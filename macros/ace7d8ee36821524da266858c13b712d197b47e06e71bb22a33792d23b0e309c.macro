Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Type Ligne_Factures
    Mouvt As String
    Exercice As String
    Date_Val As String
    Jnl As String
    Date_Ech As String
    No_Ecrit As String
    Code_OP As String
    No_Fact As String
    CCollectif As String
    CDebit As String
    CCredit As String
    Libelle As String
    Montant_Plus As String
    Montant_Moins As String
    Mois As String
End Type
Function Ccpmodulo(Ccpstr As String)
Dim xtab As Integer, ytab As Integer
Dim i As Integer, j As Integer
Dim Chiffre As Integer, Report As Integer
Dim LText As Integer, C_Cle As Integer
xtab = 10
ytab = 9
Dim Ccptable(0 To 10, 0 To 9) As Integer
' Initialise la table matricielle du modulo
Ccptable(0, 0) = 0
Ccptable(1, 0) = 9
Ccptable(2, 0) = 4
Ccptable(3, 0) = 6
Ccptable(4, 0) = 8
Ccptable(5, 0) = 2
Ccptable(6, 0) = 7
Ccptable(7, 0) = 1
Ccptable(8, 0) = 3
Ccptable(9, 0) = 5
For i = 1 To ytab
For j = 0 To xtab - 2
Ccptable(j, i) = Ccptable(j + 1, i - 1)
Next
Ccptable(xtab - 1, i) = Ccptable(0, i - 1)
Next
For i = 1 To ytab
Ccptable(xtab, i) = 10 - i
Next
Ccptable(xtab, 0) = 0
' Boucle de calcul du chiffre cl|fffd|
LText = Len(Ccpstr) ' longueur du texte
Report = 0 ' Initialise le report
For i = 1 To LText ' parcours du texte
Chiffre = CInt(Mid(Ccpstr, i, 1))
Report = Ccptable(Chiffre, Report)
Next
' Calcul du chiffre cl|fffd|
C_Cle = Ccptable(xtab, Report)
Ccpmodulo = CStr(C_Cle)
End Function



Sub Cree_Fichier_Ecriture_UIG()
'
' Macro1 Macro
' Macro enregistr|fffd|e le 27.02.2011 par NA
'

'
  
Dim Ligne_Fact(1000) As Ligne_Factures
Dim i As Integer
Dim iligne As Integer
Dim Filename As String
Dim Gt As String
Dim Pv As String
Dim GPv As String

Gt = Chr(34)
Pv = Chr(9)
GPv = Gt + Pv + Gt

Sheets("Cotis UIG 2011").Select
    
i = 2

    While (Range("A" & i).Value <> "")
      With Ligne_Fact(i)
        .Mouvt = Range("A" & i).Value
        .Exercice = Range("B" & i).Value
        .Jnl = Range("C" & i).Value
        .Date_Val = Range("D" & i).Value
        .Date_Ech = Range("F" & i).Value
        .No_Ecrit = Range("G" & i).Value
        .Code_OP = Range("H" & i).Value
        .No_Fact = Range("I" & i).Value
        .CCollectif = Range("J" & i).Value
        .CDebit = Range("K" & i).Value
        .CCredit = Range("L" & i).Value
        .Libelle = Range("M" & i).Value
        If Range("C" & i).Value = "C" Then
            .Montant_Plus = Range("N" & i).Value
            .Montant_Moins = -Range("N" & i).Value
        Else
            .Montant_Plus = -Range("N" & i).Value
            .Montant_Moins = Range("N" & i).Value
        End If
        .Mois = Range("P" & i).Value
     End With
    i = i + 1
    Wend
    
 Filename = "U:\ASTUCES32\DOSSIERS\UIG\UIGBVR\UIG-2011.dif"
 MsgBox (Filename)
 Open Filename For Output As #1
 
 For iligne = 2 To i - 1
     With Ligne_Fact(iligne)
     
     If .Montant_Moins <> 0# Then
     
        Print #1, Gt; "F"; GPv;
        Print #1, .Exercice; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .Date_Ech; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CCollectif; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Code_OP; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Moins; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CDebit; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Plus; Gt
     
     End If
    End With
  Next iligne
  Close #1

End Sub

Sub Cree_Fichier_Ecriture_CS()
'
' Macro2 Macro
' Macro enregistr|fffd|e le 27.02.2011 par NA
'

'
  
Dim Ligne_Fact(1000) As Ligne_Factures
Dim i As Integer
Dim iligne As Integer
Dim Filename As String
Dim Gt As String
Dim Pv As String
Dim GPv As String

Gt = Chr(34)
Pv = Chr(9)
GPv = Gt + Pv + Gt

Sheets("Cotis CS 2011").Select
    
i = 2

    While (Range("A" & i).Value <> "")
      With Ligne_Fact(i)
        .Mouvt = Range("A" & i).Value
        .Exercice = Range("B" & i).Value
        .Jnl = Range("C" & i).Value
        .Date_Val = Range("D" & i).Value
        .Date_Ech = Range("F" & i).Value
        .No_Ecrit = Range("G" & i).Value
        .Code_OP = Range("H" & i).Value
        .No_Fact = Range("I" & i).Value
        .CCollectif = Range("J" & i).Value
        .CDebit = Range("K" & i).Value
        .CCredit = Range("L" & i).Value
        .Libelle = Range("M" & i).Value
        If Range("C" & i).Value = "C" Then
            .Montant_Plus = Range("N" & i).Value
            .Montant_Moins = -Range("N" & i).Value
        Else
            .Montant_Plus = -Range("N" & i).Value
            .Montant_Moins = Range("N" & i).Value
        End If
        .Mois = Range("P" & i).Value
     End With
    i = i + 1
    Wend
    
 Filename = "U:\ASTUCES32\DOSSIERS\CS\CSBVR\CS-2011.dif"
 MsgBox (Filename)
 Open Filename For Output As #1
 
 For iligne = 2 To i - 1
     With Ligne_Fact(iligne)
     
     If .Montant_Moins <> 0# Then
     
        Print #1, Gt; "F"; GPv;
        Print #1, .Exercice; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .Date_Ech; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CCollectif; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Code_OP; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Moins; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CDebit; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Plus; Gt
     
     End If
    End With
  Next iligne
  Close #1

End Sub

Sub Cree_Fichier_Ecriture_CAF()
'
' Macro1 Macro
' Macro enregistr|fffd|e le 28.02.2011 par NA
'

'
  
Dim Ligne_Fact(1000) As Ligne_Factures
Dim i As Integer
Dim iligne As Integer
Dim Filename As String
Dim Gt As String
Dim Pv As String
Dim GPv As String

Gt = Chr(34)
Pv = Chr(9)
GPv = Gt + Pv + Gt

Sheets("Acptes CAF 2011").Select
    
i = 2

    While (Range("A" & i).Value <> "")
      With Ligne_Fact(i)
        .Mouvt = Range("A" & i).Value
        .Exercice = Range("B" & i).Value
        .Jnl = Range("C" & i).Value
        .Date_Val = Range("D" & i).Value
        .Date_Ech = Range("F" & i).Value
        .No_Ecrit = Range("G" & i).Value
        .Code_OP = Range("H" & i).Value
        .No_Fact = Range("I" & i).Value
        .CCollectif = Range("J" & i).Value
        .CDebit = Range("K" & i).Value
        .CCredit = Range("L" & i).Value
        .Libelle = Range("M" & i).Value
        If Range("C" & i).Value = "C" Then
            .Montant_Plus = Range("O" & i).Value
            .Montant_Moins = -Range("O" & i).Value
        Else
            .Montant_Plus = -Range("O" & i).Value
            .Montant_Moins = Range("O" & i).Value
        End If
        .Mois = Range("Q" & i).Value
     End With
    i = i + 1
    Wend
    
 Filename = "U:\ASTUCES32\DOSSIERS\CAF\CAFBVR\CAF-" & Ligne_Fact(2).Mois & ".dif"
 MsgBox (Filename)
 Open Filename For Output As #1
 
 For iligne = 2 To i - 1
     With Ligne_Fact(iligne)
     
     If .Montant_Moins <> 0# Then
     
        Print #1, Gt; "F"; GPv;
        Print #1, .Exercice; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .Date_Ech; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CCollectif; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Code_OP; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Moins; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CDebit; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Plus; Gt
     
     End If
    End With
  Next iligne
  Close #1

End Sub

Sub Cree_Fichier_Ecriture_FFPP()
'
' Macro1 Macro
' Macro enregistr|fffd|e le 01.03.2011 par NA
'

'
  
Dim Ligne_Fact(100) As Ligne_Factures
Dim i As Integer
Dim iligne As Integer
Dim Filename As String
Dim Gt As String
Dim Pv As String
Dim GPv As String

Gt = Chr(34)
Pv = Chr(9)
GPv = Gt + Pv + Gt

Sheets("Cotis FFPP 2010").Select
    
i = 2

    While (Range("A" & i).Value <> "")
      With Ligne_Fact(i)
        .Mouvt = Range("A" & i).Value
        .Exercice = Range("B" & i).Value
        .Jnl = Range("C" & i).Value
        .Date_Val = Range("D" & i).Value
        .Date_Ech = Range("F" & i).Value
        .No_Ecrit = Range("G" & i).Value
        .Code_OP = Range("H" & i).Value
        .No_Fact = Range("I" & i).Value
        .CCollectif = Range("J" & i).Value
        .CDebit = Range("K" & i).Value
        .CCredit = Range("L" & i).Value
        .Libelle = Range("M" & i).Value
        If Range("C" & i).Value = "C" Then
            .Montant_Plus = Range("N" & i).Value
            .Montant_Moins = -Range("N" & i).Value
        Else
            .Montant_Plus = -Range("N" & i).Value
            .Montant_Moins = Range("N" & i).Value
        End If
        .Mois = Range("P" & i).Value
     End With
    i = i + 1
    Wend
    
 Filename = "U:\ASTUCES32\DOSSIERS\CAF\CAFBVR\FFPP-" & Ligne_Fact(2).Mois & ".dif"
 MsgBox (Filename)
 Open Filename For Output As #1
 
 For iligne = 2 To i - 1
     With Ligne_Fact(iligne)
     
     If .Montant_Moins <> 0# Then
     
        Print #1, Gt; "F"; GPv;
        Print #1, .Exercice; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .Date_Ech; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CCollectif; GPv;
        Print #1, .CCredit; GPv;
        Print #1, .No_Fact; GPv;
        Print #1, .Code_OP; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Moins; Gt
        
        Print #1, Gt; "M"; GPv;
        Print #1, .Jnl; GPv;
        Print #1, .Date_Val; GPv;
        Print #1, .No_Ecrit; GPv;
        Print #1, .CDebit; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, ""; GPv;
        Print #1, .Libelle; GPv;
        Print #1, .Montant_Plus; Gt
     
     End If
    End With
  Next iligne
  Close #1

End Sub




Attribute VB_Name = "Module2"
Dim Astuces As Object


Public Function DebutMois(Annee As Integer, Mois As Integer)
On Error GoTo Fin
    DebutMois = DateSerial(Annee, Mois, 1)
Fin:
End Function

Public Function FinMois(Annee As Integer, Mois As Integer)
On Error GoTo Fin
    FinMois = DateSerial(Annee, Mois, 1)
    FinMois = DateAdd("m", 1, FinMois)
    FinMois = DateAdd("d", -1, FinMois)
Fin:
End Function

Public Function NomSociete(Societe As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    NomSociete = Astuces.NomSociete(Societe)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    NomSociete = Astuces.NomSociete(Societe)
    Err.Clear
Fin:
End Function

Function LastPath() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    LastPath = Astuces.LastPath()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    LastPath = Astuces.LastPath()
    Err.Clear
Fin:
End Function

Function ExerciceParDefaut(Societe As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ExerciceParDefaut = Astuces.ExerciceParDefaut(Societe)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ExerciceParDefaut = Astuces.ExerciceParDefaut(Societe)
    Err.Clear
Fin:
End Function

Function IntituleCompte(Societe As String, Exercice As String, Compte As String) As String
    On Error GoTo DoCreate
    IntituleCompte = Astuces.IntituleCompte(Societe, Exercice, Compte)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    IntituleCompte = Astuces.IntituleCompte(Societe, Exercice, Compte)
    Err.Clear
Fin:
End Function

Function MonnaieCompte(Societe As String, Exercice As String, Compte As String) As String
    On Error GoTo DoCreate
    MonnaieCompte = Astuces.MonnaieCompte(Societe, Exercice, Compte)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    MonnaieCompte = Astuces.MonnaieCompte(Societe, Exercice, Compte)
    Err.Clear
Fin:
End Function
Function SoldeCompte(Societe As String, Exercice As String, dPerdu As Date, dPerau As Date, Compte As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.SoldeCompte(Societe, Exercice, Compte, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.SoldeCompte(Societe, Exercice, Compte, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        SoldeCompte = CDbl(ret)
    Else
        SoldeCompte = ret
    End If
End Function

Function SoldeCompteType(Societe As String, Exercice As String, dPerdu As Date, dPerau As Date, Compte As String, PasComptabilise As Boolean, Simulation As Boolean) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.SoldeCompteType(Societe, Exercice, Compte, dPerdu, dPerau, PasComptabilise, Simulation)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.SoldeCompteType(Societe, Exercice, Compte, dPerdu, dPerau, PasComptabilise, Simulation)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        SoldeCompteType = CDbl(ret)
    Else
        SoldeCompteType = ret
    End If
End Function

Function SoldeCompteMonnaie(Societe As String, Exercice As String, dPerdu As Date, dPerau As Date, Compte As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.SoldeCompteMonnaie(Societe, Exercice, Compte, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.SoldeCompteMonnaie(Societe, Exercice, Compte, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        SoldeCompteMonnaie = CDbl(ret)
    Else
        SoldeCompteMonnaie = ret
    End If
End Function




Function AbregeTiers(Societe As String, Exercice As String, Compte As String) As String
    On Error GoTo DoCreate
    AbregeTiers = Astuces.AbregeTiers(Societe, Exercice, Compte)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AbregeTiers = Astuces.AbregeTiers(Societe, Exercice, Compte)
    Err.Clear
Fin:
End Function

Function MonnaieTiers(Societe As String, Exercice As String, Compte As String) As String
    On Error GoTo DoCreate
    MonnaieTiers = Astuces.MonnaieTiers(Societe, Exercice, Compte)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    MonnaieTiers = Astuces.MonnaieTiers(Societe, Exercice, Compte)
    Err.Clear
Fin:
End Function


Function SoldeTiers(Societe As String, Exercice As String, dPerdu As Date, dPerau As Date, Compte As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.SoldeTiers(Societe, Exercice, Compte, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.SoldeTiers(Societe, Exercice, Compte, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        SoldeTiers = CDbl(ret)
    Else
        SoldeTiers = ret
    End If
End Function

Function SoldeTiersMonnaie(Societe As String, Exercice As String, dPerdu As Date, dPerau As Date, Compte As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.SoldeTiersMonnaie(Societe, Exercice, Compte, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.SoldeTiersMonnaie(Societe, Exercice, Compte, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        SoldeTiersMonnaie = CDbl(ret)
    Else
        SoldeTiersMonnaie = ret
    End If
End Function

Public Function AdresseDeA(Societe As String, De As String, A As String, Max As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseDeA = Astuces.AdresseDeA(Societe, De, A, Max)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseDeA = Astuces.AdresseDeA(Societe, De, A, Max)
    Err.Clear
Fin:
End Function

Public Function AdressePremier() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdressePremier = Astuces.AdressePremier()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdressePremier = Astuces.AdressePremier()
    Err.Clear
Fin:
End Function

Public Function AdresseSuivant() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseSuivant = Astuces.AdresseSuivant()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseSuivant = Astuces.AdresseSuivant()
    Err.Clear
Fin:
End Function
Public Function CentreAnDeA(Societe As String, FamAn As String, De As String, A As String, Max As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    CentreAnDeA = Astuces.CentreAnDeA(Societe, FamAn, De, A, Max)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnDeA = Astuces.CentreAnDeA(Societe, FamAn, De, A, Max)
    Err.Clear
Fin:
End Function

Public Function CentreAnPremier() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    CentreAnPremier = Astuces.CentreAnPremier()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnPremier = Astuces.CentreAnPremier()
    Err.Clear
Fin:
End Function

Public Function CentreAnSuivant() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    CentreAnSuivant = Astuces.CentreAnSuivant()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnSuivant = Astuces.CentreAnSuivant()
    Err.Clear
Fin:
End Function

Public Function AdresseAbrege(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseAbrege = Astuces.AdresseAbrege(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseAbrege = Astuces.AdresseAbrege(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseNumero(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseNumero = Astuces.AdresseNumero(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseNumero = Astuces.AdresseNumero(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseNom(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseNom = Astuces.AdresseNom(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseNom = Astuces.AdresseNom(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseTitre(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseTitre = Astuces.AdresseTitre(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseTitre = Astuces.AdresseTitre(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseAdr(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseAdr = Astuces.AdresseAdr(Interne, True)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseAdr = Astuces.AdresseAdr(Interne, True)
    Err.Clear
Fin:
End Function

Public Function AdresseCP(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseCP = Astuces.AdresseCP(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseCP = Astuces.AdresseCP(Interne)
    Err.Clear
Fin:
End Function
Public Function AdresseNoPostal(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseNoPostal = Astuces.AdresseNoPostal(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseNoPostal = Astuces.AdresseNoPostal(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseVille(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseVille = Astuces.AdresseVille(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseVille = Astuces.AdresseVille(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseTel1(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseTel1 = Astuces.AdresseTel1(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseTel1 = Astuces.AdresseTel1(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseTel2(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseTel2 = Astuces.AdresseTel2(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseTel2 = Astuces.AdresseTel2(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseFax(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseFax = Astuces.AdresseFax(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseFax = Astuces.AdresseFax(Interne)
    Err.Clear
Fin:
End Function

Public Function AdresseSoldeDebiteur(Interne As Long) As Variant
    Dim Exercice As String, Compte As String
    Dim dPerdu As Date, dPerau As Date
    On Error GoTo Fin
    Exercice = ExerciceParDefaut(LastPath())
    Compte = AdresseNumero(Interne) + "D"
    dPerdu = CDate("01/01/1980")
    dPerau = CDate("31/12/2037")
    AdresseSoldeDebiteur = SoldeTiers(LastPath(), Exercice, dPerdu, dPerau, Compte)
Fin:
End Function

Public Function AdresseNatel(Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseNatel = Astuces.AdresseNatel(Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseNatel = Astuces.AdresseNatel(Interne)
    Err.Clear
Fin:
End Function

Public Function ContactPremier(Societe As String, Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ContactPremier = Astuces.ContactPremier(Societe, Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ContactPremier = Astuces.ContactPremier(Societe, Interne)
    Err.Clear
Fin:
End Function

Public Function ContactSuivant() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ContactSuivant = Astuces.ContactSuivant()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ContactSuivant = Astuces.ContactSuivant()
    Err.Clear
Fin:
End Function

Public Function Contact(lAdresse As Long, bTitre As Boolean, bNom As Boolean, bPrenom As Boolean) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    Contact = Astuces.Contact(lAdresse, bTitre, bNom, bPrenom)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    Contact = Astuces.Contact(lAdresse, bTitre, bNom, bPrenom)
    Err.Clear
Fin:
End Function


Public Function AdresseAttn(Interne As Long, bWithLF As Boolean) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AdresseAttn = Astuces.AdresseAttn(Interne, bWithLF)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseAttn = Astuces.AdresseAttn(Interne, bWithLF)
    Err.Clear
Fin:
End Function


Public Function AnalytQteAdrCentre2(Societe As String, FamAn As String, Adresse As String, FamAn2 As String, CentreAn2 As String, dPerdu As Date, dPerau As Date) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.AnalytQteAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.AnalytQteAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        AnalytQteAdrCentre2 = CDbl(ret)
    Else
        AnalytQteAdrCentre2 = ret
    End If
End Function

Public Function AnalytMntAdrCentre2(Societe As String, FamAn As String, Adresse As String, FamAn2 As String, CentreAn2 As String, dPerdu As Date, dPerau As Date) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.AnalytMntAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ret = Astuces.AnalytMntAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        AnalytMntAdrCentre2 = CDbl(ret)
    Else
        AnalytMntAdrCentre2 = ret
    End If
End Function

Public Function NumAnalytMntAdrCentre2(Societe As String, FamAn As String, Adresse As String, FamAn2 As String, CentreAn2 As String, dPerdu As Date, dPerau As Date) As Variant
    Dim res As Variant
    res = AnalytMntAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    If (IsNull(res)) Then
        NumAnalytMntAdrCentre2 = 0
    Else
        NumAnalytMntAdrCentre2 = res
    End If
End Function

Public Function NumAnalytQteAdrCentre2(Societe As String, FamAn As String, Adresse As String, FamAn2 As String, CentreAn2 As String, dPerdu As Date, dPerau As Date) As Variant
    Dim res As Variant
    res = AnalytQteAdrCentre2(Societe, FamAn, Adresse, FamAn2, CentreAn2, dPerdu, dPerau)
    If (IsNull(res)) Then
        NumAnalytQteAdrCentre2 = 0
    Else
        NumAnalytQteAdrCentre2 = res
    End If
End Function


Public Function AnalytCentreOfAdrPremier(Societe As String, FamAn As String, Interne As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AnalytCentreOfAdrPremier = Astuces.AnalytCentreOfAdrPremier(Societe, FamAn, Interne)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AnalytCentreOfAdrPremier = Astuces.AnalytCentreOfAdrPremier(Societe, FamAn, Interne)
    Err.Clear
Fin:
End Function

Public Function AnalytCentreOfAdrSuivant() As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AnalytCentreOfAdrSuivant = Astuces.AnalytCentreOfAdrSuivant()
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AnalytCentreOfAdrSuivant = Astuces.AnalytCentreOfAdrSuivant()
    Err.Clear
Fin:
End Function

Public Function AnalytCentreAbrege(lAdresse As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    AnalytCentreAbrege = Astuces.AnalytCentreAbrege(lAdresse)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AnalytCentreAbrege = Astuces.AnalytCentreAbrege(lAdresse)
    Err.Clear
Fin:
End Function

Public Function CentreAnStringField(lCentreAn As Long, lField As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    CentreAnStringField = Astuces.CentreAnStringField(lCentreAn, lField)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnStringField = Astuces.CentreAnStringField(lCentreAn, lField)
    Err.Clear
Fin:
End Function

Public Function CentreAnLongField(lCentreAn As Long, lField As Long) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    CentreAnLongField = Astuces.CentreAnLongField(lCentreAn, lField)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnLongField = Astuces.CentreAnLongField(lCentreAn, lField)
    Err.Clear
Fin:
End Function

Public Function MvtRubNumAdrNumQte(Societe As String, FamAn As String, Exercice As String, RubNum As String, AdrNum As String, Du As Date, Au As Date) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    MvtRubNumAdrNumQte = Astuces.MvtRubNumAdrNumQte(Societe, FamAn, Exercice, RubNum, AdrNum, Du, Au)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    MvtRubNumAdrNumQte = Astuces.MvtRubNumAdrNumQte(Societe, FamAn, Exercice, RubNum, AdrNum, Du, Au)
    Err.Clear
Fin:
    If (IsNumeric(MvtRubNumAdrNumQte)) Then MvtRubNumAdrNumQte = CDbl(MvtRubNumAdrNumQte)
End Function

Function AdresseCA(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    AdresseCA = Astuces.AdresseCA(Societe, NumAdresse, PeriodeDu, PeriodeAu)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseCA = Astuces.AdresseCA(Societe, NumAdresse, PeriodeDu, PeriodeAu)
    Err.Clear
Fin:
    If (IsNumeric(AdresseCA)) Then AdresseCA = CDbl(AdresseCA)
End Function

Function CommenditaireCA(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    CommenditaireCA = Astuces.CommenditaireCA(Societe, NumAdresse, PeriodeDu, PeriodeAu)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CommenditaireCA = Astuces.CommenditaireCA(Societe, NumAdresse, PeriodeDu, PeriodeAu)
    Err.Clear
Fin:
    If (IsNumeric(CommenditaireCA)) Then CommenditaireCA = CDbl(CommenditaireCA)
End Function


Function AdresseNumAbrege(Societe As String, NumAdresse As String) As String
    On Error GoTo DoCreate
    AdresseNumAbrege = Astuces.AdresseNumAbrege(Societe, NumAdresse)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    AdresseNumAbrege = Astuces.AdresseNumAbrege(Societe, NumAdresse)
    Err.Clear
Fin:
End Function

Function StatOuvrierHeures(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    StatOuvrierHeures = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 1)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    StatOuvrierHeures = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 1)
    Err.Clear
Fin:
    If (IsNumeric(StatOuvrierHeures)) Then StatOuvrierHeures = CDbl(StatOuvrierHeures)
End Function

Function StatOuvrierHeuresQuota(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    StatOuvrierHeuresQuota = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 2)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    StatOuvrierHeuresQuota = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 2)
    Err.Clear
Fin:
    If (IsNumeric(StatOuvrierHeuresQuota)) Then StatOuvrierHeuresQuota = CDbl(StatOuvrierHeuresQuota)
End Function

Function StatOuvrierFactures(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    StatOuvrierFactures = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 3)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    StatOuvrierFactures = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 3)
    Err.Clear
Fin:
    If (IsNumeric(StatOuvrierFactures)) Then StatOuvrierFactures = CDbl(StatOuvrierFactures)
End Function

Function StatOuvrierRendement(Societe As String, NumAdresse As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    StatOuvrierRendement = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 4)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    StatOuvrierRendement = Astuces.StatOuvrier(Societe, NumAdresse, PeriodeDu, PeriodeAu, 4)
    Err.Clear
Fin:
    If (IsNumeric(StatOuvrierRendement)) Then StatOuvrierRendement = CDbl(StatOuvrierRendement)
End Function

Function RechAvanceeMontant(Societe As String, Compteur As String, PeriodeDu As Date, PeriodeAu As Date, Region As String, Representant As String, GrStat As String) As Variant
    On Error GoTo DoCreate
    RechAvanceeMontant = Astuces.RechAvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 1)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    RechAvanceeMontant = AstucesRech.AvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 1)
    Err.Clear
Fin:
    If (IsNumeric(RechAvanceeMontant)) Then RechAvanceeMontant = CDbl(RechAvanceeMontant)
End Function

Function RechAvanceeAnalytFacture(Societe As String, Compteur As String, PeriodeDu As Date, PeriodeAu As Date, Region As String, Representant As String, GrStat As String) As Variant
    On Error GoTo DoCreate
    RechAvanceeAnalytFacture = Astuces.RechAvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 2)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    RechAvanceeAnalytFacture = AstucesRech.AvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 2)
    Err.Clear
Fin:
    If (IsNumeric(RechAvanceeAnalytFacture)) Then RechAvanceeAnalytFacture = CDbl(RechAvanceeAnalytFacture)
End Function

Function RechAvanceeAnalyt(Societe As String, Compteur As String, PeriodeDu As Date, PeriodeAu As Date, Region As String, Representant As String, GrStat As String) As Variant
    On Error GoTo DoCreate
    RechAvanceeAnalyt = Astuces.RechAvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 3)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    RechAvanceeAnalyt = AstucesRech.AvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 3)
    Err.Clear
Fin:
    If (IsNumeric(RechAvanceeAnalyt)) Then RechAvanceeAnalyt = CDbl(RechAvanceeAnalyt)
End Function

Function RechAvanceeAnalytPercent(Societe As String, Compteur As String, PeriodeDu As Date, PeriodeAu As Date, Region As String, Representant As String, GrStat As String) As Variant
    On Error GoTo DoCreate
    RechAvanceeAnalytPercent = Astuces.RechAvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 4)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    RechAvanceeAnalytPercent = AstucesRech.AvanceePeriode(Societe, Compteur, PeriodeDu, PeriodeAu, Region, Representant, GrStat, 4)
    Err.Clear
Fin:
    If (IsNumeric(RechAvanceeAnalytPercent)) Then RechAvanceeAnalytPercent = CDbl(RechAvanceeAnalytPercent)
End Function

Function CentreAnFamAnAbrege(Societe As String, NumFamAn As String, NumCentreAn As String) As Variant
    On Error GoTo DoCreate
    CentreAnFamAnAbrege = Astuces.CentreAnFamAnAbrege(Societe, NumFamAn, NumCentreAn)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    CentreAnFamAnAbrege = Astuces.CentreAnFamAnAbrege(Societe, NumFamAn, NumCentreAn)
    Err.Clear
Fin:
End Function


Function MntAnalytPlanRubsPeriode(Societe As String, Exercice As String, NumCompte As String, FamAn As String, Rub1 As String, Rub2 As String, Rub3 As String, Rub4 As String, PeriodeDu As Date, PeriodeAu As Date) As Variant
    On Error GoTo DoCreate
    MntAnalytPlanRubsPeriode = Astuces.MntAnalytPlanRubsPeriode(Societe, Exercice, NumCompte, FamAn, Rub1, Rub2, Rub3, Rub4, PeriodeDu, PeriodeAu)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    MntAnalytPlanRubsPeriode = Astuces.MntAnalytPlanRubsPeriode(Societe, Exercice, NumCompte, FamAn, Rub1, Rub2, Rub3, Rub4, PeriodeDu, PeriodeAu)
    Err.Clear
Fin:
    If (IsNumeric(MntAnalytPlanRubsPeriode)) Then MntAnalytPlanRubsPeriode = CDbl(MntAnalytPlanRubsPeriode)
End Function

Function DocumentDate(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentDate = Astuces.DocumentStringField(Societe, Compteur, Document, 15)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentDate = Astuces.Astuces.DocumentStringField(Societe, Compteur, Document, 15)
    Err.Clear
Fin:
    If (IsDate(DocumentDate)) Then DocumentDate = CDate(DocumentDate)
End Function

Function DocumentMonnaie(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentMonnaie = Astuces.DocumentStringField(Societe, Compteur, Document, 38)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentMonnaie = Astuces.Astuces.DocumentStringField(Societe, Compteur, Document, 38)
    Err.Clear
Fin:
End Function

Function DocumentMontant(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentMontant = Astuces.DocumentStringField(Societe, Compteur, Document, 44)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentMontant = Astuces.Astuces.DocumentStringField(Societe, Compteur, Document, 44)
    Err.Clear
Fin:
    If (IsNumeric(DocumentMontant)) Then DocumentMontant = CDbl(DocumentMontant)
End Function

Function DocumentMontantHT(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentMontantHT = Astuces.DocumentStringField(Societe, Compteur, Document, 63)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentMontantHT = Astuces.Astuces.DocumentStringField(Societe, Compteur, Document, 63)
    Err.Clear
Fin:
    If (IsNumeric(DocumentMontantHT)) Then DocumentMontantHT = CDbl(DocumentMontantHT)
End Function

Function DocumentMontantMon(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentMontantMon = Astuces.DocumentStringField(Societe, Compteur, Document, 133)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentMontantMon = Astuces.Astuces.DocumentStringField(Societe, Compteur, Document, 133)
    Err.Clear
Fin:
    If (IsNumeric(DocumentMontantMon)) Then DocumentMontantMon = CDbl(DocumentMontantMon)
End Function

Function DocumentArticlePrix(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticlePrix = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 30)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticlePrix = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 30)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticlePrix)) Then DocumentArticlePrix = CDbl(DocumentArticlePrix)
End Function

Function DocumentArticleQte(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleQte = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 29)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleQte = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 29)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleQte)) Then DocumentArticleQte = CDbl(DocumentArticleQte)
End Function

Function DocumentArticleQteStat(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleQteStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 11)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleQteStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 11)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleQteStat)) Then DocumentArticleQteStat = CDbl(DocumentArticleQteStat)
End Function

Function DocumentArticleQteSansStat(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleQteSansStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, -3)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleQteSansStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, -3)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleQteSansStat)) Then DocumentArticleQteSansStat = CDbl(DocumentArticleQteSansStat)
End Function

Function DocumentArticleMontantStat(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleMontantStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 12)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleMontantStat = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, 12)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleMontantStat)) Then DocumentArticleMontantStat = CDbl(DocumentArticleMontantStat)
End Function

Function DocumentArticleMontant(Societe As String, Compteur As String, Document As String, Article As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleMontant = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, -1)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleMontant = Astuces.DocumentArticleField(Societe, Compteur, Document, Article, -1)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleMontant)) Then DocumentArticleMontant = CDbl(DocumentArticleMontant)
End Function

Function DocumentArticleTotalQtePrix(Societe As String, Compteur As String, Document As String) As Variant
    On Error GoTo DoCreate
    DocumentArticleTotalQtePrix = Astuces.DocumentArticleField(Societe, Compteur, Document, "", -2)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    DocumentArticleTotalQtePrix = Astuces.DocumentArticleField(Societe, Compteur, Document, "", -2)
    Err.Clear
Fin:
    If (IsNumeric(DocumentArticleTotalQtePrix)) Then DocumentArticleTotalQtePrix = CDbl(DocumentArticleTotalQtePrix)
End Function

Function ArticleDesignation(Societe As String, Article As String) As Variant
    On Error GoTo DoCreate
    ArticleDesignation = Astuces.ArticleDesignation(Societe, Article)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    ArticleDesignation = Astuces.ArticleDesignation(Societe, Article)
    Err.Clear
Fin:
End Function




Function BudgetCompte(Societe As String, Exercice As String, Budget As String, dPerdu As Date, dPerau As Date, Compte As String) As Variant
    Dim ret As String
    
    On Error GoTo DoCreate
    ret = Astuces.BudgetCompte(Societe, Exercice, Compte, Budget, dPerdu, dPerau)
    GoTo Fin:
DoCreate:
    Set Astuces = CreateObject("Astuces32.Document")
    Set Astuces.
    ret = Astuces.BudgetCompte(Societe, Exercice, Compte, Budget, dPerdu, dPerau)
    Err.Clear
Fin:
    If (IsNumeric(ret)) Then
        BudgetCompte = CDbl(ret)
    Else
        BudgetCompte = ret
    End If
End Function

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' z{k{
' z{k{

INQUEST-PP=macro
