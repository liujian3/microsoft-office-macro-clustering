Attribute VB_Name = "Module1"
Private Sub InitMacro()

End Sub
Function SaveReportData() As Boolean
On Error GoTo SaveReportData_Error
Dim objIE As Object
Dim strValues As String
SaveReportData = True
Set objIE = CreateObject("InternetExplorer.Application")
DoEvents
DeleteCookies
With objIE
.AddressBar = False
.StatusBar = False
.MenuBar = False
.Toolbar = 0
.Visible = False
.Navigate Range("DD3").Comment.Text
End With
While objIE.Busy
Wend
While objIE.Document.ReadyState <> "complete"
Wend
strValues = strValues & BuildXML0()
strValues = strValues & BuildXML1()
With objIE.Document.Forms("EFormsDataCaptureForm")
If Not Range("DD4").Comment Is Nothing Then
.All.Item("ExertID").Value = Range("DD4").Comment.Text
End If
.All.Item("ReportID").Value = "279"
.All.Item("ReportName").Value = "PSL TEC MP 40 TOXIC GAS ,SPAN GAS RECORD REV 1"
.All.Item("EntityCode").Value = Range("DD1").Comment.Text
.All.Item("EntityName").Value = Range("DD2").Comment.Text
.All.Item("DatabaseIdentity").Value = Range("DD5").Comment.Text
.All.Item("CurrentEntityCode").Value = Range("DD6").Comment.Text
.All.Item("CurrentUserCode").Value = Range("DD7").Comment.Text
.All.Item("CurrentUserName").Value = Range("DD8").Comment.Text
.All.Item("EntryValues").Value = strValues
.submit
End With
While objIE.Busy
Wend
While objIE.Document.ReadyState <> "complete"
Wend
Cleanup:
objIE.Quit
Set objIE = Nothing
Exit Function
SaveReportData_Error:
Select Case Err.Number
Case 9000
SaveReportData = False
Resume Cleanup
 Case Else
 Debug.Print Err.Number, Err.Description
MsgBox Err.Description
SaveReportData = False
Stop
End Select
End Function
Private Sub DeleteCookies()
Dim strDir As String, strFile As String
strDir = VBA.Environ$("USERPROFILE") & "\Cookies\"
strFile = Dir(strDir & "*tek-tips*.txt", vbNormal)
Do While strFile <> ""
Kill strDir & strFile
strFile = Dir
Loop
End Sub
Public Function BuildXML0()
    Dim strXML As String
    strXML = "(((Report)))"
    strXML = strXML & "(((Sheet Name=""DETECTOR"")))"
    Sheets("DETECTOR").Select
    If Range("B6").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B6"" Value=""" & Replace(Range("B6").Value, """", "``") & """  /)))"
    End If

    If Range("F6").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F6"" Value=""" & Replace(Range("F6").Value, """", "``") & """  /)))"
    End If

    If Range("A12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A12"" Value=""" & Replace(Range("A12").Value, """", "``") & """  /)))"
    End If

    If Range("B12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B12"" Value=""" & Replace(Range("B12").Value, """", "``") & """  /)))"
    End If

    If Range("C12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C12"" Value=""" & Replace(Range("C12").Value, """", "``") & """  /)))"
    End If

    If Range("D12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D12"" Value=""" & Replace(Range("D12").Value, """", "``") & """  /)))"
    End If

    If Range("E12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E12"" Value=""" & Replace(Range("E12").Value, """", "``") & """  /)))"
    End If

    If Range("F12").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F12"" Value=""" & Replace(Range("F12").Value, """", "``") & """  /)))"
    End If

    If Range("A13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A13"" Value=""" & Replace(Range("A13").Value, """", "``") & """  /)))"
    End If

    If Range("B13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B13"" Value=""" & Replace(Range("B13").Value, """", "``") & """  /)))"
    End If

    If Range("C13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C13"" Value=""" & Replace(Range("C13").Value, """", "``") & """  /)))"
    End If

    If Range("D13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D13"" Value=""" & Replace(Range("D13").Value, """", "``") & """  /)))"
    End If

    If Range("E13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E13"" Value=""" & Replace(Range("E13").Value, """", "``") & """  /)))"
    End If

    If Range("F13").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F13"" Value=""" & Replace(Range("F13").Value, """", "``") & """  /)))"
    End If

    If Range("A14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A14"" Value=""" & Replace(Range("A14").Value, """", "``") & """  /)))"
    End If

    If Range("B14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B14"" Value=""" & Replace(Range("B14").Value, """", "``") & """  /)))"
    End If

    If Range("C14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C14"" Value=""" & Replace(Range("C14").Value, """", "``") & """  /)))"
    End If

    If Range("D14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D14"" Value=""" & Replace(Range("D14").Value, """", "``") & """  /)))"
    End If

    If Range("E14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E14"" Value=""" & Replace(Range("E14").Value, """", "``") & """  /)))"
    End If

    If Range("F14").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F14"" Value=""" & Replace(Range("F14").Value, """", "``") & """  /)))"
    End If

    If Range("A15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A15"" Value=""" & Replace(Range("A15").Value, """", "``") & """  /)))"
    End If

    If Range("B15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B15"" Value=""" & Replace(Range("B15").Value, """", "``") & """  /)))"
    End If

    If Range("C15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C15"" Value=""" & Replace(Range("C15").Value, """", "``") & """  /)))"
    End If

    If Range("D15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D15"" Value=""" & Replace(Range("D15").Value, """", "``") & """  /)))"
    End If

    If Range("E15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E15"" Value=""" & Replace(Range("E15").Value, """", "``") & """  /)))"
    End If

    If Range("F15").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F15"" Value=""" & Replace(Range("F15").Value, """", "``") & """  /)))"
    End If

    If Range("A16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A16"" Value=""" & Replace(Range("A16").Value, """", "``") & """  /)))"
    End If

    If Range("B16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B16"" Value=""" & Replace(Range("B16").Value, """", "``") & """  /)))"
    End If

    If Range("C16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C16"" Value=""" & Replace(Range("C16").Value, """", "``") & """  /)))"
    End If

    If Range("D16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D16"" Value=""" & Replace(Range("D16").Value, """", "``") & """  /)))"
    End If

    If Range("E16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E16"" Value=""" & Replace(Range("E16").Value, """", "``") & """  /)))"
    End If

    If Range("F16").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F16"" Value=""" & Replace(Range("F16").Value, """", "``") & """  /)))"
    End If

    If Range("A17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A17"" Value=""" & Replace(Range("A17").Value, """", "``") & """  /)))"
    End If

    If Range("B17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B17"" Value=""" & Replace(Range("B17").Value, """", "``") & """  /)))"
    End If

    If Range("C17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C17"" Value=""" & Replace(Range("C17").Value, """", "``") & """  /)))"
    End If

    If Range("D17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D17"" Value=""" & Replace(Range("D17").Value, """", "``") & """  /)))"
    End If

    If Range("E17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E17"" Value=""" & Replace(Range("E17").Value, """", "``") & """  /)))"
    End If

    If Range("F17").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F17"" Value=""" & Replace(Range("F17").Value, """", "``") & """  /)))"
    End If

    If Range("A18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A18"" Value=""" & Replace(Range("A18").Value, """", "``") & """  /)))"
    End If

    If Range("B18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B18"" Value=""" & Replace(Range("B18").Value, """", "``") & """  /)))"
    End If
    
    If Range("A54").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A54"" Value=""" & Replace(Range("A54").Value, """", "``") & """  /)))"
    End If
    
    If Range("A55").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A55"" Value=""" & Replace(Range("A55").Value, """", "``") & """  /)))"
    End If

    If Range("C18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C18"" Value=""" & Replace(Range("C18").Value, """", "``") & """  /)))"
    End If

    If Range("D18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D18"" Value=""" & Replace(Range("D18").Value, """", "``") & """  /)))"
    End If

    If Range("E18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E18"" Value=""" & Replace(Range("E18").Value, """", "``") & """  /)))"
    End If

    If Range("F18").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F18"" Value=""" & Replace(Range("F18").Value, """", "``") & """  /)))"
    End If

    If Range("A19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A19"" Value=""" & Replace(Range("A19").Value, """", "``") & """  /)))"
    End If

    If Range("B19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B19"" Value=""" & Replace(Range("B19").Value, """", "``") & """  /)))"
    End If

    If Range("C19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C19"" Value=""" & Replace(Range("C19").Value, """", "``") & """  /)))"
    End If

    If Range("D19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D19"" Value=""" & Replace(Range("D19").Value, """", "``") & """  /)))"
    End If

    If Range("E19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E19"" Value=""" & Replace(Range("E19").Value, """", "``") & """  /)))"
    End If

    If Range("F19").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F19"" Value=""" & Replace(Range("F19").Value, """", "``") & """  /)))"
    End If

    If Range("A20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A20"" Value=""" & Replace(Range("A20").Value, """", "``") & """  /)))"
    End If

    If Range("B20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B20"" Value=""" & Replace(Range("B20").Value, """", "``") & """  /)))"
    End If

    If Range("C20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C20"" Value=""" & Replace(Range("C20").Value, """", "``") & """  /)))"
    End If

    If Range("D20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D20"" Value=""" & Replace(Range("D20").Value, """", "``") & """  /)))"
    End If

    If Range("E20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E20"" Value=""" & Replace(Range("E20").Value, """", "``") & """  /)))"
    End If

    If Range("F20").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F20"" Value=""" & Replace(Range("F20").Value, """", "``") & """  /)))"
    End If

    If Range("A21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A21"" Value=""" & Replace(Range("A21").Value, """", "``") & """  /)))"
    End If

    If Range("B21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B21"" Value=""" & Replace(Range("B21").Value, """", "``") & """  /)))"
    End If

    If Range("C21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C21"" Value=""" & Replace(Range("C21").Value, """", "``") & """  /)))"
    End If

    If Range("D21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D21"" Value=""" & Replace(Range("D21").Value, """", "``") & """  /)))"
    End If

    If Range("E21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E21"" Value=""" & Replace(Range("E21").Value, """", "``") & """  /)))"
    End If

    If Range("F21").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F21"" Value=""" & Replace(Range("F21").Value, """", "``") & """  /)))"
    End If

    If Range("A22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A22"" Value=""" & Replace(Range("A22").Value, """", "``") & """  /)))"
    End If

    If Range("B22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B22"" Value=""" & Replace(Range("B22").Value, """", "``") & """  /)))"
    End If

    If Range("C22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C22"" Value=""" & Replace(Range("C22").Value, """", "``") & """  /)))"
    End If

    If Range("D22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D22"" Value=""" & Replace(Range("D22").Value, """", "``") & """  /)))"
    End If

    If Range("E22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E22"" Value=""" & Replace(Range("E22").Value, """", "``") & """  /)))"
    End If

    If Range("F22").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F22"" Value=""" & Replace(Range("F22").Value, """", "``") & """  /)))"
    End If

    If Range("A23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A23"" Value=""" & Replace(Range("A23").Value, """", "``") & """  /)))"
    End If

    If Range("B23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B23"" Value=""" & Replace(Range("B23").Value, """", "``") & """  /)))"
    End If

    If Range("C23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C23"" Value=""" & Replace(Range("C23").Value, """", "``") & """  /)))"
    End If

    If Range("D23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D23"" Value=""" & Replace(Range("D23").Value, """", "``") & """  /)))"
    End If

    If Range("E23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E23"" Value=""" & Replace(Range("E23").Value, """", "``") & """  /)))"
    End If

    If Range("F23").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F23"" Value=""" & Replace(Range("F23").Value, """", "``") & """  /)))"
    End If

    If Range("A24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A24"" Value=""" & Replace(Range("A24").Value, """", "``") & """  /)))"
    End If

    If Range("B24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B24"" Value=""" & Replace(Range("B24").Value, """", "``") & """  /)))"
    End If

    If Range("C24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C24"" Value=""" & Replace(Range("C24").Value, """", "``") & """  /)))"
    End If

    If Range("D24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D24"" Value=""" & Replace(Range("D24").Value, """", "``") & """  /)))"
    End If

    If Range("E24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E24"" Value=""" & Replace(Range("E24").Value, """", "``") & """  /)))"
    End If

    If Range("F24").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F24"" Value=""" & Replace(Range("F24").Value, """", "``") & """  /)))"
    End If

    If Range("A25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A25"" Value=""" & Replace(Range("A25").Value, """", "``") & """  /)))"
    End If

    If Range("B25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B25"" Value=""" & Replace(Range("B25").Value, """", "``") & """  /)))"
    End If

    If Range("C25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C25"" Value=""" & Replace(Range("C25").Value, """", "``") & """  /)))"
    End If

    If Range("D25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D25"" Value=""" & Replace(Range("D25").Value, """", "``") & """  /)))"
    End If

    If Range("E25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E25"" Value=""" & Replace(Range("E25").Value, """", "``") & """  /)))"
    End If

    If Range("F25").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F25"" Value=""" & Replace(Range("F25").Value, """", "``") & """  /)))"
    End If

    If Range("A26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A26"" Value=""" & Replace(Range("A26").Value, """", "``") & """  /)))"
    End If

    If Range("B26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B26"" Value=""" & Replace(Range("B26").Value, """", "``") & """  /)))"
    End If

    If Range("C26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C26"" Value=""" & Replace(Range("C26").Value, """", "``") & """  /)))"
    End If

    If Range("D26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D26"" Value=""" & Replace(Range("D26").Value, """", "``") & """  /)))"
    End If

    If Range("E26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E26"" Value=""" & Replace(Range("E26").Value, """", "``") & """  /)))"
    End If

    If Range("F26").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F26"" Value=""" & Replace(Range("F26").Value, """", "``") & """  /)))"
    End If

    If Range("A27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A27"" Value=""" & Replace(Range("A27").Value, """", "``") & """  /)))"
    End If

    If Range("B27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B27"" Value=""" & Replace(Range("B27").Value, """", "``") & """  /)))"
    End If

    If Range("C27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C27"" Value=""" & Replace(Range("C27").Value, """", "``") & """  /)))"
    End If

    If Range("D27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D27"" Value=""" & Replace(Range("D27").Value, """", "``") & """  /)))"
    End If

    If Range("E27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E27"" Value=""" & Replace(Range("E27").Value, """", "``") & """  /)))"
    End If

    If Range("F27").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F27"" Value=""" & Replace(Range("F27").Value, """", "``") & """  /)))"
    End If

    If Range("A28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A28"" Value=""" & Replace(Range("A28").Value, """", "``") & """  /)))"
    End If

    If Range("B28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B28"" Value=""" & Replace(Range("B28").Value, """", "``") & """  /)))"
    End If

    If Range("C28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C28"" Value=""" & Replace(Range("C28").Value, """", "``") & """  /)))"
    End If

    If Range("D28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D28"" Value=""" & Replace(Range("D28").Value, """", "``") & """  /)))"
    End If

    If Range("E28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E28"" Value=""" & Replace(Range("E28").Value, """", "``") & """  /)))"
    End If

    If Range("F28").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F28"" Value=""" & Replace(Range("F28").Value, """", "``") & """  /)))"
    End If

    If Range("A34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A34"" Value=""" & Replace(Range("A34").Value, """", "``") & """  /)))"
    End If

    If Range("B34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B34"" Value=""" & Replace(Range("B34").Value, """", "``") & """  /)))"
    End If

    If Range("C34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C34"" Value=""" & Replace(Range("C34").Value, """", "``") & """  /)))"
    End If

    If Range("D34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D34"" Value=""" & Replace(Range("D34").Value, """", "``") & """  /)))"
    End If

    If Range("E34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E34"" Value=""" & Replace(Range("E34").Value, """", "``") & """  /)))"
    End If

    If Range("F34").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F34"" Value=""" & Replace(Range("F34").Value, """", "``") & """  /)))"
    End If

    If Range("A35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A35"" Value=""" & Replace(Range("A35").Value, """", "``") & """  /)))"
    End If

    If Range("B35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B35"" Value=""" & Replace(Range("B35").Value, """", "``") & """  /)))"
    End If

    If Range("C35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C35"" Value=""" & Replace(Range("C35").Value, """", "``") & """  /)))"
    End If

    If Range("D35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D35"" Value=""" & Replace(Range("D35").Value, """", "``") & """  /)))"
    End If

    If Range("E35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E35"" Value=""" & Replace(Range("E35").Value, """", "``") & """  /)))"
    End If

    If Range("F35").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F35"" Value=""" & Replace(Range("F35").Value, """", "``") & """  /)))"
    End If

    If Range("A36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A36"" Value=""" & Replace(Range("A36").Value, """", "``") & """  /)))"
    End If

    If Range("B36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B36"" Value=""" & Replace(Range("B36").Value, """", "``") & """  /)))"
    End If

    If Range("C36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C36"" Value=""" & Replace(Range("C36").Value, """", "``") & """  /)))"
    End If

    If Range("D36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D36"" Value=""" & Replace(Range("D36").Value, """", "``") & """  /)))"
    End If

    If Range("E36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E36"" Value=""" & Replace(Range("E36").Value, """", "``") & """  /)))"
    End If

    If Range("F36").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F36"" Value=""" & Replace(Range("F36").Value, """", "``") & """  /)))"
    End If

    If Range("A37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A37"" Value=""" & Replace(Range("A37").Value, """", "``") & """  /)))"
    End If

    If Range("B37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B37"" Value=""" & Replace(Range("B37").Value, """", "``") & """  /)))"
    End If

    If Range("C37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C37"" Value=""" & Replace(Range("C37").Value, """", "``") & """  /)))"
    End If

    If Range("D37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D37"" Value=""" & Replace(Range("D37").Value, """", "``") & """  /)))"
    End If

    If Range("E37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E37"" Value=""" & Replace(Range("E37").Value, """", "``") & """  /)))"
    End If

    If Range("F37").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F37"" Value=""" & Replace(Range("F37").Value, """", "``") & """  /)))"
    End If

    If Range("A38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A38"" Value=""" & Replace(Range("A38").Value, """", "``") & """  /)))"
    End If

    If Range("B38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B38"" Value=""" & Replace(Range("B38").Value, """", "``") & """  /)))"
    End If

    If Range("C38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C38"" Value=""" & Replace(Range("C38").Value, """", "``") & """  /)))"
    End If

    If Range("D38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D38"" Value=""" & Replace(Range("D38").Value, """", "``") & """  /)))"
    End If

    If Range("E38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E38"" Value=""" & Replace(Range("E38").Value, """", "``") & """  /)))"
    End If

    If Range("F38").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F38"" Value=""" & Replace(Range("F38").Value, """", "``") & """  /)))"
    End If

    If Range("A39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A39"" Value=""" & Replace(Range("A39").Value, """", "``") & """  /)))"
    End If

    If Range("B39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B39"" Value=""" & Replace(Range("B39").Value, """", "``") & """  /)))"
    End If

    If Range("C39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C39"" Value=""" & Replace(Range("C39").Value, """", "``") & """  /)))"
    End If

    If Range("D39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D39"" Value=""" & Replace(Range("D39").Value, """", "``") & """  /)))"
    End If

    If Range("E39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E39"" Value=""" & Replace(Range("E39").Value, """", "``") & """  /)))"
    End If

    If Range("F39").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F39"" Value=""" & Replace(Range("F39").Value, """", "``") & """  /)))"
    End If

    If Range("A40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A40"" Value=""" & Replace(Range("A40").Value, """", "``") & """  /)))"
    End If

    If Range("B40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B40"" Value=""" & Replace(Range("B40").Value, """", "``") & """  /)))"
    End If

    If Range("C40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C40"" Value=""" & Replace(Range("C40").Value, """", "``") & """  /)))"
    End If

    If Range("D40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D40"" Value=""" & Replace(Range("D40").Value, """", "``") & """  /)))"
    End If

    If Range("E40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E40"" Value=""" & Replace(Range("E40").Value, """", "``") & """  /)))"
    End If

    If Range("F40").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F40"" Value=""" & Replace(Range("F40").Value, """", "``") & """  /)))"
    End If

    If Range("A41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A41"" Value=""" & Replace(Range("A41").Value, """", "``") & """  /)))"
    End If

    If Range("B41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B41"" Value=""" & Replace(Range("B41").Value, """", "``") & """  /)))"
    End If

    If Range("C41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C41"" Value=""" & Replace(Range("C41").Value, """", "``") & """  /)))"
    End If

    If Range("D41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D41"" Value=""" & Replace(Range("D41").Value, """", "``") & """  /)))"
    End If

    If Range("E41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E41"" Value=""" & Replace(Range("E41").Value, """", "``") & """  /)))"
    End If

    If Range("F41").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F41"" Value=""" & Replace(Range("F41").Value, """", "``") & """  /)))"
    End If

    If Range("A42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A42"" Value=""" & Replace(Range("A42").Value, """", "``") & """  /)))"
    End If

    If Range("B42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B42"" Value=""" & Replace(Range("B42").Value, """", "``") & """  /)))"
    End If

    If Range("C42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C42"" Value=""" & Replace(Range("C42").Value, """", "``") & """  /)))"
    End If

    If Range("D42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D42"" Value=""" & Replace(Range("D42").Value, """", "``") & """  /)))"
    End If

    If Range("E42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E42"" Value=""" & Replace(Range("E42").Value, """", "``") & """  /)))"
    End If

    If Range("F42").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F42"" Value=""" & Replace(Range("F42").Value, """", "``") & """  /)))"
    End If

    If Range("A43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A43"" Value=""" & Replace(Range("A43").Value, """", "``") & """  /)))"
    End If

    If Range("B43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B43"" Value=""" & Replace(Range("B43").Value, """", "``") & """  /)))"
    End If

    If Range("C43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C43"" Value=""" & Replace(Range("C43").Value, """", "``") & """  /)))"
    End If

    If Range("D43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D43"" Value=""" & Replace(Range("D43").Value, """", "``") & """  /)))"
    End If

    If Range("E43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E43"" Value=""" & Replace(Range("E43").Value, """", "``") & """  /)))"
    End If

    If Range("F43").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F43"" Value=""" & Replace(Range("F43").Value, """", "``") & """  /)))"
    End If

    If Range("A44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A44"" Value=""" & Replace(Range("A44").Value, """", "``") & """  /)))"
    End If

    If Range("B44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B44"" Value=""" & Replace(Range("B44").Value, """", "``") & """  /)))"
    End If

    If Range("C44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C44"" Value=""" & Replace(Range("C44").Value, """", "``") & """  /)))"
    End If

    If Range("D44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D44"" Value=""" & Replace(Range("D44").Value, """", "``") & """  /)))"
    End If

    If Range("E44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E44"" Value=""" & Replace(Range("E44").Value, """", "``") & """  /)))"
    End If

    If Range("F44").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F44"" Value=""" & Replace(Range("F44").Value, """", "``") & """  /)))"
    End If

    If Range("A45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A45"" Value=""" & Replace(Range("A45").Value, """", "``") & """  /)))"
    End If

    If Range("B45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B45"" Value=""" & Replace(Range("B45").Value, """", "``") & """  /)))"
    End If

    If Range("C45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C45"" Value=""" & Replace(Range("C45").Value, """", "``") & """  /)))"
    End If

    If Range("D45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D45"" Value=""" & Replace(Range("D45").Value, """", "``") & """  /)))"
    End If

    If Range("E45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E45"" Value=""" & Replace(Range("E45").Value, """", "``") & """  /)))"
    End If

    If Range("F45").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F45"" Value=""" & Replace(Range("F45").Value, """", "``") & """  /)))"
    End If

    If Range("A46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A46"" Value=""" & Replace(Range("A46").Value, """", "``") & """  /)))"
    End If


    BuildXML0 = strXML
End Function
Public Function BuildXML1()
    Dim strXML As String
    If Range("B46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B46"" Value=""" & Replace(Range("B46").Value, """", "``") & """  /)))"
    End If

    If Range("C46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C46"" Value=""" & Replace(Range("C46").Value, """", "``") & """  /)))"
    End If

    If Range("D46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D46"" Value=""" & Replace(Range("D46").Value, """", "``") & """  /)))"
    End If

    If Range("E46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E46"" Value=""" & Replace(Range("E46").Value, """", "``") & """  /)))"
    End If

    If Range("F46").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F46"" Value=""" & Replace(Range("F46").Value, """", "``") & """  /)))"
    End If

    If Range("A47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A47"" Value=""" & Replace(Range("A47").Value, """", "``") & """  /)))"
    End If

    If Range("B47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B47"" Value=""" & Replace(Range("B47").Value, """", "``") & """  /)))"
    End If

    If Range("C47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C47"" Value=""" & Replace(Range("C47").Value, """", "``") & """  /)))"
    End If

    If Range("D47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D47"" Value=""" & Replace(Range("D47").Value, """", "``") & """  /)))"
    End If

    If Range("E47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E47"" Value=""" & Replace(Range("E47").Value, """", "``") & """  /)))"
    End If

    If Range("F47").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F47"" Value=""" & Replace(Range("F47").Value, """", "``") & """  /)))"
    End If

    If Range("A48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A48"" Value=""" & Replace(Range("A48").Value, """", "``") & """  /)))"
    End If

    If Range("B48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B48"" Value=""" & Replace(Range("B48").Value, """", "``") & """  /)))"
    End If

    If Range("C48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C48"" Value=""" & Replace(Range("C48").Value, """", "``") & """  /)))"
    End If

    If Range("D48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D48"" Value=""" & Replace(Range("D48").Value, """", "``") & """  /)))"
    End If

    If Range("E48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E48"" Value=""" & Replace(Range("E48").Value, """", "``") & """  /)))"
    End If

    If Range("F48").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F48"" Value=""" & Replace(Range("F48").Value, """", "``") & """  /)))"
    End If

    If Range("A49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A49"" Value=""" & Replace(Range("A49").Value, """", "``") & """  /)))"
    End If

    If Range("B49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B49"" Value=""" & Replace(Range("B49").Value, """", "``") & """  /)))"
    End If

    If Range("C49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C49"" Value=""" & Replace(Range("C49").Value, """", "``") & """  /)))"
    End If

    If Range("D49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D49"" Value=""" & Replace(Range("D49").Value, """", "``") & """  /)))"
    End If

    If Range("E49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E49"" Value=""" & Replace(Range("E49").Value, """", "``") & """  /)))"
    End If

    If Range("F49").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F49"" Value=""" & Replace(Range("F49").Value, """", "``") & """  /)))"
    End If

    If Range("A50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A50"" Value=""" & Replace(Range("A50").Value, """", "``") & """  /)))"
    End If

    If Range("B50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""B50"" Value=""" & Replace(Range("B50").Value, """", "``") & """  /)))"
    End If

    If Range("C50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C50"" Value=""" & Replace(Range("C50").Value, """", "``") & """  /)))"
    End If

    If Range("D50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""D50"" Value=""" & Replace(Range("D50").Value, """", "``") & """  /)))"
    End If

    If Range("E50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""E50"" Value=""" & Replace(Range("E50").Value, """", "``") & """  /)))"
    End If

    If Range("F50").Value <> "" Then
        strXML = strXML & "(((CellData Col=""F50"" Value=""" & Replace(Range("F50").Value, """", "``") & """  /)))"
    End If

    If Range("A59").Value <> "" Then
        strXML = strXML & "(((CellData Col=""A59"" Value=""" & Replace(Range("A59").Value, """", "``") & """  /)))"
    End If

    If Range("C59").Value <> "" Then
        strXML = strXML & "(((CellData Col=""C59"" Value=""" & Replace(Range("C59").Value, """", "``") & """  /)))"
    End If

    strXML = strXML & "(((/Sheet)))"
    strXML = strXML & "(((/Report)))"
    BuildXML1 = strXML
End Function
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim NewRwHt As Single
    Dim cWdth As Single, MrgeWdth As Single
    Dim c As Range, cc As Range
    Dim ma As Range

    With Target
        If .MergeCells And .WrapText Then
            
            Dim actualHeight As Single
            actualHeight = .RowHeight
            
            Set c = Target.Cells(1, 1)
            cWdth = c.ColumnWidth
            Set ma = c.MergeArea
            For Each cc In ma.Cells
                MrgeWdth = MrgeWdth + cc.ColumnWidth
            Next
            Application.ScreenUpdating = False
            ma.MergeCells = False
            c.ColumnWidth = MrgeWdth
            c.EntireRow.AutoFit
            NewRwHt = c.RowHeight
            ma.MergeCells = True
            If actualHeight < NewRwHt Then
                c.ColumnWidth = cWdth
                ma.RowHeight = NewRwHt
            Else
                c.ColumnWidth = cWdth
                ma.RowHeight = actualHeight
            End If
            cWdth = 0: MrgeWdth = 0
            Application.ScreenUpdating = True
        End If
    End With

End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub ChangeCellType(i As Integer, j As Integer)
Dim NewRwHt As Single
Dim cWdth As Single, MrgeWdth As Single
Dim c As Range, cc As Range
Dim ma As Range
Dim Target As Range
With ActiveSheet.Range(ActiveSheet.Cells(i, j), ActiveSheet.Cells(i, j))
If .MergeCells And .WrapText And Not .Cells.Locked And .Value <> "" Then
Dim actualHeight As Single
actualHeight = .RowHeight
Set c = .Cells(1, 1)
cWdth = c.ColumnWidth
Set ma = c.MergeArea
For Each cc In ma.Cells
MrgeWdth = MrgeWdth + cc.ColumnWidth
Next
Application.ScreenUpdating = False
ma.MergeCells = False
c.ColumnWidth = MrgeWdth
c.EntireRow.AutoFit
NewRwHt = c.RowHeight
ma.MergeCells = True
If actualHeight < NewRwHt Then
c.ColumnWidth = cWdth
ma.RowHeight = NewRwHt
Else
c.ColumnWidth = cWdth
ma.RowHeight = actualHeight
End If
cWdth = 0: MrgeWdth = 0
Application.ScreenUpdating = True
 End If
End With
End Sub
Private Sub Workbook_BeforeClose(Cancel As Boolean)
Application.DisplayAlerts = False
Application.DefaultSaveFormat = 56
ActiveWorkbook.Saved = True
End Sub




Private Sub Workbook_Open()
Dim i As Integer
Dim j As Integer
For i = 1 To 70
For j = 1 To 70
Call ChangeCellType(i, j)
Next
Next
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
On Error GoTo ErrorTrap

    If Range("DD14").Value = "Initiated" Then
    
        Dim blnProcessComplete As Boolean
        blnProcessComplete = SaveReportData
        If Not blnProcessComplete Then
            MsgBox "Data not saved", vbCritical, "Error with SaveReportData"
            Exit Sub
        End If
        SaveAsUI = False
        Range("DD14").Value = "Records Saved"
        ActiveWorkbook.Close
        Application.Quit
    End If
    
    If Not Range("DD4").Comment Is Nothing Then
        Range("DD14").Value = "Initiated"
    End If
    
    
    Exit Sub
ErrorTrap:
    Exit Sub
End Sub


INQUEST-PP=macro
