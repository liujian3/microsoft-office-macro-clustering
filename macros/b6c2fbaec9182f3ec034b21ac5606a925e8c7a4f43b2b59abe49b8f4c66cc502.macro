Attribute VB_Name = "ConsolidationData"
Attribute VB_Base = "0{C67E68BC-8FFE-4A34-AA6A-E2EFA650690B}{2045DCBC-7348-4CF6-BF26-B393CF80EB1C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Public ArrFiles As Variant
Private Sub UserForm_Initialize()
If ConsolidationData.ListBox1.ListCount <> 0 Then
    For i = ConsolidationData.ListBox1.ListCount - 1 To 0 Step -1
            ListBox1.RemoveItem i
    Next i
End If
End Sub
Private Sub CommandButton1_Click()
Dim name_file As String
        ArrFiles = Application.GetOpenFilename("Excel Files(*.*),*.*", , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", , True)
        
        If IsArray(ArrFiles) Then
                For i = 1 To UBound(ArrFiles)
                    name_file = Right(ArrFiles(i), Len(ArrFiles(i)) - InStrRev(ArrFiles(i), "\"))
                    ConsolidationData.ListBox1.AddItem (CStr(i) & ". " & name_file & ";")
                Next i
                Exit Sub
        Else
                If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ?", vbOKCancel) = vbOK Then Unload ConsolidationData
        End If

End Sub

Private Sub CommandButton2_Click()
Dim main_book As String
Dim book_name As String
Dim sheet_name As String
Dim wsh As Worksheet
Dim num_row As Long
Dim num_col As Long
Dim ArrData() As Variant
Dim ArrAllData() As Variant
Dim group As Integer
Dim date_ex As Integer
Dim region As Integer
Dim inf_source As Integer
Dim fio_inf_source As Integer
Dim error_source As Integer
Dim type_error As Integer
Dim discription_error As Integer
Dim accountant_error As Integer
Dim accountant_resp As Integer
Dim time_execution As Integer
Dim remove_error As Integer
Dim result As Integer
Dim repercussion As Integer
Dim events As Integer

Application.ScreenUpdating = False
Application.AskToUpdateLinks = False
Application.DisplayAlerts = False


main_book = ActiveWorkbook.Name

For i = 1 To UBound(ArrFiles)
    Workbooks.Open ArrFiles(i), False
    book_name = ActiveWorkbook.Name
    Workbooks(book_name).Sheets(1).Select
    sheet_name = ActiveSheet.Name
    Set wsh = Workbooks(book_name).Sheets(sheet_name)
    If wsh.AutoFilterMode = True Then wsh.AutoFilterMode = False
    
    num_row = wsh.Cells(Rows.count, 2).End(xlUp).Row
    num_col = wsh.Cells(1, Columns.count).End(xlToLeft).Column
    
    ReDim ArrData(1 To num_row, 1 To num_col)
    ArrData = wsh.Range(wsh.Cells(1, 1), wsh.Cells(num_row, num_col)).Value
    fir = InStr(1, book_name, "_") + 1
    sec = InStr(fir, book_name, "_") + 1
    str1 = Mid(book_name, fir, sec - fir - 1)
            
    If i <> 1 Then
        num = UBound(ArrAllData, 2)
        ReDim Preserve ArrAllData(1 To UBound(ArrAllData, 1), 1 To (num + num_row - 2))
        
        For k = 3 To num_row
            ArrAllData(1, num + k - 2) = str1
            For j = LBound(ArrAllData, 1) To UBound(ArrAllData, 1) - 1
                ArrAllData(j + 1, num + k - 2) = ArrData(k, j)
            Next j
        Next k
    End If
    
    If i = 1 Then
    '----------------------------------------------------------------------------------------------------------
        
    ReDim ArrAllData(1 To UBound(ArrData, 2) + 1, 1 To num_row)
    
    For k = 1 To num_row
        ArrAllData(1, k) = str1
        For j = 1 To num_col
            ArrAllData(j + 1, k) = ArrData(k, j)
        Next j
    Next k
        
    '---------------------------------------------------------------------------------------------------------
    End If
    
Workbooks(book_name).Close False
Next i
Dim wsh1 As Worksheet
Dim SheetExist As Boolean
Dim new_sheet As String

new_sheet = "|fffd||fffd||fffd||fffd| |fffd||fffd| " & CStr(MonthName(number_month))

For Each wsh1 In Workbooks(main_book).Sheets
  If new_sheet = wsh1.Name Then
            SheetExist = True
            Exit For
        End If
Next wsh1
    
If SheetExist = True Then
        Application.DisplayAlerts = False
        Workbooks(main_book).Worksheets(new_sheet).Delete
        Application.DisplayAlerts = True
        Set wsh1 = Workbooks(main_book).Worksheets.Add
        wsh1.Move After:=Worksheets(Worksheets.count)
        wsh1.Name = new_sheet
        
        
End If
    
If SheetExist = False Then
        Set wsh1 = Workbooks(main_book).Worksheets.Add
        wsh1.Move After:=Worksheets(Worksheets.count)
        wsh1.Name = new_sheet
End If

Dim ArrAllDataTr As Variant
ReDim ArrAllDataTr(1 To UBound(ArrAllData, 2), 1 To UBound(ArrAllData, 1))

For i = 1 To UBound(ArrAllData, 2)
    For j = 1 To UBound(ArrAllData, 1)
        ArrAllDataTr(i, j) = ArrAllData(j, i)
    Next j
Next i
ArrAllDataTr(1, 1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
ArrAllDataTr(2, 1) = 0
Dim tra As Variant

Dim oDict: Set oDict = CreateObject("Scripting.Dictionary")

oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|.,|fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd|.|fffd|.)"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd|"
oDict.Item("C|fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
oDict.Item("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"


For i = 3 To UBound(ArrAllData, 2)
    tra = CStr(ArrAllDataTr(i, 2))
    If oDict.Exists(tra) = True Then
        ArrAllDataTr(i, 2) = oDict.Item(tra)
    End If
Next i

For i = 3 To UBound(ArrAllDataTr, 1)
    If Mid(ArrAllDataTr(i, 3), 4, 2) <> number_month Then
       ArrAllDataTr(i, 2) = ""
    End If
Next i

wsh1.Range(wsh1.Cells(1, 1), wsh1.Cells(UBound(ArrAllData, 2), UBound(ArrAllData, 1))) = ArrAllDataTr

For i = UBound(ArrAllData, 2) To 3 Step -1
    If ArrAllDataTr(i, 2) = "" Then
        wsh1.Rows(i).Delete
    End If
Next i

If ArrAllDataTr(2, 1) = 0 Or ArrAllDataTr(2, 1) = "" Then
    wsh1.Rows(2).Delete
End If


ConsolidationData.Hide

'num_col = num_col + 1

'wsh1.Cells(1, num_col) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|*"
num_row = wsh1.Cells(wsh1.Rows.count, 1).End(xlUp).Row

Dim rg As Range

Set rg = wsh1.Range(wsh1.Cells(1, 1), wsh1.Cells(num_row, UBound(ArrAllData, 1)))

With rg
        .Font.Size = 10
        .Font.Strikethrough = False
        .Font.Superscript = False
        .Font.Subscript = False
        .Font.OutlineFont = False
        .Font.Shadow = False
        .Font.Underline = xlUnderlineStyleNone
        .Font.ThemeColor = xlThemeColorLight1
        .Font.TintAndShade = 0

        .Borders(xlDiagonalDown).LineStyle = xlNone
        .Borders(xlDiagonalUp).LineStyle = xlNone
        .Borders(xlEdgeLeft).LineStyle = xlContinuous
        .Borders(xlEdgeLeft).ColorIndex = 0
        .Borders(xlEdgeLeft).TintAndShade = 0
        .Borders(xlEdgeLeft).Weight = xlThin

         .Borders(xlEdgeTop).LineStyle = xlContinuous
        .Borders(xlEdgeTop).ColorIndex = 0
        .Borders(xlEdgeTop).TintAndShade = 0
        .Borders(xlEdgeTop).Weight = xlThin

        .Borders(xlEdgeBottom).LineStyle = xlContinuous
        .Borders(xlEdgeBottom).ColorIndex = 0
        .Borders(xlEdgeBottom).TintAndShade = 0
        .Borders(xlEdgeBottom).Weight = xlThin '

        .Borders(xlEdgeRight).LineStyle = xlContinuous
        .Borders(xlEdgeRight).ColorIndex = 0
        .Borders(xlEdgeRight).TintAndShade = 0
        .Borders(xlEdgeRight).Weight = xlThin

        .Borders(xlInsideVertical).LineStyle = xlContinuous
        .Borders(xlInsideVertical).ColorIndex = 0
        .Borders(xlInsideVertical).TintAndShade = 0
        .Borders(xlInsideVertical).Weight = xlThin

        .Borders(xlInsideHorizontal).LineStyle = xlContinuous
        .Borders(xlInsideHorizontal).ColorIndex = 0
        .Borders(xlInsideHorizontal).TintAndShade = 0
        .Borders(xlInsideHorizontal).Weight = xlThin

        .HorizontalAlignment = xlGeneral
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    
Set rg = wsh1.Range(wsh1.Cells(1, 1), wsh1.Cells(1, UBound(ArrAllData, 1)))

    With rg
            .Font.Bold = True
            .HorizontalAlignment = xlCenter
            .VerticalAlignment = xlCenter
            .WrapText = True
            .Orientation = 0
            .AddIndent = False
            .IndentLevel = 0
            .ShrinkToFit = False
            .ReadingOrder = xlContext
            .MergeCells = False
            .Interior.Pattern = xlSolid
            .Interior.PatternColorIndex = xlAutomatic
            .Interior.ThemeColor = xlThemeColorAccent5
            .Interior.TintAndShade = 0.599993896298105
            .Interior.PatternTintAndShade = 0
    End With
    
    wsh1.Columns("A:A").ColumnWidth = 15
    wsh1.Columns("B:B").ColumnWidth = 25
    wsh1.Columns("C:C").ColumnWidth = 13
    wsh1.Columns("D:D").ColumnWidth = 9
    wsh1.Columns("E:H").ColumnWidth = 16
    wsh1.Columns("I:I").ColumnWidth = 12
    wsh1.Columns("J:L").ColumnWidth = 11
    wsh1.Columns("M:M").ColumnWidth = 20
    wsh1.Columns("N:N").ColumnWidth = 10
    wsh1.Columns("O:O").ColumnWidth = 25
    wsh1.Columns("P:Q").ColumnWidth = 14
    wsh1.Columns("R:R").ColumnWidth = 16
    wsh1.Columns("S:S").ColumnWidth = 17
    wsh1.Columns("T:T").ColumnWidth = 13
    wsh1.Columns("U:U").ColumnWidth = 14
    wsh1.Columns("V:V").ColumnWidth = 18
    
    wsh1.Rows("1:" & num_row).EntireRow.AutoFit
    
    If wsh1.Cells(2, 1).Value = 1 Then wsh1.Rows(2).Delete
    
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|!"

Application.ScreenUpdating = True
Application.AskToUpdateLinks = True
Application.DisplayAlerts = True

End Sub

Private Sub UserForm_Terminate()
End
End Sub
Attribute VB_Name = "CopySheet"
Attribute VB_Base = "0{392EBA3B-5F05-4FBD-BD9A-96C8F7418E88}{F9C092A5-56B4-4656-BBB0-15F8DD11E7DF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Activate()
CopySheet.CommandButton1.Enabled = False
End Sub
Private Sub CommandButton1_Click()
Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim str_sheet As String
Dim wsh As Worksheet
Dim SheetExists As Boolean
Dim e_style As Excel.Style
    str_sheet = CopySheet.ListBox1.Value
    
   ' If Workbooks(copy_book).Sheets(str_sheet).Columns.EntireColumn.Hidden = True Then
   '     Workbooks(copy_book).Sheets(str_sheet).Columns.EntireColumn.Hidden = False
   ' End If
    If Workbooks(copy_book).Sheets(str_sheet).AutoFilterMode = True Then _
        Workbooks(copy_book).Sheets(str_sheet).AutoFilterMode = False
    
    SheetExists = False
    For Each wsh In Workbooks(main_book).Sheets
        If str_sheet = wsh.Name Then
            SheetExists = True
            Exit For
        End If
    Next wsh
    
    If SheetExists = True Then
        Application.DisplayAlerts = False
        Workbooks(main_book).Worksheets(str_sheet).Delete
        Application.DisplayAlerts = True
        SheetExists = False
    End If
    
    Workbooks(copy_book).Sheets(str_sheet).Unprotect
    
    Workbooks(copy_book).Sheets(str_sheet).Select
    
    Workbooks(copy_book).Sheets(str_sheet).UsedRange.Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
     
    If SheetExists = False Then
        If Workbooks(copy_book).Styles.count > 15 Then
            GoTo Errors1
        Else
            On Error GoTo Errors1
            Workbooks(copy_book).Sheets(str_sheet).Copy _
                After:=Workbooks(main_book).Worksheets(Workbooks(main_book).Worksheets.count):
        End If
    End If
    
    Application.DisplayAlerts = False
    Workbooks(copy_book).Close (False)
    Application.DisplayAlerts = True
    
    Workbooks(main_book).Sheets(str_sheet).Select
    CopySheet.Hide
    CopySheet.ListBox1.Clear
    GoTo Ends

Errors1:
    Dim ArrValue() As Variant
    Workbooks(main_book).Sheets.Add.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    ArrValue = Workbooks(copy_book).Sheets(str_sheet).UsedRange.Value
    Application.DisplayAlerts = False
    Workbooks(copy_book).Close (False)
    Application.DisplayAlerts = True
    
    Workbooks(main_book).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Workbooks(main_book).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Range _
        (Cells(1, 1), _
        Cells(UBound(ArrValue, 1), UBound(ArrValue, 2))) = ArrValue

    
    Workbooks(main_book).Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    CopySheet.Hide
    CopySheet.ListBox1.Clear
    
Ends:
Application.ScreenUpdating = True
Application.DisplayAlerts = True

End Sub

Private Sub ListBox1_Change()
If CopySheet.ListBox1.Value <> "" Then
CopySheet.CommandButton1.Enabled = True
Else
CopySheet.CommandButton1.Enabled = False
End If
End Sub

Private Sub UserForm_Initialize()
CopySheet.BackColor = RGB(198, 213, 236)
CopySheet.Label1.BackColor = RGB(198, 213, 236)
CopySheet.CommandButton1.BackColor = RGB(162, 186, 223)
End Sub

Private Sub UserForm_Terminate()
Dim wb As Workbook
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For Each wb In Workbooks
    If wb.Name <> ThisWorkbook.Name Then
        wb.Close False
    End If
Next wb
End
End Sub
Attribute VB_Name = "DetermineDate"
Attribute VB_Base = "0{DF90A046-8587-44EF-9481-2270EAFE3EB3}{E4A05807-B254-4122-A1DB-8DF4F104EA7F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()

    If DetermineDate.ComboBox1.Value <> "" And DetermineDate.ComboBox2.Value <> "" And _
        DetermineDate.ComboBox3.Value <> "" And _
        DetermineDate.ComboBox4.Value <> "" And _
        DetermineDate.ComboBox5.Value <> "" And _
        DetermineDate.ComboBox6.Value <> "" And _
        DetermineDate.ComboBox7.Value <> "" And _
        DetermineDate.ComboBox8.Value <> "" And _
        DetermineDate.ComboBox9.Value <> "" And _
        DetermineDate.ComboBox10.Value <> "" And _
        DetermineDate.ComboBox11.Value <> "" And _
        DetermineDate.ComboBox12.Value <> "" And _
        DetermineDate.ComboBox13.Value <> "" And _
        DetermineDate.ComboBox14.Value <> "" And _
        DetermineDate.ComboBox15.Value <> "" And _
        DetermineDate.TextBox4.Value <> "" And _
        DetermineDate.TextBox5.Value <> "" And _
        DetermineDate.TextBox6.Value <> "" And _
        DetermineDate.TextBox7.Value <> "" And _
        DetermineDate.TextBox8.Value <> "" And _
        DetermineDate.TextBox9.Value <> "" And _
        DetermineDate.TextBox10.Value <> "" And _
        DetermineDate.TextBox11.Value <> "" And _
        DetermineDate.TextBox12.Value <> "" And _
        DetermineDate.TextBox13.Value <> "" Then
        
        
        If InStr(1, ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1).Value, "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) = 0 Then
st:
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Rows(1).Insert

            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 1) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 3) = "DeadLine"
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 5) = "DeadLine For Bank"
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 7) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 9) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
            
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 2) = CDate(DetermineDate.ComboBox1.Value & "." _
                & DetermineDate.ComboBox2.Value & "." _
                & DetermineDate.ComboBox5.Value & " " & DetermineDate.TextBox11.Value & ":" & DetermineDate.TextBox13.Value & ":00")
                '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 4) = CDate(DetermineDate.ComboBox3.Value & "." _
                & DetermineDate.ComboBox4.Value & "." _
                & DetermineDate.ComboBox6.Value & " " & DetermineDate.TextBox12.Value & ":" & DetermineDate.TextBox4.Value & ":00")
                'Deadline
                
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 6) = CDate(DetermineDate.ComboBox7.Value & "." _
                & DetermineDate.ComboBox8.Value & "." _
                & DetermineDate.ComboBox9.Value & " " & DetermineDate.TextBox5.Value & ":" & DetermineDate.TextBox6.Value & ":00")
                'Deadline for bank
                
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 8) = CDate(DetermineDate.ComboBox10.Value & "." _
                & DetermineDate.ComboBox11.Value & "." _
                & DetermineDate.ComboBox12.Value & " " & DetermineDate.TextBox7.Value & ":" & DetermineDate.TextBox8.Value & ":00")
                '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, 10) = CDate(DetermineDate.ComboBox13.Value & "." _
                & DetermineDate.ComboBox14.Value & "." _
                & DetermineDate.ComboBox15.Value & " " & DetermineDate.TextBox9.Value & ":" & DetermineDate.TextBox10.Value & ":00")
                '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Else
            ActiveWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Rows(1).Delete
            GoTo st
        End If
        
        DetermineDate.Hide
    Else
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!")
    End If
End Sub

Private Sub UserForm_Activate()
    'CommandButton1.Enabled = False
    DetermineDate.ComboBox1.Clear
    DetermineDate.ComboBox2.Clear
    DetermineDate.ComboBox3.Clear
    DetermineDate.ComboBox4.Clear
    DetermineDate.ComboBox5.Clear
    DetermineDate.ComboBox6.Clear
    DetermineDate.ComboBox7.Clear
    DetermineDate.ComboBox8.Clear
    DetermineDate.ComboBox9.Clear
    DetermineDate.ComboBox10.Clear
    DetermineDate.ComboBox11.Clear
    DetermineDate.ComboBox12.Clear
    DetermineDate.ComboBox13.Clear
    DetermineDate.ComboBox14.Clear
    DetermineDate.ComboBox15.Clear
    DetermineDate.TextBox4.Value = ""
    DetermineDate.TextBox5.Value = ""
    DetermineDate.TextBox6.Value = ""
    DetermineDate.TextBox7.Value = ""
    DetermineDate.TextBox8.Value = ""
    DetermineDate.TextBox9.Value = ""
    DetermineDate.TextBox10.Value = ""
    DetermineDate.TextBox11.Value = ""
    DetermineDate.TextBox12.Value = ""
    DetermineDate.TextBox13.Value = ""
    
    For i = 0 To 30
        DetermineDate.ComboBox1.AddItem CStr(i + 1), i
        DetermineDate.ComboBox3.AddItem CStr(i + 1), i
        DetermineDate.ComboBox7.AddItem CStr(i + 1), i
        DetermineDate.ComboBox10.AddItem CStr(i + 1), i
        DetermineDate.ComboBox15.AddItem CStr(i + 1), i
    Next i
    
    For i = 0 To 11
        DetermineDate.ComboBox2.AddItem MonthName(i + 1), i
        DetermineDate.ComboBox4.AddItem MonthName(i + 1), i
        DetermineDate.ComboBox11.AddItem MonthName(i + 1), i
        DetermineDate.ComboBox8.AddItem MonthName(i + 1), i
        DetermineDate.ComboBox14.AddItem MonthName(i + 1), i
    Next i
    
    For i = Year(Date) - 1 To Year(Date) + 1
        DetermineDate.ComboBox5.AddItem CStr(i)
        DetermineDate.ComboBox6.AddItem CStr(i)
        DetermineDate.ComboBox9.AddItem CStr(i)
        DetermineDate.ComboBox12.AddItem CStr(i)
        DetermineDate.ComboBox13.AddItem CStr(i)
    Next i
    
    DetermineDate.TextBox4.Value = "59"
    DetermineDate.TextBox5.Value = "23"
    DetermineDate.TextBox6.Value = "59"
    DetermineDate.TextBox7.Value = "16"
    DetermineDate.TextBox8.Value = "00"
    DetermineDate.TextBox9.Value = "23"
    DetermineDate.TextBox10.Value = "59"
    DetermineDate.TextBox11.Value = "23"
    DetermineDate.TextBox12.Value = "23"
    DetermineDate.TextBox13.Value = "59"

    
End Sub

Private Sub UserForm_Initialize()
    DetermineDate.BackColor = RGB(198, 213, 236)
    DetermineDate.Label1.BackColor = RGB(198, 213, 236)
    DetermineDate.Label2.BackColor = RGB(198, 213, 236)
    DetermineDate.Label3.BackColor = RGB(198, 213, 236)
    DetermineDate.Label4.BackColor = RGB(198, 213, 236)
    DetermineDate.Label5.BackColor = RGB(198, 213, 236)
    DetermineDate.Label6.BackColor = RGB(198, 213, 236)
    DetermineDate.Label7.BackColor = RGB(198, 213, 236)
    DetermineDate.Label8.BackColor = RGB(198, 213, 236)
    DetermineDate.Label9.BackColor = RGB(198, 213, 236)
    DetermineDate.Label10.BackColor = RGB(198, 213, 236)
    DetermineDate.Label11.BackColor = RGB(198, 213, 236)
    DetermineDate.Label12.BackColor = RGB(198, 213, 236)
    DetermineDate.Label13.BackColor = RGB(198, 213, 236)
    DetermineDate.Label14.BackColor = RGB(198, 213, 236)
    DetermineDate.Label15.BackColor = RGB(198, 213, 236)
    DetermineDate.CommandButton1.BackColor = RGB(162, 186, 223)
End Sub
Private Sub TextBox4_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox4_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox5_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox5_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox6_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox6_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox7_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox7_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox8_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox8_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox9_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox9_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox10_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox10_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox11_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox11_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox12_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox12_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub
Private Sub TextBox13_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii < 48 Or KeyAscii > 57 Then
       KeyAscii = 0
    End If
End Sub

'Private Sub TextBox13_KeyPress(ByVal KeyAscii As DetermineDate.ReturnInteger)
'    If KeyAscii < 48 Or KeyAscii > 57 Then KeyAscii = 0
'End Sub

Private Sub UserForm_Terminate()
End
End Sub
Attribute VB_Name = "GeneralForm"
Attribute VB_Base = "0{B8D6A68B-9A10-48FE-87DA-61DA09FB2C06}{C64C1998-5F8F-45DC-9958-FF7AE733D79E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox1_Change()
If GeneralForm.CheckBox1.Value = True Then
    GeneralForm.CheckBox2.Value = False
    GeneralForm.CheckBox3.Value = False
    GeneralForm.CheckBox4.Value = False
End If
If GeneralForm.CheckBox1.Value = True Or _
    GeneralForm.CheckBox2.Value = True Or _
    GeneralForm.CheckBox3.Value = True Or _
    GeneralForm.CheckBox4.Value = True Then
    GeneralForm.CommandButton1.Enabled = True
Else
    GeneralForm.CommandButton1.Enabled = False
End If
End Sub
Private Sub CheckBox2_Change()
If GeneralForm.CheckBox2.Value = True Then
    GeneralForm.CheckBox1.Value = False
    GeneralForm.CheckBox3.Value = False
    GeneralForm.CheckBox4.Value = False
End If
If GeneralForm.CheckBox1.Value = True Or _
    GeneralForm.CheckBox2.Value = True Or _
    GeneralForm.CheckBox3.Value = True Or _
    GeneralForm.CheckBox4.Value = True Then
    GeneralForm.CommandButton1.Enabled = True
Else
    GeneralForm.CommandButton1.Enabled = False
End If
End Sub


Private Sub CheckBox3_Change()
If GeneralForm.CheckBox3.Value = True Then
    GeneralForm.CheckBox2.Value = False
    GeneralForm.CheckBox1.Value = False
    GeneralForm.CheckBox4.Value = False
End If
If GeneralForm.CheckBox1.Value = True Or _
    GeneralForm.CheckBox2.Value = True Or _
    GeneralForm.CheckBox3.Value = True Or _
    GeneralForm.CheckBox4.Value = True Then
    GeneralForm.CommandButton1.Enabled = True
Else
    GeneralForm.CommandButton1.Enabled = False
End If
End Sub
Private Sub CheckBox4_Change()
If GeneralForm.CheckBox4.Value = True Then
    GeneralForm.CheckBox2.Value = False
    GeneralForm.CheckBox3.Value = False
    GeneralForm.CheckBox1.Value = False
End If
If GeneralForm.CheckBox1.Value = True Or _
    GeneralForm.CheckBox2.Value = True Or _
    GeneralForm.CheckBox3.Value = True Or _
    GeneralForm.CheckBox4.Value = True Then
    GeneralForm.CommandButton1.Enabled = True
Else
    GeneralForm.CommandButton1.Enabled = False
End If
End Sub

Private Sub CommandButton1_Click()
Dim wsh As Worksheet

For Each wsh In Workbooks(general_book).Sheets
    If InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd|", vbTextCompare) = 0 And InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) = 0 Then
        Application.DisplayAlerts = False
            wsh.Delete
        Application.DisplayAlerts = True
    End If
Next wsh

For Each wsh In Workbooks(general_book).Sheets
    If wsh.Name <> "|fffd||fffd||fffd||fffd||fffd|" And InStr(1, wsh.Name, "c|fffd||fffd||fffd||fffd|", vbTextCompare) <> 0 And wsh.Visible = xlSheetVisible Then
        wsh.Visible = xlSheetHidden
    End If
Next wsh

If GeneralForm.CheckBox1.Value = True Then
    GeneralForm.Hide
     For Each wsh In Workbooks(general_book).Sheets
        If InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) <> 0 Then
            If wsh.Visible = xlSheetHidden Then
                wsh.Visible = xlSheetVisible
            End If
            wsh.Select
        Else
            If wsh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
                wsh.Visible = xlSheetHidden
            End If
        End If
     Next wsh
End If
If GeneralForm.CheckBox2.Value = True Then
GeneralForm.Hide
     For Each wsh In Workbooks(general_book).Sheets
        If InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) <> 0 And wsh.Visible = xlSheetHidden Then
            If wsh.Visible = xlSheetHidden Then
                wsh.Visible = xlSheetVisible
            End If
            wsh.Select
        Else
            If wsh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
                wsh.Visible = xlSheetHidden
            End If
        End If
     Next wsh
End If
If GeneralForm.CheckBox3.Value = True Then
    GeneralForm.Hide
     For Each wsh In Workbooks(general_book).Sheets
        If InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) <> 0 And wsh.Visible = xlSheetHidden Then
            If wsh.Visible = xlSheetHidden Then
                wsh.Visible = xlSheetVisible
            End If
            wsh.Select
        Else
            If wsh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
                wsh.Visible = xlSheetHidden
            End If
        End If
     Next wsh
End If

If GeneralForm.CheckBox4.Value = True Then
    GeneralForm.Hide
     For Each wsh In Workbooks(general_book).Sheets
        If InStr(1, wsh.Name, "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbTextCompare) <> 0 And wsh.Visible = xlSheetHidden Then
            If wsh.Visible = xlSheetHidden Then
                wsh.Visible = xlSheetVisible
            End If
            wsh.Select
        Else
            If wsh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
                wsh.Visible = xlSheetHidden
            End If
        End If
     Next wsh
End If

End Sub

Private Sub UserForm_Activate()
GeneralForm.CheckBox1.Value = False
GeneralForm.CheckBox2.Value = False
GeneralForm.CheckBox3.Value = False
GeneralForm.CheckBox4.Value = False

GeneralForm.CommandButton1.Enabled = False
End Sub

Private Sub UserForm_Initialize()
GeneralForm.BackColor = RGB(198, 213, 236)
GeneralForm.Label1.BackColor = RGB(198, 213, 236)
GeneralForm.CheckBox1.BackColor = RGB(198, 213, 236)
GeneralForm.CheckBox2.BackColor = RGB(198, 213, 236)
GeneralForm.CheckBox3.BackColor = RGB(198, 213, 236)
GeneralForm.CheckBox4.BackColor = RGB(198, 213, 236)
GeneralForm.CommandButton1.BackColor = RGB(162, 186, 223)
End Sub

Private Sub UserForm_Terminate()
End
End Sub
Attribute VB_Name = "KillStyles"
Sub KillStyle()
Attribute KillStyle.VB_ProcData.VB_Invoke_Func = " \n14"
t = Timer
Dim wsh As Worksheet

Dim e_style As Style
s = 0

    For Each e_style In ActiveWorkbook.Styles
        If e_style.BuiltIn = True Then
            s = s + 1
        Else
            e_style.Locked = False
            e_style.IncludeProtection = False
            e_style.Delete
            k = k + 1
        End If
    Next e_style

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  " & Timer - t & " |fffd||fffd||fffd|.", vbInformation
End Sub

Attribute VB_Name = "SelectDateForRequest"
Attribute VB_Base = "0{34B0A659-853C-4B7F-9883-530F90F9D11A}{82518112-1589-4B04-8442-1FB7288C8D2B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
    If SelectDateForRequest.ComboBox1.Value <> "" And _
       SelectDateForRequest.ComboBox2.Value <> "" And _
       SelectDateForRequest.ComboBox3.Value <> "" Then
            SelectDateForRequest.Hide
    Else
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    End If
End Sub

Private Sub UserForm_Activate()
    
    SelectDateForRequest.ComboBox1.Clear
    SelectDateForRequest.ComboBox2.Clear
    SelectDateForRequest.ComboBox3.Clear
    
    For i = 0 To 30
        SelectDateForRequest.ComboBox1.AddItem CStr(i + 1), i
    Next i
    
    For i = 0 To 11
        SelectDateForRequest.ComboBox2.AddItem MonthName(i + 1), i
    Next i
    
    For i = Year(Date) - 1 To Year(Date) + 1
        SelectDateForRequest.ComboBox3.AddItem CStr(i)
    Next i
End Sub

Private Sub UserForm_Initialize()
    SelectDateForRequest.BackColor = RGB(198, 213, 236)
    SelectDateForRequest.Label1.BackColor = RGB(198, 213, 236)
    SelectDateForRequest.Label2.BackColor = RGB(198, 213, 236)
    SelectDateForRequest.Label3.BackColor = RGB(198, 213, 236)
    SelectDateForRequest.CommandButton1.BackColor = RGB(162, 186, 223)
End Sub

Private Sub UserForm_Terminate()
    If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbOKCancel) = vbOK Then
        Speed.Ended
        End
    Else
        'SelectDateForRequest.Show
    End If
End Sub
Attribute VB_Name = "SelectMonth"
Attribute VB_Base = "0{7BF2C1E6-35C9-4F10-B269-4B1D5409636F}{34B16D47-7516-4C5B-98BA-CF2D51251A29}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub UserForm_Activate()
For i = 1 To 12
    If i < 10 Then
    SelectMonth.ComboBox1.AddItem ("0" & i)
    Else
    SelectMonth.ComboBox1.AddItem (i)
    End If
Next i
End Sub
Private Sub CommandButton1_Click()
    If SelectMonth.ComboBox1.Value = "" Then
        MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!")
    Else
        number_month = SelectMonth.ComboBox1.Value
        SelectMonth.Hide
        ConsolidationData.Show
    End If
End Sub

Private Sub UserForm_Terminate()
End
End Sub
Attribute VB_Name = "SelectSheet"
Attribute VB_Base = "0{C4C09357-5B83-442B-A03A-E77B4BB3873D}{F65D4E04-43B1-4FE0-B95C-D1F753CBB6FC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Dim str_sheet As String
Dim wsh As Worksheet
Dim SheetExists As Boolean

    str_sheet = SelectSheet.ListBox1.Value

    If Workbooks(select_book).Sheets(str_sheet).ProtectContents = True Then
        Workbooks(select_book).Sheets(str_sheet).Unprotect
    End If
       
    If Workbooks(select_book).Sheets(str_sheet).Columns.EntireColumn.Hidden = True Then
        Workbooks(select_book).Sheets(str_sheet).Columns.EntireColumn.Hidden = False
    End If
        
    If Workbooks(select_book).Sheets(str_sheet).AutoFilterMode = True Then
        Workbooks(select_book).Sheets(str_sheet).AutoFilterMode = False
    End If
    If Workbooks(select_book).Sheets(str_sheet).Visible = 0 Then Workbooks(select_book).Sheets(str_sheet).Visible = -1
    Workbooks(select_book).Sheets(str_sheet).Select
    
    SelectSheet.Hide
    SelectSheet.ListBox1.Clear

End Sub

Private Sub ListBox1_Change()
If SelectSheet.ListBox1.Text <> "" Then
    SelectSheet.CommandButton1.Enabled = True
Else
    CopySheet.CommandButton1.Enabled = False
End If
End Sub

Private Sub UserForm_Activate()
SelectSheet.CommandButton1.Enabled = False
End Sub

Private Sub UserForm_Initialize()
SelectSheet.BackColor = RGB(198, 213, 236)
SelectSheet.Label1.BackColor = RGB(198, 213, 236)
SelectSheet.CommandButton1.BackColor = RGB(162, 186, 223)

End Sub

Private Sub UserForm_Terminate()
Dim wb As Workbook
Dim wsh As Worksheet
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For Each wb In Workbooks
    If wb.Name <> ThisWorkbook.Name Then
        wb.Close False
    End If
Next wb
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
