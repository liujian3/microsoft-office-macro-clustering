Attribute VB_Name = "DataDen"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Public WithEvents DenChang As MSForms.TextBox
Attribute DenChang.VB_VarHelpID = -1
Public WithEvents MecChang As MSForms.TextBox
Attribute MecChang.VB_VarHelpID = -1

Private Sub DenChang_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
'On Error Resume Next
Dim i&, D&
If KeyCode = 37 Then
    With Kalendar
        i = Replace(.ActiveControl.Name, "Dn", "")
        i = IIf(Val(.ActiveControl) < 8, i - Val(.ActiveControl) + 1, i - 7)
        .ActiveControl.BackColor = &H8000000E
        .Controls("Dn" & i).SetFocus
        .Controls("Dn" & i).BackColor = &H80FF80
        .VDat = DateSerial(Year(.VDat), Month(.VDat), .ActiveControl)
    End With
End If
If KeyCode = 39 Then
    With Kalendar
        D = Day(DateSerial(Year(.VDat), Month(.VDat) + 1, 0))
        i = Replace(.ActiveControl.Name, "Dn", "")
        i = IIf(Val(.ActiveControl) > D - 7, i + D - Val(.ActiveControl), i + 7)
        .ActiveControl.BackColor = &H8000000E
        .Controls("Dn" & i).SetFocus
        .Controls("Dn" & i).BackColor = &H80FF80
        .VDat = DateSerial(Year(.VDat), Month(.VDat), .ActiveControl)
    End With
End If
If KeyCode = 38 Or KeyCode = 40 Then
    With Kalendar
        .ActiveControl.BackColor = &H8000000E
    End With
End If

End Sub

Private Sub DenChang_KeyUp(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = 38 Or KeyCode = 40 Then
    With Kalendar
        .ActiveControl.BackColor = &H80FF80
        .VDat = DateSerial(Year(.VDat), Month(.VDat), .ActiveControl)
    End With
End If
End Sub

Private Sub DenChang_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i&
For i = 1 To 37
    Kalendar.Controls("Dn" & i).BackColor = &H8000000E ' - |fffd||fffd||fffd||fffd||fffd|
Next
DenChang.BackColor = &H80FF80 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
With Kalendar
    .VDat = DateSerial(Year(.VDat), Month(.VDat), .ActiveControl)
End With
End Sub


Private Sub MecChang_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i
With Kalendar
    For i = 0 To 11
        .Controls("M" & i).BackColor = &H8000000E
    Next
    MecChang.BackColor = &H80FF80
    .VDat = DateValue(1 & " " & MecChang)
End With
Dni
End Sub
Sub Dni()
Dim D1 As Date, D2 As Date, i&
With Kalendar
    D1 = DateSerial(Year(.VDat), Month(.VDat), 1)
    D2 = DateSerial(Year(.VDat), Month(.VDat) + 1, 0)
End With
For i = 1 To 37
    With Kalendar.Controls("Dn" & i)
        .BackColor = &H8000000E ' - |fffd||fffd||fffd||fffd||fffd|
        .Visible = 0
        .Text = ""
        .Enabled = 1
    End With
Next
For i = 1 To Day(D2)
    With Kalendar.Controls("Dn" & i + Weekday(D1, vbMonday) - 1)
        .Text = i
        .Visible = 1
    End With
Next
Kalendar.Controls("Dn" & Weekday(D1, vbMonday)).BackColor = &H80FF80
'Kalendar.Ok.SetFocus

End Sub
Attribute VB_Name = "Imvoiys_1"
Option Explicit
Public Inv(1 To 30, 1 To 6), Brn$, k&, Fl As Boolean '
Public LD As Date, UD As Date ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
Public Sm#, RnPer As Range, P$, Nazen$ '
Public DataGod&, Avans#, Oplat#
Public ActContr As Object, FlagDat As Boolean '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Sub New_Bron()
    Broni.Show
End Sub

Sub Sthet_Za_Progivanie()
Erase Inv
Sm = 0
Brn = Cells(21, 4)
Dim i&, R&, C&, Cd&, Cn&, D As Date, D1 As Date, C1&, C2&, Cnaht&
Dim Skid#, DopM&, DopZ# ' |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd|
Dim ShNew As Range, ShZen As Range, Cel As Range ' |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|, cells |fffd||fffd||fffd||fffd||fffd|
Dim Rsh&, Csh& ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|
Dim Buking$, Buk#, Sav#, N&, Srk$, Kevr
Dim Rnow&, Rzen&, Ar(), Room$
Dim z As Long
On Error Resume Next
Cnaht = Worksheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").Cells(2, 3) - 3
Set ShNew = Worksheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").UsedRange
Set ShZen = Worksheets("|fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").UsedRange
Rnow = ShNew.Rows.Count
Rzen = ShZen.Rows.Count
DopZ = Worksheets("|fffd||fffd||fffd||fffd|").Cells(8, 9).Value
'' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
With Worksheets("|fffd||fffd||fffd||fffd||fffd|")
    Set Cel = .Range("A:A").Find(Brn)
    If Cel Is Nothing Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!"
        Exit Sub
    End If
    With Cel
        LD = .Offset(, 4)
        UD = .Offset(, 5)
        DopM = .Offset(, 7)
        Skid = .Offset(, 8)
        Avans = .Offset(, 11)
        Buking = .Offset(, 14)
        Oplat = .Offset(, 10)
    End With
    
End With

If Buking = "booking.com" Or Buking = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
    Buk = 1
    Kevr = Worksheets("|fffd||fffd||fffd||fffd|").Cells(2, 1).Value + 1
Else
    Buk = 2
    Kevr = 1
End If
    C1 = LD - Cnaht
    C2 = UD - Cnaht - 1
    D = LD
'    |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Inv
With ShNew
    Ar = .Range(.Cells(1, C1), .Cells(Rnow, C1)).Value2
    R = WorksheetFunction.Match(CDbl(Brn), Ar, 0)
    Room = .Cells(R, 1)
End With
With ShZen
    R = R + Buk
    k = 1
    Inv(k, 5) = .Cells(R, C1)
    Inv(k, 1) = k
    Inv(k, 3) = Room
    Sm = Sm + CDbl(Inv(k, 5))
End With
If Cells(20, 11) = "1 |fffd||fffd||fffd||fffd||fffd|" Then Sav = Sm
If Cells(20, 11) = "3 |fffd||fffd||fffd||fffd||fffd|" Then N = C1 + 2
'|fffd||fffd||fffd||fffd||fffd|
For i = C1 + 1 To C2
    With ShNew
        Ar = .Range(.Cells(1, i), .Cells(Rnow, i)).Value2
        R = WorksheetFunction.Match(CDbl(Brn), Ar, 0)
        Room = .Cells(R, 1)
    End With
    With ShZen
        R = R + Buk
        
        If .Cells(R, i) <> CDbl(Inv(k, 5)) Then
            Inv(k, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & D & " |fffd||fffd| " & .Cells(2, i)
            Inv(k, 4) = .Cells(2, i) - D
            Inv(k, 6) = CDbl(Inv(k, 5)) * Inv(k, 4)
            Sm = Sm + .Cells(R, i)
            k = k + 1
            Inv(k, 5) = .Cells(R, i)
            Inv(k, 1) = k
            Inv(k, 3) = Room
            D = .Cells(2, i)
        Else
            Sm = Sm + .Cells(R, i)
        End If
        If i = N Then Sav = Sm
    End With

Next
    Inv(k, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & D & " |fffd||fffd| " & ShZen.Cells(2, i)
    Inv(k, 4) = ShZen.Cells(2, i) - D
    Inv(k, 6) = CDbl(Inv(k, 5)) * Inv(k, 4)
'    Sm = Sm + CDbl(Inv(k, 5))

z = k
k = k + 1
Inv(k, 5) = "|fffd||fffd||fffd||fffd||fffd|:": Inv(k, 6) = Sm

If Skid Then
    k = k + 1
    Inv(k, 5) = "|fffd||fffd||fffd||fffd||fffd||fffd| " & Skid * 100 & "%":
    Inv(k, 6) = Sm * Skid
    Sm = Sm - Inv(k, 6)
End If


If DopM Then
    k = k + 1
    Inv(k, 6) = Sm
    z = z + 1
    k = k + 1
    Inv(k, 1) = z: Inv(k, 4) = DopM: Inv(k, 5) = DopZ: Inv(k, 3) = "|fffd||fffd||fffd||fffd|"
    Inv(k, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|": Inv(k, 6) = DopM * DopZ * Kevr
    Sm = Sm + Inv(k, 6)
End If


If ActiveSheet.CodeName = "|fffd||fffd||fffd||fffd|20" Then

    k = k + 1
    Inv(k, 5) = "|fffd||fffd||fffd||fffd||fffd|:": Inv(k, 6) = Sm

        k = k + 2
            If Cells(20, 11) = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then Sav = Sm
            If Cells(20, 11) = "50%|fffd|" Then Sav = Sm / 2
            If Cells(20, 11) = "50%|fffd|" Then Srk = "50%|fffd||fffd||fffd||fffd||fffd||fffd| " Else Srk = Cells(20, 11)
            Inv(k, 3) = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|:   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & Srk & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - " & Format(Sav, "# ##0.00") & " |fffd||fffd||fffd|."
            If Cells(20, 11) <> "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" And Cells(20, 11) <> "" Then
            k = k + 1
            Inv(k, 3) = "*|fffd||fffd||fffd||fffd| :   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|  " _
            & Format((Sm - Sav), "# ##0.00") & " |fffd||fffd||fffd|."
            End If
End If

End Sub



Attribute VB_Name = "Kalendar"
Attribute VB_Base = "0{8C528D89-559F-4056-9128-634D6CC0EFC7}{176DC33C-4E61-4139-8B04-BEAA74297FD8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Dim DenCh(1 To 37) As New DataDen
Dim MecCh(11) As New DataDen
Dim TD&, N&, CotNan$

Private Sub Canc_Click()
Unload Me
End Sub


Private Sub Mes_Change()
VDat = Format(DateValue(Mes))
Kalen
End Sub

Private Sub Ok_Click()
ActContr = VDat
Me.Hide
End Sub

Private Sub UserForm_Activate()
Dim i&
For i = 1 To 37
   Set DenCh(i).DenChang = Me.Controls("Dn" & i)
Next
For i = 0 To 11
    Mes.AddItem Format(DateAdd("m", i, Date), " MMMM YYYY")
Next
Mes = Format(VDat, " MMMM YYYY")
'M0.BackColor = &H80FF80
'VDat = Format(Date, "DD.MM.YYYY")
Kalen
End Sub

Sub Kalen()
Dim D1 As Date, D2 As Date, i&
D1 = DateSerial(Year(VDat), Month(VDat), 1)
D2 = DateSerial(Year(VDat), Month(VDat) + 1, 0)
TD = Day(VDat)
For i = 1 To 37
    With Me.Controls("Dn" & i)
        .BackColor = &H8000000E ' - |fffd||fffd||fffd||fffd||fffd|
        .Visible = 0
        .Text = ""
        .Enabled = 1
    End With
Next
For i = 1 To Day(D2)
    With Me.Controls("Dn" & i + Weekday(D1, vbMonday) - 1)
        .Text = i
        .Visible = 1
        If i = Day(VDat) Then
            .BackColor = &H80FF80    ' &H0080FF80&
            TD = i + Weekday(D1, vbMonday) - 1 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1- |fffd||fffd||fffd||fffd||fffd|
            .SetFocus
      End If
    End With
Next
End Sub

Sub ViborDnya()
Me.Controls(CotNan).BackColor = &H8000000E ' - |fffd||fffd||fffd||fffd||fffd|
Me.ActiveControl.BackColor = &HC0FFC0
CotNan = Me.ActiveControl.Name
VDat = DateSerial(Year(VDat), Month(VDat), Me.ActiveControl.Text)
Den = Day(VDat)
End Sub
Attribute VB_Name = "Pasvord"
Attribute VB_Base = "0{92081FE4-6353-4993-B35F-ADE0D40B94F9}{4AC0C01F-A503-4A43-BCFF-7FDEC3A8F169}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
'On Error Resume Next
Private Sub CommandButton1_Click()
    ActiveSheet.Unprotect Pasv.Value
    If Flag.Value = "" Then Range("NZ1").Value = Pasv.Value
    Unload Me
End Sub

Private Sub CommandButton2_Click()
    Pasv.Value = ""
End Sub
Attribute VB_Name = "Saves"
Option Explicit

Sub Save_As()
Attribute Save_As.VB_ProcData.VB_Invoke_Func = " \n14"
Dim Nam$, Nam1$

If ActiveSheet.CodeName = "|fffd||fffd||fffd||fffd|20" Then Nam1 = Cells(21, 4).Text Else Nam1 = "|fffd||fffd||fffd||fffd||fffd|-" & Cells(21, 4).Text
    Nam = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd|\" & Nam1 & "_" _
    & Format(Date, "DD.MM.YY") & ".pdf"
    ChDir ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd|"
    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
        Nam, Quality:=xlQualityStandard _
        , IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
        True
'        |fffd||fffd||fffd||fffd|21.Activate
'    Nam = ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd|\" & Cells(21, 4).Text & "_" & "_" _
'    & Format(Date, "DD.MM.YY") & "-|fffd||fffd||fffd||fffd||fffd|.pdf"
''    ChDir ThisWorkbook.Path & "\|fffd||fffd||fffd||fffd||fffd|"
'    ActiveSheet.ExportAsFixedFormat Type:=xlTypePDF, Filename:= _
'        Nam, Quality:=xlQualityStandard _
'        , IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:= _
'        True

End Sub
Sub SendMail()
    Dim mPath$
    Dim OutApp As Object
    Dim OutMail As Object
'    Dim mFil As Object
    Dim Bod$, Sb$, i, Fn$
    Bod = Worksheets(1).Cells(2, 4).Value & Chr(10) & Chr(10) & Cells(10, 4)
    Sb = Worksheets(1).Cells(1, 4).Value
    mPath = ThisWorkbook.Path
    On Error Resume Next
'    Arr = Range(Cells(1, 1), Cells(Rows.Count, 1).End(xlUp)).Value
'    If WorksheetFunction.CountA(Range("A:A")) < 2 Then
'        ReDim Arr(1 To 1, 1 To 1)
'        Arr(1, 1) = Cells(Rows.Count, 1).End(xlUp).Value
'    End If
'    Application.ScreenUpdating = False
'    Set OutApp = CreateObject("Outlook.Application")   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Outlook |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'    OutApp.Session.Logon
    On Error GoTo cleanup  '|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' For i = 1 To UBound(Arr)
'     If Arr(i, 1) <> "" Then
'        Set OutMail = OutApp.CreateItem(0)   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        On Error Resume Next
'        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        With OutMail
''            .display
'            If Cells(2, 7) <> "" Then
'                .from = Cells(2, 6).Value
'                .SentOnBehalfOfName = Cells(2, 7).Value
'            End If
'            .To = Arr(i, 1) '|fffd||fffd||fffd||fffd||fffd|
'            .Subject = Sb ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            .body = Bod ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''            |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|:
'         Fn = Dir(mPath & "\*")
''    Do Until Fn = ""
''            If Fn <> ThisWorkbook.Name Then
''                .Attachments.Add ThisWorkbook.Path & "\" & Fn
''            End If
''        Fn = Dir
''     Loop
'            .Send
'        End With
     
        On Error GoTo 0
'        Set OutMail = Nothing
'     End If
' Next
cleanup:
'    Set OutApp = Nothing
    Application.ScreenUpdating = True
'    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
End Sub


Attribute VB_Name = "ShemaZen"
Attribute VB_Base = "0{CE97AA98-C4C1-4916-857D-FDE3D722D57E}{01B86FFF-4F65-4C0F-AD76-C437712550C5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit
Dim Dnath As Date
Private Sub Cl1_Click()
Set ActContr = Me.Dat1
With Kalendar
    .Caption = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    .Top = Me.Top
    .Left = Me.Left + Me.Width
    .VDat = Date
    .Show
End With
End Sub

Private Sub CL2_Click()
Set ActContr = Me.Dat2
With Kalendar
    .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|"
    .Top = Me.Top
    .Left = Me.Left + Me.Width
    .VDat = Dat1
    .Show
End With
End Sub

Private Sub CommandButton1_Click()
Dim Pass
100
If Err Then
    Me.Hide
    Pasvord.Show
    Me.Show
End If
Pass = Range("NZ1").Value
If Zena = "" Then Exit Sub
Application.EnableEvents = False
On Error GoTo 100
ActiveSheet.Unprotect Pass
With Selection
    .Offset(-1).Resize(2).Interior.Color = 255
    .Value = CDbl(Zena)
End With
ActiveSheet.Protect Pass
Application.EnableEvents = True
ActiveSheet.Calculate
End Sub

Private Sub CommandButton2_Click()
Zena = ""
Stoim = Format(WorksheetFunction.Sum(Selection), "#,###")
StoimBuc = Format(WorksheetFunction.Sum(Selection.Offset(-1)), "#,###")
End Sub

Private Sub Dat1_Change()
Dim C
'Dat2 = Dat1
If Not FlagDat Then
    C = DateValue(Dat1) - Dnath
    ActiveWindow.ScrollColumn = C + 2
End If
End Sub

Private Sub Dat1_Enter()
Set ActContr = Me.Dat1
With Kalendar
    .Caption = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    .Top = Me.Top
    .Left = Me.Left + Me.Width
    .VDat = Date
    .Show
End With
End Sub

Private Sub Dat2_Change()
Dim C, R, C1
DatV = Format(DateValue(Dat2) + 1, "DD.MM.YYYY")
If Not FlagDat Then
FlagDat = True
'    Application.EnableEvents = False
    If |fffd| <> "" Then
        R = Range("B3:B31").Find(What:=|fffd|.Value, After:=Range("B3"), LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Row + 1
        C = WorksheetFunction.Match(CDbl(DateValue(Dat1)), Range("2:2").Value2)
        C1 = WorksheetFunction.Match(CDbl(DateValue(Dat2)), Range("2:2").Value2)
        Range(Cells(R, C), Cells(R, C1)).Select
    End If
'    Application.EnableEvents = True
End If
FlagDat = False
End Sub

Private Sub Dat2_Enter()
Set ActContr = Me.Dat2
With Kalendar
    .Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|"
    .Top = Me.Top
    .Left = Me.Left + Me.Width
    .VDat = Dat1
    .Show
End With
End Sub

Private Sub |fffd|_Change()
Dim R, C, C1
If Dat1 <> "" And Dat2 <> "" Then
If Not FlagDat Then
FlagDat = True
'    Application.EnableEvents = False
    If |fffd| <> "" Then
        R = Range("B3:B31").Find(What:=|fffd|.Value, After:=Range("B3"), LookIn:=xlFormulas, LookAt:= _
        xlWhole, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
        , SearchFormat:=False).Row + 1
        C = WorksheetFunction.Match(CDbl(DateValue(Dat1)), Range("2:2").Value2)
        C1 = WorksheetFunction.Match(CDbl(DateValue(Dat2)), Range("2:2").Value2)
        Range(Cells(R, C), Cells(R, C1)).Select
    End If
'    Application.EnableEvents = True
End If
FlagDat = False

End If
End Sub

Private Sub UserForm_Deactivate()
Application.EnableEvents = True
End Sub

Private Sub UserForm_Initialize()
Dim D As Date, i&
Dnath = Cells(2, 3).Value
For i = 4 To 30 Step 2
    |fffd|.AddItem Cells(i, 2).Value
Next
D = Date
End Sub

Private Sub UserForm_Terminate()
Application.EnableEvents = True

End Sub

Private Sub Zena_Change()
Dim Buk
Buk = Worksheets("|fffd||fffd||fffd||fffd|").Cells(2, 1).Value + 1
If Not FlagDat Then
    FlagDat = 1
    If Zena <> "" Then
        Stoim.BackColor = &HC0FFFF
        StoimBuc.BackColor = &HC0FFFF
        Zena.BackColor = &HC0FFFF
        If Right(Zena, 1) Like "[0-9]" Then
        Stoim = Format(Selection.Cells.Count * CDbl(Zena), "#,###")
        StoimBuc = Format(CDbl(Stoim) * Buk, "#,###")
        Else
            Zena = Left(Zena, Len(Zena) - 1)
        End If
End If
If Len(Zena) = 0 Then
    Stoim.BackColor = &HFFFFFF
    StoimBuc.BackColor = &HFFFFFF
    Zena.BackColor = &HFFFFFF
    Stoim = Format(WorksheetFunction.Sum(Selection), "#,###")
    StoimBuc = Format(WorksheetFunction.Sum(Selection.Offset(-1)), "#,###")
End If
    FlagDat = False
End If
Zena = Format(Zena, "#,###")
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
'    Application.Calculation = xlCalculationManual
If Target.Address = "$A$1" Then Exit Sub
    Application.EnableEvents = False
    Application.ScreenUpdating = False
Dim Cel As Range, C&, Tar, Adr$, Ki, N&, Rn As Range
If Target.Row Mod 2 Then

    If Target.Cells(1, 1).Value = "" Then GoTo 100
    Tar = Target.Cells(1, 1).Value
    Set Rn = Range(Cells(3, 3), Cells(2, 3).End(xlToRight).Offset(30))
        With CreateObject("Scripting.Dictionary")
            Set Cel = Rn.Find(What:=Tar, After:=Rn.Cells(1, 1), LookIn:=xlValues, LookAt:= _
            xlPart, SearchDirection:=xlNext, MatchCase:= _
            False, SearchFormat:=False)
            Adr = Cel.Address
              Cel.Activate
           C = Cel.Column
            .Item(C) = ""
            Do
             Set Cel = Rn.Find(Tar, After:=Cel)
            If Cel.Address = Adr Then Exit Do
             Cel.Activate
            C = Cel.Column
            If .exists(C) Then
                MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
                Target.Value = Empty
'   Application.Calculation = xlCalculationManual
    Application.EnableEvents = False
    Application.ScreenUpdating = False
                Target.Select
                Exit Sub
            End If
            .Item(C) = ""
             Loop
             Ki = .keys
             N = .Count
        End With
        With Application.WorksheetFunction
        If .Max(Ki) - .Min(Ki) + 1 <> N Then
                MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
                Target.Value = Empty
                Application.EnableEvents = True
                 Target.Select
               Exit Sub
            End If
        End With

'Else
'    Selection = Target
End If
100
Application.EnableEvents = True
'Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
End Sub


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim Ar(), C&
    If ActiveCell.Address = "$B$1" Then
        Ar = Range("A1", Cells(1, Columns.Count).End(xlToLeft)).Value2
        C = WorksheetFunction.Match(CDbl(Date), Ar, 0)
            ActiveWindow.ScrollColumn = C
    End If
'If (ActiveCell.Row Mod 2) = 0 Then
'    Validation1
'End If
End Sub

'Sub Validation1()
'ActiveSheet.Unprotect "80013254"
'ActiveSheet.Cells.Validation.Delete
'    With ActiveCell.Validation
'        .Delete
'        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
'        xlBetween, Formula1:="=ValShm"
'
'        .IgnoreBlank = True
'        .InCellDropdown = True
'        .InputTitle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
'        .ErrorTitle = ""
'        .InputMessage = " "
'        .ErrorMessage = ""
'        .ShowInput = True
'        .ShowError = True
'    End With
''ActiveSheet.Protect "80013254"
'End Sub





Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
ActiveSheet.Calculate
End Sub

'Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'If Not Intersect(ActiveCell, Range("O:O")) Is Nothing Then Validation2
'End Sub

'Sub Validation2()
'ActiveSheet.Unprotect "80013254"
'    With Selection.Validation
'        .Delete
'        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
'        xlBetween, Formula1:="=ValBrn"
'        .IgnoreBlank = True
'        .InCellDropdown = True
'        .InputTitle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
'        .ErrorTitle = ""
'        .InputMessage = " "
'        .ErrorMessage = ""
'        .ShowInput = True
'        .ShowError = True
'    End With
'ActiveSheet.Protect "80013254"

'End Sub






Attribute VB_Name = "|fffd||fffd||fffd||fffd|20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_Activate()
Dim S#, D1 As Date, D2 As Date
On Error Resume Next
    Brn = Cells(21, 4)
        Sthet_Za_Progivanie
    Remove_Password
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Dim CL As Range
    If Target.Address = "$D$21" Or Target.Address = "$K$20" Then
        P = [n3]
        Brn = Range("D21").Value:
        With |fffd||fffd||fffd||fffd|2
            Set CL = .Range("A:A").Find(Brn, .Cells(1, 1))
            If CL Is Nothing Then
                MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!"
                Application.EnableEvents = 0
                [d21] = "|fffd| |fffd||fffd||fffd||fffd||fffd|"
                Application.EnableEvents = True
                Exit Sub
            End If
        End With
        Sthet_Za_Progivanie
        Remove_Password
    End If
End Sub

Sub Remove_Password()
 Dim N&
    Application.EnableEvents = False
    Application.ScreenUpdating = False
'    Application.Calculation = xlManual
    P = [n3]
1
    If N = 3 Then
        N = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical, "|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
        Application.EnableEvents = True
        Application.ScreenUpdating = True
'        Application.Calculation = xlAutomatic
        Exit Sub
    End If
    On Error Resume Next
        ActiveSheet.Unprotect Password:=P
        Cells(3, "N").Value = P
        If Err Then
            N = N + 1
            P = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
           On Error GoTo 0
            GoTo 1
        End If
            On Error GoTo 0
    Cells(24, 4) = "|fffd||fffd||fffd||fffd||fffd| - " & LD & " 14:00"
    Cells(24, 6) = "|fffd||fffd||fffd||fffd||fffd| - " & UD & " 12:00"
    Range("B28:G54") = Inv
    Erase Inv
    Rows("28:57").EntireRow.Hidden = False
     Rows(28 + k & ":57").EntireRow.Hidden = True
    ActiveSheet.Protect Password:=P, DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlUnlockedCells
   Application.EnableEvents = True
    Application.ScreenUpdating = True
'    Application.Calculation = xlAutomatic
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_Activate()
Dim CL As Range
On Error Resume Next
    Brn = Cells(21, 4)
    Sthet_Za_Progivanie
    Remove_Password
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Dim CL As Range
    If Target.Address = "$D$21" Or Target.Address = "$K$20" Then
    Application.EnableEvents = False
        P = [n3]
        Brn = Range("D21").Value:
        With |fffd||fffd||fffd||fffd|2
            Set CL = .Range("A:A").Find(Brn, .Cells(1, 1))
            If CL Is Nothing Then
                MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!"
                Application.EnableEvents = 0
                [d21] = "|fffd| |fffd||fffd||fffd||fffd||fffd|"
                Application.EnableEvents = True
                Exit Sub
            End If
        End With
        Sthet_Za_Progivanie
        Remove_Password
    End If
    Application.EnableEvents = True
End Sub

Sub Remove_Password()
 Dim N&
    Application.EnableEvents = False
    Application.ScreenUpdating = False
'    Application.Calculation = xlManual
    P = [n3]
1
    If N = 3 Then
        N = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical, "|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
        Application.EnableEvents = True
        Application.ScreenUpdating = True
'        Application.Calculation = xlAutomatic
        Exit Sub
    End If
    On Error Resume Next
        ActiveSheet.Unprotect Password:=P
        Cells(3, "N").Value = P
        If Err Then
            N = N + 1
            P = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
           On Error GoTo 0
            GoTo 1
        End If
            On Error GoTo 0
    Cells(24, 4) = "|fffd||fffd||fffd||fffd||fffd| - " & LD & " 14:00"
    Cells(24, 6) = "|fffd||fffd||fffd||fffd||fffd| - " & UD & " 12:00"
    k = k + 1
    Inv(k, 5) = "|fffd||fffd||fffd||fffd||fffd|:" '& [k20]:
    Inv(k, 6) = Avans + Oplat
    
    k = k + 1
    Inv(k, 5) = "|fffd||fffd||fffd||fffd||fffd|:" '& [k20]:
    Inv(k, 6) = Sm - Avans - Oplat
    
    If Sm - Avans - Oplat Then
        k = k + 2
        Inv(k, 2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
        Inv(k, 3) = Sm - Avans - Oplat
        k = k + 1
'        Inv(k, 3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
    End If
    Range("B28:G54") = Inv
    Erase Inv
    Rows("28:57").EntireRow.Hidden = False
     Rows(28 + k & ":57").EntireRow.Hidden = True
    ActiveSheet.Protect Password:=P, DrawingObjects:=True, Contents:=True, Scenarios:=True
    ActiveSheet.EnableSelection = xlUnlockedCells
   Application.EnableEvents = True
    Application.ScreenUpdating = True
'    Application.Calculation = xlAutomatic
End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'Set RnPer = Range(Cells(3, 4), Cells(3, 4).End(xlToRight))
'If Not Intersect(ActiveCell, RnPer) Is Nothing Then
'    RnPer.Interior.Color = 13434828
'    ActiveCell.Interior.Color = 11851260
'    With KorDat
'        .Spin = ActiveCell.Column - 3
'        .Spin.Min = 1
'        .Spin.Max = RnPer.Cells.Count
'        .Show
'    End With
'End If
'End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Worksheet_Activate()
ShemaZen.Show
End Sub

Private Sub Worksheet_Deactivate()
On Error Resume Next
ShemaZen.Hide
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim R&, S, i&, Sb
Dim Buk
Buk = Worksheets("|fffd||fffd||fffd||fffd|").Cells(2, 1).Value + 1
Application.EnableEvents = 0
If Intersect(Selection, Range(Cells(4, 3), Cells(4, 3).End(xlDown).End(xlToRight))) Is Nothing Then Exit Sub
    R = Int(Selection.Row / 2) * 2 + 1
    Range(Cells(R, Selection.Column), Cells(R, Selection.Column + Selection.Columns.Count - 1)).Select
S = WorksheetFunction.Sum(Selection)
Sb = WorksheetFunction.Sum(Selection.Offset(-1))
FlagDat = True
With ShemaZen
    .Dat1 = Format(Cells(2, Selection.Column), "DD.MM.YYYY")
    .Dat2 = Format(Cells(2, Selection.Column + Selection.Columns.Count - 1), "DD.MM.YYYY")
    If .Zena = "" Then
        .Stoim = Format(S, "#,###")
        .StoimBuc = Format(Sb, "#,###")
    Else
        .Stoim = Format(Selection.Cells.Count * CDbl(.Zena), "#,###")
        .StoimBuc = Format(Selection.Cells.Count * CDbl(.Zena) * Buk, "#,###")
    End If
    .|fffd| = Cells(R - 1, 2)
'    .Show
    On Error Resume Next
    .Show
End With
FlagDat = False
Application.EnableEvents = 1
End Sub

Sub Restore_Formulas()
    Dim i&, Rn As Range, C&, R&, Pass$
    Application.ScreenUpdating = False
    Application.Calculation = xlManual
    With Pasvord
        .Flag = 1
        .Show
    End With
    On Error GoTo 100
    Pass = Range("NZ1").Value
'    ActiveSheet.Unprotect Pass
    C = Cells(4, Columns.Count).End(xlToLeft).Column
    R = Cells(Rows.Count, 3).End(xlUp).Row
    For i = 4 To R Step 2
        Set Rn = Range(Cells(i, 3), Cells(i, C))
        Rn.FormulaR1C1 = "=R[1]C*R1C"
        Rn.Interior.Color = xlNone
        Set Rn = Range(Cells(i + 1, 3), Cells(i + 1, C))
        Rn.FormulaR1C1 = "=IF(RC1="""",HLOOKUP(R3C,|fffd||fffd||fffd||fffd||fffd||fffd|,MATCH(R[-1]C1,|fffd||fffd||fffd|,0)),R[1]C*R1C)"
        Rn.Interior.Color = xlNone
    Next
100
    Application.ScreenUpdating = True
    Application.Calculation = xlAutomatic
    ActiveSheet.Protect Pass
End Sub

Sub t()
Dim i
For i = 5 To 31 Step 2
Cells(i, 1) = Empty
Next
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
DataGod = Worksheets("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").Range("A1")
End Sub


INQUEST-PP=macro
