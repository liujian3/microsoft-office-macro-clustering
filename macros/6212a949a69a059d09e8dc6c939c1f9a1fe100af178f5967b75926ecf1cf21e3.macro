Attribute VB_Name = "BuCalsmaKitab"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro
'

'
    ActiveWindow.SmallScroll Down:=-6
    Range("C9:AE9").Select
    Selection.Copy
    Sheets("Save List").Select
    Range("C9").Select
    Application.GoTo Reference:="R999C3"
    Selection.End(xlUp).Select
    ActiveCell.Offset(1, 0).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.SmallScroll Down:=-12
    Range("T1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = ""
    Range("T1").Select
    Sheets("Analysis").Select
    Range("T1").Select
    ActiveCell.FormulaR1C1 = ""
    Range("T1").Select
End Sub
Sub Makro2()
Attribute Makro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro2 Makro
'

'
    Range("C9:AD100").Select
    Selection.ClearContents
    ActiveWindow.SmallScroll Down:=-9
    Range("T1").Select
    ActiveCell.FormulaR1C1 = ""
    Range("T1").Select
End Sub
Sub Makro3()
Attribute Makro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro3 Makro
'

'
    Sheets("Save List").Select
End Sub
Sub Makro4()
Attribute Makro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro4 Makro
'

'
    Sheets("Analysis").Select
End Sub
Sub Makro5()
Attribute Makro5.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro5 Makro
'

'
    Range("B12").Select
    ActiveSheet.PasteSpecial Format:="HTML", Link:=False, DisplayAsIcon:= _
        False, NoHTMLFormatting:=True
    Range("X1").Select
    ActiveCell.FormulaR1C1 = ""
    Range("X1").Select
End Sub
Sub Makro6()
Attribute Makro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro6 Makro
'

'
    Range("B24").Select
    ActiveSheet.PasteSpecial Format:="HTML", Link:=False, DisplayAsIcon:= _
        False, NoHTMLFormatting:=True
    ActiveWindow.SmallScroll Down:=-3
    Range("X1").Select
    ActiveCell.FormulaR1C1 = ""
    Range("X1").Select
End Sub

Sub MakroDate()
'
' MakroDate Makro
'

'
    Sheets("BazaDate").Select
End Sub
Attribute VB_Name = "Module10"
Attribute VB_Name = "Module11"
Sub AKTAR()
Dim LR  As Long, i  As Long, cls
cls = Array("A65", "B65", "C65", "d65", "e65", "f65", "g65", "h65", "|fffd|65", "j65", "k65", "l65", "m65", "n65", "O65", "P65", "Q65")
With Sheets("SONUCLAR")
    LR = WorksheetFunction.Max(2, .Range("D" & Rows.Count).End(xlUp).Row + 1)
    For i = LBound(cls) To UBound(cls)
        .Cells(LR, i + 1).Value = Sheets("BazaDate").Range(cls(i)).Value
    Next i
End With
Call kaydet
End Sub
Attribute VB_Name = "Module12"
Sub sil()
Attribute sil.VB_ProcData.VB_Invoke_Func = " \n14"
'
' sil Makro
'

'
    Range("A2:Q1004").Select
    Selection.ClearContents
    Range("A1").Select
End Sub
Attribute VB_Name = "Module13"
Sub kaydet()
Attribute kaydet.VB_ProcData.VB_Invoke_Func = " \n14"
'
' kaydet Makro
'

'
    Range("H1").Select
    ActiveWorkbook.Save
    Range("H1").Select
End Sub
Attribute VB_Name = "Module2"
Attribute VB_Name = "Module3"
Sub pal()
    
    If vbNo = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion, constrPrjName) Then Exit Sub
    
    '
    Application.ScreenUpdating = False
    Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|..."
    
    fnrngStatistic_Clear.Clear
    fnrngStatistic_1stRow.ClearContents
 
'    Sheets("Foglio1").Activate
'    Range("a:d").ClearContents

    With Sheets("Foglio1")
    
        .Range("a:d").ClearContents

        myConn = "URL;http://data.goaloo.com/1x2/index.htm" _

'        Range("aa5").Select
'        With Selection.QueryTable
        
        With .Range("aa5").QueryTable
            .Connection = myConn
            .Refresh BackgroundQuery:=False
        End With
        
        'Range("t1:y1").Select
        'Selection.AutoFill Destination:=Range("t1:y4033"), Type:=xlFillDefault
        
        .Range("t1:y1").AutoFill Destination:=.Range("t1:y4033"), Type:=xlFillDefault
        
        'Range("t1:y4033").Select
    
    End With
    
    'Stop
    sbGetDataFromWeb
    'Stop
    Call ordina
    
    'Sheets("bazadate").Activate
    
    sbSetActualListFillRange
    
    'Range("d4").Select
    
    Application.ScreenUpdating = True
    Application.StatusBar = ""
    
End Sub


Attribute VB_Name = "Module4"
Function HLink(rng As Range) As String
  If rng(1).Hyperlinks.Count Then
      HLink = rng.Hyperlinks(1).Address
  End If
End Function


Attribute VB_Name = "Module5"
Option Explicit

Sub ordina()

    Dim RR1 As Long
    Dim UR1 As Long
    Dim UR2 As Long
    
    Application.Calculation = xlManual
'    Sheets("foglio1").Activate
'    Range("a:e").ClearContents

    Dim Ws1 As Worksheet
    Dim Ws2 As Worksheet
    
    Set Ws1 = Sheets("foglio1")
    Set Ws2 = Sheets("foglio1")
    
    Ws1.Range("a:e").ClearContents
    
    UR1 = Ws1.Range("t" & Rows.Count).End(xlUp).Row
    
    Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
    
    For RR1 = 2 To UR1
        
        'Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: " & RR1 & " / " & UR1
        
        If Ws1.Range("t" & RR1).Value <> "" Then
            
            UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1
            Ws1.Range("t" & RR1 & ":x" & RR1).Copy
            Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues
        
        End If
    
    Next RR1
    
    Application.StatusBar = ""
    
    Application.CutCopyMode = False
    Application.Calculation = xlAutomatic
    Calculate

End Sub

Attribute VB_Name = "Module6"
Sub list()
Sheets("bazadate").Activate
End Sub


Attribute VB_Name = "Module7"
Option Explicit

Sub sbAnaliz()
    Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
    MacroSS
    Application.StatusBar = ""
    Call AKTAR
End Sub

Sub MacroSS()

    Dim straddress As String
    
    Application.ScreenUpdating = False
    
    'Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."

    straddress = Sheets("BazaDATE").Range("z2").Value
    
    With Sheets("ampionate")
        
        .Range("A1:AQ30000").Clear
            
        With .QueryTables.Add(Connection:= _
            "URL;" & straddress _
            , Destination:=.Range("A1"))
            .FieldNames = True
            .RowNumbers = False
            .FillAdjacentFormulas = False
            .PreserveFormatting = True
            .RefreshOnFileOpen = False
            .BackgroundQuery = True
            .RefreshStyle = xlInsertDeleteCells
            .SavePassword = False
            .SaveData = True
            .AdjustColumnWidth = True
            .RefreshPeriod = 0
            '.WebSelectionType = xlAllTables
            .WebSelectionType = xlSpecifiedTables
            .WebTables = "1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,,45,46,47"
            .WebFormatting = xlWebFormattingNone
            .WebPreFormattedTextToColumns = True
            .WebConsecutiveDelimitersAsOne = True
            .WebSingleBlockTextImport = False
            .WebDisableDateRecognition = True
            .WebDisableRedirections = False
            .Refresh BackgroundQuery:=False
        
        End With
    
    End With
           
    sbUpdateKefs
    
    'Sheets("BazaDate").Select

    Application.ScreenUpdating = True
    'Application.StatusBar = ""

End Sub

Sub stergere()
    ActiveSheet.Range("A4:Z396").ClearContents
    ActiveSheet.Range("AB4:AB396").ClearContents
End Sub



' 05/13/2004 by Alan Ryder
' Calculates Competing Poisson Probability of a Win
' U = Intensity of Goals For [Average Goals For per Game (>=0)]
' V = Intensity of Goals Against [Average Goals Against per Game (>=0)]
' Time = Elapsed Percentage of Game (0<=T<=1)
' Lead = Goal Differential at Time of Calculation
' ET = Scoring Rate (% of U and V) for trailing team in "Endgame"
' EL = Scoring Rate (% of U and V) for leading team in "Endgame"
' OT = Percentage Extra Scoring Rate (% of U and V) in Overtime
' OTType = Overtime Type
' [0] = None
' [1] = Sudden Death (Playoff)
' [2] = 5 Minute (Regular Season)
' Calc = Calculation to perform
' [-1] = Pr(Loss)
' [0] = Pr(Tie)
' [1] = Pr(Win)
' [2] = Expected Points
' [3] = Win Equivalent (W + T/2)
'
Function PrWin(U As Double, v As Double, Time As Double, Lead As Integer, ET As Double, EL As Double, OT As Double, OTType As Integer, Calc As Integer) As Double
Dim PDF As Double, PDA As Double, CPA As Double, OTW As Double
Dim PrTie As Double, PrLossBy1 As Double, PrWinBy1 As Double
Dim A As Double, B As Double
Dim i As Integer, C As Integer
' Set U, V at rate for remainder of game
U = (1 - Time) * Application.WorksheetFunction.Max(U, 0.00001)
v = (1 - Time) * Application.WorksheetFunction.Max(v, 0.00001)
' If Trailing, Switch U, V
If Lead < 0 Then
A = U
U = v
v = A
End If
' Set Initial Values
C = Abs(Lead)
PrWin = 0
PrTie = 0
PrWinBy1 = 0
PrLossBy1 = 0
PDF = 0
PDA = 0
If C > 0 Then
CPA = Application.WorksheetFunction.Poisson(C - 1, v, vbTrue)
Else
CPA = 0
End If
i = 0
' Calculate Basic Probabilities
While i < 30
A = PDA
PDA = Application.WorksheetFunction.Poisson(i + C, v, vbFalse)
PrLossBy1 = PrLossBy1 + PDF * PDA
PDF = Application.WorksheetFunction.Poisson(i, U, vbFalse)
PrWinBy1 = PrWinBy1 + PDF * A
PrTie = PrTie + PDF * PDA
PrWin = PrWin + PDF * CPA
CPA = CPA + PDA
i = i + 1
Wend
' Restore Full Game Intensities
U = U / (1 - Time)
v = v / (1 - Time)
' Endgame Goals: Some Losses Become Ties, Some Wins Become Ties
If ET > 0 Then
A = PrWinBy1 * (1 - Exp(-U * EL - v * ET)) * v * ET / (U * EL + v * ET)
B = PrLossBy1 * (1 - Exp(-U * ET - v * EL)) * U * ET / (U * ET + v * EL)
PrWin = PrWin - A
PrTie = PrTie + A + B
End If
' If Trailing calculations were reversed
If Lead < 0 Then PrWin = 1 - PrWin - PrTie
' Adjust for Overtime
If OTType = 2 Then
A = (1 - Exp(-(U + v) * (1 + OT) / 12))
Else
A = OTType
End If
OTW = U / (U + v)
B = PrTie * A
PrWin = PrWin + B * OTW
PrTie = PrTie - B
If OTType = 1 Then B = 0
' Pr(Loss)
If Calc = -1 Then PrWin = 1 - PrWin - PrTie
' Pr(Tie)
If Calc = 0 Then PrWin = PrTie
' Expected Points
If Calc = 2 Then PrWin = 2 * PrWin + PrTie + B * (1 - OTW)
' Pr(Win Equivalent)
If Calc = 3 Then PrWin = PrWin + 0.5 * PrTie
End Function




Attribute VB_Name = "Module8"
Option Explicit

Sub |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
End Sub
Attribute VB_Name = "Module9"

Sub Archivia_Risurtati_2()


                
   Application.ScreenUpdating = False
  
   
    Sheets("Statistic").Select
    
     Range("A2:BA1500").SpecialCells(xlVisible).Copy
    
    '  Workbooks(Nda).Worksheets(1).Range("A2:BA1500").SpecialCells(xlVisible).Copy
    
    
    
    Sheets("|fffd||fffd||fffd||fffd||fffd|").Select
    
    'posiziona prima cella libera
       
    With Worksheets("|fffd||fffd||fffd||fffd||fffd|")
    Dim lRiga As Long
    lRiga = .Range("A" & Rows.Count).End(xlUp).Row
    .Cells(lRiga + 1, 1).Select                 ' inizia a scrivere da Colonna A
    End With
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
        
    Sheets("Statistic").Select
    'Range("AE1").Select
    'Application.CutCopyMode = False
    'ActiveCell.FormulaR1C1 = ""
   ' Range("AE1").Select
    'Sheets("STAT").Select
    'Range("A1").Select
   
   MsgBox (" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! ")
    
End Sub







Attribute VB_Name = "Sayfa1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sayfa10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{CA0AFA6D-223F-49CC-BD99-65BF735FB218}{8B2FDBF3-6459-43FB-9BDB-F6A61927963D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Attribute VB_Name = "mod_Immediate"
'Cells(2, "G").Copy
'fnrngColumnGonFoglio1.Select
'?TypeName(Selection)
'ListBox
'
'ActiveSheet.Shapes("lista").Select
'
'?TypeName(ActiveSheet.Shapes("lista"))
'Shape
'
'?TypeName(ActiveSheet.Shapes.Range(Array("lista")))
'ShapeRange
'
'ActiveSheet.Shapes("lista").ListFillRange = "Foglio1!$G2:$G114"
'?ActiveSheet.Shapes("lista").ListFillRange
'?Selection.ListFillRange
'Foglio1!$G2:$G114
'?[lista].ListFillRange
'Foglio1!$G2:$G114
'?Range("lista").ListFillRange
'[lista].ListFillRange = "Foglio1!$G2:$G4"
'?fnrngColumnGonFoglio1.Address
'$G$2:$G$113
'[lista].ListFillRange = "Foglio1!" & fnrngColumnGonFoglio1.Address
'?ActiveSheet.Index
'1
'Sheets(1).[lista].ListFillRange = "Foglio1!$G2:$G4"
'Sheets(1).[lista].ListFillRange = "Foglio1!$G2:$G14"
'
'sbSetActualListFillRange
'fnrngStatistic_1stRow.Select
'fnrngStatistic_1stRow.Copy
'fnrngStatistic_Clear.Select
'fnrngStatistic_Clear.Clear
'?1 < 2
'True
'?0 < 2
'True
'?2 < 2
'False
'sbrngRowDublicateAndClearContents fnrngStatistic_1stRow, 3
'ActiveCell.ClearContents
'?fnrngColumnGonFoglio1.Rows.Count
'112
'
'fncelPasteOnStatistic.Copy
'fnrngColumnLigaOnFoglio1.Copy
'?ActiveCell.Address(0, 0)
'AA132
'
'fncelLeague_InColHead_League_OnFoglio1(1).Copy
'fncelLeague_InColHead_League_OnFoglio1(2).Copy
'fncelLeague_InColHead_League_OnFoglio1(3).Copy
'fncelLeague_InColHead_League_OnFoglio1(112).Copy
'?fncelLeague_InColHead_League_OnFoglio1(112)
'Application.ReferenceStyle = xlA1
'Application.ReferenceStyle = xlR1C1
'?ActiveCell.Cells(1, 1)
'COL D1
'?ActiveCell.Cells(1, 3)
'Deportivo Pasto
'?ActiveCell.Cells(1, 11)
'Atletico Bucaramanga
'
'?ActiveCell.Cells(1, 4)
'1.68
'?ActiveCell.Cells(1, 5)
'3.33
'?ActiveCell.Cells(1, 6)
'4.80
'?Cells(4, 2)
'23
'?fncelLeague_InColHead_League_OnFoglio1(23).Cells(1, 6)
'4.80
'
'sbSelectRangeWithSheetVisible ['ZW2'!D25]
'?['ZW2'!D23]
' 0,367355002016949
'?['ZW2'!D24]
' 0,469378191468851
'?['ZW2'!D25]
' 0,163266472223486
'?ActiveCell.Formula
'=CONCATENATE('ZW2'!I20,":",'ZW2'!J20)
'=CONCATENATE('ZW2'!I19,":",'ZW2'!J19)
'=CONCATENATE('ZW2'!I18,":",'ZW2'!J18)
'?[CONCATENATE('ZW2'!I18,":",'ZW2'!J18)]
'0:0
'?[CONCATENATE('ZW2'!I19,":",'ZW2'!J19)]
'1:0
'?[CONCATENATE('ZW2'!I20,":",'ZW2'!J20)]
'0:1
'
'?ActiveCell.Formula
'='Analiz Sayfas?'!AG47
'?['Analiz Sayfas?'!AG47]
'-1
'sbSelectRangeWithSheetVisible ['Analiz Sayfas?'!AG47]
'?ActiveCell
'-1
'
'?Replace(ActiveCell.Formula, "=", "?[") & "]"
'?['Analiz Sayfas?'!AG47]
'-1
'
'
Attribute VB_Name = "mod_Module"

Sub |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    Selection.AutoFilter
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    ActiveWorkbook.Worksheets("Statistic").AutoFilter.Sort.SortFields.Clear
    Selection.AutoFilter
    Range("A1:A4").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range("A1:AG4").Select
    Selection.AutoFilter
End Sub

Sub sbTEST__AutoFilter()
    Dim ws As Worksheet
    Set ws = ActiveSheet
    With ws
        Stop
        If .AutoFilterMode Then .Range("A1").AutoFilter
        .Range("A1").CurrentRegion.AutoFilter
        Debug.Print ".AutoFilter.Range.Address(0,0) = " & .AutoFilter.Range.Address(0, 0)
    End With
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_WebQueryTime()
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_WebQueryTime |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    With ActiveSheet.QueryTables.Add(Connection:= _
        "URL;http://data.goaloo.com/1x2/index.html", Destination:=Range("$A$1"))
        .Name = "index"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .BackgroundQuery = True
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .WebSelectionType = xlAllTables
        .WebFormatting = xlWebFormattingNone
        .WebPreFormattedTextToColumns = True
        .WebConsecutiveDelimitersAsOne = True
        .WebSingleBlockTextImport = False
        .WebDisableDateRecognition = False
        .WebDisableRedirections = False
        .Refresh BackgroundQuery:=False
    End With
    Range("A7").Select
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_FormatAsText()
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_FormatAsText |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    Selection.NumberFormat = "@"
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd|_RESIZE_LISTA()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_RESIZE_LISTA.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_RESIZE_LISTA |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    With Selection
        .ListFillRange = "Foglio1!$G2:$G113"
        .LinkedCell = "$B$4"
        .MultiSelect = xlNone
        .Display3DShading = False
    End With
    Range("A1").Select
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_SELECT_LISTA()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_SELECT_LISTA.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_SELECT_LISTA |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    ActiveSheet.Shapes.Range(Array("lista")).Select
    With Selection
        .ListFillRange = "Foglio1!$G2:$G114"
        .LinkedCell = "$B$4"
        .MultiSelect = xlNone
        .Display3DShading = False
    End With
    Range("A1").Select
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_CopyRowTimesCount()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_CopyRowTimesCount.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_CopyRowTimesCount |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    Range("A2").Select
    ActiveWindow.LargeScroll ToRight:=1
    Range("A2:AG2").Select
    Selection.Copy
    ActiveWindow.LargeScroll ToRight:=-1
    Range("A2:A10").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    ActiveSheet.Calculate
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Attribute |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'

'
    Calculate
End Sub
Attribute VB_Name = "mod_Task"
Option Explicit

Public bDebug As Boolean

Public Const constrPrjName As String = "BETPROFI 2017 V2.7"
Public Const constrPrjDate As String = "2017-11-03 08-08"

Public blnBtnOK As Boolean

Public gHTMLDocument As MSHTML.HTMLDocument
Public oTables As Object
Public oTable As MSHTML.HTMLTable
Public oTableBodies As Object
Public oTableBody As MSHTML.HTMLTableSection
Public oTableRow As MSHTML.HTMLTableRow

Sub sbDebug_OnOff()
    bDebug = Not bDebug
    Debug.Print "bDebug = " & bDebug & " [ " & ThisWorkbook.Name & " ]"
End Sub

Sub sbUpdateKefs()
    
    Dim wsBazaDate As Worksheet
    Dim wsFoglio1 As Worksheet
    
    Dim celListIndex As Range
    
    Dim celKefP1_1 As Range
    Dim celKefP1_2 As Range
    
    Dim celKefX_1 As Range
    Dim celKefX_2 As Range
    
    Dim celKefP2_1 As Range
    Dim celKefP2_2 As Range
    
    Dim celBeg As Range
    Dim celTarget As Range

    Set wsBazaDate = ThisWorkbook.Sheets("BazaDate")
    Set wsFoglio1 = ThisWorkbook.Sheets("Foglio1")

    With wsBazaDate
        Set celListIndex = .Range("B4")
        Set celKefP1_1 = .Range("L12")
        Set celKefP1_2 = .Range("L13")
        Set celKefX_1 = .Range("P12")
        Set celKefX_2 = .Range("P13")
        Set celKefP2_1 = .Range("R12")
        Set celKefP2_2 = .Range("R13")
    End With
    
    With wsFoglio1
        Set celBeg = .Range("AD1").End(xlDown).Offset(1)
        Set celTarget = celBeg.Cells(celListIndex * 2 - 1)
    End With
    
    'Stop
    
    With celKefP1_1
        .Value = celTarget.Cells(1, 1).Value
        .Interior.Color = celTarget.Cells(1, 1).Interior.Color
    End With
    
    With celKefP1_2
        .Value = celTarget.Cells(2, 1).Value
        .Interior.Color = celTarget.Cells(2, 1).Interior.Color
    End With
    
    With celKefX_1
        .Value = celTarget.Cells(1, 2).Value
        .Interior.Color = celTarget.Cells(1, 2).Interior.Color
    End With
    
    With celKefX_2
        .Value = celTarget.Cells(2, 2).Value
        .Interior.Color = celTarget.Cells(2, 2).Interior.Color
    End With
    
    With celKefP2_1
        .Value = celTarget.Cells(1, 3).Value
        .Interior.Color = celTarget.Cells(1, 3).Interior.Color
    End With
    
    With celKefP2_2
        .Value = celTarget.Cells(2, 3).Value
        .Interior.Color = celTarget.Cells(2, 3).Interior.Color
    End With
    
    'Stop

End Sub


Function fnwsFoglio2() As Worksheet
    Set fnwsFoglio2 = ThisWorkbook.Sheets("Foglio2")
End Function

Function fnwsFoglio1() As Worksheet
    Set fnwsFoglio1 = ThisWorkbook.Sheets("Foglio1")
End Function

Sub sbClearFoglio2()
    With fnwsFoglio2
        .Range(.Cells(2, 1), .Cells(.Rows.Count, 4)).ClearContents
    End With
End Sub

Sub sbGetDataFromWeb()
    
    Dim wsFoglio2 As Worksheet
    Dim i As Long
    Dim celPaste As Range
    
    sbClearFoglio2
    ufmWeb.Show 1
    
    If blnBtnOK = False Then Exit Sub
    
    Set oTables = gHTMLDocument.getElementsByClassName("schedule")
    'Debug.Print "oTables.Length = " & oTables.Length
    'Stop
    
    Set wsFoglio2 = fnwsFoglio2
    'Stop
    
    Set oTable = oTables(0)
    'Set oTable = oTables(1)
    'Stop
    
    Set oTableBodies = oTable.tBodies
    'Debug.Print "oTableBodies.Length = " & oTableBodies.Length
    'Stop
    
    Set oTableBody = oTableBodies(0)
    'Debug.Print "oTableBody.Rows.Length = " & oTableBody.Rows.Length
    'Stop
    
    For Each oTableRow In oTableBody.Rows
    
        If oTableRow.ID Like "tr_*" Then
        
            With wsFoglio2
                Set celPaste = .Cells(.Rows.Count, 1).End(xlUp).Offset(1)
                celPaste.Cells(1, 1).Value = oTableRow.Cells(0).innerText
                celPaste.Cells(1, 2).Value = oTableRow.Cells(1).innerText
                celPaste.Cells(1, 3).Value = oTableRow.Cells(2).innerText
                celPaste.Cells(1, 4).Value = oTableRow.Cells(10).innerText
            End With
        
        End If
        
    Next oTableRow
    
    sbCopyTime
    'Stop
    
End Sub

Sub sbCopyTime()
    Dim i As Long
    Dim rngTimeCopy As Range
    Dim rngTimePaste As Range
    Dim celBeg As Range
    Dim celEnd As Range
    With fnwsFoglio1
        Set celBeg = .Range("AB1").End(xlDown)
        Set celEnd = celBeg.End(xlDown)
        Set rngTimePaste = .Range(celBeg.Offset(1), celEnd.Offset(-1))
    End With
    With fnwsFoglio2
        Set rngTimeCopy = .Range(.Range("B2"), .Range("B1").End(xlDown))
    End With
    If rngTimeCopy.Rows.Count = rngTimePaste.Rows.Count / 2 Then
        'Stop
        For i = 1 To rngTimeCopy.Rows.Count
            rngTimePaste.Cells(i * 2 - 1, 1).Value = rngTimeCopy.Cells(i, 1)
        Next i
        'Stop
    End If
    'Stop
End Sub

Sub sbCalculation_OFF()
    Application.Calculation = xlCalculationManual
End Sub

Sub sbCalculation_ON()
    Application.Calculation = xlCalculationAutomatic
End Sub

Function fnrngColumnGonFoglio1() As Range
    
    Dim celBeg As Range
    Dim celEnd As Range
    Dim rngColumn As Range
    
    With Foglio1
        Set celBeg = .Range("A2")
        Set celEnd = .Cells(.Rows.Count, celBeg.Column).End(xlUp)
        Set fnrngColumnGonFoglio1 = .Range(.Cells(celBeg.Row, "G"), .Cells(celEnd.Row, "G"))
    End With
    
End Function

Sub sbSetActualListFillRange()
    ThisWorkbook.Sheets("BazaDate").[lista].ListFillRange = "Foglio1!" & fnrngColumnGonFoglio1.Address
End Sub

Function fnrngStatistic_1stRow() As Range
    With wsStatistic
        Set fnrngStatistic_1stRow = .Range(.Cells(2, "A"), .Cells(2, "AH"))
    End With
End Function

Function fnrngStatistic_Clear() As Range
    With wsStatistic
        Set fnrngStatistic_Clear = .Range(.Cells(3, "A"), .Cells(.Rows.Count, "AH"))
        If .AutoFilterMode Then .Range("A1").AutoFilter
    End With
End Function

Sub sbrngStatistic_Clear()
    fnrngStatistic_Clear.Clear
    sbrngRowDublicateAndClearContents fnrngStatistic_1stRow, fnrngColumnGonFoglio1.Rows.Count
End Sub

Sub sbrngRowDublicateAndClearContents(rngRow As Range, lngDublicateCount As Long)
    
    Dim rngPaste As Range
    Dim wsPaste As Worksheet
    
    'If lngDublicateCount < 2 Then Exit Sub
    
    Set wsPaste = rngRow.Parent
    
    With wsPaste
    
        Set rngPaste = rngRow.Resize(lngDublicateCount, rngRow.Columns.Count)
        rngRow.Copy
        rngPaste.PasteSpecial xlPasteAll
        Application.CutCopyMode = False
        rngPaste.ClearContents
    
    End With

End Sub

Function fncelPasteOnStatistic() As Range
    With wsStatistic
        Set fncelPasteOnStatistic = .Cells(.Rows.Count, "A").End(xlUp).Offset(1)
    End With
End Function

Sub sbrngStatisticFill()
    
    Dim lngLeague As Long
    Dim lngLeagueCount As Long
    Dim celPaste As Range
    Dim dtBeg As Date
    Dim strVal As String
    
    If vbNo = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion, constrPrjName) Then Exit Sub
    
    wsStatistic.Activate
    Application.ReferenceStyle = xlA1
    
    dtBeg = Now
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    sbrngStatistic_Clear
    lngLeagueCount = fnrngColumnLigaOnFoglio1.Rows.Count
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For lngLeague = 1 To lngLeagueCount
    
        Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & lngLeague & " / " & lngLeagueCount & " ( " & Format(Now - dtBeg, "hh:mm:ss") & " )"
        
        DoEvents
    
        sbUpdateListItemData lngLeague
        
        DoEvents
    
        Set celPaste = fncelPasteOnStatistic
        
        sbSelectRangeWithSheetVisible celPaste
        
        With fncelLeague_InColHead_League_OnFoglio1(lngLeague)
            
            '|fffd||fffd||fffd||fffd||fffd|
            'strVal = .Cells(1, 2).Value
            celPaste.Cells(, 1).Value = .Cells(1, 2).Value
            '|fffd||fffd||fffd||fffd|
            celPaste.Cells(, 2).Value = .Cells(1, 1).Value
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 3).Value = .Cells(1, 3).Value
            '|fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 4).Value = .Cells(1, 11).Value
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            'celPaste.Cells(, 5).Value = ""
            
            '|fffd||fffd||fffd||fffd||fffd| |fffd| %  |fffd||fffd| 1|fffd||fffd||fffd||fffd|
            '1) ='ZW2'!D23
            celPaste.Cells(, 6).Value = ['ZW2'!D23]
            '2) ='ZW2'!D24
            celPaste.Cells(, 7).Value = ['ZW2'!D24]
            '3) ='ZW2'!D25
            celPaste.Cells(, 8).Value = ['ZW2'!D25]
            
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd|
            '1)
            celPaste.Cells(, 9).Value = [CONCATENATE('ZW2'!I18,":",'ZW2'!J18)]
            '2)
            celPaste.Cells(, 10).Value = [CONCATENATE('ZW2'!I19,":",'ZW2'!J19)]
            '3)
            celPaste.Cells(, 11).Value = [CONCATENATE('ZW2'!I20,":",'ZW2'!J20)]
            
            'Stop
            
            '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1
            celPaste.Cells(, 12).Value = ['Analiz Sayfas?'!AG47]
            '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2
            celPaste.Cells(, 13).Value = ['Analiz Sayfas?'!AG48]
            '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1
            celPaste.Cells(, 14).Value = ['Analiz Sayfas?'!AF47]
            '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2
            celPaste.Cells(, 15).Value = ['Analiz Sayfas?'!AF48]
            
            '|fffd||fffd||fffd||fffd||fffd| |fffd| % |fffd||fffd| |fffd||fffd||fffd||fffd|
            '?Replace(ActiveCell.Formula,"=","?[") & "]"
            '1)
            celPaste.Cells(, 16).Value = ['ZW4'!D23]
            '2)
            celPaste.Cells(, 17).Value = ['ZW3'!AX14]
            '3)
            celPaste.Cells(, 18).Value = ['ZW4'!D25]
            
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            '1)
            celPaste.Cells(, 19).Value = [CONCATENATE('ZW4'!I18,":",'ZW4'!J18)]
            '2)
            celPaste.Cells(, 20).Value = [CONCATENATE('ZW4'!I19,":",'ZW4'!J19)]
            '3)
            celPaste.Cells(, 21).Value = [CONCATENATE('ZW4'!I20,":",'ZW4'!J20)]
            
            'Stop
            
            '|fffd||fffd||fffd| |fffd|1
'            celPaste.Cells(, 22).Value = .Cells(2, 4).Value
'            celPaste.Cells(, 22).Interior.Color = .Cells(2, 4).Interior.Color
            celPaste.Cells(, 22).Value = .Cells(1, 4).Value
            '|fffd||fffd||fffd| |fffd|
'            celPaste.Cells(, 23).Value = .Cells(2, 5).Value
'            celPaste.Cells(, 23).Interior.Color = .Cells(2, 5).Interior.Color
            celPaste.Cells(, 23).Value = .Cells(1, 5).Value
            '|fffd||fffd||fffd| |fffd|2
'            celPaste.Cells(, 24).Value = .Cells(2, 6).Value
'            celPaste.Cells(, 24).Interior.Color = .Cells(2, 6).Interior.Color
            celPaste.Cells(, 24).Value = .Cells(1, 6).Value
            
            '|fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| |fffd|1
            celPaste.Cells(, 25).Value = ['45W (2)'!B9]
            '|fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| |fffd|1
            celPaste.Cells(, 26).Value = ['45W (2)'!B10]
            
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| '45W (2)'
            '
            ' ['45W (2)'!B27] >> ='7V7'!G4+'7V7'!J4
            '
            ' ['45W (2)'!C23].Formula >> =IF('8P0'!C23=2,"|fffd||fffd|","|fffd||fffd||fffd|")
            '
            '
            '
            '
            '
            
            
            '1 |fffd||fffd||fffd||fffd|
            celPaste.Cells(, 27).Value = [Analysis!V9]
            '|fffd||fffd||fffd||fffd|
            celPaste.Cells(, 28).Value = [Analysis!W9]
            
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = ABS( [|fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| |fffd|1] - [|fffd||fffd|.|fffd||fffd||fffd||fffd||fffd| |fffd|1] )
            'celPaste.Cells(, 29).FormulaR1C1 = "=ABS(RC[-4]-RC[-3])"
            celPaste.Cells(, 29).Value = fnvarAbsDifference(celPaste.Cells(, 25), celPaste.Cells(, 26))
            
            '|fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 30).Value = [Analysis!X9]
            '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 31).Value = [Analysis!Y9]
            '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 32).Value = [Analysis!Z9]
            '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 33).Value = [Analysis!AA9]
            '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            celPaste.Cells(, 34).Value = [Analysis!AB9]
        End With
    Next lngLeague
    
    wsStatistic.Range("A1").CurrentRegion.AutoFilter
    
    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", vbInformation, constrPrjName
    Application.StatusBar = ""

End Sub

Function fnrngColumnLigaOnFoglio1() As Range
    With Foglio1
        Set fnrngColumnLigaOnFoglio1 = .Range(.Range("A2"), .Cells(.Rows.Count, "A").End(xlUp))
    End With
End Function

Function fncelColHead_League_OnFoglio1() As Range
    With Foglio1
        Set fncelColHead_League_OnFoglio1 = .Range("AD1").End(xlDown).Offset(, -3) ' .Range("AA132")
    End With
End Function

Function fncelLeague_InColHead_League_OnFoglio1(lngLeague As Long) As Range
    With fncelColHead_League_OnFoglio1
        Set fncelLeague_InColHead_League_OnFoglio1 = .Offset((lngLeague - 1) * 2 + 1)
    End With
End Function

Sub sbSelectRangeWithSheetVisible(rng As Range)
    Dim ws As Worksheet
    Set ws = rng.Parent
    ws.Visible = xlSheetVisible
    ws.Activate
    rng.Select
End Sub

Sub sbUpdateListItemData(lngListItem As Long)
    With wsBazaDate
        .Range("B4").Value = lngListItem
        MacroSS
    End With
End Sub

Function fnvarAbsDifference(cel_1 As Range, cel_2 As Range)
    fnvarAbsDifference = "#|fffd||fffd||fffd||fffd|!"
    On Error Resume Next
    fnvarAbsDifference = Abs(cel_1.Value - cel_2.Value)
End Function

Sub sbGetScore()
    
    Dim dicTeams As Dictionary
    Dim rngColumn As Range
    Dim cel As Range
    Dim strKey As String
    Dim strKeyDate As String
    Dim i As Long
    Dim celPaste As Range
    Dim dtBeg As Date
    Dim arrDatePart
    
    If vbNo = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion, constrPrjName) Then Exit Sub
    
    dtBeg = Now
    
    wsStatistic.Activate
    'Stop
    
    Set rngColumn = fnrngColumn(wsStatistic.Range("A2"))
    'rngColumn.Select
    'rngColumn.Copy
    'Stop
    
    If rngColumn Is Nothing Then
        'Stop
        MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical, constrPrjName
    Else
        Set dicTeams = New Dictionary
        For Each cel In rngColumn
            'strKey = cel.Value & "^" & cel.Offset(, 1).Value & "^" & cel.Offset(, 2).Value & "^" & cel.Offset(, 3).Value
            'strKey = cel.Value & "^" & cel.Offset(, 1).Value & "^" & cel.Offset(, 3).Value
            strKey = Left(cel.Value, 5) & "^" & cel.Offset(, 1).Value & "^" & cel.Offset(, 3).Value
            dicTeams.Add strKey, cel.Offset(, 4)
        Next cel
        
        If bDebug Then Debug.Print "dicTeams.Count = " & dicTeams.Count
        If bDebug Then Stop
        
        ufmWebGetScore.Show 1
        If blnBtnOK = False Then Exit Sub
        
        Set oTable = gHTMLDocument.getElementById("table_live")
        If bDebug Then Debug.Print "oTable.rows.length = " & oTable.Rows.Length
        If bDebug Then Stop
        
        Application.Calculation = xlCalculationManual
    
        strKeyDate = ""
        For i = 1 To oTable.Rows.Length
            
            Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: " & i & " / " & oTable.Rows.Length & " ( " & Format(Now - dtBeg, "hh:mm:ss") & " )"
            'DoEvents
            
            Set oTableRow = oTable.Rows(i - 1)
            'Debug.Print "oTableRow.cells.length = " & oTableRow.Cells.Length
            'Stop
            If oTableRow.Cells.Length = 1 Then
                If IsDate(Left(oTableRow.Cells(0).innerText, 10)) Then
                    If bDebug Then Debug.Print "oTableRow.Cells(0).innerText = " & oTableRow.Cells(0).innerText
                    'strKeyDate = Format(DateValue(Left(oTableRow.Cells(0).innerText, 10)), "mm/dd")
                    'strKeyDate = Left(oTableRow.Cells(0).innerText, 5)
                    arrDatePart = Split(Left(oTableRow.Cells(0).innerText, 5), "/")
                    strKeyDate = Format(arrDatePart(0), "00") & "/" & Format(arrDatePart(1), "00")
                    If bDebug Then Debug.Print "strKeyDate = " & strKeyDate
                    If bDebug Then Stop
                End If
            End If
            If strKeyDate <> "" Then
                If oTableRow.Cells.Length = 9 Then
                    'Debug.Print "oTableRow.Cells(1).innerText = " & oTableRow.Cells(1).innerText
                    
                    'strKey = strKeyDate & " " & oTableRow.Cells(2).innerText & "^" & Replace(Replace(Trim(oTableRow.Cells(1).innerText), "(a)", "") & "^" & Trim(oTableRow.Cells(4).innerText) & "^" & Trim(oTableRow.Cells(6).innerText), "(N)", "")
                    'strKey = strKeyDate & " " & oTableRow.Cells(2).innerText & "^" & Replace(Trim(oTableRow.Cells(1).innerText), "(a)", "") & "^" & Trim(oTableRow.Cells(4).innerText) & "^" & Trim(oTableRow.Cells(6).innerText)
                    
                    'strKey = strKeyDate & " " & oTableRow.Cells(2).innerText & "^" & fnstrMultiReplace(Trim(oTableRow.Cells(1).innerText), "", "(a)", "(c)", "off") & "^" & Trim(oTableRow.Cells(4).innerText) & "^" & Trim(oTableRow.Cells(6).innerText)
                    'strKey = strKeyDate & " " & oTableRow.Cells(2).innerText & "^" & fnstrMultiReplace(Trim(oTableRow.Cells(1).innerText), "", "(a)", "(c)", "off") & "^" & Trim(oTableRow.Cells(6).innerText)
                    strKey = strKeyDate & "^" & fnstrMultiReplace(Trim(oTableRow.Cells(1).innerText), "", "(a)", "(c)", "off") & "^" & Trim(oTableRow.Cells(6).innerText)
                    
                    'If bDebug Then Debug.Print "strKey = """ & strKey & """"
                    'If bDebug Then Stop
                    
                    If dicTeams.Exists(strKey) Then
                        Set celPaste = dicTeams(strKey)
                        'If bDebug Then celPaste.Select
                        'If bDebug Then Stop
                        celPaste.Value = oTableRow.Cells(5).innerText
                        'If bDebug Then Stop
                    Else
                        'If bDebug Then Stop
                    End If
                Else
                    'If bDebug Then Stop
                End If
            End If
        Next i
        
        MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbInformation, constrPrjName
        Application.Calculation = xlCalculationAutomatic
        Application.StatusBar = ""
        'Stop
    
    End If
    
End Sub

Function fnrngColumn(celBeg As Range) As Range
    Dim ws As Worksheet
    Dim celEnd As Range
    Set ws = celBeg.Parent
    With ws
        Set celEnd = .Cells(.Rows.Count, celBeg.Column).End(xlUp)
        If celEnd.Row >= celBeg.Row Then
            Set fnrngColumn = .Range(celBeg, celEnd)
        End If
    End With
End Function

Function fnstrMultiReplace(ByVal strText As String, strReplaceWith As String, ParamArray arrFind() As Variant) As String
    Dim v As Variant
    Dim strTextNew As String
    strTextNew = strText
    For Each v In arrFind
        strTextNew = Replace(strTextNew, v, strReplaceWith)
    Next
    fnstrMultiReplace = strTextNew
End Function

Sub sbTEST__fnstrMultiReplace()
    Debug.Print fnstrMultiReplace("SLV D1(a)", "", "(a)", "(c)", "off")
    Debug.Print fnstrMultiReplace("BOL D1(c)", "", "(a)", "(c)", "off")
    Debug.Print fnstrMultiReplace("COL D2off", "", "(a)", "(c)", "off")
End Sub
Attribute VB_Name = "ufmWeb"
Attribute VB_Base = "0{3D96D9C1-CB44-4850-981E-D7C19249E19E}{64CF665F-A055-4635-85B8-D6CED16F832C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub btnClose_Click()
    If vbNo = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion, "") Then Exit Sub
    Unload Me
End Sub

Private Sub btnGO_Click()
    
    Me.WebBrowser1.Silent = True
    Me.WebBrowser1.navigate Me.TextBox1.Text

End Sub

Private Sub btnOK_Click()
    blnBtnOK = True
    Set gHTMLDocument = WebBrowser1.document
    Unload Me
End Sub

Private Sub UserForm_Initialize()
    blnBtnOK = False
    Me.TextBox1.Text = "http://data.goaloo.com/1x2/index.htm"
    btnGO_Click
End Sub

Attribute VB_Name = "ufmWebGetScore"
Attribute VB_Base = "0{19E3A07D-FF80-487E-829A-78EDF63BEB52}{41700B76-B2C1-4C50-9B43-31DF7140A3E7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Option Explicit

Private Sub btnClose_Click()
    If vbNo = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNo + vbQuestion, "") Then Exit Sub
    Unload Me
End Sub

Private Sub btnGO_Click()
    
    Me.WebBrowser1.Silent = True
    Me.WebBrowser1.navigate Me.TextBox1.Text

End Sub

Private Sub btnOK_Click()
    blnBtnOK = True
    Set gHTMLDocument = WebBrowser1.document
    Unload Me
End Sub

Private Sub UserForm_Initialize()
    blnBtnOK = False
    Me.TextBox1.Text = "http://www.goaloo.com/results.htm"
    btnGO_Click
End Sub

Attribute VB_Name = "wsBazaDate"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wsStatistic"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "????1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "????4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "????8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' YQjx

INQUEST-PP=macro
