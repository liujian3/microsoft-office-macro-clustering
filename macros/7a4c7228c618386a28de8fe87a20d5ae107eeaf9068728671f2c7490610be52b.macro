Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "btn7, 6, 0, MSForms, CommandButton"
Attribute VB_Control = "btn6, 5, 1, MSForms, CommandButton"
Attribute VB_Control = "btn5, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "btn2, 3, 3, MSForms, CommandButton"
Attribute VB_Control = "btn1, 2, 4, MSForms, CommandButton"
Const regionalni = "Regional"
Const artpas = "A-Pass"
Private Sub btn3_Click()
  addchild
End Sub

Private Sub btn4_Click()
  delchild
End Sub

Private Sub btn1_Click()
  addlineME
'  If (Left(Range(Cells(Selection.Row, 2), Cells(Selection.Row + 1, 2)).Name.Name, Len(Range(Cells(Selection.Row, 2), Cells(Selection.Row + 1, 2)).Name.Name) - 3)) = "UMRENB_" Then addlineME "UMRENB_", "MESUBB_"
'  If (Left(Range(Cells(Selection.Row, 2), Cells(Selection.Row + 1, 2)).Name.Name, Len(Range(Cells(Selection.Row, 2), Cells(Selection.Row + 1, 2)).Name.Name) - 3)) = "UMREN_" Then addlineME "UMREN_", "MESUB_"
End Sub

Private Sub btn2_Click()
  dellineME
End Sub

Private Sub btn5_Click()
  childform
End Sub

Private Sub btn6_Click()
  addlineDISP
End Sub

Private Sub btn7_Click()
  dellineDISP
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim title As Variant
  Dim lbl_vybrfil As Variant
  Dim btn_odebrat As Variant
  Dim btn_import As Variant
  Dim btn_matka As Variant
  Dim btn_pridat As Variant
  Dim btn_ulozit As Variant
  Dim lbl_fil As Variant
  Dim x As Integer
  On Error GoTo 10
  If Target.Address = "$M$2" Then
    Select Case Target
      Case "DE"
       lang = 1
      Case "CZ"
       lang = 2
      Case "SK"
       lang = 3
      Case "HR"
       lang = 4
      Case "PL"
       lang = 5
      Case "RO"
       lang = 6
      Case "BG"
       lang = 7
      Case "EN"
       lang = 8
      Case "???"
       lang = 99
    End Select
    If lang <> 99 Then
      On Error GoTo 0
      languagesel 1
    End If
  End If
  If Target.Address = "$M$3" Then
    Select Case Target
      Case "DE"
       lang = 1
      Case "CZ"
       lang = 2
      Case "SK"
       lang = 3
      Case "HR"
       lang = 4
      Case "PL"
       lang = 5
      Case "RO"
       lang = 6
      Case "BG"
       lang = 7
      Case "EN"
       lang = 8
      Case "???"
       lang = 99
    End Select
    If lang <> 99 Then
      On Error GoTo 0
      languagesel 2
    End If
  End If
  If Target.Address = "$S$2" Then
    Select Case Target
      Case "KI"
       lang = 9
      Case "CZ"
       lang = 2
      Case "SK"
       lang = 3
      Case "HR"
       lang = 4
      Case "PL"
       lang = 5
      Case "RO"
       lang = 6
      Case "BG"
       lang = 7
    End Select
    On Error GoTo 0
    zmenazeme
  End If
  If Left(Target.Name.Name, 5) = "SSTUF" And UCase(Target.Value) = "R" Then
    'If Len(Target.Name.Name) = 5 Then formregion.btn_matka.Visible = False Else formregion.btn_matka.Visible = True
    formregion.Caption = hlaska(17)
    formregion.lbl_vybrfil.Caption = hlaska(18)
    formregion.btn_odebrat.Caption = hlaska(19)
    formregion.btn_import.Caption = hlaska(20)
    formregion.btn_ulozit.Caption = hlaska(23)
    'formregion.btn_matka.Caption = hlaska(21)
    formregion.btn_pridat.Caption = hlaska(22)
    formregion.lbl_fil.Caption = hlaska(24)
    On Error GoTo 0
    regform (Target.Name.Name)
  End If
10 End Sub







Attribute VB_Name = "List24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Global lang As Byte
Const texty = "Textfeld"
Const rolety = "Settings"
Const lokalni = "lokal"
Const artpas = "A-Pass"
Const wine = "Weinetikett"
Const mineral = "Mineralis."
Const regionalni = "Regional"
Const backshop = "Langtext"
Const whisky = "Whiskey"
Const nf = "NF"
Const polenw = "Fields"
Const zeme = "L|fffd|nder"
Const hlasky = "Messages"
Const novaverzeCZ = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathCZ = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzeKI = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathKI = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzeSK = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathSK = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzeHR = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathHR = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzePL = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathPL = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzeRO = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathRO = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const novaverzeBG = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\A-Pass KMO update"
Const versionpathBG = "\\de.int.kaufland\global\ki\ek\vertraege-handbuecher\aktuell\Formulare u. Vorlagen\Artikelpass_Lieferantenstammblatt\version.txt"
Const heslo = "autobus"
Dim jechyba As Boolean
Sub languagesel(numb As Byte)
  'Macro mhav1304 3.12.2013
  Dim y As Long
  Dim pocetdeti As Integer
  Dim pocetd As String
  Dim cykl As Integer
  Application.ScreenUpdating = False
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  Sheets(wine).Unprotect Password:=heslo
  Sheets(mineral).Unprotect Password:=heslo
  Sheets(backshop).Unprotect Password:=heslo
  Sheets(whisky).Unprotect Password:=heslo
  Sheets(nf).Unprotect Password:=heslo
  y = 2
  pocetdeti = pocetr("komponent_display_001")
  On Error Resume Next
  Do
    If Left(Sheets(texty).Cells(y, 3), 1) = "t" Then
      If Mid(Sheets(texty).Cells(y, 3), 3, 1) = "?" Then
        For cykl = 1 To pocetdeti
          If numb = 1 Then Range(Left(Sheets(texty).Cells(y, 3), 3) & Format(cykl, "000") & Right(Sheets(texty).Cells(y, 3), Len(Sheets(texty).Cells(y, 3)) - 3)) = Sheets(texty).Cells(y, lang + 3)
          If numb = 2 Then Range(Left(Sheets(texty).Cells(y, 3), 3) & Format(cykl, "000") & Mid(Sheets(texty).Cells(y, 3), 4, Len(Sheets(texty).Cells(y, 3)) - 5) & "L2") = Sheets(texty).Cells(y, lang + 3)
        Next cykl
      Else
        If numb = 1 Then Range(Sheets(texty).Cells(y, 3)) = Sheets(texty).Cells(y, lang + 3)
        If numb = 2 Then Range(Left(Sheets(texty).Cells(y, 3), Len(Sheets(texty).Cells(y, 3)) - 2) & "L2") = Sheets(texty).Cells(y, lang + 3)
      End If
    End If
    y = y + 1
  Loop While Sheets(texty).Cells(y, 3) <> ""
  If numb = 1 Then srolety "SPRACHE"
  On Error GoTo 0
  ActiveSheet.Protect Password:=heslo
  Sheets(wine).Protect Password:=heslo
  Sheets(mineral).Protect Password:=heslo
  Sheets(backshop).Protect Password:=heslo
  Sheets(whisky).Protect Password:=heslo
  Sheets(nf).Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
  Application.ScreenUpdating = True
  On Error GoTo 0
End Sub

Sub zmenazeme()
  Application.ScreenUpdating = False
  Dim maxcis As Integer
  Dim cykl1 As Integer
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  Sheets(wine).Unprotect Password:=heslo
  Sheets(mineral).Unprotect Password:=heslo
  Sheets(backshop).Unprotect Password:=heslo
  Sheets(whisky).Unprotect Password:=heslo
  Sheets(nf).Unprotect Password:=heslo
  kopylokal "lokal1_begin", "lokal1_end", False
  kopylokal "lokal2_begin", "lokal2_end", True
  Range("LAND").Select
  srolety "LAND"
  landof
  Sheets(artpas).Select
  deleteenabled
  enablestandardfields 3, "Artpas"
  Select Case Range("LAND")
    Case "CZ"
    enablestandardfields 9, "CZ"
    Case "BG"
    enablestandardfields 10, "BG"
    Case "PL"
    enablestandardfields 11, "PL"
    Case "RO"
    enablestandardfields 12, "RO"
    Case "SK"
    enablestandardfields 13, "SK"
    Case "HR"
    enablestandardfields 14, "HR"
  End Select
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  maxcis = pocetr("MEINHB_001")
  For cykl1 = 1 To maxcis
    ActiveSheet.Protection.AllowEditRanges.Add title:="MerneB" & Format(cykl1, "000"), Range:=Range("UMRENB_" & Format(cykl1, "000") & ":UMREZB_" & Format(cykl1, "000") & ",KZBMEB_" & Format(cykl1, "000") & ":MESUBB_" & Format(cykl1, "000"))
  Next cykl1
  maxcis = pocetr("MEINH_001")
  For cykl1 = 1 To maxcis
    ActiveSheet.Protection.AllowEditRanges.Add title:="Merne" & Format(cykl1, "000"), Range:=Range("UMREN_" & Format(cykl1, "000") & ":UMREZ_" & Format(cykl1, "000") & ",KZBME_" & Format(cykl1, "000") & ":BRGEW_" & Format(cykl1, "000") & ",GEWEI_" & Format(cykl1, "000") & ":MESUB_" & Format(cykl1, "000"))
  Next cykl1
  maxcis = pocetr("komponent_display_001")
  For cykl1 = 1 To maxcis
    ActiveSheet.Protection.AllowEditRanges.Add title:="Display" & Format(cykl1, "000"), Range:=Range("komponent_display_" & Format(cykl1, "000") & "," & ("stck_display_" & Format(cykl1, "000")))
  Next cykl1
  Range("landlief_zoll").Value = ""
  Range("eulief_zoll").Value = ""
  Range("nonzoll").Value = ""
  pocetznaku
  'Range("A216:A65536").EntireRow.Hidden = True
  ActiveSheet.Protect Password:=heslo
  Sheets(wine).Protect Password:=heslo
  Sheets(mineral).Protect Password:=heslo
  Sheets(backshop).Protect Password:=heslo
  Sheets(whisky).Protect Password:=heslo
  Sheets(nf).Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
  Application.ScreenUpdating = True
End Sub

Sub kopylokal(zacatek As String, konec As String, druhy As Boolean)
  Dim ya As Long
  Dim yb As Long
  Dim apasy As Long
  Dim cykl As Byte
  Dim cykl1 As Byte
  Dim jmeno As String
  If Range(konec).Row - Range(zacatek).Row <> 1 Then
    Range(Cells(Range(zacatek).Row + 1, 1), Cells(Range(konec).Row - 1, 1)).EntireRow.Delete
  End If
  ya = 0
  Do
    ya = ya + 1
    If Sheets(lokalni).Cells(ya, 1) = "E_N_D" Then Exit Sub
  Loop While Sheets(lokalni).Cells(ya, 2) <> Range("LAND").Value
  ya = ya + 1
  yb = ya
  Do
    yb = yb + 1
  Loop While Sheets(lokalni).Cells(yb, 2) <> "E_N_D"
  If druhy = True Then
    ya = yb + 2
    yb = ya
    Do
      yb = yb + 1
    Loop While Sheets(lokalni).Cells(yb, 2) <> "E_N_D"
  End If
  yb = yb - 1
  Range(konec).Select
  For cykl = ya To yb
    ActiveCell.EntireRow.Insert
    ActiveCell.RowHeight = Sheets(lokalni).Cells(cykl, 1).RowHeight
  Next cykl
  Sheets(lokalni).Visible = True
  Sheets(lokalni).Select
  Sheets(lokalni).Range(Cells(ya, 1), Cells(yb, 60)).Copy
  Sheets(artpas).Select
  Range(zacatek).Select
  ActiveCell.Offset(1, 0).Select
  ActiveSheet.Paste
  Application.CutCopyMode = False
  Sheets(lokalni).Select
  On Error Resume Next
  apasy = Sheets(artpas).Range(zacatek).Row + 1
  For cykl = ya To yb
    For cykl1 = 1 To 60
      Err.Clear
      jmeno = Range(Cells(cykl, cykl1), Cells(cykl, cykl1)).Name.Name
      If Err = 0 Then
        Sheets(artpas).Select
        Sheets(artpas).Range(Sheets(artpas).Cells(apasy, cykl1 + 1), Sheets(artpas).Cells(apasy, cykl1 + 1)).Name = Left(jmeno, Len(jmeno) - 3)
        Sheets(lokalni).Select
      End If
    Next cykl1
    apasy = apasy + 1
  Next cykl
  On Error GoTo 0
  Sheets(lokalni).Visible = False
  Sheets(artpas).Select
End Sub

Sub srolety(jazyk As String)
  Dim yr As Long
  Dim zacatek As Long
  Dim bunka As String
  Dim chyba As Byte
  Dim cisroletky As Byte
  Dim hotovo As Boolean
  Dim listst As String
  Dim pocetradkusr As Integer
  Dim listrol As Variant
  Dim cykl As Byte
  Dim hodnoty(1 To 50) As String
  Dim preklhodn As Boolean
  preklhodn = False
  listrol = Array(wine, mineral, backshop)
  pocetradkusr = pocetr("MEINS_000")
  pocetradkusr = pocetradkusr + pocetr("MEINSB_000")
  yr = pocetradkusr * 2
  pocetradkusr = pocetr("komponent_display_001") * 3
  yr = yr + pocetradkusr + 290
  On Error Resume Next
  Do
    If UCase(Sheets(artpas).Cells(yr, 1)) = jazyk Then
      preklhodn = False
      If Sheets(artpas).Cells(yr, 3) <> "lim" Then
        bunka = Sheets(artpas).Cells(yr, 2).Value
        yr = yr + 1
        zacatek = yr
        'if ucase(left(sheets(artpas).cells(yr+1,3),1))="T" then hbunky=right
        Do While UCase(Sheets(artpas).Cells(yr, lang * 2 + 2)) <> "E_N_D"
          If UCase(Left(Sheets(artpas).Cells(yr, 3), 1)) = "T" Then
            hodnoty(Val(Mid(Sheets(artpas).Cells(yr, 3), 2, 3))) = Sheets(artpas).Cells(yr, lang * 2 + 2)
            preklhodn = True
          End If
          yr = yr + 1
        Loop
        If zacatek <> yr Then
          chyba = 0
          cisroletky = 1
          hotovo = False
          If Right(bunka, 1) <> "_" Then
            With Range(bunka).Validation
              .Delete
              .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
              xlBetween, Formula1:="=" & Range(Sheets(artpas).Cells(zacatek, lang * 2 + 2), Sheets(artpas).Cells(yr - 1, lang * 2 + 2)).Address
              .IgnoreBlank = False
              .InCellDropdown = True
              .InputTitle = ""
              .ErrorTitle = ""
              .InputMessage = ""
              .ErrorMessage = ""
              .ShowInput = True
              .ShowError = True
            End With
            If preklhodn Then Range(bunka).Value = hodnoty(Val(Right(Range(bunka).Value, 3)))
          Else
            Do
              Err.Clear
              With Range(bunka & Format(cisroletky, "000")).Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=" & Range(Sheets(artpas).Cells(zacatek, lang * 2 + 2), Sheets(artpas).Cells(yr - 1, lang * 2 + 2)).Address
                .IgnoreBlank = False
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
              End With
              If preklhodn Then Range(bunka & Format(cisroletky, "000")).Value = hodnoty(Val(Right(Range(bunka & Format(cisroletky, "000")).Value, 3)))
              cisroletky = cisroletky + 1
              If Err <> 0 Then chyba = chyba + 1 Else chyba = 0
              If chyba = 5 Then hotovo = True
            Loop While hotovo <> True
          End If
        Else
          If Right(bunka, 1) <> "_" Then
            With Range(bunka).Validation
              .Delete
              .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
              xlBetween, Formula1:="=$AG$300"
              .IgnoreBlank = False
              .InCellDropdown = True
              .InputTitle = ""
              .ErrorTitle = ""
              .InputMessage = ""
              .ErrorMessage = ""
              .ShowInput = True
              .ShowError = True
            End With
          Else
            With Range(bunka & Format(cisroletky, "000")).Validation
              .Delete
              .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
              xlBetween, Formula1:="=$AG$300"
              .IgnoreBlank = False
              .InCellDropdown = True
              .InputTitle = ""
              .ErrorTitle = ""
              .InputMessage = ""
              .ErrorMessage = ""
              .ShowInput = True
              .ShowError = True
            End With
          End If
        End If
      Else
        bunka = Sheets(artpas).Cells(yr, 2).Value
        yr = yr + 1
        Range(bunka) = (Sheets(artpas).Cells(yr, lang * 2 + 2))
      End If
    End If
    yr = yr + 1
  Loop While Sheets(artpas).Cells(yr, 1).Value <> "E_N_D"
  '  --  ostatni listy roletky
  For cykl = LBound(listrol) To UBound(listrol)
    yr = 300
    Do
      If UCase(Sheets(listrol(cykl)).Cells(yr, 1)) = jazyk Then
        If UCase(Sheets(listrol(cykl)).Cells(yr, 3)) <> "LIM" Then
          bunka = Sheets(listrol(cykl)).Cells(yr, 2).Value
          yr = yr + 1
          zacatek = yr
          Do While UCase(Sheets(listrol(cykl)).Cells(yr, lang * 2 + 2)) <> "E_N_D"
            yr = yr + 1
          Loop
          If zacatek <> yr Then
            chyba = 0
            cisroletky = 1
            hotovo = False
            listst = listrol(cykl) 'Mid(Range(bunka).Address(External:=True), InStr(1, Range(bunka).Address(External:=True), "]") + 1, InStr(1, Range(bunka).Address(External:=True), "!") - (InStr(1, Range(bunka).Address(External:=True), "]") + 2))
            If Right(bunka, 1) <> "_" Then
              With Range(bunka).Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=" & Range(Sheets(listst).Cells(zacatek, lang * 2 + 2), Sheets(listst).Cells(yr - 1, lang * 2 + 2)).Address
                .IgnoreBlank = False
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
              End With
            Else
              Do
                Err.Clear
                With Range(bunka & Format(cisroletky, "000")).Validation
                  .Delete
                  .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                  xlBetween, Formula1:="=" & Range(Sheets(listst).Cells(zacatek, lang * 2 + 2), Sheets(listst).Cells(yr - 1, lang * 2 + 2)).Address
                  .IgnoreBlank = False
                  .InCellDropdown = True
                  .InputTitle = ""
                  .ErrorTitle = ""
                  .InputMessage = ""
                  .ErrorMessage = ""
                  .ShowInput = True
                  .ShowError = True
                End With
                cisroletky = cisroletky + 1
                If Err <> 0 Then chyba = chyba + 1 Else chyba = 0
                If chyba = 5 Then hotovo = True
              Loop While hotovo <> True
            End If
          Else
            If Right(bunka, 1) <> "_" Then
              With Range(bunka).Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AG$300"
                .IgnoreBlank = False
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
              End With
            Else
              With Range(bunka & Format(cisroletky, "000")).Validation
                .Delete
                .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="=$AG$300"
                .IgnoreBlank = False
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
              End With
            End If
          End If
        Else
          bunka = Sheets(listrol(cykl)).Cells(yr, 2).Value
          yr = yr + 1
          Range(bunka) = (Sheets(listrol(cykl)).Cells(yr, lang * 2 + 2))
        End If
      End If
      yr = yr + 1
    Loop While Sheets(listrol(cykl)).Cells(yr, 1).Value <> "E_N_D"
  Next cykl
  On Error GoTo 0
End Sub

Sub addlineME()
  Dim cykl As Byte
  Dim cykl1 As Integer
  Dim maxcis As Integer
  Dim prvnir As Integer
  Dim poslednir As Integer
  Dim minozn As Integer
  Dim maxozn As Integer
  Dim jmenoz As String
  Dim jmenok As String
  Dim pole As Variant
  'Application.EnableEvents = False
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  pole = Array("UMREN", "MEINH", "UMREZ", "MEINS", "KZBME", "KZBSTME", "KZAUSME", "KZVRKME", "EAN11_tab", "BRGEW", "NTGEW", "GEWEI", "LAENG", "BREIT", "HOEHE", "MESUB")
  On Error Resume Next
  Err.Clear
  prvnir = Selection.Rows(1).Row
  poslednir = Selection.Rows.Count + prvnir - 1
  jmenoz = Range("B" & prvnir & ":B" & prvnir).Name.Name
  jmenok = Range("B" & poslednir - 1 & ":B" & poslednir - 1).Name.Name
  If Left(jmenoz, 5) = "UMREN" Then
    If Left(jmenoz, Len(jmenoz) - 4) = Left(jmenok, Len(jmenok) - 4) Then
      If Err <> 0 Then
        'Application.EnableEvents = True
        End
      End If
      Application.ScreenUpdating = False
      maxcis = pocetr(jmenoz)
      On Error GoTo 0
      Range("B" & prvnir & ":B" & poslednir).EntireRow.Select
      Selection.Copy
      Selection.Insert shift:=xlDown
      Application.CutCopyMode = False
      minozn = Right(jmenoz, 3)
      maxozn = Right(jmenok, 3)
      For cykl1 = maxcis To minozn Step -1
        For cykl = LBound(pole) To UBound(pole)
          If Left(Right(jmenoz, 5), 1) <> "B" Then
            ActiveWorkbook.Names(pole(cykl) & "_" & Format(cykl1, "000")).Name = pole(cykl) & "_" & Format(cykl1 + maxozn - minozn + 1, "000")
          Else
            ActiveWorkbook.Names(pole(cykl) & "B_" & Format(cykl1, "000")).Name = pole(cykl) & "B_" & Format(cykl1 + maxozn - minozn + 1, "000")
          End If
        Next cykl
      Next cykl1
      Range("B" & prvnir).Select
      For cykl1 = minozn To maxozn
        For cykl = LBound(pole) To UBound(pole)
          If Left(Right(jmenoz, 5), 1) <> "B" Then
            ActiveCell.Name = pole(cykl) & "_" & Format(cykl1, "000")
            If pole(cykl) = "EAN11_tab" Then Range("EAN11_tab_" & Format(cykl1, "000")).Formula = Null
'            If pole(cykl) = "KZBME" Then Range("KZBME_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZBSTME" Then Range("KZBSTME_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZAUSME" Then Range("KZAUSME_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZVRKME" Then Range("KZVRKME_" & Format(cykl1, "000")).Formula = ""
          Else
            ActiveCell.Name = pole(cykl) & "B_" & Format(cykl1, "000")
            If pole(cykl) = "EAN11_tab" Then Range("EAN11_tabB_" & Format(cykl1, "000")).Formula = Null
'            If pole(cykl) = "KZBME" Then Range("KZBMEB_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZBSTME" Then Range("KZBSTMEB_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZAUSME" Then Range("KZAUSMEB_" & Format(cykl1, "000")).Formula = ""
'            If pole(cykl) = "KZVRKME" Then Range("KZVRKMEB_" & Format(cykl1, "000")).Formula = ""
          End If
          ActiveCell.Offset(0, 1).Select
        Next cykl
        ActiveCell.Offset(2, 0).Select
        Range("B" & ActiveCell.Row).Select
      Next cykl1
      basicmj
      '------- povolene bunky --------
      On Error Resume Next
      cykl1 = 1
      Do While Err = 0
        If Left(Right(jmenoz, 5), 1) <> "B" Then
          ActiveSheet.Protection.AllowEditRanges("Merne" & Format(cykl1, "000")).Delete
        Else
          ActiveSheet.Protection.AllowEditRanges("MerneB" & Format(cykl1, "000")).Delete
        End If
        cykl1 = cykl1 + 1
      Loop
      On Error GoTo 0
      maxcis = pocetr(jmenoz)
      For cykl1 = 1 To maxcis
        If Left(Right(jmenoz, 5), 1) <> "B" Then
          ActiveSheet.Protection.AllowEditRanges.Add title:="Merne" & Format(cykl1, "000"), Range:=Range("UMREN_" & Format(cykl1, "000") & ":UMREZ_" & Format(cykl1, "000") & ",KZBME_" & Format(cykl1, "000") & ":BRGEW_" & Format(cykl1, "000") & ",GEWEI_" & Format(cykl1, "000") & ":MESUB_" & Format(cykl1, "000"))
        Else
          ActiveSheet.Protection.AllowEditRanges.Add title:="MerneB" & Format(cykl1, "000"), Range:=Range("UMRENB_" & Format(cykl1, "000") & ":UMREZB_" & Format(cykl1, "000") & ",KZBMEB_" & Format(cykl1, "000") & ":MESUBB_" & Format(cykl1, "000"))
        End If
      Next cykl1
    Else
      MsgBox hlaska(4), vbExclamation
    End If
    Application.ScreenUpdating = True
    Cells(prvnir, 2).Select
  End If
  'Application.EnableEvents = True
  ActiveSheet.Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
  On Error GoTo 0
End Sub

Sub dellineME()
  Dim cykl As Byte
  Dim cykl1 As Integer
  Dim maxcis As Integer
  Dim prvnir As Integer
  Dim poslednir As Integer
  Dim minozn As Integer
  Dim maxozn As Integer
  Dim jmenoz As String
  Dim jmenok As String
  Dim pole As Variant
  Dim msg1 As Variant
  Dim msg2 As Variant
  'Application.EnableEvents = False
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  pole = Array("UMREN", "MEINH", "UMREZ", "MEINS", "KZBME", "KZBSTME", "KZAUSME", "KZVRKME", "EAN11_tab", "BRGEW", "NTGEW", "GEWEI", "LAENG", "BREIT", "HOEHE", "MESUB")
  On Error Resume Next
  Err.Clear
  prvnir = Selection.Rows(1).Row
  poslednir = Selection.Rows.Count + prvnir - 1
  jmenoz = Range("B" & prvnir & ":B" & prvnir).Name.Name
  jmenok = Range("B" & poslednir - 1 & ":B" & poslednir - 1).Name.Name
  If Left(jmenoz, 5) = "UMREN" Then
    If Left(jmenoz, Len(jmenoz) - 4) = Left(jmenok, Len(jmenok) - 4) Then
      If Err <> 0 Then
        'Application.EnableEvents = True
        End
      End If
      Application.ScreenUpdating = False
      maxcis = pocetr(jmenoz)
      On Error GoTo 0
      If (Right(jmenoz, 3) <> "001") Or (Right(jmenok, 3) <> Format(maxcis, "000")) Then
        minozn = Right(jmenoz, 3)
        maxozn = Right(jmenok, 3)
        For cykl1 = minozn To maxozn
          For cykl = LBound(pole) To UBound(pole)
            If Left(Right(jmenoz, 5), 1) <> "B" Then
              ActiveWorkbook.Names(pole(cykl) & "_" & Format(cykl1, "000")).Delete
            Else
              ActiveWorkbook.Names(pole(cykl) & "B_" & Format(cykl1, "000")).Delete
            End If
          Next cykl
        Next cykl1
        If maxcis <> maxozn Then
          For cykl1 = minozn To minozn + maxcis - maxozn - 1
            For cykl = LBound(pole) To UBound(pole)
              If Left(Right(jmenoz, 5), 1) <> "B" Then
                ActiveWorkbook.Names(pole(cykl) & "_" & Format(cykl1 + maxozn - minozn + 1, "000")).Name = pole(cykl) & "_" & Format(cykl1, "000")
              Else
                ActiveWorkbook.Names(pole(cykl) & "B_" & Format(cykl1 + maxozn - minozn + 1, "000")).Name = pole(cykl) & "B_" & Format(cykl1, "000")
               End If
            Next cykl
          Next cykl1
        End If
        Range(Cells(prvnir, 2), Cells(poslednir, 2)).EntireRow.Delete
        basicmj
        '------- povolene bunky --------
        On Error Resume Next
        cykl1 = 1
        Do While Err = 0
          If Left(Right(jmenoz, 5), 1) <> "B" Then
            ActiveSheet.Protection.AllowEditRanges("Merne" & Format(cykl1, "000")).Delete
          Else
            ActiveSheet.Protection.AllowEditRanges("MerneB" & Format(cykl1, "000")).Delete
          End If
          cykl1 = cykl1 + 1
        Loop
        On Error GoTo 0
        maxcis = pocetr(jmenoz)
        For cykl1 = 1 To maxcis
          If Left(Right(jmenoz, 5), 1) <> "B" Then
            ActiveSheet.Protection.AllowEditRanges.Add title:="Merne" & Format(cykl1, "000"), Range:=Range("UMREN_" & Format(cykl1, "000") & ":UMREZ_" & Format(cykl1, "000") & ",KZBME_" & Format(cykl1, "000") & ":BRGEW_" & Format(cykl1, "000") & ",GEWEI_" & Format(cykl1, "000") & ":MESUB_" & Format(cykl1, "000"))
          Else
            ActiveSheet.Protection.AllowEditRanges.Add title:="MerneB" & Format(cykl1, "000"), Range:=Range("UMRENB_" & Format(cykl1, "000") & ":UMREZB_" & Format(cykl1, "000") & ",KZBMEB_" & Format(cykl1, "000") & ":MESUBB_" & Format(cykl1, "000"))
          End If
        Next cykl1
      Else
        MsgBox hlaska(2), vbExclamation
      End If
    Else
      MsgBox hlaska(3), vbExclamation
    End If
    Application.ScreenUpdating = True
    Cells(prvnir, 2).Select
  End If
  'Application.EnableEvents = True
  ActiveSheet.Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
  On Error GoTo 0
End Sub

Function fjazyk()
  Dim lng As Byte
  Dim lngarr As Variant
  lngarr = Array("DE", "EN", "CZ", "SK", "HR", "PL", "RO", "BG", "???")
  For lng = 0 To 8
    If lngarr(lng) = Range("SPRACH_001").Value Then Exit For
  Next lng
  If lng = 8 Then lng = 1
  fjazyk = lng + 3
End Function
Function hlaska(radek As Integer)
  hlaska = Sheets(hlasky).Cells(radek, fjazyk).Formula
End Function

Sub basicmj()
  Dim pocradku As Integer
  Dim pocradkub As Integer
  Dim bcykl As Integer
  Application.ScreenUpdating = False
  pocradku = pocetr("MEINS_000")
  pocradkub = pocetr("MEINSB_000")
  For bcykl = 1 To pocradku
    Range("MEINS_" & Format(bcykl, "000")).FormulaR1C1 = "=R27C3"
    Range("UMREN_" & Format(bcykl, "000"), "MESUB_" & Format(bcykl, "000")).Select
    If bcykl <> pocradku And Selection.Borders(xlEdgeBottom).Weight = xlMedium Then
      Selection.Borders(xlEdgeBottom).Weight = xlThin
    End If
    If bcykl = pocradku And Selection.Borders(xlEdgeBottom).Weight = xlThin Then
      Selection.Borders(xlEdgeBottom).Weight = xlMedium
      Selection.Borders(xlEdgeTop).Weight = xlThin
    End If
  Next bcykl
  For bcykl = 1 To pocradkub
    Range("MEINSB_" & Format(bcykl, "000")).FormulaR1C1 = "=R27C3"
  Next bcykl
  Range("intrastatbasicmj").FormulaR1C1 = "=R27C3"
  Application.ScreenUpdating = True
End Sub
Function pocetr(jmbunky)
  Dim maxc As Integer
  On Error Resume Next
  Application.ScreenUpdating = False
  For maxc = 1 To 10000
    Err.Clear
    Range(Left(jmbunky, Len(jmbunky) - 4) & "_" & Format(maxc, "000")).Select
    If Err <> 0 Then
      Exit For
    End If
  Next maxc
  pocetr = maxc - 1
  On Error GoTo 0
End Function

Sub regform(cil As String)
'  Dim regionazev As String
'  Dim x As Integer
'  'On Error Resume Next
'  Err.Clear
'  regionazev = Sheets(regionalni).Range("r" & cil)
'  If Err Then
'    x = 1
'    Do While Sheets(regionalni).Cells(1, x) <> ""
'      x = x + 1
'    Loop
'    Sheets(regionalni).Cells(1, x).Name = "r" & cil
'    Sheets(regionalni).Cells(1, x).Value = cil
'  End If
'  Sheets(regionalni).Select
'  Sheets(regionalni).Range("r" & cil).Select
'  On Error GoTo 0
  formregion.Show
End Sub
Sub pridatfilform()
  Dim x As Integer
  x = 2
  Do While Sheets(regionalni).Cells(x, 1) <> ""
    pridej Sheets(regionalni).Cells(x, 1), 0
    x = x + 1
  Loop
  'Sheets(artpas).Select
End Sub
Sub ulozitfil()
  Dim x As Integer
  Application.ScreenUpdating = False
  ActiveWorkbook.Unprotect Password:=heslo
  Sheets(regionalni).Visible = True
  Sheets(regionalni).Select
  Sheets(regionalni).Range(Cells(2, 1), Cells(1000, 1)).ClearContents
  For x = 0 To formregion.lst_fil.ListCount - 1
    Sheets(regionalni).Cells(x + 2, 1) = formregion.lst_fil.List(x, 0)
  Next x
  Sheets(regionalni).Visible = False
  ActiveWorkbook.Protect Password:=heslo
  Application.ScreenUpdating = True
  Sheets(artpas).Select
End Sub

Sub pridej(filialkafp As String, hlaska As Byte)
  Dim uzje As Boolean
  Dim cyklf As Integer
  Dim mess As Byte
  If Len(filialkafp) = 4 Then
    uzje = False
    For cyklf = 0 To formregion.lst_fil.ListCount - 1
      If formregion.lst_fil.List(cyklf, 0) = filialkafp Then uzje = True
    Next cyklf
    If uzje Then
      If hlaska = 1 Then MsgBox "Fili|fffd|lka je ji|fffd| v seznamu", vbInformation, "Chyba"
    Else
      For cyklf = 0 To formregion.lst_fil.ListCount - 1
        If filialkafp < formregion.lst_fil.List(cyklf, 0) Then Exit For
      Next cyklf
      formregion.lst_fil.AddItem filialkafp, cyklf
    End If
    formregion.txt_fil.Text = ""
    formregion.txt_fil.SetFocus
  End If
End Sub

Sub zmatky()
  Dim x As Integer
  Dim aktnazev As String
  Sheets(regionalni).Select
  aktnazev = "r" & ActiveCell.Formula
  On Error Resume Next
  Err.Clear
  Range("rSSTUF").Select
  If Err = 0 Then
    On Error GoTo 0
    pridatfilform
    Sheets(regionalni).Select
    Range(aktnazev).Select
  End If
  Sheets(artpas).Select
  On Error GoTo 0
  formregion.txt_fil.SetFocus
End Sub

Sub pocetznaku()
  Dim pocznaku As Variant
  Dim pocznakukont As Variant
  Dim cykl1 As Integer
  Dim cykl2 As Integer
  Dim pocetdeti As String
  '---- count of chars array of cells with numbers ----  pocet znaku
  pocznaku = Array("t_wMAKTX_de_L1", "t_wMAKTX_nat_L1", "w_MAKTM_L1", "t_MAKTM_20_001", "t_MAKTM_20_002", "t_MAKTM_20_003", "t_MAKTM_8_004", _
  "t_kh_etikett_001", "t_kh_etikett_002", "t_kh_etikett_003", "t_kh_etikett_004", "t_kh_etikett_005", "text_langtext_max", "tt_langtext_max")
  '---- count of chars checked cells ----  pole pro pocet znaku
  pocznakukont = Array("MAKTX_de", "MAKTX_nat", "MAKTM", _
  "MAKTM_20_001", "MAKTM_20_002", "MAKTM_20_003", "MAKTM_8_04", "kh_etikett_001", "kh_etikett_002", "kh_etikett_003", "kh_etikett_004", "kh_etikett_005", "text_langtext", "Langtext")
  '--------
  'pocetdeti = pocetr("childb_000")
  For cykl1 = LBound(pocznaku) To UBound(pocznaku)
    If Mid(pocznaku(cykl1), 3, 1) = "?" Then
      If Range(Left(pocznaku(cykl1), 3) & Format("1", "000") & Mid(pocznaku(cykl1), 4, Len(pocznaku(cykl1)))).Value <> "" Then
        For cykl2 = 1 To pocetdeti
          On Error GoTo 0
          With Range(pocznakukont(cykl1) & Format(cykl2, "000")).Validation
            .Delete
            .Add Type:=xlValidateTextLength, AlertStyle:=xlValidAlertStop, _
             Operator:=xlLessEqual, Formula1:=Range(Left(pocznaku(cykl1), 3) & Format(cykl2, "000") & Mid(pocznaku(cykl1), 4, Len(pocznaku(cykl1)))).Value
            .IgnoreBlank = False
            .InCellDropdown = True
            .InputTitle = ""
            .ErrorTitle = ""
            .InputMessage = ""
            .ErrorMessage = ""
            .ShowInput = True
            .ShowError = True
          End With
        Next cykl2
      End If
    Else
      If Range(pocznaku(cykl1)).Value <> "" Then
        With Range(pocznakukont(cykl1)).Validation
          .Delete
          .Add Type:=xlValidateTextLength, AlertStyle:=xlValidAlertStop, _
           Operator:=xlLessEqual, Formula1:=Range(pocznaku(cykl1)).Value
          .IgnoreBlank = False
          .InCellDropdown = True
          .InputTitle = ""
          .ErrorTitle = ""
          .InputMessage = ""
          .ErrorMessage = ""
          .ShowInput = True
          .ShowError = True
        End With
      End If
    End If
  Next cykl1
'  With Range(back).Validation
'    .Delete
'    .Add Type:=xlValidateTextLength, AlertStyle:=xlValidAlertStop, _
'     Operator:=xlLessEqual, Formula1:=Range(w_maxtext_back).Value
'    .IgnoreBlank = False
'    .InCellDropdown = True
'    .InputTitle = ""
'    .ErrorTitle = ""
'    .InputMessage = ""
'    .ErrorMessage = ""
'    .ShowInput = True
'    .ShowError = True
'  End With
End Sub
Sub kontrola()
  Dim numa As Variant
  Dim numb As Variant
  Dim kontfld As Variant
  Dim cykl As Integer
  Dim cykl1 As Integer
  Dim pocetrb As Integer
  Dim pocetra As Integer
  Dim pocetx As Integer
  Dim chyba As Boolean
  Dim eu As Boolean
  Dim domaci As Boolean
  Dim y As Integer
  Dim x As Integer
  Sheets(artpas).Select
  pocetra = pocetr("MEINHB_001")
  jechyba = False
  Application.ScreenUpdating = False
  '-------------------------------------  numbers field --------------------------------------
  'Units and other fields
  numa = Array("UMREZ_", "EAN11_tab_", "BRGEW_", "NTGEWB_001", "LAENG_", "BREIT_", "HOEHE_", "MATNR", "WEKGR", "PRDHA", "LIFNR", "BISMT", "PMATA", "ZZWERB", _
  "MATNR", "EAN11_www_001", "EAN11_www_002", "EAN11_www_003", "EAN11_ww_001", "EAN11_ww_002", "EAN11_ww_003")
  'Basic units
  numb = Array("UMREZB_", "EAN11_tabB_", "BRGEWB_", "LAENGB_", "BREITB_", "HOEHEB_")
  'Basic units
  For cykl = LBound(numb) To UBound(numb)
    For cykl1 = 1 To pocetra
      'Range(numb(cykl) & Format(cykl1, "000")).Interior.ColorIndex = 10
      If Range(numb(cykl) & Format(cykl1, "000")) <> "" Or Range(numb(cykl) & Format(cykl1, "000")) <> Null Then
        If Not IsNumeric(Range(numb(cykl) & Format(cykl1, "000"))) Then
          Application.ScreenUpdating = True
          Range(numb(cykl) & Format(cykl1, "000")).Select
          MsgBox hlaska(5), vbExclamation
          jechyba = True
          Exit Sub
        End If
      End If
    Next cykl1
  Next cykl
  'Units and other fieds
  pocetrb = pocetr("MEINH_001")
  For cykl = LBound(numa) To UBound(numa)
    If Right(numa(cykl), 1) = "_" Then
      For cykl1 = 1 To pocetrb
        'Range(numa(cykl) & Format(cykl1, "000")).Interior.ColorIndex = 10
        If Range(numa(cykl) & Format(cykl1, "000")) <> "" Or Range(numa(cykl) & Format(cykl1, "000")) <> Null Then
          If Not IsNumeric(Range(numa(cykl) & Format(cykl1, "000"))) Then
            Range(numa(cykl) & Format(cykl1, "000")).Select
            Application.ScreenUpdating = True
            MsgBox hlaska(5), vbExclamation
            jechyba = True
            Exit Sub
          End If
        End If
      Next cykl1
    Else
      'Range(numa(cykl)).Interior.ColorIndex = 10
      If Range(numa(cykl)) <> "" Or Range(numa(cykl)) <> Null Then
        If Not IsNumeric(Range(numa(cykl))) Then
          Range(numa(cykl)).Select
          Application.ScreenUpdating = True
          MsgBox hlaska(5), vbExclamation
          jechyba = True
          Exit Sub
        End If
      End If
    End If
  Next cykl
  '-------------------------- Stejne udaje u objednaci a vydajove jednotky ------------------------
  kontfld = Array("UMREN", "MEINH", "UMREZ", "MEINS", "KZBME", "KZVRKME", "BRGEW", "LAENG", "BREIT", "HOEHE")
  numa = Array("KZBSTME", "KZAUSME")
  If pocetrb > 1 Then
    For cykl = LBound(numa) To UBound(numa)
      chyba = False
      For cykl1 = 1 To pocetrb
        If UCase(Range(numa(cykl) & "_" & Format(cykl1, "000")).Value) = "X" And chyba = False Then
          y = cykl1
          chyba = True
        End If
        If chyba And UCase(Range(numa(cykl) & "_" & Format(cykl1, "000")).Value) = "X" Then
          For x = LBound(kontfld) To UBound(kontfld)
            If Range(kontfld(x) & "_" & Format(cykl1, "000")).Value <> Range(kontfld(x) & "_" & Format(y, "000")).Value Then
              Application.ScreenUpdating = True
              jechyba = True
              Range(kontfld(x) & "_" & Format(cykl1, "000")).Select
              MsgBox hlaska(31), vbExclamation
              Exit Sub
            End If
          Next x
        End If
      Next cykl1
    Next cykl
  End If
  '------------------------- language of etikets --------------------
  pocetrb = 0
  kontfld = Array("de", "cz", "sk", "hr", "pl", "ro", "bg")
  For cykl = LBound(kontfld) To UBound(kontfld)
    If UCase(Range(kontfld(cykl))) = "X" Then pocetrb = pocetrb + 1
  Next cykl
  If pocetrb = 0 Then
    Application.ScreenUpdating = True
    Range(kontfld(0)).Select
    MsgBox hlaska(6), vbExclamation
    jechyba = True
    Exit Sub
  End If
  '-------------------------- dates ---------------------------------
  kontfld = Array("aktdat", "LDVZL", "LDBZL", "LDVFL", "anf_listdatum", "LDVFL", "LDBFL", "list_aprdat", "kalk_dat_ab_001", "kalk_dat_ab_002", "kalk_dat_ab_003")
  For cykl = LBound(kontfld) To UBound(kontfld)
    If Not IsDate(Range(kontfld(cykl))) And Not IsNull(Range(kontfld(cykl))) And Range(kontfld(cykl)) <> "" Then
      Application.ScreenUpdating = True
      Range(kontfld(cykl)).Select
      MsgBox hlaska(7), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '-------- date of the end less than date of begin -------------
  If Range("LDVZL") > Range("LDBZL") Then
    Application.ScreenUpdating = True
    Range("LDVZL").Select
    MsgBox hlaska(8), vbExclamation
    jechyba = True
    Exit Sub
  End If
  If Range("LDVFL") > Range("LDBFL") Then
    Application.ScreenUpdating = True
    Range("LDVFL").Select
    MsgBox hlaska(8), vbExclamation
    jechyba = True
    Exit Sub
  End If
  '------------------------ Minimal one X in ME columns ------------------------
  pocetra = pocetr("MEINHB_001")
  pocetrb = pocetr("MEINH_001")
  pocetrb = pocetrb + pocetra
  kontfld = Array("KZBMEB_001", "KZBSTMEB_001", "KZAUSMEB_001", "KZVRKMEB_001")
  For cykl1 = LBound(kontfld) To UBound(kontfld)
    pocetx = 0
    x = Range(kontfld(cykl1)).Column
    y = Range(kontfld(cykl1)).Row
    For cykl = y To (pocetrb * 2 + y) - 2 Step 2
      If UCase(Cells(cykl, x).Value) = "X" Then pocetx = pocetx + 1
'      If pocetx > 1 Then
'        Range(kontfld(0)).Select
'        MsgBox hlaska(9), vbExclamation
'        End
'      End If
    Next cykl
    If pocetx = 0 Then
      Application.ScreenUpdating = True
      Range(kontfld(0)).Select
      MsgBox hlaska(10), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl1
  '-------------------------- Stejne udaje u zakladni jednotky ------------------------
  kontfld = Array("UMREN", "MEINH", "UMREZ", "MEINS", "KZBME", "KZVRKME", "BRGEW", "LAENG", "BREIT", "HOEHE")
  If pocetra > 1 Then
    For cykl = 1 To pocetra
      For cykl1 = LBound(kontfld) To UBound(kontfld)
        If Range(kontfld(cykl1) & "B_" & Format(cykl, "000")).Value <> Range(kontfld(cykl1) & "B_" & "001").Value Then
          Application.ScreenUpdating = True
          jechyba = True
          Range(kontfld(cykl1) & "B_" & Format(cykl, "000")).Select
          MsgBox hlaska(31), vbExclamation
          Exit Sub
        End If
      Next cykl1
    Next cykl
  End If
  '---------------------------- x in x field ---------------------------------
  numa = Array("KZBMEB_", "KZBSTMEB_", "KZAUSMEB_", "KZVRKMEB_")
  For cykl = LBound(numa) To UBound(numa)
    For cykl1 = 1 To pocetra
      If UCase(Range(numa(cykl) & Format(cykl1, "000"))) <> "X" And (Range(numa(cykl) & Format(cykl1, "000"))) <> "" And (Range(numa(cykl) & Format(cykl1, "000"))) <> Chr(160) Then
        Application.ScreenUpdating = True
        Range(numa(cykl) & Format(cykl1, "000")).Select
        MsgBox hlaska(27), vbExclamation
        jechyba = True
        Exit Sub
      End If
'      If UCase(Range(numa(cykl) & Format(cykl1, "000"))) = "X" And Range("EAN11_tabB_" & Format(cykl1, "000")).Value = "" Then
'        Range("EAN11_tabB_" & Format(cykl1, "000")).Select
'        MsgBox hlaska(28), vbExclamation
'        End
'      End If
    Next cykl1
  Next cykl
  numa = Array("KZBME_", "KZBSTME_", "KZAUSME_", "KZVRKME_")
  pocetra = pocetr("MEINH_001")
  For cykl = LBound(numa) To UBound(numa)
    For cykl1 = 1 To pocetra
      If UCase(Range(numa(cykl) & Format(cykl1, "000"))) <> "X" And (Range(numa(cykl) & Format(cykl1, "000"))) <> "" And (Range(numa(cykl) & Format(cykl1, "000"))) <> Chr(160) Then
        Application.ScreenUpdating = True
        Range(numa(cykl) & Format(cykl1, "000")).Select
        MsgBox hlaska(27), vbExclamation
        jechyba = True
        Exit Sub
      End If
'      If UCase(Range(numa(cykl) & Format(cykl1, "000"))) = "X" And Range("EAN11_tab_" & Format(cykl1, "000")).Value = "" Then
'        Range("EAN11_tab_" & Format(cykl1, "000")).Select
'        MsgBox hlaska(28), vbExclamation
'        End
'      End If
    Next cykl1
  Next cykl
  numa = Array("de", "cz", "sk", "hr", "pl", "ro", "bg", "ZZSOPO", "ZZEK_KZLEAD", "grill", "ZZLUL_AUSPACK", "STOFF", _
               "STOFF_adr", "biozid", "sortbonus", "reakt_kdis", "reakt_nonkdis", "sofortlist", "inventurproblemart", "sdatenblatt", "qpass")
  For cykl = LBound(numa) To UBound(numa)
    If UCase(Range(numa(cykl))) <> "X" And (Range(numa(cykl))) <> "" And (Range(numa(cykl))) <> Chr(160) Then
      Application.ScreenUpdating = True
      Range(numa(cykl)).Select
      MsgBox hlaska(27), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '---------------------------- brutto > netto -------------------------------
  pocetra = pocetr("MEINHB_001")
  For cykl = 1 To pocetra
    If (Range("BRGEWB_" & Format(cykl, "000")) < Range("NTGEWB_" & Format(cykl, "000"))) Then
      Application.ScreenUpdating = True
      Range("BRGEWB_" & Format(cykl, "000")).Select
      MsgBox hlaska(11), vbExclamation
      jechyba = True
      Exit Sub
    End If
    If (Range("BRGEWB_" & Format(cykl, "000")).Value = "") Then
      Application.ScreenUpdating = True
      Range("BRGEWB_" & Format(cykl, "000")).Select
      MsgBox hlaska(34), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '------------------------------- brutto ------------------------------------
  pocetra = pocetr("MEINH_001")
  For cykl = 1 To pocetra
    If (Val(Range("BRGEW_" & Format(cykl, "000"))) < (Val(Range("UMREZ_" & Format(cykl, "000")).Value) / Val(Range("UMREN_" & Format(cykl, "000")).Value) * Val(Range("BRGEWB_001").Value))) Then
      Application.ScreenUpdating = True
      Range("BRGEW_" & Format(cykl, "000")).Select
      MsgBox hlaska(12), vbExclamation
      jechyba = True
      Exit Sub
    End If
    If (Range("BRGEW_" & Format(cykl, "000")).Value = "") Then
      Application.ScreenUpdating = True
      Range("BRGEW_" & Format(cykl, "000")).Select
      MsgBox hlaska(34), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '--------------------------- required field --------------------------------
'  kontfld = Array("MAKTX", "LFATX", "", "", "", "", "", "", "", "")

  '--------------------------- Auspackware -----------------------------------
  pocetra = pocetr("MEINHB_001")
  pocetra = pocetra + pocetr("MEINH_001")
  x = Range("KZBSTMEB_001").Column
  cykl1 = Range("KZBSTMEB_001").Row
  For cykl = cykl1 To (pocetra * 2 + cykl1) - 2 Step 2
    If (UCase(Cells(cykl, x).Value) = "X" And UCase(Cells(cykl, x + 2).Value) <> "X") And (UCase(Range("ZZLUL_AUSPACK").Value) <> "X") Then
      Application.ScreenUpdating = True
      Cells(cykl, x).Select
      MsgBox hlaska(13), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '---------------------------- PAL 1000kg -----------------------------------
  x = Range("BRGEWB_001").Column
  For cykl = cykl1 To (pocetra * 2 + cykl1) - 2 Step 2
    If Cells(cykl, x).Value > 1000 Then
      MsgBox (Cells(cykl, x).Value)
      Application.ScreenUpdating = True
      Cells(cykl, x).Select
      MsgBox hlaska(14), vbExclamation
      jechyba = True
      Exit Sub
    End If
  Next cykl
  '------------------------- Projednano v ----------------------------------
  If UCase(Left(Range("ZZEK_KZKLMA").Value, 1)) = "C" And Range("verh").Value = "" Then
    MsgBox hlaska(38), vbExclamation
    jechyba = True
    Exit Sub
  End If
  '--------------------------- Landesprodukt CZ ---------------------------------
'  If UCase(Right(Range("WHERL"), 2)) <> "CZ" And UCase(Range("WHERR")) = "CZ" Then
'    msg1 = Array("DE1", "EN1", _
'    "Zem|fffd| p|fffd|vodu nen|fffd| CZ, artikl nen|fffd| region|fffd|ln|fffd| produkt.", "SK1", _
'    "HR1", "PL1", _
'    "RO1", "BG1")
'    Range("WHERR").Select
'    MsgBox msg1(fjazyk), vbExclamation
'  End If
  '--------------------------- Dan ----------------------------------------------
'  chyba = False
'  If UCase(Range("LAND")) <> "KI" Then
'    If Range("ZE_HERKL").Value <> "" And Range("ZE_HERKL").Value <> Chr(160) Then
'      If Mid(Range("ZE_HERKL").Value, Len(Range("ZE_HERKL").Value) - 3, 1) = "-" Then eu = True Else eu = False
'      If Left(Range("ZE_HERKL").Value, 1) = "_" Then domaci = True Else domaci = False
'  '    If (UCase(Range("zoll_EU").Value) = "X") And (Range("nonzoll").Value <> "") And (Range("nonzoll").Value <> Chr(160)) Then chyba = True
'  '    If (UCase(Range("zoll_EU").Value) = "X") And ((Range("landlief_zoll").Value = "" Or Range("landlief_zoll").Value = Chr(160)) And (Range("eulief_zoll").Value = "" Or Range("eulief_zoll").Value = Chr(160))) Then chyba = True
'  '    If (UCase(Range("zoll_EU").Value) <> "X") And ((Range("landlief_zoll").Value <> "" And Range("landlief_zoll").Value <> Chr(160)) Or (Range("eulief_zoll").Value <> "" And Range("eulief_zoll").Value <> Chr(160))) Then chyba = True
'  '    If (UCase(Range("zoll_EU").Value) <> "X") And (Range("nonzoll").Value = "" Or Range("nonzoll").Value = Chr(160)) Then chyba = True
'      If domaci And ((Range("nonzoll").Value <> "" And Range("nonzoll").Value <> Chr(160)) Or (Range("eulief_zoll").Value <> "" And Range("eulief_zoll").Value <> Chr(160))) Then chyba = True
'      If domaci And (Range("landlief_zoll").Value = "" Or Range("landlief_zoll").Value = Chr(160)) Then chyba = True
'      If domaci = False And eu And ((Range("landlief_zoll").Value <> "" And Range("landlief_zoll").Value <> Chr(160)) Or (Range("nonzoll").Value <> "" And Range("nonzoll").Value <> Chr(160))) Then chyba = True
'      If domaci = False And eu And (Range("eulief_zoll").Value = "" Or Range("eulief_zoll").Value = Chr(160)) Then chyba = True
'      'If eu And UCase(Range("zoll_eu").Value) <> "X" Then chyba = True
'      'If eu = False And UCase(Range("zoll_eu").Value) = "X" Then chyba = True
'      If eu = False And domaci = False And (Range("nonzoll").Value = "" Or Range("nonzoll").Value = Chr(160)) Then chyba = True
'      If eu = False And domaci = False And ((Range("landlief_zoll").Value <> "" And Range("landlief_zoll").Value <> Chr(160)) Or (Range("eulief_zoll").Value <> "" And Range("eulief_zoll").Value <> Chr(160))) Then chyba = True
'    Else
'      If (Range("landlief_zoll").Value <> "" And Range("landlief_zoll").Value <> Chr(160)) Or (Range("eulief_zoll").Value <> "" And Range("eulief_zoll").Value <> Chr(160)) Or (Range("nonzoll").Value <> "" And Range("nonzoll").Value <> Chr(160)) Then chyba = True
'    End If
'  End If
'  Range("t_mwst_eing_L1").Select
'  If chyba Then
'    Application.ScreenUpdating = True
'    MsgBox hlaska(26), vbExclamation
'    jechyba = True
'    Exit Sub
'  End If
  '--------------------------- kontrola podminek -----------------------------
  chyba = False
  If Range("kalk_dat_ab_001").Value = "" And (Range("kalk_dat_ab_002").Value <> "" Or Range("kalk_dat_ab_003").Value <> "") Then chyba = True
  If Range("kalk_dat_ab_002").Value = "" And Range("kalk_dat_ab_003").Value <> "" Then chyba = True
  If chyba Then
    Application.ScreenUpdating = True
    Range("kalk_dat_ab_001").Select
    MsgBox hlaska(32), vbExclamation
    jechyba = True
    Exit Sub
  End If
  '--------------------------- bez listovani neni cena ----------------------------
  If (UCase(Range("sortbonus_nonlist").Value) = "X") And (Range("VKP0_p1").Value <> "" Or Range("VKP0_p2").Value <> "" Or Range("VKP0_p3").Value <> "" Or Range("VKP0_p4").Value <> "" Or Range("VKP0_p5").Value <> "" Or Range("VKP0_p6").Value <> "" Or Range("VKP0_p7").Value <> "" Or Range("VKP0_p8").Value <> "" Or Range("VKP0_p9").Value <> "" Or Range("VKP0_pZ").Value <> "") Then
    Application.ScreenUpdating = True
    Range("VKP0_p1").Select
    MsgBox hlaska(36), vbExclamation
    Exit Sub
  End If
  '--------------------------- celni nomenklatura ----------------------------
'  If Range("WSTAW").Value <> "" And Len(Range("WSTAW").Value) <> 10 Then
'    Application.ScreenUpdating = True
'    Range("WSTAW").Select
'    MsgBox hlaska(33), vbExclamation
'    Exit Sub
'  End If
  '--------------------------- DPG -------------------------------------------
'  If UCase(Range("ZZEK_KZLEAD")) = "X" Then
'    Application.ScreenUpdating = True
'    Range("ZZEK_KZLEAD").Select
'    MsgBox hlaska(15), vbExclamation
'  End If
  Application.ScreenUpdating = True
  Range("t_zzmm43_L1").Select
End Sub

Sub newversion()
  Dim verze As String
  Dim msg1 As Variant
  Dim tento As String
  Dim tamten As String
  Dim y As Integer
  Dim cykl As Integer
  Dim pocetratento As Integer
  Dim pocetratamten As Integer
  Dim sloupce As Variant
  Dim displeje As Variant
  Dim nazvypoli(2000) As String
  Dim hodnotypoli(2000) As Variant
  Dim cykl1 As Integer
  Dim cestaart As String
  Dim novysoubor As String
  ActiveWorkbook.Unprotect Password:=heslo
  sloupce = Array("UMREN", "MEINH", "UMREZ", "KZBME", "KZBSTME", "KZAUSME", "KZVRKME", "EAN11_tab", "BRGEW", "NTGEW", "GEWEI", "LAENG", "BREIT", "HOEHE", "MESUB")
  displeje = Array("komponent_display", "stck_display")
  Application.ScreenUpdating = False
  On Error Resume Next
  Err.Clear
  Open versionpathKI For Input As #1
  If Err = 0 Then novaverze = novaverzeKI Else Err.Clear
  Open versionpathCZ For Input As #1
  If Err = 0 Then novaverze = novaverzeCZ Else Err.Clear
  Open versionpathSK For Input As #1
  If Err = 0 Then novaverze = novaverzeSK Else Err.Clear
  Open versionpathHR For Input As #1
  If Err = 0 Then novaverze = novaverzeHR Else Err.Clear
  Open versionpathPL For Input As #1
  If Err = 0 Then novaverze = novaverzePL Else Err.Clear
  Open versionpathRO For Input As #1
  If Err = 0 Then novaverze = novaverzeRO Else Err.Clear
  Open versionpathBG For Input As #1
  If Err = 0 Then novaverze = novaverzeBG Else Err.Clear
  Line Input #1, verze
  Close #1
  If Val(verze) > Val(Sheets(artpas).Range("L5")) Then
    If MsgBox(hlaska(16), vbYesNo + vbExclamation) = vbYes Then
      tento = ActiveWorkbook.Name
      cestaart = ThisWorkbook.Path
      Application.EnableEvents = False
      Err.Clear
      If UCase(Right(tento, 3)) = "XLS" Then
        Workbooks.OpenXML (novaverze & ".xls")
      Else
        Workbooks.OpenXML (novaverze & ".xlsb")
      End If
      If Err <> 0 Then
        Application.EnableEvents = True
        Application.ScreenUpdating = True
        End
      End If
      tamten = ActiveWorkbook.Name
      y = 2
      Do While Workbooks(tento).Sheets(polenw).Cells(y, 1) <> ""
        Workbooks(tento).Activate
        nazvypoli(y - 2) = Range(Workbooks(tento).Sheets(polenw).Cells(y, 1)).Name.Name
        hodnotypoli(y - 2) = Range(Workbooks(tento).Sheets(polenw).Cells(y, 1))
        y = y + 1
      Loop
      Workbooks(tamten).Activate
      Application.EnableEvents = True
      For y = 0 To 2000
        If y = 6 Then Application.EnableEvents = False
        Range(nazvypoli(y)) = hodnotypoli(y)
      Next y
      'zjisteni poctu radku
      pocetratamten = pocetr("MEINHB_001")
      Workbooks(tento).Activate
      pocetratento = pocetr("MEINHB_001")
      'pridani radku EANu
      Application.EnableEvents = True
      If pocetratamten < pocetratento Then
        Workbooks(tamten).Activate
        Range("MEINHB_001").Select
        For cykl = pocetratamten + 1 To pocetratento
          Application.Run "'" & tamten & "'!AddlineME"
        Next cykl
      End If
      'odebrani radku EANu
      If pocetratamten > pocetratento Then
        Workbooks(tamten).Activate
        Range("MEINHB_001").Select
        For cykl = pocetratento + 1 To pocetratamten
          Application.Run "'" & tamten & "'!DellineME"
        Next cykl
      End If
      Erase nazvypoli
      Erase hodnotypoli
      cykl1 = 0
      Application.EnableEvents = False
      Workbooks(tento).Activate
      For y = 1 To pocetratento
        For cykl = LBound(sloupce) To UBound(sloupce)
          nazvypoli(cykl1) = Range(sloupce(cykl) & "B_" & Format(y, "000")).Name.Name
          hodnotypoli(cykl1) = Range(sloupce(cykl) & "B_" & Format(y, "000"))
          cykl1 = cykl1 + 1
        Next cykl
      Next y
      Workbooks(tamten).Activate
      For y = 0 To 2000
        Range(nazvypoli(y)) = hodnotypoli(y)
      Next y
      pocetratamten = pocetr("MEINH_001")
      Workbooks(tento).Activate
      pocetratento = pocetr("MEINH_001")
      Application.EnableEvents = True
      If pocetratamten < pocetratento Then
      On Error GoTo 0
        Workbooks(tamten).Activate
        Range("MEINH_001").Select
        For cykl = pocetratamten + 1 To pocetratento
          Application.Run "'" & tamten & "'!addlineME"
        Next cykl
      End If
      If pocetratamten > pocetratento Then
        Workbooks(tamten).Activate
        Range("MEINH_001").Select
        For cykl = pocetratento + 1 To pocetratamten
          Application.Run "'" & tamten & "'!DellineME"
        Next cykl
      End If
      Erase nazvypoli
      Erase hodnotypoli
      cykl1 = 0
      Application.EnableEvents = False
      Workbooks(tento).Activate
      For y = 1 To pocetratento
        For cykl = LBound(sloupce) To UBound(sloupce)
          If sloupce(cykl) <> "NTGEW" Then
            nazvypoli(cykl1) = Range(sloupce(cykl) & "_" & Format(y, "000")).Name.Name
            hodnotypoli(cykl1) = Range(sloupce(cykl) & "_" & Format(y, "000"))
            cykl1 = cykl1 + 1
          End If
        Next cykl
      Next y
      Workbooks(tamten).Activate
      For y = 0 To 2000
        Range(nazvypoli(y)) = hodnotypoli(y)
      Next y
      '---- display -----
      Application.EnableEvents = True
      Workbooks(tento).Activate
      pocetratento = pocetr("komponent_display_001")
      Workbooks(tamten).Activate
      If pocetratento > 1 Then
        For cykl = 2 To pocetratento
          Application.Run "'" & tamten & "'!Addlinedisp"
        Next cykl
      End If
      Erase nazvypoli
      Erase hodnotypoli
      cykl1 = 0
      Application.EnableEvents = False
      Workbooks(tento).Activate
      For y = 1 To pocetratento
        For cykl = LBound(displeje) To UBound(displeje)
          nazvypoli(cykl1) = Range(displeje(cykl) & "_" & Format(y, "000")).Name.Name
          hodnotypoli(cykl1) = Range(displeje(cykl) & "_" & Format(y, "000"))
          cykl1 = cykl1 + 1
        Next cykl
      Next y
      Workbooks(tamten).Activate
      For y = 0 To 2000
        Range(nazvypoli(y)) = hodnotypoli(y)
      Next y
      Workbooks(tento).Sheets(regionalni).Range("A1:A1000").Copy Destination:=Workbooks(tamten).Sheets(regionalni).Range("A1")
      Workbooks(tamten).Activate
      Range("A1").Select
      If UCase(Right(tento, 3)) = "XLS" Then
        ActiveWorkbook.SaveAs cestaart & "\" & Left(tento, Len(tento) - 4) & "_1.xls", FileFormat:=56
        novysoubor = Left(tento, Len(tento) - 4) & "_1.xls"
      Else
        ActiveWorkbook.SaveAs cestaart & "\" & Left(tento, Len(tento) - 5) & "_1.xlsb", FileFormat:=50
        novysoubor = Left(tento, Len(tento) - 5) & "_1.xlsb"
      End If
      MsgBox hlaska(37) & novysoubor, vbInformation
    End If
  End If
  On Error GoTo 0
  ActiveWorkbook.Protect Password:=heslo
  Application.ScreenUpdating = True
  Application.EnableEvents = True
End Sub

Sub addenablefields(nazev As String, policko As String)
  ActiveSheet.Protection.AllowEditRanges.Add title:=nazev, Range:=Range(policko)
End Sub
Sub enablestandardfields(cislosloupce As Byte, nazev As String)
  Dim cykl1 As Integer
  Dim y As Integer
  Dim povpole As String
  Dim pocpov As Integer
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  y = 2
  pocpov = 0
  povpole = ""
  Do While Sheets(polenw).Cells(y, cislosloupce).Value <> ""
    povpole = povpole & Sheets(polenw).Cells(y, cislosloupce).Value & ","
    If y Mod 12 = 0 Then
      pocpov = pocpov + 1
      povpole = Left(povpole, Len(povpole) - 1)
      addenablefields nazev & Format(pocpov, "000"), povpole
      povpole = ""
    End If
    y = y + 1
  Loop
  If povpole <> "" Then
    pocpov = pocpov + 1
    povpole = Left(povpole, Len(povpole) - 1)
    addenablefields nazev & Format(pocpov, "000"), povpole
  End If
  ActiveSheet.Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
End Sub
Sub deleteenabled()
  On Error Resume Next
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  Do While Err = 0
    ActiveSheet.Protection.AllowEditRanges(1).Delete
  Loop
  On Error GoTo 0
End Sub
Sub enableallcells()
  Dim cykl As Integer
  Sheets(artpas).Select
  deleteenabled
  enablestandardfields 3, "Artpas"
  Sheets(wine).Select
  deleteenabled
  enablestandardfields 4, "Wine"
  Sheets(whisky).Select
  deleteenabled
  enablestandardfields 5, "Whisky"
  Sheets(backshop).Select
  deleteenabled
  enablestandardfields 6, "Langtext"
  Sheets(nf).Select
  deleteenabled
  enablestandardfields 7, "NF"
  Sheets(mineral).Select
  deleteenabled
  enablestandardfields 8, "Mineral"
End Sub
Sub landof()
  Dim pole As Variant
  Dim cykl As Byte
  Dim yr As Integer
  Dim zacatek As Integer
  Dim langu As Byte
  Dim seznams As String
  Dim pocetradkusr As Integer
  pole = Array("WHERL", "ZE_HERKL")
  pocetradkusr = pocetr("MEINS_000")
  pocetradkusr = pocetradkusr + pocetr("MEINSB_000")
  yr = pocetradkusr * 2
  pocetradkusr = pocetr("komponent_display_001") * 3
  yr = yr + pocetradkusr + 290
  If lang <> 9 Then langu = lang Else langu = 1  ' KI=DE
  zacatek = yr
  Do While UCase(Sheets(artpas).Cells(yr, langu * 2 + 50)) <> "E_N_D"
    yr = yr + 1
  Loop
  For cykl = LBound(pole) To UBound(pole)
    With Range(pole(cykl)).Validation
      .Delete
      .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
       xlBetween, Formula1:="=" & Range(Sheets(artpas).Cells(zacatek + 2, langu * 2 + 50), Sheets(artpas).Cells(yr - 1, langu * 2 + 50)).Address
      .IgnoreBlank = False
      .InCellDropdown = True
      .InputTitle = ""
      .ErrorTitle = ""
      .InputMessage = ""
      .ErrorMessage = ""
      .ShowInput = True
      .ShowError = True
    End With
  Next cykl
End Sub
Sub childform()
  Dim tento As String
  Dim novy As String
  Dim cykl As Integer
  Dim minus As Byte
  Dim koncovka As String
  Dim pocetra As Integer
  Application.EnableEvents = False
  ActiveWorkbook.Save
  Application.EnableEvents = True
  kontrola
  If jechyba Then
    MsgBox hlaska(29), vbExclamation
    End
  End If
  Application.ScreenUpdating = False
  tento = ActiveWorkbook.FullName
  If UCase(Right(tento, 4)) = "XLSB" Then
    minus = 5
    koncovka = "xlsb"
  ElseIf UCase(Right(tento, 3)) = "XLS" Then
    minus = 4
    koncovka = "xls"
  End If
  For cykl = 1 To 1000
    If Dir(Left(ActiveWorkbook.FullName, Len(ActiveWorkbook.FullName) - minus) & "__" & hlaska(30) & "__" & Format(cykl, "000") & "." & koncovka, vbNormal) = "" Then
      ActiveWorkbook.SaveCopyAs (Left(ActiveWorkbook.FullName, Len(ActiveWorkbook.FullName) - minus) & "__" & hlaska(30) & "__" & Format(cykl, "000") & "." & koncovka)
      Exit For
    End If
  Next cykl
  Application.EnableEvents = False
  Workbooks.OpenXML (Left(ActiveWorkbook.FullName, Len(ActiveWorkbook.FullName) - minus) & "__" & hlaska(30) & "__" & Format(cykl, "000") & "." & koncovka)
  Application.EnableEvents = True
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  novy = ActiveWorkbook.Name
  ActiveSheet.Shapes.Range(Array("btn5")).Delete
  Range("addchildrange").Select
  Selection.Borders(xlDiagonalDown).LineStyle = xlNone
  Selection.Borders(xlDiagonalUp).LineStyle = xlNone
  Selection.Borders(xlEdgeLeft).LineStyle = xlNone
  Selection.Borders(xlEdgeTop).LineStyle = xlNone
  Selection.Borders(xlEdgeBottom).LineStyle = xlNone
  Selection.Borders(xlEdgeRight).LineStyle = xlNone
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
  Selection.ClearContents
  Range("IDNLF").MergeArea.ClearContents
  Range("IDNLF").MergeArea.Interior.ColorIndex = 4
  'Range("MAKTX_de").MergeArea.ClearContents
  Range("MAKTX_de").MergeArea.Interior.ColorIndex = 4
  'Range("MAKTX_nat").MergeArea.ClearContents
  Range("MAKTX_nat").MergeArea.Interior.ColorIndex = 4
  Range("MAKTM").MergeArea.Interior.ColorIndex = 4
  '!!!!! ------- do|fffd|e|fffd|it maz|fffd|n|fffd| |fffd||fffd|dk|fffd| ----------
  pocetra = pocetr("EAN11_tabB_001")
  For cykl = 1 To pocetra
    Range("EAN11_tabB_" & Format(cykl, "000")).MergeArea.ClearContents
  Next cykl
  Range("EAN11_tabB_001").MergeArea.Interior.ColorIndex = 4
  pocetra = pocetr("EAN11_tab_001")
  For cykl = 1 To pocetra
    Range("EAN11_tab_" & Format(cykl, "000")).MergeArea.ClearContents
  Next cykl
  Range("EAN11_tab_001").MergeArea.Interior.ColorIndex = 4
  Range("EANMutter").MergeArea.Interior.ColorIndex = 4
  Application.ScreenUpdating = True
  Workbooks(novy).Activate
  Range("EANMutter").Select
  Application.EnableEvents = False
  ActiveSheet.Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
  ActiveWorkbook.Save
  Application.EnableEvents = True
End Sub

Sub addlineDISP()
  Dim poslednir As Integer
  Dim cykl As Integer
  'Application.EnableEvents = False
  Application.ScreenUpdating = False
  ActiveWorkbook.Unprotect Password:=heslo
  ActiveSheet.Unprotect Password:=heslo
  poslednir = pocetr("komponent_display_001")
  Range("komponent_display_" & Format(poslednir, "000")).EntireRow.Select
  Selection.Resize(Selection.Rows.Count + 1, Selection.Columns.Count).Select
  Selection.Copy
  ActiveCell.Offset(3, 0).EntireRow.Select
  Selection.Insert shift:=xlDown
  Application.CutCopyMode = False
  Range("komponent_display_" & Format(poslednir, "000")).Select
  ActiveCell.Offset(3, 0).Select
  ActiveCell.Name = "komponent_display_" & Format(poslednir + 1, "000")
  ActiveCell.Offset(0, -1).Select
  ActiveCell.Name = "t_?" & Format(poslednir + 1, "000") & "_komponent_display_01_L1"
  ActiveCell.Offset(1, 0).Select
  ActiveCell.Name = "t_?" & Format(poslednir + 1, "000") & "_komponent_display_01_L2"
  ActiveCell.Offset(0, 12).Select
  ActiveCell.Name = "t_?" & Format(poslednir + 1, "000") & "_stck_display_01_L2"
  ActiveCell.Offset(-1, 0).Select
  ActiveCell.Name = "t_?" & Format(poslednir + 1, "000") & "_stck_display_01_L1"
  ActiveCell.Offset(0, 1).Select
  ActiveCell.Name = "stck_display_" & Format(poslednir + 1, "000")
  Range("B" & ActiveCell.Row & ":I" & ActiveCell.Row + 2).Select
  Selection.Clear
  Selection.Borders(xlDiagonalDown).LineStyle = xlNone
  Selection.Borders(xlDiagonalUp).LineStyle = xlNone
  Selection.Borders(xlEdgeLeft).LineStyle = xlNone
  Selection.Borders(xlEdgeTop).LineStyle = xlNone
  Selection.Borders(xlEdgeBottom).LineStyle = xlNone
  Selection.Borders(xlEdgeRight).LineStyle = xlNone
  Selection.Borders(xlInsideVertical).LineStyle = xlNone
  Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
  Range("komponent_display_" & Format(poslednir + 1, "000")) = ""
  Range("stck_display_" & Format(poslednir + 1, "000")) = ""
  Application.ScreenUpdating = True
  Range("komponent_display_001").Select
  On Error Resume Next
  For cykl = 1 To poslednir
    ActiveSheet.Protection.AllowEditRanges("Display" & Format(cykl, "000")).Delete
  Next cykl
  On Error GoTo 0
  For cykl = 1 To poslednir + 1
    ActiveSheet.Protection.AllowEditRanges.Add title:="Display" & Format(cykl, "000"), Range:=Range("komponent_display_" & Format(cykl, "000") & ", stck_display_" & Format(cykl, "000"))
  Next cykl
  ActiveSheet.Protect Password:=heslo
  ActiveWorkbook.Protect Password:=heslo
End Sub

Sub dellineDISP()
  Dim poslednir As Integer
  Dim aktualcis As String
  'Application.EnableEvents = False
  On Error Resume Next
  If Left(ActiveCell.Name.Name, 17) = "komponent_display" Or Left(ActiveCell.Name.Name, 12) = "stck_display" Then
    If Err = 0 Then
      On Error GoTo 0
      aktualcis = Right(ActiveCell.Name.Name, 3)
      poslednir = pocetr("komponent_display_001")
      Range("komponent_display_" & aktualcis).Select
      If aktualcis <> "001" Then
        ActiveWorkbook.Unprotect Password:=heslo
        ActiveSheet.Unprotect Password:=heslo
        Application.ScreenUpdating = False
        ActiveWorkbook.Names("komponent_display_" & aktualcis).Delete
        ActiveWorkbook.Names("stck_display_" & aktualcis).Delete
        ActiveWorkbook.Names("t_?" & aktualcis & "_komponent_display_01_L1").Delete
        ActiveWorkbook.Names("t_?" & aktualcis & "_komponent_display_01_L2").Delete
        ActiveWorkbook.Names("t_?" & aktualcis & "_stck_display_01_L1").Delete
        ActiveWorkbook.Names("t_?" & aktualcis & "_stck_display_01_L2").Delete
        If Val(aktualcis) <> poslednir Then
          ActiveWorkbook.Names("komponent_display_" & Format(poslednir, "000")).Name = "komponent_display_" & aktualcis
          ActiveWorkbook.Names("stck_display_" & Format(poslednir, "000")).Name = "stck_display_" & aktualcis
          ActiveWorkbook.Names("t_?" & Format(poslednir, "000") & "_komponent_display_01_L1").Name = "t_?" & aktualcis & "_komponent_display_01_L1"
          ActiveWorkbook.Names("t_?" & Format(poslednir, "000") & "_komponent_display_01_L2").Name = "t_?" & aktualcis & "_komponent_display_01_L2"
          ActiveWorkbook.Names("t_?" & Format(poslednir, "000") & "_stck_display_01_L1").Name = "t_?" & aktualcis & "_stck_display_01_L1"
          ActiveWorkbook.Names("t_?" & Format(poslednir, "000") & "_stck_display_01_L2").Name = "t_?" & aktualcis & "_stck_display_01_L2"
        End If
        ActiveCell.EntireRow.Select
        Selection.Resize(Selection.Rows.Count + 1, Selection.Columns.Count).Select
        Selection.EntireRow.Delete
        On Error Resume Next
        For cykl = 1 To poslednir
          ActiveSheet.Protection.AllowEditRanges("Display" & Format(cykl, "000")).Delete
        Next cykl
        On Error GoTo 0
        For cykl = 1 To poslednir - 1
          ActiveSheet.Protection.AllowEditRanges.Add title:="Display" & Format(cykl, "000"), Range:=Range("komponent_display_" & Format(cykl, "000") & ", stck_display_" & Format(cykl, "000"))
        Next cykl
        Range("komponent_display_001").Select
        ActiveSheet.Protect Password:=heslo
        ActiveWorkbook.Protect Password:=heslo
        Application.ScreenUpdating = True
      Else
        MsgBox hlaska(35), vbExclamation
      End If
    End If
  End If
  On Error GoTo 0
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
  kontrola
End Sub

Private Sub Workbook_Open()
  Application.ScreenUpdating = False
  newversion
  Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "formregion"
Attribute VB_Base = "0{E2AB48FE-A50F-44D0-82DB-0C548361953F}{B9699AC0-F5E0-4A6E-BE24-4E55C183FBF9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub btn_import_Click()
  Dim souborf As Variant
  Dim filialkaf As String
  ChDrive "C"
  ChDir "C:\Users\" & (Environ$("Username")) & "\Documents\"
  souborf = Application.GetOpenFilename(FileFilter:="Soubory Excel (*.txt), *.txt", MultiSelect:=False)
  If souborf <> False Then
    Open souborf For Input As #1
    Do While Not EOF(1)
      Input #1, filialkaf
      pridej filialkaf, 0
    Loop
    Close #1
  End If
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  If CloseMode = 0 Then
      'Cancel = True
      If MsgBox(hlaska(25), vbYesNo + vbQuestion) = vbYes Then
        btn_ulozit_Click
        Me.Hide
      Else
        Me.Hide
      End If
  End If
  Unload Me
End Sub

'Private Sub btn_matka_Click()
'  zmatky
'End Sub

Private Sub btn_odebrat_Click()
  Dim cyklf As Integer
  Dim pocet As Integer
  pocet = lst_fil.ListCount - 1
  cyklf = 0
  Do
    If lst_fil.Selected(cyklf) Then
      lst_fil.RemoveItem cyklf
      pocet = pocet - 1
    Else
      cyklf = cyklf + 1
    End If
  Loop While cyklf <= pocet
End Sub

Private Sub btn_pridat_Click()
  pridej txt_fil.Text, 1
End Sub

Private Sub btn_ulozit_Click()
  ulozitfil
  Me.Hide
End Sub

Private Sub txt_fil_keydown(ByVal keycode As msforms.ReturnInteger, ByVal shift As Integer)
  If keycode = 13 Then
    pridej txt_fil.Text, 1
    keycode = vbNull
  End If
End Sub

Private Sub UserForm_Activate()
  lst_fil.Clear
  pridatfilform
  txt_fil.SetFocus
End Sub




INQUEST-PP=macro
