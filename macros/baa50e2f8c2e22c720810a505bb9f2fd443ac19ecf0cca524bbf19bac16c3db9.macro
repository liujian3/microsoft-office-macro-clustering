Attribute VB_Name = "DeclaracionesGbl"
Option Explicit
Public i As Integer
Public j As Integer
Public Tipo As Variant
Public resp As Variant

Public Function Trim(strString) As String
Trim = Application.WorksheetFunction.Trim(strString)
End Function


Public Function Chr(strString) As Variant
On Error GoTo Error
Chr = Application.WorksheetFunction.Chr(strString)
Exit Function
Error:
Chr = ""
End Function
Attribute VB_Name = "Module1"
Public Const msgTITLE = "Quanticus Admincontrol Plus"

Public Sub Reemplaza()
    ActiveCell.Value = Replace(ActiveCell.Value, Chr(34), Chr(32))
End Sub

Public Sub Valida_Carateres()
    Cells.Replace What:="""", Replacement:="", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
        
    Cells.Replace What:="'", Replacement:="", LookAt:=xlPart, SearchOrder:= _
        xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False

End Sub
    
Attribute VB_Name = "M|fffd|dulo1"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = "A\n14"
'
' Macro1 Macro
'
' Acceso directo: Ctrl+May|fffd|s+A
'
    Range("AP11").Select
    ActiveWorkbook.Save
    ActiveSheet.Shapes("cmdListasPrecios").Select
    Selection.Verb Verb:=xlPrimary
    Range("AP2").Select
    ActiveSheet.Shapes("cmdListasPrecios").Select
    Range("AT5").Select
    ActiveSheet.Shapes("cmdListasPrecios").Select
    ActiveWorkbook.Save
    Range("AS5").Select
    ActiveWorkbook.Save
    Range("AT8").Select
End Sub
Attribute VB_Name = "M|fffd|dulo2"
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidaClientes, 72, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 73, 1, MSForms, CommandButton"

Private Sub cmdInsertaRenglon_Click()
    On Error GoTo falla
    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", msgTITLE)
    If resp = "0" Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Range("A1").Select
    End If
    'ValidaFormula
    Exit Sub
    
falla:
    MsgBox Err.Description
End Sub

Private Sub cmdValidaClientes_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("Catclientes").rows.Count
    Col = Range("Catclientes").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
      
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
      If Len(Trim(Pais_RFC)) > 0 Then
         MsgBox "El campo " & Pais_RFC & " es necesario si se expiden Facturas Electronicas.", vbInformation, msgTITLE
      End If
      MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
    
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    
 On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 32
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
            Case 0 'Clave_cliente
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 1 'Razon
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'N_Comercial
                If Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If

            Case 3 'RFC
                If Tipo = "Empty" Then
                    'MsgBox "El campo RFC es necesareo si se expiden Facturas Electronicas.", vbInformation, msgTITLE
                    Pais_RFC = "RFC"
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
                If Tipo <> "Empty" Then ActiveCell.Value = UCase(ActiveCell.Value)
                
            Case 4 'Curp
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 5  'Calle
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 6, 7 'N_Ext,N_Int
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 8 To 10 'Colonia,Ciudad,Comunidad
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 11 'CP
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 12 'Estado
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 13 ' Pa|fffd|s
                If Tipo = "Empty" Then
                    'MsgBox "El campo RFC es necesareo si se expiden Facturas Electronicas.", vbInformation, msgTITLE
                    Pais_RFC = Pais_RFC & ", Pa|fffd|s"
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 14 'Clave_Agente
                If Tipo = "Empty" Then
                    ActiveCell.Value = "*NA*" & (ActiveCell.Value)
                
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 15 'Lista_Precios
                If Tipo = "Empty" Then
                    ActiveCell.Value = "1" & (ActiveCell.Value)
                End If
                
            Case 16 'Plazo
                If Tipo = "Empty" Then
                    ActiveCell.Value = "0" & (ActiveCell.Value)
                End If
                
            Case 17 'Limite_Credito
                If Tipo = "Empty" Then
                    ActiveCell.Value = "0" & (ActiveCell.Value)
                End If
                
            Case 18, 19 'Dia_Revision, Dia_Pago
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite letras, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                End If
                
            Case 20 'Clave_Tipo
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 21 'Clave_Categoria
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 22 'Clave_Zona
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 23 'Clave_Giro
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 24 To 31 'Clave_Cat 1-8
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 32 'Imprimir
                If Tipo = "Empty" Then
                    ActiveCell.Value = "0" & (ActiveCell.Value)
                End If
                
        End Select
    Next i
    
   ' Valida_Carateres
    ActiveCell.Offset(0, -32).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next
    
End Function

Private Sub ValidaFormula()
    ActiveSheet.Range("Formula").Select
    Selection.Copy
    Range("FormulaAgente").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas
    Application.CutCopyMode = False
    ActiveSheet.Range("A1").Select
End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdListasPrecios, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdValidaProductos, 74, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 75, 2, MSForms, CommandButton"
Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntos renglones desea insertar?", "Insertar renglones")
    If resp = "0" Or Len(resp) = 0 Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Range("A1").Select
    End If
    
    'ValidaFormula
    
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub

Private Sub cmdListasPrecios_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas listas desea manejar?", "Listas de Precios")
    If Len(resp) = 0 Then Exit Sub
    If resp >= 2 Then
        Range("AS4").Select
        ActiveCell.FormulaR1C1 = "Precio1"
        For i = 1 To resp - 1
            Columns("AS:AS").Select
            Selection.Insert Shift:=xlToRight
            Selection.NumberFormat = "$#,##0.00"
            Range("AS4").Select
            ActiveCell.FormulaR1C1 = "Precio" & i + 1
            With Selection.Interior
                .ColorIndex = 33
                .Pattern = xlSolid
                .PatternColorIndex = xlAutomatic
            End With
        Next i
    End If
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub

Private Sub cmdValidaProductos_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CatProductoPrecio").rows.Count
    Col = Range("CatProductoPrecio").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC, Col)
     If (bError) Then bError = True: Exit For
                
     If IsEmpty(ActiveCell.Value) Then Exit For
      
      ActiveCell.Offset(0, -1).Activate
      
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
      If Len(Trim(Pais_RFC)) > 0 Then
         MsgBox "El campo " & Pais_RFC & " es necesario si se expiden Facturas Electronicas.", vbInformation, msgTITLE
      End If
      MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
    
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String, Col As Integer) As Boolean
 Dim Column As Integer
 
 On Error GoTo ErrValidaLinea
    Column = Col
    ValidaLinea = False
     
    For i = 0 To Column - 1
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Clave_Producto
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 1 'Descripcion
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2, 3, 4 'Codigo_Proveedor, Clave_1, Clave_2
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 5 To 13 'Clave_Proveedor,Clave_Categoria,Clave_Categoria_Sub_1,Clave_Categoria_Sub_2,Clave_Formato,Clave_Tamano,Clave_Fabricante,Clave_Marca,Clave_Color
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 14 'Modelo
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 15 To 22 'Clave_Cat 1-8
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 23 'Costo_Estandar
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Len(Trim(ActiveCell.Value)) > 28 Then
                    MsgBox "El campo solo admite un maximo de 28 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
            Case 24 'Precio_Minimo
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                    
            Case 25 'BDescuentos
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                End If
                
            Case 26  'Comision
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                End If
                
            Case 27:  'Comision_Porcentaje
                
            Case 28 'Clave_Moneda
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 29 To 39 'Tasa_IVA,Tasa_IEPS,Tasa_Suntuario,Tasa_Impuesto_1,Tasa_Impuesto_2, Servicio, Serie, Lote, Pedimento
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                End If
                    
'            Case 34 'Serie
'                If Tipo = "Empty" Then
'                    ActiveCell.Value = 0 & (ActiveCell.Value)
'                End If
'
'            Case 35 'Lote
'                If Tipo = "Empty" Then
'                    ActiveCell.Value = 0 & (ActiveCell.Value)
'                End If
'
'            Case 36 'Pedimento
'                If Tipo = "Empty" Then
'                    ActiveCell.Value = 0 & (ActiveCell.Value)
'                End If
                
            Case 40 'Clave_UM
                If Tipo = "Empty" Then
                    'MsgBox "El campo RFC es necesareo si se expiden Facturas Electronicas.", vbInformation, msgTITLE
                    'ActiveCell.Value = "PZ" & (ActiveCell.Value)
                ElseIf Len(Trim(ActiveCell.Value)) > 5 Then
                    MsgBox "El campo solo admite un maximo de 5 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 40 'Factor_UM
                If Tipo = "Empty" Then
                    ActiveCell.Value = 1 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
            Case 41 'Costo_Reposicion
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Len(Trim(ActiveCell.Value)) > 28 Then
                    MsgBox "El campo solo admite un maximo de 28 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
            
            Case Else 'PrecioN
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
        End Select
    Next i
    
    Column = Column * -1
    ActiveCell.Offset(0, Column + 1).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next
       
End Function

Private Sub ValidaFormula()

    ActiveSheet.Range("Formula2").Select
    Selection.Copy
    Range("FormulaProveedor").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas
    Application.CutCopyMode = False
    ActiveSheet.Range("A1").Select

End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidaAgentes, 34, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 35, 1, MSForms, CommandButton"
Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If Len(resp) = 0 Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
    End If
    ActiveSheet.Range("A1").Select
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub

Private Sub cmdValidaAgentes_Click()

    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CatAgentes").rows.Count
    Col = Range("CatAgentes").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
      
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
    
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 14
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Clave_Agente
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 1 'Clave_Tipo
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'Clave_Zona
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 3 'Nombre
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 120 Then
                    MsgBox "El campo solo admite un maximo de 120 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 4 'Apellido
                If Len(Trim(ActiveCell.Value)) > 120 Then
                    MsgBox "El campo solo admite un maximo de 120 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                    
            Case 5 'Razon
                If Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 6 'RFC
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 7 'Curp
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 8  'Calle
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 9, 10 'Colonia,Ciudad
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                   
            Case 11 'CP
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 12 'Estado
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 13 ' Pa|fffd|s
                If Tipo = "Empty" Then
                    'MsgBox "El campo RFC es necesareo si se expiden Facturas Electronicas.", vbInformation, msgTITLE
                    Pais_RFC = Pais_RFC & ", Pa|fffd|s"
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                                
           Case 14 ' Comision_Porcentaje
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite un maximo de 28 carateres, revise sus datos", vbCritical, msgTITLE
                End If
                
        End Select
    Next i
    ActiveCell.Offset(0, -14).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidaProveedores, 31, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 32, 1, MSForms, CommandButton"
Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If Len(resp) = 0 Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
    End If
    ActiveSheet.Range("A1").Select
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub

Private Sub cmdValidaProveedores_Click()

    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CatProveedor").rows.Count
    Col = Range("CatProveedor").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
      
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
    
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 26
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Clave_Proveedor
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 1 'Razon
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'RFC
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 3 'Curp
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 4  'Calle
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 5 To 7 'Colonia,Ciudad,Comunidad
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            'Case 6, 7 'N_Ext,N_Int
                'If Len(Trim(ActiveCell.Value)) > 20 Then
                    'MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    'GoTo Exit_Valida_Linea
                    
                'ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    'ActiveCell.Value = "'" & (ActiveCell.Value)
                'End If
            
            Case 8 'CP
                If Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
            
            Case 9 'Estado
                If Len(Trim(ActiveCell.Value)) > 100 Then
                    MsgBox "El campo solo admite un maximo de 100 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 10 ' Pa|fffd|s
                If Tipo = "Empty" Then
                    'MsgBox "El campo RFC es necesareo si se expiden Facturas Electronicas.", vbInformation, msgTITLE
                    Pais_RFC = Pais_RFC & ", Pa|fffd|s"
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 11 ' Telefono
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 12 'Clave_Agente
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 13 'Plazo
                If Tipo = "Empty" Then
                    ActiveCell.Value = "0" & (ActiveCell.Value)
                End If
                
            Case 14 'Limite_Credito
                If Tipo = "Empty" Then
                    ActiveCell.Value = "0" & (ActiveCell.Value)
                End If
                
            Case 15 'Clave_Tipo
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 16 'Clave_Categoria
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 17 'Clave_Zona
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 18 'Clave_Giro
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 19 To 26 'Clave_Cat 1-8
                If Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
        End Select
    Next i
    ActiveCell.Offset(0, -26).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidaCuentas, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 2, 1, MSForms, CommandButton"



Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If Len(resp) = 0 Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
    End If
    ActiveSheet.Range("A1").Select
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub

Private Sub cmdValidaCuentas_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CatCuentas").rows.Count
    Col = Range("CatCuentas").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean

    
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 2
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Cuenta_Numero
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsNumeric(ActiveCell.Value) Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                End If
                
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                 ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                End If
                
            Case 1 'Cuenta_Nombre
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                End If
                
            Case 2 'Cuenta_Tipo
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 50 Then
                    MsgBox "El campo solo admite un maximo de 50 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                End If
                
        End Select
        
    Next i
    ActiveCell.Offset(0, -2).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidarCuentas, 26, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 27, 1, MSForms, CommandButton"
Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If resp = "0" Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Range("A1").Select
    End If
    
    'ValidaFormula
    
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub
Private Sub ValidaFormula()

    ActiveSheet.Range("Formula4").Select
    Selection.Copy
    Range("FormulaCliente").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas
    Application.CutCopyMode = False
    ActiveSheet.Range("A1").Select

End Sub

Private Sub cmdValidarCuentas_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CxCSub").rows.Count
    Col = Range("CxCSub").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 4
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Fecha
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsDate(ActiveCell.Value) Then
                    MsgBox "El campo no es valido, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsDate(ActiveCell.Value) Then
                    ActiveCell.Value = Format$(ActiveCell.Value, "dd/mm/yyyy")
                End If
                
             Case 1 'Clave_cliente
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'Fecha_Cobrar
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsDate(ActiveCell.Value) Then
                    MsgBox "El campo no es valido, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsDate(ActiveCell.Value) Then
                    ActiveCell.Value = Format(ActiveCell.Value, "dd/mm/yyyy")
                End If
                
            Case 3 'Documento_Cargo
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                               
            Case 4 'Cargo
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
        End Select
        
    Next i
    ActiveCell.Offset(0, -4).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdValidarCuentas, 23, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdInsertaRenglon, 24, 1, MSForms, CommandButton"

Private Sub cmdInsertaRenglon_Click()

    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If resp = "0" Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Range("A1").Select
    End If
    
    'ValidaFormula
    
    Exit Sub
    
falla:
    MsgBox Err.Description

End Sub
Private Sub ValidaFormula()

    ActiveSheet.Range("Formula5").Select
    Selection.Copy
    Range("FormulaProveedorCxP").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas
    Application.CutCopyMode = False
    ActiveSheet.Range("A1").Select

End Sub

Private Sub cmdValidarCuentas_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("CxPSub").rows.Count
    Col = Range("CxPSub").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 4
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
        
            Case 0 'Fecha
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsDate(ActiveCell.Value) Then
                    MsgBox "El campo no es valido, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsDate(ActiveCell.Value) Then
                    ActiveCell.Value = Format$(ActiveCell.Value, "dd/mm/yyyy")
                End If
                
             Case 1 'Clave_Proveedor
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'Fecha_Pagar
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsDate(ActiveCell.Value) Then
                    MsgBox "El campo no es valido, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsDate(ActiveCell.Value) Then
                    ActiveCell.Value = Format(ActiveCell.Value, "dd/mm/yyyy")
                End If
                
            Case 3 'Documento_Cargo
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                               
            Case 4 'Cargo
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
        End Select
        
    Next i
    ActiveCell.Offset(0, -4).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdInsertaRenglon, 26, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdValidaExistencias, 58, 2, MSForms, CommandButton"
Private Sub cmdInsertaRenglon_Click()
    On Error GoTo falla

    resp = InputBox("Cu|fffd|ntas renglones desea insertar?", "Insertar renglones")
    If Len(resp) = 0 Then Exit Sub
    If resp >= 1 Then
        rows("6:6").Select
        fin = 6 + resp - 1
        rows("6:" & fin).Select
        Selection.Insert Shift:=xlDown
        ActiveSheet.Range("A1").Select
    End If
    'ValidaFormula
    Exit Sub
    
falla:
    MsgBox Err.Description
End Sub

Private Sub ValidaFormula()
    ActiveSheet.Range("Formula3").Select
    Selection.Copy
    Range("FormulaProducto").Select
    Selection.PasteSpecial Paste:=xlPasteFormulas
    Application.CutCopyMode = False
    ActiveSheet.Range("A1").Select
End Sub

Private Sub cmdValidaExistencias_Click()
    Dim bError As Boolean
    Dim UltimaFila As Integer
    Dim row As Integer
    Dim i As Integer
    Dim Col As Integer
    Dim Pais_RFC As String
    
    row = Range("Existencias").rows.Count
    Col = Range("Existencias").Columns.Count
    
    ActiveSheet.Range("A5").Select
    
    For i = 1 To row - 1
    
     UltimaFila = ActiveCell.row
     bError = ValidaLinea(Pais_RFC)
     If (bError) Then bError = True: Exit For
        
      If IsEmpty(ActiveCell.Value) Then Exit For
        
      ActiveCell.Offset(0, -1).Activate
           
    Next i
    
    If (i <= row - 1) And (bError = False) Then bError = Valida_Rezagados(UltimaFila, row, Col, i)
    Valida_Carateres
    
    If Not (bError) Then
       MsgBox "Validaci|fffd|n terminada." & Chr(13) & "Revise sus datos antes de importarlos", , msgTITLE
    End If
End Sub

Private Function Valida_Rezagados(UltimaFila As Integer, row As Integer, Col As Integer, i As Integer) As Boolean
  Dim Pos As Integer
         
   Valida_Rezagados = False
   For j = 1 To row - i
         
        If Not IsEmpty(ActiveCell.Value) Then Pos = ActiveCell.row
            
        If Pos > UltimaFila Then
           MsgBox "Hay l|fffd|neas vacias entre registros, revise sus datos", , msgTITLE
           Valida_Rezagados = True
           
           Pos = -1 * ((Pos - 1) - UltimaFila)
           ActiveCell.Offset(Pos, 0).Activate
           
           Exit For
        End If
        ActiveCell.Offset(1, 0).Activate
         
      Next j
       
End Function

Private Function ValidaLinea(Pais_RFC As String) As Boolean
    On Error GoTo ErrValidaLinea
 
    ValidaLinea = False
    For i = 0 To 7
    
        ActiveCell.Offset(0, 1).Activate
        Tipo = TypeName(ActiveCell.Value)
        
        Select Case i
             
            Case 0 'Clave_Producto
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Len(Trim(ActiveCell.Value)) > 20 Then
                    MsgBox "El campo solo admite un maximo de 20 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 1 'Descripcion
                If Len(Trim(ActiveCell.Value)) > 255 Then
                    MsgBox "El campo solo admite un maximo de 255 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf IsNumeric(ActiveCell.Value) Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 2 'Ctd
                If Tipo = "Empty" Then
                    MsgBox "El campo no puede estar vacio, revise sus datos", , msgTITLE
                    GoTo Exit_Valida_Linea
                    
                 ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                End If
                
            Case 3 'Clave_UM
                If Tipo = "Empty" Then
                   MsgBox "El campo no puede estar vacio, revise sus datos", vbCritical, msgTITLE
                   GoTo Exit_Valida_Linea
                      
                ElseIf Len(Trim(ActiveCell.Value)) > 5 Then
                    MsgBox "El campo solo admite un maximo de 5 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                
                ElseIf IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    ActiveCell.Value = "'" & (ActiveCell.Value)
                End If
                
            Case 4 'Factor_UM
                If Tipo = "Empty" Then
                    ActiveCell.Value = 1 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
            Case 5 'Costo_Unitario(Estandar)
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Len(Trim(ActiveCell.Value)) > 28 Then
                    MsgBox "El campo solo admite un maximo de 28 carateres, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                    
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                    GoTo Exit_Valida_Linea
                End If
                
            Case 6, 7 'Tasa_IVA,Tasa_IEPS
                If Tipo = "Empty" Then
                    ActiveCell.Value = 0 & (ActiveCell.Value)
                ElseIf Not IsNumeric(ActiveCell.Value) And (Tipo <> "Empty") Then
                    MsgBox "El campo solo admite numeros, revise sus datos", vbCritical, msgTITLE
                End If
        End Select
        
    Next i
    ActiveCell.Offset(0, -7).Activate
    ActiveCell.Offset(1, 0).Activate
    Exit Function
    
Exit_Valida_Linea:
    ValidaLinea = True
    Exit Function
    
ErrValidaLinea:
    MsgBox "Error No " & Err.Number & Chr(13) & Err.Description, , msgTITLE
    Resume Next

End Function

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
