Attribute VB_Name = "ArkData"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim dataset As Integer

Private Sub CommandButton1_Click()
    KopierTilData
End Sub

Private Sub Worksheet_Activate()
    dataset = CInt(Trim(Right(Range("C2").Value, 2)))
End Sub

Private Sub Worksheet_Change(ByVal target As Range)
    UpdateAll target
End Sub
Sub UpdateAll(ByVal target As Range)
Dim i As Long
Dim j As Long
Dim k As Integer
Dim s(20000) As String
Dim v(20000) As Long
Dim t As String
Dim fundet As Boolean
Dim startrow As Integer
Dim antaldata As Long
Dim vint As Double
Dim hint As Double
Dim obs As Double
Dim r As Integer, c As Integer
Dim dsn As Integer
On Error Resume Next
Application.Calculation = xlCalculationManual
r = Selection.Row
c = Selection.Column
On Error GoTo slut
Application.ScreenUpdating = False
Application.Enableevents = False
    
    If target.Row = 2 And target.Column = 3 Then ' nyt datas|fffd|t
        dsn = CInt(Trim(Right(Range("C2").Value, 2)))
        SaveData (dataset)
        LoadData (dsn)
        Application.Calculate
    End If
    dataset = CInt(Trim(Right(Range("C2").Value, 2)))


If target.Row = 2 And target.Column > 5 And target.Column < 9 Then
    LavIntervaller
End If

antaldata = Cells(4, 2).Value
'antaldata = Application.WorksheetFunction.Count(A:A)
startrow = 5

If target.Column = 1 And target.Row > startrow - 1 Then
' delete ugrup data
i = 1
Do While Cells(startrow + i, 3).Value <> ""
    i = i + 1
Loop
Range("c1:d" & i).Offset(startrow - 1, 0).ClearContents
i = 0

' t|fffd|l hyppigheder
Do
    t = Range("A1").Offset(i + startrow - 1, 0).Value
    fundet = False
    For j = 0 To k
        If t = s(j) Then
            fundet = True
            Exit For
        End If
    Next
    If Not fundet Then
        s(k) = t
        v(k) = 1
        k = k + 1
    Else
        v(j) = v(j) + 1
    End If
    i = i + 1
Loop Until Range("A1").Offset(i + startrow - 1, 0).Value = ""

For i = 0 To k - 1
    Range("c1").Offset(i + startrow - 1, 0).Value = Val(Replace(s(i), ",", "."))
    Range("d1").Offset(i + startrow - 1, 0).Value = v(i)
Next
'    Range("C5:D11").Select
'    ActiveWorkbook.Worksheets("Data").Sort.SortFields.Clear
'    ActiveWorkbook.Worksheets("Data").Sort.SortFields.Add key:=Range("C5"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    ArkData.Sort.SortFields.Clear
    ArkData.Sort.SortFields.Add key:=Range("C5"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveSheet.Sort
        .SetRange Range("C" & startrow & ":D" & k - 1 + startrow)
        .Header = xlGuess
'        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End If


If (target.Column < 8 And target.Row > startrow - 1 And Len(Cells(5, 3).Value) > 0) Or target.Row = 2 And target.Column > 5 And target.Column < 9 Then
' delete grup data ' T|fffd|l grupperede
i = 1
Do While Cells(startrow + i, 7).Value <> "" Or Cells(startrow + i, 8).Value <> ""
    i = i + 1
Loop

' t|fffd|l grupperede op
Range("h1:h" & i).Offset(startrow - 1, 0).ClearContents
i = 0

Do While Cells(startrow + i, 3).Value <> ""
    obs = Cells(startrow + i, 3).Value
'    vint = Cells(startrow, 6).Value
'    hint = Cells(startrow, 7).Value
'    If obs >= vint And obs <= hint Then 'f|fffd|rste interval er begge med ender med
'        Cells(startrow, 8).Value = Cells(startrow, 8).Value + Cells(startrow + i, 4).Value
'    End If
    j = 0
    Do While Cells(startrow + j, 7).Value <> ""
        vint = Cells(startrow + j, 6).Value
        hint = Cells(startrow + j, 7).Value
        If obs > vint And obs <= hint Then
            Cells(startrow + j, 8).Value = Cells(startrow + j, 8).Value + Cells(startrow + i, 4).Value
        End If
        j = j + 1
    Loop
    i = i + 1
Loop
End If
' inds|fffd|t 0 ved grup-hyppigheder hvis ingen
j = 0
Do While Cells(startrow + j, 7).Value <> ""
    If Range("H5").Offset(j, 0).Value = "" Then
        Range("H5").Offset(j, 0).Value = 0
    End If
    j = j + 1
Loop

'prikdiagram
OpdaterPrikDiagram
Call OpdaterHistogram2(ArkData, "Diagram 3", 5, 6, "L", "M")


slut:
On Error Resume Next
    ActiveSheet.Range("A1").Activate
    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
Application.ScreenUpdating = True
Application.Enableevents = True
Application.Calculation = xlCalculationAutomatic 'xlCalculationManual
End Sub

Sub KopierTilData()
Dim i As Integer, j As Integer, k As Integer
Dim r As Integer
Dim c As Integer
Dim n As Long, s As Double
Application.ScreenUpdating = False
Application.Enableevents = False

On Error Resume Next
r = Selection.Row
c = Selection.Column
If r = 0 Then r = 1
If c = 0 Then c = 1
On Error GoTo fejl

' slet goodness of fit
    n = 0
    Do
        n = n + 2
    Loop While ArkGOF.Range("A3").Offset(n, 0).Value <> ""
    ArkGOF.Range("A3:D" & n + 3).ClearContents
' slet Histogram fit
    n = 0
    Do
        n = n + 2
    Loop While ArkHisto.Range("A4").Offset(n, 0).Value <> ""
    ArkHisto.Range("A4:C" & n + 4).ClearContents
' slet p|fffd| grup-ark
    n = 0
    Do
        n = n + 2
    Loop While ArkGrup.Range("A4").Offset(n, 0).Value <> ""
    ArkGrup.Range("A4:E" & n + 4).ClearContents
' slet p|fffd| UGrup-ark
    n = 0
    Do
        n = n + 2
    Loop While ArkUgrup.Range("A3").Offset(n, 0).Value <> ""
    ArkUgrup.Range("A3:D" & n + 4).ClearContents



' slet normal-plot data
Do
    j = j + 2
Loop While ArkNormal.Range("A3").Offset(j, 0).Value <> ""
ArkNormal.Range("A3:B" & j + 3).ClearContents

j = 0
Dim trin As Integer
trin = Application.WorksheetFunction.sum(Range("d:d")) / 1000
If trin < 1 Then
    trin = 1
End If
Do
    i = i + 1 ' t|fffd|l ugrup op
    For j = 1 To Range("d4").Offset(i, 0).Value / trin ' overf|fffd|r til normal-plot
        k = k + 1
        ArkNormal.Range("a2").Offset(k, 0).Value = Range("C4").Offset(i, 0).Value
    Next
Loop While Range("d4").Offset(i, 0).Value <> ""

    Range("C5:D" & i + 3).Select
    Selection.Copy
    ArkUgrup.Select
    ActiveSheet.Range("A3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
' kopier grupperede
ArkData.Select
j = 0
Do
    j = j + 1
Loop While Range("g4").Offset(j, 0).Value <> ""
    If j > 1 Then
    Range("F5:H" & j + 3).Select
    Selection.Copy
    ArkGrup.Select
    ActiveSheet.Range("A4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
' kopier til Histogram-Fit
    ArkHisto.Select
    ActiveSheet.Range("A4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    n = Application.WorksheetFunction.Count(Range("G5:G10000"))
    s = Application.WorksheetFunction.sum(Range("H5:H" & n + 4))
    For j = 0 To n - 1
        ArkHisto.Range("C4").Offset(j, 0).Value = ArkHisto.Range("C4").Offset(j, 0).Value / s
    Next
' kopier til Goodness of fit
    ArkGOF.Select
    ActiveSheet.Range("A3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    Application.CutCopyMode = False
    For j = 0 To n - 1
        ArkHisto.Range("C3").Offset(j, 0).Value = ArkHisto.Range("C3").Offset(j, 0).Value
    Next
    End If
    
' kopier til normalplot
'Sheets("Data").Select
'Sheets("Normal-Plot").Select


GoTo slut
fejl:
    MsgBox Lang.A(7), vbOKOnly, Lang.A(8)
slut:
    On Error Resume Next
ArkData.Select
    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
Application.Enableevents = True
Application.ScreenUpdating = True
End Sub

Sub OpdaterPrikDiagram()

Dim i As Integer
Dim n As Integer ' hyppighed
Dim j As Integer
Dim k As Integer  ' samlede antal punkter p|fffd| prikdiagram
Dim x As Double ' stok var
Dim maxv As Integer

Do While Cells(i + 5, 3).Value <> ""
    x = Cells(i + 5, 3).Value
    n = Cells(i + 5, 4).Value
    If n > maxv Then maxv = n
    For j = 1 To n
        k = k + 1
        Cells(k + 4, 10).Value = x
        Cells(k + 4, 11).Value = j
    Next
    i = i + 1
Loop
ActiveSheet.ChartObjects("Diagram 2").Activate
ActiveChart.SeriesCollection(1).XValues = ArkData.Range("$J$5:$J$" & k + 4)
ActiveChart.SeriesCollection(1).Values = ArkData.Range("$K$5:$K$" & k + 4)
If maxv < 10 Then maxv = 10
ActiveChart.Axes(xlValue).MaximumScale = maxv + 2

'ActiveChart.Axes(xlValue).Visible = False

End Sub

Sub LavIntervaller()
Dim i As Integer
Dim start As Double
Dim slut As Double
Dim delta As Double



Do
    i = i + 1
Loop While Range("G4").Offset(i, 0).Value <> ""
Range("F5:H" & i + 5).ClearContents

start = Cells(2, 6).Value
slut = Cells(2, 7).Value
delta = Cells(2, 8).Value

If slut <= start Or delta = 0 Then GoTo slut

i = 0
Do
    Cells(5 + i, 6).Value = start + delta * i
    Cells(5 + i, 7).Value = start + delta * (i + 1)
    i = i + 1
Loop While start + delta * i < slut

slut:
End Sub

Sub SaveData(no As Integer)
Dim antaldata As Long
Dim AntalUgrup As Long
Dim AntalGrup As Long
Dim r As Integer, c As Integer
'Application.ScreenUpdating = False
'Application.EnableEvents = False
On Error GoTo fejl
'Application.Calculation = xlCalculationManual
'r = Selection.Row
'c = Selection.Column
ArkData.Calculate
antaldata = ArkData.Range("B4").Value
AntalUgrup = ArkData.Range("E4").Value
AntalGrup = ArkData.Range("I4").Value
    
    ArkGemte.Range("A11:F" & 11 + ArkGemte.Range("F4").Value).Offset(0, (no - 1) * 6).ClearContents
    'kopier r|fffd|data
    If antaldata > 0 Then
    Range("A5:A" & antaldata + 4).Select
    Selection.Copy
    ArkGemte.Select
    ActiveSheet.Range("A11").Offset(0, (no - 1) * 6).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    ArkData.Activate
    End If
    
    ' kopiere ugrupperede
    If AntalUgrup > 0 Then
    Range("C5:D" & AntalUgrup + 4).Select
    Selection.Copy
    ArkGemte.Select
    ActiveSheet.Range("B11").Offset(0, (no - 1) * 6).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    ArkData.Activate
    End If
    
    ' kopiere grupperede
    If AntalGrup > 0 Then
    Range("F5:H" & AntalGrup + 4).Select
    Selection.Copy
    ArkGemte.Select
    ActiveSheet.Range("D11").Offset(0, (no - 1) * 6).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End If
    Application.CutCopyMode = False

GoTo slut
fejl:
    MsgBox Lang.A(7), vbOKOnly, Lang.A(8)
slut:
'Application.EnableEvents = True
'On Error Resume Next
'    Sheets("Data").Activate
'    Sheets("Data").Range("A1").Activate
'    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate

End Sub

Sub LoadData(no As Integer)
Dim antaldata As Long
Dim AntalUgrup As Long
Dim AntalGrup As Long
Dim r As Integer, c As Integer
On Error GoTo fejl
'Application.Calculation = xlCalculationManual
'r = Selection.Row
'c = Selection.Column
ArkGemte.Calculate
antaldata = ArkGemte.Range("F1").Offset(0, (no - 1) * 6).Value
AntalUgrup = ArkGemte.Range("F2").Offset(0, (no - 1) * 6).Value
AntalGrup = ArkGemte.Range("F3").Offset(0, (no - 1) * 6).Value

    ArkData.Range("A5:A" & ArkData.Range("B4").Value + 5).ClearContents
    'kopier r|fffd|data
    If antaldata > 0 Then
    ArkGemte.Activate
    ActiveSheet.Range("A11:A" & antaldata + 11).Offset(0, (no - 1) * 6).Select
    Selection.Copy
    ArkData.Select
    ActiveSheet.Range("A5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End If
    
    ' kopiere ugrupperede
    ArkData.Range("C5:D" & ArkData.Range("B4").Value + 5).ClearContents
    If AntalUgrup > 0 Then
    ArkGemte.Activate
    ActiveSheet.Range("B11:C" & AntalUgrup + 11).Offset(0, (no - 1) * 6).Select
    Selection.Copy
    ArkData.Select
    ActiveSheet.Range("C5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End If
    
    ' kopiere grupperede
    ArkData.Range("F5:H" & ArkData.Range("B4").Value + 5).ClearContents
    If AntalGrup > 0 Then
    ArkGemte.Activate
    ActiveSheet.Range("D11:F" & AntalGrup + 11).Offset(0, (no - 1) * 6).Select
    Selection.Copy
    ArkData.Select
    ActiveSheet.Range("F5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
    End If
    
    Application.CutCopyMode = False
    ArkData.Activate

GoTo slut
fejl:
    MsgBox Lang.A(7), vbOKOnly, Lang.A(8)
slut:
'On Error Resume Next
'    Sheets("Data").Activate
'    Sheets("Data").Range("A1").Activate
'    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate


End Sub
Attribute VB_Name = "ArkGOF"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    GFUpdate
End Sub

Private Sub Worksheet_Change(ByVal target As Range)
    GFUpdate
End Sub
Sub GFUpdate()
'    ActiveChart.SetElement (msoElementSecondaryValueAxisNone)
'    ActiveChart.SetElement (msoElementSecondaryValueAxisShow)
'    ActiveChart.Axes(xlValue, xlSecondary).Select
Dim r As Integer, c As Integer
On Error Resume Next
r = Selection.Row
c = Selection.Column
    ArkGOF.ChartObjects("Diagram 2").Chart.Axes(xlValue, xlPrimary).MaximumScale = Int(1000 * ArkMellem.Range("B1001").Value + 1) / 1000
'    Sheets("Frekvensfunktion").Axes(xlValue, xlPrimary).MaximumScale = Int(1000 * Sheets("Hj|fffd|lp").Range("B1001").Value + 1) / 1000
'    Sheets("Chi2Fordeling").ChartObjects("Diagram 6").Chart.Axes(xlValue, xlPrimary).MaximumScaleIsAuto = True
    ArkGOF.ChartObjects("Diagram 2").Chart.Axes(xlValue, xlSecondary).MaximumScale = ArkGOF.ChartObjects("Diagram 2").Chart.Axes(xlValue, xlPrimary).MaximumScale

    ArkGOF.ChartObjects("Diagram 2").Chart.Axes(xlCategory, xlPrimary).MinimumScale = 0
    ArkGOF.ChartObjects("Diagram 2").Chart.Axes(xlCategory, xlPrimary).MaximumScale = Range("F12").Value
'    Sheets("Frekvensfunktion").Axes(xlCategory, xlPrimary).MinimumScale = 0
'    Sheets("Frekvensfunktion").Axes(xlCategory, xlPrimary).MaximumScale = Range("D6").Value
    n = Application.WorksheetFunction.Count(Range("A:A"))
'    arkgof.ChartObjects("Diagram 3").Chart.SeriesCollection(1).Values = "=$C$3:$C$" & n + 3
'    arkgof.ChartObjects("Diagram 3").Chart.SeriesCollection(2).Values = "=$D$3:$D$" & n + 3

    ArkGOF.ChartObjects("Diagram 3").Activate
    ActiveChart.SeriesCollection(1).Values = ArkGOF.Range("$C$3:$C$" & n + 2)
    ActiveChart.SeriesCollection(2).Values = ArkGOF.Range("$D$3:$D$" & n + 2)
If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
    
End Sub
Sub SymmetriskFordeling()
Dim n As Integer, i As Integer
Dim x As Double, su As Double
On Error GoTo slut
    Application.ScreenUpdating = False
    Application.Enableevents = False
    Do While Range("C3").Offset(n, 0).Value <> ""
        su = su + Range("C3").Offset(n, 0).Value
        n = n + 1
    Loop
    If n = 0 Then GoTo slut
    
    x = Range("B2").Offset(n, 0).Value - Range("A3").Value
    For i = 1 To n
        Range("D2").Offset(i, 0).Value = (Range("B2").Offset(i, 0).Value - Range("A2").Offset(i, 0).Value) / x * su
    Next
slut:
    Application.ScreenUpdating = True
    Application.Enableevents = True
End Sub
Sub GFNormalFordeling()
Dim n As Integer, i As Integer
Dim m As Double, s As Double, su As Double
Dim res As String
On Error GoTo slut

res = InputBox(Lang.A(37))
If res = "" Then GoTo slut
m = Val(Replace(res, ",", "."))
res = InputBox(Lang.A(38))
If res = "" Then GoTo slut
s = Val(Replace(res, ",", "."))
    Application.ScreenUpdating = False
    Application.Enableevents = False
    Do While Range("C3").Offset(n, 0).Value <> ""
        su = su + Range("C3").Offset(n, 0).Value
        n = n + 1
    Loop
    
    For i = 1 To n
        Range("D2").Offset(i, 0).Value = (Application.WorksheetFunction.NormDist(Range("B2").Offset(i, 0).Value, m, s, True) - Application.WorksheetFunction.NormDist(Range("A2").Offset(i, 0).Value, m, s, True)) * su
    Next
slut:
    Application.ScreenUpdating = True
    Application.Enableevents = True

End Sub

Attribute VB_Name = "ArkGemte"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ArkGrup"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
    Dim r As Integer, c As Integer

Private Sub Worksheet_Activate()
    
Application.Calculate
    
    OpdaterAltGrup

End Sub

Private Sub Worksheet_Change(ByVal target As Range)
    
    OpdaterAltGrup
    
End Sub
Sub OpdaterAltGrup()
    On Error GoTo slut
    Application.Calculation = xlCalculationManual
    r = Selection.Row
    c = Selection.Column
    Application.ScreenUpdating = False
    Application.Enableevents = False
    
    OpdaterSumkurve
    'OpdaterHistogram
    Call OpdaterHistogram2(ArkGrup, "Diagram 3", 4, 1, "M", "N")
    
    'boksplot
'    On Error Resume Next
'    ActiveSheet.ChartObjects("Diagram 4").Activate
'    If Err.Number <> 0 Then
'        Err.Clear
'        GoTo slut
'    End If
'    ActiveChart.PlotBy = xlRows
'    SetChartFormatting
slut:
    On Error Resume Next
'    ActiveSheet.Range("A1").Activate
    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
    Application.Enableevents = True
    Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

End Sub
Sub OpdaterSumkurve()
'
' Sumkurve Makro
'
    On Error GoTo slut
    Dim A As Double, b As Double
    Dim i As Integer
    Dim ni As Integer
    Dim mi As Integer
    Dim ui As Integer
    Dim pi As Integer
    Dim p2i As Integer
    Dim if1 As Integer, if2 As Integer ' til invers fraktil
    Dim n As Long
    ni = 3
    mi = 3
    ui = 3
    pi = 3
    p2i = 3
    if1 = 3
    if2 = 3
    Dim yv As Double
    Dim xv As Double
    Dim midv As Double
    Dim sumk As Double
    i = 3
    Cells(3, 8).Value = Cells(4, 1)
    Cells(3, 9).Value = 0
    Cells(2, 3).FormulaR1C1 = "=sum(R4C3:R8C3)"
'    Range("D4:E100").ClearContents ' problematisk da dokumentet s|fffd| bliver for langt i Word
'    Range("H4:I100").ClearContents ' kan m|fffd|ske implementeres celle for celle s|fffd| kun relevante slettes
    Cells(2, 3).FormulaR1C1 = "=sum(R4C3:R500C3)"
    Do
        i = i + 1
        n = n + Cells(i, 3).Value
        Cells(i, 4).FormulaR1C1 = "=R" & i & "C3/R2C3"
        If i > 4 Then
            Cells(i, 5).FormulaR1C1 = "=R" & i & "C4+R" & i - 1 & "C5"
        Else
            Cells(i, 5).FormulaR1C1 = "=R" & i & "C4"
        End If
        Cells(i, 8).FormulaR1C1 = "=R" & i & "C2"
        Cells(i, 9).FormulaR1C1 = "=R" & i & "C5"
        
        midv = midv + (Cells(i, 2).Value + Cells(i, 1).Value) / 2 * Cells(i, 4).Value
        sumk = sumk + Cells(i, 3).Value * (Cells(i, 2).Value + Cells(i, 1).Value) ^ 2 / 4
        xv = CDbl(Cells(i, 8).Value)
        yv = CDbl(Cells(i, 9).Value)
        If yv <= 0.25 Then
            ni = i
        End If
        If yv <= 0.5 Then
            mi = i
        End If
        If yv <= 0.75 Then
            ui = i
        End If
        If yv <= Cells(9, 7).Value Then
            pi = i
        End If
        If yv <= Cells(10, 7).Value Then
            p2i = i
        End If
        If Cells(i, 1).Value <= Cells(9, 6).Value And Cells(i, 2).Value > Cells(9, 6).Value Then
            if1 = i
        End If
        If Cells(i, 1).Value <= Cells(10, 6).Value And Cells(i, 2).Value > Cells(10, 6).Value Then
            if2 = i
        End If
    Loop While Cells(i + 1, 1).Value <> "" And Cells(i + 1, 2).Value <> ""
    Cells(2, 3).FormulaR1C1 = "=sum(R4C3:R" & i & "C3)"
'    On Error Resume Next
    
'middeltal
Cells(11, 7).Value = midv
'spredning
Cells(12, 7).Value = (sumk / n - Cells(11, 7).Value ^ 2) ^ 0.5

    'kvartils|fffd|t
    Cells(4, 7).Value = Cells(ni, 8).Value + (0.25 - Cells(ni, 9).Value) * (Cells(ni + 1, 8).Value - Cells(ni, 8).Value) / (Cells(ni + 1, 9).Value - Cells(ni, 9).Value)
    Cells(5, 7).Value = Cells(mi, 8).Value + (0.5 - Cells(mi, 9).Value) * (Cells(mi + 1, 8).Value - Cells(mi, 8).Value) / (Cells(mi + 1, 9).Value - Cells(mi, 9).Value)
    Cells(6, 7).Value = Cells(ui, 8).Value + (0.75 - Cells(ui, 9).Value) * (Cells(ui + 1, 8).Value - Cells(ui, 8).Value) / (Cells(ui + 1, 9).Value - Cells(ui, 9).Value)
    ' fraktiler
    If r >= 9 And r <= 11 And c = 7 Then ' hopper 1 ned ved enter
    If Cells(9, 7).Value <> "" Then
        Cells(9, 6).Value = Cells(pi, 8).Value + (Cells(9, 7).Value - Cells(pi, 9).Value) * (Cells(pi + 1, 8).Value - Cells(pi, 8).Value) / (Cells(pi + 1, 9).Value - Cells(pi, 9).Value)
    Else
        Cells(9, 6).Value = ""
    End If
    If Cells(10, 7).Value <> "" Then
        Cells(10, 6).Value = Cells(p2i, 8).Value + (Cells(10, 7).Value - Cells(p2i, 9).Value) * (Cells(p2i + 1, 8).Value - Cells(p2i, 8).Value) / (Cells(p2i + 1, 9).Value - Cells(p2i, 9).Value)
    Else
        Cells(10, 6).Value = ""
    End If
    End If
    ' invers fraktiler
    If r >= 9 And r <= 11 And c = 6 Then
    If Cells(9, 6).Value <> "" Then
        If if1 = 3 Then
            If Cells(9, 6).Value <= Cells(4, 1).Value Then
                Cells(9, 7).Value = 0
            Else
                Cells(9, 7).Value = 1
            End If
        Else
            A = (Cells(if1, 9).Value - Cells(if1 - 1, 9).Value) / (Cells(if1, 8).Value - Cells(if1 - 1, 8).Value)
            b = Cells(if1, 9).Value - A * Cells(if1, 8).Value
            Cells(9, 7).Value = A * Cells(9, 6).Value + b
        End If
    End If
    If Cells(10, 6).Value <> "" Then
        If if2 = 3 Then
            If Cells(10, 6).Value <= Cells(4, 1).Value Then
                Cells(10, 7).Value = 0
            Else
                Cells(10, 7).Value = 1
            End If
        Else
            A = (Cells(if2, 9).Value - Cells(if2 - 1, 9).Value) / (Cells(if2, 8).Value - Cells(if2 - 1, 8).Value)
            b = Cells(if2, 9).Value - A * Cells(if2, 8).Value
            Cells(10, 7).Value = A * Cells(10, 6).Value + b
        End If
    End If
    End If
'    Cells(5, 7).Value = mx1 + (0.5 - my1) * (mx2 - mx1) / (my2 - my1)
'    Cells(6, 7).Value = ux1 + (0.75 - uy1) * (ux2 - ux1) / (uy2 - uy1)
    On Error Resume Next
    ActiveSheet.ChartObjects("Diagram 1").Activate
    If Err.Number <> 0 Then
        Err.Clear
        GoTo slut
    End If
        
    ActiveChart.ChartType = xlXYScatterLines
'    For i = 1 To ActiveChart.SeriesCollection.Count
'        ActiveChart.SeriesCollection(i).Delete
'    Next
    ActiveChart.SeriesCollection(1).Name = "=""Sumkurve"""
    ActiveChart.SeriesCollection(1).XValues = Range(ActiveSheet.Cells(3, 8).Address, ActiveSheet.Cells(i, 8).Address)
    ActiveChart.SeriesCollection(1).Values = Range(ActiveSheet.Cells(3, 9).Address, ActiveSheet.Cells(i, 9).Address)
    ActiveChart.SeriesCollection(1).Border.Weight = 1
    With ActiveChart.Axes(xlCategory)
        .HasMajorGridlines = True
'        .MajorUnit = xmajuni
'        .HasMinorGridlines = True
'        .MinorUnit = xminuni
        .MinimumScale = ActiveSheet.Cells(3, 8).Value
'        .MaximumScale = xmax '+ xmajuni / 10
        
    End With
    
    With ActiveChart.Axes(xlValue)
        .HasMajorGridlines = True
        .HasMinorGridlines = True
    End With
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MinimumScale = 0
    ActiveChart.Axes(xlValue).MaximumScale = 1.2
    ActiveChart.Axes(xlValue).MaximumScale = 1
    ActiveChart.Axes(xlValue).MajorUnit = 0.2
    ActiveChart.Axes(xlValue).MajorUnit = 0.25
    ActiveChart.Axes(xlValue).MinorUnit = 0.04
    ActiveChart.Axes(xlValue).MinorUnit = 0.1
    ActiveChart.Axes(xlValue).MinorUnit = 0.05
    Selection.MinorTickMark = xlInside
    Selection.MinorTickMark = xlOutside
    Selection.MinorTickMark = xlCross
    Selection.MinorTickMark = xlInside
    ActiveChart.Axes(xlValue).CrossesAt = 0
    ActiveChart.SeriesCollection(1).Border.Color = RGB(0, 0, 0)
    ActiveChart.SeriesCollection(1).Interior.Color = RGB(0, 0, 0)
    ActiveChart.SeriesCollection(2).MarkerStyle = -4142
    ActiveChart.SeriesCollection(3).MarkerStyle = -4142
    ActiveChart.SeriesCollection(4).MarkerStyle = -4142
    ActiveChart.SeriesCollection(5).MarkerStyle = -4142
    ActiveChart.SeriesCollection(6).MarkerStyle = -4142
'    With Selection
'        .MarkerStyle = 1
'        .MarkerSize = 7
'    End With

'    ActiveChart.Legend.Select
'    Selection.Delete
    
    
' beregn kvartils|fffd|t

slut:
End Sub

Public Sub SetChartFormatting()
'
' test boksplot
'
On Error GoTo slut
'
Dim err1 As String, err2 As String
    
    ActiveChart.SeriesCollection(1).Select
    Selection.Format.Fill.Visible = msoFalse
    Selection.Format.Line.Visible = msoFalse
    ActiveChart.SeriesCollection(2).Select
    Selection.Format.Fill.Visible = msoFalse
    Selection.Format.Line.Visible = msoFalse
    
    ActiveChart.SeriesCollection(3).Select
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
    Selection.Format.Fill.Visible = msoFalse
    
    ActiveChart.SeriesCollection(4).Select
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
    Selection.Format.Fill.Visible = msoFalse
    
    
' error bars
    ActiveChart.SeriesCollection(1).HasErrorBars = False
    ActiveChart.SeriesCollection(3).HasErrorBars = False
    
    err1 = "=Grup!L4"
    err2 = "=Grup!L7"
    ActiveChart.SeriesCollection(2).HasErrorBars = True
    ActiveChart.SeriesCollection(2).ErrorBars.Select
    ActiveChart.SeriesCollection(2).ErrorBar Direction:=xlX, Include:= _
        xlMinusValues, Type:=xlCustom, Amount:="={1}", MinusValues:=err1
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With

    
    ActiveChart.SeriesCollection(4).HasErrorBars = True
    ActiveChart.SeriesCollection(4).ErrorBars.Select
    ActiveChart.SeriesCollection(4).ErrorBar Direction:=xlX, Include:= _
        xlPlusValues, Type:=xlCustom, Amount:=err2, MinusValues:="{0}"
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
slut:
End Sub

Sub OpdaterHistogram()
    Dim i As Integer, r As Integer, rk As Integer
    Dim dy As Double, dx As Double, ymajuni As Double, majuni As Double, xmajuni As Double, minuni As Double, xminuni As Double
    Dim xpow As Integer, ypow As Integer, xdiv As Integer, ydiv As Integer
    Dim areal As Double, xmin As Double, xmax As Double
    Dim s As Variant
    Dim col1 As Double, bredde As Double
    Dim yakse As Boolean
    Dim procent As Integer
    
    On Error GoTo slut
    
    i = 0
'    Range("M4:N1000").ClearContents ' problematisk da dokumentet bliver for langt, men formentlig ikke noget problem at fjerne
    Do
        Range("M4").Offset(4 * i, 0).FormulaR1C1 = "=R" & 4 + i & "C1"
        Range("m4").Offset(4 * i + 1, 0).FormulaR1C1 = "=R" & 4 + i & "C1"
        Range("m4").Offset(4 * i + 2, 0).FormulaR1C1 = "=R" & 4 + i & "C2"
        Range("m4").Offset(4 * i + 3, 0).FormulaR1C1 = "=R" & 4 + i & "C2"
        
        Range("n4").Offset(4 * i, 0).Value = 0
        Range("n4").Offset(4 * i + 1, 0).FormulaR1C1 = "=R" & 4 + i & "C3/(R" & 4 + i & "C2-R" & 4 + i & "C1)"
        Range("n4").Offset(4 * i + 2, 0).FormulaR1C1 = "=R" & 4 + i & "C3/(R" & 4 + i & "C2-R" & 4 + i & "C1)"
        Range("n4").Offset(4 * i + 3, 0).Value = 0
        
        i = i + 1
    Loop While Range("A4").Offset(i, 0).Value <> "" And Range("B4").Offset(i, 0).Value <> ""
    r = i

'    Range(Cells(4, 1), Cells(100, 5)).Select
'    DeleteGrid
'    Range(Cells(4, 1), Cells(i + 3, 5)).Select
'    MakeGrid
    On Error Resume Next
    ActiveSheet.ChartObjects("Diagram 3").Activate
    If Err.Number <> 0 Then
        Err.Clear
        GoTo slut
    End If
    
    Set s = ActiveSheet
    xmin = s.Cells(4, 1).Value
    xmax = s.Cells(r + 3, 2).Value
    If xmin >= xmax Then GoTo slut
    ActiveChart.SetSourceData Source:=Range("M4:N" & 3 + 4 * i)
'    Sheets("Histogram").Activate
    ActiveChart.Axes(xlCategory).Select
    
    
'    xmin = Range("A4").Value
'    xmax = Range("B3").Offset(i, 0).Value
    ActiveChart.Axes(xlCategory).MinimumScale = xmin
    ActiveChart.Axes(xlCategory).MaximumScale = xmax
    
    col1 = ActiveSheet.Cells(4, 1).Value
    yakse = True
    bredde = s.Cells(4, 2).Value - s.Cells(4, 1).Value
    
    For rk = 4 To r + 3
'        areal = areal + (s.Cells(rk, 2).Value - s.Cells(rk, 1).Value) * s.Cells(rk, 3).Value
        areal = areal + s.Cells(rk, 3).Value
    Next
    
    
    dx = ActiveChart.Axes(xlCategory).MaximumScale - ActiveChart.Axes(xlCategory).MinimumScale
'    dx = xmax - xmin
    dy = ActiveChart.Axes(xlValue).MaximumScale - ActiveChart.Axes(xlValue).MinimumScale
    
    
    xpow = Int(Log(dx) / Log(10))
    ypow = Int(Log(dy) / Log(10))
    xmajuni = 10 ^ (xpow)
    If dx / xmajuni < 4 Then
        xmajuni = xmajuni / 5
    ElseIf dx / xmajuni < 11 Then
        xmajuni = xmajuni / 2
    ElseIf dx / xmajuni > 50 Then
        xmajuni = xmajuni * 5
    ElseIf dx / xmajuni > 25 Then
        xmajuni = xmajuni * 2
    End If
    If dy / 10 ^ ypow < 4 Then
        ypow = ypow - 1
        ydiv = 2
    Else
        ydiv = 1
    End If
'    xminuni = xmajuni / xdiv
'    ymajuni = 10 ^ (ypow) * ydiv
    ymajuni = areal / xmajuni / 25
    procent = 4 'Round(ymajuni * xmajuni * 100 / areal, 1)
    
'    ActiveChart.SeriesCollection(1).Name = "et tern er " & procent & "%"
'    ActiveChart.SetElement (msoElementLegendNone)
    
    
    With ActiveChart.Axes(xlCategory)
        .HasMajorGridlines = True
        .MajorUnit = xmajuni
        .HasMinorGridlines = False
'        .MinorUnit = xminuni
        .MinimumScale = xmin '- xmajuni / 10
        .MaximumScale = xmax '+ xmajuni / 10
    End With
    With ActiveChart.Axes(xlValue)
        .HasMajorGridlines = True
        .HasMinorGridlines = False
        .TickLabelPosition = xlNone
        .MajorTickMark = xlNone
        .MajorUnit = ymajuni
        .MinorUnit = ymajuni / 10
    End With
'    ActiveChart.HasLegend = True
'    With ActiveChart.Legend
'        .Position = xlCorner
'        .IncludeInLayout = False
'    End With
'    ActiveChart.Legend.Select
'    Selection.Left = 5
'    Selection.Top = 5

    
    With ActiveChart.PlotArea.Border
        .ColorIndex = 16
        .Weight = xlThin
        .LineStyle = xlContinuous
    End With
    'ActiveChart.PlotArea.Fill.TwoColorGradient Style:=msoGradientHorizontal, Variant:=1
    With ActiveChart.PlotArea
        .Fill.Visible = True
        .Fill.ForeColor.SchemeColor = 2
        .Fill.BackColor.SchemeColor = 24
    End With
    With ActiveChart.Axes(xlValue).MajorGridlines.Border
        .ColorIndex = 48
        .Weight = xlHairline
        .LineStyle = xlContinuous
    End With
    With ActiveChart.Axes(xlValue).MinorGridlines.Border
        .ColorIndex = 15
        .Weight = xlHairline
        .LineStyle = xlContinuous
    End With
    With ActiveChart.Axes(xlCategory).Border
        .Weight = xlHairline
        .LineStyle = xlAutomatic
    End With
    With ActiveChart.Axes(xlCategory)
        .MajorTickMark = xlOutside
        .MinorTickMark = xlInside
        .TickLabelPosition = xlNextToAxis
    End With
    ActiveChart.SeriesCollection(1).ErrorBar Direction:=xlY, Include:= _
        xlMinusValues, Type:=xlPercent, Amount:=100
    With ActiveChart.SeriesCollection(1).Border
        .ColorIndex = 57
        .Weight = xlMedium
        .LineStyle = xlContinuous
    End With
    With ActiveChart.SeriesCollection(1)
        .MarkerBackgroundColorIndex = xlNone
        .MarkerForegroundColorIndex = xlNone
        .MarkerStyle = xlNone
        .Smooth = False
        .MarkerSize = 3
        .Shadow = False
    End With
    With ActiveChart.SeriesCollection(1).ErrorBars.Border
        .LineStyle = xlContinuous
        .ColorIndex = 57
        .Weight = xlMedium
    End With
    ActiveChart.SeriesCollection(1).ErrorBars.EndStyle = xlNoCap
slut:
End Sub

Sub MakeGrid()
'
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
        Range("F3:G9").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlMedium
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

End Sub

Sub DeleteGrid()
'
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    
End Sub

Sub EEvents()
Application.Enableevents = True
End Sub

Attribute VB_Name = "ArkHelp"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ArkHisto"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
    OpdaterHistoFit
End Sub

Private Sub Worksheet_Change(ByVal target As Range)
    OpdaterHistoFit
End Sub
Sub OpdaterHistoFit()
Dim r As Integer, c As Integer
On Error GoTo slut
    Application.ScreenUpdating = False
    Application.Enableevents = False
Application.Calculation = xlCalculationManual
r = Selection.Row
c = Selection.Column
    Call OpdaterHistogram2(ArkHisto, "Diagram 2", 4, 1, "F", "G")
slut:
    On Error Resume Next
    If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
    Application.ScreenUpdating = True
    Application.Enableevents = True
Application.Calculation = xlCalculationAutomatic

End Sub
Sub FitNormal()
    Range("E3").Formula = "=J3"
    Range("E4").Formula = "=K2"
End Sub

Attribute VB_Name = "ArkMellem"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ArkNormal"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    OpdaterNormalPlot
End Sub

Private Sub Worksheet_Change(ByVal target As Range)
    OpdaterNormalPlot
End Sub

Sub OpdaterNormalPlot()
Dim i As Integer
Dim n As Integer ' antal tal
Dim r As Integer, c As Integer

Application.ScreenUpdating = False
Application.Enableevents = False
Application.Calculation = xlCalculationManual
On Error Resume Next
r = Selection.Row
c = Selection.Column

On Error GoTo fejl
'Exit Sub
Do While Cells(n + 3, 1).Value <> ""
    n = n + 1
Loop

i = 3
Do While Cells(i, 1).Value <> ""
    Cells(i, 2).Formula = "=norminv((" & i - 2 & "-0.5)/" & n & ",0,1)"
    i = i + 1
Loop

    ActiveSheet.ChartObjects("Diagram 1").Activate
'    ActiveChart.SeriesCollection(1).XValues = "='Ark1'!$A$3:$A$" & n + 2
'    ActiveChart.SeriesCollection(1).Values = "='Ark1'!$B$3:$B$7" & n + 2
    ActiveChart.SeriesCollection(1).XValues = "='Normal-Plot'!$A$3:$A$" & n + 2
    ActiveChart.SeriesCollection(1).Values = "='Normal-Plot'!$B$3:$B$" & n + 2

    Range("D3").Formula = "=-intercept(B3:B" & i - 1 & "," & "A3:A" & i - 1 & ")*d4"
    Range("D4").Formula = "=1/slope(B3:B" & i - 1 & "," & "A3:A" & i - 1 & ")"

fejl:
    On Error Resume Next
If r > 0 And c > 0 Then ActiveSheet.Cells(r, c).Activate
Application.ScreenUpdating = True
Application.Enableevents = True
Application.Calculation = xlCalculationAutomatic

End Sub
Attribute VB_Name = "ArkSettings"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal target As Range)
Application.ScreenUpdating = False
Application.Enableevents = False

On Error GoTo slut
If target.Column = 1 Then
If target.Row = 6 And Range("A6").Value <> "" Then
    Range("A7").Value = ""
ElseIf target.Row = 7 And Range("A7").Value <> "" Then
    Range("A6").Value = ""
Else
    GoTo slut
End If
'Sheets("Data").Activate
'OpdaterAlt
'Sheets("Indstillinger").Activate
End If

slut:
Application.Enableevents = True
End Sub

Attribute VB_Name = "ArkUgrup"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim ur As Integer, uc As Integer

Private Sub Worksheet_Activate()
Application.Calculate
OpdaterAlt

End Sub

Private Sub Worksheet_Change(ByVal target As Range)
OpdaterAlt
End Sub

Public Sub OpdaterAlt()
On Error GoTo slut
Application.Calculation = xlCalculationManual
    ur = Selection.Row
    uc = Selection.Column

Application.ScreenUpdating = False
Application.Enableevents = False

Dim i As Integer
Dim j As Integer
Dim m As Integer
Dim n As Long
Dim pi As Integer
Dim p2i As Integer
Dim if1 As Integer, if2 As Integer ' til invers fraktil
Dim pn As Integer
Dim pm As Integer
Dim pu As Integer
Dim r As Range
Dim sumk As Double
Dim sum As Double
Dim yv As Single
Dim dv As Single
Set r = Selection

i = 2
pi = 2
p2i = 2
if1 = 1
if2 = 1
pn = 2
pm = 2
pu = 2
Do
    i = i + 1
    Cells(i, 3).FormulaR1C1 = "=R" & i & "C2/R2C7" ' frekvens
        If i > 3 Then ' kum frekvens
            Cells(i, 4).FormulaR1C1 = "=R" & i & "C3+R" & i - 1 & "C4"
        Else
            Cells(i, 4).FormulaR1C1 = "=R" & i & "C3"
        End If
    ' til trappediagram
    Cells(2 * (i - 2) + 1, 9).FormulaR1C1 = "=R" & i & "C1"
    Cells(2 * (i - 2) + 2, 9).FormulaR1C1 = "=R" & i + 1 & "C1"
    Cells(2 * (i - 2) + 1, 10).FormulaR1C1 = "=R" & i & "C4"
    Cells(2 * (i - 2) + 2, 10).FormulaR1C1 = "=R" & i & "C4"
    
    ' til middeltal og spredning
    sumk = sumk + Cells(i, 2).Value * Cells(i, 1).Value ^ 2
    sum = sum + Cells(i, 2).Value * Cells(i, 1).Value
    n = n + Cells(i, 2).Value
    ' antal
'    Cells(2, 7).Value = n
    
    'fraktiler
        yv = (Cells(i, 4).Value)
        If yv <= Cells(7, 6).Value Then
            pi = i
        End If
        If yv <= Cells(8, 6).Value Then
            p2i = i
        End If
    'invers fraktil
        If Cells(i, 1).Value <= Cells(7, 5).Value Then
            if1 = i
        End If
        If Cells(i, 1).Value <= Cells(8, 5).Value Then
            if2 = i
        End If
        
    'Kvartils|fffd|t grafisk afl|fffd|sning
        If yv <= 0.25 Then
            pn = i
        End If
        If yv <= 0.5 Then
            pm = i
        End If
        If yv <= 0.75 Then
            pu = i
        End If
    
Loop While Cells(i + 1, 1).Value <> ""

'middeltal
Cells(9, 6).FormulaR1C1 = "=SUMPRODUCT(R3C1:R" & i & "C1,R3C2:R" & i & "C2)/R2C7"
'spredning
'Cells(7, 5).FormulaR1C1 = "=" & sumk / n & "-(R6C5)^2"
Cells(10, 6).Value = (sumk / n - Cells(9, 6).Value ^ 2) ^ 0.5

'afslut trappediagram
    Cells(1, 9).FormulaR1C1 = "=2*R3C1-R4C1"
    Cells(1, 10).Value = 0
    Cells(2, 9).FormulaR1C1 = "=R3C1"
    Cells(2, 10).Value = 0
    Cells(2 * (i - 2) + 2, 9).FormulaR1C1 = "=R" & i & "C1+(R" & i & "C1-R" & i - 1 & "C1)/4*3"


'kvartils|fffd|t
If ArkSettings.Range("A6").Value = "x" Then ' kvartils|fffd|t midterste tal metoden
Dim arr() As Double
Dim ai As Integer
ReDim arr(n)
For j = 3 To i
    For m = 0 To Cells(j, 2).Value - 1
        arr(ai) = Cells(j, 1)
        ai = ai + 1
    Next
Next
If n = 1 Then
    Cells(3, 6).Value = arr(0)
    Cells(4, 6).Value = arr(0)
    Cells(5, 6).Value = arr(0)
ElseIf Int(n / 2) = n / 2 Then ' lige
    Cells(4, 6).Value = (arr(n / 2 - 1) + arr(n / 2)) / 2
    If Int(n / 4) = n / 4 Then ' lige dele over under median
        Cells(3, 6).Value = (arr(n / 4 - 1) + arr(n / 4)) / 2
        Cells(5, 6).Value = (arr(n * 3 / 4 - 1) + arr(n * 3 / 4)) / 2
    Else ' ulige dele over/under median
        Cells(3, 6).Value = arr((n + 1) / 4 - 1)
        Cells(5, 6).Value = arr((n + 1) * 3 / 4 - 1)
    End If
Else ' ulige
    Cells(4, 6).Value = arr((n + 1) / 2 - 1) ' median
    If Int((n - 1) / 4) = (n - 1) / 4 Then ' lige dele over under median
        Cells(3, 6).Value = (arr((n - 1) / 4 - 1) + arr((n - 1) / 4)) / 2
        Cells(5, 6).Value = (arr((n - 1) * 3 / 4) + arr((n - 1) * 3 / 4 + 1)) / 2
    Else ' ulige dele over under median
        Cells(3, 6).Value = arr((n + 1) / 4 - 1)
        Cells(5, 6).Value = arr((n + 1) * 3 / 4 - 1)
    End If
End If
Else ' grafisk afl|fffd|sning af kvartils|fffd|t
    If pn > 2 Then
        dv = 0.25 - CSng(Cells(pn, 4).Value)
    Else
        dv = 0.25
    End If
    If dv = 0 Then
        Cells(3, 6).Value = (Cells(pn, 1).Value + Cells(pn + 1, 1).Value) / 2
    Else
        Cells(3, 6).Value = Cells(pn + 1, 1).Value
    End If
    If pm > 2 Then
        dv = 0.5 - CSng(Cells(pm, 4).Value)
    Else
        dv = 0.5
    End If
    If dv = 0 Then
        Cells(4, 6).Value = (Cells(pm, 1).Value + Cells(pm + 1, 1).Value) / 2
    Else
        Cells(4, 6).Value = Cells(pm + 1, 1).Value
    End If
    If pu > 2 Then
        dv = 0.75 - CSng(Cells(pu, 4).Value)
    Else
        dv = 0.75
    End If
    If dv = 0 Then
        Cells(5, 6).Value = (Cells(pu, 1).Value + Cells(pu + 1, 1).Value) / 2
    Else
        Cells(5, 6).Value = Cells(pu + 1, 1).Value
    End If
End If

'fraktiler
If ur >= 7 And ur <= 9 And uc = 6 Then
If Cells(7, 6).Value <> "" Then
    If pi > 2 Then
        dv = CSng(Cells(7, 6).Value) - CSng(Cells(pi, 4).Value)
    Else
        dv = CSng(Cells(7, 6).Value)
    End If
        
    If dv = 0 Then
        Cells(7, 5).Value = (Cells(pi, 1).Value + Cells(pi + 1, 1).Value) / 2
    Else
        Cells(7, 5).Value = Cells(pi + 1, 1).Value
    End If
Else
    Cells(7, 5).Value = ""
End If
If Cells(8, 6).Value <> "" Then
    If p2i > 2 Then
        dv = CSng(Cells(8, 6).Value) - CSng(Cells(p2i, 4).Value)
    Else
        dv = CSng(Cells(8, 6).Value)
    End If
    If dv = 0 Then
        Cells(8, 5).Value = (Cells(p2i, 1).Value + Cells(p2i + 1, 1).Value) / 2
    Else
        Cells(8, 5).Value = Cells(p2i + 1, 1).Value
    End If
Else
    Cells(8, 5).Value = ""
End If
End If
' invers fraktiler
If ur >= 7 And ur <= 9 And uc = 5 Then
If Cells(7, 5).Value <> "" Then
    If if1 < 3 Then
        Cells(7, 6).Value = 0
    Else
        Cells(7, 6).Value = Cells(if1, 4).Value
    End If
Else
    Cells(7, 6).Value = ""
End If
If Cells(8, 5).Value <> "" Then
    If if2 < 3 Then
        Cells(8, 6).Value = 0
    Else
        Cells(8, 6).Value = Cells(if2, 4).Value
    End If
Else
    Cells(8, 6).Value = ""
End If
End If

'prikdiagram og pindediagram
OpdaterPrikPindeDiagram

' pindediagram gamle stolpediagram fjernet
'On Error Resume Next
'ActiveSheet.ChartObjects("Diagram 1").Activate
'If Err.Number <> 0 Then
'    Err.Clear
'    GoTo trappediag
'End If
'ActiveSheet.ChartObjects("Diagram 1").Activate
'ActiveChart.SeriesCollection(1).XValues = "=Data!$A$3:$A$" & i
'ActiveChart.SeriesCollection(1).Values = "=Data!$B$3:$B$" & i

' trappediagram
trappediag:
On Error Resume Next
ActiveSheet.ChartObjects("Diagram 3").Activate
If Err.Number <> 0 Then
    Err.Clear
    GoTo boksplotdiag
End If
'Worksheets(1).Range("$A$8:$A$" & endcol)
ActiveChart.SeriesCollection(1).XValues = ArkUgrup.Range("$I$1:$I$" & 2 * (i - 1)) '"=Ugrup!$I$1:$I$" & 2 * (i - 1)
ActiveChart.SeriesCollection(1).Values = ArkUgrup.Range("$J$1:$J$" & 2 * (i - 1)) ' "=Ugrup!$J$1:$J$" & 2 * (i - 1)

    With ActiveChart.Axes(xlCategory)
        .HasMajorGridlines = True
        .MinimumScale = ActiveSheet.Cells(1, 9).Value
        .MaximumScale = ActiveSheet.Cells(2 * (i - 2) + 2, 9).Value
    End With
    
    With ActiveChart.Axes(xlValue)
        .HasMajorGridlines = True
        .HasMinorGridlines = True
    End With
    
    ActiveChart.Axes(xlValue).Select
    ActiveChart.Axes(xlValue).MinimumScale = 0
'    ActiveChart.Axes(xlValue).MaximumScale = 1.2
    ActiveChart.Axes(xlValue).MaximumScale = 1
'    ActiveChart.Axes(xlValue).MajorUnit = 0.2
    ActiveChart.Axes(xlValue).MajorUnit = 0.25
'    ActiveChart.Axes(xlValue).MinorUnit = 0.04
'    ActiveChart.Axes(xlValue).MinorUnit = 0.1
    ActiveChart.Axes(xlValue).MinorUnit = 0.05
    Selection.MinorTickMark = xlInside
    Selection.MinorTickMark = xlOutside
    Selection.MinorTickMark = xlCross
    Selection.MinorTickMark = xlInside
    ActiveChart.Axes(xlValue).CrossesAt = 0
    ActiveChart.SeriesCollection(1).Border.Color = RGB(0, 0, 0)
    ActiveChart.SeriesCollection(1).Interior.Color = RGB(0, 0, 0)
    ActiveChart.SeriesCollection(1).Format.Line.Weight = 1.5
    ActiveChart.SeriesCollection(2).MarkerStyle = -4142
    ActiveChart.SeriesCollection(3).MarkerStyle = -4142
    ActiveChart.SeriesCollection(4).MarkerStyle = -4142
    ActiveChart.SeriesCollection(5).MarkerStyle = -4142
    ActiveChart.SeriesCollection(6).MarkerStyle = -4142

' boksplot
boksplotdiag:
'    ActiveSheet.ChartObjects("Diagram 2").Activate
'If Err.Number <> 0 Then
'    Err.Clear
'    GoTo slut
'End If
'    ActiveChart.PlotBy = xlRows
'    SetChartFormatting


slut:
    On Error Resume Next
    If Not r Is Nothing Then
    r.Activate
    End If
    Application.Enableevents = True
    Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic
End Sub
Sub AktiverEvents()
    Application.Enableevents = True
End Sub

Public Sub SetChartFormatting()
'
' boksplot
'

'
Dim err1, err2 As String
On Error GoTo slut
    ActiveChart.SeriesCollection(1).Select
    Selection.Format.Fill.Visible = msoFalse
    Selection.Format.Line.Visible = msoFalse
    ActiveChart.SeriesCollection(2).Select
    Selection.Format.Fill.Visible = msoFalse
    Selection.Format.Line.Visible = msoFalse
    
    ActiveChart.SeriesCollection(3).Select
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
    Selection.Format.Fill.Visible = msoFalse
    
    ActiveChart.SeriesCollection(4).Select
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
    Selection.Format.Fill.Visible = msoFalse
    
    
' error bars
    ActiveChart.SeriesCollection(1).HasErrorBars = False
    ActiveChart.SeriesCollection(3).HasErrorBars = False
    
    err1 = ArkUgrup.Range("H3") '"=Ugrup!H3"
    err2 = ArkUgrup.Range("H6") '"=Ugrup!H6"
    ActiveChart.SeriesCollection(2).HasErrorBars = True
    ActiveChart.SeriesCollection(2).ErrorBars.Select
    ActiveChart.SeriesCollection(2).ErrorBar Direction:=xlX, Include:= _
        xlMinusValues, Type:=xlCustom, Amount:="={1}", MinusValues:=err1
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With

    
    ActiveChart.SeriesCollection(4).HasErrorBars = True
    ActiveChart.SeriesCollection(4).ErrorBars.Select
    ActiveChart.SeriesCollection(4).ErrorBar Direction:=xlX, Include:= _
        xlPlusValues, Type:=xlCustom, Amount:=err2, MinusValues:="{0}"
    With Selection.Format.Line
        .Visible = msoTrue
        .ForeColor.ObjectThemeColor = msoThemeColorText1
        .ForeColor.TintAndShade = 0
        .Transparency = 0
        .Weight = 1.5
    End With
    
slut:
End Sub

Sub OpdaterPrikPindeDiagram()

Dim i As Integer
Dim n As Integer ' hyppighed
Dim j As Integer
Dim k As Integer  ' samlede antal punkter p|fffd| prikdiagram
Dim x As Double ' stok var
Dim maxv As Integer

Do While Cells(i + 3, 1).Value <> ""
    x = Cells(i + 3, 1).Value
    n = Cells(i + 3, 2).Value
    If n > maxv Then maxv = n
    Cells(3 * i + 1, 15).Value = x ' pindediagram
    Cells(3 * i + 1, 16).Value = 0 ' pindediagram
    Cells(3 * i + 2, 15).Value = x ' pindediagram
    Cells(3 * i + 2, 16).Value = n ' pindediagram
    Cells(3 * i + 3, 15).Value = x ' pindediagram
    Cells(3 * i + 3, 16).Value = 0 ' pindediagram
    For j = 1 To n
        k = k + 1
        Cells(k, 13).Value = x
        Cells(k, 14).Value = j
    Next
    i = i + 1
Loop
ActiveSheet.ChartObjects("Diagram 5").Activate
ActiveChart.SeriesCollection(1).XValues = ArkUgrup.Range("$M$1:$M$" & k)   '"=Ugrup!$M$1:$M$" & k
ActiveChart.SeriesCollection(1).Values = ArkUgrup.Range("$N$1:$N$" & k) '"=Ugrup!$N$1:$N$" & k
If maxv < 10 Then maxv = 10
ActiveChart.Axes(xlValue).MaximumScale = maxv + 2
ActiveSheet.ChartObjects("Diagram 6").Activate ' pindediagram
ActiveChart.SeriesCollection(1).XValues = ArkUgrup.Range("$O$1:$O$" & 3 * i)  '"=Ugrup!$O$1:$O$" & 3 * i
ActiveChart.SeriesCollection(1).Values = ArkUgrup.Range("$P$1:$P$" & 3 * i) '"=Ugrup!$P$1:$P$" & 3 * i

'ActiveChart.Axes(xlValue).Visible = False

End Sub

Attribute VB_Name = "Denne_projektmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Funktioner"

Sub OpdaterHistogram2(ark As Worksheet, diagramnavn As String, startrow As Integer, startcol As Integer, xcol As String, ycol As String)
    ' diagramnavn="diagram 3", startrow
    ' opdaterhistogram("Diagram 3",5,6,"L","M")
    ' opdaterhistogram("Diagram 3",4,1,"M","N")
    Dim i As Integer, r As Integer, rk As Integer
    Dim dy As Double, dx As Double, ymajuni As Double, majuni As Double, xmajuni As Double, minuni As Double, xminuni As Double
    Dim xpow As Integer, ypow As Integer, xdiv As Integer, ydiv As Integer
    Dim areal As Double, xmin As Double, xmax As Double
    Dim s As Variant
    Dim col1 As Double, bredde As Double
    Dim yakse As Boolean
    Dim procent As Integer
    
    On Error GoTo slut
    
    i = 0
'    Range("M4:N1000").ClearContents ' problematisk da dokumentet bliver for langt, men formentlig ikke noget problem at fjerne
    Do
        Range(xcol & "4").Offset(4 * i, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol
        Range(xcol & "4").Offset(4 * i + 1, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol
        Range(xcol & "4").Offset(4 * i + 2, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol + 1
        Range(xcol & "4").Offset(4 * i + 3, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol + 1
        
        Range(ycol & "4").Offset(4 * i, 0).Value = 0
        Range(ycol & "4").Offset(4 * i + 1, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol + 2 & "/(R" & startrow + i & "C" & startcol + 1 & "-R" & startrow + i & "C" & startcol & ")"
        Range(ycol & "4").Offset(4 * i + 2, 0).FormulaR1C1 = "=R" & startrow + i & "C" & startcol + 2 & "/(R" & startrow + i & "C" & startcol + 1 & "-R" & startrow + i & "C" & startcol & ")"
        Range(ycol & "4").Offset(4 * i + 3, 0).Value = 0
        
        i = i + 1
    Loop While Cells(i + startrow, startcol).Value <> "" And Cells(i + startrow, startcol + 1).Value <> ""
    r = i

'    Range(Cells(4, 1), Cells(100, 5)).Select
'    DeleteGrid
'    Range(Cells(4, 1), Cells(i + 3, 5)).Select
'    MakeGrid
'    On Error Resume Next
    ActiveSheet.ChartObjects(diagramnavn).Activate
    If Err.Number <> 0 Then
        Err.Clear
        GoTo slut
    End If
    
    Set s = ActiveSheet
    xmin = s.Cells(startrow, startcol).Value
    xmax = s.Cells(r + startrow - 1, startcol + 1).Value
    If xmin >= xmax Then GoTo slut
'    ActiveChart.SeriesCollection(1).XValues = Range("'" & arknavn & "'!" & xcol & "4:" & xcol & 3 + 4 * i)
    ActiveChart.SeriesCollection(1).XValues = ark.Range(xcol & "4:" & xcol & 3 + 4 * i)
     ActiveChart.SeriesCollection(1).Values = ark.Range(ycol & "4:" & ycol & 3 + 4 * i)
'     ActiveChart.SeriesCollection(1).Values = Range("'" & arknavn & "'!" & ycol & "4:" & ycol & 3 + 4 * i)
    ActiveChart.Axes(xlCategory).Select
    
    
'    xmin = Range("A4").Value
'    xmax = Range("B3").Offset(i, 0).Value
    ActiveChart.Axes(xlCategory).MinimumScale = xmin
    ActiveChart.Axes(xlCategory).MaximumScale = xmax
    
    col1 = ActiveSheet.Cells(startrow, startcol).Value
    yakse = True
    bredde = s.Cells(startrow, startcol + 1).Value - s.Cells(startrow, startcol).Value
    
    For rk = startrow To r + startrow - 1
'        areal = areal + (s.Cells(rk, 2).Value - s.Cells(rk, 1).Value) * s.Cells(rk, 3).Value
        areal = areal + s.Cells(rk, startcol + 2).Value
    Next
    
    
    dx = ActiveChart.Axes(xlCategory).MaximumScale - ActiveChart.Axes(xlCategory).MinimumScale
'    dx = xmax - xmin
    dy = ActiveChart.Axes(xlValue).MaximumScale - ActiveChart.Axes(xlValue).MinimumScale
    
    
    xpow = Int(Log(dx) / Log(10))
    ypow = Int(Log(dy) / Log(10))
    xmajuni = 10 ^ (xpow)
    If dx / xmajuni < 4 Then
        xmajuni = xmajuni / 5
    ElseIf dx / xmajuni < 11 Then
        xmajuni = xmajuni / 2
    ElseIf dx / xmajuni > 50 Then
        xmajuni = xmajuni * 5
    ElseIf dx / xmajuni > 25 Then
        xmajuni = xmajuni * 2
    End If
    If dy / 10 ^ ypow < 4 Then
        ypow = ypow - 1
        ydiv = 2
    Else
        ydiv = 1
    End If
'    xminuni = xmajuni / xdiv
'    ymajuni = 10 ^ (ypow) * ydiv
    ymajuni = areal / xmajuni / 25
    procent = 4 'Round(ymajuni * xmajuni * 100 / areal, 1)
    
'    ActiveChart.SeriesCollection(1).Name = "et tern er " & procent & "%"
'    ActiveChart.SetElement (msoElementLegendNone)
    
    
    With ActiveChart.Axes(xlCategory)
        .HasMajorGridlines = True
        .MajorUnit = xmajuni
        .HasMinorGridlines = False
'        .MinorUnit = xminuni
        .MinimumScale = xmin '- xmajuni / 10
        .MaximumScale = xmax '+ xmajuni / 10
    End With
    With ActiveChart.Axes(xlValue)
        .HasMajorGridlines = True
        .HasMinorGridlines = False
        .TickLabelPosition = xlNone
        .MajorTickMark = xlNone
        .MajorUnit = ymajuni
        .MinorUnit = ymajuni / 10
    End With
'    ActiveChart.HasLegend = True
'    With ActiveChart.Legend
'        .Position = xlCorner
'        .IncludeInLayout = False
'    End With
'    ActiveChart.Legend.Select
'    Selection.Left = 5
'    Selection.Top = 5

    
    With ActiveChart.PlotArea.Border
        .ColorIndex = 16
        .Weight = xlThin
        .LineStyle = xlContinuous
    End With
    'ActiveChart.PlotArea.Fill.TwoColorGradient Style:=msoGradientHorizontal, Variant:=1
    With ActiveChart.PlotArea
        .Fill.Visible = True
        .Fill.ForeColor.SchemeColor = 2
        .Fill.BackColor.SchemeColor = 24
    End With
    With ActiveChart.Axes(xlValue).MajorGridlines.Border
        .ColorIndex = 48
        .Weight = xlHairline
        .LineStyle = xlContinuous
    End With
    With ActiveChart.Axes(xlValue).MinorGridlines.Border
        .ColorIndex = 15
        .Weight = xlHairline
        .LineStyle = xlContinuous
    End With
    With ActiveChart.Axes(xlCategory).Border
        .Weight = xlHairline
        .LineStyle = xlAutomatic
    End With
    With ActiveChart.Axes(xlCategory)
        .MajorTickMark = xlOutside
        .MinorTickMark = xlInside
        .TickLabelPosition = xlNextToAxis
    End With
    ActiveChart.SeriesCollection(1).ErrorBar Direction:=xlY, Include:= _
        xlMinusValues, Type:=xlPercent, Amount:=100
    With ActiveChart.SeriesCollection(1).Border
        .ColorIndex = 57
        .Weight = xlMedium
        .LineStyle = xlContinuous
    End With
    With ActiveChart.SeriesCollection(1)
        .MarkerBackgroundColorIndex = xlNone
        .MarkerForegroundColorIndex = xlNone
        .MarkerStyle = xlNone
        .Smooth = False
        .MarkerSize = 3
        .Shadow = False
    End With
    With ActiveChart.SeriesCollection(1).ErrorBars.Border
        .LineStyle = xlContinuous
        .ColorIndex = 57
        .Weight = xlMedium
    End With
    ActiveChart.SeriesCollection(1).ErrorBars.EndStyle = xlNoCap
slut:
End Sub


Attribute VB_Name = "Lang"
Private SprogNr As Integer
Private SA(100, 5) As String
Sub Auto_Open()
    CheckLanguageSetting
    LoadSprogArray
    SetText
End Sub
Public Sub CheckLanguageSetting()
Dim LanguageSetting As Integer
    LanguageSetting = CInt(GetRegSettingLong("Language"))
    If LanguageSetting = 0 Then
        SprogNr = GetOfficeLanguage
    Else
        SprogNr = LanguageSetting
    End If
End Sub
Function GetOfficeLanguage() As Integer
'Reads the UI-language for Word
'https://support.microsoft.com/en-us/help/213833/xl2000-creating-macros-for-different-language-versions
Select Case Application.International(xlCountrySetting)
Case 45 ' Dansk
    GetOfficeLanguage = 1
Case 34 ' Spanish
    GetOfficeLanguage = 3
Case Else ' 1033 is english
    GetOfficeLanguage = 2
End Select

End Function

Public Function GetRegSettingLong(key As String) As LongPtr
    GetRegSettingLong = CLngPtr(RegKeyRead("HKCU\SOFTWARE\WORDMAT\Settings\" & key))
End Function
Function RegKeyRead(i_RegKey As String) As String
'eks syntaks
'"HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\ProgramFilesDir"
#If Mac Then
    RegKeyRead = GetSetting("com.wordmat", "defaults", i_RegKey)
#Else
Dim myWS As Object
  On Error Resume Next
  'access Windows scripting
  Set myWS = CreateObject("WScript.Shell")
  'read key from registry
  RegKeyRead = myWS.RegRead(i_RegKey)
#End If
End Function
Public Function A(i As Long) As String
On Error Resume Next
    If SA(i, SprogNr - 1) <> vbNullString Then
        A = SA(i, SprogNr - 1)
    ElseIf SA(i, 1) <> vbNullString Then
        A = SA(i, 1)
    Else
        If SA(0, 0) = vbNullString Then LoadSprogArray
        A = SA(i, 0)
    End If
End Function
Sub LoadSprogArray()
SA(0, 0) = "Data"
SA(0, 1) = "Data"
SA(0, 2) = ""

SA(1, 0) = "Ugrup"
SA(1, 1) = "Ungroup"
SA(1, 2) = ""

SA(2, 0) = "Grup"
SA(2, 1) = "Group"
SA(2, 2) = ""

SA(3, 0) = "Histogram-Fit"
SA(3, 1) = "Histogram fit"
SA(3, 2) = ""

SA(4, 0) = "Normal-plot"
SA(4, 1) = "Normal-plot"
SA(4, 2) = ""

SA(5, 0) = "Indstillinger"
SA(5, 1) = "Settings"
SA(5, 2) = ""

SA(6, 0) = "Hj|fffd|lp"
SA(6, 1) = "Help"
SA(6, 2) = ""

SA(7, 0) = "Der skete en fejl"
SA(7, 1) = "An error occured"
SA(7, 2) = ""

SA(8, 0) = "Fejl"
SA(8, 1) = "Error"
SA(8, 2) = ""

SA(9, 0) = "Kopier til |fffd|vrige ark"
SA(9, 1) = "Copy to other sheets"
SA(9, 2) = ""

SA(10, 0) = "Opt|fffd|lling / gruppering"
SA(10, 1) = "Count / grouping"
SA(10, 2) = ""

SA(11, 0) = "V|fffd|lg:"
SA(11, 1) = "Choose:"
SA(11, 2) = ""

SA(12, 0) = "Datas|fffd|t"
SA(12, 1) = "Dataset"
SA(12, 2) = ""

SA(13, 0) = "R|fffd| data"
SA(13, 1) = "Raw data"
SA(13, 2) = ""

SA(14, 0) = "Obs."
SA(14, 1) = "Obs."
SA(14, 2) = ""

SA(15, 0) = "Ugruppret opt|fffd|lling"
SA(15, 1) = "Ungrouped count"
SA(15, 2) = ""

SA(16, 0) = "Hyppighed"
SA(16, 1) = "Frequency"
SA(16, 2) = ""

SA(17, 0) = "Start"
SA(17, 1) = "Start"
SA(17, 2) = ""

SA(18, 0) = "Slut"
SA(18, 1) = "End"
SA(18, 2) = ""

SA(19, 0) = "Interval l|fffd|ngde"
SA(19, 1) = "Interval length"
SA(19, 2) = ""

SA(20, 0) = "Prikdiagram"
SA(20, 1) = "Dot diagram"
SA(20, 2) = ""

SA(21, 0) = "Histogram"
SA(21, 1) = "Histogram"
SA(21, 2) = ""

SA(22, 0) = "Observationer"
SA(22, 1) = "Observations"
SA(22, 2) = ""

SA(23, 0) = "Et tern er 4%"
SA(23, 1) = "A grid is 4%"
SA(23, 2) = ""

SA(24, 0) = "Hyppighed"
SA(24, 1) = "Frequency"
SA(24, 2) = ""

SA(25, 0) = "Form|fffd|let med dette ark er at f|fffd| talt data op og evt grupperet dem." & vbLf & "" & vbLf & "Indtast observationer i venstre kolonne. N|fffd|r du er f|fffd|rsig med at opt|fffd|lle/gruppere data trykkes p|fffd| 'koper til |fffd|vrige ark'-knappen"
SA(25, 1) = "The purpose of this sheet is to count data and group data." & vbLf & "" & vbLf & "Enter observation in the left column. When you are done entering/grouping data press the 'Copy other sheets'-button"
SA(25, 2) = ""

SA(26, 0) = "Alle intervaller er af typen" & vbLf & "]a,b]" & vbLf & "dvs. venstre gr|fffd|nse af intervallet er ikke med i intervallet, men det er h|fffd|jre. " & vbLf & "" & vbLf & "Man kan selv indtaste intervaller herunder, ogs|fffd| af forskellig l|fffd|ngde. Vha. de tre felter ovenover kan man dog nemt lave intervaller af samme l|fffd|ngde, og nemt |fffd|ndre intervallerne igen"
SA(26, 1) = "Alle intervaller er af typen" & vbLf & "]a,b]" & vbLf & "dvs. venstre gr|fffd|nse af intervallet er ikke med i intervallet, men det er h|fffd|jre. " & vbLf & "" & vbLf & "Man kan selv indtaste intervaller herunder, ogs|fffd| af forskellig l|fffd|ngde. Vha. de tre felter ovenover kan man dog nemt lave intervaller af samme l|fffd|ngde, og nemt |fffd|ndre intervallerne igen"
SA(26, 2) = ""

SA(27, 0) = "Ugrupperede Observationer"
SA(27, 1) = "Ungrouped observations"
SA(27, 2) = ""

SA(28, 0) = "Hyp."
SA(28, 1) = "Freq."
SA(28, 2) = ""

SA(29, 0) = "Frekvens"
SA(29, 1) = "Percent"
SA(29, 2) = ""

SA(30, 0) = "Kum. Frekv."
SA(30, 1) = "Cumulative"
SA(30, 2) = ""

SA(31, 0) = "Deskriptorer"
SA(31, 1) = "Descriptors"
SA(31, 2) = ""

SA(32, 0) = "Kvartils|fffd|t"
SA(32, 1) = "Quartiles"
SA(32, 2) = ""

SA(33, 0) = "Nedre"
SA(33, 1) = "lower"
SA(33, 2) = ""

SA(34, 0) = "Median"
SA(34, 1) = "Median"
SA(34, 2) = ""

SA(35, 0) = "|fffd|vre"
SA(35, 1) = "Upper"
SA(35, 2) = ""

SA(36, 0) = "Fraktil"
SA(36, 1) = "Percentile"
SA(36, 2) = ""

SA(37, 0) = "Middeltal"
SA(37, 1) = "Mean value"
SA(37, 2) = ""

SA(38, 0) = "Spredning"
SA(38, 1) = "St. deviation"
SA(38, 2) = ""

SA(39, 0) = "Pindediagram"
SA(39, 1) = "Bar chart"
SA(39, 2) = ""

SA(40, 0) = "Boksplot"
SA(40, 1) = "Box and Whisker plot"
SA(40, 2) = ""

SA(41, 0) = "Trappediagram"
SA(41, 1) = "Stair case diagram"
SA(41, 2) = ""

SA(42, 0) = "Prikdiagram"
SA(42, 1) = "Dot diagram"
SA(42, 2) = ""

SA(43, 0) = "Afl|fffd|s p|fffd| trappediagram" & vbLf & "Indtast en procentv|fffd|rdi i h|fffd|jre kolonne for at bestemme en fraktil." & vbLf & "" & vbLf & "Indtast i venstre kolonne for at bestemme hvilken fraktil der h|fffd|rer til en bestemt observation " & vbLf & "(Invers fraktil)."
SA(43, 1) = "Read from the stair case diagram" & vbLf & "Enter a percentage value in the right column to determine a fractile (percentile)" & vbLf & "" & vbLf & "Indtast i venstre kolonne for at bestemme hvilken fraktil der h|fffd|rer til en bestemt observation " & vbLf & "(Invers fraktil)."
SA(43, 2) = ""

SA(44, 0) = "Grupperede observationer"
SA(44, 1) = "Grouped observations"
SA(44, 2) = ""

SA(45, 0) = "Interval"
SA(45, 1) = "Interval"
SA(45, 2) = ""

SA(46, 0) = "Mindste"
SA(46, 1) = "Smallest"
SA(46, 2) = ""

SA(47, 0) = "St|fffd|rste"
SA(47, 1) = "Largest"
SA(47, 2) = ""

SA(48, 0) = "Observation"
SA(48, 1) = "Observation"
SA(48, 2) = ""

SA(49, 0) = "Sumkurve"
SA(49, 1) = "Cumulative percentage diagram"
SA(49, 2) = ""

SA(50, 0) = "Mindste og st|fffd|rste observation er ikke del af kvartils|fffd|ttet." & vbLf & "" & vbLf & "De er med her for at man manuelt kan justere boksplottet"
SA(50, 1) = "The smallest and largest observation  is not part of the quartiles." & vbLf & "" & vbLf & "They are here so you can manually adjust the boksplot if needed."
SA(50, 2) = ""

SA(51, 0) = "S|fffd|ttes automatisk til mindste interval men kan |fffd|ndres manuelt hvis mindste observation kendes."
SA(51, 1) = "Automatically set to the first interval, but can be changed if the smallest observation is known."
SA(51, 2) = ""

SA(52, 0) = "S|fffd|ttes automatisk til st|fffd|rste interval men kan |fffd|ndres manuelt hvis st|fffd|rste observation kendes."
SA(52, 1) = "Automatically set to the last interval, but can be changed if the largest observation is known."
SA(52, 2) = ""

SA(53, 0) = "Fra"
SA(53, 1) = "From"
SA(53, 2) = ""

SA(54, 0) = "Til"
SA(54, 1) = "To"
SA(54, 2) = ""

SA(55, 0) = "Goodness of fit"
SA(55, 1) = "Goodness of fit"
SA(55, 2) = ""

SA(56, 0) = "Obs. fordeling"
SA(56, 1) = "Obs. Distribution"
SA(56, 2) = ""

SA(57, 0) = "Forventet fordeling"
SA(57, 1) = "Expected distribution"
SA(57, 2) = ""

SA(58, 0) = "0-hypotese:"
SA(58, 1) = "0-hypothesis:"
SA(58, 2) = ""

SA(59, 0) = "Den observerede stikpr|fffd|ve stammer fra den forventede fordeling"
SA(59, 1) = "The observed distribution of the sample is from the expected distribution"
SA(59, 2) = ""

SA(60, 0) = "Signifikans niveau"
SA(60, 1) = "Significance level"
SA(60, 2) = ""

SA(61, 0) = "P-v|fffd|rdi:"
SA(61, 1) = "P-value:"
SA(61, 2) = ""

SA(62, 0) = "Konklusion:"
SA(62, 1) = "Conclusion"
SA(62, 2) = ""

SA(63, 0) = "Goodness of fit bygger p|fffd| " & ChrW(&H3C7) & ChrW(&HB2) & "-fordeling"
SA(63, 1) = "Goodness of fit is based on " & ChrW(&H3C7) & ChrW(&HB2) & "-distribution"
SA(63, 2) = ""

SA(64, 0) = "Frihedsgrader"
SA(64, 1) = "Degrees of freedom"
SA(64, 2) = ""

SA(65, 0) = "" & ChrW(&H3C7) & ChrW(&HB2) & "-v|fffd|rdi:"
SA(65, 1) = "" & ChrW(&H3C7) & ChrW(&HB2) & "-value"
SA(65, 2) = ""

SA(66, 0) = "Xmaks"
SA(66, 1) = "Xmax"
SA(66, 2) = ""

SA(67, 0) = "Symmetrisk forventet"
SA(67, 1) = "Equal expected"
SA(67, 2) = ""

SA(68, 0) = "Normalfordeling forventet"
SA(68, 1) = "Normal expected"
SA(68, 2) = ""

SA(69, 0) = "Resultatet er usikkert da der er hyppigheder under 5"
SA(69, 1) = "There are frequencies below 5. The result is unreliable."
SA(69, 2) = ""

SA(70, 0) = "Der skal v|fffd|re det samme antal observationer i observeret og forventet fordeling."
SA(70, 1) = "You must have the same number of observations in the observed an expected distributions"
SA(70, 2) = ""

SA(71, 0) = "Resultatet er usikkert da det samlede antal hyppigheder er under 50"
SA(71, 1) = "The total number of observations is below 50. The result is unreliable."
SA(71, 2) = ""

SA(72, 0) = "Nul-hypotese forkastet"
SA(72, 1) = "0-hypothesis rejected"
SA(72, 2) = ""

SA(73, 0) = "Nul-hypotese bekr|fffd|ftet"
SA(73, 1) = "0-hypothesis confirmed"
SA(73, 2) = ""

SA(74, 0) = "" & ChrW(&H3C7) & ChrW(&HB2) & "-frekvensfunktion"
SA(74, 1) = "" & ChrW(&H3C7) & ChrW(&HB2) & "-frequency function"
SA(74, 2) = ""

SA(75, 0) = "Kumuleret h|fffd|jresum"
SA(75, 1) = "Cumulative right hand sum"
SA(75, 2) = ""

SA(76, 0) = "Grafisk sammenligning"
SA(76, 1) = "Bar chart comparison"
SA(76, 2) = ""

SA(77, 0) = "Observeret"
SA(77, 1) = "Observed"
SA(77, 2) = ""

SA(78, 0) = "Forventet"
SA(78, 1) = "Expected"
SA(78, 2) = ""

SA(79, 0) = "Som standard er " & vbLf & "antallet af frihedsgrader = antal intervaller -1." & vbLf & "" & vbLf & "Men det kan |fffd|ndres her hvis det |fffd|nskes." & vbLf & "" & vbLf & "For test mod normalfordeling bruges ofte " & vbLf & "frihedsgrader = antal intervaller -3" & vbLf & "som 'straf' for estimeringen af middelv|fffd|rdi og spredning."
SA(79, 1) = "By default" & vbLf & "Degrees of freedom = number of intervals -1." & vbLf & "" & vbLf & "But you change it manually here." & vbLf & "" & vbLf & "For test againt the normaldistribution it is often used: " & vbLf & "Degrees of freedom = number of intervals -3" & vbLf & "as 'punishment' for estimation of mean value and standard deviation."
SA(79, 2) = ""

SA(80, 0) = "P|fffd| graferne herunder"
SA(80, 1) = "For the graphs below"
SA(80, 2) = ""

SA(81, 0) = "Hvis ugrupperet indtastes bare observationer i denne s|fffd|jle"
SA(81, 1) = "If ungrouped, just enter the data in this column"
SA(81, 2) = ""

SA(82, 0) = "Histogramfitning til normalfordeling"
SA(82, 1) = "Histogram fit to normal distribution"
SA(82, 2) = ""

SA(83, 0) = "Fit automatisk"
SA(83, 1) = "Fit automatically"
SA(83, 2) = ""

SA(84, 0) = "Grafisk normalfordelingstest"
SA(84, 1) = "Graphical normal distributrion test"
SA(84, 2) = ""

SA(85, 0) = "Data"
SA(85, 1) = "Data"
SA(85, 2) = ""

SA(86, 0) = "Punkterne skal ligge p|fffd| en ret linje for at kunne bekr|fffd|fte en normalfordeling."
SA(86, 1) = "Points must be on a straight line to confirm normal distribution"
SA(86, 2) = ""

SA(87, 0) = "(Sk|fffd|ring med x-aksen)"
SA(87, 1) = "(x-axis intersect)"
SA(87, 2) = ""

SA(88, 0) = "(Invers h|fffd|ldning af linjen)"
SA(88, 1) = "(Invers slope)"
SA(88, 2) = ""

SA(89, 0) = "V|fffd|rdierne skal indtastes i ordnet r|fffd|kkef|fffd|lge"
SA(89, 1) = "Values must be entered in numerical order"
SA(89, 2) = ""

SA(90, 0) = "Beregning af kvartils|fffd|t for ugrupperede observationer kan defineres p|fffd| to m|fffd|der. Du kan her v|fffd|lge mellem to forskellige metoder."
SA(90, 1) = "Calculation of quartiles for ungrouped data can be defined in two ways."
SA(90, 2) = ""

SA(91, 0) = "De to metoder giver i de fleste tilf|fffd|lde det samme, men ikke altid"
SA(91, 1) = "In most cases the two methods will return the same result, but not always."
SA(91, 2) = ""

SA(92, 0) = "T|fffd|llemetoden.  "
SA(92, 1) = "Count method"
SA(92, 2) = ""

SA(93, 0) = "Grafisk afl|fffd|sning p|fffd| Trappediagram"
SA(93, 1) = "Reading from the stair case diagram"
SA(93, 2) = ""

SA(94, 0) = "T|fffd|llemetoden" & vbLf & "tallene skrives i ordnet r|fffd|kkef|fffd|lge. Midterste tal er medianen." & vbLf & "Nedre kvartil er medianen af alle tal mindre end medianen. |fffd|vre kvartil er medianen af alle tal over medianen. Hvis der er et lige antal tal er medianen midt mellem de to tal om midten." & vbLf & "Eksempel:" & vbLf & "1" & vbLf & "2 Nedre kvartil" & vbLf & "2" & vbLf & "3 Median" & vbLf & "3" & vbLf & "4 |fffd|vre kvartil" & vbLf & "5" & vbLf & ""
SA(94, 1) = "Count method" & vbLf & "The numbers are written in numerical order. The middle number is the median." & vbLf & "Lower quartile is the median of all the numbers below the median. Upper quartile is the median of the numbers above the median. If there is an equal number of numbers the median is the number between the two numbers in the middle." & vbLf & "Example:" & vbLf & "1" & vbLf & "2 Lower quartile" & vbLf & "2" & vbLf & "3 Median" & vbLf & "3" & vbLf & "4 Upper quartile" & vbLf & "5"
SA(94, 2) = ""

SA(95, 0) = "Grafisk afl|fffd|sning" & vbLf & "Nedre kvartil afl|fffd|ses ved 25%" & vbLf & "Median ved 50%" & vbLf & "|fffd|vre kvartil ved 75%" & vbLf & "p|fffd| trappediagrammet"
SA(95, 1) = "Reading from the stair case diagram" & vbLf & "Lower quartile is read at 25%" & vbLf & "Median at 50%" & vbLf & "Upper quartile at 75%" & vbLf & "on the stair case diagram"
SA(95, 2) = ""

SA(96, 0) = "Indtast observationer p|fffd| dataarket og indstil evt. intervaller. Tryk kopier for at overf|fffd|re dataene til de andre faner." & vbLf & "Der er ingen gr|fffd|nse for hvor mange observationer der kan inds|fffd|ttes bare flyt graferne for at f|fffd| mere plads." & vbLf & "" & vbLf & "Hvis du vil gemme dette Excelark er det vigtigt at det gemmes som Excel-ark med makroer (.xlsm) ellers vil mange funktioner ikke virke." & vbLf & "" & vbLf & "Flyt selv rundt og |fffd|ndrer st|fffd|rrelsen p|fffd| diagrammerne, eller slet dem du ikke vil bruge." & vbLf & "" & vbLf & "Hvis kun frekvenser er kendt, indtastes frekvenser bare under hyppigheder." & vbLf & "Hvis der skal laves sammenligning af flere observationss|fffd|t i samme diagram m|fffd| du bruge de mere specifikke excelark."
SA(96, 1) = "Enter observation data in the data sheet and set intervals if required. Press copy to transfer the data to the other sheets for furhter analysis." & vbLf & "There is 'no' limit to the amount of data. Move the diagrams if they block the data." & vbLf & "" & vbLf & "If you want to save this Excel sheet make sure you save it in the excel format with macros (.xlsm) otherwise it will be impaired" & vbLf & "" & vbLf & "You can rearrange the diagrams and delete them if required." & vbLf & "" & vbLf & "If only percentages are known just enter percentages under frequencies." & vbLf & "If you want to compare several datasets you must use the specifik WordMat Excel sheets for that purpose."
SA(96, 2) = ""

SA(97, 0) = "Du kan indtaste flere datas|fffd|t som du kan analysere s|fffd|rskilt. Du kan altid g|fffd| tilbage til et tidligere datas|fffd|t."
SA(97, 1) = "You can enter several datasets which can be analyzed separately. You can always go back to a another dataset."
SA(97, 2) = ""

End Sub

Sub SetText()
' sheet 1 - binomialfordeling
' sheet 2 - Tabel
' sheet 3 - Graf
    On Error GoTo slut
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.Enableevents = False
    
    ArkData.Name = A(0)
    ArkUgrup.Name = A(1)
    ArkGrup.Name = A(2)
    ArkGOF.Name = "GOF"
    ArkHisto.Name = A(3)
    ArkNormal.Name = A(4)
    ArkSettings.Name = A(5)
    ArkHelp.Name = A(6)
    
    ArkData.Buttons("ButtonCopy").Caption = A(9)
    ArkData.Range("A1").Value = A(10)
    ArkData.Range("A2").Value = A(11)
    ArkData.Range("A3").Value = A(13)
    ArkData.Range("A4").Value = A(14)
    ArkData.Range("C4").Value = A(14)
    ArkData.Range("C3").Value = A(15)
    ArkData.Range("D4").Value = A(24)
    ArkData.Range("H4").Value = A(24)
    ArkData.Range("F1").Value = A(17)
    ArkData.Range("G1").Value = A(18)
    ArkData.Range("F4").Value = A(17)
    ArkData.Range("G4").Value = A(18)
    ArkData.Range("H1").Value = A(19)
    ArkData.Range("N2").Value = A(12) & " 1"
    ArkData.Range("N3").Value = A(12) & " 2"
    ArkData.Range("N4").Value = A(12) & " 3"
    ArkData.Range("N5").Value = A(12) & " 4"
    ArkData.Range("N6").Value = A(12) & " 5"
    ArkData.Range("N7").Value = A(12) & " 6"
    ArkData.Range("N8").Value = A(12) & " 7"
    ArkData.Range("N9").Value = A(12) & " 8"
    ArkData.Range("C2").Value = A(12) & " " & Right(ArkData.Range("C2").Value, 1)
    Range("C2:D2").Validation.InputMessage = A(97)
    ArkData.Range("D1").Comment.Text Text:=A(25)
    ArkData.Range("F3").Comment.Text Text:=A(26)
    
    ArkData.ChartObjects("Diagram 3").Activate
    ActiveChart.ChartTitle.Caption = A(21)
    ActiveChart.Axes(xlCategory).AxisTitle.Text = A(22)
    ActiveChart.Shapes.Range(Array("Tekstboks 1")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = A(23)
    ArkData.ChartObjects("Diagram 2").Activate
    ActiveChart.ChartTitle.Caption = A(20)
    
    ArkUgrup.Range("A1").Value = A(27)
    ArkUgrup.Range("A2").Value = A(14)
    ArkUgrup.Range("B2").Value = A(28)
    ArkUgrup.Range("C2").Value = A(29)
    ArkUgrup.Range("D2").Value = A(30)
    ArkUgrup.Range("E1").Value = A(31)
    ArkUgrup.Range("E2").Value = A(32)
    ArkUgrup.Range("E3").Value = A(33)
    ArkUgrup.Range("E4").Value = A(34)
    ArkUgrup.Range("E5").Value = A(35)
    ArkUgrup.Range("E6").Value = A(14)
    ArkUgrup.Range("F6").Value = A(36)
    ArkUgrup.Range("E9").Value = A(37)
    ArkUgrup.Range("E10").Value = A(38)
    ArkUgrup.Range("E6").Comment.Text Text:=A(43)
    ArkUgrup.ChartObjects("Diagram 6").Activate
    ActiveChart.ChartTitle.Caption = A(39)
    ArkUgrup.ChartObjects("Diagram 1").Activate
    ActiveChart.ChartTitle.Caption = A(40)
    ArkUgrup.ChartObjects("Diagram 3").Activate
    ActiveChart.ChartTitle.Caption = A(41)
    ArkUgrup.ChartObjects("Diagram 5").Activate
    ActiveChart.ChartTitle.Caption = A(42)
    
    ArkGrup.Range("A1").Value = A(44)
    ArkGrup.Range("A2").Value = A(45)
    ArkGrup.Range("A3").Value = A(53)
    ArkGrup.Range("B3").Value = A(54)
    ArkGrup.Range("C3").Value = A(28)
    ArkGrup.Range("D3").Value = A(29)
    ArkGrup.Range("E3").Value = A(30)
    ArkGrup.Range("F1").Value = A(31)
    ArkGrup.Range("F2").Value = A(32)
    ArkGrup.Range("F3").Value = A(46)
    ArkGrup.Range("F4").Value = A(33)
    ArkGrup.Range("F5").Value = A(34)
    ArkGrup.Range("F6").Value = A(35)
    ArkGrup.Range("F7").Value = A(47)
    ArkGrup.Range("F8").Value = A(48)
    ArkGrup.Range("G8").Value = A(36)
    ArkGrup.Range("F11").Value = A(37)
    ArkGrup.Range("F12").Value = A(38)
    ArkGrup.Range("F2").Comment.Text Text:=A(50)
    ArkGrup.Range("F3").Comment.Text Text:=A(51)
    ArkGrup.Range("F7").Comment.Text Text:=A(52)
    ArkGrup.Range("F8").Comment.Text Text:=A(43)
    ArkGrup.ChartObjects("Diagram 1").Activate
    ActiveChart.ChartTitle.Caption = A(49)
    ArkGrup.ChartObjects("Diagram 3").Activate
    ActiveChart.ChartTitle.Caption = A(21)
    ActiveChart.Axes(xlCategory).AxisTitle.Text = A(22)
    ActiveChart.Shapes.Range(Array("Tekstboks 1")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = A(23)
    ArkGrup.ChartObjects("Diagram 5").Activate
    ActiveChart.ChartTitle.Caption = A(40)
    
    ArkGOF.Range("A1").Value = A(55)
    ArkGOF.Range("A2").Value = A(53)
    ArkGOF.Range("B2").Value = A(54)
    ArkGOF.Range("C2").Value = A(56)
    ArkGOF.Range("D2").Value = A(57)
    ArkGOF.Range("E1").Value = A(58)
    ArkGOF.Range("G1").Value = A(59)
    ArkGOF.Range("E2").Value = A(60)
    ArkGOF.Range("E4").Value = A(61)
    ArkGOF.Range("E5").Value = A(62)
    ArkGOF.Range("E9").Value = A(63)
    ArkGOF.Range("E10").Value = A(64)
    ArkGOF.Range("E11").Value = A(65)
    ArkGOF.Range("E12").Value = A(66)
    ArkGOF.Range("B2").Comment.Text Text:=A(81)
    ArkGOF.Range("F10").Comment.Text Text:=A(79)
    ArkGOF.Range("E12").Comment.Text Text:=A(80)
    ArkGOF.Buttons("ButtonExpected").Caption = A(67)
    ArkGOF.Buttons("ButtonNormal").Caption = A(68)
    ArkGOF.ChartObjects("Diagram 3").Activate
#If Mac Then
#Else
    ActiveChart.FullSeriesCollection(1).Name = "=""" & A(77) & """"
    ActiveChart.FullSeriesCollection(2).Name = "=""" & A(78) & """"
#End If
    ActiveChart.ChartTitle.Caption = A(76)
    ArkGOF.ChartObjects("Diagram 2").Activate
    ActiveChart.ChartTitle.Caption = A(74)
    ArkGOF.ChartObjects("Diagram 1").Activate
    ActiveChart.ChartTitle.Caption = A(75)
    ArkGOF.Range("G3").Formula = "=IF(COUNTIF(C:C,""<5"")>0,""" & A(69) & """,IF(SUM(C:C)<>SUM(D:D),""" & A(70) & """, IF(SUM(C:C)<50,""" & A(71) & ""","""")))"
    ArkGOF.Range("F5").Formula = "=IF(F4="""","""",IF(F4<F2,""" & A(72) & """,""" & A(73) & """))"
    
    ArkHisto.Range("A1").Value = A(82)
    ArkHisto.Range("A2").Value = A(45)
    ArkHisto.Range("A3").Value = A(53)
    ArkHisto.Range("B3").Value = A(54)
    ArkHisto.Range("C3").Value = A(29)
    ArkHisto.Buttons("ButtonAutoFit").Caption = A(83)
    ArkHisto.ChartObjects(1).Activate
    ActiveChart.ChartTitle.Caption = A(21)
    ActiveChart.Axes(xlCategory).AxisTitle.Text = A(22)
    ActiveChart.Shapes.Range(Array("Tekstboks 1")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = A(23)
    ArkHisto.ChartObjects(1).Activate
    
    ArkNormal.Range("A1").Value = A(84)
    ArkNormal.Range("A2").Value = A(85)
    ArkNormal.Range("C2").Value = A(86)
    ArkNormal.Range("E3").Value = A(87)
    ArkNormal.Range("E4").Value = A(88)
    ArkNormal.Range("A2").Comment.Text Text:=A(89)
    
    ArkSettings.Range("A1").Value = A(5)
    ArkSettings.Range("A3").Value = A(90)
    ArkSettings.Range("A4").Value = A(91)
    ArkSettings.Range("B6").Value = A(92)
    ArkSettings.Range("B7").Value = A(93)
    ArkSettings.Range("B6").Comment.Text Text:=A(94)
    ArkSettings.Range("B7").Comment.Text Text:=A(95)
    
    ArkHelp.Range("A1").Value = A(6)
    ArkHelp.Range("A2").Value = A(96)
    
    
    ArkData.Activate
'    ArkData.Range("A1").Value = A(0)
'    ArkData.Range("A2").Comment.Text Text:=A(3)

'    ArkUgrup.ChartObjects(1).Activate
'    ActiveChart.ChartTitle.Caption = A(0)

    
slut:
    
    Application.Enableevents = True
    Application.Calculation = xlCalculationAutomatic 'xlCalculationManual
    Application.ScreenUpdating = True

End Sub



' InQuest injected base64 decoded content
' ZrH+

INQUEST-PP=macro
