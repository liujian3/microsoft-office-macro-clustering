Attribute VB_Name = "LoginForm"
Attribute VB_Base = "0{443B6968-9ACA-43FF-9B46-429789CA2AA2}{528D614F-AF43-40DE-81C6-3E1C42338737}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'------------------------------------------------------------------------------
' |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||fffd|
'
' @author kawaguchi
'------------------------------------------------------------------------------
Option Explicit

'------------------------------------------------------------------------------
' // |fffd|u|fffd|~|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    ' -----|fffd|u|fffd|~|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||242||fffd||fffd|I|fffd||fffd||fffd||30b||58e|~
    If (CloseMode = vbFormControlMenu) Then
        Cancel = True
        MsgBox "|fffd|u|fffd|~|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||34e|g|fffd|p|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
    End If
End Sub

'------------------------------------------------------------------------------
' // |fffd|u|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub LoginButton_Click()
    ' -----|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||30e|Z|fffd|o
    Dim version As String
    Dim yyyymm As String
    Dim mm As String
    Dim PASSWORD As String
    version = Mid([PRODUCTNAME].Value, InStr([PRODUCTNAME].Value, "Ver.") + 4, 1)
    yyyymm = CStr(CDec(Format(Date, "yyyymm")) ^ 2)
    mm = CStr(CDec(Format(Date, "mm")) ^ 2)
    PASSWORD = CStr(version) & Right(mm, 1) & Mid(yyyymm, 5, 4)
    ' -----|fffd||fffd||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||303|`|fffd|F|fffd|b|fffd|N
    With PasswordTextBox
        If (.Text = PASSWORD) Then
            Unload Me
        Else
            MsgBox "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            .SetFocus
            .SelStart = 0
            .SelLength = Len(.Text)
        End If
    End With
End Sub

'------------------------------------------------------------------------------
' // |fffd|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub CancelButton_Click()
    ' -----|fffd|u|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|v|fffd||fffd||82||fffd||fffd||fffd|
    Dim book As Workbook
    For Each book In Workbooks
        If (book.Name = CALCURATETOOL_BOOKNAME) Then
            Application.DisplayAlerts = False
            Workbooks(CALCURATETOOL_BOOKNAME).Close False
            Exit For
        End If
    Next
    ' -----|fffd|A|fffd|v|fffd||fffd||fffd||30f|I|fffd||fffd||fffd||fffd|Excel|fffd||fffd||82||fffd||fffd||fffd|
    Application.DisplayAlerts = False
    Application.EnableEvents = False
    If (Workbooks.Count = 1) Then
        Application.Quit
    Else
        ThisWorkbook.Close False
    End If
    Application.EnableEvents = True
End Sub
Attribute VB_Name = "MainModule"
'------------------------------------------------------------------------------
' |fffd|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
' @author kawaguchi
'------------------------------------------------------------------------------
Option Explicit
'
'|fffd||8414||fffd||933e|
'
Public IsFamilyDesign As Boolean    ' False=|fffd||742||4c482|Q|fffd||30c||90|l|fffd||fffd||fffd||fffd||fffd|ATrue=|fffd||742||4c482|Q|fffd||309||191||fffd||fffd||fffd||fffd||fffd|

Public Const PRODUCT_NAME As String = "|fffd||fffd||d1||fffd||fffd||fffd||fffd||6cc||fffd||fffd|@|fffd||fffd||fffd||3cf||fffd||fffd||c42c||fffd|V|fffd|[|fffd|g"
Public Const CALCURATETOOL_BOOKNAME As String = "|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|i|fffd||208||554||141|j.xls"
Public Const LOGIN_SHEETNAME As String = "|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd|"
Public Const PRODUCTSELECTION_SHEETNAME As String = "|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||fffd|"
Public Const MINKEN2SELECTION_SHEETNAME As String = "|fffd||742||4c482|Q|fffd|I|fffd||fffd||fffd||fffd||fffd|"
Public Const FAMILYMITUMORI_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd|"
Public Const FAMILYMITUMORI_TEMPLATE_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|i|fffd||fffd||fffd|`|fffd|j"
Public Const FAMILYHOSYO_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e"
Public Const MINKEN2INPUT_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||fffd|"
Public Const MINKEN2MITUMORI_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||fffd||fffd||3cf||fffd|"
Public Const MINKEN3INPUT_SHEETNAME As String = "|fffd||742||4c482|R|fffd||fffd||fffd||349||fffd||fffd|"
Public Const MINKEN3MITUMORI_SHEETNAME As String = "|fffd||742||4c482|R|fffd||fffd||fffd||3cf||fffd|"
Public Const PASSWORD As String = "25445"
Public Const MINKEN2FAMILYTEMPORARY_SHEETNAME As String = "|fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^"
Public Const MAX_FAMILYNUMBER As Integer = 5            '|fffd||191||fffd||fffd||fffd||6cc||fffd||fffd||fffd|Max|fffd|l|fffd||fffd|
Public Const MEMBER_HIDDEN_ROW As Integer = 5           '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||308||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||fffd|
Public Const PLAN_HIDDEN_ROW As Integer = 42            '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||308||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30d|s|fffd||fffd|
Public Const PLAN1_START_ROW As Integer = 1             '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|1|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
Public Const PLAN2_START_ROW As Integer = 44            '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|2|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
Public Const PLAN3_START_ROW As Integer = 87            '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|3|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
Public Const PLAN1_MEMBER_START_ROW As Integer = 8      '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|1|fffd|i|fffd||fffd||6cc||fffd||fffd||481|j|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
Public Const PLAN2_MEMBER_START_ROW As Integer = 51     '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|2|fffd|i|fffd||fffd||6cc||fffd||fffd||481|j|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
Public Const PLAN3_MEMBER_START_ROW As Integer = 94     '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||303|v|fffd||fffd||fffd||fffd|3|fffd|i|fffd||fffd||6cc||fffd||fffd||481|j|fffd||303|X|fffd|^|fffd|[|fffd|g|fffd|s
'
'|fffd|\|fffd||fffd||fffd||310||933e|
'
'|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
Public Type PlanInfo
    Payment As String
    '|fffd||fffd|{|fffd||23de|
    NyuinHokenKin As String
    NyuinChiryoHiyo As String
    NyuinShohiyo As String
    SagakuBed As String
    '|fffd|C|fffd||4d5||23de|
    SenshinIryo As String
    GanNyuin As String
    GanShinDan As String
    GanNyuTuinChiryo As String
    TokuteiShippei As String
    JoseiTokuteiShippei As String
    '|fffd||6cc||fffd||fffd||fffd|
    TsukiBarai As Integer
    YearBarai As Integer
    ZenkiZennoBarai As Integer
End Type

'|fffd||191||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
Public Type FamilyMemberInfo
    Name As String
    BirthDayY As String
    BirthDayM As String
    BirthDayD As String
    Sex As String               '|fffd||fffd||fffd||fffd|
    Age As Integer              '|fffd|N|fffd||fffd|
    Plan(1 To 2) As PlanInfo
    PaymentVal(2) As Integer    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@(|fffd||fffd|/|fffd|N/|fffd|S)
    Premium(2) As Integer       '|fffd||6cc||fffd||fffd||fffd|
    
End Type

'|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd|
Public Member(1 To MAX_FAMILYNUMBER) As FamilyMemberInfo
Public GlobalMemberNo As Integer


'****************************************************************************************
' |fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
'****************************************************************************************
Sub Auto_Open()
    ' -----|fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd|^|fffd||fffd|\|fffd||fffd||fffd||310||752||fffd|
    Application.ScreenUpdating = False
    ThisWorkbook.Sheets(LOGIN_SHEETNAME).Visible = xlSheetVisible
    Dim i As Integer
    Dim st As Worksheet

    For Each st In ThisWorkbook.Sheets
        If (st.Name <> LOGIN_SHEETNAME) Then
            st.Visible = xlSheetVeryHidden
        End If
    Next
    ' -----|fffd|u|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|v|fffd||30b|N|fffd||fffd|
    Dim file As String
    file = ThisWorkbook.path & "\" & CALCURATETOOL_BOOKNAME
    If (Dir(file) = "") Then
        MsgBox CALCURATETOOL_BOOKNAME & " |fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7cb|N|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Application.DisplayAlerts = False
        ThisWorkbook.Close False
        Exit Sub
    End If
    Workbooks.Open Filename:=file
    ThisWorkbook.Activate
    ' -----|fffd|u|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||281|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    With ThisWorkbook.Sheets(LOGIN_SHEETNAME)
        .Select
        .Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
        .EnableSelection = xlUnlockedCells
    End With
    Application.ScreenUpdating = True
    ' -----|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    LoginForm.Show

    ' -----|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(LOGIN_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        .ScrollArea = "A1:E13"
        .Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
        .EnableSelection = xlUnlockedCells
    End With
    Application.ScreenUpdating = True
    
End Sub

'****************************************************************************************
' |fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub MinKen2Button_Click()
    ' -----|fffd||742||4c482|Q|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN2SELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        .ScrollArea = "A1:E13"
        .Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
        .EnableSelection = xlUnlockedCells
    End With
    Application.ScreenUpdating = True
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub MinKen3Button_Click()
    ' -----|fffd||fffd||282||303|N|fffd||fffd||fffd|A
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = ""
    If (Now() >= DateSerial(2012, 12, 1)) Then
        [|fffd||fffd||fffd||fffd|3_y_1].Value = Year(Now())
        [|fffd||fffd||fffd||fffd|3_m_1].Value = Month(Now())
        [|fffd||fffd||fffd||fffd|3_d_1].Value = Day(Now())
    Else
        [|fffd||fffd||fffd||fffd|3_y_1].ClearContents
        [|fffd||fffd||fffd||fffd|3_m_1].ClearContents
        [|fffd||fffd||fffd||fffd|3_d_1].ClearContents
    End If
    [|fffd||fffd||fffd||fffd|3_y_2].ClearContents
    [|fffd||fffd||fffd||fffd|3_m_2].ClearContents
    [|fffd||fffd||fffd||fffd|3_d_2].ClearContents
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].ClearContents
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].ClearContents
    Dim pl As Integer
    For pl = 1 To 3
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = ""
        Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = ""
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = 0
    Next
    Application.EnableEvents = True
    ' -----|fffd||742||4c482|R|fffd||fffd||fffd||349||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN3INPUT_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        Application.GoTo .[A1], True
    End With
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Select
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|Q|fffd|I|fffd||fffd||fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd|@|fffd||90|l|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub MinKen2PersonalButton_Click()
    ' -----|fffd||3d0||fffd||fffd||310||752||fffd|
    IsFamilyDesign = False
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||30f||fffd||fffd||fffd||fffd||fffd|
    With ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
        .Shapes("|fffd||fffd||fffd||fffd|2_SelectionButton").Visible = True
    End With
    
    '|fffd||742||fffd|2|fffd||fffd||fffd||349||fffd||282||313||fffd||fffd||350||fffd||fffd||fffd|i|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|j|fffd||310||752||fffd|
    Call SetEnableMinken2(False)

    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||303|N|fffd||fffd||fffd|A
    Call ClearINKEN2INPUT_SHEET
    
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN2SELECTION_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        Application.GoTo .[A1], True
    End With
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Select
    Application.ScreenUpdating = True
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd|@|fffd||191||fffd||fffd||fffd||fffd||fffd||fffd||fffd||103|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub MinKen2FamilyButton_Click()
    Dim MemberCnt As Integer
    Dim PlanCnt As Integer


    Application.ScreenUpdating = False
    Application.EnableEvents = False    '|fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||312||fffd|~
    
    '-----|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||303|N|fffd||fffd||fffd|A
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T_|fffd|X|fffd|V|fffd||348||fffd|].ClearContents
    
    '-----|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||303|N|fffd||fffd||fffd|A|fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd|].Value = ""
    Call SetMin2FamilyRange([|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd|v|fffd||fffd||fffd||fffd||fffd||348||fffd|], Empty)
    For MemberCnt = 1 To 5
        Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd||6cc||fffd||fffd||fffd|" & MemberCnt), Empty)
    Next MemberCnt
    
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value = Year(Now())
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value = Month(Now())
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value = Day(Now())
    [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||2347||fffd||fffd|].Value = ""
    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|`|fffd|F|fffd|b|fffd|N
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth1 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth2 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth3 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth4 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth5 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear1 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear2 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear3 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear4 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear5 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll1 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll2 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll3 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll4 = True
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll5 = True
    
    
    '|fffd||fffd||fffd|`|fffd||303|N|fffd||fffd||fffd|A
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("B2").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("Y6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("AA6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("AC6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("Y6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("AA6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("AC6").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("C12:J38").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("P12:AD46").Value = ""
     ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Range("AG39").Value = ""
    
    
    '|fffd||23de||fffd||fffd||fffd|e|fffd||2347||fffd||fffd||fffd||303|N|fffd||fffd||fffd|A
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Range("M36").Value = ""
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Range("M79").Value = ""
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Range("M122").Value = ""
    
 
    '|fffd||a39e||fffd|I|fffd||243|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Unprotect PASSWORD

    '|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd||303|N|fffd||fffd||fffd|A
    For PlanCnt = 1 To 3
        For MemberCnt = 1 To MAX_FAMILYNUMBER
            Range("|fffd||fffd||fffd||fffd|2|fffd||195||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt).Value = ""
        Next MemberCnt
        Range("|fffd||fffd||fffd||fffd|2|fffd||195||fffd|_|fffd||6d7||fffd||fffd|v" & PlanCnt).Value = ""
    Next PlanCnt
    
    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||110||752||fffd|
    Call ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Protect(PASSWORD, DrawingObjects:=True)

    
    ' -----|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||315|\|fffd||fffd|
    With ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN2SELECTION_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd|].Select
    End With
    Application.ScreenUpdating = True
    Application.EnableEvents = True    '|fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||312||fffd|~|fffd||309||fffd||fffd||fffd|
    
   '|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||292|u|fffd||312||fffd||fffd||fffd|
    ActiveCell.Activate
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||310||752||fffd|
    ActiveWindow.ScrollColumn = 1
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|s|fffd||310||752||fffd|
    ActiveWindow.ScrollRow = 1

End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd|@|fffd||7c2||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub MinKen2BackButton_Click()
    ' -----|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN2SELECTION_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
    End With
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|P|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub FreeDesignButton1_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||591|J|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(1)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|Q|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub FreeDesignButton2_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||591|J|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(2)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|R|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub FreeDesignButton3_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||591|J|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(3)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|S|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub FreeDesignButton4_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||591|J|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(4)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|T|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub FreeDesignButton5_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||591|J|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(5)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||242|Q|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub DesignCopyButton2_Click()
    
    ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    Call CopyTemporaryPlan(2)

End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||242|R|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub DesignCopyButton3_Click()
    
    ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    Call CopyTemporaryPlan(3)

End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||242|S|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub DesignCopyButton4_Click()
    ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    Call CopyTemporaryPlan(4)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||242|T|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub DesignCopyButton5_Click()
    ' |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
    Call CopyTemporaryPlan(5)
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||191||fffd|_HosyoButton_Click()
    '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
    If Not CheckPremium(0) Then
        MsgBox "|fffd||74c|v|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If


    ' -----|fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e|fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    
    '|fffd||6cc||fffd||fffd||fffd||fffd||502||30d|X|fffd|V
    Call SetHoshoHokenKikan

    
    With ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        '|fffd||6cc||fffd||fffd||fffd||fffd||30d|X|fffd|V(|fffd|\|fffd||fffd||fffd|E|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|)
        Call SetHoshoPremium
        .Select
    End With
    Application.ScreenUpdating = True
    
    '|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||292|u|fffd||312||fffd||fffd||fffd|
    ActiveCell.Activate
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||310||752||fffd|
    ActiveWindow.ScrollColumn = 1
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|s|fffd||310||752||fffd|
    ActiveWindow.ScrollRow = 1
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||191||fffd|_SelectionButton_Click()
    ' -----|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
    End With
    Application.ScreenUpdating = True
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||3cf||fffd||fffd||195||23de||fffd||fffd||fffd|e|fffd||fffd||fffd|c|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'  |fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||341|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||342||202||fffd||202||fffd||fffd|B
'    |fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347|Copy|fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd|B
'    |fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||102||fffd||fffd|AVBA|fffd||303|\|fffd|[|fffd|X|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||302||fffd||fffd|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd|I|fffd||256||fffd||fffd||182||202||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Sub |fffd||191||fffd|_MakeButton_Click()
    
    '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
    If Not CheckPremium(0) Then
        MsgBox "|fffd||74c|v|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If

    Application.ScreenUpdating = False
    Dim newBook As Workbook
    Dim bookName As String
    
    bookName = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd|").Value & "|fffd|l"


    '|fffd||6cc||fffd||fffd||fffd||fffd||502||30d|X|fffd|V
    Call SetHoshoHokenKikan

    With ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME)
    '|fffd||6cc||fffd||fffd||fffd||fffd||30d|X|fffd|V|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||7c2||248||fffd|U|fffd|r|fffd|W|fffd|u|fffd||fffd||fffd||242||fffd||fffd||fffd|
        .Visible = xlSheetVisible
        .Activate
        'ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        '|fffd||6cc||fffd||fffd||fffd||fffd||30d|X|fffd|V(|fffd|\|fffd||fffd||fffd|E|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|)
        Call SetHoshoPremium
        .Visible = xlSheetVeryHidden
   '     .Select
        ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Activate
    End With

    
    '|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|i|fffd||fffd||fffd|`|fffd|j|fffd||252|l|fffd||14a|i|fffd|[
    With ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME)
        .Range("B2").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd|].Value
        .Range("Y6").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value
        .Range("AA6").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value
        .Range("AC6").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value
        .Range("C12:J38").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd||fffd||354||348||fffd|].Value
        .Range("P12:AD40").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd|v|fffd||fffd||fffd||fffd||fffd||348||fffd|].Value
        .Range("P42:AD46").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||6cc||fffd||fffd||fffd||fffd||348||fffd|].Value
        .Range("P42:AD46").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||6cc||fffd||fffd||fffd||fffd||348||fffd|].Value
        .Range("AB3").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||c42c||fffd||fffd|].Value
        .Range("O50").Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||2347||fffd||fffd|].Value
    End With
    
    
    '|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|i|fffd||fffd||fffd|`|fffd|j|fffd||fffd||283|u|fffd|b|fffd|N|fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|B
    '|fffd||a39e||fffd|I|fffd||255|\|fffd||fffd||fffd||fffd||502||242||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Visible = xlSheetVisible

    ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Copy
    
   
    
    '|fffd||fffd|\|fffd||fffd||fffd||fffd||502||256||7c2||fffd|
    ThisWorkbook.Sheets(FAMILYMITUMORI_TEMPLATE_SHEETNAME).Visible = xlSheetVeryHidden
    
    Set newBook = Workbooks(ActiveSheet.Parent.Name)
    
    
    With newBook.ActiveSheet
        .Unprotect PASSWORD
        .Name = FAMILYMITUMORI_SHEETNAME
        .[B2].Select
    End With
    
    

    '|fffd||a39e||fffd|I|fffd||255|\|fffd||fffd||fffd||fffd||502||242||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Visible = xlSheetVisible
       
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Copy After:=newBook.Worksheets(FAMILYMITUMORI_SHEETNAME)
    
    With newBook.ActiveSheet
        .Unprotect PASSWORD
        '|fffd|{|fffd|^|fffd||fffd||fffd||30d||d3dc|
        .Shapes("|fffd||191||fffd|_MitumoriButton").Delete
        .Shapes("|fffd||191||fffd|_MitumoriButton").Delete
        .Shapes("|fffd||191||fffd|_MitumoriButton").Delete
        
        Call DeleteHoshoHidden(newBook)
        
        '|fffd|Z|fffd||fffd||fffd|S|fffd||302||fffd|l|fffd||143|R|fffd|s|fffd|[
        .Cells.Copy
        .Cells.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False

        .[B9].Select
    End With
    
    '|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||292|u|fffd||312||fffd||fffd||fffd|
    ActiveCell.Activate
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||310||752||fffd|
    ActiveWindow.ScrollColumn = 1
    ' |fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|s|fffd||310||752||fffd|
    ActiveWindow.ScrollRow = 1
    newBook.Worksheets(FAMILYHOSYO_SHEETNAME).Select
    ActiveWindow.DisplayHeadings = True
    
    newBook.Worksheets(FAMILYMITUMORI_SHEETNAME).Select
        
    ActiveWindow.DisplayHeadings = True
    
    
    '|fffd||fffd|\|fffd||fffd||fffd||fffd||502||256||7c2||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Visible = xlSheetVeryHidden
    ThisWorkbook.Activate
    
    Application.ScreenUpdating = True

   '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|B
    Call DisplaySaveDialog(newBook, bookName)
    

'    MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
'           "|fffd|u|fffd|b|fffd|N|fffd||fffd||602||fffd||582||fffd||fffd||101|A|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbInformation, PRODUCT_NAME
End Sub




'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub EditPremium(ByVal check As Boolean, ByVal MemberCnt As Integer, ByVal Key As String)
    
    Dim PlanCnt As Integer
    
    If check = True Then
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|XON|fffd||30f||a347||fffd||fffd||fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd||73d1||fffd||fffd||fffd||7c2||fffd|
        For PlanCnt = 1 To 3
            Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key), _
                 IIf(IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key).Value) Or _
                    Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key).Value <> 0, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key).Value, "-"))
            If Key <> "A" Then
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & Key), _
                    IIf(IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & Key).Value) Or _
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key).Value <> 0, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & Key).Value, "-"))
            End If
        Next PlanCnt
    
    Else
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|XOFF|fffd||30f||a347||fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
        For PlanCnt = 1 To 3
            Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Key), "")
            If Key <> "A" Then
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & Key), "")
            End If
        Next
    
    End If
    

End Sub




'****************************************************************************************
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e|fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||191||fffd|_MitumoriButton_Click()
    ' -----|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
    End With
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_Copy1To2Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g2].Value = [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[2].Value = [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[1].Value
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_Copy2To3Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g3].Value = [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[3].Value = [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[2].Value
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_Clear2Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = ""
    [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g2].Value = ""
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[2].Value = 0
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_Clear3Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = ""
    [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g3].Value = ""
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd|i3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[3].Value = 0
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_MitumoriButton_Click()
     
    If ([|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = "") Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If ([|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = "") Then
        MsgBox "|fffd||fffd||fffd||282||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|")) Then
        MsgBox "|fffd|N|fffd||e0aa||fffd|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
               "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||190||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|1")) Or IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2")) Or IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3")) Then
        MsgBox "|fffd||fffd||fffd||353||fffd||fffd|e|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
     
     
    If (IsFamilyDesign) Then
        ' |fffd||191||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347|
        
        ' -----|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|\|fffd||fffd||fffd||302||310||752||fffd|
        Call EditMemberInf(GlobalMemberNo, False)
    
        
        Application.ScreenUpdating = False
        
        ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/02/07
        ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Unprotect PASSWORD
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(GlobalMemberNo) & "_y").Value = Range("|fffd||fffd||fffd||fffd|2_y_2").Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(GlobalMemberNo) & "_m").Value = Range("|fffd||fffd||fffd||fffd|2_m_2").Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(GlobalMemberNo) & "_d").Value = Range("|fffd||fffd||fffd||fffd|2_d_2").Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(GlobalMemberNo) & "_|fffd||fffd||fffd||fffd|").Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|").Value
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(GlobalMemberNo) & "_|fffd|N|fffd||fffd|").Value = Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|").Value
        ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Protect PASSWORD, DrawingObjects:=True
        ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/02/07
        
        ' -----|fffd||fffd||fffd||349||fffd||282||fffd||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||582||30d|X|fffd|V
        Call SetTemporaryFromInput(GlobalMemberNo)
        
        ' -----|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||315|\|fffd||fffd|
        With ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME)
            .Visible = xlSheetVisible
            ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME).Visible = xlSheetVeryHidden
            .Select
        End With
        
        Application.ScreenUpdating = True
    Else
        ' |fffd||90|l|fffd||fffd||fffd||fffd||fffd||30f||a347|
  
        ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||3cf||fffd||fffd||315|\|fffd||fffd|
        Application.ScreenUpdating = False
        With ThisWorkbook.Sheets(MINKEN2MITUMORI_SHEETNAME)
            .Visible = xlSheetVisible
            ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME).Visible = xlSheetVeryHidden
            If (IsError([|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2]) Or IsError([|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3])) Then
                .Rows("10:42").Hidden = False
                .Rows("43:75").Hidden = True
            Else
                If ([|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2].Value + [|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3].Value) > 0 Then
                    .Rows("10:42").Hidden = False
                    .Rows("43:75").Hidden = True
                Else
                    .Rows("10:42").Hidden = True
                    .Rows("43:75").Hidden = False
                End If
            End If
            .Select
            Application.GoTo .[A1], True
            .[A4].Select
        End With
        Application.ScreenUpdating = True
    End If
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_SelectionButton_Click()
    ' -----|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME).Visible = xlSheetVeryHidden
        ThisWorkbook.Sheets(MINKEN2MITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
    End With
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|Q|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_MakeButton_Click()
    Application.ScreenUpdating = False
    Dim newBook As Workbook
    ThisWorkbook.Sheets(MINKEN2MITUMORI_SHEETNAME).Copy
    Set newBook = Workbooks(ActiveSheet.Parent.Name)
    
    Dim bookName As String
    '|fffd||fffd||fffd||30e||64fe||fffd||197|l|fffd||fffd|\|fffd||fffd|
    bookName = getSei(Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|").Value) & "|fffd|l"
    
    '|fffd|V|fffd|u|fffd|b|fffd|N|fffd||303||fffd||fffd|l|fffd|[|fffd||fffd|
    'ActiveWorkbook.SaveAs Filename:=bookName & ".xls"

    With newBook.ActiveSheet
        .Unprotect PASSWORD
        .Cells.Copy
        .Cells.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
        .[H6].Value = ThisWorkbook.Sheets(MINKEN2MITUMORI_SHEETNAME).[H6].Value
        .Shapes("|fffd||fffd||fffd||fffd|2_MakeButton").Delete
        .Shapes("|fffd||fffd||fffd||fffd|2_InputButton").Delete
        If (.Rows("10:10").Hidden) Then
            .Rows("10:42").Delete Shift:=xlUp
        Else
            .Rows("43:75").Delete Shift:=xlUp
        End If
        .[A4].Select
    End With
    ActiveWindow.DisplayHeadings = True
    ThisWorkbook.Activate
    Application.ScreenUpdating = True
    
    Call DisplaySaveDialog(newBook, bookName)
'    MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
'           "|fffd|u|fffd|b|fffd|N|fffd||fffd||602||fffd||582||fffd||fffd||101|A|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbInformation, PRODUCT_NAME
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd||fffd||fffd||349||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|2_InputButton_Click()
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||3cf||fffd||fffd||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN2MITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        Application.GoTo .[A1], True
    End With
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Select
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|R|fffd||fffd||fffd||349||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_Copy1To2Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g2].Value = [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|2].Value = [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|1].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[2].Value = [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[1].Value
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_Copy2To3Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g3].Value = [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|3].Value = [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|2].Value
    [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[3].Value = [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[2].Value
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_Clear2Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = ""
    [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g2].Value = ""
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|2].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[2].Value = 0
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd|v|fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd|[|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_Clear3Button_Click()
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = ""
    [|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g3].Value = ""
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd|i3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|3].Value = 0
    [|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[3].Value = 0
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_MitumoriButton_Click()
    If ([|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = "") Then
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If ([|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = "") Then
        MsgBox "|fffd||fffd||fffd||282||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|")) Then
        MsgBox "|fffd|N|fffd||e0aa||fffd|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
               "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||190||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    If IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|1")) Or IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2")) Or IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|3")) Then
        MsgBox "|fffd||fffd||fffd||353||fffd||fffd|e|fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Exit Sub
    End If
    ' -----|fffd||742||4c482|R|fffd||fffd||fffd||3cf||fffd||fffd||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN3MITUMORI_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN3INPUT_SHEETNAME).Visible = xlSheetVeryHidden
        If (IsError([|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2]) Or IsError([|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|3])) Then
            .Rows("10:30").Hidden = False
            .Rows("31:51").Hidden = True
        Else
            If ([|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|2].Value + [|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|3].Value) > 0 Then
                .Rows("10:30").Hidden = False
                .Rows("31:51").Hidden = True
            Else
                .Rows("10:30").Hidden = True
                .Rows("31:51").Hidden = False
            End If
        End If
        .Select
        Application.GoTo .[A1], True
        .[A4].Select
    End With
    Application.ScreenUpdating = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_SelectionButton_Click()
    ' -----|fffd||fffd||fffd|i|fffd|I|fffd||fffd||fffd||fffd||282||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(PRODUCTSELECTION_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN3INPUT_SHEETNAME).Visible = xlSheetVeryHidden
        ThisWorkbook.Sheets(MINKEN3MITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
    End With
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd||742||4c482|R|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|Q|fffd||301|u|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_MakeButton_Click()
    Application.ScreenUpdating = False
    Dim newBook As Workbook
    ThisWorkbook.Sheets(MINKEN3MITUMORI_SHEETNAME).Copy
    Set newBook = Workbooks(ActiveSheet.Parent.Name)
    With newBook.ActiveSheet
        .Unprotect PASSWORD
        .Cells.Copy
        .Cells.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Application.CutCopyMode = False
        .[H6].Value = ThisWorkbook.Sheets(MINKEN3MITUMORI_SHEETNAME).[H6].Value
        .Shapes("|fffd||fffd||fffd||fffd|3_MakeButton").Delete
        .Shapes("|fffd||fffd||fffd||fffd|3_InputButton").Delete
        If (.Rows("10:10").Hidden) Then
            .Rows("10:30").Delete Shift:=xlUp
        Else
            .Rows("31:51").Delete Shift:=xlUp
        End If
        .[A4].Select
    End With
    ActiveWindow.DisplayHeadings = True
    ThisWorkbook.Activate
    Application.ScreenUpdating = True
    MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
           "|fffd|u|fffd|b|fffd|N|fffd||fffd||602||fffd||582||fffd||fffd||101|A|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbInformation, PRODUCT_NAME
End Sub

'------------------------------------------------------------------------------
' |fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd||301|u|fffd||fffd||fffd||349||fffd||282||581|v|fffd|{|fffd|^|fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub |fffd||fffd||fffd||fffd|3_InputButton_Click()
    ' -----|fffd||742||4c482|R|fffd||fffd||fffd||3cf||fffd||fffd||315|\|fffd||fffd|
    Application.ScreenUpdating = False
    With ThisWorkbook.Sheets(MINKEN3INPUT_SHEETNAME)
        .Visible = xlSheetVisible
        ThisWorkbook.Sheets(MINKEN3MITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
        .Select
        Application.GoTo .[A1], True
    End With
    [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Select
    Application.ScreenUpdating = True
End Sub

'****************************************************************************************
' |fffd|T|fffd|u|fffd||fffd||fffd|[|fffd|`|fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub ClearINKEN2INPUT_SHEET()
    ' -----|fffd||fffd||282||303|N|fffd||fffd||fffd|A
    Application.EnableEvents = False
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = ""
    If (Now() >= DateSerial(2012, 12, 1)) Then
        [|fffd||fffd||fffd||fffd|2_y_1].Value = Year(Now())
        [|fffd||fffd||fffd||fffd|2_m_1].Value = Month(Now())
        [|fffd||fffd||fffd||fffd|2_d_1].Value = Day(Now())
    Else
        [|fffd||fffd||fffd||fffd|2_y_1].ClearContents
        [|fffd||fffd||fffd||fffd|2_m_1].ClearContents
        [|fffd||fffd||fffd||fffd|2_d_1].ClearContents
    End If
    [|fffd||fffd||fffd||fffd|2_y_2].ClearContents
    [|fffd||fffd||fffd||fffd|2_m_2].ClearContents
    [|fffd||fffd||fffd||fffd|2_d_2].ClearContents
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].ClearContents
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].ClearContents
    Dim pl As Integer
    For pl = 1 To 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|"
        Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = ""
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = 0
    Next
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd|
    [|fffd||fffd||fffd||fffd|2_|fffd||191||fffd||fffd|t|fffd||fffd||fffd|O].Value = 0
    
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd||fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||582||311|J|fffd||68f||fffd||fffd||fffd|
' sameFlg:|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347|True
' |fffd||7c2||fffd|l
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub MoveToMINKEN2INPUT_SHEET(ByVal MemberNo As Integer, Optional ByVal sameFlg As Boolean = False)

    '|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    If CheckFamilyInput(MemberNo) = False Then
        Exit Sub
    End If

   
    ' -----|fffd||3d0||fffd||fffd||310||752||fffd|
    IsFamilyDesign = True
    ' -----|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|\|fffd||fffd||fffd||302||310||752||fffd|
    Call EditMemberInf(MemberNo, True)
    GlobalMemberNo = MemberNo
    
    
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||30f||fffd||fffd||fffd||fffd||fffd|
    With ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
        .Shapes("|fffd||fffd||fffd||fffd|2_SelectionButton").Visible = False
    End With
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c8||a39e||fffd|I|fffd||255||48f|W|fffd||82||242||fffd||fffd||fffd|
   ' Call SetEnableMinken2(False)
    
    
    Dim PlanCnt As Integer
    

    
    ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||303|N|fffd||fffd||fffd|A
    Call ClearINKEN2INPUT_SHEET
    Dim InputUpdateFlg As Boolean
    InputUpdateFlg = False
    
     '|fffd||fffd||290||752||fffd||302||fffd||fffd||7c3|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|~
    Application.EnableEvents = False
    
    
     ' |fffd||fffd||fffd||fffd||fffd|l|fffd||310||752||fffd|
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & "_|fffd||fffd|").Value & Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd|").Value
    [|fffd||fffd||fffd||fffd|2_y_1].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y").Value
    [|fffd||fffd||fffd||fffd|2_m_1].Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value
    [|fffd||fffd||fffd||fffd|2_d_1].Value = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value
    [|fffd||fffd||fffd||fffd|2_y_2].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_y").Value
    [|fffd||fffd||fffd||fffd|2_m_2].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_m").Value
    '|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|~|fffd||309||fffd||fffd||fffd|(|fffd|N|fffd||fffd|v|fffd|Z|fffd||302||fffd||fffd||7ce|b|fffd||fffd||fffd||fffd||fffd|)
    Application.EnableEvents = True
    [|fffd||fffd||fffd||fffd|2_d_2].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_d").Value
     '|fffd||fffd||290||752||fffd||302||fffd||fffd||7c3|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|~
    Application.EnableEvents = False
    
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd||fffd||fffd|").Value
    [|fffd||fffd||fffd||fffd|2_|fffd||191||fffd||fffd|t|fffd||fffd||fffd|O].Value = 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd|

    
    '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
    If CheckPremium(MemberNo) Then
        '|fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||202||fffd||fffd||fffd|
     
        For PlanCnt = 1 To 3
            If Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M")) Then
                '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||754||fffd||fffd|f|fffd||fffd||fffd||fffd|
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd|Z|fffd|b|fffd|g" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|@" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|x" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd|i" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanCnt).Value
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
                InputUpdateFlg = True
            End If
        Next PlanCnt
        
        If InputUpdateFlg Then
            '|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|~|fffd||309||fffd||fffd||fffd|
            'Application.EnableEvents = True
            '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||90bd||fffd||7c2||24b|[|fffd||fffd||fffd|I|fffd||243|`|fffd|F|fffd||fffd||fffd|W|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||102||44f|o|fffd||fffd|
            Call ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME).Worksheet_Change2([|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||354||348||fffd|])
            '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@START
            If sameFlg = True And (IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|1")) Or IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|2")) Or IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|3"))) Then
                ' |fffd||fffd||193||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||102||fffd||fffd|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||349||fffd||282||591|J|fffd||682||fffd||fffd||fffd|
                sameFlg = False
                
            End If
            '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@END
            
        End If
    End If

    '|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|~|fffd||309||fffd||fffd||fffd|
    Application.EnableEvents = True
    
    '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@START
    If sameFlg = False Then
    '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@END
        '|fffd|@|fffd|t|fffd||fffd||fffd|[|fffd||74c|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||341|A|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        Call SetEnableMinken2(True)
        
        ' -----|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||315|\|fffd||fffd|
        Application.ScreenUpdating = False
        With ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
            .Visible = xlSheetVisible
            ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Visible = xlSheetVeryHidden
            .Select
            Application.GoTo .[A1], True
        End With
        [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Select
        Application.ScreenUpdating = True
        

    '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@START
    End If
    '2014/5/19 |fffd||fffd||193||fffd||fffd||fffd||fffd||243|{|fffd|^|fffd||fffd||fffd|s|fffd||f347||fffd|C|fffd||fffd||fffd||389||fffd||fffd|@kasagawa|fffd|@END
End Sub
'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||313||fffd||fffd||350||fffd||fffd||fffd|i|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|j
' |fffd||fffd||fffd|J|fffd||68c||fffd||fffd||242||fffd||fffd|A|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd|FTrue:(|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd||fffd||311|J|fffd||681|j, False:(|fffd||742||4c482|Q|fffd|I|fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||311|J|fffd||681|j
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub SetEnableMinken2(isFamily As Boolean)
    
    Dim WSheet As Worksheet
    Set WSheet = ThisWorkbook.Sheets(MINKEN2INPUT_SHEETNAME)
    
    
    '|fffd||fffd|x|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||342||fffd||fffd||fffd|
    WSheet.Unprotect PASSWORD
    
    '|fffd|S|fffd|Z|fffd||fffd||fffd||fffd||fffd|b|fffd|N
  '  WSheet.Cells.Locked = True
    'MsgBox "|fffd||fffd||fffd||fffd|2_d_1 = " & [|fffd||fffd||fffd||fffd|2_d_1].Interior.ColorIndex
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Interior.Pattern = xlPatternNone
    [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Interior.ColorIndex = -4142
    If isFamily = False Then
        '|fffd||742||4c482|Q|fffd|I|fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||311|J|fffd||682||30f||a347||fffd||341|A|fffd||242||fffd||fffd||fffd||fffd||101|A|fffd||fffd||6cc||fffd||fffd||48f||fffd||fffd||fffd||fffd||fffd||349||82||242||fffd||fffd||fffd|
        [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_y_1].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_m_1].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_d_1].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_y_2].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_m_2].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_d_2].MergeArea.Locked = False
        [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Locked = False
        [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Interior.Pattern = xlPatternNone
        [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Interior.ColorIndex = 37
    End If
    '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||349||82||fffd|
    [|fffd||fffd||fffd||fffd|2_|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|].Locked = False
    [|fffd||fffd||fffd||fffd|2_|fffd||191||fffd||fffd|t|fffd||fffd||fffd|O].Locked = False
    
    
    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||110||752||fffd|
    ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/01/21
    'WSheet.Protect PASSWORD, UserInterfaceOnly:=True
    WSheet.Protect PASSWORD, DrawingObjects:=False, Contents:=True, Scenarios:=True
    ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/01/21
    'ActiveSheet.EnableSelection = xlUnlockedCells
    

End Sub

'****************************************************************************************
' |fffd|T|fffd|u|fffd||fffd||fffd|[|fffd|`|fffd||fffd|
'****************************************************************************************
'------------------------------------------------------------------------------
' Prm|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd|FminkenType|fffd|F0=|fffd||742||fffd|2|fffd|A1=|fffd||742||fffd|3
' |fffd||7c2||fffd|l|fffd|F|fffd||202||fffd|
'------------------------------------------------------------------------------
Sub Prm(ByVal minkenType As Integer)
    ' -----|fffd||693||fffd||fffd||fffd||fffd||30e||64fe|
    Application.EnableEvents = False
    Dim minken As String
    If (minkenType = 0) Then
        minken = "|fffd||fffd||fffd||fffd|2_"
    Else
        minken = "|fffd||fffd||fffd||fffd|3_"
    End If
    ' -----|fffd|u|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|v|fffd||317|L|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    Dim isFind As Boolean
    Dim book As Workbook
    isFind = False
    For Each book In Workbooks
        If (book.Name = CALCURATETOOL_BOOKNAME) Then
                isFind = True
            Exit For
        End If
    Next
    Dim pl As Integer
    If (isFind = False) Then
        For pl = 1 To 3
            Range(minken & "|fffd||6cc||fffd||fffd||fffd|" & pl).Value = "#N/A"
            Range(minken & "|fffd|N|fffd||fffd|" & pl).Value = "#N/A"
            Range(minken & "|fffd|O|fffd|[" & pl).Value = "#N/A"
        Next
        MsgBox CALCURATETOOL_BOOKNAME & " |fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||7cc|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        Application.EnableEvents = True
        Exit Sub
    End If
    ' -----|fffd||6cc||fffd||fffd||fffd||fffd||30e|Z|fffd|o
    With Workbooks(CALCURATETOOL_BOOKNAME).Sheets("main")
        ' -----E4|fffd|F|fffd||fffd||fffd||fffd||258|a|fffd|^|fffd||fffd||fffd||fffd|(0=|fffd||742||fffd|2|fffd|A1=|fffd||742||fffd|3)
        If (minkenType = 0) Then
            .[|fffd||fffd||fffd||fffd|].Value = 0
        Else
            .[|fffd||fffd||fffd||fffd|].Value = 1
        End If
        ' -----E5|fffd|F|fffd||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|(0=|fffd|p|fffd||fffd||fffd|A1=|fffd||fffd||fffd|N|fffd|x)
        .[|fffd||fffd|].Value = 1
        ' -----E6|fffd|F|fffd||fffd||fffd||fffd|(1=|fffd|j|fffd||fffd||fffd|A2=|fffd||fffd||fffd||fffd|)
        If (Range(minken & "|fffd||fffd||fffd||fffd|").Value = "|fffd|j|fffd||fffd|") Then
            .[Sex].Value = 1
        ElseIf (Range(minken & "|fffd||fffd||fffd||fffd|").Value = "|fffd||fffd||fffd||fffd|") Then
            .[Sex].Value = 2
        Else
            .[Sex].ClearContents
        End If
        ' -----E7|fffd|F|fffd|N|fffd||fffd|(0|fffd|`89=|fffd||742||fffd|2|fffd|A30|fffd|`89=|fffd||742||fffd|3)
        .[x].Value = Range(minken & "|fffd|N|fffd||fffd|").Value
        
        For pl = 1 To 3
            ' -----E10|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@(0=|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|A2=|fffd|N|fffd||fffd||fffd|A4=|fffd||fffd||fffd||fffd||fffd|A5=|fffd|c|fffd||308||fffd||fffd|A6=|fffd|W|fffd|c|fffd||fffd|)
            If (Range(minken & "|fffd||fffd||fffd||fffd|" & pl) = "|fffd||fffd||fffd||fffd|") Then
                .[|fffd||fffd||fffd||fffd|].Value = 4
            ElseIf (Range(minken & "|fffd||fffd||fffd||fffd|" & pl) = "|fffd|N|fffd||fffd|") Then
                .[|fffd||fffd||fffd||fffd|].Value = 2
            ElseIf (Range(minken & "|fffd||fffd||fffd||fffd|" & pl) = "|fffd|c|fffd||308||fffd|") Then
                .[|fffd||fffd||fffd||fffd|].Value = 5
            ElseIf (Range(minken & "|fffd||fffd||fffd||fffd|" & pl) = "|fffd|W|fffd|c|fffd||fffd|") Then
                .[|fffd||fffd||fffd||fffd|].Value = 6
            ElseIf (Range(minken & "|fffd||fffd||fffd||fffd|" & pl) = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
                .[|fffd||fffd||fffd||fffd|].Value = 0
            Else
                .[|fffd||fffd||fffd||fffd|].ClearContents
            End If
            ' -----E14|fffd|F|fffd||fffd||fffd||fffd||23de||fffd||38f||6ca|O|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p|fffd||fffd||fffd||fffd|p)|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||289|@|fffd||fffd||fffd||d4||fffd|p|fffd||fffd||fffd||42a8f||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|)(0=|fffd|p|fffd||fffd||fffd|A1=|fffd||fffd||fffd|N|fffd|x)
            .[|fffd||fffd||fffd||fffd|O|fffd||fffd|].Value = 1
            ' -----E20|fffd|F|fffd||fffd||fffd|@(0=|fffd|t|fffd||442||202||fffd||fffd|A3|fffd|`20=|fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range(minken & "|fffd||fffd||fffd|@" & pl).Value > 0) Then
                .[|fffd||fffd||fffd|@AMT].Value = Int(Range(minken & "|fffd||fffd||fffd|@" & pl).Value / 1000)
            Else
                .[|fffd||fffd||fffd|@AMT].Value = 0
            End If
            ' -----E21|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd|z|fffd||30e|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|(1=|fffd||742||fffd|3|fffd||fffd|60|fffd||fffd||fffd|A2:|fffd||742||fffd|3|fffd||fffd|90|fffd||fffd|or|fffd||742||fffd|2|fffd||fffd|365|fffd||fffd|)
            If (minkenType = 0) Then
                .[|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|].Value = 2
            Else
                If (Range(minken & "|fffd||fffd||fffd|x" & pl).Value = 60) Then
                    .[|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|].Value = 1
                ElseIf (Range(minken & "|fffd||fffd||fffd|x" & pl).Value = 90) Then
                    .[|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|].Value = 2
                Else
                    .[|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|].ClearContents
                End If
            End If
            ' -----E23|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1=1|fffd|^|fffd|A2=2|fffd|^|fffd|A3=3|fffd|^)
            .[|fffd||fffd||fffd||fffd||fffd|^].Value = Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value
            ' -----E26|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3,5,10=|fffd||742||fffd|2:|fffd||fffd||fffd|~|fffd|P|fffd||281|A1,2,3=|fffd||742||fffd|3:|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then
                .[|fffd||fffd||fffd||fffd|AMT].Value = Int(Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value / 100)
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' ----- E28|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|p|fffd||30d||fffd||fffd|z|fffd|x|fffd|b|fffd|h(1=3|fffd||fffd||fffd|~|fffd|A2=1.5|fffd||fffd||fffd|~)
            If (Range(minken & "|fffd||fffd||fffd|x" & pl).Value = 3) Then
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].Value = 1
            ElseIf (Range(minken & "|fffd||fffd||fffd|x" & pl).Value = 1.5) Then
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].Value = 2
            Else
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].ClearContents
            End If
            ' -----E29|fffd|F|fffd||fffd|i|fffd||fffd||d2|S|fffd||6c1|E|fffd|s|fffd|S|fffd||fffd|(0=|fffd|s|fffd|S|fffd||6c1|A1=|fffd|S|fffd||fffd|)
            If (Range(minken & "|fffd||fffd|i" & pl).Value > 0) Then
                .[|fffd||fffd|i|fffd|S|fffd||fffd|].Value = 1
            Else
                .[|fffd||fffd|i|fffd|S|fffd||fffd|].Value = 0
            End If
                ' -----E30|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|@(0=|fffd|t|fffd||442||202||fffd||fffd|A5|fffd|`30=|fffd||fffd|~|fffd|P|fffd||fffd|)
            If (minkenType = 0) Then
                If (Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then
                    .[|fffd||fffd||fffd||fffd||fffd|AMT].Value = Int(Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value / 1000)
                Else
                    .[|fffd||fffd||fffd||fffd||fffd|AMT].Value = 0
                End If
            Else
                .[|fffd||fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E32|fffd|F|fffd||fffd||fffd||fffd|f|fffd|f(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3,5=|fffd|S|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (minkenType = 0) Then
                If (Range(minken & "|fffd||fffd||fffd|f" & pl).Value > 0) Then
                    .[|fffd||fffd||fffd||fffd|fAMT].Value = Int(Range(minken & "|fffd||fffd||fffd|f" & pl).Value / 100)
                Else
                    .[|fffd||fffd||fffd||fffd|fAMT].Value = 0
                End If
            Else
                .[|fffd||fffd||fffd||fffd|fAMT].Value = 0
            End If
            ' -----E33|fffd|F|fffd||fffd||fffd||554||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A50,100,200,300=|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (minkenType = 0) Then
                .[|fffd||fffd||fffd||fffd|AMT].Value = Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E34|fffd|F|fffd||fffd||fffd||83be||fffd|a|fffd||23de|(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3=|fffd|S|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (minkenType = 0) Then
                If (Range(minken & "|fffd||fffd||fffd|f" & pl).Value > 0) Then
                    .[|fffd||fffd||fffd||fffd|AMT].Value = Int(Range(minken & "|fffd||fffd||fffd|f" & pl).Value / 100)
                Else
                    .[|fffd||fffd||fffd||fffd|AMT].Value = 0
                End If
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E35|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83be||fffd|a|fffd||23de|(0=|fffd|t|fffd||442||202||fffd||fffd|A5,10=|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (minkenType = 0) Then
                If (Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then
                    .[|fffd||fffd||fffd||fffd|AMT].Value = Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value
                Else
                    .[|fffd||fffd||fffd||fffd|AMT].Value = 0
                End If
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E36|fffd|F|fffd||fffd||fffd||4e857||d4||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3=|fffd|^)
            If (minkenType = 0) Then
                If (Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|") Then
                    .[|fffd||fffd||fffd||4e84c|^].Value = Range(minken & "|fffd||fffd||fffd||fffd|" & pl).Value
                Else
                    .[|fffd||fffd||fffd||4e84c|^].Value = 0
                End If
            Else
                .[|fffd||fffd||fffd||4e84c|^].Value = 0
            End If
            
            ' |fffd||6cc||fffd||fffd||fffd||fffd||313|]|fffd|L
            .Calculate
            
            If (minkenType = 0) Then
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||d3dc|(2013/12/12)
                If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
                    Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
                    Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = 0
                    Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = 0
                Else
                    Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = .[G40].Value
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
                        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = .[G43].Value
                        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = .[G46].Value
                    Else
                        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = 0
                        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = 0
                    End If
                End If
            Else
                If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "" And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 0) Then
                    Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
                    Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = 0
                    Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = 0
                Else
                    Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = .[G40].Value
                    If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
                        Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = .[G43].Value
                        Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = .[G46].Value
                    Else
                        Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = 0
                        Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = 0
                    End If
                End If
            End If
        Next
    End With
    Application.EnableEvents = True
End Sub

'------------------------------------------------------------------------------
' Syuki|fffd||590||fffd||fffd|FDate
'------------------------------------------------------------------------------
Function Syuki(ByVal shiki As Date) As Date
    Dim y As Integer
    Dim m As Integer
    Dim d As Integer
    
    y = Year(shiki)
    m = Month(shiki)
    d = Day(shiki)
    If (m = 2 And d > 27) Then
        Syuki = DateSerial(y + 10, 3, 1) - 1
    Else
        Syuki = DateSerial(y + 10, m, d)
    End If
End Function

'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g
' |fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||fffd||fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||594||fffd||fffd|f
' @author kasagawa
'------------------------------------------------------------------------------
Public Sub SetTemporaryFromInput(ByVal MemberNo As Integer)
    Dim PlanNo As Integer
    For PlanNo = 1 To 3
        If Not IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & PlanNo)) Then
            '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||341|A|fffd|X|fffd|L|fffd|b|fffd|v|fffd||fffd||fffd||fffd|B
            '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd||702||fffd||fffd||fffd|0|fffd||30f||a347||fffd||302||74d|X|fffd|V
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd|Z|fffd|b|fffd|g" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|@" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|x" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd|i" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & PlanNo).Value
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & PlanNo).Value

            Application.EnableEvents = False

            '|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||595||6cc||fffd||fffd||fffd||fffd||310||752||fffd|
            Call SetTemporaryPremium(Member(MemberNo), MemberNo, PlanNo)

            Application.EnableEvents = True

        End If
    Next PlanNo
End Sub



'------------------------------------------------------------------------------
' |fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||590||752||fffd|
'
' |fffd||fffd||fffd||fffd||fffd|FMember|fffd|AMemberNo|fffd|APlanNo
' |fffd||7c2||fffd|l|fffd|F|fffd||202||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub SetTemporaryPremium(ByRef Member As FamilyMemberInfo, ByVal MemberNo As Integer, _
                                ByVal PlanNo As Integer)
    ' -----|fffd||693||fffd||fffd||fffd||fffd||30e||64fe|
  '  Application.EnableEvents = False
    
    Dim PayCnt As Integer
    Dim Payment(2) As String
    Dim UpDateFlg As Boolean
    UpDateFlg = False
    
    Payment(0) = "M"
    Payment(1) = "Y"
    Payment(2) = "A"

    ' -----|fffd|u|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|v|fffd||317|L|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    Dim isFind As Boolean
    Dim book As Workbook
    isFind = False
    For Each book In Workbooks
        If (book.Name = CALCURATETOOL_BOOKNAME) Then
                isFind = True
            Exit For
        End If
    Next
    Dim PlanCnt As Integer
    If (isFind = False) Then
        For PlanCnt = 1 To 3
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "M").Value = ""
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "Y").Value = ""
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "A").Value = ""
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & "M").Value = ""
            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & "Y").Value = ""
        Next
        MsgBox CALCURATETOOL_BOOKNAME & " |fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||7cc|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        'Application.EnableEvents = True
        Exit Sub
    End If
    ' -----|fffd||6cc||fffd||fffd||fffd||fffd||30e|Z|fffd|o
    With Workbooks(CALCURATETOOL_BOOKNAME).Sheets("main")
        
        ' -----E4|fffd|F|fffd||fffd||fffd||fffd||258|a|fffd|^|fffd||fffd||fffd||fffd|(0=|fffd||742||fffd|2|fffd|A1=|fffd||742||fffd|3)
        .[|fffd||fffd||fffd||fffd|].Value = 0
        'Debug.Print ".[|fffd||fffd||fffd||fffd|].Value=" & .[|fffd||fffd||fffd||fffd|].Value
        
        ' -----E5|fffd|F|fffd||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|(0=|fffd|p|fffd||fffd||fffd|A1=|fffd||fffd||fffd|N|fffd|x)
        .[|fffd||fffd|].Value = 1
        ' -----E6|fffd|F|fffd||fffd||fffd||fffd|(1=|fffd|j|fffd||fffd||fffd|A2=|fffd||fffd||fffd||fffd|)
        If (Member.Sex = "|fffd|j|fffd||fffd|") Then
            .[Sex].Value = 1
        ElseIf (Member.Sex = "|fffd||fffd||fffd||fffd|") Then
            .[Sex].Value = 2
        Else
            .[Sex].ClearContents
        End If
        'Debug.Print ".[Sex].Value=" & .[Sex].Value
        ' -----E7|fffd|F|fffd|N|fffd||fffd|(0|fffd|`89=|fffd||742||fffd|2|fffd|A30|fffd|`89=|fffd||742||fffd|3)
        .[x].Value = Member.Age
        
        'Debug.Print ".[x].Value=" & .[x].Value
        For PlanCnt = 1 To 3 '|fffd|v|fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v
            
            ' -----E14|fffd|F|fffd||fffd||fffd||fffd||23de||fffd||38f||6ca|O|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p|fffd||fffd||fffd||fffd|p)|fffd||fffd||fffd||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||289|@|fffd||fffd||fffd||d4||fffd|p|fffd||fffd||fffd||42a8f||fffd||fffd|N|fffd|x|fffd|_|fffd||fffd|)(0=|fffd|p|fffd||fffd||fffd|A1=|fffd||fffd||fffd|N|fffd|x)
            .[|fffd||fffd||fffd||fffd|O|fffd||fffd|].Value = 1
            ' -----E20|fffd|F|fffd||fffd||fffd|@(0=|fffd|t|fffd||442||202||fffd||fffd|A3|fffd|`20=|fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|@" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd|@AMT].Value = Int(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|@" & PlanNo).Value / 1000)
            Else
                .[|fffd||fffd||fffd|@AMT].Value = 0
            End If
            ' -----E21|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd|z|fffd||30e|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|(1=|fffd||742||fffd|3|fffd||fffd|60|fffd||fffd||fffd|A2:|fffd||742||fffd|3|fffd||fffd|90|fffd||fffd|or|fffd||742||fffd|2|fffd||fffd|365|fffd||fffd|)
            .[|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|].Value = 2
       
            ' -----E23|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1=1|fffd|^|fffd|A2=2|fffd|^|fffd|A3=3|fffd|^)
            .[|fffd||fffd||fffd||fffd||fffd|^].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            ' -----E26|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3,5,10=|fffd||742||fffd|2:|fffd||fffd||fffd|~|fffd|P|fffd||281|A1,2,3=|fffd||742||fffd|3:|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd||fffd|AMT].Value = Int(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value / 100)
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' ----- E28|fffd|F|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd|p|fffd||30d||fffd||fffd|z|fffd|x|fffd|b|fffd|h(1=3|fffd||fffd||fffd|~|fffd|A2=1.5|fffd||fffd||fffd|~)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|x" & PlanNo).Value = 3) Then
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].Value = 1
            ElseIf (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|x" & PlanNo).Value = 1.5) Then
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].Value = 2
            Else
                .[|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h].ClearContents
            End If
            ' -----E29|fffd|F|fffd||fffd|i|fffd||fffd||d2|S|fffd||6c1|E|fffd|s|fffd|S|fffd||fffd|(0=|fffd|s|fffd|S|fffd||6c1|A1=|fffd|S|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd|i" & PlanNo).Value > 0) Then
                .[|fffd||fffd|i|fffd|S|fffd||fffd|].Value = 1
            Else
                .[|fffd||fffd|i|fffd|S|fffd||fffd|].Value = 0
            End If
            ' -----E30|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|@(0=|fffd|t|fffd||442||202||fffd||fffd|A5|fffd|`30=|fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd||fffd||fffd|AMT].Value = Int(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value / 1000)
            Else
                .[|fffd||fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E32|fffd|F|fffd||fffd||fffd||fffd|f|fffd|f(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3,5=|fffd|S|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd||fffd|fAMT].Value = Int(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value / 100)
            Else
                .[|fffd||fffd||fffd||fffd|fAMT].Value = 0
            End If
            ' -----E33|fffd|F|fffd||fffd||fffd||554||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A50,100,200,300=|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            .[|fffd||fffd||fffd||fffd|AMT].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            ' -----E34|fffd|F|fffd||fffd||fffd||83be||fffd|a|fffd||23de|(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3=|fffd|S|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd||fffd|AMT].Value = Int(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value / 100)
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E35|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83be||fffd|a|fffd||23de|(0=|fffd|t|fffd||442||202||fffd||fffd|A5,10=|fffd||fffd||fffd|~|fffd|P|fffd||fffd|)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value > 0) Then
                .[|fffd||fffd||fffd||fffd|AMT].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Else
                .[|fffd||fffd||fffd||fffd|AMT].Value = 0
            End If
            ' -----E36|fffd|F|fffd||fffd||fffd||4e857||d4||fffd|p(0=|fffd|t|fffd||442||202||fffd||fffd|A1,2,3=|fffd|^)
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = "|fffd||fffd||fffd||fffd|") Then ' 0:|fffd||202||fffd||fffd|^1:|fffd||fffd||fffd||fffd|
 '           ElseIf (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 1) Then ' 0:|fffd||202||fffd||fffd|^1:|fffd||fffd||fffd||fffd|
                .[|fffd||fffd||fffd||4e84c|^].Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value
            Else
                .[|fffd||fffd||fffd||4e84c|^].Value = 0
            End If
            
            Member.PaymentVal(0) = 4 '|fffd||fffd||fffd||fffd|
            Member.PaymentVal(1) = 2 '|fffd|N|fffd||fffd|
            Member.PaymentVal(2) = 0 '|fffd|S|fffd||fffd||fffd|O|fffd|[

            For PayCnt = 0 To 2          '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||303||fffd||fffd|[|fffd|v
                ' -----E10|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@(0=|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|A2=|fffd|N|fffd||fffd||fffd|A4=|fffd||fffd||fffd||fffd||fffd|A5=|fffd|c|fffd||308||fffd||fffd|A6=|fffd|W|fffd|c|fffd||fffd|)
                .[|fffd||fffd||fffd||fffd|].Value = Member.PaymentVal(PayCnt)
    
                ' |fffd||6cc||fffd||fffd||fffd||fffd||313|]|fffd|L
                .Calculate
                
                If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|@" & PlanNo).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0 And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|x" & PlanNo).Value = 0 And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd|i" & PlanNo).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0 And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0 And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0 _
                        And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd|f" & PlanNo).Value = 0 And Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo).Value = 0) Then
                    Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & Payment(PayCnt)).Value = ""
                    If PayCnt <> 2 Then
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & Payment(PayCnt)).Value = ""
                    End If
                    UpDateFlg = True
                Else
                    If (PayCnt = 0) Then
                        If .[G40].Value >= 1000 Then
                            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "M").Value = .[G40].Value
                            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & "M").Value = .[G40].Value * 12 * 10
                        Else    '1000|fffd|~|fffd||fffd||fffd||fffd||fffd||389||fffd|
                            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "M").Value = 0
                            Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & "M").Value = 0
                        End If
                    ElseIf (PayCnt = 1) Then
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "Y").Value = .[G43].Value
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanNo & "Y").Value = .[G43].Value * 10
                    Else
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd||6d7||fffd|" & PlanNo & "A").Value = .[G40].Value
                    End If
                    UpDateFlg = True
                End If
            Next PayCnt '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||303||fffd||fffd|[|fffd|v
            
        Next PlanCnt '|fffd|v|fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|[|fffd|v
    End With
    
    
    If UpDateFlg = True Then
        '|fffd||fffd||fffd||fffd||fffd||149||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||315||6cc||fffd||fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd|
        Call UpdatePremium(MemberNo)
    End If
 
 '   Application.EnableEvents = True
End Sub


Private Sub SetNA(ByVal pl As Integer)
    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "" And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
    Else
        Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = "#N/A"
    End If
    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = "#N/A"
        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = "#N/A"
    Else
        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = 0
    End If
End Sub

'------------------------------------------------------------------------------
' |fffd||fffd||fffd||fffd||fffd|o|fffd|\|fffd||fffd||fffd||302||30d|X|fffd|V|fffd|i|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|j
'
' |fffd||fffd||fffd||fffd||fffd|FMemberNo
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub EditMemberInf(ByVal MemberNo As Integer, ByVal FamilyMode As Boolean)
    If FamilyMode = True Then
        '|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||fffd||fffd||fffd||752||fffd|
        Member(MemberNo).Name = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd|").Value
        Member(MemberNo).BirthDayY = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_y").Value
        Member(MemberNo).BirthDayM = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_m").Value
        Member(MemberNo).BirthDayD = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_d").Value
        
        Member(MemberNo).Sex = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd||fffd||fffd|").Value
        Member(MemberNo).Age = IIf(IsNumeric(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|N|fffd||fffd|").Value), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|N|fffd||fffd|").Value, 0)
    
    Else
        '|fffd||742||4c482|Q|fffd||fffd||fffd||349||fffd||282||fffd||fffd||fffd||752||fffd|
        Member(MemberNo).Name = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value
        Member(MemberNo).BirthDayY = [|fffd||fffd||fffd||fffd|2_y_2].Value
        Member(MemberNo).BirthDayM = [|fffd||fffd||fffd||fffd|2_m_2].Value
        Member(MemberNo).BirthDayD = [|fffd||fffd||fffd||fffd|2_d_2].Value
        
        Member(MemberNo).Sex = [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value
        Member(MemberNo).Age = [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|]
    
    End If
    Member(MemberNo).PaymentVal(0) = 4 '|fffd||fffd||fffd||fffd|
    Member(MemberNo).PaymentVal(1) = 2 '|fffd|N|fffd||fffd|
    Member(MemberNo).PaymentVal(2) = 0 '|fffd|S|fffd||fffd||fffd|O|fffd|[
  
End Sub

'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||7068||fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||254||fffd||fffd|f|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd|:|fffd|@MemberNo(1|fffd|`5)|fffd|^0:|fffd|S|fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Public Sub UpdatePremium(ByVal MemberNo As Integer)
    Dim MemberCnt As Integer
    Dim PlanCnt As Integer
    Dim MaxMemberNo As Integer
    
    If MemberNo = 0 Then
        MaxMemberNo = MAX_FAMILYNUMBER
    Else
        MaxMemberNo = MemberNo
    End If
    
    Dim cbMonth(1 To MAX_FAMILYNUMBER) As Object
    Set cbMonth(1) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth1
    Set cbMonth(2) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth2
    Set cbMonth(3) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth3
    Set cbMonth(4) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth4
    Set cbMonth(5) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbMonth5
    
    Dim cbYear(1 To MAX_FAMILYNUMBER) As Object
    Set cbYear(1) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear1
    Set cbYear(2) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear2
    Set cbYear(3) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear3
    Set cbYear(4) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear4
    Set cbYear(5) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbYear5
    
    Dim cbAll(1 To MAX_FAMILYNUMBER) As Object
    Set cbAll(1) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll1
    Set cbAll(2) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll2
    Set cbAll(3) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll3
    Set cbAll(4) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll4
    Set cbAll(5) = ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).cbAll5
    
    
    For MemberCnt = MaxMemberNo To MaxMemberNo
    
        ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/02/07
        '' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/01/21
        'ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Unprotect PASSWORD
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(MemberCnt) & "_y").Value = Range("|fffd||fffd||fffd||fffd|2_y_2").Value
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(MemberCnt) & "_m").Value = Range("|fffd||fffd||fffd||fffd|2_m_2").Value
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(MemberCnt) & "_d").Value = Range("|fffd||fffd||fffd||fffd|2_d_2").Value
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(MemberCnt) & "_|fffd||fffd||fffd||fffd|").Value = Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|").Value
        'Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & CStr(MemberCnt) & "_|fffd|N|fffd||fffd|").Value = Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|").Value
        'ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Protect PASSWORD, DrawingObjects:=True
        ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/01/21
        ' -----|fffd||fffd| |fffd|s|fffd||f347||fffd|C|fffd||fffd| 2014/02/07
    
        '|fffd||3cd|X|fffd|L|fffd||fffd||30f||a347|
        For PlanCnt = 1 To 3
            '|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||302||302||755|\|fffd||fffd||fffd||fffd||fffd||fffd|
            '|fffd||fffd||fffd||fffd|
            If cbMonth(MemberCnt) And (Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M").Value)) Then
                If Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M").Value > 0 Then
                    Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M"), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M").Value)
                    Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M"), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M").Value)
                 Else '1000|fffd|~|fffd||fffd||fffd||fffd||fffd||389||fffd|
                    Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M"), "-")
                    Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M"), "-")
                End If
            Else
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M"), "")
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M"), "")
            End If
            '|fffd|N|fffd||fffd|
            If cbYear(MemberCnt) Then
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "Y"), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "Y").Value)
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "Y"), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "Y").Value)
            Else
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "Y"), "")
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "Y"), "")
            End If
            '|fffd|S|fffd||fffd||fffd|O|fffd|[
            If cbAll(MemberCnt) Then
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "A"), Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "A").Value)
            Else
                Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "A"), "")
            End If
        Next PlanCnt
    Next MemberCnt
    
End Sub

'------------------------------------------------------------------------------
' |fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||303|R|fffd|s|fffd|[|fffd|i|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||241|j
' |fffd||fffd||fffd||fffd||fffd|F|fffd|R|fffd|s|fffd|[|fffd||fffd||182||202||fffd|MemberNo
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub CopyTemporaryPlan(ByVal MemberNo As Integer)
    Dim MemberCnt As Integer
    Dim PlanCnt As Integer
    
    
    '|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    If CheckFamilyInput(MemberNo) = False Then
        Exit Sub
    End If
    
    
    Application.ScreenUpdating = False
    
    
    '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||194||fffd||fffd||80b7||fffd||fffd|B
    For MemberCnt = MemberNo - 1 To 1 Step -1
        For PlanCnt = 1 To 3
            If (Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "M").Value) Or _
                Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "Y").Value) Or _
                Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & "A").Value) Or _
                Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M").Value) Or _
                Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "Y").Value)) Then
                
                ' |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||74e||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
                Call CopyTemporaryPlanCore(MemberCnt, MemberNo)
                
                Application.ScreenUpdating = True

                Exit Sub
                
            End If
        Next PlanCnt
    
    Next MemberCnt
    
    Application.ScreenUpdating = True


End Sub

'------------------------------------------------------------------------------
' |fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||303|R|fffd|s|fffd|[|fffd|i|fffd||fffd||315||fffd||fffd||193||fffd||fffd||fffd||fffd||241|j
' |fffd||fffd||fffd||fffd||fffd|F|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||182||202||fffd|MemberNo|fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||182||202||fffd|MemberNo
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub CopyTemporaryPlanCore(ByVal fmMember As Integer, ByVal toMember As Integer)
    Dim PlanCnt As Integer
    

    
    For PlanCnt = 1 To 3
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd|Z|fffd|b|fffd|g" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd|Z|fffd|b|fffd|g" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd|@" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd|@" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd|x" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd|x" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd|i" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd|i" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd|f" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd|f" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd|f" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd|f" & PlanCnt).Value
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & toMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & fmMember & "_|fffd||fffd||fffd||fffd|" & PlanCnt).Value
        
        '|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|\|fffd||fffd||fffd||302||310||752||fffd|
        Call EditMemberInf(toMember, True)
        
        Application.EnableEvents = False
        
        '|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||595||6cc||fffd||fffd||fffd||fffd||310||752||fffd|
        Call SetTemporaryPremium(Member(toMember), toMember, PlanCnt)
        
        
        Application.EnableEvents = True
    Next PlanCnt

    '2014/5/19 |fffd|C|fffd||fffd| START kasagawa
    '|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||10f|o|fffd||302||fffd||fffd||7c2||24c||102||44f|o|fffd||fffd|
    Call MoveToMINKEN2INPUT_SHEET(toMember, True)
    '2014/5/19 |fffd|C|fffd||fffd| END kasagawa


End Sub

'------------------------------------------------------------------------------
' |fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
' |fffd||fffd||fffd||fffd||fffd|F1|fffd|`5:|fffd||fffd||fffd||fffd||fffd||38f||6d4||fffd||6cc||fffd||fffd||fffd|No, 0:|fffd|S|fffd||fffd||6cc||fffd||fffd||fffd|
' |fffd||7c2||fffd|l|fffd|FTrue:|fffd||fffd||fffd||742||fffd||fffd||fffd|@False|fffd|F|fffd||fffd||fffd||742||fffd||fffd||202||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Function CheckPremium(ByVal MemberNo As Integer) As Boolean
    Dim PlanCnt As Integer
    CheckPremium = False
    
    If MemberNo > 0 Then
        For PlanCnt = 1 To 3
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||6d7||fffd|" & PlanCnt & "M").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "M").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||6d7||fffd|" & PlanCnt & "Y").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd||fffd||fffd|" & PlanCnt & "Y").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||6d7||fffd|" & PlanCnt & "A").Value <> "") Then
                CheckPremium = True
                Exit Function
            End If
        Next PlanCnt
    Else
        For PlanCnt = 1 To 3
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||6d7||fffd||fffd|v" & PlanCnt & "M").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd||fffd||fffd||fffd|v" & PlanCnt & "M").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||6d7||fffd||fffd|v" & PlanCnt & "Y").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd||fffd||fffd||fffd|v" & PlanCnt & "Y").Value <> "" Or _
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||6d7||fffd||fffd|v" & PlanCnt & "A").Value <> "") Then
                CheckPremium = True
                Exit Function
            End If
        Next PlanCnt
    End If

End Function
    


'------------------------------------------------------------------------------
' |fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd|F|fffd|N|fffd||fffd||fffd|A|fffd||38f||fffd|MemberNo
' @author kasagawa
'------------------------------------------------------------------------------
Public Sub ClearPlan(ByVal MemberNo As Integer)

    If (MemberNo > 0) Then
        '|fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T" & MemberNo & "_|fffd|v|fffd||fffd||fffd||fffd|").Value = Empty
        '|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|V|fffd|[|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|v|fffd||fffd||fffd||fffd|"), Empty)
    Else
        '|fffd||742||4c482|Q|fffd||191||fffd||fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|T_|fffd|X|fffd|V|fffd||348||fffd|].Value = Empty
        '|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|V|fffd|[|fffd|g|fffd||303|N|fffd||fffd||fffd|A
        Call SetMin2FamilyRange([|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd|v|fffd||fffd||fffd||fffd||fffd||348||fffd|], Empty)
    
    End If
    

End Sub

'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||314|N|fffd||fffd||30d|X|fffd|V
' @author kasagawa
'------------------------------------------------------------------------------
Public Sub SetMin2FamilyAgeRange(Target As Range, Val As Variant, ByVal MemberCnt As Integer)
    
    If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value <> "" Or _
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_m").Value <> "" Or _
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_d").Value <> "") Then
        Call SetMin2FamilyRange(Target, Val)
    End If
    If Val = "#N/A" Then
        '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
         Call ClearPlan(MemberCnt)
    End If

End Sub


'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||30d|X|fffd|V|fffd|i|fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d|X|fffd|V|fffd||fffd||fffd||fffd|j
' @author kasagawa
'------------------------------------------------------------------------------
Public Sub SetMin2FamilyRange(Target As Range, Val As Variant)

    '|fffd||a39e||fffd|I|fffd||243|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Unprotect PASSWORD
    
    Target.Value = Val
    
    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||110||752||fffd|
    Call ThisWorkbook.Sheets(FAMILYMITUMORI_SHEETNAME).Protect(PASSWORD, DrawingObjects:=True)

End Sub


'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
' |fffd||fffd||fffd||fffd||fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||fffd|MemberNo
' @author kasagawa
'------------------------------------------------------------------------------
Private Function CheckFamilyInput(ByVal MemberNo As Integer)
    CheckFamilyInput = False
    ' -----|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
     If [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd|].Value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     End If
     If ([|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value = "" Or [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value = "" Or [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d] = "") Then
         MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     End If
     If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd|").Value = "") Then
         MsgBox "|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     End If
     
     If Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_y").Value = "" And _
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_m").Value = "" And _
        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_d").Value = "" Then
         Call SetMin2FamilyRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|N|fffd||fffd|"), "")
     End If
     
     If IsError(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|N|fffd||fffd|")) Then
         MsgBox "|fffd|N|fffd||e0aa||fffd|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||190||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     ElseIf (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd|N|fffd||fffd|").Value = "") Then
         MsgBox "|fffd|N|fffd||e0aa||fffd|v|fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||190||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     End If
     If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberNo & "_|fffd||fffd||fffd||fffd|").Value = "") Then
         MsgBox "|fffd||fffd||fffd||282||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
         Exit Function
     End If
    
     CheckFamilyInput = True
     
End Function


'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e|fffd||315||6cc||fffd||fffd||fffd||fffd||502||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub SetHoshoHokenKikan()
    Dim HokenKikan As String
    Dim shikiDate As Date
    
    shikiDate = CDate([|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value & "/" & [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value & "/" & [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value)
    HokenKikan = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value & "|fffd|N" & [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value & "|fffd||fffd|" & [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value & "|fffd||fffd|" & _
                                "|fffd|@|fffd||fffd||fffd||fffd|@" & Format(Syuki(shikiDate), "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|") & " |fffd||702||fffd| 10|fffd|N|fffd||fffd|"
                                
     '|fffd||a39e||fffd|I|fffd||243|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Unprotect PASSWORD
    
    [|fffd||fffd||fffd||fffd|2|fffd||195||fffd|_|fffd||6cc||fffd||fffd||fffd||fffd||fffd|1].Value = HokenKikan
    [|fffd||fffd||fffd||fffd|2|fffd||195||fffd|_|fffd||6cc||fffd||fffd||fffd||fffd||fffd|2].Value = HokenKikan
    [|fffd||fffd||fffd||fffd|2|fffd||195||fffd|_|fffd||6cc||fffd||fffd||fffd||fffd||fffd|3].Value = HokenKikan
    
    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||110||752||fffd|
    Call ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Protect(PASSWORD, DrawingObjects:=True)

End Sub

'------------------------------------------------------------------------------
' |fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub SetHoshoPremium()
    Dim PlanCnt As Integer
    Dim MemberCnt As Integer
    Dim PaymentCnt As Integer
    Dim Payment(2) As String
    Dim wkStr As String
    Dim DisplayMemberFlg As Boolean
    Dim DisplayPlanFlg As Boolean
    
    Dim RowCnt As Integer
    Payment(0) = "M"
    Payment(1) = "Y"
    Payment(2) = "A"
    
    '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||282||30d|s|fffd||342||fffd||fffd||7c1|i|fffd||fffd||6cc||fffd||fffd||482||302||342||fffd||fffd||7c2||30d|s|fffd|j
    Dim MemberRowPos(1 To 3) As Integer  'PlanCnt
    MemberRowPos(1) = PLAN1_MEMBER_START_ROW
    MemberRowPos(2) = PLAN2_MEMBER_START_ROW
    MemberRowPos(3) = PLAN3_MEMBER_START_ROW
    
    '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||282||30d|s|fffd||342||fffd||fffd||fffd|
    Dim PlanRowPos(1 To 3) As Integer  'PlanCnt
    PlanRowPos(1) = PLAN1_START_ROW
    PlanRowPos(2) = PLAN2_START_ROW
    PlanRowPos(3) = PLAN3_START_ROW
    
    
    
    '|fffd||a39e||fffd|I|fffd||243|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Unprotect PASSWORD
    Rows.Hidden = False
    '|fffd||645c||fffd||314||fffd|\|fffd||fffd||fffd||fffd|
    For PlanCnt = 1 To 3
        ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Shapes("|fffd||742||fffd|2|fffd||fffd||fffd|S" & PlanCnt).Visible = True
        ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Shapes("|fffd|x|fffd|m|fffd||38d||403||fffd||fffd|S" & PlanCnt).Visible = True
    Next PlanCnt

    
   '|fffd||6cc||fffd||fffd||fffd|
    For PlanCnt = 1 To 3
        DisplayPlanFlg = False
        For MemberCnt = 1 To MAX_FAMILYNUMBER
            DisplayMemberFlg = False
            '|fffd||fffd||fffd||fffd||fffd||fffd|
            wkStr = ""
            For PaymentCnt = 0 To 2
                If (Not IsEmpty(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Payment(PaymentCnt)).Value)) _
                    And IsNumeric(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Payment(PaymentCnt)).Value) Then
                
                    Select Case Payment(PaymentCnt)
                    Case "M"
                        wkStr = "|fffd||fffd||fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                    Case "Y"
                        wkStr = wkStr & vbCrLf & "|fffd|N|fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                    Case Else
                        wkStr = wkStr & vbCrLf & "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                    End Select
                    Range("|fffd||fffd||fffd||fffd|2|fffd||195||fffd|" & MemberCnt & "_|fffd||6d7||fffd|" & PlanCnt).Value = wkStr
                    DisplayMemberFlg = True
                    DisplayPlanFlg = True
                End If
            Next PaymentCnt
            
            If DisplayMemberFlg = False Then
                ' |fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd|s|fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|@|fffd|E|fffd|LMemberRowPos(PlanCnt)|fffd||fffd|-1|fffd||fffd|t|fffd||fffd|
                For RowCnt = MemberRowPos(PlanCnt) + MEMBER_HIDDEN_ROW * (MemberCnt - 1) To MemberRowPos(PlanCnt) - 1 + MEMBER_HIDDEN_ROW * MemberCnt
                    Rows(RowCnt).Hidden = True
                Next RowCnt
            End If
        Next MemberCnt
        If DisplayPlanFlg = False Then
            ' |fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|
            For RowCnt = PlanRowPos(PlanCnt) To PlanRowPos(PlanCnt) + PLAN_HIDDEN_ROW
                Rows(RowCnt).Hidden = True
                
            Next RowCnt
            '|fffd||645c||fffd||314||fffd|\|fffd||fffd||fffd||fffd|
            ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Shapes("|fffd||742||fffd|2|fffd||fffd||fffd|S" & PlanCnt).Visible = False
            ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Shapes("|fffd|x|fffd|m|fffd||38d||403||fffd||fffd|S" & PlanCnt).Visible = False

        End If
    Next PlanCnt
    
    '|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd|2
     For PlanCnt = 1 To 3
     '|fffd||fffd||fffd||fffd||fffd||fffd|
         wkStr = ""
         For PaymentCnt = 0 To 2
            If Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & "_|fffd||6d7||fffd||fffd|v" & PlanCnt & Payment(PaymentCnt)).Value <> "" Then
                Select Case Payment(PaymentCnt)
                Case "M"
                    wkStr = "|fffd||fffd||fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & "_|fffd||6d7||fffd||fffd|v" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                Case "Y"
                    wkStr = wkStr & vbCrLf & "|fffd|N|fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & "_|fffd||6d7||fffd||fffd|v" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                Case Else
                    wkStr = wkStr & vbCrLf & "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|" & vbCrLf & Format(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & "_|fffd||6d7||fffd||fffd|v" & PlanCnt & Payment(PaymentCnt)).Value, "#,#|fffd|~")
                End Select
                
                Range("|fffd||fffd||fffd||fffd|2|fffd||195||fffd|_|fffd||6d7||fffd||fffd|v" & PlanCnt).Value = wkStr
                
            End If
        Next PaymentCnt
    Next PlanCnt
   
                
    '|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||310||752||fffd|
    '|fffd||fffd|U|fffd|S|fffd||fffd||fffd||fffd|
    ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).ResetAllPageBreaks
    
    If Rows(PlanRowPos(2)).Hidden = False And Rows(PlanRowPos(1)).Hidden = False Then
        Range("B" & PlanRowPos(2)).PageBreak = xlManual
    End If
    If Rows(PlanRowPos(3)).Hidden = False And (Rows(PlanRowPos(1)).Hidden = False Or Rows(PlanRowPos(2)).Hidden = False) Then
        Range("B" & PlanRowPos(3)).PageBreak = xlManual
    End If
    
    
    '|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||110||752||fffd|
    Call ThisWorkbook.Sheets(FAMILYHOSYO_SHEETNAME).Protect(PASSWORD, DrawingObjects:=True)

End Sub

'------------------------------------------------------------------------------
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||602||fffd||702||142||315||fffd||fffd||fffd||fffd||fffd||1228f|o|fffd||fffd||fffd||fffd|
' |fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||341|A|fffd|S|fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Function getSei(ByVal Shimei As String) As String
    
    Dim Sei As String
    Dim PosHanSpace As Long     '|fffd||fffd||fffd|p|fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||292|u
    Dim PosZenSpace As Long     '|fffd|S|fffd|p|fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||292|u
    Dim PosSpace As Long
    
    '|fffd||fffd||fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||292|u|fffd||30e||64fe|
    PosHanSpace = InStr(Shimei, " ")
    '|fffd|S|fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||292|u|fffd||30e||64fe|
    PosZenSpace = InStr(Shimei, "|fffd|@")
    If PosHanSpace = 0 Then
        PosHanSpace = Len(Shimei)
    End If
    If PosZenSpace = 0 Then
        PosZenSpace = Len(Shimei)
    End If
    
    If PosZenSpace < PosHanSpace Then
        PosSpace = PosZenSpace
    Else
        PosSpace = PosHanSpace
    End If
    
    Sei = Shimei
    If Len(Shimei) > PosSpace Then
        Sei = Left(Shimei, PosSpace - 1)
    End If
    getSei = Sei
End Function



'------------------------------------------------------------------------------
' |fffd||742||42bc2||fffd|Q|fffd||191||fffd||fffd||30e|c|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||a0bd||fffd||742||4c482|Q|fffd||191||fffd||fffd||23de||fffd||fffd||fffd|e|fffd||314||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Function DeleteHoshoHidden(newBook As Workbook) As String
    
    Dim PlanCnt As Integer
    Dim RowCnt As Integer
    Dim DelRowCnt As Integer
    
   '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||282||30d|s|fffd||342||fffd||fffd||fffd|
    Dim PlanRowPos(1 To 3) As Integer  'PlanCnt
    PlanRowPos(1) = PLAN1_START_ROW
    PlanRowPos(2) = PLAN2_START_ROW
    PlanRowPos(3) = PLAN3_START_ROW

    '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||282||30d|s|fffd||342||fffd||fffd||7c1|i|fffd||fffd||6cc||fffd||fffd||482||302||342||fffd||fffd||7c2||30d|s|fffd|j
    Dim MemberRowPos(1 To 3) As Integer  'PlanCnt
    MemberRowPos(1) = PLAN1_MEMBER_START_ROW
    MemberRowPos(2) = PLAN2_MEMBER_START_ROW
    MemberRowPos(3) = PLAN3_MEMBER_START_ROW


    '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||282||30d||d3dc|
    For PlanCnt = 3 To 1 Step -1
        If Rows(PlanRowPos(PlanCnt)).Hidden Then
            '|fffd|v|fffd||fffd||fffd||fffd||fffd|P|fffd||28d||d3dc||fffd|i|fffd||149||fffd||fffd|s|fffd||fffd||fffd||fffd||d3dc||fffd|j
            For RowCnt = PlanRowPos(PlanCnt) + PLAN_HIDDEN_ROW To PlanRowPos(PlanCnt) Step -1
                Rows(RowCnt).Delete
            Next RowCnt
            '|fffd||645c||fffd||30d||d3dc|
            newBook.ActiveSheet.Shapes("|fffd||742||fffd|2|fffd||fffd||fffd|S" & PlanCnt).Delete
            newBook.ActiveSheet.Shapes("|fffd|x|fffd|m|fffd||38d||403||fffd||fffd|S" & PlanCnt).Delete
            
        Else
            '|fffd||fffd||6cc||fffd||fffd||482||314||348||342||14c||fffd||fffd||fffd|
            For RowCnt = MemberRowPos(PlanCnt) + MEMBER_HIDDEN_ROW * MAX_FAMILYNUMBER - 1 To PlanRowPos(PlanCnt) Step -1
                If Rows(RowCnt).Hidden Then
                    '|fffd|B|fffd||fffd||fffd|s|fffd||142||fffd||fffd||fffd||38d||d3dc|
                    Rows(RowCnt).Delete
                End If
            Next RowCnt
        
        End If
    Next PlanCnt
    
    '|fffd|B|fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||fffd|
    Rows.Hidden = False
         
End Function


'------------------------------------------------------------------------------
' |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub DisplaySaveDialog(newBook As Workbook, ByVal bookName As String)
    On Error GoTo Ext
    Dim vntFileName As Variant
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|J|fffd||fffd||fffd||702||fffd|
    vntFileName = _
                Application.GetSaveAsFilename( _
                     InitialFileName:=bookName & ".xls" _
                   , FileFilter:="Microsoft Office Excel |fffd|u|fffd|b|fffd|N(*.xls),*.xls" _
                   , FilterIndex:=1 _
                   , Title:="|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||115||6d1||fffd|" _
                   )
    If vntFileName <> False Then
        '|fffd||6d1||fffd||fffd||fffd||fffd||fffd|
        newBook.SaveAs Filename:=vntFileName
        
        MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf, vbInformation, PRODUCT_NAME
'        MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf, vbInformation, PRODUCT_NAME
'           "|fffd|u|fffd|b|fffd|N|fffd||fffd||602||fffd||582||fffd||fffd||101|A|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbInformation, PRODUCT_NAME
    Else
        '|fffd||20a2||fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd||fffd||fffd|OFF|fffd||242||fffd||fffd||702||fffd|
        Application.DisplayAlerts = False

        newBook.Close SaveChanges:=False
        
        '|fffd||20a2||fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd||fffd||fffd|ON|fffd||256||7c2||fffd||fffd||702||fffd|
        Application.DisplayAlerts = True
    End If
    
    Exit Sub
    
Ext:
    '|fffd||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||241|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||702||fffd||fffd||341|A|fffd|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    MsgBox newBook.Name & "|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||150|V|fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf _
                        & "|fffd|u|fffd|b|fffd|N|fffd||fffd||602||fffd||582||fffd||fffd||101|A|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbInformation, PRODUCT_NAME
    
End Sub


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cbMonth1, 169, 0, MSForms, CheckBox"
Attribute VB_Control = "cbYear1, 170, 1, MSForms, CheckBox"
Attribute VB_Control = "cbAll1, 171, 2, MSForms, CheckBox"
Attribute VB_Control = "cbMonth2, 172, 3, MSForms, CheckBox"
Attribute VB_Control = "cbYear2, 173, 4, MSForms, CheckBox"
Attribute VB_Control = "cbAll2, 174, 5, MSForms, CheckBox"
Attribute VB_Control = "cbMonth3, 175, 6, MSForms, CheckBox"
Attribute VB_Control = "cbYear3, 176, 7, MSForms, CheckBox"
Attribute VB_Control = "cbAll3, 177, 8, MSForms, CheckBox"
Attribute VB_Control = "cbMonth4, 178, 9, MSForms, CheckBox"
Attribute VB_Control = "cbYear4, 179, 10, MSForms, CheckBox"
Attribute VB_Control = "cbAll4, 180, 11, MSForms, CheckBox"
Attribute VB_Control = "cbMonth5, 181, 12, MSForms, CheckBox"
Attribute VB_Control = "cbYear5, 182, 13, MSForms, CheckBox"
Attribute VB_Control = "cbAll5, 183, 14, MSForms, CheckBox"
'------------------------------------------------------------------------------
' |fffd|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
' @author kasagawa
'------------------------------------------------------------------------------
'Option Explicit

Private Sub Worksheet_Change(ByVal Target As Range)
 '   Debug.Print "Worksheet_Change"
    On Error GoTo Ext

    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd||fffd||fffd||354||348||fffd|]) Is Nothing) Or _
        Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd|n|fffd||fffd||fffd||fffd|]) Is Nothing) Then
        Application.EnableEvents = False
    
        ' |fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|N|fffd||318|a|fffd||fffd||fffd|AD|fffd||255||50a||fffd|
        Call ConvertAD(Target, Member)
        
        ' |fffd|N|fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd||fffd|{
        Call CalcAge(Target, Member)
    
        '|fffd||fffd||fffd||282||315||3cd|X|fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|O
        Call ChangeSex(Target, Member)
    
    ElseIf Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_|fffd|n|fffd||fffd||fffd||fffd|]) Is Nothing) Then
        Application.EnableEvents = False
        '|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||315||3cd|X
        Call ClearPlan(0)
        
        
    End If
    
    
    Application.EnableEvents = True
'    Exit Sub
'
Ext:
'   MsgBox "|fffd|f|fffd|o|fffd|b|fffd|O|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|F" & Err.Description & "(" & Err.Number & ")"
'   Application.EnableEvents = True
'
    '|fffd|O|fffd||302||fffd||fffd||7d5||6cc||fffd|
    Application.EnableEvents = True

End Sub



'------------------------------------------------------------------------------
' |fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|a|fffd||f068||fffd||fffd||fffd||fffd||3ca||fffd|
' |fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|W|fffd|A|fffd||fffd||6cc||fffd||fffd||48f||fffd||fffd|\|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub ConvertAD(ByVal Target As Range, Member() As FamilyMemberInfo)
    Dim MemberCnt As Integer

    For MemberCnt = 1 To MAX_FAMILYNUMBER
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y")) Is Nothing) Then
            '|fffd||3cd|X|fffd|L|fffd||fffd||30f||a347|
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value <> "") Then
                Dim L1 As String
                L1 = Left(UCase(StrConv(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value, vbNarrow)), 1)
                If ("MTSH" Like "*" & L1 & "*") Then
                    If L1 = "M" Then
                        L1 = 1867
                    ElseIf L1 = "T" Then
                        L1 = 1911
                    ElseIf L1 = "S" Then
                        L1 = 1925
                    ElseIf L1 = "H" Then
                        L1 = 1988
                    End If
                    Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value = Int(Mid(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value, 2, 2)) + L1
                End If
            End If
        End If
    Next

End Sub


'------------------------------------------------------------------------------
' |fffd|N|fffd||fffd|v|fffd|Z
' |fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|W|fffd|A|fffd||fffd||6cc||fffd||fffd||48f||fffd||fffd|\|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub CalcAge(ByVal Target As Range, Member() As FamilyMemberInfo)

    Dim MemberCnt As Integer
    
    For MemberCnt = 1 To MAX_FAMILYNUMBER
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_ymd")) Is Nothing) Then
            '|fffd||3cd|X|fffd|L|fffd||fffd||30f||a347|
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value > 9999) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                GoTo ErrExt
            End If

            Dim y1 As Integer
            Dim m1 As Integer
            Dim d1 As Integer
            Dim y2 As Integer
            Dim m2 As Integer
            Dim d2 As Integer
            Dim ymd1 As Date
            Dim ymd2 As Date
            Dim Age As Integer
            y1 = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_y].Value
            m1 = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_m].Value
            d1 = [|fffd||fffd||fffd||fffd|2|fffd||191||fffd|_d].Value
            y2 = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value
            m2 = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_m").Value
            d2 = Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_d").Value
            ymd1 = DateSerial(y1, m1, d1)
            ymd2 = DateSerial(y2, m2, d2)
            If (m1 * 100 + d1 < m2 * 100 + d2) Then
                Age = y1 - y2 - 1
            Else
                Age = y1 - y2
            End If
            If (y1 = 0 Or m1 = 0 Or d1 = 0) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    GoTo ErrExt
                Else
                    GoTo Next_MemberCnt
                End If
            Else
                If (IsDate(y1 & "/" & m1 & "/" & d1) = False) Then
                    If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").Value <> "" Or _
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_m").Value <> "" Or _
                        Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_d").Value <> "") Then
                    
                        Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                    End If
                    '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
                    'Call ClearPlan(MemberCnt)
                    If MemberCnt = MAX_FAMILYNUMBER Then
                        MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                        Exit Sub
                    Else
                        GoTo Next_MemberCnt
                    End If
                End If
            End If
            If (CDate(y1 & "/" & m1 & "/" & d1) < DateSerial(2015, 8, 1)) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                MsgBox "|fffd||fffd||fffd||30c|v|fffd|Z|fffd|V|fffd|[|fffd|g|fffd||142||341|A2015|fffd|N8|fffd||fffd|1|fffd||fffd||fffd||20d|~|fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||302||74c|v|fffd|Z|fffd||94|\|fffd||142||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
                       "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_y").ClearContents
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_m").ClearContents
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_d").ClearContents
                GoTo ErrExt
            End If
            If (ymd1 < Now() - 1) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    MsgBox "|fffd|k|fffd|y|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                    Exit Sub
                Else
                    GoTo Next_MemberCnt
                End If
            End If
            Dim okDay As Date
            okDay = DateSerial(Year(Now), Month(Now) + 4, 1) - 1
            If (ymd1 > okDay) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd|" & Format(okDay, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|") & "|fffd||702||142||313||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
                           "3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||34e||fffd||fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
                    Exit Sub
                Else
                    GoTo Next_MemberCnt
                End If

            End If
            If (ymd1 > Now() + 183) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    MsgBox "|fffd||fffd||fffd||fffd|t|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                    Exit Sub
                Else
                    GoTo Next_MemberCnt
                End If
            End If
            If (y2 = 0 And m2 = 0 And d2 = 0) Then
                '|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "", MemberCnt)
                '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
                Call ClearPlan(MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    Exit Sub
                Else
                    GoTo Next_MemberCnt
                End If
            ElseIf (y2 = 0 Or m2 = 0 Or d2 = 0) Then
                '|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||fffd||fffd||a0a9||fffd||fffd||fffd||fffd||fffd||752||fffd|
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                If MemberCnt = MAX_FAMILYNUMBER Then
                    Exit Sub
                Else
                    GoTo Next_MemberCnt
                End If
            Else
                If (IsDate(y2 & "/" & m2 & "/" & d2) = False) Then
                    Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                    MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                    GoTo ErrExt
                End If
            End If
            If (Age > 89) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                MsgBox "90|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                GoTo ErrExt
            End If
            If ((ymd1 - ymd2 + 1 < 15) Or (ymd2 > Now())) Then
                Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), "#N/A", MemberCnt)
                MsgBox "|fffd||fffd||fffd||fffd|15|fffd||fffd||fffd||fffd||fffd||fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                GoTo ErrExt
            End If
            Call SetMin2FamilyAgeRange(Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd|N|fffd||fffd|"), Age, MemberCnt)
            '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
            Call ClearPlan(MemberCnt)
           
            
         End If

Next_MemberCnt:

    Next MemberCnt

    Exit Sub

ErrExt:
    '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
  '  Call ClearPlan(MemberCnt)

End Sub


'------------------------------------------------------------------------------
' |fffd||fffd||fffd||295||3cd|X
' |fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|W|fffd|A|fffd||fffd||6cc||fffd||fffd||48f||fffd||fffd|\|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub ChangeSex(ByVal Target As Range, Member() As FamilyMemberInfo)
    Dim MemberCnt As Integer

    For MemberCnt = 1 To MAX_FAMILYNUMBER
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|")) Is Nothing) Then
            '|fffd||3cd|X|fffd|L|fffd||fffd||30f||a347|
            '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
            Call ClearPlan(MemberCnt)
            Exit For
        End If
    Next MemberCnt

End Sub


'------------------------------------------------------------------------------
' |fffd||fffd||fffd||295||3cd|X|fffd|i|fffd|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|j
' |fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|W|fffd|A|fffd||fffd||6cc||fffd||fffd||48f||fffd||fffd|\|fffd||fffd||fffd||fffd|
' @author kasagawa
'------------------------------------------------------------------------------
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    'Debug.Print "Worksheet_BeforeDoubleClick"
    Dim MemberCnt As Integer
  
    For MemberCnt = 1 To MAX_FAMILYNUMBER
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|")) Is Nothing) Then
            '|fffd||3cd|X
            Application.EnableEvents = False
            
            If (Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|").Value = "|fffd|j|fffd||fffd|") Then
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|").Value = "|fffd||fffd||fffd||fffd|"
            Else
                Range("|fffd||fffd||fffd||fffd|2|fffd||191||fffd|" & MemberCnt & "_|fffd||fffd||fffd||fffd|").Value = "|fffd|j|fffd||fffd|"
            End If
            
            '|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A
            Call ClearPlan(MemberCnt)
            
            Application.EnableEvents = True
            Exit For
        End If
    Next MemberCnt


End Sub


'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|P|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbMonth1_Change()
    Call EditPremium(cbMonth1, 1, "M")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|Q|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbMonth2_Change()
    Call EditPremium(cbMonth2, 2, "M")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|R|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbMonth3_Change()
    Call EditPremium(cbMonth3, 3, "M")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|S|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbMonth4_Change()
    Call EditPremium(cbMonth4, 4, "M")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd|T|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbMonth5_Change()
    Call EditPremium(cbMonth5, 5, "M")
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|N|fffd||fffd||fffd|P|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbYear1_Change()
    Call EditPremium(cbYear1, 1, "Y")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|N|fffd||fffd||fffd|Q|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbYear2_Change()
    Call EditPremium(cbYear2, 2, "Y")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|N|fffd||fffd||fffd|R|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbYear3_Change()
    Call EditPremium(cbYear3, 3, "Y")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|N|fffd||fffd||fffd|S|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbYear4_Change()
    Call EditPremium(cbYear4, 4, "Y")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|N|fffd||fffd||fffd|T|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbYear5_Change()
    Call EditPremium(cbYear5, 5, "Y")
End Sub

'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|P|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbAll1_Change()
    Call EditPremium(cbAll1, 1, "A")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|Q|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbAll2_Change()
    Call EditPremium(cbAll2, 2, "A")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|R|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbAll3_Change()
    Call EditPremium(cbAll3, 3, "A")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|S|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbAll4_Change()
    Call EditPremium(cbAll4, 4, "A")
End Sub
'------------------------------------------------------------------------------
' |fffd|u|fffd||742||4c482|Q|fffd||191||fffd||fffd||fffd||fffd||3cf||fffd||fffd|@|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd|T|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Sub cbAll5_Change()
    Call EditPremium(cbAll5, 5, "A")
End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Option Explicit

'|fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||fffd||fffd||7c2||303||fffd||fffd|\|fffd|b|fffd|h
Public Sub Worksheet_Change2(ByVal Target As Range)
    Call Worksheet_Change(Target)

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  
    If (Intersect(Target, [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||354||348||fffd|]) Is Nothing) Then
        Exit Sub
    End If
    On Error GoTo Ext
    Application.EnableEvents = False
  
    ' |fffd|a|fffd||fffd||fffd|AD|fffd||255||50a||fffd|
    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2_y_2]) Is Nothing) Then
        Call AD
    End If
  
    ' |fffd|n|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|
    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2_ymd]) Is Nothing) Then
        Call Check1
        GoTo Ext
    End If

    ' |fffd|_|fffd||fffd|Z|fffd|b|fffd|g
    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g]) Is Nothing) Then
        If (Target.Column = 5) Then
            Call Set1(1)
        ElseIf (Target.Column = 7) Then
            Call Set1(2)
        ElseIf (Target.Column = 9) Then
            Call Set1(3)
        End If
    Else
        Call Set2
    End If

Ext:
    If (IsError([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value) = False) Then
        Call Prm(0)
        Call Check2
    End If
    Application.EnableEvents = True
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  
    If (Intersect(Target, [|fffd||fffd||fffd||fffd|2_|fffd|}|fffd|E|fffd|X|fffd||348||fffd|]) Is Nothing) Then
        Exit Sub
    End If
    On Error GoTo Ext
    Application.EnableEvents = False
  
    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|]) Is Nothing) Then
        If ([|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = "|fffd|j|fffd||fffd|") Then
            [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = "|fffd||fffd||fffd||fffd|"
        Else
            [|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|].Value = "|fffd|j|fffd||fffd|"
        End If
        GoTo Ext
    End If
  
    Dim pl As Integer
    For pl = 1 To 3
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl)) Is Nothing) Then
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|N|fffd||fffd|"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|N|fffd||fffd|") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|"
            Else
                Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|"
            End If
            GoTo Ext
        End If
    Next
  
    For pl = 1 To 3
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl)) Is Nothing) Then
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E5") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S5"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S5") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3"
            ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3") Then
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E5"
            Else
                Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
            End If
            If (Target.Column = 5) Then
                Call Set1(1)
            ElseIf (Target.Column = 7) Then
                Call Set1(2)
            ElseIf (Target.Column = 9) Then
                Call Set1(3)
            End If
            GoTo Ext
        End If
    Next
  
Ext:
    If (IsError([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value) = False) Then
        Call Prm(0)
        Check2
    End If
    Cancel = True
    Application.EnableEvents = True
End Sub

Private Sub Set1(ByVal pl As Integer)
    If (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 100
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 300
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S5") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 500
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 100
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 300
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    ElseIf (Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E5") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 500
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0
    End If
End Sub

Private Sub Set2()
    Dim pl As Integer
    For pl = 1 To 3
        Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = ""
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 100 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 300 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3"
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 500 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S5"
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 100 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1"
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 300 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3"
        End If
        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 500 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|2_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E5"
        End If
    Next
End Sub

Private Sub AD()
    If ([|fffd||fffd||fffd||fffd|2_y_2].Value <> "") Then
        Dim L1 As String
        L1 = Left(UCase(StrConv([|fffd||fffd||fffd||fffd|2_y_2].Value, vbNarrow)), 1)
        If ("MTSH" Like "*" & L1 & "*") Then
            If L1 = "M" Then
                L1 = 1867
            ElseIf L1 = "T" Then
                L1 = 1911
            ElseIf L1 = "S" Then
                L1 = 1925
            ElseIf L1 = "H" Then
                L1 = 1988
            End If
            [|fffd||fffd||fffd||fffd|2_y_2].Value = Int(Mid([|fffd||fffd||fffd||fffd|2_y_2].Value, 2, 2)) + L1
        End If
    End If
End Sub

Private Sub Check1()
    If ([|fffd||fffd||fffd||fffd|2_y_2].Value > 9999) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    
    Dim y1 As Integer
    Dim m1 As Integer
    Dim d1 As Integer
    Dim y2 As Integer
    Dim m2 As Integer
    Dim d2 As Integer
    Dim ymd1 As Date
    Dim ymd2 As Date
    Dim Age As Integer
    y1 = [|fffd||fffd||fffd||fffd|2_y_1].Value
    m1 = [|fffd||fffd||fffd||fffd|2_m_1].Value
    d1 = [|fffd||fffd||fffd||fffd|2_d_1].Value
    y2 = [|fffd||fffd||fffd||fffd|2_y_2].Value
    m2 = [|fffd||fffd||fffd||fffd|2_m_2].Value
    d2 = [|fffd||fffd||fffd||fffd|2_d_2].Value
    ymd1 = DateSerial(y1, m1, d1)
    ymd2 = DateSerial(y2, m2, d2)
    If (m1 * 100 + d1 < m2 * 100 + d2) Then
        Age = y1 - y2 - 1
    Else
        Age = y1 - y2
    End If
    If (y1 = 0 Or m1 = 0 Or d1 = 0) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        GoTo ErrExt
    Else
        If (IsDate(y1 & "/" & m1 & "/" & d1) = False) Then
            [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
            MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            GoTo ErrExt
        End If
    End If
    If (CDate(y1 & "/" & m1 & "/" & d1) < DateSerial(2015, 8, 1)) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd||30c|v|fffd|Z|fffd|V|fffd|[|fffd|g|fffd||142||341|A2015|fffd|N8|fffd||fffd|1|fffd||fffd||fffd||20d|~|fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||302||74c|v|fffd|Z|fffd||94|\|fffd||142||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
               "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
        [|fffd||fffd||fffd||fffd|2_y_1].ClearContents
        [|fffd||fffd||fffd||fffd|2_m_1].ClearContents
        [|fffd||fffd||fffd||fffd|2_d_1].ClearContents
        GoTo ErrExt
    End If
    If (ymd1 < Now() - 1) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd|k|fffd|y|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    Dim okDay As Date
    okDay = DateSerial(Year(Now), Month(Now) + 4, 1) - 1
    If (ymd1 > okDay) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd|" & Format(okDay, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|") & "|fffd||702||142||313||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
               "3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||34e||fffd||fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If (ymd1 > Now() + 183) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd||fffd|t|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If (y2 = 0 Or m2 = 0 Or d2 = 0) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        GoTo ErrExt
    Else
        If (IsDate(y2 & "/" & m2 & "/" & d2) = False) Then
            [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
            MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            GoTo ErrExt
        End If
    End If
    If (Age > 89) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "90|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If ((ymd1 - ymd2 + 1 < 15) Or (ymd2 > Now())) Then
        [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd||fffd|15|fffd||fffd||fffd||fffd||fffd||fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    [|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = Age
    Exit Sub

ErrExt:
    Dim pl As Integer
    For pl = 1 To 3
        Call SetNA(pl)
    Next
End Sub

Private Sub Check2()
    Dim errMsg As String
    Dim pl As Integer
    errMsg = ""
    For pl = 1 To 3
        Dim ms As String
        ms = "|fffd|v|fffd||fffd||fffd||fffd|" & pl & " |fffd|G "
        
        If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|] > 89) Then
            '[|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value = "#N/A"
            'MsgBox "90|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            'GoTo ErrExt
            Call SetNA(pl)
            errMsg = "90|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
        End If
        
        If ((Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value _
                + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value _
                + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value _
                + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value _
                + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value) > 0 Or Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|") Then
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "") Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
                If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd|{|fffd||23de||fffd||fffd|t|fffd||442||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
                If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 3000 Or Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 4000) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|5,000|fffd|~|fffd||20f||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0) Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value < 1 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|") Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If Not IsError([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value) Then
                If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value <= 14) Then
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 15000) Then
                        Call SetNA(pl)
                        If (errMsg = "") Then
                            errMsg = ms & "|fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||182||fffd||fffd||fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||34d||fffd||fffd|v|fffd||fffd|15,000|fffd|~|fffd||209||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                        End If
                    End If
                Else
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value + Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 30000) Then
                        Call SetNA(pl)
                        If (errMsg = "") Then
                            errMsg = ms & "|fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||182||fffd||fffd||fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||34d||fffd||fffd|v|fffd||fffd|30,000|fffd|~|fffd||209||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                        End If
                    End If
                End If
                If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value >= 40) Then
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 20000) Then
                        Call SetNA(pl)
                        If (errMsg = "") Then
                            errMsg = ms & "|fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|20,000|fffd|~|fffd||209||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                        End If
                    End If
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value > 300) Then
                        Call SetNA(pl)
                        If (errMsg = "") Then
                            errMsg = ms & "|fffd||fffd||fffd||fffd|f|fffd|f|fffd||6cc||fffd||fffd||fffd||fffd|z|fffd||fffd|300|fffd||fffd||fffd|~|fffd||209||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                        End If
                    End If
                End If
                If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value >= 76 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd||fffd||554||fffd|p|fffd||355|t|fffd||442||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
                If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value < 30 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value > 0) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd||fffd||83be||fffd|a|fffd|f|fffd|f|fffd||6cc||fffd||fffd||fffd||fffd||355|t|fffd||442||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
                If ([|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|].Value >= 15 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|").Value = "|fffd||fffd||fffd||fffd|") Then
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 10) Then
                        Dim cnt As Integer
                        cnt = 0
                        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value > 0) Then cnt = cnt + 1
                        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then cnt = cnt + 1
                        If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then cnt = cnt + 1
                        If (cnt < 2) Then
                            Call SetNA(pl)
                            If (errMsg = "") Then
                                errMsg = ms & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83be||fffd|a|fffd||fffd||fffd|@|fffd||a39e||fffd||fffd||fffd||fffd|10|fffd||fffd||fffd|~|fffd||242||fffd||fffd||fffd||fffd||182||fffd||fffd||341|A|fffd||fffd|{|fffd||23de||fffd||fffd||fffd|Q|fffd||88||20f||fffd|t|fffd||442||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                            End If
                        End If
                    End If
                Else
                    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value > 0) Then
                        Call SetNA(pl)
                        If (errMsg = "") Then
                            errMsg = ms & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83be||fffd|a|fffd||fffd||fffd|@|fffd||a39e||fffd||fffd||fffd||355|t|fffd||442||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
                        End If
                    End If
                End If
            End If
            If Not IsError(Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value) Then
                If (Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value < 1000) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||6cc||fffd||fffd||fffd||fffd||fffd|1,000|fffd|~|fffd||20f||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
            End If
        End If
    Next
    If (errMsg <> "") Then
        MsgBox errMsg, vbCritical, PRODUCT_NAME
    End If
End Sub

Private Sub SetNA(ByVal pl As Integer)
    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "" And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|@" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|x" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd|i" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd|f" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
    Else
        Range("|fffd||fffd||fffd||fffd|2_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = "#N/A"
    End If
    If (Range("|fffd||fffd||fffd||fffd|2_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = "#N/A"
        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = "#N/A"
    Else
        Range("|fffd||fffd||fffd||fffd|2_|fffd|N|fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|2_|fffd|O|fffd|[" & pl).Value = 0
    End If
End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'------------------------------------------------------------------------------
' |fffd||742||4c482|R|fffd||fffd||fffd||349||fffd||fffd|
'
' @author kawaguchi
'------------------------------------------------------------------------------
'Option Explicit


Private Sub Worksheet_Change(ByVal Target As Range)
    If Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||354||348||fffd|")) Is Nothing Then
        Exit Sub
    End If
    On Error GoTo Ext
    Application.EnableEvents = False

    ' |fffd|a|fffd||fffd||fffd|AD|fffd||255||50a||fffd|
    If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_y_2")) Is Nothing) Then
        Call AD
    End If
    
    ' |fffd|n|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|
    If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_ymd")) Is Nothing) Then
        Call Check1
        GoTo Ext
    End If

    ' |fffd|_|fffd||fffd|Z|fffd|b|fffd|g
    If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g")) Is Nothing) Then
        Call Set1
    Else
        Call Set2
    End If

Ext:
    If (IsError([|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value) = False) Then
        Call Prm(1)
        Call Check2
    End If
    Application.EnableEvents = True
End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
  
    If (Intersect(Target, [|fffd||fffd||fffd||fffd|3_|fffd|}|fffd|E|fffd|X|fffd||348||fffd|]) Is Nothing) Then
        Exit Sub
    End If
    On Error GoTo Ext
    Application.EnableEvents = False
  
    If Not (Intersect(Target, [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|]) Is Nothing) Then
        If ([|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = "|fffd|j|fffd||fffd|") Then
            [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = "|fffd||fffd||fffd||fffd|"
        Else
            [|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|].Value = "|fffd|j|fffd||fffd|"
        End If
        GoTo Ext
    End If
  
    Dim pl As Integer
    For pl = 1 To 3
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl)) Is Nothing) Then
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|N|fffd||fffd|"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|N|fffd||fffd|") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|"
            Else
                Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd||fffd||fffd||fffd|"
            End If
            GoTo Ext
        End If
    Next
  
    For pl = 1 To 3
        If Not (Intersect(Target, Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl)) Is Nothing) Then
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S2"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S2") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E2"
            ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E2") Then
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3"
            Else
                Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
            End If
            Call Set1
            GoTo Ext
        End If
    Next
  
Ext:
    If (IsError([|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value) = False) Then
        Call Prm(1)
        Check2
    End If
    Cancel = True
    Application.EnableEvents = True
End Sub

Private Sub Set1()
    Dim pl As Integer
    For pl = 1 To 3
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 100
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S2") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 200
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 300
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 100
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E2") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 200
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        ElseIf (Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3") Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 300
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000
        End If
    Next
End Sub

Private Sub Set2()
    Dim pl As Integer
    For pl = 1 To 3
        Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = ""
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 100 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S1"
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 200 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S2"
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 300 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "S3"
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 100 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E1"
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 200 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E2"
        End If
        If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 300 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 3 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 90 _
                And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 1000) Then
            Range("|fffd||fffd||fffd||fffd|3_|fffd|Z|fffd|b|fffd|g" & pl).Value = "E3"
        End If
    Next
End Sub

Private Sub AD()
    If ([|fffd||fffd||fffd||fffd|3_y_2].Value <> "") Then
        Dim L1 As String
        L1 = Left(UCase(StrConv([|fffd||fffd||fffd||fffd|3_y_2].Value, vbNarrow)), 1)
        If ("MTSH" Like "*" & L1 & "*") Then
            If L1 = "M" Then
                L1 = 1867
            ElseIf L1 = "T" Then
                L1 = 1911
            ElseIf L1 = "S" Then
                L1 = 1925
            ElseIf L1 = "H" Then
                L1 = 1988
            End If
            [|fffd||fffd||fffd||fffd|3_y_2].Value = Int(Mid([|fffd||fffd||fffd||fffd|3_y_2].Value, 2, 2)) + L1
        End If
    End If
End Sub

Private Sub Check1()
    If ([|fffd||fffd||fffd||fffd|3_y_2].Value > 9999) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    
    Dim y1 As Integer
    Dim m1 As Integer
    Dim d1 As Integer
    Dim y2 As Integer
    Dim m2 As Integer
    Dim d2 As Integer
    Dim ymd1 As Date
    Dim ymd2 As Date
    Dim Age As Integer
    y1 = [|fffd||fffd||fffd||fffd|3_y_1].Value
    m1 = [|fffd||fffd||fffd||fffd|3_m_1].Value
    d1 = [|fffd||fffd||fffd||fffd|3_d_1].Value
    y2 = [|fffd||fffd||fffd||fffd|3_y_2].Value
    m2 = [|fffd||fffd||fffd||fffd|3_m_2].Value
    d2 = [|fffd||fffd||fffd||fffd|3_d_2].Value
    ymd1 = DateSerial(y1, m1, d1)
    ymd2 = DateSerial(y2, m2, d2)
    If (m1 * 100 + d1 < m2 * 100 + d2) Then
        Age = y1 - y2 - 1
    Else
        Age = y1 - y2
    End If
    If (y1 = 0 Or m1 = 0 Or d1 = 0) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        GoTo ErrExt
    Else
        If (IsDate(y1 & "/" & m1 & "/" & d1) = False) Then
            [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
            MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            GoTo ErrExt
        End If
    End If
    If (CDate(y1 & "/" & m1 & "/" & d1) < DateSerial(2012, 12, 1)) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd||30c|v|fffd|Z|fffd|V|fffd|[|fffd|g|fffd||142||341|A2012|fffd|N12|fffd||fffd|1|fffd||fffd||fffd||20d|~|fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||302||74c|v|fffd|Z|fffd||94|\|fffd||142||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
               "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
        [|fffd||fffd||fffd||fffd|3_y_1].ClearContents
        [|fffd||fffd||fffd||fffd|3_m_1].ClearContents
        [|fffd||fffd||fffd||fffd|3_d_1].ClearContents
        GoTo ErrExt
    End If
    If (ymd1 < Now() - 1) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd|k|fffd|y|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    Dim okDay As Date
    okDay = DateSerial(Year(Now), Month(Now) + 4, 1) - 1
    If (ymd1 > okDay) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||6cc||fffd||fffd|n|fffd||fffd||fffd||fffd|" & Format(okDay, "yyyy|fffd|Nm|fffd||fffd|d|fffd||fffd|") & "|fffd||702||142||313||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@" & vbCrLf & _
               "3|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||6cc||fffd||fffd|n|fffd||fffd||fffd||34e||fffd||fffd|Z|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If (ymd1 > Now() + 183) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "|fffd||fffd||fffd||fffd|t|fffd|_|fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If (y2 = 0 Or m2 = 0 Or d2 = 0) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        GoTo ErrExt
    Else
        If (IsDate(y2 & "/" & m2 & "/" & d2) = False) Then
            [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
            MsgBox "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
            GoTo ErrExt
        End If
    End If
    If (Age > 80) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "81|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    If (Age < 30) Then
        [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
        MsgBox "30|fffd||396||fffd||fffd||fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
        GoTo ErrExt
    End If
    [|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = Age
    Exit Sub

ErrExt:
    Dim pl As Integer
    For pl = 1 To 3
        Call SetNA(pl)
    Next
End Sub

Private Sub Check2()
    Dim errMsg As String
    Dim pl As Integer
    errMsg = ""
    For pl = 1 To 3
        Dim ms As String
        ms = "|fffd|v|fffd||fffd||fffd||fffd|" & pl & " |fffd|G "
        
        If ([|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value <> "") Then
            If ([|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value > 80) Then
                '[|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
                Call SetNA(pl)
                'MsgBox "81|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                'GoTo ErrExt
                errMsg = "81|fffd||388||20f||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
            End If
            If ([|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value < 30) Then
                '[|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|].Value = "#N/A"
                Call SetNA(pl)
                'MsgBox "30|fffd||396||fffd||fffd||fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
                'GoTo ErrExt
                errMsg = "30|fffd||396||fffd||fffd||fffd||fffd||348||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|@|fffd|@"
            End If
        End If
        
        ' |fffd||fffd|-----|fffd||6cc||fffd||fffd||fffd||fffd|Z|fffd|o|fffd|s|fffd||f347||fffd||302||fffd||fffd||7c1|A|fffd|u|fffd||742||fffd||202||30c||fffd||fffd||6c2|R|fffd|v|fffd|u|fffd|j|fffd||fffd||fffd|v|fffd|u51|fffd||388||20f||fffd|v|fffd|u|fffd|R|fffd|^|fffd|v|fffd|u|fffd|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|60|fffd||fffd||fffd|v|fffd||30f||a347||fffd|A|fffd|v|fffd|Z|fffd|s|fffd||82||182||fffd||fffd||fffd|
        'If (IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|")) = False) Then
        '    If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|").Value = "|fffd|j|fffd||fffd|") Then
        '        If (Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|").Value >= 51) Then
        '            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 3) Then
        '                If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 60) Then
        '                    Call SetNA(pl)
        '                    If (errMsg = "") Then
        '                        errMsg = ms & "51|fffd||388||20f||fffd||313||fffd||fffd|@|fffd||fffd||fffd||d4||fffd|p|fffd|i|fffd|R|fffd|^|fffd|j|fffd||302||fffd||fffd|_|fffd||fffd||341|A" & vbCrLf & _
        '                                      "|fffd|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|60|fffd||fffd||fffd||308||fffd||fffd||c2bc2||fffd||fffd||fffd||fffd||752||fffd|~|fffd||fffd||fffd||102||fffd||fffd||fffd||702||fffd||fffd| |fffd|@|fffd|@" & vbCrLf & _
        '                                      "|fffd|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd|90|fffd||fffd||fffd||142||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        '                    End If
        '                End If
        '            End If
        '        End If
        '    End If
        'End If
        ' |fffd||fffd|-----
        
        If ((Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value + Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value _
                + Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value + Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value) > 0) Then
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "") Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0) Then
                If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd|{|fffd||23de||fffd||fffd|t|fffd||442||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
                If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 3000 Or Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 4000) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||fffd||fffd|@|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd|5,000|fffd|~|fffd||20f||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value > 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0) Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd||fffd||fffd|z|fffd|x|fffd|b|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0) Then
                Call SetNA(pl)
                If (errMsg = "") Then
                    errMsg = ms & "|fffd|x|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                End If
            End If
            If Not IsError(Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value) Then
                If (Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value < 1000) Then
                    Call SetNA(pl)
                    If (errMsg = "") Then
                        errMsg = ms & "|fffd||6cc||fffd||fffd||fffd||fffd||fffd|1,000|fffd|~|fffd||20f||fffd||182||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@"
                    End If
                End If
            End If
        End If
    Next
    If (errMsg <> "") Then
        MsgBox errMsg, vbCritical, PRODUCT_NAME
    End If
End Sub

Private Sub SetNA(ByVal pl As Integer)
    If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "" And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|@" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0 And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd|x" & pl).Value = 0 _
            And Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd|i" & pl).Value = 0) Then
        Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = 0
    Else
        Range("|fffd||fffd||fffd||fffd|3_|fffd||6cc||fffd||fffd||fffd|" & pl).Value = "#N/A"
    End If
    If (Range("|fffd||fffd||fffd||fffd|3_|fffd||fffd||fffd||fffd|" & pl).Value = "|fffd|S|fffd||fffd||fffd|O|fffd|[|fffd||fffd|") Then
        Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = "#N/A"
        Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = "#N/A"
    Else
        Range("|fffd||fffd||fffd||fffd|3_|fffd|N|fffd||fffd|" & pl).Value = 0
        Range("|fffd||fffd||fffd||fffd|3_|fffd|O|fffd|[" & pl).Value = 0
    End If
End Sub
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'------------------------------------------------------------------------------
' |fffd|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
' @author kawaguchi
'------------------------------------------------------------------------------
Option Explicit


'------------------------------------------------------------------------------
' |fffd||6d1||fffd||fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
   Cancel = True
   MsgBox "|fffd||6d1||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
          "|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||341|A|fffd||fffd||fffd||3cf||fffd||fffd||fffd||282||301|u|fffd||fffd||fffd||3cf||fffd||fffd||fffd||fffd|c|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|@|fffd|@", vbCritical, PRODUCT_NAME
End Sub

'------------------------------------------------------------------------------
' |fffd|N|fffd||fffd||fffd|[|fffd|Y|fffd||fffd||fffd||fffd|
'------------------------------------------------------------------------------
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    ' -----|fffd|u|fffd||6cc||fffd||fffd||fffd||fffd|v|fffd|Z|fffd|c|fffd|[|fffd||fffd||fffd|v|fffd||fffd||82||fffd||fffd||fffd|
    Dim book As Workbook
    For Each book In Workbooks
        If (book.Name = CALCURATETOOL_BOOKNAME) Then
            Application.DisplayAlerts = False
            Workbooks(CALCURATETOOL_BOOKNAME).Close False
            Exit For
        End If
    Next
    ' -----|fffd|A|fffd|v|fffd||fffd||fffd||30f|I|fffd||fffd||fffd||fffd|Excel|fffd||fffd||82||fffd||fffd||fffd|
    Application.DisplayAlerts = False
    Application.EnableEvents = False
    If (Workbooks.Count = 1) Then
        Application.Quit
    Else
        ThisWorkbook.Close False
    End If
    Application.EnableEvents = True
End Sub


INQUEST-PP=macro
