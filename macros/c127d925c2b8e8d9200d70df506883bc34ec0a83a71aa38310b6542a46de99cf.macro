Attribute VB_Name = "A_Type"
Option Explicit

Public v As Kozotai     '|fffd|\|fffd||fffd||fffd||fffd|
Dim vR As Long          '|fffd||fffd||fffd||68d|s
Dim vKomoku As String   '|fffd||fffd||fffd||696||fffd|


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|e|fffd|V|fffd|[|fffd|g|fffd||317||fffd||3d0||fffd||fffd||30d|\|fffd||fffd||fffd||302||242||fffd||fffd||fffd|`
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Type Kozotai

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||50d||fffd||fffd|F|fffd||1cd||fffd||fffd|E|fffd|o|fffd||341|E|fffd||fffd||fffd||fffd|p
    C_Tuban As Long    'B|fffd||fffd|F|fffd||294||fffd|
    C_Insatu As Long   'C|fffd||fffd|F|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|
    C_Export As Long   'D|fffd||fffd|FCSV|fffd|o|fffd||353||fffd|
    C_Import As Long   'E|fffd||fffd|F|fffd||1cd||fffd||fffd||fffd|
    C_ProcID As Long   'F|fffd||fffd|F|fffd||8471||fffd|h|fffd|c
    C_KaisoNum As Long 'AA|fffd||fffd|F|fffd|c|fffd||30a||509||515d4||fffd||fffd|s|fffd||50d||fffd|
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||50d||fffd||fffd|F|fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd|p
    C_I  As Long       'I|fffd||fffd|F|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h
    C_J  As Long       'J|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd|
    C_K  As Long       'K|fffd||fffd|F|fffd||515d0||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|
    '(2019/10/07)|fffd||1c9||fffd|
    C_N  As Long       'N|fffd||fffd|F|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h
    
    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||317||fffd||50d||fffd|
    C_Code As Long     'A|fffd||fffd|F|fffd|c|fffd||303|R|fffd|[|fffd|h
    C_Dantai As Long   'B|fffd||fffd|F|fffd|c|fffd||311||fffd||fffd||fffd|
    C_Region As Long   'D|fffd||fffd|F|fffd|s|fffd||fffd||fffd|{|fffd||fffd|
    C_Hyoji As Long    'E|fffd||fffd|F|fffd|\|fffd||fffd||fffd||fffd|
    C_Syuryobi As Long 'G|fffd||fffd|F|fffd|K|fffd|p|fffd|I|fffd||fffd||fffd||fffd|
    
    
    '|fffd||fffd||fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||50d||fffd|
    C_Komokumei As Long   'A|fffd||fffd|F|fffd||fffd||fffd||696||fffd|
    C_Hissu As Long    'B|fffd||fffd|F|fffd|K|fffd|{
    C_Zokuse As Long   'C|fffd||fffd|F|fffd||fffd||fffd||fffd|
    C_Mojisu1 As Long  'D|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
    C_Mojisu2 As Long  'E|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|
    
End Type


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||313||1cd||fffd||fffd|E|fffd|o|fffd||341|E|fffd||fffd||fffd||fffd|p|fffd||317||fffd||64fe|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Get_Column_DR1()
    
    On Error GoTo Jump
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vR = .Range("|fffd||fffd||fffd||68d|s").Row
        
        vKomoku = "|fffd||294||fffd|"
        v.C_Tuban = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|"
        v.C_Insatu = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "CSV|fffd|o|fffd||353||fffd|"
        v.C_Export = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||1cd||fffd||fffd||fffd|"
        v.C_Import = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||8471||fffd|h|fffd|c"
        v.C_ProcID = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd|c|fffd||30a||509||515d4||fffd||fffd|s|fffd||50d||fffd|"
        v.C_KaisoNum = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        
    End With
    On Error GoTo 0
    Exit Function

Jump:
    MsgBox "|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||241|A|fffd|u" & vKomoku & "|fffd|v|fffd||42a82||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
    On Error GoTo 0
    End
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd|p|fffd||317||fffd||64fe|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Get_Column_DR2()
    On Error GoTo Jump
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vR = .Range("|fffd||fffd||fffd||68d|s").Row
        
        vKomoku = "|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h"
        v.C_I = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd|"
        v.C_J = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||515d0||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|"
        v.C_K = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column

        '(2019/10/07)|fffd||1c9||fffd|
        vKomoku = "|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h"
        v.C_N = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column

    End With
    On Error GoTo 0
    Exit Function

Jump:
    MsgBox "|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||241|A|fffd|u" & vKomoku & "|fffd|v|fffd||42a82||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
    On Error GoTo 0
    End
End Function
    

'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||317||fffd||64fe|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Get_Column_Kanri()
    On Error GoTo Jump
    With Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g")
        vR = .Range("|fffd||fffd||fffd||68d|s").Row
    
        vKomoku = "|fffd|c|fffd||303|R|fffd|[|fffd|h"
        v.C_Code = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd|c|fffd||311||fffd||fffd||fffd|"
        v.C_Dantai = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd|s|fffd||fffd||fffd|{|fffd||fffd|"
        v.C_Region = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd|\|fffd||fffd||fffd||fffd|"
        v.C_Hyoji = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd|K|fffd|p|fffd|I|fffd||fffd||fffd||fffd|"
        v.C_Syuryobi = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
    End With
    On Error GoTo 0
    Exit Function

Jump:
    MsgBox "|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||241|A|fffd|u" & vKomoku & "|fffd|v|fffd||42a82||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
    On Error GoTo 0
    End
End Function

'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||64fe|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Get_Column_Sagyo()
    On Error GoTo Jump
    With Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_")
        vR = .Range("|fffd||fffd||fffd||68d|s").Row
        '(2019/10/04)|fffd||1c9||fffd|
        vKomoku = "|fffd||fffd||fffd||696||fffd|"
        v.C_Komokumei = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        
        vKomoku = "|fffd|K|fffd|{"
        v.C_Hissu = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||fffd||fffd||fffd|"
        v.C_Zokuse = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||fffd||fffd||fffd||fffd||fffd|1"
        v.C_Mojisu1 = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
        vKomoku = "|fffd||fffd||fffd||fffd||fffd||fffd|2"
        v.C_Mojisu2 = .Rows(vR).Find(What:=vKomoku, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Column
    End With
    On Error GoTo 0
    Exit Function

Jump:
    MsgBox "|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||241|A|fffd|u" & vKomoku & "|fffd|v|fffd||42a82||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
    On Error GoTo 0
    End
End Function

Attribute VB_Name = "B_Sub"
Option Explicit


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd||294||50d|s|fffd||312||fffd||fffd|o
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Extract_Data(vRange)
    
    Dim vRenban_T As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||310||64ea||fffd||50d||fffd|
    Dim vRenban_B As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||316||fffd||fffd||fffd||fffd||50d||fffd|
    
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||312||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||30e||64fe|
    With Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g")
        vRenban_T = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||64ea|")
        vRenban_B = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||fffd||fffd||fffd|")
    End With
    
    '|fffd||fffd||fffd|u|fffd||294||501|v|fffd||310||64ea||fffd||196||fffd||fffd||fffd||fffd||312||294||502||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||312||fffd||fffd|o
    If vRenban_T <> "" And vRenban_B <> "" Then
        vRange.AutoFilter Field:=v.C_Tuban, _
            Criteria1:=">=" & vRenban_T, Operator:=xlAnd, _
            Criteria2:="<=" & vRenban_B

    '|fffd||fffd||fffd|u|fffd||294||501|v|fffd||310||64ea||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||312||fffd||fffd|o
    ElseIf vRenban_T <> "" And vRenban_B = "" Then
        vRange.AutoFilter Field:=v.C_Tuban, Criteria1:=">=" & vRenban_T

    '|fffd||fffd||fffd|u|fffd||294||501|v|fffd||316||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||312||fffd||fffd|o
    ElseIf vRenban_T = "" And vRenban_B <> "" Then
        vRange.AutoFilter Field:=v.C_Tuban, Criteria1:="<=" & vRenban_B
    
    '|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||312||fffd||fffd|o
    ElseIf vRenban_T = "" And vRenban_B = "" Then
        vRange.AutoFilter Field:=v.C_Tuban, Criteria1:="<>"
    End If

End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Count_Row()
    
    Dim vR As Long          '|fffd||fffd||fffd||fffd||fffd|s
    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCount As Long      '|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vCount = 0
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        For vR = vRK + 1 To vRB
            If .Rows(vR).Hidden = False And .Cells(vR, v.C_Tuban) <> "" Then
                vCount = vCount + 1
            End If
        Next
    End With
    
    '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
    With Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g")
        .Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") = Format(vCount, "0000000")
    End With
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd||fffd||fffd|o|fffd|s|fffd|Z|fffd||fffd||fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Output_Date(vC)
    
    Dim vR As Long          '|fffd||fffd||fffd||fffd||fffd|s
    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCount As Long      '|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd||314||fffd||fffd||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        For vR = vRK + 1 To vRB
            If .Rows(vR).Hidden = False And .Cells(vR, v.C_Tuban) <> "" Then
                
                '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|^CSV|fffd|o|fffd||353||fffd||fffd|v|fffd||fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
                Application.EnableEvents = False
                .Cells(vR, vC) = Date
                Application.EnableEvents = True
            End If
        Next
    End With
End Function
Attribute VB_Name = "C_Import"
Option Explicit


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|C|fffd||fffd||fffd|||fffd|[|fffd|g
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Sub Import_Data()
    
    Dim vBook_sys As Object '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim vFName As String    'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vJyokyo As String   '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41|v
    Dim vCount As Long      '|fffd||1cd||fffd||fffd|f|fffd|[|fffd|^|fffd||30c||fffd||fffd||fffd|
    Dim vNo As Long         '|fffd||294||fffd|
    Dim vMsg As String      '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
    
    Dim vR As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|s
    Dim vC As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Dim vRK As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d||fffd||fffd||68d|s
    Dim vRT As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd||310||64ea||fffd|s
    Dim vRB As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCR As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd||309|E|fffd|[|fffd||fffd|
    Dim vRange As Range     '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd||314||348||fffd|
    
    Dim vRT2 As Long        '|fffd||1cd||fffd||fffd|f|fffd|[|fffd|^|fffd||310||64ea||fffd|s|fffd|i|fffd||fffd||fffd||68d|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    Dim vRB2 As Long        '|fffd||1cd||fffd||fffd|f|fffd|[|fffd|^|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCR2 As Long        '|fffd||1cd||fffd||fffd|f|fffd|[|fffd|^|fffd||309|E|fffd|[|fffd||fffd|
    Dim vRange2 As Range    '|fffd||1cd||fffd||fffd|f|fffd|[|fffd|^|fffd||314||348||fffd|

    Dim fso As FileSystemObject
    Dim fFile As File
    Dim extension As String
    
    '(2019/10/15)|fffd||1c9||fffd|
    'Const vPW As String = "tys" '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p
    
    
    
    '|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e|w|fffd||fffd|
    Set vBook_sys = ActiveWorkbook
    ChDir ActiveWorkbook.Path
    ''(2019/11/13)|fffd||1c9||fffd|
    'On Error GoTo Jump1
    vFName = Application.GetOpenFilename("CSV|fffd|t|fffd|@|fffd|C|fffd||fffd|,*.csv")
    If vFName = "False" Then GoTo Jump
    
    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    
    '(2019/10/07)|fffd||1c9||fffd|
    'Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    'ActiveSheet.Unprotect Password:=vPW
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||30e||64fe|
    Call Get_Column_DR1
    
    '|fffd||fffd||fffd|g|fffd||fffd||fffd|q|fffd||fffd|.csv|fffd||fffd||fffd||fffd|.txt|fffd||255||3cd|X|fffd||fffd||fffd||fffd|@|fffd||fffd|.csv|fffd||30f||a347||fffd|AOpenText|fffd||fffd|FieldInfo|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|
    Set fso = New FileSystemObject
    Set fFile = fso.GetFile(vFName)
    extension = ".txt"
    fFile.Name = fso.GetBaseName(fFile.Path) & extension
    
    '|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||310|V|fffd|u|fffd|b|fffd|N|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||313||1cd||fffd||fffd||741|FI|fffd|EJ|fffd|EK|fffd|EM|fffd|EP|fffd|EU|fffd|EX|fffd|EAA|fffd||fffd||355||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(2)|fffd|A|fffd||fffd||fffd||fffd||20a|O|fffd||355|W|fffd||fffd||fffd||fffd||fffd||fffd|(1)
    Workbooks.OpenText Filename:=fFile, _
        Origin:=932, _
        StartRow:=1, _
        DataType:=xlDelimited, _
        TextQualifier:=xlTextQualifierNone, _
        ConsecutiveDelimiter:=False, _
        Tab:=False, _
        Semicolon:=False, _
        Comma:=True, _
        Space:=False, _
        Other:=False, _
        FieldInfo:=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 2), Array(5, 2), _
            Array(6, 2), Array(7, 1), Array(8, 2), Array(9, 1), Array(10, 1), Array(11, 2), _
            Array(12, 1), Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 2), Array(17, 1), _
            Array(18, 1), Array(19, 2), Array(20, 1), Array(21, 2), Array(22, 2)), _
        TrailingMinusNumbers:=True

    '|fffd||fffd|CSV|fffd|f|fffd|[|fffd|^|fffd||315||fffd||fffd||294||348||342||310||752||fffd|
    With ActiveSheet
        vRT2 = 1
        ' *** 20180925 Start ***
        '|fffd||fffd||fffd||fffd||fffd||294||348||341|u|fffd||14f|I|fffd|s|fffd|v|fffd||34e||8471|ID|fffd||30d||14f|I|fffd|s|fffd||fffd||752||fffd|
        vRB2 = .Cells(.Rows.Count, "A").End(xlUp).Row
        '|fffd||fffd||fffd||fffd||fffd||294||348||341|u|fffd||14f|I|fffd||fffd|v|fffd||fffd|22|fffd||fffd|i|fffd|c|fffd||30a||509||515d4||fffd||fffd|s|fffd||50d||fffd||fffd|j|fffd||fffd||752||fffd|
        '(2019/10/08)|fffd||3cd|X22|fffd||fffd|100
        vCR2 = 100
        ' *** 20180925 End ***
        Set vRange2 = .Range(.Cells(vRT2, "A"), .Cells(vRB2, vCR2))
        
        ' *** 20180828 Start ***
        '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||30c|`|fffd||fffd||fffd||257||fffd||fffd||3cd|X
        Columns(5).Insert xlShiftToRight
        Columns(8).Cut
        Columns(6).Insert xlShiftToRight
        ' *** 20180828  End   ***

    End With

    '|fffd||fffd|CSV|fffd|f|fffd|[|fffd|^|fffd||301|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||582||315||fffd||fffd||fffd|
    With vBook_sys.Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        If .AutoFilterMode = True Then .AutoFilterMode = False
        vRT = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row + 1
        vRange2.Copy
        Application.EnableEvents = False
        .Cells(vRT, v.C_ProcID).PasteSpecial Paste:=xlPasteValues
        Application.EnableEvents = True
        Application.CutCopyMode = False
    End With
    
    '|fffd||fffd||fffd||fffd||197|p|fffd||310|V|fffd|u|fffd|b|fffd|N|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|N|fffd||fffd||fffd|[|fffd|Y
    Application.DisplayAlerts = False
    ActiveWorkbook.Close
    Application.DisplayAlerts = True
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||315||fffd||fffd||28d|s|fffd||301|u|fffd||1cd||fffd||fffd||fffd||fffd|v|fffd||fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
    With vBook_sys.Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRB = vRT + vRB2 - 1
        For vR = vRT To vRB
            Application.EnableEvents = False
            .Cells(vR, v.C_Import) = Date
            Application.EnableEvents = True
        Next
    End With
    vCount = vRB - vRT + 1
    
    '|fffd||fffd||fffd||294||513||fffd||fffd||342||18c|r|fffd||fffd||fffd|`|fffd||fffd|
    With vBook_sys.Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
    
        '|fffd||fffd||fffd||294||502||313||fffd||fffd||fffd|
        Application.EnableEvents = False
        vNo = 1
        For vR = vRK + 1 To vRB
            '|fffd||fffd||fffd||1cd||fffd||fffd||fffd||fffd||311||fffd||fffd||742||fffd||fffd||fffd|s|fffd||302||752||294||502||fffd||fffd||fffd||fffd|
            If .Cells(vR, v.C_Import) <> "" Then
                .Cells(vR, v.C_Tuban) = vNo
            End If
            vNo = vNo + 1
        Next
        Application.EnableEvents = True
    
        '|fffd||fffd||fffd|r|fffd||fffd||fffd||315|`|fffd||fffd|
        vCR = .Cells(vRK, .Columns.Count).End(xlToLeft).Column
        .Range(.Cells(vRT, v.C_Tuban), .Cells(vRB, vCR)).Borders.LineStyle = xlContinuous
    End With
    
    '|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|C|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
    Call Import_Data_Log(vBook_sys, vFName)

    '|fffd||fffd||fffd|g|fffd||fffd||fffd|q|fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|
    extension = ".csv"
    fFile.Name = fso.GetBaseName(fFile.Path) & extension
    
    '|fffd||fffd||fffd||33c8||fffd||fffd|
    vBook_sys.Activate
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    
    '(2019/10/07)|fffd||1c9||fffd|
    'ActiveSheet.Protect Password:=vPW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    '    False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    '    AllowInsertingRows:=True, AllowDeletingRows:=True, AllowSorting:=True, _
    '    AllowFiltering:=True, AllowUsingPivotTables:=True
    'ActiveSheet.EnableSelection = xlNoRestrictions
    
    Range("A1").Activate
    Application.ScreenUpdating = True
    Set vBook_sys = Nothing
    Set vRange = Nothing
    Set vRange2 = Nothing
    Set fso = Nothing
    
    '|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||315|\|fffd||fffd|
    vMsg = vFName
    vMsg = vMsg & Chr(13) & Chr(13) & "|fffd||fffd|L|fffd||302|b|fffd|r|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|S|fffd|f|fffd|[|fffd|^|fffd|i"
    vMsg = vMsg & vCount & "|fffd||fffd||fffd|j|fffd||fffd||fffd|A"
    vMsg = vMsg & Chr(13) & "|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd||fffd||fffd|s|fffd||252||1c9||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd| "
    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"

'    '(2019/11/13)|fffd||1c9||fffd|
'    GoTo Jump
'Jump1:
'    vMsg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1cd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||142||fffd||fffd|BCSV|fffd||fffd||283|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355||82||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
'    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
Jump:
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|C|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Import_Data_Log(vBook_sys, vFName)

    Dim vFile_Name As String    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile_Num As Integer    '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd|
    Dim vData As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    
'    '(2019/11/13)|fffd||1c9||fffd|
'    On Error GoTo Jump1
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|I|fffd|[|fffd|v|fffd||fffd|(|fffd||1c9||fffd||fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    vFile_Num = FreeFile
    vFile_Name = vBook_sys.Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
    Open vFile_Name For Append As #vFile_Num

    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1cd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    vData = vData & "|fffd|@|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & vFName
    Print #vFile_Num, vData

    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    Close #vFile_Num
    
'    '(2019/11/13)|fffd||1c9||fffd|
'    GoTo Jump
'Jump1:
'    vMsg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||1cd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B "
'    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
'Jump:
End Sub

Attribute VB_Name = "D_Export"
Option Explicit

'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Sub Export_Data()
Attribute Export_Data.VB_ProcData.VB_Invoke_Func = " \n14"

    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd||fffd||fffd||fffd||fffd|s
    Dim vC_Export           '|fffd||fffd||fffd||fffd||fffd||38f||6d7||fffd|
    Dim vRange As Range     '|fffd|f|fffd|[|fffd|^|fffd||348||fffd|
    Dim vCell As Range      '|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
    Dim vMsg As String      '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
    Dim vJyokyo As String   '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41|v
    Dim vBook_sys As Object '|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim vBook_New As Object '|fffd||fffd||197|p|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim vPath As String     '|fffd|p|fffd|X|fffd||fffd|
    Dim vFName As String    'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vLastRow As Long     '|fffd|o|fffd||351||38f||6c2||316||fffd||fffd||fffd||fffd|s
    Dim vRow As Long         '|fffd|o|fffd||351||38f||6cd|s
    Dim vCol As Integer      '|fffd|o|fffd||351||38f||6d7||fffd|
    Dim vFileNumber As Integer 'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd|No
    Dim vCsvFile As String   'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    
    '(2019/10/09)|fffd||1c9||fffd|
    'Dim vLocalCode As Long  '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g1|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||682||301|u|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v

    '(2019/10/15)|fffd||1c9||fffd|
    Const vPW As String = "tys" '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p

    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    Set vBook_sys = ActiveWorkbook
    '(2019/10/07)|fffd||1c9||fffd|
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    ActiveSheet.Unprotect Password:=vPW
    '(2019/10/08)|fffd||1c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        .Columns.Hidden = False
        .Rows.Hidden = False
        '(2019/11/14)|fffd||1c9||fffd|
        If .AutoFilterMode = True Then .AutoFilterMode = False
        .Rows("2:" & Rows.Count).Interior.Color = xlNone
    End With
        
    '(2019/10/25)|fffd||1c9||fffd|
    '|fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd||311|O|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|o====================================================================
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||30e||64fe|
    Call Get_Column_DR1
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        'If .AutoFilterMode = True Then .AutoFilterMode = False
        '|fffd||151||fffd|s(.Cells(.Rows.Count, v.C_Tuban))|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24d||14f|I|fffd|s|fffd||fffd|T|fffd||fffd|(End(xlUp))
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum))
    End With

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd||294||50d|s|fffd||312||fffd||fffd|o
    Call Extract_Data(vRange)
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41|v|fffd||312||fffd||fffd|o
    '|fffd|w|fffd||fffd||294||502||143|t|fffd|B|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||348||342||251||382||fffd||fffd||102||fffd||fffd||fffd||243|t|fffd|B|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|s|fffd||fffd|
    vJyokyo = Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||fffd|")
    If vJyokyo = "|fffd|o|fffd||34d||fffd|" Then
        vRange.AutoFilter Field:=v.C_Export, Criteria1:="<>"
    ElseIf vJyokyo = "|fffd||fffd||fffd|o|fffd||fffd|" Then
        vRange.AutoFilter Field:=v.C_Export, Criteria1:="="
    End If
        
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
    Call Count_Row
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|L|fffd||fffd||a347|
    If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") > 0 Then
        
        '(2019/10/25)|fffd||1c9||fffd|
        If Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Range("N2") <> Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|{|fffd||fffd|_|fffd|e|fffd|X|fffd|g") Then
            vMsg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|A|fffd|E|fffd|g|fffd||301|u|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||188||642||202||fffd||702||fffd||fffd|B|fffd|u|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||702||fffd||fffd||341|u|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            GoTo Jump2
        End If
        
        '(2019/10/08)|fffd||1c9||fffd|
        If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") > 10000 Then
            Application.ScreenUpdating = True
            vMsg = "|fffd|o|fffd||351||38f||6c2||fffd|10000|fffd||fffd||fffd||12d02||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCr & "10000|fffd||fffd||fffd||12d02||fffd||fffd||fffd||a347||fffd||352||294||502||24f|o|fffd||351||38f||6c2||fffd||fffd|w|fffd||80b5||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10f|o|fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B"
            GoTo Jump2
        End If
    End If
        
    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N====================================================

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||30e||64fe|
    'Call Get_Column_DR1

    ' *** 20180828 start ***
    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||e3c0||fffd|`|fffd|F|fffd|b|fffd|N
    Call Check_Data
    
    '|fffd||fffd|S-JIS|fffd|\|fffd||fffd||fffd|s|fffd||83|f|fffd|[|fffd|^|fffd||303|`|fffd|F|fffd|b|fffd|N
    Call Check_SJIS

    '|fffd||fffd|B|fffd||fffd||510|F|fffd||30c||fffd||fffd||fffd|
    With Application
        .FindFormat.Clear
        .FindFormat.Interior.Color = 255
    End With
    ' *** 20180828 end ***

'    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|o====================================================================
'
'    '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
'    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
'        If .AutoFilterMode = True Then .AutoFilterMode = False
'        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
'        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
'        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum))
'    End With
'
'    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd||294||50d|s|fffd||312||fffd||fffd|o
'    Call Extract_Data(vRange)
'
'    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41|v|fffd||312||fffd||fffd|o
'    vJyokyo = Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||fffd|")
'    If vJyokyo = "|fffd|o|fffd||34d||fffd|" Then
'        vRange.AutoFilter Field:=v.C_Export, Criteria1:="<>"
'    ElseIf vJyokyo = "|fffd||fffd||fffd|o|fffd||fffd|" Then
'        vRange.AutoFilter Field:=v.C_Export, Criteria1:="="
'    End If
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd|f|fffd|[|fffd|^|fffd||303|G|fffd|N|fffd|X|fffd|||fffd|[|fffd|g===================================================
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
    '(2019/10/25)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
    '|fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd|O|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
    'Call Count_Row
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|L|fffd||fffd||a347|
    If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") > 0 Then
        
        '(2019/10/25)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
        '|fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd|O|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
'        '(2019/10/09)|fffd||1c9||fffd|
'        'If vLocalCode <> Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Cells(25, "J") Then
'        If vLocalCode <> Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|{|fffd||fffd|_|fffd|e|fffd|X|fffd|g") Then
'            vMsg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|A|fffd|E|fffd|g|fffd||301|u|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||188||642||202||fffd||702||fffd||fffd|B|fffd|u|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||702||fffd||fffd||341|u|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
'            GoTo Jump2
'        End If
'
'        '(2019/10/08)|fffd||1c9||fffd|
'        If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") > 10000 Then
'            Application.ScreenUpdating = True
'            vMsg = "|fffd||fffd||fffd||fffd||fffd||38f||6c3||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd|10000|fffd||fffd||fffd||12d02||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCr & "10000|fffd||fffd||fffd||12d02||fffd||fffd||fffd|CSV|fffd|o|fffd||342||34f||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||312||294||50e|w|fffd||fffd||17617|p|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10d|s|fffd||fffd||fffd||60a4||fffd||fffd||fffd||80a2||fffd||fffd||fffd||702||fffd||fffd|B"
'            GoTo Jump2
'        End If
        
        Set vCell = vRange.Find(What:="", LookIn:=xlValues, _
        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
        MatchByte:=False, SearchFormat:=True)
        
        If Not vCell Is Nothing Then
            'MsgBox "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
            vMsg = "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B"
            
            '(2019/11/11)|fffd||1c9||fffd|
            '|fffd||fffd||82||142||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||352||294||50d||fffd||fffd||682||fffd||510|F|fffd|\|fffd||fffd|
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Cells(vRK, v.C_Tuban).Interior.Color = 255
            
            GoTo Jump2
        End If
        
        '|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd||301|uCSV|fffd|o|fffd||353||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
        Call Output_Date(v.C_Export)
            
        '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||303||fffd||fffd|[|fffd|N|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||315||fffd||fffd||fffd|
        vPath = ActiveWorkbook.Path
        With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
            .Range(.Cells(vRK, "B"), .Cells(vRB, v.C_KaisoNum)).SpecialCells(xlCellTypeVisible).Copy
        End With
        Workbooks.Add
        Set vBook_New = ActiveWorkbook
        ActiveSheet.Paste
        '|fffd||fffd||fffd|s|fffd|v|fffd|f|fffd|[|fffd|^|fffd|i|fffd||fffd||fffd||68d|s|fffd|A|fffd||294||501|`|fffd||1cd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||d3dc|
        Rows(1).Delete
        Range(Columns(v.C_Tuban - 1), Columns(v.C_ProcID - 2)).Delete
        
        '|fffd||fffd||fffd|o|fffd||343|t|fffd|H|fffd|[|fffd|}|fffd|b|fffd|g|fffd||255||3cd|X
        Columns(5).Delete
        Columns(5).Cut
        Columns(8).Insert xlShiftToRight
        '|fffd||fffd||fffd|o|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||242||355|s|fffd|v|fffd||302||fffd||fffd||7d2|l|fffd||fffd||fffd||d3dc|
        Columns(6).Clear
        Columns(22).Clear
        
        '|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||30e||64fe|
        With vBook_sys.Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g")
            .Calculate
            vFName = .Range("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
        End With
        
        '|fffd||fffd|CSV|fffd|o|fffd||fffd|
        vCsvFile = vPath & "\" & vFName
        vLastRow = Cells(Rows.Count, 1).End(xlUp).Row
        vFileNumber = FreeFile
        
        On Error GoTo Jump1
        Open vCsvFile For Output As #vFileNumber
            For vRow = 1 To vLastRow
                For vCol = 1 To 21
                    Print #vFileNumber, Cells(vRow, vCol) & ",";
                Next
                Print #vFileNumber, Cells(vRow, vCol) & ""
            Next
        Close vFileNumber
        
        On Error GoTo Jump1
        '|fffd||fffd||fffd||fffd||fffd|[|fffd|N|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||d3dc|
        Application.DisplayAlerts = False
        ActiveWorkbook.Close
        Application.DisplayAlerts = True

        '|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
        Call Export_Data_Log(vBook_sys)
    
        '|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30d||c42c|
        vMsg = vFName
        vMsg = vMsg & Chr(13) & Chr(13) & "|fffd||fffd|L|fffd||fffd|CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|A"
        vMsg = vMsg & Chr(13) & "|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||193||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||255||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd| "
        
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||c42c|
    ElseIf Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") = 0 Then
        vMsg = "|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd| "
    End If
    GoTo Jump2
    
    '================================================================================

    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
Jump1:
    Application.DisplayAlerts = False
    vBook_New.Close
    Application.DisplayAlerts = True
    vMsg = "CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||302||141|A|fffd||82||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
    On Error GoTo 0

Jump2:
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||312||fffd||fffd|o|fffd||fffd||502||309||fffd||fffd||fffd|
    vBook_sys.Activate
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        If .AutoFilterMode = True Then .AutoFilterMode = False
        Application.GoTo Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Range("A1"), Scroll:=True
    End With



    '|fffd||fffd||fffd||33c8||fffd||fffd|
    '(2019/10/07)|fffd||1c9||fffd|
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    ActiveSheet.Protect Password:=vPW, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingRows:=True, AllowDeletingRows:= _
        True, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:= _
        True
    ActiveSheet.EnableSelection = xlNoRestrictions
    
    Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
    Application.ScreenUpdating = True
    Set vBook_sys = Nothing
    Set vRange = Nothing
    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c||fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Export_Data_Log(vBook_sys)

    Dim vFile_Name As String    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile_Num As Integer    '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd|
    Dim vData As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    Dim vRenban_T As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||310||64ea||fffd||50d||fffd|
    Dim vRenban_B As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||316||fffd||fffd||fffd||fffd||50d||fffd|
    Dim vJyokyo  As String      '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||301|u|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41|v
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|I|fffd|[|fffd|v|fffd||fffd|(|fffd||1c9||fffd||fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    vFile_Num = FreeFile
    vFile_Name = vBook_sys.Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
    Open vFile_Name For Append As #vFile_Num

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||64fe|
    With vBook_sys.Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g")
        vRenban_T = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||64ea|")
        vRenban_B = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||fffd||fffd||fffd|")
        vJyokyo = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||fffd|")
    End With

    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd|f|fffd|[|fffd|^|fffd|o|fffd||342||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    vData = vData & "|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||294||501||fffd|" & vRenban_T & "|fffd|`" & vRenban_B
    vData = vData & "|fffd|C|fffd|f|fffd|[|fffd|^|fffd|o|fffd||34f||cbd41||fffd|" & vJyokyo
    Print #vFile_Num, vData

    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    Close #vFile_Num
End Sub
Attribute VB_Name = "E_Print"
Option Explicit


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd||fffd||fffd|[|fffd||308||fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Sub Print_Out()
    
    Dim vR As Long              '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|s
    Dim vRK As Long             '|fffd||fffd||fffd||68d|s
    Dim vRB As Long             '|fffd||fffd||fffd||fffd||fffd|s
    Dim vRB_Extract As Long     '|fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vRange As Range         '|fffd|f|fffd|[|fffd|^|fffd||348||fffd|
    Dim vCell As Range          '|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
    Dim vCount As Long          '|fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||30c||fffd||fffd||fffd|
    Dim vMsg As String          '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
    Dim vAns As Byte            '|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||309||fffd|
    Dim vJyokyo  As String      '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||301|u|fffd||fffd||fffd||fffd||cbd41|v
    Dim vRecord As Long         '|fffd|u|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||311||38f||6c3||fffd||fffd|R|fffd|[|fffd|h|fffd||50d||fffd|
    
    '(2019/10/15)|fffd||1c9||fffd|
    Const vPW As String = "tys" '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p
    
    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False

    '(2019/10/07)|fffd||1c9||fffd|
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    ActiveSheet.Unprotect Password:=vPW

    '(2019/10/08)|fffd||1c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        .Columns.Hidden = False
        .Rows.Hidden = False
        '(2019/11/13)|fffd||1c9||fffd|
        If .AutoFilterMode = True Then .AutoFilterMode = False
        '(2019/11/14)|fffd||1c9||fffd|
        .Rows("2:" & Rows.Count).Interior.Color = xlNone
    End With

    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N====================================================

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||30e||64fe|
    Call Get_Column_DR1



    '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        'If .AutoFilterMode = True Then .AutoFilterMode = False
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum + 1))
    End With

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd||294||50d|s|fffd||312||fffd||fffd|o
    Call Extract_Data(vRange)

    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||cbd41|v|fffd||312||fffd||fffd|o
    vJyokyo = Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
    If vJyokyo = "|fffd||fffd||fffd||fffd||fffd|" Then
        vRange.AutoFilter Field:=v.C_Insatu, Criteria1:="<>"
    ElseIf vJyokyo = "|fffd||fffd||fffd||fffd||fffd|" Then
        vRange.AutoFilter Field:=v.C_Insatu, Criteria1:="="
    End If

    '|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd|f|fffd|[|fffd|^|fffd||308||fffd||fffd|========================================================

    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
    Call Count_Row


    ' *** 20180828 start ***
    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||e3c0||fffd|`|fffd|F|fffd|b|fffd|N
    Call Check_Data

    '|fffd||fffd|S-JIS|fffd|\|fffd||fffd||fffd|s|fffd||83|f|fffd|[|fffd|^|fffd||303|`|fffd|F|fffd|b|fffd|N
    Call Check_SJIS

    '|fffd||fffd|B|fffd||fffd||510|F|fffd||30c||fffd||fffd||fffd|
    With Application
        .FindFormat.Clear
        .FindFormat.Interior.Color = 255
    End With
    ' *** 20180828 end ***

    '|fffd||fffd||fffd||38f||6cd|s|fffd||312||fffd||fffd|o==============================================================
    
'    '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
'    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
'        If .AutoFilterMode = True Then .AutoFilterMode = False
'        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
'        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
'        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum + 1))
'    End With
'
'    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd||294||50d|s|fffd||312||fffd||fffd|o
'    Call Extract_Data(vRange)
'
'    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||cbd41|v|fffd||312||fffd||fffd|o
'    vJyokyo = Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
'    If vJyokyo = "|fffd||fffd||fffd||fffd||fffd|" Then
'        vRange.AutoFilter Field:=v.C_Insatu, Criteria1:="<>"
'    ElseIf vJyokyo = "|fffd||fffd||fffd||fffd||fffd|" Then
'        vRange.AutoFilter Field:=v.C_Insatu, Criteria1:="="
'    End If
'
'    '|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd|f|fffd|[|fffd|^|fffd||308||fffd||fffd|========================================================
'
'    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||303|J|fffd|E|fffd||fffd||fffd|g
'    Call Count_Row
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|L|fffd||fffd||a347|
    If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") > 0 Then
        
         ' *** 20180828 start ***
        Set vCell = vRange.Find(What:="", LookIn:=xlValues, _
        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
        MatchByte:=False, SearchFormat:=True)

        If Not vCell Is Nothing Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
           
            Application.ScreenUpdating = True
            Set vRange = Nothing
            With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
                If .AutoFilterMode = True Then .AutoFilterMode = False
                Application.GoTo Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Range("A1"), Scroll:=True
            End With
            
            '(2019/11/11)|fffd||1c9||fffd|
            '|fffd||fffd||82||142||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||352||294||50d||fffd||fffd||682||fffd||510|F|fffd|\|fffd||fffd|
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Cells(vRK, v.C_Tuban).Interior.Color = 255
            
            Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
            Exit Sub
        End If
         ' *** 20180828 End ***
        
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||30a|m|fffd|F
        vCount = Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|")
        vMsg = vCount & "|fffd|@|fffd||fffd||fffd||312||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
        vMsg = vMsg & Chr(13) & Chr(13) & "|fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H"
        vAns = MsgBox(vMsg, vbQuestion + vbYesNo, "|fffd|w|fffd||fffd|")
        If vAns = vbYes Then
        
            ''|fffd||fffd||fffd||fffd||fffd|o|fffd|s|fffd||301|u|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
            Call Output_Date(v.C_Insatu)
        
            '|fffd||fffd||fffd|u|fffd|{|fffd||fffd|/|fffd|e|fffd|X|fffd|g|fffd|v|fffd||30e||64fe|
            Sheets("|fffd||fffd||fffd|[|fffd|\|fffd||fffd|").Activate
            With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
                            
                '|fffd||fffd||fffd|s|fffd||315||3c9||fffd|
                vRB_Extract = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
                For vR = vRK + 1 To vRB_Extract
                    If .Rows(vR).Hidden = False And .Cells(vR, v.C_Tuban) <> "" Then
                        
                        '|fffd||fffd||fffd||fffd||fffd|[|fffd|f|fffd|[|fffd|^|fffd||30d|X|fffd|V
                        vRecord = .Cells(vR, v.C_Tuban)
                        ActiveSheet.Range("|fffd||38f||6c3||fffd||fffd|R|fffd|[|fffd|h") = vRecord
                        ActiveSheet.Calculate
                        '|fffd||fffd||fffd||fffd||fffd|[|fffd||308||fffd||fffd|
                        '(2019/10/16)|fffd||1c9||fffd|
                        On Error Resume Next
                        ActiveSheet.PrintOut
                    End If
                Next
    
            End With
        
            '|fffd||fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
            Call Print_Out_Log
            
            '|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30d||c42c|
            vMsg = "|fffd|w|fffd||fffd||fffd||fffd||fffd||fffd||24d||fffd||fffd|v|fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||301|A|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            vMsg = vMsg & Chr(13) & Chr(13)
            vMsg = vMsg & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd||341|A" & vCount & "|fffd|@|fffd||fffd||fffd||142||fffd||fffd|"
        End If

    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||c42c|
    ElseIf Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Range("|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|") = 0 Then
        vMsg = "|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd| "
        vAns = vbYes
    End If
    
    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|==================================================================

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||312||fffd||fffd|o|fffd||fffd||502||309||fffd||fffd||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        If .AutoFilterMode = True Then .AutoFilterMode = False
        Application.GoTo Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Range("A1"), Scroll:=True
    End With
    
    '(2019/10/07)|fffd||1c9||fffd|
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    ActiveSheet.Protect Password:=vPW, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingRows:=True, AllowDeletingRows:= _
        True, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:= _
        True
    ActiveSheet.EnableSelection = xlNoRestrictions
    
    '|fffd||fffd||fffd||33c8||fffd||fffd|
    Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
    Application.ScreenUpdating = True
    Set vRange = Nothing
    
    '|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||315|\|fffd||fffd|
    If vAns = vbYes Then
        MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
    End If
    
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Print_Out_Log()

    Dim vFile_Name As String    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile_Num As Integer    '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd|
    Dim vData As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    Dim vRenban_T As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||310||64ea||fffd||50d||fffd|
    Dim vRenban_B As Variant    '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v|fffd||316||fffd||fffd||fffd||fffd||50d||fffd|
    Dim vJyokyo  As String      '|fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||301|u|fffd||fffd||fffd||fffd||cbd41|v
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|I|fffd|[|fffd|v|fffd||fffd|(|fffd||1c9||fffd||fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    vFile_Num = FreeFile
    vFile_Name = Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
    Open vFile_Name For Append As #vFile_Num

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||64fe|
    With Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g")
        vRenban_T = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||64ea|")
        vRenban_B = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||294||fffd|_|fffd||fffd||fffd||fffd|")
        vJyokyo = .Range("|fffd|o|fffd||34f||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|")
    End With
        
    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    vData = vData & "|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||294||501||fffd|" & vRenban_T & "|fffd|`" & vRenban_B
    vData = vData & "|fffd|C|fffd||fffd||fffd||fffd||cbd41||fffd|" & vJyokyo
    Print #vFile_Num, vData

    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    Close #vFile_Num
End Sub

Attribute VB_Name = "F_Check"
Option Explicit

'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|f|fffd|[|fffd|^|fffd|W|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Check_Data() As Long

    Dim vR As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|s
    Dim vC As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Dim vRK As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vData As Variant    '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^
    '(2019/10/04)|fffd||1c9||fffd|
    Dim vChk0 As Variant    '|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd||696||fffd||fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|l

    Dim vChk1 As Variant    '|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd|K|fffd|{|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|l
    Dim vChk2 As Variant    '|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd||fffd||fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|l
    Dim vChk3 As Variant    '|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd||fffd||fffd||fffd|1|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|l
    Dim vChk4 As Variant    '|fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||fffd||fffd||fffd||fffd||fffd|2|fffd|v|fffd|`|fffd|F|fffd|b|fffd|N|fffd|l
    Dim i As Long           '|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    Dim vLenData As Long    '|fffd|f|fffd|[|fffd|^|fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim vLenUcode As Long   '|fffd|f|fffd|[|fffd|^|fffd||303||fffd||fffd|j|fffd|R|fffd|[|fffd|h|fffd||3ca||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
    '(2019/10/04)|fffd||1c9||fffd|
    Dim vProcID As Long        '|fffd||8471||fffd||fffd|ID|fffd||303|t|fffd||fffd||fffd|O 0:|fffd||fffd||fffd||fffd||fffd|l|fffd|A1:|fffd|V|fffd|K|fffd||fffd||fffd|A2:|fffd|C|fffd||fffd||fffd||fffd||fffd|A3:|fffd||d3dc||fffd||fffd|
    Dim vDate As String
    
    '(2019/10/16)|fffd||1c9||fffd|
    Dim vTYear As String    '|fffd||292|m|fffd|N|fffd||fffd||fffd||fffd||fffd||314|N
    
    '(2019/10/18)|fffd||1c9||fffd|
    Dim vSakiCodeExist As Boolean '|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317|L|fffd||fffd||fffd|t|fffd||fffd||fffd|O
    'Dim vMotoCodeExist As Boolean '|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317|L|fffd||fffd||fffd|t|fffd||fffd||fffd|O
    
    '(2019/11/07)|fffd||1c9||fffd|
    Dim bNum As Boolean     '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
    
    '(2019/11/11)|fffd||1c9||fffd|
    Dim vCount As Variant
    Dim vRange As Range
    
    Dim vCell As Range
    
    '(2019/11/12)|fffd||1c9||fffd|
    '|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|Q|fffd||190||752||8068||fffd||a5d7||fffd||fffd||fffd|uMicrosoft VBScript Regular Expressions 5.5|fffd|v|fffd||fffd|I|fffd||fffd|
    'Dim re As RegExp
    
    '|fffd||fffd||fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||64fe|
    Call Get_Column_Sagyo

    '(2019/10/09)|fffd||1c9||fffd|
    Call Get_Column_Kanri

    '(2019/10/17)|fffd||1c9||fffd|
    '|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||18e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||315|R|fffd|t|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||255|K|fffd|v
    Call Get_Column_DR2

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||197||fffd||315||3c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||303|Z|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
        '.Cells.Interior.Color = xlNone
        '(2019/10/18)|fffd||1c9||fffd|
        '.Rows("2:" & Rows.Count).Interior.Color = xlNone
        
        '(2019/11/14)|fffd||1c9||fffd|
        '|fffd|t|fffd|B|fffd||fffd||fffd|^|fffd|[|fffd||348||342||143|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        Application.EnableEvents = False
        .Cells(.Range("|fffd||fffd||fffd||68d|s").Row, v.C_Tuban) = ""
        vRK = .Cells(.Range("|fffd||fffd||fffd||68d|s").Row, v.C_Tuban).End(xlDown).Row - 1
        If vRK < 1 Then vRK = 1
        .Cells(.Range("|fffd||fffd||fffd||68d|s").Row, v.C_Tuban) = "|fffd||294||fffd|"
        Application.EnableEvents = True
        
        'vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        
        '(2019/11/11)|fffd||1c9||fffd|
        '|fffd||294||502||303|Z|fffd||fffd||fffd|w|fffd|i|fffd||fffd||fffd||fffd||fffd|F|fffd||243||fffd||fffd|Z|fffd|b|fffd|g
        '.Cells(vRK, 2).Interior.Color = 65535   '|fffd||fffd||fffd|F
        .Cells(.Range("|fffd||fffd||fffd||68d|s").Row, v.C_Tuban).Interior.Color = 65535   '|fffd||fffd||fffd|F
        
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        For vR = vRK + 1 To vRB
              
            ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p Start ***
            '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||682||313|h|fffd||fffd||82||502||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
            Range(Cells(vR, 1), Cells(vR, v.C_KaisoNum)).Interior.Color = xlNone
            ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p end ***
            
            '(2019/10/04)|fffd||1c9||fffd|
            vProcID = 0
            '(2019/10/18)|fffd||1c9||fffd|
            vSakiCodeExist = False
            'vMotoCodeExist = False
            
            '(2019/11/07)|fffd||1c9||fffd|
            vTYear = ""
            
            For vC = v.C_ProcID To v.C_KaisoNum
                    
                '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||64fe|
                vData = .Cells(vR, vC)
                
                '(2019/11/07)|fffd||1c9||fffd|
                bNum = False
                
                '|fffd||fffd||fffd|u|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|l|fffd||30e||64fe|
                With Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_")
                    '(2019/10/04)|fffd||1c9||fffd|
                    vChk0 = .Cells(vC - .Range("|fffd||fffd||fffd||68d|s").Row - 1, v.C_Komokumei) '|fffd||fffd||fffd||696||fffd|
                    
                    vChk1 = .Cells(vC - .Range("|fffd||fffd||fffd||68d|s").Row - 1, v.C_Hissu)     '|fffd|K|fffd|{
                    vChk2 = .Cells(vC - .Range("|fffd||fffd||fffd||68d|s").Row - 1, v.C_Zokuse)    '|fffd||fffd||fffd||fffd|
                    vChk3 = .Cells(vC - .Range("|fffd||fffd||fffd||68d|s").Row - 1, v.C_Mojisu1)   '|fffd||fffd||fffd||fffd||fffd||fffd|1
                    vChk4 = .Cells(vC - .Range("|fffd||fffd||fffd||68d|s").Row - 1, v.C_Mojisu2)   '|fffd||fffd||fffd||fffd||fffd||fffd|2
                End With
                
                '|fffd||fffd||fffd|K|fffd|{|fffd|u|fffd||fffd||fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N
                If vChk1 = "|fffd||fffd|" And vData = "" Then
                    .Cells(vR, v.C_Tuban).Interior.Color = 255   '|fffd||510|F
                    '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    'GoTo Jump
                    '(2019/10/04)|fffd||1c9||fffd|
                    .Cells(vR, vC).Interior.Color = 255
                
                '|fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                ElseIf IsEmpty(vData) Then
                
                    '(2019/10/04)|fffd||1c9||fffd|
                    '|fffd|u|fffd||8471|ID|fffd|v|fffd||fffd||fffd|h|fffd|C|fffd||fffd||fffd||fffd||fffd|h|fffd||30f||a347||fffd|A|fffd|u|fffd|C|fffd||fffd||fffd||50501|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||183|G|fffd||fffd||fffd|[
                    If vChk0 = "|fffd|C|fffd||fffd||fffd||fffd|" Then
                        If vProcID = 2 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    End If
                
                    '(2019/10/04)|fffd||1c9||fffd|
                    '|fffd|u|fffd||8471|ID|fffd|v|fffd||fffd||fffd|h|fffd|C|fffd||fffd||fffd||fffd||fffd|h|fffd||702||fffd||fffd||341|h|fffd||d3dc||fffd||fffd||fffd|h|fffd||30f||a347||fffd|A|fffd|u|fffd||fffd||fffd|l|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||183|G|fffd||fffd||fffd|[
                    If vChk0 = "|fffd||fffd||fffd|l" Then
                        If vProcID = 2 Or vProcID = 3 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd|p|fffd|J|fffd||fffd||fffd|}|fffd|A|fffd||fffd||fffd|s|fffd|`|fffd|F|fffd|b|fffd|N
                ElseIf InStr(vData, ",") <> 0 Or InStr(vData, vbCr) <> 0 Or InStr(vData, vbLf) <> 0 Or InStr(vData, vbCrLf) > 0 Then
                    .Cells(vR, v.C_Tuban).Interior.Color = 255
                    '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    'GoTo Jump
                    '(2019/10/04)|fffd||1c9||fffd|
                    .Cells(vR, vC).Interior.Color = 255
                
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|S|fffd|p|fffd||fffd||fffd|p|fffd|v|fffd||30d||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N========================================
                ElseIf vChk2 = "|fffd|S|fffd|p|fffd||fffd||fffd|p" Then
                    vLenData = Len(vData)                               '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||315||fffd||fffd||fffd||fffd||fffd|
                    vLenUcode = LenB(StrConv(vData, vbFromUnicode))     '|fffd||fffd||fffd|j|fffd|R|fffd|[|fffd|h|fffd||3ca||fffd||fffd|f|fffd|[|fffd|^|fffd||303|o|fffd|C|fffd|g|fffd||fffd|
                    
                    '|fffd||fffd||fffd|S|fffd|p|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    If vLenData * 2 = vLenUcode Then
                        If Len(vData) > vChk3 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    
                    '|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf vLenData = vLenUcode Then
                        If Len(vData) > vChk4 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    
                    '|fffd||fffd||fffd|S|fffd|p|fffd||194||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||742||30f||a347||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    Else
                        If Len(vData) > vChk3 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|S|fffd|p|fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N================================================
                ElseIf vChk2 = "|fffd|S|fffd|p" Then
                    vLenData = Len(vData)                              '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||315||fffd||fffd||fffd||fffd||fffd|
                    vLenUcode = LenB(StrConv(vData, vbFromUnicode))    '|fffd||fffd||fffd|j|fffd|R|fffd|[|fffd|h|fffd||3ca||fffd||fffd|f|fffd|[|fffd|^|fffd||303|o|fffd|C|fffd|g|fffd||fffd|
                    
                    '|fffd||fffd||fffd|S|fffd|p|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    If vLenData * 2 = vLenUcode Then
                        If Len(vData) > vChk3 Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        
                        '(2019/10/17)|fffd||1c9||fffd|
                        '|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd|A|fffd||fffd||fffd||30c||fffd|A|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||731f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||251||389||fffd||fffd||fffd||fffd||90a9||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                        ElseIf vChk0 = "|fffd||515d0||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|" Then
                            '|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd||14e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                            Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Hyoji).Find(What:=vData, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
                            '|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347|
                            If Not vCell Is Nothing Then
                                '|fffd|c|fffd||311||fffd||fffd||fffd|=1|fffd||30f||a347||fffd||34e|d|fffd|l|fffd||fffd|A|fffd|g|fffd|p|fffd|s|fffd||82||302||fffd||fffd||7c1|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd|
                                If Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Cells(vCell.Row, v.C_Dantai) = 1 Then
                                    .Cells(vR, v.C_Tuban).Interior.Color = 255
                                    .Cells(vR, vC).Interior.Color = 255
                                Else
                                    '|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||743|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||390||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
                                    If vSakiCodeExist Then
                                        Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Code).Find(What:=Cells(vR, v.C_I), LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
                                        If Not vCell Is Nothing Then
                                            '|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|Y|fffd||fffd||fffd||30e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|AvData|fffd||191||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                                            If vData <> Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Cells(vCell.Row, v.C_Hyoji) Then
                                                .Cells(vR, v.C_Tuban).Interior.Color = 255
                                                .Cells(vR, vC).Interior.Color = 255
                                            End If
                                        Else
                                        '|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||142||342||202||fffd||fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd||142||343|G|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd||202||fffd|
                                        End If
                                    End If
                                End If
                            '|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|
                            Else
                                .Cells(vR, v.C_Tuban).Interior.Color = 255
                                .Cells(vR, vC).Interior.Color = 255
                            End If
                        
                        '(2019/10/21)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        '|fffd||515cc||fffd||fffd||310||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||342||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|
                        'ElseIf vChk0 = "|fffd||515cc||fffd||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|" & vbLf & "|fffd||702||fffd||fffd||fffd| |fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd|m|fffd||fffd|" Then
                            '|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd||14e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                            'Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Hyoji).Find(What:=vData, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
                            'If Not vCell Is Nothing Then
                                ''|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||743|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||390||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
                                'If vMotoCodeExist Then
                                '    Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Code).Find(What:=Cells(vR, v.C_N), LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
                                '    If Not vCell Is Nothing Then
                                '        '|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|Y|fffd||fffd||fffd||30e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|AvData|fffd||191||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                                '        If vData <> Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Cells(vCell.Row, v.C_Hyoji) Then
                                '            .Cells(vR, v.C_Tuban).Interior.Color = 255
                                '            .Cells(vR, vC).Interior.Color = 255
                                '        End If
                                '    Else
                                '    End If
                                'End If
                            '|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347|
                            'Else
                            '    .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '    .Cells(vR, vC).Interior.Color = 255
                            'End If
                        End If
                    '|fffd||fffd||fffd|S|fffd|p|fffd||fffd||fffd||fffd||fffd||142||202||fffd||fffd||a347|
                    Else
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd|S|fffd|p|fffd|J|fffd|i|fffd||303|`|fffd|F|fffd|b|fffd|N=============================================
                ElseIf vChk2 = "|fffd|S|fffd|p|fffd|J|fffd|i" Then
                    
                    '|fffd||fffd||fffd|S|fffd|p|fffd|J|fffd|i|fffd||142||202||fffd||fffd||a347|
                    For i = 1 To Len(vData)
                        If Not Mid(vData, i, 1) Like "[|fffd|@-|fffd|[|fffd|O-|fffd|X|fffd|||fffd|@]" Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    Next
                        
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    If Len(vData) > vChk3 Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|l|fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N===============================================
                ElseIf vChk2 = "|fffd||fffd||fffd|l" Then
                    '(2019/10/08)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    '|fffd||fffd||fffd||fffd||fffd|l|fffd||142||202||fffd||fffd||a347|
                    'If IsNumeric(vData) = False Then
                    '    .Cells(vR, v.C_Tuban).Interior.Color = 255
                    '    '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    '    'GoTo Jump
                    '    '(2019/10/04)|fffd||1c9||fffd|
                    '    .Cells(vR, vC).Interior.Color = 255

                    '(2019/11/07)|fffd||1c9||fffd|
                    bNum = True
                    
                    '(2019/11/12)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    '(2019/10/08)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    For i = 1 To Len(vData)
                        If Not Mid(vData, i, 1) Like "[0-9]" Then
                            bNum = False
                            '.Cells(vR, v.C_Tuban).Interior.Color = 255
                            '.Cells(vR, vC).Interior.Color = 255
                            Exit For
                        End If
                    Next

'                    '(2019/11/12)|fffd||1c9||fffd|
'                    Set re = New RegExp
'                    re.Pattern = "[0-9]{" + CStr(Len(vData)) + "}"
'                    If Not re.Test(vData) Then
'                        bNum = False
'                    End If
                    
                    '(2019/11/07)|fffd||1c9||fffd|
                    If Not bNum = True Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        .Cells(vR, vC).Interior.Color = 255
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf Len(vData) <> vChk3 Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                        
                    '|fffd||fffd||fffd||fffd||fffd|p|fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf Len(vData) <> LenB(StrConv(vData, vbFromUnicode)) Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    'End If
                    
                    '(2019/10/18)|fffd||1c9||fffd|
                    '|fffd||8471||fffd||fffd|ID|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||30f||a347||fffd||24f|C|fffd||fffd||fffd||50502||313||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[
                    ElseIf vChk0 = "|fffd|C|fffd||fffd||fffd||fffd|" Then
                        '(2019/11/11)|fffd|C|fffd||fffd|
                        If vProcID = 2 Then
                            '|fffd|C|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||24f|C|fffd||fffd||fffd||50502||fffd|0|fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||183|G|fffd||fffd||fffd|[
                            If vData = 0 Then
                                .Cells(vR, v.C_Tuban).Interior.Color = 255
                                .Cells(vR, vC).Interior.Color = 255
                            End If
                            '(2019/11/15)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
'                        ElseIf vProcID = 1 Or vProcID = 3 Then
'                            If vData = 0 Then
'                            Else
'                                .Cells(vR, v.C_Tuban).Interior.Color = 255
'                                .Cells(vR, vC).Interior.Color = 255
'                            End If
                        Else
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    '(2019/10/09)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                    ElseIf vChk0 = "|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h" Then
                        Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Code).Find(What:=vData, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        
                        If Not vCell Is Nothing Then
                            '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd|(|fffd|c|fffd||311||fffd||fffd||fffd|=1)|fffd||30f||a347||fffd||341|A|fffd|d|fffd|l|fffd||fffd|g|fffd|p|fffd|s|fffd||82||302||fffd||fffd||7c1|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd|
                            If Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Cells(vCell.Row, v.C_Dantai) = 1 Then
                                .Cells(vR, v.C_Tuban).Interior.Color = 255
                                .Cells(vR, vC).Interior.Color = 255
                            Else
                                '(2019/10/18)|fffd||1c9||fffd|
                                vSakiCodeExist = True
                            End If
                        Else
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    '(2019/10/07)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                    ElseIf vChk0 = "|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h" Then
                        Set vCell = Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Columns(v.C_Code).Find(What:=vData, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
                        If Not vCell Is Nothing Then
                            '(2019/10/18)|fffd||1c9||fffd|
                            '(2019/10/21)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'vMotoCodeExist = True
                        Else
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                        '(2019/10/25)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        '|fffd||fffd||fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||310||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N(1|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||682||302||fffd|)|fffd|ACSV|fffd|o|fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd||302||74e|g|fffd|p
                        'If vR = 2 Then
                        '    Check_Data = vData
                        'End If
                    '(2019/10/08)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||317||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf vChk0 = "|fffd||292|m|fffd|N|fffd||fffd||fffd||fffd|" Or vChk0 = "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd|" Then
                        '"MM/DD/YYYY"|fffd||315||fffd||fffd||fffd||fffd||fffd||255||3ca||fffd||fffd||fffd||fffd||fffd|IsDate|fffd||fffd||fffd|s|fffd||fffd|
                        vDate = Mid(vData, 5, 2) & "/" & Mid(vData, 7, 2) & "/" & Mid(vData, 1, 4)
                        '(2019/10/16)|fffd||1c9||fffd|
                        If vChk0 = "|fffd||292|m|fffd|N|fffd||fffd||fffd||fffd|" Then
                            vTYear = Mid(vData, 1, 4)
                        End If
                        If Not IsDate(vDate) Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    '(2019/10/16)|fffd||1c9||fffd|
                    ElseIf vChk0 = "|fffd|N|fffd||fffd|" Then
                        If vTYear <> vbNullString Then
                            If vData <> vTYear - 1 Then
                                .Cells(vR, v.C_Tuban).Interior.Color = 255
                                .Cells(vR, vC).Interior.Color = 255
                            End If
                        End If
                    '(2019/11/08)|fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'                    |fffd|i|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|j
'                    |fffd||fffd||70f||fffd| |fffd||7d1||652a||fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||217||7c2||152||fffd||7c2||fffd|Z|fffd||fffd||fffd||364||fffd||fffd||fffd||24c|f|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||182||fffd||fffd||fffd|
'                    |fffd|Z|fffd||fffd|
'                    |fffd|P|fffd|P|fffd|\|fffd|i|fffd||fffd||fffd||fffd||fffd|P|fffd|i|fffd|V|fffd|O|fffd|}|fffd|j|fffd|P|fffd|P|fffd|i|fffd|o|fffd||fffd||fffd|~|fffd|p|fffd||fffd||fffd|j|fffd|j|fffd||fffd||fffd|P|fffd|P|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||fffd|j
'                    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|i|fffd||fffd||fffd||fffd||fffd|P|fffd|i|fffd|V|fffd|O|fffd|}|fffd|j|fffd|P|fffd|P|fffd|i|fffd|o|fffd||fffd||fffd|~|fffd|p|fffd||fffd||fffd|j|fffd|j|fffd||fffd||fffd|P|fffd|P|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||8045||fffd|P|fffd||30f||a347||fffd||341|A|fffd|O|fffd||182||fffd||fffd||fffd|B
'                    |fffd|Z|fffd||fffd||fffd||315||fffd||fffd||fffd|
'                    Pn |fffd||90|l|fffd||50d||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||931f||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||30f|\|fffd||a305||fffd||314||50d||fffd||fffd||30d||149||fffd||fffd||282||30c||fffd||fffd||fffd|1|fffd||fffd||fffd||682||182||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd|n|fffd||fffd||fffd||682||310||fffd||fffd||fffd|
'                    |fffd|p|fffd||fffd||fffd|@|fffd|P|fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||302||182||fffd||fffd|@|fffd||fffd||fffd|{|fffd|P|fffd|@|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|P|fffd|P|fffd||302||182||fffd||fffd|@|fffd||fffd||fffd|\|fffd|T
                    
                    '(2019/10/09)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd|`|fffd|F|fffd|b|fffd|N(ALL9|fffd||34b||fffd||fffd|e)
                    ElseIf vChk0 = "|fffd||90|l|fffd||50d||fffd|" And vData <> "999999999999" Then
                        Dim vChkDigit As Long
                        '|fffd||fffd||fffd|11|fffd||fffd||fffd||251||382||fffd||fffd||101|A|fffd||fffd||282||fffd||fffd||fffd|6,5,4,3,2,7,6,5,4,3,2|fffd||fffd||fffd|||fffd||fffd||fffd||fffd|
                        vChkDigit = Mid(vData, 1, 1) * 6 + Mid(vData, 2, 1) * 5 + Mid(vData, 3, 1) * 4 + Mid(vData, 4, 1) * 3 _
                        + Mid(vData, 5, 1) * 2 + Mid(vData, 6, 1) * 7 + Mid(vData, 7, 1) * 6 + Mid(vData, 8, 1) * 5 _
                        + Mid(vData, 9, 1) * 4 + Mid(vData, 10, 1) * 3 + Mid(vData, 11, 1) * 2
                        '|fffd|v|fffd|Z|fffd||fffd||fffd||282||318|a|fffd||fffd|11|fffd||14a||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd|
                        vChkDigit = vChkDigit Mod 11
                        '|fffd|]|fffd||80aa|0|fffd||702||fffd||fffd||fffd|1|fffd||302||182||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd||fffd|0|fffd||182||fffd||fffd||fffd|
                        If vChkDigit = 0 Or vChkDigit = 1 Then
                            vChkDigit = 0
                        Else
                            '|fffd||fffd||fffd||fffd||20a|O|fffd||fffd|11|fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd||182||202||fffd|
                            vChkDigit = 11 - vChkDigit
                        End If
                        
                        '|fffd||90|l|fffd||50d||fffd||fffd||309||fffd||fffd||a305||fffd||195|s|fffd||fffd|v|fffd||202||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd|G|fffd||fffd||fffd|[
                        If vChkDigit <> Mid(vData, 12, 1) Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|l|fffd||fffd||fffd|X|fffd|g|fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N========================================
                ElseIf vChk2 = "|fffd||fffd||fffd|l|fffd||fffd||fffd|X|fffd|g" Then
                     '|fffd||fffd|1|fffd|E2|fffd|E3|fffd||142||202||fffd||fffd||a347|
                    If Not vData Like "[1-3]" Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    End If

                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||8471|ID|fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N========================================
                ElseIf vChk2 = "|fffd||8471|ID" Then
                    
                    '|fffd||fffd|F0502110|fffd|i|fffd|V|fffd|K|fffd|j|fffd|EF0502120|fffd|i|fffd|C|fffd||fffd||fffd|j|fffd|EF0502130|fffd|i|fffd||d3dc||fffd|j|fffd||142||202||fffd||fffd||a347|
                    '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    'If vData = "F0502110" Or vData = "F0502120" Or vData = "F0502130" Then
                    '(2019/10/04)|fffd||1c9||fffd|
                    If vData = "F0502110" Then
                        vProcID = 1
                    ElseIf vData = "F0502120" Then
                        vProcID = 2
                    ElseIf vData = "F0502130" Then
                        vProcID = 3
                    
                    Else
                        '(2019/10/04)|fffd||1c9||fffd|
                        vProcID = 0
                        
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|d|fffd|b|fffd||50d||fffd||fffd|v|fffd||303|`|fffd|F|fffd|b|fffd|N========================================
                ElseIf vChk2 = "|fffd|d|fffd|b|fffd||50d||fffd|" Then
                    
'                    '(2019/11/12)|fffd||1c9||fffd|
'                    Set re = New RegExp
'                    re.Pattern = "[0-9()-]{" + CStr(Len(vData)) + "}"
'                    If Not re.Test(vData) Then
'                        .Cells(vR, v.C_Tuban).Interior.Color = 255
'                        .Cells(vR, vC).Interior.Color = 255
'                    End If
                    
                    '|fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd||fffd||142||202||fffd||fffd||a347|
                    For i = 1 To Len(vData)
                        If Not Mid(vData, i, 1) Like "[0-9()-]" Then
                            .Cells(vR, v.C_Tuban).Interior.Color = 255
                            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                            'GoTo Jump
                            '(2019/10/04)|fffd||1c9||fffd|
                            .Cells(vR, vC).Interior.Color = 255
                        End If
                    Next
                        
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    If Len(vData) > vChk3 Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    End If
                
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|l|fffd||348||341|v|fffd||303|`|fffd|F|fffd|b|fffd|N==========================================
                ElseIf vChk2 = "|fffd||fffd||fffd|l|fffd||348||fffd|" Then
                    
                    '(2019/11/05)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    '|fffd||fffd||fffd||fffd||fffd|l|fffd||142||202||fffd||fffd||a347|
                    'If IsNumeric(vData) = False Then
                    '    .Cells(vR, v.C_Tuban).Interior.Color = 255
                    '    '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                    '    'GoTo Jump
                    '    '(2019/10/04)|fffd||1c9||fffd|
                    '    .Cells(vR, vC).Interior.Color = 255
                    
                    '(2019/11/07)|fffd||1c9||fffd|
                    bNum = True
                    
                    '(2019/11/05)|fffd||1c9||fffd|
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    For i = 1 To Len(vData)
                        If Not Mid(vData, i, 1) Like "[0-9]" Then
                            bNum = False
                            '.Cells(vR, v.C_Tuban).Interior.Color = 255
                            '.Cells(vR, vC).Interior.Color = 255
                            Exit For
                        End If
                    Next
                    
'                    '(2019/11/12)|fffd||1c9||fffd|
'                    Set re = New RegExp
'                    re.Pattern = "[0-9]{" + CStr(Len(vData)) + "}"
'                    If Not re.Test(vData) Then
'                        bNum = False
'                    End If
                    
                    
                    '(2019/11/07)|fffd||1c9||fffd|
                    If Not bNum = True Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        .Cells(vR, vC).Interior.Color = 255
                    
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf Len(vData) > vChk3 Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    
                    '|fffd||fffd||fffd||fffd||fffd|p|fffd|`|fffd|F|fffd|b|fffd|N
                    ElseIf Len(vData) <> LenB(StrConv(vData, vbFromUnicode)) Then
                        .Cells(vR, v.C_Tuban).Interior.Color = 255
                        '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                        'GoTo Jump
                        '(2019/10/04)|fffd||1c9||fffd|
                        .Cells(vR, vC).Interior.Color = 255
                    
                    End If
                End If
                
            Next

            '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||e3c0||fffd||fffd||fffd||30f||a347||fffd||310|F|fffd||fffd||fffd||fffd|===========================================
            '(2019/10/04)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
            '.Cells(vR, v.C_Tuban).Interior.Color = xlNone
Jump:

'    ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p Start ***
'    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||682||fffd||510|F|fffd||242||fffd||fffd||fffd|
'        If vC <= v.C_KaisoNum Then
'            .Cells(vR, vC).Interior.Color = 255
'        End If
'    ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p End ***
        Next
        
        '(2019/11/11)|fffd||1c9||fffd|
        '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
'        If .AutoFilterMode = True Then .AutoFilterMode = False
'        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
'        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
'        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum))
'
'        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
'        vCount = 0
'        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
'        For vR = vRK + 1 To vRB
'            If .Rows(vR).Hidden = False And .Cells(vR, v.C_Tuban) <> "" Then
'                vCount = vCount + 1
'            End If
'        Next
'        '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||a347|
'        If vCount > 0 Then
'            Set vCell = vRange.Find(What:="", LookIn:=xlValues, _
'            LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
'            MatchByte:=False, SearchFormat:=True)
'
'            If Not vCell Is Nothing Then
'                '|fffd||fffd||82||142||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||352||294||50d||fffd||fffd||682||fffd||510|F|fffd|\|fffd||fffd|
'                .Cells(vRK, 2).Interior.Color = 255
'            End If
'        End If
    End With
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F S-JIS|fffd|R|fffd|[|fffd|h|fffd|\|fffd||fffd||fffd|s|fffd||83|f|fffd|[|fffd|^|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|i1|fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||389||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Check_SJIS()

    Dim vR As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|s
    Dim vC As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Dim vRK As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vBefore As String   '|fffd||3ca||fffd||fffd|O|fffd|f|fffd|[|fffd|^
    Dim vAfter As String    '|fffd||3ca||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|iSJIS|fffd|j
     
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||197||fffd||315||3c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        For vR = vRK + 1 To vRB
            For vC = v.C_ProcID To v.C_KaisoNum
                    
                '|fffd||fffd||fffd||3ca||fffd||fffd|O|fffd||195||50a||48c||fffd|(SJIS)|fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
                vBefore = .Cells(vR, vC)
                vAfter = Encode(vBefore, "shift_jis")   'SJIS|fffd||3ca||fffd|
                
                '|fffd||fffd||fffd||3ca||fffd||fffd|O|fffd||195||3ca||fffd||fffd||fffd|(SJIS)|fffd||fffd||fffd|s|fffd||fffd|v|fffd||30f||a347|
                If vBefore <> vAfter Then
'                    ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p Start ***
'                    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||682||fffd||510|F|fffd||242||fffd||fffd||fffd|
'                    .Cells(vR, vC).Interior.Color = 255
'                    ' *** 20180828 |fffd|f|fffd|o|fffd|b|fffd|O|fffd|p End ***
                    .Cells(vR, v.C_Tuban).Interior.Color = 255      '|fffd||510|F
                    Exit For
                End If
            Next
        Next
    End With
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F S-JIS|fffd|R|fffd|[|fffd|h|fffd||3ca||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Encode(ByVal txt As String, ByVal chrset As String) As Variant

    Dim pos As Long
    Dim stm As Object

    '|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||310||752||fffd|
    Set stm = CreateObject("ADODB.Stream")  'Stream|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    pos = 0
    Select Case UCase(chrset)
    Case "UNICODE", "UTF-16"
        pos = 2
    Case "UTF-8"
        pos = 3
    End Select

    '|fffd||fffd|SJIS|fffd||3ca||fffd|
    With stm
        .Open
        .Type = 2
        .Charset = chrset
        .WriteText txt      'Stream|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||24f|o|fffd||fffd|(|fffd||3ca||fffd|)
        .Position = 0
        .Position = pos
        Encode = .Readtext  'Stream|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||fffd||64fe|
        .Close
    End With

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||d3dc|
    Set stm = Nothing
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||643|`|fffd|F|fffd|b|fffd|N
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Function Check_Def()

    Dim vR As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd|s
    Dim vC As Long          '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Dim vRK As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vData1 As Variant   '|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^
    Dim vData2 As Long      '|fffd|u|fffd||fffd||fffd||654||fffd|r|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||294||501|v
    Dim vData3 As Variant   '|fffd|u|fffd||fffd||fffd||654||fffd|r|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||197||fffd||315||3c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        For vR = vRK + 1 To vRB
            For vC = v.C_ProcID To v.C_KaisoNum
                    
                '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||30e||64fe|
                vData1 = .Cells(vR, vC)
                With Sheets("|fffd||fffd||fffd||654||fffd|r")
                    vData2 = .Cells(vR, v.C_Tuban)
                    vData3 = .Cells(vR, vC)
                End With
            
                '|fffd||fffd||fffd|F|fffd||30f||fffd||fffd||fffd|/|fffd||fffd||fffd|F
                If vData1 = vData3 And vData2 <> 0 Then
                    .Cells(vR, "A").Interior.Color = xlNone     '|fffd||fffd||fffd|F
                ElseIf vData1 <> vData3 And vData2 <> 0 Then
                    .Cells(vR, "A").Interior.Color = 65280      '|fffd||390|F
                    Sheets("|fffd||fffd||fffd||654||fffd|r").Cells(vR, vC).Value = vData1
                    Exit For
                End If
            Next
        Next
    End With
End Function


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************

Sub Data_check()

    Dim vR As Long          '|fffd||fffd||fffd||fffd||fffd|s
    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd||fffd||fffd||fffd||fffd|s
    Dim vRange As Range     '|fffd|f|fffd|[|fffd|^|fffd||348||fffd|
    Dim vCell As Range      '|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
    Dim vBook_sys As Object '|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
    Dim vCount As Long      '|fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    Dim vMsg As String      '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W

    '(2019/10/15)|fffd||1c9||fffd|
    'Const vPW As String = "tys" '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p

    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    Set vBook_sys = ActiveWorkbook
        
    '(2019/10/07)|fffd||1c9||fffd|
    'Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    'ActiveSheet.Unprotect Password:=vPW
    '(2019/10/17)|fffd||1c9||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        .Columns.Hidden = False
        .Rows.Hidden = False
        '(2019/11/13)|fffd||1c9||fffd|
        If .AutoFilterMode = True Then .AutoFilterMode = False
    End With
    
    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N====================================================

    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||30e||64fe|
    Call Get_Column_DR1

    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||e3c0||fffd|`|fffd|F|fffd|b|fffd|N
    Call Check_Data

    '|fffd||fffd|S-JIS|fffd|\|fffd||fffd||fffd|s|fffd||83|f|fffd|[|fffd|^|fffd||303|`|fffd|F|fffd|b|fffd|N
    Call Check_SJIS

    '|fffd||fffd|B|fffd||fffd||510|F|fffd||30c||fffd||fffd||fffd|
    With Application
        .FindFormat.Clear
        .FindFormat.Interior.Color = 255
    End With

    '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|o====================================================================
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd||348||342||310||752||fffd|
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        If .AutoFilterMode = True Then .AutoFilterMode = False
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        Set vRange = .Range(.Cells(vRK, "A"), .Cells(vRB, v.C_KaisoNum))
    End With

    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        vRB = .Cells(.Rows.Count, v.C_Tuban).End(xlUp).Row
        vCount = 0
        vRK = .Range("|fffd||fffd||fffd||68d|s").Row
        For vR = vRK + 1 To vRB
            If .Rows(vR).Hidden = False And .Cells(vR, v.C_Tuban) <> "" Then
                vCount = vCount + 1
            End If
        Next
    End With
    
    '|fffd||fffd||fffd||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|L|fffd||fffd||a347|
    If vCount > 0 Then

        Set vCell = vRange.Find(What:="", LookIn:=xlValues, _
        LookAt:=xlPart, SearchOrder:=xlByRows, MatchCase:=False, _
        MatchByte:=False, SearchFormat:=True)
        
        If Not vCell Is Nothing Then
            'MsgBox "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|f|fffd|[|fffd|^|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
            vMsg = "|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|f|fffd|[|fffd|^|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd|B"
            
            '(2019/11/11)|fffd||1c9||fffd|
            '|fffd||fffd||82||142||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||352||294||50d||fffd||fffd||682||fffd||510|F|fffd|\|fffd||fffd|
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Cells(vRK, v.C_Tuban).Interior.Color = 255
            
            GoTo Jump2
        End If
        
        '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd||a347|
        vMsg = "|fffd|G|fffd||fffd||fffd|[|fffd|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
        
    '|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||c42c|
    ElseIf vCount = 0 Then
        vMsg = "|fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c3|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd| "
    End If
    GoTo Jump2

Jump2:
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||312||fffd||fffd|o|fffd||fffd||502||309||fffd||fffd||fffd|
    vBook_sys.Activate
    With Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h")
        If .AutoFilterMode = True Then .AutoFilterMode = False
        Application.GoTo Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Range("A1"), Scroll:=True
    End With
    
    '(2019/10/07)|fffd||1c9||fffd|
    'Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    'ActiveSheet.Protect Password:=vPW, DrawingObjects:=False, Contents:=True, Scenarios:= _
    '    False, AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    '    AllowInsertingRows:=True, AllowDeletingRows:=True, AllowSorting:=True, _
    '    AllowFiltering:=True, AllowUsingPivotTables:=True
    'ActiveSheet.EnableSelection = xlNoRestrictions

'|fffd||fffd||fffd||33c8||fffd||fffd|
    Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Activate
    Application.ScreenUpdating = True
    Set vBook_sys = Nothing
    Set vRange = Nothing
    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
    
End Sub




Attribute VB_Name = "G_List"
Option Explicit


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||301|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd|f|fffd|[|fffd|^|fffd||30d||c42c|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Sub Make_Sagyo_Sheet()
    
    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCR As Long         '|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||309|E|fffd|[|fffd||fffd|
    Dim vRange As Range     '|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||303|f|fffd|[|fffd|^|fffd||348||fffd|
    Dim vC2 As Long         '|fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    Dim vRB2 As Long        '|fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||316||fffd||fffd||fffd||fffd|s
    Dim vCR2 As Long        '|fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||309|E|fffd|[|fffd||fffd|
    Dim vRange2 As Range    '|fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||303|f|fffd|[|fffd|^|fffd||348||fffd|
    Dim vRegion As String   '|fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||fffd|1|fffd|s|fffd||682||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd|
    Dim vMsg As String      '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W

    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||317||fffd||30e||64fe|
   Call Get_Column_Kanri
    
    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Activate
        
    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||301|u|fffd|c|fffd||311||fffd||fffd||fffd||fffd|F1|fffd|v|fffd||30d|s|fffd||fffd||fffd|o|fffd|i|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||312||fffd||fffd|o|fffd|j
    If ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False
    vRB = Cells(Rows.Count, v.C_Dantai).End(xlUp).Row
    vRK = Range("|fffd||fffd||fffd||68d|s").Row
    vCR = Cells(vRK, Columns.Count).End(xlToLeft).Column
    Set vRange = Range(Cells(vRK, "A"), Cells(vRB, vCR))
    vRange.AutoFilter Field:=v.C_Dantai, Criteria1:=1

    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||312||fffd||fffd|o|fffd|f|fffd|[|fffd|^|fffd|i|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd|j|fffd||301|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||582||315||fffd||fffd||fffd|
    Sheets("|fffd||fffd||183|V|fffd|[|fffd|g").Cells(vRK, "A").CurrentRegion.ClearContents
    Set vRange2 = Range(Cells(vRK + 1, v.C_Hyoji), Cells(vRB, v.C_Hyoji))
    vRange2.Copy
    Sheets("|fffd||fffd||183|V|fffd|[|fffd|g").Range("A1").PasteSpecial _
        Paste:=xlPasteValues, _
        Operation:=xlNone, _
        SkipBlanks:=False, _
        Transpose:=True
    Application.CutCopyMode = False
        
    With Sheets("|fffd||fffd||183|V|fffd|[|fffd|g")
        
        '|fffd||fffd||fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||30e||64fe|
        vCR2 = .Cells(1, .Columns.Count).End(xlToLeft).Column
        For vC2 = 1 To vCR2
            vRegion = .Cells(1, vC2)
            
            '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||282||30b||fffd|s|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||312||fffd||fffd|o
            If ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False
            vRange.AutoFilter Field:=v.C_Dantai, _
                Criteria1:=Array("2", "3", _
                "4", "5"), Operator:=xlFilterValues
            vRange.AutoFilter Field:=v.C_Syuryobi, _
                Criteria1:=99999999
            vRange.AutoFilter Field:=v.C_Region, _
                Criteria1:=vRegion
        
            '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||282||30b||fffd|s|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||301|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||582||315||fffd||fffd||fffd|
            Range(Cells(vRK + 1, v.C_Hyoji), Cells(vRB, v.C_Hyoji)).Copy
            .Cells(2, vC2).PasteSpecial Paste:=xlPasteValues
            Application.CutCopyMode = False
            
            '|fffd||fffd||fffd|u|fffd||fffd||183|V|fffd|[|fffd|g|fffd|v|fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd|Z|fffd||fffd||fffd||348||342||582||316||fffd||fffd|O|fffd||310||752||fffd|
            vRB2 = .Cells(.Rows.Count, vC2).End(xlUp).Row
            ActiveWorkbook.Names.Add Name:=vRegion, _
                RefersToR1C1:="=|fffd||fffd||183|V|fffd|[|fffd|g!R2C" & vC2 & ":R" & vRB2 & "C" & vC2
        Next
    End With
    
    '|fffd||fffd||fffd||33c8||fffd||fffd|
    If ActiveSheet.AutoFilterMode = True Then ActiveSheet.AutoFilterMode = False
    Range("A1").Activate
    Sheets("|fffd||fffd||183|V|fffd|[|fffd|g").Activate
    Range("A1").Activate
    Application.ScreenUpdating = True
    Set vRange = Nothing
    Set vRange2 = Nothing
    
    '|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||315|\|fffd||fffd|
    vMsg = "|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||301|u|fffd|\|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd|A|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||282||250|U|fffd||856a||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    MsgBox vMsg, , "|fffd||fffd||fffd|m|fffd||70b9|"
End Sub
Attribute VB_Name = "Module1"
Attribute VB_Name = "Module2"
Attribute VB_Name = "Module3"
Attribute VB_Name = "Module4"
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|uCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|C|fffd|A|fffd|E|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2019/10/27
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

    '|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||fffd||a347|
    If Target.Locked Then
        '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c2||243|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
        Cancel = True
    End If

End Sub


Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Dim vCell_Target As Range   '|fffd|I|fffd||fffd||fffd|Z|fffd||fffd||fffd||348||342||30f||fffd||fffd||fffd||fffd|Z|fffd||fffd|
Dim vR As Long              '|fffd|l|fffd||3cd|X|fffd|Z|fffd||fffd||fffd||30d|s|fffd||50d||fffd|
Dim vC As Long              '|fffd|l|fffd||3cd|X|fffd|Z|fffd||fffd||fffd||317||fffd||50d||fffd|
Dim vRK As Long             '|fffd||fffd||fffd||68d|s
Dim vRT As Long             '|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||30c||fffd||fffd||fffd||fffd||64ea||fffd|s
Dim vRB As Long             '|fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s
Dim i As Long               '|fffd||294||513||fffd||fffd||342||303|J|fffd|E|fffd||fffd||fffd|^|fffd|[
Dim vNo  As Long            '|fffd||294||fffd|

' *** 20180828 Start ***
Dim vCell As Range          '|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
Dim vRange As Range         '|fffd||fffd||fffd||fffd||fffd||38f||6d4||348||fffd|
Dim vKomoku As String       '|fffd||fffd||fffd||696||fffd|
Dim vData As Variant        '|fffd|l|fffd||3cd|X|fffd|Z|fffd||fffd||fffd||312|l
Dim vRegion As String       '|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd|

'(2019/10/11)|fffd||1c9||fffd|           '|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd|
Dim vLocal As String

Dim vCode As String         '|fffd|c|fffd||303|R|fffd|[|fffd|h
Dim vMsg As String          '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W

Dim vC1 As Long             '|fffd|T|fffd|u|fffd||fffd||fffd|[|fffd|`|fffd||fffd||fffd|F|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||317||fffd||50d||fffd|
Dim vC2 As Long             '|fffd|T|fffd|u|fffd||fffd||fffd|[|fffd|`|fffd||fffd||fffd|F|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317||fffd||50d||fffd|
Dim vC3 As Long             '|fffd|T|fffd|u|fffd||fffd||fffd|[|fffd|`|fffd||fffd||fffd|F|fffd||fffd||fffd|M|fffd||30e|s|fffd||64ac||fffd||fffd||fffd||317||fffd||50d||fffd|

'(2019/10/30)|fffd||1c9||fffd|
Const vPW As String = "tys" '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p

' *** 20180828 end ***

'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F|fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd|X|fffd|V|fffd||fffd||fffd||313||fffd||fffd||34e|x|fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Worksheet_Change(ByVal Target As Range)
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||317||fffd||64fe|
    Call Get_Column_DR1
    
    '|fffd||fffd||fffd|u|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|v|fffd|V|fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd|`|fffd|F|fffd|b|fffd|N|fffd|p|fffd||317||fffd||64fe|
    Call Get_Column_DR2
    
    '|fffd||fffd||fffd|I|fffd||fffd||fffd|Z|fffd||fffd||fffd||348||353||fffd||fffd||30f||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||315||3c9||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||311||389||fffd||fffd|j
    For Each vCell_Target In Target
                
        If vCell_Target.Locked = True Then
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Unprotect Password:=vPW
            vCell_Target.Locked = False
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").Protect Password:=vPW, DrawingObjects:=False, Contents:=True, Scenarios:= _
                False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
                AllowFormattingRows:=True, AllowInsertingRows:=True, AllowDeletingRows:= _
                True, AllowSorting:=True, AllowFiltering:=True, AllowUsingPivotTables:= _
                True
            Sheets("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|R|fffd|[|fffd|h").EnableSelection = xlNoRestrictions
        End If
        '|fffd||fffd||fffd||fffd||348||342||314||fffd||fffd||fffd|(|fffd|s|fffd|P|fffd||283|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||512|Z|fffd|k)
        vC = Target.Column
        If vC = v.C_Tuban Or (vC >= v.C_ProcID And vC <= v.C_KaisoNum) Then
                                
            '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
            Application.ScreenUpdating = False
            Application.Calculation = xlCalculationManual
           
            '|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||3cd|X|fffd|Z|fffd||fffd||fffd|l|fffd||30e||64fe|
            vR = vCell_Target.Row
            vC = vCell_Target.Column
            vData = vCell_Target.Value
            vRK = Range("|fffd||fffd||fffd||68d|s").Row
            vKomoku = Cells(vRK, vC)
           
            '|fffd||fffd||fffd|r|fffd||fffd||fffd|E|fffd||294||510|F|fffd|E|fffd|f|fffd|[|fffd|^|fffd||30f||fffd||fffd||fffd|
            If Cells(vR, v.C_Tuban) = "" And vC = v.C_Tuban Then
              '  With Range(Cells(vR, "A"), Cells(vR, v.C_KaisoNum))
              '
              '      '|fffd||fffd||fffd|r|fffd||fffd||fffd||30f||fffd||fffd||fffd|
              '      If vR - 1 <> vRK Then
              '          .Borders(xlEdgeTop).LineStyle = xlNone
              '      End If
              '      .Borders(xlEdgeBottom).LineStyle = xlNone
              '      .Borders(xlEdgeLeft).LineStyle = xlNone
              '      .Borders(xlEdgeRight).LineStyle = xlNone
              '      .Borders(xlInsideVertical).LineStyle = xlNone
              '      .Borders(xlInsideHorizontal).LineStyle = xlNone
              '
              '      '|fffd||fffd|A|fffd|`B|fffd||fffd|F|fffd||183|f|fffd|[|fffd|^|fffd||30f||fffd||fffd||fffd|
              '      .Interior.ColorIndex = xlNone
              '      Application.EnableEvents = False
              '      .ClearContents
              '      Application.EnableEvents = True
              '  End With

            '|fffd||fffd||fffd||294||513||fffd||fffd||342||18c|r|fffd||fffd||fffd|`|fffd||fffd|
            ElseIf Cells(vR, v.C_Tuban) = "" And vData <> "" Then
        
                '|fffd||fffd||fffd||294||502||313||fffd||fffd||fffd|
                Application.EnableEvents = False
                    Cells(vR, v.C_Tuban) = vR - 1
                Application.EnableEvents = True
        
                '|fffd||fffd||fffd|r|fffd||fffd||fffd||315|`|fffd||fffd|
                Range(Cells(vR, v.C_Tuban), Cells(vR, v.C_KaisoNum)).Borders.LineStyle = xlContinuous
            End If
    
            ' *** 20180828 Start ***
            '|fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347|================================================
            
            '|fffd||fffd|K|fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||30f||fffd||fffd||fffd|
            If vKomoku = "|fffd||515d0||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|" And vData <> "" Then
                vC1 = v.C_J   'J|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||317||fffd||50d||fffd|
                vC2 = v.C_I   'I|fffd||fffd|F|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317||fffd||50d||fffd|
                vC3 = v.C_K   'K|fffd||fffd|F|fffd||515d0||fffd|c|fffd||310||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd||fffd||317||fffd||fffd|
                
                '|fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||191||fffd||fffd|M|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
                Call Get_Code
            
'            ' |fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347|==========================================
'
'            '|fffd||fffd|K|fffd||fffd|l|fffd||fffd||fffd||3cd|X|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||fffd|I|fffd||fffd|l|fffd||30f||fffd||fffd||fffd|
'            ElseIf vKomoku = "|fffd||515d0||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd|" Then
'                Cells(vR, v.C_I).ClearContents

            ' *** 20180828 end ***
            
            '(2019/10/11)
            ElseIf vKomoku = "|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd|" And vData <> "" Then
                'K|fffd||42a93||fffd||fffd||34d||3c2||153|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||252|c|fffd||303|R|fffd|[|fffd|h|fffd||30e||fffd||fffd||fffd||fffd||752||fffd||fffd||fffd|s|fffd||fffd|
                vC1 = v.C_J   'J|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||317||fffd||fffd|
                vC2 = v.C_I   'I|fffd||fffd|F|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317||fffd||fffd|
                vC3 = v.C_K   'K|fffd||fffd|F|fffd||515d0||fffd|c|fffd||310||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd||fffd||317||fffd||fffd|
                 '|fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||191||fffd||fffd|M|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
                Call Get_Code
            
            '(2019/10/07)|fffd||1c9||fffd|
            '|fffd||fffd||fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||30f||fffd||fffd||fffd|
            ElseIf vKomoku = "|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h" And vData <> "" Then
                vC1 = v.C_J   'J|fffd||fffd|F|fffd||fffd||fffd||fffd||fffd|p|fffd||515d0||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||317||fffd||fffd|
                vC2 = v.C_I   'I|fffd||fffd|F|fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317||fffd||fffd|
                vC3 = v.C_K   'K|fffd||fffd|F|fffd||515d0||fffd|c|fffd||310||fffd|s|fffd|i|fffd||64ac||fffd||fffd||fffd|j|fffd||fffd||fffd||317||fffd||fffd|
                '|fffd||fffd||fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd||189||515d0||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
                Call Get_Kaiso_Saki
            
            '|fffd||fffd||fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||30f||fffd||fffd||fffd|
            ElseIf vKomoku = "|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h" And vData <> "" Then
                vC2 = v.C_N   'N|fffd||fffd|F|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||317||fffd||fffd|
                '|fffd||fffd||fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
                Call Get_Kaiso_Moto
            
            End If
        End If
    Next

    '|fffd||fffd||fffd||33c8||fffd||fffd|
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
    
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||191||fffd||fffd|M|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||30f|o|fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/08/28
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Get_Code()

    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||30f||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||30e||64fe|
    Call Get_Column_Kanri
            
    With Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g")
    
        '(2019/10/08)|fffd||1c9||fffd|
        '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7ce|s|fffd||64ac||fffd||fffd||fffd||fffd||48f|W|fffd||fffd||fffd||fffd||fffd||a347||fffd||352|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||d3dc|
        Application.EnableEvents = False
        Cells(vR, vC2) = ""
        Application.EnableEvents = True
    
        '|fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd|s|fffd||310||64ea||fffd|s|fffd||30c||fffd||fffd||fffd|
        vRegion = Cells(vR, vC1)
        Set vCell = .Columns(v.C_Region).Find(What:=vRegion, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        If Not vCell Is Nothing Then
            vRT = vCell.Row
            
            '|fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd|s|fffd||316||fffd||fffd||fffd||fffd|s|fffd||30c||fffd||fffd||fffd|
            vRB = .Columns(v.C_Region).Find(What:=vRegion, SearchDirection:=xlPrevious, _
                LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True).Row
        Else
            'MsgBox "|fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
            Application.Calculation = xlCalculationAutomatic
            End
        End If
    
        '|fffd||fffd||fffd||fffd||fffd||fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||142||30e|s|fffd||64ac||fffd||fffd||fffd|s|fffd||30c||fffd||fffd||fffd||fffd|i|fffd|d|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||311||38d||fffd|j
        Set vRange = .Range(.Cells(vRT, v.C_Hyoji), .Cells(vRB, v.C_Hyoji))
        '(2019/10/11)|fffd||1c9||fffd|
        vLocal = Cells(vR, vC3)
        'Set vCell = vRange.Find(What:=vData, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        Set vCell = vRange.Find(What:=vLocal, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        If Not vCell Is Nothing Then
            
            '(2019/10/08)|fffd||1c9||fffd|
            '|fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||30f||a347|
            If vRegion = "" Then
                '(2019/10/21)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
                ''|fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||253|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||a347||fffd|A|fffd|c|fffd||311||fffd||fffd||fffd|=1|fffd||142||fffd||fffd||90b1||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||10e||fffd||fffd||fffd||fffd||752||fffd|
                If .Cells(vCell.Row, v.C_Dantai) = 1 Then
                '    Application.EnableEvents = False
                '    vCode = .Cells(vCell.Row, v.C_Code)
                '    Cells(vR, vC2) = vCode
                '    Application.EnableEvents = True
                
                    '(2019/10/23)|fffd||1c9||fffd|
                    '|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd||255|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90aa||fffd|A|fffd|d|fffd|l|fffd||182||fffd||fffd||114|F|fffd||7c2||102||fffd||fffd||202||fffd||fffd||302||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd|
                    'MsgBox "|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                    MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                    Application.ScreenUpdating = True
                    Application.Calculation = xlCalculationAutomatic
                    End
                Else
                End If
            Else
                '|fffd||fffd||fffd|u|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd|v|fffd||30f|o|fffd||fffd|
                Application.EnableEvents = False
                vCode = .Cells(vCell.Row, v.C_Code)
                Cells(vR, vC2) = vCode
            
                Application.EnableEvents = True
            End If
        
        '|fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        Else
            '|fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||142||202||fffd||fffd||a347|
            If Not vLocal = vbNullString Then
                'MsgBox "|fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                Application.ScreenUpdating = True
                Application.Calculation = xlCalculationAutomatic
                End
            End If
        End If
    End With
End Sub

'(2019/10/07)|fffd||1c9||fffd|
'|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||515d0||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
'|fffd||702||fffd||fffd|A|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|{|fffd||fffd||fffd||18e|s|fffd||64ac||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||24e||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|
Private Sub Get_Kaiso_Saki()

    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||30f||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||30e||64fe|
    Call Get_Column_Kanri
        
    With Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g")
        vCode = Cells(vR, vC2)
        
        '|fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
        Set vCell = .Columns(v.C_Code).Find(What:=vCode, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        
        If Not vCell Is Nothing Then
            'If .Cells(vCell.Row, v.C_Region) <> vbNullString Then
            If .Cells(vCell.Row, v.C_Dantai) <> 1 Then
                Application.EnableEvents = False
                '|fffd||fffd||fffd|Y|fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||30e|s|fffd||64ac||fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||752||fffd|
                Cells(vR, vC3) = .Cells(vCell.Row, v.C_Hyoji)
                '|fffd||fffd||fffd|Y|fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||313|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||752||fffd|
                Cells(vR, vC1) = .Cells(vCell.Row, v.C_Region)
                Application.EnableEvents = True
            Else
                'MsgBox "|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                Application.ScreenUpdating = True
                Application.Calculation = xlCalculationAutomatic
                End
            End If
        Else
            'MsgBox "|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||64ac||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
            Application.Calculation = xlCalculationAutomatic
            End
        End If

    End With
End Sub

'(2019/10/07)|fffd||1c9||fffd|
'|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|
Private Sub Get_Kaiso_Moto()

    '|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||30f||fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||30e||64fe|
    Call Get_Column_Kanri
        
    With Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g")
        vCode = Cells(vR, vC2)
        Set vCell = .Columns(v.C_Code).Find(What:=vCode, LookIn:=xlValues, LookAt:=xlWhole, MatchByte:=True)
        
        If Not vCell Is Nothing Then
            '(2019/10/24)|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g
            '|fffd||515cc||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||353|s|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||313||fffd||fffd||349||82||302||fffd||fffd||fffd|
            'If .Cells(vCell.Row, v.C_Dantai) <> 1 Then
            'Else
                'MsgBox "|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
                'Application.ScreenUpdating = True
                'Application.Calculation = xlCalculationAutomatic
            'End If
        Else
            'MsgBox "|fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd|u|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|c|fffd||303|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
            Application.ScreenUpdating = True
            Application.Calculation = xlCalculationAutomatic
            End
        End If

    End With
End Sub

'(2019/10/15)|fffd||1c9||fffd|
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
    '|fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||fffd||a347|
    If Target.Locked Then
        '|fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c2||243|_|fffd|u|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
        Cancel = True
    End If
End Sub
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Const vPW As String = "tys"


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|u|fffd|b|fffd|N|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Workbook_Open()

    Dim vYear As Variant    '|fffd|N
    Dim vMonth As Variant   '|fffd||fffd|
    Dim vDay As Variant     '|fffd||fffd|
    Dim vToday As String    '|fffd|{|fffd||fffd|
    Dim vRK As Long         '|fffd||fffd||fffd||68d|s
    Dim vRB As Long         '|fffd||fffd||fffd||fffd||fffd|s
    Dim vCR As Long          '|fffd|E|fffd|[|fffd||fffd|
    
    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    
    
    
    '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
    Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Unprotect Password:=vPW
    Sheets("|fffd||fffd||fffd|[|fffd|\|fffd||fffd|").Unprotect Password:=vPW
    Call Ctrl_Q
    
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||301|u|fffd||c42c||fffd|N|fffd||fffd||fffd||fffd||fffd|v|fffd||582||316|{|fffd||fffd||fffd||fffd||fffd|t|fffd||30f|o|fffd||fffd|
    vYear = Year(Date)
    vMonth = Month(Date)
    vDay = Day(Date)
    vToday = vYear & Format(vMonth, "00") & Format(vDay, "00")
    Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
    ActiveSheet.Range("|fffd||c42c||fffd|N|fffd||fffd||fffd||fffd|") = vToday
    
    '|fffd||fffd||fffd||fffd||fffd|O|fffd|p|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||183|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|O|fffd|L|fffd|^
    Call Make_Log_File
    
    '|fffd||fffd||fffd||33c8||fffd||fffd|
    Application.ScreenUpdating = True
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|/|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Sub Ctrl_Q()
Attribute Ctrl_Q.VB_Description = "|fffd||6cc||fffd||310||752||fffd|/|fffd||fffd||fffd||fffd|"
Attribute Ctrl_Q.VB_ProcData.VB_Invoke_Func = "q\n14"
    
    Dim vAns
    
    '(2019/11/11)|fffd||1c9||fffd|
    ActiveWorkbook.Unprotect Password:=vPW
    
    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = False
    
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||6cc||fffd||30f||a347|
    If Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").ProtectContents = False Then

        '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
        Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
        ActiveWindow.DisplayGridlines = False
        ActiveWindow.DisplayHeadings = False
        ActiveSheet.ScrollArea = Range("|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||348||fffd|").Name
        ActiveSheet.Protect UserInterfaceOnly:=True
        ActiveSheet.Protect Password:=vPW
        
        '|fffd||fffd||fffd|u|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|
        Sheets("|fffd||fffd||fffd|[|fffd|\|fffd||fffd|").Activate
        ActiveWindow.DisplayGridlines = False
        ActiveWindow.DisplayHeadings = False
        ActiveSheet.Range("|fffd||fffd||197||fffd|").EntireColumn.Hidden = True
        ActiveSheet.ScrollArea = Range("|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd||348||fffd|").Name
        ActiveSheet.Protect UserInterfaceOnly:=True
        ActiveSheet.Protect Password:=vPW
        
        '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||314||fffd|\|fffd||fffd|
        Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Visible = False
        Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Visible = False
        Sheets("|fffd||fffd||183|V|fffd|[|fffd|g").Visible = False
                
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||6cc||fffd||30f||a347|
    ElseIf Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").ProtectContents = True Then
        
        '|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||fffd|
        vAns = InputBox("|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", "|fffd||fffd||fffd||fffd|")
        If vAns = vPW Then
        
            '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd|v|fffd|V|fffd|[|fffd|g|fffd||314||fffd||6cc||fffd|
            Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
            ActiveSheet.Unprotect Password:=vPW
            ActiveSheet.ScrollArea = ""
            ActiveWindow.DisplayGridlines = True
            ActiveWindow.DisplayHeadings = True
            
            '|fffd||fffd||fffd|u|fffd||fffd||fffd|[|fffd|\|fffd||fffd||fffd|v|fffd|V|fffd|[|fffd|g|fffd||314||fffd||6cc||fffd|
            Sheets("|fffd||fffd||fffd|[|fffd|\|fffd||fffd|").Activate
            ActiveSheet.Unprotect Password:=vPW
            ActiveSheet.ScrollArea = ""
            ActiveSheet.Range("|fffd||fffd||197||fffd|").EntireColumn.Hidden = False
            ActiveWindow.DisplayGridlines = True
            ActiveWindow.DisplayHeadings = True
        
            '|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd|
            Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Visible = True
            Sheets("|fffd||1d7||fffd||fffd|V|fffd|[|fffd|g").Visible = True
            Sheets("|fffd||fffd||183|V|fffd|[|fffd|g").Visible = True
            
        
        '|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||642||202||fffd||a347|
        Else
            MsgBox "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||642||202||fffd||702||fffd||fffd|B", , "|fffd||fffd||fffd|m|fffd||70b9|"
        End If
    End If
    
    '(2019/11/11)|fffd||1c9||fffd|
    ActiveWorkbook.Protect Password:=vPW, Structure:=True, Windows:=False
    
    '|fffd||fffd||fffd||33c8||fffd||fffd|
    Sheets("|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g").Activate
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||303|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||183||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
'|fffd|@FSO|fffd|Q|fffd||190||752||fffd|FMicrosoft Scripting Runtime
Private Sub Make_Log_File()

    Dim fso As New FileSystemObject  ' FileSystemObject
    Dim vFile_Name As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile As TextStream          '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|
    Dim vData As String              '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||310||752||fffd|
    vFile_Name = Format(Now, "YYYYMMDDHHmmss")
    vFile_Name = "KST_TOOL_" & vFile_Name & ".log"
    vFile_Name = ThisWorkbook.Path & "\" & vFile_Name
    Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|") = vFile_Name
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||c42c|(|fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    Set vFile = fso.CreateTextFile( _
        Filename:=vFile_Name, _
        Overwrite:=True)
        
    '|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd|x|fffd||fffd||fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    vFile.WriteLine vData
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    vFile.Close
    Set vFile = Nothing
    Set fso = Nothing
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

    Dim vFile_Name As String    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile_Num As Integer    '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd|
    Dim vData As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|I|fffd|[|fffd|v|fffd||fffd|(|fffd||1c9||fffd||fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    vFile_Num = FreeFile
    vFile_Name = Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
    Open vFile_Name For Append As #vFile_Num

    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd|x|fffd||fffd||fffd|c|fffd|[|fffd||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    Print #vFile_Num, vData

    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    Close #vFile_Num
End Sub


'**************************************************************************************************************
'|fffd|@|fffd|@|fffd|\ |fffd|@      |fffd|F |fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd|[|fffd|Y|fffd||fffd||fffd||303||fffd||fffd|O|fffd|L|fffd|^
'|fffd|@|fffd|V|fffd|K|fffd||c42c||fffd|@|fffd|@ |fffd|F 2018/07/17
'|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@ |fffd|F
'**************************************************************************************************************
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    Dim vFile_Name As String    '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    Dim vFile_Num As Integer    '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd|
    Dim vData As String         '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||582||30f|o|fffd||353||fffd||fffd|e
    
    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|I|fffd|[|fffd|v|fffd||fffd|(|fffd||1c9||fffd||fffd|o|fffd||343||fffd||fffd|[|fffd|h)
    vFile_Num = FreeFile
    vFile_Name = Sheets("|fffd||fffd||183|t|fffd|H|fffd||fffd||fffd|_").Range("|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|")
    Open vFile_Name For Append As #vFile_Num

    '|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||30f|o|fffd||fffd|
    vData = Format(Now, "YYYY/MM/DD HH:mm:ss")
    vData = vData & "|fffd|@|fffd|y|fffd|x|fffd||fffd||fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|z"
    Print #vFile_Num, vData

    '|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|I|fffd||fffd|
    Close #vFile_Num
End Sub


INQUEST-PP=macro
