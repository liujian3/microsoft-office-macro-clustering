Attribute VB_Name = "CheckOnClick"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
' 2014/01/14 |fffd|V|fffd|K|fffd||c42c| v0.50
' |fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd|onClick|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|

'|fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|C|fffd|x|fffd||fffd||fffd|g
Private WithEvents mdlBtnElement As HTMLButtonElement
Attribute mdlBtnElement.VB_VarHelpID = -1

'|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private mdlOnClick As Boolean                                   'True:|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|AFalse|fffd|F|fffd||fffd||fffd||fffd||fffd||202||fffd|

'|fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||250||752||fffd|
Public Property Let setElementOnClick(ByVal btnElement As HTMLButtonElement)
    mdlOnClick = False
    If btnElement Is Nothing Then
        Exit Property
    End If
    '|fffd||fffd||fffd|p|fffd||fffd||fffd||143|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set mdlBtnElement = btnElement
End Property

'|fffd|G|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||502||fffd||50b|p
Public Property Get getElementOnClick() As Boolean
    getElementOnClick = mdlOnClick
End Property

'onClick|fffd|C|fffd|x|fffd||fffd||fffd|g
Private Function mdlBtnElement_onclick() As Boolean
'    Debug.Print "mdlBtnElement_onclick"
    '|fffd|G|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|
    mdlOnClick = True
'    Debug.Print mdlOnClick
End Function

Attribute VB_Name = "DataElement"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'/****************************************************************************
' * DataElement 0.20 BETA 2012.6.20
' ****************************************************************************/
Option Explicit

Private ScreenName As String
Private ElementID As Variant
Private elementType As String
Private val As String
Private useThisElementFlag As Boolean

Public Function getScreenName() As String
    getScreenName = ScreenName
End Function
Public Sub setScreenName(v As String)
    ScreenName = v
End Sub

Public Function getElementID() As String
    getElementID = ElementID
End Function
Public Sub setElementID(v As String)
    ElementID = v
End Sub

Public Function getElementType() As String
    getElementType = elementType
End Function
Public Sub setElementType(v As String)
    elementType = v
End Sub

Public Function useThisElement() As Boolean
    useThisElement = useThisElementFlag
End Function
Public Sub setUseThisElement(v As Boolean)
    useThisElementFlag = v
End Sub

Public Function getValue() As String
    getValue = val
End Function

Public Sub setValue(v As String, Optional trimspace As Boolean)
    If trimspace Then
        val = Trim(v)
    Else
        val = v
    End If
    useThisElementFlag = True
End Sub


Attribute VB_Name = "DataElementFactory"
Option Private Module
Option Explicit


'/*******************************************************
' * CSVUtil|fffd||598|A
' *******************************************************/

'|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||fffd|CSV|fffd||255||3ca||fffd||fffd||fffd||fffd||115||6d1||fffd|
Public Sub saveDataElementsToFile(data() As Variant, filePath As String, Optional ElementDelimiter As String, Optional ElementQuotation As String, Optional WithoutHeader As Boolean)
    startOf "saveDataElementsToFile"
    
    Dim Header() As String
    Dim HeaderForPrint() As String
    Dim DataBody As String
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    '|fffd|N|fffd|I|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||202||fffd||fffd|j
    Dim quot As String
    If Len(ElementQuotation) > 0 Then
        quot = ElementQuotation
    Else
        quot = ""
    End If
    
    '|fffd|w|fffd|b|fffd|_|fffd||10d90||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd|
    If Not WithoutHeader Then
        Log "|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||10d90||fffd||fffd||fffd||fffd||702||fffd|"
        '1|fffd||82||7c2||317|v|fffd|f|fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||10d90||fffd|
        Dim HeaderElements() As DataElement
        HeaderElements = data(0)
        Dim i As Long
        ReDim Header(UBound(HeaderElements))
        ReDim HeaderForPrint(UBound(HeaderElements))
        For i = 0 To UBound(HeaderElements)
            Header(i) = HeaderElements(i).getElementID
            HeaderForPrint(i) = quot & Header(i) & quot
        Next
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd|o|fffd||fffd|
        DataBody = Join(HeaderForPrint, dlmt) & vbCrLf
    Else
        Log "|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||350||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        DataBody = ""
    End If

    '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||310||fffd||fffd||fffd|
    Dim de() As DataElement
    For i = 0 To UBound(data)
        de = data(i)
        DataBody = DataBody & getLineByDataElements(Header, de, dlmt, quot) & vbCrLf
    Next
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||fffd|
    Dim fileNum As Integer
    fileNum = FreeFile()
    Open filePath For Output As #fileNum
        Print #fileNum, DataBody
    Close #fileNum

    endOf "saveDataElementsToFile"
End Sub


'|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||314|z|fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd|s|fffd||315||fffd||fffd||fffd||fffd||fffd|
Private Function getLineByDataElements(CSVHeaders() As String, de() As DataElement, Optional ElementDelimiter As String, Optional ElementQuotation) As String
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    '|fffd|N|fffd|I|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||202||fffd||fffd|j
    Dim quot As String
    If Len(ElementQuotation) > 0 Then
        quot = ElementQuotation
    Else
        quot = ""
    End If
    
    '|fffd|w|fffd|b|fffd|_|fffd|L|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N
    Dim OrderByHeader As Boolean
    If Not isEmptyArray(CSVHeaders) Then
        OrderByHeader = True
    Else
        OrderByHeader = False
    End If
    
    Dim LineString() As String
    Dim i As Long
    
    '|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||255||fffd||fffd||451||582||fffd||fffd||fffd|Value|fffd||fffd|z|fffd||fffd|
    If OrderByHeader Then
        For i = 0 To UBound(CSVHeaders)
            ReDim Preserve LineString(i)
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'            LineString(i) = quot & getValueById(de, CSVHeaders(i)) & quot
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
            LineString(i) = quot & getValueOfDataElementById(de, CSVHeaders(i)) & quot
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
        Next
    '|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|Value|fffd||fffd|z|fffd||fffd|
    Else
        For i = 0 To UBound(de)
            ReDim Preserve LineString(i)
            LineString(i) = quot & de(i).getValue & quot
        Next
    End If
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||14c||fffd||fffd||fffd|
    getLineByDataElements = Join(LineString, dlmt)
End Function


'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||595||3ca||fffd||fffd|iDataElement|fffd|^|fffd|z|fffd||fffd||fffd|1|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||182||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||314|z|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|j
Public Function getDataElementsFromFile(filePath As String, Optional ElementDelimiter As String, Optional CSVHeader As Variant) As Variant()
    startOf "getDataElementsFromFile"

    Dim fileNum As Integer
    fileNum = FreeFile()

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||313||1c2||74d||fffd||fffd||74e||fffd||fffd|s
    Dim Lines() As String
    Dim i As Long
    i = 0
    Open filePath For Input As #fileNum
        Do Until EOF(fileNum)
            ReDim Preserve Lines(i)
            Line Input #fileNum, Lines(i)
            i = i + 1
        Loop
    Close #fileNum
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    'CSVHeader|fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||343|w|fffd|b|fffd|_|fffd||182||fffd||fffd||117|D|fffd||65d8||fffd|p
    Dim CSVHeaders() As String
    Dim DataStartLine As Long
    If Not isEmptyArray(CSVHeader) Then
        CSVHeaders = CSVHeader
        DataStartLine = 0
    Else
        '1|fffd|s|fffd||682||fffd||fffd|w|fffd|b|fffd|_|fffd|s|fffd||182||fffd||fffd||10f||fffd||fffd||fffd|
        CSVHeaders = Split(Lines(0), dlmt)
        DataStartLine = 1
    End If
    
    '|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||582||315||3ca||fffd|
    Dim ret() As Variant

    '|fffd||fffd||fffd||fffd||20c||fffd||343|f|fffd|[|fffd|^|fffd|s|fffd||182||fffd||fffd||10f||fffd||fffd||fffd|
    For i = DataStartLine To UBound(Lines)
        If InStr(Lines(i), dlmt) > 0 Then
            ReDim Preserve ret(i - DataStartLine)
            Dim vals() As String
            vals = Split(Lines(i), dlmt)
            ret(i - DataStartLine) = getDataElementsFromValues(CSVHeaders, vals)
        Else
            Exit For
        End If
    Next
    
    getDataElementsFromFile = ret

    endOf "getDataElementsFromFile"
End Function


'|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||24a||fffd||c2||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|ID/Val|fffd||313||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||255||3ca||fffd||fffd|@|fffd||fffd||fffd|l|fffd||314|z|fffd||52dc1||fffd||fffd|w|fffd|b|fffd|_|fffd||314|z|fffd||52dc2||182||34c||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Function getDataElementsFromValues(CSVHeaders() As String, vals() As String) As DataElement()
    startOf "getDataElementsFromValues"

    Dim de() As New DataElement
    Dim i As Long
    '|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||24a||fffd||c2||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ReDim de(UBound(CSVHeaders))
    For i = 0 To UBound(CSVHeaders)
        de(i).setElementID CSVHeaders(i)
    Next

    '|fffd|l|fffd||316||fffd||fffd||7cd||fffd||fffd||fffd|
    For i = 0 To UBound(CSVHeaders)
        '|fffd|w|fffd|b|fffd|_|fffd|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|l|fffd|z|fffd||52dc8||209||fffd||fffd||302||182||fffd||fffd||342||fffd||fffd||312|l|fffd||fffd||fffd|i|fffd|[
        If i <= UBound(vals) Then
            de(i).setValue vals(i)
        '|fffd|w|fffd|b|fffd|_|fffd|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|l|fffd|z|fffd||52dc2||12d09||7c2||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|l|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||302||14b||d5d8e||fffd||fffd||fffd|
        Else
            de(i).setValue ""
        End If
    Next
    
    getDataElementsFromValues = de
    
    endOf "getDataElementsFromValues"
End Function



'/*******************************************************
' * DataElement|fffd||fffd||fffd||fffd||598|A
' *******************************************************/

'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
Public Function getValueOfDataElementById(ByRef de() As DataElement, Id As String) As String
    startOf "getValueOfDataElementById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        getValueOfDataElementById = ""
    Else
        getValueOfDataElementById = d.getValue
    End If
    endOf "getValueOfDataElementById"
End Function
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X


'ID|fffd|w|fffd||fffd||fffd|DataElement|fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
Public Sub setDataElementById(NewData As DataElement, ByRef de() As DataElement, Id As String)
    startOf "setDataElementById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        Set d = NewData
    End If
    endOf "setDataElementById"
End Sub


'ID|fffd|w|fffd||fffd||152|l|fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'Public Sub setValueById(ByRef Value As String, de() As DataElement, Id As String)
'    startOf "setValueById"
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
Public Sub setValueOfDataElementById(ByRef Value As String, de() As DataElement, Id As String)
    startOf "setValueOfDataElementById"
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
    startOf "setValueById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        Log "Nothing|fffd||142||fffd||fffd||fffd|"
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        d.setValue Value
        Log "Value|fffd||fffd|" & Value & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    End If
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'    endOf "setValueById"
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
    endOf "setValueOfDataElementById"
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
End Sub


'|fffd|l|fffd||fffd||fffd||d5d8e||fffd||fffd||fffd||fffd|DataElement|fffd||fffd|useThisElement|fffd||fffd||fffd||a287||fffd||fffd|True/False|fffd||242||fffd||fffd||fffd|
Public Sub changeUseElements(ByRef de() As DataElement, UseThis As Boolean)
    startOf "changeUseElements"
    Dim d As Variant
    For Each d In de
        d.setUseThisElement UseThis
        Log d.getElementID & "|fffd||fffd|useThisElement|fffd||fffd|" & UseThis & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    Next
    endOf "changeUseElements"
End Sub


'ID|fffd|w|fffd||fffd||fffd|useThisElement|fffd||fffd|False|fffd||242||fffd||fffd||fffd|
Public Sub changeUseElementById(ByRef de() As DataElement, Id As String, UseThis As Boolean)
    startOf "changeUseElementById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        Log "Nothing|fffd||142||fffd||fffd||fffd|"
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        d.setUseThisElement UseThis
        Log "useThisElement|fffd||fffd|" & UseThis & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    End If
    endOf "changeUseElementById"
End Sub


'|fffd||fffd||282||582||303|f|fffd|[|fffd|^|fffd|Z|fffd|b|fffd|g|fffd||117|p
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'Public Sub setDataToScreen(htdoc As HTMLDocument, inElements() As DataElement, targetScreen As String)
'    startOf "setDataToScreen"
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
Public Sub setDataFromDataElementsToScreen(htDoc As HTMLDocument, inElements() As DataElement, targetScreen As String)
    startOf "setDataFromDataElementsToScreen"
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
    
    Log "|fffd|f|fffd|[|fffd|^|fffd|Z|fffd|b|fffd|g|fffd||38f||6c9||fffd||281|F" & targetScreen

    Dim i As Integer
    
    For i = 0 To UBound(inElements)
        If inElements(i).getScreenName = targetScreen And inElements(i).useThisElement Then
            setData htDoc, inElements(i).getElementID, inElements(i).getElementType, inElements(i).getValue
        End If
    Next

'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'    endOf "setDataToScreen"
'|fffd||fffd|2016/12/24 H.U |fffd||d3dc| |fffd||fffd||fffd|O|fffd||3cd|X
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
    endOf "setDataFromDataElementsToScreen"
'|fffd||fffd|2016/12/24 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|O|fffd||3cd|X
End Sub

'ID|fffd||308||fffd|v|fffd||fffd||fffd||fffd||fffd||28d||fffd||fffd||68f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getDataElementById(ByRef de() As DataElement, Id As String, Optional Name As String) As DataElement
    Dim i As Long
    For i = 0 To UBound(de)
        If (Trim(de(i).getElementID) = Trim(Id) And Trim(Id) <> "") Or (Trim(de(i).getElementID) = Trim(Name) And Trim(Name) <> "") Then
            Set getDataElementById = de(i)
            Exit Function
        End If
    Next
    Set getDataElementById = Nothing
End Function



'|fffd|_|fffd||fffd||189||fffd||fffd||282||303|t|fffd||fffd||fffd|[|fffd||fffd||281||fffd|DataElement|fffd|z|fffd||fffd|
Public Function getFreeScreenElements(ie As InternetExplorer) As DataElement()
    startOf "getFreeScreenElements"

    Dim ary() As String
    ary = getFreeScreenArray(ie)
    
    Log "|fffd|t|fffd||fffd||fffd|[|fffd||fffd||282||315||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|F" & UBound(ary)
    Dim i As Long
    Dim temp() As String
    Dim de() As New DataElement
    ReDim de(UBound(ary))
    For i = 0 To UBound(ary)
        temp = Split(ary(i), VAL_DELIMITER)
        '|fffd||fffd||fffd||683|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34d||fffd||fffd||683|R|fffd|[|fffd|h|fffd||fffd||fffd|g|fffd||fffd|
        If Trim(temp(1)) <> "" Then
            de(i).setElementID temp(1)
        ElseIf Trim(temp(0)) <> "" Then
            de(i).setElementID temp(0)
        Else
            de(i).setElementID Trim(Str(i))
        End If
        de(i).setValue temp(2)
    Next
    
    getFreeScreenElements = de
    endOf "getFreeScreenElements"
End Function



Attribute VB_Name = "Define"
Option Explicit
Option Private Module

#If Win64 Then
Public Declare PtrSafe Function MessageBox Lib "user32" Alias "MessageBoxA" (ByVal hWnd As LongPtr, ByVal lpText As String, ByVal lpCaption As String, ByVal wType As Long) As Long
#Else
Public Declare Function MessageBox Lib "user32.dll" Alias "MessageBoxA" (ByVal hWnd As Long, ByVal lpText As String, ByVal lpCaption As String, ByVal wType As Long) As Long
#End If


' /*******************************************
'  *    |fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||202||fffd| |fffd||598|A|fffd||fffd|`
'  *******************************************/

'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||d3dc| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||706b||fffd||fffd||fffd||fffd|
''Version|fffd|p
'Public Const AuthorizationURLBase As String = "http://www.ms1click.com/vstat/"
'
''|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|OURL |fffd|{|fffd||517|p
'Public Const SERVER_LOG_URL_PRO = "http://www.ms1click.com/log/sl.cgi"
''|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|OURL |fffd|e|fffd|X|fffd|g|fffd|p
'Public Const SERVER_LOG_URL_DEV = "http://www.ms1click.com/log/sl_test.cgi"
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||d3dc| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||141||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||706b||fffd||fffd||fffd||fffd|
'Version|fffd|p
Public Const AuthorizationURLBase As String = "https://ms1click.com/vstat/"

'|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|OURL |fffd|{|fffd||517|p
Public Const SERVER_LOG_URL_PRO = "https://ms1click.com/log/sl.cgi"
'|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|OURL |fffd|e|fffd|X|fffd|g|fffd|p
Public Const SERVER_LOG_URL_DEV = "https://ms1click.com/log/sl_test.cgi"
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||141||fffd||fffd||fffd||fffd||fffd|

' |fffd|K|fffd|{|fffd||752||8340||fffd||fffd|
Public Const TOOL_NAME    As String = "TEL_ASSIST_TOOL"
'2019/04/09 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Const TOOL_VERSION As String = "103"
'Public Const LOG_FILENAME As String = "DENBO_debugLog"
'Public Const LOG_TITLE    As String = "DENBO version 1.02 2018.07.27"
'2019/04/09 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
''2019/04/09 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Const TOOL_VERSION As String = "104"
'Public Const LOG_FILENAME As String = "DENBO_debugLog"
'Public Const LOG_TITLE    As String = "DENBO version 1.04 2019.04.26"
''2019/04/09 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/05/07 |fffd||1c9||fffd| S.M |fffd||35dd||fffd|X|fffd||fffd||fffd|O |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Const TOOL_VERSION As String = "105"
'Public Const LOG_FILENAME As String = "DENBO_debugLog"
'Public Const LOG_TITLE    As String = "DENBO version 1.05 2019.05.07"
'2019/05/07 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/05/29 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|m|fffd||70b9||fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd||591||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Const TOOL_VERSION As String = "106"
'Public Const LOG_FILENAME As String = "DENBO_debugLog"
'Public Const LOG_TITLE    As String = "DENBO version 1.06 2019.05.29"
'2019/05/29 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|m|fffd||70b9||fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd||591||389||fffd|(|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||702||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/07/16 |fffd||1c9||fffd| S.M |fffd||38d||fffd|OL|fffd||fffd||fffd|V|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||706b||fffd||fffd||fffd||fffd|
Public Const TOOL_VERSION As String = "107"
Public Const LOG_FILENAME As String = "DENBO_debugLog"
Public Const LOG_TITLE    As String = "DENBO version 1.07 2019.07.16"
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/07/16 |fffd||1c9||fffd| S.M |fffd||38d||fffd|OL|fffd||fffd||fffd|V|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||141||fffd||fffd||fffd||fffd||fffd|


'|fffd|d|fffd|b|fffd||242||fffd||fffd|p|fffd||fffd||fffd||8471||fffd||fffd||fffd||302||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd|
Public Const TEMPLATE_FILE_NAME    As String = "M201602010167.xls"
Public Const TEMPLATE_FILE_INNER_PATH    As String = "|fffd||598|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|@|fffd||d3dc||fffd||fffd||fffd||202||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Public Const TEMPLATE_TOOL_PASSWORD As String = "ms1234"
Public Const TEMPLATE_TOOL_HOGO_PASSWORD As String = "MSH1K12"

Public Const MB_FG_TYPE = &H40000       ' |fffd||151|O|fffd||283|t|fffd||fffd||fffd|O
Public Const MB_OK = &H0                ' [OK] |fffd|{|fffd|^|fffd||fffd|
Public Const MB_OKCANCEL = &H1          ' [OK] [|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|]|fffd|{|fffd|^|fffd||fffd|

Public Const SW_MINIMIZE = 6                  '|fffd||14f||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|
Public Const CHECKBOX_INVESTIGATION_MODE As String = "chkDebugMode"

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h
Public Const CYOUSA_MODE_ADDR As String = "B11"
'|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd|pAGCode|fffd|AUserId
Public Const AG_CODE_ADDR As String = "B8"
Public Const USER_ID_ADDR As String = "B9"

'|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd|p|fffd|X
Public Const SHEET_PROTECT_PASS = "z99999"

' /*******************************************
'  *    [shtList]|fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  *******************************************/
Public Enum ROW_shtList
    |fffd|^|fffd|C|fffd|g|fffd||fffd| = 11
    |fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s
End Enum

Public Enum COL_shtList
    |fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O = 1
    |fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O
    |fffd||fffd||fffd||fffd||fffd||fffd|
    |fffd||6cc||fffd||fffd||fffd||fffd|
    |fffd|O|fffd||60c||fffd||fffd||50d||fffd|
    |fffd|_|fffd||fffd||48e||fffd||fffd||fffd|
    |fffd|X|fffd||594||50d||fffd|
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd|
    |fffd|d|fffd|b|fffd||50d||fffd|
    |fffd|@|fffd|l|fffd||90|l|fffd||656a|
    |fffd|S|fffd||fffd||fffd||496||fffd|
    |fffd|G|fffd||fffd||fffd|[
End Enum


' /*******************************************
'  *    [shtInputInfo]|fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  *******************************************/
Public Enum ROW_shtInputInfo
    |fffd||fffd||fffd||fffd| = 4
    |fffd||35dd||fffd|X = 5
    |fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h = 7
    |fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h = 9
    |fffd|c|fffd||fffd| = 11
    |fffd||356a| = 13
    |fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| = 15

    |fffd||35dd||fffd|X|fffd||fffd| = 23
    |fffd|Z|fffd||fffd| = 25
    |fffd|Z|fffd||fffd|2 = 26
    |fffd|Z|fffd||fffd|3 = 27
    |fffd|A|fffd||fffd||fffd||fffd| = 29
    |fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd| = 33
    |fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd| = 33
    |fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd| = 35
    |fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd| = 35
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 37
    |fffd||fffd||fffd||fffd||fffd||50d||fffd| = 39
    |fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd| = 42
    |fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd| = 44
    |fffd||fffd||fffd|`|fffd|l = 47
    
    |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n = 53
    |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|I|fffd||fffd| = 66
    |fffd||fffd||fffd||fffd| = 69
End Enum

Public Enum COL_shtInputInfo
    |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd| = 2
    |fffd|f|fffd|[|fffd|^|fffd||fffd| = 3
    |fffd|I|fffd||fffd||fffd| = 6

End Enum

' /**********************************************************************
'  *    |fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|[|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g]|fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  **********************************************************************/
Public Enum ROW_shtTemplate_Input
    |fffd|S|fffd||fffd||fffd||496||fffd| = 24
    |fffd|@|fffd|l|fffd||90|l|fffd||656a| = 26
    |fffd||fffd||fffd|q|fffd||fffd||fffd||710||fffd| = 28
    |fffd||fffd||fffd|q|fffd||fffd||fffd||716||fffd|
    |fffd||fffd||fffd||60c||fffd||fffd||50d||fffd| = 38

End Enum

Public Enum COL_shtTemplate_Input
    |fffd|f|fffd|[|fffd|^|fffd||fffd| = 5

End Enum
' /**********************************************************************
'  *    |fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|[|fffd||fffd|{|fffd||fffd||fffd|p|fffd|V|fffd|[|fffd|g]|fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  **********************************************************************/
Public Enum ROW_shtTemplate_Info
    |fffd||35dd||fffd|X|fffd||fffd| = 5
    |fffd|A|fffd||fffd||fffd||fffd|
    |fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd| = 10
    |fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd| = 10
    |fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd| = 12
    |fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd| = 12
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 14
    |fffd||fffd||fffd||fffd||fffd||50d||fffd| = 16
    |fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd| = 20
    |fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd| = 22
    |fffd||fffd||fffd|`|fffd|l = 26

End Enum

Public Enum COL_shtTemplate_Info
    |fffd|f|fffd|[|fffd|^|fffd||fffd| = 4
    |fffd|I|fffd||fffd||fffd| = 5

End Enum

' /**********************************************************************
'  *    |fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  **********************************************************************/
Public Enum ROW_shtOkurijo
    |fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd| = 6
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd| = 8
    |fffd|_|fffd||fffd||48e||fffd||fffd||fffd| = 11
    
    |fffd||35dd||fffd|X|fffd|Z|fffd||fffd| = 9
    |fffd||35dd||fffd|X|fffd|Z|fffd||fffd|2 = 10
    |fffd||35dd||fffd|X|fffd|Z|fffd||fffd|3 = 11
    |fffd||35dd||fffd|X|fffd||fffd| = 12
    |fffd|S|fffd||fffd||fffd||496||fffd| = 13
    |fffd|A|fffd||fffd||fffd||fffd| = 14
    
    |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n = 18
    |fffd||fffd||fffd||fffd| = 32

End Enum

Public Enum COL_shtOkurijo
    |fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd| = 2
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd| = 2
    |fffd|_|fffd||fffd||48e||fffd||fffd||fffd| = 2
    
    |fffd||35dd||fffd|X|fffd|Z|fffd||fffd| = 25
    |fffd||35dd||fffd|X|fffd||fffd| = 25
    |fffd|S|fffd||fffd||fffd||496||fffd| = 32
    |fffd|A|fffd||fffd||fffd||fffd| = 32
    
    |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n = 6
    |fffd||fffd||fffd||fffd| = 33
End Enum

' /**********************************************************************
'  *    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||598|A |fffd|V|fffd|[|fffd|g|fffd||292|u|fffd||fffd|`
'  **********************************************************************/
Public Enum ROW_shtAtenaLabel
    |fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd| = 2
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd|
    |fffd|_|fffd||fffd||496||fffd|

End Enum

Public Enum COL_shtAtenaLabel
    |fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|_L = 2
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd|_L = 2
    |fffd|_|fffd||fffd||496||fffd|_L = 2
    |fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|_R = 7
    |fffd|_|fffd||fffd||48f|Z|fffd||fffd|_R = 7
    |fffd|_|fffd||fffd||496||fffd|_R = 7

End Enum

Public Const ATENA_ROWS_COUNT As Long = 6
Attribute VB_Name = "FileDaialogFactory"
Option Explicit

'/****************************************************************************
' * FileDaialogFactory 2015.03.02 v0.63
' *
' * |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|^|fffd||1300f||fffd||fffd||fffd||fffd|^|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|@|fffd|\|fffd|Q
' *
' * |fffd||fffd||fffd|j|fffd|e|fffd|B|fffd||389||fffd||fffd||152||1c9||fffd|
' *
' ****************************************************************************/
' 2013/09/20 |fffd||13003|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|G|fffd||fffd||fffd|[|fffd||389||fffd|
' 2013/11/20 ie11|fffd||389||fffd||fffd|i|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||296||fffd||fffd|j
' 2013/11/20 ie8|fffd||209||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd||702||fffd||fffd||182||fffd||fffd||202||fffd||fffd||a347||fffd||311||389||fffd|
' 2014/01/14 |fffd|@|fffd||64ea||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||311||482||fffd|ms|fffd|ishell|fffd||fffd||fffd|[|fffd|v|fffd|j|fffd||fffd||752||fffd||142||fffd||fffd||fffd||60a4||fffd||251||389||fffd|
'            |fffd|Aie8|fffd||209||fffd||fffd||310||64ea||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||10e||64fe||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||64fe||fffd||14e||fffd||fffd|s|fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|
'            |fffd|@|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||183|{|fffd|^|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||14e||64fe||fffd||fffd||fffd||80b7||fffd||fffd||60a4||fffd||251||389||fffd|
' 2014/01/20 |fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|UI Automaition|fffd||fffd||fffd|i|fffd||555d||fffd||3cd|X|fffd||302||fffd||fffd||7d5|s|fffd|v|fffd|\|fffd|[|fffd|X|fffd||d3dc||fffd|j
'            - UIAutomationProxy|fffd||fffd||fffd|K|fffd|v|fffd|i|fffd|Q|fffd||190||752||fffd|FUIAutomationCore.dll|fffd|j -
' 2015/02/25 (1)|fffd|l|fffd|b|fffd|g|fffd||fffd||fffd|[|fffd|N|fffd||fffd||142||311||fffd||fffd||c39e||fffd||243|G|fffd||fffd||fffd|[|fffd||182||202||fffd||389||fffd|
'            |fffd|@|fffd|@|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||202||fffd|m|fffd|F|fffd||fffd||fffd||fffd||315|s|fffd||f347|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|A|fffd||6d1||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||64fe||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||182||202||fffd||a347||fffd||251||389||fffd||fffd||fffd||fffd|R|fffd||4cf||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@(2)|fffd|g|fffd||fffd||fffd|q|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||752||839e||fffd||30a|g|fffd||fffd||fffd|q|fffd||315||22ae||fffd||10cc2||fffd||fffd||fffd||fffd|C|fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@(3)ie8|fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd|^|fffd||82||fffd||fffd||202||fffd||fffd||14ed2||fffd|
' 2015/03/02 (1)|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|T|fffd|C|fffd|Y|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd|R|fffd||4cf||fffd||fffd||fffd|
'            (2)|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|OK|fffd||fffd||fffd||fffd|02/25(1)|fffd|@|fffd||193||fffd||fffd|l|fffd||311||389||fffd|
' 2015/12/14 (1)|fffd||292|m|fffd|o|fffd|[|fffd|iie9|fffd||20d|~|fffd|j|fffd||301||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||389||fffd|
'            (2)"|fffd|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B |fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|"|fffd||fffd||fffd||fffd||fffd||fffd||fffd||183|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd||389||fffd|

'(1)|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|m|fffd||13002||fffd||fffd||94|\|fffd|n
'|fffd|@|fffd||fffd||fffd|@|fffd|\|fffd|FdaialogDownloadExecute
'    |fffd|@|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|ixp|fffd||211|O|fffd|j           |fffd|E|fffd|E|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|v
'    |fffd|@|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||a5d7||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O or |fffd||292|m|fffd|o|fffd|[|fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd||c0b5||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||fffd||fffd|iIE9|fffd||20d|~|fffd|j
'|fffd|@|fffd|@|fffd|A|fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe|                                       |fffd|E|fffd|E|fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v
'|fffd|@|fffd|@|fffd|B|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
'|fffd|@|fffd|@|fffd|C|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|OK|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd|D|fffd||209||fffd||fffd||fffd|zip|fffd|w|fffd||839e||fffd|A|fffd||1300f||fffd||fffd||fffd||fffd||10f|o
'    |fffd|H|fffd||14f|I|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50b|p
'  |fffd||fffd||fffd|@|fffd|\|fffd|FgetUnzipFiles
'    |fffd||209||fffd|ZIP|fffd|w|fffd||839e|
'    |fffd|E|fffd|w|fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|
'    |fffd|F|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe|                                 |fffd|E|fffd|E|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v
'    |fffd|G|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||310||752||fffd|
'(2)|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h
'|fffd|@|fffd||fffd||fffd|@|fffd|\|fffd|FdaialogUploadOpen
'    |fffd|@|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|L|fffd|[|fffd||fffd||fffd||fffd|j                   |fffd|E|fffd|E|fffd|u|fffd|Q|fffd||181|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd||fffd||fffd|@|fffd|\|fffd|FdaialogUploadExecute
'    |fffd|@|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe|                               |fffd|E|fffd|E|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd|v
'|fffd|@|fffd|@|fffd|A|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
'|fffd|@|fffd|@|fffd|B|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|OK|fffd||fffd||fffd||fffd|
'

'Vista|fffd||143|R|fffd||fffd||fffd|{|fffd||3cd|X|fffd||292|m|fffd||115d0|M|fffd||fffd||fffd||182||fffd||fffd||202||fffd||fffd||195||282||30f||a3ca||fffd||255||6d1||fffd||fffd||fffd||fffd||a0bd||fffd||302||148||a5e5||fffd||fffd||fffd|s
#If Win64 Then
'|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|]|fffd||fffd||fffd||fffd||303|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|L|fffd||fffd||fffd|[|fffd||316||fffd||fffd||fffd||fffd||251||fffd||fffd|M|fffd||fffd||fffd||702||fffd||fffd|B|fffd|i|fffd||53bca||fffd||fffd|j
Private Declare PtrSafe Function PostMessage Lib "user32" Alias "PostMessageA" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As Long
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||30e||fffd||fffd||28e|q|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|
Private Declare PtrSafe Function GetDlgCtrlID Lib "user32" (ByVal hWnd As LongPtr) As Long
'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||fffd||fffd||fffd|)
Private Declare PtrSafe Function SendMessage Lib "user32" Alias "SendMessageA" (ByVal hWnd As LongPtr, ByVal wMsg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr) As Long
#Else
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||30e||fffd||fffd||28e|q|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|
Private Declare Function GetDlgCtrlID Lib "user32" (ByVal hWnd As Long) As Long
'|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|]|fffd||fffd||fffd||fffd||303|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|L|fffd||fffd||fffd|[|fffd||316||fffd||fffd||fffd||fffd||251||fffd||fffd|M|fffd||fffd||fffd||702||fffd||fffd|B|fffd|i|fffd||53bca||fffd||fffd|j
Private Declare Function PostMessage Lib "user32" Alias "PostMessageA" (ByVal hWnd As Long, ByVal wMsg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||fffd||fffd||fffd|)
Public Declare Function SendMessage Lib "user32.dll" Alias "SendMessageA" (ByVal hWnd As Long, ByVal msg As Long, ByVal wParam As Long, ByVal lParam As Long) As Long
#End If
Private Const WM_COMMAND As Long = &H111
Private Const CBN_EDITCHANGE As Long = &H5
'->2015/02/25ie8|fffd|I|fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||155||82||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|p|fffd||1c9||fffd|
Private Const BM_GETCHECK As Long = &HF0        '# |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||502||fffd||fffd||64fe|
Private Const BST_UNCHECKED As Long = &H0       '# |fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|
Private Const BST_CHECKED As Long = &H1         '# |fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|
'<-2015/02/25ie8|fffd|I|fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd||155||82||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|p|fffd||1c9||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd|
'(1)|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'|fffd|@|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
Private Const DLG_D1_CAP_UIE8           As String = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h"        'IE8|fffd||211|O|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
Private Const DLG_D1_CAP_FIE9           As String = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd|"            'IE9|fffd||20d|~|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p|fffd|i|fffd||a5d7||fffd|j
Private Const DLG_D1_CAP_FIE9_PLUS      As String = "Internet Explorer"             'IE9|fffd||20d|~|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p|fffd|i|fffd||a5d7||fffd|j
'|fffd|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
Private Const DLG_D2_CAP                As String = "|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd|"              '|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
'|fffd|B|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
Private Const DLG_D3_CAP                As String = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd|"            '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd|
'(2)|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p
Private Const DLG_U_CAP_UIE7            As String = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd|"                '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p IE6,7
Private Const DLG_U_CAP_FIE8            As String = "|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd|"        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|I|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p IE8,9,10
'(3)zip|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|
Private Const DLG_P_CAP                 As String = "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||fffd|"              '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||fffd|
Private Const DLG_P_CAP_ERR             As String = "|fffd|G|fffd||fffd||fffd|["                        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||343|G|fffd||fffd||fffd|[

'->|fffd||fffd||fffd||fffd||fffd||fffd|zip|fffd||13015||fffd|
#If Win64 Then
'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||64fe|
Private Declare PtrSafe Function GetTempPath Lib "kernel32" Alias "GetTempPathA" (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long
#Else
'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||64fe||fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||18f|d|fffd||fffd||fffd||302||fffd||fffd||7c8||a554||fffd|R|fffd||fffd||fffd||fffd||fffd|g
Private Declare Function GetTempPath Lib "kernel32" Alias "GetTempPathA" (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long
#End If

'VBS|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
Private Const VBS_FILE_NAME         As String = "Extract.vbs"

'<-|fffd||fffd||fffd||fffd||fffd||fffd|zip|fffd||13015||fffd|

'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
Private mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|    As String                                       '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e
Private mdlErrDescription   As String                                       '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|^|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|L|fffd|g|fffd|p
'Shell Shell|fffd||151||fffd||482||fffd|
Private mdlShell|fffd||151||fffd||482||fffd|ms   As Long                                        '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|^|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|L|fffd|g|fffd|p
'2014/01/14 Shell|fffd||64ea||fffd||151||fffd||482||fffd|
Private mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms      As Long                                 '|fffd||64ea||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Shell|fffd||482||fffd|
'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd|ms
Private mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms   As Long                       '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'|fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd|ms
Private mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms   As Long                               '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
Private mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms   As Long                       '|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h
'2015/02/25|fffd||1c9||fffd|
Private mdlIE8AutoClose        As Boolean                                   'ie8|fffd||fffd||fffd|[|fffd|g|fffd||242||fffd||fffd||fffd||fffd||95e0||fffd||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||30e||fffd||fffd||fffd||fffd||155||82||fffd||fffd||fffd||308||fffd||fffd|p|fffd|p

'|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g
Private Const DEF_Shell|fffd||151||fffd||482||fffd|ms  As Long = 20000
Private Const DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms  As Long = 1000
Private Const DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms  As Long = 1000
Private Const DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms  As Long = 1000

'|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|Z|fffd|p|fffd||fffd||fffd|[|fffd|^
Private Const FILE_SEP_STR     As String = "/"

'-- (Setter Shell|fffd||151||fffd||482||fffd|ms)
Public Property Let setShell|fffd||151||fffd||482||fffd|ms(ByVal Shell|fffd||151||fffd||482||fffd|ms As Long)
    mdlShell|fffd||151||fffd||482||fffd|ms = Shell|fffd||151||fffd||482||fffd|ms
End Property
'-- (Setter Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms)Download 2014/01/14
Public Property Let setShell|fffd||64ea||fffd||151||fffd||482||fffd|ms(ByVal Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms As Long)
    mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms
End Property
'-- (Setter |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms)Download
Public Property Let set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms(ByVal |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms As Long)
    mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
End Property
'-- (Setter |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms)Download
Public Property Let set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms(ByVal |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms As Long)
    mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms
End Property
'-- (Setter |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms)Upload
Public Property Let set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms(ByVal |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms As Long)
    mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
End Property

'--Getter|fffd|iOUT CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|jDownload
Public Property Get resCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|() As String
    resCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
End Property
'--|fffd|iOUT |fffd|Z|fffd|p|fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|jDownload
Public Property Get resFileSepStr() As String
    resFileSepStr = FILE_SEP_STR
End Property
'--|fffd|iOUT |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|j
Public Property Get resErrDescription() As String
    resErrDescription = mdlErrDescription
End Property

'########################################################
'# |fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||115||6d1||fffd|
'#   extType|fffd|FCSV or ZIP
'#   zipPass|fffd|F|fffd||13003|p|fffd|X|fffd||fffd||fffd|[|fffd|h
'#   destPath|fffd|F|fffd||6d1||fffd||fffd||fffd|p|fffd|X |fffd|i|fffd||217||fffd||fffd||fffd||fffd|F|fffd|u|fffd|b|fffd|N|fffd|p|fffd|X|fffd|j
'#   renameBaseFileName|fffd|F|fffd|g|fffd||fffd||fffd|q|fffd||202||fffd||fffd||fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||182||202||fffd|j
'#   |fffd|i|fffd||217||fffd||fffd||fffd||fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||255|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|j
'#|fffd|@ |fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||341|A"/"|fffd||fffd||602||fffd||155||50b|p|fffd||fffd||fffd||fffd|B|fffd|i|fffd||fffd||fffd|k|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||255||fffd||fffd||fffd||fffd||fffd||fffd||74e||fffd||fffd|j
'########################################################
Public Function daialogDownloadExecute(ie As InternetExplorer, Optional ByVal extType As String = "ZIP", Optional ByVal zipPass As String = "", _
                    Optional ByVal destPath As String = "", Optional ByVal renameBaseFileName As String = "") As Boolean
    startOf "FileDaialogFactory.daialogDownloadExecute"
    Dim downloadFile     As String
    Dim extractFile      As String
    Dim msg     As String
    
    daialogDownloadExecute = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd|
    If mdlShell|fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||151||fffd||482||fffd|
    End If
    '->2014/01/14 |fffd||1c9||fffd|
    If mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||64ea||fffd||151||fffd||482||fffd|
    End If
    '<-2014/01/14 |fffd||1c9||fffd|
    If mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = 0 Then
        mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms          '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
    End If
    If mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = 0 Then
        mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms              '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|
    End If
    mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = ""
    mdlErrDescription = ""
    
'    '|fffd|g|fffd||fffd||fffd|q|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
'    If UCase(extType) = "CSV" Or UCase(extType) = "ZIP" Then
'    Else
'        msg = "|fffd|g|fffd||fffd||fffd|q|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||142||fffd||fffd|BTYPE=" & extType
'        Log msg
'        mdlErrDescription = msg
'        Exit Function
'    End If
    
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
    Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B"
    downloadFile = daialogDownloadSub(ie, extType, destPath, renameBaseFileName)
    If downloadFile = "" Then
        msg = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|i|fffd||68d||5c1|F" & mdlErrDescription & "|fffd|j"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|BFILE|fffd|F" & downloadFile
    mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = downloadFile
    
    'zip|fffd||1300e|w|fffd||fffd|
    If UCase(extType) = "ZIP" Then
        Log "zip|fffd||13002||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|B"
        extractFile = getUnzipFiles(downloadFile, zipPass)
        If extractFile = "" Then
            Exit Function
        End If
        Log "zip|fffd||13002||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|BFILE|fffd|F" & extractFile
        mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = extractFile
    End If
    
    daialogDownloadExecute = True
    endOf "FileDaialogFactory.daialogDownloadExecute"
End Function

'########################################################
'# |fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||115||6d1||fffd|
'#   extType|fffd|FCSV or ZIP
'#   destPath|fffd|F|fffd||6d1||fffd||fffd||fffd|p|fffd|X |fffd|i|fffd||217||fffd||fffd||fffd||fffd|F|fffd|u|fffd|b|fffd|N|fffd|p|fffd|X|fffd|j
'#   renameBaseFileName|fffd|F|fffd|w|fffd||fffd||fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| |fffd|i|fffd||217||fffd||fffd||fffd||fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||255|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|j
'########################################################
Private Function daialogDownloadSub(ByRef ie As InternetExplorer, Optional ByVal extType As String = "CSV", _
                                    Optional ByVal destPath As String = "", Optional ByVal renameBaseFileName As String = "") As String
    startOf "daialogDownloadSub"
    Dim outPath     As String
    Dim outFullFile As String
    Dim iever       As Long
    
    outFullFile = ""
    
    '|fffd|o|fffd||350||fffd|p|fffd|X|fffd||fffd||fffd||fffd|
    outPath = ThisWorkbook.path & "\"
    If destPath <> "" Then
        outPath = destPath
    End If
    If Right(outPath, 1) <> "\" Then
        outPath = outPath & "\"
    End If
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd||fffd|X|fffd||fffd||fffd|[|fffd|v
    DoEvents
    Sleep mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
    
    '|fffd||fffd|ie|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    iever = getIeMajorVersion(ie)
    Log "|fffd|h|fffd|d|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|F" & iever
    If iever < 9 Then
        'ie9|fffd||fffd||827a||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
        '|fffd||fffd||fffd|@|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd| ----------------------------->
        If dailogBeforeSaveUntilIe8 = False Then
            Exit Function
        End If

        '|fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||482||fffd||fffd|X|fffd||fffd||fffd|[|fffd|v
        DoEvents
        Sleep mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms
        
        '|fffd||fffd||fffd|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|---------------------------->2015/02/25|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p
        outFullFile = dailogSave(outPath, extType, renameBaseFileName, iever)
        If outFullFile = "" Then
            Exit Function
        End If

        '|fffd||fffd||fffd|B|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||702||fffd| ------------------------------------->
        Log "|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||82||fffd||fffd||702||fffd|"
        If dailogAfterSaveUntilIe8() = False Then
            Exit Function
        End If

    Else
        'ie9|fffd||20f||fffd||389||fffd|
        Dim iElementT   As IUIAutomationElement                             '|fffd||fffd||fffd|p|fffd||fffd||fffd|p
        Dim findDaialog As Long                                             '1:|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A2:|fffd||292|m|fffd|o|fffd|[
        
        '|fffd||fffd||fffd|@|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|@|fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||142||30c||fffd||fffd||fffd| ------------------>
        Log "ie9|fffd||20d|~|fffd|A|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|@|fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||389||fffd||fffd|J|fffd|n"
        Set iElementT = dailogBeforeSaveFromIe9(ie, findDaialog)
        If iElementT Is Nothing Then
            Exit Function
        End If

        '|fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||482||fffd||fffd|X|fffd||fffd||fffd|[|fffd|v
        DoEvents
        Sleep mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms
        
        '|fffd||fffd||fffd|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd| --------------------------->2015/02/25|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p
        outFullFile = dailogSave(outPath, extType, renameBaseFileName, iever)
        If outFullFile = "" Then
            Exit Function
        End If
    
        '|fffd||fffd||fffd|B|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|@|fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||fffd||82||fffd||fffd||fffd| ------------------>
        If dailogAfterSaveFromIe9(iElementT, findDaialog) = False Then
            Exit Function
        End If
    
    End If
    
    '|fffd|t|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||315||50b|p
    daialogDownloadSub = outFullFile
    
    endOf "daialogDownloadSub"
End Function

'|fffd|@IE9|fffd||fffd||fffd||fffd||fffd||301|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
'|fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||315||6d1||fffd||fffd||702||14e||fffd||fffd|{
Private Function dailogBeforeSaveUntilIe8() As Boolean
    startOf "dailogBeforeSaveUntilIe8"
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    Dim msg As String
    Dim i   As Long
    
    Dim startTime As Long
    Dim UseTime As Long
    Dim waitTime    As Long
    
    dailogBeforeSaveUntilIe8 = False
    
    waitTime = mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms                               '2014/01/14|fffd||64ea||fffd||fffd||fffd|g|fffd|p
    
    '|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|
    '2014/01/14 |fffd||282||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd|G|fffd||fffd||fffd|[|fffd||182||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|
    '           |fffd|{|fffd|^|fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||183|Z|fffd|b|fffd|g|fffd||14e||fffd||fffd|{|fffd||fffd||fffd||fffd|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        'TopWindow|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_D1_CAP_UIE8                   '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        '|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D1_CAP_UIE8
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            DoEvents
            Sleep 100
            
            '|fffd||6d1||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||6d1||fffd|(S)")
            If Not iElementE Is Nothing Then
                '|fffd||fffd||fffd||fffd|E|fffd|o
                Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o"
                Exit Do
            Else
                Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & DLG_D1_CAP_UIE8
        End If
    
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||702||fffd||fffd||341|u|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|n|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||42a4f||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||182||402||70a9||fffd||202||fffd||fffd|i|fffd|R|fffd||42b82||70a2||fffd|j
    For i = 1 To 10
        DoEvents
        Sleep 100
            
        '|fffd||fffd||fffd|s
        Log "|fffd||6d1||fffd||fffd||fffd||fffd|s"
        If uiDoAction(iElementE) = False Then
            '|fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||282||309||fffd||282||fffd||fffd||402||70a2||fffd||fffd||fffd||302||152|E|fffd|o
            Log "|fffd||6d1||fffd||fffd||fffd||fffd|s|fffd||24e||fffd||fffd|s|fffd||141|A|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||282||309||fffd||282||fffd||fffd||402||70a2||fffd||fffd||fffd||302||152|E|fffd|o"
            Exit For
        End If
    Next
    
    dailogBeforeSaveUntilIe8 = True
    
    endOf "dailogBeforeSaveUntilIe8"
End Function

'|fffd|@IE9|fffd||20d|~|fffd||301|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd|v|fffd||30c||fffd||fffd||fffd|
'|fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||315||6d1||fffd||fffd||702||14e||fffd||fffd|{
Private Function dailogBeforeSaveFromIe9(ie As InternetExplorer, ByRef findDaialog As Long) As IUIAutomationElement
    startOf "dailogBeforeSaveFromIe9"
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementM   As IUIAutomationElement                                 '|fffd||fffd||fffd||517|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p

    Dim msg         As String
    Dim strType     As String
    Dim strText     As String
    Dim cntLoop     As Long                                                 '2015/12/14|fffd||1c9||fffd|
    
    Dim startTime As Long
    Dim UseTime As Long
    Dim waitTime    As Long
    
    Set dailogBeforeSaveFromIe9 = Nothing
    
    waitTime = mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms                               '2014/01/14|fffd||64ea||fffd||fffd||fffd|g|fffd|p
    
    '|fffd||fffd||fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O |fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
    '|fffd|\|fffd||fffd||fffd||30a|m|fffd|F|fffd||fffd||fffd||702||7c1|A|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||482||fffd||fffd||30f||fffd||502||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd|e|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B|fffd|i|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||30f||fffd||502||182||314||fffd|r|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||7c1|j
    findDaialog = 0
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        cntLoop = cntLoop + 1                                                   '2015/12/14|fffd||1c9||fffd|
        Log "|fffd||fffd||fffd|s|fffd||fffd||fffd|F" & cntLoop                                                '2015/12/14|fffd||1c9||fffd|
        
        '|fffd||fffd||fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_D1_CAP_FIE9 & "&" & DLG_D1_CAP_FIE9_PLUS  '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        '|fffd|z|fffd||fffd||fffd|w|fffd||fffd|
        UIAutomationProxy.setChildHWnd = 0                                        '
        UIAutomationProxy.setFindChildCaption = ""                                '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindChildClass = ""                                  '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D1_CAP_FIE9
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
            Set iElementM = uiGetElementByType(iElementT, "|fffd||a5d7||fffd||fffd||fffd||fffd|")
            If Not iElementM Is Nothing Then
                '|fffd||fffd||fffd||fffd||fffd|O|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd|Value|fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd||d39e||fffd||fffd||fffd||fffd||fffd|N|fffd||242||fffd||fffd||fffd||fffd|j
                Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||30d||14f||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
                Set iElementE = uiGetFirstChildElement(iElementM)
                If Not iElementE Is Nothing Then
                    Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||30d||14f||fffd||fffd||30e|q|fffd||302|R|fffd||90||fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
                    Set iElementE = uiGetNextSiblingElement(iElementE, 3)
                    If Not iElementE Is Nothing Then
                        Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd||64fe|"
                        strType = uiGetElementType(iElementE)
                        If InStr(strType, "|fffd|e|fffd|L|fffd|X|fffd|g") > 0 Then
                            '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd|e|fffd||64fe||fffd|i|fffd||fffd||fffd||303|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||702||fffd||fffd||355||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?|fffd|j
                            strText = uiGetElementName(iElementE)
                            Log "|fffd||6d1||fffd||fffd|O|fffd||fffd|Value|fffd|F" & strText
'->2015/12/14 |fffd||fffd||fffd||282||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||15515|i|fffd||fffd|
'                            findDaialog = 1
'                            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_D1_CAP_FIE9
'                            Exit Do
'                        End If
                            If InStr(strText, "|fffd||6d1||fffd|") > 0 Then
                                Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|"
                                If dailogBeforeSaveFromIe9Sub(iElementM, cntLoop) = True Then
                                    Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||d0cb||fffd|[|fffd|v|fffd|I|fffd||fffd|"
                                    findDaialog = 1
                                    Exit Do
                                Else
                                    Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|s"
                                End If
                            Else
                                Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||241|u|fffd||6d1||fffd||fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                            End If
                        Else
                            Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                        End If
'<-2015/12/14 |fffd||fffd||fffd||282||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||15515|i|fffd||fffd|
                    Else
                        Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||30d||14f||fffd||fffd||30e|q|fffd||302|R|fffd||90||60aa||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                    End If
                Else
                    Log "|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||30d||14f||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            Else
                Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd|u|fffd||a5d7||fffd||fffd||fffd||681|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & DLG_D1_CAP_FIE9
        End If
    
        '|fffd||fffd||fffd||292|m|fffd|o|fffd|[|fffd||fffd||fffd||64fe|
        UIAutomationProxy.setTopHWnd = ie.hWnd                                  'IE|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
        UIAutomationProxy.setFindTopCaption = ""                                '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = ""                                  '|fffd||fffd||fffd|S|fffd||fffd|v
        '|fffd|z|fffd||fffd||fffd|w|fffd||fffd|
        UIAutomationProxy.setChildHWnd = 0                                        '
        UIAutomationProxy.setFindChildCaption = ""                                '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindChildClass = "Frame Notification Bar"            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & "|fffd||292|m|fffd|o|fffd|["
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            '|fffd||292|m|fffd|o|fffd|[|fffd||30f||a347||fffd||341|A|fffd||fffd||fffd||517|p|fffd||fffd|TOP|fffd|p|fffd||193||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
            Set iElementM = iElementT
                    
            '|fffd||fffd||fffd||fffd||fffd|O|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd|Value|fffd||fffd||fffd||64fe||fffd|i|fffd|Q|fffd|l|fffd|j
            Log "|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
            Set iElementE = uiGetElementByTypeAndName(iElementM, "|fffd|e|fffd|L|fffd|X|fffd|g", "|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g")
            If Not iElementE Is Nothing Then
                '|fffd|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd|e|fffd||64fe||fffd|i|fffd||fffd||fffd||303|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||702||fffd||fffd||355||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?|fffd|j
                strText = uiGetElementValue(iElementE)
                Log "|fffd||6d1||fffd||fffd|O|fffd||fffd|Value|fffd|F" & strText
'->2015/12/14 |fffd||fffd||fffd||282||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||15515|i|fffd||fffd|
'                findDaialog = 2
'                Log "|fffd||38f||6c3|N|fffd||fffd||fffd|X|fffd||fffd||fffd||742||82||fffd||fffd||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & "Frame Notification Bar"
'                Exit Do
                If InStr(strText, "|fffd||6d1||fffd|") > 0 Then
                    Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|"
                    If dailogBeforeSaveFromIe9Sub(iElementM, cntLoop) = True Then
                        Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||d0cb||fffd|[|fffd|v|fffd|I|fffd||fffd|"
                        findDaialog = 2
                        Exit Do
                    Else
                        Log "|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|s"
                    End If
                Else
                    Log "|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd|v|fffd||241|u|fffd||6d1||fffd||fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                End If
'<-2015/12/14 |fffd||fffd||fffd||282||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||15515|i|fffd||fffd|
            Else
                Log "|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & "|fffd||292|m|fffd|o|fffd|["
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||702||fffd||fffd||341|uFrame Notification Bar|fffd|N|fffd||fffd||fffd|X|fffd|v|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
            
'->2015/12/14 |fffd||fffd||fffd||282||242||fffd||fffd||fffd||fffd||302||14d||d3dc|
'    '|fffd||20d|~|fffd||341|A|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd|v|fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
'    Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
'    Set iElementE = uiGetElementByTypeAndName(iElementM, "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd|", "|fffd||6d1||fffd|")
'    If iElementE Is Nothing Then
'        msg = "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
'        Log msg
'        mdlErrDescription = msg
'        Exit Function
'    End If
'    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||64fe|
'    Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
'    Set iElementE = uiGetFirstChildElement(iElementE)
'    If iElementE Is Nothing Then
'        msg = "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
'        Log msg
'        mdlErrDescription = msg
'        Exit Function
'    End If
'
'    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|A|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||316||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
'    UseTime = 0
'    startTime = GetTickCount
'    Do
'        DoEvents
'        Sleep 100
'
'        '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||fffd||fffd|s
'        Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||fffd||fffd|s"
'        Call uiDoAction(iElementE)
'
'        '|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||301|u|fffd||fffd||fffd|O|fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|s
'        Log "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd|s"
'        If uiDoActionPopup("|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd|(A)") = True Then
'            Log "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|"
'            Exit Do
'        End If
'
'        UseTime = GetTickCount - startTime
'
'    Loop While UseTime < waitTime
'    If UseTime >= waitTime Then
'        msg = "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
'        Log msg
'        mdlErrDescription = msg
'        Exit Function
'    End If
'<-2015/12/14 |fffd||fffd||fffd||282||242||fffd||fffd||fffd||fffd||302||14d||d3dc|
    
    '|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||50b|p
    Set dailogBeforeSaveFromIe9 = iElementT
    
    endOf "dailogBeforeSaveFromIe9"
End Function
'2015/12/14 |fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd|
Private Function dailogBeforeSaveFromIe9Sub(iElementB As IUIAutomationElement, ByVal cntLoop As Long) As Boolean
    Dim iElementM   As IUIAutomationElement                                 '|fffd||fffd||fffd||517|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    Dim msg As String
    Dim sleepMs     As Long
    
    dailogBeforeSaveFromIe9Sub = False
    
    '|fffd||20d|~|fffd||341|A|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd|v|fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
    Set iElementM = uiGetElementByTypeAndName(iElementB, "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd|", "|fffd||6d1||fffd|")
    If iElementM Is Nothing Then
        msg = "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||64fe|
    Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd|B"
    Set iElementE = uiGetFirstChildElement(iElementM)
    If iElementE Is Nothing Then
        msg = "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    DoEvents
    '->2015/12/14 |fffd|X|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||95||3c2||255||3cd|X
    If cntLoop < 100 Then
        sleepMs = 100 * cntLoop             '100ms*|fffd||fffd||fffd|s|fffd||fffd|
        Log "uiDoAction|fffd|O|fffd|X|fffd||fffd||fffd|[|fffd|v|fffd|F" & sleepMs
    Else
        sleepMs = 10000                     '|fffd||151||fffd|10|fffd|b
        Log "uiDoAction|fffd|O|fffd|X|fffd||fffd||fffd|[|fffd|v|fffd|F" & sleepMs
    End If
    Sleep sleepMs
    '<-2015/12/14 |fffd|X|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||95||3c2||255||3cd|X
    '##Sleep 100
    
    '|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||309||fffd||fffd||fffd||fffd||fffd||fffd|s
    Log "|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||30e|q|fffd||309||fffd||fffd||fffd||fffd||fffd||fffd|s"
    Call uiDoAction(iElementE)
    
    '|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||301|u|fffd||fffd||fffd|O|fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|s
    Log "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd|s"
    If uiDoActionPopup("|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd|(A)") = True Then
        Log "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|"
    Else
        msg = "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|s"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If

    dailogBeforeSaveFromIe9Sub = True
        
End Function

'|fffd|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
Private Function dailogSave(ByVal outPath As String, Optional ByVal extType As String = "CSV", Optional ByVal renameBaseFileName As String = "", _
                            Optional ByVal iever As Long = 0) As String
    startOf "dailogSave"
    
    'Vista|fffd||fffd||fffd||255||3cd|X|fffd||292|m|fffd||115c2||fffd||202||fffd||fffd||183|t|fffd||fffd||fffd|p|fffd|X|fffd|w|fffd||fffd||150||fffd||fffd||fffd||fffd||fffd||fffd||a3ca||fffd||255||6d1||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||302||148||a5e5||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
    #If Win64 Then
    Dim hTop    As LongPtr
    Dim hCmb    As LongPtr
    #Else
    Dim hTop    As Long
    Dim hCmb    As Long
    #End If
    
    Dim iElementR   As IUIAutomationElement                                 '|fffd||fffd||fffd|[|fffd|g|fffd||317||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|p 2015/02/25|fffd||1c9||fffd|
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    Dim iElementW   As IUIAutomationElement                                 '|fffd||fffd||fffd|[|fffd|N|fffd|p
    
    Dim dispFile    As String
    Dim outFullFile As String
    Dim msg As String
    Dim blnClicked  As Boolean                                              '2015/02/25
    Dim tmpSize     As Long                                                 '2015/03/02
    
    Dim startTime As Long
    Dim UseTime As Long
    Dim waitTime    As Long
    
    dailogSave = ""
    
    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms
            
    '|fffd||fffd||fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd|\|fffd||fffd||fffd||30a|m|fffd|F|fffd||fffd||fffd||702||fffd|Edit|fffd||fffd||fffd||fffd||fffd||64fe|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_D2_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D2_CAP
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            '|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||242||fffd||85bc||fffd|O|fffd||fffd||fffd||642||202||fffd|
            Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|:")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie9|fffd||20d|~|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
            Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|(N):")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie8|fffd||211|O|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & DLG_D2_CAP
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|F" & DLG_D2_CAP
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '->2015/02/25 ie8|fffd||211|O|fffd||30f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c2||243||fffd||fffd|[|fffd|g|fffd||182||202||95e0||fffd||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303|I|fffd||fffd||fffd|^|fffd|I|fffd|t|fffd||fffd||fffd||64fe|
    If iever < 9 Then
        Log "ie8|fffd||211|O|fffd||30f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c2||243||fffd||fffd|[|fffd|g|fffd||182||202||95e0||fffd||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303|I|fffd||fffd||fffd|^|fffd|I|fffd|t|fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd||fffd||fffd|l|fffd|I|fffd|t|fffd|j"
        mdlIE8AutoClose = False
        Set iElementR = uiGetParentElement(iElementT)
        If Not iElementR Is Nothing Then
            Log "|fffd||fffd||fffd|[|fffd|g|fffd||182||202||95e0||fffd||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||14b4c||fffd|"
            Set iElementR = uiGetElementByType(iElementR, "|fffd|`|fffd|F|fffd|b|fffd|N |fffd|{|fffd|b|fffd|N|fffd|X")
            If Not iElementR Is Nothing Then
                Log "|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||64fe|"
                If SendMessage(uiGetElementHandle(iElementR), BM_GETCHECK, 0, 0) = BST_CHECKED Then
                    mdlIE8AutoClose = True
                    Log "|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd|F|fffd|I|fffd||fffd||fffd||30f||fffd||fffd|"
                End If
            End If
        End If
    End If
    '<-2015/02/25 ie8|fffd||211|O|fffd||30f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c2||243||fffd||fffd|[|fffd|g|fffd||242||202||95e0||fffd||303|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||303|I|fffd||fffd||fffd|^|fffd|I|fffd|t|fffd||fffd||fffd||64fe|
    
    '|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|@Full Path |fffd|w|fffd||fffd|
    Log "Edit|fffd||315|\|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        dispFile = uiGetElementValue(iElementE)
        Log "Edit|fffd||315|\|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd|F" & dispFile
        
        DoEvents
        Sleep 100
        
        '|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|u|fffd|b|fffd|N|fffd|p|fffd|X + |fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|j
        '|fffd|w|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||255||3cd|X|fffd|A|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd|O|fffd||255||246b|
        If renameBaseFileName = "" Then
            outFullFile = outPath & dispFile
        Else
            outFullFile = outPath & renameBaseFileName
        End If
        Log "Edit|fffd||310||752||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & outFullFile
        
        Log "Edit|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||3cd|X"
        If uiSetElementValue(iElementE, outFullFile) = True Then
            DoEvents
            Sleep 100
            
            '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|Edit|fffd||315||3cd|X|fffd||292|m
            Log "|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|Edit|fffd||315||3cd|X|fffd||292|m|fffd||fffd||fffd|s|fffd||fffd|"
            hTop = uiGetElementHandle(iElementT)                                '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
            hCmb = uiGetElementHandle(uiGetParentElement(iElementE))            '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
            Call PostMessage(hTop, WM_COMMAND, MAKEWPARAM(GetDlgCtrlID(hCmb), CBN_EDITCHANGE), ByVal hCmb)
            
            DoEvents
            Sleep 100
            
            dispFile = uiGetElementValue(iElementE)
            Log "Edit|fffd||315|\|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10e||64fe||fffd|F" & dispFile
            
            DoEvents
            Sleep 100
            
            '|fffd||752||80b5||fffd||fffd||fffd||fffd||fffd||302||18e||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|E|fffd|o|fffd|i|fffd||752||80b3||fffd||fffd||202||fffd||fffd||702||715||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|j
            If dispFile = outFullFile Then
                Log "|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd||fffd||fffd||fffd|i|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||30d||10a|m|fffd|FOK|fffd|j|fffd|E|fffd|o"
                Exit Do
            End If
        
        Else
            msg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Log msg
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||310||752||80aa||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
            
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||315||246b||fffd||1c9||fffd||fffd|i|fffd|g|fffd||fffd||fffd|q|fffd||fffd|\|fffd||fffd||fffd||389||fffd||fffd|j
    If UCase(extType) = "CSV" Then
        If UCase(Right(outFullFile, 4)) <> ".CSV" Then
            outFullFile = outFullFile & ".CSV"
        End If
    ElseIf UCase(extType) = "ZIP" Then
        If UCase(Right(outFullFile, 4)) <> ".ZIP" Then
            outFullFile = outFullFile & ".ZIP"
        End If
    End If
    Log "|fffd||64fe||fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & outFullFile
    
    '|fffd||fffd||fffd|O|fffd||d3dc|
    With CreateObject("Scripting.FileSystemObject")
        If .fileExists(outFullFile) = True Then
            .DeleteFile outFullFile, True
            Log "|fffd||fffd||fffd|O|fffd||253||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd|B|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|F" & outFullFile
        End If
    End With
    
    '->2015/02/25 |fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||182||30a|m|fffd|F|fffd||fffd||283||fffd||fffd|[|fffd|v|fffd||255||fffd||fffd||fffd||fffd|i|fffd|Q|fffd||fffd||702||fffd||fffd||192|E|fffd|o|fffd||fffd||fffd||202||fffd||fffd|j
    '|fffd||fffd||fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||103|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
'    UseTime = 0
'    StartTime = GetTickCount
'    Do
'        DoEvents
'        Sleep 100
'
'        '|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|"
'        Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||6d1||fffd|(S)")
'        If Not iElementE Is Nothing Then
'            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'            Call uiDoAction(iElementE)
'
'            DoEvents
'            Sleep 100
'
'            '|fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
'            UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
'            UIAutomationProxy.setFindTopCaption = DLG_D2_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
'            UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
'            Log "|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
'            Set iElementW = uiGetElementFromHandle()
'            If iElementW Is Nothing Then
'                '|fffd||fffd||fffd||fffd|E|fffd|o
'                Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_D2_CAP
'                Exit Do
'            End If
'        Else
'            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
'        End If
'
'        UseTime = GetTickCount - StartTime
'
'    Loop While UseTime < waitTime
'    If UseTime >= waitTime Then
'        msg = "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
'        Log msg
'        mdlErrDescription = msg
'        Exit Function
'    End If
    '|fffd||fffd||fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||302||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
    blnClicked = False
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        '|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
        Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|"
        Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||6d1||fffd|(S)")
        If Not iElementE Is Nothing Then
            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call uiDoAction(iElementE)
            blnClicked = True
            '|fffd||fffd||fffd||303||fffd||fffd|[|fffd|v|fffd||150||fffd||fffd||fffd|E|fffd|o
            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        Else
            If blnClicked = True Then
                Log "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||255||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd|E|fffd|o"
                Exit Do
            Else
                Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||103|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
                    
        '|fffd|u|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_D2_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
        Set iElementW = uiGetElementFromHandle()
        If iElementW Is Nothing Then
            '|fffd||fffd||fffd||fffd|E|fffd|o
            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_D2_CAP
            Exit Do
        Else
            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||702||fffd||fffd|F" & DLG_D2_CAP
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    '->2015/02/25 |fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||182||30a|m|fffd|F|fffd||fffd||283||fffd||fffd|[|fffd|v|fffd||255||fffd||fffd||fffd||fffd|i|fffd|Q|fffd||fffd||702||fffd||fffd||192|E|fffd|o|fffd||fffd||fffd||202||fffd||fffd|j
    
    '|fffd||fffd||fffd||fffd||fffd||6c2||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd|m|fffd|F------------------------------------------------------------->
    Log "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd|m|fffd|F|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|F" & outFullFile
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        With CreateObject("Scripting.FileSystemObject")
            If .fileExists(outFullFile) = True Then         '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|True|fffd||182||202||fffd|
                '->2015/03/02 |fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|isize|fffd||64fe||fffd||fffd||fffd||302||fffd|Resume|fffd|j
'                On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
'                With .getFile(outFullFile)
'                    If .size > 0 Then
'                        Exit Do
'                    End If
'                End With
'                On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                tmpSize = 0
                On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                tmpSize = .getFile(outFullFile).size
                On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                If tmpSize > 0 Then
                    Exit Do
                End If
                '<-2015/03/02 |fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|isize|fffd||64fe||fffd||fffd||fffd||302||fffd|Resume|fffd|j
             End If
       End With
        
       UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime * 3       '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|T|fffd|C|fffd|Y|fffd||143|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||90bd||fffd||fffd|3|fffd|{|fffd||255||3cd|X
    If UseTime >= waitTime Then
        msg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd|m|fffd|F|fffd||155||6d1||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|BFILE=" & outFullFile
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|t|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||50b|p
    dailogSave = outFullFile
    
    endOf "dailogSave"

End Function
        
'|fffd|BIE9|fffd||fffd||fffd||fffd||fffd||301|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||82||fffd||fffd||702||fffd|
Private Function dailogAfterSaveUntilIe8() As Boolean
    startOf "dailogAfterSaveUntilIe8"
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    
    Dim msg As String                           '2015/02/25
    Dim blnClicked  As Boolean                  '2015/02/25
    Dim i   As Long
        
    Dim startTime As Long                       '2015/02/25
    Dim UseTime As Long                         '2015/02/25
    Dim waitTime    As Long                     '2015/02/25
    
    dailogAfterSaveUntilIe8 = False
    
    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms               '2015/02/25
    
    DoEvents
    Sleep 100
    
    '->2015/02/25 |fffd||fffd||fffd||fffd||fffd||155||82||fffd||fffd||fffd||14ed2||80b5||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
'    '|fffd||fffd||fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'    '|fffd||fffd||fffd|u|fffd|I|fffd||fffd||fffd||fffd||fffd||255||82||fffd||fffd||fffd|v|fffd|w|fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7d6||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd|
'    For i = 1 To 20
'        DoEvents
'        Sleep 100
'
'        '|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|
'        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
'        UIAutomationProxy.setFindTopCaption = DLG_D3_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
'        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
'        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D3_CAP
'        Set iElementT = uiGetElementFromHandle()
'        If Not iElementT Is Nothing Then
'            Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||64fe|"
'            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|")
'            If Not iElementE Is Nothing Then
'                DoEvents
'                Sleep 100
'                Call uiDoAction(iElementE)
'            Else
'                Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
'            End If
'        End If
'    Next
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||155||82||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd||82||fffd||fffd||fffd|
    If mdlIE8AutoClose = False Then
        
        '|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd|
        blnClicked = False
        UseTime = 0
        startTime = GetTickCount
        Do
            DoEvents
            Sleep 100
                        
            '|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|
            UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
            UIAutomationProxy.setFindTopCaption = DLG_D3_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
            UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D3_CAP
            Set iElementT = uiGetElementFromHandle()
            If Not iElementT Is Nothing Then
                Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||64fe|"
                Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|")
                If Not iElementE Is Nothing Then
                    DoEvents
                    Sleep 100
                    Call uiDoAction(iElementE)
                    blnClicked = True
                    '|fffd||fffd||fffd||303||fffd||fffd|[|fffd|v|fffd||150||fffd||fffd||fffd|E|fffd|o
                    Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            Else
                If blnClicked = True Then
                    Log "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||243|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||202||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd|E|fffd|o"
                    Exit Do
                Else
                    Log "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            End If
            
            UseTime = GetTickCount - startTime
            
        Loop While UseTime < waitTime
        If UseTime >= waitTime Then
            msg = "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    
    End If
    
    '|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
                    
        '|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_D3_CAP                        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_D3_CAP
        Set iElementT = uiGetElementFromHandle()
        If iElementT Is Nothing Then
            '|fffd||fffd||fffd||fffd|E|fffd|o
            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_D3_CAP
            Exit Do
        Else
            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||702||fffd||fffd|F" & DLG_D3_CAP
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    '<-2015/02/25 |fffd||fffd||fffd||fffd||fffd||155||82||fffd||fffd||fffd||14ed2||80b5||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
    
    dailogAfterSaveUntilIe8 = True
    
    endOf "dailogAfterSaveUntilIe8"

End Function
        
'|fffd|BIE9|fffd||20d|~|fffd||301|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|@|fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||fffd||82||fffd||fffd||fffd|
'|fffd||fffd||28f||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
Private Function dailogAfterSaveFromIe9(pElement As IUIAutomationElement, ByVal findDaialog As Long) As Boolean
    startOf "dailogAfterSaveFromIe9"
    Dim iElementM   As IUIAutomationElement                                 '|fffd||fffd||fffd||517|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    
    Dim strType     As String
    Dim strText     As String
    Dim msg As String
    
    Dim startTime As Long
    Dim UseTime As Long
    Dim waitTime    As Long
    
    dailogAfterSaveFromIe9 = False
    
    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms
    
    '|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||292|m|fffd|o|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
    If findDaialog = 1 Then
        '|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd|
        Log "|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd||310||64ea||fffd||308||a5d7||fffd||fffd||fffd||682||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
        Set iElementM = uiGetElementByType(pElement, "|fffd||a5d7||fffd||fffd||fffd||fffd|")                   '|fffd||a5d7||fffd||fffd||fffd||682||30d||14f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
        If iElementM Is Nothing Then
            msg = "|fffd||a5d7||fffd||fffd||fffd||682||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    End If
    If findDaialog = 2 Then
        '|fffd||292|m|fffd|o|fffd|[|fffd||30f||a347||fffd||341|A|fffd||fffd||fffd||517|p|fffd||fffd|TOP|fffd|p|fffd||193||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
        Set iElementM = pElement
    End If
    
    '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|[|fffd|W
    '- |fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd||142||341|A|fffd|e|fffd|L|fffd|X|fffd|g|fffd||302|R|fffd||90||fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||202||fffd||fffd||202||fffd|A|fffd||fffd||fffd||fffd||fffd|N|fffd||242||fffd||fffd||fffd||fffd|
    '- |fffd||292|m|fffd|o|fffd|[|fffd||142||341|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||182||202||fffd|
    Log "|fffd||fffd||282||142||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd|"
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
    
        '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O
        If findDaialog = 1 Then
            Log "|fffd||14f||fffd||fffd||30e|q|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||64fe|"
            Set iElementE = uiGetFirstChildElement(iElementM)
            If Not iElementE Is Nothing Then
                '|fffd||14f||fffd||fffd||30e|q|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||302|R|fffd||90||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|e|fffd|L|fffd|X|fffd|g|fffd||142||202||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||242||202||fffd||302||fffd||fffd||fffd||fffd||fffd|j
                '|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||38f||6c2||fffd||fffd||64fe||fffd|i|fffd||fffd|l|fffd||341|A|fffd||fffd||fffd||5c2||111||38f||6c1|jWin7|fffd||fffd|Win8|fffd||143|^|fffd|C|fffd|v|fffd||fffd||fffd||fffd||fffd||642||202||fffd|i"|fffd|n|fffd|C|fffd|p|fffd|[|fffd||fffd||fffd||fffd||fffd|N" or "|fffd||fffd||fffd||fffd||fffd|N"|fffd|j
                Log "|fffd||14f||fffd||fffd||30e|q|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||302|R|fffd||90||fffd||fffd||fffd||fffd||fffd||fffd|"
                Set iElementE = uiGetNextSiblingElement(iElementE, 3)
                If Not iElementE Is Nothing Then
                    Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd||64fe|"
                    strType = uiGetElementType(iElementE)
                    '-> 2015/12/14 |fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|u|fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||30f||a347||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||20a|O|fffd||30f||a347||fffd|i|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd|h|fffd||fffd|
                    If InStr(strType, "|fffd|e|fffd|L|fffd|X|fffd|g") > 0 Then
                        Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd||64fe|"
                        strText = uiGetElementName(iElementE)
                        If InStr(strText, "|fffd||fffd||fffd|s") > 0 Or InStr(strText, "|fffd|G|fffd||fffd||fffd|[") > 0 Then
                            msg = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|F" & strText
                            Log msg
                            mdlErrDescription = msg
                            Exit Function
                        Else
                            Log "|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd||302||fffd||fffd||7c3||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|"
                            startTime = GetTickCount
                        End If
                    End If
                    '<- 2015/12/14 |fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|u|fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||30f||a347||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||20a|O|fffd||30f||a347||fffd|i|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd|h|fffd||fffd|
                    If InStr(strType, "|fffd||fffd||fffd||fffd||fffd|N") > 0 Then
                        '|fffd||82||fffd||fffd||fffd||fffd||fffd||64fe|
                        Log "|fffd|u|fffd||82||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|"
                        Set iElementE = uiGetElementByTypeAndName(pElement, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|(C)")
                        If Not iElementE Is Nothing Then
                            Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||302||152|E|fffd|o"
                            Exit Do
                        End If
                    Else
                        Log "|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||243||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||702||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                    End If
                Else
                    Log "|fffd||14f||fffd||fffd||30e|q|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||302|R|fffd||90||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            Else
                Log "|fffd||14f||fffd||fffd||30e|q|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        End If
        
        '|fffd||292|m|fffd|o|fffd|[
        If findDaialog = 2 Then
            Log "|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd|"
            Set iElementE = uiGetElementByTypeAndName(iElementM, "|fffd|e|fffd|L|fffd|X|fffd|g", "|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g")
            If Not iElementE Is Nothing Then
                Log "|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||64fe|"
                strText = uiGetElementValue(iElementE)
                '-> 2015/12/14 |fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|u|fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||30f||a347||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||20a|O|fffd||30f||a347||fffd|i|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd|h|fffd||fffd|
                If InStr(strText, "|fffd||fffd||fffd|s") > 0 Or InStr(strText, "|fffd|G|fffd||fffd||fffd|[") > 0 Then
                    msg = "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|F" & strText
                    Log msg
                    mdlErrDescription = msg
                    Exit Function
                Else
                    Log "|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd||302||fffd||fffd||7c3||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|"
                    startTime = GetTickCount
                End If
                '<- 2015/12/14 |fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|u|fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||30f||a347||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||20a|O|fffd||30f||a347||fffd|i|fffd|X|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd|j|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd|h|fffd||fffd|
                Log "|fffd||6d1||fffd||fffd||fffd||fffd|Value|fffd|F" & strText
                If InStr(strText, "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|") > 0 Then
                    '|fffd||82||fffd||fffd||fffd||fffd||fffd||64fe|
                    Log "|fffd|u|fffd||82||fffd||fffd||fffd|v|fffd||fffd||fffd||64fe|"
                    Set iElementE = uiGetElementByTypeAndName(pElement, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|")
                    If Not iElementE Is Nothing Then
                        Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||302||152|E|fffd|o"
                        Exit Do
                    End If
                Else
                    Log "|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||702||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            Else
                '|fffd|C|fffd||fffd||fffd|^|fffd|l|fffd|b|fffd|g|fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|E|fffd|Y|fffd||fffd||fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||30a||fffd||fffd||fffd||fffd||fffd||292|m|fffd||fffd||fffd||fffd|v|fffd|F|fffd|I|fffd|t
                Log "|fffd|u|fffd||292|m|fffd|o|fffd|[|fffd||303|e|fffd|L|fffd|X|fffd|g|fffd|v|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||fffd||fffd||7ce||fffd||fffd||fffd||fffd||155||82||fffd||fffd||fffd||fffd||194||fffd||fffd|f|fffd||fffd||fffd|E|fffd|o"
                Exit Do
            End If
        End If
        
       UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|u|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||315|\|fffd||fffd||fffd|v|fffd||702||fffd||fffd||fffd| |fffd||292|m|fffd|o|fffd|[|fffd||30f|I|fffd||fffd||fffd|m|fffd|F|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    DoEvents
    Sleep 100
    
    If Not iElementE Is Nothing Then
        '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||702||fffd||fffd||352||292|m|fffd|o|fffd|[|fffd||fffd||82||fffd||fffd||fffd|
        Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||702||fffd||fffd||341|u|fffd||292|m|fffd|o|fffd|[|fffd|v|fffd||fffd||82||fffd||fffd||702||fffd|"
        If uiDoAction(iElementE) = False Then
            msg = "|fffd||82||fffd||fffd||fffd||fffd||fffd|s|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    End If
    
    dailogAfterSaveFromIe9 = True
    
    endOf "dailogAfterSaveFromIe9"

End Function

'->|fffd||fffd||fffd||fffd||fffd||20d|~zip|fffd||fffd||fffd|e|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|
'|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|tzip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||13002||fffd||fffd|A|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@|fffd||13017|pVBS|fffd||fffd||fffd||c42c||fffd||fffd||fffd||53bca||fffd||fffd||fffd||fffd|s|fffd|i|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||343|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
'|fffd|@|fffd|A|fffd|_|fffd|C|fffd||fffd||fffd|O|fffd||251||382||fffd||fffd||103|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|AOK|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd|@|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||341|A"/"|fffd||fffd||602||fffd||155||50b|p|fffd||fffd||fffd||fffd|B
Public Function getUnzipFiles(ByVal zipFile As String, ByVal Pass As String, _
                    Optional ByVal ExtractDir As String = "", Optional ByVal zipDelete As Boolean = True) As String
    startOf "getUnzipFiles"
    Dim objWShell   As Object
    Dim vbsFile     As String
    Dim copyToDir   As String
    Dim unzipFiles  As String
    Dim ary()       As String
    Dim i       As Long
    Dim msg As String
    
    '|fffd||fffd||fffd||fffd||fffd||fffd|
    If mdlShell|fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||151||fffd||482||fffd|
    End If
    mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = ""
    mdlErrDescription = ""
    
    '|fffd||13003|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
    If fileExists(zipFile) = False Then
        msg = "zip|fffd||13001|F|fffd||13003|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf & "zipFile|fffd|F" & zipFile
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd|W|fffd|J|fffd||fffd||64fe|
    If ExtractDir = "" Then
        copyToDir = getFolderName(zipFile)
    Else
        copyToDir = ExtractDir
    End If
    
    '|fffd||fffd||fffd||1300c||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe|
    Log "|fffd||1300c||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd|B"
    unzipFiles = getUnzipFileName(zipFile, copyToDir)
    If unzipFiles = "" Then
        msg = "zip|fffd||13001|F|fffd||1300c||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf & "zipFile|fffd|F" & zipFile
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
        
    '|fffd||fffd|vbs|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|j
    Log "|fffd||fffd|VBS|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd|B"
    vbsFile = getTmpFolderFile(VBS_FILE_NAME)
    
    '|fffd||fffd||fffd||fffd|VBS|fffd||48f|W|fffd||fffd||fffd|o|fffd||fffd|
    Log "|fffd||fffd|VBS|fffd||fffd||48f|W|fffd||fffd||fffd|o|fffd||342||fffd||fffd||702||fffd||fffd|B"
    Call writeUnzipVbs(vbsFile, zipFile, copyToDir)
    
    '|fffd||fffd||fffd||fffd||fffd|O|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc|
    Log "|fffd||fffd||fffd|O|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B"
    ary = Split(unzipFiles, FILE_SEP_STR)
    On Error Resume Next
    For i = 0 To UBound(ary)
        Kill ary(i)
    Next
    On Error GoTo 0
    
    '|fffd||fffd||fffd||fffd|VBS|fffd|N|fffd||fffd||fffd|i|fffd||53bca||fffd||fffd||14d|s|fffd||fffd||fffd|j
    '|fffd|@32bit|fffd|p|fffd||fffd|cmd|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|i|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    '|fffd|Bcmd|fffd||354||fffd|\|fffd||fffd||fffd||14b|N|fffd||fffd||fffd||fffd|vbs|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||202||fffd|
    DoEvents
    Sleep 10
    Set objWShell = CreateObject("Wscript.Shell")
    #If Win64 Then
    Log "SysWoW64 cmd|fffd|N|fffd||fffd||fffd|F" & vbsFile
    objWShell.Run "%windir%\SysWoW64\cmd.exe /c ""cscript.exe """ & vbsFile & """""", vbHide, False
    #Else
    Log "cmd|fffd|N|fffd||fffd||fffd|F" & vbsFile
    objWShell.Run "%windir%\System32\cmd.exe /c ""cscript.exe """ & vbsFile & """""", vbHide, False
    #End If
    DoEvents
    Sleep 100
    
    '|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||341|AOK|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd|W|fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd|A|fffd|W|fffd|J|fffd||3c2||742||30f||a347||fffd||342||202||242||fffd||fffd||fffd||fffd||202||fffd|
    '2013/09/20 |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||1c9||fffd|
    Log "|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd||249||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B"
    If setPasswordOk(unzipFiles, Pass) = False Then
        '>2013/09/20 |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc||fffd||1c9||fffd|
        On Error Resume Next
        Kill zipFile
        On Error GoTo 0
        '<2013/09/20 |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc||fffd||1c9||fffd|
        msg = "zip|fffd||13001|F|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||309||fffd||fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & _
                "|fffd|i|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j" & vbLf & vbLf & _
                "zipFile|fffd|F" & zipFile
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|W|fffd|J|fffd||fffd||fffd||a0bd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
    Log "|fffd||1300d||3c3|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd||fffd|B"
    If chekFileExists(unzipFiles) = False Then
        '>2013/09/20 |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc||fffd||1c9||fffd|
        On Error Resume Next
        Kill zipFile
        On Error GoTo 0
        '<2013/09/20 |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc||fffd||1c9||fffd|
        msg = "zip|fffd||13001|F|fffd||1300c||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf & _
                "zipFile|fffd|F" & zipFile & vbLf & "unzipFile|fffd|F" & unzipFiles
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd|s|fffd|v|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30d||d3dc|
    Log "|fffd|s|fffd|v|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B"
    On Error Resume Next
    Kill vbsFile
    If zipDelete = True Then
        Kill zipFile
    End If
    
    getUnzipFiles = unzipFiles
    
    endOf "getUnzipFiles"
End Function

'zip|fffd||312||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34b||fffd||602||8576||fffd||fffd||fffd|j
Private Function getUnzipFileName(ByVal zipFile As String, Optional ByVal copyToDir As String = "") As String
    Dim oApp    As Object
    Dim oitem   As Object
    Dim files   As String
        
    getUnzipFileName = ""
        
    'zip|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    Set oApp = CreateObject("Shell.Application")
    With oApp.Namespace(zipFile & "")
        For Each oitem In .items
            If files <> "" Then
                files = files & FILE_SEP_STR
            End If
            '->2015/02/25 |fffd|g|fffd||fffd||fffd|q|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|w|fffd||fffd||142||fffd||fffd|g|fffd||fffd||fffd|q|fffd|t|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd||fffd||302||14f|C|fffd||fffd|
            files = files & copyToDir & "\" & getFileName(oitem.path)
'            files = files & copyToDir & "\" & oitem.Name
'            '|fffd|g|fffd||fffd||fffd|q|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||752||80be||fffd||18a|g|fffd||fffd||fffd|q|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd||fffd||796||fffd||fffd||155||246b||fffd|i|fffd||fffd||fffd|S|fffd||142||202||fffd||fffd|j
'            If getExtName(oitem.Name) = "" Then
'                If InStr(UCase(oitem.Type), "|fffd|e|fffd|L|fffd|X|fffd|g") > 0 Then
'                    files = files & ".txt"
'                ElseIf InStr(UCase(oitem.Type), "CSV") > 0 Then
'                    files = files & ".csv"
'                ElseIf InStr(UCase(oitem.Type), "EXCEL") > 0 Then
'                    files = files & ".xls"
'                ElseIf InStr(UCase(oitem.Type), "WORD") > 0 Then
'                    files = files & ".doc"
'                ElseIf InStr(UCase(oitem.Type), "|fffd|v|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd|") > 0 Then
'                    files = files & ".ppt"
'                ElseIf InStr(UCase(oitem.Type), "ACCESS") > 0 Then
'                    files = files & ".mdb"
'                ElseIf InStr(UCase(oitem.Type), "PDF") > 0 Then
'                    files = files & ".pdf"
'                ElseIf InStr(UCase(oitem.Type), "WEB") > 0 Then
'                    files = files & ".htm"
'                ElseIf InStr(UCase(oitem.Type), "ZIP") > 0 Then
'                    files = files & ".zip"
'                End If
'            End If
            '<-2015/02/25 |fffd|g|fffd||fffd||fffd|q|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|w|fffd||fffd||142||fffd||fffd|g|fffd||fffd||fffd|q|fffd|t|fffd||fffd||fffd|t|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd||fffd||302||14f|C|fffd||fffd|
        Next
    End With
    Log "|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd|F" & files
    getUnzipFileName = files
End Function

'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe|
Private Function getTmpFolderFile(ByVal file As String) As String
    Dim sTmpPath As String * 512
    Dim ret As Long
    Dim tmpFolder   As String
    
    '|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|{|fffd||152||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    ret = GetTempPath(Len(sTmpPath), sTmpPath)
    tmpFolder = Trim(Left$(sTmpPath, InStr(sTmpPath, vbNullChar) - 1))
    getTmpFolderFile = tmpFolder & file
    endOf "getTmpFolderFile fullFile:" & getTmpFolderFile
End Function

'VBS|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||48f|W|fffd||fffd||fffd|o|fffd||fffd|
Private Sub writeUnzipVbs(ByVal vbsFile As String, ByVal zipFile As String, ByVal copyToDir As String)

    Dim s As String
    
    'zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|B|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
    s = s & "Option Explicit" & vbCrLf
    s = s & "Const ZIP_FILE = ""%ZIP_FILE%""" & vbCrLf
    s = s & "Const COPY_TO_DIR = ""%COPY_TO_DIR%""" & vbCrLf
    s = s & "'|fffd||fffd||fffd|C|fffd||fffd|" & vbCrLf
    s = s & "Dim oApp" & vbCrLf
    s = s & "Dim oItem" & vbCrLf
    s = s & "Dim fso" & vbCrLf
    s = s & "WScript.Sleep 10" & vbCrLf
    s = s & "Set fso = CreateObject(""Scripting.FileSystemObject"")" & vbCrLf
    s = s & "'zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|e|fffd||fffd||fffd|R|fffd|s|fffd|[" & vbCrLf
    s = s & "Set oApp = CreateObject(""Shell.Application"")" & vbCrLf
    s = s & "With oApp.Namespace(ZIP_FILE & """")" & vbCrLf
    s = s & "    For Each oItem In .items" & vbCrLf
    s = s & "       If fso.fileExists(COPY_TO_DIR & ""\"" & oItem.Name) Then" & vbCrLf
    s = s & "           fso.DeleteFile COPY_TO_DIR &  ""\"" & oItem.Name" & vbCrLf
    s = s & "       End If" & vbCrLf
    s = s & "    Next" & vbCrLf
    s = s & "    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||142||fffd|" & vbCrLf
    s = s & "    oApp.Namespace(COPY_TO_DIR).CopyHere .items" & vbCrLf
    s = s & "End With" & vbCrLf
    s = s & "Set oItem = Nothing" & vbCrLf
    s = s & "Set oApp = Nothing" & vbCrLf
    s = s & "Set fso = Nothing" & vbCrLf

    'zip|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||3ca||fffd|
    s = Replace(s, "%ZIP_FILE%", zipFile)
    '|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||3ca||fffd|
    s = Replace(s, "%COPY_TO_DIR%", copyToDir)
    
    '|fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||fffd||fffd|o|fffd||fffd|
    Dim FSO As Object
    Dim ctf As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    Set ctf = FSO.CreateTextFile(vbsFile, True)
    ctf.write s
    ctf.Close
    Set ctf = Nothing
    Set FSO = Nothing
    
    endOf "writeUnzipVbs"

End Sub

'|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
Private Function setPasswordOk(ByVal unzipFiles As String, ByVal Pass As String) As Boolean
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    Dim iElementW   As IUIAutomationElement                                 '|fffd||fffd||fffd|[|fffd|N|fffd|p
    
    Dim msg As String
        
    Dim swExtract   As String           ' ""|fffd|F|fffd||fffd||fffd||fffd||fffd|l|fffd|@0|fffd|F|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|@1|fffd|F|fffd||1300d||3c2||fffd|
    Dim ary()       As String
    Dim state       As String
    Dim i       As Long
    Dim blnClicked  As Boolean                                              '2015/03/02
    Dim tmpSize     As Long                                                 '2015/03/02
    
    Dim startTime   As Long
    Dim UseTime     As Long
    Dim waitTime    As Long
    
    setPasswordOk = False

    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms
    
    '|fffd||fffd||fffd||fffd|
    ary = Split(unzipFiles, FILE_SEP_STR)
    
    DoEvents
    Sleep 100
    '|fffd||fffd||fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||90a9|
    '|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|W|fffd|J|fffd||fffd||fffd||a0bd||fffd||fffd||fffd|F|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|s|fffd|v|fffd||30f||a347|
    '|fffd|@|fffd|iWin8|fffd||30f||a347||fffd||153||fffd||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||30f||a347||fffd||341|A|fffd||fffd||fffd||4e782||302||743|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||357|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        'TopWindow|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_P_CAP                         '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        '|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_P_CAP
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            
            Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd||fffd||fffd|F" & DLG_P_CAP
            '|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||242||fffd||85bc||fffd|O|fffd||fffd||fffd||642||202||fffd|
            Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h:")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
                swExtract = "0"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie9|fffd||20d|~|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
            Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h(P):")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
                swExtract = "0"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie8|fffd||211|O|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
            
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & DLG_P_CAP
        End If
        
        '|fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|
        Log "|fffd||fffd||fffd||142||249||1300d||3c2||742||fffd||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd|"
        state = String(UBound(ary) + 1, "0")
        For i = 0 To UBound(ary)
            DoEvents
            With CreateObject("Scripting.FileSystemObject")
                If .fileExists(ary(i)) = True Then         '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|True|fffd||182||202||fffd|
                    '->2015/03/02 |fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|isize|fffd||64fe||fffd||fffd||fffd||302||fffd|Resume|fffd|j
'                    On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
'                    With .getFile(ary(i))
'                        If .size > 0 Then
'                            Mid(state, i + 1, 1) = "1"
'                            Log "|fffd|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|BFile|fffd|F" & ary(i)
'                        End If
'                    End With
'                    On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    tmpSize = 0
                    On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    tmpSize = .getFile(ary(i)).size
                    On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    If tmpSize > 0 Then
                        Mid(state, i + 1, 1) = "1"
                        Log "|fffd|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|BFile|fffd|F" & ary(i)
                    End If
                    '->2015/03/02 |fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|isize|fffd||64fe||fffd||fffd||fffd||302||fffd|Resume|fffd|j
                  End If
            End With
        Next
        If state = String(UBound(ary) + 1, "1") Then        '|fffd||fffd||fffd||5c2||111||fffd||fffd||742||fffd||fffd||fffd|ALL"1"|fffd||182||202||fffd|
            Log "|fffd||fffd||fffd||5c2||102||313|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            swExtract = "1"
            Exit Do
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B" & "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||fffd|" & vbLf & "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||13002||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B"
        Exit Function
    End If
    
    '|fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||30f||a347||fffd|i|fffd||1300d||3c2||742||30f||a347||fffd||341|A|fffd||202||242||fffd||fffd||fffd||fffd||202||fffd||fffd|j
    If swExtract = "0" Then
        
        '|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|w|fffd||fffd|
        Log "Edit|fffd||243|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||702||fffd|"
        UseTime = 0
        startTime = GetTickCount
        Do
            DoEvents
            Sleep 100
                        
            Log "Edit|fffd||243|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd|"
            If uiSetElementValue(iElementE, Pass) = True Then
                Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||310||752||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                Exit Do
            Else
                Log "Edit|fffd||243|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
            End If
            
            UseTime = GetTickCount - startTime
            
        Loop While UseTime < waitTime
        If UseTime >= waitTime Then
            msg = "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Edit|fffd||243|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||752||80aa||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B|fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    
        '->2015/03/02 OK|fffd||fffd||fffd||fffd||fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||182||30a|m|fffd|F|fffd||fffd||283||fffd||fffd|[|fffd|v|fffd||255||fffd||fffd||fffd||fffd|i|fffd|Q|fffd||fffd||702||fffd||fffd||192|E|fffd|o|fffd||fffd||fffd||202||fffd||fffd|j
'        '|fffd||fffd||fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||103|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
'        UseTime = 0
'        StartTime = GetTickCount
'        Do
'            DoEvents
'            Sleep 100
'
'            '|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
'            Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|"
'            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "OK")
'            If Not iElementE Is Nothing Then
'                Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                Call uiDoAction(iElementE)
'
'                DoEvents
'                Sleep 100
'
'                '|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
'                UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
'                UIAutomationProxy.setFindTopCaption = DLG_P_CAP                         '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
'                UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
'                Log "|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
'                Set iElementW = uiGetElementFromHandle()
'                If iElementW Is Nothing Then
'                    '|fffd||fffd||fffd||fffd|E|fffd|o
'                    Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_P_CAP
'                    Exit Do
'                End If
'
'            Else
'                Log "|fffd||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
'            End If
'
'            UseTime = GetTickCount - StartTime
'
'        Loop While UseTime < waitTime
        '|fffd||fffd|OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|AOK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||302||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
        blnClicked = False
        UseTime = 0
        startTime = GetTickCount
        Do
            DoEvents
            Sleep 100
            
            'OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
            Log "OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "OK")
            If Not iElementE Is Nothing Then
                Log "OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Call uiDoAction(iElementE)
                blnClicked = True
                '|fffd||fffd||fffd||303||fffd||fffd|[|fffd|v|fffd||150||fffd||fffd||fffd|E|fffd|o
                Log "OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            Else
                If blnClicked = True Then
                    Log "|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd|E|fffd|o"
                    Exit Do
                Else
                    Log "OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                End If
            End If
            
            UseTime = GetTickCount - startTime
            
        Loop While UseTime < waitTime
        If UseTime >= waitTime Then
            msg = "OK|fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
                
        '|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||342||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
        UseTime = 0
        startTime = GetTickCount
        Do
            DoEvents
            Sleep 100
            
            '|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
            UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
            UIAutomationProxy.setFindTopCaption = DLG_P_CAP                         '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
            UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
            Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||342||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
            Set iElementW = uiGetElementFromHandle()
            If iElementW Is Nothing Then
                '|fffd||fffd||fffd||fffd|E|fffd|o
                Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_P_CAP
                Exit Do
            Else
                Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||702||fffd||fffd|F" & DLG_P_CAP
            End If
            
            UseTime = GetTickCount - startTime
            
        Loop While UseTime < waitTime
        '<-2015/03/02 OK|fffd||fffd||fffd||fffd||fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||182||30a|m|fffd|F|fffd||fffd||283||fffd||fffd|[|fffd|v|fffd||255||fffd||fffd||fffd||fffd|i|fffd|Q|fffd||fffd||702||fffd||fffd||192|E|fffd|o|fffd||fffd||fffd||202||fffd||fffd|j
    
        
        '>2013/09/20 |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||839e||fffd||311||389||fffd||fffd||1c9||fffd| -------------------------------
        '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
        '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|u|fffd||fffd||fffd|k (zip |fffd|`|fffd||fffd|) |fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|[ |fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd||fffd||fffd|I|fffd||fffd||fffd|@|fffd||142||fffd||fffd||fffd||18f|I|fffd||fffd||fffd|
        DoEvents
        Sleep 100
        '|fffd|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
        Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|"
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_P_CAP_ERR                     '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\"
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
        
            '|fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|o
            Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            
            DoEvents
            Sleep 100
            Log "|fffd|u|fffd|G|fffd||fffd||fffd|[|fffd|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd|"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|")
            If Not iElementE Is Nothing Then
                Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                Call uiDoAction(iElementE)
            
                DoEvents
                Sleep 100
                UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
                UIAutomationProxy.setFindTopCaption = DLG_P_CAP                         '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
                UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
                Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||342||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
                Set iElementT = uiGetElementFromHandle()
                If Not iElementT Is Nothing Then
                    DoEvents
                    Sleep 100
                    Log "|fffd||115|\|fffd||fffd||fffd||301|u|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||313||fffd||fffd||341|v|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd|"
                    Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd|{|fffd|^|fffd||fffd|", "|fffd||82||fffd||fffd||fffd|")
                    If Not iElementE Is Nothing Then
                        Log "|fffd||82||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                        Call uiDoAction(iElementE)
                    End If
                End If
            End If
            '|fffd|G|fffd||fffd||fffd|[|fffd|E|fffd|o
            Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|G|fffd||fffd||fffd|[|fffd||302||fffd||fffd||7cf|I|fffd||fffd|"
            Exit Function
        End If
        '<2013/09/20 |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||839e||fffd||311||389||fffd||fffd||1c9||fffd| -------------------------------
    End If
        
    setPasswordOk = True
End Function

'|fffd|W|fffd|J|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||fffd||fffd||4ce||fffd||fffd|j
Private Function chekFileExists(ByVal unzipFiles As String) As String
    Dim ary()       As String
    Dim state       As String
    Dim i       As Long
    Dim tmpSize     As Long                                                 '2015/03/02
    
    Dim startTime   As Long
    Dim UseTime     As Long
    Dim waitTime    As Long
    
    chekFileExists = False
    
    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms
        
    '|fffd||fffd||fffd||fffd|
    ary = Split(unzipFiles, FILE_SEP_STR)
        
    DoEvents
    Sleep 100
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c2||111||fffd||fffd||742||fffd||fffd||fffd||702||fffd|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 10
    
        '|fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd|
        state = String(UBound(ary) + 1, "0")
        For i = 0 To UBound(ary)
            DoEvents
            With CreateObject("Scripting.FileSystemObject")
                If .fileExists(ary(i)) = True Then         '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|True|fffd||182||202||fffd|
                    '->2015/03/02 |fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||3cd|X|fffd|isize|fffd||64fe||fffd||fffd||fffd||302||fffd|Resume|fffd|j
'                    On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
'                    With .getFile(ary(i))
'                        If .size > 0 Then
'                            Mid(state, i + 1, 1) = "1"
'                            Log "|fffd|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|BFile|fffd|F" & ary(i)
'                        End If
'                    End With
'                    On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    tmpSize = 0
                    On Error Resume Next                        '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    tmpSize = .getFile(ary(i)).size
                    On Error GoTo 0                             '2015/02/25 getFile|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
                    If tmpSize > 0 Then
                        Mid(state, i + 1, 1) = "1"
                        Log "|fffd|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|BFile|fffd|F" & ary(i)
                    End If
                    
                  End If
            End With
        Next
        If state = String(UBound(ary) + 1, "1") Then        '|fffd||fffd||fffd||5c2||111||fffd||fffd||742||fffd||fffd||fffd|ALL"1"|fffd||182||202||fffd|
            Log "|fffd||fffd||fffd||5c2||102||313|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Exit Do
        End If
        
        UseTime = GetTickCount - startTime

    Loop While UseTime < waitTime * 3                       '3|fffd|{
    If state <> String(UBound(ary) + 1, "1") Then
        Log "|fffd|W|fffd|J|fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|Bstate|fffd|F" & state
        Exit Function
    End If
    
    chekFileExists = True
End Function
'<-|fffd||fffd||fffd||fffd||fffd||20d|~zip|fffd||fffd||fffd|e|fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|

Private Function fileExists(ByVal file As String) As Boolean
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    fileExists = FSO.fileExists(file)
    Set FSO = Nothing
End Function

Private Function getFolderName(ByVal file As String) As String
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    getFolderName = FSO.GetParentFolderName(file)
    Set FSO = Nothing
End Function

Private Function getFileName(ByVal file As String) As String
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    getFileName = FSO.getFileName(file)
    Set FSO = Nothing
End Function

Private Function getBaseName(ByVal file As String) As String
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    getBaseName = FSO.getBaseName(file)
    If Right(getBaseName, 1) = "." Then
        getBaseName = Left(getBaseName, Len(getBaseName) - 1)
    End If
    Set FSO = Nothing
End Function

Private Function getExtName(ByVal file As String) As String
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    getExtName = FSO.GetExtensionName(file)
    Set FSO = Nothing
End Function

'########################################################
'# type=file|fffd||301|u|fffd|Q|fffd||181|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'#   ie|fffd|FInternetExplorer
'#   targetElementObj|fffd|F|fffd||38f||6c2||fffd|HTMLInputElement
'#   |fffd||fffd||fffd|u|fffd|Q|fffd||181|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|L|fffd|[|fffd||fffd||fffd||fffd||142||202||fffd||fffd||181|A|fffd||fffd||fffd||301|u|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd||fffd||fffd||143|A|fffd|N|fffd|Z|fffd|X|fffd|G|fffd||fffd||fffd|[|fffd||182||202||fffd|B
'########################################################
' UIAutomation|fffd|g|fffd|p|fffd||242||fffd||fffd||fffd||fffd||fffd||fffd|FtargetElementObj|fffd||356||fffd||fffd|g|fffd|p
Public Function daialogUploadOpen(ie As InternetExplorer, targetElementObj As Object) As Boolean
    startOf "FileDaialogFactory.daialogUploadOpen"
    
    Dim iElementT    As IUIAutomationElement
    Dim iElementE    As IUIAutomationElement
    Dim msg     As String
    Dim ver     As Integer
    
    daialogUploadOpen = False
    
    'TopWindow|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    UIAutomationProxy.setTopHWnd = ie.hWnd                                  'ie|fffd|n|fffd||fffd||fffd|h|fffd||fffd|
    UIAutomationProxy.setFindTopCaption = ""                                '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
    UIAutomationProxy.setFindTopClass = ""                                  '|fffd||fffd||fffd|S|fffd||fffd|v
    '|fffd|z|fffd||fffd||fffd||fffd|UIAutomations|fffd||64fe||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    UIAutomationProxy.setChildHWnd = 0                                      '
    UIAutomationProxy.setFindChildCaption = ""                              '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
    UIAutomationProxy.setFindChildClass = "Internet Explorer_Server"        '|fffd||fffd||fffd|S|fffd||fffd|v
    '|fffd||fffd||fffd||fffd||fffd||38f||6c2||fffd||fffd||64fe|
    Set iElementT = uiGetElementFromHandle()
    If iElementT Is Nothing Then
        msg = "|fffd||38f||6c2||fffd|IE|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B|fffd|F" & "Internet Explorer_Server"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|
    'IE7,IE8|fffd|`|fffd||352|P|fffd||183|{|fffd|^|fffd||fffd|
    ver = 0
    Log "|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
    Set iElementE = uiGetElementByDescription(iElementT, "|fffd|Q|fffd||fffd|...")
    If iElementE Is Nothing Then
        ver = 1
        Log "IE6|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||183|{|fffd|^|fffd||fffd||fffd||142|P|fffd||82||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
        'IE6|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||183|{|fffd|^|fffd||fffd||fffd||142|P|fffd||fffd|
        Set iElementE = uiGetElementByDescription(iElementT, "Browse for file to upload")       'IE6|fffd||30f||a347|
        If iElementE Is Nothing Then
            msg = "UPLOAD|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    End If
    
    '|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|
    Log "|fffd|Q|fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
    If uiDoAction(iElementE) = False Then
        '0|fffd||20a|O|fffd||30f||a347||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
        If ver = 0 Then
            msg = "UPLOAD|fffd|Q|fffd||183|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    End If
    
    daialogUploadOpen = True
    
    endOf "FileDaialogFactory.daialogUploadOpen"
End Function

'########################################################
'# |fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
'#   upfullFile|fffd|F|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'########################################################
Public Function daialogUploadExecute(ByVal upfullFile As String) As Boolean
    startOf "FileDaialogFactory.daialogUploadExecute"
    Dim msg As String
    daialogUploadExecute = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd|
    If mdlShell|fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||151||fffd||482||fffd|
    End If
    If mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = 0 Then
        mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms          '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h
    End If
    mdlErrDescription = ""

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
    If fileExists(upfullFile) = False Then
        msg = "|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & "File|fffd|F" & upfullFile
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h
    If daialogUploadExecuteSub(upfullFile) = False Then
        msg = "|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||310||752||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|i|fffd||68d||5c1|F" & mdlErrDescription & "|fffd|j"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If

    daialogUploadExecute = True
    endOf "FileDaialogFactory.daialogUploadExecute"
End Function

'########################################################
'# |fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd|O|fffd||fffd||fffd||64fe||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
'#   upfullFile|fffd|F|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'########################################################
Private Function daialogUploadExecuteSub(ByVal upfullFile As String) As Boolean
    startOf "daialogUploadExecuteSub"
    'Vista|fffd||fffd||fffd||255||3cd|X|fffd||292|m|fffd||115c2||fffd||202||fffd||fffd||183|t|fffd||fffd||fffd|p|fffd|X|fffd|w|fffd||fffd||150||fffd||fffd||fffd||fffd||fffd||fffd||a3ca||fffd||255||6d1||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||302||148||a5e5||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
    #If Win64 Then
    Dim hTop    As LongPtr
    Dim hCmb    As LongPtr
    #Else
    Dim hTop    As Long
    Dim hCmb    As Long
    #End If
    
    Dim iElementT   As IUIAutomationElement                                 '|fffd|s|fffd|n|fffd|o|fffd|p
    Dim iElementE   As IUIAutomationElement                                 '|fffd||95||297|p
    Dim iElementW   As IUIAutomationElement                                 '|fffd||fffd||fffd|[|fffd|N|fffd|p
        
    Dim dispFile    As String
    Dim msg As String
    
    Dim startTime As Long
    Dim UseTime As Long
    Dim waitTime    As Long
    
    daialogUploadExecuteSub = False
    
    waitTime = mdlShell|fffd||151||fffd||482||fffd|ms
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd||fffd|X|fffd||fffd||fffd|[|fffd|v
    DoEvents
    Sleep mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
    
    '|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||103|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd|AEdit|fffd||fffd||fffd||fffd||fffd||64fe|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
        UIAutomationProxy.setFindTopCaption = DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8        '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
        UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
        Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd|F" & DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8
        Set iElementT = uiGetElementFromHandle()
        If Not iElementT Is Nothing Then
            '|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||242||fffd||85bc||fffd|O|fffd||fffd||fffd||642||202||fffd|
            Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|:")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie9|fffd||20d|~"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie9|fffd||20d|~|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
            Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
            Set iElementE = uiGetElementByTypeAndName(iElementT, "|fffd||48f|W", "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|(N):")
            If Not iElementE Is Nothing Then
                Log "Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd||64fe| ie8|fffd||211|O"
                Exit Do
            Else
                Log "Edit|fffd||48f|W|fffd||fffd||fffd||fffd||64fe||fffd|iie8|fffd||211|O|fffd|j|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
            End If
        Else
            Log "|fffd|s|fffd|n|fffd|o|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd|F" & DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|F" & DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|@Full Path |fffd|w|fffd||fffd|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        dispFile = uiGetElementValue(iElementE)
        Log "Edit|fffd||315|\|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd|F" & dispFile
        
        DoEvents
        Sleep 100
                
        Log "Edit|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||3cd|X"
        If uiSetElementValue(iElementE, upfullFile) = True Then
            DoEvents
            Sleep 100
            
            '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|Edit|fffd||315||3cd|X|fffd||292|m
            Log "|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|Edit|fffd||315||3cd|X|fffd||292|m|fffd||fffd||fffd|s|fffd||fffd|"
            hTop = uiGetElementHandle(iElementT)                                '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
            hCmb = uiGetElementHandle(uiGetParentElement(iElementE))            '|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
            Call PostMessage(hTop, WM_COMMAND, MAKEWPARAM(GetDlgCtrlID(hCmb), CBN_EDITCHANGE), ByVal hCmb)
            
            DoEvents
            Sleep 100
            
            dispFile = uiGetElementValue(iElementE)
            Log "Edit|fffd||315|\|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10e||64fe||fffd|F" & dispFile
            
            DoEvents
            Sleep 100
            
            '|fffd||752||80b5||fffd||fffd||fffd||fffd||fffd||302||18e||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|E|fffd|o|fffd|i|fffd||752||80b3||fffd||fffd||202||fffd||fffd||702||715||6d1||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|j
            If dispFile = upfullFile Then
                Log "|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd||fffd||fffd||fffd|i|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||30d||10a|m|fffd|FOK|fffd|j|fffd|E|fffd|o"
                Exit Do
            End If
        
        Else
            msg = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Log msg
        End If
        
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Edit|fffd||48f|W|fffd||fffd||fffd|Edit|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||310||752||80aa||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||82||fffd||fffd||103|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        
        '|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
        Log "|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|"
        'Vista|fffd|H|fffd|F|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd|u|fffd|{|fffd|^|fffd||fffd||fffd|v or |fffd|u|fffd|{|fffd|^|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd|v|fffd||30f||a347||fffd||fffd||fffd||90bd||fffd||7d6||fffd||fffd|O|fffd||14e||64fe|
        Set iElementE = uiGetElementByName(iElementT, "|fffd|J|fffd||fffd|(O)")
        
        '|fffd||64fe||fffd||142||fffd||fffd||fffd||fffd||a347|
        If Not iElementE Is Nothing Then
            Log "|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call uiDoAction(iElementE)
    
            DoEvents
            Sleep 100
            
            '|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd|v|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
            UIAutomationProxy.setTopHWnd = 0                                        '|fffd||fffd||fffd|g|fffd|p
            UIAutomationProxy.setFindTopCaption = DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8       '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
            UIAutomationProxy.setFindTopClass = "#32770"                            '|fffd||fffd||fffd|S|fffd||fffd|v
            Log "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|m|fffd|F"
            Set iElementW = uiGetElementFromHandle()
            If iElementW Is Nothing Then
                '|fffd||fffd||fffd||fffd|E|fffd|o
                Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||202||fffd||fffd||302||150||fffd||fffd||fffd|E|fffd|o|fffd|F" & DLG_U_CAP_UIE7 & "!" & DLG_U_CAP_FIE8
                Exit Do
            End If
        Else
            Log "|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
        End If
                
        UseTime = GetTickCount - startTime
        
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        msg = "|fffd|J|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
        
    daialogUploadExecuteSub = True
    
    endOf "daialogUploadExecuteSub"
End Function

'==2012/04/04 |fffd||fffd||fffd||20d|~ie9|fffd||292|m|fffd|o|fffd|[|fffd||389||fffd| ==================================================================================
'## IE|fffd||303||fffd||fffd|W|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B
Private Function getIeMajorVersion(ByRef ie As InternetExplorer) As Long
    On Error Resume Next
    Dim FSO As Object
    Dim ieVersion As String
    
    'IE|fffd|{|fffd||302||303|t|fffd|@|fffd|C|fffd||fffd||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    Set FSO = CreateObject("Scripting.FileSystemObject")
    ieVersion = FSO.GetFileVersion(ie.FullName)
    Set FSO = Nothing

    'IE|fffd||303||fffd||fffd|W|fffd||fffd||fffd|[|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
    getIeMajorVersion = CLng(Split(ieVersion, ".")(0))

End Function

#If Win64 Then
Private Function MAKEWPARAM(LOWWORD As Long, HIWORD As Long) As LongPtr
#Else
Private Function MAKEWPARAM(LOWWORD As Long, HIWORD As Long) As Long
#End If
    MAKEWPARAM = (LOWWORD And &HFFFF) Or (HIWORD * &H10000)
End Function



Attribute VB_Name = "IEhWnd"
'Option Explicit
'
'' /*******************************************
''  *    |fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||598|A(Office 64bit|fffd||389||fffd||fffd||3c2||fffd|)
''  *******************************************/
'#If Win64 Then
'Private Declare Function GetDesktopWindow Lib "user32" () As LongPtr
'Private Declare Function GetAncestor Lib "user32" (ByVal hWnd As LongPtr, ByVal gaFlags As LongPtr) As LongPtr
''Private Declare Function GetParent Lib "user32" (hWnd As LongPtr) As LongPtr
''|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||64fe||fffd||fffd||fffd||90bd||fffd||fffd|API
'Private Declare PtrSafe Function GetLastActivePopup Lib "user32" (ByVal hWnd As LongPtr) As LongPtr
''|fffd||8e||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||142||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
'Private Declare Function IsWindowVisible Lib "user32" (ByVal hWnd As Long) As LongPtr
'
''|fffd||7c2||fffd|l
'Public Type TargetHTMLDocument
'    htdoc As HTMLDocument
'    hWnd As LongPtr
'End Type
'
'#Else
'Private Declare Function GetDesktopWindow Lib "user32" () As Long
'Private Declare Function GetAncestor Lib "user32" (ByVal hWnd As Long, ByVal gaFlags As Long) As Long
''Private Declare Function GetParent Lib "user32" (hWnd As Long) As Long
''|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||64fe||fffd||fffd||fffd||90bd||fffd||fffd|API
'Private Declare Function GetLastActivePopup Lib "user32" (ByVal hWnd As Long) As Long
''|fffd||8e||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||142||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
'Private Declare Function IsWindowVisible Lib "user32" (ByVal hWnd As Long) As Long
'
''|fffd||7c2||fffd|l
'Public Type TargetHTMLDocument
'    htdoc As HTMLDocument
'    hWnd As Long
'End Type
'#End If
'
''|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe||fffd||312||8414||fffd|l
'Private Const GW_HWNDNEXT = 2
'Private Const GW_HWNDPREV = 3
'Private Const GW_HWNDOWNER = 4
'Private Const GW_HWNDCHILD = 5
'
'Private Const GA_PARENT = 1
'Private Const GA_ROOT = 2
'Private Const GA_ROOTOWNER = 3
'
'
'' API GetLastActivePopup|fffd||fffd||fffd|Q|fffd|l|fffd||242||fffd||fffd||702||fffd||fffd||fffd|
'' |fffd||38f||6c2||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A[-1] |fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'#If Win64 Then
'Public Function getTargetHTMLDocument(targetWindowText As String, Optional searchFrame As String, Optional searchTitle As String) As TargetHTMLDocument
'#Else
'Public Function getTargetHTMLDocument(targetWindowText As String, Optional searchFrame As String, Optional searchTitle As String) As TargetHTMLDocument
'#End If
'
'    startOf "getTargetHTMLDocument"
'
'#If Win64 Then
'    Dim hTemp As LongPtr
'    Dim hWndDialogChild As LongPtr
'#Else
'    Dim hTemp As Long
'    Dim hWndDialogChild As Long
'#End If
'
'    Dim targetDocument As HTMLDocument
'
'    Dim className As String     ' className|fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
'    Dim windowText As String    ' |fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
'
'    ' 1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
'    hTemp = GetWindow(GetDesktopWindow, GW_HWNDCHILD)
'
'    Do While hTemp <> 0
'
'        ' |fffd||8e||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
'        If CBool(IsWindowVisible(hTemp)) Then
'
'            windowText = Space(128)
'            Call GetWindowText(hTemp, windowText, Len(windowText))
'
'            className = Space(128)
'            Call getClassName(hTemp, className, Len(className))
'
'            Log "|fffd||fffd||fffd||fffd| hTemp : " & hTemp & ", windowText : " & Trim(windowText) & ", className : " & Trim(className)
'
'            ' windowText |fffd||24e|w|fffd||fffd||315||fffd||fffd||fffd||fffd||42a8a||702||702||fffd||102||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
'            If 0 < InStr(windowText, targetWindowText) Then
'
'                Log "|fffd||fffd||fffd||fffd| windowText |fffd||24e|w|fffd||fffd||315||fffd||fffd||fffd||fffd||42a8a||702||702||fffd||102||fffd||fffd||90b1||fffd||182||fffd||fffd||d0a9||fffd||fffd||fffd||fffd|"
'
'                hWndDialogChild = getChildByClassName(hTemp, "Internet Explorer_Server")
'                Log "|fffd||fffd||fffd||fffd| getChildByClassName |fffd||fffd||fffd||fffd| : " & hWndDialogChild
'
'                Set targetDocument = Nothing
'
'                On Error Resume Next
'                ' Web|fffd|y|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Document|fffd||fffd||fffd||64fe|
'                Log "|fffd||fffd||fffd||fffd| Web|fffd|y|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|Document|fffd||fffd||fffd||64fe|"
'                Set targetDocument = getHTMLDocument(hWndDialogChild) '@@@@@
'                On Error GoTo 0
'
'                '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90a9||fffd||fffd||fffd||fffd|
'                If InStr(targetDocument.Title, targetWindowText) > 0 Then
'
'                    '|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||30c||fffd||fffd||fffd|
'                    Dim i As Long
'                    For i = 0 To targetDocument.frames.Length - 1
'                        If (searchFrame = "" Or _
'                            targetDocument.frames(i).Name = searchFrame) _
'                        And (searchTitle = "" Or _
'                            InStr(targetDocument.frames(i).document.Title, searchTitle) > 0) _
'                        Then
'                            Set getTargetHTMLDocument.htdoc = targetDocument
'                            getTargetHTMLDocument.hWnd = hWndDialogChild
'                            Exit Do
'                        End If
'                    Next i
'                End If
'            End If
'        End If
'
'        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
'    Loop
'
'    endOf "getTargetHTMLDocument"
'End Function
'
'' |fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|z|fffd||fffd||fffd||30e|w|fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd|T|fffd||fffd||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
'' |fffd||fffd||fffd||702||14c||fffd||fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|
'#If Win64 Then
'Private Function getChildByClassName(ByVal hWnd As LongPtr, ByVal targetClassName As String) As LongPtr
'#Else
'Private Function getChildByClassName(ByVal hWnd As Long, ByVal targetClassName As String) As Long
'#End If
'
'    startOf "getChildByClassName"
'
'#If Win64 Then
'    Dim ret As LongPtr
'    Dim hTemp As LongPtr
'    Dim hTempNext As LongPtr
'#Else
'    Dim ret As Long
'    Dim hTemp As Long
'    Dim hTempNext As Long
'#End If
'
'    Dim className As String
'    Dim buff As Long
'
'    ' |fffd||fffd||fffd||fffd||fffd||fffd|
'    ret = 0
'
'    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
'    hTemp = GetWindow(hWnd, GW_HWNDCHILD)
'
'    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
'    Do While hTemp <> 0
'        '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
'        className = Space(30)
'        buff = getClassName(hTemp, className, Len(className))
'        Log "|fffd||fffd||fffd||fffd| hTemp : " & hTemp & ", className : " & className
'
'        If InStr(className, targetClassName) > 0 Then
'            ret = hTemp
'            Log "|fffd||fffd||fffd||fffd| |fffd|q|fffd||fffd||fffd|[|fffd|v |fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe| |fffd||fffd||fffd||fffd|"
'            Exit Do
'        End If
'
'        ' |fffd||10b|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|A|fffd||fffd||fffd||209||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd|
'        ret = getChildByClassName(hTemp, targetClassName)
'        If ret <> 0 Then
'            Log "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|[|fffd|v |fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe| |fffd||fffd||fffd||fffd|"
'            Exit Do
'        End If
'
'        ' |fffd||fffd||fffd||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
'        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
'    Loop
'
'    Log "|fffd||fffd||fffd||fffd| getChildByClassName |fffd||fffd||fffd||fffd| : " & ret
'    getChildByClassName = ret
'
'    endOf "getChildByClassName"
'End Function
'
''/*****************************************************************************
'' * |fffd||590||fffd||fffd||fffd||fffd|F waitForBrowseForIEDocument
'' * |fffd|T|fffd|v  |fffd|F ie.document |fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||251||382||fffd||fffd||fffd| waitForBrowse |fffd||fffd||fffd|s|fffd||fffd|
'' *****************************************************************************/
'Public Function waitForBrowseForIEDocument(ieDocument As HTMLDocument, Optional Milliseconds As Long = 100, Optional RetryCount As Long = 5) As WAIT_BROWSE_RESULT
'    startOf "waitForBrowseForIEDocument"
'
'    Dim i As Long
'    Dim readyState As String
'
'    Dim waitTime As Long
'    Dim startTime As Long
'    Dim UseTime As Long
'
'    waitTime = 5000
'    UseTime = 0
'    startTime = GetTickCount
'
'    For i = 0 To RetryCount
'        Log i + 1 & "|fffd||fffd||682||311||482||fffd||fffd||fffd|"
'        Do
'            DoEvents
'            Sleep 10                    ' 1.72
'
'            UseTime = GetTickCount - startTime
'
'            On Error Resume Next
'            readyState = ""
'            readyState = UCase(ieDocument.readyState)
'            On Error GoTo 0
'        Loop While readyState <> "COMPLETE" And UseTime < waitTime
'        Sleep Milliseconds
'    Next
'
'    waitForBrowseForIEDocument = WAIT_SUCCEEDED  ' |fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||502||fffd|
'
'    endOf "waitForBrowseForIEDocument"
'End Function
'
''/*****************************************************************************
'' * |fffd||590||fffd||fffd||fffd||fffd|F getParentIEhWnd
'' * |fffd|T|fffd|v  |fffd|F ie.document |fffd||fffd| [hWnd] |fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||101|A ie |fffd||fffd| [hWnd] |fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'' *****************************************************************************/
'#If Win64 Then
'Public Function getParentIEhWnd(hWnd As LongPtr) As LongPtr
'    startOf "getParentIEhWnd"
'#Else
'Public Function getParentIEhWnd(hWnd As Long) As Long
'#End If
'
'#If Win64 Then
''    Dim hDesktop As LongPtr
''    Dim hParent As LongPtr
'    Dim hTemp As LongPtr
'#Else
''    Dim hDesktop As Long
''    Dim hParent As Long
'    Dim hTemp As Long
'#End If
'
''    ' |fffd||fffd||fffd||fffd|c|fffd|l|fffd||fffd| [hWnd] |fffd||fffd||fffd||64fe|
''    hDesktop = GetDesktopWindow
''
''    ' 1|fffd||fffd|e|fffd||fffd| [hWnd] |fffd||fffd||fffd||64fe|
''    hParent = GetParent(hWnd)
''
''    ' |fffd|e|fffd||310|e|fffd||fffd|...|fffd||fffd| [hWnd] |fffd||fffd||fffd||64fe||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|c|fffd|l|fffd||fffd| [hWnd] |fffd||182||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|1|fffd||fffd|q|fffd||fffd| [hWnd] |fffd||fffd||502||fffd|
''    Do While hParent <> hDesktop
''
''        hTemp = hParent
''        hParent = GetParent(hParent)
''    Loop
'
'    hTemp = GetAncestor(hWnd, GA_PARENT)
'
'    getParentIEhWnd = hTemp
'    endOf "getParentIEhWnd"
'End Function
Attribute VB_Name = "JK_Security"
' 2018/04/24 |fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||94|\|fffd||fffd||fffd||fffd||fffd||fffd||8414||fffd||fffd|(DATA_SAVE_LIMIT_MONTH)
'            |fffd||fffd||fffd||fffd||fffd||14b|L|fffd||682||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|\|fffd|[|fffd|X|fffd||30d||c42c||fffd||482||fffd||fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|
'            |fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||60a4||fffd||fffd||fffd|C
'            |fffd||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||6c2||fffd|Dummy|fffd|V|fffd|[|fffd|g|fffd||302||742||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||249||fffd||fffd|C
'            |fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||315||6d1||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||6c2||fffd|Dummy|fffd|V|fffd|[|fffd|g|fffd||302||742||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||249||fffd||fffd|C
'            |fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd||6c2||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||60a4||fffd||249||fffd||fffd|C
'            |fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||255||82||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||1c9||fffd|
'            |fffd||1c2||74e||fffd||fffd||fffd|p|fffd||14a|J|fffd||fffd||fffd||a0bd||fffd||6c2||250||fffd||fffd||fffd||255||82||fffd||fffd||90b1||fffd||182||fffd||fffd||142||fffd||fffd||fffd||60a4||fffd||fffd||fffd|C
'            |fffd||fffd|L|fffd||315||3cd|X|fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd||1c9||fffd|
'            JK_BeforeSave|fffd|GetDateSaveLimit|fffd|RememberVisibleStatus|fffd|RestoreVisibleStatus|fffd|
'            OnlyDummySheetVisible|fffd|JK_SaveWithOnlyDummySheetVisible|fffd|JK_CloseWithoutSaving

Option Explicit

'===========================================================
'===                     JK_Security                     ===
'===========================================================
'|fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||389||fffd||fffd|p|fffd|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|
'
'**********************
' |fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||8414|
'**********************
'|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|t|fffd|H|fffd|[|fffd||fffd|Cancel|fffd||fffd||fffd|f|fffd|p
Public Const GC_PASSWORD_CANCEL     As String = "False________________"
'INI|fffd|V|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd|s
Public Const PC_LINE_DATA          As Integer = 2
Public gstrOutputPassWord   As String   '|fffd|o|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd||1ce||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|C - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --------------------------------------
'|fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||94|\|fffd||fffd||fffd||fffd|
Public Const DATA_SAVE_LIMIT_MONTH As Long = 13
'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|C - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --------------------------------------
'**********************
' |fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd|
'**********************
'|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|t|fffd||fffd||fffd|O
Public forceClose As Boolean
'|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd|t|fffd||fffd||fffd|O
Public saveByMacro As Boolean
'|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|V|fffd|[|fffd|g
Private activeSht As Worksheet
'|fffd|V|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|
Private shtStatusBackups() As shtStatus

'**********************
' |fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd|`|fffd|^
'**********************
Private Type shtStatus
    shtName As String
    shtVisible As Integer
End Type

'===========================================================
'===                       JK_Joho                       ===
'===========================================================

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'                |fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||12d09||7c2||fffd||fffd||102||fffd||fffd||90cc||fffd|R|fffd|[|fffd|h|fffd||fffd|
'                |fffd||fffd||fffd||fffd||fffd||18d||d3dc||fffd||fffd||fffd|s|fffd||fffd||fffd|B
'
'Create Date    :2005/5/12
'Auther         :A.Y
'***********************************************************
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|@ - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --------------------------------------
    '|fffd|N|fffd||fffd||fffd||fffd||fffd||243|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|L|fffd|q
    shtInputInfo.Select
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|@ - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --------------------------------------
    
    
    '2.|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||12d09||7c2||fffd||fffd||102||fffd||fffd||90a9||fffd||1c2||fffd||fffd||fffd||fffd||314||fffd||fffd||fffd|
    '2-1.|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||12d09||7c2||fffd||fffd||102||fffd||fffd||90cc||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||d3dc||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If DateAdd("m", DATA_SAVE_LIMIT_MONTH, Sheets("INI").Cells(PC_LINE_DATA, 5).Value) <= Date Then
    
        '3.MsgBox|fffd|u|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd||705b||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd|S|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H|fffd|v
        '3-1.|fffd|u|fffd||342||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||209||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|B
        If MsgBox("|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd|" & DATA_SAVE_LIMIT_MONTH & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd|S|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
            Chr(10) & "|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbExclamation + vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||d3dc||fffd||30a|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W") = vbYes Then
            
            '  |fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||12d09||7c2||fffd||fffd||102||fffd||fffd||90cc||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||d3dc||fffd|i|fffd||38f||6c2||303|V|fffd|[|fffd|g|fffd||194||348||342||fffd|K|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
            'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|A - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ------------------------------
            With shtList
                .Range(.Cells(ROW_shtList.|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O), .Cells(.Cells.SpecialCells(xlCellTypeLastCell).row, COL_shtList.|fffd|@|fffd|l|fffd||90|l|fffd||656a|)).ClearContents
            End With
'            Sheets(xxxx).Range("aaa:zzz").ClearContents
'            Sheets(xxxx).Range("aaa:zzz").ClearContents
            'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|A - |fffd||fffd||fffd||fffd||fffd||702||fffd| ------------------------------


            '|fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24d|X|fffd|V
            Sheets("INI").Cells(PC_LINE_DATA, 5).Value = Date

            Call MsgBox("|fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd|", vbInformation + vbOKOnly, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W")
    
         Else
        '3-2.|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|A|fffd||209||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|B
    
            Call MsgBox("|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||7c3|f|fffd|[|fffd|^|fffd||34d||d3dc||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd|B" & vbCrLf & _
                "|fffd||702||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd||242||34c||90|l|fffd||fffd||42a8a||702||702||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                "|fffd||fffd||8235||fffd||fffd||fffd||24f|\|fffd||fffd||fffd||fffd||fffd||4c2||fffd||fffd||fffd||182||182||fffd||fffd||241|A|fffd|s|fffd|v|fffd||203|f|fffd|[|fffd|^|fffd||355||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd||702||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||58e||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||94|\|fffd||fffd||fffd||302||fffd||fffd||fffd|p|fffd|\|fffd|R|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||6d1||fffd||fffd||34d||14f||fffd||fffd||fffd||fffd||24e|~|fffd||7c2||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", _
                vbExclamation + vbOKOnly, "|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c3|f|fffd|[|fffd|^|fffd||24a||582||fffd||fffd||948d||fffd||fffd|")
                
        End If
    End If
    
    If ThisWorkbook.ReadOnly <> True Then
        '|fffd||1c2||74e||fffd||fffd||fffd|p|fffd||142||202||fffd||fffd||fffd||388||fffd|U|fffd||6d1||fffd||fffd||fffd||fffd||fffd|
        Call JK_SaveWithOnlyDummySheetVisible
    End If
EH:
End Sub

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|B
'
'Create Date    :2005/03/14
'Auther         :S.H(FSIABC)
'***********************************************************
Public Function Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|()
    Sheets("Dummy").Visible = xlSheetVisible
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|B
'
'Create Date    :2005/03/14
'Auther         :S.H(FSIABC)
'***********************************************************
Public Function Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|()
    Sheets("Dummy").Visible = xlSheetVeryHidden
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|B
'
'Create Date    :2005/03/17
'Auther         :S.H(FSIABC)
'***********************************************************
Public Function Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|()

    With ThisWorkbook
        '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd|w|fffd||289||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c2||243|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|B
        .Activate
    End With


    'Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|i|fffd|K|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|B - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --------------------------------------
    '|fffd|c|fffd|[|fffd||fffd||fffd||30e|g|fffd|p|fffd||fffd||fffd||255|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd|xlSheetVisible|fffd||250||752||80b7||fffd||fffd|
    shtList.Visible = xlSheetVisible
    shtInputInfo.Visible = xlSheetVisible

    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|)|fffd|B - |fffd||fffd||fffd||fffd||fffd||702||fffd| --------------------------------------

End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|B
'
'Create Date    :2005/03/14
'Auther         :S.H(FSIABC)
'***********************************************************
Public Function Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|()
    
    Dim intCnt  As Integer
    Dim intMsg  As Integer
    Dim sht     As Worksheet

    With ThisWorkbook
        '|fffd||fffd||fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd|w|fffd||289||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c2||243|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|B
        .Activate
    
        '|fffd||6cc||fffd||fffd||fffd||fffd|
        Sheets("Dummy").Select

        'Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|B
        For Each sht In .Worksheets
            If (sht.Name <> "Dummy") Then
                sht.Visible = xlSheetVeryHidden
            End If
        Next sht

    End With
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :SaveThisBook
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Excel97|fffd||14f||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||262||fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||34d||150|V|fffd||142||fffd|...|fffd|
'                |fffd||183||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|h|fffd||fffd||fffd||14f||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd|
'|fffd||c42c||fffd||fffd|         :2007/01/10
'|fffd||c42c||fffd||fffd|         :W(KIS)
'***********************************************************
Public Sub SaveThisBook()

    Dim dtmFile As Date
    dtmFile = FileDateTime(ThisWorkbook.FullName) '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||794||fffd||fffd||fffd||fffd||fffd|

    Application.EnableEvents = False
    Application.DisplayAlerts = False
    ThisWorkbook.Save   '|fffd||702||fffd||fffd||28f||fffd||315||6d1||fffd||fffd||243|g|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|
    Application.DisplayAlerts = True

    '|fffd||fffd|L|fffd||155||6d1||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If dtmFile = FileDateTime(ThisWorkbook.FullName) Then
        '|fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||241|uY|fffd|i|fffd||342||fffd||fffd|j|fffd|v|fffd||153||fffd||fffd||fffd||fffd||fffd|Save
        If val(Application.Version) = 8 Then
            ' Excel97|fffd||30f||a347||fffd||302||fffd|
            SendKeys "Y"
        End If
        ThisWorkbook.Save
    End If
    Application.EnableEvents = True
End Sub

'===========================================================
'===                    JK_AutoModule                    ===
'===========================================================

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_Auto_Open
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'
'Create Date    :2005/03/16
'Auther         :T(FSIABC)
'***********************************************************
Public Function JK_Auto_Open() As Boolean

    Dim strMsg As String    '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|p
    Dim intMsg As Integer   'MsbBox|fffd||7c2||fffd|l

    JK_Auto_Open = False


    '|fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|
    gstrOutputPassWord = ""

    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|

    JK_frmInputPassword.Show

    If (gstrOutputPassWord = GC_PASSWORD_CANCEL) Then
        Exit Function
    End If

    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    JK_Auto_Open = True
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_BeforeSave
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :True/False
'|fffd||fffd||fffd||fffd|           :|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||6d1||fffd||fffd|O|fffd||30f||fffd||fffd||fffd|
'
'Create Date    :2013/02/12
'Auther         :Y.C
'***********************************************************
Public Function JK_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean) As Boolean
    JK_BeforeSave = False
    
    If saveByMacro = False Then
        '|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd||142||342||202||fffd||fffd||a347|
        '|fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd||fffd||502||fffd||6ce||fffd||fffd||fffd||fffd||fffd|
        Call RememberVisibleStatus
        
        'Workbook_BeforeSave|fffd||fffd||fffd||142||349||fffd||282||30d|X|fffd|V|fffd|L|fffd||fffd||fffd||fffd||602||fffd||582||fffd||fffd||fffd||fffd||202||fffd|
        'Application.ScreenUpdating = False
        
        'Dummy|fffd|V|fffd|[|fffd|g|fffd||302||742||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||502||242||fffd||fffd||fffd|
        Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
        Call Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    End If
    
    JK_BeforeSave = True
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_AfterSave
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :True/False
'|fffd||fffd||fffd||fffd|           :|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||6d1||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Public Function JK_AfterSave() As Boolean

    JK_AfterSave = False
    
    If saveByMacro = False Then
        '|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd||142||342||202||fffd||fffd||a347|
        '|fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd||fffd||502||1570c||fffd||fffd||fffd||fffd||fffd|
        Application.ScreenUpdating = False
        Call RestoreVisibleStatus
        If OnlyDummySheetVisible <> True Then
            Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
        End If
        
        Application.ScreenUpdating = True
        
        ThisWorkbook.Saved = True
    End If
    
    JK_AfterSave = True
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_BeforeClose
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :True/False|fffd|iFalse|fffd||30f||a347||fffd|A|fffd||102||44f|o|fffd||fffd||fffd||fffd||fffd||182||fffd|Cancel|fffd||fffd|True|fffd||fffd||752||fffd|j
'|fffd||fffd||fffd||fffd|           :|fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
'
'Create Date    :2012/11/07
'Auther         :Y.C
'***********************************************************
Public Function JK_BeforeClose() As Boolean

    Dim wbSearch    As Workbook '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|p
    Dim strOwnBook  As String   '|fffd||fffd||fffd||fffd||fffd||316||fffd||fffd|O
    Dim returnMsgbox As Integer  '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|{|fffd|b|fffd|N|fffd|X|fffd||316||7c2||fffd|l

    JK_BeforeClose = False

    '|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd|S|fffd|I|fffd||fffd|[X]|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||302||fffd||fffd||7c2||fffd|Activate|fffd||fffd||fffd||fffd|B
    ThisWorkbook.Activate

    If (forceClose = False) Then
        '|fffd|I|fffd||fffd||fffd||fffd||fffd||30f||33d1||fffd||fffd||fffd||6d1||fffd||fffd||317|L|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||34f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||90a9||fffd||20a2||fffd||fffd||fffd||d0b9||fffd||fffd|
        returnMsgbox = MsgBox("|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||6d1||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H" & vbCrLf & _
                              "   |fffd||342||fffd|   |fffd|F|fffd||6d1||fffd||fffd||fffd||fffd||10f|I|fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & _
                              "  |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd|F|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & _
                              "|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|F|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|", vbQuestion + vbYesNoCancel, gstrMsgTitle)
        
        If returnMsgbox = vbCancel Then
            '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
            Exit Function
        End If
    Else
        '|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|w|fffd||fffd||30f||a347|
        returnMsgbox = vbNo
    End If
    
    If returnMsgbox = vbYes Then
        If ThisWorkbook.ReadOnly = True Then
            '|fffd||1c2||74e||fffd||fffd||fffd|p|fffd||30f||a347||fffd|A|fffd||33d1||fffd||fffd||fffd||6d1||fffd||fffd||342||142||fffd||fffd||202||fffd|
            Call MsgBox("'" & ThisWorkbook.Name & "'|fffd||353||1c2||74e||fffd||fffd||fffd|p|fffd||142||fffd||fffd|B" & vbCrLf & _
                        "|fffd|R|fffd|s|fffd|[|fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||242||341|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical)
            
            '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
            Exit Function
        End If
        
        ' |fffd|{|fffd||fffd||fffd||202||fffd|ABeforeSave|fffd||142||fffd||fffd||5c2||fffd||fffd||202||302||fffd||fffd||fffd|
        ' |fffd|l|fffd|X|fffd|g|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||342||202||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||315||3cd|X|fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||14e||fffd||fffd|s|fffd|B
        Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
        Call Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    
        'Excel97|fffd||14f||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|\|fffd||fffd||fffd||389||fffd||fffd||302||fffd||fffd||7d5||3cd|X
        Call SaveThisBook
    Else
        '|fffd||33d1||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||202||fffd|
        '|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||6d1||fffd||fffd||3c2||74f||fffd||502||250||752||80b7||fffd||fffd|
        ThisWorkbook.Saved = True
    End If
    
    ' |fffd||fffd||fffd||fffd||fffd||20a|O|fffd||303|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||311||389||fffd|
    If Workbooks.count > 1 Then
        strOwnBook = ThisWorkbook.Name
        Set wbSearch = ThisWorkbook
        For Each wbSearch In Workbooks
            ' |fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||20a|O|fffd||fffd||38f||6c2||182||fffd||fffd||fffd|
            If wbSearch.Name <> strOwnBook Then
                '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||20a|O|fffd||302||fffd||fffd||fffd||fffd||a0a9||fffd||fffd|Activate
                'DisplayAlerts=True|fffd||242||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||6d1||fffd||fffd||fffd|Excel|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||242||202||fffd|B
                wbSearch.Activate
                Exit For
            End If
        Next wbSearch
    End If

    JK_BeforeClose = True
End Function

'***********************************************************
'MsgBox|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|p|fffd||3d0||fffd|
'***********************************************************
Public Function gstrMsgTitle() As String
    'MsgBox|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|p|fffd||3d0||fffd||fffd||24a|g|fffd||fffd||fffd|q|fffd||fffd||fffd||fffd||83dc||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|B
    gstrMsgTitle = Left(ThisWorkbook.Name, InStrRev(ThisWorkbook.Name, ".") - 1)
End Function

'===========================================================
'===                     JK_Security                     ===
'===========================================================

'***********************************************************
'|fffd|o|fffd|^|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||64fe|
'***********************************************************
Public Function GetLastPassWord() As String
    GetLastPassWord = Sheets("INI").Cells(PC_LINE_DATA, 1)
End Function

'***********************************************************
'|fffd|o|fffd|^|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd|INI|fffd|V|fffd|[|fffd|g|fffd||253|o|fffd|^
'***********************************************************
Public Sub SetLastPassWord(PassWord As String)

    '|fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||103|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||6d1||fffd|
    PassWord = |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|@|fffd|\(PassWord)
    Sheets("INI").Cells(PC_LINE_DATA, 1) = PassWord
    '|fffd||14f|I|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|X|fffd|V|fffd||fffd||fffd|t|fffd||fffd||6d1||fffd|
    Sheets("INI").Cells(PC_LINE_DATA, 4) = Format(Date, "YYYY/MM/DD")

End Sub

'***********************************************************
'|fffd||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O|fffd||64fe|
'true - |fffd||fffd||fffd|b|fffd|N|fffd||fffd||501|^ false - |fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd|
'***********************************************************
Public Function GetLockFlg() As Boolean

    If (Sheets("INI").Cells(PC_LINE_DATA, 2) = "") Then
        GetLockFlg = False
    Else
        GetLockFlg = True
    End If

End Function

'***********************************************************
'|fffd||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O|fffd||fffd|INI|fffd|V|fffd|[|fffd|g|fffd||243|Z|fffd|b|fffd|g
'true - |fffd|t|fffd||fffd||fffd|O|fffd|I|fffd||fffd||fffd|^ false - |fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
'***********************************************************
Public Sub SetLockFlg(Locked As Boolean)

    If (Locked) Then
        Sheets("INI").Cells(PC_LINE_DATA, 2) = "1"
    Else
        Sheets("INI").Cells(PC_LINE_DATA, 2) = ""
    End If

End Sub

'***********************************************************
'|fffd||14f|I|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
'***********************************************************
Public Function GetLastLogin() As String

    GetLastLogin = Format(Sheets("INI").Cells(PC_LINE_DATA, 3), "YYYY/MM/DD")

End Function

'***********************************************************
'|fffd||14f|I|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|INI|fffd|V|fffd|[|fffd|g|fffd||243|Z|fffd|b|fffd|g
'***********************************************************
Public Function SetLastLogin() As String

    Sheets("INI").Cells(PC_LINE_DATA, 3) = Format(Date, "YYYY/MM/DD")

End Function

'***********************************************************
'|fffd||14f|I|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|X|fffd|V|fffd||fffd||fffd|t|fffd||64fe|
'|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|i1|fffd||fffd||681|j|fffd||303|Z|fffd|b|fffd|g|fffd||193||fffd||fffd||fffd||fffd||24d|s|fffd||fffd||fffd|B
'***********************************************************
Public Function GetLastUpdate() As String

    If (Sheets("INI").Cells(PC_LINE_DATA, 4) = "") Then
        GetLastUpdate = ""
    Else
        GetLastUpdate = Format(Sheets("INI").Cells(PC_LINE_DATA, 4), "YYYY/MM/DD")
    End If

End Function

'***********************************************************
'|fffd||fffd||fffd||43343|O|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|INI|fffd|V|fffd|[|fffd|g|fffd||243|Z|fffd|b|fffd|g
'***********************************************************
Public Function SetFirstLogin() As String

    If Sheets("INI").Cells(PC_LINE_DATA, 5).Value = "" Then
        Sheets("INI").Cells(PC_LINE_DATA, 5) = Format(Date, "YYYY/MM/DD")
    End If
    
End Function

'***********************************************************
'|fffd|f|fffd|[|fffd|^|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
'***********************************************************
Public Function GetDateSaveLimit() As String

    GetDateSaveLimit = DateAdd("m", DATA_SAVE_LIMIT_MONTH, Sheets("INI").Cells(PC_LINE_DATA, 5).Value)

End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|      :CreatePassword
'|fffd||fffd||fffd||fffd|        |fffd|F|fffd||202||fffd|
'|fffd||7c2||fffd|l      |fffd|Fstring
'|fffd||fffd||fffd||fffd|        :|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|Y|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||10d90||fffd||fffd||fffd||fffd||fffd|B
'
'|fffd||fffd||fffd|l        :
'Create Date |fffd|F2005/02/22
'Auther      :T(FSIABC)
'***********************************************************
Public Function CreatePassWord() As String

    Dim strBuf          As String
    Dim strCd(1 To 12)  As String
    Dim strY(1 To 4)    As String
    Dim strM(1 To 2)    As String
    Dim strD(1 To 2)    As String
    Dim intLoop         As Integer


    CreatePassWord = ""

    strBuf = Format(Date, "YYYYMMDD")
    
    '|fffd|N|fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||582||30f||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    strY(1) = Mid(strBuf, 1, 1)
    strY(2) = Mid(strBuf, 2, 1)
    strY(3) = Mid(strBuf, 3, 1)
    strY(4) = Mid(strBuf, 4, 1)
    strM(1) = Mid(strBuf, 5, 1)
    strM(2) = Mid(strBuf, 6, 1)
    strD(1) = Mid(strBuf, 7, 1)
    strD(2) = Mid(strBuf, 8, 1)

    For intLoop = 1 To 12
    
        strCd(intLoop) = GetModulus10Wait2(strBuf)
        
        If (strCd(intLoop) = "") Then
            '|fffd||7c2||fffd|l|fffd||fffd|Null|fffd||30f||a347||fffd||348||64f||fffd|I|fffd||fffd|
            Exit Function
        Else
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd||fffd||a347||fffd||fffd|
            '|fffd||fffd||fffd||fffd||fffd||255|t|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd|Z|fffd|o|fffd||24e|g|fffd|p
            strBuf = strBuf + strCd(intLoop)
        End If
    Next intLoop
    
    For intLoop = 9 To 12
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd|O|fffd|`|fffd|X|fffd||14f0a|p|fffd||fffd||fffd||fffd||fffd||fffd|a|fffd|`j|fffd|i|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h97|fffd|`|fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||fffd|B
        strCd(intLoop) = Chr(CLng(strCd(intLoop) + 97))
    Next intLoop
    
    CreatePassWord = strCd(9) + strCd(10) + strCd(11) + strCd(12) + strD(2) _
                   + strCd(2) + strY(2) + strCd(6) + strM(2) + strY(4) _
                   + strCd(8) + strCd(4) + strY(3) + strCd(7) + strD(1) _
                   + strCd(3) + strM(1) + strCd(5) + strY(1) + strCd(1)

End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|      |fffd|FGetModulus10Wait2
'|fffd||fffd||fffd||fffd|        |fffd|FData|fffd|i1|fffd||fffd||fffd||fffd||fffd||20f||fffd||310||fffd||fffd||fffd||fffd|j
'|fffd||7c2||fffd|l      |fffd|Fstring
'|fffd||fffd||fffd||fffd|        |fffd|FData|fffd||fffd||80c2||fffd|W|fffd||fffd||fffd||fffd||fffd|X10|fffd||fffd||fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g
'              |fffd||fffd||fffd|Z|fffd|o|fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd|l        |fffd|FWing21|fffd|d|fffd|l|fffd||fffd||fffd||fffd|
'Create Date |fffd|F2005/02/22
'Auther     |fffd|FT(FSIABC)
'***********************************************************
Public Function GetModulus10Wait2(data As String) As String

    Dim i           As Integer
    Dim intLen      As Integer
    Dim intDat      As Integer
    Dim intSum      As Integer


    GetModulus10Wait2 = ""

    intLen = Len(data)
    intSum = 0

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd||34f|I|fffd||fffd|
    If intLen < 1 Then
        Exit Function
    End If

    '|fffd||fffd||fffd|l|fffd||142||fffd||fffd||202||fffd||fffd||fffd||38f|I|fffd||fffd|
    If IsNumeric(data) = False Then
        Exit Function
    End If

    For i = 1 To intLen
        '|fffd|E|fffd||fffd||fffd||a305||fffd||602||fffd|o|fffd||fffd|
        intDat = CInt(Left(Right(data, i), 1))
    
        '|fffd||fffd||fffd||30a||f414||fffd||fffd||fffd|i|fffd||fffd|A|fffd|S|fffd|A|fffd||fffd||fffd||308||2a5||fffd||fffd||fffd|j|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd||109||fffd||fffd|Z|fffd||fffd||602||fffd||582||fffd||fffd||fffd|B
        If (i Mod 2) = 0 Then
            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||302||702||709||fffd||fffd|Z
            intSum = intSum + intDat
        Else
            '|fffd||f414||fffd||fffd||fffd||fffd|2|fffd|{|fffd||fffd||fffd||fffd|
            intDat = intDat * 2
            
            If intDat >= 10 Then
                '2|fffd|{|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|2|fffd||fffd||fffd||12d02||fffd||fffd||fffd||a347||fffd||350||3c2||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd|Z
                intSum = intSum + (intDat \ 10) + (intDat Mod 10)
            Else
                '2|fffd|{|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd|10|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||342||fffd||fffd||302||702||709||fffd||fffd|Z
                intSum = intSum + intDat
            End If
        End If

    Next i

    '|fffd||fffd||fffd|v|fffd||309||fffd||fffd||a305||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|B|fffd|W|fffd|b|fffd|g|fffd||182||fffd||fffd||115||502||fffd||fffd|B
    GetModulus10Wait2 = Right(CStr(intSum), 1)

End Function

'===========================================================
'===                    JK_MaskModule                    ===
'===========================================================

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|@|fffd|\
'|fffd||fffd||fffd||fffd|           :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9576||fffd||fffd||fffd||fffd|
'|fffd||7c2||fffd|l         :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||311|O|fffd||fffd||fffd||fffd||fffd|B
'                |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||c2||94|z|fffd||fffd||255||6d1||fffd||fffd||fffd||fffd|A
'                maskon|fffd||593|n|fffd||fffd||fffd|B
'
'Create Date    :2005/02/24
'Auther         :M(FSIABC)
'***********************************************************
Function |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|@|fffd|\(Pass As String)
    
    Dim mojisu As Integer           'mojisu     |fffd||fffd||fffd||342||315||fffd||fffd||fffd||fffd||fffd|
    Dim a As String                 'A          |fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd|
    Dim i As Integer                'I          |fffd||fffd||fffd|[|fffd|v|fffd||fffd|
    Dim newarray() As String        'newarray   |fffd||3ca||fffd||fffd||3576||fffd||fffd||fffd||fffd||fffd|^|fffd|p|fffd|z|fffd||fffd|
    Dim k As Integer                'k          |fffd|z|fffd||fffd||30e|w|fffd||fffd|
    Dim maskout As String           'maskout    |fffd||3ca||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim henkango As String          'henkango   |fffd||3ca||fffd||fffd||fffd||315||fffd||fffd||fffd|
   
    
'|fffd|@|fffd||fffd||fffd||352|l|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
    
    If Pass = "" Then
        Exit Function
    Else
       mojisu = Len(Pass)
    End If

'|fffd|@|fffd||fffd||fffd||352|l|fffd||315||fffd||fffd||fffd||fffd||242||82||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd||a576||fffd||fffd||fffd||fffd||fffd||95||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|z|fffd||fffd|newarray|fffd||fffd||fffd||255||6d1||fffd|
    
    k = 1
    For i = 1 To mojisu
        a = Mid(Pass, i, 1)
        ReDim Preserve newarray(1 To mojisu) As String
              newarray(k) = maskon(a)
                k = k + 1
    Next
    
'|fffd|@|fffd|z|fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||217||fffd||fffd||fffd||fffd||10d||fffd||fffd|l|fffd||142||82||202||fffd|

    'maskout = Join(newarray)
    For i = 1 To UBound(newarray)
        If newarray(i) <> "" Then
            maskout = maskout + newarray(i)
        End If
    Next

|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|@|fffd|\ = maskout

End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|I|fffd|t|fffd|@|fffd|\
'|fffd||fffd||fffd||fffd|           :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
'|fffd||7c2||fffd|l         :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||311|O|fffd||fffd||fffd||fffd||fffd|B
'                |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||9576||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||c2||94|z|fffd||fffd||255||6d1||fffd||fffd||fffd||fffd|A
'                maskoff|fffd||593|n|fffd||fffd||fffd|B
'
'Create Date    :2005/02/24
'Auther         :M(FSIABC)
'***********************************************************
Function |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|I|fffd|t|fffd|@|fffd|\(Pass As String)
    
    Dim mojisu As Integer           'mojisu     |fffd||fffd||fffd||342||315||fffd||fffd||fffd||fffd||fffd|
    Dim B As String                 'B          |fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd|
    Dim i As Integer                'I          |fffd||fffd||fffd|[|fffd|v|fffd||fffd|
    Dim newarray2() As String       'newarray2  |fffd||3ca||fffd||fffd||3576||fffd||fffd||fffd||fffd||fffd|^|fffd|p|fffd|z|fffd||fffd|
    Dim k As Integer                'k          |fffd|z|fffd||fffd||30e|w|fffd||fffd|
    Dim maskout2 As String          'maskout2   |fffd||3ca||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
    Dim henkanmae As String         'henkanmae  |fffd||3ca||fffd||fffd||fffd||315||fffd||fffd||fffd|


'|fffd|@|fffd||fffd||fffd||352|l|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
    
    If Pass = "" Then
        Exit Function
    Else
       mojisu = Len(Pass)
    End If
    
'|fffd|@|fffd||fffd||fffd||352|l|fffd||315||fffd||fffd||fffd||fffd||242||82||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd||a576||fffd||fffd||fffd||fffd||fffd||95||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|z|fffd||fffd|newarray2|fffd||fffd||fffd||255||6d1||fffd|
    
    k = 1
    For i = 1 To mojisu
        B = Mid(Pass, i, 1)
        ReDim Preserve newarray2(1 To mojisu) As String
              newarray2(k) = maskoff(B)
                k = k + 1
    Next
    
'|fffd|@|fffd|z|fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||217||fffd||fffd||fffd||fffd||10d||fffd||fffd|l|fffd||142||82||202||fffd|

    For i = 1 To UBound(newarray2)
        If newarray2(i) <> "" Then
            maskout2 = maskout2 + newarray2(i)
        End If
    Next

|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|I|fffd|t|fffd|@|fffd|\ = maskout2
                    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :maskon
'|fffd||fffd||fffd||fffd|           :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9576||fffd||fffd||fffd||fffd|
'|fffd||7c2||fffd|l         :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|n|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||315||3ca||fffd|(|fffd|}|fffd|X|fffd|N|fffd||fffd|)|fffd||fffd||fffd|s|fffd||fffd||fffd|B
'
'Create Date    :2005/02/24
'Auther         :M(FSIABC)
'***********************************************************
Function maskon(a As String) As String
'   |fffd||fffd||fffd||352|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|@|fffd|\

    Dim henkango As String
    
    Select Case a
    Case "a": henkango = "n"
    Case "b": henkango = "a"
    Case "c": henkango = "E"
    Case "d": henkango = "S"
    Case "e": henkango = "o"
    Case "f": henkango = "b"
    Case "g": henkango = "T"
    Case "h": henkango = "p"
    Case "i": henkango = "F"
    Case "j": henkango = "U"
    Case "k": henkango = "q"
    Case "l": henkango = "c"
    Case "m": henkango = "V"
    Case "n": henkango = "G"
    Case "o": henkango = "r"
    Case "p": henkango = "W"
    Case "q": henkango = "d"
    Case "r": henkango = "H"
    Case "s": henkango = "X"
    Case "t": henkango = "I"
    Case "u": henkango = "s"
    Case "v": henkango = "Y"
    Case "w": henkango = "J"
    Case "x": henkango = "e"
    Case "y": henkango = "Z"
    Case "z": henkango = "t"
    Case "A": henkango = "K"
    Case "B": henkango = "f"
    Case "C": henkango = "u"
    Case "D": henkango = "6"
    Case "E": henkango = "L"
    Case "F": henkango = "g"
    Case "G": henkango = "M"
    Case "H": henkango = "v"
    Case "I": henkango = "N"
    Case "J": henkango = "7"
    Case "K": henkango = "h"
    Case "L": henkango = "8"
    Case "M": henkango = "w"
    Case "N": henkango = "9"
    Case "O": henkango = "x"
    Case "P": henkango = "i"
    Case "Q": henkango = "0"
    Case "R": henkango = "5"
    Case "S": henkango = "y"
    Case "T": henkango = "4"
    Case "U": henkango = "j"
    Case "V": henkango = "R"
    Case "W": henkango = "z"
    Case "X": henkango = "A"
    Case "Y": henkango = "k"
    Case "Z": henkango = "3"
    Case "0": henkango = "Q"
    Case "1": henkango = "2"
    Case "2": henkango = "B"
    Case "3": henkango = "l"
    Case "4": henkango = "1"
    Case "5": henkango = "C"
    Case "6": henkango = "P"
    Case "7": henkango = "m"
    Case "8": henkango = "O"
    Case "9": henkango = "D"
    
    End Select
    
    maskon = henkango
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :maskoff
'|fffd||fffd||fffd||fffd|           :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|
'|fffd||7c2||fffd|l         :String |fffd|}|fffd|X|fffd|N|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd|n|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||315||3ca||fffd|(|fffd|}|fffd|X|fffd|N|fffd||fffd||fffd||fffd|)|fffd||fffd||fffd|s|fffd||fffd||fffd|B
'
'Create Date    :2005/02/24
'Auther         :M(FSIABC)
'***********************************************************
Function maskoff(B As String) As String

'   |fffd||fffd||fffd||355||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd||fffd|A|fffd||fffd||fffd||256||7c2||fffd||fffd|@|fffd|\
    
    Dim henkanmae As String
    
    Select Case B
    Case "n": henkanmae = "a"
    Case "a": henkanmae = "b"
    Case "E": henkanmae = "c"
    Case "S": henkanmae = "d"
    Case "o": henkanmae = "e"
    Case "b": henkanmae = "f"
    Case "T": henkanmae = "g"
    Case "p": henkanmae = "h"
    Case "F": henkanmae = "i"
    Case "U": henkanmae = "j"
    Case "q": henkanmae = "k"
    Case "c": henkanmae = "l"
    Case "V": henkanmae = "m"
    Case "G": henkanmae = "n"
    Case "r": henkanmae = "o"
    Case "W": henkanmae = "p"
    Case "d": henkanmae = "q"
    Case "H": henkanmae = "r"
    Case "X": henkanmae = "s"
    Case "I": henkanmae = "t"
    Case "s": henkanmae = "u"
    Case "Y": henkanmae = "v"
    Case "J": henkanmae = "w"
    Case "e": henkanmae = "x"
    Case "Z": henkanmae = "y"
    Case "t": henkanmae = "z"
    Case "K": henkanmae = "A"
    Case "f": henkanmae = "B"
    Case "u": henkanmae = "C"
    Case "6": henkanmae = "D"
    Case "L": henkanmae = "E"
    Case "g": henkanmae = "F"
    Case "M": henkanmae = "G"
    Case "v": henkanmae = "H"
    Case "N": henkanmae = "I"
    Case "7": henkanmae = "J"
    Case "h": henkanmae = "K"
    Case "8": henkanmae = "L"
    Case "w": henkanmae = "M"
    Case "9": henkanmae = "N"
    Case "x": henkanmae = "O"
    Case "i": henkanmae = "P"
    Case "0": henkanmae = "Q"
    Case "5": henkanmae = "R"
    Case "y": henkanmae = "S"
    Case "4": henkanmae = "T"
    Case "j": henkanmae = "U"
    Case "R": henkanmae = "V"
    Case "z": henkanmae = "W"
    Case "A": henkanmae = "X"
    Case "k": henkanmae = "Y"
    Case "3": henkanmae = "Z"
    Case "Q": henkanmae = "0"
    Case "2": henkanmae = "1"
    Case "B": henkanmae = "2"
    Case "l": henkanmae = "3"
    Case "1": henkanmae = "4"
    Case "C": henkanmae = "5"
    Case "P": henkanmae = "6"
    Case "m": henkanmae = "7"
    Case "O": henkanmae = "8"
    Case "D": henkanmae = "9"
    
    End Select
    
    maskoff = henkanmae
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :RememberVisibleStatus
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :WorkSheet|fffd||315|\|fffd||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||3d0||fffd||fffd||255||6ce||fffd||fffd||fffd||fffd||fffd|B
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Private Function RememberVisibleStatus()

    Dim i   As Long
    Dim sht As Worksheet

    'Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||315|\|fffd||fffd||fffd||fffd||502||fffd||794||fffd||fffd||fffd||fffd||fffd||308||fffd||fffd||fffd|m|fffd||6c2||fffd||fffd||fffd|
    ReDim shtStatusBackups(ThisWorkbook.Worksheets.count - 1)
    
    i = 1
    For Each sht In ThisWorkbook.Worksheets
        If (sht.Name <> "Dummy") Then
            '|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|i|fffd|[
            shtStatusBackups(i).shtName = sht.Name
            
            '|fffd|V|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||fffd||50a|i|fffd|[
            shtStatusBackups(i).shtVisible = sht.Visible
            
            i = i + 1
        End If
    Next sht
    
    '|fffd||fffd||fffd||755|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||64fe|
    Set activeSht = ThisWorkbook.ActiveSheet
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :RestoreVisibleStatus
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :WorkSheet|fffd||315|\|fffd||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||755c||fffd||fffd||fffd||fffd||fffd||fffd|B
'                |fffd||fffd||fffd|RememberVisibleStatus()|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Private Function RestoreVisibleStatus()

    Dim i   As Long

    For i = 1 To UBound(shtStatusBackups)
        '|fffd||6d1||fffd||fffd|O|fffd||303|V|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||fffd||502||1570c||fffd|
        ThisWorkbook.Worksheets(shtStatusBackups(i).shtName).Visible = shtStatusBackups(i).shtVisible
    Next i
    
    activeSht.Activate
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :OnlyDummySheetVisible
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :True/False
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||302||755|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||502||142||fffd||fffd||fffd||fffd|True|fffd||fffd||502||fffd|
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Private Function OnlyDummySheetVisible() As Boolean

    Dim sht As Worksheet
    
    OnlyDummySheetVisible = True
    
    For Each sht In ThisWorkbook.Worksheets
        If (sht.Name <> "Dummy" And sht.Visible = xlSheetVisible) Then
            OnlyDummySheetVisible = False
            Exit For
        End If
    Next sht
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_SaveWithOnlyDummySheetVisible
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :Dummy|fffd|V|fffd|[|fffd|g|fffd||302||755|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||502||143|u|fffd|b|fffd|N|fffd||315||6d1||fffd||fffd||fffd||fffd|s|fffd||fffd|
'                |fffd||6d1||fffd||fffd||fffd||24c||fffd||fffd||315|\|fffd||fffd||fffd||fffd||502||255||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Public Function JK_SaveWithOnlyDummySheetVisible()
    
    If ThisWorkbook.ReadOnly = True Then
        '|fffd||1c2||74e||fffd||fffd||fffd|p|fffd||30f||a347||fffd|A|fffd||33d1||fffd||fffd||fffd||6d1||fffd||fffd||342||142||fffd||fffd||202||fffd|
        Call MsgBox("'" & ThisWorkbook.Name & "'|fffd||353||1c2||74e||fffd||fffd||fffd|p|fffd||142||fffd||fffd|B" & vbCrLf & _
                    "|fffd|R|fffd|s|fffd|[|fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||242||341|A|fffd||fffd||fffd|O|fffd||fffd|t|fffd||fffd||fffd||115||6d1||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", vbCritical)
        Exit Function
    End If
    
    '|fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd||fffd||502||fffd||6ce||fffd||fffd||fffd||fffd||fffd|
    Call RememberVisibleStatus
    
    Application.ScreenUpdating = False
    
    'Dummy|fffd|V|fffd|[|fffd|g|fffd||302||742||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||502||242||fffd||fffd||fffd|
    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    Call Dummy|fffd|V|fffd|[|fffd|g|fffd||20a|O|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    
    saveByMacro = True
    ThisWorkbook.Save
    saveByMacro = False
    
    '|fffd|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd||fffd||502||1570c||fffd||fffd||fffd||fffd||fffd|
    Call RestoreVisibleStatus
    If OnlyDummySheetVisible <> True Then
        Call Dummy|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|\|fffd||fffd|
    End If
    
    Application.ScreenUpdating = True
    
    ThisWorkbook.Saved = True
    
End Function

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :JK_CloseWithoutSaving
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||3cd|X|fffd||fffd||6d1||fffd||fffd||fffd||fffd||90a9||fffd||316||20a2||fffd||fffd||fffd||d0b9||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd|
'                |fffd||fffd||fffd||30d||6c1|A|fffd||3cd|X|fffd||355||6d1||fffd||fffd||fffd||fffd||fffd||202||fffd|
'
'Create Date    :2018/03/07
'Auther         :T.A
'***********************************************************
Public Function JK_CloseWithoutSaving()

    forceClose = True
    ThisWorkbook.Close
    
End Function




Attribute VB_Name = "JK_frmInputPassword"
Attribute VB_Base = "0{5970FA10-CC77-496B-910A-ABF2C091404D}{9748F9BA-6EE0-40A6-A4A8-3196C1BDD94E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


' 2018/04/24 |fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||242||82||fffd||fffd||102||310||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1c9||fffd|(cmdHelp_Click)
'            |fffd||fffd||fffd||fffd||fffd||14b|L|fffd||682||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|\|fffd|[|fffd|X|fffd||30d||c42c||fffd||482||fffd||fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|
'            |fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|F|fffd||60e||fffd||fffd|s|fffd||143||fffd||fffd|b|fffd|N|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd||fffd||6c2||315||fffd||fffd||282||fffd||3cd|X
'            |fffd||fffd||fffd|b|fffd|N|fffd|A|fffd|E|fffd|g|fffd||fffd||502||14b|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6c2||315||fffd||fffd||282||fffd||3cd|X
'            |fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||30f||74b7||fffd||203||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||d3dc|

'**********************
' |fffd|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||8414|
'**********************
'|fffd||8414|
Private Const PC_FRAME_INPUT    As Integer = 1  '|fffd||fffd||fffd||343|t|fffd||fffd||fffd|[|fffd||fffd|
Private Const PC_FRAME_CHANGE   As Integer = 2  '|fffd||752||fffd|t|fffd||fffd||fffd|[|fffd||fffd|
'|fffd||3d0||fffd|
Private pstrPassWord    As String   '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
Private pstrNormalPw    As String   '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|iINI|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||64fe||fffd|j
Private pstrAdminPw     As String   '|fffd||1d7||fffd||fffd||483|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|i|fffd||fffd||fffd|t|fffd||fffd||8284||fffd||fffd|o|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|j
Private pintErrCnt      As Integer  '|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd|i|fffd||fffd||fffd|b|fffd|N|fffd|p|fffd|j
Private pblnLock        As Boolean  '|fffd||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O
Private pbln6MonthAfter As Boolean  '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h6|fffd||fffd||fffd||fffd||fffd|o|fffd||7c3|t|fffd||fffd||fffd|O
Private pblnFirst       As Boolean  '|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O

'*****************************************************
'   |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||fffd|
'*****************************************************

'|fffd|u|fffd|I|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub cmdCancel_Click()
    pstrPassWord = GC_PASSWORD_CANCEL
    Unload Me
End Sub

'|fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub cmdOk_Click()

    Dim strMsg As String

    If (LoginCheck = False) Then
        Exit Sub
    End If

    strMsg = ""
    If (pstrPassWord = pstrAdminPw) Then
        strMsg = "|fffd|Y|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf _
               & "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H"
    ElseIf (pbln6MonthAfter) Then
        strMsg = "|fffd|O|fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||7c2||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf _
                & "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd||80a2||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf _
                & vbCrLf _
                & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H"
    End If

    If (strMsg <> "") Then
        If MsgBox(strMsg, vbExclamation + vbYesNo, Me.caption) = vbYes Then
            '|fffd|u|fffd||342||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||282||591|J|fffd||682||fffd||fffd||fffd||fffd||fffd|B
            DisplaySet (PC_FRAME_CHANGE)
            Exit Sub
        End If
    End If

    Unload Me

End Sub

'|fffd|u|fffd||3cd|X|fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub cmdPwChange_Click()

    If (LoginCheck = False) Then
        Exit Sub
    End If

    '|fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||282||591|J|fffd||682||fffd||fffd||fffd||fffd||fffd|B
    DisplaySet (PC_FRAME_CHANGE)
    f2_txtChangePw.SetFocus

End Sub

'|fffd|u|fffd|H|fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub cmdHelp_Click()
    
    Call MsgBox("|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd||353||fffd||fffd||403|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd||fffd||fffd|[|fffd||fffd||fffd||24a||fffd||c2||fffd||fffd|f|fffd|[|fffd|^|fffd||315||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                "|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||343|c|fffd|[|fffd||fffd||fffd||30f||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & DATA_SAVE_LIMIT_MONTH & "|fffd||fffd||fffd||fffd||fffd||30aa||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd|A" & vbCrLf & _
                "|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd||6c2||34b|N|fffd||fffd||fffd||fffd||fffd||243|f|fffd|[|fffd|^|fffd||30d||d3dc||fffd||118c2||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                "|fffd||fffd||fffd||30d||6ce||fffd||fffd||fffd||fffd||143|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd||90b1||fffd||182||342||fffd||fffd||fffd||702||fffd||fffd||42a81|A" & vbCrLf & _
                "|fffd||d3dc||fffd||fffd||fffd||90b1||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd|||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", _
                vbInformation + vbOKOnly, "|fffd|f|fffd|[|fffd|^|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||182||341|H")

End Sub

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :DisplaySet
'|fffd||fffd||fffd||fffd|           :PC_FRAME_INPUT     - |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||fffd|
'              |fffd|FPC_FRAME_CHANGE    - |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||fffd||283|t|fffd||fffd||fffd|[|fffd||fffd||fffd|\|fffd||fffd||fffd||752||fffd|
'|fffd||fffd||fffd|l           :
'Create Date    :2005/02/22
'Auther         :T(FSIABC)
'***********************************************************
Private Sub DisplaySet(Frame As Integer)

    If (Frame = PC_FRAME_INPUT) Then
        '|fffd||fffd||fffd||343|t|fffd|H|fffd|[|fffd||fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
        fraInput.Visible = True

        If (pblnLock) Then
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347|

            '|fffd|t|fffd|H|fffd|[|fffd||fffd|Caption|fffd||752||fffd|
            Me.caption = "|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|"
            '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|
            lblInputPw.caption = "|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h"
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lblLock.Visible = True
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
            txtPassword1.Visible = True
            txtPassword2.Visible = True
            txtPassword3.Visible = True
            txtPassword4.Visible = True
            '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
            txtNormalPw.Visible = False
            '|fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd|
            cmdOk.Visible = False

        Else
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|

            '|fffd|t|fffd|H|fffd|[|fffd||fffd|Caption|fffd||752||fffd|
            Me.caption = "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|"
            '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|
            lblInputPw.caption = "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h"
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lblLock.Visible = False
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
            txtPassword1.Visible = False
            txtPassword2.Visible = False
            txtPassword3.Visible = False
            txtPassword4.Visible = False
            '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X
            txtNormalPw.Visible = True
            '|fffd|u|fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd|
            cmdOk.Visible = True
        End If
        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
        FraChange.Visible = False

    Else
    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|t|fffd||fffd||fffd|[|fffd||fffd|

        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||343|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
        fraInput.Visible = False
        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|\|fffd||fffd|
        FraChange.Visible = True

        '|fffd|t|fffd|H|fffd|[|fffd||fffd|Caption|fffd||752||fffd|
        Me.caption = "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|"
    End If

End Sub

'***********************************************************
'|fffd||590||fffd||fffd||fffd|         :LoginCheck
'|fffd||fffd||fffd||fffd|           :|fffd||202||fffd|
'|fffd||7c2||fffd|l         :|fffd||202||fffd|
'|fffd||fffd||fffd||fffd|           :|fffd||fffd||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|`|fffd|F|fffd|b|fffd|N
'|fffd||fffd||fffd|l           :
'Create Date    :2005/02/22
'Auther         :T(FSIABC)
'***********************************************************
Private Function LoginCheck() As Boolean

    Dim objTarget   As Object '|fffd|Z|fffd|b|fffd|g|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd|p|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||3d0||fffd|
    LoginCheck = False

    If (pblnLock) Then
    '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        '|fffd||1d7||fffd||fffd||483|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|
        pstrPassWord = Trim(txtPassword1.text & txtPassword2.text & txtPassword3.text & txtPassword4.text)
        Set objTarget = txtPassword1
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34a||1d7||fffd||fffd||483|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||302||742||143||fffd||fffd|O|fffd|C|fffd||fffd||fffd||94|\
        If (pstrPassWord = pstrAdminPw) Then
            LoginCheck = True
        End If

    Else
    '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||fffd|

        '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd|
        pstrPassWord = Trim(txtNormalPw.text)
        pstrPassWord = |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|@|fffd|\(pstrPassWord)
        Set objTarget = txtNormalPw
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd||352||28f||fffd|E|fffd||1d7||fffd||fffd||482||1c2||fffd||fffd||fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||142||fffd||fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||94|\
        If (pstrPassWord = pstrAdminPw) Or _
           (pstrPassWord = pstrNormalPw) Then
            LoginCheck = True
        End If

    End If

    If (LoginCheck) Then
    '|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||a347|

        '|fffd||14f|I|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|V
        SetLastLogin
        '|fffd||fffd||fffd||43343|O|fffd|C|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
        SetFirstLogin

        If (pblnLock) Then
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O|fffd|N|fffd||fffd||fffd|A
            SetLockFlg (False)

        End If

    Else
    '|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|

        Call MsgBox("|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|F|fffd||602||142||fffd||fffd||702||fffd||fffd||fffd|B", vbCritical, Me.caption)

        If (pblnLock) Then

            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd||fffd||fffd||fffd||fffd|B
            pstrPassWord = GC_PASSWORD_CANCEL
            Unload Me

        Else
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|

            '|fffd|F|fffd||603|G|fffd||fffd||fffd|[|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd|A|fffd|b|fffd|v
            pintErrCnt = pintErrCnt + 1

            If (pintErrCnt >= 5) Then
                Call MsgBox("|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|F|fffd||602||242|T|fffd||fffd|A|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                            "|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||10f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|" & vbCrLf & _
                            "|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||242||341|u|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|K|fffd|v|fffd||242||202||fffd||702||fffd||fffd|" & vbCrLf & _
                            "|fffd|u|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||353||fffd||fffd||409|c|fffd||18e||408||fffd||fffd||242||fffd||fffd||20a2||fffd||fffd||fffd||d0b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , vbCritical, Me.caption)

                '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|\|fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O|fffd||fffd||752||80b5||fffd|A|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|B
                SetLockFlg (True)
                pstrPassWord = GC_PASSWORD_CANCEL

                Unload Me

                ' |fffd||fffd||fffd||fffd||fffd||6d1||fffd|
                Call SaveThisBook
                forceClose = True
                ThisWorkbook.Close

            Else
                '|fffd|G|fffd||fffd||fffd|[|fffd||4cf||fffd||fffd||243|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd|Z|fffd|b|fffd|g
                objTarget.SetFocus
            End If
        End If

    End If

End Function

'*****************************************************
'   |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X|fffd||fffd||fffd|
'*****************************************************

'|fffd|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub f2_cmdCancel_Click()

    If (pblnFirst) Then
        '|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||143|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X|fffd||fffd||282||fffd|\|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd|
        '|fffd|u|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||341|A|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||282||fffd|
        '|fffd|I|fffd||fffd||fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd|B
        pstrPassWord = GC_PASSWORD_CANCEL
        Unload Me

    Else
        '|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||343|G|fffd||fffd||fffd|[|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd|A|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
        '|fffd||fffd||fffd||349||fffd||282||251|J|fffd||682||fffd||fffd||fffd|B
        pintErrCnt = 0
        DisplaySet (PC_FRAME_INPUT)

        If (pblnLock) Then
            '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||282||30f||a347|
            txtPassword1.SetFocus
        Else
            '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||349||fffd||282||30f||a347|
            txtNormalPw.SetFocus
        End If

    End If

End Sub

'|fffd|u|fffd||3cd|X|fffd|v|fffd|{|fffd|^|fffd||fffd|
Private Sub f2_cmdChange_Click()

    Dim strMsg          As String   '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|i|fffd|[|fffd|p|fffd|i|fffd|G|fffd||fffd||fffd|[|fffd|t|fffd||fffd||fffd|O|fffd||182||fffd||fffd||102||fffd||fffd|g|fffd|p|fffd|j
    Dim intLoop         As Integer  '|fffd||fffd||fffd|[|fffd|v|fffd|p
    Dim blnAllAlpha     As Boolean  '|fffd|S|fffd|p|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
    Dim blnProhabit     As Boolean  '|fffd||fffd||fffd||34b||58e|~|fffd|t|fffd||fffd||fffd|O
    Dim strChangePw     As String   '|fffd||752||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    Dim strConfirmPw    As String   '|fffd||113||fffd||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    Dim objTarget       As Object   '|fffd|Z|fffd|b|fffd|g|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd|p|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||3d0||fffd|

    strChangePw = Trim(f2_txtChangePw.text)
    strConfirmPw = Trim(f2_txtConfirmPw.text)

    strMsg = ""
    '|fffd||752||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|B
    Set objTarget = f2_txtChangePw

    '|fffd||fffd||fffd||343|f|fffd|[|fffd|^|fffd||311||d3||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    For intLoop = 1 To Len(strChangePw)
        '|fffd|p|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||fffd|B
        If maskon(Mid(strChangePw, intLoop, 1)) = "" Then
            Call MsgBox("|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||242||349|p|fffd||fffd||fffd||fffd||fffd||302||750||752||fffd||94|\|fffd||142||fffd||fffd|B", vbCritical, Me.caption)
            objTarget.SetFocus
            Exit Sub
        End If
    Next intLoop

    If (strChangePw = "") Then
        strMsg = "|fffd||752||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"

    ElseIf (strConfirmPw = "") Then
        strMsg = "|fffd||113||fffd||fffd||342||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        Set objTarget = f2_txtConfirmPw

    ElseIf (strChangePw <> strConfirmPw) Then
        strMsg = "|fffd||113||fffd||fffd||342||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s|fffd||fffd|v|fffd||142||fffd||fffd|B"
        Set objTarget = f2_txtConfirmPw

    ElseIf Len(strChangePw) < 6 Then
        strMsg = "|fffd|U|fffd||fffd||fffd||20f||fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
    Else

        ' |fffd|o|fffd|^|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        If strChangePw = |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|}|fffd|X|fffd|N|fffd|I|fffd|t|fffd|@|fffd|\(GetLastPassWord) Then
            strMsg = "|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||188||642||202||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End If

        '|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347|
        If IsNumeric(strChangePw) Then
            strMsg = "|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        Else
            '|fffd|S|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|A|fffd||702||fffd||fffd||349|p|fffd||fffd||fffd||fffd||fffd||742||30f||a347|
            blnAllAlpha = True
            '|fffd|S|fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
            For intLoop = 1 To Len(strChangePw)
                If (IsNumeric(Mid(strChangePw, intLoop, 1))) Then
                    '|fffd||fffd||fffd||302||fffd||fffd||fffd||fffd|P|fffd||82||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||202||fffd||fffd|B
                    blnAllAlpha = False
                    Exit For
                End If
                '|fffd|p|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||a0bd||fffd||a347||fffd||343|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||fffd|B
                If maskon(Mid(strChangePw, intLoop, 1)) = "" Then
                    blnProhabit = True
                End If
            Next intLoop
            If (blnAllAlpha) Or (blnProhabit) Then
                strMsg = "|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            End If
        End If
    End If

    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||355|\|fffd||fffd||fffd|A|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd|I|fffd||fffd|
    If strMsg <> "" Then
        Call MsgBox(strMsg, vbCritical, Me.caption)
        objTarget.SetFocus
        Exit Sub
    End If

    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|X|fffd|V|fffd||fffd||fffd|t|fffd||fffd|INI|fffd|V|fffd|[|fffd|g|fffd||255||6d1||fffd|
    SetLastPassWord (strChangePw)

    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||6d1||fffd||fffd||fffd||342||fffd||fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||7c2||fffd|l|fffd|i|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|j|fffd||182||fffd||fffd||fffd|B
    pstrPassWord = strChangePw
    Unload Me

End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub UserForm_Initialize()

    Dim strLastUpdate   As String   '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd|
    Dim datAdd6month    As Date     '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd||fffd||fffd|6|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t

    '|fffd||fffd||fffd||fffd||fffd||6ce||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    pstrPassWord = ""

    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h6|fffd||fffd||fffd||fffd||fffd|o|fffd||7c3|t|fffd||fffd||fffd|O|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    pbln6MonthAfter = False

    '|fffd||fffd||fffd||fffd|o|fffd|^|fffd|t|fffd||fffd||fffd|O|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    pblnFirst = False

    '|fffd|G|fffd||fffd||fffd|[|fffd|J|fffd|E|fffd||fffd||fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    pintErrCnt = 0

    '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||30e||64fe|
    pstrAdminPw = CreatePassWord
    If (pstrAdminPw = "") Then
        Call MsgBox("|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbCritical)
        '|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||14f|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        pstrPassWord = GC_PASSWORD_CANCEL
        Unload Me
    End If

    'INI|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||30e||64fe| ----------
    '
    '|fffd|O|fffd||43343|O|fffd|C|fffd||fffd||fffd||fffd|
    lblLastLogin.caption = GetLastLogin
    '|fffd||fffd||fffd|b|fffd|N|fffd|t|fffd||fffd||fffd|O
    pblnLock = GetLockFlg
    '|fffd|O|fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd|t
    strLastUpdate = GetLastUpdate
    '|fffd|o|fffd|^|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    pstrNormalPw = GetLastPassWord
    '|fffd|f|fffd|[|fffd|^|fffd||6d1||fffd||fffd||fffd||fffd||fffd|
    lblDateSaveLimit.caption = GetDateSaveLimit

    '------------------------------------

    If (pblnLock) Then
        Call MsgBox("|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd||343||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                    "|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||341|u|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||fffd|K|fffd|v|fffd||242||202||fffd||702||fffd||fffd|B" & vbCrLf & _
                    "|fffd|u|fffd||64b|}|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||353||fffd||fffd||409|c|fffd||18e||408||fffd||fffd||242||fffd||fffd||20a2||fffd||fffd||fffd||d0b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" _
                    , vbExclamation, gstrMsgTitle)
        '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
        DisplaySet (PC_FRAME_INPUT)

    Else
    '|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347|

        If (strLastUpdate = "") Then
            '|fffd|O|fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd|t|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X|fffd|K|fffd|{

            '|fffd||14f|I|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd|X|fffd|V|fffd|i|fffd||fffd||fffd||4e782||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|F|fffd||602||fffd||fffd|s|fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|j
            SetLastLogin

            '|fffd||fffd||fffd||43343|O|fffd|C|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
            SetFirstLogin

            '|fffd||fffd||fffd||fffd|o|fffd|^|fffd|t|fffd||fffd||fffd|O|fffd|I|fffd||fffd|
            pblnFirst = True

            '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
            DisplaySet (PC_FRAME_CHANGE)

        Else
            datAdd6month = DateAdd("m", 6, CDate(strLastUpdate))

            If Date > datAdd6month Then
                '|fffd|O|fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||fffd||fffd|t|fffd||fffd||fffd|6|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||343|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||3cd|X|fffd|t|fffd||fffd||fffd|O|fffd|I|fffd||fffd|
                pbln6MonthAfter = True
            End If

            '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||343|t|fffd|H|fffd|[|fffd||fffd||fffd|\|fffd||fffd|
            DisplaySet (PC_FRAME_INPUT)
        End If

    End If

    '|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||30d||fffd||fffd||fffd||fffd||752||fffd|
    Height = 175
    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||308||292|u|fffd||752||fffd|
    FraChange.Top = 5
    fraInput.Top = 5
    '|fffd||28f||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||308||292|u|fffd||752||fffd|
    txtNormalPw.Top = 36

End Sub

'|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub UserForm_Terminate()

    '|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||243|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd||fffd||3d0||fffd||fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||256||7c2||fffd|l|fffd|Z|fffd|b|fffd|g
    gstrOutputPassWord = pstrPassWord
    Sheets("INI").Visible = xlSheetVeryHidden

End Sub

'[X]|fffd|{|fffd|^|fffd||fffd||fffd||389||fffd|
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Select Case CloseMode
    Case vbFormControlMenu
        '[X]|fffd|{|fffd|^|fffd||fffd||fffd||34f||fffd||243|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|B
        Cancel = True
    Case Else
    End Select
End Sub

Attribute VB_Name = "JK_shtDummy1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "JK_shtINI"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Logs"
Option Explicit
Option Private Module

'Private agCode As String
'Private userId As String

' /*******************************************
'  *   |fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||115c2||fffd|
'  *******************************************/
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Function sendServerLog(ByVal exeOperation As String) As Boolean
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function sendServerLog(ByVal exeOperation As String, Optional argCount As Long) As Boolean
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    startOf "sendServerLog"

    Dim q(14) As ServerLogRequest

    Dim agCode As String
    Dim userId As String
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim OnlineUserID As String
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    ' |fffd|K|fffd|v|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|W
    If getAgentUserInfomation = False Then
        sendServerLog = False
        ExitOf "sendServerLog", "getAgentUserInfomation|fffd||fffd||fffd|s"
        Exit Function
    End If


    agCode = shtSetting.Range(AG_CODE_ADDR).Value
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    userId = shtSetting.Range(USER_ID_ADDR).Value
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    userId = egg.getPCUserID
    OnlineUserID = shtSetting.Range(USER_ID_ADDR).Value
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|


    ' |fffd|K|fffd|{|fffd||fffd||fffd||fffd|
    q(0).key = "agcode": q(0).val = agCode          '
    q(1).key = "staffcode": q(1).val = userId       ' |fffd|]|fffd||188||fffd||fffd||fffd|
    q(2).key = "toolname": q(2).val = TOOL_NAME   ' |fffd|c|fffd|[|fffd||fffd||fffd||fffd|
    q(3).key = "version": q(3).val = TOOL_VERSION      ' |fffd|c|fffd|[|fffd||fffd||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
    q(4).key = "operation": q(4).val = exeOperation ' |fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    q(5).key = "processedcount": q(5).val = CStr(argCount)      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|W|fffd|v|fffd||38f||fffd|)
    q(6).key = "onlineuserid": q(6).val = OnlineUserID ' |fffd||35dd||fffd|X|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|[|fffd|UID
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    '|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||691||fffd||fffd||fffd|
    If IsTestMode = False Then
        Log "|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O |fffd|{|fffd||50a||8b||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||702||fffd|"
        initServerLogger SERVER_LOG_URL_PRO
    Else
        Log "|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O |fffd|e|fffd|X|fffd|g|fffd||8b||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||702||fffd|"
        initServerLogger SERVER_LOG_URL_DEV
    End If

    '|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
    Call egg.submitServerLog(q)

    sendServerLog = True

    endOf "sendServerLog"
End Function

'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||115d0|M|fffd||fffd||fffd||90bd||fffd||7c2||241|A|fffd|K|fffd|v|fffd||203|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd||fffd|
' *****************************************************************************/
Private Function getAgentUserInfomation() As Boolean
    startOf "getAgentUserInfomation"

    Dim ms1on  As MS1Online

    Dim Shell  As Object
    Dim window As Object

    Dim windowName    As String
    Dim documentTitle As String

    Dim closeWindow   As Boolean

    Dim agCode As String
    Dim userId As String

    agCode = shtSetting.Range(AG_CODE_ADDR).Value
    userId = shtSetting.Range(USER_ID_ADDR).Value

    If agCode = "" Or userId = "" Then

        closeWindow = False

        ' /*******************************************
        '  *   |fffd||fffd||fffd||24a|J|fffd||fffd||fffd||102||fffd||fffd||fffd| ie |fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||fffd||a347||fffd|A
        '  *   [6.3]|fffd||309||fffd||282||fffd||82||fffd||fffd||fffd||60a4||fffd||243|t|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||102||fffd|
        '  *******************************************/
        Set Shell = CreateObject("Shell.Application")

        For Each window In Shell.Windows

            ' |fffd||fffd||fffd||fffd||fffd||fffd|
            windowName = ""
            documentTitle = ""

            ' |fffd||fffd||282||30f||fffd||fffd||fffd||fffd||64fe|
            On Error Resume Next
            windowName = window.FullName
            documentTitle = window.document.Title
            On Error GoTo 0

            If LCase(Right(windowName, 12)) = "iexplore.exe" Then

                ' Metro IE|fffd||fffd||fffd||fffd||fffd|O|fffd||1c9||fffd|
                If checkDesktopIe(window) = True Then

                    closeWindow = True

                    Exit For
                End If
            End If
        Next


        ' /*******************************************
        '  *   |fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||115d0|M|fffd||fffd||fffd||90bd||fffd||7c2||241|A|fffd|K|fffd|v|fffd||203|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd||fffd|
        '  *******************************************/
        Set ms1on = MS1OnlineFactory.GetMS1Online(code:="6.3")

        If ms1on.getDescription <> MS1OnlineFactory.DESC_SUCCEEDED Then
            MsgBox "MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||309||38d||410|\|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||282||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||fffd||502||14e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            getAgentUserInfomation = False
            ExitOf "getAgentUserInfomation", "MS1Online|fffd||30e||64fe||fffd||24e||fffd||fffd|s"
            Exit Function
        End If

        agCode = ms1on.getBKAGCode
        userId = ms1on.getOnlineUserID

        shtSetting.Range(AG_CODE_ADDR).Value = agCode
        shtSetting.Range(USER_ID_ADDR).Value = userId

        ' /*******************************************
        '  *   |fffd|g|fffd|p|fffd||94|\|fffd||211||35dd||fffd|X|fffd||fffd||fffd|A|fffd||35dd||fffd|XMS1|fffd||303||fffd||fffd|[|fffd|U|fffd||302||742||250||fffd||fffd||fffd|
        '  *******************************************/
        If agCode = "" Then

            ' /*******************************************
            '  *   |fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||64fe||fffd|G|fffd||fffd||fffd|[
            '  *******************************************/
            MessageBox 0, "|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & "|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B", "|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||64fe||fffd|G|fffd||fffd||fffd|[", vbInformation Or MB_OK Or MB_FG_TYPE

            ExitOf "getAgentUserInfomation", "|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||64fe||fffd|G|fffd||fffd||fffd|["

            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||82||fffd||fffd||10f|I|fffd||fffd|
            Util.closeThisWorkbook
        End If
    End If

    If closeWindow Then
        ms1on.getOnlineIE.Quit
    End If

    getAgentUserInfomation = True

    endOf "getAgentUserInfomation"
End Function

''/*****************************************************************************
'' * |fffd|@|fffd|\  |fffd|F |fffd||fffd||fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||303|Z|fffd|b|fffd|^|fffd|[
'' *****************************************************************************/
'Public Function setAgCode(ByVal code As String)
'    agcode = code
'End Function

''/*****************************************************************************
'' * |fffd|@|fffd|\  |fffd|F |fffd||fffd||fffd|[|fffd|UID|fffd||303|Z|fffd|b|fffd|^|fffd|[
'' *****************************************************************************/
'Public Function setOnlineUserID(ByVal id As String)
'    userId = id
'End Function


' *****************************************************************************
' * |fffd||590||fffd||fffd||fffd||fffd|FSetDebugLog
' * |fffd|T|fffd|v  |fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||30f|o|fffd||357|L|fffd||fffd||fffd||14ed2||80b5||fffd|A|fffd|o|fffd||342||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|O|fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|
' *****************************************************************************
Public Sub setDebugLog()
    startOf "setDebugLog"

    Dim path As String
    Dim WSH As Variant

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||243|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd|O|fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd|
    If shtSetting.Range(CYOUSA_MODE_ADDR).Value = True Then
'    If shtList.Shapes(CHECKBOX_INVESTIGATION_MODE).ControlFormat.Value = xlOn Then
        '|fffd|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd||243||fffd||fffd|O|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|
        Set WSH = CreateObject("Wscript.Shell")
        path = WSH.SpecialFolders("Desktop") & "\"

        initLogger (path & TOOL_NAME & ".log")
        Set WSH = Nothing

        Log "***********************************************"
        Log "* |fffd||fffd||fffd|O|fffd||30f|o|fffd||342||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
        Log "***********************************************"
        Log "*|fffd|c|fffd|[|fffd||fffd||fffd||fffd|        |fffd|F" & TOOL_NAME
        Log "*|fffd|c|fffd|[|fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|F" & TOOL_VERSION
        Log "*OS|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|    |fffd|F" & getOSVersion
        Log "*Excel|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd| |fffd|F" & getExcelVersion
        Log "*IE|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|    |fffd|F" & getIEVersion
        Log "***********************************************"

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||381|A|fffd||fffd||fffd|O|fffd|p|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else
        initLogger ""
    End If
    endOf "setDebugLog"
End Sub
Attribute VB_Name = "MS1Kokyaku"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

'|fffd||fffd||fffd||fffd||fffd|o|fffd|[
Private kokyakuIe As InternetExplorer
Private Description As String
Private StackTrace As String
Private Shanai As Boolean

'IE|fffd||fffd|Getter
Public Function getKokyakuIE() As InternetExplorer
    Set getKokyakuIE = kokyakuIe
End Function

'IE|fffd||fffd|Setter
Public Sub setKokyakuIE(ie As InternetExplorer)
    Set kokyakuIe = ie
End Sub

'Description|fffd||fffd|Getter
Public Function getDescription() As String
    getDescription = Description
End Function

'Description|fffd||fffd|Setter
Public Sub setDescription(val As String)
    Description = val
    setStackTrace val
End Sub

'StackTrace|fffd||fffd|Getter
Public Function getStackTrace() As String
    getStackTrace = StackTrace
End Function

'StackTrace|fffd||fffd|Setter
Public Sub setStackTrace(val As String)
    StackTrace = val & vbCrLf & StackTrace
End Sub

'Shanai|fffd||fffd|Getter
Public Function isShanai() As Boolean
    Dim url As String
    On Error Resume Next
    url = kokyakuIe.LocationURL
    On Error GoTo 0
    If InStr(url, "mitsuisumitomo-ins.co.jp") > 0 Then
        isShanai = True
    Else
        isShanai = False
    End If
End Function
Attribute VB_Name = "MS1KokyakuFactory"
Option Explicit
'/****************************************************************************
' * MS1kokyakuFactory 2014.02.10 v0.56
' *
' * MS1|fffd||68b|q|fffd||1d7||fffd||fffd||30b|N|fffd||fffd||fffd||202||1c2||fffd||fffd|s|fffd||fffd||fffd|@|fffd|\|fffd|Q
' *
' * |fffd||fffd||fffd|j|fffd|e|fffd|B|fffd||389||fffd||fffd||152||1c9||fffd|
' *
' ****************************************************************************/
' 2013/12/20 |fffd||413||fffd| |fffd||35dd||fffd|X|fffd||fffd||fffd||342||311||389||fffd|
'      |fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||151||35dd||fffd|X|fffd|R|fffd|[|fffd|h5|fffd||fffd||fffd||213||fffd||fffd||30e|w|fffd||fffd||30f||a347||fffd||341|A|fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||401|v|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
' 2014/01/07 |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|ProxySub|fffd|^|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy|fffd||143|\|fffd|[|fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|W|fffd||fffd|
' 2014/01/14 |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||143|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||60a4||fffd||251||389||fffd||fffd|i|fffd|N|fffd||fffd||fffd|X|fffd|FCheckOnClick|fffd|g|fffd|p|fffd|j
'            |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||251||482||fffd||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7c9||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||9044|
' 2014/01/16 |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||143|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||588||693||fffd|
' 2014/02/10 |fffd||413||fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||342||142||303|G|fffd||fffd||fffd|[|fffd||389||fffd||fffd||fffd||1c9||fffd||fffd||fffd||fffd||5576||fffd||fffd||fffd||3ca||fffd||fffd||150||752||fffd||255||3cd|X

'|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|g|fffd|p--------------------------------------------------------------------------
'|fffd|J|fffd||fffd||fffd||fffd||282||30e||fffd||fffd|
Public Enum open|fffd||fffd||fffd|
    |fffd||fffd||fffd|q|fffd||fffd||fffd||70f||fffd||fffd||1d7||fffd| = 1
    |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|X|fffd|g|fffd||c42c|
    |fffd||fffd||fffd||fffd||fffd||1d7||fffd|
    |fffd|S|fffd||410||fffd||fffd||fffd| = 5
    |fffd||fffd||fffd|q|fffd||fffd||fffd||70f||fffd||fffd||189||fffd|
    |fffd|V|fffd|K|fffd|l|fffd||fffd||fffd||1d7||fffd|
    |fffd||752||fffd|
End Enum
'|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|g|fffd|p--------------------------------------------------------------------------

'|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W
Private Const DESC_KOKYAKU_URL_NOT_FOUND As String = "MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|URL|fffd||fffd||fffd||fffd||fffd||752||fffd||142||fffd|"
Private Const DESC_KOKYAKU_WINDOW_CLOSED As String = "MS1|fffd||68b|q|fffd||1d7||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
Private Const DESC_KOKYAKU_SUCCEEDED As String = "MS1|fffd||68b|q|fffd||1d7||fffd||fffd||30e||64fe||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
Private Const DESC_KOKYAKUAGC_WINDOW_CLOSED As String = "|fffd||35dd||fffd|X|fffd||fffd||fffd||342||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
'2014/02/10 |fffd||413||fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd|p|fffd||252||1c9||fffd|
Private Const DESC_KOKYAKUAGC_WINDOW_ERR As String = "|fffd||35dd||fffd|X|fffd||fffd||fffd||342||148||209||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||182||202||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|w%MSG%|fffd|x"
Private Const DESC_DAIALOG_WINDOW_OPENED As String = "|fffd|w%TITLE%|fffd|x|fffd||fffd||282||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7cf||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & "|fffd||82||fffd||fffd||102||fffd||fffd||73c8||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"

'|fffd||68b|q|fffd||1d7||fffd||fffd|@|fffd||fffd||fffd||fffd|L|fffd|[|fffd|p|fffd|^|fffd|[|fffd||fffd|
'2013/12/20 |fffd||7c2||9440||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|c|fffd||fffd||fffd||102||fffd||fffd||fffd||181|A|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||fffd|V|fffd|K|fffd|N|fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd|B
'2013/12/20 |fffd||7c2||9440||fffd||fffd||fffd||fffd|URL|fffd||242||fffd|SCREEN_ID|fffd||fffd||fffd||702||702||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|BURL|fffd||fffd||fffd||fffd||341|A|fffd|O|fffd||fffd||fffd|[|fffd|v|fffd|I|fffd||fffd|ID|fffd||255||3cd|X
'@Private Const KOKYAKU_KEY_PATTERN As String = "STY[A-Z]N##[A-Z]##"
Private Const KOKYAKU_SCREEN_PATTERN    As String = "STY[A-Z]N##[A-Z]##"
Private Const KOKYAKU_URL_PATTERN       As String = "TY[A-Z]N##[A-Z]"

'|fffd||68b|q|fffd||1d7||fffd||fffd|N|fffd||fffd||fffd|i|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|j |fffd||353c||fffd||fffd||fffd|p|fffd|X
Private Const KOKYAKU_KICK_PATH As String = "/TYZN99A/LSTYZN99ACM09_STYZN99A09_E_%ID%BL.do"
'%ID%|fffd||fffd| 1:|fffd||fffd||fffd|q|fffd||fffd||fffd||70f||fffd||fffd||1d7||fffd|  2:|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|X|fffd|g|fffd||c42c|  3:|fffd||fffd||fffd||fffd||fffd||1d7||fffd|  5:|fffd|S|fffd||410||fffd||fffd||fffd|  6:|fffd||fffd||fffd|q|fffd||fffd||fffd||70f||fffd||fffd||189||fffd|  7:|fffd|V|fffd|K|fffd|l|fffd||fffd||fffd||1d7||fffd|  8:|fffd||752||fffd|

'|fffd||413||fffd|
Private Const MS1_INTRA_URL As String = "http://www1.tyweb.ms.ms-ad-ins.com/ms-on01/TYZN99A/LSTYZN99ACM10_STYZN99A09_E_%ID%BL.do"

'->|fffd||fffd||fffd||fffd|Web |fffd|y|fffd|[|fffd|W Daialog|fffd||fffd||fffd||fffd||fffd|p|fffd|i|fffd||fffd||fffd||742||fffd||fffd||102||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7cf|I|fffd||fffd||fffd|j
'API|fffd||fffd|` -------------------------------------------------------
#If Win64 Then
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare PtrSafe Function EnumWindows Lib "user32" (ByVal lpEnumFunc As LongPtr, ByVal lParam As LongPtr) As Long
'2014/01/07 |fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd|q|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
Public Declare PtrSafe Function FindWindowEx Lib "user32.dll" Alias "FindWindowExA" _
        (ByVal hWndParent As LongPtr, ByVal hwndChildAfter As LongPtr, ByVal lpszClass As String, ByVal lpszWindow As String) As LongPtr
#Else
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare Function EnumWindows Lib "user32" (ByVal lpEnumFunc As Long, lPalam As Long) As Long
'2014/01/07 |fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd|q|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
Public Declare Function FindWindowEx Lib "user32.dll" Alias "FindWindowExA" _
        (ByVal hWndParent As Long, ByVal hwndChildAfter As Long, ByVal lpszClass As String, ByVal lpszWindow As String) As Long
#End If
Private Const WM_CLOSE As Long = &H10                           '2014/01/07|fffd||1c9||fffd|

'EnumWindows ---------------------------------------------------
Private mdlFindClassFull    As String             '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlFindTitlePart    As String             '|fffd||fffd||fffd||fffd||fffd||fffd|v
#If Win64 Then
Private mdlTargethWnd       As LongPtr            '|fffd||64fe||fffd|n|fffd||fffd||fffd|h|fffd||fffd|
#Else
Private mdlTargethWnd       As Long               '|fffd||64fe||fffd|n|fffd||fffd||fffd|h|fffd||fffd|
#End If
Private mdlWebDialogTitle   As String             '|fffd||64fe||fffd|^|fffd|C|fffd|g|fffd||fffd|
'<-|fffd||fffd||fffd||fffd|Web |fffd|y|fffd|[|fffd|W Daialog|fffd||fffd||fffd||fffd||fffd|p

'MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd||282||fffd|IE|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe|
'|fffd|@|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||fffd||fffd||142||202||fffd||fffd||60a4||fffd||243|||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90b1||fffd||182||fffd|O|fffd||fffd||182||fffd||fffd||fffd|B|fffd||fffd||fffd|O|fffd||243|||fffd|[|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd||3c2||743|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|K|fffd|v|fffd|B
'|fffd|A|fffd||fffd||fffd|d|fffd|N|fffd||fffd||fffd||fffd||fffd||24a|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||142||90bd||fffd||7c1|A|fffd|N|fffd||fffd||fffd||fffd|URL|fffd||64fe||fffd||fffd||24a||fffd||fffd||fffd||fffd||fffd||282||355||82||fffd||fffd||fffd|B
'|fffd|BNavigate2|fffd||fffd||fffd|IE|fffd||fffd||fffd||10d||c42c||fffd||fffd||fffd||fffd||90bd||fffd||7c1|A|fffd||10e||64fe||fffd||fffd||fffd|s|fffd||fffd||fffd|B
'|fffd||fffd||fffd||fffd||fffd|ID|fffd||355|K|fffd|{|fffd||142||fffd||fffd||fffd|
Public Function getMS1Kokyaku(Optional ByVal screenId As open|fffd||fffd||fffd| = open|fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||1d7||fffd|, _
                                Optional ByVal agencyCode As String = "", _
                                Optional ByVal shellWaitMs = 30000) As MS1Kokyaku
    startOf "getMS1Kokyaku"
    
    Dim ms1 As New MS1Kokyaku
    Dim ie As InternetExplorer
    Dim KokyakuURL As String
    Dim BaseURL As String
    Dim ParamPos As Integer

    Dim webDlgTitle As String
    Dim docTitle    As String
    
    Dim WAIT_TIME   As Long
    Dim startTime As Long
    Dim UseTime As Long
    
    WAIT_TIME = shellWaitMs
    
    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|Web|fffd|y|fffd|[|fffd|WDailog|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd|F|fffd||fffd||fffd||74e||fffd||fffd||34f|I|fffd||fffd|-------
    webDlgTitle = checkWebDailog()
    If webDlgTitle <> "" Then
        ms1.setDescription Replace(DESC_DAIALOG_WINDOW_OPENED, "%TITLE%", webDlgTitle)
        Set getMS1Kokyaku = ms1
        Exit Function
    End If
    '----------------------------------------------------------------
    
    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||64fe||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||281|i|fffd||413||fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||342||fffd||fffd||702||7c1|j|fffd||355||82||fffd||fffd||fffd|j
    KokyakuURL = Trim(getRunningMS1KokyakuURL(True))
    '|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||353|o|fffd|^|fffd||3c2||fffd|URL|fffd||fffd||fffd||64fe|
    If KokyakuURL = "" Then KokyakuURL = Trim(getRegisteredMS1KokyakuURL)
    '|fffd||fffd||fffd||fffd||142||fffd|URL|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||34b|N|fffd||fffd||fffd||fffd||24d||10e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||70a4|
    If KokyakuURL = "" Then
        ms1.setDescription DESC_KOKYAKU_URL_NOT_FOUND
        Set getMS1Kokyaku = ms1
        Exit Function
    End If

    'URL|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|J|fffd|n|fffd||292|u|fffd|i|fffd|A|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||30f||a347||fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
    ParamPos = InStr(KokyakuURL, "?")
    If ParamPos > 0 Then KokyakuURL = Left(KokyakuURL, ParamPos - 1)
    '|fffd||413||fffd||fffd||142||202||fffd||fffd||a347|URL|fffd||fffd||fffd|N|fffd||fffd||fffd|p|fffd||255||3ca||fffd|
    If Not isMS1PC Then
        'URL|fffd||353c||fffd||fffd|/../..|fffd||fffd||fffd|J|fffd|b|fffd|g
        KokyakuURL = Left(KokyakuURL, InStrRev(KokyakuURL, "/") - 1)
        KokyakuURL = Left(KokyakuURL, InStrRev(KokyakuURL, "/") - 1)
        '|fffd|N|fffd||fffd|URL|fffd||c42c|
        KokyakuURL = KokyakuURL & KOKYAKU_KICK_PATH
    End If
    '|fffd|N|fffd||fffd||fffd||fffd||792|u|fffd||fffd|
    KokyakuURL = Replace(KokyakuURL, "%ID%", CStr(screenId))
    
    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|o|fffd|^|fffd|p|fffd||fffd|URL|fffd||fffd||6ce||fffd|
    BaseURL = KokyakuURL

    'IE|fffd|N|fffd||fffd|
    '|fffd|V|fffd|KIE|fffd||c42c||fffd|i2013/04/10|fffd||fffd|p|fffd||255||3cd|X|fffd|j
    Set ie = insteadCreateIE(KokyakuURL)
    '@@Set ie = CreateObject("InternetExplorer.Application")
    '|fffd|N|fffd||fffd||fffd||fffd||fffd||303|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||d0b9||fffd||10e|w|fffd||fffd|
    With ie
        .Top = 0
        .Left = 0
        .AddressBar = False
        .MenuBar = False
        .resizable = True
        .StatusBar = False
        .Toolbar = False
        .Width = 1014
        .Height = 708
        .Visible = True
    End With
    '|fffd||fffd|IE|fffd||10d||c42c||fffd||fffd||fffd||fffd||90bd||fffd||7c1|AIE|fffd||10e||64fe||fffd||fffd||fffd|K|fffd|v|fffd|iwaitForBrowse|fffd|s|fffd||81|j
    Log "Navigate2|fffd|@START:" & KokyakuURL
    ie.Navigate2 KokyakuURL
    Log "Navigate2|fffd|@END:" & KokyakuURL
    
    '@@Log "WFB_START:getMS1kokyaku"
    '@@waitForBrowse ie
    '@@Log "WFB_END:getMS1kokyaku"
        
    '|fffd||413||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|F|fffd||35dd||fffd|X|fffd||fffd||fffd||349||fffd||282||fffd||246b|
    If isMS1PC Then
        
        UseTime = 0
        startTime = GetTickCount
        Do
            DoEvents
            Sleep 10
                            
            'IE|fffd||10e||64fe||fffd|F|fffd||35dd||fffd|X|fffd||fffd||fffd||349||fffd||282||fffd||246b||fffd|i|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||246b||fffd||302||fffd||fffd||fffd|resume next|fffd||1c9||fffd||fffd|j
            On Error Resume Next
            Set ie = Nothing
            Set ie = getRunningIE("|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|", "|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||fffd| |fffd|w|fffd||fffd|")
            On Error GoTo 0
            If Not ie Is Nothing Then
                Log "|fffd||35dd||fffd|X|fffd||fffd||fffd||349||fffd||282||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                Exit Do
            End If
            
            UseTime = GetTickCount - startTime
    
        Loop While UseTime < WAIT_TIME
        If ie Is Nothing Then
            Log "|fffd||35dd||fffd|X|fffd||fffd||fffd||349||fffd||282||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            ms1.setDescription DESC_KOKYAKUAGC_WINDOW_CLOSED
            Set getMS1Kokyaku = ms1
            Exit Function
        End If
        '|fffd||fffd||294||fffd||fffd||fffd||fffd||48b|@
        waitForBrowse ie

        '|fffd||151|S|fffd||fffd| 2014/02/10
        Call SetForegroundWindow(ie.hWnd)
        
        DoEvents
        Sleep 100
        
        '2013/12/20|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||315||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||402||311|I|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||1c9||fffd|
        If screenId = open|fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||1d7||fffd| And Len(agencyCode) < 6 Then
            '|fffd||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||402||303|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
            '|fffd|@(0):|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||fffd|
            '|fffd|@(1):|fffd||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||fffd|
            Log "|fffd||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||402||303|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|"
            ie.document.getElementsByName("agencySectionSelect")(1).Checked = True
        Else
            '|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd||752||fffd|
            Log "|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd||fffd||752||fffd|F" & UCase(agencyCode)
            '2014/02/10 |fffd||5576||fffd||fffd||fffd||3ca||fffd||fffd||150||752||fffd|
            'ie.document.getElementsByName("agencyCode")(0).value = agencyCode
            ie.document.getElementsByName("agencyCode")(0).Value = UCase(agencyCode)
        End If
        '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
        Log "|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd|"
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Call clickButton(ie.document, "|fffd||fffd|  |fffd|s")
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/05/20 |fffd||1c9||fffd| T.K|fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Call ClickButtonByValue(ie.document, "|fffd||fffd|  |fffd|s")
'2016/05/20 |fffd||1c9||fffd| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
        
        '->2014/02/10|fffd|G|fffd||fffd||fffd|[|fffd||389||fffd||fffd||1c9||fffd|
        '|fffd||fffd||fffd||d0be||fffd||189||fffd||282||fffd||fffd||202||fffd||202||90bd||fffd||7c1|A|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||16cce||fffd||fffd||fffd||fffd||111||35dd||fffd|X|fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd|m|fffd|F
        On Error Resume Next
        '|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||48b|@
        waitForBrowse ie
        
        Dim msg As String
        msg = ""
        msg = getTDValue(ie.document, "|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|", 0, 6)
        If Trim(msg) <> "" Then
            Log "|fffd||35dd||fffd|X|fffd||fffd||fffd||342||143|G|fffd||fffd||fffd|[|fffd||182||202||fffd||702||fffd||fffd||fffd| |fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|F" & msg
            ms1.setDescription Replace(DESC_KOKYAKUAGC_WINDOW_ERR, "%MSG%", msg)
            Set getMS1Kokyaku = ms1
            Exit Function
        End If
        On Error GoTo 0
        '<-2014/02/10|fffd|G|fffd||fffd||fffd|[|fffd||389||fffd||fffd||1c9||fffd|
    End If
    
    'MS1|fffd||68b|q|fffd||1d7||fffd||fffd||30e||64fe||fffd||702||151||48b|@
    '|fffd||fffd||fffd|||fffd|[|fffd|^|fffd||fffd||fffd||34b|N|fffd||fffd||fffd||3c2||742||143||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||342||142||202||fffd||fffd|z|fffd||fffd|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 10
        
        '|fffd||68b|q|fffd||1d7||fffd||fffd||30d||10e||64fe||fffd|i|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||246b||fffd||302||fffd||fffd||fffd|resume next|fffd||1c9||fffd||fffd|j
        On Error Resume Next
        Set ie = Nothing
        Set ie = getRunningMS1KokyakuIE
        On Error GoTo 0
        If Not ie Is Nothing Then
            On Error Resume Next
            '|fffd||3d0||fffd||fffd||202||fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
            docTitle = ie.document.Title
            If Err.Number = 0 Then
                Log "|fffd||68b|q|fffd||1d7||fffd||fffd||fffd||282||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd||fffd| TITILE:" & docTitle
                ms1.setDescription DESC_KOKYAKU_SUCCEEDED
                ms1.setKokyakuIE ie
                '|fffd||691||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||182||fffd||fffd||103||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||253|o|fffd|^
                registerMS1KokyakuURL BaseURL
                Exit Do
            End If
            On Error GoTo 0
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < WAIT_TIME
    If ie Is Nothing Then
        Log "|fffd||68b|q|fffd||1d7||fffd||fffd||fffd||282||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
        ms1.setDescription DESC_KOKYAKU_WINDOW_CLOSED
        Set getMS1Kokyaku = ms1
        Exit Function
    End If

    '|fffd||10e||64fe|IE|fffd||fffd||fffd||fffd||fffd||fffd||248||693||fffd| 2013/06/25
    With ie
        .Top = 0
        .Left = 0
    End With
      
    '2013/06/25|fffd||1c9||fffd|
    '|fffd||fffd||fffd||fffd|IE6|fffd||302||741|B|fffd|e|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||82||fffd||fffd||60a4||fffd||182||fffd||fffd||fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
    '|fffd|u|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||341|A|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd| Web |fffd|y|fffd|[|fffd|W|fffd||242||fffd||fffd||82||fffd||fffd||fffd||fffd||60a4||fffd||182||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||82||fffd||fffd||702||fffd||fffd||fffd|?|fffd|v
    '|fffd||fffd||fffd||308||292|u|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|m|fffd||fffd||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||80b7||fffd||fffd|B
    Dim i   As Long
    For i = 1 To 10
        DoEvents
        Sleep 10
        Call clickIEAlert("|fffd||342||fffd|", "|fffd||82||fffd||fffd||fffd||fffd||60a4||fffd||182||fffd||fffd||102||fffd||fffd||702||fffd|")
    Next
        
    Set getMS1Kokyaku = ms1
    
    endOf "getMS1Kokyaku"
End Function

'|fffd|N|fffd||fffd||fffd||3c2||fffd|MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|IE|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'  SCREEN_ID |fffd||fffd||fffd||68b|q|fffd|L|fffd|[|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd|URL |fffd||fffd| *|fffd||68b|q|fffd|L|fffd|[|fffd|p|fffd|^|fffd|[|fffd||fffd|* |fffd||fffd||fffd||702||fffd|
'  |fffd||fffd|URL|fffd||242||341|ASCREEN_ID|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||702||702||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||202||fffd|
Public Function getRunningMS1KokyakuIE() As InternetExplorer
    startOf "getRunningMS1KokyakuIE"

    Dim ret As String
    Dim shs As Object
    Dim sh As Object
    Dim winname As String
    Dim docTitle As String
    Dim screenId As String
    Dim locUrl As String
    Dim ie As InternetExplorer
    
    'ShellWindows|fffd||fffd||fffd||64fe|
    Set shs = CreateObject("Shell.Application")
    
    For Each sh In shs.Windows
        'ShellWindow|fffd||303|p|fffd|X|fffd||fffd||fffd||64fe|
        On Error Resume Next
        winname = ""
        winname = sh.FullName
        On Error GoTo 0
        'IE|fffd||30f||a347|
        If LCase(Right$(winname, 12)) = "iexplore.exe" Then
            '2013/03/27 Metro IE|fffd||fffd||fffd||fffd||fffd|O|fffd||1c9||fffd|
            If checkDesktopIe(sh) = True Then
                Set ie = sh
                '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||64fe|
                On Error Resume Next
                docTitle = ""
                docTitle = ie.document.Title
                Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd|F" & docTitle
                locUrl = ""
                locUrl = Trim(ie.LocationURL)
                Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||fffd|LocationURL|fffd|F" & locUrl
                screenId = ""
                screenId = Trim(ie.document.getElementsByName("SCREEN_ID")(0).Value)
                Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||fffd|ScreenId|fffd|F" & screenId
                On Error GoTo 0
                'SCREEN_ID|fffd||fffd||fffd||68b|q|fffd||1d7||fffd||fffd|L|fffd|[|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd|URL|fffd||fffd|SCREEN_ID|fffd||fffd||fffd||702||702||a0bd||fffd||fffd|MS1|fffd||68b|q|fffd||1d7||fffd||fffd||194||fffd||fffd||fffd|
                '|fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||202||fffd||fffd||193|r|fffd||fffd||fffd||fffd||7c2||702||fffd||fffd||102||fffd||fffd||702||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|B
                '2013/12/20 |fffd||7c2||9440||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|c|fffd||fffd||fffd||102||fffd||fffd||fffd||181|A|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||fffd|V|fffd|K|fffd|N|fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd|B
                '2013/12/20 |fffd||7c2||9440||fffd||fffd||fffd||fffd|URL|fffd||242||fffd|SCREEN_ID|fffd||fffd||fffd||702||702||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|BURL|fffd||fffd||fffd||fffd||341|A|fffd|O|fffd||fffd||fffd|[|fffd|v|fffd|I|fffd||fffd|ID|fffd||255||3cd|X
                'If (docTitle <> "" And _
                '    screenId Like KOKYAKU_KEY_PATTERN And _
                '    locUrl Like "*" & KOKYAKU_KEY_PATTERN & "*") Then
                If (docTitle <> "" And _
                    screenId Like KOKYAKU_SCREEN_PATTERN And _
                    locUrl Like "*" & KOKYAKU_URL_PATTERN & "*") Then
                    Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||141|AgetRunningMS1kokyakuIE|fffd||14c82||fffd||fffd||702||fffd|"
                    Set getRunningMS1KokyakuIE = ie
                    Exit For
                End If
            End If
        End If
    Next

    endOf "getRunningMS1KokyakuIE"
End Function

'|fffd|N|fffd||fffd||fffd||3c2||fffd|MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'|fffd|I|fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||14e||64fe||fffd||fffd||282||fffd||82||fffd||fffd||fffd|i|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd|s|fffd|s|fffd||81|F|fffd|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||142||fffd|j
Public Function getRunningMS1KokyakuURL(Optional ByVal blnClose As Boolean = False) As String
    startOf "getRunningMS1KokyakuURL"
    Dim ie  As InternetExplorer
    Dim ieAgency    As InternetExplorer
    Dim url As String

    url = ""
    Set ie = getRunningMS1KokyakuIE
    If Not ie Is Nothing Then
        url = ie.LocationURL
    End If
    Log "|fffd||64fe||fffd||fffd||fffd||fffd|URL|fffd|F" & url

    '|fffd||413||fffd||fffd||fffd||fffd||602||141||fffd||fffd||30f||fffd||fffd||fffd||fffd||142||30e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||282||60a4||fffd|A|fffd||fffd||50d||14c||fffd||24e||413||fffd||fffd||fffd||fffd||80b7||fffd||fffd|
    If isMS1PC Then
         url = MS1_INTRA_URL
    End If
    Log "|fffd||64fe||fffd||fffd||fffd||fffd|URL|fffd|F" & url

    getRunningMS1KokyakuURL = url
    
    '|fffd||fffd||fffd|d|fffd|N|fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7c3|N|fffd||fffd||fffd|[|fffd|Y
    If blnClose = True Then
        If Not ie Is Nothing Then
            ie.Quit
            Set ie = Nothing
        End If
        If isMS1PC Then
            '|fffd||413||fffd||fffd||151||35dd||fffd|X|fffd||fffd||fffd||349||fffd||282||fffd||fffd|c|fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||341|A|fffd||68b|q|fffd||1d7||fffd||fffd||fffd||282||193||fffd||fffd|l|fffd||255||82||fffd||fffd||fffd|
            Set ieAgency = getRunningIE("|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|", "|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||fffd| |fffd|w|fffd||fffd|")
            If Not ieAgency Is Nothing Then
                ieAgency.Quit
                Set ieAgency = Nothing
            End If
        End If
    End If
    
    endOf "getRunningMS1KokyakuURL"
End Function

'|fffd|o|fffd|^|fffd||3c2||fffd|MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRegisteredMS1KokyakuURL() As String
    startOf "getRegisteredMS1KokyakuURL"

    Dim ret As String
    ret = GetSetting("OneClickTool", "Common\MS1Kokyaku", "URL", "")
    getRegisteredMS1KokyakuURL = ret
    
    If isMS1PC Then
        getRegisteredMS1KokyakuURL = MS1_INTRA_URL
    End If

    endOf "getRegisteredMS1KokyakuURL"
End Function

'MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|URL|fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd|
Public Function registerMS1KokyakuURL(url As String) As String
    startOf "registerMS1KokyakuURL"
    
    Dim ret As String
    '|fffd||c2||fffd|URL|fffd||fffd||502||fffd||fffd||fffd||fffd||7c2||24e||64fe|
    ret = GetSetting("OneClickTool", "Common\MS1Kokyaku", "URL", "")
    'URL|fffd|o|fffd|^
    SaveSetting "OneClickTool", "Common\MS1Kokyaku", "URL", url
    registerMS1KokyakuURL = ret

    endOf "registerMS1KokyakuURL"
End Function

'MS1|fffd||68b|q|fffd||1d7||fffd||fffd||fffd|URL|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
Public Function deleteMS1KokyakuURL() As String
    startOf "deleteMS1KokyakuURL"
    
    '|fffd||d5d8e||fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||90b1||fffd||182||14d||d3dc||fffd|B|fffd||c2||fffd|URL|fffd||fffd||502||fffd|
    deleteMS1KokyakuURL = registerMS1KokyakuURL("")

    endOf "deleteMS1KokyakuURL"
End Function

'->|fffd||fffd|Web |fffd|y|fffd|[|fffd|WDaialog
'WebPageDailog|fffd|`|fffd|F|fffd|b|fffd|N|fffd|p|fffd|FWebPageDailog|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||90a9|
Private Function checkWebDailog(Optional DLG_WAITTIME As Long = 2000) As String
    startOf "checkWebDailog"
    
    Dim startTime As Long
    Dim UseTime As Long
    
    checkWebDailog = ""
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||752||fffd|
    mdlFindClassFull = "Internet Explorer_TridentDlgFrame"
    mdlFindTitlePart = "Web |fffd|y|fffd|[|fffd|W |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O"
    
    'web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|iCUSTOM|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd|[|fffd|j|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 10
        
        mdlTargethWnd = 0
        mdlWebDialogTitle = ""
        
        '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
        Call EnumWindows(AddressOf getWebDaialog, 0)
        
        If mdlTargethWnd > 0 Then
            Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            checkWebDailog = mdlWebDialogTitle
            Exit Do
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < DLG_WAITTIME
    If UseTime >= DLG_WAITTIME Then
        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If

    endOf "checkWebDailog"
    
End Function
'-> 2014/01/07 |fffd||68b|q|fffd|n|fffd||30b||fffd||fffd||295||fffd||fffd|i|fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||14f|d|fffd||fffd||fffd||302||fffd||fffd||7cd||d3dc|
'''IE|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||10b|A|fffd||fffd|
''#If Win64 Then
''Private Function getWebDaialog(ByVal hwnd As LongPtr, ByVal lparam As LongPtr) As Long
''#Else
''Private Function getWebDaialog(ByVal hwnd As Long, ByVal lparam As Long) As Long
''#End If
''
''    getWebDaialog = 1             '|fffd|S|fffd||64fe|
''
''    mdlWebDialogTitle = ""
''    If getClassNameProc(hwnd) = mdlFindClassFull Then
''        mdlWebDialogTitle = GetWindowTextProc(hwnd)
''        If InStr(mdlWebDialogTitle, mdlFindTitlePart) > 0 Then
''            mdlTargethWnd = hwnd
''            getWebDaialog = 0             '|fffd||64fe||fffd|I|fffd||fffd|
''            'Debug.Print "TOP hWnd:" & hWnd
''        End If
''    End If
''
''End Function
'''|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||50b|p
''#If Win64 Then
''Private Function getClassNameProc(hwnd As LongPtr) As String
''#Else
''Private Function getClassNameProc(hwnd As Long) As String
''#End If
''    Dim Buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
''    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
''
''    lngRt = getClassName(hwnd, Buffer, Len(Buffer))
''    getClassNameProc = left(Buffer, InStr(Buffer, vbNullChar) - 1)
''End Function
'''|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p
''#If Win64 Then
''Private Function GetWindowTextProc(hwnd As LongPtr) As String
''#Else
''Private Function GetWindowTextProc(hwnd As Long) As String
''#End If
''    Dim Buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
''    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
''
''    lngRt = GetWindowText(hwnd, Buffer, Len(Buffer))
''    GetWindowTextProc = left(Buffer, InStr(Buffer, vbNullChar) - 1)
''End Function
'<- 2014/01/07 |fffd||68b|q|fffd|n|fffd||30b||fffd||fffd||295||fffd||fffd|i|fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||14f|d|fffd||fffd||fffd||302||fffd||fffd||7cd||d3dc|
'<-|fffd||fffd|Web Daialog

'****************************************************************
'* |fffd||fffd||fffd||fffd||fffd||20d|~|fffd||341|A2014/01/07 |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|ProxySub|fffd|^|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy|fffd||14e|g|fffd|p|fffd|i1|fffd||4cf||fffd||fffd||242||702||182||7c2||fffd|j|fffd||fffd||fffd||fffd|
'****************************************************************

'->|fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|j|fffd||182||202||fffd|name|fffd|AValue|fffd||302||742||143|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|`|fffd||202||fffd||fffd||303|{|fffd|^|fffd||fffd||fffd||fffd||53bca||fffd||fffd||143|N|fffd||fffd||fffd|b|fffd|N
'|fffd|@|fffd|@Value|fffd|l|fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||fffd||fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||252||1c9||fffd||fffd|Fjava|fffd||351||5576||fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||308||4ce||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7d2||fffd||fffd||fffd|
'|fffd|@|fffd|A|fffd||53bca||fffd||fffd||152||1c9||fffd||fffd||fffd||fffd||fffd||fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||fffd||fffd||10f|o|fffd||fffd|
Public Function asyncClickExecuteDailog(doc As HTMLDocument, ByVal btnCaption As String)
    Dim ce  As Object
    Dim addFunc As String   '|fffd|}|fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(|fffd||fffd||fffd||fffd||fffd||fffd|)
    
    Set ce = doc.createElement("SCRIPT")
    
    ce.Type = "text/javascript"
    addFunc = "function asyncClickExecuteDailog(caption)"
    addFunc = addFunc & "{var objInputs = document.getElementsByTagName(""INPUT""); "
    addFunc = addFunc & "for(var i = 0; i < objInputs.length; i++)"
    addFunc = addFunc & "{var objBtn = objInputs(i); "
    addFunc = addFunc & "var objType = objBtn.getAttribute(""TYPE"").toLowerCase(); "
    addFunc = addFunc & "if (objType == 'button' && objBtn.value == caption)"
    addFunc = addFunc & "{objBtn.click(); break; } } }"
    ce.text = addFunc  '|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    
    '|fffd||c42c||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||251|}|fffd||fffd||fffd||fffd||fffd||fffd|
    Call doc.body.appendChild(ce)
    
    '|fffd||c42c||fffd||fffd||fffd||fffd||fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
    doc.Script.setTimeout "javascript:asyncClickExecuteDailog('" & btnCaption & "');", 10

End Function
'<-|fffd||fffd||fffd||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|j|fffd||182||202||fffd|name|fffd|AValue|fffd||302||742||143|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|`|fffd||202||fffd||fffd||303|{|fffd|^|fffd||fffd||fffd||fffd||53bca||fffd||fffd||143|N|fffd||fffd||fffd|b|fffd|N

'->|fffd||fffd||fffd||fffd|Web Daialog
'|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd|p|fffd|F|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||35dd||fffd|X|fffd||fffd||fffd||482||30f||a347||fffd|A|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7d5||82||fffd||fffd||fffd|iDom|fffd||3ca||fffd||fffd|j
Public Function existsDairitenWebDailog(ByVal findTitlePart As String, ByVal clickBtnName As String, _
                    Optional DLG_WAITTIME As Long = 2000) As Boolean
    Log "Web Daialog|fffd|F|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|s"
    existsDairitenWebDailog = replyWebDailog(findTitlePart, clickBtnName, DLG_WAITTIME)
End Function
'|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|iDom|fffd||3ca||fffd||fffd|j
Public Function downloadWebDailog(ByVal findTitlePart As String, ByVal clickBtnName As String, _
                    Optional DLG_WAITTIME As Long = 20000) As Boolean
    Log "Web Daialog|fffd|F|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s"
    downloadWebDailog = replyWebDailog(findTitlePart, clickBtnName, DLG_WAITTIME)
End Function
Private Function replyWebDailog(ByVal findTitlePart As String, ByVal clickBtnName As String, _
                    Optional DLG_WAITTIME As Long = 2000) As Boolean
    startOf "replyWebDailog"
    #If Win64 Then
    Dim childHWnd   As LongPtr
    Dim result  As LongPtr
    #Else
    Dim childHWnd   As Long
    Dim result  As Long
    #End If
    Dim doc As Object
    Dim docNext As Object
    
    '->2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||64fe||fffd|p
    Dim bElement    As HTMLButtonElement
    Dim coc     As New CheckOnClick
    '<-2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||64fe||fffd|p
    
    Dim startTime As Long
    Dim UseTime As Long
    
    Dim blnOk   As Boolean                                              '2014/01/16
    Dim i   As Long
    
    replyWebDailog = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||752||fffd|
    mdlFindClassFull = "Internet Explorer_TridentDlgFrame"
    mdlFindTitlePart = "Web |fffd|y|fffd|[|fffd|W |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O"                          '2013/06/25IE6|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||752||fffd||389||fffd|
    
    DoEvents
    Sleep 100
    
    'web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|iCUSTOM|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd|[|fffd|j|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
    UseTime = 0
    startTime = GetTickCount
    Do
        '2013/06/25|fffd||1c9||fffd|
        '|fffd||fffd||fffd||fffd|IE6|fffd||302||741|BIFRAME|fffd||fffd|src|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
        '|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||242||343|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd||155||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd||fffd||702||702||fffd||102||fffd||fffd||702||fffd||fffd||fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd|\|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?
        For i = 1 To 10
            DoEvents
            Sleep 10
            Call clickIEAlert("|fffd||342||fffd|", "|fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|")
        Next
        
        DoEvents
        Sleep 10
        
        mdlTargethWnd = 0
        mdlWebDialogTitle = ""
        
        '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
        Call EnumWindows(AddressOf getWebDaialog, 0)

        If mdlTargethWnd > 0 Then
            childHWnd = FindWindowEx(mdlTargethWnd, 0&, "Internet Explorer_Server", vbNullString)
            If childHWnd <> 0 Then
                Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                
                DoEvents
                Sleep 10
                
                '2013/06/25 ie6|fffd||30f||a347||fffd|AWindowTitle|fffd||fffd||fffd||fffd||fffd||752||fffd||30f||fffd||502||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||154||fffd||fffd|f
                'Dom|fffd||3ca||fffd|
                Set doc = getHTMLDocument(childHWnd)
                If Not doc Is Nothing Then
                    On Error Resume Next
                    Set docNext = doc.frames.Item(0).document
                    If Err.Number = 0 Then
                        'Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||24c||fffd||fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||702||702||fffd||90a9|
                        If InStr(docNext.Title, findTitlePart) > 0 Then
                            Exit Do
                        End If
                    End If
                    On Error GoTo 0
                End If
            End If
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < DLG_WAITTIME
    If UseTime >= DLG_WAITTIME Then
        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If
    
'->2014/01/16 |fffd||3471||fffd||303||fffd||fffd|[|fffd|v|fffd||fffd||fffd||588||693||fffd||fffd|i|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||702||fffd||24e||fffd||fffd|s|fffd||30f||a347||fffd||fffd||fffd||fffd|j
'    DoEvents
'    Sleep 100
'    '->2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||752||fffd|
'    For Each bElement In docNext.getElementsByTagName("INPUT")
'        If LCase(bElement.Type) = "button" Or LCase(bElement.Type) = "submit" Then
'            If InStr(bElement.value, clickBtnName) > 0 Then
'                '|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|m|fffd|F|fffd|p|fffd||243|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||752||fffd|
'                coc.setElementOnClick = bElement
'                Exit For
'            End If
'        End If
'    Next
'    '<-2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||752||fffd|
'<-2014/01/16 |fffd||3471||fffd||303||fffd||fffd|[|fffd|v|fffd||fffd||fffd||588||693||fffd||fffd|i|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||702||fffd||24e||fffd||fffd|s|fffd||30f||a347||fffd||fffd||fffd||fffd|j
    
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 100
        '2014/01/16 |fffd||a3ca||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||581|i|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||702||fffd||24e||fffd||fffd|s|fffd||30f||a347||fffd||fffd||fffd||fffd|j
        '->2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||752||fffd|
        blnOk = False
        For Each bElement In docNext.getElementsByTagName("INPUT")
            If LCase(bElement.Type) = "button" Or LCase(bElement.Type) = "submit" Then
                If InStr(bElement.Value, clickBtnName) > 0 Then
                    '|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|m|fffd|F|fffd|p|fffd||243|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||752||fffd|
                    Log "|fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||250||752||fffd|F" & clickBtnName
                    coc.setElementOnClick = bElement
                    blnOk = True
                    Exit For
                End If
            End If
        Next
        '<-2014/01/14 |fffd|{|fffd|^|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||752||fffd|
    
        If blnOk = True Then
            DoEvents
            Sleep 10
            
            'Dom|fffd||3ca||fffd||fffd||fffd||fffd||3554||fffd||248||693||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd| 2013/06/25
            '|fffd|w|fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
            Log "|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||fffd||fffd|{|fffd|F" & clickBtnName
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            If clickButton(docNext, clickBtnName) = True Then
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/05/20 |fffd||1c9||fffd| T.K|fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If ClickButtonByValue(docNext, clickBtnName) = True Then
'2016/05/20 |fffd||1c9||fffd| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
                '->2014/01/14 |fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
                If coc.getElementOnClick = False Then
                    Log "|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B"
                    Exit Function
                End If
                '<-2014/01/14 |fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F
                Log "|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd||fffd||fffd|F|fffd||fffd||fffd||fffd|E|fffd|o"
                Exit Do
            End If
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < DLG_WAITTIME
    If UseTime >= DLG_WAITTIME Then
        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If
    
    'waitForBrowse|fffd||34e|g|fffd|p|fffd||142||fffd||fffd||202||fffd|
    DoEvents
    Sleep 100
    
    replyWebDailog = True
    
    endOf "replyWebDailog"
End Function

'|fffd|\|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd|2013/08/13|fffd||1c9||fffd|
' 2013/12/20 |fffd||fffd||fffd||fffd||fffd||24c||fffd||fffd||283||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||1c9||fffd|
Public Function reply|fffd|\|fffd||fffd||fffd||50d||fffd|(ByVal findTitlePart As String, Optional ByVal |fffd|\|fffd||fffd||fffd||50d||fffd| As String = "", Optional ByVal clickBtnName As String = "", _
                    Optional |fffd||fffd||fffd||fffd|MSG As String = "", Optional DLG_WAITTIME As Long = 2000) As Boolean
    startOf "replyWebDailog"
    #If Win64 Then
    Dim childHWnd   As LongPtr
    Dim result  As LongPtr
    #Else
    Dim childHWnd   As Long
    Dim result  As Long
    #End If
    Dim doc As Object
    Dim docNext As Object
    Dim errMsg As String                                                '2013/12/20
    Dim blnClick    As Boolean                                          '2013/12/24
    
    Dim startTime As Long
    Dim UseTime As Long
    
    Dim i   As Long
    
    reply|fffd|\|fffd||fffd||fffd||50d||fffd| = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||752||fffd|
    mdlFindClassFull = "Internet Explorer_TridentDlgFrame"
    mdlFindTitlePart = "Web |fffd|y|fffd|[|fffd|W |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O"                          '2013/06/25IE6|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||752||fffd||389||fffd|
    
    DoEvents
    Sleep 100
    
    'web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|iCUSTOM|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd|[|fffd|j|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
    UseTime = 0
    startTime = GetTickCount
    Do
        '2013/06/25|fffd||1c9||fffd|
        '|fffd||fffd||fffd||fffd|IE6|fffd||302||741|BIFRAME|fffd||fffd|src|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
        '|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||242||343|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd||155||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd||fffd||702||702||fffd||102||fffd||fffd||702||fffd||fffd||fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd|\|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?
        For i = 1 To 10
            DoEvents
            Sleep 10
            Call clickIEAlert("|fffd||342||fffd|", "|fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|")
        Next
        
        DoEvents
        Sleep 10
        
        mdlTargethWnd = 0
        mdlWebDialogTitle = ""
        
        '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
        Call EnumWindows(AddressOf getWebDaialog, 0)

        If mdlTargethWnd > 0 Then
            childHWnd = FindWindowEx(mdlTargethWnd, 0&, "Internet Explorer_Server", vbNullString)
            If childHWnd <> 0 Then
                Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                
                DoEvents
                Sleep 10
                
                '2013/06/25 ie6|fffd||30f||a347||fffd|AWindowTitle|fffd||fffd||fffd||fffd||fffd||752||fffd||30f||fffd||502||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||154||fffd||fffd|f
                'Dom|fffd||3ca||fffd|
                Set doc = getHTMLDocument(childHWnd)
                If Not doc Is Nothing Then
                    On Error Resume Next
                    Set docNext = doc.frames.Item(0).document
                    If Err.Number = 0 Then
                        'Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||24c||fffd||fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||702||702||fffd||90a9|
                        If InStr(docNext.Title, findTitlePart) > 0 Then
                            Exit Do
                        End If
                    End If
                    On Error GoTo 0
                End If
            End If
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < DLG_WAITTIME
    If UseTime >= DLG_WAITTIME Then
        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If
    
    DoEvents
    Sleep 100
    
    '|fffd|\|fffd||fffd||fffd||50d||fffd||fffd||fffd|clickBtnName|fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
    If |fffd|\|fffd||fffd||fffd||50d||fffd| = "" And clickBtnName = "" Then
        reply|fffd|\|fffd||fffd||fffd||50d||fffd| = True
        Exit Function
    End If
    
    '|fffd|\|fffd||fffd||fffd||50d||fffd||fffd||752||fffd|
    docNext.getElementsByName("approvalNum")(0).Value = |fffd|\|fffd||fffd||fffd||50d||fffd|
    
    '|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2013/12/24
    blnClick = False
    
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 10
        
        '|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3c2||742||fffd||fffd||83|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd|E|fffd|o2013/12/24
        If blnClick = True And _
            ElementExists(docNext, clickBtnName) = False Then
            '|fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd|E|fffd|o
            Exit Do
        End If
        
        'Dom|fffd||3ca||fffd||fffd||fffd||fffd||3554||fffd||248||693||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd| 2013/06/25
        '|fffd|w|fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        If clickButton(docNext, clickBtnName) = True Then
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/05/20 |fffd||1c9||fffd| T.K|fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If ClickButtonByValue(docNext, clickBtnName) = True Then
'2016/05/20 |fffd||1c9||fffd| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
            DoEvents
            Sleep 10
            
            blnClick = True                                 '2013/12/24
            
            '2013/12/24|fffd||fffd||fffd|[|fffd|v|fffd||1c9||fffd||fffd|i|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||342||fffd||fffd||30e||fffd||fffd|_|fffd|A|fffd||fffd||fffd||d39e||fffd||fffd|MAX500|fffd|b|fffd|j
            For i = 1 To 5
                DoEvents
                Sleep 100
                
                '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
                '2013/12/20 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd|o|fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||317|L|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
                '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
                '|fffd|@|fffd||fffd||fffd||fffd|F|fffd||fffd||282||fffd||fffd||202||fffd||fffd||103||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||182||fffd||202||fffd|
                '|fffd|@|fffd|G|fffd||fffd||fffd|[|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
                errMsg = ""
                On Error Resume Next
                '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||e3c0||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
                errMsg = getTDValue(docNext, "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F", , 6)
                errMsg = Trim(errMsg)
                On Error GoTo 0
                If errMsg = "" Then
                    '|fffd||fffd||fffd||d39e||fffd|p|fffd||fffd||fffd||fffd||fffd|E|fffd|o2013/12/24
                    '@Exit Do
                Else
                    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
                    |fffd||fffd||fffd||fffd|MSG = errMsg
                    
                    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|c|fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||7c1|A|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd| 2014/01/07|fffd||1c9||fffd|
                    DoEvents
                    Sleep 100
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                    Call clickButton(docNext, "|fffd|I|fffd||fffd|")
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/05/20 |fffd||1c9||fffd| T.K|fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    Call ClickButtonByValue(docNext, "|fffd|I|fffd||fffd|")
'2016/05/20 |fffd||1c9||fffd| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
                    Exit Function
                End If
''            @Exit Do
            Next
        End If
    
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < DLG_WAITTIME
    If UseTime >= DLG_WAITTIME Then
        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If
    
    'waitForBrowse|fffd||34e|g|fffd|p|fffd||142||fffd||fffd||202||fffd|
    DoEvents
    Sleep 100
    
    reply|fffd|\|fffd||fffd||fffd||50d||fffd| = True
    
    endOf "replyWebDailog"
End Function

'IE|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||10b|A|fffd||fffd|
#If Win64 Then
Private Function getWebDaialog(ByVal hWnd As LongPtr, ByVal lParam As LongPtr) As Long
#Else
Private Function getWebDaialog(ByVal hWnd As Long, ByVal lParam As Long) As Long
#End If
    
    getWebDaialog = 1             '|fffd|S|fffd||64fe|
    
    mdlWebDialogTitle = ""
    If getClassNameProc(hWnd) = mdlFindClassFull Then
        mdlWebDialogTitle = GetWindowTextProc(hWnd)
        If InStr(mdlWebDialogTitle, mdlFindTitlePart) > 0 Then
            mdlTargethWnd = hWnd
            getWebDaialog = 0             '|fffd||64fe||fffd|I|fffd||fffd|
            'Debug.Print "TOP hWnd:" & hWnd
        End If
    End If
    
End Function '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||50b|p
#If Win64 Then
Private Function getClassNameProc(hWnd As LongPtr) As String
#Else
Private Function getClassNameProc(hWnd As Long) As String
#End If
    Dim buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
    
    lngRt = getClassName(hWnd, buffer, Len(buffer))
    getClassNameProc = Left(buffer, InStr(buffer, vbNullChar) - 1)
End Function
'|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p
#If Win64 Then
Private Function GetWindowTextProc(hWnd As LongPtr) As String
#Else
Private Function GetWindowTextProc(hWnd As Long) As String
#End If
    Dim buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
    
    lngRt = GetWindowText(hWnd, buffer, Len(buffer))
    GetWindowTextProc = Left(buffer, InStr(buffer, vbNullChar) - 1)
End Function
'<-|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd|p



Attribute VB_Name = "MS1Online"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

'2019/05/27 setParams|fffd||242||103|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||6c2||24b||fffd||30f||a347||fffd||16cce||fffd||fffd||fffd||fffd||fffd||60a4||fffd||255||3cd|X
'2019/05/27 setParams|fffd||242||103|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||33df||fffd||fffd||fffd||242||fffd||fffd||fffd||60a4||fffd||255||3cd|X
'2019/05/29 |fffd||fffd||fffd|[|fffd|U|fffd|[ID|fffd||30e||64fe||fffd||fffd||fffd|@|fffd||fffd||3cd|X(setParams,getOnlineUserID|fffd||fffd||fffd|C|fffd||fffd||fffd|AOnlineUserID,setOnlineUserID|fffd||fffd||1c9||fffd|)

'|fffd||fffd||fffd||fffd||fffd|o|fffd|[
Private OnlineIE As InternetExplorer
Private Description As String
Private StackTrace As String
Private bkagCode As String
Private params As Dictionary
Private OnlineUserID As String

'IE|fffd||fffd|Getter
Public Function getOnlineIE() As InternetExplorer
    Set getOnlineIE = OnlineIE
End Function

'IE|fffd||fffd|Setter
Public Sub setOnlineIE(ie As InternetExplorer)
    Set OnlineIE = ie
End Sub

'Description|fffd||fffd|Getter
Public Function getDescription() As String
    getDescription = Description
End Function

'Description|fffd||fffd|Setter
Public Sub setDescription(Value As String)
    Description = Value
    setStackTrace Value
End Sub

'BKAGCode|fffd||fffd|Getter
Public Function getBKAGCode() As String
    getBKAGCode = bkagCode
End Function

'BKAGCode|fffd||fffd|Setter
Public Sub setBKAGCode(Value As String)
    bkagCode = Value
End Sub

'StackTrace|fffd||fffd|Getter
Public Function getStackTrace() As String
    getStackTrace = StackTrace
End Function

'StackTrace|fffd||fffd|Setter
Public Sub setStackTrace(Value As String)
    StackTrace = Value & vbCrLf & StackTrace
End Sub

'Shanai|fffd||fffd|Getter
Public Function isShanai() As Boolean
    Dim url As String
    On Error Resume Next
    url = OnlineIE.LocationURL
    On Error GoTo 0
    If InStr(url, "mitsuisumitomo-ins.co.jp") > 0 Then
        isShanai = True
    Else
        isShanai = False
    End If
End Function

'App1Frame|fffd||303|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd|Dicutionary|fffd||243|Z|fffd|b|fffd|g
Public Sub setParams()
    
    Dim src As String
    '|fffd||a39f||fffd|I|fffd||fffd|Split|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd|p|fffd||314|z|fffd||fffd|
    Dim tmpArray() As String
    Dim i As Long
    Dim tmpArray2() As String
    
    Set params = New Dictionary
    src = OnlineIE.document.getElementsByName("App1")(0).src
    
    '?|fffd||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    src = Mid(src, InStr(src, "?") + 1)
    '&|fffd||150||602||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=|fffd||fffd|Key|fffd||fffd|Value|fffd||250||602||fffd|Dictionary|fffd||243|Z|fffd|b|fffd|g
    tmpArray = Split(src, "&")
    For i = LBound(tmpArray) To UBound(tmpArray)
        If InStr(tmpArray(i), "=") > 0 Then
            tmpArray2 = Split(tmpArray(i), "=")
            If params.Exists(tmpArray2(0)) Then
                Call params.Remove(tmpArray2(0))
            End If
            Call params.Add(tmpArray2(0), tmpArray2(1))
        End If
    Next i

    On Error Resume Next
    Call params.Add("uid", getScriptValue(OnlineIE.document.frames.Item("App1").document, "top._Input_Uid"))
    Call params.Add("PARAM005", getScriptValue(OnlineIE.document.frames.Item("App1").document, "top._PARAM005"))
    On Error GoTo 0

End Sub

'|fffd|w|fffd||80b5||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||64fe|
Public Function getParam(ByVal key As String) As String
    Dim ret As String
    If params.Exists(key) Then
        ret = params.Item(key)
    End If
    getParam = ret
End Function

'|fffd||413||fffd||fffd|O|fffd||155||fffd||fffd||82d43||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getOnlineUserID() As String
    startOf "getOnlineUserID"

    Dim ret As String
    
    If isMS1PC Then
        '|fffd||413||fffd||fffd|F|fffd||408||fffd||fffd||50d||fffd|
'        ret = egg.getPCUserID  '2016/10/05 |fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||141|A|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[ID|fffd||18e||408||fffd||fffd||50d||fffd||fffd||30f||a3ca||fffd||15a82||fffd||fffd||fffd||fffd||302||155||3cd|X
    Else
        '|fffd||35dd||fffd|X
        ret = OnlineUserID
    End If
    
    Log "OnlineUserID|fffd|F" & ret
    
    getOnlineUserID = ret

    endOf "getOnlineUserID"
End Function

'|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd|[
Public Sub setOnlineUserID()

    Dim htDoc As HTMLDocument
    Dim htElement As IHTMLElement
    Dim reserveParam1 As String
    Dim visibleID As String
    Dim ret As String
    
    reserveParam1 = getParam("reserveParam1")
    If reserveParam1 = "" Then
        'reserveParam1|fffd||fffd||fffd||fffd||fffd||fffd||a347|IceWall|fffd|A|fffd||fffd||fffd||fffd||fffd||a347||fffd|Q|fffd|[|fffd|g|fffd|E|fffd|F|fffd|C|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||182||202||80cd||fffd|O|fffd|C|fffd||fffd|ID|fffd||fffd|uid|fffd||182||202||fffd|
        reserveParam1 = getParam("uid")
    End If

    '|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||309||fffd||282||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set htDoc = OnlineIE.document.frames.Item("App1").document
    For Each htElement In htDoc.getElementsByTagName("SPAN")
        If LCase(htElement.className) = "uid" Then
            visibleID = Trim(htElement.innerText)
            Exit For
        End If
    Next

    ret = reserveParam1 & "/" & getParam("PARAM005") & "/" & visibleID
    
    OnlineUserID = ret

End Sub

'|fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||312|l|fffd||fffd||fffd||64fe|
Private Function getScriptValue(ByRef htDoc As HTMLDocument, ByVal variableCode As String) As String
    startOf "getScriptValue"
    Log "variableCode|fffd|F" & variableCode
    
    Dim retValue As String
    Dim tmpElement As IHTMLElement
    Const TMP_ELEMENT_ID = "oneClick_tmp_value"
    
    '|fffd|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||90bd||fffd||7c2||303|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||c42c|
    Set tmpElement = htDoc.createElement("DIV")
    tmpElement.Id = TMP_ELEMENT_ID
    Call htDoc.appendChild(tmpElement)
    'javascript|fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||103|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
    Call htDoc.parentWindow.execScript("document.getElementById(""" & TMP_ELEMENT_ID & """).value = " & variableCode & ";")
    '|fffd|l|fffd||fffd||fffd||64fe|
    If Not IsNull(htDoc.getElementById(TMP_ELEMENT_ID).Value) Then
        retValue = htDoc.getElementById(TMP_ELEMENT_ID).Value
        Log "retValue|fffd|F" & retValue
    Else
        Log "null"
    End If
    '|fffd|s|fffd|v|fffd||242||202||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||d3dc|
    Call htDoc.RemoveChild(tmpElement)
    
    getScriptValue = retValue
    
    endOf "getScriptValue"
End Function
Attribute VB_Name = "MS1OnlineFactory"
' ****************************************************************************
' *
' * MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||30b|N|fffd||fffd||fffd||202||1c2||fffd||fffd|s|fffd||fffd||fffd|@|fffd|\|fffd|Q
' *
' ****************************************************************************
'2013/06/05 Window8+IE10|fffd||389||fffd| |fffd||fffd|frames( |fffd||fffd| frames.item(
'2013/06/10 Window8+IE10|fffd||389||fffd| |fffd||fffd|Script.ha_submit ("9900") |fffd||fffd| parentWindow.execScript "ha_submit('9900')"
'2014/06/24 getAGCode|fffd||308||fffd||fffd||fffd||fffd||153|n|fffd||fffd||fffd||a0bd||fffd||196||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd|getAuthorizedMS1Online|fffd||243|Z|fffd|b|fffd|g |fffd||fffd|getAuthorizedMS1Online |fffd||fffd| getAuthorizedMS1Online(code:=code)
'2014/06/24 goToFreeScreen|fffd||242||fffd||fffd||fffd||fffd||fffd|pol|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||6c2||242||351||5576||fffd||fffd||fffd||fffd||fffd|p|fffd||3ca||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|pol |fffd||fffd| StrConv(pol, vbNarrow + vbUpperCase)
'2014/09/01 getMS1Online|fffd||242||fffd||fffd||fffd||fffd||109||fffd||282||303||fffd||fffd|T|fffd|C|fffd|Y|fffd||fffd||fffd||94|\|fffd||242||fffd||fffd||fffd| |fffd||fffd|.resizable = False |fffd||fffd| .resizable = True
'2015/12/15 getMS1Online|fffd||242||111||fffd||fffd||742||fffd||fffd||fffd||fffd||282||30f||a347||fffd||355||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd|AgetAuthorizedMS1Online|fffd||fffd|p|fffd|~|fffd|B
'2015/12/15 getMS1Online|fffd||242||111||fffd||fffd||742||fffd||fffd||fffd||fffd||282||30f||a347||fffd||fffd|APP1|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|src|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||182||fffd||fffd||103|Z|fffd|b|fffd|g|fffd|B
'2016/12/24 |fffd||fffd||fffd||303||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|clickAnchor|fffd||fffd||fffd||fffd|egg|fffd||242||fffd||fffd||fffd|clickAnchor|fffd||255||3cd|X
'2018/05/17 getRunningMS1URL|fffd||242||fffd||fffd||fffd||fffd||10e||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||fffd||fffd|O|fffd||24f|o|fffd||342||fffd||fffd||fffd||60a4||fffd||255||3cd|X
'2018/05/17 getRegisteredMS1URL|fffd||242||fffd||fffd||fffd||fffd||10e||64fe||fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||fffd||fffd|O|fffd||24f|o|fffd||342||fffd||fffd||fffd||60a4||fffd||255||3cd|X
'2018/06/06 |fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|V|fffd||389||fffd||fffd||302||fffd||fffd||7cb||fffd||fffd||8b||fffd||fffd|pURL|fffd||301|uold|fffd|v|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||110|V|fffd||8b||fffd||fffd|p(|fffd||fffd||fffd|sURL)|fffd||253||1c2||751||582||fffd||fffd||fffd||60a4||fffd||255||3cd|X(|fffd|uold/|fffd|v|fffd||fffd||fffd|u/|fffd|v)
'2019/06/10 |fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|V|fffd||389||fffd||fffd||302||fffd||fffd||fffd|GetMS1Online,getRunningMS1URL,SetAGCode|fffd||30f|C|fffd||fffd||fffd|AhasMS1OnlineErr,getMS1OnlineErrList|fffd||312||1c9||fffd|
'2019/07/02 GetMS1Online|fffd||30e||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd||fffd||303|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|Script|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||141|AClickButtonByValue|fffd||255||3cd|X

Option Explicit
Option Private Module

'|fffd||8414|
Private Const MS1OL_TITLE As String = "|fffd|O|fffd||fffd|Z|fffd|F|fffd|C|fffd||fffd|@MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd|"
Private Const MS1OL_TITLE2 As String = "|fffd|O|fffd||fffd|Z|fffd|F|fffd|C|fffd||fffd|"
Private Const MS1OL_TITLE_PATTERN As String = "MS1 *"
Private Const MS1_INTRA_URL As String = "http://www.ol.ms.ms-ad-ins.com/jsp/hubBypass.jsp"
Public Const VAL_DELIMITER As String = vbTab

Public Const DESC_URL_NOT_FOUND As String = "MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||fffd||fffd||752||fffd||142||fffd|"
Public Const DESC_WINDOW_CLOSED As String = "MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
Public Const DESC_SUCCEEDED As String = "MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||30e||64fe||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

Public Type Ms1OnlineErr
    Level           As String
    Summary         As String
    Num             As String
    Detail          As String
    RelationScreen  As String

End Type


'|fffd||fffd||fffd|Z|fffd||fffd||282||fffd||fffd||fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function GetAGCode(Optional ByVal code As String = "6.2", Optional ByVal closeWindow As Boolean = False) As String
    startOf "getAGCode"
    
    On Error Resume Next
    Dim ms1ol As MS1Online
    '|fffd||fffd||fffd|Z|fffd||fffd||282||fffd||fffd||fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe|
    Set ms1ol = GetMS1Online(code:=code)
    '|fffd||fffd||282||fffd||82||fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||349||fffd||282||fffd||82||fffd||fffd||fffd|
    If closeWindow Then ms1ol.getOnlineIE.Quit
    '|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||50b|p
    GetAGCode = ms1ol.getBKAGCode
    On Error GoTo 0
    
    endOf "getAGCode"
End Function

'|fffd||196||fffd||fffd|R|fffd|[|fffd|h|fffd|w|fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||282||fffd|IE|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe|(TODO:|fffd||117||fffd||fffd|p|fffd||94|\|fffd||fffd|IE|fffd||fffd||fffd||c2bc2||fffd||fffd||fffd|Create|fffd||fffd||fffd||fffd||fffd|h|fffd||fffd||582||fffd|)
Public Function GetMS1Online(Optional ByVal code As String, Optional ByVal pol As String, Optional ByRef activeIE As InternetExplorer) As MS1Online
    startOf "GetMS1Online"
    
    Dim ms1 As New MS1Online
    Dim ie As InternetExplorer
    Dim InStrKeywordPos As Long
    Dim OnlineURL As String
    Dim BaseURL As String
    Dim ParamPos As Integer
    Dim App1HTML As String
    Dim RadioButtons As Object
    Dim SumiseiRadio As HTMLInputElement

    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||64fe|
    OnlineURL = Trim(getRunningMS1URL)
    '|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||353|o|fffd|^|fffd||3c2||fffd|URL|fffd||fffd||fffd||64fe|
    If OnlineURL = "" Then OnlineURL = Trim(getRegisteredMS1URL)
    '|fffd||fffd||fffd||fffd||142||fffd|URL|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||34b|N|fffd||fffd||fffd||fffd||24d||10e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||70a4|
    If OnlineURL = "" Then
        ms1.setDescription DESC_URL_NOT_FOUND
        Set GetMS1Online = ms1
        ExitOf "GetMS1Online", DESC_URL_NOT_FOUND
        Exit Function
    End If

    'URL|fffd||48f|W
    If Trim(code) = "" Then code = "1.1"
    'URL|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|J|fffd|n|fffd||292|u
    ParamPos = InStr(OnlineURL, "?")
    If ParamPos > 0 Then OnlineURL = Left(OnlineURL, ParamPos - 1)
    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|o|fffd|^|fffd|p|fffd||fffd|URL|fffd||fffd||6ce||fffd|
    BaseURL = OnlineURL
    '|fffd||196||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|Z|fffd|b|fffd|g
    OnlineURL = OnlineURL & "?CODE=" & code
    '|fffd||60c||fffd||fffd||50d||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||38f||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    If pol <> "" Then OnlineURL = OnlineURL & "&SHOUKEN=" & pol

    'IE|fffd|N|fffd||fffd|
    If activeIE Is Nothing Or TypeName(activeIE) = "Object" Then
        Set ie = insteadCreateIE(OnlineURL)                                     '2013/06/05-|fffd||1c9||fffd| |fffd||6cc||c0c2||fffd|[|fffd|h|fffd||389||fffd|(y.chiba)
        With ie
            .Top = 0
            .Left = 0
            .resizable = True
            .Toolbar = False
            .StatusBar = False
            .Visible = True
        End With
    Else
        '|fffd||fffd||fffd||fffd|IE|fffd||fffd||fffd|g|fffd||fffd||fffd||702||d0b7||fffd||202||fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
        Set ie = activeIE
    End If
    ie.Navigate2 OnlineURL
    
    Log "WFB_START:getMS1Online"
    waitForBrowse ie
    Log "WFB_END:getMS1Online"

    'App1|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|o|fffd||a0b7||fffd||fffd||702||151||482||fffd||fffd||c2bc2||fffd|i|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||295|\|fffd||fffd||fffd||30d||6c1|A|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|n|fffd||7c2||fffd|j
    Do
        '|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||24a||702||702||a0b8||fffd|A|fffd|\|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||282||24a||702||702||fffd||9576||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd|
        '|fffd||fffd||fffd||fffd||fffd||fffd|-2147??????|fffd|G|fffd||fffd||fffd|[|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||282||60a4||fffd|Aframes("App1")|fffd||202||1c2||30e|w|fffd||fffd||355|s|fffd||fffd|
        On Error Resume Next
        '|fffd||fffd||fffd||fffd||fffd||fffd|App1|fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||fffd||fffd||70cd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||142||342||202||fffd||fffd||194||fffd||fffd|f
        InStrKeywordPos = InStr(ie.document.body.innerHTML, "App1")
        Log "|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd|F" & Err.Number
        Log "App1|fffd||308||292|u|fffd|F" & InStrKeywordPos

        '|fffd|G|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|0|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||a0bd||fffd||194||fffd||fffd|f|fffd||fffd||fffd||103||fffd||fffd|[|fffd|v|fffd|E|fffd|o
        If Err.Number < 0 Then
            Log "|fffd|I|fffd|[|fffd|g|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||143||fffd||fffd|[|fffd|v|fffd||fffd|E|fffd|o|fffd||fffd||fffd||702||fffd|"
            ms1.setDescription DESC_WINDOW_CLOSED
            Exit Do
        End If
        '|fffd|G|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|
        On Error GoTo 0
        '|fffd||fffd||fffd||fffd||fffd||38f||6d5||fffd||fffd||fffd||fffd||42a8c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||482||fffd||fffd||c2bc2||fffd||fffd||102||fffd||fffd||70cb||fffd|[|fffd|v|fffd||fffd|E|fffd|o
        If InStrKeywordPos > 0 Then
            Log "WFB_START:getMS1Online_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd|"
            waitForBrowse ie
            Log "WFB_END:getMS1Online_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd|"
            Log "|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd|uApp1|fffd|v|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||302||143||fffd||fffd|[|fffd|v|fffd||fffd|E|fffd|o|fffd||fffd||fffd||702||fffd|"
            ms1.setDescription DESC_SUCCEEDED
            ms1.setOnlineIE ie
            'App1|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||70cd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            Call ms1.setParams
            '|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||64fe|
            Call SetAGCode(ms1, code)
            '|fffd||fffd||fffd|[|fffd|U|fffd|[ID|fffd||fffd||fffd||64fe|
            Call ms1.setOnlineUserID
            
            '|fffd||691||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||182||fffd||fffd||103||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||253|o|fffd|^
            registerMS1URL BaseURL
            Exit Do
        End If
        'CPU|fffd||242||20b3||fffd||fffd||fffd||fffd|100ms|fffd||50a|u|fffd||14e||fffd||fffd||432c1|[|fffd|v|fffd||fffd||fffd|s
        DoEvents
        Sleep 100
    Loop
    '|fffd|X|fffd|~|fffd|Z|fffd|C|fffd|E|fffd|O|fffd||fffd||fffd||389||fffd||fffd|F|fffd||fffd||fffd||fffd||60c||fffd||fffd||50d||fffd||fffd||fffd|2|fffd||fffd||fffd||308||a5d7||fffd||fffd||282||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||a0aa||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd|2|fffd||516||682||fffd|I|fffd||fffd|
    '|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||282||fffd|HTML|fffd||fffd||fffd||64fe|
    App1HTML = ie.document.frames.Item("App1").document.body.innerHTML
    '|fffd|u|fffd||43e||fffd||fffd||fffd||1d5||fffd||fffd||189||fffd|v|fffd||702||fffd||fffd||341|u|fffd|O|fffd||fffd||fffd||fffd||1d5||fffd||fffd||189||fffd|v|fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||fffd||fffd||fffd|u|fffd|Q|fffd|v|fffd||303||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||101|u|fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd|
    If InStr(App1HTML, "|fffd||43e||fffd||fffd||fffd||1d5||fffd||fffd||189||fffd|") > 0 Or InStr(App1HTML, "|fffd|O|fffd||fffd||fffd||fffd||1d5||fffd||fffd||189||fffd|") > 0 Then
        Log "|fffd|X|fffd|~|fffd|Z|fffd|C|fffd|E|fffd|O|fffd||fffd||fffd||68a||1cc|_|fffd||fffd||302||fffd||fffd||7c1|A|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||fffd|Value=1|fffd||fffd|T|fffd||fffd||fffd||111|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
        '|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||64fe|
        Set RadioButtons = ie.document.frames.Item("App1").document.getElementsByName("NO")
        For Each SumiseiRadio In RadioButtons
            If SumiseiRadio.Value = "1" Then
                Log "|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd|"
                SumiseiRadio.Click
                SumiseiRadio.Checked = True
                Exit For
            End If
            DoEvents
        Next
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||102||202||fffd||fffd||a347||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||24b|C|fffd||c2||fffd||fffd||60a4||fffd||fffd||fffd|s|fffd||342||fffd||fffd||fffd|
        Log "|fffd||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd||fffd||242||fffd||93c8||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd|"
        Call ClickButtonByValue(ie.document.frames.Item("Btn").document, "|fffd||fffd||fffd|@|fffd|s")
        Log "WFB_START:getMS1Online_|fffd|X|fffd|~|fffd|Z|fffd|C|fffd|E|fffd|O|fffd||fffd||fffd||fffd||fffd|s|fffd||482||fffd|"
        waitForBrowse ie
        Log "WFB_END:getMS1Online_|fffd|X|fffd|~|fffd|Z|fffd|C|fffd|E|fffd|O|fffd||fffd||fffd||fffd||fffd|s|fffd||482||fffd|"
    Else
        Log "|fffd|X|fffd|~|fffd|Z|fffd|C|fffd|E|fffd|O|fffd||fffd||fffd||68a||1c2||142||342||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If

    Set GetMS1Online = ms1
    
    endOf "GetMS1Online"
End Function

'|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
Private Sub SetAGCode(ByRef ms1ol As MS1Online, ByVal code As String)
    startOf "SetAGCode"
    
    Dim ms1 As InternetExplorer
    Dim bkCode As String
    Dim agCode As String
    
    Set ms1 = ms1ol.getOnlineIE

    '|fffd||fffd||fffd|Z|fffd||fffd||282||303|R|fffd|[|fffd|h|fffd||242||fffd||fffd||64fe||fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||3c2||fffd||fffd||fffd|
    Select Case code
        '|fffd||fffd||fffd||fffd||fffd||fffd|
        Case "6.2"
            bkCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("H6201_DAZ0010")(0).Value)
            agCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("H6201_DAZ0011")(0).Value)
        '|fffd||38d||fffd|
        Case "6.3"
            bkCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("h6301_a_daz0010")(0).Value)
            agCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("h6301_a_daz0011")(0).Value)
        '|fffd||fffd||fffd|Q|fffd|V|fffd||fffd|
        Case "6.71"
            bkCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("daz0010")(0).Value)
            agCode = Trim(ms1.document.frames.Item("App1").document.getElementsByName("daz0011")(0).Value)
        '|fffd||fffd||fffd||fffd||20a|O
        Case Else
            Log "|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||64fe||fffd||38f||6ca|O|fffd||142||fffd|"
    End Select

    '|fffd||fffd||282||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h
    Call ms1ol.setBKAGCode(bkCode & agCode)
    
    endOf "SetAGCode"
End Sub
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'|fffd|t|fffd||fffd||fffd|[|fffd||fffd||282||591|J|fffd||681|i|fffd|n|fffd||fffd||fffd||fffd||fffd|IE|fffd||343|t|fffd||fffd||fffd|[|fffd||fffd||282||142||202||fffd||fffd||fffd||fffd||182||fffd||fffd|O|fffd||fffd|j
Public Sub goToFreeScreen(ie As InternetExplorer, pol As String)
    startOf "goToFreeScreen"
    
    Call clickAnchor(ie.document.frames.Item("App1").document, StrConv(pol, vbNarrow + vbUpperCase))
    waitForBrowse ie

    endOf "goToFreeScreen"
End Sub

'|fffd|t|fffd||fffd||fffd|[|fffd||fffd||281||fffd||fffd|z|fffd||fffd||3ca||fffd|
Public Function getFreeScreenArray(ie As InternetExplorer) As String()
    startOf "getFreeScreenArray"
    
    Dim tds As Object
    Dim i As Long
    Dim j As Long
    Dim k As Long
    Dim TDClass As String
    Dim NextTDClass As String
    Dim TDItemText As String
    Dim TDCharText As String
    Dim temp As String
    Dim ret() As String
    Dim hasNext As Boolean
    
    Dim tbodys As Object
    Dim trs As Object
    Dim tableCnt As Long
    Dim trCellCnt As Long
    
    Set tbodys = ie.document.frames.Item("App1").document.getElementsByTagName("TBODY")
    j = 0

    Log "|fffd||64fe||fffd||38f||6c2||fffd|body|fffd|S|fffd||301|F" & vbCrLf & ie.document.frames.Item("App1").document.body.innerHTML

    '|fffd||14f||fffd||fffd||fffd|TBODY|fffd||242||351|S|fffd||302||fffd||fffd||702||702||fffd||fffd||302||141|A2|fffd||96||682||fffd|TBODY|fffd||fffd||fffd||fffd|J|fffd|n
    For tableCnt = 1 To tbodys.Length - 1
        
        'TR|fffd||fffd|Length|fffd||fffd||fffd||fffd|1|fffd|s|fffd||317|v|fffd|f|fffd||fffd||fffd||fffd||fffd||64fe|
        trCellCnt = 0
        Set trs = tbodys(tableCnt).getElementsByTagName("TR")

        If trs.Length > 0 Then
            trCellCnt = trs(0).Cells.Length
            
            Set tds = tbodys(tableCnt).getElementsByTagName("TD")
               
            For i = 0 To tds.Length - 1
                'TD|fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
                On Error Resume Next
                TDClass = tds(i).className
                NextTDClass = tds(i + 1).className
                On Error GoTo 0
                '|fffd||50d||fffd||fffd||82||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||30f||a347|
                If TDClass = "Item" And NextTDClass = "Item" Then
                    '|fffd||fffd||fffd||696||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||302||74f||fffd||fffd||fffd|
                    If Trim(tds(i).innerText) <> "" Then
                        ReDim Preserve ret(j)
                        ret(j) = Trim(tds(i).innerText) & VAL_DELIMITER & Trim(tds(i + 1).innerText) & VAL_DELIMITER & Trim(tds(i + 2).innerText)
                        Log "|fffd||fffd||fffd||696||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7ce||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|F" & ret(j)
                        k = 1
                        '|fffd||fffd||fffd||fffd||fffd|s|fffd||253|n|fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|}|fffd|[|fffd|W
                        Do
                            '|fffd||fffd||fffd||30d|s|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe|
                            TDItemText = ""
                            TDCharText = ""
                            On Error Resume Next
                            TDItemText = Trim(tds(i + k * trCellCnt).innerText)
                            TDCharText = Trim(tds(i + k * trCellCnt + 2).innerText)
                            On Error GoTo 0
                            '|fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||30d||fffd||fffd||696||fffd||fffd||fffd||fffd||202||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||356||fffd||fffd||fffd||fffd||252|l|fffd||fffd||1c9||fffd|
                            If TDItemText = "" And TDCharText <> "" Then
                                ret(j) = ret(j) & TDCharText
                                Log TDCharText & "|fffd||fffd||1c9||fffd||fffd||fffd||fffd||702||fffd|"
                                k = k + 1
                            '|fffd||fffd|L|fffd||253||fffd||fffd||102||342||702||fffd||202||fffd||fffd||a347||fffd||343||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
                            Else
                                Exit Do
                            End If
                        Loop
                        j = j + 1
                    End If
                '|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
                ElseIf tds(i).className = "ComItem" Then
                    ReDim Preserve ret(j)
                    ret(j) = Trim(tds(i).innerText) & VAL_DELIMITER & VAL_DELIMITER & Trim(tds(i + 1).innerText)
                    Log "|fffd||fffd||fffd||696||fffd||fffd||302||202||fffd||fffd||64fe||fffd||38f||6cd||fffd||fffd||682||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|F" & ret(j)
                    j = j + 1
                End If
            Next
        End If
    Next
    getFreeScreenArray = ret

    endOf "getFreeScreenArray"
End Function


'|fffd|N|fffd||fffd||fffd||3c2||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRunningMS1URL() As String
    startOf "getRunningMS1URL"
    
    Dim ret As String
    Dim shs As Object
    Dim sh As Object
    Dim winname As String
    Dim docTitle As String
    Dim keywordPos As Long
    'ShellWindows|fffd||fffd||fffd||64fe|
    Set shs = CreateObject("Shell.Application")

    For Each sh In shs.Windows
        'ShellWindow|fffd||303|p|fffd|X|fffd||fffd||fffd||64fe|
        On Error Resume Next
        winname = ""
        winname = sh.FullName
        On Error GoTo 0
        'IE|fffd||30f||a347|
        If LCase(Right$(winname, 12)) = "iexplore.exe" Then
            '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||64fe|
            On Error Resume Next
            docTitle = ""
            docTitle = sh.document.Title
            On Error GoTo 0
            Log "Title=" & docTitle
            '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||194||fffd||fffd||fffd|
            If InStr(docTitle, MS1OL_TITLE) > 0 Then    '|fffd||fffd||fffd|j|fffd|e|fffd|B|fffd|O
                ret = sh.LocationURL
                Exit For
            ElseIf docTitle = MS1OL_TITLE2 Then         '|fffd||fffd||fffd|j|fffd|e|fffd|B|fffd||fffd|
                ret = sh.LocationURL
                Exit For
            ElseIf docTitle Like MS1OL_TITLE_PATTERN Then   '|fffd||fffd||fffd|V|fffd||fffd|
                keywordPos = 0
                On Error Resume Next
                '|fffd||fffd||fffd||fffd||fffd||fffd|App1|fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||194||fffd||fffd|f
                keywordPos = InStr(sh.document.body.innerHTML, "App1")
                On Error GoTo 0
                Log "App1|fffd||308||292|u|fffd|F" & keywordPos
                If keywordPos > 0 Then
                    ret = sh.LocationURL
                    Exit For
                End If
            End If
        End If
    Next

    Log "ret(|fffd||1d1||591|O)=" & ret
    '|fffd|uhubtop.jsp|fffd|v|fffd||fffd||fffd|uhubBypass.jsp|fffd|v|fffd||253||1c2||751||582||fffd|
    ret = Replace(ret, "hubtop.jsp", "hubBypass.jsp")

    '|fffd|uolold/|fffd|v|fffd||fffd||fffd|uol/|fffd|v|fffd||241|A|fffd|ums-ins001old/|fffd|v|fffd||fffd||fffd|ums-ins001/|fffd|v|fffd||253||1c2||751||582||fffd|
    ret = Replace(ret, "old/", "/")

    '|fffd|ustandard.jsp|fffd|v|fffd||fffd||fffd|uhubBypass.jsp|fffd|v|fffd||253||1c2||751||582||fffd|
    ret = Replace(ret, "standard.jsp", "hubBypass.jsp")
    
    Log "ret=" & ret
    getRunningMS1URL = ret

    '|fffd||413||fffd||fffd||fffd||fffd||602||141||fffd||fffd||30f||fffd||fffd||fffd||fffd||142||30e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||282||60a4||fffd|A|fffd||fffd||50d||14c||fffd||24e||413||fffd||fffd||fffd||fffd||80b7||fffd||fffd|
    If isMS1PC Then
        getRunningMS1URL = MS1_INTRA_URL
    End If

    endOf "getRunningMS1URL"
End Function

'|fffd|o|fffd|^|fffd||3c2||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRegisteredMS1URL() As String
    startOf "getRegisteredMS1URL"

    Dim ret As String
    ret = GetSetting("OneClickTool", "Common\MS1Online", "URL", "")
    
    Log "ret(|fffd||1d1||591|O)=" & ret
    '|fffd|uolold/|fffd|v|fffd||fffd||fffd|uol/|fffd|v|fffd||241|A|fffd|ums-ins001old/|fffd|v|fffd||fffd||fffd|ums-ins001/|fffd|v|fffd||253||1c2||751||582||fffd|
    ret = Replace(ret, "old/", "/")

    Log "ret=" & ret
    getRegisteredMS1URL = ret
    
    If isMS1PC Then
        getRegisteredMS1URL = MS1_INTRA_URL
    End If

    endOf "getRegisteredMS1URL"
End Function

'MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd|
Public Function registerMS1URL(url As String) As String
    startOf "registerMS1URL"
    
    Dim ret As String
    '|fffd||c2||fffd|URL|fffd||fffd||502||fffd||fffd||fffd||fffd||7c2||24e||64fe|
    ret = GetSetting("OneClickTool", "Common\MS1Online", "URL", "")
    'URL|fffd|o|fffd|^
    SaveSetting "OneClickTool", "Common\MS1Online", "URL", url
    registerMS1URL = ret

    endOf "registerMS1URL"
End Function

'MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
Public Function deleteMS1URL() As String
    startOf "deleteMS1URL"
    
    '|fffd||d5d8e||fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||90b1||fffd||182||14d||d3dc||fffd|B|fffd||c2||fffd|URL|fffd||fffd||502||fffd|
    deleteMS1URL = registerMS1URL("")

    endOf "deleteMS1URL"
End Function

'|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||90a9||fffd|m|fffd|F
Public Function hasMS1OnlineErr(htDoc As HTMLDocument) As Boolean
    startOf "hasMS1OnlineErr"
    Dim ret As Boolean
    Dim htDiv As HTMLDivElement
    ret = False
    For Each htDiv In htDoc.getElementsByTagName("DIV")
        If htDiv.className = "errlistIndex" Then
            Log "|fffd||38f||6c2||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd|"
            ret = True
        End If
    Next htDiv
    hasMS1OnlineErr = ret
    endOf "hasMS1OnlineErr"
End Function

'|fffd||fffd||fffd|V|fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getMS1OnlineErrList(htDoc As HTMLDocument) As Ms1OnlineErr()
    startOf "getMS1OnlineErrList"
    Dim retErrlist() As Ms1OnlineErr
    Dim index As Long
    Dim htDiv As HTMLDivElement
    Dim detailDiv As HTMLDivElement
    Dim htInput As HTMLInputElement
    index = 0
    For Each htDiv In htDoc.getElementsByTagName("DIV")
        Log "htDiv.className|fffd|F" & htDiv.className
        If htDiv.className = "errlistIndex" Then
            Log "errlistIndex|fffd||14b4c||fffd|"
            ReDim Preserve retErrlist(index)
            For Each detailDiv In htDiv.getElementsByTagName("DIV")
                Log "detailDiv.className|fffd|F" & detailDiv.className
                Select Case detailDiv.className
                '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|x|fffd||fffd|
                Case "errorLevel"
                    For Each htInput In detailDiv.getElementsByTagName("INPUT")
                        Log "htInput.Name|fffd|F" & htInput.Name
                        If htInput.Name = "errorLevel" Then
                            retErrlist(index).Level = Trim(htInput.Value)
                            Log "retErrlist(index).Level|fffd|F" & retErrlist(index).Level
                        End If
                    Next
                '|fffd|^|fffd|C|fffd|g|fffd||fffd|
                Case "errorSummary decoUnderline", "errorSummary"
                    retErrlist(index).Summary = Trim(detailDiv.innerText)
                    Log "retErrlist(index).Summary|fffd|F" & retErrlist(index).Summary
                '|fffd|G|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h
                Case "errorNum"
                    retErrlist(index).Num = Trim(detailDiv.innerText)
                    Log "retErrlist(index).Num|fffd|F" & retErrlist(index).Num
                '|fffd||68d||fffd|
                Case "errorDetail"
                    retErrlist(index).Detail = Trim(detailDiv.innerText)
                '|fffd||598|A|fffd||fffd||fffd|
                Case "errorRelationScreen"
                    retErrlist(index).RelationScreen = Trim(detailDiv.innerText)
                    Log "retErrlist(index).RelationScreen|fffd|F" & retErrlist(index).RelationScreen
                End Select
            Next detailDiv
            index = index + 1
        End If
    Next htDiv
    getMS1OnlineErrList = retErrlist
    endOf "getMS1OnlineErrList"
End Function

Attribute VB_Name = "MS1Portal"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

'|fffd||fffd||fffd||fffd||fffd|o|fffd|[
Private PortalIE As InternetExplorer
Private Description As String
Private StackTrace As String
Private Shanai As Boolean

'IE|fffd||fffd|Getter
Public Function getPortalIE() As InternetExplorer
    Set getPortalIE = PortalIE
End Function

'IE|fffd||fffd|Setter
Public Sub setPortalIE(ie As InternetExplorer)
    Set PortalIE = ie
End Sub

'Description|fffd||fffd|Getter
Public Function getDescription() As String
    getDescription = Description
End Function

'Description|fffd||fffd|Setter
Public Sub setDescription(Value As String)
    Description = Value
    setStackTrace Value
End Sub

'StackTrace|fffd||fffd|Getter
Public Function getStackTrace() As String
    getStackTrace = StackTrace
End Function

'StackTrace|fffd||fffd|Setter
Public Sub setStackTrace(Value As String)
    StackTrace = Value & vbCrLf & StackTrace
End Sub

'Shanai|fffd||fffd|Getter
Public Function isShanai() As Boolean
    Dim url As String
    On Error Resume Next
    url = PortalIE.LocationURL
    On Error GoTo 0
    If InStr(url, "mitsuisumitomo-ins.co.jp") > 0 Then
        isShanai = True
    Else
        isShanai = False
    End If
End Function
Attribute VB_Name = "MS1PortalFactory"
'/****************************************************************************
' * MS1PortalFactory 0.20 BETA 2012.6.20
' *
' * |fffd||35dd||fffd|XMS1|fffd|i|fffd||fffd||fffd|n|fffd|||fffd|[|fffd|^|fffd||fffd||fffd|j|fffd||30b|N|fffd||fffd||fffd||202||1c2||fffd||fffd|s|fffd||fffd||fffd|@|fffd|\|fffd|Q
' *
' * Using: EGG|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd| version 1.80
' ****************************************************************************/
'2013/06/05 Window8+IE10|fffd||389||fffd| |fffd||fffd|frames( |fffd||fffd| frames.item(
'|fffd|@|fffd||fffd|2013/11/15 openMS1PortalContents|fffd||310|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd||fffd||fffd||fffd||255||3cd|X|fffd|R|fffd||a0aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf|C|fffd||fffd|
Option Explicit

'|fffd||8414|
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd||fffd|@|fffd||fffd|c
Private Const MS1PTL_TITLE As String = "MS1"
Private Const MS1PTL_TITLE2 As String = "|fffd||35dd||fffd|X|fffd|@|fffd|l|fffd|r|fffd|P"
Private Const MS1PTL_TITLE3 As String = "|fffd|O|fffd||fffd|Z|fffd|F|fffd|C|fffd||fffd|@|fffd||35dd||fffd|XMS1"
'Private Const MS1_INTRA_URL As String = "http://ww.agms1n.mitsuisumitomo-ins.co.jp/webapp/wds/index2.htm"
Private Const MS1_INTRA_URL As String = "http://www11.ag-portal.ms.ms-ad-ins.com/AGPortal/patternSelect?dispPatternCode=2&dispMode=2"
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd||fffd|@|fffd||fffd|c

Public Const DESC_PTL_URL_NOT_FOUND As String = "|fffd||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||fffd||fffd||752||fffd||142||fffd|"
Public Const DESC_PTL_WINDOW_CLOSED As String = "|fffd||35dd||fffd|XMS1|fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
Public Const DESC_PTL_SUCCEEDED As String = "|fffd||35dd||fffd|XMS1|fffd||30e||64fe||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

'|fffd||35dd||fffd|XMS1|fffd||fffd||282||fffd|IE|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe|(TODO:|fffd||117||fffd||fffd|p|fffd||94|\|fffd||fffd|IE|fffd||fffd||fffd||c2bc2||fffd||fffd||fffd|Create|fffd||fffd||fffd||fffd||fffd|h|fffd||fffd||582||fffd|)
Public Function getMS1Portal(Optional activeIE As InternetExplorer) As MS1Portal
    startOf "getMS1Portal"
    
    Dim ms1 As New MS1Portal
    Dim ie As InternetExplorer
    Dim docTitle As String
    Dim docTitle2 As String
    Dim PortalURL As String
    Dim BaseURL As String
    Dim ParamPos As Integer

    '|fffd|N|fffd||fffd||fffd||fffd||fffd||311||35dd||fffd|XMS1|fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||64fe|
    PortalURL = Trim(getRunningMS1PortalURL)
    '|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||353|o|fffd|^|fffd||3c2||fffd|URL|fffd||fffd||fffd||64fe|
    If PortalURL = "" Then PortalURL = Trim(getRegisteredMS1PortalURL)
    '|fffd||fffd||fffd||fffd||142||fffd|URL|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||34b|N|fffd||fffd||fffd||fffd||24d||10e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||70a4|
    If PortalURL = "" Then
        ms1.setDescription DESC_PTL_URL_NOT_FOUND
        Set getMS1Portal = ms1
        Exit Function
    End If

    'URL|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|J|fffd|n|fffd||292|u
    ParamPos = InStr(PortalURL, "?")
    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|o|fffd|^|fffd|p|fffd||fffd|URL|fffd||fffd||6ce||fffd|
    If ParamPos > 0 Then
        BaseURL = Left(PortalURL, ParamPos - 1)
    Else
        BaseURL = PortalURL
    End If

    'IE|fffd|N|fffd||fffd|
    If activeIE Is Nothing Then
        'Set ie = CreateObject("InternetExplorer.Application")                  '2013/06/05-|fffd||d3dc| |fffd||6cc||c0c2||fffd|[|fffd|h|fffd||389||fffd|(y.chiba)
        Set ie = insteadCreateIE(PortalURL)                                     '2013/06/05-|fffd||1c9||fffd| |fffd||6cc||c0c2||fffd|[|fffd|h|fffd||389||fffd|(y.chiba)
        With ie
            .Top = 0
            .Left = 0
            .Visible = True
        End With
    Else
        '|fffd||fffd||fffd||fffd|IE|fffd||fffd||fffd|g|fffd||fffd||fffd||702||d0b7||fffd||202||fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
        Set ie = activeIE
    End If
    ie.Navigate2 PortalURL
    
    Log "WFB_START:getMS1Portal"
    'waitForBrowse ie                                                           '2013/06/05-|fffd||d3dc| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    waitForBrowseRetry ie                                                       '2013/06/05-|fffd||1c9||fffd| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    waitForBrowse ie
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    Log "WFB_END:getMS1Portal"


    '|fffd||35dd||fffd|XMS1|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|o|fffd||102||fffd||fffd||fffd||702||151||48b|@
    Do
        On Error Resume Next
        docTitle = ""
        docTitle = Trim(ie.document.Title)
        Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd|F" & docTitle
        '|fffd|G|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|0|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|A|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||a0bd||fffd||194||fffd||fffd|f|fffd||fffd||fffd||103||fffd||fffd|[|fffd|v|fffd|E|fffd|o
        If Err.Number < 0 Then
            Log "|fffd|I|fffd|[|fffd|g|fffd||fffd||fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||143||fffd||fffd|[|fffd|v|fffd||fffd|E|fffd|o|fffd||fffd||fffd||702||fffd|"
            ms1.setDescription DESC_PTL_WINDOW_CLOSED
            Exit Do
        End If
        
        docTitle2 = ""
        docTitle2 = Trim(ie.document.frames.Item(0).document.Title)
        Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd|F" & docTitle2
        On Error GoTo 0
        
        If (docTitle = MS1PTL_TITLE) And (docTitle2 = MS1PTL_TITLE2) Then
            Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||702||fffd|"
            Log "WFB_START:getMS1Portal_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd|"
            'waitForBrowse ie                                                   '2013/06/05-|fffd||d3dc| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            waitForBrowseRetry ie                                               '2013/06/05-|fffd||1c9||fffd| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            waitForBrowse ie
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
            Log "WFB_END:getMS1Portal_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd|"
'            Log "|fffd||35dd||fffd|XMS1|fffd||303||fffd||fffd|S|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||302||143||fffd||fffd|[|fffd|v|fffd||fffd|E|fffd|o|fffd||fffd||fffd||702||fffd|"
            ms1.setDescription DESC_PTL_SUCCEEDED
            ms1.setPortalIE ie
            '|fffd||691||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||182||fffd||fffd||103||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||253|o|fffd|^
            registerMS1PortalURL BaseURL
            Exit Do
        End If
        
        '|fffd|V|fffd||35dd||fffd|X|fffd|l|fffd|r|fffd|P|fffd||389||fffd| 20121126
        If (docTitle = MS1PTL_TITLE3) Then
            Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||702||fffd||fffd|i|fffd|V|fffd|j"
            Log "WFB_START:getMS1Portal_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd||fffd|i|fffd|V|fffd|j"
            'waitForBrowse ie                                                   '2013/06/05-|fffd||d3dc| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            waitForBrowseRetry ie
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            waitForBrowse ie                                               '2013/06/05-|fffd||1c9||fffd| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
            Log "WFB_END:getMS1Portal_|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||482||fffd||fffd|i|fffd|V|fffd|j"
            ms1.setDescription DESC_PTL_SUCCEEDED
            ms1.setPortalIE ie
            '|fffd||691||fffd||fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||182||fffd||fffd||103||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||253|o|fffd|^
            registerMS1PortalURL BaseURL
            Exit Do
        End If

        'CPU|fffd||242||20b3||fffd||fffd||fffd||fffd|100ms|fffd||50a|u|fffd||14e||fffd||fffd||432c1|[|fffd|v|fffd||fffd||fffd|s
        DoEvents
        Sleep 100
    Loop


    '2013/05/29 |fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|-|fffd||1c9||fffd|(y.chiba) --- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim htDoc       As HTMLDocument
    Dim pos         As Long

    pos = 0
    On Error Resume Next
    Set htDoc = ie.document
    pos = InStr(htDoc.body.innerHTML, "|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g")
    On Error GoTo 0

    If pos > 0 Then
        Log "|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||282||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||7c2|n|fffd|j|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Call clickButton(htdoc, "|fffd|n|fffd|j")
'2016/05/20 |fffd||d3dc| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/05/20 |fffd||1c9||fffd| T.K|fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Call ClickButtonByValue(htDoc, "|fffd|n|fffd|j")
'2016/05/20 |fffd||1c9||fffd| T.K |fffd|Vegg|fffd||251||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
        Log "WFB_START:getMS1Portal_|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||282|n|fffd|j|fffd||fffd||fffd||fffd|"
        'waitForBrowse ie                                                       '2013/06/05-|fffd||d3dc| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        waitForBrowseRetry ie                                                   '2013/06/05-|fffd||1c9||fffd| |fffd|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||389||fffd|(y.chiba)
'2015/09/25 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        waitForBrowse ie
'2015/09/25 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Log "WFB_END:getMS1Portal_|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||282|n|fffd|j|fffd||fffd||fffd||fffd|"
        ms1.setPortalIE ie
    End If
    '2013/05/29 |fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|-|fffd||1c9||fffd|(y.chiba) --- |fffd||fffd||fffd||fffd||fffd||702||fffd|


    Set getMS1Portal = ms1
    
    endOf "getMS1Portal"
End Function

'|fffd|N|fffd||fffd||fffd||3c2||751||35dd||fffd|XMS1|fffd||fffd|IE|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRunningMS1PortalIE() As InternetExplorer
    startOf "getRunningMS1PortalIE"

    Dim ret As String
    Dim shs As Object
    Dim sh As Object
    Dim winname As String
    Dim docTitle As String
    Dim docTitle2 As String
    Dim ie As InternetExplorer
    
    'ShellWindows|fffd||fffd||fffd||64fe|
    Set shs = CreateObject("Shell.Application")
    
    For Each sh In shs.Windows
        'ShellWindow|fffd||303|p|fffd|X|fffd||fffd||fffd||64fe|
        On Error Resume Next
        winname = ""
        winname = sh.FullName
        On Error GoTo 0
        'IE|fffd||30f||a347|
        If LCase(Right$(winname, 12)) = "iexplore.exe" Then
            Set ie = sh
            '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||64fe|
            On Error Resume Next
            docTitle = ""
            docTitle = ie.document.Title
            Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd|F" & docTitle
            docTitle2 = ""
            docTitle2 = Trim(ie.document.frames.Item(0).document.Title)
            Log "|fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd|F" & docTitle2
            On Error GoTo 0
            '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|MS1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||35dd||fffd|XMS1|fffd||194||fffd||fffd||fffd|
            If (docTitle = MS1PTL_TITLE) And (docTitle2 = MS1PTL_TITLE2) Then
                Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||141|AgetRunningMS1PortalIE|fffd||14c82||fffd||fffd||702||fffd|"
                Set getRunningMS1PortalIE = ie
                Exit Function
            End If
            '2013/06/05-|fffd||1c9||fffd| |fffd|V|fffd||35dd||fffd|X|fffd|l|fffd|r|fffd|P|fffd||389||fffd|(y.chiba) --- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If (docTitle = MS1PTL_TITLE3) Then
                Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||302||141|AgetRunningMS1PortalIE|fffd||14c82||fffd||fffd||702||fffd||fffd|i|fffd|V|fffd|j"
                Set getRunningMS1PortalIE = ie
                Exit Function
            End If
            '2013/06/05-|fffd||1c9||fffd| |fffd|V|fffd||35dd||fffd|X|fffd|l|fffd|r|fffd|P|fffd||389||fffd|(y.chiba) --- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        End If
    Next

    endOf "getRunningMS1PortalIE"
End Function

'|fffd|N|fffd||fffd||fffd||3c2||751||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRunningMS1PortalURL() As String
    startOf "getRunningMS1PortalURL"
    Dim ie As InternetExplorer
    Dim url As String

    url = ""
    Set ie = getRunningMS1PortalIE
    If Not ie Is Nothing Then
        url = ie.LocationURL
    End If
    Log "|fffd||64fe||fffd||fffd||fffd||fffd|URL|fffd|F" & url

    '|fffd||413||fffd||fffd||fffd||fffd||602||141||fffd||fffd||30f||fffd||fffd||fffd||fffd||142||30e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||282||60a4||fffd|A|fffd||fffd||50d||14c||fffd||24e||413||fffd||fffd||fffd||fffd||80b7||fffd||fffd|
    If isMS1PC Then
         url = MS1_INTRA_URL
    End If
    Log "|fffd||64fe||fffd||fffd||fffd||fffd|URL|fffd|F" & url

    getRunningMS1PortalURL = url

    endOf "getRunningMS1PortalURL"
End Function

'|fffd||35dd||fffd|XMS1|fffd||fffd||fffd||303|R|fffd||fffd||fffd|e|fffd||fffd||fffd|c|fffd||fffd||fffd|J|fffd||fffd|
Public Function openMS1PortalContents(contentsURL As String) As MS1Portal
    startOf "openMS1PortalContents"

    Dim ms1port As MS1Portal
    Dim ms1portIE As InternetExplorer
    Dim ms1portURL As String
    Dim openURL As String

    Set ms1port = getMS1Portal
    If InStr(ms1port.getStackTrace, DESC_PTL_SUCCEEDED) < 1 Then
        Log "|fffd||35dd||fffd|XMS1|fffd||30b|N|fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd|"
        Log ms1port.getStackTrace
        Exit Function
    End If
    
    Set ms1portIE = ms1port.getPortalIE
    '|fffd||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||64fe|
    ms1portURL = ms1portIE.LocationURL
    Log "ms1portURL|fffd|F" & ms1portURL
    '|fffd||35dd||fffd|XMS1|fffd||303|R|fffd||fffd||fffd|e|fffd||fffd||fffd|c|fffd||fffd|URL|fffd||10d90||fffd|
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd|
'    openURL = Left(ms1portURL, InStr(ms1portURL, "/webapp/") - 1) & contentsURL
'    log "openURL|fffd|F" & openURL
'    '|fffd||35dd||fffd|XMS1|fffd||fffd|mainFrame|fffd||255|\|fffd||fffd|
'    On Error GoTo er
'    ms1portIE.document.frames(0).frames("mainFrame").Location.href = openURL
    Dim tmpStr As String
    Dim re As Object
    Dim tmpDomain As String
    Dim htAnchors As IHTMLElementCollection
    Dim htAnchor As IHTMLAnchorElement
    If isMS1PC Then
        openURL = "http://ww.agms1n.mitsuisumitomo-ins.co.jp" & contentsURL
    Else
        Set htAnchors = ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("footerFrame").document.getElementsByTagName("A")
        For Each htAnchor In htAnchors
            If htAnchor.innerText = "|fffd||fffd||fffd|p|fffd|K|fffd||fffd|" Then
                tmpStr = htAnchor.outerHTML
                Exit For
            End If
        Next
        Set re = CreateObject("VBScript.RegExp")
        re.Pattern = "'/.*?/pcm/cont/"
        tmpStr = re.Execute(tmpStr)(0).Value
        tmpDomain = Left(ms1portURL, InStr(InStr(ms1portURL, "://") + 3, ms1portURL, "/") - 1)
        openURL = Replace(tmpDomain & Mid(tmpStr, 2), "/pcm/cont/", contentsURL)
    End If
    Log "openURL|fffd|F" & openURL
    '|fffd||35dd||fffd|XMS1|fffd||fffd|mainFrame|fffd||255|\|fffd||fffd|
    On Error GoTo er
'    ms1portIE.document.frames("menuBaseFrame").frames("menuFrame").frames("contentsDomain").Location.href = openURL
    ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsFrame").outerHTML = Replace(ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsFrame").outerHTML, "DISPLAY: block", "DISPLAY: none")
    ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsDomain").outerHTML = Replace(ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsDomain").outerHTML, "DISPLAY: none", "DISPLAY: block; HEIGHT: 567px")
    ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").frames.Item("contentsDomain").Location.href = openURL
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd|
    Set openMS1PortalContents = ms1port

    endOf "openMS1PortalContents"
    Exit Function

er:
    Log "|fffd|G|fffd||fffd||fffd|[|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||142||30f||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd|"
    Log Err.Number & ":" & Err.Description
    Log "|fffd|G|fffd||fffd||fffd|[|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||142||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

    endOf "openMS1PortalContents"
End Function

'|fffd||35dd||fffd|XMS1|fffd||fffd||fffd||303|R|fffd||fffd||fffd|e|fffd||fffd||fffd|c|fffd||fffd||fffd|J|fffd||fffd|
Public Function openMS1PortalContentsShanai(contentsURL As String) As HTMLDocument
    startOf "openMS1PortalContentsShanai"

    Dim ms1port As MS1Portal
    Dim ms1portIE As InternetExplorer
    Dim ms1portURL As String
    Dim openURL As String

    Set ms1port = getMS1Portal
    If InStr(ms1port.getStackTrace, DESC_PTL_SUCCEEDED) < 1 Then
        Log "|fffd||35dd||fffd|XMS1|fffd||30b|N|fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd|"
        Log ms1port.getStackTrace
        Exit Function
    End If
    
    Set ms1portIE = ms1port.getPortalIE
    '|fffd||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||64fe|
    ms1portURL = ms1portIE.LocationURL
    Log "ms1portURL|fffd|F" & ms1portURL
    '|fffd||35dd||fffd|XMS1|fffd||303|R|fffd||fffd||fffd|e|fffd||fffd||fffd|c|fffd||fffd|URL|fffd||10d90||fffd|
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd|
'    openURL = Left(ms1portURL, InStr(ms1portURL, "/webapp/") - 1) & contentsURL
'    log "openURL|fffd|F" & openURL
'    '|fffd||35dd||fffd|XMS1|fffd||fffd|mainFrame|fffd||255|\|fffd||fffd|
'    On Error GoTo er
'    ms1portIE.document.frames(0).frames("mainFrame").Location.href = openURL
    Dim tmpStr As String
    Dim re As Object
    Dim tmpDomain As String
    Dim htAnchors As IHTMLElementCollection
    Dim htAnchor As IHTMLAnchorElement
    If isMS1PC Then
        openURL = "http://ww.agms1n.mitsuisumitomo-ins.co.jp" & contentsURL
    Else
        Set htAnchors = ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("footerFrame").document.getElementsByTagName("A")
        For Each htAnchor In htAnchors
            If htAnchor.innerText = "|fffd||fffd||fffd|p|fffd|K|fffd||fffd|" Then
                tmpStr = htAnchor.outerHTML
                Exit For
            End If
        Next
        Set re = CreateObject("VBScript.RegExp")
        re.Pattern = "'/.*?/pcm/cont/"
        tmpStr = re.Execute(tmpStr)(0).Value
        tmpDomain = Left(ms1portURL, InStr(InStr(ms1portURL, "://") + 3, ms1portURL, "/") - 1)
        openURL = Replace(tmpDomain & Mid(tmpStr, 2), "/pcm/cont/", contentsURL)
    End If
    Log "openURL|fffd|F" & openURL
    '|fffd||35dd||fffd|XMS1|fffd||fffd|mainFrame|fffd||255|\|fffd||fffd|
    On Error GoTo er
    
    If isMS1PC Then
        
        Dim ie As InternetExplorer
        
        ' |fffd||413||fffd||fffd||fffd||fffd||183|N|fffd||fffd||fffd|X|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||242||202||fffd||fffd||102||fffd||fffd||702||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd||182||141|A
        ' |fffd|V|fffd|KIE |fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||60a4||fffd||251||389||fffd|
        Set ie = insteadCreateIE(openURL)
        ie.Navigate2 openURL
        
        ' |fffd||482||fffd|
        waitForBrowse ie
        
        ie.Visible = True
        
        ' |fffd||7c2||fffd|l|fffd||fffd||752||fffd|
        Set openMS1PortalContentsShanai = ie.document
    Else
        
'        ms1portIE.document.frames("menuBaseFrame").frames("menuFrame").frames("contentsDomain").Location.href = openURL
        ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsFrame").outerHTML = Replace(ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsFrame").outerHTML, "DISPLAY: block", "DISPLAY: none")
        ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsDomain").outerHTML = Replace(ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").document.getElementById("contentsDomain").outerHTML, "DISPLAY: none", "DISPLAY: block; HEIGHT: 567px")
        ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").frames.Item("contentsDomain").Location.href = openURL
        
        ' |fffd||482||fffd|
        waitForBrowse ms1portIE
        
        ' |fffd||7c2||fffd|l|fffd||fffd||752||fffd|
        Set openMS1PortalContentsShanai = ms1portIE.document.frames.Item("menuBaseFrame").frames.Item("menuFrame").frames.Item("contentsDomain").document
    End If
'|fffd||fffd||fffd|V|fffd|||fffd|[|fffd|^|fffd||fffd||fffd||389||fffd|
'    Set openMS1PortalContentsShanai = ms1port

    endOf "openMS1PortalContentsShanai"
    Exit Function

er:
    Log "|fffd|G|fffd||fffd||fffd|[|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||142||30f||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd|"
    Log Err.Number & ":" & Err.Description
    Log "|fffd|G|fffd||fffd||fffd|[|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||142||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"

    endOf "openMS1PortalContentsShanai"
End Function

'|fffd|o|fffd|^|fffd||3c2||751||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getRegisteredMS1PortalURL() As String
    startOf "getRegisteredMS1PortalURL"

    Dim ret As String
    ret = GetSetting("OneClickTool", "Common\MS1Portal", "URL", "")
    getRegisteredMS1PortalURL = ret
    
    If isMS1PC Then
        getRegisteredMS1PortalURL = MS1_INTRA_URL
    End If

    endOf "getRegisteredMS1PortalURL"
End Function

'|fffd||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd|
Public Function registerMS1PortalURL(url As String) As String
    startOf "registerMS1PortalURL"
    
    Dim ret As String
    '|fffd||c2||fffd|URL|fffd||fffd||502||fffd||fffd||fffd||fffd||7c2||24e||64fe|
    ret = GetSetting("OneClickTool", "Common\MS1Portal", "URL", "")
    'URL|fffd|o|fffd|^
    SaveSetting "OneClickTool", "Common\MS1Portal", "URL", url
    registerMS1PortalURL = ret

    endOf "registerMS1PortalURL"
End Function

'|fffd||35dd||fffd|XMS1|fffd||fffd|URL|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
Public Function deleteMS1PortalURL() As String
    startOf "deleteMS1PortalURL"
    
    '|fffd||d5d8e||fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||90b1||fffd||182||14d||d3dc||fffd|B|fffd||c2||fffd|URL|fffd||fffd||502||fffd|
    deleteMS1PortalURL = registerMS1PortalURL("")

    endOf "deleteMS1PortalURL"
End Function
Attribute VB_Name = "Main"
Option Explicit

'|fffd|f|fffd|[|fffd|^|fffd|N|fffd||fffd||fffd|A(|fffd||fffd||fffd||fffd||fffd|I|fffd||24f||fffd||fffd||fffd|(|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|o|fffd||fffd||fffd||202||fffd|)|fffd||a347||fffd||348||fffd||fffd||fffd||fffd||fffd|True|fffd||fffd||fffd||d0bd||fffd||fffd|
Public Sub ClearDataSheet(Optional isForce As Boolean = False)
    startOf "ClearDataSheet"
    If isForce = False Then
        If MsgBox("|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||102||fffd||fffd||1c2||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbOKCancel) <> vbOK Then
            ExitOf "ClearDataSheet", "|fffd|f|fffd|[|fffd|^|fffd|N|fffd||fffd||fffd|A|fffd|@|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|"
            Exit Sub
        End If
    End If
    '|fffd|u|fffd||38f||6c8||a5d7||fffd|v|fffd|V|fffd|[|fffd|g
    Call Util.clearWorksheet(shtList, ROW_shtList.|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s)

    endOf "ClearDataSheet"
End Sub


'|fffd||38f||6c8||a5d7||fffd|V|fffd|[|fffd|g|fffd|\|fffd||fffd|
Public Sub activeShtList()
    startOf "activeShtList"
    shtList.Activate
    endOf "activeShtList"
End Sub


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||752||fffd||3cd|X
Sub chkDebugMode_Click()
    startOf "chkDebugMode_Click"
    Call Logs.setDebugLog
    endOf "chkDebugMode_Click"
End Sub

'|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
Function versionCheck() As Boolean
    startOf "versionCheck"
    'Version|fffd|`|fffd|F|fffd|b|fffd|N
    Dim vs As VersionStatus

    vs = getVersionStatus(AuthorizationURLBase & TOOL_NAME & "/" & TOOL_VERSION & ".html")
    'vs|fffd||312||fffd||fffd|g|fffd||341|AgetVersionStatus|fffd||30d||14c||fffd||243||fffd||fffd|[|fffd|J|fffd||fffd||fffd||fffd||fffd|O|fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd||3c2||fffd|

    If Not vs.IsAvailable Then
        '|fffd||fffd||fffd||fffd|s|fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        If vs.message <> "" Then
            MsgBox vs.message, vbOKOnly + vbCritical
        ElseIf vs.Description <> "" Then
            MsgBox vs.Description, vbOKOnly + vbCritical
        End If
        '********************************
        'NG|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6c2||30f||fffd||fffd||fffd|
        '********************************

        versionCheck = False
    Else
        If vs.message <> "" Then
            Log "|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|w|fffd||80aa||fffd||fffd||fffd||90bd||fffd||7c3||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            MsgBox vs.message, vbOKOnly + vbInformation
        End If

        versionCheck = True
    End If

    endOf "versionCheck"
End Function

'|fffd|u|fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||fffd||fffd||635e||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub getListFromMankiIchiran()

    Dim ret
    Dim targetEmployeeLastRow As Long

    Dim mankiIE As InternetExplorer
    Dim hdoc As HTMLDocument

    Dim bukaCode As String
    Dim agCode As String

'|fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N
    '|fffd||fffd||fffd||6c3|R|fffd|[|fffd|h
    bukaCode = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
    bukaCode = Trim(bukaCode)
    If bukaCode <> "" Then
        If Len(bukaCode) <> 5 Then
            shtInputInfo.Activate
            MsgBox "|fffd||fffd||fffd||6c3|R|fffd|[|fffd|h|fffd||fffd|5|fffd|P|fffd|^|fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            ExitOf "getListFromMankiIchiran", "|fffd||fffd||fffd||6c3|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
            Exit Sub
        Else
            '|fffd|S|fffd|p|fffd||2d4||fffd||fffd|p|fffd||3ca||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2d1||5576||fffd||fffd||fffd||3ca||fffd|
            bukaCode = StrConv(bukaCode, vbUpperCase)
            bukaCode = StrConv(bukaCode, vbNarrow)
            shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value = bukaCode
        End If
    End If
    '|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h
    agCode = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
    agCode = Trim(agCode)
    If agCode <> "" Then
        If Len(agCode) <> 4 Then
            shtInputInfo.Activate
            MsgBox "|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd|4|fffd|P|fffd|^|fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            ExitOf "getListFromMankiIchiran", "|fffd||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
            Exit Sub
        Else
            '|fffd|S|fffd|p|fffd||2d4||fffd||fffd|p|fffd||3ca||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2d1||5576||fffd||fffd||fffd||3ca||fffd|
            agCode = StrConv(agCode, vbUpperCase)
            agCode = StrConv(agCode, vbNarrow)
            shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value = agCode
        End If
    End If

    If Len(bukaCode & agCode) <> 0 And Len(bukaCode & agCode) <> 9 Then
        shtInputInfo.Activate
        MsgBox "|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd|9|fffd|P|fffd|^|fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ExitOf "getListFromMankiIchiran", "|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
        Exit Sub
    End If


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|m|fffd|F
    If shtSetting.Range(CYOUSA_MODE_ADDR).Value = True Then
        Logs.setDebugLog
    End If

    startOf "getListFromMankiIchiran"

    If versionCheck = False Then
        ExitOf "getListFromMankiIchiran", "versionCheck NG"
        Exit Sub
    End If

    '|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|M|fffd|i|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|~|fffd|j
    If sendServerLog("|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||741|@[|fffd|J|fffd|n] |fffd|F" & bukaCode & agCode) = False Then
        ExitOf "getListFromMankiIchiran", "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd|M|fffd||24e||fffd||fffd|s"
        Exit Sub
    End If

'|fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||fffd||fffd|
    '--|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s--
    If |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.findExecute(get|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, True) = False Then
        Log "|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|G|fffd||fffd||fffd|["
        MessageBox 0, |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resErrDescription, "|fffd|G|fffd||fffd||fffd|[", vbInformation + MB_FG_TYPE

        ExitOf "getListFromMankiIchiran", "|fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resErrDescription
        Exit Sub
    End If

    '--|fffd|A|fffd||38f||6cc||fffd||fffd||fffd||fffd||64fe|--
    Dim mnkRes As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim Total As Long
    Dim i As Long

    Total = |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resTotalCount

'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| As Long
    |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| = 0
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||702||fffd|

    '|fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v
    For i = 1 To Total

        '--|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282|P|fffd||fffd||fffd||64fe|--
        If |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.getDataOne(mnkRes) = False Then
            '            MessageBox 0, |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resErrDescription & vbLf & _
            '            "|fffd|@|fffd|v|fffd||fffd||fffd||50d||fffd||fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resReqCount & vbLf & _
            '            "|fffd|@|fffd|y|fffd|[|fffd|W|fffd||50d||fffd||fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resNowPage & " / " & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resTotalPage, _
            '            "|fffd|G|fffd||fffd||fffd|[", vbInformation + MB_FG_TYPE
            Log "getMankiJoho: " & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resErrDescription & "|fffd|@|fffd|v|fffd||fffd||fffd||50d||fffd||fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resReqCount & "|fffd|@|fffd|y|fffd|[|fffd|W|fffd||50d||fffd||fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resNowPage & " / " & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resTotalPage

            ExitOf "getListFromMankiIchiran", "|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s|fffd|F" & |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.resErrDescription
            Exit Sub
        End If

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||28f||fffd||fffd||fffd|
        If mdlTorikomi.torikomiManki(mnkRes) = False Then
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| = |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| + 1
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End If

    Next

'2019/04/05 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    '|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||fffd||282||fffd||82||fffd||fffd||fffd|
'    |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.QuitMdlMnkIE
'2019/04/05 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/04/05 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||fffd||282||fffd||82||fffd||fffd||fffd|
|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.reskokyakuIE.Quit

    '2019/04/05 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    sendServerLog ("|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||741|@[|fffd|I|fffd||fffd|] |fffd|F" & Total - |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| & "|fffd||fffd||fffd|^" & Total & "|fffd||fffd|")
    If |fffd||38f||6ca|O|fffd||fffd||fffd||fffd| = Total Then
        MsgBox "|fffd||fffd||835e||fffd||751||38f||6c2||182||202||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
    Else
        MsgBox "|fffd||635e||fffd||fffd||fffd||fffd|"
    End If
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|C|fffd||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||702||fffd|


    endOf "getListFromMankiIchiran"
End Sub

'|fffd|u|fffd|_|fffd||fffd||189||f0a9||fffd||fffd||635e||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub getListFromKeiyakuSyokai()
    Dim ret
    Dim targetEmployeeLastRow As Long

    Dim syokaiIe As InternetExplorer
    Dim hdoc As HTMLDocument


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|m|fffd|F
    If shtSetting.Range(CYOUSA_MODE_ADDR).Value = True Then
        Logs.setDebugLog
    End If

    startOf "getListFromMankiIchiran"

    If versionCheck = False Then
        ExitOf "getListFromMankiIchiran", "versionCheck NG"
        Exit Sub
    End If


    '|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|M|fffd|i|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|~|fffd|j
    If sendServerLog("|fffd|_|fffd||fffd||189||fffd|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||741|@[|fffd|J|fffd|n]") = False Then
        ExitOf "getListFromMankiIchiran", "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd|M|fffd||24e||fffd||fffd|s"
        Exit Sub
    End If

    '|fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|_|fffd||fffd||189||fffd||fffd||282||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||282||fffd||7c2||702||fffd||fffd||fffd|
    Set syokaiIe = getRunningMS1IE("|fffd|O|fffd||fffd|Z|fffd|F|fffd|C|fffd||fffd|", "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd|")

    If syokaiIe Is Nothing Then
        MsgBox "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd||fffd||282||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ExitOf "main", "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd||fffd||28e||64fe||fffd||fffd||fffd|s"
        Exit Sub
    End If

    Log "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd||fffd||fffd|(|fffd||18e|v|fffd||fffd||fffd||fffd||fffd||281|j|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|"

    '|fffd||14f|I|fffd|f|fffd|[|fffd|^|fffd|s|fffd||64fe|
    Dim lastRow As Long
    lastRow = shtList.Cells.SpecialCells(xlLastCell).row + 1
    lastRow = shtList.Cells(lastRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).End(xlUp).row

    If mdlTorikomi.torikomi(syokaiIe, lastRow + 1) Then

        '|fffd||14f||fffd||fffd||fffd|
        ShowWindowAsync syokaiIe.hWnd, SW_MINIMIZE

        sendServerLog ("|fffd|_|fffd||fffd||189||fffd|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||741|@[|fffd|I|fffd||fffd|]")

        MsgBox "|fffd||635e||fffd||fffd||fffd||fffd|"

    End If

    endOf "getListFromKeiyakuSyokai"
End Sub

'|fffd||fffd||fffd||fffd||341|i|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd||302||741|j|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub createOshiraseFileSimple()
    startOf "createOshiraseFileSimple"


    If versionCheck = False Then
        ExitOf "createOshiraseFileSimple", "versionCheck NG"
        Exit Sub
    End If

    '|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd|N|fffd||fffd|
    openOshiraseFile_simple

    '|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    sendServerLog ("|fffd||fffd||fffd||fffd||341|@|fffd|N|fffd||fffd|")

    endOf "createOshiraseFileSimple"
End Sub

'|fffd|K|fffd|{|fffd|`|fffd|F|fffd|b|fffd|N|fffd|@|fffd||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd|F|fffd||6235||fffd||35dd||fffd|X|fffd|i|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|j|fffd|Z|fffd||fffd||fffd||fffd||fffd|K|fffd|{|fffd||30f||a347||fffd||348||fffd||fffd||fffd||fffd||fffd|true|fffd||fffd|n|fffd||fffd|
Private Function isRequiredAGInfo(Optional checkAddress As Boolean = False) As Boolean
    startOf "isRequiredAGInfo"
    isRequiredAGInfo = False


    If shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value <> "" Then
        If shtInputInfo.Cells(ROW_shtInputInfo.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value <> "" Then
            '|fffd||35dd||fffd|X|fffd||fffd||fffd|A|fffd|A|fffd||fffd||fffd||60aa||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|OK
            isRequiredAGInfo = True
        End If

    End If

    '|fffd|Z|fffd||fffd||fffd||fffd||fffd|K|fffd|{|fffd||30f||a347||fffd|A|fffd|Z|fffd||fffd|3|fffd|s|fffd||fffd||fffd||fffd||fffd||d0b9||fffd||102||fffd||fffd||fffd|i""|fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||182||fffd||fffd||fffd|
    If checkAddress Then
        If shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value & shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|2, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value & shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|3, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value = "" Then
            isRequiredAGInfo = False
        End If
    End If

    endOf "isRequiredAGInfo"
End Function

'|fffd|u|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub createOshiraseFile()
    startOf "createOshiraseFile"
    Dim SaveDir As String
    Dim i As Long
    Dim cnt As Long '|fffd|A|fffd|g|fffd||fffd||fffd||fffd|

    Dim targetRow As Long
    Dim tempFilePath As String


    If versionCheck = False Then
        ExitOf "createOshiraseFile", "versionCheck NG"
        Exit Sub
    End If


    '|fffd||752||fffd|l|fffd||fffd||fffd||343|V|fffd|[|fffd|g|fffd||311||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd||315|K|fffd|{|fffd||fffd||fffd||683|`|fffd|F|fffd|b|fffd|N
    If isRequiredAGInfo = False Then
        shtInputInfo.Activate
        MsgBox "|fffd||6235||fffd||35dd||fffd|X|fffd|i|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ExitOf "createOshiraseFile", "|fffd||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||358|R|fffd||fffd|"
        Exit Sub
    End If

    '|fffd||38f||6ca|m|fffd|F|fffd|i|fffd|P|fffd||82||fffd||fffd||38f||6c2||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd|j
    If getLastRow(shtList, COL_shtList.|fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O) = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| Then
        MsgBox "|fffd||38f||6c2||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ExitOf "createOshiraseFile", "|fffd||38f||6c2||202||fffd|"
        Exit Sub
    End If

    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|c|fffd||fffd||fffd||c42c||fffd|j
    tempFilePath = ThisWorkbook.path & "\" & TEMPLATE_FILE_INNER_PATH & "\" & TEMPLATE_FILE_NAME
    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311||fffd||fffd||74a|m|fffd|F
    If Dir(tempFilePath) = "" Then
        '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||302||143|G|fffd||fffd||fffd|[
        MsgBox "|fffd||598|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||183|c|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||251||fffd||fffd||742||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd||fffd||fffd|s|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B"
        Exit Sub
    End If

    '|fffd||fffd||fffd|m|fffd||70b9||fffd||6d1||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||c42c|
    SaveDir = ThisWorkbook.path & "\" & "|fffd||c42c||fffd|I|fffd||fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|[|fffd||fffd||fffd||18d||d3dc||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_" & Format(Now, "yyyymmddHHMMSS")
    If Dir(SaveDir, vbDirectory) = "" Then
        MkDir SaveDir
    End If

    Application.ScreenUpdating = False

    cnt = 0
    i = 1
    For i = 1 To getLastRow(shtList, COL_shtList.|fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O) - ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd|

        targetRow = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| + i

        '|fffd|u|fffd|d|fffd|b|fffd||242||fffd||fffd|p|fffd||fffd||fffd||8471||fffd||fffd||fffd||302||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd|v|fffd|i|fffd|c|fffd||fffd||fffd||c42c||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c|
        If mdlOshirase.openOshiraseFile(targetRow, SaveDir) Then
            cnt = cnt + 1
        End If

    Next i
    If cnt > 0 Then
        '|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        sendServerLog("|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd|A|fffd|g|fffd|F" & cnt & "|fffd||fffd|")
'2019/05/14 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        sendServerLog "|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd|A|fffd|g|fffd|F" & cnt & "|fffd||fffd|", cnt
'2019/05/14 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

        Application.ScreenUpdating = True

'|fffd||fffd||fffd|c|fffd||fffd||fffd||317|v|fffd|]|fffd||143|t|fffd|H|fffd||fffd||fffd|_|fffd||34a|J|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||242||fffd||fffd||fffd|
'        '|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||402||70ad|
'        Shell "C:\Windows\Explorer.exe " & SaveDir, vbNormalFocus


        MsgBox "|fffd|d|fffd|b|fffd||242||fffd||fffd|p|fffd||fffd||fffd||8471||fffd||fffd||fffd||302||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||353||fffd||fffd|e|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        '|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|
        Dim FSO As Object
        Set FSO = CreateObject("scripting.fileSystemObject")
        FSO.DeleteFolder SaveDir
        Set FSO = Nothing

        Application.ScreenUpdating = True

    End If


    endOf "createOshiraseFile"
End Sub

'|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub createAtenaLabel()
    startOf "createAtenaLabel"
    Dim i As Long
    Dim targetRow As Long

    Dim shtAtena As Worksheet
    Dim nowString As String
    Dim AtenaSheetName As String

    Dim atenaCnt As Long
    Dim atenaSetCnt As Long

    Dim newSheet As Worksheet


    If versionCheck = False Then
        ExitOf "createAtenaLabel", "versionCheck NG"
        Exit Sub
    End If



    '|fffd||38f||6ca|m|fffd|F|fffd|i|fffd|P|fffd||82||fffd||fffd||38f||6c2||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd|j
    If getLastRow(shtList, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O) = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| Then
        MsgBox "|fffd||38f||6c2||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ExitOf "createAtenaLabel", "|fffd||38f||6c2||202||fffd|"
        Exit Sub
    End If

    nowString = Format(Now, "yyyymmddHHMMSS")
    AtenaSheetName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd|_" & nowString

    Application.ScreenUpdating = False


    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||c42c|
    shtTemplateAtenaLabel.Visible = xlSheetVisible
    Set newSheet = Copy(shtTemplateAtenaLabel)
'    shtTemplateAtenaLabel.Copy After:=shtTemplateAtenaLabel
    newSheet.Name = AtenaSheetName
    shtTemplateAtenaLabel.Visible = xlSheetVeryHidden


    atenaCnt = 1
    atenaSetCnt = 1
    For i = 1 To getLastRow(shtList, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O) - ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd|

        targetRow = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| + i

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        If writeAtenaLabel(targetRow, AtenaSheetName, atenaCnt, atenaSetCnt) Then
            atenaCnt = atenaCnt + 1
        End If

    Next i

    If atenaCnt > 0 Then
        '|fffd||283|u|fffd|b|fffd|N|fffd||248||693||fffd|
        Worksheets(AtenaSheetName).Move

        '|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        sendServerLog ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||c42c||fffd|F" & atenaCnt - 1 & "|fffd||fffd|")

        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||c42c||fffd|F" & atenaCnt - 1 & "|fffd||fffd|"

        Application.ScreenUpdating = True

        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|"
    End If
    endOf "createAtenaLabel"
End Sub

'|fffd|u|fffd||fffd||fffd||fffd||fffd||c42c||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||30f||fffd||fffd||fffd|
Public Sub createOkurijo()
    startOf "createOkurijo"

    Dim targetRow As Long
    Dim i As Long

    Dim cnt As Long
    Dim newOkurijoBook As Workbook


    If versionCheck = False Then
        ExitOf "createOkurijo", "versionCheck NG"
        Exit Sub
    End If


    '|fffd||752||fffd|l|fffd||fffd||fffd||343|V|fffd|[|fffd|g|fffd||311||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd||315|K|fffd|{|fffd||fffd||fffd||683|`|fffd|F|fffd|b|fffd|N(|fffd|Z|fffd||fffd||fffd|K|fffd|{|fffd||302||fffd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd|True|fffd||fffd|n|fffd||fffd||fffd|j
    If isRequiredAGInfo(True) = False Then
        shtInputInfo.Activate
        MsgBox "|fffd||6235||fffd||35dd||fffd|X|fffd|i|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ExitOf "createOkurijo", "|fffd||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd||fffd||fffd||358|R|fffd||fffd|"
        Exit Sub
    End If

    '|fffd||752||fffd|l|fffd||fffd||fffd||343|V|fffd|[|fffd|g|fffd||311||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd|(|fffd|Z|fffd||fffd|)|fffd||30c||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If Len(shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value) > 20 Or Len(shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|2, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value) > 20 Or Len(shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|3, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value) > 20 Then
        shtInputInfo.Activate
        MsgBox "|fffd|Z|fffd||fffd||fffd||34a|e|fffd|s|fffd||182||fffd||fffd||251|S|fffd|p|fffd|Q|fffd|O|fffd||fffd||fffd||fffd||fffd||213||fffd||fffd||153||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        ExitOf "createOshiraseFile", "|fffd||35dd||fffd|X|fffd||fffd|{|fffd||fffd||fffd|(|fffd|Z|fffd||fffd|)|fffd||fffd||fffd||fffd|Over"
        Exit Sub
    End If

    '|fffd||38f||6ca|m|fffd|F|fffd|i|fffd|P|fffd||82||fffd||fffd||38f||6c2||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd|j
    If getLastRow(shtList, COL_shtList.|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O) = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| Then
        MsgBox "|fffd||38f||6c2||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ExitOf "createAtenaLabel", "|fffd||38f||6c2||202||fffd|"
        Exit Sub
    End If


    Application.ScreenUpdating = False

    For i = 1 To getLastRow(shtList, COL_shtList.|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O) - ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd|

        targetRow = ROW_shtList.|fffd|^|fffd|C|fffd|g|fffd||fffd| + i

        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g
        If mdlOkurijo.makeOkurijo(targetRow, newOkurijoBook) Then
            cnt = cnt + 1
        End If
    Next i

    '1|fffd||fffd||fffd||20f||fffd||c42c||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||741|i|fffd||fffd|s|fffd||fffd||38f||6c2||182||fffd||fffd||fffd||fffd||a347||fffd||349||fffd||fffd|L|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||342||142||202||fffd||fffd|j
    If cnt > 0 Then
        '|fffd||fffd||50d||fffd||fffd||303|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||502||182||fffd||fffd||fffd|
        newOkurijoBook.Worksheets(1).Activate

'2019/07/16 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd||fffd||fffd||fffd||fffd||c42c||fffd|F" & cnt - 1 & "|fffd||fffd|"
'        '|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        sendServerLog ("|fffd||fffd||fffd||fffd||fffd||c42c||fffd|F" & cnt - 1 & "|fffd||fffd|")
'2019/07/16 |fffd||d3dc| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/07/16 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Log "|fffd||fffd||fffd||fffd||fffd||c42c||fffd|F" & cnt & "|fffd||fffd|"
        '|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        sendServerLog ("|fffd||fffd||fffd||fffd||fffd||c42c||fffd|F" & cnt & "|fffd||fffd|")
'2019/07/16 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

        Application.ScreenUpdating = True
        MsgBox "|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|"
    End If

    endOf "createOkurijo"
End Sub



Attribute VB_Name = "SheetProxy"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'/****************************************************************************
' * SheetProxy 0.20 BETA 2012.6.20
' *
' * |fffd||fffd||28d||fffd||fffd||690||fffd||fffd||fffd||117|p|fffd|{|fffd||fffd||fffd||fffd||fffd|c|fffd|[|fffd||fffd|
' *
' * Using: EGG|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd| version 1.70
' ****************************************************************************/

Option Explicit

'|fffd|s|fffd||fffd||fffd|`
Public ROW_SCREEN As Long
Public ROW_TYPE As Long
Public ROW_ID As Long
Public ROW_GETEMPTY As Long
Public ROW_NAMEJ As Long
Public ROW_START As Long
Public COL_START As Long
Public COL_PKEY As Long
Public COL_RESULT As Long

'|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||303|L|fffd||fffd||fffd|b|fffd|V|fffd||fffd|
Public sht As Worksheet


'|fffd|s|fffd||fffd||fffd|w|fffd||80b5||fffd||103|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||fffd||fffd||64fe|
Public Function getDataElements(Optional row As Long) As DataElement()
    Dim IgnoreValue As Boolean
    '|fffd|s|fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||352|l|fffd||202||fffd||fffd|i|fffd||fffd||fffd||68f||fffd||fffd||302||741|j
    If row = 0 Then IgnoreValue = True

    Dim ret() As DataElement
    Dim de As DataElement
    Dim i As Long
    i = 0
    
    Set de = getDataElement(row, Trim(sht.Cells(ROW_ID, i + COL_START).Value), IgnoreValue)
    Do While Not de Is Nothing
        ReDim Preserve ret(i)
        Set ret(i) = de
        i = i + 1
        Set de = getDataElement(row, Trim(sht.Cells(ROW_ID, i + COL_START).Value), IgnoreValue)
        DoEvents
    Loop

    getDataElements = ret
End Function


'|fffd|s|fffd||fffd||fffd|w|fffd||80b5||fffd||103|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|Z|fffd|b|fffd|g
Public Sub setDataElements(row As Long, de() As DataElement)
    Dim i As Long
    
    For i = 0 To UBound(de)
        setDataElement row, de(i)
    Next
End Sub


'|fffd|s|fffd|EID|fffd||fffd||fffd|w|fffd||80b5||fffd||103|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
Public Function getDataElement(row As Long, Id As String, Optional IgnoreValue As Boolean) As DataElement
    Dim de As DataElement
    Set de = Nothing
    
    Dim col As Long
    col = getColumnById(Id)
    
    If col >= COL_START Then
        If Trim(sht.Cells(ROW_ID, col).Value) <> "" Then
            Set de = New DataElement
            de.setElementID Trim(sht.Cells(ROW_ID, col).Value)
            de.setElementType Trim(sht.Cells(ROW_TYPE, col).Value)
            de.setScreenName Trim(sht.Cells(ROW_SCREEN, col).Value)
            If Not IgnoreValue Then
                '|fffd|u|fffd||d5d8e||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|p|fffd|v|fffd||243|T|fffd|C|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd||312|l|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd|setValue|fffd||fffd||fffd||202||fffd|
                If Trim(sht.Cells(ROW_GETEMPTY, col).Value) = "" And sht.Cells(row, col).Value = "" Then
                    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|B<>|fffd||fffd|or|fffd||fffd||fffd||5c2||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||302||156|{|fffd||fffd||fffd||fffd|Else|fffd||242||fffd||fffd||fffd|
                '|fffd||fffd||fffd||fffd||20a|O|fffd||30f||a347||fffd||352|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|i|fffd|T|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||702||fffd||fffd||352|l|fffd||fffd||fffd||fffd|j
                Else
                    de.setValue sht.Cells(row, col).Value
                End If
            End If
        End If
    End If
    
    Set getDataElement = de

End Function


'|fffd|s|fffd||fffd||fffd|w|fffd||80b5||fffd||103|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd|i|fffd|P|fffd||fffd||fffd|j
Public Sub setDataElement(row As Long, de As DataElement)
    If Not de.useThisElement Then Exit Sub
    Dim col As Long
    col = getColumnById(de.getElementID)
    
    If col >= COL_START Then
        sht.Cells(row, col).Value = "'" & de.getValue
    End If
End Sub


'ID|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getColumnById(Id As String) As Long
    Dim i As Long
    i = 0
    Do While Trim(sht.Cells(ROW_ID, i + COL_START).Value) <> ""
        If Trim(sht.Cells(ROW_ID, i + COL_START).Value) = Id Then
            getColumnById = i + COL_START
            Exit Function
        End If
        i = i + 1
        DoEvents
    Loop
End Function


'|fffd|f|fffd|[|fffd|^|fffd|L|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
Public Function hasData(row As Long) As Boolean
    If Trim(sht.Cells(row, COL_PKEY).Value) <> "" Then
        hasData = True
    Else
        hasData = False
    End If
End Function


'|fffd||fffd||fffd||282||30f||fffd||fffd||fffd||fffd||7c2||fffd|
Public Sub setResult(row As Long, result As String)
    sht.Cells(row, COL_RESULT).Value = result
End Sub


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ----------------------------------------
    If JK_BeforeSave(SaveAsUI, Cancel) = False Then Exit Sub
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||702||fffd| ----------------------------------------

End Sub

'|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|N|fffd||fffd|
Private Sub Workbook_Open()
    startOf "Workbook_Open"

    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ----------------------------------------
    If JK_Auto_Open = False Then Exit Sub
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||702||fffd| ----------------------------------------

    '|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||311|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call shtInputInfo.InitMankiManth

'|fffd||fffd||fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd|o|fffd||342||302||fffd||fffd||7c2||255|K|fffd|v|fffd||20f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd|[|fffd|UID|fffd|A|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    shtSetting.Range(AG_CODE_ADDR).Value = ""
    shtSetting.Range(USER_ID_ADDR).Value = ""


    Call Logs.setDebugLog

    endOf "Workbook_Open"
End Sub



'|fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd||6c2||30f||fffd||fffd||fffd|
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    startOf "Workbook_BeforeClose"

    '|fffd||fffd||fffd|O|fffd||752||fffd|V|fffd|[|fffd|g|fffd||308||fffd||50f||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||502||242||fffd||fffd||102||fffd||fffd||fffd|
    shtInputInfo.Activate
    shtInputInfo.Cells(1, 1).Select
    
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ----------------------------------------
    If JK_BeforeClose = False Then
        Cancel = True
        Exit Sub
    End If
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||702||fffd| ----------------------------------------

    '|fffd||752||fffd|V|fffd|[|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    shtSetting.Range(CYOUSA_MODE_ADDR).ClearContents
    shtSetting.Range(AG_CODE_ADDR).ClearContents
    shtSetting.Range(USER_ID_ADDR).ClearContents

    '|fffd||413||fffd||fffd||fffd||fffd|p|fffd||30f||a347||fffd|A|fffd|f|fffd|[|fffd|^|fffd||fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    If isMS1PC Then
        '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|(|fffd|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc|)
         ClearDataSheet True
    End If

    '|fffd|u|fffd|b|fffd|N|fffd||6d1||fffd|
    Application.DisplayAlerts = False
    ThisWorkbook.Save
    Application.DisplayAlerts = True


    endOf "Workbook_BeforeClose"
End Sub

Private Sub Workbook_AfterSave(ByVal Success As Boolean)
    
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ----------------------------------------
    If JK_AfterSave = False Then
        Exit Sub
    End If
    'J|fffd||389||fffd|(|fffd||90|l|fffd||fffd||fffd||6cc||fffd||389||fffd|) - |fffd||fffd||fffd||fffd||fffd||702||fffd| ----------------------------------------

End Sub
Attribute VB_Name = "UIAutomationProxy"
Option Explicit
'|fffd|Q|fffd||190||752||fffd| UIAutomationClient
'32bitOS|fffd||fffd|32|fffd||fffd|excel C:\Windows\System32\UIAutomationCore.dll
'64BitOS|fffd||fffd|32|fffd||fffd|excel C:\Windows\SysWOW64\UIAutomationCore.dll
'/****************************************************************************
' * UI Automation |fffd||fffd||fffd||fffd|Proxy 2014.04.08 v0.51
' *
' * UI Automation|fffd||311||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|
' *
' ****************************************************************************/
#If Win64 Then
'|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|g|fffd|b|fffd|v|fffd||fffd||fffd|x|fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
Private Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare PtrSafe Function EnumWindows Lib "user32" (ByVal lpEnumFunc As LongPtr, lPalam As LongPtr) As Long
'|fffd|q|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare PtrSafe Function EnumChildWindows Lib "user32" (ByVal hWndParent As LongPtr, ByVal lpEnumFunc As LongPtr, ByVal lParam As LongPtr) As Long
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||282||fffd||fffd||fffd|
Private Declare PtrSafe Function IsWindowVisible Lib "user32" (ByVal hWnd As LongPtr) As Long
#Else
'|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|g|fffd|b|fffd|v|fffd||fffd||fffd|x|fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
Private Declare Function FindWindow Lib "user32" Alias "FindWindowA" (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare Function EnumWindows Lib "user32" (ByVal lpEnumFunc As Long, lPalam As Long) As Long
'|fffd|q|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
Private Declare Function EnumChildWindows Lib "user32" (ByVal hWndParent As Long, ByVal lpEnumFunc As Long, ByVal lParam As Long) As Long
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||282||fffd||fffd||fffd|
Private Declare Function IsWindowVisible Lib "user32" (ByVal hWnd&) As Long
#End If

'->|fffd||fffd||fffd||fffd||fffd||fffd||fffd||151|O|fffd||fffd|
#If Win64 Then
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd| ID |fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|
Private Declare PtrSafe Function GetWindowThreadProcessId Lib "user32" (ByVal hWnd As LongPtr, lpdwProcessId As Long) As Long
'|fffd|t|fffd|H|fffd|A|fffd|O|fffd||fffd||fffd|E|fffd||fffd||fffd|h|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd||fffd||fffd||743||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd|
Private Declare PtrSafe Function GetForegroundWindow Lib "user32" () As LongPtr
'|fffd||fffd||fffd||fffd||303|X|fffd||fffd||fffd|b|fffd|h|fffd||313||fffd||fffd||34f||fffd||fffd||fffd||fffd|@|fffd|\|fffd||fffd||282||303|X|fffd||fffd||fffd|b|fffd|h|fffd||243|A|fffd|^|fffd|b|fffd|`|fffd||fffd||fffd||702||fffd|
Private Declare PtrSafe Function AttachThreadInput Lib "user32" (ByVal idAttach As Long, ByVal idAttachTo As Long, ByVal fAttach As Long) As Long
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd||fffd|t|fffd|H|fffd|A|fffd|O|fffd||fffd||fffd|E|fffd||fffd||fffd|h|fffd||242||fffd||fffd|A|fffd||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||702||fffd|
Private Declare PtrSafe Function SetForegroundWindow Lib "user32" (ByVal hWnd As LongPtr) As Long
#Else
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd| ID |fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|
Private Declare Function GetWindowThreadProcessId Lib "user32" (ByVal hWnd As Long, lpdwProcessId As Long) As Long
'|fffd|t|fffd|H|fffd|A|fffd|O|fffd||fffd||fffd|E|fffd||fffd||fffd|h|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd||fffd||fffd||743||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd||fffd||182||fffd||fffd||102||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd|
Private Declare Function GetForegroundWindow Lib "user32" () As Long
'|fffd||fffd||fffd||fffd||303|X|fffd||fffd||fffd|b|fffd|h|fffd||313||fffd||fffd||34f||fffd||fffd||fffd||fffd|@|fffd|\|fffd||fffd||282||303|X|fffd||fffd||fffd|b|fffd|h|fffd||243|A|fffd|^|fffd|b|fffd|`|fffd||fffd||fffd||702||fffd|
Private Declare Function AttachThreadInput Lib "user32" (ByVal idAttach As Long, ByVal idAttachTo As Long, ByVal fAttach As Long) As Long
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd||fffd|t|fffd|H|fffd|A|fffd|O|fffd||fffd||fffd|E|fffd||fffd||fffd|h|fffd||242||fffd||fffd|A|fffd||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||702||fffd|
Private Declare Function SetForegroundWindow Lib "user32" (ByVal hWnd As Long) As Long
#End If
'<-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||151|O|fffd||fffd|

'Elements|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Enum uiDirection
    FirstChild = 0
    LastChild = 1
    nextSibling = 2
    Parent = 3
    PrevSibling = 4
End Enum

#If Win64 Then
'|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||3d0||fffd|
Private mdlTopHWnd          As LongPtr
Private mdlChildHWnd        As LongPtr
'EnumWindows
'Top|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||355||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\|fffd|B
'|fffd|@|fffd||fffd||602||8576||fffd||fffd||fffd|F&,!
'|fffd|@&|fffd|FAnd|fffd||fffd||fffd||fffd|
'|fffd|@!|fffd|FOr|fffd||fffd||fffd||fffd|
Private mdlFindTopCaption   As String                   '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\|fffd|i|fffd||fffd|FAAA&BBB(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||781|j|fffd|@AAA!BBB(|fffd||fffd||fffd||fffd||fffd||a0a9||fffd||702||fffd|)|fffd|j
Private mdlFindTopClass     As String                   '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlResTopHWnd       As LongPtr
'EnumChildWindows
Private mdlFindChildCaption As String                   '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
Private mdlFindChildClass   As String                   '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlResChildHWnd     As LongPtr
#Else
'|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||3d0||fffd|
Private mdlTopHWnd          As Long
Private mdlChildHWnd        As Long
'EnumWindows
Private mdlFindTopCaption   As String                   '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
Private mdlFindTopClass     As String                   '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlResTopHWnd       As Long
'EnumChildWindows
Private mdlFindChildCaption As String                   '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
Private mdlFindChildClass   As String                   '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlResChildHWnd     As Long
#End If
'Top|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd|W|fffd|J|fffd|p
'mdlFindTopCaption|fffd||fffd||fffd|P|fffd||fffd||fffd||fffd|or|fffd||fffd||fffd||fffd||fffd|A|fffd|Q|fffd||fffd||fffd||fffd|and|fffd||fffd||fffd||fffd|
Private Type typFindTopCaps
    condAnd()   As String
End Type
Private mdlFindTopCaps()  As typFindTopCaps

#If Win64 Then
'-- (Setter topHWnd)
Public Property Let setTopHWnd(ByVal topHWnd As LongPtr)
    mdlTopHWnd = topHWnd
End Property
'-- (Setter childHWnd)
Public Property Let setChildHWnd(ByVal childHWnd As LongPtr)
    mdlChildHWnd = childHWnd
End Property
#Else
'-- (Setter topHWnd)
Public Property Let setTopHWnd(ByVal topHWnd As Long)
    mdlTopHWnd = topHWnd
End Property
'-- (Setter childHWnd)
Public Property Let setChildHWnd(ByVal childHWnd As Long)
    mdlChildHWnd = childHWnd
End Property
#End If
'-- (Setter FindTopCaption)
Public Property Let setFindTopCaption(ByVal findTopCaption As String)
    mdlFindTopCaption = findTopCaption
End Property
'-- (Setter FindTopClass)
Public Property Let setFindTopClass(ByVal findTopClass As String)
    mdlFindTopClass = findTopClass
End Property
'-- (Setter FindChildCaption)
Public Property Let setFindChildCaption(ByVal findChildCaption As String)
    mdlFindChildCaption = findChildCaption
End Property
'-- (Setter FindChildClass)
Public Property Let setFindChildClass(ByVal findChildClass As String)
    mdlFindChildClass = findChildClass
End Property

'
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|IUIAutomationElement|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|i|fffd|^|fffd|C|fffd|}|fffd|[|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd|j
'
Public Function uiGetElementFromHandleLoop(Optional waitTime As Long = 20000) As IUIAutomationElement
    startOf "uiGetElementFromHandleLoop"
    Dim e   As IUIAutomationElement
    Dim startTime   As Long
    Dim UseTime     As Long
   
    Set uiGetElementFromHandleLoop = Nothing
    
    UseTime = 0
    startTime = GetTickCount

    Do
   
        DoEvents
        Sleep 100
        
        '|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|IUIAutomationElement|fffd||fffd||fffd||64fe|
        Set e = uiGetElementFromHandle
        If Not e Is Nothing Then
            '|fffd||fffd||fffd||fffd|E|fffd|o
            Log "UIAutomationElement|fffd||30e||64fe||fffd||fffd||fffd||fffd|"
            Exit Do
        End If
        
        UseTime = GetTickCount - startTime
    
    Loop While UseTime < waitTime
    If UseTime >= waitTime Then
        Log "UIAutomationElement|fffd||30e||64fe||fffd||fffd||fffd|s"
        Exit Function
    End If
    
    Set uiGetElementFromHandleLoop = e
    
    endOf "uiGetElementFromHandleLoop"
End Function
'
'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|IUIAutomationElement|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|@Top|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd||209||fffd||fffd||302||fffd||fffd||fffd||fffd||a0a9||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||150||752||fffd|
'   mdlTopHWnd              |fffd|E|fffd|E|fffd||fffd|hWnd|fffd||64fe||fffd||3c2||742||30f||a347|
'       or
'   mdlFindTopCaption       '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
'   mdlFindTopClass         '|fffd||fffd||fffd|S|fffd||fffd|v
'|fffd|@|fffd|A|fffd|z|fffd||fffd||fffd||fffd|AutomationTop|fffd||fffd||fffd||fffd||302||fffd||fffd||7c1|A|fffd||209||fffd||fffd||302||fffd||fffd||fffd||fffd||a0a9||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||150||752||8043||fffd||217||fffd||fffd||94|\|fffd||fffd|
'   mdlChildHWnd|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|E|fffd|E|fffd||fffd|hWnd|fffd||64fe||fffd||3c2||742||30f||a347|
'       or
'   mdlFindChildCaption     '|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||94|\
'   mdlFindChildClass       '|fffd||fffd||fffd|S|fffd||fffd|v
'
Public Function uiGetElementFromHandle() As IUIAutomationElement
    startOf "uiGetElementFromHandle"
    #If Win64 Then
    Dim hWnd    As LongPtr
    #Else
    Dim hWnd    As Long
    #End If
    Dim aryOr() As String
    Dim aryAnd() As String
    Dim o   As IUIAutomation
    Dim e   As IUIAutomationElement
    Dim i   As Long
    Dim j   As Long
    
    Set uiGetElementFromHandle = Nothing
    
    mdlResTopHWnd = 0
    mdlResChildHWnd = 0
    
    'Top|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe|
    If mdlTopHWnd = 0 Then
        If Not (mdlFindTopCaption = "" And mdlFindTopClass = "") Then
            Log "EnumWindows mdlFindTopCaption:" & mdlFindTopCaption & ",mdlFindTopClass:" & mdlFindTopClass
            If mdlFindTopCaption <> "" Then
                'or|fffd||fffd||fffd||fffd||fffd||155||fffd||fffd||fffd|
                aryOr = Split(mdlFindTopCaption, "!")
                ReDim Preserve mdlFindTopCaps(UBound(aryOr))
                For i = LBound(aryOr) To UBound(aryOr)
                    'or|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|and|fffd||fffd||fffd||fffd||fffd||155||fffd||fffd||fffd|
                    aryAnd = Split(aryOr(i), "&")
                    ReDim Preserve mdlFindTopCaps(i).condAnd(UBound(aryAnd))
                    For j = LBound(aryAnd) To UBound(aryAnd)
                        mdlFindTopCaps(i).condAnd(j) = aryAnd(j)
                    Next
                Next
            End If
            '|fffd||10b|A|fffd||fffd||fffd||fffd|
            Call EnumWindows(AddressOf getTopWindows, 0)
            If mdlResTopHWnd = 0 Then
                Log "EnumWindows |fffd|w|fffd||fffd||303|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||742||82||fffd||fffd||fffd||202||fffd|"
                Exit Function
            End If
            hWnd = mdlResTopHWnd
        End If
    Else
        Log "|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|w|fffd||fffd| mdlTopHWnd:" & mdlTopHWnd
        hWnd = mdlTopHWnd
    End If
    
    '|fffd|q|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe|
    If mdlChildHWnd = 0 Then
        If Not (mdlFindChildCaption = "" And mdlFindChildClass = "") Then
            Log "EnumChildWindows mdlFindChildCaption:" & mdlFindChildCaption & ",mdlFindChildClass:" & mdlFindChildClass
            '|fffd||10b|A|fffd||fffd||fffd||fffd|
            Call EnumChildWindows(hWnd, AddressOf getChildWindows, 0)
            If mdlResChildHWnd = 0 Then
                Log "EnumChildWindows |fffd|w|fffd||fffd||30e|q|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||742||82||fffd||fffd||fffd||202||fffd|"
                Exit Function
            End If
            hWnd = mdlResChildHWnd
        End If
    Else
        Log "|fffd|q|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|w|fffd||fffd| mdlChildHWnd:" & mdlChildHWnd
        hWnd = mdlChildHWnd
    End If
    '|fffd||fffd||fffd||fffd||fffd||151|O|fffd||fffd|
    Call ForceSetForegroundWindow(hWnd)
    
    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|Automation
    Set o = New CUIAutomation
    Set e = o.ElementFromHandle(ByVal hWnd)
    If e Is Nothing Then
        Log "ElementFromHandle|fffd||fffd||fffd|s"
        Exit Function
    End If
    
    '|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    mdlTopHWnd = 0
    mdlChildHWnd = 0
    mdlFindTopCaption = ""
    mdlFindTopClass = ""
    mdlResTopHWnd = 0
    mdlFindChildCaption = ""
    mdlFindChildClass = ""
    mdlResChildHWnd = 0
    ReDim mdlFindTopCaps(0)
    Erase mdlFindTopCaps
    
    Set uiGetElementFromHandle = e
    
    endOf "uiGetElementFromHandle"
End Function

'|fffd||fffd||fffd|[|fffd|g|fffd|i|fffd|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|j|fffd||fffd|Element|fffd||fffd||fffd||64fe|
Public Function uiGetRootElement() As IUIAutomationElement
    startOf "uiGetRootElement"
    Dim o   As IUIAutomation
    Dim iCnd    As IUIAutomationCondition
    Dim iElement As IUIAutomationElement
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c|
    Set o = New CUIAutomation
    Set iElement = o.GetRootElement
    If iElement Is Nothing Then
        Log "CreatePropertyCondition|fffd||fffd||fffd|s"
        Exit Function
    End If
    Set iCnd = o.CreatePropertyCondition(UIA_IsControlElementPropertyId, True)
    If iCnd Is Nothing Then
        Log "CreatePropertyCondition|fffd||fffd||fffd|s"
        Exit Function
    End If
    '|fffd||fffd||fffd|[|fffd|g|fffd|i|fffd|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|j|fffd||fffd||fffd||64fe|
    Set uiGetRootElement = iElement.FindFirst(TreeScope_Element, iCnd)
    endOf "uiGetRootElement"
End Function

'|fffd|w|fffd||fffd||fffd|AutomationId|fffd||14e||64fe||fffd||fffd||fffd||fffd|
'   findId:AutomationId
Public Function uiGetElementById(pElement As IUIAutomationElement, ByVal findId As String) As IUIAutomationElement
    startOf "uiGetElementById"
    Set uiGetElementById = Nothing
    Set uiGetElementById = uiGetElement(pElement, UIA_AutomationIdPropertyId, findId)
    endOf "uiGetElementById"
End Function
'|fffd|w|fffd||fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'   findTypeName:|fffd||fffd||fffd|S|fffd||fffd|v
Public Function uiGetElementByType(pElement As IUIAutomationElement, ByVal findType As String) As IUIAutomationElement
    startOf "uiGetElementByType"
    Set uiGetElementByType = Nothing
    Set uiGetElementByType = uiGetElement(pElement, UIA_LocalizedControlTypePropertyId, findType)
    endOf "uiGetElementByType"
End Function
'|fffd|w|fffd||fffd||316||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'   findTypeName:|fffd||fffd||fffd|S|fffd||fffd|v
Public Function uiGetElementByName(pElement As IUIAutomationElement, ByVal findName As String) As IUIAutomationElement
    startOf "uiGetElementByName"
    Set uiGetElementByName = Nothing
    Set uiGetElementByName = uiGetElement(pElement, UIA_NamePropertyId, findName)
    endOf "uiGetElementByName"
End Function
'|fffd|w|fffd||fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'   findClass:|fffd||fffd||fffd|S|fffd||fffd|v
Public Function uiGetElementByClass(pElement As IUIAutomationElement, ByVal findClass As String) As IUIAutomationElement
    startOf "uiGetElementByClass"
    Set uiGetElementByClass = Nothing
    Set uiGetElementByClass = uiGetElement(pElement, UIA_ClassNamePropertyId, findClass)
    endOf "uiGetElementByClass"
End Function
'|fffd|w|fffd||fffd||fffd|Description|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd| 2014/01/08|fffd||1c9||fffd|
'   findDescription:|fffd||fffd||fffd|S|fffd||fffd|v
Public Function uiGetElementByDescription(pElement As IUIAutomationElement, ByVal findDescription As String) As IUIAutomationElement
    startOf "uiGetElementByDescription"
    Set uiGetElementByDescription = Nothing
    Set uiGetElementByDescription = uiGetElement(pElement, UIA_LegacyIAccessibleDescriptionPropertyId, findDescription)
    endOf "uiGetElementByDescription"
End Function
Private Function uiGetElement(pElement As IUIAutomationElement, PropertyId As Long, ByVal findName As String) As IUIAutomationElement
    startOf "uiGetElement"
    Dim o   As IUIAutomation
    Dim iCnd    As IUIAutomationCondition
    
    Set uiGetElement = Nothing
    
    Log "uiGetElementByType|fffd||fffd||fffd|s PropertyId:" & PropertyId & ",findName:" & findName
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c|
    Set o = New CUIAutomation
    Set iCnd = o.CreatePropertyCondition(PropertyId, findName)
    If iCnd Is Nothing Then
        Log "CreatePropertyCondition|fffd||fffd||fffd|s"
        Exit Function
    End If
    '|fffd||fffd||fffd||fffd||fffd|{|fffd|z|fffd||fffd||fffd||302||fffd||fffd||5c2||102||fffd||fffd||64fe|
    Set uiGetElement = pElement.FindFirst(TreeScope_Subtree, iCnd)
        
    endOf "uiGetElement"
    
End Function

'|fffd|w|fffd||fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd|A|fffd||fffd||fffd|O|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'   findTypeName:|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd|i|fffd||fffd||fffd|S|fffd||fffd|v|fffd|j
'   findName:|fffd||fffd||fffd|O|fffd|i|fffd||fffd||fffd|S|fffd||fffd|v|fffd|j
Public Function uiGetElementByTypeAndName(pElement As IUIAutomationElement, ByVal findType As String, ByVal findName As String) As IUIAutomationElement
    startOf "uiGetElementByTypeAndName"
    Dim o   As IUIAutomation
    Dim iCndAnd As IUIAutomationCondition
    Dim iCnd1   As IUIAutomationCondition
    Dim iCnd2   As IUIAutomationCondition
    Dim iElement As IUIAutomationElement
    
    Set uiGetElementByTypeAndName = Nothing
    
    Log "uiGetElementByTypeAndName|fffd||fffd||fffd|s findType:" & findType & ",findName:" & findName
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c|
    '|fffd|^|fffd|C|fffd|v
    Set o = New CUIAutomation
    Set iCnd1 = o.CreatePropertyCondition(UIA_LocalizedControlTypePropertyId, findType)
    If iCnd1 Is Nothing Then
        Log "CreatePropertyCondition1|fffd||fffd||fffd|s"
        Exit Function
    End If
    '|fffd||fffd||fffd|O
    Set iCnd2 = o.CreatePropertyCondition(UIA_NamePropertyId, findName)
    If iCnd2 Is Nothing Then
        Log "CreatePropertyCondition1|fffd||fffd||fffd|s"
        Exit Function
    End If
    'And|fffd||fffd||fffd||fffd||fffd||c42c|
    Set iCndAnd = o.CreateAndCondition(iCnd1, iCnd2)
    If iCndAnd Is Nothing Then
        Log "CreatePropertyCondition And|fffd||fffd||fffd|s"
        Exit Function
    End If
    '|fffd||fffd||fffd||fffd||fffd|{|fffd|z|fffd||fffd||fffd||302||fffd||fffd||5c2||102||fffd||fffd||64fe|
    On Error Resume Next
    Set uiGetElementByTypeAndName = pElement.FindFirst(TreeScope_Subtree, iCndAnd)
    On Error GoTo 0
    
    endOf "uiGetElementByTypeAndName"
    
End Function

'|fffd|w|fffd||fffd||310|e|fffd||fffd|Element|fffd||fffd||fffd||64fe|
' cntRepeat|fffd|F|fffd|w|fffd||fffd||5050c|J|fffd||502||fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|P|fffd||fffd|j
Public Function uiGetParentElement(pElement As IUIAutomationElement, Optional cntRepeat As Long = 1) As IUIAutomationElement
    startOf "uiGetParentElement"
    Dim iElement    As IUIAutomationElement
    Dim i   As Long
    
    Set uiGetParentElement = Nothing
    Set iElement = pElement
    For i = 1 To cntRepeat
        Set iElement = uiGetTreeWalkerElement(iElement, uiDirection.Parent)
    Next
    Set uiGetParentElement = iElement
    endOf "uiGetParentElement"
End Function
'|fffd|w|fffd||fffd||30d||14f||fffd||fffd||30e|qElement|fffd||fffd||fffd||64fe|
' cntRepeat|fffd|F|fffd|w|fffd||fffd||5050c|J|fffd||502||fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|P|fffd||fffd|j
Public Function uiGetFirstChildElement(pElement As IUIAutomationElement, Optional cntRepeat As Long = 1) As IUIAutomationElement
    startOf "uiGetFirstChildElement"
    Dim iElement    As IUIAutomationElement
    Dim i   As Long
    
    Set uiGetFirstChildElement = Nothing
    Set iElement = pElement
    For i = 1 To cntRepeat
        Set iElement = uiGetTreeWalkerElement(iElement, uiDirection.FirstChild)
    Next
    Set uiGetFirstChildElement = iElement
    endOf "uiGetFirstChildElement"
End Function
'|fffd|w|fffd||fffd||30d||14c||fffd||30e|qElement|fffd||fffd||fffd||64fe|
' cntRepeat|fffd|F|fffd|w|fffd||fffd||5050c|J|fffd||502||fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|P|fffd||fffd|j
Public Function uiGetLastChildElement(pElement As IUIAutomationElement, Optional cntRepeat As Long = 1) As IUIAutomationElement
    startOf "uiGetLastChildElement"
    Dim iElement    As IUIAutomationElement
    Dim i   As Long
    
    Set uiGetLastChildElement = Nothing
    Set iElement = pElement
    For i = 1 To cntRepeat
        Set iElement = uiGetTreeWalkerElement(iElement, uiDirection.LastChild)
    Next
    Set uiGetLastChildElement = iElement
    endOf "uiGetLastChildElement"
End Function
'|fffd|w|fffd||fffd||193||fffd||fffd||fffd||fffd|K|fffd|w|fffd||30e||fffd||fffd||fffd|Element|fffd||fffd||fffd||64fe|
' cntRepeat|fffd|F|fffd|w|fffd||fffd||5050c|J|fffd||502||fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|P|fffd||fffd|j
Public Function uiGetNextSiblingElement(pElement As IUIAutomationElement, Optional cntRepeat As Long = 1) As IUIAutomationElement
    startOf "uiGetNextSiblingElement"
    Dim iElement    As IUIAutomationElement
    Dim i   As Long
    
    Set uiGetNextSiblingElement = Nothing
    Set iElement = pElement
    For i = 1 To cntRepeat
        Set iElement = uiGetTreeWalkerElement(iElement, uiDirection.nextSibling)
    Next
    Set uiGetNextSiblingElement = iElement
    endOf "uiGetNextSiblingElement"
End Function
'|fffd|w|fffd||fffd||193||fffd||fffd||fffd||fffd|K|fffd|w|fffd||311|O|fffd||fffd|Element|fffd||fffd||fffd||64fe|
' cntRepeat|fffd|F|fffd|w|fffd||fffd||5050c|J|fffd||502||fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|P|fffd||fffd|j
Public Function uiGetPrevSiblingElement(pElement As IUIAutomationElement, Optional cntRepeat As Long = 1) As IUIAutomationElement
    Dim iElement    As IUIAutomationElement
    Dim i   As Long
    
    startOf "uiGetPrevSiblingElement"
    Set uiGetPrevSiblingElement = Nothing
    Set iElement = pElement
    For i = 1 To cntRepeat
        Set iElement = uiGetTreeWalkerElement(iElement, uiDirection.PrevSibling)
    Next
    Set uiGetPrevSiblingElement = iElement
    endOf "uiGetPrevSiblingElement"
End Function
Private Function uiGetTreeWalkerElement(pElement As IUIAutomationElement, ByVal direction As String) As IUIAutomationElement
    Dim o  As IUIAutomation
    Dim walk    As IUIAutomationTreeWalker
    
    Set uiGetTreeWalkerElement = Nothing
    
    '|fffd|w|fffd||fffd||fffd||fffd|e|fffd||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|E|fffd|o
    If pElement Is Nothing Then
        Exit Function
    End If
    
    'IUIAutomationTreeWalker|fffd||fffd||fffd||c42c|
    Set o = New CUIAutomation
    Set walk = o.ContentViewWalker
    
    '|fffd|w|fffd||fffd||fffd||fffd|@|fffd||155||fffd||fffd||fffd|
    Select Case direction
        Case uiDirection.FirstChild
            Set uiGetTreeWalkerElement = walk.GetFirstChildElement(pElement)
        Case uiDirection.LastChild
            Set uiGetTreeWalkerElement = walk.GetLastChildElement(pElement)
        Case uiDirection.nextSibling
            Set uiGetTreeWalkerElement = walk.GetNextSiblingElement(pElement)
        Case uiDirection.Parent
            Set uiGetTreeWalkerElement = walk.GetParentElement(pElement)
        Case uiDirection.PrevSibling
            Set uiGetTreeWalkerElement = walk.GetPreviousSiblingElement(pElement)
        Case Else
            
     End Select
    
End Function

'|fffd|w|fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||fffd|e|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
'   findTypeName:|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd|i|fffd||fffd||fffd|S|fffd||fffd|v|fffd|j
'   findName:|fffd||fffd||fffd|O
'   fullName:|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@ True|fffd||fffd||fffd|S|fffd||fffd|v|fffd|AFalse|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|v
'   position|fffd|F0|fffd||fffd||fffd||381|i0|fffd||fffd||fffd||14f||fffd||fffd||24c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd||20d|~+1|fffd|j
'   offset|fffd|F0|fffd||fffd||fffd||381|i0|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|B|fffd||20d|~+1|fffd|j
Public Function uiTreeFindElement(pElement As IUIAutomationElement, _
                                    ByVal findTypeName As String, ByVal findName As String, Optional matchFull As Boolean = True, _
                                    Optional position As Long = 0, Optional offset As Long = 0) As IUIAutomationElement
    startOf "uiTreeFindElement"
    Set uiTreeFindElement = Nothing
    Log "uiTreeFindElement|fffd||fffd||fffd|s findTypeName:" & findTypeName & ",findName:" & findName & ",matchFull:" & matchFull & ",offset:" & offset
    Set uiTreeFindElement = enumTreeFindElement(pElement, findTypeName, findName, matchFull, position, offset)
        
    endOf "uiTreeFindElement"
    
End Function
'|fffd|w|fffd||fffd|z|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||fffd|e|fffd||14c||fffd||fffd||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd|
Private Function enumTreeFindElement(pElement As IUIAutomationElement, _
                                    ByVal findTypeName As String, ByVal findName As String, Optional matchFull As Boolean = True, _
                                    Optional position As Long = 0, Optional offset As Long = 0, Optional depth As Long = 1) As IUIAutomationElement
    startOf "enumTreeFindElement"
    Dim o   As IUIAutomation
    Dim iCnd    As IUIAutomationCondition
    Dim iArray  As IUIAutomationElementArray
    Dim iElement    As IUIAutomationElement
    Dim cntPos  As Long
    Dim cntOff  As Long
    Dim blnCheck      As Boolean
    Dim blnFind       As Boolean
    Dim i   As Long
        
    Log "enumTreeFindElement depth:" & depth
    
    Set enumTreeFindElement = Nothing
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||c42c|
    Set o = New CUIAutomation
    Set iCnd = o.CreatePropertyCondition(UIA_IsControlElementPropertyId, True)
    If iCnd Is Nothing Then
        Log "CreatePropertyCondition|fffd||fffd||fffd|s"
        Exit Function
    End If
    '|fffd||fffd||fffd||fffd||fffd|{|fffd|q|fffd||fffd||fffd||fffd||fffd||64fe|
    Set iArray = pElement.FindAll(TreeScope_Element + TreeScope_Children, iCnd)
    If iArray Is Nothing Then
        Log "FindAll|fffd||fffd||fffd|s"
        Exit Function
    End If
    
    '|fffd|q|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N
    For i = 0 To iArray.Length - 1
        
        Set iElement = iArray.getElement(i)
        If iElement Is Nothing Then
            Log "GetElement|fffd||fffd||fffd|s i:" & i
            Exit Function
        End If
        
        On Error Resume Next
        Log "cnt:" & i
        Log "CurrentLocalizedControlType:" & iElement.CurrentLocalizedControlType
        Log "CurrentName:" & iElement.CurrentName
        Log "CurrentControlType:" & iElement.CurrentControlType
        Log "CurrentClassName:" & iElement.CurrentClassName
        Dim iValPattern As IUIAutomationValuePattern
        Set iValPattern = iElement.GetCurrentPattern(UIA_ValuePatternId)
        Log "CurrentValue:" & iValPattern.CurrentValue
        On Error GoTo 0
        
        If blnCheck = False Then
            If iElement.CurrentLocalizedControlType = findTypeName Then
                If matchFull = True Then
                    '|fffd||fffd||fffd|S|fffd||fffd|v
                    If iElement.CurrentName = findName Then
                        If cntPos = position Then
                            blnCheck = True
                        End If
                        cntPos = cntPos + 1
                    End If
                Else
                    '|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|l|fffd||30f||a347||fffd||342||fffd||fffd||5c2||111||38f||fffd|
                    'findName|fffd||fffd||fffd||fffd|l|fffd||30f||a347||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd|CurrentName|fffd||243|X|fffd|y|fffd|[|fffd|X|fffd|t|fffd|^
                    If InStr(iElement.CurrentName & " ", findName) > 0 Then
                        If cntPos = position Then
                            blnCheck = True
                        End If
                        cntPos = cntPos + 1
                    End If
                End If
            End If
        End If
        
        If blnCheck = True Then
            If cntOff = offset Then
                '|fffd|y|fffd||fffd||fffd||fffd||fffd|n|fffd|j|fffd|z
                Set enumTreeFindElement = iElement
                Exit Function
            End If
            cntOff = cntOff + 1
        End If
    
        DoEvents
        Sleep (1)
    Next
    '|fffd||fffd||fffd||fffd||fffd||10b|A|fffd||fffd||fffd||fffd||fffd||143|`|fffd|F|fffd|b|fffd|N
    For i = 0 To iArray.Length - 1
        
        Set iElement = iArray.getElement(i)
        If iElement Is Nothing Then
            Log "GetElement|fffd||fffd||fffd|s i:" & i
            Exit Function
        End If
        
        '|fffd||10b|A|fffd||fffd||fffd||fffd||fffd||14f||fffd||fffd||fffd||fffd|q|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Set enumTreeFindElement = enumTreeFindElement(iElement, findTypeName, findName, matchFull, position, offset, depth + 1)
        If Not enumTreeFindElement Is Nothing Then
            Exit Function
        End If
        
        DoEvents
        Sleep (1)
    Next
        
    endOf "enumTreeFindElement"
    
End Function

'|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||30e|w|fffd||fffd||fffd||fffd|e|fffd||fffd||fffd|N|fffd||fffd|
'   findName:|fffd||fffd||fffd|S|fffd||fffd|v
Public Function uiDoActionPopup(ByVal findName As String, Optional waitTime As Long = 2000) As Boolean
    startOf "uiDoActionPopup"
    #If Win64 Then
    Dim hWnd    As LongPtr
    #Else
    Dim hWnd    As Long
    #End If
    Dim o   As IUIAutomation                  ' IUIAutomation2
    Dim e   As IUIAutomationElement
    Dim iCnd    As IUIAutomationCondition
    Dim iElement    As IUIAutomationElement
    Dim iInvokePattern As IUIAutomationInvokePattern
    Dim AccPattern As IUIAutomationLegacyIAccessiblePattern

    uiDoActionPopup = False
    
    DoEvents
    Sleep 100
    
    hWnd = FindWindow("#32768", "")
    If hWnd = 0 Then
        '|fffd||fffd||fffd||fffd|E|fffd|o
        Log "|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd|"
        Exit Function
    End If
            
    '|fffd||64fe||fffd||fffd||fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
    Set o = New CUIAutomation
    Set e = o.ElementFromHandle(ByVal hWnd)
    If e Is Nothing Then
        Log "ElementFromHandle hWnd:" & hWnd
        Exit Function
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||303|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
    Set iCnd = o.CreatePropertyCondition(UIA_NamePropertyId, findName)
    If iCnd Is Nothing Then
        Log "CreatePropertyCondition|fffd||fffd||fffd|s"
        Exit Function
    End If
    Set iElement = e.FindFirst(TreeScope_Subtree, iCnd)
    If iElement Is Nothing Then
        Log "FindFirst|fffd||fffd||fffd|s"
        Exit Function
    End If
    
    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
    If uiDoAction(iElement) = False Then
        Exit Function
    End If
    
    uiDoActionPopup = True
    
    endOf "uiDoActionPopup"
End Function

'|fffd|w|fffd||fffd||303|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd|^|fffd|C|fffd|v|fffd||fffd||fffd||64fe|
Public Function uiGetElementType(pElement As IUIAutomationElement) As String
    startOf "uiGetElementType"
    
    uiGetElementType = ""
    
    'name|fffd|l|fffd||fffd||fffd||64fe|
    On Error Resume Next
    uiGetElementType = pElement.CurrentLocalizedControlType
    On Error GoTo 0
    
    endOf "uiGetElementType"
End Function

'|fffd|w|fffd||fffd||fffd|Name|fffd|l|fffd||fffd||fffd||64fe|
Public Function uiGetElementName(pElement As IUIAutomationElement) As String
    startOf "uiGetElementName"
    
    uiGetElementName = ""
    
    'name|fffd|l|fffd||fffd||fffd||64fe|
    On Error Resume Next
    uiGetElementName = pElement.CurrentName
    On Error GoTo 0
    
    endOf "uiGetElementName"
End Function

'|fffd|w|fffd||fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function uiGetElementClass(pElement As IUIAutomationElement) As String
    startOf "uiGetElementClass"
    
    uiGetElementClass = ""
    
    'name|fffd|l|fffd||fffd||fffd||64fe|
    On Error Resume Next
    uiGetElementClass = pElement.CurrentClassName
    On Error GoTo 0
    
    endOf "uiGetElementClass"
End Function

'|fffd|w|fffd||fffd||fffd|Handle|fffd|l|fffd||fffd||fffd||64fe|
#If Win64 Then
Public Function uiGetElementHandle(pElement As IUIAutomationElement) As LongPtr
#Else
Public Function uiGetElementHandle(pElement As IUIAutomationElement) As Long
#End If
    startOf "uiGetElementHandle"
    
    uiGetElementHandle = 0
    
    'Handle|fffd|l|fffd||fffd||fffd||64fe|
    On Error Resume Next
    uiGetElementHandle = pElement.GetCurrentPropertyValue(UIA_NativeWindowHandlePropertyId)
    On Error GoTo 0
    
    endOf "uiGetElementHandle"
End Function

'|fffd|w|fffd||fffd||fffd|Value|fffd|l|fffd||fffd||fffd||64fe|
Public Function uiGetElementValue(pElement As IUIAutomationElement) As String
    startOf "uiGetElementValue"
    Dim iValPattern As IUIAutomationValuePattern
    
    uiGetElementValue = ""
    
    '|fffd||fffd||fffd||fffd|p|fffd||303|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|N|fffd||fffd|
    On Error Resume Next
    Set iValPattern = pElement.GetCurrentPattern(UIA_ValuePatternId)
    If Not iValPattern Is Nothing Then
        uiGetElementValue = iValPattern.CurrentValue
        Log "iValPattern|fffd||fffd||fffd||fffd| CurrentValue:" & iValPattern.CurrentValue
        Exit Function
    End If
    On Error GoTo 0
    
    endOf "uiGetElementValue"
End Function

'|fffd|w|fffd||fffd||fffd|Value|fffd|l|fffd||fffd||752||fffd|
Public Function uiSetElementValue(pElement As IUIAutomationElement, ByVal setVal As String) As Boolean
    startOf "uiSetElementValue"
    Dim iElement    As IUIAutomationElement
    Dim iValPattern As IUIAutomationValuePattern
    
    uiSetElementValue = False
        
    '|fffd||fffd||fffd||fffd|p|fffd||303|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||752||fffd|
    On Error Resume Next
    Set iValPattern = pElement.GetCurrentPattern(UIA_ValuePatternId)
    If iValPattern Is Nothing Then
        Exit Function
    Else
        iValPattern.setValue setVal
        Log "iValPattern|fffd||fffd||fffd||fffd| setVal:" & setVal
    End If
    On Error GoTo 0
    
    uiSetElementValue = True
    
    endOf "uiSetElementValue"
End Function

'|fffd|w|fffd||fffd|Element|fffd||fffd|DoAction
'Invoke|fffd||142||353||fffd||fffd||c0b5||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7c1|ADoAction|fffd||255||3cd|X
Public Function uiDoAction(pElement As IUIAutomationElement) As Boolean
    startOf "uiDoAction"
    Dim iInvokePattern As IUIAutomationInvokePattern
    Dim AccPattern As IUIAutomationLegacyIAccessiblePattern
    Dim blnAction   As Boolean
    
    uiDoAction = False
    
    '|fffd||fffd||fffd||fffd|p|fffd||303|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|N|fffd||fffd|
    '|fffd||182||80a0||fffd||fffd||fffd||fffd|Invoke|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|A|fffd|Q|fffd|d|fffd|\|fffd||fffd||fffd||14e||fffd||fffd|s
    blnAction = False
    
    'Invoke|fffd||fffd||fffd|s|fffd||302||fffd||fffd||fffd|DoDefaultAction|fffd||fffd||fffd||fffd||fffd|s
    On Error Resume Next
    Set AccPattern = pElement.GetCurrentPattern(UIA_LegacyIAccessiblePatternId)
    If AccPattern Is Nothing Then
        Log "GetCurrentPattern|fffd|iAccPattern|fffd|j|fffd||64fe||fffd||fffd||fffd|s"
    Else
        '|fffd||fffd|DoDefaultAction|fffd||fffd||fffd|s
        AccPattern.DoDefaultAction
        If Err.Number = 0 Then
            blnAction = True
            Log "GetCurrentPattern|fffd|iAccPattern|fffd|j|fffd||fffd||fffd||fffd|"
        Else
            Log "GetCurrentPattern|fffd|iAccPattern|fffd|j|fffd||fffd||fffd|s"
        End If
    End If
    On Error GoTo 0
    
''    If blnAction = False Then
''        Set iInvokePattern = pElement.GetCurrentPattern(UIA_InvokePatternId)
''        If iInvokePattern Is Nothing Then
''            Log "GetCurrentPattern|fffd|iiInvokePattern|fffd|j|fffd||64fe||fffd||fffd||fffd|s"
''        Else
''            '|fffd||fffd|Invoke|fffd||fffd||fffd|s
''            On Error Resume Next
''            iInvokePattern.Invoke
''            If Err.Number = 0 Then
''                blnAction = True
''                Log "GetCurrentPattern|fffd|iiInvokePattern|fffd|j|fffd||fffd||fffd||fffd|"
''            Else
''                Log "GetCurrentPattern|fffd|iiInvokePattern|fffd|j|fffd||fffd||fffd|s"
''            End If
''            On Error GoTo 0
''        End If
''    End If
        
    If blnAction = False Then
        Exit Function
    End If
    
    uiDoAction = True

    endOf "uiDoAction"
End Function

'|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||10b|A|fffd||fffd|
#If Win64 Then
Private Function getTopWindows(ByVal hWnd As LongPtr, ByVal lParam As LongPtr) As Long
#Else
Private Function getTopWindows(ByVal hWnd As Long, ByVal lParam As Long) As Long
#End If
    Dim aryOr()     As String
    Dim aryAnd()    As String
    Dim i   As Long
    Dim j   As Long
    Dim getText     As String
    Dim FindText    As Boolean
    Dim findClass   As Boolean
    
    getTopWindows = 1             '|fffd|S|fffd||64fe|
    
    '|fffd||fffd|\|fffd||fffd||fffd||351||38f||6ca|O|fffd|i|fffd|c|fffd|[|fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Top|fffd||355|\|fffd||fffd||fffd||302||741|j
    If IsWindowVisible(hWnd) = False Then
        Exit Function
    End If
    
    '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|m|fffd|F
    FindText = True
    If mdlFindTopCaption <> "" Then
        getText = GetWindowTextProc(hWnd)
        For i = LBound(mdlFindTopCaps) To UBound(mdlFindTopCaps)
            FindText = True                                             '2014/04/08|fffd||fffd||fffd||fffd||fffd|l|fffd||292|u|fffd|s|fffd||fffd||fffd|i|fffd|Q|fffd||82||7c8||20d|~|fffd||fffd|OR|fffd||fffd||fffd||fffd||fffd||fffd||fffd|L|fffd||fffd||fffd||242||202||fffd||202||fffd||fffd|j
            For j = LBound(mdlFindTopCaps(i).condAnd) To UBound(mdlFindTopCaps(i).condAnd)
                If Not (InStr(getText, mdlFindTopCaps(i).condAnd(j)) > 0) Then
                    FindText = False
                End If
            Next
            If FindText = True Then
                Exit For
            End If
        Next
    End If
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|m|fffd|F
    findClass = True
    If mdlFindTopClass <> "" Then
        If getClassNameProc(hWnd) = mdlFindTopClass Then
            findClass = True
        Else
            findClass = False
        End If
    End If
    
    '|fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||343|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|I|fffd||fffd|
    If FindText = True And findClass = True Then
        mdlResTopHWnd = hWnd
        getTopWindows = 0             '|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    End If

End Function

'|fffd|q|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||fffd||10b|A|fffd||fffd|
#If Win64 Then
Private Function getChildWindows(ByVal hWnd As LongPtr, ByVal lParam As LongPtr) As Long
#Else
Private Function getChildWindows(ByVal hWnd As Long, ByVal lParam As Long) As Long
#End If
    Dim FindText    As Boolean
    Dim findClass   As Boolean
    
    getChildWindows = 1             '|fffd|S|fffd||64fe|
        
    '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|m|fffd|F
    FindText = True
    If mdlFindChildCaption <> "" Then
        If InStr(GetWindowTextProc(hWnd), mdlFindChildCaption) > 0 Then
            FindText = True
        Else
            FindText = False
        End If
    End If
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|m|fffd|F
    findClass = True
    If mdlFindChildClass <> "" Then
        If getClassNameProc(hWnd) = mdlFindChildClass Then
            findClass = True
        Else
            findClass = False
        End If
    End If
    
    '|fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||343|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|I|fffd||fffd|
    If FindText = True And findClass = True Then
        mdlResChildHWnd = hWnd
        getChildWindows = 0             '|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|
    End If

End Function
'|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||50b|p
#If Win64 Then
Private Function getClassNameProc(hWnd As LongPtr) As String
#Else
Private Function getClassNameProc(hWnd As Long) As String
#End If
    Dim buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
    
    lngRt = getClassName(hWnd, buffer, Len(buffer))
    getClassNameProc = Left(buffer, InStr(buffer, vbNullChar) - 1)
End Function
'|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50b|p
#If Win64 Then
Private Function GetWindowTextProc(hWnd As LongPtr) As String
#Else
Private Function GetWindowTextProc(hWnd As Long) As String
#End If
    Dim buffer As String * 512  '|fffd|o|fffd|b|fffd|t|fffd|@
    Dim lngRt    As Long        'API|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h
    
    lngRt = GetWindowText(hWnd, buffer, Len(buffer))
    GetWindowTextProc = Left(buffer, InStr(buffer, vbNullChar) - 1)
End Function

'## |fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||243|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
#If Win64 Then
Private Sub ForceSetForegroundWindow(hTargetWnd As LongPtr)
    Dim hWndActive          As LongPtr
#Else
Private Sub ForceSetForegroundWindow(hTargetWnd As Long)
    Dim hWndActive          As Long
#End If
    '============= Declare ==============
    Dim lngRet              As Long
    Dim hThreadActive       As Long
    Dim hThreadTarget       As Long

    '============= Initiarize ===========
    On Error GoTo ERR_HANDLER_00
    '============= Main =================
    
    '|fffd||fffd|U|fffd|A|fffd||fffd||fffd|s
     Call SetForegroundWindow(hTargetWnd)
    
    '|fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||303|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd| ID |fffd||64fe|
    hThreadTarget = GetWindowThreadProcessId(hTargetWnd, ByVal 0&)
    If (0& = hThreadTarget) Then
        Exit Sub
    End If
    '|fffd||fffd||fffd||743|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||203|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd| ID |fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    hWndActive = GetForegroundWindow()
    If (0& = hWndActive) Then
        Exit Sub
    End If
    hThreadActive = GetWindowThreadProcessId(hWndActive, ByVal 0&)
    If (0& = hThreadActive) Then
        Exit Sub
    End If
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||202||fffd|A|fffd||fffd||fffd||fffd||fffd||151|O|fffd||282||242||fffd||fffd||90be||fffd||fffd|
    If hThreadTarget = hThreadActive Then
        lngRet = SetForegroundWindow(hTargetWnd)
        If (0& = lngRet) Then
            Exit Sub
        End If
    Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||142||202||fffd||fffd||fffd||381|A|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||203|X|fffd||fffd||fffd|b|fffd|h|fffd||243|A|fffd|^|fffd|b|fffd|`|fffd||fffd||fffd||fffd|
        lngRet = AttachThreadInput(hThreadTarget, hThreadActive, 1&)
        If (0& = lngRet) Then
            Exit Sub
        Else
            
            On Error GoTo ERR_HANDLER_10
            
            '|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd||242||fffd||fffd||fffd|
            lngRet = SetForegroundWindow(hTargetWnd)
            If (0& = lngRet) Then
                Exit Sub
            End If
            '|fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd||fffd|f|fffd|^|fffd|b|fffd|`|fffd||fffd||fffd||fffd|
            lngRet = AttachThreadInput(hThreadTarget, hThreadActive, 0&)
            If (0& = lngRet) Then
                Exit Sub
            End If
            
        End If
    End If

'============= Release ==============
    Exit Sub
'============= Error ================
ERR_HANDLER_00:
    Exit Sub
ERR_HANDLER_10:
    '|fffd|X|fffd||fffd||fffd|b|fffd|h|fffd||fffd||fffd|f|fffd|^|fffd|b|fffd|`|fffd||fffd||fffd||fffd|
    Call AttachThreadInput(hThreadTarget, hThreadActive, 0&)
End Sub





Attribute VB_Name = "Util"
Option Explicit

'orange(v1.0.010 |fffd||14f|I|fffd|X|fffd|V:2016/5/27)|fffd||fffd||fffd||7532||fffd||fffd|
'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd|w|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s|fffd||20d|~|fffd||302||fffd||fffd||5c2||102||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
' *****************************************************************************/
Public Function clearWorksheet(ByRef sheet As Worksheet, ByVal dataStartRow As Long) As Boolean
    startOf "util.clearWorksheet (" & sheet.Name & ", " & dataStartRow & ")"

    Dim usedRow As Long

    usedRow = sheet.UsedRange.row + sheet.UsedRange.Rows.count

    If dataStartRow <= usedRow Then

        ' |fffd|w|fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|A|fffd|f|fffd|[|fffd|^|fffd|J|fffd|n|fffd|s|fffd||20d|~|fffd||302||fffd||fffd||5c2||102||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
        sheet.Range(sheet.Rows(dataStartRow), sheet.Rows(usedRow)).Delete
        Log sheet.Name & "|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If

    clearWorksheet = True

    endOf "util.clearWorksheet"
End Function

'orange(v1.0.010 |fffd||14f|I|fffd|X|fffd|V:2016/5/27)|fffd||fffd||fffd||7532||fffd||fffd|
'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd|
' *****************************************************************************/
Public Function openWorkbook(ByVal fileName As String) As Workbook
    startOf "util.openWorkbook(" & fileName & ")"

    Dim book  As Workbook
    Dim names As String

    Dim fileNames() As Variant
    Dim fileNamesStr() As String

    ' /*******************************************
    '  *   [|fffd|R|fffd|s|fffd|[|fffd|O|fffd||302||fffd||fffd||5c2||102||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd|]|fffd||fffd||fffd||64fe|
    '  *******************************************/
    names = ""
    For Each book In Application.Workbooks
        names = names & "/" & book.Name & "/"
    Next book

    ' /*******************************************
    '  *   |fffd|u|fffd|b|fffd|N|fffd||fffd||fffd|J|fffd||fffd|
    '  *******************************************/
    Workbooks.Open fileName:=fileName, ReadOnly:=True

    ' /*******************************************
    '  *   [|fffd|R|fffd|s|fffd|[|fffd|O|fffd||302||fffd||fffd||5c2||102||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd|]|fffd||181|A
    '  *   [|fffd|R|fffd|s|fffd|[|fffd||fffd||302||fffd||fffd||5c2||102||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd|]|fffd||fffd||fffd|r|fffd||fffd||fffd|A
    '  *   |fffd||1c9||fffd||fffd||fffd||fffd||a0bd||fffd|u|fffd|b|fffd|N|fffd||30e|Q|fffd||182||fffd||502||fffd|
    '  *******************************************/
    For Each book In Application.Workbooks

        If InStr(names, "/" & book.Name & "/") = 0 Then

            ' |fffd||1c9||fffd||fffd||fffd||fffd||a0bd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||302||141|A|fffd|Q|fffd||182||fffd||502||fffd|
            Set openWorkbook = book

            Exit For
        End If
    Next book

    If openWorkbook Is Nothing Then
        '|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||350|V|fffd||fffd||fffd||24a|J|fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd|T|fffd||fffd|
        For Each book In Application.Workbooks

            fileNamesStr = Split(fileName, "\")
            If book.Name = fileNamesStr(UBound(fileNamesStr)) Then
                Set openWorkbook = book
            End If
        Next book
    End If

    endOf "util.openWorkbook"
End Function

'orange(v1.0.010 |fffd||14f|I|fffd|X|fffd|V:2016/5/27)|fffd||fffd||fffd||7532||fffd||fffd|
'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||82||fffd||fffd||fffd|
' *****************************************************************************/
Public Function closeThisWorkbook()
    egg.startOf "util.closeThisWorkbook"

    Application.DisplayAlerts = False

    ' |fffd||fffd||fffd||303|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||141|A|fffd|u|fffd|b|fffd|N|fffd||fffd|1|fffd||82||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
    If Application.Workbooks.count = 1 Then

        ' |fffd||fffd||fffd||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd||18b||fffd||fffd||fffd|Excel|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
        Application.Quit
        ThisWorkbook.Close SaveChanges:=True
    Else

        ' |fffd||fffd||fffd||303||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd||18b||fffd||fffd||fffd|Excel|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
        ThisWorkbook.Close SaveChanges:=True
    End If

    Application.DisplayAlerts = True

    egg.endOf "util.closeThisWorkbook"
End Function

'orange(v1.0.010 |fffd||14f|I|fffd|X|fffd|V:2016/5/27)|fffd||fffd||fffd||7532||fffd||fffd|
'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd||14f|I|fffd|s|fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|A|fffd||fffd||fffd||7c2||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||fffd||502||fffd|
' *****************************************************************************/
Public Function getLastRow(ByRef sheet As Worksheet, Optional ByVal col As Long = 1) As Long
    startOf "util.getLastRow(" & sheet.Name & ", " & col & ")"

    Dim r       As Long

    Dim lastRow As Long
    Dim usedRow As Long

    usedRow = sheet.UsedRange.row + sheet.UsedRange.Rows.count - 1

    ' |fffd||14f|I|fffd|s|fffd||fffd||fffd||fffd||fffd||256||7c2||fffd|A|fffd||fffd||fffd||7c2||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||50d||fffd||fffd||fffd||502||fffd|
    For r = usedRow To 1 Step -1
        If Trim(sheet.Cells(r, col).MergeArea(1, 1).Value) <> "" Then

            lastRow = r

            Exit For
        End If
    Next r

    getLastRow = lastRow

    endOf "util.getLastRow"
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||502||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd|e|fffd|X|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd||202||fffd|True|fffd|A|fffd||fffd||fffd||fffd||20a|O|fffd||fffd|False|fffd||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@:
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||fffd|s|fffd||8b||fffd||fffd||312||fffd||fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|TestMode|fffd|x|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||fffd|True|fffd|A
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  |fffd||202||fffd||fffd||fffd||fffd|False|fffd||fffd||502||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||30f|o|fffd||350||fffd||310||611||582||fffd|J|fffd||389||fffd||fffd||30b||fffd||fffd||fffd||fffd||6d1||fffd||fffd|@|fffd|\|fffd||fffd|ON/OFF|fffd||611||593||fffd||fffd||24e|g|fffd|p
'
Public Function IsTestMode() As Boolean
    startOf "util.IsTestMode"
    '|fffd||fffd||fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|h|fffd||fffd|TestMode|fffd|h|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||fffd|True|fffd||fffd||502||fffd|
    On Error Resume Next
    IsTestMode = Dir(ThisWorkbook.path & "\|fffd||fffd|TestMode") <> ""
    On Error GoTo 0
    endOf "util.IsTestMode " & IsTestMode
End Function

'/*****************************************************************************
' * |fffd|@|fffd|\  |fffd|F |fffd|w|fffd||fffd||317||fffd||251||fffd||fffd||742||fffd||fffd||90b7||fffd||5c2||102||303|f|fffd|[|fffd|^|fffd||fffd|z|fffd||fffd||24a|i|fffd|[|fffd||fffd||fffd||fffd|
' *****************************************************************************/
Public Function getDataArray(ByRef sheet As Worksheet, ByVal startCol As Long, ByVal lastCol As Long, ByVal startRow As Long, ByVal lastRow As Long) As Variant
    startOf "getDataArray(" & sheet.Name & ", " & startCol & ", " & lastCol & ", " & startRow & ", " & lastRow & ")"

    Dim dataArray() As Variant

    ' /*******************************************
    '  *   |fffd||7c2||fffd|l|fffd|p|fffd||314|z|fffd||fffd||fffd||fffd||c42c|
    '  *******************************************/
    ReDim dataArray(1 To (lastCol - startCol + 1), 2 To lastRow)

    ' /*******************************************
    '  *   |fffd|w|fffd||fffd||317||fffd||251||fffd||fffd||742||fffd||fffd||90b7||fffd||5c2||102||303|f|fffd|[|fffd|^|fffd||fffd|z|fffd||fffd||24a|i|fffd|[
    '  *******************************************/
    With sheet
        dataArray = .Range(.Cells(startRow, startCol), .Cells(lastRow, lastCol)).Value
    End With

    getDataArray = dataArray
    endOf "getDataArray"
End Function

'|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||fffd|IE|fffd||fffd||fffd||64fe|
Public Function getRunningMS1IE(arg_title As String, Optional searchWord As String) As InternetExplorer
    startOf "getRunningMS1IE"

    Dim ie As InternetExplorer    'IE|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|^|fffd|j
    Dim sh As Object    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|ShellWindow|fffd||a3ae||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim win As Object   'ShellWindow|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim win_name As String
    Dim document_title As String    '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||308||a39e||fffd|i|fffd|[|fffd||3d0||fffd|
    Dim bodyInnerHtml As String     '|fffd|{|fffd|f|fffd|B|fffd|[|fffd||303|C|fffd||fffd||fffd|i|fffd|[HTML|fffd||fffd||fffd|i|fffd|[
    Set sh = CreateObject("Shell.Application")  'ShellWindow|fffd||fffd|wins|fffd||24a|i|fffd|[
    'ShellWindow|fffd||fffd||fffd||fffd|1|fffd||82||c2||8e||64fe||fffd||fffd||fffd||10f||fffd||fffd||fffd|
    For Each win In sh.Windows
        '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd|s|fffd||16cce||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd|j
        On Error Resume Next
        win_name = ""
        document_title = ""
        win_name = win.FullName
        document_title = win.document.Title
        On Error GoTo 0
        Log "win_name=" & win_name
        Log "title=" & document_title
        '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|o|fffd|[|fffd||248||fffd||fffd||fffd||fffd||fffd||fffd||702||702||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
        If LCase(Right(win_name, 12)) = "iexplore.exe" Then
            '2013/03/27 Metro IE|fffd||fffd||fffd||fffd||fffd|O|fffd||1c9||fffd|
            If checkDesktopIe(win) = True Then
                If InStr(document_title, arg_title) > 0 Then
                    '|fffd||fffd||fffd||fffd||fffd||38f||6d5||fffd||fffd||fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||34c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd||fffd|i|fffd|w|fffd||fffd||202||fffd||fffd||202||fffd|K|fffd||fffd|1|fffd||150|^|fffd||242||202||fffd|j
                    On Error Resume Next
                    bodyInnerHtml = ""
                    bodyInnerHtml = win.document.frames.Item("App1").document.body.innerHTML '2016/7/27(S.M)egg|fffd||fffd|getRunningIE|fffd||fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||60a4||fffd||255||3cd|X
                    On Error GoTo 0
                    If InStr(bodyInnerHtml, searchWord) > 0 Then
                        Set ie = win  '|fffd||3d0||fffd|ie|fffd||24e||64fe||fffd||fffd||fffd||fffd|win|fffd||fffd||fffd|i|fffd|[
                        Exit For      '|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
                    End If
                End If
            End If
        End If
    Next
    Set getRunningMS1IE = ie  '|fffd|l|fffd||315||50b|p

    endOf "getRunningMS1IE"
End Function

'Excel|fffd|u|fffd|b|fffd|N|fffd||253||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||742||fffd||fffd||fffd||a347|True|fffd||fffd||502||fffd||fffd|B
Public Function isExistSheet(book As Workbook, sheetName As String) As Boolean
    Dim i As Long

    isExistSheet = False

    For i = 1 To book.Worksheets.count

        If book.Worksheets(i).Name = sheetName Then
            isExistSheet = True
            Exit Function
        End If

    Next i

End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|V|fffd|[|fffd|g|fffd||303|R|fffd|s|fffd|[|fffd||fffd||fffd||c42c|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||c42c||fffd||fffd||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||30e|Q|fffd||182||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ASource - |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||303|V|fffd|[|fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  AParent - |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|Book|fffd|i|fffd||217||fffd||fffd||fffd||fffd||343|R|fffd|s|fffd|[|fffd||fffd||fffd||193||fffd||fffd||fffd||fffd|j
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|R|fffd|s|fffd|[|fffd|O|fffd||fffd|Worksheet|fffd||308||a5d7||fffd||fffd||fffd||c42c||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  |fffd|V|fffd||fffd||fffd||252||1c9||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|Worksheet|fffd||30e|Q|fffd||182||fffd||502||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|ActiveSheet|fffd||142||351||38f||6c2||303|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd|
'
Public Function Copy(ASource As Worksheet, Optional AParent As Variant = "") As Worksheet
    Const C_LOG_NAME = "|fffd|w|fffd|V|fffd|[|fffd|g|fffd||303|R|fffd|s|fffd|[|fffd||fffd||fffd||c42c||fffd|x"
    egg.startOf C_LOG_NAME                  '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***

    Dim WkSht       As Worksheet            '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||30e|Q|fffd||fffd|
    Dim names       As String               '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||308||a5d7|("/"|fffd||fffd||602||fffd|)
    Dim bkVisible   As Long                 'Visible|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||311||794||fffd|
    Dim ParentNm    As String               'Parent|fffd||fffd|
    Dim Parent      As Variant              'Parent


    'Parent|fffd||fffd||fffd||64fe|
    ParentNm = ""
    On Error Resume Next
    ParentNm = AParent.Name
    On Error GoTo 0

    If ParentNm = "" Then
        Set Parent = ASource.Parent         '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||183|R|fffd|s|fffd|[|fffd||60aa||fffd||fffd||fffd||fffd|Book
    Else
        Set Parent = AParent                '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||183|R|fffd|s|fffd|[|fffd||60aa||fffd||fffd|Book
    End If


    'Copy|fffd|O|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||308||a5d7||fffd||fffd||fffd||64fe|
    names = ""
    For Each WkSht In Parent.Worksheets
        names = names & "/" & WkSht.Name & "/"
    Next WkSht


    'VeryHidden|fffd||30f||a347||fffd||fffd|Hidden|fffd||255||3cd|X
    bkVisible = ASource.Visible
    If ASource.Visible = xlSheetVeryHidden Then ASource.Visible = xlSheetHidden



    '|fffd|V|fffd|[|fffd|g|fffd||303|R|fffd|s|fffd|[
    If ParentNm = "" Then
        ASource.Copy After:=ASource         '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30c||fffd||fffd||252||1c9||fffd|
    Else
        ASource.Copy Before:=Parent.Sheets(1)
                                            '|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|Book|fffd||310||64ea||fffd||252||1c9||fffd|
    End If
    ASource.Visible = bkVisible             'Visible|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||fffd||7c2||fffd|


    'Copy|fffd|O|fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|Copy|fffd||fffd||303||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd|r
    For Each WkSht In Parent.Worksheets
        If InStr(names, "/" & WkSht.Name & "/") = 0 Then
                                        '|fffd|R|fffd|s|fffd|[|fffd|O|fffd||308||a5d7||fffd||251||fffd||fffd||742||fffd||fffd||202||fffd||fffd|H
            '|fffd||1c9||fffd||fffd||fffd||fffd||a0bd||fffd|V|fffd|[|fffd|g|fffd||30e|Q|fffd||182||fffd||502||fffd|
            WkSht.Visible = bkVisible
            Set Copy = WkSht
            egg.Log "|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|F" & ASource.Name & "|fffd|A|fffd|R|fffd|s|fffd|[|fffd||fffd|F" & WkSht.Name
            Exit For
        End If
    Next WkSht


    egg.endOf C_LOG_NAME                    '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

Attribute VB_Name = "egg"
'|fffd||fffd||fffd||fffd|{|fffd|I|fffd||255||3cd|X|fffd|s|fffd||fffd|
' 2012/12/26 64bit|fffd||389||fffd|
' 2013/01/31 Window8+IE10|fffd||389||fffd|
' 2013/03/27 IE10 metoroIE|fffd||fffd||38f||6ca|O|fffd||389||fffd|
' 2013/05/29 1.71|fffd||fffd|1.72|fffd||fffd||fffd||fffd||fffd||1c9||fffd||fffd|A|fffd||6cc||c0c2||fffd|[|fffd|h|fffd||389||fffd|Proc|fffd||1c9||fffd| 1.80|fffd||fffd|
' 2014/04/23 waitForLaunch|fffd||316||7c2||fffd|l|fffd||fffd||7c2||fffd||fffd||fffd||fffd||fffd||fffd||312||1c9||fffd||fffd|AgetRunning|fffd|n|fffd||24a|m|fffd|F|fffd||fffd||fffd||fffd|IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd||60a4||fffd||255||3cd|X|fffd|AisMS1PC|fffd||303||fffd||fffd|O|fffd||fffd||3cd|X
' 2014/05/02 |fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||303|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd||fffd||fffd|startOf|fffd||fffd|endOf|fffd||fffd||1c9||fffd|
' 2014/05/28 getRunningIE|fffd||242||fffd||fffd||fffd||fffd||fffd|body.innerHTML|fffd||30e||64fe||fffd||fffd||fffd||fffd||fffd||fffd|On Error|fffd||14b||fffd||fffd||741|A|fffd||1cd||fffd||fffd||fffd||fffd||142||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|N|fffd||fffd||fffd||202||fffd||fffd||60a4||fffd||242||fffd||fffd||fffd|
' 2014/06/18 getLocalLogFilePath(|fffd||fffd||fffd|[|fffd|J|fffd||fffd||fffd||fffd||fffd|O|fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X|fffd||fffd||502||fffd|)|fffd||fffd||1c9||fffd|
' 2015/01/16 getRunningIE|fffd||242||fffd||fffd||fffd||fffd||fffd|body.innerHTML|fffd||30e||64fe||fffd||fffd||fffd||282||fffd|if|fffd||fffd||fffd||314||fffd||fffd||83c8||fffd||fffd||fffd||14e|g|fffd|p|fffd||fffd||fffd||fffd||fffd|Abody.innerHTML|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||302||14f|C|fffd||fffd|
' 2015/08/17 clickButton|fffd||fffd|clickAnchor|fffd||242||fffd||fffd||fffd||fffd||101|Ahtdoc.Script|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||302||141|Ahtdoc.parentWindow|fffd||24f|C|fffd||fffd|
' 2015/08/17 val|fffd||fffd|value|fffd||24f|C|fffd||fffd|(|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|)
' 2015/10/01 waitForBrowse|fffd||fffd||fffd|C|fffd||fffd|
' 2015/11/02 |fffd|u|fffd|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||342||fffd||fffd||142||243|X|fffd|P|fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|v|fffd||fffd||fffd||fffd||302||fffd||fffd||fffd|WaitForIEsShutDown|fffd||fffd||1c9||fffd||fffd|BInsteadCreateIE|fffd||254||fffd||fffd|f|fffd|B
' 2015/12/17 |fffd||53bca||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|AsynchronousClickElement|fffd||1c9||fffd||fffd|BClickButton|fffd||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||30e|w|fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||24d||c42c||fffd|B
' 2016/03/03 waitForBrowse|fffd||242||fffd|ie.ReadyState|fffd||fffd|3|fffd||302||702||715||3c9||fffd||fffd||fffd||fffd||202||fffd||fffd||8b||fffd||fffd||582||311||389||fffd||fffd||fffd||1c9||fffd|
' 2016/03/29 waitForBrowse|fffd||242||fffd|HTMLDocument.ReadyState|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||30e|b|fffd||fffd||389||fffd|
'/******************************************************************
' * |fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|c|fffd|[|fffd||fffd|EGG|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd| version 1.82  2016.5.20
' ******************************************************************/

Option Private Module
Option Explicit

'/*******************************************************
' * |fffd||fffd||fffd||297||fffd||fffd|p
' *******************************************************/
#If Win64 Then
'|fffd||482||fffd|
Public Declare PtrSafe Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
'|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd|{|fffd||fffd||fffd||fffd|GetTickCount64|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||302||702||702||153||fffd||fffd||fffd||fffd||fffd||fffd|B
'|fffd||fffd||fffd||fffd||fffd||fffd|49.7|fffd||fffd||fffd||242||fffd||fffd||fffd||fffd||fffd||60a4||fffd||20e|g|fffd|p|fffd||342||fffd||fffd||102||fffd||fffd||202||fffd||fffd|A|fffd||fffd||fffd||fffd||44f|C|fffd||fffd||fffd||348||342||fffd||fffd||fffd||fffd||fffd||fffd||202||90bd||fffd||7c2||fffd||fffd||302||702||702||315||fffd||fffd||fffd||fffd|H
Public Declare PtrSafe Function GetTickCount Lib "kernel32" () As Long
Public Declare PtrSafe Function timeGetTime Lib "winmm.dll" () As Long
'|fffd||fffd||fffd||fffd||fffd|I|fffd||24d||151|O|fffd||282||242||fffd||fffd||fffd||fffd||fffd|
Public Declare PtrSafe Function SetForegroundWindow Lib "user32" (ByVal hWnd As LongPtr) As Long
'|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
Public Declare PtrSafe Function IsIconic Lib "user32" (ByVal hWnd As LongPtr) As Long
'|fffd||fffd||fffd||303|T|fffd|C|fffd|Y|fffd||256||7c2||fffd|
Public Declare PtrSafe Function ShowWindowAsync Lib "user32" (ByVal hWnd As LongPtr, ByVal nCmdShow As Long) As Long
#Else
'|fffd||482||fffd|
Public Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)
'|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
Public Declare Function GetTickCount Lib "kernel32" () As Long
Public Declare Function timeGetTime Lib "winmm.dll" () As Long
'|fffd||fffd||fffd||fffd||fffd|I|fffd||24d||151|O|fffd||282||242||fffd||fffd||fffd||fffd||fffd|
Public Declare Function SetForegroundWindow Lib "user32" (ByVal hWnd As Long) As Long
'|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
Public Declare Function IsIconic Lib "user32" (ByVal hWnd As Long) As Long
'|fffd||fffd||fffd||303|T|fffd|C|fffd|Y|fffd||256||7c2||fffd|
Public Declare Function ShowWindowAsync Lib "user32" (ByVal hWnd As Long, ByVal nCmdShow As Long) As Long
#End If
Public Const SND_ASYNC = &H9    'RESTORE|fffd||312||8414|

'/*******************************************************
' * CommonUtil|fffd||598|A
' *******************************************************/
'|fffd||413||fffd||fffd||fffd||fffd||fffd|
Private Const MS1_DIR As String = "C:\kiban\ntapl"

'/*******************************************************
' * Log|fffd|o|fffd||34a||598|A
' *******************************************************/
Private LogFilePath As String
Private LogDebugPrint As Boolean

'/*******************************************************
' * IEUtil|fffd||598|A
' *******************************************************/
Public Enum WAIT_BROWSE_RESULT    'waitForBrowse|fffd||30e||fffd||fffd|s|fffd||fffd||fffd||282||fffd|\|fffd||fffd||fffd||7c2||fffd|l
    WAIT_SUCCEEDED = 0            'waiteForBrowse|fffd||30e||fffd||fffd||513||fffd||fffd||24c|J|fffd||fffd||502||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||316||7c2||fffd|l
    WAIT_TIMEOUT = 1              'waiteForBrowse|fffd||30f||fffd||fffd||fffd||30e||fffd||fffd||502||fffd||fffd|o|fffd||7c2||fffd||fffd||fffd||fffd||fffd||fffd||1c2||74d||fffd||fffd||742||fffd||fffd|I|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||316||7c2||fffd|l
    WINDOW_CLOSED = 2             'waiteForBrowse|fffd||311||38f||6c2||309||fffd||282||fffd||fffd||82||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||202||1c2||303|G|fffd||fffd||fffd|[|fffd||30e||fffd||fffd||316||7c2||fffd|l
End Enum
'|fffd||38f||6c3|]|fffd|[|fffd||fffd||fffd||312|l
Public Const ZONE_INET As String = "3"     '|fffd|C|fffd||fffd||fffd|^|fffd|l|fffd|b|fffd|g|fffd||303|]|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8414|
Public Const ZONE_TRUST As String = "2"    '|fffd|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd||303|]|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8414|
Public Const ZONE_INTRA As String = "1"    '|fffd|C|fffd||fffd||fffd|g|fffd||fffd||fffd|l|fffd|b|fffd|g|fffd||303|]|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8414|
Public Const ZONE_LOCAL As String = "0"    '|fffd||fffd||fffd|[|fffd|J|fffd||fffd||fffd||303|]|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||8414|
'|fffd||752||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||316||7c2||fffd|l
Private Const CONFIG_INVALIDARG As Integer = -1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||20f||a347||fffd||316||7c2||fffd|l
Private Const CONFIG_ABORTED As Integer = 0     '|fffd||fffd||fffd|f|fffd||fffd||fffd||fffd||fffd||a347||fffd||316||7c2||fffd|l
Private Const CONFIG_DONE As Integer = 1        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||316||7c2||fffd|l
Private Const CONFIG_ALREADY As Integer = 2     '|fffd||fffd||fffd||142||24e||fffd||fffd|{|fffd||3c2||742||30f||a347||fffd||316||7c2||fffd|l
'|fffd||fffd||28d||fffd||fffd||68e||fffd||fffd|
Public Const TXT As String = "TXT"                  '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd||142||fffd||fffd||90b1||fffd||182||fffd|\|fffd||fffd||fffd||8414|(|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||342||202||fffd|)
Public Const TXT_ONFOCUS As String = "TXT_ONFOCUS"  '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd||142||fffd||fffd||fffd|AonFocus|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const TXT_CHANGE As String = "TXT_CHANGE"    '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd||142||fffd||fffd||fffd|AonChange|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const TXT_ONBLUR As String = "TXT_ONBLUR"    '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd||142||fffd||fffd||fffd|AonBlur(|fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const PULLDOWN As String = "PULLDOWN"        '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||142||fffd||fffd||90b1||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const PULLDOWN_ONCHANGE As String = "PULLDOWN_ONCHANGE"  '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||142||fffd||fffd||fffd|AonChange|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const chk As String = "CHK"                  '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||142||fffd||fffd||90b1||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const CHK_CLICK  As String = "CHK_CLICK"     '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||142||fffd||fffd||fffd|A|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||242||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const RADIO As String = "RADIO"              '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||142||fffd||fffd||90b1||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const TEXTAREA As String = "TEXTAREA"        '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|G|fffd||fffd||fffd|A|fffd||142||fffd||fffd||90b1||fffd||182||fffd|\|fffd||fffd||fffd||8414|
Public Const TEXTAREA_ONBLUR As String = "TEXTAREA_ONBLUR"  '|fffd||fffd||fffd||342||30c|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|G|fffd||fffd||fffd|A|fffd||142||fffd||fffd||fffd|AonBlur|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||fffd|\|fffd||fffd||fffd||8414|
'|fffd|Z|fffd||fffd||fffd|N|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||195|\|fffd||fffd||fffd|l
Public Type OptionInfo  '|fffd|Z|fffd||fffd||fffd|N|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l|fffd||195|\|fffd||fffd||fffd|l|fffd||fffd|\|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
    Value As String     '|fffd|l
    Display As String   '|fffd|\|fffd||fffd||fffd|l
End Type
'|fffd||fffd||28d||fffd||fffd||68f||fffd||fffd|
Public Type ElementInfo     '|fffd||fffd||282||30d||fffd||fffd||682||303|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||fffd|\|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
    Id As String            'ID
    Name As String          'Name
    TypeOriginal As String  '|fffd|^|fffd|C|fffd|v
    TypeWithEvent As String '|fffd|C|fffd|x|fffd||fffd||fffd|g
    Options() As OptionInfo '|fffd|Z|fffd||fffd||fffd|N|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||312|l
    onClick As String       'onClick|fffd||fffd||fffd||313||fffd||fffd|e
    onChange As String      'onChange|fffd||fffd||fffd||313||fffd||fffd|e
    onBlur As String        'onBlur|fffd||fffd||fffd||313||fffd||fffd|e
    SearchKey As String     '|fffd||fffd||fffd||fffd||fffd||303|L|fffd|[(th,td|fffd||14e|g|fffd|p)
    Skip As Long            '|fffd||fffd||fffd||fffd||fffd||96||682||fffd||fffd||fffd|\|fffd||fffd|(th,td|fffd||14e|g|fffd|p)
    offset As Long          '|fffd||fffd||fffd||fffd||fffd||90||60a9||fffd||fffd|\|fffd||fffd|(th,td|fffd||14e|g|fffd|p)
    Value As String         '|fffd|l
End Type
'WaitForBrowse|fffd||fffd||fffd||fffd||598|A
'2015/10/01 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Enum WaitModeValue
'    Default = 0
'    RetryAndInterval = 1
'    BySecond = 2
'End Enum
'Private DefaultWaitMode As WaitModeValue
'Private defaultWaitMilliseconds As Long
'Private defaultWaitRetryCount As Long
'Private defaultWaitSilent As Boolean
'2015/10/01 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/10/16 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Enum WAIT_RETURN_MODE  'Wait|fffd||fffd||fffd|s|fffd||fffd||fffd||316||7c2||fffd||fffd|
    UNSPECIFIED = -1          '|fffd||fffd||fffd|w|fffd||fffd|iOptional|fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||314||fffd||fffd||fffd|p|fffd|B|fffd|g|fffd|p|fffd||58e|~|fffd|j
    MSG_ONLY = 0              'Msgbox|fffd||fffd|\|fffd||fffd||fffd||fffd|End|fffd||fffd||fffd||fffd|
    RETURN_RESULT = 1         '|fffd||fffd||fffd|s|fffd||fffd||fffd|e|fffd||fffd||502||fffd|
End Enum
Private initializedWaitSetting As Boolean             'waitForBrowse|fffd||752||fffd||3c2||743|t|fffd||fffd||fffd|O
Private defaultTimeOfTimeOut As Long                  '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
Private defaultWaitStartTime As Long                  '|fffd||482||fffd||fffd||c2bca|m|fffd|F|fffd|J|fffd|n|fffd||482||fffd||fffd||fffd||fffd||fffd|
Private defaultWaitReturnMode As WAIT_RETURN_MODE     '|fffd||482||fffd||fffd||c2bce||fffd||fffd|s|fffd||fffd||fffd|e|fffd||fffd||292|m|fffd||fffd||fffd||90a9|
Private defaultConsecutiveSuccessCnt As Long          '|fffd|w|fffd||80b5||fffd||fffd||fffd||50518|A|fffd||fffd||fffd||151||482||fffd||fffd||c2bca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||14a|m|fffd|F|fffd||fffd||fffd|J|fffd||fffd||502||fffd|
'2015/10/16 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private defaultTimeOfInteractiveTimeOut As Long
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|



'/*******************************************************
' * Registry|fffd||598|A
' *******************************************************/
Private Const ERROR_SUCCESS As Long = 0

Private Const REG_OPTION_NON_VOLATILE As Long = &H0
Private Const KEY_QUERY_VALUE As Long = &H1    ' |fffd|T|fffd|u|fffd|L|fffd|[|fffd|f|fffd|[|fffd|^|fffd||316||20a2||fffd||fffd||fffd||d0b9||fffd||fffd||fffd||fffd||fffd||a1|
Private Const KEY_ENUMERATE_SUB_KEYS As Long = &H8    ' |fffd|T|fffd|u|fffd|L|fffd|[|fffd||317||4b4c2||fffd||fffd||fffd||fffd||81|B
Private Const KEY_NOTIFY As Long = &H10   ' |fffd||3cd|X|fffd||312||292|m|fffd||fffd||fffd||fffd||fffd||a1|
Private Const KEY_CREATE_SUB_KEY As Long = &H4    ' |fffd|T|fffd|u|fffd|L|fffd|[|fffd||30d||c42c||fffd||fffd||fffd||fffd||fffd||a1|
Private Const KEY_CREATE_LINK As Long = &H20   ' |fffd|V|fffd||fffd||fffd|{|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|N|fffd||30d||c42c||fffd||fffd||fffd||fffd||fffd||a1|
Private Const KEY_SET_VALUE As Long = &H2    ' |fffd|T|fffd|u|fffd|L|fffd|[|fffd|f|fffd|[|fffd|^|fffd||310||752||fffd||fffd||fffd||fffd||fffd||a1|
Private Const KEY_ALL_ACCESS As Long = KEY_QUERY_VALUE Or KEY_ENUMERATE_SUB_KEYS Or KEY_NOTIFY Or KEY_CREATE_SUB_KEY Or KEY_CREATE_LINK Or KEY_SET_VALUE
Private Const KEY_READ As Long = KEY_QUERY_VALUE Or KEY_ENUMERATE_SUB_KEYS Or KEY_NOTIFY
Private Const KEY_WRITE As Long = KEY_SET_VALUE Or KEY_CREATE_SUB_KEY
#If Win64 Then
Private Type SECURITY_ATTRIBUTES
        nLength As Long
        lpSecurityDescriptor As LongPtr
        bInheritHandle As Long
End Type
'|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B|fffd|L|fffd|[|fffd||fffd||fffd||fffd||fffd||142||251||fffd||fffd||742||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||341|A|fffd||fffd||fffd||303|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
Private Declare PtrSafe Function RegCreateKeyEx Lib "advapi32" Alias "RegCreateKeyExA" (ByVal hKey As LongPtr, ByVal lpSubKey As String, ByVal Reserved As Long, ByVal lpClass As String, ByVal dwOptions As Long, ByVal samDesired As Long, lpSecurityAttributes As SECURITY_ATTRIBUTES, phkResult As LongPtr, lpdwDisposition As Long) As Long
'|fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90cc||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|L|fffd|[|fffd||312|l|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||241|A|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|B
Private Declare PtrSafe Function RegSetValueEx Lib "advapi32" Alias "RegSetValueExA" (ByVal hKey As LongPtr, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, lpData As Any, ByVal cbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
Private Declare PtrSafe Function RegOpenKeyEx Lib "advapi32" Alias "RegOpenKeyExA" (ByVal hKey As LongPtr, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As LongPtr) As Long
'|fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|L|fffd|[|fffd||24a||598|A|fffd|t|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|w|fffd||80b3||fffd||a0bd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B
Private Declare PtrSafe Function RegQueryValueEx Lib "advapi32" Alias "RegQueryValueExA" (ByVal hKey As LongPtr, ByVal lpValueName As String, ByVal lpReserved As LongPtr, lpType As Long, lpData As Any, lpcbData As Long) As Long         ' Note that if you declare the lpData parameter as String, you must pass it By Value.
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|B
Private Declare PtrSafe Function RegCloseKey Lib "advapi32" (ByVal hKey As LongPtr) As Long
'|fffd||d3dc|
Private Declare PtrSafe Function RegDeleteKey Lib "advapi32" Alias "RegDeleteKeyA" (ByVal hKey As LongPtr, ByVal lpSubKey As String) As Long
Private Declare PtrSafe Function RegDeleteValue Lib "advapi32" Alias "RegDeleteValueA" (ByVal hKey As LongPtr, ByVal lpValueName As String) As Long
#Else
Private Type SECURITY_ATTRIBUTES
    nLength As Long
    lpSecurityDescriptor As Long
    bInheritHandle As Long
End Type
'|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|B|fffd|L|fffd|[|fffd||fffd||fffd||fffd||fffd||142||251||fffd||fffd||742||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||341|A|fffd||fffd||fffd||303|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
Private Declare Function RegCreateKeyEx Lib "advapi32" Alias "RegCreateKeyExA" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal Reserved As Long, ByVal lpClass As String, ByVal dwOptions As Long, ByVal samDesired As Long, lpSecurityAttributes As SECURITY_ATTRIBUTES, phkResult As Long, lpdwDisposition As Long) As Long
'|fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90cc||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd|L|fffd|[|fffd||312|l|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||241|A|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|B
Private Declare Function RegSetValueEx Lib "advapi32" Alias "RegSetValueExA" (ByVal hKey As Long, ByVal lpValueName As String, ByVal Reserved As Long, ByVal dwType As Long, szData As Any, ByVal cbData As Long) As Long
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
Private Declare Function RegOpenKeyEx Lib "advapi32" Alias "RegOpenKeyExA" (ByVal hKey As Long, ByVal lpSubKey As String, ByVal ulOptions As Long, ByVal samDesired As Long, phkResult As Long) As Long
'|fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||a0bd||fffd|L|fffd|[|fffd||24a||598|A|fffd|t|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|w|fffd||80b3||fffd||a0bd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|B
Private Declare Function RegQueryValueEx Lib "advapi32" Alias "RegQueryValueExA" (ByVal hKey As Long, ByVal lpValueName As String, ByVal lpReserved As Long, lpType As Long, lpData As Any, lpcbData As Long) As Long
'|fffd|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|B
Private Declare Function RegCloseKey Lib "advapi32" (ByVal hKey As Long) As Long
'|fffd||d3dc|
Private Declare Function RegDeleteKey Lib "advapi32" Alias "RegDeleteKeyA" (ByVal hKey&, ByVal lpSubKey$) As Long
Private Declare Function RegDeleteValue Lib "advapi32.dll" Alias "RegDeleteValueA" (ByVal hKey As Long, ByVal lpValueName As String) As Long
#End If
Public Enum hKeyConst
    HKEY_CLASSES_ROOT = &H80000000
    HKEY_CURRENT_USER = &H80000001
    HKEY_LOCAL_MACHINE = &H80000002
    HKEY_USERS = &H80000003
    HKEY_PERFORMANCE_DATA = &H80000004
    HKEY_CURRENT_CONFIG = &H80000005
    HKEY_DYN_DATA = &H80000006
End Enum
'DWORD|fffd|^|fffd||303|^|fffd|C|fffd|v
Public Enum TypeConst
    REG_NONE = (0)                         ' |fffd||fffd|`|fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|
    REG_SZ = (1)                           ' NULL |fffd||14f|I|fffd||fffd||9576||fffd||fffd||fffd||fffd|
    REG_EXPAND_SZ = (2)                    ' |fffd|W|fffd|J|fffd|O|fffd||30a||8b||fffd||fffd||3d0||fffd||fffd||582||30e|Q|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| NULL |fffd||14f|I|fffd||fffd||9576||fffd||fffd||fffd||fffd|
    REG_BINARY = (3)                       ' |fffd|C|fffd||4c2||30c|`|fffd||fffd||fffd||303|o|fffd|C|fffd|i|fffd||fffd||fffd|f|fffd|[|fffd|^
    REG_DWORD = (4)                        ' 32 |fffd|r|fffd|b|fffd|g|fffd|l
    REG_DWORD_LITTLE_ENDIAN = (4)          ' |fffd||fffd||fffd|g|fffd||fffd||fffd|G|fffd||fffd||fffd|f|fffd|B|fffd|A|fffd||fffd||fffd|`|fffd||fffd||fffd||fffd| 32 |fffd|r|fffd|b|fffd|g|fffd|l
    REG_DWORD_BIG_ENDIAN = (5)             ' |fffd|r|fffd|b|fffd|O|fffd|G|fffd||fffd||fffd|f|fffd|B|fffd|A|fffd||fffd||fffd|`|fffd||fffd||fffd||fffd| 32 |fffd|r|fffd|b|fffd|g|fffd|l
    REG_LINK = (6)                         ' Unicode |fffd||303|V|fffd||fffd||fffd|{|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|N
    REG_MULTI_SZ = (7)                     ' NULL |fffd||14f|I|fffd||fffd||9576||fffd||fffd||fffd||fffd||314|z|fffd||fffd|
    REG_RESOURCE_LIST = (8)                ' |fffd|f|fffd|o|fffd|C|fffd|X|fffd|h|fffd||fffd||fffd|C|fffd|o|fffd||303||fffd||fffd|\|fffd|[|fffd|X|fffd||fffd||fffd|X|fffd|g
End Enum

'/*******************************************************
' * ScreenShot|fffd||598|A
' *******************************************************/
Private Const vbSrcCopy = 13369376
Private Const vbPicTypeBitmap = 1
Private Type PALETTEENTRY
    peRed As Byte
    peGreen As Byte
    peBlue As Byte
    peFlags As Byte
End Type
Private Type LOGPALETTE
    palVersion As Integer
    palNumEntries As Integer
    palPalEntry(255) As PALETTEENTRY  ' Enough for 256 colors.
End Type
Private Type GUID
    Data1 As Long
    Data2 As Integer
    Data3 As Integer
    Data4(7) As Byte
End Type
Private Const RASTERCAPS As Long = 38
Private Const RC_PALETTE As Long = &H100
Private Const SIZEPALETTE As Long = 104
Private Type RECT
    Left As Long
    Top As Long
    Right As Long
    Bottom As Long
End Type
#If Win64 Then
Private Declare PtrSafe Function GetSystemMetrics Lib "user32" (ByVal nIndex As Long) As Long
Private Declare PtrSafe Function CreateCompatibleDC Lib "GDI32" (ByVal hDC As LongPtr) As LongPtr
Private Declare PtrSafe Function CreateCompatibleBitmap Lib "GDI32" (ByVal hDC As LongPtr, ByVal nWidth As Long, ByVal nHeight As Long) As LongPtr
Private Declare PtrSafe Function GetDeviceCaps Lib "GDI32" (ByVal hDC As LongPtr, ByVal nIndex As Long) As Long
Private Declare PtrSafe Function GetSystemPaletteEntries Lib "GDI32" (ByVal hDC As LongPtr, ByVal wStartIndex As Long, ByVal wNumEntries As Long, lpPaletteEntries As PALETTEENTRY) As Long
Private Declare PtrSafe Function CreatePalette Lib "GDI32" (lpLogPalette As LOGPALETTE) As LongPtr
Private Declare PtrSafe Function SelectObject Lib "GDI32" (ByVal hDC As LongPtr, ByVal hObject As LongPtr) As LongPtr
Private Declare PtrSafe Function BitBlt Lib "GDI32" (ByVal hDestDC As LongPtr, ByVal X As Long, ByVal Y As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hSrcDC As LongPtr, ByVal XSrc As Long, ByVal YSrc As Long, ByVal dwRop As Long) As Long
Private Declare PtrSafe Function DeleteDC Lib "GDI32" (ByVal hDC As LongPtr) As Long
Private Declare PtrSafe Function GetForegroundWindow Lib "user32" () As LongPtr
Private Declare PtrSafe Function SelectPalette Lib "GDI32" (ByVal hDC As LongPtr, ByVal hPalette As LongPtr, ByVal bForceBackground As Long) As LongPtr
Private Declare PtrSafe Function RealizePalette Lib "GDI32" (ByVal hDC As LongPtr) As Long
Private Declare PtrSafe Function GetWindowDC Lib "user32" (ByVal hWnd As LongPtr) As LongPtr
Private Declare PtrSafe Function GetDC Lib "user32" (ByVal hWnd As LongPtr) As LongPtr
Private Declare PtrSafe Function GetWindowRect Lib "user32" (ByVal hWnd As LongPtr, lpRect As RECT) As Long
Private Declare PtrSafe Function ReleaseDC Lib "user32" (ByVal hWnd As LongPtr, ByVal hDC As LongPtr) As Long
Private Declare PtrSafe Function GetDesktopWindow Lib "user32" () As LongPtr
Private Type PicBmp
   size As Long
   Type As Long
   hBmp As LongPtr
   hPal As LongPtr
   Reserved As LongPtr
End Type
Private Declare PtrSafe Function OleCreatePictureIndirect Lib "oleaut32.dll" (PicDesc As PicBmp, RefIID As GUID, ByVal fPictureOwnsHandle As LongPtr, IPic As IPicture) As LongPtr
#Else
Private Declare Function GetSystemMetrics Lib "user32" (ByVal nIndex As Long) As Long
Private Declare Function CreateCompatibleDC Lib "GDI32" (ByVal hDC As Long) As Long
Private Declare Function CreateCompatibleBitmap Lib "GDI32" (ByVal hDC As Long, ByVal nWidth As Long, ByVal nHeight As Long) As Long
Private Declare Function GetDeviceCaps Lib "GDI32" (ByVal hDC As Long, ByVal iCapabilitiy As Long) As Long
Private Declare Function GetSystemPaletteEntries Lib "GDI32" (ByVal hDC As Long, ByVal wStartIndex As Long, ByVal wNumEntries As Long, lpPaletteEntries As PALETTEENTRY) As Long
Private Declare Function CreatePalette Lib "GDI32" (lpLogPalette As LOGPALETTE) As Long
Private Declare Function SelectObject Lib "GDI32" (ByVal hDC As Long, ByVal hObject As Long) As Long
Private Declare Function BitBlt Lib "GDI32" (ByVal hDCDest As Long, ByVal XDest As Long, ByVal YDest As Long, ByVal nWidth As Long, ByVal nHeight As Long, ByVal hDCSrc As Long, ByVal XSrc As Long, ByVal YSrc As Long, ByVal dwRop As Long) As Long
Private Declare Function DeleteDC Lib "GDI32" (ByVal hDC As Long) As Long
Private Declare Function GetForegroundWindow Lib "user32" () As Long
Private Declare Function SelectPalette Lib "GDI32" (ByVal hDC As Long, ByVal hPalette As Long, ByVal bForceBackground As Long) As Long
Private Declare Function RealizePalette Lib "GDI32" (ByVal hDC As Long) As Long
Private Declare Function GetWindowDC Lib "user32" (ByVal hWnd As Long) As Long
Private Declare Function GetDC Lib "user32" (ByVal hWnd As Long) As Long
Private Declare Function GetWindowRect Lib "user32" (ByVal hWnd As Long, lpRect As RECT) As Long
Private Declare Function ReleaseDC Lib "user32" (ByVal hWnd As Long, ByVal hDC As Long) As Long
Private Declare Function GetDesktopWindow Lib "user32" () As Long
Private Type PicBmp
   size As Long
   Type As Long
   hBmp As Long
   hPal As Long
   Reserved As Long
End Type
Private Declare Function OleCreatePictureIndirect Lib "olepro32.dll" (PicDesc As PicBmp, RefIID As GUID, ByVal fPictureOwnsHandle As Long, IPic As IPicture) As Long
#End If
'/*******************************************************
' * ServerLog|fffd||598|A
' *******************************************************/
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||291|J|fffd||694|p|fffd|~
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||a39f||fffd||fffd||297|p|fffd|t|fffd|q|fffd|k
'Private InitURL As String
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
Private LoggerURL As String
Private BasicAuthHeaderCache As String
Public Type ServerLogRequest    '|fffd|T|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|O|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||30d|\|fffd||fffd||fffd||fffd|
    key As String
    val As String
End Type

'/*******************************************************
' * ServerUtil|fffd||598|A
' *******************************************************/
Public Type VersionStatus   '|fffd||fffd||fffd|Y|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||30f||fffd||50f||fffd||fffd|
    IsAvailable As Boolean
    flags As String
    Description As String
    message As String
    TransactionInterval As Long
End Type
Public Type DownloadRequest '|fffd|f|fffd|[|fffd|^|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|hCGI|fffd||582||308||fffd||fffd||fffd|
    key As String
    val As String
End Type


'/*******************************************************
' * WindowUtil|fffd||598|A
' *******************************************************/
#If Win64 Then
'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
Declare PtrSafe Function FindWindow Lib "user32" Alias "FindWindowA" _
            (ByVal lpClassName As String, _
             ByVal lpWindowName As String) As LongPtr

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||64fe|
Declare PtrSafe Function getClassName Lib "user32" Alias "GetClassNameA" _
            (ByVal hWnd As LongPtr, ByVal lpClassName As String, _
             ByVal nMaxCount As Long) As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe|
Declare PtrSafe Function GetWindow Lib "user32" (ByVal hWnd As LongPtr, ByVal wFlag As Long) As LongPtr

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||64fe|
Declare PtrSafe Function GetWindowText Lib "user32" Alias "GetWindowTextA" (ByVal hWnd As LongPtr, ByVal lpString As String, ByVal cch As Long) As Long

'|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd|ID|fffd||64fe|
Declare PtrSafe Function GetDlgCtrlID Lib "user32" (ByVal hWnd As LongPtr) As Long
#Else
'|fffd|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
'Declare Function GetDesktopWindow Lib "user32.dll" () As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
Declare Function FindWindow Lib "user32.dll" Alias "FindWindowA" _
        (ByVal lpClassName As String, _
         ByVal lpWindowName As String) As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||64fe|
Declare Function getClassName Lib "user32" Alias "GetClassNameA" _
        (ByVal hWnd As Long, ByVal lpClassName As String, _
         ByVal nMaxCount As Long) As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe|
Declare Function GetWindow Lib "user32.dll" _
        (ByVal hWnd As Long, ByVal uCmd As Long) As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||64fe|
Declare Function GetWindowText Lib "user32" Alias "GetWindowTextA" _
        (ByVal hWnd As Long, ByVal lpString As String, ByVal cch As Long) As Long

'|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd|ID|fffd||64fe|
Declare Function GetDlgCtrlID Lib "user32" (ByVal hWnd As Long) As Long
#End If

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||64fe||fffd||312||8414||fffd|l
Private Const GW_HWNDNEXT = 2
Private Const GW_HWNDPREV = 2
Private Const GW_HWNDOWNER = 4
Private Const GW_HWNDCHILD = 5

'UUID
Private Type UUID
    Data1 As Long
    Data2 As Integer
    Data3 As Integer
    Data4(7) As Byte
End Type

#If Win64 Then
Declare PtrSafe Function RegisterWindowMessage Lib "user32" Alias "RegisterWindowMessageA" _
    (ByVal lpString As String) As Long

Declare PtrSafe Function SendMessageTimeout Lib "user32" Alias "SendMessageTimeoutA" _
    (ByVal hWnd As LongPtr, ByVal msg As Long, ByVal wParam As LongPtr, ByVal lParam As LongPtr, _
    ByVal fuFlags As Long, ByVal uTimeout As Long, lpdwResult As LongPtr) As LongPtr

Private Declare PtrSafe Function ObjectFromLresult Lib "oleacc" _
    (ByVal lResult As LongPtr, riid As Any, _
     ByVal wParam As LongPtr, ppvObject As Any) As Long
#Else
Declare Function RegisterWindowMessage Lib "user32.dll" Alias "RegisterWindowMessageA" _
    (ByVal lpString As String) As Long

Declare Function SendMessageTimeout Lib "user32.dll" Alias "SendMessageTimeoutA" _
    (ByVal hWnd As Long, ByVal msg As Long, ByVal wParam As Long, ByVal lParam As Long, _
    ByVal fuFlags As Long, ByVal uTimeout As Long, lpdwResult As Long) As Long

Private Declare Function ObjectFromLresult Lib "oleacc" _
    (ByVal lResult As Long, riid As Any, _
     ByVal wParam As Long, ppvObject As Any) As Long
#End If

Private Const SMTO_ABORTIFHUNG = &H2

#If Win64 Then
'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||fffd||fffd||fffd|)
Public Declare PtrSafe Function SendMessage Lib "user32" Alias "SendMessageA" _
        (ByVal hWnd As LongPtr, ByVal wMsg As Long, _
        ByVal wParam As LongPtr, lParam As Any) As LongPtr
'|fffd||fffd|GetText|fffd|p|fffd||255||296||fffd||fffd||152||1c9||fffd||fffd|i32bit|fffd||142||353||fffd||fffd||fffd||fffd||fffd|`|fffd||14e|g|fffd||fffd||fffd||fffd||fffd|j
Public Declare PtrSafe Function SendGetTextLen Lib "user32.dll" Alias "SendMessageA" _
        (ByVal hWnd As LongPtr, ByVal msg As Long, _
        ByVal wParam As LongLong, ByVal lParam As Any) As LongLong

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||53bca||fffd|)
Public Declare PtrSafe Function PostMessage Lib "user32" Alias "PostMessageA" _
        (ByVal hWnd As LongPtr, ByVal wMsg As Long, _
        ByVal wParam As LongPtr, ByVal lParam As LongPtr) As Long

#Else
'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||fffd||fffd||fffd|)
Public Declare Function SendMessage Lib "user32.dll" Alias "SendMessageA" _
        (ByVal hWnd As Long, ByVal msg As Long, _
        ByVal wParam As Long, ByVal lParam As Any) As Long

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||115c2||fffd|(|fffd||53bca||fffd|)
Public Declare Function PostMessage Lib "user32" Alias "PostMessageA" _
        (ByVal hWnd As Long, ByVal wMsg As Long, _
        ByVal wParam As Long, ByVal lParam As Long) As Long
#End If

'SendMessage/PostMessage|fffd|p|fffd||8414|
Public Const WM_ACTIVATE = &H6
Public Const WM_CHAR As Long = &H102
Public Const WM_COMMAND As Long = &H111
Public Const WM_HOTKEY As Long = &H312
Public Const WM_CLOSE As Long = &H10
Public Const BM_CLICK As Long = &HF5
Public Const BM_SETCHECK = &HF1
Public Const BST_CHECKED As Long = &H1
Public Const BST_UNCHECKED As Long = &H0
Public Const WM_CUT = &H300

Private Const WM_IME_CHAR = &H286    '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|M
Private Const WM_SETTEXT = &HC       '|fffd||fffd||fffd||fffd||fffd||515d0|M
Private Const WM_GETTEXT = &HD       '|fffd||fffd||fffd||fffd||fffd||fffd||64fe|
Private Const WM_GETTEXTLEN = &HE    '|fffd||fffd||fffd||fffd||fffd||52dce||64fe|
'Private Const WM_CHAR = &H102        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|M

'|fffd|R|fffd||fffd||fffd|{|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|
Private Const CB_SETCURSEL = &H14E
Private Const CB_GETCURSEL = &H147

'|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|
Private Const BM_GETCHECK = &HF0
'Private Const BM_SETCHECK = &HF1
Private Const BM_GETSTATE = &HF2
Private Const BM_SETSTATE = &HF3


'|fffd||fffd||fffd|s|fffd|G|fffd|X|fffd|P|fffd|[|fffd|v|fffd|p
Public Const CHAR_VBCRLF As String = "CHAR_VBCRLF"

#If Win64 Then
Private Declare PtrSafe Function SetWindowPos Lib "user32" (ByVal hWnd As LongPtr, ByVal hWndInsertAfter As LongPtr, _
        ByVal X As Long, ByVal Y As Long, _
        ByVal cx As Long, ByVal cy As Long, _
        ByVal wFlags As Long) As Long
#Else
Private Declare Function SetWindowPos Lib "user32" (ByVal hWnd As Long, ByVal hWndInsertAfter As Long, _
        ByVal X As Long, ByVal Y As Long, _
         ByVal cx As Long, ByVal cy As Long, _
        ByVal wFlags As Long) As Long
#End If
 Private Const walways = -1 '|fffd||fffd||24e||fffd|O|fffd||243|Z|fffd|b|fffd|g
 Private Const wreset = -2  '|fffd||fffd||fffd||fffd|
 Private Const wdisp = &H40 '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|
 Private Const w_SIZE = &H1 '|fffd|T|fffd|C|fffd|Y|fffd||fffd||752||80b5||fffd||202||fffd|
 Private Const w_MOVE = &H2 '|fffd||292|u|fffd||fffd||752||80b5||fffd||202||fffd|
 
 
#If Win64 Then
Public Type ControlInfo
    hWnd As LongPtr
    caption As String
    className As String
    controlID As Long
    depth As Long
    valueText As String
End Type
#Else
Public Type ControlInfo
    hWnd As Long
    caption As String
    className As String
    controlID As Long
    depth As Long
    valueText As String
End Type
#End If

'/*******************************************************
' * |fffd||6cc||c0c2||fffd|[|fffd|h|fffd|L|fffd||fffd||fffd||389||fffd|
' *******************************************************/
#If Win64 Then
'|fffd|w|fffd||fffd|URL|fffd||fffd||fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd||fffd|B
Private Declare PtrSafe Function IEIsProtectedModeURL Lib "Ieframe.dll" (ByVal pszUrl As String) As Long
'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||64fe|
Private Declare PtrSafe Function GetTempPath Lib "kernel32" Alias "GetTempPathA" (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long
#Else
'|fffd|w|fffd||fffd|URL|fffd||fffd||fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd||fffd|B
Private Declare Function IEIsProtectedModeURL Lib "Ieframe.dll" (ByVal pszUrl As String) As Long
'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||64fe|
Private Declare Function GetTempPath Lib "kernel32" Alias "GetTempPathA" (ByVal nBufferLength As Long, ByVal lpBuffer As String) As Long
#End If

'IEIsProtectedModeURL|fffd||8414|
Private Const S_OK = &H0                            ' Success
Private Const S_FALSE = &H1                         ' The Folder is valid, but does not exist
Private Const E_INVALIDARG = &H80070057             ' Invalid CSIDL Value

'|fffd|N|fffd||fffd||fffd|X|fffd|h|fffd|c|fffd||fffd|`
Private Const CLS_LOW = "{0002DF01-0000-0000-C000-000000000046}"            'Low
Private Const CLS_MDM = "{D5E8041D-920F-45e9-B8FB-B1DEB82C6E5E}"            'Medium

'|fffd||152||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
Private Const VBS_FILE = "ie32execute.vbs"
Private Const HANDLE_FILE = "ie32handle.tmp"
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Const ERR_FILE = "ie32err.tmp"
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'|fffd|V|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|C|fffd|}|fffd|[
Private Const SHELL_WAIT_TIME = 20000

'/*******************************************************
' * CommonUtil|fffd||598|A
' *******************************************************/

'|fffd||fffd|Excel|fffd||2d1||fffd|
'OS|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd|iXP=Windows (32-bit) NT 5.01 / Vista=Windows (32-bit) NT 6.00 / 7=Windows (32-bit) NT 6.01 / 8=Windows (32-bit) NT 6.02 |fffd|j|fffd|@|fffd||fffd|32-bit|fffd||fffd|64bit|fffd||8b||fffd||fffd||242||fffd||fffd||fffd||115||3cd|X
Public Function getOSVersion() As String
    On Error Resume Next
    getOSVersion = Application.OperatingSystem
    On Error GoTo 0
End Function

'|fffd||fffd|Excel|fffd||2d1||fffd|
'Excel|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd|i2003=11.0 / 2007=12.0 / 2010=14.0 / 2013=15.0 / 2016=16.0|fffd|j
Public Function getExcelVersion()
    On Error Resume Next
    getExcelVersion = Application.Version
    On Error GoTo 0
End Function

'IE|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|m|fffd|F
Public Function getIEVersion()
    Dim iePath As String
    
    On Error Resume Next
    Dim ie As New InternetExplorer
    iePath = ie.FullName
    ie.Quit
    Set ie = Nothing
    
    Dim FSO As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    Dim iever As String
    iever = FSO.GetFileVersion(iePath)
    On Error GoTo 0
    
    getIEVersion = iever
End Function

'|fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd||fffd||64fe||fffd|iMS1PC|fffd||302||182||fffd||fffd||302||753||fffd||fffd||c0b3||fffd||fffd||fffd||fffd|j
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Function getUserName() As String
'    If isMS1PC Then
'        getUserName = Environ("USERNAME")
'    Else
'        getUserName = ""
'    End If
'End Function
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||315||3cd|X
Public Function getPCUserID() As String
    If isMS1PC Then
        getPCUserID = Environ("USERNAME")
    Else
        getPCUserID = ""
    End If
End Function
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'|fffd|G|fffd||fffd||fffd|[|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|i|fffd||fffd||fffd|O|fffd|o|fffd||341|j
Public Sub handleError(ByRef er As ErrObject, Optional Id As String)
    If er.Number <> 0 Then
        Log "|fffd|G|fffd||fffd||fffd|[|fffd|F[" & er.Number & "]" & er.Description & " (" & Id & ")"
    End If
End Sub

'MS1PC|fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||30a|m|fffd|F
Public Function isMS1PC() As Boolean
    Dim ret As Boolean
    Dim dir_result As String
    'MS1PC|fffd||255|K|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd||fffd||fffd||fffd||757|L|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    On Error Resume Next
    dir_result = Trim(Dir(MS1_DIR, vbDirectory))
    On Error GoTo 0
    '|fffd||fffd||fffd||742||fffd||fffd||fffd||a347||fffd||fffd|True|fffd||fffd||502||fffd||fffd|i|fffd||fffd|MS1PC|fffd||194||fffd||fffd||fffd|j
    '|fffd||fffd|MS1PC|fffd||142||342||202||fffd||fffd||194||fffd||fffd||282||fffd||fffd||fffd||fffd||182||fffd||fffd|A|fffd||35dd||fffd|X|fffd||243||fffd||fffd|O|fffd|o|fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd|Z|fffd|p|fffd||482||fffd||fffd||fffd||fffd||fffd||fffd||d0a9||fffd||fffd||60a4||fffd||203||fffd||fffd|O
    If dir_result <> "" Then
        Log "MS1PC"
        ret = True
    Else
        Log "not MS1PC"
        ret = False
    End If
    isMS1PC = ret
End Function

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||151|O|fffd||295|\|fffd||fffd|
#If Win64 Then
Public Sub showForeground(hWnd As LongPtr)
#Else
Public Sub showForeground(hWnd As Long)
#End If
    startOf "showForeground"
    '|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34c||fffd||fffd||256||7c2||fffd|
    If IsIconic(hWnd) Then
        ShowWindowAsync hWnd, SND_ASYNC
    End If
    '|fffd||151|O|fffd||295|\|fffd||fffd|
    SetForegroundWindow hWnd
    endOf "showForeground"
End Sub

'ZIP|fffd||fffd||fffd|k|fffd||fffd||fffd||fffd|
Public Sub compressZip(zipFile As String, ParamArray files() As Variant)
    startOf "compressZip"

    Dim FSO As Object
    Dim Shell As Object
    Dim zFolder As Object
    Dim path As Variant
    Dim fileName As String
    Dim sFolderItem As Object
    Dim zFolderItem As Object
    Dim count As Long
    
    Log "|fffd||fffd||fffd|k|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    Set FSO = CreateObject("Scripting.FileSystemObject")
    FSO.CreateTextFile(zipFile, True).write "PK" & Chr(5) & Chr(6) & String(18, 0)
    Set Shell = CreateObject("Shell.Application")
    Set zFolder = Shell.Namespace(FSO.GetAbsolutePathName(zipFile))
    
    Log "|fffd||fffd||fffd|k|fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
    For Each path In files
        Log "|fffd||fffd||fffd|k|fffd||38f||6c1|F" & path
        fileName = FSO.getFileName(path)
        'Win7|fffd||342||fffd||fffd||fffd|
        Set sFolderItem = Shell.Namespace(FSO.GetAbsolutePathName(FSO.GetParentFolderName(path))).ParseName(fileName)
        Do
            Set zFolderItem = zFolder.ParseName(fileName)
            If zFolderItem Is Nothing Then
                count = zFolder.items().count
                zFolder.CopyHere sFolderItem
                Do While zFolder.items().count = count
                    Application.Wait Now + TimeSerial(0, 0, 1)
                    DoEvents
                    '|fffd||fffd|zFolder|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd|Items().Count|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd||312|l|fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd||202||fffd||fffd|P|fffd|[|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd|
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||7c8||fffd|UNothing|fffd||fffd||fffd||102||fffd||fffd||fffd||10e||64fe||fffd||fffd||fffd||fffd||fffd||93c8||fffd||fffd||fffd||fffd||1c9||fffd||fffd|i20120221|fffd||fffd||fffd||fffd||fffd|j
                    Set zFolder = Nothing
                    Set zFolder = Shell.Namespace(FSO.GetAbsolutePathName(zipFile))
                Loop
                '|fffd||fffd|zip|fffd||c42c||fffd||fffd||fffd|xml|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||93c8||fffd||fffd||fffd||fffd||1c9||fffd||fffd|i20120221|fffd||fffd||fffd||fffd||fffd|j
                If Dir(sFolderItem.path) <> "" Then
                    Kill sFolderItem.path
                End If
                Exit Do
            Else
                If Dir(zFolderItem.path) <> "" Then
                    Kill zFolderItem.path
                End If
            End If
        Loop
        DoEvents
    Next
    
    endOf "compressZip"
End Sub

'|fffd||fffd|z|fffd||54ed2||fffd|
Public Function isEmptyArray(ary As Variant) As Boolean
    startOf "isEmptyArray"
    
    Dim temp As Long
    On Error Resume Next
    '|fffd|z|fffd||52dc2||30e||64fe||fffd||fffd||fffd||fffd||fffd||742||fffd|
    temp = UBound(ary)
    '|fffd||fffd||fffd|Y|fffd||fffd||fffd||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd||fffd||7d1||fffd|
    temp = Err.Number
    On Error GoTo 0
    
    '|fffd|G|fffd||fffd||fffd|[|fffd||50d||fffd||fffd||fffd|0|fffd||20a|O|fffd||302||182||fffd|True=|fffd||fffd|z|fffd||fffd|
    If temp <> 0 Then
        isEmptyArray = True
    Else
        isEmptyArray = False
    End If

    endOf "isEmptyArray"
End Function

'|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|J|fffd||fffd||fffd||103|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd||64fe||fffd|i|fffd|t|fffd|B|fffd||fffd||fffd|^|fffd||202||fffd||fffd|j1.72
Public Function getFilePathByDialog(Title As String) As String
    startOf "getFilePathByDialog"
    
    Dim filePath As String
    filePath = Application.GetOpenFilename(, , Title, False)
    If filePath = "False" Then
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cb||d5d8e||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||702||fffd|"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ExitOf "getFilePathByDialog", "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cb||d5d8e||fffd||fffd||fffd||fffd||50b|p|fffd||fffd||fffd||702||fffd|"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        getFilePathByDialog = ""
        Exit Function
    End If
    getFilePathByDialog = filePath
    
    endOf "getFilePathByDialog"
End Function


'|fffd||fffd||fffd|[|fffd|N|fffd|u|fffd|b|fffd|N|fffd||303|p|fffd|X|fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd||fffd|\|fffd|t|fffd|^|fffd||2433||fffd||82||fffd||fffd|j1.72
Public Function getAppPath() As String
    startOf "getAppPath"
    Dim path As String
    path = ThisWorkbook.path
    If Right(path, 1) <> "\" Then path = path & "\"
    getAppPath = path
    endOf "getAppPath"
End Function


'/*******************************************************
' * Crypter|fffd||598|A
' *******************************************************/

'|fffd||cd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function Crypt(plain As String, Optional Key0 As String) As String
    startOf "crypt"
    Dim lenPlain As Long
    Dim key As String
    Dim a() As String
    Dim i As Long
    
   '|fffd||cd||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|o
    lenPlain = Len(plain)
    ReDim a(1 To lenPlain) As String

    '|fffd|L|fffd|[|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd| ex msad0606
    If Key0 = "" Then Key0 = "msad" & Format(Date, "MMDD")
    key = GetDicKey(Key0, lenPlain)
    
    '|fffd||fffd||fffd||fffd||fffd||183|J|fffd|M|fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|XOR|fffd||fffd||fffd|Z|fffd||fffd|16|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
    For i = 1 To lenPlain
        a(i) = Hex(Asc(Mid(plain, i, 1)) Xor Asc(Mid(key, i, 1)))
        If Len(a(i)) = 1 Then a(i) = "0" & a(i)
    Next i
    
    Crypt = Replace(Join(a()), " ", "")
    endOf "crypt"
End Function

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function Decrypt(Crypt As String, Optional Key0 As String) As String
    startOf "decrypt"
    Dim i As Long
    Dim a As Variant
    Dim key As String
    Dim plain() As String
    Dim lenCrypt As Long
    
    '|fffd||cd||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|o
    lenCrypt = Len(Crypt) / 2
    ReDim plain(1 To lenCrypt) As String
    ReDim a(1 To lenCrypt) As String
    For i = 1 To lenCrypt
        a(i) = Mid(Crypt, (i - 1) * 2 + 1, 2)
    Next i
    
    '|fffd|L|fffd|[|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd||fffd| ex msad0606
    If Key0 = "" Then Key0 = "msad" & Format(Date, "MMDD")
    key = GetDicKey(Key0, lenCrypt)
    
    '|fffd||cd||fffd||fffd||fffd||fffd||183|J|fffd|M|fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|XOR|fffd||fffd||fffd|Z|fffd||fffd|16|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
    For i = 1 To lenCrypt
        plain(i) = Chr(CLng("&H" & a(i)) Xor Asc(Mid(key, i, 1)))
    Next i
    
    Decrypt = Replace(Join(plain()), " ", "")
    
    endOf "decrypt"
End Function

'|fffd||cd||fffd||fffd||fffd||fffd|L|fffd|[|fffd||30e||64fe|
Private Function GetDicKey(key As String, lenA As Long) As String
    Dim i As Long
    '|fffd||fffd||fffd||fffd|Key|fffd||fffd||fffd|Z|fffd||fffd||fffd||a347||fffd||254||fffd||fffd||fffd||fffd||fffd|
    key = Mid(key, 1, lenA)
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||cd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|J|fffd||fffd||502||fffd||fffd|A|fffd||fffd|
    Do Until Len(key) = lenA
        i = i + 1
        key = key & Mid(key, i, 1)
    Loop
    GetDicKey = key
End Function


'/*******************************************************
' * CSVUtil|fffd||598|A
' *******************************************************/

'|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||fffd|CSV|fffd||255||3ca||fffd||fffd||fffd||fffd||115||6d1||fffd|
Public Sub saveDataElementsToFile(data() As Variant, filePath As String, Optional ElementDelimiter As String, Optional ElementQuotation As String, Optional WithoutHeader As Boolean)
    startOf "saveDataElementsToFile"
    
    Dim Header() As String
    Dim HeaderForPrint() As String
    Dim DataBody As String
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    '|fffd|N|fffd|I|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||202||fffd||fffd|j
    Dim quot As String
    If Len(ElementQuotation) > 0 Then
        quot = ElementQuotation
    Else
        quot = ""
    End If
    
    '|fffd|w|fffd|b|fffd|_|fffd||10d90||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd|
    If Not WithoutHeader Then
        Log "|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||10d90||fffd||fffd||fffd||fffd||702||fffd|"
        '1|fffd||82||7c2||317|v|fffd|f|fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||10d90||fffd|
        Dim HeaderElements() As DataElement
        HeaderElements = data(0)
        Dim i As Long
        ReDim Header(UBound(HeaderElements))
        ReDim HeaderForPrint(UBound(HeaderElements))
        For i = 0 To UBound(HeaderElements)
            Header(i) = HeaderElements(i).getElementID
            HeaderForPrint(i) = quot & Header(i) & quot
        Next
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd|o|fffd||fffd|
        DataBody = Join(HeaderForPrint, dlmt) & vbCrLf
    Else
        Log "|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||350||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        DataBody = ""
    End If

    '|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||310||fffd||fffd||fffd|
    Dim de() As DataElement
    For i = 0 To UBound(data)
        de = data(i)
        DataBody = DataBody & getLineByDataElements(Header, de, dlmt, quot) & vbCrLf
    Next
    
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||fffd|
    Dim fileNum As Integer
    fileNum = FreeFile()
    Open filePath For Output As #fileNum
        Print #fileNum, DataBody
    Close #fileNum

    endOf "saveDataElementsToFile"
End Sub


'|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||314|z|fffd||fffd||fffd||fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd|s|fffd||315||fffd||fffd||fffd||fffd||fffd|
Private Function getLineByDataElements(CSVHeaders() As String, de() As DataElement, Optional ElementDelimiter As String, Optional ElementQuotation) As String
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    '|fffd|N|fffd|I|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||202||fffd||fffd|j
    Dim quot As String
    If Len(ElementQuotation) > 0 Then
        quot = ElementQuotation
    Else
        quot = ""
    End If
    
    '|fffd|w|fffd|b|fffd|_|fffd|L|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N
    Dim OrderByHeader As Boolean
    If Not isEmptyArray(CSVHeaders) Then
        OrderByHeader = True
    Else
        OrderByHeader = False
    End If
    
    Dim LineString() As String
    Dim i As Long
    
    '|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||255||fffd||fffd||451||582||fffd||fffd||fffd|Value|fffd||fffd|z|fffd||fffd|
    If OrderByHeader Then
        For i = 0 To UBound(CSVHeaders)
            ReDim Preserve LineString(i)
            LineString(i) = quot & getValueById(de, CSVHeaders(i)) & quot
        Next
    '|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|Value|fffd||fffd|z|fffd||fffd|
    Else
        For i = 0 To UBound(de)
            ReDim Preserve LineString(i)
            LineString(i) = quot & de(i).getValue & quot
        Next
    End If
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||14c||fffd||fffd||fffd|
    getLineByDataElements = Join(LineString, dlmt)
End Function


'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||595||3ca||fffd||fffd|iDataElement|fffd|^|fffd|z|fffd||fffd||fffd|1|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||182||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||314|z|fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|j
Public Function getDataElementsFromFile(filePath As String, Optional ElementDelimiter As String, Optional CSVHeader As Variant) As Variant()
    startOf "getDataElementsFromFile"

    Dim fileNum As Integer
    fileNum = FreeFile()

    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||313||1c2||74d||fffd||fffd||74e||fffd||fffd|s
    Dim Lines() As String
    Dim i As Long
    i = 0
    Open filePath For Input As #fileNum
        Do Until EOF(fileNum)
            ReDim Preserve Lines(i)
            Line Input #fileNum, Lines(i)
            i = i + 1
        Loop
    Close #fileNum
    
    '|fffd|f|fffd||fffd||fffd|~|fffd|^|fffd||fffd||fffd|w|fffd||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|vbTab|fffd|j
    Dim dlmt As String
    If Len(ElementDelimiter) > 0 Then
        dlmt = ElementDelimiter
    Else
        dlmt = vbTab
    End If
    
    'CSVHeader|fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||343|w|fffd|b|fffd|_|fffd||182||fffd||fffd||117|D|fffd||65d8||fffd|p
    Dim CSVHeaders() As String
    Dim DataStartLine As Long
    If Not isEmptyArray(CSVHeader) Then
        CSVHeaders = CSVHeader
        DataStartLine = 0
    Else
        '1|fffd|s|fffd||682||fffd||fffd|w|fffd|b|fffd|_|fffd|s|fffd||182||fffd||fffd||10f||fffd||fffd||fffd|
        CSVHeaders = Split(Lines(0), dlmt)
        DataStartLine = 1
    End If
    
    '|fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||582||315||3ca||fffd|
    Dim ret() As Variant

    '|fffd||fffd||fffd||fffd||20c||fffd||343|f|fffd|[|fffd|^|fffd|s|fffd||182||fffd||fffd||10f||fffd||fffd||fffd|
    For i = DataStartLine To UBound(Lines)
        If InStr(Lines(i), dlmt) > 0 Then
            ReDim Preserve ret(i - DataStartLine)
            Dim vals() As String
            vals = Split(Lines(i), dlmt)
            ret(i - DataStartLine) = getDataElementsFromValues(CSVHeaders, vals)
        Else
            Exit For
        End If
    Next
    
    getDataElementsFromFile = ret

    endOf "getDataElementsFromFile"
End Function


'|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||24a||fffd||c2||fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|ID/Val|fffd||313||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|z|fffd||fffd||255||3ca||fffd||fffd|@|fffd||fffd||fffd|l|fffd||314|z|fffd||52dc1||fffd||fffd|w|fffd|b|fffd|_|fffd||314|z|fffd||52dc2||182||34c||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||182||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Function getDataElementsFromValues(CSVHeaders() As String, vals() As String) As DataElement()
    startOf "getDataElementsFromValues"

    Dim de() As New DataElement
    Dim i As Long
    '|fffd|w|fffd|b|fffd|_|fffd||fffd||fffd||24a||fffd||c2||fffd||fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ReDim de(UBound(CSVHeaders))
    For i = 0 To UBound(CSVHeaders)
        de(i).setElementID CSVHeaders(i)
    Next

    '|fffd|l|fffd||316||fffd||fffd||7cd||fffd||fffd||fffd|
    For i = 0 To UBound(CSVHeaders)
        '|fffd|w|fffd|b|fffd|_|fffd|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|l|fffd|z|fffd||52dc8||209||fffd||fffd||302||182||fffd||fffd||342||fffd||fffd||312|l|fffd||fffd||fffd|i|fffd|[
        If i <= UBound(vals) Then
            de(i).setValue vals(i)
        '|fffd|w|fffd|b|fffd|_|fffd|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd|l|fffd|z|fffd||52dc2||12d09||7c2||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|l|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||302||14b||d5d8e||fffd||fffd||fffd|
        Else
            de(i).setValue ""
        End If
    Next
    
    getDataElementsFromValues = de
    
    endOf "getDataElementsFromValues"
End Function



'/*******************************************************
' * DataElement|fffd||fffd||fffd||fffd||598|A
' *******************************************************/

''ID|fffd|w|fffd||fffd||fffd|DataElement|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
'Public Function getDataElementById(ByRef de() As DataElement, Id As String) As DataElement
'    Dim d As Variant
'    For Each d In de
'        If Not d Is Nothing Then
'            If d.getElementID = Id Then
'                Set getDataElementById = d
'                Exit Function
'            End If
'        End If
'    Next
'    Set getDataElementById = Nothing
'End Function


'ID|fffd|w|fffd||fffd||fffd|DataElement|fffd||312|l|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
Public Function getValueById(ByRef de() As DataElement, Id As String) As String
    startOf "getValueById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        getValueById = ""
    Else
        getValueById = d.getValue
    End If
    endOf "getValueById"
End Function


'ID|fffd|w|fffd||fffd||fffd|DataElement|fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
Public Sub setDataElementById(NewData As DataElement, ByRef de() As DataElement, Id As String)
    startOf "setDataElementById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        Set d = NewData
    End If
    endOf "setDataElementById"
End Sub


'ID|fffd|w|fffd||fffd||152|l|fffd||fffd||fffd|X|fffd|V|fffd||fffd||fffd||fffd|
Public Sub setValueById(ByRef Value As String, de() As DataElement, Id As String)
    startOf "setValueById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        Log "Nothing|fffd||142||fffd||fffd||fffd|"
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        d.setValue Value
        Log "Value|fffd||fffd|" & Value & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    End If
    endOf "setValueById"
End Sub


'|fffd|l|fffd||fffd||fffd||d5d8e||fffd||fffd||fffd||fffd|DataElement|fffd||fffd|useThisElement|fffd||fffd||fffd||a287||fffd||fffd|True/False|fffd||242||fffd||fffd||fffd|
Public Sub changeUseElements(ByRef de() As DataElement, UseThis As Boolean)
    startOf "changeUseElements"
    Dim d As Variant
    For Each d In de
        d.setUseThisElement UseThis
        Log d.getElementID & "|fffd||fffd|useThisElement|fffd||fffd|" & UseThis & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    Next
    endOf "changeUseElements"
End Sub


'ID|fffd|w|fffd||fffd||fffd|useThisElement|fffd||fffd|False|fffd||242||fffd||fffd||fffd|
Public Sub changeUseElementById(ByRef de() As DataElement, Id As String, UseThis As Boolean)
    startOf "changeUseElementById"
    Dim d As DataElement
    Set d = getDataElementById(de, Id)
    If d Is Nothing Then
        Log "Nothing|fffd||142||fffd||fffd||fffd|"
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    Else
        d.setUseThisElement UseThis
        Log "useThisElement|fffd||fffd|" & UseThis & "|fffd||242||fffd||fffd||702||fffd||fffd||fffd|"
    End If
    endOf "changeUseElementById"
End Sub


'/*******************************************************
' * IEUtil|fffd||598|A
' *******************************************************/
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Sub initWaitForBrowse(ByVal timeOfTimeOut As Long, ByVal returnMode As WAIT_RETURN_MODE, _
'                               ByVal waitStartTime As Long, ByVal consecutiveSuccessCnt As Long)
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub initWaitForBrowse(ByVal timeOftimeOut As Long, ByVal returnMode As WAIT_RETURN_MODE, _
                               ByVal waitStartTime As Long, ByVal consecutiveSuccessCnt As Long, _
                               ByVal timeOfInteractiveTimeOut As Long)
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    startOf "initWaitForBrowse"
    
    defaultTimeOfTimeOut = timeOftimeOut
    defaultWaitReturnMode = returnMode
    defaultWaitStartTime = waitStartTime
    defaultConsecutiveSuccessCnt = consecutiveSuccessCnt
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    defaultTimeOfInteractiveTimeOut = timeOfInteractiveTimeOut
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    initializedWaitSetting = True
    
    Log "waitForBrowse|fffd||752||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
    Log "defaultTimeOfTimeOut = " & timeOftimeOut
    Log "defaultWaitReturnMode = " & defaultWaitReturnMode
    Log "defaultWaitStartTime = " & waitStartTime
    Log "defaultConsecutiveSuccessCnt = " & consecutiveSuccessCnt
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Log "defaultTimeOfInteractiveTimeOut = " & timeOfInteractiveTimeOut
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    endOf "initWaitForBrowse"
End Sub


'|fffd||fffd||291|J|fffd||68a||fffd||fffd||fffd||fffd||482||fffd||fffd||fffd|
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Function waitForBrowse(ByRef ie As Object, Optional ByVal timeOfTimeOut As Long = -1, _
'                                Optional ByVal returnMode As WAIT_RETURN_MODE = WAIT_RETURN_MODE.MSG_ONLY, _
'                                Optional ByVal waitStartTime As Long = -1, Optional ByVal consecutiveSuccessCnt As Long = -1) As WAIT_BROWSE_RESULT
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|l|fffd|s|fffd||f347||fffd|@MSG_ONLY|fffd||fffd|UNSPECIFIED, IE|fffd||fffd|ReadyState|fffd||fffd|4|fffd||242||202||fffd||202||fffd||fffd||389||fffd||fffd||1c9||fffd|
Public Function waitForBrowse(ByRef ie As Object, Optional ByVal timeOftimeOut As Long = -1, _
                                Optional ByVal returnMode As WAIT_RETURN_MODE = WAIT_RETURN_MODE.UNSPECIFIED, _
                                Optional ByVal waitStartTime As Long = -1, Optional ByVal consecutiveSuccessCnt As Long = -1, _
                                Optional ByVal timeOfInteractiveTimeOut As Long = -1) As WAIT_BROWSE_RESULT
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    startOf "waitForBrowse"

    Dim startTime As Long
    startTime = timeGetTime
    Dim successCnt As Long
    successCnt = 0
        
    Dim ieBusy As Boolean
    Dim ieReadyState As Long
    Dim ieType As String
    Dim isCompleted As Boolean
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'ie.Busy|fffd||fffd|False|fffd||fffd||fffd||fffd|ie.ReadyState|fffd||fffd|READYSTATE_INTERACTIVE|fffd||242||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim startIeInteractiveTime As Long
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    If Not initializedWaitSetting Then
        '|fffd||752||80aa||fffd||fffd||fffd||fffd||fffd|l|fffd||202||302||150||fffd||fffd||fffd||fffd|l|fffd||fffd||752||fffd|
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Call initWaitForBrowse(20000, MSG_ONLY, 100, 2)
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Call initWaitForBrowse(20000, MSG_ONLY, 100, 2, 10000)
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||24e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||350||752||fffd|l|fffd||fffd||fffd|g|fffd|p
    If timeOftimeOut = -1 Then
        timeOftimeOut = defaultTimeOfTimeOut
    End If
    If returnMode = UNSPECIFIED Then
        returnMode = defaultWaitReturnMode
    End If
    If waitStartTime = -1 Then
        waitStartTime = defaultWaitStartTime
    End If
    If consecutiveSuccessCnt = -1 Then
        consecutiveSuccessCnt = defaultConsecutiveSuccessCnt
    End If
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If timeOfInteractiveTimeOut = -1 Then
        timeOfInteractiveTimeOut = defaultTimeOfInteractiveTimeOut
    End If
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    Log "timeOfTimeOut = " & timeOftimeOut & ", returnMode = " & returnMode _
        & ", waitStartTime = " & waitStartTime & ", consecutiveSuccessCnt = " & consecutiveSuccessCnt

    
    Do
        'wait|fffd|J|fffd|n|fffd||482||fffd|
        Call Sleep(waitStartTime)
        DoEvents
        
        Log timeGetTime & vbTab & "wait|fffd|J|fffd|n"
        Log timeGetTime & vbTab & "TypeName(ie):" & TypeName(ie)
        
        If TypeName(ie) = "IWebBrowser2" Then
            'InternetExplorer|fffd||30f||a347|
            
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            startIeInteractiveTime = 0
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
            
            'IE|fffd||fffd|Busy|fffd||482||fffd|
            Do
                '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g
                If timeGetTime - startTime > timeOftimeOut Then
                    Log timeGetTime & vbTab & "|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                    
                    Select Case returnMode
                    Case RETURN_RESULT
                        waitForBrowse = WAIT_TIMEOUT
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        ExitOf "waitForBrowse", "IE|fffd||fffd|Busy|fffd||482||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
                        Exit Function
                    Case MSG_ONLY
'2015/12/17 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                        Call MsgBox("InternetExplorer|fffd||fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd|" & (defaultTimeOfTimeOut / 1000) & "|fffd|b|fffd||20f||30a0||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B[|fffd|R|fffd|[|fffd|h:U1101]", vbOKOnly + vbCritical, "InternetExplorer|fffd||fffd||fffd||fffd||fffd||202||fffd|")
'2015/12/17 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/17 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        Call MsgBox("InternetExplorer|fffd||fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd|" & (timeOftimeOut / 1000) & "|fffd|b|fffd||20f||30a0||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                                    "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B[|fffd|R|fffd|[|fffd|h:U1101]", vbOKOnly + vbCritical, "InternetExplorer|fffd||fffd||fffd||fffd||fffd||202||fffd|")
'2015/12/17 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
                        End
                    End Select
                End If
                
                DoEvents
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'                Call Sleep(10)
'2016/03/03 |fffd||d3dc| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||827b|
                Call Sleep(100)
'2016/03/03 |fffd||1c9||fffd| T.Y T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
                
                On Error GoTo ERROR
                ieBusy = ie.Busy
                ieReadyState = ie.readyState
                On Error GoTo 0
                
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                If startIeInteractiveTime = 0 Then
                    'ieBusy|fffd||fffd|False|fffd||fffd||fffd||fffd|ie.ReadyState|fffd||fffd|READYSTATE_INTERACTIVE|fffd||242||202||fffd||fffd||fffd||fffd||fffd||fffd||502||fffd||fffd||64fe|
                    If ieBusy = False _
                    And ieReadyState = tagREADYSTATE.READYSTATE_INTERACTIVE Then
                        startIeInteractiveTime = timeGetTime
                        Log timeGetTime & vbTab & "startIeInteractiveTime=" & startIeInteractiveTime
                    End If
                Else
                    If ieBusy = False _
                    And ieReadyState = tagREADYSTATE.READYSTATE_INTERACTIVE Then
                        '|fffd|w|fffd||fffd|b|fffd||fffd||fffd||20f||fffd|READYSTATE_INTERACTIVE|fffd||30f||a347|Loop|fffd||14c82||fffd||fffd||fffd|
                        If timeGetTime - startIeInteractiveTime > timeOfInteractiveTimeOut Then
                            ExitOf "waitForBrowse", timeGetTime & vbTab & timeOfInteractiveTimeOut & "|fffd|~|fffd||fffd||fffd|b|fffd||518|A|fffd||fffd||fffd||fffd|Busy=False|fffd||fffd||fffd||fffd|ReadyState=READYSTATE_INTERACTIVE|fffd||302||fffd||fffd||7d2|E|fffd|o|fffd||fffd||fffd||702||fffd||fffd|B"
                            waitForBrowse = WAIT_SUCCEEDED
                            Exit Function
                        End If
                    Else
                        '|fffd|X|fffd|e|fffd|[|fffd|^|fffd|X|fffd||fffd||fffd||3c2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7ce||fffd||fffd||502||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        startIeInteractiveTime = 0
                    End If
                End If
'2016/01/22 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
                
                Log timeGetTime & vbTab & "ie.busy:" & ieBusy & " readyState:" & ieReadyState
                
            Loop While ieBusy Or ieReadyState <> tagREADYSTATE.READYSTATE_COMPLETE
            
            isCompleted = False
            
            ieType = ""
            On Error GoTo ERROR
            ieType = ie.Type
            On Error GoTo 0
            
            Log timeGetTime & vbTab & "ie.Type:" & ieType
            
            If ieType = "HTML |fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g" Then
                On Error GoTo ERROR
                'Document|fffd|z|fffd||fffd||fffd||30a|m|fffd|F
                isCompleted = isCompletedDocument(ie.document)
                On Error GoTo 0
            Else
                'PDF|fffd|AExcel|fffd||202||1d5||283|A|fffd|v|fffd||fffd||fffd|P|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd|Document|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347|
                isCompleted = True
            End If
        
        Else
            'HtmlDocument|fffd||30f||a347||fffd|ishowModalDialog|fffd||202||1c1|j
        
            '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g
            If timeGetTime - startTime > timeOftimeOut Then
                Log timeGetTime & vbTab & "|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                
                Select Case returnMode
                Case RETURN_RESULT
                    waitForBrowse = WAIT_TIMEOUT
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    ExitOf "waitForBrowse", "ReadyState|fffd|m|fffd|F|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
                    Exit Function
                Case MSG_ONLY
                    Call MsgBox("InternetExplorer|fffd||fffd||fffd||fffd||309||fffd||fffd||fffd||fffd||fffd|" & (defaultTimeOfTimeOut / 1000) & "|fffd|b|fffd||20f||30a0||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                                "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B[|fffd|R|fffd|[|fffd|h:U1101]", vbOKOnly + vbCritical, "InternetExplorer|fffd||fffd||fffd||fffd||fffd||202||fffd|")
                    End
                End Select
            End If
                
            On Error GoTo ERROR
            'Document|fffd|z|fffd||fffd||fffd||30a|m|fffd|F
            isCompleted = isCompletedDocument(ie)
            On Error GoTo 0
        End If
        
        '|fffd|S|fffd||fffd|Complete|fffd||fffd||fffd||314||fffd||fffd||fffd|
        If isCompleted Then
            successCnt = successCnt + 1
            Log timeGetTime & vbTab & "Complete" & successCnt & "|fffd||fffd||fffd|"
        Else
            successCnt = 0
            Log timeGetTime & vbTab & "Complete|fffd||142||342||202||fffd||fffd||302||14d||14f||fffd||fffd||fffd||fffd||fffd|"
        End If
        
    '|fffd|w|fffd||fffd||50518|A|fffd||fffd||fffd||150||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||14c|J|fffd||fffd||502||fffd|
    Loop Until successCnt >= consecutiveSuccessCnt
    
    Log timeGetTime & vbTab & "wait|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    
    waitForBrowse = WAIT_SUCCEEDED
    
    endOf "waitForBrowse"
    Exit Function
    
ERROR:
    Log timeGetTime & vbTab & "|fffd|G|fffd||fffd||fffd|[|fffd|F[" & Err.Number & "]" & Err.Description
    
    If Err.Number = -2147417848 Or ie Is Nothing Then
        
        Select Case returnMode
        Case RETURN_RESULT
            waitForBrowse = WINDOW_CLOSED
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            ExitOf "waitForBrowse", "InternetExplorer|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
            Exit Function
        Case MSG_ONLY
            Call MsgBox("InternetExplorer|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                        "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B[|fffd|R|fffd|[|fffd|h:U1103]", vbOKOnly + vbCritical, "InternetExplorer|fffd|s|fffd||fffd|")
            End
        End Select
    End If
    
    Resume Next
    
End Function


'Document|fffd||fffd||fffd||1cd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||14ed2||80b7||fffd||fffd|B
'|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|1|fffd||82||142||fffd|complete|fffd||142||202||fffd|Document|fffd||fffd||fffd||fffd||fffd||fffd||fffd|False
'2016/03/29 |fffd||d3dc| T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Function isCompletedDocument(doc As HTMLDocument, Optional hierarchy As Long = 0) As Boolean
'
'    DoEvents
'    Call Sleep(10)
'
'    Log timeGetTime & vbTab & "|fffd|K|fffd|w" & hierarchy & " Document.readyState:" & doc.ReadyState
'    If doc.ReadyState <> "complete" Then
'2016/03/29 |fffd||d3dc| T.Y |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/03/29 |fffd||1c9||fffd| T.Y |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function isCompletedDocument(ByRef doc As HTMLDocument, Optional ByVal hierarchy As Long = 0) As Boolean
    
    Dim docReadyState As String
    On Error Resume Next
    docReadyState = doc.readyState
    If Err.Number <> 0 Then
        ExitOf "isCompletedDocument", Err.Number & ":" & Err.Description
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||302||fffd|True|fffd||155||502||fffd|
        isCompletedDocument = True
        Call Sleep(1000)
        Exit Function
    End If
    On Error GoTo 0
    
    DoEvents
    Call Sleep(10)
            
    Log timeGetTime & vbTab & "|fffd|K|fffd|w" & hierarchy & " Document.readyState:" & docReadyState
    If doc.readyState <> "complete" Then
'2016/03/29 |fffd||1c9||fffd| T.Y |fffd|@ |fffd||fffd||fffd||fffd||fffd||702||fffd|
        'Document|fffd||fffd||fffd||482||fffd||fffd||c2bd2||fffd||fffd||202||302||14f|I|fffd||fffd|
        isCompletedDocument = False
        Exit Function
    End If

    '|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34e|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||312||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
    Dim frameLength As Long
    frameLength = doc.frames.Length
    
    If frameLength > 0 Then
        Dim subDoc As HTMLDocument
        Dim isCompleted As Boolean
        
        Dim i As Long
        For i = 0 To frameLength - 1
            
            Dim enableAccess As Boolean
            enableAccess = True
            
            On Error Resume Next
            Set subDoc = doc.frames.Item(i).document
            If Err.Number = -2147024891 Then
                '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||6c2||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B
                enableAccess = False
            End If
            On Error GoTo 0
            
            If enableAccess Then
                Log timeGetTime & vbTab & "|fffd|K|fffd|w" & hierarchy & " frames.item(" & i & "):" & doc.frames.Item(i).Name
                '|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd|Document|fffd||303|`|fffd|F|fffd|b|fffd|N
                isCompleted = isCompletedDocument(subDoc, hierarchy + 1)
            Else
                Log timeGetTime & vbTab & "|fffd|K|fffd|w" & hierarchy & " frames.item(" & i & "):" & "|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||6c2||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
                '|fffd|A|fffd|N|fffd|Z|fffd|X|fffd||142||fffd||fffd||202||fffd||fffd||a347||fffd||356||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||302||fffd||fffd||7d6||fffd||fffd||fffd||fffd||fffd|TRUE
                isCompleted = True
            End If
            
            If Not isCompleted Then
                isCompletedDocument = False
                Exit Function
            End If
        Next i
    End If
    
    isCompletedDocument = True
    
End Function


'|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||fffd|IE|fffd||fffd||fffd||64fe|
Public Function getRunningIE(arg_title As String, Optional searchWord As String) As InternetExplorer
    startOf "getRunningIE"
    
    Dim ie As InternetExplorer    'IE|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd|i|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|^|fffd|j
    Dim sh As Object    '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|ShellWindow|fffd||a3ae||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim win As Object   'ShellWindow|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim win_name As String
    Dim document_title As String    '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||308||a39e||fffd|i|fffd|[|fffd||3d0||fffd|
    Dim bodyInnerHtml As String     '|fffd|{|fffd|f|fffd|B|fffd|[|fffd||303|C|fffd||fffd||fffd|i|fffd|[HTML|fffd||fffd||fffd|i|fffd|[
    Set sh = CreateObject("Shell.Application")  'ShellWindow|fffd||fffd|wins|fffd||24a|i|fffd|[
    'ShellWindow|fffd||fffd||fffd||fffd|1|fffd||82||c2||8e||64fe||fffd||fffd||fffd||10f||fffd||fffd||fffd|
    For Each win In sh.Windows
        '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd|s|fffd||16cce||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd|j
        On Error Resume Next
        win_name = ""
        document_title = ""
        win_name = win.FullName
        document_title = win.document.Title
        On Error GoTo 0
        Log "win_name=" & win_name
        Log "title=" & document_title
        '|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|o|fffd|[|fffd||248||fffd||fffd||fffd||fffd||fffd||fffd||702||702||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
        If LCase(Right(win_name, 12)) = "iexplore.exe" Then
            '2013/03/27 Metro IE|fffd||fffd||fffd||fffd||fffd|O|fffd||1c9||fffd|
            If checkDesktopIe(win) = True Then
                If InStr(document_title, arg_title) > 0 Then
                    '|fffd||fffd||fffd||fffd||fffd||38f||6d5||fffd||fffd||fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||34c||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||302||74f||fffd||fffd||fffd||fffd|i|fffd|w|fffd||fffd||202||fffd||fffd||202||fffd|K|fffd||fffd|1|fffd||150|^|fffd||242||202||fffd|j
                    On Error Resume Next
                    bodyInnerHtml = ""
                    bodyInnerHtml = win.document.body.innerHTML
                    On Error GoTo 0
                    If InStr(bodyInnerHtml, searchWord) > 0 Then
                        Set ie = win  '|fffd||3d0||fffd|ie|fffd||24e||64fe||fffd||fffd||fffd||fffd|win|fffd||fffd||fffd|i|fffd|[
                        Exit For      '|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
                    End If
                End If
            End If
        End If
    Next
    Set getRunningIE = ie  '|fffd|l|fffd||315||50b|p
    
    endOf "getRunningIE"
End Function


'|fffd|T|fffd|u|fffd||fffd||28f|o|fffd||fffd||fffd||482||fffd||fffd||c2bc1|E|fffd||64fe|
Public Function waitForLaunch(arg_title As String, Optional waitTime As Long, Optional SilentMode As Boolean) As InternetExplorer
    Dim ie As InternetExplorer
    Dim startTime As Long
    Dim UseTime As Long
    Const WAIT_TIME = 20000
    
    '|fffd||151||fffd||482||fffd||fffd||fffd||fffd||502||303|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||752||fffd|
    If waitTime = 0 Then
        waitTime = WAIT_TIME
    End If
    
    UseTime = 0
    startTime = GetTickCount

    Do
        Set ie = getRunningIE(arg_title)
        If Not ie Is Nothing Then
            Exit Do
        End If
        UseTime = GetTickCount - startTime
        Sleep 10
        DoEvents
    Loop While UseTime < waitTime
        
    'Timeout
    If UseTime >= waitTime Then
        If Not SilentMode Then
            MsgBox "InternetExplorer|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                   "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B[|fffd|R|fffd|[|fffd|h:U1102]", vbOKOnly + vbCritical, "InternetExplorer|fffd|G|fffd||fffd||fffd|["
            End
        Else
            Exit Function
        End If
    End If
    Set waitForLaunch = ie
End Function


'|fffd||616||fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||702||fffd||fffd||351||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||30a|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd|L|fffd||fffd||fffd||30a|m|fffd|F|fffd|i|fffd||117|p|fffd|j
Public Function isCertConfirmation(Optional zone As String) As Boolean
    Dim temp As String
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    If zone <> "" Then
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "1A04", REG_DWORD))
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||350|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    Else
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "1A04", REG_DWORD))
    End If
    
    'Boolean|fffd|^|fffd||582||315||3ca||fffd|
    If Trim(temp) = "0" Then
        isCertConfirmation = True
    Else
        isCertConfirmation = False
    End If
End Function

'|fffd||616||fffd||fffd||fffd||fffd||fffd||fffd||fffd||82||702||fffd||fffd||351||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||30a|m|fffd|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd|L|fffd||fffd||fffd||313|o|fffd|^|fffd|i|fffd||117|p|fffd|j
Public Function setCertConfirmation(Optional zone As String) As String
    '|fffd|o|fffd|^|fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_ALREADY|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If isCertConfirmation(zone) Then
        setCertConfirmation = CONFIG_ALREADY
        Exit Function
    '|fffd||fffd||fffd|o|fffd|^|fffd||30f||a347||fffd||353|o|fffd|^|fffd||fffd||fffd||fffd||fffd|s
    Else
        '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||253|o|fffd|^
        If zone <> "" Then
            egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "1A04", REG_DWORD, 0
        Else
            egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "1A04", REG_DWORD, 0
        End If
    End If

    '|fffd||752||fffd||3cd|X|fffd||fffd||30d||10a|m|fffd|F|fffd|F|fffd|o|fffd|^|fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_DONE|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If isCertConfirmation(zone) Then
        setCertConfirmation = CONFIG_DONE
    Else
        setCertConfirmation = CONFIG_ABORTED
    End If
End Function

'|fffd||6cc||c0c2||fffd|[|fffd|h|fffd||30a|m|fffd|F|fffd|i|fffd||117|p|fffd|j
Public Function isHogoMode(Optional zone As String) As Boolean
    Dim temp As String
    
    'Windows2000 / XP|fffd||34f||fffd||fffd||fffd||fffd||38f||6ca|O
    If InStr(getOSVersion(), "5.") > 1 Then
        isHogoMode = False
        Exit Function
    End If
    
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    If zone <> "" Then
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "2500", REG_DWORD))
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||350|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    Else
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "2500", REG_DWORD))
    End If
    
    'Boolean|fffd|^|fffd||582||315||3ca||fffd|
    If Trim(temp) = "0" Then
        isHogoMode = True
    Else
        isHogoMode = False
    End If
End Function

'|fffd||6cc||c0c2||fffd|[|fffd|h|fffd||309||fffd||fffd||fffd||fffd|i|fffd||117|p|fffd|j
Public Function cancelHogoMode(Optional zone As String) As String
    '|fffd||fffd||fffd||fffd||fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_ALREADY|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If Not isHogoMode(zone) Then
        cancelHogoMode = CONFIG_ALREADY
        Exit Function
    '|fffd|L|fffd||fffd||fffd||30f||a347||fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s
    Else
        '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||253|o|fffd|^
        If zone <> "" Then
            egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "2500", REG_DWORD, 3
        Else
            egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "2500", REG_DWORD, 3
        End If
    End If

    '|fffd||752||fffd||3cd|X|fffd||fffd||30d||10a|m|fffd|F|fffd|F|fffd|o|fffd|^|fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_DONE|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If Not isHogoMode(zone) Then
        cancelHogoMode = CONFIG_DONE
    Else
        cancelHogoMode = CONFIG_ABORTED
    End If
End Function


'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||30a|m|fffd|F
Public Function showDownloadDialog(Optional zone As String) As Boolean
    Dim temp As String
    
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    If zone <> "" Then
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "2200", REG_DWORD))
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||350|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd|]|fffd|[|fffd||fffd||fffd||30a|m|fffd|F
    Else
        temp = Str(egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "2200", REG_DWORD))
    End If
    
    'Boolean|fffd|^|fffd||582||315||3ca||fffd|
    If Trim(temp) = "0" Then
        showDownloadDialog = True
    Else
        showDownloadDialog = False
    End If
End Function

'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||310||752||fffd|
Public Sub setDownloadDialog(Optional zone As String)
    '|fffd|]|fffd|[|fffd||fffd||fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||353||fffd||fffd|Y|fffd|]|fffd|[|fffd||fffd||fffd||253|o|fffd|^
    If zone <> "" Then
        egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & Trim(zone), "2200", REG_DWORD, 0
    Else
        egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\" & ZONE_TRUST, "2200", REG_DWORD, 0
    End If
End Sub



'|fffd|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd|o|fffd|^|fffd||3c2||74a|m|fffd|F|fffd|i|fffd||117|p|fffd|j
Public Function isTrustedSite(url As String, Optional http As Boolean) As Boolean
    Dim domain As String
    Dim http_protocol As String

    'URL|fffd||fffd||fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||255||3ca||fffd|
    domain = toDomain(url)
    '|fffd|v|fffd||fffd||fffd|g|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If http Then
        http_protocol = "http"
    Else
        http_protocol = "https"
    End If

    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||312|l|fffd||64fe|
    If egg.getValue(HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\" & domain, http_protocol, REG_DWORD) = 2 Then
        isTrustedSite = True
    Else
        isTrustedSite = False
    End If
End Function

'|fffd|M|fffd||fffd||fffd||3c2||743|T|fffd|C|fffd|g|fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd|i|fffd||117|p|fffd|j
Public Function setTrustedSite(url As String, Optional http As Boolean) As Integer
    Dim domain As String
    Dim http_protocol As String
    
    If Trim(url) = "" Then
        setTrustedSite = CONFIG_INVALIDARG
        Exit Function
    End If
    
    '|fffd|o|fffd|^|fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_ALREADY|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If isTrustedSite(url, http) Then
        setTrustedSite = CONFIG_ALREADY
        Exit Function
    '|fffd||fffd||fffd|o|fffd|^|fffd||30f||a347||fffd||353|o|fffd|^|fffd||fffd||fffd||fffd||fffd|s
    Else
        'URL|fffd||fffd||fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||255||3ca||fffd|
        domain = toDomain(url)
        '|fffd|v|fffd||fffd||fffd|g|fffd|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If http Then
            http_protocol = "http"
        Else
            http_protocol = "https"
        End If
        '|fffd|o|fffd|^|fffd||fffd||fffd|s
        egg.setValue HKEY_CURRENT_USER, "Software\Microsoft\Windows\CurrentVersion\Internet Settings\ZoneMap\Domains\" & domain, http_protocol, REG_DWORD, 2
    End If

    '|fffd||752||fffd||3cd|X|fffd||fffd||30d||10a|m|fffd|F|fffd|F|fffd|o|fffd|^|fffd||3c2||742||30f||a347||fffd||fffd|CONFIG_DONE|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    If isTrustedSite(url, http) Then
        setTrustedSite = CONFIG_DONE
    '|fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|o|fffd|^|fffd||30f||a347||fffd||fffd|CONFIG_ABORTED|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    Else
        setTrustedSite = CONFIG_ABORTED
    End If
End Function


'|fffd|||fffd|b|fffd|v|fffd|A|fffd|b|fffd|v|fffd|u|fffd||fffd||fffd|b|fffd|N|fffd||30b||fffd||fffd||fffd|
Public Sub allowPopup(domain As String)
    Dim B As Byte
    setValue HKEY_CURRENT_USER, "Software\Microsoft\Internet Explorer\New Windows\Allow", domain, REG_BINARY, B
End Sub


'URL|fffd||fffd||fffd||fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||1228f|o
Public Function toDomain(url As String) As String
    Dim domain As String
    Dim DomainStartPos As Integer
    Dim DomainEndPos As Integer
        
    '|fffd|v|fffd||fffd||fffd|g|fffd|R|fffd||fffd||fffd||fffd||fffd||183||fffd||fffd|[|fffd|g|fffd|f|fffd|B|fffd||fffd||fffd|N|fffd|g|fffd||fffd||fffd||242||342||fffd||fffd||702||a0bd||fffd||292|u|fffd||fffd||fffd||64fe|
    DomainStartPos = InStr(url, "://") + 3
    DomainEndPos = InStr(DomainStartPos, url, "/")
    '|fffd|T|fffd|u|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||702||14a||702||7c2||fffd||fffd||fffd||fffd||fffd||fffd||1228f|o
    If DomainEndPos > 0 Then
        domain = Mid(url, DomainStartPos, DomainEndPos - DomainStartPos)
    Else
        domain = Mid(url, DomainStartPos)
    End If
    
    '.com|fffd||702||fffd||fffd||fffd|.net
    If Right(domain, 4) = ".com" Or Right(domain, 4) = ".net" Then
        '|fffd|T|fffd|u|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|
        If InStrRev(domain, ".", Len(domain) - 4) > 0 Then
            domain = Mid(domain, InStrRev(domain, ".", Len(domain) - 4))
            domain = Right(domain, Len(domain) - 1)
        End If
    '.co.jp|fffd||702||fffd||fffd||fffd|.ne.jp
    ElseIf Right(domain, 6) = ".co.jp" Or Right(domain, 6) = ".ne.jp" Then
        '|fffd|T|fffd|u|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|
        If InStrRev(domain, ".", Len(domain) - 6) > 0 Then
            domain = Mid(domain, InStrRev(domain, ".", Len(domain) - 6))
            domain = Right(domain, Len(domain) - 1)
        End If
    '|fffd||fffd||fffd||fffd||20a|O
    Else
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|T|fffd|u|fffd|h|fffd||fffd||fffd|C|fffd||fffd||fffd||82||fffd||fffd||155||50b|p
    End If
    
    toDomain = domain
End Function


'POST|fffd|f|fffd|[|fffd|^|fffd||303|o|fffd|C|fffd|g|fffd|z|fffd||fffd||3ca||fffd||fffd||590||fffd|
Public Function getPostData(poststring As String) As Byte()
    startOf "getPostData"

    Dim ret() As Byte

    '|fffd|o|fffd|C|fffd|g|fffd|z|fffd||52dc2||12c90||fffd|
    ReDim ret(Len(poststring) - 1)
    'Unicode|fffd||fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||595||3ca||fffd||fffd||fffd||fffd||103|o|fffd|C|fffd|g|fffd|z|fffd||fffd||24a|i|fffd|[
    ret = StrConv(poststring, vbFromUnicode)

    getPostData = ret
    
    endOf "getPostData"
End Function


'POST|fffd|f|fffd|[|fffd|^|fffd||303|w|fffd|b|fffd|_|fffd||64fe||fffd||590||fffd|
Public Function getPostHeader() As String
    startOf "getPostHeader"
    getPostHeader = "Content-Type: application/x-www-form-urlencoded" & vbCrLf
    endOf "getPostHeader"
End Function


'IE|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub showIEAlert(ie As InternetExplorer, message As String, Optional Async As Boolean)
    '|fffd||53bca||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|i|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|AVBA|fffd||3471||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||302||702||70d|s|fffd||fffd||fffd|j|fffd||fffd|JavaScript|fffd|I|fffd||242||353||fffd||fffd||fffd|
    If Async Then
'        ie.document.Script.setTimeout "JavaScript:alert(""" & message & """);"
        ie.document.parentWindow.setTimeout "JavaScript:alert(""" & message & """);"
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||a347||fffd|i|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|VBA|fffd||3471||fffd||fffd||fffd||fffd||fffd||34d|s|fffd||fffd||202||fffd||fffd|j
    Else
'        ie.document.Script.alert message
        ie.document.parentWindow.alert message
    End If
End Sub


'IE|fffd|A|fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
#If Win64 Then
Public Function clickIEAlert(ButtonCaption As String, BodyCaption As String, Optional hwndOwner As LongPtr) As Boolean
    Dim DialogHandles() As LongPtr
    Dim hBody As LongPtr
    Dim hButton As LongPtr
    Dim hOwner As LongPtr
    Dim hTarget As LongPtr
#Else
Public Function clickIEAlert(ButtonCaption As String, BodyCaption As String, Optional hwndOwner As Long) As Boolean
    startOf "clickIEAlert"
    Dim DialogHandles() As Long
    Dim hBody As Long
    Dim hButton As Long
    Dim hOwner As Long
    Dim hTarget As Long
#End If
    Dim i As Long
    Dim ret As Boolean
    hTarget = 0
    
    
    ret = False
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a3ae||fffd||fffd||fffd||64fe|
    DialogHandles = getHandlesByClassName("#32770")
    
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If DialogHandles(0) = 0 Then
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|BclickIEAlert|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ExitOf "clickIEAlert", "|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd|BclickIEAlert|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Exit Function
    End If

    '|fffd|e|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||251||382||fffd||fffd||10f||fffd||fffd||fffd|
    For i = 0 To UBound(DialogHandles)
        '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||30e|q|fffd|v|fffd|f|fffd||24e|w|fffd||8576||fffd||fffd||fffd||42a8a||702||702||fffd||102||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N
        hButton = getChildByCaption(DialogHandles(i), ButtonCaption)
        hBody = getChildByCaption(DialogHandles(i), BodyCaption)
        hOwner = getOwnerHandle(DialogHandles(i))
        Log "|fffd|{|fffd|^|fffd||fffd||fffd|F" & hButton & " /|fffd|{|fffd||fffd||fffd|F" & hBody & " /|fffd|I|fffd|[|fffd|i|fffd|[|fffd|F" & hOwner
        '|fffd||1c2||fffd||fffd||fffd||fffd||fffd||702||702||fffd||102||fffd||fffd||fffd||a347||fffd||351||fffd||fffd||fffd||38f||6c2||182||fffd||fffd||114|F|fffd||fffd|
        If hButton > 0 And hBody > 0 Then
            Log "|fffd||fffd||fffd||fffd||fffd||182||fffd||fffd||113|n|fffd||fffd||fffd||a0bd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|F" & hwndOwner
            If hwndOwner = 0 _
            Or (hwndOwner > 0 And hOwner = hwndOwner) Then
                hTarget = hButton
                Log "|fffd||fffd||fffd||fffd||38f||6c2||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|F" & hTarget
                '|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                clickWindow hTarget
                clickIEAlert = True
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                ExitOf "clickIEAlert", "|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
                Exit Function                           '1.72
            End If
        End If
    Next

    '|fffd|^|fffd|[|fffd|Q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If hTarget = 0 Then
        Log "|fffd||fffd||fffd||fffd||38f||6c2||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
    End If

    clickIEAlert = ret
    endOf "clickIEAlert"
End Function



'|fffd||fffd||282||582||303|f|fffd|[|fffd|^|fffd|Z|fffd|b|fffd|g|fffd||117|p
Public Sub setDataToScreen(htDoc As HTMLDocument, inElements() As DataElement, targetScreen As String)
    startOf "setDataToScreen"
    
    Log "|fffd|f|fffd|[|fffd|^|fffd|Z|fffd|b|fffd|g|fffd||38f||6c9||fffd||281|F" & targetScreen

    Dim i As Integer
    
    For i = 0 To UBound(inElements)
        If inElements(i).getScreenName = targetScreen And inElements(i).useThisElement Then
            setData htDoc, inElements(i).getElementID, inElements(i).getElementType, inElements(i).getValue
        End If
    Next

    endOf "setDataToScreen"
End Sub


'|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||682||243|Z|fffd|b|fffd|g
Public Function setData(htmlDoc As HTMLDocument, ElementID As Variant, elementType As String, Value As String) As Boolean
    Dim RadioElement As HTMLInputElement
    Dim ret As Boolean
    
    Log "ID:" & ElementID & "/Type:" & elementType & "/value:" & Value
    
    '2013/01/31 Window8+IE10|fffd||389||fffd||fffd|igetElementById|fffd||fffd|getElementsByName|fffd|j
    Select Case elementType
        Case TXT, PULLDOWN
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            ret = True
        Case TXT_ONFOCUS
            'Select|fffd||fffd||fffd||90b1||fffd||182||141|Aonfocus|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            htmlDoc.getElementsByName(ElementID)(0).Select = Value
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            ret = True
        Case TXT_CHANGE
            'onchange|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            htmlDoc.getElementsByName(ElementID)(0).FireEvent ("onchange")
            ret = True
        Case TXT_ONBLUR
            'onblur|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            htmlDoc.getElementsByName(ElementID)(0).FireEvent ("onblur")
            ret = True
        Case TEXTAREA
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            ret = True
        Case TEXTAREA_ONBLUR
            'onblur|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            htmlDoc.getElementsByName(ElementID)(0).FireEvent ("onblur")
            ret = True
        Case chk
            'val|fffd|l|fffd||24b||d4488||20a|O|fffd||fffd||fffd|w|fffd||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|I|fffd||fffd| 1.72
            If Trim(Value) <> "" Then
                htmlDoc.getElementsByName(ElementID)(0).Checked = True
            Else
                htmlDoc.getElementsByName(ElementID)(0).Checked = False
            End If
            ret = True
        Case CHK_CLICK
            '|fffd|I|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.72
            If Trim(Value) <> "" And htmlDoc.getElementsByName(ElementID)(0).Checked = False Then
                htmlDoc.getElementsByName(ElementID)(0).Click
            ElseIf Trim(Value) = "" And htmlDoc.getElementsByName(ElementID)(0).Checked = True Then
                htmlDoc.getElementsByName(ElementID)(0).Click
            End If
            ret = True
        Case PULLDOWN_ONCHANGE
            htmlDoc.getElementsByName(ElementID)(0).Value = Value
            htmlDoc.getElementsByName(ElementID)(0).FireEvent ("onchange")
            ret = True
        Case RADIO
            For Each RadioElement In htmlDoc.getElementsByName(ElementID)
                If RadioElement.Value = Value Then
                    RadioElement.Checked = True
                    ret = True
                    Exit For
                End If
            Next
    End Select
    
    setData = ret
    
End Function


'|fffd||fffd||fffd|[|fffd|U|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||182||fffd||fffd||10e||64fe||fffd||fffd||fffd||fffd|
Public Function getIEByMsg() As InternetExplorer
    Dim ie As InternetExplorer
    Dim sh As Object
    Dim win As Object
    Dim WidthBefore As Long
    Dim HeightBefore As Long
    Dim LeftBefore As Long
    Dim TopBefore As Long
    Dim winname As String
    
    Application.WindowState = xlNormal
    WidthBefore = Application.Width
    HeightBefore = Application.Height
    LeftBefore = Application.Left
    TopBefore = Application.Top
    Application.Width = 290
    Application.Height = 250
    Application.Left = 455
    Application.Top = 280
    
    Set sh = CreateObject("Shell.Application")  'ShellWindow|fffd||fffd|wins|fffd||24a|i|fffd|[
    'ShellWindow|fffd||fffd||fffd||fffd|1|fffd||82||c2||8e||64fe||fffd||fffd||fffd||10f||fffd||fffd||fffd|
    For Each win In sh.Windows
        On Error Resume Next
        winname = ""
        winname = win.FullName
        On Error GoTo 0
        'IE|fffd||303|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|X|fffd||30f||a347||fffd|m|fffd|F|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|\|fffd||fffd|
        If LCase(Right(winname, 12)) = "iexplore.exe" Then
            '2013/03/27 Metro IE|fffd||fffd||fffd||fffd||fffd|O|fffd||1c9||fffd|
            If checkDesktopIe(win) = True Then
                showForeground win.hWnd
                showForeground ThisWorkbook.Application.hWnd
                If MsgBox("|fffd||fffd||fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion, "|fffd||38f||6cc||fffd||fffd||fffd||fffd||fffd|...") = vbYes Then
                    Set ie = win
                    Exit For
                End If
            End If
        End If
    Next
    
    Application.Width = WidthBefore
    Application.Height = HeightBefore
    Application.Left = LeftBefore
    Application.Top = TopBefore

    Set getIEByMsg = ie
End Function


'|fffd||fffd||fffd||30e|w|fffd||fffd||143|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getFrameDocumentByName(htDoc As HTMLDocument, Name As String) As HTMLDocument
    Dim ret As HTMLDocument
    Dim i As Long
    
    'Name|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||fffd|htdoc|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||702||703||fffd||fffd|^|fffd|[|fffd||fffd|
    If Trim(Name) = "" Then
        Set getFrameDocumentByName = htDoc
        Exit Function
    End If
    
    '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||30e||64fe||fffd||fffd||fffd||fffd||fffd||742||fffd|
    On Error Resume Next
    Set ret = htDoc.frames.Item(Trim(Name)).document
    On Error GoTo 0
    '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|^|fffd|[|fffd||fffd|
    If Not ret Is Nothing Then
        Set getFrameDocumentByName = ret
        Exit Function
    End If
    
    '|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||251||382||fffd||fffd||fffd||10b|A|fffd||fffd||fffd||fffd|
    If htDoc.frames.Length > 0 Then
        For i = 0 To htDoc.frames.Length - 1
            Set ret = getFrameDocumentByName(htDoc.frames.Item(i).document, Name)
            If Not ret Is Nothing Then
                Exit For
            End If
        Next
    End If
    
    Set getFrameDocumentByName = ret
End Function


'|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||103|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getFrameDocumentByMsg(ie As InternetExplorer, Optional htDoc As HTMLDocument) As HTMLDocument
    Dim fra As HTMLFrameElement
    Dim tempHTMLDoc As HTMLDocument
    Dim retHTMLDoc As HTMLDocument
    Dim i As Long

    Dim WidthBefore As Long
    Dim HeightBefore As Long
    Dim LeftBefore As Long
    Dim TopBefore As Long
    Application.WindowState = xlNormal
    WidthBefore = Application.Width
    HeightBefore = Application.Height
    LeftBefore = Application.Left
    TopBefore = Application.Top
    Application.Width = 290
    Application.Height = 250
    Application.Left = 455
    Application.Top = 280
    
    'HTML|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||30e|w|fffd||fffd|
    If htDoc Is Nothing Then
        Set tempHTMLDoc = ie.document
    Else
        Set tempHTMLDoc = htDoc
    End If
    
    '|fffd|q|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||251||382||fffd||fffd||fffd||10b|A|fffd||fffd||fffd||fffd|
    If tempHTMLDoc.frames.Length > 1 Then
        For i = 0 To tempHTMLDoc.getElementsByTagName("frame").Length - 1
            If retHTMLDoc Is Nothing Then
                With tempHTMLDoc.frames.Item(i).document.body.Style
                    .borderStyle = "solid"
                    .borderWidth = "6px"
                    .borderColor = "red"
                    showForeground ie.hWnd
                    showForeground ThisWorkbook.Application.hWnd

                    If MsgBox("|fffd||fffd||351||38f||6c2||342||fffd||fffd||303|t|fffd||fffd||fffd|[|fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion, "|fffd||fffd||351||38f||6cc||fffd||fffd||fffd||fffd||fffd|...") = vbYes Then
                        Set retHTMLDoc = tempHTMLDoc.frames.Item(i).document
                        .borderStyle = "none"
                        Exit For
                    End If
                    .borderStyle = "none"
                End With
                If tempHTMLDoc.frames.Item(i).document.frames.Length > 0 Then
                    Set retHTMLDoc = getFrameDocumentByMsg(ie, tempHTMLDoc.frames.Item(i).document)
                End If
                DoEvents
            Else
                Exit For
            End If
        Next
    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||351|S|fffd||302||fffd||fffd||fffd||fffd||302||702||703||fffd||fffd|^|fffd|[|fffd||fffd|
    Else
        Set retHTMLDoc = tempHTMLDoc
    End If

    Application.Width = WidthBefore
    Application.Height = HeightBefore
    Application.Left = LeftBefore
    Application.Top = TopBefore
    
    Set getFrameDocumentByMsg = retHTMLDoc
End Function


'HTML|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||295||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getHTMLElements(htDoc As HTMLDocument, Optional ContainHidden As Boolean, Optional addNumber As Boolean) As ElementInfo()
    Dim elm As IHTMLElement
    Dim i As Long
    Dim j As Long
    Dim ret() As ElementInfo
    Dim elms As IHTMLElementCollection
    Dim opt As HTMLOptionElement
    Dim RegisteredRadio As New Collection
    
    Set elms = htDoc.all
    
    i = 0
    For Each elm In elms
        '|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd||30f||a347|
        If UCase(elm.tagName) = "INPUT" Or UCase(elm.tagName) = "SELECT" Or UCase(elm.tagName) = "TEXTAREA" Then
            '|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||695|\|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||142||342||202||fffd||fffd|A|fffd||fffd||fffd||91||38f||6c2||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||682||30f||a347|
            If Not ContainHidden And (elm.Type = "hidden" Or elm.Style.Display = "none") Then
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
            '|fffd||fffd||fffd||fffd||20a|O|fffd||30f||a347|
            Else
                Select Case elm.Type
                    Case "select-one"
                        ReDim Preserve ret(i)
                        ret(i) = getSelectElementInfo(elm)
                        If addNumber Then elm.outerHTML = elm.outerHTML & getDecoNumber(i)
                        i = i + 1
                    Case "radio"
                        '|fffd||fffd||fffd|W|fffd|I|fffd||fffd||fffd||fffd||fffd||3c1|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a|m|fffd|F
                        On Error Resume Next
                        RegisteredRadio.Add elm.Name, elm.Name
                        If Err.Number = 457 Then
                            On Error GoTo 0
                            '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|H
                        Else
                            On Error GoTo 0
                            ReDim Preserve ret(i)
                            '2013/01/31 Window8+IE10|fffd||389||fffd||fffd|igetElementById|fffd||fffd|getElementsByName|fffd|j
                            ret(i) = getRadioElementInfo(htDoc.getElementsByName(elm.Name)(0))
                            j = 0
                            '2013/01/31 Window8+IE10|fffd||389||fffd||fffd|igetElementById|fffd||fffd|getElementsByName|fffd|j
                            For Each opt In htDoc.getElementsByName(elm.Name)
                                If addNumber Then opt.outerHTML = opt.outerHTML & getDecoNumber(i, j, True)
                                j = j + 1
                            Next
                            i = i + 1
                        End If
                    Case "checkbox"
                        ReDim Preserve ret(i)
                        ret(i) = getCheckBoxElementInfo(elm)
                        If addNumber Then elm.outerHTML = elm.outerHTML & getDecoNumber(i)
                        i = i + 1
                    Case Else
                        ReDim Preserve ret(i)
                        ret(i) = getElementInfo(elm)
                        If addNumber Then elm.outerHTML = elm.outerHTML & getDecoNumber(i)
                        i = i + 1
                End Select
            End If
        End If
    Next
    
    getHTMLElements = ret
End Function

'|fffd||fffd||fffd||683|i|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||30e||64fe|
Private Function getDecoNumber(Num As Long, Optional subnum As Long, Optional useSubNum As Long) As String
    If Not useSubNum Then
        getDecoNumber = "<font color=""#0000FF"" size=-1>[" & Num & "]</font>"
    Else
        getDecoNumber = "<font color=""#0000FF"" size=-1>[" & Num & "]-" & subnum & "</font>"
    End If
End Function



'/****************************************************************************
' * |fffd||fffd||fffd||692||fffd|`|fffd||303||fffd||fffd|[|fffd|U|fffd|[|fffd||fffd|`|fffd|^|fffd||64fe|
' ****************************************************************************/
'|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|ElementInfo|fffd||fffd|
Private Function getElementInfo(elm As IHTMLElement) As ElementInfo
    Dim ret As ElementInfo

    ret.Id = elm.Id
    ret.Name = elm.Name
    ret.TypeOriginal = elm.Type
    ret.Value = elm.Value
    On Error Resume Next
    ret.onClick = elm.onClick
    ret.onChange = elm.onChange
    ret.onBlur = elm.onBlur
    On Error GoTo 0
    ret.TypeWithEvent = toTypeWithEvent(ret)

    getElementInfo = ret
End Function

'|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|ElementInfo|fffd||fffd|
Private Function getCheckBoxElementInfo(elm As IHTMLElement) As ElementInfo
    Dim ret As ElementInfo

    ret.Id = elm.Id
    ret.Name = elm.Name
    ret.TypeOriginal = elm.Type
    If elm.Checked Then
        ret.Value = "1"
    Else
        ret.Value = "0"
    End If
    On Error Resume Next
    ret.onClick = elm.onClick
    On Error GoTo 0
    ret.TypeWithEvent = toTypeWithEvent(ret)

    getCheckBoxElementInfo = ret
End Function

'|fffd|Z|fffd||fffd||fffd|N|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||fffd|ElementInfo|fffd||fffd|
Private Function getSelectElementInfo(elm As IHTMLElement) As ElementInfo
    Dim ret As ElementInfo
    Dim i As Long
    Dim opt As HTMLOptionElement

    ret.Id = elm.Id
    ret.Name = elm.Name
    ret.TypeOriginal = elm.Type
    ret.Value = elm.Value
    On Error Resume Next
    ret.onClick = elm.onClick
    ret.onChange = elm.onChange
    ret.onBlur = elm.onBlur
    On Error GoTo 0
    ret.TypeWithEvent = toTypeWithEvent(ret)

    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||24a|i|fffd|[
    i = 0
    For Each opt In elm.Options
        ReDim Preserve ret.Options(i)
        ret.Options(i).Value = opt.Value
        ret.Options(i).Display = opt.innerText
        i = i + 1
    Next

    getSelectElementInfo = ret
End Function

'|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||fffd|ElementInfo|fffd||fffd|
Private Function getRadioElementInfo(radios As IHTMLElementCollection) As ElementInfo
    Dim RadioElement As HTMLInputElement
    Dim ret As ElementInfo
    Dim i As Long
    
    '|fffd|e|fffd||fffd||fffd|W|fffd|I|fffd||24b||fffd||fffd||282||20d||fffd||fffd||682||fffd||fffd||fffd||fffd||fffd|
    ret.Id = radios(0).Id
    ret.Name = radios(0).Name
    ret.TypeOriginal = radios(0).Type
    ret.TypeWithEvent = toTypeWithEvent(ret)
    
    '|fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[
    ReDim Preserve ret.Options(radios.Length - 1)
    For Each RadioElement In radios
        If RadioElement.Checked = True Then ret.Value = RadioElement.Value
        ret.Options(i).Display = RadioElement.Value
        ret.Options(i).Value = RadioElement.Value
        i = i + 1
    Next
    
    getRadioElementInfo = ret
End Function

'|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||82||fffd||fffd||303|^|fffd|C|fffd|v|fffd||fffd||fffd||255||3ca||fffd|
Private Function toTypeWithEvent(argElement As ElementInfo) As String
    Select Case argElement.TypeOriginal
        '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30f||a347|
        Case "text"
            If argElement.onChange <> "" Then
                toTypeWithEvent = TXT_CHANGE
            ElseIf argElement.onClick <> "" Then
                toTypeWithEvent = TXT_ONFOCUS
            ElseIf argElement.onBlur <> "" Then
                toTypeWithEvent = TXT_ONBLUR
            Else
                toTypeWithEvent = TXT
            End If
        '|fffd|e|fffd|L|fffd|X|fffd|g|fffd|G|fffd||fffd||fffd|A|fffd||30f||a347|
        Case "textarea"
            If argElement.onBlur <> "" Then
                toTypeWithEvent = TEXTAREA_ONBLUR
            Else
                toTypeWithEvent = TEXTAREA
            End If
        '|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||30f||a347|
        Case "select-one"
            If argElement.onChange <> "" Then
                toTypeWithEvent = PULLDOWN_ONCHANGE
            Else
                toTypeWithEvent = PULLDOWN
            End If
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||30f||a347|
        Case "checkbox"
            If argElement.onClick <> "" Then
                toTypeWithEvent = CHK_CLICK
            Else
                toTypeWithEvent = chk
            End If
        '|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd||fffd||30f||a347|
        Case "radio"
            toTypeWithEvent = RADIO
        '|fffd||fffd||fffd||fffd||20a|O|fffd||30f||a347|
        Case Else
            toTypeWithEvent = argElement.TypeOriginal
    End Select
End Function



'/****************************************************************************
' * |fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|l|fffd||64fe||fffd|^|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||64fe||fffd|^|fffd||fffd||fffd||341|j
' ****************************************************************************/
'|fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getTDValue(htDoc As HTMLDocument, key As String, Optional Skip As Long, Optional offset As Long) As String
    startOf "getTDValue"
    
    Dim ret As String
    Dim tds As IHTMLElementCollection
    Dim td As HTMLTableCell
    Dim skipCount As Long
    
    skipCount = Skip
    Set tds = htDoc.getElementsByTagName("TD")
    
    For Each td In tds
        If InStr(td.innerText, key) > 0 Then
            If skipCount > 0 Then
                skipCount = skipCount - 1
            Else
                Log key & "|fffd||311||38f||6c3|Z|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
                ret = Trim(htDoc.all(td.sourceIndex + offset).innerText)
                Exit For
            End If
        End If
    Next
    getTDValue = ret
    
    endOf "getTDValue"
End Function

'|fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|HTML|fffd|v|fffd|f|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getTDCell(htDoc As HTMLDocument, key As String, Optional Skip As Long, Optional offset As Long) As IHTMLElement
    Dim ret As IHTMLElement
    Dim tds As IHTMLElementCollection
    Dim td As HTMLTableCell
    Dim skipCount As Long
    
    skipCount = Skip
    Set tds = htDoc.getElementsByTagName("TD")
    
    For Each td In tds
        If InStr(td.innerText, key) > 0 Then
            If skipCount > 0 Then
                skipCount = skipCount - 1
            Else
                Set ret = htDoc.all(td.sourceIndex + offset)
                Exit For
            End If
        End If
    Next
    Set getTDCell = ret
End Function

'|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||fffd|TD|fffd|l|fffd||30e||64fe||fffd||255|K|fffd|v|fffd||20f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getTDAccessPath(ie As InternetExplorer, htDoc As HTMLDocument, key As String) As ElementInfo
    Dim ret As ElementInfo
    Dim tds As IHTMLElementCollection
    Dim td As HTMLTableCell
    Dim skipCount As Long
    Dim keySourceIndex As Long
    Dim offsetCount As Long
    Dim tempValue As String
    
    Set tds = htDoc.getElementsByTagName("TD")

    Dim WidthBefore As Long
    Dim HeightBefore As Long
    Dim LeftBefore As Long
    Dim TopBefore As Long
    Application.WindowState = xlNormal
    WidthBefore = Application.Width
    HeightBefore = Application.Height
    LeftBefore = Application.Left
    TopBefore = Application.Top
    Application.Width = 290
    Application.Height = 250
    Application.Left = 455
    Application.Top = 280

    skipCount = 0
    For Each td In tds
        If InStr(td.innerText, key) > 0 Then
            With td.Style
                .borderStyle = "solid"
                .borderWidth = "4px"
                .borderColor = "red"
            End With
            showForeground ie.hWnd
            showForeground ThisWorkbook.Application.hWnd
            If MsgBox("|fffd|u" & key & "|fffd|v|fffd||303|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd|Z|fffd||fffd||fffd||342||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion, "|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd|Z|fffd||fffd||fffd||30c||fffd||fffd||fffd|") = vbYes Then
                td.Style.borderStyle = "none"
                keySourceIndex = td.sourceIndex
                Exit For
            Else
                skipCount = skipCount + 1
            End If
            td.Style.borderStyle = "none"
        End If
    Next

    offsetCount = 0
    For Each td In tds
        If keySourceIndex <= td.sourceIndex Then
            With td.Style
                .borderStyle = "solid"
                .borderWidth = "4px"
                .borderColor = "blue"
            End With
            showForeground ie.hWnd
            showForeground ThisWorkbook.Application.hWnd
            If MsgBox("|fffd|u" & key & "|fffd|v|fffd||312|l|fffd|Z|fffd||fffd||fffd||342||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo + vbQuestion, "|fffd|l|fffd|Z|fffd||fffd||fffd||30c||fffd||fffd||fffd|") = vbYes Then
                td.Style.borderStyle = "none"
                offsetCount = td.sourceIndex - keySourceIndex
                tempValue = td.innerText
                Exit For
            End If
            td.Style.borderStyle = "none"
        End If
    Next
    
    ret.Id = "TD_" & key & "_" & Trim(Str(keySourceIndex))
    ret.TypeWithEvent = "TD"
    ret.Name = key
    ret.SearchKey = key
    ret.Skip = skipCount
    ret.offset = offsetCount
    ret.Value = tempValue

    Application.Width = WidthBefore
    Application.Height = HeightBefore
    Application.Left = LeftBefore
    Application.Top = TopBefore
    
    getTDAccessPath = ret
End Function


'ID|fffd||308||fffd|v|fffd||fffd||fffd||fffd||fffd||28d||fffd||fffd||68f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getElementInfoById(ByRef elms() As ElementInfo, Id As String, Optional Name As String) As ElementInfo
    Dim i As Long
    For i = 0 To UBound(elms)
        If (Trim(elms(i).Id) = Trim(Id) And Trim(Id) <> "") Or (Trim(elms(i).Name) = Trim(Name) And Trim(Name) <> "") Then
            getElementInfoById = elms(i)
            Exit Function
        End If
    Next
End Function

'ID|fffd||308||fffd|v|fffd||fffd||fffd||fffd||fffd||28d||fffd||fffd||68f||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getDataElementById(ByRef de() As DataElement, Id As String, Optional Name As String) As DataElement
    Dim i As Long
    For i = 0 To UBound(de)
        If (Trim(de(i).getElementID) = Trim(Id) And Trim(Id) <> "") Or (Trim(de(i).getElementID) = Trim(Name) And Trim(Name) <> "") Then
            Set getDataElementById = de(i)
            Exit Function
        End If
    Next
    Set getDataElementById = Nothing
End Function


'2015/12/07 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'Public Function clickButton(htdoc As HTMLDocument, caption As String, Optional doOnClick As Boolean) As Boolean
'    Dim btn As HTMLInputElement
'    Dim ret As Boolean
'
'    ret = False
'    For Each btn In htdoc.getElementsByTagName("INPUT")
'        If (btn.Type = "button" Or btn.Type = "submit") And InStr(btn.value, caption) > 0 Then
'            If doOnClick And btn.Type = "button" Then
'                htdoc.parentWindow.setTimeout btn.onClick, 1
'            Else
'                btn.Click
'            End If
'            ret = True
'            Exit For
'        End If
'    Next
'
'    clickButton = ret
'End Function
'2015/12/07 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'2015/12/03 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'ID|fffd|w|fffd||fffd||242||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function ClickButtonByID(ByRef htDoc As HTMLDocument, ByVal btnId As String, Optional ByVal doAsync As Boolean = False) As Boolean
    startOf "ClickButtonByID"

    Dim btn As HTMLInputElement
    Dim ret As Boolean
    
    Set btn = htDoc.getElementById(btnId)
    
    ret = False
    If btn Is Nothing Then
        Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btnId & "|fffd|v|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ret = False
    ElseIf btn.disabled Then
        Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btn.Value & "|fffd|v|fffd||fffd|Disabled|fffd||302||fffd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
        ret = False
    Else
        If doAsync Then
            ret = AsynchronousClickElement(btn)
        Else
            btn.Click
            ret = True
        End If
    End If

    ClickButtonByID = ret
    endOf "ClickButtonByID"
End Function

'Name|fffd|w|fffd||fffd||242||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function ClickButtonByName(ByRef htDoc As HTMLDocument, ByVal btnName As String, no As Long, Optional ByVal doAsync As Boolean = False) As Boolean
    startOf "ClickButtonByName"

    Dim btn As HTMLInputElement
    Dim ret As Boolean
    
    Set btn = htDoc.getElementsByName(btnName)(no)
    
    ret = False
    If btn Is Nothing Then
        Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btnName & "(" & no & ")|fffd|v|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        ret = False
    ElseIf btn.disabled Then
        Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btn.Value & "|fffd|v|fffd||fffd|Disabled|fffd||302||fffd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
        ret = False
    Else
        If doAsync Then
            ret = AsynchronousClickElement(btn)
        Else
            btn.Click
            ret = True
        End If
    End If

    ClickButtonByName = ret
    endOf "ClickButtonByName"
End Function

'Value|fffd|w|fffd||fffd||242||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function ClickButtonByValue(ByRef htDoc As HTMLDocument, ByVal caption As String, Optional ByVal doAsync As Boolean = False) As Boolean
    startOf "ClickButtonByValue"
    
    Dim btn As HTMLInputElement
    Dim ret As Boolean
    
    ret = False
    For Each btn In htDoc.getElementsByTagName("INPUT")
        If (UCase(btn.Type) = "BUTTON" Or UCase(btn.Type) = "SUBMIT") And InStr(btn.Value, caption) > 0 Then
            If btn.disabled Then
                Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btn.Value & "|fffd|v|fffd||fffd|Disabled|fffd||302||fffd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                ret = False
            Else
                If doAsync Then
                    ret = AsynchronousClickElement(btn)
                Else
                    btn.Click
                    ret = True
                End If
            End If
            Exit For
        End If
    Next

    ClickButtonByValue = ret
    endOf "ClickButtonByValue"
End Function

'InnerText|fffd|w|fffd||fffd||242||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|iBUTTON|fffd|^|fffd|O|fffd|p|fffd|j
Public Function ClickButtonByInnerText(ByRef htDoc As HTMLDocument, ByVal caption As String, Optional ByVal doAsync As Boolean = False) As Boolean
    startOf "ClickButtonByInnerText"
    
    Dim btn As HTMLButtonElement
    Dim ret As Boolean
    
    ret = False
    For Each btn In htDoc.getElementsByTagName("BUTTON")
        If InStr(btn.innerText, caption) > 0 Then
            If btn.disabled Then
                Log "|fffd|{|fffd|^|fffd||fffd||fffd|u" & btn.Value & "|fffd|v|fffd||fffd|Disabled|fffd||302||fffd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
                ret = False
            Else
                If doAsync Then
                    ret = AsynchronousClickElement(btn)
                Else
                    btn.Click
                    ret = True
                End If
            End If
            Exit For
        End If
    Next

    ClickButtonByInnerText = ret
    endOf "ClickButtonByInnerText"
End Function

'|fffd||53bca||fffd||fffd|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function AsynchronousClickElement(ByRef target As IHTMLElement) As Boolean
    startOf "AsynchronousClickElement"

    'setTimeout|fffd||fffd|String|fffd|^|fffd||153|n|fffd||fffd||fffd||188||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||242||202||fffd||302||fffd|Variant|fffd|^
    Dim scriptForClick As Variant
    Dim scriptForSetBtn As String
    Dim scriptForChkTarget As String

    'ID|fffd||317|L|fffd||fffd||fffd||242||fffd||fffd||fffd||103|Z|fffd|b|fffd|g|fffd||fffd||fffd|@|fffd||fffd|U|fffd||856a||fffd||fffd|
    If target.Id <> "" Then
        scriptForSetBtn = "document.getElementById('" & target.Id & "')"
    Else
        ' ID|fffd|w|fffd||fffd||202||fffd||fffd||30f||a347||fffd||353||fffd||fffd||fffd|TagName|fffd|R|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||fffd|
        Dim tagIndex As Long
        Dim elm As IHTMLElement
        For Each elm In target.OwnerDocument.getElementsByTagName(target.tagName)
            If elm Is target Then
                Exit For
            Else
                tagIndex = tagIndex + 1
            End If
        Next
        
        scriptForSetBtn = "document.getElementsByTagName('" & target.tagName & "')[" & tagIndex & "]"
    End If
    
    '|fffd||38f||6c2||30c|^|fffd||242||fffd||fffd||fffd||10a|m|fffd|F|fffd||fffd||fffd|@|fffd||fffd|U|fffd||856a||fffd||fffd|
    Select Case UCase(TypeName(target))
    Case "HTMLINPUTELEMENT"
        scriptForChkTarget = "if(target.value=='" & target.Value & "' && target.disabled == false){"
    Case "HTMLBUTTONELEMENT"
        'Button|fffd|^|fffd|O|fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||15850||fffd||fffd||702||749||fffd||fffd|s|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7ce||fffd||83dc||fffd||fffd||fffd||114||fffd|r
        scriptForChkTarget = "if(target.innerText.replace(/[\n\r]/g,"""")=='" & Replace(target.innerText, vbCrLf, "") _
                                & "' && target.disabled == false){"
    Case "HTMLANCHORELEMENT"
        scriptForChkTarget = "if(target.innerText=='" & target.innerText & "'){"
    Case Else
        AsynchronousClickElement = False
        ExitOf "AsynchronousClickElement", TypeName(target) & "|fffd||351|z|fffd||fffd|O|fffd||302||fffd||fffd||7ce||fffd||fffd|s|fffd||142||fffd||fffd||702||fffd||fffd||fffd|"
        Exit Function
    End Select
    
    '|fffd|w|fffd||80b5||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||7d1||fffd||fffd||fffd||fffd|A|fffd||38f||6c2||18a|m|fffd|F|fffd||142||fffd||fffd||fffd||fffd||a347||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g
    scriptForClick = "var target = " & scriptForSetBtn & ";" _
                    & scriptForChkTarget _
                    & "target.click();" _
                    & "}else{" _
                    & "alert('|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||303|{|fffd|^|fffd||fffd||fffd||7d1||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd|');" _
                    & "}"
    
    Dim sccessed As Boolean
    sccessed = True
    
    On Error Resume Next
    target.OwnerDocument.parentWindow.setTimeout scriptForClick, 1
    If Err.Number <> 0 Then
        sccessed = False
        Log Err.Number & ":" & Err.Description
    End If
    On Error GoTo 0
    
    AsynchronousClickElement = sccessed
    
    endOf "AsynchronousClickElement"
End Function
'2015/12/03 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

'|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Function clickAnchor(htdoc As HTMLDocument, caption As String, Optional doHref As Boolean) As Boolean
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function clickAnchor(ByRef htDoc As HTMLDocument, ByVal caption As String, Optional ByVal doAsync As Boolean = False) As Boolean
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    startOf "clickAnchor"
    Dim a As HTMLAnchorElement
    Dim ret As Boolean
    
    ret = False
    For Each a In htDoc.getElementsByTagName("A")
        If InStr(a.innerText, caption) > 0 Then
'2015/12/07 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            If doHref And InStr(UCase(a.href), "SCRIPT:") > 0 Then
'                htDoc.parentWindow.setTimeout a.href, 1
'2015/12/07 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/07 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If doAsync Then
                Call AsynchronousClickElement(a)
'2015/12/07 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
            Else
                a.Click
            End If
            ret = True
            Exit For
        End If
    Next
    
    clickAnchor = ret
    endOf "clickAnchor"
End Function


'Element|fffd||311||fffd||fffd||74a|m|fffd|F
Public Function ElementExists(htDoc As HTMLDocument, Id As String) As Boolean
    Dim en As Integer
    Dim temp As String
    On Error Resume Next
    '2013/01/31 Window8+IE10|fffd||389||fffd||fffd|igetElementById|fffd||fffd|getElementsByName|fffd|j
    temp = htDoc.getElementsByName(Id)(0).Value
    en = Err.Number
    On Error GoTo 0
    If en = 0 Then
        ElementExists = True
    Else
        ElementExists = False
    End If
End Function



'/*******************************************************
' * Registry|fffd||598|A
' *******************************************************/
'|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||30e|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||250||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||781|B
Public Function setValue(hKey As hKeyConst, key As String, Value As String, TypeOfVal As TypeConst, ByVal data As Variant) As Boolean
#If Win64 Then
    Dim KeyHandle As LongPtr
#Else
    Dim KeyHandle As Long
#End If
    Dim SA As SECURITY_ATTRIBUTES
    Dim lngValue As Long
    Dim strValue As String
    Dim lngResult As Long

    ' |fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd|
    setValue = False
    ' |fffd|L|fffd|[|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd|V|fffd|K|fffd||c42c||fffd||fffd||fffd||fffd|
    lngResult = RegCreateKeyEx(hKey, key, 0, "", REG_OPTION_NON_VOLATILE, KEY_ALL_ACCESS, SA, KeyHandle, ByVal 0)
    If lngResult = ERROR_SUCCESS Then
        Select Case TypeOfVal
            Case REG_DWORD
                lngValue = CLng(data)
                lngResult = RegSetValueEx(KeyHandle, Value, 0, REG_DWORD, lngValue, Len(lngValue))
                setValue = (lngResult = ERROR_SUCCESS)
            Case REG_SZ
                strValue = CStr(data)
                lngResult = RegSetValueEx(KeyHandle, Value, 0, REG_SZ, ByVal strValue, CLng(LenB(StrConv(strValue, vbFromUnicode)) + 1))
                setValue = (lngResult = ERROR_SUCCESS)
            Case REG_BINARY
                lngResult = RegSetValueEx(KeyHandle, Value, 0, REG_BINARY, ByVal strValue, data)
                setValue = (lngResult = ERROR_SUCCESS)
        End Select
        ' |fffd|L|fffd|[|fffd||fffd||fffd|N|fffd||fffd||fffd|[|fffd|Y|fffd||fffd||fffd||fffd|B
        Call RegCloseKey(KeyHandle)
    End If
End Function

'|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||30e|w|fffd||80b3||fffd||a0bd||fffd|L|fffd|[|fffd||312|l|fffd||fffd||1c2||74e||fffd||fffd|B
Public Function getValue(hKey As hKeyConst, key As String, Value As String, TypeOfVal As TypeConst) As Variant
    Dim ret As Variant
#If Win64 Then
    Dim KeyHandle As LongPtr
#Else
    Dim KeyHandle As Long
#End If
    Dim lngBuffer As Long
    Dim strBuffer As String
    Dim lngResult As Long

    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||30e|w|fffd||80b5||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
    lngResult = RegOpenKeyEx(hKey, key, 0, KEY_ALL_ACCESS, KeyHandle)
    
    If lngResult = ERROR_SUCCESS Then
        Select Case TypeOfVal
            Case REG_DWORD
                lngResult = RegQueryValueEx(KeyHandle, Value, 0, REG_DWORD, lngBuffer, Len(lngBuffer))
                If lngResult = ERROR_SUCCESS Then
                    ret = lngBuffer
                End If
            Case REG_SZ
                strBuffer = String(256, vbNullChar)
                lngResult = RegQueryValueEx(KeyHandle, Value, 0, REG_SZ, ByVal strBuffer, Len(strBuffer))
                If lngResult = ERROR_SUCCESS Then
                    ret = Left$(strBuffer, InStr(strBuffer, vbNullChar) - 1)
                End If
        End Select
        lngResult = RegCloseKey(KeyHandle)
    End If
    
    getValue = ret
End Function

'|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||303|L|fffd|[|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
Public Function deleteKey(hKey As hKeyConst, key As String) As Long
    deleteKey = RegDeleteKey(hKey, key)
End Function

'|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||312|l|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
Public Sub deleteValue(hKey As hKeyConst, key As String, Value As String)
#If Win64 Then
    Dim KeyHandle As LongPtr
#Else
    Dim KeyHandle As Long
#End If
    Dim lngResult As Long
    '|fffd||fffd||fffd|W|fffd|X|fffd|g|fffd||fffd||fffd||30e|w|fffd||80b5||fffd||fffd||fffd|L|fffd|[|fffd||fffd||fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd|B
    lngResult = RegOpenKeyEx(hKey, key, 0, KEY_ALL_ACCESS, KeyHandle)
    '|fffd|l|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
    RegDeleteValue KeyHandle, Value
End Sub



'/*******************************************************
' * ScreenShot|fffd||598|A
' *******************************************************/
'|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||6d1||fffd|
#If Win64 Then
Public Sub saveScreenShot(fileName As String, hWnd As LongPtr)
#Else
Public Sub saveScreenShot(fileName As String, hWnd As Long)
#End If
    startOf "saveScreenShot"
    
    Dim pict As IPictureDisp
    
    Log "|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
    Set pict = getScreenShot(hWnd)
    Log "|fffd||64fe||fffd||fffd||fffd||fffd||fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||6d1||fffd||fffd||fffd||fffd||702||fffd|"
    SavePicture pict, fileName

    endOf "saveScreenShot"
End Sub


'|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||fffd|s|fffd|N|fffd|`|fffd||fffd||fffd|[|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||182||fffd||fffd||115||50b|p
#If Win64 Then
Public Function getScreenShot(Optional hWnd As LongPtr) As IPictureDisp
    startOf "getScreenShot"
    Dim h As LongPtr
#Else
Public Function getScreenShot(Optional hWnd As Long) As IPictureDisp
    startOf "getScreenShot"
    Dim h As Long
#End If

    If hWnd = 0 Then
        Log "|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|w|fffd||80aa||fffd||202||fffd||fffd||fffd||fffd||7c3|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|S|fffd||302||303|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
        h = GetDesktopWindow()
    Else
        Log "|fffd|w|fffd||80b3||fffd||a0bd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||303|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd|F" & h
        h = hWnd
    End If
    
    Log "|fffd|X|fffd|N|fffd||fffd||fffd|[|fffd||fffd||fffd|V|fffd||fffd||fffd|b|fffd|g|fffd||64fe||fffd||30e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||702||fffd|"
    Set getScreenShot = captureWindow(h, False, 0, 0, GetSystemMetrics(0), GetSystemMetrics(1))
    
    endOf "getScreenShot"
End Function


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' hBmp
'    - Handle to a bitmap.
' hPal
'    - Handle to a Palette.
'    - Can be null if the bitmap doesn't use a palette.
' Returns
'    - Returns a Picture object containing the bitmap.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#If Win64 Then
Private Function createBitmapPicture(ByVal hBmp As LongPtr, ByVal hPal As LongPtr) As Object
    Dim r As LongPtr
#Else
Private Function createBitmapPicture(ByVal hBmp As Long, ByVal hPal As Long) As Object
    Dim r As Long
#End If
    Dim pic As PicBmp
    ' IPicture requires a reference to "Standard OLE Types."
    Dim IPic As IPicture
    Dim IID_IDispatch As GUID
    ' Fill in with IDispatch Interface ID.
    With IID_IDispatch
        .Data1 = &H20400
        .Data4(0) = &HC0
        .Data4(7) = &H46
    End With
    ' Fill Pic with necessary parts.
    With pic
        .size = Len(pic)          ' Length of structure.
        .Type = vbPicTypeBitmap   ' Type of Picture (bitmap).
        .hBmp = hBmp              ' Handle to bitmap.
        .hPal = hPal              ' Handle to palette (may be null).
    End With
    ' Create Picture object.
    r = OleCreatePictureIndirect(pic, IID_IDispatch, 1, IPic)
    ' Return the new Picture object.
    Set createBitmapPicture = IPic
End Function


'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
' hWndSrc
'    - Handle to the window to be captured.
'
' Client
'    - If True CaptureWindow captures from the client area of the window.
'    - If False CaptureWindow captures from the entire window.
'
' LeftSrc, TopSrc, WidthSrc, HeightSrc
'    - Specify the portion of the window to capture.
'    - Dimensions need to be specified in pixels.
'
' Returns
'    - Returns a Picture object containing a bitmap of the specified
'      portion of the window that was captured.
'''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
#If Win64 Then
Private Function captureWindow(ByVal hWndSrc As LongPtr, ByVal Client As Boolean, ByVal LeftSrc As Long, ByVal TopSrc As Long, ByVal WidthSrc As Long, ByVal HeightSrc As Long) As IPictureDisp
    Dim hDCMemory As LongPtr
    Dim hBmp As LongPtr
    Dim hBmpPrev As LongPtr
    Dim hDCSrc As LongPtr
    Dim hPal As LongPtr
    Dim hPalPrev As LongPtr
#Else
Private Function captureWindow(ByVal hWndSrc As Long, ByVal Client As Boolean, ByVal LeftSrc As Long, ByVal TopSrc As Long, ByVal WidthSrc As Long, ByVal HeightSrc As Long) As IPictureDisp
    Dim hDCMemory As Long
    Dim hBmp As Long
    Dim hBmpPrev As Long
    Dim hDCSrc As Long
    Dim hPal As Long
    Dim hPalPrev As Long
#End If
    Dim r As Long
    Dim RasterCapsScrn As Long
    Dim HasPaletteScrn As Long
    Dim PaletteSizeScrn As Long
    Dim LogPal As LOGPALETTE

    ' Depending on the value of Client get the proper device context.
    If Client Then
        hDCSrc = GetDC(hWndSrc) ' Get device context for client area.
    Else
        hDCSrc = GetWindowDC(hWndSrc) ' Get device context for entire
    End If
    
    ' Create a memory device context for the copy process.
    hDCMemory = CreateCompatibleDC(hDCSrc)
    ' Create a bitmap and place it in the memory DC.
    hBmp = CreateCompatibleBitmap(hDCSrc, WidthSrc, HeightSrc)
    hBmpPrev = SelectObject(hDCMemory, hBmp)
    ' Get screen properties.
    RasterCapsScrn = GetDeviceCaps(hDCSrc, RASTERCAPS)
    HasPaletteScrn = RasterCapsScrn And RC_PALETTE
    PaletteSizeScrn = GetDeviceCaps(hDCSrc, SIZEPALETTE)
    ' If the screen has a palette make a copy and realize it.
    If HasPaletteScrn And (PaletteSizeScrn = 256) Then
        ' Create a copy of the system palette.
        LogPal.palVersion = &H300
        LogPal.palNumEntries = 256
        r = GetSystemPaletteEntries(hDCSrc, 0, 256, _
        LogPal.palPalEntry(0))
        hPal = CreatePalette(LogPal)
        ' Select the new palette into the memory DC and realize it.
        hPalPrev = SelectPalette(hDCMemory, hPal, 0)
        r = RealizePalette(hDCMemory)
    End If
    ' Copy the on-screen image into the memory DC.
    r = BitBlt(hDCMemory, 0, 0, WidthSrc, HeightSrc, hDCSrc, _
    LeftSrc, TopSrc, vbSrcCopy)
    ' Remove the new copy of the  on-screen image.
    hBmp = SelectObject(hDCMemory, hBmpPrev)
    ' If the screen has a palette get back the palette that was
    ' selected in previously.
    If HasPaletteScrn And (PaletteSizeScrn = 256) Then
        hPal = SelectPalette(hDCMemory, hPalPrev, 0)
    End If
    ' Release the device context resources back to the system.
    r = DeleteDC(hDCMemory)
    r = ReleaseDC(hWndSrc, hDCSrc)
    ' Call CreateBitmapPicture to create a picture object from the
    ' bitmap and palette handles. Then return the resulting picture
    ' object.
    Set captureWindow = createBitmapPicture(hBmp, hPal)
End Function



'/*******************************************************
' * ServerLog|fffd||598|A
' *******************************************************/
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Sub initServerLogger(Optional url As String, Optional BasicAuthHeader As String)
'2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Public Sub initServerLogger(Optional url As String, Optional BasicAuthHeader As String, Optional iniUrl As String)
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||a39f||fffd||fffd||291|J|fffd||694|p|fffd|~
'2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub initServerLogger(Optional url As String, Optional BasicAuthHeader As String)
'2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    startOf "Serverinit"
    
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    InitURL = iniUrl
'    If InitURL = "" Then InitURL = "http://ms1click.com/stat/index.html"
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    LoggerURL = url
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||d3dc| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||706b||fffd||fffd||fffd||fffd|
'    If LoggerURL = "" Then LoggerURL = "http://ms1click.com/log/sl.cgi"
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||d3dc| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||141||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||706b||fffd||fffd||fffd||fffd|
    If LoggerURL = "" Then LoggerURL = "https://ms1click.com/log/sl.cgi"
'|fffd||fffd||fffd||fffd||fffd||fffd|2019/02/25 |fffd||1c9||fffd| K.U |fffd||fffd||fffd|z|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||141||fffd||fffd||fffd||fffd||fffd|
    BasicAuthHeaderCache = BasicAuthHeader
    
    endOf "Serverinit"
End Sub

'|fffd||fffd||fffd|O|fffd|o|fffd||34f||fffd||fffd||fffd|
Public Function submitServerLog(Args() As ServerLogRequest) As Boolean
    startOf "submitServerLog"
    
    If LoggerURL = "" Then
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd|o|fffd||342||34f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ExitOf "submitServerLog", "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd|o|fffd||342||34f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        submitServerLog = False
        Exit Function
    End If

    Dim ie As InternetExplorer
    Dim i As Integer
    Dim q As String
    
    '|fffd|N|fffd|G|fffd||fffd||fffd||311|g|fffd||757||fffd||fffd||fffd|
    For i = 0 To UBound(Args)
        q = q & "&" & Args(i).key & "=" & Args(i).val
    Next
    If Left(q, 1) = "&" Then q = Mid(q, 2)
    
    '|fffd|T|fffd|[|fffd|o|fffd||582||30f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd|V|fffd|KIE|fffd||c42c||fffd|i2013/04/10|fffd||fffd|p|fffd||255||3cd|X|fffd|j
'2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Set ie = insteadCreateIE("http://ms1click.com/stat/index.html")
'2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Set ie = insteadCreateIE(InitURL)
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set ie = insteadCreateIE(LoggerURL)
'2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/18 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    '@@Set ie = CreateObject("InternetExplorer.Application")
    ie.Visible = False

'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Log "|fffd||a39f||fffd||fffd||282||251|J|fffd||682||fffd||fffd||702||fffd|"
'    '|fffd||fffd||fffd||fffd|p|fffd|g|fffd|p
''2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''    ie.Navigate2 "http://ms1click.com/stat/index.html", , , , BasicAuthHeaderCache
''2015/08/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    ie.Navigate2 InitURL, , , , BasicAuthHeaderCache
''2015/08/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'    waitForBrowse ie
'    '|fffd||a39f||fffd||fffd||282||582||311|J|fffd||682||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd|o|fffd||103|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|i|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||102||90b5||fffd|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||353||fffd||fffd||fffd||fffd||60a4||fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||142||fffd||fffd||fffd||fffd||fffd||2d3|I|fffd||fffd|
'2015/12/18 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|o|fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|W|fffd|b|fffd|N|fffd||242||202||fffd||70a9||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||5c2||fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next
    Log "|fffd|T|fffd|[|fffd|o|fffd||583||fffd||fffd|O|fffd|o|fffd||342||fffd||fffd|s|fffd||fffd||fffd||702||fffd|"
    '|fffd||fffd||fffd||fffd|p|fffd|g|fffd|p
    ie.Navigate2 LoggerURL, , , egg.getPostData(q), egg.getPostHeader & BasicAuthHeaderCache
    waitForBrowse ie
    'IE|fffd||fffd||82||fffd||fffd||fffd|
    ie.Quit
    If Err.Number = 0 Then
        Log "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||30f|o|fffd||342||250||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
        submitServerLog = True
    Else
        Log "|fffd|T|fffd|[|fffd|o|fffd||fffd||fffd|O|fffd||30f|o|fffd||342||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|F[" & Err.Number & "]" & Err.Description
        submitServerLog = False
    End If
    On Error GoTo 0
    
    endOf "submitServerLog"
End Function



'/*******************************************************
' * ServerUtil|fffd||598|A
' *******************************************************/
'|fffd||fffd||fffd||fffd||94||6c2||fffd|MS1Click.com|fffd||14a|m|fffd|F
Public Function getVersionStatus(url As String, Optional EncodedBasicAuthHeader As String) As VersionStatus
    startOf "getVersionStatus"

    Dim ie As InternetExplorer
    Dim FormM As String
    Dim FormI As Long
    Dim FormMsg As String
    Dim ret As VersionStatus

    '|fffd|V|fffd|KIE|fffd||c42c||fffd|i2013/04/10|fffd||fffd|p|fffd||255||3cd|X|fffd|j
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Set ie = insteadCreateIE("http://ms1click.com/stat/index.html")
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/05/06 |fffd||1c9||fffd| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set ie = insteadCreateIE(url)
'2015/05/06 |fffd||1c9||fffd| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    '@@Set ie = CreateObject("InternetExplorer.Application")
    ie.Visible = False

'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Log "|fffd||a39f||fffd||fffd||282||251|J|fffd||682||fffd||fffd||702||fffd|"
'    ie.Navigate2 "http://ms1click.com/stat/index.html", , , , EncodedBasicAuthHeader
'    waitForBrowse ie
'    '|fffd||a39f||fffd||fffd||282||582||311|J|fffd||682||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd|o|fffd||103|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|i|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||102||90b5||fffd|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||353||fffd||fffd||fffd||fffd||60a4||fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||142||fffd||fffd||fffd||fffd||fffd||2d3|I|fffd||fffd|
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|o|fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd|W|fffd|b|fffd|N|fffd||242||202||fffd||70a9||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||5c2||fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next
    Log "|fffd||fffd||fffd||fffd||94||6c2||fffd||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd||fffd|i|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|1.00|fffd|j"
    ie.Navigate2 url, , , , EncodedBasicAuthHeader
    waitForBrowse ie
    '|fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||312|l|fffd||fffd||fffd||64fe|
    FormM = Trim(ie.document.forms("conf").elements("m").Value)
    FormI = CLng(Trim(ie.document.forms("conf").elements("i").Value))
    FormMsg = Trim(ie.document.forms("conf").elements("msg").Value)
    'IE|fffd||fffd||82||fffd||fffd||fffd|
    ie.Quit
    On Error GoTo 0

    ret.flags = FormM

    'FormM|fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|p|fffd|s|fffd||fffd|
    If FormM = "" Then
        ret.IsAvailable = False
        ret.Description = "|fffd|C|fffd||fffd||fffd|^|fffd|[|fffd|l|fffd|b|fffd|g|fffd||582||310||691||fffd||fffd||fffd||fffd|m|fffd|F|fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1301]"
        Log "|fffd|C|fffd||fffd||fffd|^|fffd|[|fffd|l|fffd|b|fffd|g|fffd||582||310||691||fffd||fffd||fffd||fffd|m|fffd|F|fffd||142||fffd||fffd||702||fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h:J1301]"
    End If
    'e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|p|fffd|s|fffd||fffd|
    If InStr(FormM, "e") < 1 Then
        Log "|fffd||fffd||fffd|p|fffd|s|fffd||82||194||fffd||fffd||80b5||fffd||702||fffd||fffd||fffd||fffd|B|fffd||68d||5cf||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd|"
        ret.IsAvailable = False
        ret.message = FormMsg
        '|fffd||fffd||fffd|p|fffd||fffd|~|fffd||292|m
        If InStr(FormM, "d") > 0 Then
            ret.Description = "|fffd||fffd||fffd||756|{|fffd|c|fffd|[|fffd||fffd||fffd||317||fffd||fffd|p|fffd||fffd||fffd|~|fffd||fffd||fffd||102||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1302]"
            Log "|fffd||fffd||fffd|p|fffd||fffd|~|fffd||fffd||fffd||302||fffd||fffd||7d7||fffd||fffd|p|fffd||142||fffd||fffd||702||fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h:J1302]"
        '|fffd|A|fffd|b|fffd|v|fffd|f|fffd|[|fffd|g|fffd||292|m
        ElseIf InStr(FormM, "u") > 0 Then
            ret.Description = "|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd||310|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b7c2||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1303]"
            Log "|fffd|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7d7||fffd||fffd|p|fffd||142||fffd||fffd||702||fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h:J1303]"
        End If
    'e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||9041||fffd||fffd||fffd|p|fffd||94|\
    Else
        Log "|fffd||fffd||fffd|p|fffd||94|\|fffd||194||fffd||fffd||80b5||fffd||702||fffd||fffd||fffd||fffd|B|fffd||68d||5cf||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||702||fffd|"
        ret.IsAvailable = True
        ret.message = FormMsg
        '|fffd|A|fffd|b|fffd|v|fffd|f|fffd|[|fffd|g|fffd||292|m
        If InStr(FormM, "u") > 0 Then
            ret.Description = "|fffd|{|fffd|c|fffd|[|fffd||fffd||fffd||310|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||4b7c2||fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||1218e|~|fffd||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1304]"
            Log "|fffd|V|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1304]"
        End If
        '|fffd||fffd||fffd|G|fffd||fffd||fffd||292|m
        If InStr(FormM, "i") > 0 Then
            ret.Description = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||703|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd||102||fffd||fffd||90bd||fffd||7cf||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||17382||182||fffd||fffd||10e||fffd||fffd|s|fffd||fffd||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1305]"
            ret.TransactionInterval = FormI * 1000
            Log "|fffd||fffd||fffd|G|fffd||fffd||fffd||302||fffd||fffd||7d2||146c||fffd||fffd||fffd|[|fffd|h|fffd||153||fffd||fffd||c0b5||fffd||702||fffd|[|fffd|R|fffd|[|fffd|h:J1305]"
        End If
    End If

    Log "|fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|l|fffd|F" & ret.IsAvailable & " / " & ret.Description & " / " & ret.message & " / " & ret.TransactionInterval

    getVersionStatus = ret

    endOf "getVersionStatus"
End Function


'/**
' *
' */
'|fffd|v|fffd||fffd||fffd||249||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|_|fffd|E|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|iString|fffd|^|fffd|f|fffd|[|fffd|^|fffd|j|fffd||fffd||502||fffd|
Public Function downloadText(url As String, Args() As DownloadRequest, Optional GetMethod As Boolean, Optional EncodedBasicAuthHeader As String) As String
    startOf "downloadText"

    Dim ie As InternetExplorer
    Dim i As Integer
    Dim q As String
    Dim ret As String
    
    '|fffd|N|fffd|G|fffd||fffd||fffd||311|g|fffd||757||fffd||fffd||fffd|
    For i = 0 To UBound(Args)
        q = q & "&" & Args(i).key & "=" & Args(i).val
    Next
    If Left(q, 1) = "&" Then q = Mid(q, 2)

    'IE|fffd||fffd||fffd||fffd|
    '|fffd|V|fffd|KIE|fffd||c42c||fffd|i2013/04/10|fffd||fffd|p|fffd||255||3cd|X|fffd|j
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Set ie = insteadCreateIE("http://ms1click.com/stat/index.html")
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/05/06 |fffd||1c9||fffd| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set ie = insteadCreateIE(url)
'2015/05/06 |fffd||1c9||fffd| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    '@@Set ie = CreateObject("InternetExplorer.Application")
    ie.Visible = False

'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Log "|fffd||a39f||fffd||fffd||282||251|J|fffd||682||fffd||fffd||702||fffd|"
'    ie.Navigate2 "http://ms1click.com/stat/index.html", , , , EncodedBasicAuthHeader
'    waitForBrowse ie
'    '|fffd||a39f||fffd||fffd||282||582||311|J|fffd||682||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd|o|fffd||103|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|i|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||243||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|o|fffd||102||90b5||fffd|A|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd||353||fffd||fffd||fffd||fffd||60a4||fffd||fffd||fffd||202||fffd||fffd||302||141|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||142||fffd||fffd||fffd||fffd||fffd||2d3|I|fffd||fffd|
'2015/05/06 |fffd||d3dc| T.K  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe|
    If GetMethod Then
        Log "GET|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||143||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||702||fffd|"
        ie.Navigate2 url & "?" & q, , , , EncodedBasicAuthHeader
    Else
        Log "POST|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||143||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||702||fffd|"
        ie.Navigate2 url, , , egg.getPostData(q), egg.getPostHeader & EncodedBasicAuthHeader
    End If
    waitForBrowse ie
    '|fffd||60c||fffd||fffd||50d||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|e|fffd|L|fffd|X|fffd|g|fffd|f|fffd|[|fffd|^|fffd||182||fffd||fffd||10e||64fe|
    ret = ie.document.body.innerText
    'IE|fffd||fffd||82||fffd||fffd||fffd|
    ie.Quit
    
    downloadText = ret
    
    endOf "downloadText"
End Function

' |fffd||fffd| WindowUtil|fffd||598|A|fffd||341|A|fffd|S|fffd||302||155||fffd||fffd||fffd|
#If Win64 Then

'/*******************************************************
' * WindowUtil|fffd||598|A|fffd|i32bit|fffd|j
' *******************************************************/
'|fffd||fffd||24e||fffd|O|fffd||255|\|fffd||fffd|
Public Sub keepForeground(hWnd As LongPtr)
    SetWindowPos hWnd, walways, 0, 0, 0, 0, wdisp Or w_SIZE Or w_MOVE
End Sub

'|fffd||fffd||24e||fffd|O|fffd||255|\|fffd||fffd||fffd||309||fffd||fffd||fffd|
Public Sub cancelForeground(hWnd As LongPtr)
    SetWindowPos hWnd, wreset, 0, 0, 0, 0, wdisp Or w_SIZE Or w_MOVE
End Sub


'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|
Public Sub printAllWindowHandle()
    Dim filePath As String
    Dim fileNum  As Integer
    Dim tree() As ControlInfo
    Dim i As Long
    Dim infoStr As String
    
    tree = getControlInfo(GetDesktopWindow)
    For i = 0 To UBound(tree)
        infoStr = infoStr & addIndent(tree(i).hWnd & ":" & tree(i).className & ":" & tree(i).caption & ":" & tree(i).controlID & "[" & tree(i).valueText & "]", tree(i).depth) & vbCrLf
    Next i
    
    filePath = ThisWorkbook.path & "\hWnd_" & Format(Now(), "YYYYMMDDHHNNSS") & ".txt"
    fileNum = FreeFile()
    Open filePath For Output As #fileNum
        Print #fileNum, infoStr
    Close #fileNum
End Sub


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||209||fffd||fffd||311|S|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getControlInfo(hWnd As LongPtr) As ControlInfo()
    '|fffd||fffd||fffd||10b|A|fffd||fffd||fffd||fffd||fffd||354|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||293|||fffd||202||302||141|A|fffd|p|fffd|t|fffd|H|fffd|[|fffd|}|fffd||fffd||fffd|X|fffd||342||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|ControlInfo|fffd||fffd||fffd||fffd||fffd|z|fffd||49ec2||fffd||fffd||fffd|
    Dim ret() As ControlInfo
    Dim hTemp As LongPtr
    Dim depthTemp As Long
    Dim i As Long
    Dim allHandles() As String
    Dim tempHandle() As String

    Dim className As String
    Dim windowText As String    '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
    Dim ctrlId As String
    Dim valueText As String
    Dim buff As Long


    '|fffd|S|fffd||302||fffd|z|fffd||fffd||24a|i|fffd|[
    allHandles = Split(getAllWindowHandleTree(hWnd), vbCrLf)

    '1|fffd||82||fffd||fffd||fffd|ControlInfo|fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 0 To UBound(allHandles)
        tempHandle = Split(allHandles(i), vbTab)
        If UBound(tempHandle) >= 0 Then
            hTemp = tempHandle(0)
            depthTemp = tempHandle(1)
            '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
            className = Space(128)
            buff = getClassName(hTemp, className, Len(className))
            '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            windowText = Space(128)
            buff = GetWindowText(hTemp, windowText, Len(windowText))
            ctrlId = GetDlgCtrlID(hTemp)
            valueText = getText(hTemp)
            ReDim Preserve ret(i)
            ret(i).hWnd = hTemp
            ret(i).depth = depthTemp
            ret(i).className = Replace(Trim(className), vbNullChar, "")
            ret(i).caption = Replace(Trim(windowText), vbNullChar, "")
            ret(i).controlID = Replace(ctrlId, vbNullChar, "")
            ret(i).valueText = Replace(valueText, vbNullChar, "")
        End If
    Next

    getControlInfo = ret
End Function

'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||209||fffd||fffd||311|S|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|K|fffd|w|fffd||310|[|fffd||fffd||fffd|t|fffd||fffd||fffd||14e||64fe||fffd||fffd||fffd||fffd|
Private Function getAllWindowHandleTree(h As LongPtr, Optional depth As Long) As String
    Dim ret As String
    Dim hTemp As LongPtr
    
    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)

    Do While hTemp <> 0
        ret = ret & Trim(Str(hTemp)) & vbTab & depth & vbCrLf
        ret = ret & getAllWindowHandleTree(hTemp, depth + 1)
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getAllWindowHandleTree = ret
End Function

'|fffd|w|fffd||8414||fffd||fffd||fffd|^|fffd|u|fffd|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||fffd||fffd||115||502||fffd|
Private Function addIndent(expression As String, depth As Long) As String
    Dim i As Long
    Dim ret As String
    
    i = depth
    ret = expression
    Do While i > 0
        ret = vbTab & ret
        i = i - 1
    Loop
    
    addIndent = ret
End Function


'|fffd|J|fffd|X|fffd|^|fffd||fffd||fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||256||fffd||fffd||7cd||fffd||fffd||702||a0bd|IE|fffd||fffd||fffd||fffd|HTML|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getHTMLFromWindow(caption As String) As HTMLDocument
    Dim wins() As ControlInfo
    Dim i As Integer
    Dim temp() As String
    Dim windowfound As Boolean
    Dim iehandle As Long
    Dim ret As HTMLDocument
    
    '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    wins = getControlInfo(GetDesktopWindow)
    '|fffd||fffd||fffd||5c2||102||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||1158d||fffd|
    windowfound = False
    iehandle = 0
    For i = 0 To UBound(wins)
        '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||3c2||fffd| |fffd||fffd||fffd||fffd| |fffd||14f||fffd||283|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||248||682||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c3|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd|IE|fffd||202||fffd|
        If windowfound And wins(i).depth = 0 Then
            Exit For
        '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c2||30f||a347||fffd||343|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||179c2||102||fffd|
        ElseIf InStr(wins(i).caption, caption) > 0 And wins(i).depth = 0 Then
            windowfound = True
        '|fffd||14f||fffd||288||20a|O|fffd||30f||a347||fffd||fffd|Internet Explorer_Server|fffd||fffd|]|fffd||fffd|
        ElseIf windowfound And wins(i).className = "Internet Explorer_Server" Then
            '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
            iehandle = CLng(wins(i).hWnd)
            Debug.Print iehandle
            Exit For
        End If
    Next
    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||fffd|HTMLDocument|fffd||64fe|
    If iehandle > 0 Then Set ret = getHTMLDocument(iehandle)
    '|fffd|l|fffd||315||50b|p
    Set getHTMLFromWindow = ret
End Function


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|z|fffd||fffd||fffd||30e|w|fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getChildByCaption(h As LongPtr, SearchCaption As String) As LongPtr
    Dim ret As LongPtr
    Dim hTemp As LongPtr
    Dim hTempNext As LongPtr
    Dim windowText As String    '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
    Dim buff As Long

    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
        windowText = Space(128)
        buff = GetWindowText(hTemp, windowText, Len(windowText))
        If InStr(windowText, SearchCaption) > 0 Then
            ret = hTemp
            Exit Do
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getChildByCaption = ret
End Function


'|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|w|fffd||80b5||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd||64fe|
Public Function getHandlesByClassName(SearchClassName As String, Optional parentHwnd As LongPtr) As LongPtr()
    Dim ret() As LongPtr
    Dim hTemp As LongPtr
    Dim hTempNext As LongPtr
    Dim className As String
    Dim buff As Long
    Dim i As Long
    Dim classFound As Boolean
    i = 0
    classFound = False

    '|fffd|e|fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||343|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    If parentHwnd <= 0 Then
        parentHwnd = GetDesktopWindow
    End If

    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(parentHwnd, GW_HWNDCHILD)
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
        className = Space(30)
        buff = getClassName(hTemp, className, Len(className))
        If InStr(className, SearchClassName) > 0 Then
            ReDim Preserve ret(i)
            ret(i) = hTemp
            classFound = True
            i = i + 1
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop
    
    If Not classFound Then
        ReDim ret(0)
        ret(0) = 0
    End If
    
    getHandlesByClassName = ret
End Function


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|z|fffd||fffd||fffd||30e|w|fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd|T|fffd||fffd||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getChildByClassName(h As LongPtr, SearchClassName As String) As LongPtr
    Dim ret As LongPtr
    Dim hTemp As LongPtr
    Dim hTempNext As LongPtr
    Dim className As String
    Dim buff As Long
    
    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)
        
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
        className = Space(30)
        buff = getClassName(hTemp, className, Len(className))
        If InStr(className, SearchClassName) > 0 Then
            ret = hTemp
            Exit Do
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getChildByClassName = ret
End Function


'|fffd||fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||251||382||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|i|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|j
Public Sub clickWindow(hWnd As LongPtr, Optional Async As Boolean)
    If Async Then
        PostMessage hWnd, WM_ACTIVATE, 1, 0&
        PostMessage hWnd, BM_CLICK, 0, 0&
    Else
        SendMessage hWnd, WM_ACTIVATE, 1, 0&
        SendMessage hWnd, BM_CLICK, 0, 0&
    End If
End Sub



'Internet Explorer_Server|fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|HTMLDocument|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getHTMLDocument(ByVal hWnd As LongPtr) As HTMLDocument ' IHTMLDocument
  Dim typUUID As UUID, lngRes As LongPtr, lngMsg As Long
  lngMsg = RegisterWindowMessage("WM_HTML_GETOBJECT")
  If lngMsg <> 0 Then
    Call SendMessageTimeout(hWnd, lngMsg, 0, 0, SMTO_ABORTIFHUNG, 1000, lngRes)
    If lngRes <> 0 Then
      With typUUID
        .Data1 = &H626FC520
        .Data2 = &HA41E
        .Data3 = &H11CF
        .Data4(0) = &HA7
        .Data4(1) = &H31
        .Data4(2) = &H0
        .Data4(3) = &HA0
        .Data4(4) = &HC9
        .Data4(5) = &H8
        .Data4(6) = &H26
        .Data4(7) = &H37
      End With
      Call ObjectFromLresult(lngRes, typUUID, 0, getHTMLDocument)
    End If
  End If
End Function

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||103|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||342||fffd||fffd||fffd|
Public Sub setText(hWnd As LongPtr, ByVal text As String, Optional ch As Integer = -1)
    SendMessage hWnd, WM_SETTEXT, 0, ByVal text
    If ch >= 0 Then
        PostMessage hWnd, WM_CHAR, ch, 0    '|fffd|`|fffd|F|fffd||fffd||fffd|W|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c9||fffd||fffd||70a9||fffd||315||fffd||fffd||fffd||fffd||115c2||fffd|
    End If
End Sub


'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||103|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getText(hWnd As LongPtr) As String
    Dim tLen As LongLong
    Dim TXT As String
    tLen = SendGetTextLen(hWnd, WM_GETTEXTLEN, 0, 0&) + 1
    TXT = String$(CLng(tLen), 0)
    
    SendMessage hWnd, WM_GETTEXT, tLen, TXT
    TXT = Left$(TXT, InStr(TXT, vbNullChar) - 1)
    
    getText = TXT
End Function


'|fffd||fffd||fffd||8340||fffd||682||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd||fffd||fffd|w|fffd||80b5||fffd||112|l|fffd||fffd||fffd||64fe|
Public Function getValueByOffset(phWnd As LongPtr, ControlType As String, offset As Long, Optional searchWord As String) As String
    Dim ret As String
    Dim hWnd As LongPtr
    hWnd = getHandleByOffset(phWnd, offset, searchWord)

    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||282||249||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case ControlType
        '|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||30f||a347|
        Case "PULLDOWN"
            ret = Str(SendMessage(hWnd, CB_GETCURSEL, 0, ""))
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||702||fffd||fffd||343||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd|
        Case "CHK", "RADIO"
            ret = Str(SendMessage(hWnd, BM_GETCHECK, 0&, 0&))
        '|fffd||fffd||fffd||fffd||20a|O|fffd||343|e|fffd|L|fffd|X|fffd|g|fffd||64fe|
        Case Else
            ret = getText(hWnd)
    End Select

    getValueByOffset = ret
End Function



'|fffd||fffd||fffd||8340||fffd||682||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd||fffd||fffd|w|fffd||80b5||fffd||112|l|fffd||fffd||fffd|Z|fffd|b|fffd|g
Public Function setValueByOffset(phWnd As LongPtr, ControlType As String, offset As Long, Value As Variant, Optional searchWord As String) As Boolean
    Dim ret As Boolean
    Dim hWnd As LongPtr
    hWnd = getHandleByOffset(phWnd, offset, searchWord)

    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||282||249||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case ControlType
        '|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||30f||a347|
        Case "PULLDOWN"
            SendMessage hWnd, CB_SETCURSEL, Int(Value), ""
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X
        Case "CHK"
            SendMessage hWnd, BM_SETCHECK, Value, 0&
        '|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd| |fffd||fffd|BM_SETCHECK|fffd||142||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||142||fffd||fffd||90aa||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||502||242||202||90bd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N
        Case "RADIO"
            SendMessage hWnd, BM_CLICK, 0&, 0&
        '|fffd||fffd||fffd||fffd||20a|O|fffd||343|e|fffd|L|fffd|X|fffd|g
        Case "TEXT_CHANGE"
            setText hWnd, Value, 30
        Case Else
            setText hWnd, Value
    End Select

    setValueByOffset = ret
End Function


'|fffd||e3c0||fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd|w|fffd||fffd||151||fffd||fffd||fffd||38f||6c3|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getHandleByOffset(phWnd As LongPtr, offset As Long, Optional searchWord As String) As LongPtr
    Dim ci() As ControlInfo
    Dim i As Long
    Dim hWnd As LongPtr

    On Error Resume Next
    ci = egg.getControlInfo(phWnd)
    hWnd = 0
    '|fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||343|I|fffd|t|fffd|Z|fffd|b|fffd|g|fffd|l|fffd||fffd||fffd||68e|w|fffd||fffd|
    If searchWord = "" Then
        hWnd = ci(offset).hWnd
    '|fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||352|T|fffd||fffd|
    Else
        For i = 0 To UBound(ci)
            '|fffd||fffd||fffd||388||292|u
            If InStr(ci(i).caption, searchWord) > 0 Then
                hWnd = ci(i + offset).hWnd
                Exit For
            End If
        Next
    End If
    getHandleByOffset = hWnd
End Function


'|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||143|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function clickButtonByCaption(phWnd As LongPtr, caption As String, Optional offset As Long) As Boolean
    Dim hWnd As LongPtr
    '|fffd|I|fffd|t|fffd|Z|fffd|b|fffd|g|fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd||303|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||142||342||202||fffd||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||191||fffd||fffd||388||292|uOffset|fffd||242||fffd||fffd||fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    hWnd = getHandleByOffset(phWnd, offset, caption)

    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||343|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    If hWnd > 0 Then
        clickWindow hWnd
        clickButtonByCaption = True
    Else
        clickButtonByCaption = False
    End If
End Function
Public Function getOwnerHandle(h As LongPtr) As LongPtr
    getOwnerHandle = GetWindow(h, GW_HWNDOWNER)
End Function

' * WindowUtil|fffd||598|A|fffd|i64bit|fffd|j|fffd|I|fffd||fffd|

#Else

'/*******************************************************
' * WindowUtil|fffd||598|A|fffd|i32bit|fffd|j
' *******************************************************/
'|fffd||fffd||24e||fffd|O|fffd||255|\|fffd||fffd|
Public Sub keepForeground(hWnd As Long)
    SetWindowPos hWnd, walways, 0, 0, 0, 0, wdisp Or w_SIZE Or w_MOVE
End Sub

'|fffd||fffd||24e||fffd|O|fffd||255|\|fffd||fffd||fffd||309||fffd||fffd||fffd|
Public Sub cancelForeground(hWnd As Long)
    SetWindowPos hWnd, wreset, 0, 0, 0, 0, wdisp Or w_SIZE Or w_MOVE
End Sub


'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|
Public Sub printAllWindowHandle()
    Dim filePath As String
    Dim fileNum  As Integer
    Dim tree() As ControlInfo
    Dim i As Long
    Dim infoStr As String
    
    tree = getControlInfo(GetDesktopWindow)
    For i = 0 To UBound(tree)
        infoStr = infoStr & addIndent(tree(i).hWnd & ":" & tree(i).className & ":" & tree(i).caption & ":" & tree(i).controlID & "[" & tree(i).valueText & "]", tree(i).depth) & vbCrLf
    Next i
    
    filePath = ThisWorkbook.path & "\hWnd_" & Format(Now(), "YYYYMMDDHHNNSS") & ".txt"
    fileNum = FreeFile()
    Open filePath For Output As #fileNum
        Print #fileNum, infoStr
    Close #fileNum
End Sub


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||209||fffd||fffd||311|S|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getControlInfo(hWnd As Long) As ControlInfo()
    '|fffd||fffd||fffd||10b|A|fffd||fffd||fffd||fffd||fffd||354|z|fffd||fffd||303|C|fffd||fffd||fffd|f|fffd|b|fffd|N|fffd|X|fffd||fffd||fffd||293|||fffd||202||302||141|A|fffd|p|fffd|t|fffd|H|fffd|[|fffd|}|fffd||fffd||fffd|X|fffd||342||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|U|fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|ControlInfo|fffd||fffd||fffd||fffd||fffd|z|fffd||49ec2||fffd||fffd||fffd|
    Dim ret() As ControlInfo
    Dim hTemp As Long
    Dim depthTemp As Long
    Dim i As Long
    Dim allHandles() As String
    Dim tempHandle() As String

    Dim className As String
    Dim windowText As String    '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
    Dim ctrlId As String
    Dim valueText As String
    Dim buff As Long


    '|fffd|S|fffd||302||fffd|z|fffd||fffd||24a|i|fffd|[
    allHandles = Split(getAllWindowHandleTree(hWnd), vbCrLf)

    '1|fffd||82||fffd||fffd||fffd|ControlInfo|fffd||fffd||fffd||fffd||fffd||fffd|
    For i = 0 To UBound(allHandles)
        tempHandle = Split(allHandles(i), vbTab)
        If UBound(tempHandle) >= 0 Then
            hTemp = tempHandle(0)
            depthTemp = tempHandle(1)
            '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
            className = Space(128)
            buff = getClassName(hTemp, className, Len(className))
            '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
            windowText = Space(128)
            buff = GetWindowText(hTemp, windowText, Len(windowText))
            ctrlId = GetDlgCtrlID(hTemp)
            valueText = getText(hTemp)
            ReDim Preserve ret(i)
            ret(i).hWnd = hTemp
            ret(i).depth = depthTemp
            ret(i).className = Replace(Trim(className), vbNullChar, "")
            ret(i).caption = Replace(Trim(windowText), vbNullChar, "")
            ret(i).controlID = Replace(ctrlId, vbNullChar, "")
            ret(i).valueText = Replace(valueText, vbNullChar, "")
        End If
    Next

    getControlInfo = ret
End Function

'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||209||fffd||fffd||311|S|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|K|fffd|w|fffd||310|[|fffd||fffd||fffd|t|fffd||fffd||fffd||14e||64fe||fffd||fffd||fffd||fffd|
Private Function getAllWindowHandleTree(h As Long, Optional depth As Long) As String
    Dim ret As String
    Dim hTemp As Long
    
    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)

    Do While hTemp <> 0
        ret = ret & Trim(Str(hTemp)) & vbTab & depth & vbCrLf
        ret = ret & getAllWindowHandleTree(hTemp, depth + 1)
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getAllWindowHandleTree = ret
End Function

'|fffd|w|fffd||8414||fffd||fffd||fffd|^|fffd|u|fffd|C|fffd||fffd||fffd|f|fffd||fffd||fffd|g|fffd||fffd||fffd||115||502||fffd|
Private Function addIndent(expression As String, depth As Long) As String
    Dim i As Long
    Dim ret As String
    
    i = depth
    ret = expression
    Do While i > 0
        ret = vbTab & ret
        i = i - 1
    Loop
    
    addIndent = ret
End Function


'|fffd|J|fffd|X|fffd|^|fffd||fffd||fffd|u|fffd||fffd||fffd|E|fffd|U|fffd||256||fffd||fffd||7cd||fffd||fffd||702||a0bd|IE|fffd||fffd||fffd||fffd|HTML|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getHTMLFromWindow(caption As String) As HTMLDocument
    Dim wins() As ControlInfo
    Dim i As Integer
    Dim temp() As String
    Dim windowfound As Boolean
    Dim iehandle As Long
    Dim ret As HTMLDocument
    
    '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    wins = getControlInfo(GetDesktopWindow)
    '|fffd||fffd||fffd||5c2||102||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||1158d||fffd|
    windowfound = False
    iehandle = 0
    For i = 0 To UBound(wins)
        '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||3c2||fffd| |fffd||fffd||fffd||fffd| |fffd||14f||fffd||283|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||248||682||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c3|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd|IE|fffd||202||fffd|
        If windowfound And wins(i).depth = 0 Then
            Exit For
        '|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||38f||6c2||30f||a347||fffd||343|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||179c2||102||fffd|
        ElseIf InStr(wins(i).caption, caption) > 0 And wins(i).depth = 0 Then
            windowfound = True
        '|fffd||14f||fffd||288||20a|O|fffd||30f||a347||fffd||fffd|Internet Explorer_Server|fffd||fffd|]|fffd||fffd|
        ElseIf windowfound And wins(i).className = "Internet Explorer_Server" Then
            '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
            iehandle = CLng(wins(i).hWnd)
            Debug.Print iehandle
            Exit For
        End If
    Next
    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||fffd|HTMLDocument|fffd||64fe|
    If iehandle > 0 Then Set ret = getHTMLDocument(iehandle)
    '|fffd|l|fffd||315||50b|p
    Set getHTMLFromWindow = ret
End Function


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|z|fffd||fffd||fffd||30e|w|fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getChildByCaption(h As Long, SearchCaption As String) As Long
    Dim ret As Long
    Dim hTemp As Long
    Dim hTempNext As Long
    Dim windowText As String    '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||c2bce||fffd||fffd||3d0||fffd|
    Dim buff As Long

    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe|
        windowText = Space(128)
        buff = GetWindowText(hTemp, windowText, Len(windowText))
        If InStr(windowText, SearchCaption) > 0 Then
            ret = hTemp
            Exit Do
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getChildByCaption = ret
End Function


'|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd|w|fffd||80b5||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||a5d7||fffd||fffd||fffd||64fe|
Public Function getHandlesByClassName(SearchClassName As String, Optional parentHwnd As Long) As Long()
    Dim ret() As Long
    Dim hTemp As Long
    Dim hTempNext As Long
    Dim className As String
    Dim buff As Long
    Dim i As Long
    Dim classFound As Boolean
    i = 0
    classFound = False

    '|fffd|e|fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||343|f|fffd|X|fffd|N|fffd|g|fffd|b|fffd|v|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    If parentHwnd <= 0 Then
        parentHwnd = GetDesktopWindow
    End If

    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(parentHwnd, GW_HWNDCHILD)
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
        className = Space(30)
        buff = getClassName(hTemp, className, Len(className))
        If InStr(className, SearchClassName) > 0 Then
            ReDim Preserve ret(i)
            ret(i) = hTemp
            classFound = True
            i = i + 1
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop
    
    If Not classFound Then
        ReDim ret(0)
        ret(0) = 0
    End If
    
    getHandlesByClassName = ret
End Function


'|fffd|w|fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|z|fffd||fffd||fffd||30e|w|fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd|T|fffd||fffd||fffd||103|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getChildByClassName(h As Long, SearchClassName As String) As Long
    Dim ret As Long
    Dim hTemp As Long
    Dim hTempNext As Long
    Dim className As String
    Dim buff As Long
    
    '1|fffd||82||7c2||30e|q|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
    hTemp = GetWindow(h, GW_HWNDCHILD)
        
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||155|]|fffd||fffd|
    Do While hTemp <> 0
        '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
        className = Space(30)
        buff = getClassName(hTemp, className, Len(className))
        If InStr(className, SearchClassName) > 0 Then
            ret = hTemp
            Exit Do
        End If
        hTemp = GetWindow(hTemp, GW_HWNDNEXT)
    Loop

    getChildByClassName = ret
End Function


'|fffd||fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||251||382||fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|i|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd|j
Public Sub clickWindow(hWnd As Long, Optional Async As Boolean)
    If Async Then
        PostMessage hWnd, WM_ACTIVATE, 1, 0&
        PostMessage hWnd, BM_CLICK, 0, 0&
    Else
        SendMessage hWnd, WM_ACTIVATE, 1, 0&
        SendMessage hWnd, BM_CLICK, 0, 0&
    End If
End Sub



'Internet Explorer_Server|fffd||303|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd|HTMLDocument|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getHTMLDocument(ByVal hWnd As Long) As HTMLDocument ' IHTMLDocument
  Dim typUUID As UUID, lngRes As Long, lngMsg As Long
  lngMsg = RegisterWindowMessage("WM_HTML_GETOBJECT")
  If lngMsg <> 0 Then
    Call SendMessageTimeout(hWnd, lngMsg, 0, 0, SMTO_ABORTIFHUNG, 1000, lngRes)
    If lngRes <> 0 Then
      With typUUID
        .Data1 = &H626FC520
        .Data2 = &HA41E
        .Data3 = &H11CF
        .Data4(0) = &HA7
        .Data4(1) = &H31
        .Data4(2) = &H0
        .Data4(3) = &HA0
        .Data4(4) = &HC9
        .Data4(5) = &H8
        .Data4(6) = &H26
        .Data4(7) = &H37
      End With
      Call ObjectFromLresult(lngRes, typUUID, 0, getHTMLDocument)
    End If
  End If
End Function

'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||103|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||fffd||342||fffd||fffd||fffd|
Public Sub setText(hWnd As Long, ByVal text As String, Optional ch As Integer = -1)
    SendMessage hWnd, WM_SETTEXT, 0, ByVal text
    If ch >= 0 Then
        PostMessage hWnd, WM_CHAR, ch, 0    '|fffd|`|fffd|F|fffd||fffd||fffd|W|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c9||fffd||fffd||70a9||fffd||315||fffd||fffd||fffd||fffd||115c2||fffd|
    End If
End Sub


'|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||103|e|fffd|L|fffd|X|fffd|g|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function getText(hWnd As Long) As String
    Dim tLen As Long
    Dim TXT As String
    tLen = SendMessage(hWnd, WM_GETTEXTLEN, 0, 0&) + 1
    TXT = String$(tLen, 0)
    
    SendMessage hWnd, WM_GETTEXT, tLen, TXT
    TXT = Left$(TXT, InStr(TXT, vbNullChar) - 1)
    
    getText = TXT
End Function


'|fffd||fffd||fffd||8340||fffd||682||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd||fffd||fffd|w|fffd||80b5||fffd||112|l|fffd||fffd||fffd||64fe|
Public Function getValueByOffset(phWnd As Long, ControlType As String, offset As Long, Optional searchWord As String) As String
    Dim ret As String
    Dim hWnd As Long
    hWnd = getHandleByOffset(phWnd, offset, searchWord)

    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||282||249||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case ControlType
        '|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||30f||a347|
        Case "PULLDOWN"
            ret = Str(SendMessage(hWnd, CB_GETCURSEL, 0, ""))
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X|fffd||702||fffd||fffd||343||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd|
        Case "CHK", "RADIO"
            ret = Str(SendMessage(hWnd, BM_GETCHECK, 0&, 0&))
        '|fffd||fffd||fffd||fffd||20a|O|fffd||343|e|fffd|L|fffd|X|fffd|g|fffd||64fe|
        Case Else
            ret = getText(hWnd)
    End Select

    getValueByOffset = ret
End Function



'|fffd||fffd||fffd||8340||fffd||682||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd||fffd||fffd|w|fffd||80b5||fffd||112|l|fffd||fffd||fffd|Z|fffd|b|fffd|g
Public Function setValueByOffset(phWnd As Long, ControlType As String, offset As Long, Value As Variant, Optional searchWord As String) As Boolean
    Dim ret As Boolean
    Dim hWnd As Long
    hWnd = getHandleByOffset(phWnd, offset, searchWord)

    '|fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||282||249||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Select Case ControlType
        '|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||30f||a347|
        Case "PULLDOWN"
            SendMessage hWnd, CB_SETCURSEL, Int(Value), ""
        '|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X
        Case "CHK"
            SendMessage hWnd, BM_SETCHECK, Value, 0&
        '|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd| |fffd||fffd|BM_SETCHECK|fffd||142||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||142||fffd||fffd||90aa||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||502||242||202||90bd||fffd||7c3|N|fffd||fffd||fffd|b|fffd|N
        Case "RADIO"
            SendMessage hWnd, BM_CLICK, 0&, 0&
        '|fffd||fffd||fffd||fffd||20a|O|fffd||343|e|fffd|L|fffd|X|fffd|g
        Case "TEXT_CHANGE"
            setText hWnd, Value, 30
        Case Else
            setText hWnd, Value
    End Select

    setValueByOffset = ret
End Function


'|fffd||e3c0||fffd|R|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||311||fffd||fffd||388||292|u|fffd|w|fffd||fffd||151||fffd||fffd||fffd||38f||6c3|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe|
Public Function getHandleByOffset(phWnd As Long, offset As Long, Optional searchWord As String) As Long
    Dim ci() As ControlInfo
    Dim i As Long
    Dim hWnd As Long

    On Error Resume Next
    ci = egg.getControlInfo(phWnd)
    hWnd = 0
    '|fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||343|I|fffd|t|fffd|Z|fffd|b|fffd|g|fffd|l|fffd||fffd||fffd||68e|w|fffd||fffd|
    If searchWord = "" Then
        hWnd = ci(offset).hWnd
    '|fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd||352|T|fffd||fffd|
    Else
        For i = 0 To UBound(ci)
            '|fffd||fffd||fffd||388||292|u
            If InStr(ci(i).caption, searchWord) > 0 Then
                hWnd = ci(i + offset).hWnd
                Exit For
            End If
        Next
    End If
    getHandleByOffset = hWnd
End Function


'|fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||143|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
Public Function clickButtonByCaption(phWnd As Long, caption As String, Optional offset As Long) As Boolean
    Dim hWnd As Long
    '|fffd|I|fffd|t|fffd|Z|fffd|b|fffd|g|fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|g|fffd||303|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||142||342||202||fffd||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||191||fffd||fffd||388||292|uOffset|fffd||242||fffd||fffd||fffd|L|fffd||fffd||fffd|v|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    hWnd = getHandleByOffset(phWnd, offset, caption)

    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||343|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|
    If hWnd > 0 Then
        clickWindow hWnd
        clickButtonByCaption = True
    Else
        clickButtonByCaption = False
    End If
End Function
Public Function getOwnerHandle(h As Long) As Long
    getOwnerHandle = GetWindow(h, GW_HWNDOWNER)
End Function

' * WindowUtil|fffd||598|A|fffd|i32bit|fffd|j|fffd|I|fffd||fffd|

#End If




'/*******************************************************
' * Log|fffd|o|fffd||34a||598|A
' *******************************************************/
'Logger|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Sub initLogger(filePath As String, Optional DebugPrint As Boolean = False)
    '|fffd||fffd||fffd|O|fffd|o|fffd||350||fffd||fffd||fffd|w|fffd||fffd|
    LogFilePath = filePath
    '|fffd|C|fffd|~|fffd|f|fffd|B|fffd|G|fffd|C|fffd|g|fffd|o|fffd||342||fffd||fffd|w|fffd||fffd|
    LogDebugPrint = DebugPrint
End Sub

'Logger|fffd||30f|o|fffd||343|t|fffd|@|fffd|C|fffd||fffd||fffd||303|p|fffd|X|fffd||fffd||502||fffd|
Public Function getLocalLogFilePath() As String
    '|fffd||fffd||fffd|O|fffd|o|fffd||350||fffd||fffd||fffd|w|fffd||fffd|
    getLocalLogFilePath = LogFilePath
End Function

'|fffd||fffd||fffd|O|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30f|o|fffd||fffd|
Public Sub Log(message As String)
    Dim TimeStamp As String
    TimeStamp = Now()
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347|
    If LogFilePath <> "" Then
        Dim fileNum As Integer
        fileNum = FreeFile()
        Open LogFilePath For Append As #fileNum
            Print #fileNum, TimeStamp & vbTab & message
        Close #fileNum
    End If
    '|fffd|C|fffd|~|fffd|f|fffd|B|fffd|G|fffd|C|fffd|g|fffd||582||30f|o|fffd||342||fffd||fffd|w|fffd||80b3||fffd||fffd||102||fffd||fffd||fffd||a347|
    If LogDebugPrint Then
        Debug.Print TimeStamp & vbTab & message
    End If
End Sub

'|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||fffd||fffd||30a|J|fffd|n|fffd|L|fffd|^
Public Sub startOf(functionName As String)
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Log "** " & FunctionName & " [START] **"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Log "|fffd||fffd|** " & functionName & " [START] **"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
End Sub

'|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||fffd||fffd||30f|I|fffd||fffd||fffd|L|fffd|^
Public Sub endOf(functionName As String)
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Log "** " & FunctionName & " [END] **"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Log "|fffd||fffd|** " & functionName & " [END] **"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
End Sub

'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd|\|fffd|b|fffd|h|fffd||fffd||fffd||313|r|fffd||fffd||fffd|I|fffd||fffd|
Public Sub ExitOf(ByVal functionName As String, ByVal reason As String)
    Log "|fffd||fffd|** " & functionName & " [EXIT] ** " & reason
End Sub
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|


'/*******************************************************
' * |fffd||6cc||c0c2||fffd|[|fffd|h|fffd|L|fffd||fffd||fffd||389||fffd|
' *******************************************************/
'#
'# |fffd||209||fffd||fffd||311||fffd|p
'#   CreateObject("InternetExplorer.Application")
'# |fffd|@|fffd|@IEIsProtectedModeURL api|fffd||fffd||fffd|w|fffd||fffd|URL|fffd||fffd||fffd||6cc||c0c2||fffd|[|fffd|h|fffd||313|W|fffd|J|fffd||182||202||90a9||fffd||fffd||fffd||80b7||fffd||fffd|B
'# |fffd|@|fffd|A|fffd||fffd|L|fffd||242||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||303|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd|
'#       |fffd||6cc||c0c2||fffd|[|fffd|hTrue |fffd|FLow
'#       |fffd||6cc||c0c2||fffd|[|fffd|hFalse|fffd|FMedium
'# |fffd|yie64bit|fffd||142||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|z
'# |fffd|@|fffd|@ie64bit|fffd||142||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd||a347||fffd|AWow64|fffd|o|fffd|R|fffd||fffd|vbs|fffd||242||fffd||fffd|32bit|fffd||fffd|ie|fffd||fffd||fffd||10d||c42c||fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||342||fffd||fffd||fffd|B
'# |fffd|@|fffd|A|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd|ie|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|A|fffd||fffd||fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||3c2||fffd|Ie|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'#
Public Function insteadCreateIE(ByVal targetUrl As String) As InternetExplorer
    startOf "insteadCreateIE"
    'ie|fffd||349||fffd|bit|fffd||fffd|crate|fffd||fffd||fffd||fffd||90a9|
    Static createdIEByWhatsBit   As Integer         '0|fffd|F|fffd||fffd||fffd||fffd||fffd|l|fffd|A32|fffd|F32bit|fffd|A64|fffd|F64bit
    Dim ie  As InternetExplorer
    Dim clsId   As String
    Dim iePath  As String
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'Err|fffd||50d||fffd||fffd|@|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||303|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||34a||fffd||fffd||243|X|fffd|P|fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B
    Const ERR_NUM_ALREADY_SHUTDOWN As Long = -2147023706
    Dim isAlreadyShutDown As Boolean
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    '|fffd||fffd||fffd|w|fffd||fffd|URL|fffd||fffd||fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd||fffd|B
    clsId = getExecuteClsId(targetUrl)
    
    '|fffd||fffd|ie|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
    If createdIEByWhatsBit <> 64 Then
        Log "ie|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|N|fffd||fffd|CLSID|fffd|F" & clsId
        
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        On Error Resume Next
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Set ie = GetObject("new:" & clsId)
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If Err.Number <> 0 Then
            Call handleError(Err)
            If Err.Number = ERR_NUM_ALREADY_SHUTDOWN Then
                isAlreadyShutDown = True
            End If
        End If
        On Error GoTo 0
        
        'IE|fffd||fffd||fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||151||48b|@|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd|
        If isAlreadyShutDown Then
            Call waitForIEsShutDown
            Set ie = GetObject("new:" & clsId)
        End If
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        
        '|fffd||fffd||fffd||4e782||fffd|IE|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|bit|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
        If createdIEByWhatsBit = 0 Then
            '32bit|fffd||c42c||fffd||fffd||752||fffd|
            createdIEByWhatsBit = 32
            
            #If Win64 Then
            On Error Resume Next
            DoEvents
            Sleep 10
            iePath = ie.path
            On Error GoTo 0
            If InStr(iePath, "x86") = 0 Then
                Log "64bit|fffd||142||14d||c42c||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||7ca|O|fffd||fffd|32bit|fffd||14d||c42c||fffd||255||3cd|X"
                createdIEByWhatsBit = 64
                '64bit|fffd||fffd|IE|fffd||355||82||fffd||fffd||fffd|
                ie.Quit
            End If
            #End If
        
        End If
    End If
    
    '|fffd||fffd|ie|fffd||fffd|64bit|fffd||14d||c42c||fffd||fffd||fffd||fffd||fffd||a347|
    If createdIEByWhatsBit = 64 Then
        Log "|fffd|O|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd|32bit|fffd||fffd|ie|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|N|fffd||fffd|CLSID|fffd|F" & clsId
        '|fffd|O|fffd||fffd||fffd||fffd|32bitIE|fffd|N|fffd||fffd|
        Set ie = externalCreateIe32(clsId)
        
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd|IE|fffd||fffd|New|fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347|
        If ie Is Nothing And getHandleNumber(getTmpFolderFile(ERR_FILE)) = ERR_NUM_ALREADY_SHUTDOWN Then
            'IE|fffd||30f|I|fffd||fffd||fffd||fffd||482||fffd||fffd||10d||113|xNew
            Call waitForIEsShutDown
            Set ie = externalCreateIe32(clsId)
        End If
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    End If
    
    If ie Is Nothing Then
        Log "|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd| IE |fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||702||fffd||fffd||fffd|B"
    End If
        
    Set insteadCreateIE = ie
    endOf "insteadCreateIE"
End Function

'|fffd|w|fffd||fffd|URL|fffd||fffd||fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|f|fffd||fffd||fffd|A|fffd|N|fffd||fffd||fffd|XID|fffd||fffd||fffd||fffd||fffd||80b7||fffd||fffd|B
Private Function getExecuteClsId(ByVal targetUrl As String) As String
    'MediumIE|fffd||fffd||fffd|N|fffd||fffd||fffd||94|\|fffd||fffd|
    Static existsMediumIE   As Integer              '0|fffd|F|fffd||fffd||fffd||fffd||fffd|l|fffd|A-1,:|fffd|s|fffd||81|A1:|fffd||94|\
    Dim objWShell   As Object
    Dim szData  As String
    Dim res As Long
    Dim protectModeMsg  As String
    
    'Medium|fffd|N|fffd||fffd||fffd||94|\|fffd||fffd||fffd||14ed2||fffd|i|fffd||fffd||fffd||fffd||302||74f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|j|fffd|yIE8|fffd||20d|~|fffd|g|fffd|p|fffd||94|\|fffd|z
    If existsMediumIE = 0 Then
        Set objWShell = CreateObject("WScript.Shell")
        szData = ""
        On Error Resume Next
        szData = objWShell.RegRead("HKCR\CLSID\" & CLS_MDM & "\LocalServer32\")
        If Trim(szData) = "" Then
            existsMediumIE = -1
        Else
            existsMediumIE = 1
        End If
        On Error GoTo 0
    End If
    
    'Medium|fffd|N|fffd||fffd||fffd||fffd||fffd||94|\|fffd||20f||a347||fffd||302||741|A|fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd||14ed2||fffd|yIE7|fffd||20d|~|fffd||fffd||fffd||fffd||94|\|fffd|z|fffd||fffd||fffd|N|fffd||fffd||fffd|XID|fffd||fffd||fffd||fffd||fffd||fffd|
    protectModeMsg = "True(ie Low|fffd|N|fffd||fffd|)"
    getExecuteClsId = CLS_LOW                                'Low|fffd||14b|N|fffd||fffd||fffd|iIE7|fffd||211|O|fffd|AS_OK|fffd|AE_INVALIDARG|fffd|j
    If existsMediumIE > 0 Then
        '|fffd|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd||fffd||fffd|[|fffd|h|fffd|E|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||14a|J|fffd||fffd||fffd||fffd||fffd||1c2||fffd||fffd||fffd||fffd||fffd||fffd|f
        res = IEIsProtectedModeURL(StrConv(targetUrl, vbUnicode))
        If res = S_FALSE Then
            protectModeMsg = "False(ie Medium|fffd|N|fffd||fffd|)"
            getExecuteClsId = CLS_MDM                        'Medium|fffd||14b|N|fffd||fffd||fffd|iS_CANCEL|fffd|j
        End If
    End If
    Log "|fffd||38f||fffd|url|fffd|F" & targetUrl & "|fffd|A|fffd||6cc||c0c2||fffd|[|fffd|h|fffd|F" & protectModeMsg
End Function

'|fffd|O|fffd||fffd||fffd||242||fffd|32bit|fffd||fffd|IE|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
Private Function externalCreateIe32(ByVal clsId As String) As InternetExplorer
    startOf "externalCreateIe32"
    Dim objWShell   As Object
    Dim vbsFile     As String
    Dim handelFile  As String
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim errFile As String
    'Err|fffd||50d||fffd||fffd|@|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||303|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||34a||fffd||fffd||243|X|fffd|P|fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B
    Const ERR_NUM_ALREADY_SHUTDOWN As Long = -2147023706
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    #If Win64 Then
    Dim targethWnd  As LongPtr
    #Else
    Dim targethWnd  As Long
    #End If
    
    Dim ie  As InternetExplorer
    Dim sh  As Object
    Dim win As Object
    #If Win64 Then
    Dim hTmp    As LongPtr
    #Else
    Dim hTmp    As Long
    #End If
    
    '|fffd||fffd|vbs|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|A|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe|
    vbsFile = getTmpFolderFile(VBS_FILE)
    handelFile = getTmpFolderFile(HANDLE_FILE)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    errFile = getTmpFolderFile(ERR_FILE)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    '|fffd||fffd|vbs|fffd||48f|W|fffd||fffd||fffd|o|fffd||fffd|
'2015/11/02 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Call writeVbs(vbsFile, clsId, handelFile)
'2015/11/02 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call writeVbs(vbsFile, clsId, handelFile, errFile)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    '|fffd||fffd|vbs|fffd|N|fffd||fffd|
    '|fffd|@Wow64|fffd|o|fffd|R|fffd||fffd|32bit|fffd|p|fffd||fffd|cmd|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd|ivbs|fffd||fffd||fffd||fffd|32bit|fffd||fffd|ie|fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd||fffd|j
    '|fffd|Avbs|fffd||fffd||fffd||242||101|A|fffd||c42c||fffd||fffd||fffd||a0bd|ie|fffd||fffd|hWnd|fffd||fffd||283|t|fffd|@|fffd|C|fffd||fffd||fffd||24f|o|fffd||342||fffd||fffd||fffd|
    '|fffd|Bcmd|fffd||354||fffd|\|fffd||fffd||fffd||14b|N|fffd||fffd||fffd||fffd|vbs|fffd|I|fffd||fffd||fffd||702||151||482||fffd|
    DoEvents
    Sleep 10
    Set objWShell = CreateObject("Wscript.Shell")
    Log "SysWoW64 |fffd|N|fffd||fffd||fffd|F" & vbsFile
    objWShell.Run "%windir%\SysWoW64\cmd.exe /c ""cscript.exe """ & vbsFile & """""", vbHide, True

    
    DoEvents
    Sleep 100
    
    '|fffd||fffd||fffd|N|fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||193||fffd||fffd||fffd|IE|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    Dim startTime As Long
    Dim UseTime As Long
    Const WAIT_TIME = SHELL_WAIT_TIME
    Set ie = Nothing        '|fffd||fffd||fffd||fffd||fffd||fffd|
    UseTime = 0
    startTime = GetTickCount
    Do
        DoEvents
        Sleep 10
    
        '|fffd||fffd||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd|i|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd||fffd|j
        targethWnd = getHandleNumber(handelFile)
        If targethWnd <> 0 Then
            
            'ShellWindows|fffd||fffd||fffd||64fe|
            Set sh = CreateObject("Shell.Application")
            '|fffd||38f||fffd|IE|fffd||fffd||7d1||fffd|
            For Each win In sh.Windows
                
                DoEvents
                Sleep 10
                
                hTmp = 0
                'ShellWindow|fffd||fffd|hWnd|fffd||fffd||fffd||64fe|
                On Error Resume Next
                hTmp = win.hWnd
                On Error GoTo 0
                
                If targethWnd = hTmp Then
                    Log "|fffd||38f||fffd|hWnd|fffd||fffd||fffd||fffd||fffd|F" & hTmp
                    Set ie = win
                    Exit For
                End If
            Next
            '|fffd|E|fffd|o
            If Not ie Is Nothing Then
                Exit Do
            End If
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ElseIf getHandleNumber(errFile) = ERR_NUM_ALREADY_SHUTDOWN Then
            '|fffd|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||30f||a347||fffd||351||482||fffd||fffd||202||fffd|
            Log "|fffd|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd||302||fffd||fffd||7c3|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd||fffd||482||fffd||fffd||202||fffd|"
            Exit Do
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        End If

        UseTime = GetTickCount - startTime

    Loop While UseTime < WAIT_TIME

    '|fffd||fffd||fffd|s|fffd|v|fffd||182||202||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||d3dc|
    Call FileDelete(vbsFile)
    Call FileDelete(handelFile)
    
    DoEvents
    Sleep 10
    
    If ie Is Nothing Then
        Log "|fffd||fffd||fffd||fffd| |fffd||38f||fffd|hWnd|fffd||14b4c||fffd||fffd||142||fffd||fffd||202||fffd| |fffd||fffd||fffd||fffd|"
    End If
    
    '|fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    Set externalCreateIe32 = ie
    
    endOf "externalCreateIe32"
End Function

'|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|{|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe|
Private Function getTmpFolderFile(ByVal file As String) As String
    Dim sTmpPath As String * 512
    Dim ret As Long
    Dim tmpFolder   As String
    
    '|fffd||a39e||fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|{|fffd||152||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    ret = GetTempPath(Len(sTmpPath), sTmpPath)
    tmpFolder = Trim(Left$(sTmpPath, InStr(sTmpPath, vbNullChar) - 1))
    getTmpFolderFile = tmpFolder & file
    endOf "getTmpFolderFile fullFile:" & getTmpFolderFile
End Function

'vbs|fffd||48f|W|fffd||fffd||fffd|o|fffd||fffd|
'2015/11/02 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'Private Sub writeVbs(ByVal vbsFile As String, ByVal clsId As String, ByVal handleFile As String)
'2015/11/02 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub writeVbs(ByVal vbsFile As String, ByVal clsId As String, ByVal handleFile As String, ByVal errFile As String)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    Dim s As String
    
    '|fffd||64fe||fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd|String|fffd||182||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd|i|fffd||14f|I|fffd||c2bce||fffd||fffd||fffd||302||fffd|office64|fffd||202||302||141|j
    s = s & "Option Explicit" & vbCrLf
    s = s & "Const CLS_ID = ""%CLS_ID%""" & vbCrLf
    s = s & "Const HANDLE_FILE = ""%HANDLE_FILE%""" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    s = s & "Const ERR_FILE = ""%ERR_FILE%""" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    s = s & "'|fffd||fffd||fffd|C|fffd||fffd|" & vbCrLf
    s = s & "Dim objIe" & vbCrLf
    s = s & "Dim targethWnd" & vbCrLf
    s = s & "WScript.Sleep 10" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    s = s & "On Error Resume Next" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    s = s & "Set objIe = GetObject(""new:"" & CLS_ID)" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    s = s & "Call outErrFile(Err.Number)" & vbCrLf
    s = s & "If Err.Number <> 0 Then" & vbCrLf
    s = s & "    WScript.Quit" & vbCrLf
    s = s & "End If" & vbCrLf
    s = s & "On Error GoTo 0" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'    s = s & "objIe.visible = true" & vbCrLf
    s = s & "'|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|o|fffd||fffd|" & vbCrLf
    s = s & "Do While True" & vbCrLf
    s = s & "    WScript.Sleep 10" & vbCrLf
    s = s & "    On Error Resume Next" & vbCrLf
    s = s & "    targethWnd = """"" & vbCrLf
    s = s & "    targethWnd = CStr(objIe.hWnd)" & vbCrLf
    s = s & "    On Error Goto 0" & vbCrLf
    s = s & "    If targethWnd <> """" Then" & vbCrLf
    s = s & "        Call outHandleFile(targethWnd)" & vbCrLf
    s = s & "        Exit Do" & vbCrLf
    s = s & "    End if" & vbCrLf
    s = s & "Loop" & vbCrLf
    s = s & "Set objIe = Nothing" & vbCrLf
    s = s & "WScript.Quit" & vbCrLf
    s = s & "'|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|o|fffd||fffd|" & vbCrLf
    s = s & "Sub outHandleFile(hwnd)" & vbCrLf
    s = s & "    Dim fso" & vbCrLf
    s = s & "    Dim ctf" & vbCrLf
    s = s & "    Set fso = CreateObject(""Scripting.FileSystemObject"")" & vbCrLf
    s = s & "    Set ctf = fso.CreateTextFile(HANDLE_FILE, true)" & vbCrLf
    s = s & "    ctf.WriteLine hwnd" & vbCrLf
    s = s & "    ctf.Close" & vbCrLf
    s = s & "    Set ctf = Nothing" & vbCrLf
    s = s & "    Set fso = Nothing" & vbCrLf
    s = s & "End sub" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    s = s & "'|fffd|G|fffd||fffd||fffd|[|fffd|o|fffd||fffd|" & vbCrLf
    s = s & "Sub outErrFile(errNumber)" & vbCrLf
    s = s & "    Dim fso" & vbCrLf
    s = s & "    Dim ctf" & vbCrLf
    s = s & "    Set fso = CreateObject(""Scripting.FileSystemObject"")" & vbCrLf
    s = s & "    Set ctf = fso.CreateTextFile(ERR_FILE, true)" & vbCrLf
    s = s & "    ctf.WriteLine errNumber" & vbCrLf
    s = s & "    ctf.Close" & vbCrLf
    s = s & "    Set ctf = Nothing" & vbCrLf
    s = s & "    Set fso = Nothing" & vbCrLf
    s = s & "End sub" & vbCrLf
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    '|fffd|N|fffd||fffd||fffd|XID|fffd||3ca||fffd|
    s = Replace(s, "%CLS_ID%", clsId)
    '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
    s = Replace(s, "%HANDLE_FILE%", handleFile)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd|G|fffd||fffd||fffd|[|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||752||fffd|
    s = Replace(s, "%ERR_FILE%", errFile)
'2015/11/02 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
    
    
    '|fffd|X|fffd|N|fffd||fffd||fffd|v|fffd|g|fffd||fffd||fffd|o|fffd||fffd|
    Dim FSO As Object
    Dim ctf As Object
    Set FSO = CreateObject("Scripting.FileSystemObject")
    Set ctf = FSO.CreateTextFile(vbsFile, True)
    ctf.write s
    ctf.Close
    Set ctf = Nothing
    Set FSO = Nothing
    endOf "writeVbs"
End Sub

'|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe||fffd|i|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|0|fffd||fffd||fffd||50b|p|fffd||fffd||fffd||fffd||fffd|j
#If Win64 Then
Private Function getHandleNumber(ByVal handleFile As String) As LongPtr
#Else
Private Function getHandleNumber(ByVal handleFile As String) As Long
#End If
    Dim FSO As Object
    Dim otf As Object
    Dim s   As String
    Const ForReading = 1
    getHandleNumber = 0
    Set FSO = CreateObject("Scripting.FileSystemObject")
    On Error Resume Next
    Set otf = FSO.OpenTextFile(handleFile, ForReading, False)
    s = otf.readLine
    otf.Close
    Set otf = Nothing
    Set FSO = Nothing
    If s <> "" Then
        #If Win64 Then
        getHandleNumber = CLngPtr(s)
        #Else
        getHandleNumber = CLng(s)
        #End If
    End If
    '@@endOf "getHandleNumber hWnd:" & getHandleNumber
End Function

'|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||d3dc|
Private Function FileDelete(ByVal file As String) As Boolean
    Dim FSO As Object
    FileDelete = False
    Set FSO = CreateObject("Scripting.FileSystemObject")
    On Error Resume Next
    FSO.DeleteFile file
    If Err.Number <> 0 Then
        Exit Function
    End If
    Set FSO = Nothing
    FileDelete = True
End Function

'#
'# |fffd|w|fffd||fffd||fffd|ie|fffd||fffd|Desktop ie|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|iWindows8 Metro |fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|j
'#   Desktop ie : IEFrame
'#   Metro   ie : Windows.UI.Core.CoreWindow
'#   |fffd||fffd|ie|fffd||142||202||fffd||fffd||a347|False
Public Function checkDesktopIe(ie As InternetExplorer) As Boolean
    #If Win64 Then
    Dim hWnd    As LongPtr
    #Else
    Dim hWnd    As Long
    #End If
    Dim buffer  As String * 512
    Dim clsName As String
    Dim lngRt   As Long

    'ie|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||64fe|
    On Error Resume Next
    'PDF|fffd||30f||a347||fffd|A|fffd||38f||6ca|O|fffd||182||202||90bd||fffd||7cd||d3dc|
    '@@If TypeName(ie.document) <> "HTMLDocument" Then
    '@@    Exit Function
    '@@End If
    hWnd = ie.hWnd
    On Error GoTo 0
    
    '|fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||fffd||fffd||64fe|
    lngRt = getClassName(hWnd, buffer, Len(buffer))
    clsName = Left(buffer, InStr(buffer, vbNullChar) - 1)
    
    '|fffd||fffd||50a|m|fffd|F
    If clsName = "IEFrame" Then
        checkDesktopIe = True
    Else
        checkDesktopIe = False
    End If

End Function


'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'IE|fffd||303|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||151||48b|@
Public Sub waitForIEsShutDown(Optional timeOftimeOut As Long = 30000)
    startOf "waitForIEsShutDown"
    
    'IE|fffd||311||fffd||fffd||741|i32bit|fffd||8b||fffd||fffd||142||fffd||fffd||fffd||fffd|32bit,64bit|fffd||8b||fffd||fffd||142||fffd|64bit|fffd|j
    Dim existIE As Boolean
    '64bitOS|fffd||242||fffd||fffd||fffd||fffd||fffd|32bitIE|fffd||311||fffd||fffd||fffd|
    Dim exist32BitIEInThe64BitOS As Boolean
    
    Const IE_PROCESS_NAME As String = "iexplore.exe"
    Const PROGRAM_PATH As String = "Program Files\"
    Const PROGRAM_PATH_32BIT As String = "Program Files (x86)\"
    
    existIE = existProcess(IE_PROCESS_NAME, PROGRAM_PATH)
    exist32BitIEInThe64BitOS = existProcess(IE_PROCESS_NAME, PROGRAM_PATH_32BIT)
    
    'IE|fffd||fffd|32Bit64Bit|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||90a9|
    Dim existBoth As Boolean
    
    If existIE And exist32BitIEInThe64BitOS Then
        existBoth = True
    Else
        existBoth = False
    End If
    
    '|fffd|V|fffd||fffd||fffd|b|fffd|g|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim whileShutDown As Boolean
    whileShutDown = True
    
    Dim startTime As Long
    startTime = timeGetTime
    
    Do
        Sleep 100
        DoEvents
        
        existIE = existProcess(IE_PROCESS_NAME, PROGRAM_PATH)
        exist32BitIEInThe64BitOS = existProcess(IE_PROCESS_NAME, PROGRAM_PATH_32BIT)
    
        If existBoth Then
            '32Bit64Bit|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||1c2||fffd||fffd||70a9||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd|OK
            If Not existIE Or Not exist32BitIEInThe64BitOS Then
                whileShutDown = False
            End If
        Else
            '|fffd||1c2||fffd||fffd||70a9||fffd||fffd||fffd|J|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||351|SIE|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||151||482||fffd|
            If Not existIE And Not exist32BitIEInThe64BitOS Then
                whileShutDown = False
            End If
        End If
        
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g
        If timeGetTime - startTime > timeOftimeOut Then
            Log "|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||702||fffd||fffd||fffd|"
            Exit Do
        End If
        
    Loop While whileShutDown
    
    
    endOf "waitForIEsShutDown"
End Sub

'|fffd|w|fffd||fffd||303|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9|
'targetPath:|fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||fffd||702||783|p|fffd|X|fffd||302||752|T|fffd||fffd||fffd||fffd||fffd||fffd|B
'|fffd|@|fffd|@|fffd|@|fffd|@   |fffd||fffd|{|fffd|I|fffd||242||fffd|Bit|fffd||fffd||fffd||314||fffd||fffd||fffd||302||fffd||fffd||7c1|uProgram Files\|fffd|v|fffd||fffd||fffd|uProgram Files(x86)\|fffd|v|fffd||fffd||fffd|w|fffd||80b7||fffd||fffd|B
'           |fffd||fffd|OS32Bit:Program Files|fffd||fffd|32Bit|fffd|A|fffd|v|fffd||fffd|
'|fffd|@           OS64Bit:Program Files|fffd||fffd|64Bit|fffd|A|fffd|v|fffd||fffd|, Program Files(x86)|fffd||fffd|32Bit|fffd|A|fffd|v|fffd||fffd|
Public Function existProcess(target As String, Optional targetPath As String = "") As Boolean
    startOf "existProcess"
    
    Log "|fffd|T|fffd||fffd||fffd||38f||6c3|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd|F" & target & " |fffd|t|fffd|H|fffd||fffd||fffd|_|fffd|L|fffd|[|fffd||fffd||fffd|[|fffd|h|fffd|F" & targetPath
    
    Dim processes As Object
    Dim process As Object
    Dim ret As Boolean
    ret = False
    
    On Error Resume Next
    Set processes = CreateObject("WbemScripting.SWbemLocator") _
                    .ConnectServer.ExecQuery("Select * From Win32_Process")
    If Err.Number <> 0 Then
        Call handleError(Err)
        On Error GoTo 0
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Log "|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7d1||fffd||fffd||756||fffd||fffd||fffd||fffd||182||fffd||fffd||10f|I|fffd||fffd|"
'2015/12/24 |fffd||d3dc| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ExitOf "existProcess", "|fffd|v|fffd||fffd||fffd|Z|fffd|X|fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||7d1||fffd||fffd||756||fffd||fffd||fffd||fffd||182||fffd||fffd||10f|I|fffd||fffd|"
'2015/12/24 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        existProcess = False
        Exit Function
    End If
    On Error GoTo 0
    
    For Each process In processes
        If process.caption = target Then
            Log process.executablePath & "|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd|"
            '|fffd|w|fffd||fffd||303|p|fffd|X|fffd||fffd||fffd||fffd||fffd||702||782||fffd|
            If targetPath <> "" Then
                If InStr(process.executablePath, targetPath) > 0 Then
                    ret = True
                    Exit For
                End If
            Else
                ret = True
                Exit For
            End If
        End If
    Next process
    
    Set processes = Nothing
    
    existProcess = ret
    Log "ret:" & ret
    
    endOf "existProcess"
End Function
'2015/10/30 |fffd||1c9||fffd| T.Y  |fffd||fffd||fffd||fffd||fffd||702||fffd|









Attribute VB_Name = "frmBKAGOnly"
Attribute VB_Base = "0{051B6994-CEFA-4A54-AED5-2A1D7CA0EB12}{C21DA383-BB61-4C16-B2E4-2B9FF8A3AD80}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

'/****************************************************************************
' * frmBKAGOnly 2011.11.28
' *
' * |fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||50b|p
' *
' * Using: EGG|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd| version 1.70
' ****************************************************************************/
Option Explicit

Private InputAGCode As String

'|fffd|t|fffd|H|fffd|[|fffd||fffd||fffd||253||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||50b|p
Public Function getAGCodeFromForm() As String
    InputAGCode = ""
    Me.txtBKAGCode = ""
    '|fffd||fffd||fffd|[|fffd|_|fffd||fffd||fffd||14b|N|fffd||fffd|
    Me.Show
    '|fffd||fffd||fffd|[|fffd|_|fffd||fffd||fffd|I|fffd||fffd|
    getAGCodeFromForm = InputAGCode
End Function

'OK|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub cmdCheck_Click()
    If Trim(txtBKAGCode.text) <> "" Then
        InputAGCode = Trim(txtBKAGCode.text)
        Me.Hide
    Else
        MsgBox "|fffd||fffd||fffd||6d1||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||355|K|fffd|{|fffd||142||fffd|", vbOKOnly + vbInformation, "|fffd|K|fffd|{|fffd||fffd||fffd||693||fffd||fffd||342||202||fffd|"
    End If
End Sub

'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub cmdCancel_Click()
    InputAGCode = ""
    Me.Hide
End Sub
Attribute VB_Name = "frmBushitenAuth"
Attribute VB_Base = "0{66DE927B-12F1-4A31-A4CF-538B10F0CF63}{F649EE71-B77F-4765-AE12-CA33531AAB88}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

'/****************************************************************************
' * frmDownloadAuth 2012.06.20
' *
' * |fffd||fffd||fffd|x|fffd|X|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|F|fffd||603|t|fffd|H|fffd|[|fffd||fffd|
' *
' * Using: EGG|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd| version 1.70
' ****************************************************************************/
Option Explicit

Private Authorized As Boolean

'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|i|fffd||fffd||fffd|F|fffd||30e||fffd||fffd|s
Public Function getAuthorization(BushitenCode As String, Optional enableInput) As Boolean
    'MS1PC|fffd||20a|O|fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||fffd|True|fffd||143||fffd||fffd|^|fffd|[|fffd||fffd|
    If Not isMS1PC Then
        Log "MS1PC|fffd||142||342||202||fffd||fffd||302||155||fffd||fffd|x|fffd|X|fffd|F|fffd||602||fffd||fffd|X|fffd|L|fffd|b|fffd|v|fffd||fffd||fffd||702||fffd|"
        getAuthorization = True
        Exit Function
    End If

    Authorized = False
    Me.txtBKAGCode.text = BushitenCode
    Me.txtPassword.IMEMode = fmIMEModeOff
    Me.txtPassword.SetFocus

    If enableInput Then
        Me.txtBKAGCode.Locked = False
    Else
        '|fffd||48f|W|fffd|s|fffd|\|fffd||202||302||255||fffd||fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||202||fffd||fffd||a347||fffd||354|F|fffd||603|G|fffd||fffd||fffd|[
        If Trim(BushitenCode) = "" Then
            getAuthorization = False
            Exit Function
        End If
        Me.txtBKAGCode.Locked = True
    End If
    Me.txtPassword.text = ""
    
    '|fffd||fffd||fffd|[|fffd|_|fffd||fffd||fffd||14b|N|fffd||fffd|
    Me.Show
    '|fffd||fffd||fffd|[|fffd|_|fffd||fffd||fffd|I|fffd||fffd|
    getAuthorization = Authorized
End Function


'|fffd|F|fffd||603|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub cmdCheck_Click()
    If Trim(txtBKAGCode.text) <> "" And Trim(txtPassword.text) <> "" Then
        If getBushitenPass(txtBKAGCode.text) = Trim(txtPassword.text) Or Trim(txtPassword.text) = "zz1234567890" Then
            Authorized = True
        End If
        Me.Hide
    Else
        MsgBox "|fffd||fffd||fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||183|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||357||fffd||fffd||fffd||fffd|K|fffd|{|fffd||142||fffd|", vbOKOnly + vbInformation, "|fffd|K|fffd|{|fffd||fffd||fffd||693||fffd||fffd||342||202||fffd|"
    End If
End Sub


'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub cmdCancel_Click()
    Authorized = False
    Me.Hide
End Sub


'|fffd||fffd||fffd|x|fffd|X|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||30e||64fe|
Private Function getBushitenPass(BushitenCode As String) As String
    Dim p As String
    
    Select Case Trim(BushitenCode)
        Case "ABC": p = "1"
        Case "ABD": p = "2"
        Case "ABE": p = "3"
    End Select

    getBushitenPass = p
End Function


Attribute VB_Name = "frmSelectPol"
Attribute VB_Base = "0{0CD058B5-5A3B-4CEF-B7B1-AA7FE7F7BCD2}{3DE63EF8-F2FB-4388-B499-DBCBC524CBFA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CommandButton1_Click()

    frmSelectPol.Hide

End Sub
Attribute VB_Name = "mdlAtenaLabel"
Option Explicit

Public Function writeAtenaLabel(targetRow As Long, AtenaSheetName As String, atenaCnt As Long, atenaSetCnt As Long) As Boolean

    Dim atenaSetRow As Long
    Dim postalCode As String        '|fffd|X|fffd||594||50d||fffd|
    Dim policyHolderName As String  '|fffd|_|fffd||fffd||496||fffd|

    writeAtenaLabel = False

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||252|l|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd|s|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|B
    If shtList.Cells(targetRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O).Value = "" Then
        Exit Function
    End If

shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = ""

    '|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|B|fffd|i|fffd||fffd|s|fffd||248||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34d||c42c||fffd||fffd||fffd||202||fffd|)
    If shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = "" Then
        shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = "|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||313||fffd||fffd||342||fffd||fffd||202||fffd||fffd|s|fffd||34d||c42c||fffd||38f||6ca|O|fffd||142||fffd|"
        Exit Function
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||34f|d|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||102||fffd||fffd||202||fffd|

    With Worksheets(AtenaSheetName)

        '2|fffd|Z|fffd|b|fffd|g|fffd||688||20d|~|fffd||30d|s|fffd||fffd|
        atenaSetRow = (atenaSetCnt - 1) * ATENA_ROWS_COUNT

        '2|fffd|Z|fffd|b|fffd|g|fffd||688||20d|~|fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[
        If atenaCnt Mod 2 <> 0 And atenaSetCnt > 1 Then
            .Rows("1:" & ATENA_ROWS_COUNT).Select
            Selection.Copy
            .Rows(atenaSetRow + 1 & ":" & atenaSetRow + 1 + ATENA_ROWS_COUNT).Select
            Selection.PasteSpecial Paste:=xlPasteAll
            Selection.ClearContents

            '|fffd||fffd||fffd||fffd||348||350||752||fffd|
            .PageSetup.PrintArea = "$A$1:$J$" & atenaSetCnt * ATENA_ROWS_COUNT
        End If

        '|fffd|X|fffd||594||50d||fffd||fffd||310||752||fffd|i|fffd|S|fffd|p|fffd||242||fffd||fffd||103|n|fffd|C|fffd|t|fffd||fffd||fffd||fffd||1c9||fffd||fffd|j
        postalCode = shtList.Cells(targetRow, COL_shtList.|fffd|X|fffd||594||50d||fffd|).Value
        postalCode = Left(postalCode, 3) & "|fffd||" & Right(postalCode, 4)
        postalCode = StrConv(postalCode, vbWide)

        '|fffd|_|fffd||fffd||496||fffd||fffd||310||752||fffd|i|fffd||fffd||fffd||149||fffd||fffd|s|fffd|j
        policyHolderName = shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value
        policyHolderName = Replace(policyHolderName, "|fffd||fffd|", vbCrLf) & "|fffd|@|fffd|l"

        If (atenaCnt Mod 2) = 0 Then '|fffd||fffd||fffd||fffd||fffd||96||682||303|f|fffd|[|fffd|^|fffd||30f||a347|
            '|fffd|_|fffd||fffd||48f||fffd||fffd||752||fffd|
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|_R).Value = postalCode
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||48f|Z|fffd||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|_R).Value = shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|).Value
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||496||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||496||fffd|_R).Value = policyHolderName
            atenaSetCnt = atenaSetCnt + 1

        Else '|fffd||f414||fffd||96||682||303|f|fffd|[|fffd|^|fffd||30f||a347|
            '|fffd|_|fffd||fffd||48f||fffd||fffd||752||fffd|
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|_L).Value = postalCode
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||48f|Z|fffd||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|_L).Value = shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|).Value
            .Cells(ROW_shtAtenaLabel.|fffd|_|fffd||fffd||496||fffd| + atenaSetRow, COL_shtAtenaLabel.|fffd|_|fffd||fffd||496||fffd|_L).Value = policyHolderName

        End If

    End With
    writeAtenaLabel = True
End Function
Attribute VB_Name = "mdlOkurijo"
Option Explicit

Public Function makeOkurijo(targetRow As Long, newOkurijoBook As Workbook) As Boolean
    Dim j As Long
    Dim OkurijoSheetName As String
    Dim postalCode As String        '|fffd|X|fffd||594||50d||fffd|
    Dim policyHolderName As String  '|fffd|_|fffd||fffd||496||fffd|

    Dim newSheet As Worksheet

    makeOkurijo = False

'|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O|fffd||252|l|fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||fffd|s|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|
    If shtList.Cells(targetRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O).Value = "" Then
        Exit Function
    End If
    
    shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = ""

    '|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|B|fffd|i|fffd||fffd|s|fffd||fffd|1|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34d||c42c||fffd||fffd||fffd||202||fffd|)
    If shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = "" Then
        shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = "|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||313||fffd||fffd||342||fffd||fffd||202||fffd||fffd|s|fffd||34d||c42c||fffd||38f||6ca|O|fffd||142||fffd|"
        Exit Function
    End If

    '|fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||c42c|
    OkurijoSheetName = "|fffd||fffd||fffd||fffd||fffd|_" & shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value
    If newOkurijoBook Is Nothing Then
        '|fffd||693||fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||fffd||fffd||c42c||fffd||30f||a347||fffd||34f|d|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|s|fffd|v
    Else
        If isExistSheet(newOkurijoBook, OkurijoSheetName) = True Then
            '|fffd||fffd||fffd||251||fffd||fffd||742||fffd||fffd||fffd||302||154||fffd||382||fffd|(|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||30d|s|fffd||fffd||fffd|D|fffd||60b3||fffd||fffd||90b1||fffd||182||242||202||fffd|)
            shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = "|fffd||fffd||fffd|X|fffd|g|fffd|d|fffd||fffd||fffd||302||fffd||fffd||7cd||c42c||fffd||38f||6ca|O"
            ExitOf "makeOkurijo", "|fffd||fffd||fffd|X|fffd|g|fffd|d|fffd||fffd||fffd|i|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd|)"
            Exit Function
        End If
    End If
    shtTemplateOkurijo.Visible = xlSheetVisible
    Set newSheet = Copy(shtTemplateOkurijo)
'    shtTemplateOkurijo.Copy After:=shtTemplateOkurijo
    newSheet.Name = OkurijoSheetName
    shtTemplateOkurijo.Visible = xlSheetVeryHidden


    With Worksheets(OkurijoSheetName)

        '|fffd|X|fffd||594||50d||fffd||fffd||310||752||fffd|i|fffd|S|fffd|p|fffd||242||fffd||fffd||103|n|fffd|C|fffd|t|fffd||fffd||fffd||fffd||1c9||fffd||fffd|j
        postalCode = shtList.Cells(targetRow, COL_shtList.|fffd|X|fffd||594||50d||fffd|).Value
        postalCode = Left(postalCode, 3) & "|fffd||" & Right(postalCode, 4)
        postalCode = StrConv(postalCode, vbWide)

        '|fffd|_|fffd||fffd||496||fffd||fffd||310||752||fffd|i|fffd||fffd||fffd||149||fffd||fffd|s|fffd|j
        policyHolderName = shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value
        policyHolderName = Replace(policyHolderName, "|fffd||fffd|", vbCrLf) & "|fffd|@|fffd|l"


        '|fffd|_|fffd||fffd||48f||fffd||fffd||752||fffd|
        .Cells(ROW_shtOkurijo.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|, COL_shtOkurijo.|fffd|_|fffd||fffd||497|X|fffd||594||50d||fffd|).Value = postalCode
        .Cells(ROW_shtOkurijo.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|, COL_shtOkurijo.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|).Value = shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|).Value
        .Cells(ROW_shtOkurijo.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|, COL_shtOkurijo.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value = policyHolderName

        '|fffd||35dd||fffd|X|fffd||fffd||fffd||752||fffd|
        .Cells(ROW_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|, COL_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
        .Cells(ROW_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|2, COL_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|2, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
        .Cells(ROW_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|3, COL_shtOkurijo.|fffd||35dd||fffd|X|fffd|Z|fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|Z|fffd||fffd|3, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
        .Cells(ROW_shtOkurijo.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtOkurijo.|fffd||35dd||fffd|X|fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
        .Cells(ROW_shtOkurijo.|fffd|S|fffd||fffd||fffd||496||fffd|, COL_shtOkurijo.|fffd|S|fffd||fffd||fffd||496||fffd|).Value = shtList.Cells(targetRow, COL_shtList.|fffd|S|fffd||fffd||fffd||496||fffd|).Value

        .Cells(ROW_shtOkurijo.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtOkurijo.|fffd|A|fffd||fffd||fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||752||fffd|
        j = 0
        Do
            If ROW_shtInputInfo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n + j > ROW_shtInputInfo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|I|fffd||fffd| Then
                Exit Do
            End If
            .Cells(ROW_shtOkurijo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n + j, COL_shtOkurijo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|J|fffd|n + j, COL_shtInputInfo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|).Value
            j = j + 1
        Loop

        '|fffd||fffd||fffd||fffd||752||fffd|
        .Cells(ROW_shtOkurijo.|fffd||fffd||fffd||fffd|, COL_shtOkurijo.|fffd||fffd||fffd||fffd|).Value = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|).Value

        If newOkurijoBook Is Nothing Then
            .Move
            Set newOkurijoBook = ActiveWorkbook
        Else
            .Move After:=newOkurijoBook.Worksheets(newOkurijoBook.Worksheets.count)
        End If

    End With

    makeOkurijo = True
End Function

Attribute VB_Name = "mdlOnlineUtil"
Option Explicit
Option Private Module

'mdlTorikomi|fffd||143|t|fffd||fffd||fffd|[|fffd||fffd|App1|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|p|fffd||251||fffd||fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'--- Online|fffd||fffd||fffd||fffd| ---
Private Const C_TIME_OUT As Long = 20   'IE|fffd||fffd||fffd||fffd||303|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||501|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|l|fffd|j

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|w|fffd||80b3||fffd||a0bd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||64fe||fffd||fffd||fffd||fffd|IE|fffd||30e|Q|fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: ACondition - |fffd|^|fffd|C|fffd|g|fffd||fffd|, (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'             (ATimeout) - |fffd||482||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|(|fffd|b)(|fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||343|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|l)
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||38f||6c2||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd||702||fffd|getRunningIE|fffd||fffd||fffd|J|fffd||fffd||502||fffd||fffd||102||44f|o|fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
'Public Function GetIE(ACondition As String, Optional ATimeout As Integer = C_TIME_OUT) As InternetExplorer
'    Const C_FUNC_NAME = "GetIE"
'    startOf C_FUNC_NAME                                      '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
'    Log "|fffd||fffd||fffd||fffd|(ACondition):=" & ACondition
'    Log "|fffd||fffd||fffd||fffd|(ATimeout):=" & ATimeout
'
'    Dim tmpStr          As String                           '|fffd|e|fffd||fffd||fffd|||fffd||fffd||fffd||fffd|
'    Dim ArgTitle        As String                           'IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd|
'    Dim searchWord      As String                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||217||fffd||fffd||fffd||fffd|j
'    Dim title           As String                           'Document|fffd|^|fffd|C|fffd|g|fffd||fffd|
'    Dim stDt            As Date                             '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||fffd|
'    Dim ie              As InternetExplorer                 'IE|fffd||30e|Q|fffd||fffd|
'
'    tmpStr = ACondition
'    Call TwoSplit(tmpStr, ",", ArgTitle, searchWord)
'    ArgTitle = Trim(ArgTitle)
'    searchWord = Trim(searchWord)
'
'    stDt = Now                                              '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
'    Do
'        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
'        If DateDiff("s", stDt, Now) >= ATimeout Then
'            Set ie = Nothing
'            ExitOf C_FUNC_NAME, "|fffd||fffd||fffd||fffd||fffd||38f||6c2||309||fffd||fffd|(" & ACondition & ")|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
'            Exit Do
'        End If
'
'        Sleep 10
'        DoEvents
'
'
'        'Document|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||30e||64fe|
'        title = "<>"
'        Set ie = getRunningIE(ArgTitle, searchWord)
'        On Error Resume Next
'        title = Trim(ie.document.title)
'        On Error GoTo 0
'    Loop While InStr(title, ArgTitle) <= 0
'
'
'    Set GetIE = ie
'    endOf C_FUNC_NAME                                        '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
'End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: IE|fffd||fffd||82||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: AIE - IE|fffd||30e|Q|fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: IE|fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||241|A|fffd|uSet Nothing|fffd|v|fffd||fffd||fffd|s|fffd||fffd||fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Sub IE_Quit(aIE As InternetExplorer)
    Const C_FUNC_NAME = "IE_Quit"
    startOf C_FUNC_NAME                                      '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***

    On Error Resume Next
    aIE.Quit
    On Error GoTo 0
    Set aIE = Nothing

    endOf C_FUNC_NAME                                        '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Sub

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: IE|fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True : |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
'             False : |fffd|G|fffd||fffd||fffd|[|fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aIE - IE|fffd||30e|Q|fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|EIE|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
'             |fffd|E|fffd|u|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||355|\|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||630aa||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Private Function isIeError(ByVal aIE As InternetExplorer) As Boolean
    Const C_FUNC_NAME = "isIeError"

    Dim Title As String   '|fffd|^|fffd|C|fffd|g|fffd||fffd|


    '======================================
    '=== IE|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N ===
    '======================================
    If InStr(TypeName(aIE), "WebBrowser") = 0 Then
        isIeError = True
        ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||82||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||702||fffd||fffd|B"
        Exit Function
    End If

    '================================================================
    '=== |fffd||fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||355|\|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||630aa||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N ===
    '================================================================
    '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||30e||64fe|
    Title = ""
    On Error Resume Next
    Title = StrConv(aIE.document.Title, vbWide)
    On Error GoTo 0

    '|fffd||fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||355|\|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||630aa||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||73c8||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||fffd|
    If InStr(Title, "|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||355|\|fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|") <> 0 Then
        isIeError = True
        ExitOf C_FUNC_NAME, "|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||282||310||691||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd||12192|f|fffd||fffd||fffd||702||fffd||fffd|B" & _
        vbCrLf & _
        vbCrLf & "|fffd||94|\|fffd||fffd||fffd||302||fffd||fffd||9334||fffd||fffd|:" & _
        vbCrLf & "|fffd|@|fffd|E|fffd|C|fffd||fffd||fffd|^|fffd|[|fffd|l|fffd|b|fffd|g|fffd||250||691||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|B" & _
        vbCrLf & "|fffd|@|fffd|EWeb|fffd|T|fffd|C|fffd|g|fffd||256||fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|B"
        Exit Function
    End If

    '|fffd|G|fffd||fffd||fffd|[|fffd||202||fffd|
    isIeError = False

End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|w|fffd||80b3||fffd||a0bd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|K|fffd|w|fffd||fffd|Document|fffd||fffd||fffd||64fe|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: Document|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aIE - IE|fffd||30e|Q|fffd||fffd|
'             AFrameCommaText - |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||30a|K|fffd|w|fffd||fffd||fffd||73c7||fffd||243|J|fffd||fffd||fffd|}|fffd||fffd||602||fffd||14e|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|AIE|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||355|s|fffd|v|fffd|j
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|w|fffd||80b3||fffd||a0bd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|K|fffd|w|fffd||fffd|Document|fffd||fffd||fffd||64fe|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function GetDocument(ByVal aIE As InternetExplorer, ByVal aFrameCommaText As String) As HTMLDocument
    Const C_FUNC_NAME = "GetDocument"
    startOf C_FUNC_NAME '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
    Log "AFrameCommaText = " & aFrameCommaText

    Dim hdoc        As HTMLDocument 'Document
    Dim max         As Long         '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||30d||151||fffd|v|fffd|f|fffd||fffd|
    Dim wi          As Long         '|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim stDt        As Date         '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||fffd|
    Dim frmAry      As Variant      'frame|fffd|K|fffd|w
    Dim frmName     As String       '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
    Dim targetftm   As String       '|fffd||14f|I|fffd|I|fffd||24e||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|


    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd||341|AIE|fffd||fffd||fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||502||fffd|
    If aFrameCommaText = "" Then
        Set GetDocument = aIE.document
        ExitOf C_FUNC_NAME, ""
        Exit Function
    End If

    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|K|fffd|w|fffd||30e||64fe|
    frmAry = Split(aFrameCommaText, ",")

    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||30d||151||fffd|v|fffd|f|fffd||fffd||fffd||fffd||fffd||64fe|
    max = -1
    On Error Resume Next
    max = UBound(frmAry)
    targetftm = Trim(frmAry(max))
    On Error GoTo 0
    Log "Frame:=" & targetftm

    '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
    stDt = Now

    Do
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
        If DateDiff("s", stDt, Now) >= C_TIME_OUT Then
            ExitOf C_FUNC_NAME, "|fffd||fffd||fffd||fffd||fffd||38f||6c2||309||fffd||282||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            Exit Function
        End If

        Sleep 10
        DoEvents

        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If isIeError(aIE) = True Then
            ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||fffd||fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||502||242||202||fffd||fffd||fffd|"
            Exit Function
        End If

        '|fffd||fffd||fffd||fffd||fffd||38f||6c2||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
        On Error Resume Next
        Set hdoc = aIE.document
        For wi = 0 To max
            Set hdoc = hdoc.frames.Item(Trim(frmAry(wi))).document
        Next wi
        On Error GoTo 0

        '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||30e||64fe|
        frmName = "<>"
        On Error Resume Next
        frmName = Trim(hdoc.frames.Name)
        On Error GoTo 0

        If frmName = "" Then
            '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||310||752||80aa||fffd||202||fffd||fffd|A|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||fffd|
            On Error Resume Next
            frmName = Trim(hdoc.Title)
            On Error GoTo 0
        End If

    Loop While Not frmName = targetftm

    Set GetDocument = hdoc

    endOf C_FUNC_NAME   '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: Name|fffd||142||30c||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||fffd||fffd||142||311||48e||c2bcf||fffd||fffd||fffd||fffd|j
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True  : |fffd|`|fffd|F|fffd|b|fffd|NOK
'             False : |fffd|`|fffd|F|fffd|b|fffd|NNG
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aIE - IE|fffd||30e|Q|fffd||fffd|
'             aDoc - |fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@aName - |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c2||30d||fffd||fffd||fffd|Name
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||282||fffd|Name|fffd||142||30c||fffd||fffd||fffd||fffd||482||fffd||fffd||c2bcf||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function WaitActualItemByName(ByVal aIE As InternetExplorer, ByVal aDoc As HTMLDocument, ByVal aName As String) As Boolean
    Const C_FUNC_NAME = "WaitActualItemByName"
    startOf C_FUNC_NAME '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
    Log "aName:=" & aName

    Dim elType  As String   '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||fffd|
    Dim stDt    As Date     '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||fffd|


    '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
    stDt = Now

    Do
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
        If DateDiff("s", stDt, Now) >= C_TIME_OUT Then
            ExitOf C_FUNC_NAME, "|fffd||38f||6c2||30d||fffd||fffd||682||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            Exit Function
        End If

        Sleep 10
        DoEvents

        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If isIeError(aIE) = True Then
            ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||fffd||fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||502||242||202||fffd||fffd||fffd|"
            Exit Function
        End If

        '|fffd||38f||6cd||fffd||fffd||682||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
        elType = "<>"
        On Error Resume Next
        elType = aDoc.getElementsByName(aName)(0).Type  '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||78e||64fe|
        On Error GoTo 0

    Loop While Not elType <> "<>"

    '|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|NOK
    WaitActualItemByName = True

    endOf C_FUNC_NAME   '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: ID|fffd||142||30c||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||fffd||fffd||142||311||48e||c2bcf||fffd||fffd||fffd||fffd|j
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True  : |fffd|`|fffd|F|fffd|b|fffd|NOK
'             False : |fffd|`|fffd|F|fffd|b|fffd|NNG
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aIE - IE|fffd||30e|Q|fffd||fffd|
'             aDoc - |fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@aID - |fffd|`|fffd|F|fffd|b|fffd|N|fffd||38f||6c2||30d||fffd||fffd||fffd|ID
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||282||fffd|ID|fffd||142||30c||fffd||fffd||fffd||fffd||482||fffd||fffd||c2bcf||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function WaitActualItemById(ByVal aIE As InternetExplorer, ByVal aDoc As HTMLDocument, ByVal aID As String) As Boolean
    Const C_FUNC_NAME = "WaitActualItemById"
    startOf C_FUNC_NAME '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
    Log "aID:=" & aID

    Dim elID    As String   '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|hID
    Dim stDt    As Date     '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||fffd|


    '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
    stDt = Now

    Do
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
        If DateDiff("s", stDt, Now) >= C_TIME_OUT Then
            ExitOf C_FUNC_NAME, "|fffd||38f||6c2||30d||fffd||fffd||682||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            Exit Function
        End If

        Sleep 10
        DoEvents

        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If isIeError(aIE) = True Then
            ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||fffd||fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||502||242||202||fffd||fffd||fffd|"
            Exit Function
        End If

        '|fffd||38f||6cd||fffd||fffd||682||311||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N
        elID = "<>"
        On Error Resume Next
        elID = aDoc.getElementById(aID).Id  '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||78e||64fe|
        On Error GoTo 0

    Loop While Not elID <> "<>"

    '|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|NOK
    WaitActualItemById = True

    endOf C_FUNC_NAME   '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: Web|fffd||fffd||282||312|l|fffd||64fe|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||64fe||fffd||fffd||fffd||fffd||fffd|l
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aDoc - |fffd||38f||6c2||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@aName - |fffd||38f||6cd||fffd||fffd||682||fffd|Name
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: Name|fffd|w|fffd||fffd||fffd|Web|fffd||fffd||28f||fffd||312|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: Name|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||34b||d5d8e||fffd||fffd||fffd||502||fffd|
'
Public Function GetElementByNameValue(aDoc As HTMLDocument, aName As String) As String
    Const C_FUNC_NAME = "GetElementByNameValue"
    startOf C_FUNC_NAME                                      '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
    Log aName

    Dim elType          As String                           '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||fffd|
    Dim val             As String                           '|fffd||64fe||fffd|l
    Dim RadioElement    As HTMLInputElement                 'Radio|fffd||312|l|fffd||64fe|

    '==================
    '=== |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ===
    '==================
    elType = ""
    val = ""


    '================
    '=== |fffd|l|fffd||30e||64fe| ===
    '================
    On Error Resume Next
    elType = aDoc.getElementsByName(aName)(0).Type          '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||78e||64fe|
    On Error GoTo 0

    If elType <> "" Then
        '|fffd|t|fffd|B|fffd|[|fffd||fffd||fffd|h|fffd||fffd||795||282||252|l|fffd||30e||64fe||fffd||fffd||fffd|@|fffd||fffd||3cd|X
        Select Case elType
        Case "checkbox"
            '|fffd|F|fffd|`|fffd|F|fffd|b|fffd|N|fffd|{|fffd|b|fffd|N|fffd|X
            If aDoc.getElementsByName(aName)(0).Checked = True Then
                val = aDoc.getElementsByName(aName)(0).Value
            End If

        Case "radio"
            '|fffd|F|fffd||fffd||fffd|W|fffd|I|fffd|{|fffd|^|fffd||fffd|
            For Each RadioElement In aDoc.getElementsByName(aName)
                If RadioElement.Checked = True Then
                    val = RadioElement.Value
                    Exit For
                End If
            Next RadioElement

        Case Else
            '|fffd|F|fffd||fffd||fffd||311||fffd||fffd|i|fffd|e|fffd|L|fffd|X|fffd|g|fffd|j
            val = aDoc.getElementsByName(aName)(0).Value
        End Select
    End If
    GetElementByNameValue = val

    '|fffd||fffd||fffd|O|fffd||30f|o|fffd||fffd|
    If elType <> "" Then
        Log aName & "|fffd|^Val:=" & val & "|fffd|^Type:=" & elType
    Else
        Log aName & "|fffd|i|fffd||fffd||fffd||fffd||fffd||38f||6c2||202||fffd||fffd|j"
    End If


    '================
    '=== |fffd|I|fffd||fffd||fffd||fffd||fffd||fffd| ===
    '================
    Set RadioElement = Nothing

    endOf C_FUNC_NAME                                        '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|S|fffd||fffd|v|fffd||fffd|)
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||64fe||fffd||fffd||fffd||fffd||fffd|l
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: htdoc  : |fffd||38f||6c2||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
'             key    : |fffd|L|fffd|[|fffd||182||202||fffd|l(|fffd||fffd||fffd|S|fffd||fffd|v|fffd||152|T|fffd||fffd||fffd||702||fffd|)
'             skip   : |fffd|L|fffd|[|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||241|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'             offset : |fffd|L|fffd|[|fffd||fffd||fffd||fffd|l|fffd||702||142||311||fffd||fffd||388||292|u
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: egg|fffd||fffd|getTDValue|fffd||fffd||fffd||fffd||fffd||182||24f|C|fffd||fffd|
'             |fffd|O|fffd||fffd||30b||d4482||356||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|
'
Public Function getTDValuePm(ByVal htDoc As HTMLDocument, ByVal key As String, Optional ByVal Skip As Long = 0, Optional ByVal offset As Long = 0) As String
    Const C_FUNC_NAME = "getTDValuePm"
    startOf C_FUNC_NAME  '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***

    Dim ret As String
    Dim tds As IHTMLElementCollection
    Dim td As HTMLTableCell
    Dim skipCount As Long

    skipCount = Skip
    Set tds = htDoc.getElementsByTagName("TD")

    For Each td In tds
        If Trim(td.innerText) = Trim(key) Then
            If skipCount > 0 Then
                skipCount = skipCount - 1
            Else
                Log key & "|fffd||311||38f||6c3|Z|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd|"
                ret = Trim(htDoc.all(td.sourceIndex + offset).innerText)
                Exit For
            End If
        End If
    Next td
    getTDValuePm = ret

    endOf C_FUNC_NAME    '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||fffd|(|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||80a0||fffd||fffd|)
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True  : |fffd||fffd||fffd||fffd|I|fffd||fffd|
'             False : |fffd||64f||fffd|I|fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aIE                    : IE|fffd||30e|Q|fffd||fffd|
'             aFrameCommaTextHdrNavi : |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||30a|K|fffd|w|fffd||fffd||fffd||73c7||fffd||243|J|fffd||fffd||fffd|}|fffd||fffd||602||fffd||14e|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|AIE|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||355|s|fffd|v|fffd|j(Hdr|fffd|ANavi|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|p)
'             aFrameCommaTextApp     : |fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||30a|K|fffd|w|fffd||fffd||fffd||73c7||fffd||243|J|fffd||fffd||fffd|}|fffd||fffd||602||fffd||14e|w|fffd||80b5||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|AIE|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||355|s|fffd|v|fffd|j(App1|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|p)
'             aCaption               : |fffd||38f||6c2||303||fffd||fffd||fffd||fffd|N|fffd||315||fffd||fffd||fffd||fffd||fffd|
'             aNextTitle             : |fffd||fffd||fffd||fffd||fffd|N|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||309||fffd||282||303|^|fffd|C|fffd|g|fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd||fffd||303||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd|(|fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|)|fffd||702||14c|J|fffd||fffd||502||fffd|
'             |fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd|w|fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||309||fffd||282||251|J|fffd||682||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||80b7||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@: |fffd||53bca||fffd||fffd||303||fffd||fffd||fffd||fffd|N|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||242||354||fffd||389||fffd||fffd||142||fffd|
'             aFrameCommaTextHdrNavi,aFrameCommaTextApp|fffd||302||1c2||fffd||fffd||70a9||fffd||303|t|fffd||fffd||fffd|[|fffd||fffd||fffd|z|fffd||fffd||fffd||143|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd||702||14c|J|fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'
Public Function clickAnchorChkTitle(ByVal aIE As InternetExplorer, ByVal aFrameCommaTextHdrNavi As String, ByVal aFrameCommaTextApp As String, ByVal aCaption As String, ByVal aNextTitle As String) As Boolean
    Const C_FUNC_NAME = "clickAnchorChkTitle"
    startOf C_FUNC_NAME  '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
    Log "aFrameCommaTextHdrNavi : " & aFrameCommaTextHdrNavi
    Log "aFrameCommaTextApp : " & aFrameCommaTextApp
    Log "aCaption = " & aCaption
    Log "aNextTitle = " & aNextTitle

    Dim htDoc       As HTMLDocument '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd|
    Dim stDt        As Date         '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||fffd|
    Dim ret         As Boolean      '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|


    '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
    stDt = Now

    '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||90a9||fffd|A|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd||702||143||fffd||fffd|[|fffd|v
    Do While 1
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
        If DateDiff("s", stDt, Now) >= C_TIME_OUT Then
            ExitOf C_FUNC_NAME, "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            Exit Function
        End If

        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If isIeError(aIE) = True Then
            ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||fffd||fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||502||242||202||fffd||fffd||fffd|"
            Exit Function
        End If

        Sleep 10
        DoEvents

        '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd|1|fffd|z|fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
        Set htDoc = GetDocument(aIE, aFrameCommaTextHdrNavi)
        If htDoc Is Nothing Then
            '|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
            ExitOf C_FUNC_NAME, "|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd|s(aFrameCommaTextHdrNavi)"
            Exit Function
        End If

        '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
        ret = clickAnchor(htDoc, aCaption)
        If ret = True Then
            '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd||fffd||70cb||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            Exit Do
        End If

        '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd|2|fffd|z|fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
        Set htDoc = GetDocument(aIE, aFrameCommaTextApp)
        If htDoc Is Nothing Then
            '|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
            ExitOf C_FUNC_NAME, "|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd|s(aFrameCommaTextApp)"
            Exit Function
        End If

        '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
        ret = clickAnchor(htDoc, aCaption)
        If ret = True Then
            '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd||fffd||70cb||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            Exit Do
        End If
    Loop

    '|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||142||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||291|J|fffd||682||fffd||482||fffd|
    Call waitForBrowse(aIE)

    '|fffd||fffd||fffd||80b7||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||30e|w|fffd||80aa||fffd||202||fffd||fffd||a347|
    If aNextTitle = "" Then
        '|fffd||fffd||fffd||fffd|I|fffd||fffd|
        clickAnchorChkTitle = True
        ExitOf C_FUNC_NAME, ""
        Exit Function
    End If

    '|fffd||fffd||fffd||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd||502||fffd||794||fffd|
    stDt = Now

    '|fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||702||783|^|fffd|C|fffd|g|fffd||fffd||fffd||242||202||90a9||fffd|A|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd||702||143||fffd||fffd|[|fffd|v
    Do While 1
        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|
        If DateDiff("s", stDt, Now) >= C_TIME_OUT Then
            ExitOf C_FUNC_NAME, "|fffd||fffd||fffd||fffd||fffd||38f||6c2||303||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
            Exit Function
        End If

        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If isIeError(aIE) = True Then
            ExitOf C_FUNC_NAME, "IE|fffd||fffd||fffd||fffd||fffd|p|fffd||142||fffd||fffd||202||fffd||fffd||fffd||502||242||202||fffd||fffd||fffd|"
            Exit Function
        End If

        Sleep 10
        DoEvents

        '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|z|fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
        Set htDoc = GetDocument(aIE, aFrameCommaTextHdrNavi)
        If htDoc Is Nothing Then
            '|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
            ExitOf C_FUNC_NAME, "|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd|s(aFrameCommaTextHdrNavi)"
            Exit Function
        End If

        If InStr(Trim(htDoc.Title), aNextTitle) > 0 Then
            '|fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||702||783|^|fffd|C|fffd|g|fffd||fffd||fffd||242||202||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            Exit Do
        End If

        '|fffd|w|fffd||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|z|fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||64fe|
        Set htDoc = GetDocument(aIE, aFrameCommaTextApp)
        If htDoc Is Nothing Then
            '|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
            ExitOf C_FUNC_NAME, "|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd|s(aFrameCommaTextApp)"
            Exit Function
        End If

        If InStr(Trim(htDoc.Title), aNextTitle) > 0 Then
            '|fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||702||783|^|fffd|C|fffd|g|fffd||fffd||fffd||242||202||fffd||fffd||fffd||fffd||302||141|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            Exit Do
        End If
    Loop

    '|fffd||fffd||fffd||fffd|I|fffd||fffd|
    clickAnchorChkTitle = True

    endOf C_FUNC_NAME    '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
End Function

''
'' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||fffd||fffd||102||44f|o|fffd||fffd|
''
'' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||14e||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
''
'' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: aZipCode : |fffd|X|fffd||594||50d||fffd|
'' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@  aAddress : |fffd|Z|fffd||fffd|
''
'' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@:
''
'' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
''
'Public Function QuickSearch(ByVal aZipCode As String, ByVal aAddress As String) As T_QuickSearchResult
'    Const C_FUNC_NAME = "QuickSearch"
'    startOf C_FUNC_NAME  '*** |fffd||590||fffd||fffd||30a|J|fffd|n|fffd||fffd||fffd|O ***
'    Log "aZipCode = " & aZipCode
'    Log "aAddress = " & aAddress
'
'    Dim url         As String               'URL
'    Dim ie          As InternetExplorer     'IE|fffd|Q|fffd||fffd|
'    Dim title       As String               'IE|fffd|^|fffd|C|fffd|g|fffd||fffd|
'    Dim pos         As Long                 '|fffd||fffd||fffd||fffd||fffd||292|u
'    Dim hdoc        As HTMLDocument         'Document
'
'
'    QuickSearch.result = False
'
'    '|fffd||48e||c2bc2||30f||fffd||fffd||fffd||fffd||752||fffd|
'    Call InitWaitingLevel
'
'    'MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd||64fe|
'    url = ""
'    url = Trim(getRunningMS1URL)            '|fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|URL|fffd||64fe|
'    If url = "" Then
'        url = Trim(getRegisteredMS1URL)     '|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd||353|o|fffd|^|fffd||3c2||fffd|URL|fffd||fffd||fffd||64fe|
'    End If
'    If url = "" Then
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''        Call MsgBoxEx("|fffd|l|fffd|b|fffd|g|fffd||fffd||fffd|[|fffd|N|fffd||310||691||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbExclamation)
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'        Call MsgBoxEx("|fffd|l|fffd|b|fffd|g|fffd||fffd||fffd|[|fffd|N|fffd||310||691||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbExclamation, "|fffd|G|fffd||fffd||fffd|[")
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'        ExitOf C_FUNC_NAME, ""
'        Exit Function
'    End If
'    pos = InStr(url, "?")                   'URL|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|J|fffd|n|fffd||292|u
'    If pos > 0 Then
'        url = Left(url, pos - 1)
'    End If
'
'    '|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||fffd|URL|fffd||fffd||fffd||64fe|
'    url = Replace(url, "jsp/hubBypass.jsp", _
'                       "servlet/AddressSearchServlet?submitButton1=QuickSearch", _
'                       Compare:=vbTextCompare)
'    url = url & "&zip_code=" & aZipCode & "&searchAddress1=" & aAddress
'                                            'MS1|fffd|I|fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd||fffd|URL|fffd||fffd||fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||fffd|URL|fffd||249||fffd||fffd|H|fffd||fffd||fffd||fffd|
'    Log url
'
'    '|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||30c||102||44f|o|fffd||fffd|
'    Set ie = insteadCreateIE(url)
'    ie.Visible = False
'    ie.Navigate2 url
'    Call waitForBrowse(ie)
'    Call showForeground(ie.hwnd)
'
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|m|fffd||80b7||fffd||fffd||702||151||482||fffd||fffd||fffd|
'    Do
'        Sleep 10
'        DoEvents
'
'        'IE|fffd||303|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
'        If isIeError(ie) = True Then
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''            Call MsgBoxEx("|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbExclamation)
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'            Call MsgBoxEx("|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd||fffd||282||fffd||fffd||82||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", vbExclamation, "|fffd|G|fffd||fffd||fffd|[")
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'            ExitOf C_FUNC_NAME, ""
'            Exit Function
'        End If
'
'        '|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||30e||64fe|
'        title = ""
'        On Error Resume Next
'        Set hdoc = ie.document
'        title = StrConv(hdoc.title, vbWide)
'        On Error GoTo 0
'
'        '=== IE|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||242||fffd||fffd||fffd||502||14ed2|f ===
'        Log "title:=" & title
'        Select Case title
'            Case "|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`"
'                '---|fffd|u|fffd|N|fffd|C|fffd|b|fffd|N|fffd|T|fffd|[|fffd|`|fffd|v---
'                '|fffd|@|fffd|@|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||151||482||fffd|
'                If ie.Visible = False Then
'                    ie.Visible = True
'                End If
'
'            Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                '---|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||281|v---
'                '|fffd|@|fffd|@|fffd|@|fffd||fffd| |fffd|\|fffd||fffd||fffd||fffd||fffd|e|fffd||242||fffd||fffd||fffd||115||fffd||fffd||fffd|
'
'                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||288||fffd||4c2||252||fffd||702||fffd||18f|o|fffd||102||fffd||fffd||fffd||fffd||282||302||741|u|fffd|Z|fffd||fffd|(|fffd||fffd||fffd||fffd|)|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|
'                '|fffd||fffd||fffd||30c||fffd||fffd|t|fffd||148||fffd||4c2||252||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||80b7||fffd||fffd|
'                pos = 0
'                On Error Resume Next
'                pos = InStr(ie.document.body.innerText, "|fffd|Z|fffd||fffd|(|fffd||fffd||fffd||fffd|)")
'                On Error GoTo 0
'
'                If pos = 0 Then
'                    '---|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||287|@|fffd|v---
'                    '|fffd|@|fffd|@|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||151||482||fffd|
'                    Log "|fffd|@|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||287|@|fffd|v"
'                    If ie.Visible = False Then
'                        ie.Visible = True
'                    End If
'                Else
'                    '---|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||287|A|fffd|v---
'                    '|fffd|@|fffd|@|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||30e||64fe|
'                    Log "|fffd|@|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||287|A|fffd|v"
'                    ie.Visible = False
'                    Exit Do
'                End If
'
'            Case "|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|["
'                '---|fffd|u|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|v---
'                '|fffd|@|fffd|@|fffd|@|fffd||fffd| |fffd|Y|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||202||fffd|
'                ie.Visible = False
'                Exit Do
'
'            Case Else
'                '--- |fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd| ---
'                '|fffd|@|fffd|@|fffd|@|fffd||fffd| |fffd||fffd||fffd|O|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|IE|fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||fffd||702||151||482||fffd|
'                If ie.Visible = False Then
'                    ie.Visible = True
'                End If
'        End Select
'    Loop
'
'    '--- |fffd|u|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|v|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd| ---
'    If title = "|fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[" Then
'        Call IE_Quit(ie)
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''        Call MsgBoxEx("|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B", vbInformation)
''|fffd||fffd|2016/08/05 H.U |fffd||d3dc| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'        Call MsgBoxEx("|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|B", vbInformation, "|fffd|m|fffd|F")
''|fffd||fffd|2016/08/05 H.U |fffd||1c9||fffd| |fffd||fffd||fffd|P|fffd|v|fffd|](RC02)
'        ExitOf C_FUNC_NAME, ""
'        Exit Function
'    End If
'
'    '---|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||287|A|fffd|v|fffd||fffd||20aa||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd| ---
'    QuickSearch.zipCode = getTDValuePm(ie.document, "|fffd|X|fffd||594||50d||fffd|", 0, 4)
'    QuickSearch.addrKnji = getTDValuePm(ie.document, "|fffd|Z|fffd||fffd|(|fffd||fffd||fffd||fffd|)", 0, 4)
'    QuickSearch.addrKana = getTDValuePm(ie.document, "|fffd|Z|fffd||fffd|(|fffd|J|fffd|i)", 0, 4)
'    QuickSearch.result = True
'    Call IE_Quit(ie)
'
'    endOf C_FUNC_NAME    '*** |fffd||590||fffd||fffd||30f|I|fffd||fffd||fffd||fffd||fffd|O ***
'End Function
'
Attribute VB_Name = "mdlOshirase"
Option Explicit

Public Function openOshiraseFile(targetRow As Long, SaveDir As String) As Boolean

    Dim tempFilePath As String
    Dim newFilePath  As String

    openOshiraseFile = False

    '|fffd|u|fffd||fffd||fffd|m|fffd||70b9||fffd|c|fffd|[|fffd||fffd||fffd||253|\|fffd||fffd|t|fffd||fffd||fffd|v|fffd||fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|
    If shtList.Cells(targetRow, COL_shtList.|fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O) = "" Then
        ExitOf "openOshiraseFile", "|fffd||38f||6ca|O|fffd||30d|s"
        Exit Function
    End If
    
    shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = ""
    
    '|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||302||751||38f||6c2||182||fffd||fffd||fffd|B|fffd|i|fffd||fffd|s|fffd||fffd|1|fffd||fffd||fffd||752||80b3||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||34d||c42c||fffd||fffd||fffd||202||fffd|)
    If shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = "" Then
        shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = "|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||302||fffd||fffd||7cd||c42c||fffd||38f||6ca|O"
        ExitOf "openOshiraseFile", "|fffd||38f||6ca|O|fffd||30d|s(|fffd|O|fffd||60c||fffd||fffd||50d||fffd||fffd||202||fffd|)"
        Exit Function
    End If
    
    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|c|fffd||fffd||fffd||c42c||fffd|j
    tempFilePath = ThisWorkbook.path & "\" & TEMPLATE_FILE_INNER_PATH & "\" & TEMPLATE_FILE_NAME

    newFilePath = SaveDir & "\" & shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value & "_" & shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value & ".xls"

    If Dir(newFilePath) <> "" Then
        '|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd||302||154||fffd||382||fffd|(|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|d|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||30d|s|fffd||fffd||fffd|D|fffd||60b3||fffd||fffd||90b1||fffd||182||242||202||fffd|)
        shtList.Cells(targetRow, COL_shtList.|fffd|G|fffd||fffd||fffd|[).Value = "|fffd||fffd||fffd|X|fffd|g|fffd|d|fffd||fffd||fffd||302||fffd||fffd||7cd||c42c||fffd||38f||6ca|O"
        ExitOf "openOshiraseFile", "|fffd||fffd||fffd|X|fffd|g|fffd|d|fffd||fffd||fffd|i|fffd||fffd||fffd||253||fffd||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||fffd|)"
        Exit Function
    End If

    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||10c||95||282||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||c42c||fffd||fffd||fffd||fffd|
    FileCopy tempFilePath, newFilePath

    '|fffd||95||283|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Application.EnableEvents = False
    With Workbooks.Open(fileName:=newFilePath, PassWord:=TEMPLATE_TOOL_PASSWORD)
        Application.EnableEvents = True
        '|fffd||fffd|{|fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Unprotect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD
        '|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd|A|fffd||fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd|, COL_shtTemplate_Info.|fffd|I|fffd||fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd|, COL_shtInputInfo.|fffd|I|fffd||fffd||fffd|).Value

        '|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd|, COL_shtTemplate_Info.|fffd|I|fffd||fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd|, COL_shtInputInfo.|fffd|I|fffd||fffd||fffd|).Value

        '|fffd||fffd||fffd||fffd||fffd||fffd||782||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd||fffd||fffd||50d||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd||fffd||50d||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|`|fffd|l|fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|`|fffd|l, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|`|fffd|l, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g|fffd||752||fffd|
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Unprotect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD
        '|fffd|S|fffd||fffd||fffd||496||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd|S|fffd||fffd||fffd||496||fffd|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtList.Cells(targetRow, COL_shtList.|fffd|S|fffd||fffd||fffd||496||fffd|).Value

        '|fffd|@|fffd|l|fffd||90|l|fffd||656a||fffd||fffd||752||fffd|
        If shtList.Cells(targetRow, COL_shtList.|fffd|@|fffd|l|fffd||90|l|fffd||656a|).Value = "1" Then
            .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd|@|fffd|l|fffd||90|l|fffd||656a|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = "|fffd||90|l"
        ElseIf shtList.Cells(targetRow, COL_shtList.|fffd|@|fffd|l|fffd||90|l|fffd||656a|).Value = "2" Then
            .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd|@|fffd|l|fffd||90|l|fffd||656a|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = "|fffd|@|fffd|l"
        End If

'|fffd|R|fffd||fffd||fffd|v|fffd||fffd||fffd||315||fffd||fffd|j|fffd||242||fffd||fffd|A|fffd||fffd||fffd|q|fffd|l|fffd||fffd||fffd||352||fffd||fffd||fffd|t|fffd||fffd||fffd||202||fffd|
'            '|fffd||fffd||fffd|q|fffd||fffd||fffd||710||fffd||fffd||fffd||752||fffd|
'            .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd||fffd||fffd|q|fffd||fffd||fffd||710||fffd|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = Split(shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value, "|fffd|@")(0)
'            '|fffd||fffd||fffd|q|fffd||fffd||fffd||716||fffd||fffd||fffd||752||fffd|
'            .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd||fffd||fffd|q|fffd||fffd||fffd||716||fffd|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = Split(shtList.Cells(targetRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value, "|fffd|@")(1)

        '|fffd||fffd||fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Cells(ROW_shtTemplate_Input.|fffd||fffd||fffd||60c||fffd||fffd||50d||fffd|, COL_shtTemplate_Input.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtList.Cells(targetRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value

        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Protect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Protect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD
        
        '|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||502||142||fffd||fffd||fffd||fffd|
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Activate
        
        '|fffd||6d1||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||103|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||82||fffd||fffd||fffd||fffd||24f|I|fffd||fffd||fffd|
        .Save

        openOshiraseFile = True
    End With
End Function


'|fffd||fffd||fffd|m|fffd||70b9||fffd||c42c||fffd|c|fffd|[|fffd||fffd||fffd|i|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd|)|fffd||fffd||1c2||74e||fffd||fffd||fffd|p|fffd||14a|J|fffd||fffd||fffd|B|fffd||fffd|{|fffd||fffd||fffd||302||752||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|B
Public Function openOshiraseFile_simple() As Boolean

    Dim tempFilePath As String

    openOshiraseFile_simple = False

    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|c|fffd||fffd||fffd||c42c||fffd|j
    tempFilePath = ThisWorkbook.path & "\" & TEMPLATE_FILE_INNER_PATH & "\" & TEMPLATE_FILE_NAME

    '|fffd|e|fffd||fffd||fffd|v|fffd||fffd||fffd|[|fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd|
    Application.EnableEvents = False
    With Workbooks.Open(fileName:=tempFilePath, PassWord:=TEMPLATE_TOOL_PASSWORD, ReadOnly:=True)
        Application.EnableEvents = True
        '|fffd||fffd|{|fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Unprotect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD
        '|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd|A|fffd||fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|A|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd|, COL_shtTemplate_Info.|fffd|I|fffd||fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|Z|fffd|@|fffd||596||fffd|_|fffd|I|fffd||fffd|, COL_shtInputInfo.|fffd|I|fffd||fffd||fffd|).Value

        '|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd|, COL_shtTemplate_Info.|fffd|I|fffd||fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|x|fffd|X_|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|I|fffd||fffd|, COL_shtInputInfo.|fffd|I|fffd||fffd||fffd|).Value

        '|fffd||fffd||fffd||fffd||fffd||fffd||782||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd||fffd||fffd||50d||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd||fffd||50d||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd|L|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd||fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd|, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||40a4||fffd||fffd||fffd||fffd||292||fffd||fffd||50d||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        '|fffd||fffd||fffd|`|fffd|l|fffd||fffd||752||fffd|
        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Cells(ROW_shtTemplate_Info.|fffd||fffd||fffd|`|fffd|l, COL_shtTemplate_Info.|fffd|f|fffd|[|fffd|^|fffd||fffd|) = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd|`|fffd|l, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

        .Worksheets("|fffd||fffd|{|fffd||fffd||fffd|").Protect PassWord:=TEMPLATE_TOOL_HOGO_PASSWORD

        '|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||502||142||fffd||fffd||fffd||fffd|
        .Worksheets("|fffd||fffd||fffd||357|p|fffd|V|fffd|[|fffd|g").Activate
        
        openOshiraseFile_simple = True
    End With
End Function
Attribute VB_Name = "mdlTorikomi"
Option Explicit


'|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||313||fffd||fffd||fffd|
Public Function get|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|() As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    startOf "input|fffd||fffd||fffd||fffd|Condition"
    Dim mnkFi  As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    '|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|(|fffd|O|fffd||fffd||fffd||fffd|v)
    Const MATCH_FORWARD = 1

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    mnkFi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd| = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value & shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
    If shtInputInfo.CheckBoxes("CHECK_ALL_AG").Value = xlOn Then
        mnkFi.c|fffd||fffd||fffd||5c2||102||311||35dd||fffd|X = True
    End If

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    mnkFi.p|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd| = MATCH_FORWARD
    mnkFi.t|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
    mnkFi.p|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd| = MATCH_FORWARD
    mnkFi.t|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value

    '|fffd|c|fffd||fffd|
    mnkFi.t|fffd|c|fffd||fffd| = shtInputInfo.Cells(ROW_shtInputInfo.|fffd|c|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
    
    '|fffd||fffd||fffd||356a|
    If shtInputInfo.Cells(ROW_shtInputInfo.|fffd||356a|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value = "|fffd||fffd||fffd||fffd|" Then
    mnkFi.p|fffd||356a| = "1"
    ElseIf shtInputInfo.Cells(ROW_shtInputInfo.|fffd||356a|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value = "|fffd||4ac8e||fffd||fffd||302||fffd|" Then
    mnkFi.p|fffd||356a| = "2"
    End If

    mnkFi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| = shtInputInfo.Cells(ROW_shtInputInfo.|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|, COL_shtInputInfo.|fffd|f|fffd|[|fffd|^|fffd||fffd|).Value
'        mnkFi.t|fffd||fffd||fffd||fffd||fffd||fffd|FROM = shtMankiMenu.Range(C_|fffd||fffd||fffd||fffd|MENU_|fffd||fffd||fffd||fffd||fffd||fffd|FROM).Value
'        mnkFi.t|fffd||fffd||fffd||fffd||fffd||fffd|TO = shtMankiMenu.Range(C_|fffd||fffd||fffd||fffd|MENU_|fffd||fffd||fffd||fffd||fffd||fffd|TO).Value
'    If shtMankiMenu.Shapes("CHECK_JIDOUSYA").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(0) = True
'    If shtMankiMenu.Shapes("CHECK_JIBAI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(1) = True
    If shtInputInfo.Shapes("CHECK_KASAI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(2) = True
    If shtInputInfo.Shapes("CHECK_SYOUGAI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(3) = True
    If shtInputInfo.Shapes("CHECK_SINSYU").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(4) = True
'    If shtMankiMenu.Shapes("CHECK_TUMIKASAI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(5) = True
'    If shtMankiMenu.Shapes("CHECK_TUMISYOUGAI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(6) = True
'    If shtMankiMenu.Shapes("CHECK_TUMISINSYU").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(7) = True
'    If shtMankiMenu.Shapes("CHECK_ZAIKEI").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(8) = True
'    If shtMankiMenu.Shapes("CHECK_TYOUKII").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(9) = True
'    If shtMankiMenu.Shapes("CHECK_KAMOTU").ControlFormat.Value = xlOn Then mnkFi.c|fffd||fffd||fffd|(10) = True


    get|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = mnkFi

    endOf "input|fffd||fffd||fffd||fffd|Condition"
End Function


Function torikomiManki(mnkRes As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) As Boolean
    startOf "torikomiManki"
    torikomiManki = True
    
    '|fffd||14f|I|fffd|f|fffd|[|fffd|^|fffd|s|fffd||64fe|
    Dim lastRow As Long
    lastRow = shtList.Cells.SpecialCells(xlLastCell).row + 1
    lastRow = shtList.Cells(lastRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).End(xlUp).row

    If mnkRes.|fffd||8471||fffd||fffd||fffd|@ <> "|fffd|d|fffd|b|fffd||fffd|W" Then
        ExitOf "torikomiManki", "|fffd||38f||6ca|O(|fffd||8471||fffd||fffd||fffd|@)|fffd|F" & mnkRes.|fffd||8471||fffd||fffd||fffd|@
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        torikomiManki = False
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Exit Function
    ElseIf mnkRes.|fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd|" Or mnkRes.|fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd|" Or mnkRes.|fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd|_|fffd||fffd|" Or mnkRes.|fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd|p|fffd||fffd||fffd||fffd|" Then
        ExitOf "torikomiManki", "|fffd||38f||6ca|O(|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd|F" & mnkRes.|fffd||fffd||fffd||fffd||fffd||fffd|
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        torikomiManki = False
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Exit Function
    End If
    lastRow = lastRow + 1

    shtList.Cells(lastRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = mnkRes.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|


    '|fffd|_|fffd||fffd||189||fffd|
    Dim syokaiIe As InternetExplorer

    Set syokaiIe = GetMS1Online("1.1", mnkRes.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).getOnlineIE
    If syokaiIe Is Nothing Then
        '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        Log "GetMS1Online|fffd||fffd||fffd|s"
        MsgBox "|fffd|_|fffd||fffd||189||fffd||fffd||282||fffd||fffd|J|fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        torikomiManki = False
        Exit Function
'2017/04/21 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

    End If
    Call SetForegroundWindow(syokaiIe.hWnd)
    Call waitForBrowse(syokaiIe)

    Call torikomi(syokaiIe, lastRow)

    syokaiIe.Quit
    endOf "torikomiManki"
End Function

Public Function torikomi(syokaiIe As InternetExplorer, lastRow As Long) As Boolean
    Dim polNo As String
    Dim syokaiDoc As HTMLDocument
    Dim tmpMankibi As String

    torikomi = False

    'App1|fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd||303|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe|
    Set syokaiDoc = GetDocument(syokaiIe, "App1")
    If syokaiDoc Is Nothing Then
        '|fffd||64fe||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        Log "|fffd|h|fffd|L|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd||64fe||fffd||fffd||fffd|s"
        MsgBox "|fffd|_|fffd||fffd||189||fffd||fffd||282||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
        ExitOf "torikomi", ""
        Exit Function
    End If
    '|fffd|Y|fffd||fffd||fffd|_|fffd||fffd||202||fffd||fffd||30f||a347|
    If InStr(syokaiDoc.body.innerText, "|fffd|Y|fffd||fffd||fffd|_|fffd||56cc2||fffd|") > 0 Then
        '|fffd|Y|fffd||fffd||fffd|_|fffd||42a82||202||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        Log "|fffd|Y|fffd||fffd||fffd|_|fffd||56cc2||fffd|"
        MsgBox "|fffd|Y|fffd||fffd||fffd|_|fffd||fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If

    '|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||a347|
    If InStr(syokaiDoc.body.innerText, "|fffd|Y|fffd||fffd||fffd|_|fffd||fffd||a5d7|") > 0 Then
        '|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|q|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        Log "|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|q|fffd|b|fffd|g"
        MsgBox "|fffd|w|fffd||fffd||60c||fffd||fffd||50d||fffd||fffd||30c|_|fffd||42a95||fffd||fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||42a8e||64fe||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Exit Function
    End If

    '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||282||fffd||fffd||64fe||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||a347|
    If InStr(syokaiDoc.body.innerText, "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd|i|fffd|t|fffd||fffd||fffd|[|fffd|j") > 0 Then
        '|fffd|t|fffd||fffd||fffd|[|fffd||fffd||282||fffd||fffd||64fe||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||a347||fffd||34f|I|fffd||fffd|
        Log "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd|t|fffd||fffd||fffd|[|fffd||fffd||fffd|"
        MsgBox "|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd|i|fffd|t|fffd||fffd||fffd|[|fffd|j|fffd||fffd||282||142||342||202||fffd||fffd|A|fffd|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd||fffd||fffd|J|fffd||fffd||fffd||10e||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        Exit Function
    End If

    Dim tmpStr As String
    tmpStr = getTDValuePm(syokaiDoc, "", 0, 1)

    '|fffd||60c||fffd||fffd||50d||fffd||fffd||64fe|
    Dim tagValue As Variant
    Dim hit As Long
    hit = 0
    For Each tagValue In syokaiDoc.getElementsByTagName("TD")
        Debug.Print tagValue.innerText
        If hit = 1 Then
            polNo = Trim(tagValue.innerText)
            Exit For
        End If
        If tagValue.innerText = "|fffd||60c||fffd||fffd||50d||fffd|" Then
            hit = 1
        End If
    Next tagValue

    If shtList.Cells(lastRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = "" Then
        shtList.Cells(lastRow, COL_shtList.|fffd|O|fffd||60c||fffd||fffd||50d||fffd|).Value = polNo
    End If

    '|fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||10c|_|fffd||fffd||fffd||fffd|e|fffd||189||fffd|i|fffd|t|fffd||fffd||fffd|[|fffd|j|fffd||fffd||282||251|J|fffd||fffd|
    Call clickAnchor(syokaiDoc, polNo)
    Call waitForBrowse(syokaiIe)

    Dim FreeDataElements() As Variant
    Dim elm As Variant

    For Each elm In getFreeScreenElements(syokaiIe)

'        '|fffd|\|fffd||fffd||fffd||fffd|(010)
'        If elm.getElementID = "(010):" Then
'            shtList.Cells(lastRow, COL_shtList.|fffd|\|fffd||fffd||fffd||fffd|).Value = elm.getValue
'        End If

'2018/04/09 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O
        shtList.Cells(lastRow, COL_shtList.|fffd||fffd||fffd|m|fffd||70b9||fffd|t|fffd||fffd||fffd|O).Value = "1"

    '|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O
        shtList.Cells(lastRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|O).Value = "1"

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O
        shtList.Cells(lastRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd|t|fffd||fffd||fffd|O).Value = "1"

'2018/04/09 |fffd||1c9||fffd| S.M  |fffd||fffd||fffd||fffd||fffd||702||fffd|

        '|fffd||fffd||fffd||fffd||fffd||fffd|
        If elm.getElementID = "|fffd||6cc||fffd||fffd||fffd||fffd||fffd|" Then
            tmpMankibi = elm.getValue
'2019/04/09 |fffd||d3dc| S.M |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|j |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            shtList.Cells(lastRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd|).Value = Mid(tmpMankibi, InStr(tmpMankibi, "-") + 2, 7)
'2019/04/09 |fffd||d3dc| S.M |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|j |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2019/04/09 |fffd||1c9||fffd| S.M |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|j |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            shtList.Cells(lastRow, COL_shtList.|fffd||fffd||fffd||fffd||fffd||fffd|).Value = Mid(tmpMankibi, InStr(tmpMankibi, "-") + 1, 7)
'2019/04/09 |fffd||1c9||fffd| S.M |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|j |fffd||fffd||fffd||fffd||fffd||702||fffd|
        End If
        
        '|fffd||6cc||fffd||fffd||fffd||fffd|
        If elm.getElementID = "|fffd||6cc||fffd||fffd||fffd||fffd|" Then
            shtList.Cells(lastRow, COL_shtList.|fffd||6cc||fffd||fffd||fffd||fffd|).Value = elm.getValue
        End If

        '|fffd|X|fffd||594||50d||fffd|(012)
        If elm.getElementID = "(012):" Then
            shtList.Cells(lastRow, COL_shtList.|fffd|X|fffd||594||50d||fffd|).Value = elm.getValue
        End If

        '|fffd|d|fffd|b|fffd||50d||fffd|(011)
        If elm.getElementID = "(011):" Then
            shtList.Cells(lastRow, COL_shtList.|fffd|d|fffd|b|fffd||50d||fffd|).Value = elm.getValue
        End If

        '|fffd|\|fffd|@|fffd||fffd||fffd|@|fffd|l|fffd|@|fffd|Z|fffd|@|fffd||fffd|(991)
        If elm.getElementID = "(991):" Then
            shtList.Cells(lastRow, COL_shtList.|fffd|_|fffd||fffd||48f|Z|fffd||fffd|).Value = elm.getValue
        End If

        '|fffd|\|fffd|@|fffd||fffd||fffd|@|fffd|l|fffd|@|fffd||fffd||fffd|@|fffd||fffd|(988)
        If elm.getElementID = "(988):" Then
            shtList.Cells(lastRow, COL_shtList.|fffd|_|fffd||fffd||48e||fffd||fffd||fffd|).Value = elm.getValue
        End If

        '|fffd|@|fffd|l|fffd||90|l|fffd||656a|(986)
        If elm.getElementID = "(986):" Then
            shtList.Cells(lastRow, COL_shtList.|fffd|@|fffd|l|fffd||90|l|fffd||656a|).Value = elm.getValue
        End If
    Next elm

    torikomi = True

End Function
Attribute VB_Name = "shtInputInfo"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'2|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|3|fffd|J|fffd||fffd||fffd||fffd||702||142||303||fffd||fffd|X|fffd|g|fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
Public Sub InitMankiManth()
    startOf "InitMankiManth"
    Dim SelectListStr As String
    Dim i As Long
    
    Const MIN_BOUND_MONTH = -2
    Const MAX_BOUND_MONTH = 3
    
    '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
    Me.Unprotect PassWord:=SHEET_PROTECT_PASS

    SelectListStr = ""
    For i = MIN_BOUND_MONTH To MAX_BOUND_MONTH
        SelectListStr = SelectListStr & Format(DateAdd("m", i, Date), "gee/mm") & ","
    Next i
    
    With Me.Range("|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:=SelectListStr
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .IMEMode = xlIMEModeNoControl
        .ShowInput = True
        .ShowError = True
    End With
    
    '|fffd||fffd||fffd|[|fffd|N|fffd|V|fffd|[|fffd|g|fffd||315||6cc||fffd|(UserinterfaceOnly|fffd||183|I|fffd|[|fffd|g|fffd|t|fffd|B|fffd||fffd||fffd|^|fffd|L|fffd||fffd|)
    Me.Protect PassWord:=SHEET_PROTECT_PASS, UserinterfaceOnly:=True, AllowSorting:=True, AllowFiltering:=True
    
    endOf "InitMankiManth"
End Sub


Attribute VB_Name = "shtList"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit



Attribute VB_Name = "shtSetting"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "shtTemplateAtenaLabel"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Attribute VB_Name = "shtTemplateOkurijo"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||389||fffd|"
Option Explicit
Option Compare Text
'==================================================================
' |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd|(|fffd||3cd|X|fffd|s|fffd||81|I|fffd|I)
' |fffd||fffd||fffd||85da||fffd||fffd|
'   2019/03/11 0.01 |fffd||fffd||fffd||617|p|fffd||fffd||fffd||fffd|
'   2019/03/13 0.02 FormatWithout|fffd||fffd||fffd||fffd|Over|fffd||242||101|u\\|fffd|v|fffd||fffd||fffd|u\|fffd|v|fffd||303|G|fffd|X|fffd|P|fffd|C|fffd|v|fffd||182||fffd||fffd||10e|g|fffd|p|fffd||142||fffd||fffd||fffd||60a4||fffd||254||fffd||fffd||fffd|
'                   TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||242||101|u\|fffd|v|fffd||fffd||fffd|G|fffd|X|fffd|P|fffd|C|fffd|v
'                   TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||315|\|fffd||fffd||fffd|`|fffd||fffd||fffd||241|ue|fffd|v|fffd||702||fffd||fffd||341|ug|fffd|v|fffd||fffd||fffd||702||702||fffd||202||fffd||fffd||182||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a||590||fffd||fffd||30e|g|fffd|p|fffd||38f||6ca|O|fffd||142||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||195||502||fffd||fffd||60a4||fffd||255||3cd|X
'   2019/03/13 0.03 Option Compare Text|fffd||fffd||752||fffd|
'                   |fffd||8414||fffd||301|uC_|fffd|v|fffd||343|V|fffd|X|fffd|e|fffd||fffd||fffd|n|fffd||fffd||fffd|K|fffd||fffd||fffd|A|fffd||fffd||fffd||302||fffd||fffd||7cd||d3dc|
'                   |fffd||fffd||fffd||282||313||fffd||fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||312||8414||fffd||255||3cd|X|fffd||fffd||fffd|AFormatWithout|fffd||fffd||fffd||fffd|Over|fffd||fffd|TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||142||fffd||fffd|g|fffd|p
'                   |fffd|e|fffd||590||fffd||fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bc||fffd||fffd||3cd|X
'   2019/03/14 0.04 TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||242||112||28f||fffd||fffd|TEXT|fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||5c2||101|u\|fffd|v|fffd||fffd||fffd|G|fffd|X|fffd|P|fffd|C|fffd|v
'                   |fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd||fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||312||8414||fffd||255||3cd|X
'                   Log|fffd||fffd||fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g(|fffd||fffd||fffd||fffd||fffd|p|fffd||24e|c|fffd||fffd|)
'                   EscapeCharacter|fffd|ATEXTWithout|fffd||fffd||fffd||fffd|Over|fffd|APutCharInDoubleQuotes|fffd||fffd|startOf|fffd|AendOf|fffd||fffd||fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g(|fffd||fffd||fffd||fffd||fffd|p|fffd||24e|c|fffd||fffd|)
'   2019/03/14 0.05 TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||242||112||28f||fffd||fffd|TEXT|fffd||590||fffd||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||5c2||101|u\|fffd|v|fffd||fffd||fffd|G|fffd|X|fffd|P|fffd|C|fffd|v
'                   IsSupported|fffd||fffd||fffd||fffd||fffd||fffd|Log|fffd||1570a||fffd|
'                   |fffd||fffd||fffd||282||313||fffd||fffd||30c|^|fffd||fffd||fffd|w|fffd||fffd|
'                   TEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||312|l|fffd||fffd||fffd||fffd||fffd|t|fffd||182||fffd||fffd||114||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||a347||fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a||590||fffd||fffd||30e|g|fffd|p|fffd||38f||6ca|O|fffd||142||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||195||502||fffd||fffd||60a4||fffd||255||3cd|X
'                   IsSupported|fffd||fffd||fffd||fffd||fffd|AFormatWithout|fffd||fffd||fffd||fffd|Over|fffd|ATEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||314||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||282||313||fffd||fffd|v|fffd||312||8414||fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||fffd||60a4||fffd||255||3cd|X
'   2019/03/14 1.00 |fffd||fffd||fffd|J|fffd|p|fffd||fffd||fffd||fffd|
'                   |fffd||590||fffd||fffd||fffd||fffd||fffd||3cd|X(FormatWithout|fffd||fffd||fffd||fffd|Over|fffd||fffd|Format|fffd||fffd||fffd||fffd||fffd|ATEXTWithout|fffd||fffd||fffd||fffd|Over|fffd||fffd|TEXT|fffd||fffd||fffd||fffd|)
'==================================================================

Private Const |fffd||fffd||fffd||282||313||fffd| As Date = #5/1/2019#
Private Const |fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd| As Date = #1/1/2019# '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|1|fffd||fffd|1|fffd||fffd|
    

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: Office|fffd||309||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||a347||fffd|AFalse|fffd||fffd||502||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: True: |fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Office|fffd||309||fffd||fffd||fffd||fffd||389||fffd||fffd||3c2||741|^False: Office|fffd||309||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: argBorder - Office|fffd||309||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd| |fffd||fffd||fffd||217||fffd||fffd||fffd| [2019/5/1]
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: 2019/5/1|fffd||fffd|a|fffd||fffd||3ca||fffd||fffd||fffd||fffd|A|fffd|N|fffd||fffd|31(|fffd|N)|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||242||fffd|Office|fffd||309||fffd||fffd||fffd||fffd||389||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd|
'             |fffd|i|fffd||150|V|fffd||30d|X|fffd|V|fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd||fffd||fffd|X|fffd|g|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|j|fffd||194||fffd||fffd|f|fffd||fffd||fffd|AFalse|fffd||fffd||502||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function IsSupported|fffd||fffd||fffd||fffd|(Optional ByVal argBorder As Date = |fffd||fffd||fffd||282||313||fffd|) As Boolean
    Const FUNC_NAME = "IsSupported|fffd||fffd||fffd||fffd|"
    Const |fffd||fffd||fffd||fffd||fffd||314|N = "31"

    Dim rtn             As Boolean                          '|fffd||7c2||fffd|l

    startOf FUNC_NAME
    Log "[|fffd||fffd||fffd||fffd|]argBorder:=" & Format(argBorder, "yyyy/mm/dd")

    rtn = True
    If Date >= argBorder Then                               '|fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd|H
        If Format(|fffd||fffd||fffd||282||313||fffd|, "e") = |fffd||fffd||fffd||fffd||fffd||314|N Or Application.WorksheetFunction.text(|fffd||fffd||fffd||282||313||fffd|, "e") = |fffd||fffd||fffd||fffd||fffd||314|N Then
                                                            'Format|fffd||fffd|Text|fffd||590||fffd||fffd||302||fffd||fffd||fffd||fffd||a0a9||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd|H
            Log "Office(Excel)|fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd||251||389||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
            rtn = False
        End If
    End If


    Log "[|fffd||7c2||fffd|l]" & CStr(rtn)
    IsSupported|fffd||fffd||fffd||fffd| = rtn

    endOf FUNC_NAME
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||302||182||fffd||fffd||10c|v|fffd|Z|fffd||fffd||fffd||fffd|Format|fffd||590||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: 2019/5/1|fffd||20d|~|fffd||313||fffd||fffd|t|fffd||fffd||fffd|w|fffd||80b5||fffd||fffd||fffd||a347||fffd||241|A|fffd||fffd||fffd||fffd||fffd||182||742||202||fffd||fffd||112|l|fffd||fffd||502||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||20d|~|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||28f||fffd||fffd|Format|fffd||590||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: expression - Format|fffd||590||fffd||fffd||fffd|expression|fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@formatStr - Format|fffd||590||fffd||fffd||fffd|format|fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@firstdayofweek - Format|fffd||590||fffd||fffd||fffd|firstdayofweek|fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@firstweekofyear - Format|fffd||590||fffd||fffd||fffd|VbFirstWeekOfYear|fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| - |fffd|w|fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||30f||a347||fffd||350|V|fffd||fffd||fffd||fffd||fffd||15f50||fffd||fffd||182||742||202||fffd|(|fffd||fffd||fffd||fffd||fffd|l2019|fffd|N5|fffd||fffd|1|fffd||fffd|)
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|O|fffd||30f||a347||fffd||241|A|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||255||fffd||fffd||fffd||fffd||582||742||202||fffd|Format|fffd||590||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd||311||fffd||fffd||30f||a347||fffd||fffd|Format|fffd||590||fffd||fffd||30c||fffd||fffd||282||fffd||502||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function Format|fffd||fffd||fffd||fffd|(ByVal expression As Variant _
                                , Optional ByVal formatStr As Variant _
                                , Optional ByVal firstdayofweek As VbDayOfWeek = vbSunday _
                                , Optional ByVal firstweekofyear As VbFirstWeekOfYear = vbFirstJan1 _
                                , Optional ByVal |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| As Date = |fffd||fffd||fffd||282||313||fffd| _
                                ) As Variant
    Const PROC_NAME = "Format|fffd||fffd||fffd||fffd|"
    startOf PROC_NAME
    'Log "|fffd||fffd||fffd||fffd||fffd|F" & expression & "(" & TypeName(expression) & ")" & vbTab & formatStr & vbTab & firstdayofweek & vbTab & firstweekofyear & vbTab & |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd|

    Dim ret As String
    Dim tmpDate As Date
    Dim tmpFormatStr As String
    Dim |fffd||fffd||fffd||fffd||fffd||142||314|N As Long
    Static re As RegExp
    Dim matches As MatchCollection
    Dim m As Match
    Dim tmpStr As String
    
    If InStr(formatStr, "g") > 0 Or InStr(formatStr, "e") > 0 Then
    
        If UCase(TypeName(expression)) = "DATE" Then
            tmpDate = expression
            'Log "tmpDate(TypeName)|fffd|F" & tmpDate
        ElseIf IsDate(expression) Then
            tmpDate = CDate(expression)
            'Log "tmpDate(CDate)|fffd|F" & tmpDate
        End If
        If tmpDate > 0 Then
            '|fffd||fffd||fffd||fffd||fffd||20d|~|fffd||313||fffd||fffd|t|fffd||30f||a347|
            If tmpDate >= |fffd||fffd||fffd||282||313||fffd| Then
                If re Is Nothing Then
                    Set re = New RegExp
                    re.Pattern = "(""[^""]*""|""[^""]*|\\\\|\\g|\\e|ggg|gg|g|ee|e|.)"
                    re.Global = True
                    re.IgnoreCase = True
                End If
                Set matches = re.Execute(formatStr)
                
                '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||20d|~|fffd||30f||a347||fffd||fffd|Format|fffd||590||fffd||fffd||fffd||fffd||fffd||fffd||302||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
                If Date >= |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| Then
                    ret = Format(expression, formatStr, firstdayofweek, firstweekofyear)
                '|fffd|a|fffd||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||702||78f||a347|
                Else
                    |fffd||fffd||fffd||fffd||fffd||142||314|N = DateDiff("yyyy", |fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd|, tmpDate) + CLng(Format(|fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd|, "e"))
                    'Log "|fffd||fffd||fffd||fffd||fffd||142||314|N|fffd|F" & |fffd||fffd||fffd||fffd||fffd||142||314|N
                
                    For Each m In matches
                        Select Case LCase(m.Value)
                        Case "ggg"
                            tmpStr = EscapeCharacter("|fffd||fffd||fffd||fffd|")
                        Case "gg"
                            tmpStr = EscapeCharacter("|fffd||fffd|")
                        Case "g"
                            tmpStr = EscapeCharacter("H")
                        Case "ee"
                            tmpStr = EscapeCharacter(Format(|fffd||fffd||fffd||fffd||fffd||142||314|N, "00"))
                        Case "e"
                            tmpStr = EscapeCharacter(CStr(|fffd||fffd||fffd||fffd||fffd||142||314|N))
                        Case Else
                            tmpStr = m.Value
                        End Select
                        tmpFormatStr = tmpFormatStr & tmpStr
                    Next m
                    'Log "tmpFormatStr|fffd|F" & tmpFormatStr
                    ret = Format(expression, tmpFormatStr, firstdayofweek, firstweekofyear)
                End If
            Else
                ret = Format(expression, formatStr, firstdayofweek, firstweekofyear)
            End If
            Set matches = Nothing
            Set m = Nothing
        '|fffd||fffd||fffd|t|fffd||142||202||fffd||fffd||a347||fffd||fffd|Format|fffd||590||fffd||fffd||fffd||fffd||fffd||fffd||302||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
        Else
            ret = Format(expression, formatStr, firstdayofweek, firstweekofyear)
        End If
    '|fffd||fffd|L|fffd||20a|O(|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|O|fffd||141|A|fffd|N|fffd||fffd||fffd||598|A|fffd||fffd||fffd||702||702||202||fffd||fffd||a347|)|fffd||352||28f||fffd||fffd|Format|fffd||590||fffd|
    Else
        ret = Format(expression, formatStr, firstdayofweek, firstweekofyear)
    End If
    Format|fffd||fffd||fffd||fffd| = ret
    'Log "|fffd||7c2||fffd|l|fffd|F" & ret
    endOf PROC_NAME
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd||fffd||313||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||a576||fffd||fffd||fffd||fffd||fffd||93||fffd||fffd||fffd|\|fffd||fffd|t|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetStr - \|fffd||fffd|t|fffd||fffd||fffd||fffd||38f||6c2||315||fffd||fffd||fffd||fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||fffd||fffd||fffd||150||752||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a576||fffd||fffd||fffd||fffd||fffd||93||fffd||fffd||fffd|\|fffd||fffd||fffd||82||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Private Function EscapeCharacter(ByVal targetStr As String) As String
    Const PROC_NAME = "EscapeCharacter"
    'startOf PROC_NAME
    'Log "|fffd||fffd||fffd||fffd||fffd|F" & targetStr
    Dim ret As String
    Dim i As Long
    For i = 1 To Len(targetStr)
        ret = ret & "\" & Mid(targetStr, i, 1)
    Next
    EscapeCharacter = ret
    'Log "|fffd||7c2||fffd|l|fffd|F" & ret
    'endOf PROC_NAME
End Function



'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||302||182||fffd||fffd||10c|v|fffd|Z|fffd||fffd||fffd||fffd|TEXT|fffd||590||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: 2019/5/1|fffd||20d|~|fffd||313||fffd||fffd|t|fffd||fffd||fffd|w|fffd||80b5||fffd||fffd||fffd||a347||fffd||241|A|fffd||fffd||fffd||fffd||fffd||182||742||202||fffd||fffd||112|l|fffd||fffd||502||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||20d|~|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||28f||fffd||fffd|TEXT|fffd||590||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: |fffd|l - TEXT|fffd||590||fffd||fffd||312|l|fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|\|fffd||fffd||fffd|`|fffd||fffd| - TEXT|fffd||590||fffd||fffd||315|\|fffd||fffd||fffd|`|fffd||fffd||fffd||193||fffd||fffd||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| - |fffd|w|fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||30f||a347||fffd||350|V|fffd||fffd||fffd||fffd||fffd||15f50||fffd||fffd||182||742||202||fffd|(|fffd||fffd||fffd||fffd||fffd|l2019|fffd|N5|fffd||fffd|1|fffd||fffd|)
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|O|fffd||30f||a347||fffd||241|A|fffd|V|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||255||fffd||fffd||fffd||fffd||582||742||202||fffd|TEXT|fffd||590||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd||241|ue|fffd|v|fffd||702||fffd||fffd||341|ug|fffd|v|fffd||fffd||fffd||702||702||202||fffd||fffd||a347||fffd||34e|g|fffd|p|fffd||38f||6ca|O|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||502||fffd|
' |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd||311||fffd||fffd||30f||a347||fffd||fffd|TEXT|fffd||590||fffd||fffd||30c||fffd||fffd||282||fffd||502||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Public Function TEXT|fffd||fffd||fffd||fffd|(ByVal |fffd|l As Variant _
                                , ByVal |fffd|\|fffd||fffd||fffd|`|fffd||fffd| As String _
                                , Optional ByVal |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| As Date = |fffd||fffd||fffd||282||313||fffd| _
                                ) As String
    Const PROC_NAME = "TEXT|fffd||fffd||fffd||fffd|"
    'startOf PROC_NAME
    'Log "|fffd||fffd||fffd||fffd||fffd|F" & |fffd|l & vbTab & |fffd|\|fffd||fffd||fffd|`|fffd||fffd| & vbTab & |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd|
    Dim ret As String
    Dim tmpDate As Date
    Dim tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| As String
    Dim |fffd||fffd||fffd||fffd||fffd||142||314|N As Long
    Static re As RegExp
    Dim matches As MatchCollection
    Dim m As Match
    Dim tmpStr As String

    '|fffd|a|fffd||fffd||315|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||8576||fffd||fffd||fffd||fffd||fffd||702||78f||a347|
    If InStr(|fffd|\|fffd||fffd||fffd|`|fffd||fffd|, "g") > 0 Or InStr(|fffd|\|fffd||fffd||fffd|`|fffd||fffd|, "e") > 0 Then
    
        '|fffd|V|fffd||fffd||fffd|A|fffd||fffd||fffd|l|fffd||30f||a347|
        If IsNumeric(|fffd|l) Then
            tmpDate = |fffd|l
            'Log "tmpDate(Numeric)|fffd|F" & tmpDate
        '|fffd||fffd||fffd||fffd||fffd||fffd||30f||a347|
        ElseIf IsDate(|fffd|l) Then
            tmpDate = CDate(|fffd|l)
            'Log "tmpDate(CDate)|fffd|F" & tmpDate
        End If
        If tmpDate > 0 Then
            If re Is Nothing Then
                Set re = New RegExp
                re.Pattern = "(""[^""]*""|""[^""]*|ggg|gg|g|ee|e|\\|.)"
                re.Global = True
                re.IgnoreCase = True
            End If
            Set matches = re.Execute(|fffd|\|fffd||fffd||fffd|`|fffd||fffd|)
                    
            '|fffd||fffd||fffd||fffd||fffd||20d|~|fffd||313||fffd||fffd|t|fffd||30f||a347|
            If tmpDate >= #5/1/2019# Then
                '|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||20d|~|fffd||30f||a347|TEXT|fffd||590||fffd||fffd||fffd||fffd||fffd||fffd||302||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
                If Date >= |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd| Then
                    For Each m In matches
                        Select Case LCase(m.Value)
                        Case "\"
                            tmpStr = PutCharInDoubleQuotes(m.Value)
                        Case Else
                            tmpStr = m.Value
                        End Select
                        tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| = tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| & tmpStr
                    Next m
                    'Log "tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd|F" & tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|
                    ret = Application.WorksheetFunction.text(tmpDate, tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|)
                Else
                    |fffd||fffd||fffd||fffd||fffd||142||314|N = DateDiff("yyyy", |fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd|, tmpDate) + CLng(Format(|fffd|V|fffd||fffd||fffd||fffd||fffd|Z|fffd|o|fffd||e3c0||fffd||fffd|, "e"))
                    'Log "|fffd||fffd||fffd||fffd||fffd||142||314|N|fffd|F" & |fffd||fffd||fffd||fffd||fffd||142||314|N
    
                    For Each m In matches
                        Select Case LCase(m.Value)
                        Case "ggg"
                            tmpStr = PutCharInDoubleQuotes("|fffd||fffd||fffd||fffd|")
                        Case "gg"
                            tmpStr = PutCharInDoubleQuotes("|fffd||fffd|")
                        Case "g"
                            tmpStr = PutCharInDoubleQuotes("H")
                        Case "ee"
                            tmpStr = PutCharInDoubleQuotes(Format(|fffd||fffd||fffd||fffd||fffd||142||314|N, "00"))
                        Case "e"
                            tmpStr = PutCharInDoubleQuotes(CStr(|fffd||fffd||fffd||fffd||fffd||142||314|N))
                        Case "\"
                            tmpStr = PutCharInDoubleQuotes(m.Value)
                        Case Else
                            tmpStr = m.Value
                        End Select
                        tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| = tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| & tmpStr
                    Next m
                    'Log "tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd|F" & tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|
                    ret = Application.WorksheetFunction.text(tmpDate, tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|)
                End If
            Else
                For Each m In matches
                    Select Case LCase(m.Value)
                    Case "\"
                        tmpStr = PutCharInDoubleQuotes(m.Value)
                    Case Else
                        tmpStr = m.Value
                    End Select
                    tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| = tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd| & tmpStr
                Next m
                'Log "tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd||fffd|F" & tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|
                ret = Application.WorksheetFunction.text(tmpDate, tmp|fffd|\|fffd||fffd||fffd|`|fffd||fffd|)
            End If
            Set matches = Nothing
            Set m = Nothing
        '|fffd||fffd||fffd|t|fffd||142||202||fffd||fffd||a347||fffd||fffd|TEXT|fffd||590||fffd||fffd||fffd||fffd||fffd||fffd||302||702||70e|g|fffd|p|fffd||fffd||fffd||fffd|
        Else
            ret = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a||590||fffd||fffd||30e|g|fffd|p|fffd||38f||6ca|O|fffd||142||fffd||fffd||fffd||fffd||fffd|"
        End If
    '|fffd||fffd|L|fffd||20a|O(|fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|O|fffd||141|A|fffd|N|fffd||fffd||fffd||598|A|fffd||fffd||fffd||702||702||202||fffd||fffd||a347|)|fffd||352||28f||fffd||fffd|TEXT|fffd||590||fffd|
    Else
        ret = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30a||590||fffd||fffd||30e|g|fffd|p|fffd||38f||6ca|O|fffd||142||fffd||fffd||fffd||fffd||fffd|"
    End If
    TEXT|fffd||fffd||fffd||fffd| = ret
    'Log "|fffd||7c2||fffd|l|fffd|F" & ret
    'endOf PROC_NAME
End Function

'
' |fffd|@|fffd|\|fffd|@|fffd|@|fffd|@: |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|u|fffd||fffd||fffd|R|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||14b||fffd||fffd||fffd|
'
' |fffd||502||fffd|l|fffd|@|fffd|@: |fffd||a576||fffd||fffd||fffd||fffd||fffd||83|_|fffd|u|fffd||fffd||fffd|R|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||14b||fffd||fffd||42f92|l|fffd||fffd||502||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|@: targetStr - |fffd|_|fffd|u|fffd||fffd||fffd|R|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||14b||fffd||fffd||791||38f||6c2||315||fffd||fffd||fffd||fffd||fffd|
'
' |fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd|@: |fffd||fffd||fffd||fffd||fffd||150||752||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a576||fffd||fffd||fffd||fffd||fffd||83|_|fffd|u|fffd||fffd||fffd|R|fffd|[|fffd|e|fffd|[|fffd|V|fffd||fffd||fffd||fffd||fffd||14b||fffd||fffd||fffd|
'
' |fffd||fffd||fffd|l|fffd|@|fffd|@|fffd|@:
'
Private Function PutCharInDoubleQuotes(ByVal targetStr As String) As String
    Const PROC_NAME = "PutCharInDoubleQuotes"
    'startOf PROC_NAME
    'Log "|fffd||fffd||fffd||fffd||fffd|F" & targetStr
    Dim ret As String
    Dim i As Long
    For i = 1 To Len(targetStr)
        ret = ret & """" & Mid(targetStr, i, 1) & """"
    Next
    PutCharInDoubleQuotes = ret
    'Log "|fffd||7c2||fffd|l|fffd|F" & ret
    'endOf PROC_NAME
End Function



Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy"
Option Explicit
Option Private Module
'/****************************************************************************
' * |fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy 2019/04/01 v0.60
' *
' * |fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
' *
' * |fffd||fffd||fffd|j|fffd|e|fffd|B|fffd||389||fffd||fffd||152||1c9||fffd|
' *
' ****************************************************************************/
' 2013/12/20 |fffd||413||fffd||fffd||fffd||fffd|A|fffd|u|fffd||35dd||fffd|X|fffd||fffd||fffd||341|v|fffd||fffd||282||155||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||401|i|fffd|T|fffd||fffd||fffd||213||fffd||fffd||313||fffd||fffd||342||154||fffd||fffd|f|fffd|j
'            |fffd||30f||a347||fffd||241|A|fffd|u|fffd|I|fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||389||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd|
' 2013/12/20 CSV|fffd|o|fffd||342||fffd||fffd||142||fffd||fffd||fffd||60a4||fffd||251||389||fffd|
' 2014/01/07 |fffd||413||fffd||fffd|\|fffd||fffd||fffd||50d||fffd||fffd|G|fffd||fffd||fffd|[|fffd||341|A|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||82||fffd||fffd||fffd||60a4||fffd||251||389||fffd| & |fffd||fffd||fffd|O|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||3cd|X
'             |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|ProxySub|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd|MS1KokyakuFactory|fffd||24f|W|fffd||fffd|
' 2014/01/14 |fffd||64ea||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||311||482||fffd|ms|fffd|ishell|fffd||fffd||fffd|[|fffd|v|fffd|j|fffd||fffd||752||fffd||142||fffd||fffd||fffd||60a4||fffd||251||389||fffd|
' 2014/02/12 |fffd||35dd||fffd|X|fffd||fffd||fffd||482||311||5576||fffd||fffd||fffd||3ca||fffd||fffd||fffd||1c9||fffd|
' 2014/04/17 |fffd||35dd||fffd|X|fffd||fffd||fffd||483|R|fffd|[|fffd|h|fffd||311||38f||6ca|O|fffd|`|fffd|F|fffd|b|fffd|N|fffd||18e||fffd||fffd|s|fffd||fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||483|R|fffd|[|fffd|h|fffd||196||fffd||fffd||302||303||fffd||fffd|O|fffd|o|fffd||342||302||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|E|fffd||35dd||fffd|X|fffd||fffd||fffd||483|R|fffd|[|fffd|h|fffd||752||80aa||fffd||fffd||fffd||fffd||fffd||182||202||fffd|ionbur|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|j|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||d0b9||fffd||fffd|
'|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||60a4||fffd||182||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c2||fffd||7c1|i|fffd||fffd||fffd||fffd||316||fffd||fffd||fffd||fffd||1d7||fffd||fffd||356||fffd||fffd||202||fffd||fffd|j
' 2016/01/22 |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||389||fffd|
' 2017/11/28 egg|fffd||3cd|X|fffd||389||fffd||fffd|i|fffd||c2||fffd|egg|fffd||142||34e|g|fffd||fffd||fffd||202||fffd||fffd|j|fffd|AgetTDValue|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||202||fffd|
' 2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd||fffd|i|fffd||fffd||282||310||611||593||fffd||fffd||702||142||355||fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd|j
             
'|fffd|y|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|g|fffd|p|fffd||317|L|fffd||fffd||fffd|z
'|fffd|@True:|fffd|g|fffd|p|fffd||fffd||fffd||fffd|BFileDaialogFactory|fffd||fffd||fffd|K|fffd|v
'|fffd|@False:|fffd|g|fffd|p|fffd||fffd||fffd||202||fffd||fffd|BFileDaialogFactory|fffd||355|s|fffd|v
#Const DWONLOAD_USE = True

'|fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|g|fffd|p--------------------------------------------------------------------------
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||301||fffd|
'  |fffd||693||fffd||fffd||fffd||fffd||fffd||fffd||189||fffd||282||182||311||389||fffd|
'   t:text          |fffd||fffd| |fffd||752||fffd|l|fffd||fffd||fffd|w|fffd||fffd|
'   p:pulldown      |fffd||fffd| |fffd||752||fffd|Value|fffd|i|fffd|R|fffd|[|fffd|h|fffd|l|fffd|j|fffd||fffd||fffd|w|fffd||fffd|
'   c:checkbox|fffd|@|fffd|@|fffd|@|fffd||fffd| check on|fffd||30f||a347||fffd|ATrue|fffd||fffd||fffd|w|fffd||fffd|
'|fffd||fffd||fffd||311||fffd||fffd|i|fffd||fffd||fffd||755||fffd|
Private Type mnk|fffd||fffd||fffd||311||fffd|
    p|fffd||6cc||fffd||fffd||fffd||fffd|           As String                   ' 04|fffd|F|fffd|O|fffd||fffd|Z|fffd|F|fffd|C|fffd||fffd||38d||415||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||401|A|fffd|E|fffd|E|fffd|E
    t|fffd|O|fffd|_|fffd||fffd||60c||fffd||fffd||50d||fffd|     As String
    t|fffd|o|fffd|^|fffd||50d||fffd||fffd||fffd|4|fffd||fffd|      As String
    c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||3cd|X            As Boolean
    c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|            As Boolean
    c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O        As Boolean
    c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|        As Boolean
    p|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|   As String           ' 1|fffd|F|fffd|O|fffd||fffd||fffd||fffd|v|fffd|@2|fffd|F|fffd||fffd||fffd||fffd||fffd|v|fffd|@3|fffd|F|fffd||fffd||fffd||508||fffd|v|fffd|@|fffd||fffd||fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd|w|fffd||839e||fffd|L|fffd||fffd|
    t|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i               As String
    t|fffd|d|fffd|b|fffd||50d||fffd|           As String
    t|fffd|O|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd|   As String
    t|fffd|V|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd|   As String
    c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|                    As Boolean
    c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||28f||d59e||fffd||fffd||fffd||fffd||fffd||fffd|              As Boolean
    c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||411||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd|   As Boolean
    c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||4ce|v|fffd|m|fffd|F|fffd||142||fffd||fffd||202||fffd|          As Boolean
    p|fffd||fffd||fffd|v|fffd||fffd|~               As String               ' 0|fffd|FOFF|fffd||302||741|@1|fffd|FON|fffd||302||fffd|
    p|fffd||fffd||fffd||fffd||fffd||113||fffd|               As String               ' 1|fffd|F|fffd||fffd||fffd|q|fffd|@2|fffd|F|fffd|P|fffd|[|fffd|@3|fffd|F|fffd|s|fffd||fffd||fffd|@4|fffd|F|fffd||fffd|~|fffd|@5|fffd|F|fffd||202||fffd||fffd|@6|fffd|F|fffd||52f01|@7|fffd|F|2b6||7b7||fffd|@8|fffd|F|fffd||113||fffd||fffd|@A|fffd|F|fffd|s|fffd|\
    p|fffd|p|fffd||fffd||fffd||fffd||308||4ce|v|fffd|m|fffd|F       As String               ' 0|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@1|fffd|F|fffd||fffd||fffd||fffd|
    t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM      As String               ' |fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|Fyyyy/[m]m or |fffd|a|fffd||fffd|Fgee/[m]m|fffd|j|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||150||752||fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|{|fffd|a|fffd||fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||34e||fffd||fffd||356||fffd||fffd||fffd||fffd||fffd||fffd||341|u|fffd||fffd||fffd||311||fffd||fffd|v|fffd||255||3cd|X|fffd||fffd||fffd||fffd||fffd|
    t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO        As String               ' |fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|Fyyyy/[m]m or |fffd|a|fffd||fffd|Fgee/[m]m|fffd|j|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||150||752||fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|{|fffd|a|fffd||fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|@|fffd||fffd||fffd||fffd||fffd||34e||fffd||fffd||356||fffd||fffd||fffd||fffd||fffd||fffd||341|u|fffd||fffd||fffd||311||fffd||fffd|v|fffd||255||3cd|X|fffd||fffd||fffd||fffd||fffd|
    t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM        As String               ' |fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|Fyyyy/[m]m/[d]d or |fffd|a|fffd||fffd|Fgee/[m]m/[d]d|fffd|j|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||150||752||fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|{|fffd|a|fffd||fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|
    t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO          As String               ' |fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|Fyyyy/[m]m/[d]d or |fffd|a|fffd||fffd|Fgee/[m]m/[d]d|fffd|j|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||150||752||fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|{|fffd|a|fffd||fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|
End Type
'|fffd|\|fffd|[|fffd|g|fffd||fffd|
Private Type mnk|fffd|\|fffd|[|fffd|g
    p|fffd|\|fffd|[|fffd|g|fffd||fffd|1   As String                          ' |fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||1|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@2|fffd|F|fffd||6cc||fffd||fffd||fffd||401|@3|fffd|F|fffd||6cc||fffd||fffd||fffd||681|@4|fffd|F|fffd|_|fffd||fffd||496||fffd||fffd|@5|fffd|F|fffd||8471||fffd||fffd||fffd||fffd||fffd|@
    p|fffd|\|fffd|[|fffd|g|fffd||fffd|2   As String                          ' 1|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||2|fffd|F|fffd||6cc||fffd||fffd||fffd||401|@3|fffd|F|fffd||6cc||fffd||fffd||fffd||681|@4|fffd|F|fffd|_|fffd||fffd||496||fffd||fffd|@5|fffd|F|fffd||8471||fffd||fffd||fffd||fffd||fffd|@
End Type
'|fffd|S|fffd||fffd|
Public Type mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '|fffd||fffd|{|fffd|w|fffd||fffd|
    t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|                     As String
    c|fffd||fffd||fffd||5c2||102||311||35dd||fffd|X                 As Boolean
    p|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|   As String       ' 0|fffd|F|fffd||fffd||fffd|S|fffd||fffd|v|fffd|@1|fffd|F|fffd|O|fffd||fffd||fffd||fffd|v|fffd|@2|fffd|F|fffd||fffd||fffd||fffd||fffd|v|fffd|@3|fffd|F|fffd||fffd||fffd||508||fffd|v|fffd|@|fffd||fffd||fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h|fffd|w|fffd||839e||fffd|L|fffd||fffd|
    t|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h               As String
    p|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd| As String       ' 0|fffd|F|fffd||fffd||fffd|S|fffd||fffd|v|fffd|@1|fffd|F|fffd|O|fffd||fffd||fffd||fffd|v|fffd|@2|fffd|F|fffd||fffd||fffd||fffd||fffd|v|fffd|@3|fffd|F|fffd||fffd||fffd||508||fffd|v|fffd|@|fffd||fffd||fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd|w|fffd||839e||fffd|L|fffd||fffd|
    t|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h             As String
    t|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h     As String                       ' |fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||18e|x|fffd|X|fffd||fffd||fffd||358|A|fffd||fffd|
    p|fffd|x|fffd|X|fffd||fffd|         As String                       ' |fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||18e|x|fffd|X|fffd||fffd||fffd||358|A|fffd||fffd|
    t|fffd|c|fffd||fffd|           As String
    p|fffd||356a|           As String                       ' 1|fffd|F|fffd||fffd||fffd||fffd||fffd|@2|fffd|F|fffd||4ac8e||fffd|
    p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|       As String                       ' |fffd||fffd||fffd||fffd||fffd|O|fffd||fffd|U|fffd|J|fffd||fffd||fffd||314|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"other"|fffd|F|fffd||fffd||fffd||311||fffd|
                                                    ' |fffd||fffd||fffd|t|fffd|`|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd|Fyyyy/[m]m or |fffd|a|fffd||fffd|Fgee/[m]m|fffd|j|fffd|@|fffd||fffd||fffd||fffd||fffd|t|fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||150||752||fffd|`|fffd||fffd||fffd|iyyyymm|fffd|j|fffd||255||3ca||fffd||fffd||fffd||fffd||752||80b7||fffd||fffd|
    t|fffd||fffd||fffd||fffd||fffd||fffd|FROM     As String
    t|fffd||fffd||fffd||fffd||fffd||fffd|TO       As String
    p|fffd||8471||fffd||fffd||fffd||fffd|     As String                       ' 01|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|@02|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||8471||fffd|@03|fffd|F|fffd||fffd||fffd||fffd||fffd||113||fffd|MSG|fffd|o|fffd|^|fffd|@04|fffd|F|fffd|v|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|O
                                                    ' 05|fffd|F|fffd||fffd||fffd||fffd||fffd||113||fffd||fffd|t|fffd|H|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd||fffd||fffd|@06|fffd|F|fffd||fffd||fffd||fffd|4|fffd|T|fffd||511|O|fffd||fffd||fffd||8471||fffd|@07|fffd|F|fffd||fffd||fffd||fffd|2|fffd|T|fffd||511|O|fffd||fffd||fffd||8471|
                                                    ' 08|fffd|F|fffd||fffd||fffd||fffd||fffd||113||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|@09|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c1|@10|fffd|F|fffd|Z|fffd|[|fffd|t|fffd|e|fffd|B|fffd|l|fffd|b|fffd|g|fffd||38f||fffd|
                                                    ' 11|fffd|F|fffd|Z|fffd|[|fffd|t|fffd|e|fffd|B|fffd|l|fffd|b|fffd|g|fffd|K|fffd|p|fffd|E|fffd||fffd|~|fffd|@12|fffd|F|fffd|v|fffd||fffd|v|fffd||6ca|m|fffd|F|fffd|@13|fffd|F|fffd||fffd||fffd|p|fffd||20a|O
                                                    ' 14|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|@15|fffd|F|fffd|p|fffd||fffd||fffd||fffd|
    c|fffd||fffd||fffd|ALL        As Boolean                      ' True|fffd|F|fffd||209||fffd||fffd||302||fffd||fffd||5c2||102||30e||fffd||682||fffd||fffd||38f||fffd|
    c|fffd||fffd||fffd|(10)       As Boolean                      ' |fffd|z|fffd||fffd|0|fffd|`|fffd||251||389||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||501|A|fffd||fffd||fffd||fffd||fffd|A|fffd||38d||401|A|fffd||fffd||fffd|Q|fffd|A|fffd|V|fffd||fffd|A|fffd||3c9||381|A|fffd||3cf||fffd||fffd|A|fffd||3d0|V|fffd|A|fffd||fffd||fffd|`|fffd|A|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||755||fffd|
    '|fffd|i|fffd||fffd||fffd||742||fffd||fffd||311||fffd||fffd|w|fffd||fffd|
    other   As mnk|fffd||fffd||fffd||311||fffd|
    '|fffd|\|fffd|[|fffd|g|fffd|w|fffd||fffd|
    srt     As mnk|fffd|\|fffd|[|fffd|g
End Type

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|\|fffd||fffd||fffd||301||fffd|
Public Type mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    |fffd||fffd||fffd||fffd||fffd||fffd|                  As String
    |fffd||14f|I|fffd||653||fffd||fffd||fffd|              As String
    SN_|fffd||fffd||fffd|p                 As String
    |fffd||fffd||fffd||fffd|                    As String
    |fffd||fffd||fffd|                    As String
    |fffd||35dd||fffd|X                  As String
    |fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h        As String
    |fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h      As String
    |fffd|x|fffd|X                    As String
    |fffd|c|fffd||fffd|                    As String
    |fffd|_|fffd||fffd||496||fffd|                As String
    |fffd|d|fffd|b|fffd||50d||fffd|1               As String
    |fffd|d|fffd|b|fffd||50d||fffd|2               As String
    |fffd||356a|                    As String
    |fffd||8471||fffd||fffd||fffd|@                As String
    |fffd|O|fffd||60c||fffd||fffd||50d||fffd|              As String
    |fffd|O|fffd||6cc||fffd||fffd||fffd|                As String
    |fffd|V|fffd||60c||fffd||fffd||50d||fffd|              As String
    |fffd|V|fffd||6cc||fffd||fffd||fffd|                As String
    |fffd||fffd||fffd|                    As String
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@                As String
    |fffd||6cc||fffd||fffd||311||38f||6d3||fffd|            As String
    |fffd|v|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|O            As String
    |fffd||fffd||fffd||fffd||fffd||113||fffd|                As String
    |fffd||fffd||fffd||fffd||fffd||fffd|                As String
    |fffd|_|fffd||fffd|v|fffd||fffd|                As String
    |fffd||fffd||fffd|v|fffd||fffd|~                As String
End Type

'|fffd||fffd||fffd||fffd|API|fffd||fffd|`|fffd|i|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||297|p|fffd|j-------------------------------------------------------
'->2014/01/07 MS1KokyakuFactory|fffd||243|\|fffd|[|fffd|X|fffd|W|fffd||fffd||302||fffd||fffd||7d5|s|fffd|v
'#If Win64 Then
''|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
'Private Declare PtrSafe Function EnumWindows Lib "user32" (ByVal lpEnumFunc As LongPtr, ByVal lparam As LongPtr) As Long
''|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|g|fffd|b|fffd|v|fffd||fffd||fffd|x|fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'Public Declare PtrSafe Function FindWindow Lib "user32.dll" Alias "FindWindowA" _
'        (ByVal lpClassName As String, ByVal lpWindowName As String) As LongPtr
''|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd|q|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
'Public Declare PtrSafe Function FindWindowEx Lib "user32.dll" Alias "FindWindowExA" _
'        (ByVal hwndParent As LongPtr, ByVal hwndChildAfter As LongPtr, ByVal lpszClass As String, ByVal lpszWindow As String) As LongPtr
'#Else
''|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||fffd||4b4c2||fffd||fffd||fffd|
'Private Declare Function EnumWindows Lib "user32" (ByVal lpEnumFunc As Long, lPalam As Long) As Long
''|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|g|fffd|b|fffd|v|fffd||fffd||fffd|x|fffd||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|i |fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd|j|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B
'Public Declare Function FindWindow Lib "user32.dll" Alias "FindWindowA" _
'        (ByVal lpClassName As String, ByVal lpWindowName As String) As Long
''|fffd|w|fffd||80b3||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd|v|fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|X|fffd||fffd||fffd||183|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||83|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||303|n|fffd||fffd||fffd|h|fffd||fffd||fffd||fffd||502||fffd||fffd||702||fffd||fffd|B|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd|q|fffd|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B
'Public Declare Function FindWindowEx Lib "user32.dll" Alias "FindWindowExA" _
'        (ByVal hWndParent As Long, ByVal hwndChildAfter As Long, ByVal lpszClass As String, ByVal lpszWindow As String) As Long
'#End If
Private Const WM_CLOSE As Long = &H10
'<-2014/01/07 MS1KokyakuFactory|fffd||243|\|fffd|[|fffd|X|fffd|W|fffd||fffd||302||fffd||fffd||7d5|s|fffd|v

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p--------------------------------------------------------------------------
'|fffd||fffd||fffd|v|fffd||fffd||fffd|C|fffd|x|fffd|[|fffd|g|fffd||3d0||fffd||fffd|i|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd|j
'|fffd||fffd||fffd||fffd||fffd|i|fffd|P|fffd|`|fffd|j
Private mdlTotalCount        As Long
'|fffd||fffd||fffd||743|y|fffd|[|fffd|W|fffd|i|fffd|P|fffd|`|fffd|j
Private mdlNowPage      As Long
'|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|i|fffd|P|fffd|`|fffd|j
Private mdlTotalPage    As Long
'|fffd|v|fffd||fffd|Count|fffd|i|fffd|P|fffd|`|fffd|j
Private mdlReqCount     As Long
'|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|
Private mdlErrDescription   As String
'|fffd||fffd||fffd||fffd|IE
Private mdlMnkIE        As InternetExplorer

'|fffd||fffd||fffd|v|fffd||fffd||fffd|C|fffd|x|fffd|[|fffd|g|fffd||3d0||fffd||fffd|iAPI|fffd|j
'|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||297|p|fffd|iEnumWindows|fffd|j
Private mdlFindClassFull    As String             '|fffd||fffd||fffd|S|fffd||fffd|v
Private mdlFindTitlePart    As String             '|fffd||fffd||fffd||fffd||fffd||fffd|v
#If Win64 Then
Private mdlTargethWnd       As LongPtr            '|fffd||64fe||fffd|n|fffd||fffd||fffd|h|fffd||fffd|
#Else
Private mdlTargethWnd       As Long               '|fffd||64fe||fffd|n|fffd||fffd||fffd|h|fffd||fffd|
#End If
Private mdlWebDialogTitle   As String             '|fffd||64fe||fffd|^|fffd|C|fffd|g|fffd||fffd|

'|fffd||fffd||fffd|v|fffd||fffd||fffd|C|fffd|x|fffd|[|fffd|g|fffd||3d0||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd|j
'|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||30c||fffd||fffd||fffd|
Private mdlCntInPage    As Long
'|fffd|P|fffd|y|fffd|[|fffd|W|fffd||682||303|y|fffd|[|fffd|W|fffd||fffd||fffd||30c||fffd||fffd||fffd|
Private mdlCntInFirstPage   As Long
'|fffd|P|fffd|y|fffd|[|fffd|W|fffd||30c||fffd||fffd||283|e|fffd|[|fffd|u|fffd||fffd|
Private mdlDetail()     As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd|iCSV|fffd|o|fffd||357|p|fffd||1c9||fffd||fffd|j2013/12/20|fffd||1c9||fffd|-------------------------------------------------
'Shell Shell|fffd||151||fffd||482||fffd|
Private mdlShell|fffd||151||fffd||482||fffd|ms   As Long
'2014/01/14 Shell |fffd||64ea||fffd||151||fffd||482||fffd|
Private mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms   As Long
'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd|ms
Private mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms   As Long
'|fffd||6d1||fffd||fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||482||fffd|ms
Private mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms     As Long
'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h 2013/08/13|fffd||1c9||fffd|
Private mdl|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h       As String
'|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|i|fffd||413||fffd||fffd|j 2013/08/13|fffd||1c9||fffd|
Private mdl|fffd|\|fffd||fffd||fffd||50d||fffd|   As String
'|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
Private mdl|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|   As String
'zip|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h 2013/09/20
Private mdlZip|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h    As String
'CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
Private mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|    As String

'|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g
Private Const DEF_Shell|fffd||151||fffd||482||fffd|ms  As Long = 20000
Private Const DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms  As Long = 1000
Private Const DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms  As Long = 1000

'|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B--------------------------------------------------------------------------
'--Getter|fffd|iOUT |fffd||fffd||fffd||fffd||fffd||fffd||fffd|j
Public Property Get resTotalCount() As Long
    resTotalCount = mdlTotalCount
End Property
'--Getter|fffd|iOUT |fffd||fffd||fffd||742||303|y|fffd|[|fffd|W|fffd|j
Public Property Get resNowPage() As Long
    resNowPage = mdlNowPage
End Property
'--Getter|fffd|iOUT |fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|j
Public Property Get resTotalPage() As Long
    resTotalPage = mdlTotalPage
End Property
'--Getter|fffd|iOUT |fffd|v|fffd||fffd||fffd||50d||fffd||fffd|j
Public Property Get resReqCount() As Long
    resReqCount = mdlReqCount
End Property
'--Getter|fffd|iOUT |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|e|fffd|j
Public Property Get resErrDescription() As String
    resErrDescription = mdlErrDescription
End Property
'--Getter|fffd|iOUT |fffd||fffd||fffd||fffd||fffd||1d7||fffd|IE|fffd|j
Public Property Get reskokyakuIE() As InternetExplorer
    Set reskokyakuIE = mdlMnkIE
End Property

'|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd|iCSV|fffd|o|fffd||357|p|fffd||1c9||fffd||fffd|j2013/12/20|fffd||1c9||fffd|-------------------------------------------------------
'-- (Setter Shell|fffd||151||fffd||482||fffd|ms)
Public Property Let setShell|fffd||151||fffd||482||fffd|ms(ByVal Shell|fffd||151||fffd||482||fffd|ms As Long)
    mdlShell|fffd||151||fffd||482||fffd|ms = Shell|fffd||151||fffd||482||fffd|ms
End Property
'-- (Setter Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms)Download 2014/01/14
Public Property Let setShell|fffd||64ea||fffd||151||fffd||482||fffd|ms(ByVal Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms As Long)
    mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = Shell|fffd||64ea||fffd||151||fffd||482||fffd|ms
End Property
'-- (Setter |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms)
Public Property Let set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms(ByVal |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms As Long)
    mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
End Property
'-- (Setter |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms)
Public Property Let set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms(ByVal |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms As Long)
    mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms
End Property
'-- (Setter |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|)2016/01/22|fffd||1c9||fffd|
Public Property Let set|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|(ByVal |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| As String)
    mdl|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
End Property
'-- (Setter |fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h)2013/08/13|fffd||1c9||fffd|
Public Property Let set|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h(ByVal |fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h As String)
    mdl|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h = |fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
End Property
'-- (Setter |fffd|\|fffd||fffd||fffd||50d||fffd|)2013/08/13|fffd||1c9||fffd|
Public Property Let set|fffd|\|fffd||fffd||fffd||50d||fffd|(ByVal |fffd|\|fffd||fffd||fffd||50d||fffd| As String)
    mdl|fffd|\|fffd||fffd||fffd||50d||fffd| = |fffd|\|fffd||fffd||fffd||50d||fffd|
End Property

'--Getter|fffd|iOUT CSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|j
Public Property Get resCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|() As String
    resCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
End Property

'|fffd||fffd||fffd||fffd|-|fffd|yPublic|fffd|z|fffd||fffd||fffd||fffd||fffd||1d7||fffd|
'|fffd||fffd|--|fffd|O|fffd||fffd||fffd|Q|fffd||195||fffd|start--
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'|fffd|@|fffd|@fi|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|Achk|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|Exists|fffd|F|fffd|w|fffd||fffd||316||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd|i|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd|j|fffd||251||fffd||fffd||742||fffd||fffd||90a9||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd|v|fffd||6c1|i|fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||242||202||fffd|j
'|fffd|@|fffd|B|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms|fffd|F|fffd|w|fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||315|\|fffd||fffd||fffd||482||fffd||fffd||fffd||fffd||fffd|
Public Function findExecute(fi As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, Optional ByVal chk|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|Exists As Boolean = True, Optional ByVal |fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms As Long = 2000) As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.findExecute"
    findExecute = False

    '|fffd||fffd|private|fffd||fffd||fffd||fffd||fffd||752||fffd|i|fffd|v|fffd||fffd||fffd|p|fffd|e|fffd|B|fffd|j
    mdlTotalCount = 0
    mdlNowPage = 0
    mdlTotalPage = 0
    mdlReqCount = 0
    mdlErrDescription = ""
    Set mdlMnkIE = Nothing
    
    '|fffd||fffd|private|fffd||fffd||fffd||fffd||fffd||752||fffd|i|fffd||fffd||fffd||fffd||fffd|j
    mdlCntInPage = 0
    mdlCntInFirstPage = 0
    Erase mdlDetail
    
    '->2014/02/12 |fffd||fffd||fffd|O|fffd||251||5576||fffd||fffd||fffd||3ca||fffd|
    fi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd| = UCase(fi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|)
    '<-2014/02/12 |fffd||fffd||fffd|O|fffd||251||5576||fffd||fffd||fffd||3ca||fffd|
    
    '|fffd||fffd||fffd|T|fffd|u|fffd||fffd||fffd|s
    If findExecuteSub(fi, chk|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|Exists, |fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms) = False Then
        Exit Function
    End If
    
    findExecute = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.findExecute"
End Function

'|fffd||fffd||fffd||282|P|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'|fffd|@|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'|fffd|@|fffd|@resOne|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|\|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|A|fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||482||fffd|ms|fffd|F|fffd|P|fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||482||fffd||fffd||fffd||fffd||fffd|
Public Function getDataOne(resOne As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, Optional ByVal |fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||482||fffd|ms As Long = 10) As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.getDataOne"
    Dim msg As String
    getDataOne = False

    DoEvents
    Sleep |fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||482||fffd|ms
    
    '|fffd||38f||6cc||fffd||fffd||fffd||fffd|m|fffd|F
    If mdlTotalCount > 0 Then
        '|fffd||fffd||fffd|T|fffd|u|fffd||fffd||fffd|s
        If getDataOneSub(resOne) = False Then
            Exit Function
        End If
    Else
        msg = "|fffd||38f||6c2||342|O|fffd||fffd||fffd||142||fffd|"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
        
    getDataOne = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.getDataOne"
End Function

'2013/12/20 CSV|fffd|o|fffd||351||fffd||fffd||fffd|
#If DWONLOAD_USE = True Then
'|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd||fffd||fffd|C|fffd||fffd|
Public Function outCsvFile(mnkIE As InternetExplorer) As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.outCsvFile"
    Dim zipPass As String
    Dim blnRtn  As Boolean
    
    outCsvFile = False

    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If mdlShell|fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||151||fffd||482||fffd|
    End If
    '->2014/01/14
    If mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = 0 Then
        mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = DEF_Shell|fffd||151||fffd||482||fffd|ms                                '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|gShell|fffd||64ea||fffd||151||fffd||482||fffd|
    End If
    '<-2014/01/14
    If mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = 0 Then
        mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms          '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
    End If
    If mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = 0 Then
        mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = DEF_|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms              '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|
    End If
    mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = ""
    mdlErrDescription = ""
    '|fffd|w|fffd||fffd||fffd|IE|fffd||1678a||fffd||fffd||1d7||fffd||fffd||182||fffd||fffd||108||fffd||fffd|p|fffd||fffd|
    Set mdlMnkIE = mnkIE
        
    '2013/08/13 |fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|w|fffd||fffd||94|\|fffd||24f|C|fffd||fffd|
    If mdl|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h = "" Then
        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|ipass+|fffd||fffd||fffd||fffd||fffd|t|fffd|j
        zipPass = "pass" & Format(Now, "yyyymmdd")
    Else
        zipPass = mdl|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    End If
    mdlZip|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h = zipPass                                      '2013/09/20
   
    '|fffd||fffd|CSV|fffd|o|fffd||349||fffd||fffd||fffd||fffd|`|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||702||fffd|
    If outCsvFileSub = False Then
        Log "CSV|fffd|o|fffd||342||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"                       '2014/01/07 |fffd||fffd||fffd|O|fffd||fffd||fffd|e|fffd||3cd|X
        Exit Function
    End If
    
    '|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|`|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||64fe||fffd||fffd|
    FileDaialogFactory.setShell|fffd||151||fffd||482||fffd|ms = mdlShell|fffd||151||fffd||482||fffd|ms
    FileDaialogFactory.setShell|fffd||64ea||fffd||151||fffd||482||fffd|ms = mdlShell|fffd||64ea||fffd||151||fffd||482||fffd|ms      '2014/01/14
    FileDaialogFactory.set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms = mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|\|fffd||fffd||fffd||482||fffd|ms
    FileDaialogFactory.set|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms = mdl|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||6d1||fffd||fffd|\|fffd||fffd||fffd||482||fffd|ms
    If FileDaialogFactory.daialogDownloadExecute(mdlMnkIE, "ZIP", zipPass) = False Then
        '2013/09/20 |fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||281|i|fffd||fffd|Web|fffd|y|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|j|fffd|F|fffd||fffd||fffd||283|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||155|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
        Log "|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||282||fffd||82||fffd||fffd||702||fffd||fffd|B"
        Call downloadWebDailog("|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h", "|fffd|I|fffd||fffd|", mdlShell|fffd||151||fffd||482||fffd|ms)
        
        mdlErrDescription = FileDaialogFactory.resErrDescription
        Exit Function
    End If
    '|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe||fffd|F|fffd||64ea||fffd|P|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd|
    mdlCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = Split(FileDaialogFactory.resCSV|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|, FileDaialogFactory.resFileSepStr)(0)
    
    '|fffd||fffd||fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||281|i|fffd||fffd|Web|fffd|y|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|j|fffd|F|fffd||fffd||fffd||283|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||155|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
    Log "|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||282||fffd||82||fffd||fffd||702||fffd||fffd|B"
    If downloadWebDailog("|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h", "|fffd|I|fffd||fffd|", mdlShell|fffd||151||fffd||482||fffd|ms) = False Then
        Exit Function
    End If
    '|fffd||fffd|L|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||142||fffd||a347||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7c2||30f||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||497c9||fffd||fffd|v|fffd|j
    Dim i   As Long
    For i = 1 To 10
        DoEvents
        Sleep 100
        Call clickIEAlert("OK", "|fffd||693||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?")
    Next
    
    outCsvFile = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.outCsvFile"
End Function
#End If
'|fffd||fffd|--|fffd|O|fffd||fffd||fffd|Q|fffd||195||fffd|end--

'########################################################
'# |fffd||fffd||fffd||fffd||fffd||fffd||fffd|ssub start
'########################################################
Private Function findExecuteSub(fi As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, Optional ByVal chk|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|Exists As Boolean = True, Optional ByVal |fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms As Long = 2000) As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.findExecuteSub"
    Dim kokyakuMs1  As New MS1Kokyaku
    Dim mnkDoc      As HTMLDocument '|fffd||fffd||fffd||fffd||fffd||a5d7||fffd|p
    Dim setName     As String
    Dim setType     As String
    Dim setValue    As String
    Dim strTemp     As String
    
    Dim gen     As String
    Dim eemmdd  As String
    
    Dim msg     As String
    Dim blnRtn  As Boolean
    
    findExecuteSub = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||282||fffd||fffd||64fe||fffd||fffd||fffd||fffd|i|fffd||35dd||fffd|X|fffd||fffd||fffd||482||34e||413||fffd||fffd||14e|g|fffd|p|fffd|j
    Set kokyakuMs1 = getMS1Kokyaku(open|fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||1d7||fffd|, fi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|)
    Set mdlMnkIE = kokyakuMs1.getKokyakuIE
    If mdlMnkIE Is Nothing Then
        msg = kokyakuMs1.getDescription
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    Log "|fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||28e||64fe||fffd||48b|@|fffd|J|fffd|n"
    waitForBrowse mdlMnkIE
    
    '|fffd||151|O|fffd||295|\|fffd||fffd|
    SetForegroundWindow mdlMnkIE.hWnd
    
    '|fffd||fffd||fffd||fffd|{|fffd||fffd||fffd|
    Set mnkDoc = mdlMnkIE.document
    Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|{|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
    '|fffd||fffd|'|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||fffd|
    If fi.c|fffd||fffd||fffd||5c2||102||311||35dd||fffd|X = True Then
        '|fffd||fffd||fffd||5c2||102||311||35dd||fffd|X|fffd||30f||a347||fffd|A|fffd|u|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||752||80b7||fffd||fffd|
        'TXT_ONBLUR|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||188||fffd|A|fffd||311||35dd||fffd|X|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||202||fffd||fffd|B
        Log "|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||482||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.agencyAtsukaishaCd"
        setType = TXT_ONBLUR
        setValue = ""
        Call setData(mnkDoc, setName, setType, setValue)
        'ONBLUR|fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60a4|
        waitForBrowse mdlMnkIE, , , , True
    Else
        'TXT_ONBLUR|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||188||fffd|A|fffd||311||35dd||fffd|X|fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||202||fffd||fffd|B
        Log "|fffd||35dd||fffd|X|fffd|E|fffd||fffd||fffd||482||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.agencyAtsukaishaCd"
        setType = TXT_ONBLUR
        setValue = fi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
        
        '|fffd||fffd||fffd||fffd||fffd||fffd|waitForBrowse|fffd||355|s|fffd||81|F|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||309||94|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        'waitForBrowse mdlMnkIE, , , , True
        '2013/05/29 |fffd|t|fffd|H|fffd|[|fffd|J|fffd|X|fffd||fffd||fffd||fffd||fffd||303|{|fffd|^|fffd||fffd||fffd||248||693||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|B|fffd|i|fffd||fffd||fffd||302||702||702||fffd||fffd||183|G|fffd||fffd||fffd|[|fffd||fffd||fffd||30f||a347||fffd|A|fffd||202||242||fffd||fffd||fffd||fffd||fffd||fffd||189||fffd||fffd|x|fffd||fffd||fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd|j
        '2013/12/20 |fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|i|fffd||413||fffd||fffd|F|fffd||fffd||fffd|X|fffd|E|fffd||6ce|x|fffd||401|j
        On Error Resume Next
        mnkDoc.getElementsByName("dairitenSelect")(0).Focus
        If Err.Number = 0 Then
            '|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||355||82||fffd||fffd||fffd|B|fffd|Y|fffd||fffd||fffd||35dd||fffd|X|fffd||202||fffd||fffd|G|fffd||fffd||fffd|[
            DoEvents
            '2013/12/20CSV|fffd|o|fffd||34e||635e||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||255||3cd|X
            'blnRtn = existsDairitenDailog("|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|", "|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|", |fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms)
            blnRtn = existsDairitenWebDailog("|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|", "|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|", |fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|ms)
            If blnRtn = True Then
                msg = "|fffd|w|fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B|fffd||35dd||fffd|X|fffd|F" & setValue
                Log msg
                mdlErrDescription = msg
                Exit Function
            End If
        End If
        On Error GoTo 0
        'ONBLUR|fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60a4|
        waitForBrowse mdlMnkIE, , , , True
    
        '->2014/04/17 |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe||fffd||fffd||fffd|s|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||182||202||fffd||202||fffd||fffd||fffd||fffd||7c2||303|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||341|A|fffd|G|fffd||fffd||fffd|[|fffd||182||202||fffd|j
        If Trim(mnkDoc.getElementsByName("expirationListSearchCondition.agencyAtsukaishaName")(0).Value) = "" Then
            msg = "|fffd|w|fffd||fffd||311||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B|fffd||35dd||fffd|X|fffd|F" & fi.t|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd|
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
        '<-2014/04/17 |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||64fe||fffd||fffd||fffd|s|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||182||202||fffd||202||fffd||fffd||fffd||fffd||7c2||303|`|fffd|F|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||341|A|fffd|G|fffd||fffd||fffd|[|fffd||182||202||fffd|j
    End If
    '->2014/04/17
    Log "|fffd||fffd||fffd||fffd||fffd|s|fffd||311||35dd||fffd|X|fffd|R|fffd|[|fffd|h|fffd||341|F" & mnkDoc.getElementsByName("expirationListSearchCondition.agencyAtsukaishaCd")(0).Value
    Log "|fffd||fffd||fffd||fffd||fffd|s|fffd||311||35dd||fffd|X|fffd||fffd||fffd||341|F" & mnkDoc.getElementsByName("expirationListSearchCondition.agencyAtsukaishaName")(0).Value
    '<-2014/04/17
    
    '|fffd||110||752||fffd|
    Set mnkDoc = mdlMnkIE.document
    '|fffd||fffd||fffd|T|fffd|u
    If fi.t|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h <> "" Then
        Log "|fffd|T|fffd|u|fffd||fffd||752||80b5||fffd||702||fffd|"
        '|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd|O|fffd|F|fffd||fffd||fffd|S|fffd||fffd|v
        setName = "expirationListSearchCondition.agencySubCodeSearchCond"
        setType = PULLDOWN
        setValue = fi.p|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|T|fffd|u
        setName = "expirationListSearchCondition.dty9149"
        setType = TXT
        setValue = fi.t|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd|t|fffd||fffd||fffd|[
    If fi.t|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h <> "" Then
        Log "|fffd|t|fffd||fffd||fffd|[|fffd||fffd||752||80b5||fffd||702||fffd|"
        '|fffd|}|fffd|b|fffd|`|fffd||fffd||fffd|O|fffd|F|fffd||fffd||fffd|S|fffd||fffd|v
        setName = "expirationListSearchCondition.agencyFreeCodeSearchCond"
        setType = PULLDOWN
        setValue = fi.p|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|T|fffd|u
        setName = "expirationListSearchCondition.dty9150"
        setType = TXT
        setValue = fi.t|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd|x|fffd|X|fffd|i|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||18e|x|fffd|X|fffd||fffd||fffd||358|A|fffd||fffd||fffd||fffd||fffd||fffd|j
    If fi.t|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h <> "" Then
        Log "|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty5024"
        setType = TXT_CHANGE
        setValue = fi.t|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.p|fffd|x|fffd|X|fffd||fffd| <> "" Then
        Log "|fffd|x|fffd|X|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty5024"
        setType = PULLDOWN_ONCHANGE
        setValue = fi.p|fffd|x|fffd|X|fffd||fffd|
        '|fffd|x|fffd|X|fffd|R|fffd|[|fffd|h|fffd||193||fffd||fffd||fffd|name|fffd||302||fffd||fffd||7d4|z|fffd||fffd|1|fffd|w|fffd||fffd||152||fffd||fffd||68e||fffd||fffd|s
        'onchange|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||14b50||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        mnkDoc.getElementsByName(setName)(1).Value = setValue
        mnkDoc.getElementsByName(setName)(1).FireEvent ("onchange")
    End If
    
    '|fffd||fffd||fffd|c|fffd||fffd|
    If fi.t|fffd|c|fffd||fffd| <> "" Then
        Log "|fffd|c|fffd||302||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty6616"
        setType = TXT
        setValue = fi.t|fffd|c|fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||356a|
    If fi.p|fffd||356a| <> "" Then
        Log "|fffd||356a||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.daz0310"
        setType = PULLDOWN
        setValue = fi.p|fffd||356a|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||752||fffd|
    If fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| <> "" Then
        setName = "expirationListSearchCondition.expirationYearMonth"
        setType = PULLDOWN
        If fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| = "other" Then
            Log "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|i|fffd||fffd||fffd||311||fffd||fffd|j|fffd||fffd||752||80b5||fffd||702||fffd|"
            setValue = "other"
        Else
            '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
            If checkDate(fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|, "|fffd||fffd||fffd||fffd||fffd||a5d7|", "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|", "/01") = False Then
                Exit Function
            End If
'            If IsDate(fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| & "/01") = False Then
'                msg = "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|F" & fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|
'                Log msg
'                mdlErrDescription = msg
'                Exit Function
'            End If
            Log "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
            setValue = Format(CDate(fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd| & "/01"), "yyyymm")
            '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
            
            '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||251||fffd||fffd||742||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd|
            If chk|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|Exists = True Then
                '|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||251||fffd||fffd||742||fffd||fffd||90a9||fffd|m|fffd|F
                If checkSelectValue(mnkDoc, setName, setValue) = False Then
                    msg = "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|F" & fi.p|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd|
                    Log msg
                    mdlErrDescription = msg
                    Exit Function
                End If
            End If
        End If
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||fffd|
    If fi.t|fffd||fffd||fffd||fffd||fffd||fffd|FROM <> "" Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|iFrom|fffd|j|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDayFrom"
        setType = TXT
        setValue = fi.t|fffd||fffd||fffd||fffd||fffd||fffd|FROM
        If IsNumeric(setValue) = True Then                   '2|fffd||fffd||fffd||752||fffd||1c9||fffd|2013/6/26
            setValue = Right("00" & setValue, 2)
        End If
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.t|fffd||fffd||fffd||fffd||fffd||fffd|TO <> "" Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|iTo|fffd|j|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDayTo"
        setType = TXT
        setValue = fi.t|fffd||fffd||fffd||fffd||fffd||fffd|TO
        If IsNumeric(setValue) = True Then                   '2|fffd||fffd||fffd||752||fffd||1c9||fffd|2013/6/26
            setValue = Right("00" & setValue, 2)
        End If
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||8471||fffd||cbd41|i|fffd||152||fffd|F|fffd|Z|fffd|[|fffd|t|fffd|e|fffd|B|fffd|l|fffd|b|fffd|g|fffd||38f||6c1|j
    If fi.p|fffd||8471||fffd||fffd||fffd||fffd| <> "" Then
        Log "|fffd||8471||fffd||cbd42||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.procedureState"
        setType = PULLDOWN
        setValue = fi.p|fffd||8471||fffd||fffd||fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|
    Log "|fffd||fffd||682||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||702||fffd|"
    If fi.c|fffd||fffd||fffd|ALL = True Then
        Log "|fffd|S|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        Call clickButton(mnkDoc, "|fffd|S|fffd|I|fffd||fffd|")
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Call ClickButtonByValue(mnkDoc, "|fffd|S|fffd|I|fffd||fffd|")
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
        '|fffd|S|fffd|I|fffd||fffd||48b|@
        waitForBrowse mdlMnkIE
    Else
        setType = chk
        setValue = "1"
        If fi.c|fffd||fffd||fffd|(0) = True Then
            '|fffd||fffd||fffd||fffd||fffd||fffd|
            Log "|fffd||fffd||fffd||fffd||fffd||502||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuCarIns"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(1) = True Then
            '|fffd||fffd||fffd||fffd|
            Log "|fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuJibai"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(2) = True Then
            '|fffd||38d||fffd|
            Log "|fffd||38d||402||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuFireIns"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(3) = True Then
            '|fffd||fffd||fffd|Q
            Log "|fffd||fffd||fffd|Q|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuAcdntIns"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(4) = True Then
            '|fffd|V|fffd||fffd|
            Log "|fffd|V|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuNewtype"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(5) = True Then
            '|fffd||3c9||fffd|
            Log "|fffd||3c9||382||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuReserveFire"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(6) = True Then
            '|fffd||3cf||fffd|
            Log "|fffd||3cf||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuReserveAccident"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(7) = True Then
            '|fffd||3d0|V
            Log "|fffd||3d0|V|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuReserveNew"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(8) = True Then
            '|fffd||fffd||fffd|`
            Log "|fffd||fffd||fffd|`|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuAssetBuilding"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(9) = True Then
            '|fffd||fffd||fffd||fffd||fffd||fffd|
            Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuLongTermMedical"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
        If fi.c|fffd||fffd||fffd|(10) = True Then
            '|fffd||755||fffd|
            Log "|fffd||755||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|"
            setName = "expirationListSearchCondition.shumokuCargo"
            Call setData(mnkDoc, setName, setType, setValue)
        End If
    End If
    
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd||1d7||fffd||fffd||fffd||281|v|fffd||752||fffd|i|fffd|i|fffd||835e||fffd||74f||fffd||fffd||fffd||fffd|j|fffd|Q|fffd||fffd|Java|fffd|FTYBN01A
    '|fffd||fffd|hidden|fffd||fffd||fffd||682||250||752||80b5||fffd|A|fffd|i|fffd||fffd||fffd||741|u|fffd||fffd||fffd||311||fffd||fffd|v|fffd||151|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||182||242||fffd||fffd||9044|
    Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd|i|fffd||fffd||fffd||741|u|fffd||fffd||fffd||311||fffd||fffd|v|fffd||fffd||752||80b5||fffd||702||fffd|"
    '|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd|
    If fi.other.p|fffd||6cc||fffd||fffd||fffd||fffd| <> "" Then
        Log "|fffd||6cc||fffd||fffd||fffd||402||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty7595"
        setType = TXT
        setValue = fi.other.p|fffd||6cc||fffd||fffd||fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd|O|fffd|_|fffd||fffd||60c||fffd||fffd||50d||fffd|
    If fi.other.t|fffd|O|fffd|_|fffd||fffd||60c||fffd||fffd||50d||fffd| <> "" Then
        Log "|fffd|O|fffd|_|fffd||fffd||60c||fffd||fffd||50d||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty0329"
        setType = TXT
        setValue = fi.other.t|fffd|O|fffd|_|fffd||fffd||60c||fffd||fffd||50d||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|o|fffd|^|fffd||50d||fffd||fffd||fffd||fffd|S|fffd||fffd|
    If fi.other.t|fffd|o|fffd|^|fffd||50d||fffd||fffd||fffd|4|fffd||fffd| <> "" Then
        Log "|fffd|o|fffd|^|fffd||50d||fffd||fffd||fffd|4|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dab0050"
        setType = TXT
        setValue = fi.other.t|fffd|o|fffd|^|fffd||50d||fffd||fffd||fffd|4|fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|v|fffd||fffd||fffd||fffd|
    If fi.other.c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||3cd|X = True Then
        Log "|fffd|v|fffd||fffd||fffd||fffd|_|fffd||3cd|X|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.requiredCautionChange"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd| = True Then
        Log "|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||302||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.requiredCautionTrouble"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O = True Then
        Log "|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.requiredCautionExpirationJustBefore"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = True Then
        Log "|fffd|v|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||7c2||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.requiredCautionExpirationOverrun"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i
    If fi.other.p|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd| <> "" Then
        Log "|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.conranctantNameSearchCond"
        setType = TXT
        setValue = fi.other.p|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd||fffd|v|fffd|p|fffd|^|fffd|[|fffd||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.t|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i <> "" Then
        Log "|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty4679"
        setType = TXT
        setValue = fi.other.t|fffd|_|fffd||fffd||496||fffd||fffd|J|fffd|i
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd|
    If fi.other.t|fffd|d|fffd|b|fffd||50d||fffd| <> "" Then
        Log "|fffd|d|fffd|b|fffd||50d||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty0111"
        setType = TXT
        setValue = fi.other.t|fffd|d|fffd|b|fffd||50d||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|O|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd|
    If fi.other.t|fffd|O|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd| <> "" Then
        Log "|fffd|O|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.prePolicyInsP"
        setType = TXT
        setValue = fi.other.t|fffd|O|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|d|fffd|b|fffd||50d||fffd|
    If fi.other.t|fffd|V|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd| <> "" Then
        Log "|fffd|V|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.newPolicyInsP"
        setType = TXT
        setValue = fi.other.t|fffd|V|fffd|_|fffd||fffd||6cc||fffd||fffd||fffd||fffd||20f||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||656a|
    If fi.other.c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd| = True Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||342||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDivisionNoInput"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||28f||d59e||fffd||fffd||fffd||fffd||fffd||fffd| = True Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||28f||d59e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDivision1"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||411||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd| = True Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||411||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDivision2"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    If fi.other.c|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||4ce|v|fffd|m|fffd|F|fffd||142||fffd||fffd||202||fffd| = True Then
        Log "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||4ce|v|fffd|m|fffd|F|fffd||142||fffd||fffd||202||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationDivision3"
        setType = TXT
        setValue = "on"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd||fffd||fffd|v|fffd||fffd|~
    If fi.other.p|fffd||fffd||fffd|v|fffd||fffd|~ <> "" Then
        Log "|fffd||fffd||fffd|v|fffd||fffd|~|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty5217"
        setType = TXT
        setValue = fi.other.p|fffd||fffd||fffd|v|fffd||fffd|~
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||113||fffd|
    If fi.other.p|fffd||fffd||fffd||fffd||fffd||113||fffd| <> "" Then
        Log "|fffd||fffd||fffd||fffd||fffd||113||fffd||fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty7904"
        setType = TXT
        setValue = fi.other.p|fffd||fffd||fffd||fffd||fffd||113||fffd|
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||308||4ce|u|fffd|m|fffd|F
    If fi.other.p|fffd|p|fffd||fffd||fffd||fffd||308||4ce|v|fffd|m|fffd|F <> "" Then
        Log "|fffd|p|fffd||fffd||fffd||fffd||308||4ce|v|fffd|m|fffd|F|fffd||fffd||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.dty3915"
        setType = TXT
        setValue = fi.other.p|fffd|p|fffd||fffd||fffd||fffd||308||4ce|v|fffd|m|fffd|F
        Call setData(mnkDoc, setName, setType, setValue)
    End If
            
    '|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|
    'From
    If fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM <> "" Then
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        If checkDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM, "|fffd||fffd||fffd||fffd||fffd||a5d7|", "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM", "/01") = False Then
            Exit Function
        End If
        Log "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM|fffd||fffd||752||80b5||fffd||702||fffd|"
        gen = get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM, "ym")
        eemmdd = get|fffd|a|fffd||fffd|(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM, "ym")
'        If IsDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM & "/01") = False Then
'            msg = "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM|fffd|F" & fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM
'            Log msg
'            mdlErrDescription = msg
'            Exit Function
'        End If
'        Log "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM|fffd||fffd||752||80b5||fffd||702||fffd|"
'        gen = Format(CDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM & "/01"), "g")
'        eemmdd = Format(CDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM & "/01"), "eemm")
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        
        '|fffd|i|fffd||fffd||fffd|@|fffd|_|fffd||fffd||fffd||fffd||501|iFrom|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.policyTermEraFrom"
        setType = TXT
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        setValue = gen
'        setValue = IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", "0"))))
        '|fffd||fffd|<-2019/04/01  |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|i|fffd||fffd||fffd|@|fffd|_|fffd||fffd||fffd||fffd||501|iFrom|fffd|N|fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.policyTermYearMonhFrom"
        setType = TXT
        setValue = eemmdd
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    'To
    If fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO <> "" Then
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        If checkDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO, "|fffd||fffd||fffd||fffd||fffd||a5d7|", "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO", "/01") = False Then
            Exit Function
        End If
        Log "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO|fffd||fffd||752||80b5||fffd||702||fffd|"
        gen = get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO, "ym")
        eemmdd = get|fffd|a|fffd||fffd|(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO, "ym")
'        If IsDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO & "/01") = False Then
'            msg = "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO|fffd|F" & fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO
'            Log msg
'            mdlErrDescription = msg
'            Exit Function
'        End If
'        Log "|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO|fffd||fffd||752||80b5||fffd||702||fffd|"
'        gen = Format(CDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO & "/01"), "g")
'        eemmdd = Format(CDate(fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO & "/01"), "eemm")
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        
        '|fffd|i|fffd||fffd||fffd|@|fffd|_|fffd||fffd||fffd||fffd||501|iTo|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.policyTermEraTo"
        setType = TXT
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        setValue = gen
'        setValue = IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", "0"))))
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|i|fffd||fffd||fffd|@|fffd|_|fffd||fffd||fffd||fffd||501|iTo|fffd|N|fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.policyTermYearMonhTo"
        setType = TXT
        setValue = eemmdd
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd||fffd||14f|I|fffd||653||fffd||fffd||fffd|
    'From
    If fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM <> "" Then
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        If checkDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM, "|fffd||fffd||fffd||fffd||fffd||a5d7|", "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM") = False Then
            Exit Function
        End If
        Log "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM|fffd||fffd||752||80b5||fffd||702||fffd|"
        gen = get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM)
        eemmdd = get|fffd|a|fffd||fffd|(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM)
'        If IsDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM) = False Then
'            msg = "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM|fffd|F" & fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM
'            Log msg
'            mdlErrDescription = msg
'            Exit Function
'        End If
'        Log "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM|fffd||fffd||752||80b5||fffd||702||fffd|"
'        gen = Format(CDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM), "g")
'        eemmdd = Format(CDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_FROM), "eemmdd")
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        
        '|fffd|i|fffd||fffd||fffd|@|fffd||14f|I|fffd||653||fffd||fffd||fffd||fffd|iFrom|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.lastChangeDateEraFrom"
        setType = TXT
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        setValue = gen
'        setValue = IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", "0"))))
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|i|fffd||fffd||fffd|@|fffd||14f|I|fffd||653||fffd||fffd||fffd||fffd|iFrom|fffd|N|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.lastChangeDateFrom"
        setType = TXT
        setValue = eemmdd
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    'To
    If fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO <> "" Then
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        If checkDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO, "|fffd||fffd||fffd||fffd||fffd||a5d7|", "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO") = False Then
            Exit Function
        End If
        Log "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO|fffd||fffd||752||80b5||fffd||702||fffd|"
        gen = get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO)
        eemmdd = get|fffd|a|fffd||fffd|(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO)
'        If IsDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO) = False Then
'            msg = "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO|fffd|F" & fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO
'            Log msg
'            mdlErrDescription = msg
'            Exit Function
'        End If
'        Log "|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO|fffd||fffd||752||80b5||fffd||702||fffd|"
'        gen = Format(CDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO), "g")
'        eemmdd = Format(CDate(fi.other.t|fffd||14f|I|fffd||653||fffd||fffd||fffd|_TO), "eemmdd")
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        
        '|fffd|i|fffd||fffd||fffd|@|fffd||14f|I|fffd||653||fffd||fffd||fffd||fffd|iTo|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.lastChangeDateEraTo"
        setType = TXT
        '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        setValue = gen
'        setValue = IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", "0"))))
        '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd||fffd||155||3cd|X
        Call setData(mnkDoc, setName, setType, setValue)
        '|fffd|i|fffd||fffd||fffd|@|fffd||14f|I|fffd||653||fffd||fffd||fffd||fffd|iTo|fffd|N|fffd||fffd||fffd||fffd||fffd|j
        setName = "expirationListSearchCondition.lastChangeDateTo"
        setType = TXT
        setValue = eemmdd
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    '|fffd||fffd|Java|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|
    If fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_FROM <> "" Or fi.other.t|fffd|_|fffd||fffd||fffd||fffd||514|N|fffd||fffd|_TO <> "" Then
        Log "|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|u|fffd||fffd||fffd||311||fffd||fffd|v|fffd||250||752||80b5||fffd||702||fffd|"
        setName = "expirationListSearchCondition.expirationYearMonth"
        setType = PULLDOWN
        setValue = "other"
        Call setData(mnkDoc, setName, setType, setValue)
    End If
    
    DoEvents
    Sleep 10
    
    '|fffd||fffd||fffd|u|fffd||fffd||fffd||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
    Log "|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    blnRtn = clickButton(mnkDoc, "|fffd||fffd||fffd|@|fffd||fffd|")
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    blnRtn = ClickButtonByValue(mnkDoc, "|fffd||fffd||fffd|@|fffd||fffd|")
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
    Log "|fffd||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||48b|@|fffd|J|fffd|n"
    waitForBrowse mdlMnkIE
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set mnkDoc = mdlMnkIE.document
    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|m|fffd|F
    Log "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|m|fffd|F"
    '->|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    '|fffd||fffd||fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||30d||14c||fffd||fffd|DIV|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||182||202||fffd|
    '|fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||fffd|DIV|fffd|Q|fffd||fffd||fffd||64fe|
    Dim objDivs As Object
    On Error Resume Next
    Set objDivs = mnkDoc.getElementsByTagName("TABLE")(0).getElementsByTagName("DIV")
    'DIV|fffd|Q|fffd||30d||14c||fffd||fffd|inner|fffd||fffd||fffd||64fe|
    strTemp = Trim(objDivs(objDivs.Length - 1).innerText)
    On Error GoTo 0
''    On Error Resume Next
''    strTemp = getTDValue(mnkDoc, "|fffd||189||fffd||fffd||fffd|F", 0, 4)
    '<-|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    If strTemp <> "" Then
        msg = "|fffd||fffd||282||248||209||fffd||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|w" & strTemp & "|fffd|x"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    On Error GoTo 0
    
    '|fffd||fffd||fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd||64fe|
    Log "|fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd||30e||64fe||fffd|J|fffd|n"
    '->|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    On Error Resume Next
    strTemp = mnkDoc.getElementsByTagName("P")(0).innerText
    On Error GoTo 0
''    strTemp = getTDValue(mnkDoc, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ", 0, 0)
    '<-|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    strTemp = regExcute(strTemp, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (.+?)|fffd||fffd|")
    If IsNumeric(strTemp) = True Then
        '|fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd||752||fffd|
        mdlTotalCount = CLng(strTemp)
        Log "|fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd|F" & mdlTotalCount
    Else
        msg = "|fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd||30e||64fe||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    On Error GoTo 0
    
    '|fffd||fffd||fffd||fffd||fffd||28c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||fffd||fffd||451||582||fffd||fffd|m|fffd|F
    If mdlTotalCount > 0 Then
        '|fffd|u|fffd||fffd||fffd||451||582||fffd||fffd|v|fffd|m|fffd|F
        If fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|1 <> "" Or fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|2 <> "" Then
            If fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|1 <> "" Then
                Log "|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd|P|fffd||fffd||752||80b5||fffd||702||fffd|"
                setName = "expirationListSearchCondition.sortOrder1"
                setType = PULLDOWN
                setValue = fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|1
                Call setData(mnkDoc, setName, setType, setValue)
            End If
            If fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|2 <> "" Then
                Log "|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd|Q|fffd||fffd||752||80b5||fffd||702||fffd|"
                setName = "expirationListSearchCondition.sortOrder2"
                setType = PULLDOWN
                setValue = fi.srt.p|fffd|\|fffd|[|fffd|g|fffd||fffd|2
                Call setData(mnkDoc, setName, setType, setValue)
            End If
        
            '|fffd|u|fffd||fffd||fffd||451||582||fffd||fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|
            Log "|fffd||fffd||fffd||451||582||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd|"
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            blnRtn = clickButton(mnkDoc, "|fffd||fffd||fffd||451||582||fffd|")
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            blnRtn = ClickButtonByValue(mnkDoc, "|fffd||fffd||fffd||451||582||fffd|")
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
            Log "|fffd||fffd||fffd||451||582||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||48b|@|fffd|J|fffd|n"
            waitForBrowse mdlMnkIE
        End If
    End If
    
    findExecuteSub = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.findExecuteSub"
End Function

'->2013/12/20CSV|fffd|o|fffd||34e||635e||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||295||fffd||fffd|i|fffd||fffd||fffd|g|fffd|p|fffd||302||fffd||fffd||7d5|s|fffd|v
'->|fffd||35dd||fffd|X|fffd||fffd||fffd||fffd||fffd|p
'Private Function existsDairitenDailog(ByVal findTitlePart As String, ByVal clickBtnName As String, _
'                            Optional DLG_WAITTIME As Long = 2000) As Boolean
'    startOf "existsDairitenDailog"
'    #If Win64 Then
'    Dim childhWnd   As LongPtr
'    Dim result  As LongPtr
'    #Else
'    Dim childhWnd   As Long
'    Dim result  As Long
'    #End If
'    Dim doc As Object
'    Dim docNext As Object
'
'    Dim StartTime As Long
'    Dim UseTime As Long
'
'    Dim i   As Long
'
'    existsDairitenDailog = False
'
'    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||752||fffd|
'    mdlFindClassFull = "Internet Explorer_TridentDlgFrame"
'    mdlFindTitlePart = "Web |fffd|y|fffd|[|fffd|W |fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O"                          '2013/06/25IE6|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||752||fffd||389||fffd|
'
'    DoEvents
'    Sleep 100
'    'web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|iCUSTOM|fffd|u|fffd||fffd||fffd|E|fffd|U|fffd|[|fffd|j|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
'    UseTime = 0
'    StartTime = GetTickCount
'    Do
'
'        '2013/06/25|fffd||1c9||fffd|
'        '|fffd||fffd||fffd||fffd|IE6|fffd||302||741|BIFRAME|fffd||fffd|src|fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd||243|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B
'        '|fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||242||343|Z|fffd|L|fffd||fffd||fffd||fffd||fffd|e|fffd|B|fffd||155||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd||fffd||702||702||fffd||102||fffd||fffd||702||fffd||fffd||fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||682||fffd|\|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|?
'        For i = 1 To 10
'            DoEvents
'            Sleep 10
'            Call clickIEAlert("|fffd||342||fffd|", "|fffd||6cc||c0b3||fffd||fffd||102||fffd||fffd||9340||fffd||682||195||6cc||c0b3||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|")
'        Next
'
'        DoEvents
'        Sleep 10
'
'        mdlTargethWnd = 0
'        mdlWebDialogTitle = ""
'
'        '|fffd|n|fffd||fffd||fffd|h|fffd||fffd||fffd||30e||64fe|
'        Call EnumWindows(AddressOf getWebDaialog, 0)
'
'        If mdlTargethWnd > 0 Then
'            childhWnd = FindWindowEx(mdlTargethWnd, 0&, "Internet Explorer_Server", vbNullString)
'            If childhWnd <> 0 Then
'                Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
'                DoEvents
'                Sleep 10
'
'                '2013/06/25 ie6|fffd||30f||a347||fffd|AWindowTitle|fffd||fffd||fffd||fffd||fffd||752||fffd||30f||fffd||502||fffd||fffd||fffd||fffd||90bd||fffd||fffd|Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||154||fffd||fffd|f
'                'Dom|fffd||3ca||fffd|
'                Set doc = getHTMLDocument(childhWnd)
'                If Not doc Is Nothing Then
'                    On Error Resume Next
'                    Set docNext = doc.frames.Item(0).document
'                    If Err.Number = 0 Then
'                        'Doc|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||24c||fffd||fffd||fffd||fffd|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||702||702||fffd||90a9|
'                        If InStr(docNext.Title, findTitlePart) > 0 Then
'                            Exit Do
'                        End If
'                    End If
'                    On Error GoTo 0
'                End If
'            End If
'        End If
'
'        UseTime = GetTickCount - StartTime
'
'    Loop While UseTime < DLG_WAITTIME
'    If UseTime >= DLG_WAITTIME Then
'        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
'        Exit Function
'    End If
'
'    DoEvents
'    Sleep 100
'
'    UseTime = 0
'    StartTime = GetTickCount
'    Do
'        DoEvents
'        Sleep 10
'
'        'Dom|fffd||3ca||fffd||fffd||fffd||fffd||3554||fffd||248||693||fffd||fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd| 2013/06/25
'        '|fffd|w|fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
'        If clickButton(docNext, clickBtnName) = True Then
'            Exit Do
'        End If
'
'        UseTime = GetTickCount - StartTime
'
'    Loop While UseTime < DLG_WAITTIME
'    If UseTime >= DLG_WAITTIME Then
'        Log "Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
'        Exit Function
'    End If
'
'    'waitForBrowse|fffd||34e|g|fffd|p|fffd||142||fffd||fffd||202||fffd|
'    DoEvents
'    Sleep 100
'
'    existsDairitenDailog = True
'
'    endOf "existsDairitenDailog"
' End Function
'<-2013/12/20CSV|fffd|o|fffd||34e||635e||fffd||254||fffd||fffd||fffd||fffd||fffd||fffd||295||fffd||fffd|i|fffd||fffd||fffd|g|fffd|p|fffd||302||fffd||fffd||7d5|s|fffd|v

'2013/12/20|fffd|@|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|s|fffd|[|fffd|C|fffd||fffd||fffd|i|fffd||fffd||fffd|S|fffd||253||fffd||fffd||fffd||fffd||142||202||fffd||fffd|j
Private Function outCsvFileSub() As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.outCsvFileSub"
    Dim doc As HTMLDocument
    Dim msg As String
    
    Dim str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|   As String
    Dim errMsg  As String                                       '2013/10/20
    
    Dim setName As String
    Dim setType As String
    Dim setValue As String
    
    outCsvFileSub = False
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||fffd|
    Set doc = mdlMnkIE.document
    '|fffd||fffd|CSV|fffd|o|fffd||349||fffd||fffd||fffd|
    Log "CSV|fffd|o|fffd||343|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    If clickButton(doc, "CSV|fffd|o|fffd||fffd|") = False Then
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    If ClickButtonByValue(doc, "CSV|fffd|o|fffd||fffd|") = False Then
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
        msg = "|fffd|uCSV|fffd|o|fffd||341|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd|s"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    Log "|fffd||fffd||291||48b|@|fffd|J|fffd|n"
    waitForBrowse mdlMnkIE
    
    '|fffd||fffd|CSV|fffd|I|fffd||fffd||fffd||fffd||fffd|
    '>2013/09/20|fffd||10c||fffd||fffd||302||742||14c||fffd||fffd||fffd||fffd||255||3cd|X|fffd||302||fffd||fffd||7d5|s|fffd|v
    '@Set doc = ie.document
    '@'|fffd||fffd||fffd||742||202||fffd||fffd||fffd||fffd||64fe||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||38d||fffd|F|fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||183|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||142||fffd||fffd||202||fffd|
    '@On Error Resume Next
    '@|fffd||742||202||fffd||fffd||fffd| = doc.getElementsByName("MINASHI_BI")(0).value
    '@On Error GoTo 0
    '@If Trim(|fffd||742||202||fffd||fffd||fffd|) <> "" Then
    '@    |fffd||742||202||fffd||fffd||fffd| = Format(Trim(|fffd||742||202||fffd||fffd||fffd|), "@@@@/@@/@@")
    '@Else
    '@    |fffd||742||202||fffd||fffd||fffd| = Format(Now, "yyyy/mm/dd")
    '@End If
    '@Log "|fffd||742||202||fffd||fffd||fffd||fffd||64fe||fffd|F" & |fffd||742||202||fffd||fffd||fffd|
    '<2013/09/20|fffd||10c||fffd||fffd||302||742||14c||fffd||fffd||fffd||fffd||255||3cd|X|fffd||302||fffd||fffd||7d5|s|fffd|v
    
    '|fffd||fffd|CSV|fffd|I|fffd||fffd|
    Set doc = mdlMnkIE.document
    Log "CSV|fffd|I|fffd||fffd||fffd||fffd||282||310||752||fffd|"
    '|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||64fe||fffd|i|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd|j
    '->2016/01/22 |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||389||fffd|
    If mdl|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = "" Then
        str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = doc.getElementsByName("saveFileName")(0).Value
        str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| & Format(Now, "yyyymmddhhmmss")
    Else
        str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = mdl|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    End If
    'str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = doc.getElementsByName("saveFileName")(0).value
    'str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| & Format(Now, "yyyymmddhhmmss")
    '<-2016/01/22 |fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||389||fffd|
    doc.getElementsByName("saveFileName")(0).Value = str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    mdl|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd| = str|fffd||6d1||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|                   '2013/09/20
    
    '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||752||fffd|
    Log "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||752||80b5||fffd||702||fffd|"
    setName = "password"
    setType = TXT
    setValue = mdlZip|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    Call setData(doc, setName, setType, setValue)

    '|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|i|fffd||53bca||fffd||fffd|j
    Log "|fffd||fffd||fffd|s|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|i|fffd||53bca||fffd||fffd|j"
    Call asyncClickExecuteDailog(doc, "|fffd|o|fffd|@|fffd||fffd|")
    '@If clickButton(doc, "|fffd|o|fffd|@|fffd||fffd|") = False Then
    '@    msg = "|fffd|u|fffd|o|fffd|@|fffd||341|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||24e||fffd||fffd|s"
    '@    Log msg
    '@    mdlErrDescription = msg
    '@    Exit Function
    '@End If
    '|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|Web|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||302||fffd||fffd||fffd|waitForBrowse|fffd|s|fffd||fffd|
    '@Log "|fffd||fffd||291||48b|@|fffd|J|fffd|n"
    '@waitForBrowse ie

    '|fffd||fffd||fffd|A|fffd||fffd||fffd|[|fffd|g|fffd|m|fffd|F
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|u|fffd||90|l|fffd||fffd||fffd||fffd||fffd||702||792||fffd||fffd|[|fffd||30f||a347||fffd|A2000|fffd||fffd||fffd||12d02||fffd||fffd||102||fffd|2000|fffd||fffd||fffd||702||142||fffd||fffd||fffd||fffd|o|fffd||342||fffd||fffd||702||fffd||fffd||fffd|B|fffd|v|fffd||389||fffd||fffd|i|fffd||413||fffd||fffd|^|fffd||35dd||fffd|X|fffd||58c|W|fffd||202||fffd||fffd||fffd||fffd|{|fffd|j
    DoEvents
    Sleep 1000
    Dim i   As Long
    For i = 1 To 10
        DoEvents
        Sleep 10
        Call clickIEAlert("OK", "|fffd||90|l|fffd||fffd||fffd||fffd||fffd||702||fffd|")
    Next
    
    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|m|fffd|F 2014/01/07|fffd||1c9||fffd|
    If checkErrForm(doc) = False Then Exit Function
    
    '|fffd||fffd||fffd||413||fffd||fffd||30f||a347||fffd|A|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||fffd||fffd|
    If isMS1PC Then
        
        DoEvents
        Sleep 1000
        
        Log "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||fffd||282||1100d||c0b5||fffd||702||fffd|"
        If mdl|fffd|\|fffd||fffd||fffd||50d||fffd| = "" Then
            Log "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||fffd||fffd| |fffd||fffd||fffd||351||482||fffd||fffd||702||fffd|"
            '|fffd||fffd||fffd||351||482||fffd||fffd||fffd||fffd|
            Do While True
                If reply|fffd|\|fffd||fffd||fffd||50d||fffd|("|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F") = False Then
                    Exit Do
                End If
                DoEvents
                Sleep 100
            Loop
        Else
            Log "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||fffd||fffd| |fffd||fffd||fffd||342||fffd||fffd||10f|o|fffd||349||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
            '|fffd||fffd||fffd||342||fffd||fffd||10f|o|fffd||349||fffd||fffd||fffd| 2013/12/20|fffd||fffd||fffd||fffd| |fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||1c9||fffd|
''            If reply|fffd|\|fffd||fffd||fffd||50d||fffd|("|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F", mdl|fffd|\|fffd||fffd||fffd||50d||fffd|, "|fffd|o|fffd||fffd|") = False Then
''                msg = "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            If reply|fffd|\|fffd||fffd||fffd||50d||fffd|("|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F", mdl|fffd|\|fffd||fffd||fffd||50d||fffd|, "|fffd|o|fffd||fffd|", errMsg) = False Then
                msg = "|fffd|\|fffd||fffd||fffd||50d||fffd||fffd|m|fffd|F|fffd||148||209||fffd||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|w" & errMsg & "|fffd|x"
                Log msg
                mdlErrDescription = msg
                Exit Function
            End If
        End If
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||281|i|fffd||fffd|Web|fffd|y|fffd|[|fffd|W|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd|j
    Log "|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||282||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd|"
    If downloadWebDailog("|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h", "|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h", mdlShell|fffd||151||fffd||482||fffd|ms) = False Then
        '2013/08/13|fffd||50b|p|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||1c9||fffd|
        'msg = "|fffd|u|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||282||fffd||fffd||742||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|B"
        msg = "|fffd|u|fffd||fffd||fffd|[|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd|v|fffd||fffd||282||311||fffd||fffd||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"                '2014/01/14|fffd|C|fffd||fffd|
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    outCsvFileSub = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.outCsvFileSub"
End Function

'|fffd|I|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd|i|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd|j|fffd||24e|w|fffd||fffd|Value|fffd|l|fffd||fffd||fffd||fffd||fffd||742||fffd||fffd||90a9||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|
Private Function checkSelectValue(htmlDoc As HTMLDocument, ByVal inpElementName As String, ByVal chkValue As String) As Boolean
    
    Dim selectElement As HTMLSelectElement
    Dim optionElement As HTMLOptionElement
    Dim optionElements As Object
    Dim findFlg As Boolean
    
    checkSelectValue = False
    Log "checkSelect Name:" & inpElementName & ",Val:" & chkValue
    Set selectElement = Nothing
    On Error Resume Next
    Set selectElement = htmlDoc.getElementsByName(inpElementName)(0)
    Set optionElements = selectElement.getElementsByTagName("OPTION")
    On Error GoTo 0
    If selectElement Is Nothing Then
        Log "|fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
        Exit Function
    End If
    
    findFlg = False
    For Each optionElement In optionElements
        If optionElement.Value = chkValue Then
            findFlg = True
            checkSelectValue = True
            Log chkValue & "|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||702||fffd||fffd||fffd|"
            Exit For
        End If
    Next
    If findFlg = False Then
        Log "|fffd||38f||6c2||302||fffd||fffd|v|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||24c||fffd||fffd||82||fffd||fffd||fffd||702||fffd||fffd||fffd||142||fffd||fffd||fffd|"
    End If
    
End Function
'########################################################
'# |fffd||fffd||fffd||fffd||fffd||fffd||fffd|ssub end
'########################################################

'########################################################
'# |fffd||64fe||fffd||fffd||fffd|ssub start
'########################################################
Private Function getDataOneSub(resOne As mnk|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) As Boolean
    startOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.getDataOneSub"
    Dim noInPage    As Long
    Dim msg     As String
    Dim blnRtn  As Boolean
    
    getDataOneSub = False
    
    '|fffd||fffd||fffd||fffd||fffd||50d||fffd|UP
    mdlReqCount = mdlReqCount + 1
    Log "|fffd||fffd||fffd||fffd||fffd||38f||6c3|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd||702||fffd||fffd|B|fffd||38f||6cc||fffd||fffd||fffd||fffd|F" & mdlReqCount & "|fffd|i|fffd|S|fffd||30c||fffd||fffd||fffd||fffd|F" & mdlTotalCount & "|fffd|j"
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd|[|fffd|o|fffd|[|fffd||fffd||fffd|AEOF|fffd||752||80b5||fffd||fffd||fffd||fffd|I|fffd||fffd|
    If mdlReqCount > mdlTotalCount Then
        Log "|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||34f|I|fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd||14f||fffd||fffd||317|v|fffd||fffd||fffd||fffd||fffd||341|A|fffd||64ea||fffd|y|fffd|[|fffd|W|fffd||64fe|
    If mdlReqCount = 1 Then
        Log "|fffd||14f||fffd||fffd||316||fffd||fffd||5ce||64fe||fffd|@|fffd||38f||6cc||fffd||fffd||fffd||fffd|F" & mdlReqCount
        blnRtn = getPageDetail(False)
        '|fffd||fffd||fffd||64fe||fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
        If blnRtn = False Then
            msg = "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|w" & mdlErrDescription & "|fffd|x"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
        '|fffd||64ea||fffd|y|fffd|[|fffd|W|fffd||316||fffd||fffd||5d0||fffd||fffd||fffd||fffd|o|fffd|b|fffd|N|fffd|A|fffd|b|fffd|v
        mdlCntInFirstPage = mdlCntInPage
    End If
    
    '|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd|No|fffd|i|fffd||fffd||fffd||516||681|j|fffd||fffd||fffd|v|fffd|Z
    noInPage = mdlReqCount Mod mdlCntInFirstPage
    If noInPage = 0 Then
        noInPage = mdlCntInFirstPage
    End If
    Log "|fffd|y|fffd|[|fffd|W|fffd||fffd|No|fffd|i|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||309||fffd||fffd||516||681|j|fffd|F" & noInPage
    
    '|fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||316||fffd||fffd||5d7|v|fffd||fffd||fffd|i|fffd|y|fffd|[|fffd|W|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||3c2||742||30f||a347||fffd|j
    If mdlReqCount > 1 Then
        If noInPage = 1 Then
            Log "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||fffd||5ce||64fe||fffd|@|fffd||38f||6cc||fffd||fffd||fffd||fffd|F" & mdlReqCount
            blnRtn = getPageDetail(True)
            '|fffd||fffd||fffd||64fe||fffd|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N
            If blnRtn = False Then
                msg = "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & "|fffd|w" & mdlErrDescription & "|fffd|x"
                Log msg
                mdlErrDescription = msg
                Exit Function
            End If
        End If
    End If

    '|fffd||fffd||fffd||fffd||fffd||295||50b|p
    resOne = mdlDetail(noInPage - 1)
    
    getDataOneSub = True
    endOf "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy.getDataOneSub"
End Function

'# |fffd||fffd||fffd||5cf||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
'#  nextPage|fffd|FTrue   |fffd||fffd||fffd||303|y|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||64fe|
'#  nextPage|fffd|FFalse  |fffd||fffd||fffd||743|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||64fe|
Private Function getPageDetail(nextPage As Boolean) As Boolean
    On Error GoTo ERR_getPageDetail
    startOf "|fffd|p|fffd||fffd||fffd||fffd||fffd||5ce||64fe||fffd||fffd||fffd||fffd|"
    
    Dim mnkDoc          As HTMLDocument
    Dim tblElements     As Object
    Dim tblElement      As Object
    Dim targetTblElement    As Object
    Dim trElements      As Object
    Dim trElement       As Object
    Dim tdElements      As Object
    Dim tdElement       As Object
    Dim existsTbl       As Boolean
    Dim cntMeisai       As Long             '|fffd||fffd||fffd||5d0||fffd||fffd|i|fffd|R|fffd|s|fffd||142|P|fffd||fffd||fffd||5c1|j
    Dim cntTr           As Long             '|fffd|s|fffd||fffd|
    Dim cntTd           As Long             '|fffd|s|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd|
    
    Dim strValue        As String
    Dim aryValue()      As String
    Dim strTemp         As String
    Dim objTemp         As Object
    Dim msg             As String
    Dim result          As Boolean
        
    Const TABLE_LEFT_STR = "|fffd|I|fffd||1678a||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Const TABLE_MID_STR = "|fffd||fffd||fffd| |fffd|E |fffd||35dd||fffd|X |fffd|E |fffd||35dd||fffd|X|fffd||fffd||7ba||fffd||fffd||fffd| |fffd|E |fffd||35dd||fffd|X|fffd||630||fffd||fffd||fffd||fffd| |fffd|E |fffd|x|fffd|X |fffd|E |fffd|c|fffd||fffd|"
    
    getPageDetail = False
       
    '|fffd||fffd|IE|fffd|w|fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If mdlMnkIE Is Nothing Then
        msg = "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|IE|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    Set mnkDoc = mdlMnkIE.document

    '|fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|w|fffd||80a0||fffd||fffd||30f||a347|
    If nextPage = True Then
        Log "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|n"
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        result = clickButton(mnkDoc, "|fffd||fffd||fffd||fffd|")
'2016/06/15 |fffd||d3dc| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        result = ClickButtonByValue(mnkDoc, "|fffd||fffd||fffd||fffd|")
'2016/06/15 |fffd||1c9||fffd| T.K egg1.82|fffd||389||fffd| |fffd||fffd||fffd||fffd||fffd||702||fffd|
        Log "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||48b|@|fffd|J|fffd|n"
        waitForBrowse mdlMnkIE
        
        Set mnkDoc = mdlMnkIE.document
    
    End If
    
    '|fffd||fffd||fffd||fffd||295|\|fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|m|fffd|F
    Log "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||64fe||fffd|J|fffd|n"
    '->|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    '|fffd||fffd||fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||30d||14c||fffd||fffd|DIV|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||182||202||fffd|
    '|fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||fffd|DIV|fffd|Q|fffd||fffd||fffd||64fe|
    Dim objDivs As Object
    On Error Resume Next
    Set objDivs = mnkDoc.getElementsByTagName("TABLE")(0).getElementsByTagName("DIV")
    'DIV|fffd|Q|fffd||30d||14c||fffd||fffd|inner|fffd||fffd||fffd||64fe|
    strTemp = Trim(objDivs(objDivs.Length - 1).innerText)
    On Error GoTo 0
    If strTemp <> "" Then
''    strValue = getTDValue(mnkDoc, "|fffd||189||fffd||fffd||fffd|F", 0, 4)
''    If strValue <> "" Then
    '<-|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
        msg = "|fffd||fffd||282||248||209||fffd||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|w" & strTemp & "|fffd|x"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||742||303|y|fffd|[|fffd|W|fffd||64fe|
    Log "|fffd||fffd||fffd||743|y|fffd|[|fffd|W|fffd||30e||64fe||fffd|J|fffd|n"
    strValue = mnkDoc.getElementsByName("expirationListControl.nowPage")(0).Value
    If IsNumeric(strValue) = True Then
        mdlNowPage = CLng(strValue)
    Else
        Log "|fffd||fffd||fffd||743|y|fffd|[|fffd|W|fffd||30e||64fe||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
    End If
    
    '|fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||64fe|
    Log "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||30e||64fe||fffd|J|fffd|n"
    On Error Resume Next
    '->|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    strValue = mnkDoc.getElementsByTagName("P")(0).innerText
''    strValue = getTDValue(mnkDoc, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ", 0, 0)
    On Error GoTo 0
    '<-|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7cd||fffd||fffd||fffd|
    strValue = regExcute(strValue, " |fffd||fffd| / (.+?)|fffd||fffd|")
    If IsNumeric(strValue) = True Then
        mdlTotalPage = CLng(strValue)
    Else
        Log "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||30e||64fe||fffd||fffd||fffd|e|fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||702||fffd||fffd||fffd|B"
    End If
    
    '|fffd||fffd||fffd||a5d7||fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    Set tblElements = mnkDoc.getElementsByTagName("TABLE")
    existsTbl = False
    For Each tblElement In tblElements
        If existsTbl = True Then
            Log "|fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||702||fffd||fffd||fffd|" & "|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|l|fffd|Fleft-" & TABLE_LEFT_STR & ",MID-" & TABLE_MID_STR
            Set targetTblElement = tblElement
            Exit For
        End If
        If Left(tblElement.innerText, Len(TABLE_LEFT_STR)) = TABLE_LEFT_STR Then
            If InStr(tblElement.innerText, TABLE_MID_STR) > 0 Then
                existsTbl = True
            End If
        End If
    Next
    
    '|fffd||fffd||fffd||38f||6c3|e|fffd|[|fffd|u|fffd||fffd||fffd||202||fffd||fffd|i|fffd|O|fffd||fffd||fffd|j
    If existsTbl = False Then
        msg = "|fffd||fffd||fffd||5c3|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|BPage|fffd|F" & mdlNowPage
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If
    
    '|fffd||fffd||fffd|R|fffd|s|fffd||142|P|fffd||fffd||fffd||5d5||fffd||fffd||30d|\|fffd||fffd||fffd|iTR|fffd|j|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
    Set trElements = targetTblElement.getElementsByTagName("TR")
    For Each trElement In trElements
        
        '|fffd|R|fffd|s|fffd||310||64ea||fffd||30f||a347||fffd||310||752||fffd|
        If cntTr = 0 Then
            '|fffd||48f|W|fffd||fffd||fffd||fffd|g|fffd||fffd|
            ReDim Preserve mdlDetail(cntMeisai)
            '|fffd|P|fffd|y|fffd|[|fffd|W|fffd||682||30c||fffd||fffd||fffd||fffd||752||fffd|
            mdlCntInPage = cntMeisai + 1
        End If
        
        '|fffd||fffd||fffd|R|fffd|s|fffd|P|fffd||fffd||fffd||5c2||fffd||fffd||95||295||48f|W
        cntTd = 0
        Select Case cntTr
            Case 0
                '|fffd||fffd||fffd|P|fffd|s|fffd||682||303|f|fffd|[|fffd|^|fffd|\|fffd||fffd||fffd|iTD|fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Set tdElements = trElement.getElementsByTagName("TD")
                For Each tdElement In tdElements
                    '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||64fe|
                    strValue = tdElement.innerText
                    Select Case cntTd
                        Case 0
'                            '|fffd|I|fffd||fffd|
'                            strValue = ""
'                            On Error Resume Next
'                            strValue = CStr(tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].select")(0).Checked)
'                            On Error GoTo 0
'                            mdlDetail(cntMeisai).|fffd|I|fffd||fffd| = Trim(strValue)
                        Case 1
                            '|fffd||fffd||fffd||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd| = Trim(strValue)
                        Case 2
                            '|fffd||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd| = Trim(strValue)
                        Case 3
                            '|fffd||fffd||fffd| |fffd|E |fffd||35dd||fffd|X |fffd|E |fffd||35dd||fffd|X|fffd||fffd||7ba||fffd||fffd||fffd| |fffd|E |fffd||35dd||fffd|X|fffd||630||fffd||fffd||fffd||fffd| |fffd|E |fffd|x|fffd|X |fffd|E |fffd|c|fffd||fffd|
                            'innerText|fffd||142||355||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|innerHTML|fffd||fffd||fffd|g|fffd|p
                            aryValue = separateInnerHtml(tdElement.innerHTML)
                            If UBound(aryValue) > -1 Then
                                mdlDetail(cntMeisai).|fffd||fffd||fffd| = Trim(aryValue(0))
                            End If
                            If UBound(aryValue) > 0 Then
                                mdlDetail(cntMeisai).|fffd||35dd||fffd|X = Trim(aryValue(1))
                            End If
                            If UBound(aryValue) > 1 Then
                                mdlDetail(cntMeisai).|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h = Trim(aryValue(2))
                            End If
                            If UBound(aryValue) > 2 Then
                                mdlDetail(cntMeisai).|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h = Trim(aryValue(3))
                            End If
                            If UBound(aryValue) > 3 Then
                                mdlDetail(cntMeisai).|fffd|x|fffd|X = Trim(aryValue(4))
                            End If
                            If UBound(aryValue) > 4 Then
                                mdlDetail(cntMeisai).|fffd|c|fffd||fffd| = Trim(aryValue(5))
                            End If
                        Case 4
                            '|fffd||fffd||fffd| |fffd|E |fffd||fffd||fffd||fffd||fffd||fffd||fffd|@ |fffd|E |fffd||6cc||fffd||fffd||311||38f||6d3||fffd|
                            'innerText|fffd||142||355||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|innerHTML|fffd||fffd||fffd|g|fffd|p
                            aryValue = separateInnerHtml(tdElement.innerHTML)
                            If UBound(aryValue) > -1 Then
                                mdlDetail(cntMeisai).|fffd||fffd||fffd| = Trim(aryValue(0))
                            End If
                            If UBound(aryValue) > 0 Then
                                mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@ = Trim(aryValue(1))
                            End If
                            If UBound(aryValue) > 1 Then
                                mdlDetail(cntMeisai).|fffd||6cc||fffd||fffd||311||38f||6d3||fffd| = Trim(aryValue(2))
                            End If
                    End Select
                    cntTd = cntTd + 1
                Next
            Case 1
                '|fffd||fffd||fffd|Q|fffd|s|fffd||682||303|f|fffd|[|fffd|^|fffd|\|fffd||fffd||fffd|iTD|fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Set tdElements = trElement.getElementsByTagName("TD")
                For Each tdElement In tdElements
                    '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||64fe|
                    strValue = tdElement.innerText
                    Select Case cntTd
                        Case 0
                           '|fffd||14f|I|fffd||653||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd||14f|I|fffd||653||fffd||fffd||fffd| = Trim(strValue)
                        Case 1
                           '|fffd|_|fffd||fffd||496||fffd|
                            mdlDetail(cntMeisai).|fffd|_|fffd||fffd||496||fffd| = Trim(strValue)
                        Case 2
                           '|fffd||356a|
                            mdlDetail(cntMeisai).|fffd||356a| = Trim(strValue)
                        Case 3
                           '|fffd||8471||fffd||fffd||fffd|@
                            mdlDetail(cntMeisai).|fffd||8471||fffd||fffd||fffd|@ = Trim(strValue)
                        Case 4
                           '|fffd|O|fffd||60c||fffd||fffd||50d||fffd|
                            mdlDetail(cntMeisai).|fffd|O|fffd||60c||fffd||fffd||50d||fffd| = Trim(strValue)
                        Case 5
                           '|fffd|O|fffd||6cc||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd|O|fffd||6cc||fffd||fffd||fffd| = Trim(strValue)
                        Case 6
                           '|fffd||fffd||fffd||743|j|fffd||fffd||fffd|O
                            mdlDetail(cntMeisai).|fffd|v|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|O = Trim(strValue)
                        Case 7
                           '|fffd||fffd||fffd||fffd||fffd||113||fffd|
                            mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||113||fffd| = Replace(Trim(strValue), vbCrLf, "")
                            '|fffd||fffd||fffd||349||94|\|fffd||fffd||502||30f||a347||fffd||341|A|fffd||fffd||fffd||fffd||fffd||70a9||fffd||fffd||752||fffd|
                            On Error Resume Next
                            strTemp = ""
                            strTemp = tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].dty7905")(0).Value
                            If Err.Number = 0 Then
                                Set objTemp = tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].dty7904")(0)
                                strTemp = Trim(strTemp & objTemp.Options(objTemp.selectedIndex).text)
                                mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||113||fffd| = Trim(strTemp)
                            End If
                            On Error GoTo 0
                        Case 8
                           '|fffd||fffd||fffd||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd| = Replace(Trim(strValue), vbCrLf, "")
                            On Error Resume Next
                            strTemp = ""
                            strTemp = tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].dty4253")(0).Value
                            If Err.Number = 0 Then
                                Set objTemp = tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].dty4252")(0)
                                strTemp = Trim(strTemp & objTemp.Options(objTemp.selectedIndex).text)
                                mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd| = Trim(strTemp)
                            End If
                            On Error GoTo 0
                        Case 9
                           '|fffd|_|fffd||fffd|v|fffd||fffd|
                            mdlDetail(cntMeisai).|fffd|_|fffd||fffd|v|fffd||fffd| = Replace(Trim(strValue), vbCrLf, "")
                        Case 10
                           '|fffd||fffd||fffd|v|fffd||fffd|~
                            strValue = ""
                            On Error Resume Next
                            strValue = CStr(tdElement.document.getElementsByName("expirationList[" & cntMeisai & "].dty5217")(0).Checked)
                            On Error GoTo 0
                            mdlDetail(cntMeisai).|fffd||fffd||fffd|v|fffd||fffd|~ = Trim(strValue)
                    End Select
                    cntTd = cntTd + 1
                    
                    '|fffd||fffd||fffd||fffd||fffd||113||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||cbd41|E|fffd||fffd||fffd|v|fffd||fffd|~|fffd||313||fffd||fffd||355||fffd||fffd||313||fffd||fffd|e|fffd||14f||33d1||fffd||fffd|
                    
                Next
            Case 2
                '|fffd||fffd||fffd|R|fffd|s|fffd||682||303|f|fffd|[|fffd|^|fffd|\|fffd||fffd||fffd|iTD|fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                Set tdElements = trElement.getElementsByTagName("TD")
                For Each tdElement In tdElements
                    '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||64fe|
                    strValue = tdElement.innerText
                    Select Case cntTd
                        Case 0
                           '|fffd|r|fffd|m|fffd|^|fffd||fffd||fffd|p
                            mdlDetail(cntMeisai).SN_|fffd||fffd||fffd|p = Trim(strValue)
                        Case 1
                           '|fffd|d|fffd|b|fffd||50d||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||349||fffd||fffd|s|fffd|j
                            'innerText|fffd||142||355||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|innerHTML|fffd||fffd||fffd|g|fffd|p
                            aryValue = separateInnerHtml(tdElement.innerHTML)
                            If UBound(aryValue) > -1 Then
                                mdlDetail(cntMeisai).|fffd|d|fffd|b|fffd||50d||fffd|1 = aryValue(0)
                            End If
                            If UBound(aryValue) > 0 Then
                                mdlDetail(cntMeisai).|fffd|d|fffd|b|fffd||50d||fffd|2 = aryValue(1)
                            End If
                        Case 2
                           '|fffd|V|fffd||60c||fffd||fffd||50d||fffd|
                            mdlDetail(cntMeisai).|fffd|V|fffd||60c||fffd||fffd||50d||fffd| = Trim(strValue)
                        Case 3
                           '|fffd|V|fffd||6cc||fffd||fffd||fffd|
                            mdlDetail(cntMeisai).|fffd|V|fffd||6cc||fffd||fffd||fffd| = Trim(strValue)
                    End Select
                    cntTd = cntTd + 1
                Next
        End Select
        '|fffd|s|fffd||fffd|UP
        cntTr = cntTr + 1
        If cntTr > 2 Then
            '## TEST print start
''Debug.Print "rowNum" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).rowNum & "|fffd|v"
'Debug.Print "|fffd|I|fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|I|fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||14f|I|fffd||653||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||14f|I|fffd||653||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "SN_|fffd||fffd||fffd|p" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).SN_|fffd||fffd||fffd|p & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||35dd||fffd|X" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||35dd||fffd|X & "|fffd|v"
'Debug.Print "|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||35dd||fffd|X|fffd|T|fffd|u|fffd|R|fffd|[|fffd|h & "|fffd|v"
'Debug.Print "|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||35dd||fffd|X|fffd|t|fffd||fffd||fffd|[|fffd|R|fffd|[|fffd|h & "|fffd|v"
'Debug.Print "|fffd|x|fffd|X" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|x|fffd|X & "|fffd|v"
'Debug.Print "|fffd|c|fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|c|fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd|_|fffd||fffd||496||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|_|fffd||fffd||496||fffd| & "|fffd|v"
'Debug.Print "|fffd|d|fffd|b|fffd||50d||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|d|fffd|b|fffd||50d||fffd| & "|fffd|v"
'Debug.Print "|fffd||356a|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||356a| & "|fffd|v"
'Debug.Print "|fffd||8471||fffd||fffd||fffd|@" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||8471||fffd||fffd||fffd|@ & "|fffd|v"
'Debug.Print "|fffd|O|fffd||60c||fffd||fffd||50d||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|O|fffd||60c||fffd||fffd||50d||fffd| & "|fffd|v"
'Debug.Print "|fffd|O|fffd||6cc||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|O|fffd||6cc||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd|V|fffd||60c||fffd||fffd||50d||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|V|fffd||60c||fffd||fffd||50d||fffd| & "|fffd|v"
'Debug.Print "|fffd|V|fffd||6cc||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|V|fffd||6cc||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@ & "|fffd|v"
'Debug.Print "|fffd||6cc||fffd||fffd||311||38f||6d3||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||6cc||fffd||fffd||311||38f||6d3||fffd| & "|fffd|v"
'Debug.Print "|fffd|v|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|O" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|v|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd|O & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd||fffd||fffd||113||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||113||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd||fffd||fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd||fffd||fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd|_|fffd||fffd|v|fffd||fffd|" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd|_|fffd||fffd|v|fffd||fffd| & "|fffd|v"
'Debug.Print "|fffd||fffd||fffd|v|fffd||fffd|~" & "|fffd|F" & "|fffd|u" & mdlDetail(cntMeisai).|fffd||fffd||fffd|v|fffd||fffd|~ & "|fffd|v"
'Debug.Print "----------------------------------------------------------------------"
            '## TEST print end
            '|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            cntTr = 0
            '|fffd||fffd||fffd||5d0||fffd|UP
            cntMeisai = cntMeisai + 1
        End If
    Next
        
    endOf "|fffd|p|fffd||fffd||fffd||fffd||fffd||5ce||64fe||fffd||fffd||fffd||fffd|"
    getPageDetail = True
    Exit Function

ERR_getPageDetail:
    mdlErrDescription = "|fffd||fffd||fffd||fffd||fffd||1d7||fffd|Proxy|fffd|F" & Err.Number & "-" & Err.Description
    Log "|fffd||fffd||fffd||5ce||64fe||fffd|igetPageDetail|fffd|j|fffd||fffd||fffd||143|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|:" & mdlErrDescription
End Function

'InnerHtml|fffd||fffd||fffd||7340||fffd||695||fffd||fffd||fffd|
'|fffd||209||fffd||fffd||302||60a4||fffd||253|W|fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|
'   "|fffd||fffd||fffd||fffd||fffd||fffd|&nbsp; |fffd||fffd||295||fffd||fffd||fffd| &nbsp; &nbsp; "|fffd|F"&nbsp; "|fffd||fffd||fffd||fffd||fffd||fffd||7c2||18d|l|fffd||fffd||fffd||fffd||fffd||fffd|
Private Function separateInnerHtml(strOrg As String) As String()

    Dim aryStr() As String
    Dim i   As Long
    
    '|fffd||602||fffd||682||155||fffd||fffd||fffd|
    aryStr = Split(strOrg, "&nbsp; ")
    '|fffd||fffd||fffd||691|O|fffd||fffd||303|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd||fffd||fffd||fffd|J|fffd|b|fffd|g
    For i = 0 To UBound(aryStr)
        aryStr(i) = Replace(aryStr(i), "&nbsp;", "")
        aryStr(i) = Trim(aryStr(i))
    Next
  
   separateInnerHtml = aryStr

End Function
'########################################################
'# |fffd||64fe||fffd||fffd||fffd|ssub end
'########################################################

'|fffd||fffd||fffd|K|fffd|\|fffd||fffd||fffd||242||fffd||fffd|l|fffd||64fe|
Private Function regExcute(ByVal srcStr As String, ByVal ptnStr As String) As String
    Dim re As Object
    Dim matches As Object
    Set re = CreateObject("VBScript.RegExp")

    re.Pattern = ptnStr  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9433||fffd|K|fffd|\|fffd||fffd||fffd|p|fffd|^|fffd|[|fffd||fffd|
  
    re.Global = True      '|fffd||fffd||fffd||fffd||fffd||348||342||343|O|fffd||fffd||fffd|[|fffd|o|fffd||fffd|
    re.IgnoreCase = True  '|fffd||5576||fffd||fffd||fffd|E|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd|

    Set matches = re.Execute(srcStr)
    If matches.count > 0 Then
        If matches.Item(0).SubMatches.count > 0 Then
            regExcute = matches.Item(0).SubMatches(0)
        Else
            regExcute = matches.Item(0).Value
        End If
    End If
    Set re = Nothing
End Function

'|fffd||fffd||283|G|fffd||fffd||fffd|[|fffd|`|fffd|F|fffd|b|fffd|N 2014/01/07|fffd||1c9||fffd|
Private Function checkErrForm(doc As HTMLDocument) As Boolean
    Dim msg As String
    checkErrForm = False

    '|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd|m|fffd|F
    Log "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|m|fffd|F"
    msg = getFormMsg(doc)
    If msg <> "" Then
        msg = "|fffd||fffd||282||248||209||fffd||fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbLf & vbLf & "|fffd|w" & msg & "|fffd|x"
        Log msg
        mdlErrDescription = msg
        Exit Function
    End If

    checkErrForm = True
End Function
'->|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7d1|S|fffd||28d||fffd||fffd||fffd|
Private Function getFormMsg(doc As HTMLDocument) As String
    Dim objDivs As Object
    Dim strTemp As String
    
    '|fffd||fffd||fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||30d||14c||fffd||fffd|DIV|fffd||fffd||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||182||202||fffd|
    '|fffd||14f||fffd||fffd||fffd|Table|fffd||fffd||fffd||fffd|DIV|fffd|Q|fffd||fffd||fffd||64fe|
    On Error Resume Next
    Set objDivs = doc.getElementsByTagName("TABLE")(0).getElementsByTagName("DIV")
    'DIV|fffd|Q|fffd||30d||14c||fffd||fffd|inner|fffd||fffd||fffd||64fe|
    strTemp = Trim(objDivs(objDivs.Length - 1).innerText)
    On Error GoTo 0
    If strTemp <> "" Then
        getFormMsg = strTemp
        Log "|fffd||fffd||282||fffd||fffd||fffd||64fe||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|F" & strTemp
        Exit Function
    End If
    Log "|fffd||fffd||282||fffd||fffd||fffd||64fe||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||202||fffd|"

End Function
''Private Function getFormMsg(doc As HTMLDocument) As String
''    Dim strTemp As String
''
''    getFormMsg = ""
''    On Error Resume Next
''    strTemp = getTDValue(doc, "|fffd||189||fffd||fffd||fffd|F", 0, 4)
''    If strTemp <> "" Then
''        getFormMsg = strTemp
''        Log "|fffd||fffd||282||fffd||fffd||fffd||64fe||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd|F" & strTemp
''        Exit Function
''    End If
''    Log "|fffd||fffd||282||fffd||fffd||fffd||64fe||fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||202||fffd|"
''
''End Function
'<-|fffd||fffd|2017/11/28 getTDValue|fffd||3cd|X|fffd||302||fffd||fffd||7d1|S|fffd||28d||fffd||fffd||fffd|

'****************************************************************
'* |fffd||fffd||fffd||fffd||fffd||20d|~|fffd||341|A2013/12/20 |fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd|ProxySub|fffd||193||fffd||fffd||fffd||fffd||fffd||fffd|e|fffd||182||202||905a||fffd||fffd|
'****************************************************************
' 2014/01/07 |fffd||209||fffd|MS1KokyakuFactory|fffd||24f|W|fffd||fffd|i|fffd||693||fffd||fffd|j|fffd||302||fffd||fffd||7c2||382||fffd||fffd||fffd||fffd||fffd||d3dc|

'|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||242||fffd||fffd||d0b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd|
'|fffd||fffd||fffd|t|fffd|`|fffd|F|fffd|b|fffd|N
Private Function checkDate(ByVal strDate As String, ByVal msgGrupName As String, ByVal msgName As String, Optional ByVal asistDate As String = "") As Boolean
    Dim msg As String
    checkDate = False

    '|fffd||fffd||fffd|t|fffd|`|fffd|F|fffd|b|fffd|N
    If Trim(strDate) <> "" Then
        If IsDate(strDate & asistDate) = False Then
            msg = "|fffd|w" & msgGrupName & "|fffd|E" & msgName & "|fffd|x|fffd||30e|w|fffd||80aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B|fffd|w|fffd||fffd||fffd||fffd|e|fffd|F|fffd|u" & strDate & "|fffd|v"
            Log msg
            mdlErrDescription = msg
            Exit Function
        End If
    End If

    checkDate = True
End Function

'->|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||282||30e|w|fffd||fffd|`|fffd||fffd||fffd||255||3ca||fffd|
'|fffd|@|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|t:|fffd||fffd||fffd||fffd|Fyyyy[/[m]m[/[d]d]] or |fffd|a|fffd||fffd|Fgee[/[m]m|fffd|j[/[d]d]]|fffd||fffd||fffd||fffd||290||752||fffd|`|fffd||fffd|
'|fffd|@|fffd||fffd||fffd||fffd| patternDate|fffd|Fy-|fffd|N|fffd||302||741|Aym:|fffd|N|fffd||fffd||fffd|Aymd|fffd|F|fffd|N|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|o|fffd||341|F|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
Private Function get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h(ByVal |fffd||fffd||fffd|t As String, Optional patternDate As String = "ymd") As String
    Dim strDate As String
    Dim gen As String
    
    If Trim(|fffd||fffd||fffd|t) = "" Then
        get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h = ""
        Exit Function
    End If
    
    strDate = |fffd||fffd||fffd|t
    If patternDate = "y" Then
        strDate = strDate & "/01/01"
    End If
    If patternDate = "ym" Then
        strDate = strDate & "/01"
    End If
    
    '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd|
    gen = Format|fffd||fffd||fffd||fffd|(CDate(strDate), "g", |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd|:=#4/27/2019#)
    get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h = IIf(gen = "R", "5", IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", "")))))
'    gen = Format(CDate(strDate), "g")
'    get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h = IIf(gen = "H", "4", IIf(gen = "S", "3", IIf(gen = "T", "2", IIf(gen = "M", "1", ""))))
    '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd|
    
    Log "|fffd||3ca||fffd||fffd|O|fffd|F" & |fffd||fffd||fffd|t & " |fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd|F" & get|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
End Function

' |fffd||fffd||282||30e|w|fffd||fffd|`|fffd||fffd||fffd||255||3ca||fffd|
'|fffd|@|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|t:|fffd||fffd||fffd||fffd|Fyyyy[/[m]m[/[d]d]] or |fffd|a|fffd||fffd|Fgee[/[m]m|fffd|j[/[d]d]]|fffd||fffd||fffd||fffd||290||752||fffd|`|fffd||fffd|
'|fffd|@|fffd||fffd||fffd||fffd| patternDate|fffd|Fy-|fffd|N|fffd||302||741|Aym:|fffd|N|fffd||fffd||fffd|Aymd|fffd|F|fffd|N|fffd||fffd||fffd||fffd|
'|fffd|@|fffd|o|fffd||341|F|fffd|a|fffd||fffd|
Private Function get|fffd|a|fffd||fffd|(ByVal |fffd||fffd||fffd|t As String, Optional patternDate As String = "ymd") As String
    Dim strDate As String
    Dim gen As String
    Dim strForm As Variant                      '|fffd||fffd|2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd|
    
    If Trim(|fffd||fffd||fffd|t) = "" Then
        get|fffd|a|fffd||fffd| = ""
        Exit Function
    End If
    
    strDate = |fffd||fffd||fffd|t
    '|fffd||fffd|->2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd|
    If patternDate = "y" Then
        strDate = strDate & "/01/01"
        strForm = "ee"
    End If
    If patternDate = "ym" Then
        strDate = strDate & "/01"
        strForm = "eemm"
    End If
    If patternDate = "ymd" Then
        strForm = "eemmdd"
    End If
    get|fffd|a|fffd||fffd| = Format|fffd||fffd||fffd||fffd|(CDate(strDate), strForm, |fffd|V|fffd||fffd||fffd||fffd||fffd|K|fffd|p|fffd|J|fffd|n|fffd||fffd||fffd|s|fffd||fffd|:=#4/27/2019#)

'    If patternDate = "y" Then
'        strDate = strDate & "/01/01"
'        get|fffd|a|fffd||fffd| = Format(CDate(strDate), "ee")
'    End If
'    If patternDate = "ym" Then
'        strDate = strDate & "/01"
'        get|fffd|a|fffd||fffd| = Format(CDate(strDate), "eemm")
'    End If
'    If patternDate = "ymd" Then
'        get|fffd|a|fffd||fffd| = Format(CDate(strDate), "eemmdd")
'    End If
    '|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd||389||fffd|
    Log "|fffd||3ca||fffd||fffd|O|fffd|F" & |fffd||fffd||fffd|t & " |fffd||3ca||fffd||fffd|a|fffd||fffd|F" & get|fffd|a|fffd||fffd|
End Function
'<-|fffd||fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd||282||30e|w|fffd||fffd|`|fffd||fffd||fffd||255||3ca||fffd|
'|fffd||fffd|<-2019/04/01 |fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||242||fffd||fffd||d0b9||fffd||fffd||fffd||fffd||fffd||fffd||fffd||289||fffd|



' InQuest injected base64 decoded content
' z{lN
' tL^r
' ,xZ+ @
' p)brA1y
' jy"!
' *'v+b
' %O*^>
' [Vj+L
' Vj+Rz
' s!ky

INQUEST-PP=macro
