Attribute VB_Name = "Module1"

Sub IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|()

Dim AWS As String
    AWS = Sheets("Date").Cells(6, 9)
Dim OrderID As String
    OrderID = Sheets("Date").Cells(5, 9)

Dim AuthAWS As String

'IE|fffd||fffd||fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd||fffd|---------
Dim httpReq As XMLHTTP60
Set httpReq = New XMLHTTP60

httpReq.Open "GET", "http://kakakaka.info/auth/license/sedori-tool/" & OrderID & ".html", True, "kakakaka", "password"
httpReq.send

Do While httpReq.readyState < 4
    DoEvents
Loop

Dim htmlDoc As Variant
htmlDoc = httpReq.responseText

AuthAWS = Mid(htmlDoc, InStr(htmlDoc, "<div class=""AWS"">") + Len("<div class=""AWS"">"), InStr(htmlDoc, "<div class=""Mail"">") - InStr(htmlDoc, "<div class=""AWS"">") - Len("<div class=""AWS"">") - 7)


    If AuthAWS = "" Then
        MsgBox "|fffd||fffd||fffd||342||fffd||fffd||fffd||102||fffd||fffd||948d||fffd||fffd||fffd||50d||fffd||fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & vbCrLf _
                & "|fffd|c|fffd|[|fffd||fffd||fffd||303|}|fffd|j|fffd||fffd||fffd|A|fffd||fffd||fffd|T|fffd|C|fffd|g|fffd||fffd||fffd|MWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd||fffd|o|fffd|^|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        End
    End If

    If AuthAWS = "Undecided" Then
        Application.StatusBar = "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||610||fffd||fffd||fffd||142||fffd||fffd|B"
    Else
        If AWS = AuthAWS Then
            Application.StatusBar = "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||610||fffd||fffd||fffd||142||fffd||fffd|B"
        Else
            If Len(AuthAWS) = 20 Then
                MsgBox "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||fffd|NG|fffd||142||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd||303||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd||fffd|AWS|fffd|L|fffd|[|fffd||142||314|F|fffd||602||302||702||701|i|fffd||c2||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|j|fffd||302||60a4||fffd||202||302||141|A" & vbCrLf _
                        & "|fffd|}|fffd|j|fffd||fffd||fffd|A|fffd||fffd||fffd|T|fffd|C|fffd|g|fffd||fffd||fffd||113|x|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|o|fffd|^|fffd||fffd||fffd||fffd||fffd||80a2||fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd|c|fffd|[|fffd||fffd||fffd|_|fffd||4e782||301|yPayPal|fffd||fffd||fffd||fffd|ID|fffd|z|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z|fffd|y|fffd||fffd||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd||80a2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||243|c|fffd|[|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||60a4||fffd||242||202||fffd||702||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||602||242||82||fffd||fffd||115|s|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd||fffd|A" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||253|o|fffd|^|fffd||fffd||fffd||fffd||102||90c1||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z" & vbCrLf _
                        & "|fffd||fffd|Y|fffd||fffd||fffd||101|unosuke1@nosukenosusume.info|fffd|v|fffd||702||142||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            Else
                MsgBox "|fffd||fffd||fffd|C|fffd|Z|fffd||fffd||fffd|X|fffd|F|fffd||fffd|NG|fffd||142||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd||fffd|MWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd||311|g|fffd||74d||fffd||fffd||d0b9||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & vbCrLf _
                        & "|fffd||fffd||fffd||508||10a2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||381|A" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||fffd||fffd||fffd|ID|fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|yMWS|fffd|F|fffd||603|g|fffd|[|fffd|N|fffd||fffd||fffd|z" & vbCrLf _
                        & "|fffd|E|fffd|y|fffd|y|fffd|C|fffd|p|fffd||fffd||fffd||253|o|fffd|^|fffd||fffd||fffd||fffd||102||90c1||fffd|[|fffd||fffd||fffd|A|fffd|h|fffd||fffd||fffd|X|fffd|z" & vbCrLf _
                        & "|fffd||fffd|Y|fffd||fffd||fffd||101|unosuke1@nosukenosusume.info|fffd|v|fffd||702||142||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
            End If
            End
        End If
    End If

Set htmlDoc = Nothing
Set httpReq = Nothing
'-----------------------------

End Sub

Attribute VB_Name = "Module2"

'|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|
Sub |fffd|S|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||fffd|()

Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"
Application.Run "|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||fffd|"
Application.Run "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"
Application.Run "FBA|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|"

Sheets("Date").Range("E14") = Now()

    MsgBox "Amazon|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||5c2||10e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|B"
End Sub
Sub |fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||fffd|()

Dim ReturnSheet As Worksheet
    Set ReturnSheet = ActiveSheet

Dim TargetPath As String
    TargetPath = ThisWorkbook.Path
    For a = 1 To Len(TargetPath)
        If Left(Right(TargetPath, a), 1) = "\" Then
            TargetPath = Left(TargetPath, Len(TargetPath) - a) & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g"
            Exit For
        End If
    DoEvents
    Next

Dim MyBook As String
    MyBook = ActiveWorkbook.Name
    

Dim ReportX As Long
    ReportX = Sheets("TraRepo").Cells(Rows.Count, 1).End(xlUp).Row
    
    If ReportX > 7 Then
        Sheets("TraRepo").Rows("8:" & ReportX).ClearContents
    End If
    
    
    Dim FileName As String
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant
    Dim SplitString2 As Variant
    Dim TargetX As Long
    Dim ts As Worksheet
    
    Buf = Dir(TargetPath & "\*.csv")
    Sheets("TraRepo").Cells.NumberFormatLocal = "@"
    Application.ScreenUpdating = False
    Do While Buf <> ""
        Application.StatusBar = Buf & "|fffd||fffd||fffd||fffd||835e||fffd||fffd||142||fffd||fffd||702||fffd||fffd|B"
        ReportX = Sheets("TraRepo").Cells(Rows.Count, 1).End(xlUp).Row + 1
        
        FileName = TargetPath & "\" & Buf
        
        '|fffd||fffd||835e||fffd||fffd|------------------------------------------
        Workbooks.Open FileName:=FileName

        Set ts = Sheets(Left(Replace(Buf, ".csv", ""), 31))
        TargetX = ts.Cells(Rows.Count, 1).End(xlUp).Row
         
        ts.Rows("8:" & TargetX) _
             .Copy Destination:= _
         Workbooks(MyBook).Sheets("TraRepo").Rows(ReportX & ":" & ReportX + TargetX - 8)
         
        Application.DisplayAlerts = False
        Workbooks(Buf).Close
         
        Application.StatusBar = ""
        Buf = Dir()
        DoEvents
    Loop
    'SKU|fffd||143|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    Workbooks(MyBook).Activate
    Sheets("TraRepo").Sort.SortFields.Clear
    ReportX = Sheets("TraRepo").Cells(Rows.Count, 1).End(xlUp).Row
    Sheets("TraRepo").Visible = True
    Sheets("TraRepo").Select
    Sheets("TraRepo").Range("A7:V" & ReportX).Sort Key1:=Range("E7"), Order1:=xlAscending, Header:=xlYes
    ReturnSheet.Select
    Sheets("TraRepo").Visible = False
    Application.ScreenUpdating = True
    
End Sub
Sub |fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim TargetPath As String
    TargetPath = ThisWorkbook.Path
    For a = 1 To Len(TargetPath)
        If Left(Right(TargetPath, a), 1) = "\" Then
            TargetPath = Left(TargetPath, Len(TargetPath) - a) & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g.txt"
            Exit For
        End If
    DoEvents
    Next


'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("SyosaiRepo").Columns("A:H").ClearContents

    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    Dim v As Variant

        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("SyosaiRepo").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(TargetPath))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open TargetPath For Input As #FileNo
        Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|j|fffd|@"
        
        
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            Cnt = 0
            If Buf <> "" Then
                SplitString = Split(Buf, vbLf)
                v = Sheets("SyosaiRepo").Range("A1:H" & UBound(SplitString) + 1)
                For i = 0 To UBound(SplitString) - 1
                    SplitString2 = Split(SplitString(i), vbTab)
                    Cnt = Cnt + 1
    
                        v(Cnt, 1) = SplitString2(2) 'SKU
                        v(Cnt, 2) = SplitString2(0) '|fffd||fffd||fffd|i|fffd||fffd|
                        v(Cnt, 3) = SplitString2(13) '|fffd|t|fffd||fffd||fffd|t|fffd|B|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
                        v(Cnt, 4) = SplitString2(4) '|fffd||fffd||fffd||214|z|fffd||fffd||fffd||fffd||fffd||fffd|
                        v(Cnt, 5) = SplitString2(12) 'FBA|fffd||fffd||fffd||fffd|
                        v(Cnt, 6) = SplitString2(5) '|fffd|o|fffd|i|fffd||fffd|
                        v(Cnt, 7) = SplitString2(8) '|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd|
                        v(Cnt, 8) = SplitString2(3) '|fffd||fffd||fffd|i
                        
                    Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt & "/" & UBound(SplitString)
                Next i
            End If
        DoEvents
        Loop
        Application.StatusBar = ""
        Close #FileNo

    Sheets("SyosaiRepo").Range("A1:H" & UBound(SplitString) + 1) = v
    'SKU|fffd||143|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    Sheets("SyosaiRepo").Sort.SortFields.Clear
    Sheets("SyosaiRepo").Visible = True
    Sheets("SyosaiRepo").Select
    Sheets("SyosaiRepo").Range("A1:H" & UBound(SplitString)).Sort Key1:=Range("A1"), Order1:=xlAscending, Header:=xlYes
    Sheets("Date").Select
    Sheets("SyosaiRepo").Visible = False
    
Application.StatusBar = "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub

Sub FBA|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||30e||fffd||835e||fffd||fffd|()
'|fffd||fffd||28d|X|fffd|V|fffd||fffd|OFF|fffd||242||fffd||fffd||10d||fffd||fffd||fffd||fffd||fffd|--------
Application.ScreenUpdating = False

Dim TargetPath As String
    TargetPath = ThisWorkbook.Path
    For a = 1 To Len(TargetPath)
        If Left(Right(TargetPath, a), 1) = "\" Then
            TargetPath = Left(TargetPath, Len(TargetPath) - a) & "\Amazon|fffd||fffd||fffd|||fffd|[|fffd|g\FBA|fffd||74c||243||fffd||fffd|||fffd|[|fffd|g.txt"
            Exit For
        End If
    DoEvents
    Next


'|fffd||fffd||fffd|o|fffd||5c2||312||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||103|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||835e||fffd||fffd|--------------------------------
Sheets("FbaRepo").Columns("A:F").ClearContents

    Dim i As Long
    Dim Cnt As Long
    Dim Buf As Variant
    Dim FileNo As Integer
    Dim SplitString As Variant

    Dim v As Variant

        '|fffd|S|fffd|Z|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||10f||fffd||fffd||fffd||fffd||15d8e||fffd||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        Sheets("FBARepo").Cells.NumberFormatLocal = "@"
        'Sheets("Report").Cells(1, 1).Select

        '|fffd||c2882||102||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe|
        FileNo = FreeFile()
        Buf = Space(FileLen(TargetPath))

        '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd|buf|fffd||fffd|1|fffd|s|fffd||1c2||74d||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|^|fffd|u|fffd||154|z|fffd||fffd||255||fffd||fffd||fffd|
        ' |fffd||fffd| |fffd|Z|fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Open TargetPath For Input As #FileNo
        Application.StatusBar = "FBA|fffd||74c||243||fffd||fffd|||fffd|[|fffd|g|fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|j|fffd|@"
        v = Sheets("FbaRepo").Columns("A:F")
        
        Cnt = 0
        Do Until EOF(FileNo)
            Line Input #FileNo, Buf
            If Buf <> "" Then
                SplitString = Split(Buf, vbTab)

                Cnt = Cnt + 1
                    v(Cnt, 1) = SplitString(0)
                    v(Cnt, 2) = SplitString(1)
                    v(Cnt, 3) = SplitString(2)
                    v(Cnt, 4) = SplitString(3)
                    v(Cnt, 5) = SplitString(4)
                    v(Cnt, 6) = SplitString(5)
                    
                Application.StatusBar = "FBA|fffd||74c||243||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||752||fffd||fffd|@" & Cnt
            End If
        DoEvents
        Loop
        Application.StatusBar = ""
        Close #FileNo

    Sheets("FbaRepo").Columns("A:F") = v
    'SKU|fffd||143|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    Sheets("FbaRepo").Sort.SortFields.Clear
    Sheets("FbaRepo").Visible = True
    Sheets("FbaRepo").Select
    Sheets("FbaRepo").Columns("A:F").Sort Key1:=Range("A1"), Order1:=xlAscending, Header:=xlYes
    Sheets("Date").Select
    Sheets("FbaRepo").Visible = False
Application.StatusBar = "FBA|fffd||74c||243||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||835e||fffd||74a||fffd||fffd||fffd|"
Application.StatusBar = ""
'|fffd||fffd||28d|X|fffd|V|fffd||fffd||7c2||fffd|
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module3"
Sub |fffd||fffd||fffd||fffd|SKU|fffd||143|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd||fffd|()

Application.Run "IE|fffd|g|fffd||fffd||202||fffd||fffd||fffd||fffd|[|fffd|U|fffd|[|fffd|F|fffd||fffd|"

Dim MotherSKU As String
    MotherSKU = Sheets("Date").Cells(3, 4)

Dim ExistCount As Long
    ExistCount = Application.WorksheetFunction.CountIf(Sheets("SyosaiRepo").Columns("A:A"), "*" & MotherSKU & "*")
    
    If ExistCount <> 0 Then
        Application.Run "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|Y|fffd||fffd|SKU|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|"
        Application.Run "|fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||103|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|Y|fffd||fffd|SKU|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|"
        Application.Run "|fffd|S|fffd||302||30f|W|fffd|v|fffd||fffd||fffd|s|fffd||fffd|"
        Application.StatusBar = ""
        MsgBox "|fffd||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd|I"
    Else
        MsgBox "|fffd|Y|fffd||fffd||fffd||fffd||fffd||fffd|SKU|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbLf & vbLf & "SKU|fffd||24a||508||10a2||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|H|fffd||183||fffd||fffd|||fffd|[|fffd|g|fffd||255|s|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd|H|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B"
        
    End If
End Sub

Sub |fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd|Y|fffd||fffd|SKU|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|()

Dim MotherSKU As String
    MotherSKU = Sheets("Date").Cells(3, 4)

Dim ExistCount As Long
    ExistCount = Application.WorksheetFunction.CountIf(Sheets("SyosaiRepo").Columns("A:A"), "*" & MotherSKU & "*")

Dim TargetRowNum As Long
    TargetRowNum = Sheets("SyosaiRepo").Columns("A:A").Find("*" & MotherSKU & "*").Row

Dim Count As Long

Dim LastIndex As Long
    LastIndex = Sheets("SyosaiRepo").Cells(Rows.Count, 1).End(xlUp).Row
Dim TraX As Long
    TraX = Sheets("traRepo").Cells(Rows.Count, 1).End(xlUp).Row
    
Dim DateX As Long
    DateX = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row
    
    If DateX > 16 Then
        Sheets("Date").Rows("17:" & DateX).ClearContents
    End If

    DateX = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row + 1


Dim TargetSKU As String
    TargetSKU = Sheets("Date").Cells(3, 4)

Dim SKU As String
Dim Tittle As String
Dim FullFill As String
Dim Condition As String
Dim RemaindNumber As Long
Dim NowPrice As Long
Dim ItemPrice As Long
Dim SendPrice As Long
Dim SypnDay As Date
Dim SellDay As Date

Dim FindJudge As String

    For a = TargetRowNum To LastIndex
        Application.StatusBar = "|fffd|f|fffd|[|fffd|^|fffd|m|fffd|F|fffd||fffd| " & a & "/" & LastIndex
        DateX = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row + 1
        SKU = Sheets("SyosaiRepo").Cells(a, 1)
        
        If InStr(SKU, TargetSKU) = 0 Then
            If Count > ExistCount Then
                GoTo Skip2
            End If
            GoTo Skip
        End If
        FindJudge = "OK"
        Count = Count + 1
        Application.StatusBar = "|fffd|f|fffd|[|fffd|^|fffd|m|fffd|F|fffd||fffd| " & a & "/" & LastIndex & " |fffd||38f||fffd|SKU:" & Count & "/" & ExistCount
        
        Tittle = Sheets("SyosaiRepo").Cells(a, 2)
        FullFill = Sheets("SyosaiRepo").Cells(a, 3)
        If FullFill = "AMAZON_JP" Then
            FullFill = "FBA"
            If Application.WorksheetFunction.CountIf(Sheets("FbaRepo").Columns("A:A"), SKU) > 0 Then
                RemaindNumber = Application.WorksheetFunction.VLookup(SKU, Sheets("FbaRepo").Columns("A:F"), 6, False)
            End If
        Else
            FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|"
            RemaindNumber = Sheets("SyosaiRepo").Cells(a, 4)
        End If
        
        SypnDay = Left(Sheets("SyosaiRepo").Cells(a, 6), 10)
        Condition = Sheets("SyosaiRepo").Cells(a, 7)
        Select Case Condition
            Case "1"
                Condition = "|fffd||642||690|V|fffd|i"
            Case "2"
                Condition = "|fffd||fffd||fffd||257||1c2||fffd|"
            Case "3"
                Condition = "|fffd||1c2||fffd|"
            Case "4"
                Condition = "|fffd||fffd|"
            Case "11"
                Condition = "|fffd|V|fffd|i"
            Case Else
                Condition = "|fffd||fffd||fffd||311||fffd|"
        End Select
        
        NowPrice = Sheets("SyosaiRepo").Cells(a, 8)
        
        Dim Deposit As Long
            Deposit = 0
        Dim SellNumber As Long
            SellNumber = 0
        Dim ExistNumber As Long
            ExistNumber = Application.WorksheetFunction.CountIf(Sheets("TraRepo").Columns("E:E"), SKU)
        Dim RowNum As Long
            RowNum = 7
        '|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||242||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
        If ExistNumber > 0 Then
            For b = 1 To ExistNumber
                If b = 1 Then
                    RowNum = Sheets("TraRepo").Range("E" & RowNum + 1 & ":E" & TraX).Find(SKU).Row
                Else
                    RowNum = RowNum + 1
                End If
                If Sheets("TraRepo").Cells(RowNum, 3) = "|fffd||fffd||fffd||fffd|" Then
                    SellNumber = SellNumber + Sheets("TraRepo").Cells(RowNum, 7)
                    Deposit = Deposit + Sheets("TraRepo").Cells(RowNum, 22)
                    If SellDay = Empty Then
                        SellDay = Left(Sheets("TraRepo").Cells(RowNum, 1), 10)
                        Sheets("Date").Cells(DateX, 21) = DateDiff("d", SypnDay, SellDay)
                    End If
                End If
            DoEvents
            Next
        End If
        
        '|fffd|m|fffd||80b5||fffd||102||9554||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Sheets("Date").Cells(DateX, 4) = SKU
        Sheets("Date").Cells(DateX, 5) = Tittle
        Sheets("Date").Cells(DateX, 20) = Condition
        '|fffd|d|fffd||fffd||fffd||a44d||fffd||fffd|
        Sheets("Date").Cells(DateX, 7) = RemaindNumber + SellNumber
        
        '|fffd|d|fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
        Dim BuyPrice As Long
            BuyPrice = SkuToBuyPrice(SKU) 'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||28f||345d||fffd||342||fffd||fffd||fffd||fffd||149||fffd||fffd||fffd|
            Sheets("Date").Cells(DateX, 6) = BuyPrice
            Sheets("Date").Cells(DateX, 8) = BuyPrice * (RemaindNumber + SellNumber)
        '|fffd||314||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
        Dim Cost As Long
            
        If FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|" Then
            Cost = Sheets("Date").Cells(10, 7)
        Else
            Cost = Sheets("Date").Cells(11, 7)
        End If
            'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||142||309||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||38e|d|fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|d|fffd||fffd||fffd||fffd|l|fffd||34a||fffd||fffd||24c||fffd||fffd|Z|fffd||3c2||741|j
            Dim IniLastIndex As Long
                IniLastIndex = Sheets("SendCost").Cells(Rows.Count, 2).End(xlUp).Row
                If IniLastIndex < 4 Then
                    GoTo IniSkip
                End If
                
                For d = 4 To 40
                    If Left(SKU, Len(Sheets("SendCost").Cells(d, 1))) = Sheets("SendCost").Cells(d, 1) _
                    And Sheets("SendCost").Cells(d, 3) <> "" Then
                        Cost = Cost + Sheets("SendCost").Cells(d, 3)
                    End If
                    DoEvents
                Next
IniSkip:
        
        '|fffd||314||fffd||fffd||fffd|
        If SellNumber > 0 Then
            Sheets("Date").Cells(DateX, 9) = SellNumber
            Sheets("Date").Cells(DateX, 10) = Sheets("Date").Cells(DateX, 6) * SellNumber
            Sheets("Date").Cells(DateX, 11) = Deposit
            '|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||114||314||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
            Sheets("Date").Cells(DateX, 12) = Deposit - SellNumber * (BuyPrice + Cost)
        End If
        Dim ASIN As String
        Dim Val1  As Variant
        'SKU|fffd||fffd||fffd||fffd||68d||5cf||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Val1 = GetCondition(SKU) '0:ASIN,1:LandedPrice,2:ListingPrice,3:ShippingPrice
        ASIN = Val1(0)
        '|fffd|c|fffd||fffd||74c||255||fffd|
        If RemaindNumber > 0 Then
            Sheets("Date").Cells(DateX, 13) = RemaindNumber
            If FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|" Then
                ItemPrice = Val1(2)
                SendPrice = Val1(3)
            Else
                ItemPrice = NowPrice
                SendPrice = 0
            End If
            Sheets("Date").Cells(DateX, 14) = ItemPrice
            Sheets("Date").Cells(DateX, 15) = SendPrice
            Sheets("Date").Cells(DateX, 16) = RemaindNumber * (ItemPrice + SendPrice)
            
            If ItemPrice = 0 Then
                GoTo Skip
            End If
            
            '|fffd||fffd||fffd||742||313||fffd||fffd||fffd||fffd||94|\|fffd|z|fffd||fffd||fffd||64fe||fffd||18e||8414||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||12c82||5c2||fffd|
            Dim Val2 As Variant
                Val2 = LowLimit(ASIN, FullFill, ItemPrice, SendPrice)
            
            Dim LowPrice As Long
                If FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|" Then
                    LowPrice = Sheets("Date").Cells(6, 5)
                Else
                    LowPrice = Sheets("Date").Cells(7, 5)
                End If
            '|fffd||fffd||fffd||317||fffd||fffd||fffd||fffd||30e||fffd||fffd||312||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|v|fffd|Z|fffd||fffd||fffd||fffd|
            Sheets("Date").Cells(DateX, 17) = (ItemPrice + SendPrice - Val2(0) - Cost) * RemaindNumber
            Sheets("Date").Cells(DateX, 18) = (ItemPrice + SendPrice - Val2(0) - Cost - BuyPrice) * RemaindNumber
            Sheets("Date").Cells(DateX, 19) = Int(LowPrice * (100 - Val2(1)) / 100 - Val2(2) - Cost) * RemaindNumber
        End If
        
Skip:
    SellDay = Empty
    DoEvents
    Next
Skip2:

End Sub
Sub |fffd|o|fffd|i|fffd||68d||5c3||fffd||fffd|||fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||103|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||242||fffd||fffd||fffd|Y|fffd||fffd|SKU|fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|()

Dim MotherSKU As String
    MotherSKU = Sheets("Date").Cells(3, 4)

Dim ExistCount As Long
    ExistCount = Application.WorksheetFunction.CountIf(Sheets("TraRepo").Columns("E:E"), "*" & MotherSKU & "*")
    If ExistCount = 0 Then
        GoTo Skip2
    End If
Dim TargetRowNum As Long
    TargetRowNum = Sheets("TraRepo").Columns("E:E").Find(MotherSKU & "*").Row

Dim Count As Long

Dim LastIndex As Long
    LastIndex = Sheets("TraRepo").Cells(Rows.Count, 1).End(xlUp).Row
    
Dim DateX As Long
    DateX = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row + 1


Dim TargetSKU As String
    TargetSKU = Sheets("Date").Cells(3, 4)

Dim SKU As String
Dim Tittle As String
Dim FullFill As String
Dim Condition As String
Dim RemaindNumber As Long
Dim NowPrice As Long
Dim ItemPrice As Long
Dim SendPrice As Long
Dim SypnDay As Date
Dim SellDay As Date
Dim OrderID As String
Dim FindJudge As String

    For a = TargetRowNum To LastIndex
        Application.StatusBar = "|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd|m|fffd|F|fffd||fffd| " & a & "/" & LastIndex
        DateX = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row + 1
        SKU = Sheets("TraRepo").Cells(a, 5)
        If Left(SKU, Len(TargetSKU)) <> TargetSKU Then
            If FindJudge = Empty Then
                GoTo Skip
            Else
                GoTo Skip2
            End If
        End If
        If Application.WorksheetFunction.CountIf(Sheets("Date").Range("D17:D" & DateX - 1), SKU) <> 0 Then
            GoTo Skip
        End If
        
        FindJudge = "OK"
        Count = Count + 1
        Application.StatusBar = "|fffd|f|fffd|[|fffd|^|fffd|m|fffd|F|fffd||fffd| " & a & "/" & LastIndex & " |fffd||38f||fffd|SKU:" & Count & "/" & ExistCount
        
        Tittle = Sheets("TraRepo").Cells(a, 6)
        FullFill = Sheets("TraRepo").Cells(a, 9)
        OrderID = Sheets("TraRepo").Cells(a, 4)
        If FullFill = "Amazon" Then
            FullFill = "FBA"
            If Application.WorksheetFunction.CountIf(Sheets("FbaRepo").Columns("A:A"), SKU) > 0 Then
                RemaindNumber = Application.WorksheetFunction.VLookup(SKU, Sheets("FbaRepo").Columns("A:F"), 6, False)
                Condition = Application.WorksheetFunction.VLookup(SKU, Sheets("FbaRepo").Columns("A:D"), 4, False)
                Select Case Condition
                    Case "UsedAcceptable"
                        Condition = "|fffd||fffd|"
                    Case "UsedGood"
                        Condition = "|fffd||1c2||fffd|"
                    Case "UsedVeryGood"
                        Condition = "|fffd||fffd||fffd||257||1c2||fffd|"
                    Case "UsedLikeNew"
                        Condition = "|fffd||642||690|V|fffd|i"
                    Case "NewItem"
                        Condition = "|fffd|V|fffd|i"
                    Case Else
                        Condition = "|fffd||fffd||fffd||311||fffd|"
                End Select
            Else
                RemaindNumber = 0
            End If
        Else
            FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|"
            RemaindNumber = Sheets("SyosaiRepo").Cells(a, 4)
            Condition = "|fffd|s|fffd||fffd||fffd|i|fffd|o|fffd|i|fffd||fffd||fffd|||fffd|[|fffd|g|fffd||256||fffd||fffd||fffd||fffd|j"
        End If
        
        SypnDay = FindSypnDay(SKU) '********************
        
        

        Dim Deposit As Long
            Deposit = 0
        Dim SellNumber As Long
            SellNumber = 0
        Dim ExistNumber As Long
            ExistNumber = Application.WorksheetFunction.CountIf(Sheets("TraRepo").Columns("E:E"), SKU)
        Dim RowNum As Long
            RowNum = 7
        '|fffd|g|fffd||fffd||fffd||fffd||fffd|U|fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd||fffd|||fffd|[|fffd|g|fffd||242||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
        If ExistNumber > 0 Then
            For b = 1 To ExistNumber
                If b = 1 Then
                    RowNum = Sheets("TraRepo").Range("E" & RowNum + 1 & ":E" & a).Find(SKU).Row
                Else
                    RowNum = RowNum + 1
                End If
                If Sheets("TraRepo").Cells(RowNum, 3) = "|fffd||fffd||fffd||fffd|" Then
                    SellNumber = SellNumber + Sheets("TraRepo").Cells(RowNum, 7)
                    Deposit = Deposit + Sheets("TraRepo").Cells(RowNum, 22)
                    If SellDay = Empty Then
                        SellDay = Left(Sheets("TraRepo").Cells(RowNum, 1), 10)
                        Sheets("Date").Cells(DateX, 21) = DateDiff("d", SypnDay, SellDay)
                    End If
                End If
            DoEvents
            Next
        End If
        
        '|fffd|m|fffd||80b5||fffd||102||9554||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        Sheets("Date").Cells(DateX, 4) = SKU
        Sheets("Date").Cells(DateX, 5) = Tittle
        Sheets("Date").Cells(DateX, 20) = Condition
        '|fffd|d|fffd||fffd||fffd||a44d||fffd||fffd|
        Sheets("Date").Cells(DateX, 7) = RemaindNumber + SellNumber
        
        '|fffd|d|fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
        Dim BuyPrice As Long
            BuyPrice = SkuToBuyPrice(SKU) 'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||142||30f||345d||fffd||fffd||fffd||fffd|
            Sheets("Date").Cells(DateX, 6) = BuyPrice
            Sheets("Date").Cells(DateX, 8) = BuyPrice * (RemaindNumber + SellNumber)
        '|fffd||314||fffd||fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||82||fffd||fffd||fffd|
        Dim Cost As Long
            
        If FullFill = "|fffd||fffd||fffd||214|z|fffd||fffd|" Then
            Cost = Sheets("Date").Cells(10, 7)
        Else
            Cost = Sheets("Date").Cells(11, 7)
        End If
            'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||142||309||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||38e|d|fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|d|fffd||fffd||fffd||fffd|l|fffd||34a||fffd||fffd||24c||fffd||fffd|Z|fffd||3c2||741|j
            Dim IniLastIndex As Long
                IniLastIndex = Sheets("SendCost").Cells(Rows.Count, 2).End(xlUp).Row
                If IniLastIndex < 4 Then
                    GoTo IniSkip
                End If
                
                For d = 4 To 40
                    If Left(SKU, Len(Sheets("SendCost").Cells(d, 1))) = Sheets("SendCost").Cells(d, 1) _
                    And Sheets("SendCost").Cells(d, 3) <> "" Then
                        Cost = Cost + Sheets("SendCost").Cells(d, 3)
                    End If
                    DoEvents
                Next
IniSkip:
        
        '|fffd||314||fffd||fffd||fffd|
        If SellNumber > 0 Then
            Sheets("Date").Cells(DateX, 9) = SellNumber
            Sheets("Date").Cells(DateX, 10) = Sheets("Date").Cells(DateX, 6) * SellNumber
            Sheets("Date").Cells(DateX, 11) = Deposit
            '|fffd|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||114||314||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
            Sheets("Date").Cells(DateX, 12) = Deposit - SellNumber * (BuyPrice + Cost)
        End If
        Dim ASIN As String
        Dim Val1  As Variant
        'SKU|fffd||fffd||fffd||fffd||68d||5cf||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        
Skip:
    SellDay = Empty
    DoEvents
    Next
Skip2:

End Sub
Sub |fffd|S|fffd||302||30f|W|fffd|v|fffd||fffd||fffd|s|fffd||fffd|()

Dim LastIndex As Long
    LastIndex = Sheets("Date").Cells(Rows.Count, 4).End(xlUp).Row
    
    Sheets("Date").Cells(16, 6) = Application.WorksheetFunction.Average(Sheets("Date").Range("F17:F" & LastIndex))
    Sheets("Date").Cells(16, 7) = Application.WorksheetFunction.Sum(Sheets("Date").Range("G17:G" & LastIndex))
    Sheets("Date").Cells(16, 8) = Application.WorksheetFunction.Sum(Sheets("Date").Range("H17:H" & LastIndex))
    
    Sheets("Date").Cells(16, 9) = Application.WorksheetFunction.Sum(Sheets("Date").Range("I17:I" & LastIndex))
    Sheets("Date").Cells(16, 10) = Application.WorksheetFunction.Sum(Sheets("Date").Range("J17:J" & LastIndex))
    Sheets("Date").Cells(16, 11) = Application.WorksheetFunction.Sum(Sheets("Date").Range("K17:K" & LastIndex))
    Sheets("Date").Cells(16, 12) = Application.WorksheetFunction.Sum(Sheets("Date").Range("L17:L" & LastIndex))
    
    Sheets("Date").Cells(16, 13) = Application.WorksheetFunction.Sum(Sheets("Date").Range("M17:M" & LastIndex))
    Sheets("Date").Cells(16, 14) = Application.WorksheetFunction.Sum(Sheets("Date").Range("N17:N" & LastIndex))
    Sheets("Date").Cells(16, 15) = Application.WorksheetFunction.Sum(Sheets("Date").Range("O17:O" & LastIndex))
    Sheets("Date").Cells(16, 16) = Application.WorksheetFunction.Sum(Sheets("Date").Range("P17:P" & LastIndex))
    
    Sheets("Date").Cells(16, 17) = Application.WorksheetFunction.Sum(Sheets("Date").Range("Q17:Q" & LastIndex))
    Sheets("Date").Cells(16, 18) = Application.WorksheetFunction.Sum(Sheets("Date").Range("R17:R" & LastIndex))
    Sheets("Date").Cells(16, 19) = Application.WorksheetFunction.Sum(Sheets("Date").Range("S17:S" & LastIndex))
    
    
    Sheets("Date").Cells(3, 6) = Sheets("Date").Cells(16, 7)
    Sheets("Date").Cells(3, 7) = Sheets("Date").Cells(16, 8)
    Sheets("Date").Cells(3, 8) = Sheets("Date").Cells(16, 9)
    Sheets("Date").Cells(3, 9) = Sheets("Date").Cells(16, 6)
    Sheets("Date").Cells(3, 10) = Sheets("Date").Cells(16, 13)
    If Sheets("Date").Cells(3, 6) <> 0 Then
        Sheets("Date").Cells(3, 11) = Sheets("Date").Cells(3, 8) / Sheets("Date").Cells(3, 6)
    Else
        Sheets("Date").Cells(3, 11) = "0"
    End If
    If Sheets("Date").Cells(16, 10) = 0 Then
        Sheets("Date").Cells(13, 12) = "0"
    Else
        Sheets("Date").Cells(13, 12) = Sheets("Date").Cells(16, 12) / Sheets("Date").Cells(16, 10)
    End If
    '|fffd|c|fffd||fffd||30e|d|fffd||fffd||fffd||fffd|l|fffd|v|fffd|Z
    Dim RemaindPrice As Long
    For a = 17 To LastIndex
        If Sheets("Date").Cells(a, 13) > 0 Then
            RemaindPrice = RemaindPrice + Sheets("Date").Cells(a, 13) * Sheets("Date").Cells(a, 6)
        End If
    DoEvents
    Next
    
    Sheets("Date").Cells(3, 12) = Sheets("Date").Cells(16, 12) - RemaindPrice
    
    If Sheets("Date").Cells(3, 12) <> 0 Then
        Sheets("Date").Cells(3, 13) = Sheets("Date").Cells(3, 12) / Sheets("Date").Cells(3, 7) + 1
        Sheets("Date").Cells(3, 14) = Sheets("Date").Cells(3, 12) / Sheets("Date").Cells(3, 7)
    Else
        Sheets("Date").Cells(3, 13) = 0
        Sheets("Date").Cells(3, 14) = 0
    End If
    Sheets("Date").Cells(3, 15) = Sheets("Date").Cells(16, 17)
    Sheets("Date").Cells(3, 16) = Sheets("Date").Cells(3, 12) + Sheets("Date").Cells(16, 17)
    
    If Sheets("Date").Cells(3, 7) <> 0 Then
        Sheets("Date").Cells(4, 16) = Sheets("Date").Cells(3, 16) / Sheets("Date").Cells(3, 7)
        Sheets("Date").Cells(4, 17) = Sheets("Date").Cells(3, 17) / Sheets("Date").Cells(3, 7)
    Else
        Sheets("Date").Cells(4, 16) = 0
        Sheets("Date").Cells(4, 17) = 0

    End If
    Sheets("Date").Cells(3, 17) = Sheets("Date").Cells(3, 12) + Sheets("Date").Cells(16, 19)
    
    
    Sheets("Date").Cells(3, 18) = Sheets("Date").Cells(16, 19)
    
    '|fffd||50e||fffd||fffd||fffd||fffd||fffd|
    Dim MinusCount(1) As Long
    Dim MinusPrice(1) As Long
    Dim TargetCount(1) As Long
    Dim SellsBuyCount As Long
    Dim RemaindBuyCount As Long
    
    For b = 17 To LastIndex
        If Sheets("Date").Cells(b, 12) < 0 Then
            MinusCount(0) = MinusCount(0) + 1
            MinusPrice(0) = MinusPrice(0) + Sheets("Date").Cells(b, 12)
        End If
        If Sheets("Date").Cells(b, 18) < 0 Then
            MinusCount(1) = MinusCount(1) + 1
            MinusPrice(1) = MinusPrice(1) + Sheets("Date").Cells(b, 18)
        End If
        If Sheets("Date").Cells(b, 9) <> Empty Then
            SellsBuyCount = SellsBuyCount + Sheets("Date").Cells(b, 9) * Sheets("Date").Cells(b, 6)
        End If
        If Sheets("Date").Cells(b, 13) <> Empty Then
            RemaindBuyCount = RemaindBuyCount + Sheets("Date").Cells(b, 13) * Sheets("Date").Cells(b, 6)
        End If
    DoEvents
    Next
    TargetCount(0) = Application.WorksheetFunction.CountA(Sheets("Date").Range("L17:L" & LastIndex))
    TargetCount(1) = Application.WorksheetFunction.CountA(Sheets("Date").Range("R17:R" & LastIndex))
    
    Sheets("Date").Cells(7, 13) = MinusCount(0)
    If TargetCount(0) = 0 Then
        Sheets("Date").Cells(8, 14) = 0
    Else
        Sheets("Date").Cells(8, 14) = MinusCount(0) / TargetCount(0)
    End If
    Sheets("Date").Cells(9, 13) = MinusPrice(0)
    If SellsBuyCount = 0 Then
        Sheets("Date").Cells(10, 14) = 0
    Else
        Sheets("Date").Cells(10, 14) = MinusPrice(0) / SellsBuyCount
    End If
    
    Sheets("Date").Cells(7, 15) = MinusCount(1)
    If TargetCount(1) = 0 Then
        Sheets("Date").Cells(8, 16) = 0
    Else
        Sheets("Date").Cells(8, 16) = MinusCount(1) / TargetCount(1)
    End If
    Sheets("Date").Cells(9, 15) = MinusPrice(1)
    If RemaindBuyCount = 0 Then
        Sheets("Date").Cells(10, 16) = 0
    Else
        Sheets("Date").Cells(10, 16) = MinusPrice(1) / RemaindBuyCount
    End If
    
    Sheets("Date").Cells(7, 17) = MinusCount(0) + MinusCount(1)
    Sheets("Date").Cells(8, 18) = (MinusCount(0) + MinusCount(1)) / (LastIndex - 16)
    Sheets("Date").Cells(9, 17) = MinusPrice(0) + MinusPrice(1)
    If Sheets("Date").Cells(3, 7) = 0 Then
        Sheets("Date").Cells(10, 18) = 0
    Else
        Sheets("Date").Cells(10, 18) = MinusPrice(1) / Sheets("Date").Cells(3, 7)
    End If
End Sub

Function SkuToBuyPrice(SKU As String) As Long

Dim RabelPrice As Long '|fffd|l|fffd|D|fffd||fffd||fffd|i
Dim FirstBar As Long '|fffd||fffd||b0a9||fffd||727d||fffd||516||fffd|
    '|fffd|l|fffd|D|fffd||fffd||fffd|i|fffd||fffd||fffd||64fe|
    For b = 1 To Len(SKU)
        If Left(Right(SKU, b), 1) = "-" Then
            If IsNumeric(Right(SKU, b - 1)) = True Then
                RabelPrice = Right(SKU, b - 1)
                FirstBar = b
                Exit For
            Else
                If Left(Right(SKU, b - 1), 1) = "S" And IsNumeric(Right(SKU, b - 2)) = True Then
                    RabelPrice = Right(SKU, b - 2)
                    FirstBar = b
                    Exit For
                Else
                    RabelPrice = 0
                    Exit For
                End If
            End If
        End If
    DoEvents
    Next


    '|fffd|l|fffd|D|fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||394||fffd||fffd||fffd||fffd||fffd|
    If RabelPrice = 0 Then
        SkuToBuyPrice = 0
        Exit Function
    End If
    
    '|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||202||70b1||fffd||fffd||fffd||14a||fffd||fffd||fffd|
    If FirstBar = 0 Then
        SkuToBuyPrice = RabelPrice
        Exit Function
    End If
    
Dim SaleRatio As Long
    '|fffd||fffd||fffd||fffd||fffd||752||80aa||fffd||fffd||fffd||90a9||fffd||fffd||fffd||5c2||fffd|
    For c = FirstBar + 1 To Len(SKU)
        If Left(Right(SKU, c), 1) = "S" Then
            If IsNumeric(Mid(SKU, Len(SKU) - c + 2, c - FirstBar - 1)) = True Then
                SaleRatio = Left(Right(SKU, c - 1), c - FirstBar - 1)
                Exit For
            Else
                SkuToBuyPrice = RabelPrice
                Exit Function
            End If
        End If
    DoEvents
    Next
    
    If SaleRatio <> 0 Then
        SkuToBuyPrice = Int(RabelPrice * (100 - SaleRatio) / 100)
    Else
        SkuToBuyPrice = RabelPrice
    End If

'SKU|fffd|C|fffd|j|fffd|V|fffd||fffd||fffd||fffd||fffd||142||309||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||38e|d|fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||311||fffd||fffd|R|fffd|X|fffd|g|fffd||357||fffd||fffd|v|fffd|v|fffd|Z|fffd||fffd||fffd||255||293|r|fffd||fffd||fffd||fffd|j
Dim LastIndex As Long
    LastIndex = Sheets("SendCost").Cells(Rows.Count, 2).End(xlUp).Row
    If LastIndex < 4 Then
        GoTo Skip
    End If
    
    For d = 4 To 40
        If Left(SKU, Len(Sheets("SendCost").Cells(d, 1))) = Sheets("SendCost").Cells(d, 1) _
        And Sheets("SendCost").Cells(d, 2) <> "" Then
            SkuToBuyPrice = SkuToBuyPrice - Sheets("SendCost").Cells(d, 2)
        End If
        DoEvents
    Next
Skip:
End Function
Attribute VB_Name = "Module4"
Declare Sub Sleep Lib "kernel32" (ByVal dwMilliseconds As Long)



Function GetCondition(SKU As String) As Variant '0:ASIN,1:LandedPrice,2:ListingPrice,3:ShippingPrice
Sleep 200
Dim ReturnVal(3) As Variant '0:ASIN,1:LandedPrice,2:ListingPrice,3:ShippingPrice
'----------------------------------
'|fffd|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
Dim test As Worksheet
    Set test = Sheets("Date")
'----------------------------------

'|fffd||3d0||fffd||fffd||933e|=======================================================================================================
'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||315||3d0||fffd|------------------------------------------------
Dim Url As String
Dim xmldata As Object
Dim Result As Object
Dim tmpPrice As Double
Dim tmpObj As Object
Dim rawText As String
Dim timestamp As String
Dim SignedUrl As String

'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^


Dim MWSsKey As String
    MWSsKey = Worksheets("Date").Range("I6")
Dim sKey As String
    sKey = Worksheets("Debug").Range("B4")
Dim AWSkey As String
    AWSkey = Worksheets("Debug").Range("B3")
Dim MarketPlaceID As String
    MarketPlaceID = "A1VC38T7YXB528"
Dim sellerID As String
    sellerID = Sheets("Date").Range("I7")
Dim SelfExclude As String
    SelfExclude = "False"
Dim ItemCondition As String
    ItemCondition = "All"
Dim APIVersion As String
    APIVersion = "2011-10-01"
Dim ecsaddress As String
    ecsaddress = "mws.amazonservices.jp"
'SKU|fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||d0b9||fffd||fffd|
   SKU = URLencode(SKU)
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||302||fffd||fffd||7c2||315||3d0||fffd|-----------------------------------------------------
Dim Hash, hash_2, hash_cut2, hash_10, hash_cut10 As String
Dim base64Array As Variant
Dim base64Array2 As Variant
Dim sign As String
Dim sign2 As String
Dim rawTextToSign As String
Dim rawTextToSign2 As String

Dim i As Long, j As Long, k As Long

'MWS|fffd|f|fffd|[|fffd|^|fffd||30a|i|fffd|[|fffd|J|fffd|n

ChDrive ActiveWorkbook.Path
ChDir ActiveWorkbook.Path
'--------------------------------------
'
'|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd|i3|fffd||fffd||702||14d||10e||64fe||fffd|j
ReGet:
Dim ErrCount As Long
If Err.Number <> 0 Then
    Err.Clear
    ErrCount = ErrCount + 1
    If ErrCount > 3 Then
        Exit Function
    End If
End If
'|fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|MWS|fffd|f|fffd|[|fffd|^|fffd||64fe|================================================================================================================
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||24e|g|fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|v---------------------------------------------------------------------------------
If Format(Now(), "hh") > 9 Then
    timestamp = Format(Date, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
Else
    timestamp = Format(Date - 1, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
End If
'|fffd||fffd||fffd||fffd||fffd||303|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|E|fffd|T|fffd|u|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd||64fe||fffd||302||fffd||fffd||7c2||fffd|MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd|iGetMyPriceForSKU|fffd|A10/sec)***********************
'If Sheets("PriceCheckList").Cells(x, 3) = "" And Sheets("PriceCheckList").Cells(x, 4) = "" Then
    Dim xmldata3 As Object
    Dim Result3 As Object
    
    rawText = ""
        ' |fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||c42c|(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||343|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||fffd||fffd||202||302||14f||fffd||fffd||502||fffd||3c2||fffd||fffd||fffd||fffd|NG)
        rawText = rawText _
                & "AWSAccessKeyId=" & AWSkey _
                & "&Action=GetMyPriceForSKU" _
                & "&MWSAuthToken=" & MWSsKey _
                & "&MarketplaceId=" & MarketPlaceID _
                & "&SellerId=" & sellerID _
                & "&SellerSKUList.SellerSKU.1=" & SKU _
                & "&SignatureMethod=HmacSHA256" _
                & "&SignatureVersion=2" _
                & "&Timestamp=" & timestamp _
                & "&Version=" & APIVersion
       
        rawTextToSign = "GET" & vbLf & ecsaddress & vbLf & "/Products/2011-10-01" & vbLf & rawText
        Hash = Hmac(sKey, rawTextToSign)
        
'|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|URL|fffd||30d||c42c|-----------------------------------------------------------------

        '2|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
        hash_2 = ""
        For k = 1 To 64 Step 2
            hash_cut2 = Mid(Hash, k, 2)
            hash_2 = hash_2 & HEX2BIN(hash_cut2)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|00|fffd||156||fffd||fffd||7c2||fffd|
        hash_2 = hash_2 & "00"
          
        'BASE64|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = ""
        For k = 1 To 256 Step 6
            hash_cut10 = Mid(hash_2, k, 6)
            hash_10 = ncdec(2, hash_cut10)
            base64Array = Array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "+", "/")
            sign = sign & base64Array(hash_10)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|=|fffd||156||fffd||fffd||7c2||fffd|
        sign = sign & "="
        'URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = URLencode(sign)
        Url = "https://" & ecsaddress & "/Products/2011-10-01?" & rawText & "&Signature=" & sign
        'Sheets("Date").Cells(1, 20) = Url
'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s---------------------------------------
    Set xmldata3 = CreateObject("Microsoft.XMLDOM")
    xmldata3.async = False
    xmldata3.Load Url
'XML|fffd|f|fffd|[|fffd|^|fffd||30e||fffd||fffd|o|fffd||fffd|-------------------------------------
    On Error GoTo ReGet
    Set Result3 = xmldata3.SelectNodes("GetMyPriceForSKUResponse/GetMyPriceForSKUResult/Product/Offers/Offer")
    On Error GoTo ReGet
    If Not Result3 Is Nothing Then '|fffd||64fe||fffd||fffd||42a82||fffd||fffd||fffd||381|A
        For q = 0 To 100
            On Error GoTo ReGet
            If Not Result3(q) Is Nothing Then
                On Error GoTo ReGet
                If Result3(q).SelectSingleNode("SellerSKU").Text = SKU Then
                    On Error GoTo ReGet
                    ReturnVal(1) = Result3(q).SelectSingleNode("BuyingPrice/LandedPrice/Amount").Text
                    ReturnVal(2) = Result3(q).SelectSingleNode("BuyingPrice/ListingPrice/Amount").Text
                    ReturnVal(3) = Result3(q).SelectSingleNode("BuyingPrice/Shipping/Amount").Text
                    Exit For
                End If
             End If
        DoEvents
        Next
        ReturnVal(0) = xmldata3.SelectSingleNode("GetMyPriceForSKUResponse/GetMyPriceForSKUResult/Product/Identifiers/MarketplaceASIN/ASIN").Text
    End If

GetCondition = ReturnVal
'----------------------------------
'|fffd|V|fffd|[|fffd|g|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||fffd||fffd|
    Set test = Nothing
    Erase ReturnVal

End Function


Function LowLimit(ASIN As String, FullFill As String, SypnPrice As Long, SendPrice As Long) As Variant
Sleep 200
Dim Resolt(2) As Variant '0|fffd|F|fffd||8414||fffd||fffd||fffd||fffd||fffd|z|fffd|A1|fffd|F|fffd||8414||fffd||fffd||fffd||fffd||fffd|A2|fffd|F|fffd||152||fffd||8414||fffd||fffd|
Dim test As Worksheet
    Set test = Sheets("Date")
Dim FullFillment As String

    If FullFill = "FBA" Then
        FullFillment = "true"
    Else
        FullFillment = "false"
    End If

Dim FeeRatio As Long
Dim AbsolutedFee As Long

'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||315||3d0||fffd|------------------------------------------------
Dim Url As String
Dim xmldata As Object
Dim Result As Object
Dim tmpPrice As Double
Dim tmpObj As Object
Dim rawText As String
Dim timestamp As String
Dim SignedUrl As String

Dim MWSsKey As String
    MWSsKey = Worksheets("Date").Range("I6")
Dim sKey As String
    sKey = Worksheets("Debug").Range("B4")
Dim AWSkey As String
    AWSkey = Worksheets("Debug").Range("B3")

Dim sellerID As String
    sellerID = Sheets("Date").Range("I7")
    
Dim MarketPlaceID As String
    MarketPlaceID = "A1VC38T7YXB528"
    
Dim SelfExclude As String
    SelfExclude = "False"

Dim ItemCondition As String
    ItemCondition = "All"

Dim Action As String
    Action = "GetMyFeesEstimate"

Dim APIVersion As String
    APIVersion = "2011-10-01"
    
Dim ecsaddress As String
    ecsaddress = "mws.amazonservices.jp"
   
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||302||fffd||fffd||7c2||315||3d0||fffd|-----------------------------------------------------
Dim Hash, hash_2, hash_cut2, hash_10, hash_cut10 As String
Dim base64Array As Variant
Dim base64Array2 As Variant
Dim sign As String
Dim sign2 As String
Dim rawTextToSign As String
Dim rawTextToSign2 As String

Dim i As Long, j As Long, k As Long

'-------------------------------------------------------
'|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|v|fffd||fffd||fffd|W|fffd|F|fffd|N|fffd|g|fffd|E|fffd|C|fffd||fffd||fffd|h|fffd|E|fffd||315|W|fffd||fffd||fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|Amazon2excel|fffd||fffd||149|E|fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||fffd||fffd||101|A
'|fffd|@|fffd||6cc||fffd|^|fffd|u|fffd|`|fffd|v|fffd||fffd||fffd|W|fffd|F|fffd|N|fffd|g|fffd|\|fffd||fffd||fffd|p|fffd||303|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||342||fffd||fffd||90b1||fffd||181|B
'|fffd|@|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||315||fffd||fffd||fffd||fffd||312||fffd||fffd||fffd||fffd||fffd|13|fffd|P|fffd|^|fffd||20f||fffd|`|fffd||fffd||fffd||fffd||fffd||fffd||392||fffd||fffd||fffd||fffd||642||1c2||60a2||fffd|`|fffd||242||fffd||fffd||90b1||fffd||181|B
ChDrive ActiveWorkbook.Path
ChDir ActiveWorkbook.Path
'--------------------------------------
'
'|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||30f||fffd||fffd||fffd||fffd|i3|fffd||fffd||702||14d||10e||64fe||fffd|j
ReGet:
Dim ErrCount As Long
If Err.Number <> 0 Then
    Err.Clear
    ErrCount = ErrCount + 1
    If ErrCount > 3 Then
        Exit Function
    End If
End If
'|fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd||fffd||fffd|MWS|fffd|f|fffd|[|fffd|^|fffd||64fe|================================================================================================================
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||24e|g|fffd||fffd||fffd|^|fffd|C|fffd||fffd||fffd|X|fffd|^|fffd||fffd||fffd|v---------------------------------------------------------------------------------
If Format(Now(), "hh") >= 9 Then
    timestamp = Format(Now(), "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
Else
    timestamp = Format(Now() - 1, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
End If


'------------------------------------

'|fffd||fffd||fffd||fffd||fffd||303|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|E|fffd|T|fffd|u|fffd|R|fffd||fffd||fffd|f|fffd|B|fffd|V|fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd|i|fffd||64fe||fffd||302||fffd||fffd||7c2||fffd|MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd|iGetMyPriceForSKU|fffd|A10/sec)***********************

    Dim xmldata3 As Object
    Dim Result3 As Object
    
    rawText = ""
        ' |fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||c42c|(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||343|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||fffd||fffd||202||302||14f||fffd||fffd||502||fffd||3c2||fffd||fffd||fffd||fffd|NG)
        rawText = rawText _
                & "AWSAccessKeyId=" & AWSkey _
                & "&Action=" & Action _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IdType=ASIN" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IdValue=" & ASIN _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.Identifier=request1" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.IsAmazonFulfilled=" & FullFillment _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.MarketplaceId=" & MarketPlaceID _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.Amount=" & SypnPrice _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.ListingPrice.CurrencyCode=JPY" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsMonetaryValue.Amount=0" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsMonetaryValue.CurrencyCode=JPY" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Points.PointsNumber=0" _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Shipping.Amount=" & SendPrice _
                & "&FeesEstimateRequestList.FeesEstimateRequest.1.PriceToEstimateFees.Shipping.CurrencyCode=JPY" _
                & "&MWSAuthToken=" & MWSsKey _
                & "&SellerId=" & sellerID _
                & "&SignatureMethod=HmacSHA256" _
                & "&SignatureVersion=2" _
                & "&Timestamp=" & timestamp _
                & "&Version=" & APIVersion
       
        rawTextToSign = "GET" & vbLf & ecsaddress & vbLf & "/Products/2011-10-01" & vbLf & rawText
        Hash = Hmac(sKey, rawTextToSign)
        
'|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|URL|fffd||30d||c42c|-----------------------------------------------------------------

        '2|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
        hash_2 = ""
        For k = 1 To 64 Step 2
            hash_cut2 = Mid(Hash, k, 2)
            hash_2 = hash_2 & HEX2BIN(hash_cut2)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|00|fffd||156||fffd||fffd||7c2||fffd|
        hash_2 = hash_2 & "00"
          
        'BASE64|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = ""
        For k = 1 To 256 Step 6
            hash_cut10 = Mid(hash_2, k, 6)
            hash_10 = ncdec(2, hash_cut10)
            base64Array = Array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "+", "/")
            sign = sign & base64Array(hash_10)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|=|fffd||156||fffd||fffd||7c2||fffd|
        sign = sign & "="
        'URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = URLencode(sign)
        Url = "https://" & ecsaddress & "/Products/2011-10-01?" & rawText & "&Signature=" & sign
        'Sheets("Date").Cells(1, 21) = Url
'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s---------------------------------------
    Set xmldata3 = CreateObject("Microsoft.XMLDOM")
    xmldata3.async = False
    xmldata3.Load Url
'XML|fffd|f|fffd|[|fffd|^|fffd||30e||fffd||fffd|o|fffd||fffd|-------------------------------------
    On Error GoTo ReGet
    Set Result3 = xmldata3.SelectNodes("GetMyFeesEstimateResponse/GetMyFeesEstimateResult/FeesEstimateResultList/FeesEstimateResult/FeesEstimate/FeeDetailList/FeeDetail")
'Dim AbsolutedFee As Long
'Dim BuyPrice As Long
'Dim FeeRatio As Long
'Dim ProfitRatio As Long
'Dim ProfitPlus As Long
        AbsolutedFee = Empty
    On Error GoTo ReGet
    If Not Result3 Is Nothing Then '|fffd||64fe||fffd||fffd||42a82||fffd||fffd||fffd||381|A
            On Error GoTo ReGet
            If Not Result3(0) Is Nothing Then
                FeeRatio = Result3(0).SelectSingleNode("FinalFee/Amount").Text
                FeeRatio = Application.WorksheetFunction.RoundUp((FeeRatio / (SypnPrice + SendPrice) * 100), 0)
                AbsolutedFee = Result3(1).SelectSingleNode("FinalFee/Amount").Text * 1.08
                If FullFillment = "true" Then
                    AbsolutedFee = AbsolutedFee + Result3(3).SelectSingleNode("FinalFee/Amount").Text * 1.08
                End If
                '|fffd||fffd||fffd||214|z|fffd||fffd||fffd||30f||a347||fffd||fffd||fffd||fffd||fffd||317||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|v
            End If
    End If

'|fffd||fffd||fffd||fffd|
    Resolt(0) = Int((SypnPrice + SendPrice) * FeeRatio / 100 * 1.08) + AbsolutedFee
    Resolt(1) = FeeRatio
    Resolt(2) = AbsolutedFee
    LowLimit = Resolt
'|fffd||3d0||fffd||fffd||30f||fffd||fffd||fffd||fffd||fffd|--------------------------
Set xmldata = Nothing
Set Result = Nothing
Set tmpObj = Nothing
Set xmldata3 = Nothing
Set Result3 = Nothing


FullFillment = Empty
SendCost = Empty
RatioRow = Empty
ProfitRatio = Empty
ProfitPlus = Empty
Day1 = Empty
Day2 = Empty
Per1 = Empty
Per2 = Empty
Yen1 = Empty
Yen2 = Empty
DayPosition = Empty
FeeRatio = Empty
AbsolutedFee = Empty
Url = Empty
tmpPrice = Empty
rawText = Empty
timestamp = Empty
SignedUrl = Empty
sKey = Empty
AWSkey = Empty
MarketPlaceID = Empty
sellerID = Empty
SelfExclude = Empty
ItemCondition = Empty
Action = Empty
APIVersion = Empty
ecsaddress = Empty
Hash = Empty
hash_2 = Empty
hash_cut2 = Empty
hash_10 = Empty
hash_cut10 = Empty
base64Array = Empty
base64Array2 = Empty
sign = Empty
sign2 = Empty
rawTextToSign = Empty
rawTextToSign2 = Empty
i = Empty
j = Empty
k = Empty
Set Config = Nothing
Set test = Nothing
'--------------------------------------
End Function

Function FindSypnDay(SKU) As Date

'|fffd||3d0||fffd||fffd||312||fffd|`
Dim SKULen As Long
Dim SKUDate As String
        SKULen = Len(SKU) '|fffd|o|fffd||7d3||fffd||fffd||fffd||fffd||12c82||5c2||fffd|=================================================
        '4|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N--------------------------------------------------------------
        For k = 1 To SKULen - 7
            SKUDate = Mid(SKU, k, 4) & "/" & Mid(SKU, k + 4, 2) & "/" & Mid(SKU, k + 6, 2)
            If IsDate(SKUDate) = True Then
                SypnDay = DateDiff("d", SKUDate, Format(Now(), "YYYY/MM/DD"))
                GoTo labelDate
            End If
        DoEvents
        Next
        '2|fffd||fffd||fffd|N|fffd||fffd||fffd||143|`|fffd|F|fffd|b|fffd|N-----------------------------------------------------------------
        For k = 1 To SKULen - 5
            SKUDate = Mid(SKU, k, 2) & "/" & Mid(SKU, k + 2, 2) & "/" & Mid(SKU, k + 4, 2)
            If IsDate(SKUDate) = True Then
                FindSypnDay = Format(SKUDate, "YYYY/MM/DD")
                GoTo labelDate
            End If
        DoEvents
        Next

            '|fffd|o|fffd||7d3||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
            SypnDay = 999


labelDate:

End Function


Function OrderIdToASIN(OrderID As String, SKU As String)

'|fffd||3d0||fffd||fffd||933e|//////////////////////////////////////////////////
'|fffd||752||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30e|w|fffd||fffd|
Dim Config As Worksheet
    Set Config = Sheets("Date")
'MWS|fffd||303|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim Url As String
Dim SignedUrl As String
Dim Action As String
Dim MPid As String
    Action = "ListOrderItems"
    MPid = "A1VC38T7YXB528"

OrderID = URLencode(OrderID)
'|fffd||3d0||fffd||fffd||933e|=======================================================================================================
'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||315||3d0||fffd|------------------------------------------------

Dim xmldata As Object
Dim Result As Object
Dim tmpPrice As Double
Dim tmpObj As Object
Dim rawText As String
Dim timestamp As String


'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
Dim MWSsKey As String
    MWSsKey = Worksheets("Date").Range("I6")
Dim sKey As String
    sKey = Worksheets("Debug").Range("B4")
Dim AWSkey As String
    AWSkey = Worksheets("Debug").Range("B3")

Dim sellerID As String
    sellerID = Sheets("Date").Range("I7")
    
Dim MarketPlaceID As String
    MarketPlaceID = "A1VC38T7YXB528"

Dim APIVersion As String
    APIVersion = "2013-09-01"
Dim ecsaddress As String
    ecsaddress = "mws.amazonservices.jp"
'SKU|fffd||315||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||d0b9||fffd||fffd|
   SKU = URLencode(SKU)
'|fffd||fffd||fffd||fffd||fffd||c42c||fffd||302||fffd||fffd||7c2||315||3d0||fffd|-----------------------------------------------------
Dim Hash, hash_2, hash_cut2, hash_10, hash_cut10 As String
Dim base64Array As Variant
Dim base64Array2 As Variant
Dim sign As String
Dim sign2 As String
Dim rawTextToSign As String
Dim rawTextToSign2 As String

Dim i As Long, j As Long, k As Long


'MWS|fffd||fffd||fffd||282||315||3d0||fffd|
Dim Tittle As String
Dim ASIN As String
Dim NextToken As String
Dim ErrorInfo As String
Dim ExistNum As Long
Dim Quantity As Long
Dim rc As Integer
Dim Page As Long
Dim QuantityShipped As Long
Dim ItemPrice As Long
Dim ShippingPrice As Long
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||315||3ca||fffd||fffd|p



'///////////////////////////////////////////////////////////

    '=========================================================
    'MWS|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||30e||fffd||fffd|s
    '=========================================================
    ChDrive ActiveWorkbook.Path
    ChDir ActiveWorkbook.Path


    Sleep 2000
labelNextToken:
ReStart:

If Format(Now(), "hh") > 9 Then
    timestamp = Format(Date, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
Else
    timestamp = Format(Date - 1, "yyyy-mm-dd") & "T" & Format(CDate(DateAdd("h", -9, Time)), "hh%3AMM%3Ass") & "Z"
End If
'|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd|J|fffd|n|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    'URL|fffd||c42c|----------------------------------------------------------------

    '-------------------------------------------------------------------------
    rawText = ""
        ' |fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||c42c|(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||343|A|fffd||fffd||fffd|t|fffd|@|fffd|x|fffd|b|fffd|g|fffd||fffd||fffd||202||302||14f||fffd||fffd||502||fffd||3c2||fffd||fffd||fffd||fffd|NG)

                
    If NextToken = Empty Then
        '1|fffd|y|fffd|[|fffd|W|fffd||682||30e||64fe|URL
        rawText = rawText _
                & "AWSAccessKeyId=" & AWSkey _
                & "&Action=ListOrderItems" _
                & "&AmazonOrderId=" & OrderID _
                & "&MWSAuthToken=" & MWSsKey _
                & "&SellerId=" & sellerID _
                & "&SignatureMethod=HmacSHA256" _
                & "&SignatureVersion=2" _
                & "&Timestamp=" & timestamp _
                & "&Version=" & APIVersion
                '& "&MarketplaceId=" & MarketPlaceID
               
    Else
        '2|fffd|y|fffd|[|fffd|W|fffd||688||20d|~|fffd||303|l|fffd|N|fffd|X|fffd|g|fffd|g|fffd|[|fffd|N|fffd||fffd||fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|gURL
        NextToken = URLencode(NextToken)
        rawText = rawText _
                & "AWSAccessKeyId=" & AWSkey _
                & "&Action=ListOrderItemsByNextToken" _
                & "&MWSAuthToken=" & MWSsKey _
                & "&NextToken=" & NextToken _
                & "&SellerId=" & sellerID _
                & "&SignatureMethod=HmacSHA256" _
                & "&SignatureVersion=2" _
                & "&Timestamp=" & timestamp _
                & "&Version=" & APIVersion
                '& "&MarketplaceId=" & MarketPlaceID _

        
    End If
    
        rawTextToSign = "GET" & vbLf & ecsaddress & vbLf & "/Products/2013-09-01" & vbLf & rawText
        Hash = Hmac(sKey, rawTextToSign)
        
'|fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|URL|fffd||30d||c42c|-----------------------------------------------------------------

        '2|fffd|i|fffd||fffd||fffd||255||3ca||fffd|
        hash_2 = ""
        For k = 1 To 64 Step 2
            hash_cut2 = Mid(Hash, k, 2)
            hash_2 = hash_2 & HEX2BIN(hash_cut2)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|00|fffd||156||fffd||fffd||7c2||fffd|
        hash_2 = hash_2 & "00"
          
        'BASE64|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = ""
        For k = 1 To 256 Step 6
            hash_cut10 = Mid(hash_2, k, 6)
            hash_10 = ncdec(2, hash_cut10)
            base64Array = Array("A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z", "a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z", "0", "1", "2", "3", "4", "5", "6", "7", "8", "9", "+", "/")
            sign = sign & base64Array(hash_10)
        Next
        '|fffd|s|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||302||fffd|=|fffd||156||fffd||fffd||7c2||fffd|
        sign = sign & "="
        'URL|fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
        sign = URLencode(sign)
        Url = "https://" & ecsaddress & "/Products/2013-09-01?" & rawText & "&Signature=" & sign
        'Sheets("Date").Cells(1, 20) = Url

    'MWS|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd|s---------------------------------------
    Set xmldata = CreateObject("Microsoft.XMLDOM")
    xmldata.async = False
    xmldata.Load Url
    

    
    '=========================================================
    'MWS|fffd||fffd||fffd|X|fffd|||fffd||fffd||fffd|X|fffd||30e||fffd||fffd|o|fffd||fffd|
    '=========================================================
    '|fffd||fffd||fffd|N|fffd|G|fffd|X|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||30f||fffd||fffd||fffd|
    If xmldata.SelectNodes("ListOrderItemsResponse/ListOrderItemsResult/OrderItems/OrderItem") Is Nothing Then
        ErrorInfo = xmldata.SelectSingleNode("ErrorResponse/Error/Code").Text
        'rc = MsgBox(ErrorInfo & "|fffd||143|G|fffd||fffd||fffd|[|fffd||308||5d1||48b|@|fffd||fffd||10a|J|fffd||fffd||fffd||702||fffd|" & vbLf & "|fffd||55703||fffd||fffd|[|fffd|g|fffd||fffd|2|fffd|b|fffd||142||fffd|" & vbLf & "|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||14f|I|fffd||fffd|", vbOKCancel)
        'If rc = 2 Then Exit Sub
        Application.StatusBar = ErrorInfo & "|fffd||143|G|fffd||fffd||fffd|[|fffd||308||fffd|2|fffd|b|fffd||48b|@|fffd||fffd||10a|J|fffd||fffd||fffd||702||fffd|"
        DoEvents
        Sleep 2000
        
        Tittle = Empty
        ASIN = Empty
        OrderID = Empty
        SKU = Empty
        Quantity = Empty
        QuantityShipped = Empty
        ExistNum = Empty
        SignedUrl = Empty
        ItemPrice = Empty
        ShippingPrice = Empty
        Set Result = Nothing
        Set xmldata = Nothing
        GoTo ReStart
    End If
    
    

        Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd|@" & i + 1 + Page * 100
        '|fffd||fffd||fffd||fffd||fffd|o|fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||30d|s|fffd||50d||fffd|

        '|fffd|e|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||64fe|

        ASIN = Result(ExistNum).SelectSingleNode("ASIN").Text

        Quantity = Result(ExistNum).SelectSingleNode("QuantityOrdered").Text
        QuantityShipped = Result(ExistNum).SelectSingleNode("QuantityShipped").Text
        ItemPrice = Result(ExistNum).SelectSingleNode("ItemPrice/Amount").Text
        ShippingPrice = Result(ExistNum).SelectSingleNode("ShippingPrice/Amount").Text

    
    If NextToken <> Empty Then
        Application.StatusBar = "|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||302||14e||fffd||fffd||303|g|fffd|[|fffd|N|fffd||fffd||fffd||115d0|M|fffd||fffd||fffd||702||fffd|"
        SignedUrl = Empty
        Page = Page + 1
        GoTo labelNextToken
    Else
        Application.StatusBar = "|fffd||64fe||fffd||fffd||fffd||fffd|"
    End If


End Function
Attribute VB_Name = "Module5"
Public Declare Sub UrlSign Lib "Sign.dll" (ByVal Url As String, ByVal SignedUrl As String, ByVal Secretkey As String)
'advapi32.dll
'http://su-u.jp/juju/%B5%A4%A4%DE%A4%B0%A4%EC%C6%FC%B5%AD/2007-03-08.html
Private Declare Function CryptAcquireContext Lib "advapi32.dll" Alias "CryptAcquireContextA" _
                            (ByRef phProv As Long, ByVal pszContainer As String, ByVal pszProvider As String, _
                             ByVal dwProvType As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptReleaseContext Lib "advapi32.dll" _
                            (ByVal hProv As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptCreateHash Lib "advapi32.dll" _
                            (ByVal hProv As Long, ByVal Algid As Long, ByVal hKey As Long, ByVal dwFlags As Long, _
                             ByRef phHash As Long) As Long
Private Declare Function CryptDestroyHash Lib "advapi32.dll" _
                            (ByVal hHash As Long) As Long
Private Declare Function CryptHashData Lib "advapi32.dll" _
                            (ByVal hHash As Long, pbData As Any, ByVal cbData As Long, ByVal dwFlags As Long) As Long
Private Declare Function CryptGetHashParam Lib "advapi32.dll" _
                            (ByVal hHash As Long, ByVal dwParam As Long, pbData As Any, ByRef pcbData As Long, _
                             ByVal dwFlags As Long) As Long
Private Declare Sub Sleep Lib "kernel32" (ByVal dwMs As Long)

Private Const PROV_RSA_FULL   As Long = 1
Private Const PROV_RSA_AES    As Long = 24
Private Const CRYPT_VERIFYCONTEXT As Long = &HF0000000

Private Const HP_HASHVAL      As Long = 2
Private Const HP_HASHSIZE     As Long = 4

Private Const ALG_TYPE_ANY    As Long = 0
Private Const ALG_CLASS_HASH  As Long = 32768

Private Const ALG_SID_MD2     As Long = 1
Private Const ALG_SID_MD4     As Long = 2
Private Const ALG_SID_MD5     As Long = 3
Private Const ALG_SID_SHA     As Long = 4
Private Const ALG_SID_SHA_256 As Long = 12
Private Const ALG_SID_SHA_384 As Long = 13
Private Const ALG_SID_SHA_512 As Long = 14

Private Const CALG_MD2        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD2)
Private Const CALG_MD4        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD4)
Private Const CALG_MD5        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_MD5)
Private Const CALG_SHA        As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA)
Private Const CALG_SHA_256    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_256)
Private Const CALG_SHA_384    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_384)
Private Const CALG_SHA_512    As Long = (ALG_CLASS_HASH Or ALG_TYPE_ANY Or ALG_SID_SHA_512)

' Create Hash
Private Function CreateHash(abytData() As Byte, ByVal lngAlgID As Long) As String
    Dim hProv As Long, hHash As Long
    Dim abytHash(0 To 63) As Byte
    Dim lngLength As Long
    Dim lngResult As Long
    Dim strHash As String
    Dim i As Long
    strHash = ""
    If CryptAcquireContext(hProv, vbNullString, vbNullString, _
                           IIf(lngAlgID >= CALG_SHA_256, PROV_RSA_AES, PROV_RSA_FULL), _
                           CRYPT_VERIFYCONTEXT) <> 0& Then
        If CryptCreateHash(hProv, lngAlgID, 0&, 0&, hHash) <> 0& Then
            lngLength = UBound(abytData()) - LBound(abytData()) + 1
            If lngLength > 0 Then lngResult = CryptHashData(hHash, abytData(LBound(abytData())), lngLength, 0&) _
                             Else lngResult = CryptHashData(hHash, ByVal 0&, 0&, 0&)
            If lngResult <> 0& Then
                lngLength = UBound(abytHash()) - LBound(abytHash()) + 1
                If CryptGetHashParam(hHash, HP_HASHVAL, abytHash(LBound(abytHash())), lngLength, 0&) <> 0& Then
                    For i = 0 To lngLength - 1
                        strHash = strHash & Right$("0" & Hex$(abytHash(LBound(abytHash()) + i)), 2)
                    Next
                End If
            End If
            CryptDestroyHash hHash
        End If
        CryptReleaseContext hProv, 0&
    End If
    CreateHash = LCase$(strHash)
End Function

' Create Hash From String(Shift_JIS)
Private Function CreateHashString(ByVal strData As String, ByVal lngAlgID As Long) As String
    CreateHashString = CreateHash(StrConv(strData, vbFromUnicode), lngAlgID)
End Function

' Create Hash From File
Private Function CreateHashFile(ByVal strFileName As String, ByVal lngAlgID As Long) As String
    Dim abytData() As Byte
    Dim intFile As Long
    Dim lngError As Long
    On Error Resume Next
        If Len(Dir(strFileName)) > 0 Then
            intFile = FreeFile
            Open strFileName For Binary Access Read Shared As #intFile
            abytData() = InputB(LOF(intFile), #intFile)
            Close #intFile
        End If
        lngError = Err.Number
    On Error GoTo 0
    If lngError = 0 Then CreateHashFile = CreateHash(abytData(), lngAlgID) _
                    Else CreateHashFile = ""
End Function

' MD5
Public Function CreateMD5Hash(abytData() As Byte) As String
    CreateMD5Hash = CreateHash(abytData(), CALG_MD5)
End Function
Public Function CreateMD5HashString(ByVal strData As String) As String
    CreateMD5HashString = CreateHashString(strData, CALG_MD5)
End Function
Public Function CreateMD5HashFile(ByVal strFileName As String) As String
    CreateMD5HashFile = CreateHashFile(strFileName, CALG_MD5)
End Function

' SHA-1
Public Function CreateSHA1Hash(abytData() As Byte) As String
    CreateSHA1Hash = CreateHash(abytData(), CALG_SHA)
End Function
Public Function CreateSHA1HashString(ByVal strData As String) As String
    CreateSHA1HashString = CreateHashString(strData, CALG_SHA)
End Function
Public Function CreateSHA1HashFile(ByVal strFileName As String) As String
    CreateSHA1HashFile = CreateHashFile(strFileName, CALG_SHA)
End Function

' SHA-256
Public Function CreateSHA256Hash(abytData() As Byte) As String
    CreateSHA256Hash = CreateHash(abytData(), CALG_SHA_256)
End Function
Public Function CreateSHA256HashString(ByVal strData As String) As String
    CreateSHA256HashString = CreateHashString(strData, CALG_SHA_256)
End Function
Public Function CreateSHA256HashFile(ByVal strFileName As String) As String
    CreateSHA256HashFile = CreateHashFile(strFileName, CALG_SHA_256)
End Function

' SHA-384
Public Function CreateSHA384Hash(abytData() As Byte) As String
    CreateSHA384Hash = CreateHash(abytData(), CALG_SHA_384)
End Function
Public Function CreateSHA384HashString(ByVal strData As String) As String
    CreateSHA384HashString = CreateHashString(strData, CALG_SHA_384)
End Function
Public Function CreateSHA384HashFile(ByVal strFileName As String) As String
    CreateSHA384HashFile = CreateHashFile(strFileName, CALG_SHA_384)
End Function

' SHA-512
Public Function CreateSHA512Hash(abytData() As Byte) As String
    CreateSHA512Hash = CreateHash(abytData(), CALG_SHA_512)
End Function
Public Function CreateSHA512HashString(ByVal strData As String) As String
    CreateSHA512HashString = CreateHashString(strData, CALG_SHA_512)
End Function
Public Function CreateSHA512HashFile(ByVal strFileName As String) As String
    CreateSHA512HashFile = CreateHashFile(strFileName, CALG_SHA_512)
End Function
Function URLhenkan(str As String) As String
Set sc = CreateObject("ScriptControl")
sc.Language = "Jscript"
Set js = sc.CodeObject
URLhenkan = js.encodeURIComponent(str)
End Function
'Hmac-SHA256
'http://plus-sys.jugem.jp/?eid=215
Public Function Hmac(sKey, rawTextToSign As String) As String

Dim arKey() As Byte
Dim ipad As String
Dim opad As String
Dim buff() As Byte, offset As Long

'|fffd||fffd||fffd||fffd||fffd||fffd|
    ipad = ""
    opad = ""
    Hash = ""
    ReDim arKey(0 To 63)

'|fffd||95a7||fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||c2||93||1cd||fffd||fffd||741|A|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||595||3ca||fffd||fffd||fffd|z|fffd||fffd||58a|i|fffd|[
    For i = 0 To Len(sKey) - 1
        arKey(i) = Asc(Mid(sKey, i + 1, 1))
    Next

'64|fffd||fffd||fffd||fffd||fffd||256||fffd||fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||341|A|fffd|[|fffd||fffd||fffd|Z|fffd|b|fffd|g
    For i = Len(sKey) To 63
        arKey(i) = 0
    Next

'innerpad|fffd|y|fffd||fffd|outerpad|fffd||c42c|
    For i = 0 To 63
        ipad = ipad & Chr(arKey(i) Xor &H36)
        opad = opad & Chr(arKey(i) Xor &H5C)
    Next

'|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|1|fffd||fffd||fffd|
'(innerpad+|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd|)|fffd||fffd||fffd|n|fffd|b|fffd|V|fffd||fffd||fffd|E|fffd|E|fffd|E|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|1
    Hash = CreateSHA256HashString(ipad & rawTextToSign)

'|fffd|n|fffd|b|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd|
    buff = StrConv(opad, vbFromUnicode)
    offset = UBound(buff)
    ReDim Preserve buff(offset + Len(Hash) \ 2)

    For i = 1 To (Len(Hash) \ 2)
        buff(offset + i) = CByte("&H" & Mid(Hash, (i - 1) * 2 + 1, 2))
    Next
    Hash = CreateSHA256Hash(buff)
    Hmac = Hash

End Function
Public Function HEX2BIN(ByVal hx As String) As String
    Dim num As Long
    Dim bin As String
    Dim i As Long
    num = CLng("&H" & hx)
        For i = Len(hx) * 4 - 1 To 0 Step -1
            bin = bin & -CInt((num And (2 ^ i)) <> 0)
        Next
    HEX2BIN = bin
End Function
'n|fffd|i|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd|strNumber|fffd||fffd|10|fffd|i|fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||255||3ca||fffd||fffd||fffd||fffd||115||502||fffd|
'http://www5d.biglobe.ne.jp/~tomoya03/shtml/algorithm/Convert.htm
Public Function ncdec(ByVal n As Long, ByVal strNumber As String) As Long

    Dim lngt As Long
    Dim c As Long
    Dim i As Long
    lngt = 0&
    c = 1&
    For i = 1& To Len(strNumber)
        lngt = lngt + subncdec(Left$(Right$(strNumber, i), 1)) * c
        c = c * n
    Next i
    ncdec = lngt

End Function
'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h
'http://www.geocities.co.jp/SilkRoad/4511/vb/urlenc.htm
Public Function URLencode(ByRef strSource As String) As String

 Dim lngLength As Long                                          '|fffd||fffd||fffd||fffd||fffd||fffd||303|T|fffd|C|fffd|Y(S-JIS |fffd||3ca||fffd||fffd||fffd|)|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim bytSource() As Byte                                        'ANSI/S-JIS |fffd||255||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|C|fffd|g|fffd|^|fffd|z|fffd||fffd|
 Dim strBuffer As String                                        'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@
 Dim bytSingle As Byte                                          '|fffd|z|fffd||42a42||7532||fffd||fffd||fffd|o|fffd||fffd||fffd||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim strSingleHex As String                                     '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|
 Dim lngReadCount As Long                                       'bytSource |fffd||1c2||74d||fffd||fffd||748||292|u|fffd|J|fffd|E|fffd||fffd||fffd|^
 Dim lngWriteCount As Long                                      'strBuffer |fffd||fffd||fffd||fffd||fffd||fffd||fffd||748||292|u|fffd|J|fffd|E|fffd||fffd||fffd|^
 
    lngLength = LenB(StrConv(strSource, vbFromUnicode))         'ANSI/S-JIS |fffd||3ca||fffd||fffd||fffd||303|T|fffd|C|fffd|Y|fffd||fffd||fffd||fffd||fffd||7c2||fffd|
    If Not CBool(lngLength) Then Exit Function                  '0 |fffd|o|fffd|C|fffd|g|fffd||30f||a347||fffd||590||fffd||fffd||14c82||fffd||fffd||fffd|
    ReDim bytSource(lngLength - 1)                              'ANSI/S-JIS |fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||308||fffd||fffd||fffd|m|fffd||fffd|
    bytSource = StrConv(strSource, vbFromUnicode)               'ANSI/S-JIS |fffd||255||3ca||fffd||fffd||fffd| bytSource |fffd||24a|i|fffd|[
    
    strBuffer = String$(lngLength * 3, vbNullChar)              'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||fffd||fffd||fffd||a39e||fffd|i|fffd|[|fffd|o|fffd|b|fffd|t|fffd|@|fffd||fffd||fffd|m|fffd||fffd|
    strSingleHex = "%00"                                        '16 |fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||fffd||fffd|m|fffd||fffd|
    lngWriteCount = 1                                           '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||fffd|J|fffd|n
    
    Do                                                          '|fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd|[|fffd||702||143||fffd||fffd|[|fffd|v
        bytSingle = bytSource(lngReadCount)                     '|fffd|z|fffd||42a42||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|Q|fffd||182||fffd||fffd||fffd||fffd||846c||fffd||fffd||fffd|H)
        If ((bytSingle >= &H81) And (bytSingle <= &H9F)) Or _
           ((bytSingle >= &HE0) And (bytSingle <= &HEF)) Then   'Shift-JIS 2 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd||18a|m|fffd|F|fffd||fffd||fffd||a0bd||fffd||a347|
            Mid(strSingleHex, 2, 2) = Hex$(bytSingle)           '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|(|fffd||fffd||283|o|fffd|C|fffd|g)
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
            If lngReadCount = lngLength Then Exit Do            '|fffd||fffd||fffd||fffd||fffd||fffd||30f|I|fffd|[|fffd||252|B|fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd|[|fffd|v|fffd||14c82||fffd||fffd||fffd|
            bytSingle = bytSource(lngReadCount)                 '|fffd|z|fffd||42a42||fffd| 1 |fffd|o|fffd|C|fffd|g|fffd||fffd||fffd||fffd|
            Mid(strSingleHex, 2, 2) = Hex$(bytSingle)           '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|(|fffd||fffd||fffd||283|o|fffd|C|fffd|g)
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
        ElseIf bytSingle = &H20 Then                            '|fffd||fffd||fffd|p|fffd|X|fffd|y|fffd|[|fffd|X|fffd||fffd||fffd||fffd|(" ")|fffd||30f||a347|
            Mid(strBuffer, lngWriteCount, 1) = "+"              '"+" |fffd||fffd||fffd||fffd||fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 1                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||20b7|
        ElseIf ((bytSingle >= &H40) And (bytSingle <= &H5A)) Or _
               ((bytSingle >= &H61) And (bytSingle <= &H7A)) Or _
               ((bytSingle >= &H30) And (bytSingle <= &H39)) Or _
               (bytSingle = &H2A) Or _
               (bytSingle = &H2D) Or _
               (bytSingle = &H2E) Or _
               (bytSingle = &H5F) Then                          '|fffd||fffd||fffd||3ca||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd||fffd||fffd||a347|
            Mid(strBuffer, lngWriteCount, 1) = Chr$(bytSingle)  '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||15d8e||fffd||fffd||fffd||256||7c2||fffd||fffd||10f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(^^;
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 1                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 1 |fffd||fffd||fffd||20b7|
        Else                                                    '|fffd||fffd||fffd||311||fffd||fffd||315||fffd||fffd||fffd||fffd||30f||a347|
            If bytSingle <= &HF Then                            'Hex$() |fffd||30c||fffd||fffd||282||fffd| 1 |fffd||fffd||fffd||fffd||fffd||242||202||fffd||a347|
                Mid(strSingleHex, 2, 1) = "0"                   '0 |fffd||fffd||64ea||fffd||255|t|fffd||fffd|
                Mid(strSingleHex, 3, 1) = Hex$(bytSingle)       '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|
            Else                                                '0 |fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||202||fffd||fffd||a347|
                Mid(strSingleHex, 2, 2) = Hex$(bytSingle)       '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd| 16 |fffd|i|fffd||fffd||fffd||255||3ca||fffd|
            End If
            Mid(strBuffer, lngWriteCount, 3) = strSingleHex     'URL |fffd|G|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||a0bd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd|b|fffd|t|fffd|@|fffd||24f||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            lngReadCount = lngReadCount + 1                     '|fffd||1c2||74d||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd||fffd|C|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd||fffd|g
            lngWriteCount = lngWriteCount + 3                   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|J|fffd|E|fffd||fffd||fffd|^|fffd||fffd| 3 |fffd||fffd||fffd||20b7|
        End If
    Loop Until lngReadCount = lngLength

    Erase bytSource                                             '|fffd|o|fffd|C|fffd|g|fffd|^|fffd|z|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    If lngWriteCount > 1 Then                                   '|fffd|o|fffd|b|fffd|t|fffd|@|fffd||255||fffd||fffd||fffd||fffd||42a8f||fffd||fffd||fffd||fffd||fffd||fffd||702||a0bd||fffd||a347|
        URLencode = Left$(strBuffer, lngWriteCount - 1)         '|fffd|o|fffd|b|fffd|t|fffd|@|fffd||317|]|fffd||fffd||fffd||215||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||7c2||fffd|l|fffd||182||fffd||fffd||fffd|
    End If

End Function
Public Function subncdec(ByVal b As String) As Long
    
    Dim r As Long
    r = Asc(UCase(b))
    If r > 64& Then
        subncdec = r - 55&
    Else
        subncdec = CLng(b)
    End If
    
End Function






Attribute VB_Name = "Module6"
Sub SKU|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd||752||fffd||fffd|()
    Sheets("SendCost").Select
End Sub

Sub |fffd|W|fffd|v|fffd||fffd||282||fffd|()
    Sheets("Date").Select
End Sub
Attribute VB_Name = "Module7"
Sub |fffd||fffd||fffd|p|fffd||fffd||fffd||38f||6c2||303|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|I|fffd||fffd|()


    Dim fType, prompt As String
    Dim fPath As Variant
    Dim ws As Worksheet
    Set ws = Worksheets("SendCost")

    '|fffd|I|fffd||fffd||fffd||142||fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||30e||fffd||782||fffd|csv|fffd||24c||fffd||fffd||fffd|
    fType = "Excel |327||fffd||fffd| (*.xlsm),*.xlsm"

    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||303|^|fffd|C|fffd|g|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|
    prompt = "|fffd||fffd||fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd|o|fffd|i|fffd|c|fffd|[|fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd|"
    '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd|Q|fffd||183|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||315|\|fffd||fffd|
    fPath = Application.GetOpenFilename(fType, , prompt)

    If fPath = False Then
    '|fffd|_|fffd|C|fffd|A|fffd||fffd||fffd|O|fffd||143|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd|
        End
    End If

    'B2|fffd|Z|fffd||fffd||fffd||243|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g
    ws.Cells(2, 5).Value = fPath

End Sub


Sub |fffd|o|fffd|i|fffd|c|fffd|[|fffd||fffd||fffd||fffd||fffd||7457||fffd||fffd||fffd||30f||345d||fffd||752||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|()

Dim OldFileFullPass As String
Dim OldFilePass As String
Dim OldFile As String
Dim OldFileName As String

OldFileFullPass = Sheets("SendCost").Cells(2, 5)

For a = 6 To Len(OldFileFullPass)
    If Left(Right(OldFileFullPass, a), 1) = "\" Then
        OldFilePass = Left(OldFileFullPass, Len(OldFileFullPass) - a)
        OldFile = Right(OldFileFullPass, a - 1)
        OldFileName = Replace(OldFile, ".xlsm", "")
        Exit For
    End If
DoEvents
Next

Dim MyFileFullPass As String
Dim MyFilePass As String
Dim MyFile As String
Dim MyFileName As String

MyFilePass = ActiveWorkbook.Path
MyFile = ActiveWorkbook.Name
MyFileName = Left(MyFile, Len(MyFile) - 5)
MyFileFullPass = MyFilePass & "\" & MyFile

Application.ScreenUpdating = False
Workbooks.Open OldFileFullPass

    '|fffd||fffd||fffd|p|fffd||fffd|
    Workbooks(MyFile).Sheets("SendCost").Range("B3:B30").Value = _
        Workbooks(OldFile).Sheets("Config").Range("B26:B53").Value
     
    Workbooks(MyFile).Sheets("SendCost").Range("A31:B40").Value = _
        Workbooks(OldFile).Sheets("Config").Range("A54:B63").Value
    
Workbooks(OldFile).Close SaveChanges:=False
Application.ScreenUpdating = True

MsgBox "|fffd|f|fffd|[|fffd|^|fffd||313||1c2||74d||fffd||fffd||742||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{C9876C7C-62E7-46F6-A960-1BBCCFF19C68}{305C04B1-8412-4151-9468-A0A168497438}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

' InQuest injected base64 decoded content
' m.+-
' .+-:

INQUEST-PP=macro
