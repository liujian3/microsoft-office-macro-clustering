Attribute VB_Name = "Module5"
Public EndArea As String
Public lCnn As New ADODB.Connection
Public sCnn As New ADODB.Connection
Public mServer As String, mdBase As String, mUser As String, mPass As String, mPort As String
Public Function OpenConnection() As ADODB.Connection
        Dim oCnn As New ADODB.Connection
        If mDB = "MYS" Or mDB = "LMY" Then
            oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=" & mServer & ";Port=" & mPort & ";Database=" & mdBase & ";User=" & mUser & "; Password=" & mPass & ";Option=3;"
        ElseIf mDB = "MSA" Then
            If mDBPath = "" Then
                oCnn.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & Replace(UCase(ActiveWorkbook.Path), "\CHECKLIST\IMP\" & UCase(mCoCode) & "\" & UCase(mBrCode), "") & "\ERPMain.mdb; Jet OLEDB:Database password=eximchennai12^7* "
            Else
                oCnn.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & mDBPath & "\ERPMain.mdb; Jet OLEDB:Database password=eximchennai12^7* "
            End If
        Else
            oCnn.ConnectionString = "Driver={SQLServer};Server=" & mdbServer & ";Database=" & mdbName & ";Uid=" & mdbUserid & ";Pwd=" & mdbPwd & ";"
        End If
        'oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=103.27.87.172;Port=3306;Database=cochin_clearing;User=cochinadmin; Password=cochin123;Option=3;"
        oCnn.Open
        Set OpenConnection = oCnn
    End Function
    Function openSrvConnection() As ADODB.Connection
        Dim oCnn As New ADODB.Connection
        If mDB = "MYS" Then
            Dim FocusDBIP As String
            FocusDBIP = getFocusDBIP()
            oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=" & FocusDBIP & ";Port=3306;Database=focus_db;User=focusadmin; Password=focus123;Option=3;"
        ElseIf mDB = "LMY" Then
            oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=" & mServer & ";Port=" & mPort & ";Database=focus_db;User=focusadmin; Password=focus123;Option=3;"
        ElseIf mDB = "MSA" Then
            If mDBPath = "" Then
                oCnn.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & Replace(UCase(ActiveWorkbook.Path), "\CHECKLIST\IMP\" & UCase(mCoCode) & "\" & UCase(mBrCode), "") & "\Focus_DB.mdb"
            Else
                oCnn.ConnectionString = "Provider=Microsoft.Jet.OLEDB.4.0;" & "Data Source=" & mDBPath & "\Focus_DB.mdb"
            End If
        Else
            oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=" & mServer & ";Port=" & mPort & ";Database=focus_db;User=focusadmin; Password=focus123;Option=3;"
        End If
        'oCnn.ConnectionString = "Driver={MySQL ODBC 5.2 Unicode Driver};Server=103.27.87.172;Port=3306;Database=cochin_clearing;User=cochinadmin; Password=cochin123;Option=3;"
        oCnn.Open
        Set openSrvConnection = oCnn
    End Function
    Public Function sGetRec(ByVal TabName As String, ByVal Sql As String, ByVal whereClass As String) As ADODB.Recordset
        Dim errCount As Integer
        errCount = 1
errFlag1:
        On Error GoTo errFlag
        Dim strSQL As String, Rec As String
        Dim sRst As New ADODB.Recordset
        If sCnn Is Nothing Or sCnn.State <> ADODB.ObjectStateEnum.adStateOpen Then
            Set sCnn = openSrvConnection()
        End If
            ' Build updateable keyset.
        sRst.CursorType = ADODB.CursorTypeEnum.adOpenStatic
        sRst.LockType = ADODB.LockTypeEnum.adLockOptimistic
        sRst.CursorLocation = ADODB.CursorLocationEnum.adUseClient
        If Trim(TabName) <> "" Then
            strSQL = " Select * from " & TabName
        Else
            strSQL = Sql
        End If
        If Trim(whereClass) <> "" Then
            strSQL = strSQL & " where " & whereClass
        End If
        If strSQL = "" Then
        Else
            'sRst.Source = strSQL
            sRst.ActiveConnection = sCnn
            sRst.Open (strSQL) 'Options:=adCmdText
            sRst.ActiveConnection = Nothing
        End If
        Set sGetRec = sRst
        Exit Function

        'Set rst = Nothing
errFlag:
        If errTrack(Err.Description) And errCount = 1 Then
            errCount = errCount + 1
            sCnn.Close
            sCnn = openSrvConnection()
            GoTo errFlag1
        Else
            MsgBox Err.Description, MsgBoxStyle.Critical, DrName
            End
        End If
End Function
    Public Function GetRec(ByVal TabName As String, ByVal Sql As String, ByVal whereClass As String) As ADODB.Recordset
        Dim errCount As Integer
        errCount = 1
errFlag1:
        On Error GoTo errFlag
        Dim strSQL As String, Rec As String, oCnn As New ADODB.Connection
        'Dim oCnn As ADODB.Connection = OpenConnection()

        Dim oRst As New ADODB.Recordset
        If lCnn Is Nothing Or lCnn.State <> ADODB.ObjectStateEnum.adStateOpen Then
            Set lCnn = OpenConnection()
        End If
        oRst.CursorType = ADODB.CursorTypeEnum.adOpenStatic 'adOpenKeyset
        oRst.CursorLocation = ADODB.CursorLocationEnum.adUseClient
        oRst.LockType = ADODB.LockTypeEnum.adLockOptimistic
        If Trim(TabName) <> "" Then
            strSQL = " Select * from " & TabName
        Else
            strSQL = Sql
        End If
        If Trim(whereClass) <> "" Then
            strSQL = strSQL & " where " & whereClass
        End If
        If strSQL = "" Then
        Else
            'oRst.Source = strSQL
            If InStr(UCase(strSQL), "WHERE") > 0 Then
                strSQL = Replace(strSQL, "where", "where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and ")
            Else
                strSQL = strSQL & " where co_Code='" & mCoCode & "' and br_Code=" & mBrCode
            End If
            oRst.ActiveConnection = lCnn
            oRst.Open (strSQL) 'Options:=adCmdText
            oRst.ActiveConnection = Nothing
        End If
        Set GetRec = oRst
        Exit Function
        'Set rst = Nothing
errFlag:
        If errTrack(Err.Description) And errCount = 1 Then
            errCount = errCount + 1
            lCnn.Close
            lCnn = OpenConnection()
            GoTo errFlag1
        Else
            MsgBox Err.Description, MsgBoxStyle.Critical, DrName
            End
        End If
End Function
Function writeChkFile(text As String, fileName As String)
    Dim iFile As Integer
    iFile = FreeFile
    Open App.Path & "\" & fileName For Output As #iFile
    Print #iFile, text
    Close #iFile
End Function
Public Function NumToWords(ByVal Num As Double) As String
Dim iCurrency As Long, iCoin As Long
    iCurrency = Int(Num)
    iCoin = (Num - iCurrency) * 100
    NumToWords = "Rupees " & ConvertToWords(iCurrency) & IIf(iCoin = 0, "", "and paise " & ConvertToWords(iCoin))
End Function
Public Function ConvertToWords(ByVal Num As Long) As String
Dim Digits As Integer, Number As Integer, Buffer As String, Buffer2 As String
Dim Words(0 To 5)
Words(0) = "hundreds "
Words(1) = "thousands "
Words(2) = "lakhs "
Words(3) = "crores "
      Do While Num <> 0
        If Digits = 2 Then
            Number = Num - Int(Num / 10) * 10
            Num = Int(Num / 10)
            Digits = Digits + 1
        Else
            Number = Num - Int(Num / 100) * 100
            Num = Int(Num / 100)
            Digits = Digits + 2
        End If
        Buffer2 = ""
        Select Case Digits
         Case 3
             Buffer2 = "hundred "
         Case 5
             Buffer2 = "thousand "
         Case 7
             Buffer2 = "lakh "
         Case 9
             Buffer2 = "crore "
             Digits = 2
        End Select
        Buffer = ConvertWord(Number)
        If Trim(Buffer) <> "" Then Buffer = Buffer & Buffer2
        If Trim(ConvertToWords) <> "" Then
            ConvertToWords = Buffer & ConvertToWords
        Else
            ConvertToWords = Buffer
        End If
      Loop
End Function
Function ConvertWord(ByVal Num As Long) As String
Dim Words(0 To 27)
    Words(0) = ""
    Words(1) = "one "
    Words(2) = "two "
    Words(3) = "three "
    Words(4) = "four "
    Words(5) = "five "
    Words(6) = "six "
    Words(7) = "seven "
    Words(8) = "eight "
    Words(9) = "nine "
    Words(10) = "ten "
    Words(11) = "eleven "
    Words(12) = "twelve "
    Words(13) = "thirteen "
    Words(14) = "forteen "
    Words(15) = "fifteen "
    Words(16) = "sixteen "
    Words(17) = "seventeen "
    Words(18) = "eighteen "
    Words(19) = "ninteen "
    Words(20) = "twenty "
    Words(21) = "thirt y"
    Words(22) = "forty "
    Words(23) = "fifty "
    Words(24) = "sixty "
    Words(25) = "seventy "
    Words(26) = "eighty "
    Words(27) = "ninety "
    If Num <= 20 Then
        ConvertWord = Words(Num)
    Else
        ConvertWord = " " & Words(Int(Num / 10) + 18) & Words(Num - Int(Num / 10) * 10)
    End If
End Function
Function errTrack(ByVal errString As String) As Boolean
    If InStr(UCase(errString), "MYSQL SERVER") > 0 Then
        errTrack = True
    ElseIf InStr(UCase(errString), UCase("Lost connection to MySQL server during query")) > 0 Then
        errTrack = True
    ElseIf InStr(UCase(errString), UCase("ODBC driver does not support the requested properties.")) > 0 Then
        errTrack = True
    ElseIf InStr(UCase(errString), UCase("Unspecified error")) > 0 Then
        errTrack = True
    Else
        errTrack = False
    End If
End Function
Function isFieldExists(ByVal fldName As String, ByVal tableName As String) As Boolean
    Dim oRs As ADODB.Recordset
   Set oRs = GetRec("", "SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_SCHEMA='" & mdBase & "' AND TABLE_NAME  = '" & tableName & "' and COLUMN_NAME='" & fldName & "'", "")
    If Not oRs.EOF Then
        isFieldExists = True
    Else
        isFieldExists = False
    End If
End Function

    Function getFocusDBIP() As String
        Sheets(1).Select
        If Range("AZ8").Value = "" Then
            getFocusDBIP = "182.18.157.147"
        Else
            getFocusDBIP = Range("AZ8").Value
        End If
    End Function
Attribute VB_Name = "Module6"
Public BCDTotal As Double
Public ADDTotal As Double
Public CVDTotal As Double
Public SWCTotal As Double
Public EduCusTotal As Double
Public hEduCusTotal As Double
Public EduCVDTotal As Double
Public hEduCVDTotal As Double
Public ACVDTotal As Double
Public NCDTotal As Double
Public TTATotal As Double
Public Sch2Total As Double
Public GSIATotal As Double
Public HealthCvdTotal As Double
Public HealthTotal As Double
Public AggrTotal As Double
Public SGDTotal  As Double
Public CESSTotal As Double
Public SVBTotal As Double
Public OverTotal As Double
Public OverAssValue As Double
Public OverDuty As Double
Public BCDFtotal As Double
Public ADDFTotal As Double
Public CVDFTotal As Double
Public SWCFTotal As Double
Public EduCusFTotal As Double
Public hEduCusFTotal As Double
Public EduCVDFTotal As Double
Public hEduCVDFTotal As Double
Public ACVDFTotal As Double
Public Sch2FTotal As Double
Public GSIAFTotal As Double
Public HealthCvdFTotal As Double
Public TTAFTotal As Double
Public NCDFTotal As Double
Public CESSFTotal As Double
Public HealthFTotal As Double
Public AggrFTotal As Double
Public SGDFTotal As Double
Public SVBFtotal As Double
Public OverFTotal As Double
Public mCVDFlag As Boolean
Public mACVDFlag As Boolean
Public Igm_no As String
Public Igm_date As String
Public isXBond As Boolean
Public GPreJobNo As String
Public GPreJobYear As Integer
Public mRevDep As Double
Public mCoCode As String
Public mBrCode As Integer
Public mYear As Integer
Public mDB As String
Public mDBPath As String
Public IGSTTotal As Double
Public IGSTFTotal As Double
Public IGSTCessTotal As Double
Public IGSTFCessTotal As Double
Public IGSTGTotal As Double
Public IGSTGCessTotal As Double
Public isPDBond As Boolean

'Global Databases

Dim rsScheme As ADODB.Recordset
Sub my_Work(CoCode As String, BrCode As String, qYear As String, JobNo As String, ByVal Server As String, db As String, User As String, Pass As String, port As String, dbType As String, dbPath As String)
Dim ChkLists As String
Dim rsPort As ADODB.Recordset
Dim Rs1 As ADODB.Recordset, Rs2 As ADODB.Recordset, rs3 As ADODB.Recordset, strRange As Double
Dim Rs4 As ADODB.Recordset, itemScheme As String, schRs As ADODB.Recordset
Dim sBCD As Double, sCVD As Double, EduBCD As Double, sEduCVD As Double, sACVD As Double, sNCD As Double, sGSI As Double, sTTA As Double, sSch2 As Double
Dim xLoad As Double, xMisc As Double
Dim mDebtDuty As String
Dim dbkValInr As String
Dim totFOB As Double, totFC As Double
mCoCode = CoCode
mBrCode = Int(Val(BrCode))
mYear = Int(Val(qYear))
mServer = Server
mdBase = db
mUser = User
mPass = Pass
mPort = port
mDB = dbType
mDBPath = dbPath
sPDFFile = ActiveWorkbook.Path & Application.PathSeparator & Replace(ThisWorkbook.Name, Right(ThisWorkbook.Name, Len(ThisWorkbook.Name) - InStrRev(ThisWorkbook.Name, ".") + 1), "")

'opening DBs
Set rsScheme = sGetRec("i_Scheme_Imp", "", "")

Sheets(2).Range("B1").Value = Sheets(1).Range("AZ6").Value
Sheets(2).Range("B2").Value = Sheets(1).Range("AZ7").Value
Worksheets("Sheet2").Range("B1").Locked = True
Sheets(2).Protect Password:="shrisira1207"

Sheets(1).Select
'MsgBox mCoCode & "," & mBrCode & "," & mYear & "," & mServer & "," & mdBase & "," & mUser & "," & mPass & "," & mPort, vbCritical, ""
With GetRec("b_Header", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "'")
  If Not .EOF Then
    Dim wareHouseCode
    wareHouseCode = ""
    Range("A5:I5").Merge
    Range("A5:I5").HorizontalAlignment = xlCenter
    If !BeType = "H" Then
        Range("A5:i5") = "BILL OF ENTRY FOR HOME CONSUMPTION - CHECKLIST"
    ElseIf !BeType = "W" Then
        Range("A5:I5") = "BILL ENTRY FOR WAREHOUSE - CHECKLIST"
        wareHouseCode = .Fields("BeWhCode").Value & ""
    ElseIf !BeType = "X" Then
        Range("A5:I5") = "BILL ENTRY FOR EX-BOND - CHECKLIST"
        isXBond = True
        GPreJobNo = !PreJobNo & ""
         GPreJobYear = !PreJobYear & ""
    Else
        Range("A5:I5") = "BILL ENTRY FOR UNKNOWN - CHECKLIST"
    End If
    mRevDep = Val(.Fields("RevDep").Value & "")
    Range("A6:B6").Merge
    Range("A6:B6").HorizontalAlignment = xlLeft
    Range("A6:B6") = "[Custom Stn :" & !BePortFile & "]"
    Range("A7:I7").Merge
    Range("A7").HorizontalAlignment = xlLeft
    If Not GetRec("b_Bond", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' and Bond_Code='PD'").EOF Then
        isPDBond = True
    Else
        isPDBond = False
    End If
    Dim Dkt123 As Long
    Dkt123 = !DocketNo & ""
    If Val(Dkt123) > 0 Then
        Dim rsDkt123 As ADODB.Recordset
        Set rsDkt123 = GetRec("b_docket", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and dkt_No=" & Dkt123 & "")
        If Not rsDkt123.EOF Then
            Range("A7") = "BE No./Dt./CC/Type/DktRefNo/Dt./JobNo :" & !BeNo & "/" & !BEDate & "/" & !BEClassCode & "/" & !BeType & "/" & rsDkt123.Fields("dktRefNo").Value & "" & "/" & Format(rsDkt123.Fields("dktRefDate").Value & "", "DD/MM/YYYY") & "/Job No:" & JobNo & " Date:" & Format(!BEJobYear, "DD/MM/YYYY")
        Else
            Range("A7") = "BE No./Dt./CC/Type/JobNo :" & !BeNo & "/" & !BEDate & "/" & !BEClassCode & "/" & !BeType & "/Job No:" & JobNo & " Date:" & Format(!BEJobYear, "DD/MM/YYYY")
        End If
    Else
        Range("A7") = "BE No./Dt./CC/Type/JobNo :" & !BeNo & "/" & !BEDate & "/" & !BEClassCode & "/" & !BeType & "/Job No:" & JobNo & " Date:" & Format(!BEJobYear, "DD/MM/YYYY")
    End If
'    Range("A7") = "BE No." & !BeNo & "" & "/Dt." & Format(!BEDate, "DD.MM.YYYY") & "/CC/Type/JobNo :" & !BeNo & "/" & !BEDate & "/" & !BEClassCode & "/" & !BeType & "/Job No:" & JobNo & " Date:" & Format(!BEJobYear, "DD/MM/YYYY")
    If !RefNo & "" <> "" Then
        Range("A8:i8").Merge
        Range("A8").HorizontalAlignment = xlLeft
        Range("A8").Font.Bold = True
        Range("A8").Value = "Reference No.:" & !RefNo
    End If
    'Importer Details
    Range("A9:i9").Merge
    Range("A9:i9").HorizontalAlignment = xlLeft
    Range("A9") = "Importer Details :" & !BEIECode
    If isFieldExists("IEC_PAN", "b_Header") Then
        Range("A9") = Range("A9") & "(" & .Fields("IEC_PAN").Value & ")"
    End If
    Range("A10:i10").Merge
    Range("A10:i10").HorizontalAlignment = xlLeft
    Range("A10") = !BEImp_Name
    
    Range("A11:i11").Merge
    Range("A11:i11").HorizontalAlignment = xlLeft
    Range("A11") = !BEBrSrNo & "      :" & !BEImp_Add1
    
    Range("A12:i12").Merge
    Range("A12:i12").HorizontalAlignment = xlLeft
    Range("A12") = !BEImp_Add2
    
    Range("A13:i13").Merge
    Range("A13:i13").HorizontalAlignment = xlLeft
    Range("A13") = !BEImp_City & "-" & !BEPinCode
    
    Range("A14:i14").Merge
    Range("A14:i14").HorizontalAlignment = xlLeft
    If .Fields("HSS_BEADCode").Value & "" <> "" Then
        Range("A14") = "AD Code :" & !HSS_BEAdCode & " (taken from High Sea Sale IEC)"
        Range("A14").Font.ColorIndex = 11
    Else
        Range("A14") = "AD Code :" & !BEADCode & ""
    End If
    
    Range("A3:I3").Merge
    Range("A3:I3").HorizontalAlignment = xlCenter
    If !BETrnsprt = "A" Then
        Range("A3:I3") = !BePortFile_Name & " (Air Cargo)"
    ElseIf !BETrnsprt = "S" Then
        Range("A3:I3") = !BePortFile_Name & " (Sea Cargo)"
    ElseIf !BETrnsprt = "L" Then
        Range("A3:I3") = !BePortFile_Name & " (ICD Cargo)"
    ElseIf !BETrnsprt = "D" Then
        Range("A3:I3") = !BePortFile_Name & " (Land Cargo)"
    End If
    
    Range("A1:I1").Merge
    Range("A1").HorizontalAlignment = xlCenter
    Range("A1") = !CHA_Name & ""
    Range("A1").Font.Bold = True
    Range("C6:I6").Merge
    Range("C6").Select
    Range("C6").HorizontalAlignment = xlLeft
    Range("C6") = "CHA :" & !BeCHACode & " [" & !CHA_Name & "]"
    Range("C6").Font.ColorIndex = 11
    strRange = 16
    If !BeType = "X" And !PreJobNo & "" <> "" Then
        'Set Rs1 = GetRec("b_IGMS", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & GPreJobNo & "' order by IGMSLNO")
          Set Rs1 = GetRec("b_IGMS", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & GPreJobYear & " and BEDocNo='" & GPreJobNo & "' order by IGMSLNO")
    Else
        Set Rs1 = GetRec("b_IGMS", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "' order by IGMSLNO")
    End If
    If !BeType = "X" Then
        xLoad = Val(.Fields("BEAddonHSS").Value & "")
        xMisc = Val(.Fields("BeMiscLoad").Value & "")
    End If
    If Not Rs1.EOF Then
        Do While Not Rs1.EOF
            Range("A" & strRange & ":B" & strRange).Merge
            Range("A" & strRange).HorizontalAlignment = xlLeft
            Range("A" & strRange) = "IGM No          :"
            Range("C" & strRange & ":D" & strRange).Merge
            Range("C" & strRange).HorizontalAlignment = xlLeft
            Igm_no = Rs1!IGMNo & ""
            Range("C" & strRange) = Rs1!IGMNo & "  " & Format(Rs1!IGMDate, "DD/MM/YYYY")
            Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = "Inward date     :"

            Range("C" & strRange + 1) = "'" & Format(Rs1!IGMInvardDate, "dd/mm/yyyy") '& "/" & Format(Month(Rs1!IGMInvardDate), "##") & "/" & Format(Year(Rs1!IGMInvardDate), "####")
            Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
            Range("A" & strRange + 2).HorizontalAlignment = xlLeft
            Range("A" & strRange + 2) = "Cntry of Orgn.  :"
            Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2) = !BeCountryOrg_Name & ""
            
            Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
            Range("A" & strRange + 3).HorizontalAlignment = xlLeft
            Range("A" & strRange + 3) = "BL/AWB No       :"
            Range("C" & strRange + 3 & ":D" & strRange + 3).Merge
            Range("C" & strRange + 3).HorizontalAlignment = xlLeft
            Range("C" & strRange + 3) = Rs1!IGMMAWBNo
            
            Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
            Range("A" & strRange + 4).HorizontalAlignment = xlLeft
            Range("A" & strRange + 4) = "Date            :"
            Range("C" & strRange + 4 & ":D" & strRange + 4).Merge
            Range("C" & strRange + 4).HorizontalAlignment = xlLeft
            Range("C" & strRange + 4) = "'" & Rs1!IGMMAWBDate
            Range("C" & strRange + 4).Select
            Range("C" & strRange + 4).NumberFormat = "DD/MM/YYYY"
            
            Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
            Range("A" & strRange + 5).HorizontalAlignment = xlLeft
            Range("A" & strRange + 5) = "No. of Pkgs.    :"
            Range("C" & strRange + 5 & ":D" & strRange + 5).Merge
            Range("C" & strRange + 5).HorizontalAlignment = xlLeft
            Range("C" & strRange + 5) = Format(Rs1!IGMNoofPkgs, "0.000") & Rs1!IGMPkgCode
            
            Range("A" & strRange + 6 & ":I" & strRange + 6).Merge
            Range("A" & strRange + 6).HorizontalAlignment = xlLeft
            Range("A" & strRange + 6) = "Marks           :" & Rs1!IGMMakrs_No1 & " " & Rs1!IGMMakrs_No2 & " " & Rs1!IGMMakrs_No3
            Range("A" & strRange + 7).HorizontalAlignment = xlLeft
            Range("A" & strRange + 7) = "Nos."
            
            If Rs1.Fields("IGM_PortOfRepo").Value & "" <> "" Then
                Dim PortName As String
                Set rsPort = sGetRec("", "Select PORT_NM from i_Port_Load where PORT_CD='" & Rs1.Fields("IGM_PortOfRepo").Value & "'", "")
                If Not rsPort.EOF Then
                    PortName = "(" & rsPort.Fields("PORT_NM").Value & ")"
                Else
                    PortName = ""
                End If
                rsPort.Close
                Set rsPort = Nothing
                Range("A" & strRange + 8 & ":B" & strRange + 8).Merge
                Range("A" & strRange + 8).HorizontalAlignment = xlLeft
                Range("A" & strRange + 8) = "Reporting Port  :"
                Range("C" & strRange + 8 & ":I" & strRange + 8).Merge
                Range("C" & strRange + 8).HorizontalAlignment = xlLeft
                Range("C" & strRange + 8) = "'" & Rs1.Fields("IGM_PortOfRepo").Value & " " & PortName
                'Range("A" & strRange + 8).Font.Bold = True
                'Range("C" & strRange + 8).Font.Bold = True
            End If
            
            Range("E" & strRange & ":F" & strRange).Merge
            Range("E" & strRange).HorizontalAlignment = xlLeft
            Range("E" & strRange) = "Port of Loading  :"
            Range("G" & strRange & ":H" & strRange).Merge
            Range("G" & strRange).HorizontalAlignment = xlLeft
            Range("G" & strRange) = !BeShpmntPort_Name & ""
            
            Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1) = "Port of Origin   :"
            Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1) = !BePortOrg_Name & ""
            
            Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
            Range("E" & strRange + 2).HorizontalAlignment = xlLeft
            Range("E" & strRange + 2) = "Cntry of Consign :"
            Range("G" & strRange + 2 & ":G" & strRange + 2).Merge
            Range("G" & strRange + 2).HorizontalAlignment = xlLeft
            Range("G" & strRange + 2) = !BeCountryConsignment_Name & ""
            
            Range("E" & strRange + 3 & ":F" & strRange + 3).Merge
            Range("E" & strRange + 3).HorizontalAlignment = xlLeft
            Range("E" & strRange + 3) = "H.BL/AWB No      :"
            Range("G" & strRange + 3 & ":H" & strRange + 3).Merge
            Range("G" & strRange + 3).HorizontalAlignment = xlLeft
            Range("G" & strRange + 3) = Rs1!IGMHAWBNo
            
            Range("E" & strRange + 4 & ":F" & strRange + 4).Merge
            Range("E" & strRange + 4).HorizontalAlignment = xlLeft
            Range("E" & strRange + 4) = "Date             :"
            Range("G" & strRange + 4 & ":H" & strRange + 4).Merge
            Range("G" & strRange + 4).HorizontalAlignment = xlLeft
            Range("G" & strRange + 4) = Rs1!IGMHAWBDate
            Range("G" & strRange + 4).Select
            Range("G" & strRange + 4).NumberFormat = "DD/MM/YYYY"
            
            Range("E" & strRange + 5 & ":F" & strRange + 5).Merge
            Range("E" & strRange + 5).HorizontalAlignment = xlLeft
            Range("E" & strRange + 5) = "Gross Wt.        :"
            Range("G" & strRange + 5 & ":I" & strRange + 5).Merge
            Range("G" & strRange + 5).HorizontalAlignment = xlLeft
            Range("G" & strRange + 5) = Format(Rs1!IGMGrsWeight, "0.000") & Rs1!IGMUnit
            strRange = strRange + 8
            If Rs1!IGM_GateWay_Date <> "" Then
                strRange = strRange + 1
                Range("A" & strRange & ":B" & strRange).Merge
                Range("A" & strRange).HorizontalAlignment = xlLeft
                Range("A" & strRange) = "Gateway IGM No  :"
                Range("C" & strRange & ":E" & strRange).Merge
                Range("C" & strRange).HorizontalAlignment = xlLeft
                Range("C" & strRange) = Rs1!IGM_GateWay_No & " Dated :" & Format(Rs1!IGM_GateWay_Date, "dd/mm/yyyy")
                Range("F" & strRange & ":G" & strRange).Merge
                Range("F" & strRange).HorizontalAlignment = xlLeft
                Range("F" & strRange) = "Port :" & Rs1!IGM_PortOfRepo
            End If
            strRange = strRange + 2
            Rs1.MoveNext
        Loop
        Rs1.Close
        Set Rs1 = Nothing
    End If
    If isXBond Then
        Range("A" & strRange & ":B" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Warehouse Code  :"
        Range("A" & strRange).Font.Color = RGB(255, 0, 0)
        Range("C" & strRange).HorizontalAlignment = xlLeft
        Range("C" & strRange) = !BeWhCode & ""
        Range("C" & strRange).Font.Color = RGB(255, 0, 0)
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = "Custom House     :"
        Range("E" & strRange).Font.Color = RGB(255, 0, 0)
        Range("G" & strRange) = !BeWhCusId
        Range("G" & strRange).Font.Color = RGB(255, 0, 0)
        
        Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
        Range("A" & strRange + 1).HorizontalAlignment = xlLeft
        Range("A" & strRange + 1) = "WH BE Number    :"
        Range("A" & strRange + 1).Font.Color = RGB(255, 0, 0)
        Range("C" & strRange + 1) = !BeWNo
        Range("C" & strRange + 1).Font.Color = RGB(255, 0, 0)
        Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlLeft
        Range("E" & strRange + 1) = "WH BE Date       :"
        Range("E" & strRange + 1).Font.Color = RGB(255, 0, 0)
        Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlLeft
        Range("G" & strRange + 1).NumberFormat = "DD/MM/YYYY"
        Range("G" & strRange + 1) = !BeWDate
        Range("G" & strRange + 1).Font.Color = RGB(255, 0, 0)
        
        Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
        Range("A" & strRange + 2).HorizontalAlignment = xlLeft
        Range("A" & strRange + 2) = "Number of PKG.  :"
        Range("A" & strRange + 2).Font.Color = RGB(255, 0, 0)
        Range("C" & strRange + 2) = Format(!BeNoPkg, "0.000") & " " & !BePkgCode & ""
        Range("C" & strRange + 2).Font.Color = RGB(255, 0, 0)
        Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
        Range("E" & strRange + 2).HorizontalAlignment = xlLeft
        Range("E" & strRange + 2) = "Gross weight     :"
        Range("E" & strRange + 2).Font.Color = RGB(255, 0, 0)
        Range("G" & strRange + 2 & ":H" & strRange + 2).Merge
        Range("G" & strRange + 2).HorizontalAlignment = xlLeft
        Range("G" & strRange + 2) = Format(!BeGWt, "0.000") & " " & !BeUnit & ""
        Range("G" & strRange + 2).Font.Color = RGB(255, 0, 0)
        Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
        Range("A" & strRange + 3).HorizontalAlignment = xlLeft
        Range("A" & strRange + 3) = "Load            :"
        Range("A" & strRange + 3).Font.Color = RGB(255, 0, 0)
        Range("C" & strRange + 3) = Format(xLoad, "0.000") & " INR"
        Range("C" & strRange + 3).Font.Color = RGB(255, 0, 0)
        Range("E" & strRange + 3 & ":F" & strRange + 3).Merge
        Range("E" & strRange + 3).HorizontalAlignment = xlLeft
        Range("E" & strRange + 3) = "Miscellaneous    :"
        Range("E" & strRange + 3).Font.Color = RGB(255, 0, 0)
        Range("G" & strRange + 3 & ":H" & strRange + 3).Merge
        Range("G" & strRange + 3).HorizontalAlignment = xlLeft
        Range("G" & strRange + 3) = Format(xMisc, "0.000") & " INR"
        Range("G" & strRange + 3).Font.Color = RGB(255, 0, 0)
        
        strRange = strRange + 5
    End If
    
    Range("A" & strRange & ":B" & strRange).Merge
    Range("A" & strRange).HorizontalAlignment = xlLeft
    Range("A" & strRange) = "Kachcha BE      :"
    Range("C" & strRange) = !BEKaccha
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
    Range("E" & strRange) = "Green channel    :"
    Range("G" & strRange) = !BEGreenChannal
    
    Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
    Range("A" & strRange + 1).HorizontalAlignment = xlLeft
    Range("A" & strRange + 1) = "High Sea Sale   :"
    Range("C" & strRange + 1) = !BEHighSeaSale
    Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
    Range("E" & strRange + 1).HorizontalAlignment = xlLeft
    Range("E" & strRange + 1) = "Section 48       :"
    Range("G" & strRange + 1) = !BeSection48

    Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
    Range("A" & strRange + 2).HorizontalAlignment = xlLeft
    If !bePrior = "A" Then
        Range("A" & strRange + 2) = "Advance BE      :"
        Range("C" & strRange + 2) = "Y"
    ElseIf !bePrior = "Y" Then
        Range("A" & strRange + 2) = "Prior BE        :"
        Range("C" & strRange + 2) = "Y"
    ElseIf !bePrior = "N" Then
        Range("A" & strRange + 2) = "Prior BE        :"
        Range("C" & strRange + 2) = "N"
    End If
    
    Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
    Range("E" & strRange + 2).HorizontalAlignment = xlLeft
    Range("E" & strRange + 2) = "First Check      :"
                                
    Range("G" & strRange + 2) = !BeFirstCheck

    Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
    Range("A" & strRange + 3).HorizontalAlignment = xlLeft
    Range("A" & strRange + 3) = "UCR No          :"
    Range("C" & strRange + 3) = !Ucr_No
    Range("E" & strRange + 3 & ":F" & strRange + 3).Merge
    Range("E" & strRange + 3).HorizontalAlignment = xlLeft
    Range("E" & strRange + 3) = "UCR Type         :"
    Range("G" & strRange + 3) = !Ucr_Type
    
    Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
    Range("A" & strRange + 4).HorizontalAlignment = xlLeft
    Range("A" & strRange + 4) = "Payment Method  :"
    Range("C" & strRange + 4) = !PaymentMethod
    If wareHouseCode <> "" Then
        Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
        Range("A" & strRange + 5).HorizontalAlignment = xlLeft
        Range("A" & strRange + 5) = "Warehouse Code  :"
        Range("C" & strRange + 5) = wareHouseCode
    
        Range("E" & strRange + 5 & ":F" & strRange + 5).Merge
        Range("E" & strRange + 5).HorizontalAlignment = xlLeft
        Range("E" & strRange + 5) = "Warehouse Name   :"
        Dim rsWH As ADODB.Recordset
        Set rsWH = sGetRec("warehouse_code", "", "Warehouse_Code='" & wareHouseCode & "'")
        If Not rsWH.EOF Then
            Range("G" & strRange + 5) = rsWH.Fields("Warehouse_Name").Value & ""
        Else
            Range("G" & strRange + 5) = ""
        End If
        strRange = strRange + 5
    Else
      strRange = strRange + 4
    End If
'        Range("A" & StrRange - 1 & ":L" & StrRange - 1).Borders(xlEdgeBottom).LineStyle = 1
'        StrRange = StrRange + 1
ajy = 0
'        'Invoice Details
    Dim rsCurr As New ADODB.Recordset
    Set rsCurr = GetRec("b_Currency", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "'")
    Set Rs1 = GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "' order by Inv_Sr_No")
    Rs1.ActiveConnection = Nothing
        If Not Rs1.EOF Then
            strRange = strRange + 2
            Rs1.MoveFirst
            Do While Not Rs1.EOF
                ajy = ajy + 1
                Range("A" & strRange & ":B" & strRange).Merge
                Range("A" & strRange).HorizontalAlignment = xlLeft
                Range("A" & strRange) = "Invoice Sl. No  :"
                Range("A" & strRange).Font.Bold = True
                
                Range("C" & strRange & ":E" & strRange).Merge
                Range("C" & strRange).HorizontalAlignment = xlLeft
                Range("C" & strRange) = Rs1!Inv_Sr_No
                Range("C" & strRange).Font.Bold = True
                Range("C" & strRange).NumberFormat = "0"
                
                Range("F" & strRange).HorizontalAlignment = xlLeft
                Range("F" & strRange) = "Supplier Details :"
                Range("F" & strRange).Font.Bold = True
                
                strRange = strRange + 1
                
                Range("A" & strRange & ":B" & strRange).Merge
                Range("A" & strRange).HorizontalAlignment = xlLeft
                Range("A" & strRange) = "Inv No & Dt     :"
                
                Range("C" & strRange & ":E" & strRange).Merge
                Range("C" & strRange).HorizontalAlignment = xlLeft
                Range("C" & strRange) = Rs1!Inv_No & "    " & Format(Rs1!Inv_Date, "dd/mm/yyyy")
                
                Range("F" & strRange & ":I" & strRange).Merge
                Range("F" & strRange).HorizontalAlignment = xlLeft
                Range("F" & strRange) = Rs1!Inv_Supplier_Name
                
                Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                Range("A" & strRange + 1) = "Inv Val         :"
                
                Range("C" & strRange + 1 & ":E" & strRange + 1).Merge
                Range("C" & strRange + 1).HorizontalAlignment = xlLeft
                Range("C" & strRange + 1) = Rs1!Inv_Value & " " & Rs1!Inv_Currency & "  TOI:" & Rs1!Inv_Terms   'Format(Rs1!Inv_Value, "0.00") & " " & Rs1!Inv_Currency & "  TOI:" & Rs1!Inv_Terms
                
                Range("F" & strRange + 1 & ":I" & strRange + 1).Merge
                Range("F" & strRange + 1).HorizontalAlignment = xlLeft
                Range("F" & strRange + 1) = Rs1!Inv_Supplier_Add1
                
                Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
                Range("A" & strRange + 2).HorizontalAlignment = xlLeft
                Range("A" & strRange + 2) = "Freight         :"
                
                Range("C" & strRange + 2 & ":E" & strRange + 2).Merge
                Range("C" & strRange + 2).HorizontalAlignment = xlLeft
                Range("C" & strRange + 2) = Format(FreAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & "  " & IIf(Rs1!Inv_Freight_Value > 0, Rs1!Inv_Frieght_Curr, "") & "  " & Format(Rs1!Inv_Freight_Rate, "0.000") & "%"
                
                Range("F" & strRange + 2 & ":I" & strRange + 2).Merge
                Range("F" & strRange + 2).HorizontalAlignment = xlLeft
                Range("F" & strRange + 2) = Rs1!Inv_Supplier_Add2
                
                Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
                Range("A" & strRange + 3).HorizontalAlignment = xlLeft
                Range("A" & strRange + 3) = "Insurance       :"
                
                Range("C" & strRange + 3 & ":E" & strRange + 3).Merge
                Range("C" & strRange + 3).HorizontalAlignment = xlLeft
                Range("C" & strRange + 3) = Format(InsAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00000") & "  " & IIf(Rs1!Inv_Ins_Value > 0, Rs1!Inv_Ins_Cur, "") & "  " & Format(Rs1!Inv_Ins_Rate, "0.00000") & "%"
                
                Range("F" & strRange + 3 & ":I" & strRange + 3).Merge
                Range("F" & strRange + 3).HorizontalAlignment = xlLeft
                Range("F" & strRange + 3) = Rs1!Inv_Supplier_Add3
                
                Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
                Range("A" & strRange + 4).HorizontalAlignment = xlLeft
                Range("A" & strRange + 4) = "Load            :"
                
                Range("C" & strRange + 4 & ":E" & strRange + 4).Merge
                Range("C" & strRange + 4).HorizontalAlignment = xlLeft
                Range("C" & strRange + 4) = Format(LoadAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & "  " & IIf(Rs1!Inv_Load_Value > 0, Rs1!Inv_Load_Cur, "") & Format(Rs1!Inv_Load_Rate, "0.000") & "%"
                
                Range("F" & strRange + 4 & ":I" & strRange + 4).Merge
                Range("F" & strRange + 4).HorizontalAlignment = xlLeft
                Range("F" & strRange + 4) = Rs1!Inv_Supplier_Country
                
                Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
                Range("A" & strRange + 5).HorizontalAlignment = xlLeft
                Range("A" & strRange + 5) = "Commission      :"
                
                Range("C" & strRange + 5 & ":E" & strRange + 5).Merge
                Range("C" & strRange + 5).HorizontalAlignment = xlLeft
                Range("C" & strRange + 5) = Format(CommAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & "  " & IIf(Rs1!Inv_Com_Value > 0, Rs1!Inv_Com_Cur, "") & Format(Rs1!Inv_Com_Rate, "0.000") & "%"
                
                Range("F" & strRange + 5 & ":I" & strRange + 5).Merge
                Range("F" & strRange + 5).HorizontalAlignment = xlLeft
                Range("F" & strRange + 5) = Rs1!Inv_Supplier_Pin
                
                Range("A" & strRange + 6 & ":B" & strRange + 6).Merge
                Range("A" & strRange + 6).HorizontalAlignment = xlLeft
                Range("A" & strRange + 6) = "SVB RefNo & Date:"
                
                If Rs1!Inv_SVB_Ref_No & "" <> "" Then
                    If Not IsNull(Rs1!Inv_SVB_Ref_No) Then
                        Dim SVBStatus As String
                        Range("C" & strRange + 6).HorizontalAlignment = xlLeft
                        If Rs1.Fields("Inv_Load_Status_AV").Value & "" <> "" Then
                            If Rs1.Fields("Inv_Load_Status_AV").Value = "P" Then
                                SVBStatus = "(Provisional on A.V)"
                            ElseIf Rs1.Fields("Inv_Load_Status_AV").Value = "F" Then
                                SVBStatus = "(Final on A.V.)"
                            End If
                        ElseIf Rs1.Fields("Inv_Load_Status_Duty").Value & "" <> "" Then
                            If Rs1.Fields("Inv_Load_Status_Duty").Value = "P" Then
                                SVBStatus = "(Provisional on Duty)"
                            ElseIf Rs1.Fields("Inv_Load_Status_Duty").Value = "F" Then
                                SVBStatus = "(Final on Duty)"
                            End If
                        End If
                        Range("C" & strRange + 6) = Rs1!Inv_SVB_Ref_No & "    " & Rs1!Inv_SVB_Reft_Date & SVBStatus
                    End If
                End If
                
                Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
                Range("A" & strRange + 7).HorizontalAlignment = xlLeft
                Range("A" & strRange + 7) = "SVB Load (Ass)  :"
                
                If Rs1!Inv_SVB_Ref_No & "" <> "" Then
                    If Not IsNull(Rs1!Inv_SVB_Value) Then
                        Range("C" & strRange + 7).HorizontalAlignment = xlLeft
                        Range("C" & strRange + 7) = Rs1!Inv_SVB_Value & " %"
                    End If
                End If
                
                Range("E" & strRange + 7 & ":F" & strRange + 7).Merge
                Range("E" & strRange + 7).HorizontalAlignment = xlLeft
                Range("E" & strRange + 7) = "Cust. House :"
                
                Range("G" & strRange + 7).HorizontalAlignment = xlLeft
                Range("G" & strRange + 7) = Rs1!Inv_Custom_Code
                
                Range("A" & strRange + 8 & ":B" & strRange + 8).Merge
                Range("A" & strRange + 8).HorizontalAlignment = xlLeft
                Range("A" & strRange + 8) = "SVB Load (Dty)  :"
                
                If Rs1!Inv_SVB_Ref_No & "" <> "" Then
                    If Not IsNull(Rs1!Inv_SVB_Duty) Then
                        Range("C" & strRange + 8).HorizontalAlignment = xlLeft
                        Range("C" & strRange + 8) = Rs1!Inv_SVB_Duty & " %"
                    End If
                End If
                
                Range("E" & strRange + 8 & ":I" & strRange + 8).Merge
                Range("E" & strRange + 8).HorizontalAlignment = xlLeft
                Range("E" & strRange + 8) = "HSS Load Rate:" & Rs1!Inv_HSS_Load_Rate & " Amount :" & Format(HSSAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & IIf(Rs1!Inv_HSS_Load_Amnt > 0, INR, "")
                
                If Rs1!Inv_Load_Status_AV = "P" Or Rs1!Inv_Load_Status_Duty = "P" Then
                    If InStr(Range("A5"), "(Provisional)") = 0 Then
                        Range("A5:i5") = Range("A5") & " (Provisional)"
                    End If
                Else
                    Range("A5:i5") = Replace(Range("A5"), " (Provisional)", "")
                End If
                
                
                Range("A" & strRange + 9 & ":B" & strRange + 9).Merge
                Range("A" & strRange + 9).HorizontalAlignment = xlLeft
                Range("A" & strRange + 9) = "Misc. Charges   :"
                
                Range("C" & strRange + 9 & ":D" & strRange + 9).Merge
                Range("C" & strRange + 9).HorizontalAlignment = xlLeft
                Range("C" & strRange + 9) = Format(MisAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & "  " & IIf(Rs1!Inv_Misc_Value > 0, Rs1!Inv_Misc_Cur, "") & Format(Rs1!Inv_Misc_Rate, "0.000") & "%"
                
                Range("E" & strRange + 9 & ":F" & strRange + 9).Merge
                Range("E" & strRange + 9).HorizontalAlignment = xlLeft
                Range("E" & strRange + 9) = "Other Misc. Charges   :"
                
                Range("G" & strRange + 9 & ":H" & strRange + 9).Merge
                Range("G" & strRange + 9).HorizontalAlignment = xlLeft
                Range("G" & strRange + 9) = Format(OthMisAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & " " & Rs1!Inv_Currency
            
                Range("A" & strRange + 10 & ":B" & strRange + 10).Merge
                Range("A" & strRange + 10).HorizontalAlignment = xlLeft
                Range("A" & strRange + 10) = "Discount        :"
                
                Range("C" & strRange + 10 & ":E" & strRange + 10).Merge
                Range("C" & strRange + 10).HorizontalAlignment = xlLeft
                Range("C" & strRange + 10) = Format(DisAmount(Str(JobNo), Rs1!Inv_Sr_No), "0.00") & "  " & IIf(Rs1!Inv_Dis_Amount > 0, "", "") & Format(Rs1!Inv_Dis_Rate, "0.000") & "%"
                
'new corrections
                Range("A" & strRange + 11 & ":B" & strRange + 11).Merge
                Range("A" & strRange + 11).HorizontalAlignment = xlLeft
                Range("A" & strRange + 11) = "Terms Place     :"
                
                Range("C" & strRange + 11 & ":E" & strRange + 11).Merge
                Range("C" & strRange + 11).HorizontalAlignment = xlLeft
                Range("C" & strRange + 11) = Rs1!Inv_Terms_Place & ""
                
                Range("F" & strRange + 11 & ":I" & strRange + 11).Merge
                Range("F" & strRange + 11).HorizontalAlignment = xlLeft
                'Range("F" & strRange + 11).Bold = True
                If Rs1!Inv_Third_Name & "" <> "" Then
                    Range("F" & strRange + 11) = "Third Party Details:"
                End If
                
                Range("A" & strRange + 12 & ":B" & strRange + 12).Merge
                Range("A" & strRange + 12).HorizontalAlignment = xlLeft
                Range("A" & strRange + 12) = "AEO Code        :"
                
                Range("C" & strRange + 12 & ":E" & strRange + 12).Merge
                Range("C" & strRange + 12).HorizontalAlignment = xlLeft
                Range("C" & strRange + 12) = Rs1!Inv_AEO_Code & ""
                
                Range("F" & strRange + 12 & ":I" & strRange + 12).Merge
                Range("F" & strRange + 12).HorizontalAlignment = xlLeft
                Range("F" & strRange + 12) = Rs1!Inv_Third_Name & ""
                                                             
                Range("A" & strRange + 13 & ":B" & strRange + 13).Merge
                Range("A" & strRange + 13).HorizontalAlignment = xlLeft
                Range("A" & strRange + 13) = "AEO Country     :"
                
                Range("C" & strRange + 13 & ":E" & strRange + 13).Merge
                Range("C" & strRange + 13).HorizontalAlignment = xlLeft
                Range("C" & strRange + 13) = Rs1!Inv_AEO_Country & ""
                
                Range("F" & strRange + 13 & ":I" & strRange + 13).Merge
                Range("F" & strRange + 13).HorizontalAlignment = xlLeft
                 Dim ThirdAdd As String
                If Rs1!Inv_Third_Add2 <> "" Then
                    ThirdAdd = Rs1!Inv_Third_Add1 & " ," & Rs1!Inv_Third_Add2 & ""
                Else
                    ThirdAdd = Rs1!Inv_Third_Add1 & ""
                End If
                Range("F" & strRange + 13) = ThirdAdd
                
                Range("A" & strRange + 14 & ":B" & strRange + 14).Merge
                Range("A" & strRange + 14).HorizontalAlignment = xlLeft
                Range("A" & strRange + 14) = "AEO Role        :"
                
                Range("C" & strRange + 14 & ":E" & strRange + 14).Merge
                Range("C" & strRange + 14).HorizontalAlignment = xlLeft
                Range("C" & strRange + 14) = Rs1!Inv_AEO_Role & ""
                
                Range("F" & strRange + 14 & ":I" & strRange + 14).Merge
                Range("F" & strRange + 14).HorizontalAlignment = xlLeft
                  Dim ThirdCity As String
                If Rs1!Inv_Third_PinCode <> "" Then
                    ThirdCity = Rs1!Inv_Third_City & " -" & Rs1!Inv_Third_PinCode & ""
                Else
                    ThirdCity = Rs1!Inv_Third_City & ""
                End If
                Range("F" & strRange + 14) = ThirdCity
                
                Range("A" & strRange + 15 & ":B" & strRange + 15).Merge
                Range("A" & strRange + 15).HorizontalAlignment = xlLeft
                Range("A" & strRange + 15) = "buyer and seller related:"
                
                Range("C" & strRange + 15 & ":E" & strRange + 15).Merge
                Range("C" & strRange + 15).HorizontalAlignment = xlLeft
                Range("C" & strRange + 15) = Rs1!INV_Buyer_Seller_Relation & ""
                
                Range("F" & strRange + 15 & ":I" & strRange + 15).Merge
                Range("F" & strRange + 15).HorizontalAlignment = xlLeft
                 Dim ThirdCountry As String
                If Rs1!Inv_Third_PinCode <> "" Then
                    ThirdCountry = Rs1!Inv_Third_CountryCode & " -" & Rs1!Inv_Third_CntrySubDiv & ""
                Else
                    ThirdCountry = Rs1!Inv_Third_CountryCode & ""
                End If
                Range("F" & strRange + 15) = ThirdCountry
                
                Dim mCur As String
                Dim rsCurrBuffer As New ADODB.Recordset
                Set rsCurrBuffer = rsCurr.Clone
                rsCurrBuffer.Filter = "Inv_Sr_No=" & Rs1("Inv_Sr_No") & " and CURR_CD='" & Rs1!Inv_Currency & "'"
                If Not rsCurrBuffer.EOF Then
                    mCur = rsCurrBuffer.Fields("CURR_RATE_IMP").Value & ""
                Else
                    mCur = ""
                End If
                rsCurrBuffer.Filter = ""
                rsCurrBuffer.Close
                Range("A" & strRange + 16 & ":I" & strRange + 16).Merge
                Range("A" & strRange + 16).HorizontalAlignment = xlRight
                Range("A" & strRange + 16) = "Exchange Rate :   1.00  " & Rs1!Inv_Currency & " = " & mCur
                
                strRange = strRange + 17
'                ' Item Details
                Range("A" & strRange + 1 & ":I" & strRange + 1).Merge
                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                Range("A" & strRange + 1) = "Item Details"
                Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 1
                strRange = strRange + 1
                
                strRange = fill_Item_Details(JobNo, Rs1!Inv_Sr_No, strRange)
                    
                Rs1.MoveNext
                    BCDTotal = 0
                    ADDTotal = 0
                    CVDTotal = 0
                    SWCTotal = 0
                    EduCusTotal = 0
                    hEduCusTotal = 0
                    EduCVDTotal = 0
                    hEduCVDTotal = 0
                    ACVDTotal = 0
                    Sch2Total = 0
                    GSIATotal = 0
                    TTATotal = 0
                    NCDTotal = 0
                    CESSTotal = 0
                    HealthTotal = 0
                    AggrTotal = 0
                    SGDTotal = 0
                    SVBTotal = 0
                    OverTotal = 0
                    IGSTTotal = 0
                    IGSTCessTotal = 0
            Loop
            If ajy > 1 Then
                totFAV = Val(GetRec("", "Select sum(Assvalue) as TotAssValue from b_AssValue where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "'", "")!TotAssValue)
                OverFTotal = BCDFtotal + ADDFTotal + CVDFTotal + EduCusFTotal + hEduCusFTotal + EduCVDFTotal + hEduCVDFTotal + ACVDFTotal + Sch2FTotal + GSIAFTotal + HealthCvdFTotal + TTAFTotal + NCDFTotal + CESSFTotal + SGDFTotal + AggrFTotal + HealthFTotal + IGSTFTotal + IGSTFCessTotal + SWCFTotal
                
                Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                Range("A" & strRange + 1) = "Ass. Value :"
                Range("A" & strRange + 1).Font.Bold = True
                Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
                Range("C" & strRange + 1).HorizontalAlignment = xlRight
                Range("C" & strRange + 1) = "Rs." & Format(totFAV, "0.00")
                Range("C" & strRange + 1).Font.Bold = True
                Range("C" & strRange + 1).Font.ColorIndex = 11
                Range("F" & strRange + 1 & ":G" & strRange + 1).Merge
                Range("F" & strRange + 1).HorizontalAlignment = xlLeft
                Range("F" & strRange + 1) = "Duty Payable:"
                Range("F" & strRange + 1).Font.Bold = True
                Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
                Range("H" & strRange + 1).HorizontalAlignment = xlRight
                Range("H" & strRange + 1) = "Rs." & Format(OverFTotal, "0.00")
                Range("H" & strRange + 1).Font.Bold = True
                Range("H" & strRange + 1).Font.ColorIndex = 11
                Range("A" & strRange + 2 & ":I" & strRange + 2).Merge
                Range("A" & strRange + 2).HorizontalAlignment = xlLeft
                Range("A" & strRange + 2).Font.Bold = True
                If OverFTotal > 0 Then
                    Range("A" & strRange + 2) = NumToWords(OverFTotal) & "Only"
                Else
                    Range("A" & strRange + 2) = "Rs. Zero Only"
                End If
            End If
            strRange = strRange + 1
            ajy = 0
'        End If
    End If
    Call ePortion(Trim(Str(JobNo)), strRange)
  End If
End With
ActiveWorkbook.Save
On Error Resume Next
    totPages = ActiveSheet.PageSetup.Pages.Count
    If Dir(sPDFFile & ".pdf", vbNormal) <> "" Then Kill sPDFFile & ".pdf"
    ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, fileName:=sPDFFile & ".pdf", Quality:=xlQualityStandard, To:=totPages, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
End Sub
Sub SetArea(EndArea)
    Range("A1:" & EndArea).Font.Name = "Courier New"
    If Range("AZ4") <> "" Then
        Range("A1:" & EndArea).RowHeight = Range("AZ4")
    Else
        Range("A1:" & EndArea).RowHeight = 11
    End If
    'Range("A1:" & endArea).Font.Bold = True
    If Range("AZ3") <> "" Then
        Range("A1:" & EndArea).Font.Size = Range("AZ3")
    Else
        Range("A1:" & EndArea).Font.Size = 10
    End If
        Range("A1").Font.Size = 14
        Range("A1").RowHeight = 15
    ActiveSheet.PageSetup.PrintArea = Range("A1", Range(EndArea)).Address
'    Range("A1:" & endArea).Borders(xlEdgeBottom).LineStyle = 7
End Sub
Function FreAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double, MisAmount As Double, OthMisAmount As Double
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Freight_Value = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount & "")
            OthMisAmount = getOthMisFC(JobNo, InvNo, ItemAmount, 0, 0)
            If !Inv_Misc_Cur = "INR" Then
                MisAmount = !Inv_Misc_Value / Val(GetRec("b_Currency", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & !Inv_Sr_No & " and CURR_CD='" & !Inv_Currency & "'")!CURR_RATE_IMP)
            Else
                MisAmount = !Inv_Misc_Value
            End If
            FreAmount = (ItemAmount + MisAmount) * (!Inv_Freight_Rate / 100)
        Else
            FreAmount = !Inv_Freight_Value
        End If
      End If
    End With
End Function

Function InsAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double, MisAmount As Double, OthMisAmount As Double
    
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Ins_Value = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount & "")
            OthMisAmount = getOthMisFC(JobNo, InvNo, ItemAmount, 0, 0)
            If !Inv_Misc_Cur = "INR" Then
                MisAmount = !Inv_Misc_Value / Val(GetRec("b_Currency", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & !Inv_Sr_No & " and CURR_CD='" & !Inv_Currency & "'")!CURR_RATE_IMP)
            Else
                MisAmount = !Inv_Misc_Value
            End If
            InsAmount = (ItemAmount + MisAmount + OthMisAmount) * (!Inv_Ins_Rate / 100)
        Else
            InsAmount = !Inv_Ins_Value
        End If
      End If
    End With
End Function

Function MisAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Misc_Value = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount & "")
            MisAmount = (ItemAmount) * (!Inv_Misc_Rate / 100)
        Else
            MisAmount = !Inv_Misc_Value
        End If
      End If
    End With
End Function

Function LoadAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Load_Value = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount & "")
            LoadAmount = (ItemAmount) * (!Inv_Load_Rate / 100)
        Else
            LoadAmount = !Inv_Load_Value
        End If
      End If
    End With
End Function

Function CommAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Com_Value = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount & "")
            CommAmount = (ItemAmount) * (!Inv_Com_Rate / 100)
        Else
            CommAmount = !Inv_Com_Value
        End If
      End If
    End With
End Function

Function HSSAmount(JobNo As String, InvNo As Integer)
    Dim ItemAmount As Double, mAssVal As Double, lnd As Double
    Dim MiscAmount As Double
        With GetRec("", "Select HSSValue as expr from b_AssValue where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo, "")
            If Not .EOF Then
                HSSAmount = Val(.Fields("Expr").Value & "")
            Else
                HSSAmount = 0
            End If
    End With
    'HSSAmount = Val(GetRec("", "Select HSSValue as expr from b_AssValue where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo, "").Fields("Expr").Value & "")
'    With GetRec("b_Invoice", "", "BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
'      If Not .EOF Then
'        If !Inv_HSS_Load_Amnt = 0 Then
'            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount)
'            If Inv_Misc_Value <> "" Then
'                If !Inv_Misc_Cur <> invCurr Then
'                    MiscAmount = !Inv_Misc_Value * Val(GetRec("b_Currency", "", "BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & !Inv_Sr_No & " and CURR_CD='" & !Inv_Misc_Cur & "'")!CURR_RATE_IMP & "") / Val(GetRec("b_Currency", "", "BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & !Inv_Sr_No & " and CURR_CD='" & invCurr & "'")!CURR_RATE_IMP & "")
'                Else
'                    MiscAmount = !Inv_Misc_Value
'                End If
'            End If
'            mAssVal = FreAmount(JobNo, InvNo) + InsAmount(JobNo, InvNo) + MiscAmount
'            lnd = ((ItemAmount - DisAmount(JobNo, InvNo)) + mAssVal + SVBTotal + CommAmount(JobNo, InvNo)) * Val(.Fields("Inv_Landing_Rate").Value & "") / 100
'            'lnd = (Val(GetRec("", "select Sum(Assvalue)as TotAmount from b_AssValue where BEDocNo='" & Trim(Str(JobNo)) & "' and Inv_Sr_No=" & InvNo, "").Fields("totAmount").Value & "") * 100) / (100 + Val(.Fields("Inv_Landing_Rate").Value & ""))
'            'mAssVal = Val(GetRec("", "select Sum(Assvalue)as TotAmount from b_AssValue where BEDocNo='" & Trim(Str(JobNo)) & "' and Inv_Sr_No=" & InvNo, "").Fields("TotAmount").Value & "")
'            HSSAmount = (ItemAmount + mAssVal + lnd) * (!Inv_HSS_Load_Rate / 100) * !Inv_Rate
'        Else
'            HSSAmount = !Inv_HSS_Load_Amnt
'        End If
'      End If
'    End With
End Function
Function DisAmount(JobNo As String, InvNo As String)
    Dim ItemAmount As Double
    With GetRec("b_Invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
      If Not .EOF Then
        If !Inv_Dis_Amount = 0 Then
            ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "")!totAmount)
            DisAmount = (ItemAmount) * (!Inv_Dis_Rate / 100) * !Inv_Rate
        Else
            DisAmount = !Inv_Dis_Amount
        End If
      End If
    End With
End Function
Function PrintContainerDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_Container", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "'")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Container Details"
        Range("A" & strRange).Font.Bold = True
        strRange = strRange + 1
        x = 0
        Do While Not .EOF
            x = x + 1
            Range("A" & strRange) = x
            Range("A" & strRange).HorizontalAlignment = xlLeft
            'Range("B" & strRange) = !Container_IGM_No
            Dim IGMNo As String
            If .Fields("Container_IGM_SlNo").Value & "" <> "" Then
                IGMNo = GetRec("b_IGMS", "", "yCode=" & mYear & " and BEDocNo='" & JobNo & "' and IGMSLNO=" & .Fields("Container_IGM_SlNo").Value).Fields("IgmNo").Value & ""
            End If
            Range("B" & strRange) = IGMNo
            Range("B" & strRange).HorizontalAlignment = xlLeft
            Range("C" & strRange) = !Container_Type
            Range("C" & strRange).HorizontalAlignment = xlLeft
            Range("D" & strRange) = !Container_Number
            Range("D" & strRange).HorizontalAlignment = xlLeft
            Range("F" & strRange) = !Container_Seal_No
            Range("F" & strRange).HorizontalAlignment = xlLeft
            Range("G" & strRange) = "'" & !Container_Truck_No & ""
            Range("G" & strRange).HorizontalAlignment = xlLeft
            Dim cont_size As String
            cont_size = !Container_Size & ""
            If cont_size <> "" Then
                Range("H" & strRange) = !Container_Size & ""
                Range("H" & strRange).HorizontalAlignment = xlLeft
            End If
            
            strRange = strRange + 1
            .MoveNext
        Loop
        PrintContainerDetails = strRange + 1
      Else
        PrintContainerDetails = strRange
      End If
    End With
End Function
Function DEPBDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_DEPB", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No, Item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":L" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Scheme Notifications"
        Range("A" & strRange & ":L" & strRange).Borders(xlEdgeBottom).LineStyle = 1
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
        Range("C" & strRange + 1) = "Status"
        Range("E" & strRange + 1 & ":G" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlLeft
        Range("E" & strRange + 1) = "Notification No."
        Range("I" & strRange + 1 & ":J" & strRange + 1).Merge
        Range("I" & strRange + 1).HorizontalAlignment = xlLeft
        Range("I" & strRange + 1) = "Sl No."
        Range("A" & strRange + 1 & ":L" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 1
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1) = !Item_No
            Range("C" & strRange + 1) = !Req_Status
            Range("E" & strRange + 1 & ":G" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1) = !BCB_Ntfn
            Range("I" & strRange + 1 & ":J" & strRange + 1).Merge
            Range("I" & strRange + 1).HorizontalAlignment = xlLeft
            Range("I" & strRange + 1) = !BCB_Ntfn_Sl_No
            strRange = strRange + 1
            .MoveNext
        Loop
        Range("A" & strRange & ":L" & strRange).Borders(xlEdgeBottom).LineStyle = 1
        DEPBDetails = strRange + 1
      Else
        DEPBDetails = strRange
      End If
    End With
End Function
Function LicDetails(JobNo As String, strRange As Double) As Double
    Dim totDbVal As Double, totDbDuty As Double
    With GetRec("b_License", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No, Item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "License Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
        Range("A" & strRange + 1).HorizontalAlignment = xlCenter
        Range("A" & strRange + 1) = "Inv/Item No/Lic SlNo"
        
        Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Reg No/Date/Regn.Port"
        
        Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlCenter
        Range("E" & strRange + 1) = "Debit Val/Qty"
        
        Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("H" & strRange + 1).HorizontalAlignment = xlCenter
        Range("H" & strRange + 1) = "Debit Duty"
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = "'" & !Inv_No & " / " & !Item_No & "/" & !Lic_Sr_No
            
            Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !RegnNo & " (" & !RegnDate & ")"
            Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2).Select
            'Range("C" & strRange + 2).NumberFormat = "DD/MM/YYYY"
            Range("C" & strRange + 2) = !Lic_Port
            
            Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1).Select
            Range("E" & strRange + 1).NumberFormat = "0.00"
            Range("E" & strRange + 1) = !Debt_Value
            totDbVal = totDbVal + Val(Range("E" & strRange + 1))
            Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
            Range("E" & strRange + 2).HorizontalAlignment = xlLeft
            Range("E" & strRange + 2).Select
            Range("E" & strRange + 2).NumberFormat = "0.00"
            Range("E" & strRange + 2) = Format(!Debt_Qty & "", "0.000") & " " & (!Unit & "")
            
            Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
            Range("H" & strRange + 1).HorizontalAlignment = xlRight
            Range("H" & strRange + 1).Select
            Range("H" & strRange + 1).NumberFormat = "0.00"
            Range("H" & strRange + 1) = !Debit_Duty
            totDbDuty = totDbDuty + Val(Range("H" & strRange + 1))
            'Range("H" & strRange + 2 & ":I" & strRange + 1).Merge
            'Range("H" & strRange + 2).HorizontalAlignment = xlLeft
            'Range("H" & strRange + 2).Select
            'Range("H" & strRange + 2).NumberFormat = "0.00"
            'Range("H" & strRange + 2) = !
            strRange = strRange + 2
            .MoveNext
        Loop
        Range("A" & strRange & ":I" & strRange).Borders(xlEdgeBottom).LineStyle = 1
        Range("A" & strRange + 2 & ":D" & strRange + 2).Merge
        Range("A" & strRange + 2).HorizontalAlignment = xlRight
        Range("A" & strRange + 2) = "Total    "
        Range("A" & strRange + 2).Font.Bold = True
        
        Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
        Range("E" & strRange + 2).HorizontalAlignment = xlLeft
        Range("E" & strRange + 2).NumberFormat = "0.00"
        Range("E" & strRange + 2) = Format(totDbVal, "0.00")
        Range("E" & strRange + 2).Font.Bold = True
        
        Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("H" & strRange + 2).HorizontalAlignment = xlRight
        Range("H" & strRange + 2).NumberFormat = "0.00"
        Range("H" & strRange + 2) = Format(totDbDuty, "0.00")
        Range("H" & strRange + 2).Font.Bold = True
        LicDetails = strRange + 3
      Else
        LicDetails = strRange
      End If
    End With
End Function

Function BondDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_Bond", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "'")
      If Not .EOF Then
        If !Bond_Code = "PD" Then
            If InStr(Range("A5"), "(Provisional)") = 0 Then
                Range("A5:i5") = Range("A5") & " (Provisional)"
            End If
        End If
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Bond / Certificate Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
        Range("A" & strRange + 1).HorizontalAlignment = xlCenter
        Range("A" & strRange + 1) = "Bond No"
        Range("C" & strRange + 1).HorizontalAlignment = xlLeft
        Range("C" & strRange + 1) = "Bond Code"
        Range("D" & strRange + 1).HorizontalAlignment = xlLeft
        Range("D" & strRange + 1) = "Port"
        Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlLeft
        Range("E" & strRange + 1) = "Certificate No"
        Range("G" & strRange + 1).HorizontalAlignment = xlLeft
        Range("G" & strRange + 1) = "Date"
        Range("I" & strRange + 1).HorizontalAlignment = xlLeft
        Range("I" & strRange + 1) = "Type"
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Bond_No
            If !Bond_No & "" <> "" Then
                Range("C" & strRange + 1) = !Bond_Code
            End If
            Range("D" & strRange + 1).HorizontalAlignment = xlLeft
            Range("D" & strRange + 1) = !Bond_Port
            Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1) = !Bond_Cert_No
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1).Select
            Selection.NumberFormat = "dd/mm/yyyy"
            Range("G" & strRange + 1) = !Bond_Cert_Date
            Range("I" & strRange + 1) = !Bond_Cert_Type & ""
            strRange = strRange + 1
            .MoveNext
        Loop
        BondDetails = strRange + 1
      Else
        BondDetails = strRange
      End If
    End With
End Function

Function TaxDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_CommTax", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "'")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Commercial Tax Declaration/IGST Declaration"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1).HorizontalAlignment = xlCenter
        Range("A" & strRange + 1) = "State"
        Range("B" & strRange + 1).HorizontalAlignment = xlLeft
        Range("B" & strRange + 1) = "Tax Type"
        Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlLeft
        Range("C" & strRange + 1) = "Registration No"
        Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlLeft
        Range("E" & strRange + 1).Value = "IGST AV"
        Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlLeft
        Range("G" & strRange + 1).Value = "IGST"
        Range("I" & strRange + 1).HorizontalAlignment = xlLeft
        Range("I" & strRange + 1).Value = "IGST Cess"
        
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !State_Code
            Range("B" & strRange + 1) = !Tax_Type
            Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !Tax_RgnNo
            Dim IGSTAV As Double
            IGSTAV = Val(GetRec("", "select sum(IGSTAV) as expr from b_AssValue where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BeDocNo='" & JobNo & "'", "").Fields("Expr").Value & "")
            Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1).Value = Format(Round(Val(IGSTAV), 1), "0.00")
            Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1).Value = Format(Round(Val(IGSTGTotal), 1), "0.00")
            Range("I" & strRange + 1).HorizontalAlignment = xlLeft
            Range("I" & strRange + 1).Value = Format(Round(Val(IGSTGCessTotal), 1), "0.00")
            strRange = strRange + 1
            .MoveNext
        Loop
        TaxDetails = strRange + 1
      Else
        TaxDetails = strRange
      End If
    End With
End Function

Function MiscDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_miscChg", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Miscelleneous Charges Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1).HorizontalAlignment = xlLeft
        Range("B" & strRange + 1) = "Misc.Code"
        Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Description"
        Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlRight
        Range("G" & strRange + 1) = "Amount"
        Range("I" & strRange + 1).HorizontalAlignment = xlRight
        Range("I" & strRange + 1) = "Rate"
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Misc_Charges_Code
            Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !Misc_Charges_Desc
            Range("G" & strRange + 1 & ":H" & strRange + 1).Merge
            Range("G" & strRange + 1).HorizontalAlignment = xlRight
            Range("G" & strRange + 1).Select
            Range("G" & strRange + 1).NumberFormat = "0.00"
            Range("G" & strRange + 1) = !Misc_Charges_amt
            Range("I" & strRange + 1).HorizontalAlignment = xlRight
            Range("I" & strRange + 1) = !Misc_Charges_Rate
            Range("I" & strRange + 1).Select
            Range("I" & strRange + 1).NumberFormat = "0.00"
            strRange = strRange + 1
            .MoveNext
        Loop
        MiscDetails = strRange + 1
      Else
        MiscDetails = strRange
      End If
    End With
End Function

Function perDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_Permission", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "'")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Permission Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1).HorizontalAlignment = xlLeft
        Range("A" & strRange + 1) = "Code"
        Range("B" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("B" & strRange + 1).HorizontalAlignment = xlLeft
        Range("B" & strRange + 1) = "Description"
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Permission_Code
            Range("B" & strRange + 1 & ":L" & strRange + 1).Merge
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = Left(!Permission_text, 100)
            strRange = strRange + 1
            .MoveNext
        Loop
        perDetails = strRange + 1
      Else
        perDetails = strRange
      End If
    End With
End Function
Function RSPDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_RSP", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "RSP Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
        Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Description of Item with Specification"
        Range("C" & strRange + 2 & ":F" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Notification No / Sl No"
        Range("G" & strRange + 1).HorizontalAlignment = xlCenter
        Range("G" & strRange + 1) = "NOU"
        Range("H" & strRange + 1) = "RSP(Rs/Ut)"
        Range("I" & strRange + 1).HorizontalAlignment = xlRight
        Range("I" & strRange + 1) = "Abtt."
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2

        strRange = strRange + 2
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
            Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !RSP_Desc
            Range("G" & strRange + 1).HorizontalAlignment = xlRight
            Range("G" & strRange + 1) = !RsP_Qty
            Range("H" & strRange + 1).HorizontalAlignment = xlRight
            Range("H" & strRange + 1) = !RSP
            Range("I" & strRange + 1).HorizontalAlignment = xlRight
            Range("I" & strRange + 1) = !RSP_Rebate
            If .Fields("RSP_Ntfn").Value & "" <> "" Then
                Range("C" & strRange + 2) = "Notification No" & .Fields("RSP_Ntfn").Value & " SL No." & .Fields("RSP_Ntfn_SlNo").Value & ""
                Range("C" & strRange + 2 & ":F" & strRange + 2).Merge
                Range("C" & strRange + 2).HorizontalAlignment = xlLeft
                strRange = strRange + 2
            Else
                strRange = strRange + 1
            End If
            .MoveNext
        Loop
        RSPDetails = strRange + 1
      Else
        RSPDetails = strRange
      End If
    End With
End Function


Function ManufacturerDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_item", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' and Itm_Manu_Code<>'' and Itm_Manu_Code is not null order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Manufacturer Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
       ' Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Name"
        'Range("C" & strRange + 2 & ":F" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Manu_Code"
        
        Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
        Range("D" & strRange + 1).HorizontalAlignment = xlCenter
        Range("D" & strRange + 1) = "Address"
        Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
        Range("D" & strRange + 2).HorizontalAlignment = xlCenter
        Range("D" & strRange + 2) = "Source Country"
        
        Range("F" & strRange + 1 & ":G" & strRange + 1).Merge
        Range("F" & strRange + 1).HorizontalAlignment = xlCenter
        Range("F" & strRange + 1) = "City"
        Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("F" & strRange + 2).HorizontalAlignment = xlCenter
        Range("F" & strRange + 2) = "Tramsit Country"
        
        'Range("H" & strRange + 1 & ":G" & strRange + 1).Merge
        Range("H" & strRange + 1).HorizontalAlignment = xlCenter
        Range("H" & strRange + 1) = "Country"
        'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("H" & strRange + 2).HorizontalAlignment = xlCenter
        Range("H" & strRange + 2) = "Acessory Status"
        
          'Range("H" & strRange + 1 & ":G" & strRange + 1).Merge
        Range("I" & strRange + 1).HorizontalAlignment = xlCenter
        Range("I" & strRange + 1) = "Sub Div"
        'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("I" & strRange + 2).HorizontalAlignment = xlCenter
        Range("I" & strRange + 2) = "CE Flag"
         Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 2
        Do While Not .EOF
            If !Itm_Manu_Code & "" <> "" Then
                 Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("A" & strRange + 1) = !Inv_No
                 Range("B" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("B" & strRange + 1) = !Item_No
                ' Range("C" & strRange + 1 & ":F" & strRange + 1).Merge
                 Range("C" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("C" & strRange + 1) = !Itm_Manu_Code
                  Range("C" & strRange + 2).HorizontalAlignment = xlLeft
                 Range("C" & strRange + 2) = !Itm_Manu_codeType & ""
                 
                 Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
                 Range("D" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("D" & strRange + 1) = !Itm_Manu_Add1 & ", " & !Itm_Manu_Add2 & ""
                 Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
                 Range("D" & strRange + 2).HorizontalAlignment = xlLeft
                 Range("D" & strRange + 2) = !Itm_Source_Cntry
                 
                  Range("F" & strRange + 1 & ":G" & strRange + 1).Merge
                 Range("F" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("F" & strRange + 1) = !Itm_Manu_City & " " & !Itm_Manu_Pin & ""
                 Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
                 Range("F" & strRange + 2).HorizontalAlignment = xlLeft
                 Range("F" & strRange + 2) = !Itm_Transit_Cntry & ""
                 
                 'Range("F" & strRange + 1 & ":F" & strRange + 1).Merge
                 Range("H" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("H" & strRange + 1) = !Itm_Manu_Cntry & ""
                 'Range("F" & strRange + 2 & ":F" & strRange + 2).Merge
                 Range("H" & strRange + 2).HorizontalAlignment = xlLeft
                 Range("H" & strRange + 2) = !Itm_Accessory_Status & ""
                 
                  'Range("F" & strRange + 1 & ":F" & strRange + 1).Merge
                 Range("I" & strRange + 1).HorizontalAlignment = xlLeft
                 Range("I" & strRange + 1) = !Itm_Manu_CntrySubDiv & ""
                 'Range("F" & strRange + 2 & ":F" & strRange + 2).Merge
                 Range("I" & strRange + 2).HorizontalAlignment = xlLeft
                 Range("I" & strRange + 2) = !Itm_CE_flag & ""
                 strRange = strRange + 2
            End If
            .MoveNext
        Loop
        ManufacturerDetails = strRange + 1
      Else
        ManufacturerDetails = strRange
      End If
    End With
End Function

Function InfoType(JobNo As String, strRange As Double) As Double
    With GetRec("b_info_type", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "InfoType Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
        Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Info Type"
        Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Info MSR"
        Range("C" & strRange + 3 & ":D" & strRange + 3).Merge
        Range("C" & strRange + 3).HorizontalAlignment = xlCenter
        Range("C" & strRange + 3) = "Info UQC"
        
        Range("E" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlCenter
        Range("E" & strRange + 1) = "Info Qualifier"
        Range("E" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("E" & strRange + 2).HorizontalAlignment = xlCenter
        Range("E" & strRange + 2) = "Info Code"
        Range("E" & strRange + 3 & ":I" & strRange + 3).Merge
        Range("E" & strRange + 3).HorizontalAlignment = xlCenter
        Range("E" & strRange + 3) = "Info Text"
        Range("A" & strRange + 3 & ":I" & strRange + 3).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 3
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
            Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !IT_Type
            Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2) = !IT_MSR & ""
            Range("C" & strRange + 3 & ":D" & strRange + 3).Merge
            Range("C" & strRange + 3).HorizontalAlignment = xlLeft
            Range("C" & strRange + 3) = !IT_UQC & ""
            
            Range("E" & strRange + 1 & ":I" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1) = !IT_Qualifier
            Range("E" & strRange + 2 & ":I" & strRange + 2).Merge
            Range("E" & strRange + 2).HorizontalAlignment = xlLeft
            Range("E" & strRange + 2) = !IT_Code & ""
            Range("E" & strRange + 3 & ":I" & strRange + 3).Merge
            Range("E" & strRange + 3).HorizontalAlignment = xlLeft
            Range("E" & strRange + 3) = !IT_Text & ""
            strRange = strRange + 3
            
            .MoveNext
        Loop
        InfoType = strRange + 1
      Else
        InfoType = strRange
      End If
    End With
End Function

Function Constituents(JobNo As String, strRange As Double) As Double

    With GetRec("b_Constituent", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Constituents Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
       ' Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "SlNo"
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Element Code"
       
        
        Range("D" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("D" & strRange + 1).HorizontalAlignment = xlCenter
        Range("D" & strRange + 1) = "Element Name"
        Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
        Range("D" & strRange + 2).HorizontalAlignment = xlCenter
        Range("D" & strRange + 2) = "Percentage"
        Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("F" & strRange + 2).HorizontalAlignment = xlCenter
        Range("F" & strRange + 2) = "Yield Percentage"
        Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("H" & strRange + 2).HorizontalAlignment = xlCenter
        Range("H" & strRange + 2) = "Active ingredient"
         Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 2
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
            'Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !Const_SlNo
            'Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2) = !Const_Code & ""
            
            
            Range("D" & strRange + 3 & ":I" & strRange + 1).Merge
            Range("D" & strRange + 1).HorizontalAlignment = xlLeft
            Range("D" & strRange + 1) = !Const_Name & ""
            Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
            Range("D" & strRange + 2).HorizontalAlignment = xlLeft
            Range("D" & strRange + 2) = !Const_Percentage & ""
            Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
            Range("F" & strRange + 2).HorizontalAlignment = xlLeft
            Range("F" & strRange + 2) = !Const_Yld_Percentage & ""
            Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
            Range("H" & strRange + 2).HorizontalAlignment = xlLeft
            Range("H" & strRange + 2) = !Const_ActIngredient & ""
            ' Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
            strRange = strRange + 2
            
            .MoveNext
        Loop
        Constituents = strRange + 1
      Else
        Constituents = strRange
      End If
    End With
End Function

Function Production(JobNo As String, strRange As Double) As Double

    With GetRec("b_Production", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Production Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
       ' Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Prod ID"
        Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
        Range("D" & strRange + 1).HorizontalAlignment = xlCenter
        Range("D" & strRange + 1) = "Quantity"
        'Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
        Range("F" & strRange + 1).HorizontalAlignment = xlCenter
        Range("F" & strRange + 1) = "Code"
        'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlCenter
        Range("G" & strRange + 1) = "MFD"
        'Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("H" & strRange + 1).HorizontalAlignment = xlCenter
        Range("H" & strRange + 1) = "Expiry"
        Range("I" & strRange + 1).HorizontalAlignment = xlCenter
        Range("I" & strRange + 1) = "Best Before"
         Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = "'" & !Prod_Id & ""
            Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
            Range("D" & strRange + 1).HorizontalAlignment = xlLeft
            Range("D" & strRange + 1) = "'" & !Prod_Qty & ""
            'Range("D" & strRange + 2 & ":E" & strRange + 2).Merge
            Range("F" & strRange + 1).HorizontalAlignment = xlLeft
            Range("F" & strRange + 1) = !Prod_Unit & ""
            'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1) = "'" & !Prod_Mfd & ""
            'Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
            Range("H" & strRange + 1).HorizontalAlignment = xlLeft
            Range("H" & strRange + 1) = "'" & !Prod_Expiry & ""
            Range("I" & strRange + 1).HorizontalAlignment = xlLeft
            Range("I" & strRange + 1) = "'" & !Prod_BestBefore & ""
            strRange = strRange + 1
            
            .MoveNext
        Loop
        Production = strRange + 1
      Else
        Production = strRange
      End If
    End With
End Function

Function Control(JobNo As String, strRange As Double) As Double

    With GetRec("b_Control", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Control Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
        Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Control Type Code"
       
        Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("E" & strRange + 1).HorizontalAlignment = xlCenter
        Range("E" & strRange + 1) = "Location"
        'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlCenter
        Range("G" & strRange + 1) = "St_Date"
        'Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("H" & strRange + 1).HorizontalAlignment = xlCenter
        Range("H" & strRange + 1) = "En_Date"
        Range("I" & strRange + 1).HorizontalAlignment = xlCenter
        Range("I" & strRange + 1) = "Result Code"
        Range("C" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Result Text"
         Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 2
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
            Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = "'" & !CTRL_Code & ""
            Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("E" & strRange + 1).HorizontalAlignment = xlLeft
            Range("E" & strRange + 1) = !CTRL_Location & ""
            'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1) = "'" & CTRL_StDate & ""
            'Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
            Range("H" & strRange + 1).HorizontalAlignment = xlLeft
            Range("H" & strRange + 1) = "'" & !CTRL_EnDate & ""
            Range("I" & strRange + 1).HorizontalAlignment = xlLeft
            Range("I" & strRange + 1) = !CTRL_Result_Code & ""
            Range("C" & strRange + 2 & ":I" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2) = "'" & CTRL_Result_Text
            strRange = strRange + 2
            
            .MoveNext
        Loop
        Control = strRange + 1
      Else
        Control = strRange
      End If
    End With
End Function

Function Statement(JobNo As String, strRange As Double) As Double

    With GetRec("b_Statement", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Statement Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
        'Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlCenter
        Range("C" & strRange + 1) = "Dec Type"
        Range("C" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlCenter
        Range("C" & strRange + 2) = "Statement Text"
        Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
        Range("D" & strRange + 1).HorizontalAlignment = xlCenter
        Range("D" & strRange + 1) = "Declaration No"
       'Range("F" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("F" & strRange + 1).HorizontalAlignment = xlCenter
        Range("F" & strRange + 1) = "Date"
        'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
        Range("G" & strRange + 1).HorizontalAlignment = xlCenter
        Range("G" & strRange + 1) = "Stmnt Type"
        Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("H" & strRange + 1).HorizontalAlignment = xlCenter
        Range("H" & strRange + 1) = "Statement Code"
        Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 2
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
            Range("B" & strRange + 1) = !Item_No
           ' Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = "'" & !STMT_DecType & ""
            Range("C" & strRange + 2 & ":I" & strRange + 2).Merge
             Range("C" & strRange + 2).HorizontalAlignment = xlLeft
             Range("C" & strRange + 2) = !STMT_Text & ""
             Range("D" & strRange + 1 & ":E" & strRange + 1).Merge
             Range("D" & strRange + 1).HorizontalAlignment = xlLeft
             Range("D" & strRange + 1) = "'" & !STMT_DescNo & ""
            'Range("F" & strRange + 1 & ":F" & strRange + 1).Merge
             Range("F" & strRange + 1).HorizontalAlignment = xlLeft
             Range("F" & strRange + 1) = "'" & !STMT_DescDate & ""
             'Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
             Range("G" & strRange + 1).HorizontalAlignment = xlLeft
             Range("G" & strRange + 1) = "'" & !STMT_Type & ""
             Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
             Range("H" & strRange + 1).HorizontalAlignment = xlLeft
             Range("H" & strRange + 1) = "'" & !STMT_Code & ""
            strRange = strRange + 2
            .MoveNext
        Loop
        Statement = strRange + 1
      Else
        Statement = strRange
      End If
    End With
End Function


Function Support_Docs(JobNo As String, strRange As Double) As Double

    With GetRec("b_Supporting_Docs", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and Doc_No='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Supporting Document Details"
        Range("A" & strRange).Font.Bold = True
        
        Do While Not .EOF
        Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
        Range("A" & strRange + 1).HorizontalAlignment = xlLeft
        Range("A" & strRange + 1) = "Inv No - Item No     :"
        Range("C" & strRange + 1 & ":E" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlLeft
        Range("C" & strRange + 1) = "'" & !Inv_No & " - " & !Item_No
        
        Range("F" & strRange + 2 & ":I" & strRange + 2).Merge
        Range("F" & strRange + 2).HorizontalAlignment = xlLeft
        Range("F" & strRange + 2) = "Issuing Party Details :"
        
        Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
        Range("A" & strRange + 2).HorizontalAlignment = xlLeft
        Range("A" & strRange + 2) = "CHA LICENCE NO       :"
        Range("C" & strRange + 2 & ":E" & strRange + 2).Merge
        Range("C" & strRange + 2).HorizontalAlignment = xlLeft
        Range("C" & strRange + 2) = !SUP_Cha_LicNo & ""

        Range("F" & strRange + 3 & ":I" & strRange + 3).Merge
        Range("F" & strRange + 3).HorizontalAlignment = xlLeft
        Range("F" & strRange + 3) = !SUP_Iss_Name & ""
        
        Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
        Range("A" & strRange + 3).HorizontalAlignment = xlLeft
        Range("A" & strRange + 3) = "IEC                  :"
        Range("C" & strRange + 3 & ":E" & strRange + 3).Merge
        Range("C" & strRange + 3).HorizontalAlignment = xlLeft
        Range("C" & strRange + 3) = "'" & !SUP_IEC & ""

        Range("F" & strRange + 4 & ":I" & strRange + 4).Merge
        Range("F" & strRange + 4).HorizontalAlignment = xlLeft
        Dim IssAdd As String
        If !SUP_Iss_Add2 <> "" Then
            IssAdd = !SUP_Iss_Add1 & ", " & !SUP_Iss_Add2 & ""
        Else
            IssAdd = !SUP_Iss_Add1 & ""
        End If
        Range("F" & strRange + 4) = IssAdd
        
        Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
        Range("A" & strRange + 4).HorizontalAlignment = xlLeft
        Range("A" & strRange + 4) = "Ice Gate ID          :"
        Range("C" & strRange + 4 & ":E" & strRange + 4).Merge
        Range("C" & strRange + 4).HorizontalAlignment = xlLeft
        Dim ICEID As String
        If InStr(!SUP_Icegate_Id & "", "~") > 0 Then
            ICEID = Left(!SUP_Icegate_Id & "", InStr(!SUP_Icegate_Id & "", "~") - 1)
        Else
            ICEID = !SUP_Icegate_Id & ""
        End If
        
        Range("C" & strRange + 4) = ICEID

        Range("F" & strRange + 5 & ":I" & strRange + 5).Merge
        Range("F" & strRange + 5).HorizontalAlignment = xlLeft
        Range("F" & strRange + 5) = !SUP_Iss_City & " - " & !SUP_Iss_Pin & ""
        
        Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
        Range("A" & strRange + 5).HorizontalAlignment = xlLeft
        Range("A" & strRange + 5) = "IRN No.              :"
        Range("C" & strRange + 5 & ":E" & strRange + 5).Merge
        Range("C" & strRange + 5).HorizontalAlignment = xlLeft
        Range("C" & strRange + 5) = "'" & !SUP_Uniq_DocNo & ""
        Range("C" & strRange + 5).Font.ColorIndex = 11
        
        Range("A" & strRange + 6 & ":B" & strRange + 6).Merge
        Range("A" & strRange + 6).HorizontalAlignment = xlLeft
        Range("A" & strRange + 6) = "Document Number      :"
        Range("C" & strRange + 6 & ":E" & strRange + 6).Merge
        Range("C" & strRange + 6).HorizontalAlignment = xlLeft
        Range("C" & strRange + 6) = "'" & !Sup_DocNo & ""
        Range("C" & strRange + 6).Font.ColorIndex = 11
        
        Range("F" & strRange + 7 & ":I" & strRange + 7).Merge
        Range("F" & strRange + 7).HorizontalAlignment = xlLeft
        Range("F" & strRange + 7) = "Beneficiary Details :"
        
'        Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
'        Range("A" & strRange + 7).HorizontalAlignment = xlLeft
'        Range("A" & strRange + 7) = "DRN No.              :"
'        Range("C" & strRange + 7 & ":E" & strRange + 7).Merge
'        Range("C" & strRange + 7).HorizontalAlignment = xlLeft
'        Range("C" & strRange + 7) = "'" & !SUP_DocRefNo & ""
        
        Range("F" & strRange + 8 & ":I" & strRange + 8).Merge
        Range("F" & strRange + 8).HorizontalAlignment = xlLeft
        Range("F" & strRange + 8) = !SUP_Ben_Name & ""
        
        Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
        Range("A" & strRange + 7).HorizontalAlignment = xlLeft
        Range("A" & strRange + 7) = "Doc type code        :"
        Range("C" & strRange + 7 & ":E" & strRange + 7).Merge
        Range("C" & strRange + 7).HorizontalAlignment = xlLeft
        Range("C" & strRange + 7) = "'" & !SUP_DocType & " (" & !SUP_DocName & ")"
        Range("C" & strRange + 7).Font.ColorIndex = 11
        
        Range("F" & strRange + 9 & ":I" & strRange + 9).Merge
        Range("F" & strRange + 9).HorizontalAlignment = xlLeft
        Dim BenAdd As String
        If SUP_Ben_Add2 <> "" Then
            BenAdd = !SUP_Ben_Add1 & ", " & !SUP_Ben_Add2 & ""
        Else
            BenAdd = !SUP_Ben_Add1 & ""
        End If
        Range("F" & strRange + 9) = BenAdd
        
        Range("A" & strRange + 8 & ":B" & strRange + 8).Merge
        Range("A" & strRange + 8).HorizontalAlignment = xlLeft
        Range("A" & strRange + 8) = "Place of Issue       :"
        Range("C" & strRange + 8 & ":E" & strRange + 8).Merge
        Range("C" & strRange + 8).HorizontalAlignment = xlLeft
        Range("C" & strRange + 8) = !SUP_PlaceofIssue & ""
        
         Range("F" & strRange + 10 & ":I" & strRange + 10).Merge
        Range("F" & strRange + 10).HorizontalAlignment = xlLeft
        Range("F" & strRange + 10) = !SUP_Ben_City & " - " & !SUP_Ben_Pin & ""
        
        Range("A" & strRange + 9 & ":B" & strRange + 9).Merge
        Range("A" & strRange + 9).HorizontalAlignment = xlLeft
        Range("A" & strRange + 9) = "Issued Dt/Expiry Dt  :"
        Range("C" & strRange + 9 & ":E" & strRange + 9).Merge
        Range("C" & strRange + 9).HorizontalAlignment = xlLeft
        Range("C" & strRange + 9) = !SUP_IssueDate & " / " & SUP_ExpiryDate & ""
        
        strRange = strRange + 10
            .MoveNext
        Loop
        Support_Docs = strRange + 1
      Else
        Support_Docs = strRange
      End If
    End With
End Function
Function ReImpDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_ReImport", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "Re-Import Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("A" & strRange + 2) = "Item No"
        Range("B" & strRange + 1) = "SBNo"
        Range("B" & strRange + 2) = "Date"
        Range("C" & strRange + 1) = "Port"
        Range("D" & strRange + 1) = "SB INV"
        Range("D" & strRange + 2) = "SB Item"
        Range("E" & strRange + 1) = "Ntfn No"
        Range("E" & strRange + 2) = "Sl No"
        Range("F" & strRange + 1) = "Freight"
        Range("F" & strRange + 1).HorizontalAlignment = xlRight
        Range("G" & strRange + 1) = "Ins"
        Range("G" & strRange + 1).HorizontalAlignment = xlRight
        Range("H" & strRange + 2) = "Cus. Duty"
        Range("H" & strRange + 2).HorizontalAlignment = xlRight
        Range("I" & strRange + 2) = "Ex. Duty"
        Range("H" & strRange + 2).HorizontalAlignment = xlRight
        Range("A" & strRange + 2 & ":I" & strRange + 2).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 2
        Do While Not .EOF
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = !Inv_No
            Range("A" & strRange + 2).HorizontalAlignment = xlLeft
            Range("A" & strRange + 2) = !Item_No
            Range("B" & strRange + 1) = !SB_No
            'Range("B" & strRange + 2).NumberFormat = "DD/MM/YYYY"
            Dim DD As String
            DD = "'" & !SB_Date
            Range("B" & strRange + 2) = DD
            Range("C" & strRange + 1) = !Exp_Port
            Range("D" & strRange + 1) = !SB_Inv_No
            Range("D" & strRange + 2) = !SB_Item_No
            Range("E" & strRange + 1) = !SB_Ntfn_No
            Range("E" & strRange + 2) = !SB_Ntfn_SlNo
            Range("F" & strRange + 1) = !Sb_Freight
            Range("F" & strRange + 1).HorizontalAlignment = xlRight
            Range("G" & strRange + 1) = !Sb_Insurance
            Range("G" & strRange + 1).HorizontalAlignment = xlRight
            Range("H" & strRange + 2) = !Sb_Cus_Duty
            Range("H" & strRange + 1).HorizontalAlignment = xlRight
            Range("I" & strRange + 2) = !Sb_Ex_Duty
            Range("I" & strRange + 1).HorizontalAlignment = xlRight
            strRange = strRange + 2
            .MoveNext
        Loop
        ReImpDetails = strRange + 1
      Else
        ReImpDetails = strRange
      End If
    End With
End Function

Function SBDutyDetails(JobNo As String, strRange As Double) As Double
    'With GetRec("b_SBDuty", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' and SB_Duty_Type <> 'G' order by Inv_No, item_No")
    With GetRec("b_SBDuty", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' order by Inv_No, item_No")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "SB Duty/IGST NotificationDetails"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange + 1) = "Inv No"
        Range("B" & strRange + 1) = "Item No"
       ' Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
        Range("C" & strRange + 1).HorizontalAlignment = xlLeft
        Range("C" & strRange + 1) = "Ntfn No (L)"
       ' Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
        Range("D" & strRange + 1).HorizontalAlignment = xlLeft
        Range("D" & strRange + 1) = "SL. No"
        Range("E" & strRange + 1).HorizontalAlignment = xlLeft
        Range("E" & strRange + 1) = "Duty Type"
        'Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
        Range("F" & strRange + 1).HorizontalAlignment = xlLeft
        Range("F" & strRange + 1) = "Addl. Flag"
        Range("G" & strRange + 1).HorizontalAlignment = xlLeft
        Range("G" & strRange + 1) = "Ntfn No (E)"
        Range("H" & strRange + 1).HorizontalAlignment = xlLeft
        Range("H" & strRange + 1) = "Sl No"
        Range("I" & strRange + 1).HorizontalAlignment = xlLeft
        Range("I" & strRange + 1) = "Issued By"
        
        Range("A" & strRange + 1 & ":I" & strRange + 1).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1) = !Inv_No
            Range("B" & strRange + 1) = !Item_No
           ' Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !SB_Ntfn_No
           ' Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
            Range("D" & strRange + 1).HorizontalAlignment = xlLeft
            Range("D" & strRange + 1) = !SB_Ntfn_SlNo
            If !SB_Duty_Type & "" = "G" Then
                Range("E" & strRange + 1).HorizontalAlignment = xlLeft
                Range("E" & strRange + 1) = "GST"
            Else
                Range("E" & strRange + 1).HorizontalAlignment = xlLeft
                Range("E" & strRange + 1) = "GST"
            End If
            Dim mDutyType As String
            If !Addl_Duty_Flag & "" = "I" Then
                mDutyType = "IGST"
            ElseIf !Addl_Duty_Flag & "" = "P" Then
                mDutyType = "IGST Cess"
            Else
                mDutyType = !Addl_Duty_Flag & ""
            End If
            Range("F" & strRange + 1) = mDutyType
            Range("G" & strRange + 1).HorizontalAlignment = xlLeft
            Range("G" & strRange + 1) = !GST_E_Ntfn_No & ""
            Range("H" & strRange + 1).HorizontalAlignment = xlLeft
            Range("H" & strRange + 1) = !GST_E_Ntfn_Sl_No & ""
            Dim mIssuedBy As String
            If !GST_Flag & "" = "C" Then
              mIssuedBy = "Customs"
            ElseIf !GST_Flag & "" = "G" Then
              mIssuedBy = "GST"
            Else
              mUssedBy = ""
            End If
            Range("I" & strRange + 1).HorizontalAlignment = xlLeft
            Range("I" & strRange + 1) = mIssuedBy
            strRange = strRange + 1
            .MoveNext
        Loop
        SBDutyDetails = strRange + 1
      Else
        SBDutyDetails = strRange
      End If
    End With
End Function

Function HSSDetails(JobNo As String, strRange As Double) As Double
    With GetRec("b_HSS", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "'")
      If Not .EOF Then
        strRange = strRange + 1
        Range("A" & strRange & ":I" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlLeft
        Range("A" & strRange) = "High Sea Sale Details"
        Range("A" & strRange).Font.Bold = True
        Range("A" & strRange & ":I" & strRange).Borders(xlEdgeBottom).LineStyle = 2
        strRange = strRange + 1
        Do While Not .EOF
            Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
            Range("A" & strRange + 1) = "IE Code : "
            Range("C" & strRange + 1 & ":E" & strRange + 1).Merge
            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
            Range("C" & strRange + 1) = !HSS_IEC
            
            Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
            Range("A" & strRange + 2).HorizontalAlignment = xlLeft
            Range("A" & strRange + 2) = "Br : "
            Range("C" & strRange + 2 & ":E" & strRange + 2).Merge
            Range("C" & strRange + 2).HorizontalAlignment = xlLeft
            Range("C" & strRange + 2) = !HSS_BrSl
            
            Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
            Range("A" & strRange + 3).HorizontalAlignment = xlLeft
            Range("A" & strRange + 3) = "Name :"
            Range("C" & strRange + 3 & ":E" & strRange + 3).Merge
            Range("C" & strRange + 3).HorizontalAlignment = xlLeft
            Range("C" & strRange + 3) = !HSS_Name
            
            Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
            Range("A" & strRange + 4).HorizontalAlignment = xlLeft
            Range("A" & strRange + 4) = "Address 1:"
            Range("C" & strRange + 4 & ":E" & strRange + 4).Merge
            Range("C" & strRange + 4).HorizontalAlignment = xlLeft
            Range("C" & strRange + 4) = !HSS_Add1
            
            Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
            Range("A" & strRange + 5).HorizontalAlignment = xlLeft
            Range("C" & strRange + 5 & ":E" & strRange + 5).Merge
            Range("C" & strRange + 5).HorizontalAlignment = xlLeft
            Range("C" & strRange + 5) = !HSS_Add2
            
            Range("A" & strRange + 6 & ":B" & strRange + 6).Merge
            Range("A" & strRange + 6).HorizontalAlignment = xlLeft
            Range("C" & strRange + 6 & ":E" & strRange + 6).Merge
            Range("C" & strRange + 6).HorizontalAlignment = xlLeft
            Range("C" & strRange + 6) = !HSS_City & " - " & !HSS_PIN
            
            Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
            Range("A" & strRange + 7).HorizontalAlignment = xlLeft
            Range("A" & strRange + 3) = "ADCode :"
            Range("C" & strRange + 7 & ":E" & strRange + 7).Merge
            Range("C" & strRange + 7).HorizontalAlignment = xlLeft
            Range("C" & strRange + 7) = "'" & .Fields("HSS_BEADCode").Value & ""
            
            Range("A" & strRange + 8 & ":B" & strRange + 8).Merge
            Range("A" & strRange + 8).HorizontalAlignment = xlLeft
            Range("A" & strRange + 8) = "Preceding Level : "
            Range("C" & strRange + 8 & ":E" & strRange + 8).Merge
            Range("C" & strRange + 8).HorizontalAlignment = xlLeft
            Range("C" & strRange + 8) = !HSS_Preceding & ""
            strRange = strRange + 8
            .MoveNext
        Loop
        HSSDetails = strRange + 1
      Else
        HSSDetails = strRange
      End If
    End With
End Function



Function PrintEduCessCVD(rs3 As ADODB.Recordset, strRange)
    Range("A" & strRange + 2 & ":D" & strRange + 2).Merge
    Range("A" & strRange + 2).HorizontalAlignment = xlRight
    Range("A" & strRange + 2) = "Educational Cess on CVD     :"
    Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
    Range("E" & strRange + 2).HorizontalAlignment = xlLeft
    Range("E" & strRange + 2) = rs3("EduCessCVDBuffer")
    If rs3("EduCessCVDBuffer") <> "" Then
       exDuty = Mid(rs3("EduCessCVDBuffer"), InStr(rs3("EduCessCVDBuffer"), "@") + 1)
    Else
       exDuty = rs3("TrfEduCessCVD") * (2 / 3)
       exDuty = exDuty & "%"
    End If
    Range("G" & strRange + 2).HorizontalAlignment = xlRight
    Range("G" & strRange + 2) = exDuty
    Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
    Range("H" & strRange + 2).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange + 2) = Format(Val(rs3("EduCessCVD").Value & "") / 3 * 2, "0.00")
    Else
        Range("H" & strRange + 2) = Format(Val(rs3("EduCessCVDActual").Value & "") / 3 * 2, "0.00")
    End If
    If rs3("AggrNtfn").Value <> "" Then
        Range("H" & strRange + 2) = Format(Round(Val(rs3("ECVDAggr").Value & "") / 3 * 2, 1), "0.00")
    End If
    Range("H" & strRange + 2).Select
    Range("H" & strRange + 2).NumberFormat = "0.00"
    EduCVDTotal = EduCVDTotal + Val(Range("H" & strRange + 2))
        
        'Higher Edu Cess CVD
    Range("A" & strRange + 3 & ":D" & strRange + 3).Merge
    Range("A" & strRange + 3).HorizontalAlignment = xlRight
    Range("A" & strRange + 3) = "Sec & Higher Edu Cess on CVD     :"
    Range("E" & strRange + 3 & ":F" & strRange + 3).Merge
    Range("E" & strRange + 3).HorizontalAlignment = xlLeft
    If rs3("EduCessCVDBuffer") <> "" Then
       exDuty = Mid(rs3("EduCessCVDBuffer"), InStr(rs3("EduCessCVDBuffer"), "@") + 1)
    Else
       exDuty = rs3("TrfEduCessCVD") * (1 / 3)
       exDuty = exDuty & "%"
    End If

    If EduCessCVDBuffer <> "" Then
        Range("E" & strRange + 3) = "028/2007"
    End If
    Range("G" & strRange + 3).HorizontalAlignment = xlRight
    Range("G" & strRange + 3) = exDuty
    Range("H" & strRange + 3 & ":I" & strRange + 3).Merge
    Range("H" & strRange + 3).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange + 3) = Format(Val(rs3("EduCessCVD").Value & "") / 3 * 1, "0.00")
    Else
        Range("H" & strRange + 3) = Format(Val(rs3("EduCessCVDActual").Value & "") / 3 * 1, "0.00")
    End If
    If rs3("AggrNtfn").Value <> "" Then
        Range("H" & strRange + 3) = Format(Round(Val(rs3("ECVDAggr").Value & "") / 3 * 1, 1), "0.00")
    End If
    
    Range("H" & strRange + 3).Select
    Range("H" & strRange + 3).NumberFormat = "0.00"
    hEduCVDTotal = hEduCVDTotal + Val(Range("H" & strRange + 3))
End Function

Function PrintEduCessBCD(rs3 As ADODB.Recordset, strRange)
    Range("A" & strRange + 4 & ":D" & strRange + 4).Merge
    Range("A" & strRange + 4).HorizontalAlignment = xlRight
    Range("A" & strRange + 4) = "Educational Cess on BCD     :"
    Range("E" & strRange + 4 & ":F" & strRange + 4).Merge
    Range("E" & strRange + 4).HorizontalAlignment = xlLeft
    Range("E" & strRange + 4) = rs3("EduCessBCDBuffer").Value
    If rs3("EduCessBCDBuffer") <> "" Then
       exDuty = Mid(rs3("EduCessBCDBuffer"), InStr(rs3("EduCessBCDBuffer"), "@") + 1)
    Else
       exDuty = rs3("trfEduCessBCD") * (2 / 3)
       exDuty = exDuty & "%"
    End If
    Range("G" & strRange + 4).HorizontalAlignment = xlRight
    Range("G" & strRange + 4) = exDuty
    Range("H" & strRange + 4 & ":I" & strRange + 4).Merge
    Range("H" & strRange + 4).HorizontalAlignment = xlRight
    Range("H" & strRange + 4) = Format(Round(Val(rs3("EduCessBCD").Value & "") / 3 * 2, 1), "0.00")
    If rs3("AggrNtfn").Value <> "" Then
        Range("H" & strRange + 4) = Format(Round(Val(rs3("EBCDAggr").Value & "") / 3 * 2, 1), "0.00")
    End If
    Range("H" & strRange + 4).Select
    Range("H" & strRange + 4).NumberFormat = "0.00"
    EduCusTotal = EduCusTotal + Val(Range("H" & strRange + 4))
    
    'Highier Edu Cess BCD
    Range("A" & strRange + 5 & ":D" & strRange + 5).Merge
    Range("A" & strRange + 5).HorizontalAlignment = xlRight
    Range("A" & strRange + 5) = "Customs Sec & Higher Edu. Cess     :"
    Range("E" & strRange + 5 & ":F" & strRange + 5).Merge
    Range("E" & strRange + 5).HorizontalAlignment = xlLeft
    Range("E" & strRange + 5).Value = rs3("EduCessBCDBuffer") & ""
    If rs3("EduCessBCDBuffer") <> "" Then
       exDuty = Mid(rs3("EduCessBCDBuffer"), InStr(rs3("EduCessBCDBuffer"), "@") + 1)
    Else
       exDuty = rs3("trfEduCessBCD") * (1 / 3)
       exDuty = exDuty & "%"
    End If
    If rs3("EduCessBCDBuffer") <> "" Then
        Range("E" & strRange + 5) = "028/2007"
    End If
    Range("G" & strRange + 5).HorizontalAlignment = xlRight
    Range("G" & strRange + 5) = exDuty
    Range("H" & strRange + 5 & ":I" & strRange + 5).Merge
    Range("H" & strRange + 5).HorizontalAlignment = xlRight
    Range("H" & strRange + 5) = Format(Round(Val(rs3("EduCessBCD").Value & "") / 3 * 1, 1), "0.00")
    If rs3("AggrNtfn").Value <> "" Then
        Range("H" & strRange + 5) = Format(Round(Val(rs3("EBCDAggr").Value & "") / 3 * 1, 1), "0.00")
    End If
    
    Range("H" & strRange + 5).Select
    Range("H" & strRange + 5).NumberFormat = "0.00"
    hEduCusTotal = hEduCusTotal + Val(Range("H" & strRange + 5))
End Function
Function PrintSWC(rsSWC As ADODB.Recordset, strRange)
    If Not rsSWC.EOF Then
        strRange = strRange + 1
        Range("B" & strRange & ":D" & strRange).Merge
        Range("B" & strRange).HorizontalAlignment = xlRight
        Range("B" & strRange) = "Social Welfare Surcharge    :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rsSWC("trfSWCBuffer").Value
        If rsSWC("trfSWCBuffer") <> "" Then
           exDuty = Mid(rsSWC("trfSWCBuffer"), InStr(rsSWC("trfSWCBuffer"), "@") + 1)
        Else
           exDuty = rsSWC("trfSWC").Value & ""
           exDuty = exDuty & "%"
        End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = exDuty
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        Range("H" & strRange) = Format(Round(Val(rsSWC("SWC").Value & ""), 1), "0.00")
        If rsSWC("AggrNtfn").Value <> "" Then
            Range("H" & strRange) = Format(Round(Val(rsSWC("SWCAggr").Value & ""), 1), "0.00")
        End If
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        SWCTotal = SWCTotal + Val(Range("H" & strRange))
        strRange = strRange + 1
    End If
End Function
Function PrintACVD(rs3 As ADODB.Recordset, strRange)
    Range("B" & strRange & ":D" & strRange).Merge
    Range("B" & strRange).HorizontalAlignment = xlRight
    Range("B" & strRange) = "Addl Duty - (Imports)     :"
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
        
    If rs3!ACVDBuffer <> "" Then
        Range("E" & strRange) = rs3!ACVDBuffer
    Else
        Range("E" & strRange) = ""
    End If
    
    If rs3("ACVDBuffer") <> "" Then
        exDuty = Mid(rs3("ACVDBuffer"), InStr(rs3("ACVDBuffer"), "@") + 1)
    Else
        exDuty = rs3("TrfACVD") & "%"
    End If
    Range("G" & strRange).HorizontalAlignment = xlRight
    Range("G" & strRange) = exDuty
    
    Range("H" & strRange & ":I" & strRange).Merge
    Range("H" & strRange).HorizontalAlignment = xlRight
    If mACVDFlag Then
        Range("H" & strRange) = Format(Round(Val(rs3!ACVD & ""), 1), "0.00")
    Else
        Range("H" & strRange) = Format(Round(Val(rs3!ACVDActual & ""), 1), "0.00")
    End If
    If rs3("AggrNtfn").Value <> "" Then
        Range("H" & strRange) = Format(Round(rs3("ACVDAgr"), 1), "0.00")
    End If
    
    Range("H" & strRange).Select
    Range("H" & strRange).NumberFormat = "0.00"
    ACVDTotal = ACVDTotal + Val(Range("H" & strRange))
    strRange = strRange + 1
End Function

Function PrintGSIA(rs3 As ADODB.Recordset, strRange)
    If rs3!trfGSI & "" <> "" Or rs3!GSIActual & "" <> "" Then
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "GSIA     :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!GSIBuffer
         If rs3("GSIBuffer") <> "" Then
            exDuty = Mid(rs3("GSIBuffer"), InStr(rs3("GSIBuffer"), "@") + 1)
         Else
            exDuty = rs3("trfGSI")
            exDuty = exDuty & "%"
         End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = exDuty
        
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        
        If mCVDFlag Then
            Range("H" & strRange) = Format(Round(Val(rs3!GSI & ""), 1), "0.00")
        Else
            Range("H" & strRange) = Format(Round(Val(rs3!GSIActual & ""), 1), "0.00")
        End If
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        GSIATotal = GSIATotal + Val(Range("H" & strRange))
        strRange = strRange + 1
     End If
End Function
Function PrintHealthCVD(rs3 As ADODB.Recordset, strRange)
    If rs3!trfHealthCVD & "" <> "" Or rs3!HealthCVDActual & "" <> "" Then
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "Health Cess     :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!HealthCVDBuffer
         If rs3("HealthCVDBuffer") <> "" Then
            exDuty = Mid(rs3("HealthCVDBuffer"), InStr(rs3("HealthCVDBuffer"), "@") + 1)
         Else
            exDuty = rs3("trfHealthCVD")
            exDuty = exDuty & "%"
         End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = exDuty
        
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        
        If mCVDFlag Then
            Range("H" & strRange) = Format(Round(Val(rs3!HealthCVD & ""), 1), "0.00")
        Else
            Range("H" & strRange) = Format(Round(Val(rs3!HealthCVDActual & ""), 1), "0.00")
        End If
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        HealthCvdTotal = HealthCvdTotal + Val(Range("H" & strRange))
        strRange = strRange + 1
     End If
End Function
Function PrintIGST(rs3 As ADODB.Recordset, strRange)
    'If Rs3!GST_Levy_Ntfn_No & "" <> "" And Rs3!GST_Levy_Ntfn_Sl_No & "" <> "" Then
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "IGST            :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!GST_Final_Notification & ""
        Dim DutyAmount
        Dim DutyPer
        If rs3.Fields("GST_Cus_Duty_Per").Value & "" <> "" Then
            DutyPer = rs3.Fields("GST_Cus_Duty_Per").Value & ""
            DutyAmount = Val(rs3.Fields("GST_Cus_Duty_Actual").Value & "")
        ElseIf rs3.Fields("GST_Final_Notification").Value & "" <> "" Then
            If InStr(rs3.Fields("GST_Final_Notification").Value & "", "@") > 0 Then
                DutyPer = Mid(rs3.Fields("GST_Final_Notification").Value & "", InStr(rs3.Fields("GST_Final_Notification").Value & "", "@") + 1)
            End If
            'DutyPer = Mid("Rs3!GST_Final_Notification, InStr(Rs3.fields("GST_Final_Notification").value, "@") + 1)
            If rs3.Fields("GST_Exemption_Ntfn_Duty").Value & "" <> "" Then
                DutyAmount = Format(Val(rs3.Fields("GST_Exemption_Ntfn_Duty").Value & ""), "0.00")
            Else
                DutyAmount = Format(Val(rs3.Fields("GST_Levy_Duty").Value & ""), "0.00")
            End If
        End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = DutyPer
        If rs3.Fields("IGSTSchemeNtfn").Value & "" <> "" Then
            With GetRec("b_DEPB", "", "co_Code='" & rs3.Fields("co_Code").Value & "' and br_Code=" & rs3.Fields("br_Code").Value & " and yCode=" & rs3.Fields("yCode").Value & " and DocNo='" & rs3.Fields("BeDocNo").Value & "'")
                If Not .EOF Then
                  If .Fields("Req_Status").Value & "" = "Y" Then
                    DutyAmount = Val(rs3.Fields("IGSTScheme").Value & "")
                  End If
                End If
            End With
        End If
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        Range("H" & strRange) = Format(Round(Val(DutyAmount), 1), "0.00")
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        IGSTTotal = IGSTTotal + Val(Range("H" & strRange))
        IGSTGTotal = IGSTGTotal + Val(Range("H" & strRange))
        strRange = strRange + 1
     'End If
End Function
Function PrintIGSTCess(rs3 As ADODB.Recordset, strRange)
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "IGST Cess       :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!IGST_CESS_E_Buffer & ""
        Dim DutyAmount
        Dim DutyPer
        If rs3.Fields("IGST_CESS_Cus_PER").Value & "" <> "" Then
            DutyPer = rs3.Fields("IGST_CESS_Cus_PER").Value & ""
            DutyAmount = Val(rs3.Fields("IGST_CESS_Cus_Duty").Value & "")
        ElseIf rs3.Fields("IGST_CESS_E_Buffer").Value & "" <> "" Then
            If InStr(rs3.Fields("IGST_CESS_E_Buffer").Value & "", "@") > 0 Then
                DutyPer = Mid(rs3.Fields("IGST_CESS_E_Buffer").Value & "", InStr(rs3.Fields("IGST_CESS_E_Buffer").Value & "", "@") + 1)
            End If
            'DutyPer = Mid("Rs3!GST_Final_Notification, InStr(Rs3.fields("GST_Final_Notification").value, "@") + 1)
            If rs3.Fields("IGST_CESS_E_Duty").Value & "" <> "" Then
                DutyAmount = Format(Val(rs3.Fields("IGST_CESS_E_Duty").Value & ""), "0.00")
            ElseIf rs3.Fields("IGST_CESS_L_Duty").Value & "" <> "" Then
                DutyAmount = Format(Val(rs3.Fields("IGST_CESS_L_Duty").Value & ""), "0.00")
            End If
        'Else
            'DutyPer = Rs3.Fields("IGST_CESS_L_PER").Value & ""
            'DutyAmount = Format(Val(Rs3.Fields("IGST_CESS_L_Duty").Value & ""), "0.00")
        End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = DutyPer
        
        If rs3.Fields("IGSTCessSchemeNtfn").Value & "" <> "" Then
            With GetRec("b_DEPB", "", "co_Code='" & rs3.Fields("co_Code").Value & "' and br_Code=" & rs3.Fields("br_Code").Value & " and yCode=" & rs3.Fields("yCode").Value & " and DocNo='" & rs3.Fields("BeDocNo").Value & "'")
                If Not .EOF Then
                  If .Fields("Req_Status").Value & "" = "Y" Then
                    DutyAmount = Val(rs3.Fields("IGSTCessScheme").Value & "")
                  End If
                End If
            End With
        End If
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        Range("H" & strRange) = Format(Round(Val(DutyAmount), 1), "0.00")
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        IGSTCessTotal = IGSTCessTotal + Val(Range("H" & strRange))
        IGSTGCessTotal = IGSTGCessTotal + Val(Range("H" & strRange))
        strRange = strRange + 1
End Function
Function PrintTTA(rs3 As ADODB.Recordset, strRange)
    If rs3!trfTTA & "" <> "" Or rs3!TTAActual & "" <> "" Then
        ' strRange = strRange + 1
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "T&TA     :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!TTABuffer
        
         If rs3("TTABuffer") <> "" Then
            exDuty = Mid(rs3("TTABuffer"), InStr(rs3("TTABuffer"), "@") + 1)
         Else
            exDuty = rs3("trfTTA")
            exDuty = exDuty & "%"
         End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = exDuty
        
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        If mCVDFlag Then
            Range("H" & strRange) = Format(Round(Val(rs3!TTA & ""), 1), "0.00")
        Else
            Range("H" & strRange) = Format(Round(Val(rs3!TTAActual & ""), 1), "0.00")
        End If
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        TTATotal = TTATotal + Val(Range("H" & strRange))
        strRange = strRange + 1
     End If
End Function
Function PrintNCD(rs3 As ADODB.Recordset, strRange)
    If rs3!trfNCD & "" <> "" Or rs3!NCDActual & "" <> "" Then
        Range("A" & strRange & ":D" & strRange).Merge
        Range("A" & strRange).HorizontalAlignment = xlRight
        Range("A" & strRange) = "NCD     :"
        Range("E" & strRange & ":F" & strRange).Merge
        Range("E" & strRange).HorizontalAlignment = xlLeft
        Range("E" & strRange) = rs3!NCDBuffer
        If rs3("NCDBuffer") <> "" Then
            exDuty = Mid(rs3("NCDBuffer"), InStr(rs3("NCDBuffer"), "@") + 1)
        Else
            exDuty = rs3("trfNCD")
            exDuty = exDuty & "%"
        End If
        Range("G" & strRange).HorizontalAlignment = xlRight
        Range("G" & strRange) = exDuty
        Range("H" & strRange & ":I" & strRange).Merge
        Range("H" & strRange).HorizontalAlignment = xlRight
        If mCVDFlag Then
            Range("H" & strRange) = Format(Round(Val(rs3!NCD & ""), 1), "0.00")
        Else
            Range("H" & strRange) = Format(Round(Val(rs3!NCDActual & ""), 1), "0.00")
        End If
        Range("H" & strRange).Select
        Range("H" & strRange).NumberFormat = "0.00"
        NCDTotal = NCDTotal + Val(Range("H" & strRange))
        strRange = strRange + 1
     End If
End Function
Function PrintSGD(rs3 As ADODB.Recordset, strRange)
If rs3!trfSGD & "" <> "" Or rs3!SGDActual & "" <> "" Then
    Range("A" & strRange & ":D" & strRange).Merge
    Range("A" & strRange).HorizontalAlignment = xlRight
    Range("A" & strRange) = "SGD     :"
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
    Range("E" & strRange) = rs3!SGDBuffer
    
    If rs3("SGDBuffer") <> "" Then
       exDuty = Mid(rs3("SGDBuffer"), InStr(rs3("SGDBuffer"), "@") + 1)
    Else
       exDuty = rs3("trfSGD")
       exDuty = exDuty & "%"
    End If
    Range("G" & strRange).HorizontalAlignment = xlRight
    Range("G" & strRange) = exDuty
    
    Range("H" & strRange & ":I" & strRange).Merge
    Range("H" & strRange).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange) = Format(Round(Val(rs3!SGD & ""), 1), "0.00")
    Else
        Range("H" & strRange) = Format(Round(Val(rs3!SGDActual & ""), 1), "0.00")
    End If
    Range("H" & strRange).Select
    Range("H" & strRange).NumberFormat = "0.00"
    SGDTotal = SGDTotal + Val(Range("H" & strRange))
    strRange = strRange + 1
 End If
End Function
Function printAGGR(rs3 As ADODB.Recordset, strRange)
If rs3!trfAggr & "" <> "" Or rs3!AggrActual & "" <> "" Then
    Range("A" & strRange & ":D" & strRange).Merge
    Range("A" & strRange).HorizontalAlignment = xlRight
    Range("A" & strRange) = "Aggr. Duty     :"
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
    Range("E" & strRange) = rs3!AGGRBuffer
    If rs3("AGGRBuffer") <> "" Then
       exDuty = Mid(rs3("AGGRBuffer"), InStr(rs3("AGGRBuffer"), "@") + 1)
    Else
       exDuty = rs3("trfAGGR")
       exDuty = exDuty & "%"
    End If
    Range("G" & strRange).HorizontalAlignment = xlRight
    Range("G" & strRange) = exDuty
    Range("H" & strRange & ":I" & strRange).Merge
    Range("H" & strRange).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange) = Format(Round(Val(rs3!AggrValue & ""), 1), "0.00")
    Else
        Range("H" & strRange) = Format(Round(Val(rs3!AggrActual & ""), 1), "0.00")
    End If
    Range("H" & strRange).Select
    Range("H" & strRange).NumberFormat = "0.00"
    AggrTotal = AggrTotal + Val(Range("H" & strRange))
    strRange = strRange + 1
 End If
End Function
Function printSCH(rs3 As ADODB.Recordset, strRange)
If rs3!trfSCH & "" <> "" Or rs3!CESCH2Actual & "" <> "" Then
    Range("A" & strRange & ":D" & strRange).Merge
    Range("A" & strRange).HorizontalAlignment = xlRight
    Range("A" & strRange) = "Schedule II     :"
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
    Range("E" & strRange) = rs3!CESCH2Buffer
    If rs3("CESCH2Buffer") <> "" Then
       exDuty = Mid(rs3("CESCH2Buffer"), InStr(rs3("CESCH2Buffer"), "@") + 1)
    Else
       exDuty = rs3("trfSCH")
       exDuty = exDuty & "%"
    End If
    
    Range("G" & strRange).HorizontalAlignment = xlRight
    Range("G" & strRange) = exDuty
    
    Range("H" & strRange & ":I" & strRange).Merge
    Range("H" & strRange).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange) = Format(Round(Val(rs3!CE_Schedule_II & ""), 1), "0.00")
    Else
        Range("H" & strRange) = Format(Round(Val(rs3!CESCH2Actual & ""), 1), "0.00")
    End If
    Range("H" & strRange).Select
    Range("H" & strRange).NumberFormat = "0.00"
    Sch2Total = Sch2Total + Val(Range("H" & strRange))
    strRange = strRange + 1
 End If
End Function
Function PrintHealth(rs3 As ADODB.Recordset, strRange)
If rs3!trfHealth & "" <> "" Or rs3!HealthActual & "" <> "" Then
    Range("A" & strRange & ":D" & strRange).Merge
    Range("A" & strRange).HorizontalAlignment = xlRight
    Range("A" & strRange) = "Health          :"
    Range("E" & strRange & ":F" & strRange).Merge
    Range("E" & strRange).HorizontalAlignment = xlLeft
    Range("E" & strRange) = rs3!HealthBuffer
    
    If rs3("HealthBuffer") <> "" Then
       exDuty = Mid(rs3("HealthBuffer"), InStr(rs3("HealthBuffer"), "@") + 1)
    Else
       exDuty = rs3("trfHealth")
       exDuty = exDuty & "%"
    End If
    
    Range("G" & strRange).HorizontalAlignment = xlRight
    Range("G" & strRange) = exDuty
    
    Range("H" & strRange & ":I" & strRange).Merge
    Range("H" & strRange).HorizontalAlignment = xlRight
    If mCVDFlag Then
        Range("H" & strRange) = Format(Round(Val(rs3!HealthValue & ""), 1), "0.00")
    Else
        Range("H" & strRange) = Format(Round(Val(rs3!HealthActual & ""), 1), "0.00")
    End If
    Range("H" & strRange).Select
    Range("H" & strRange).NumberFormat = "0.00"
    HealthTotal = HealthTotal + Val(Range("H" & strRange))
    strRange = strRange + 1
 End If
End Function
Function fill_Item_Details(JobNo As String, InvNo As String, mRange As Double)
Dim schRs As New ADODB.Recordset, Rs2 As New ADODB.Recordset, rs3 As New ADODB.Recordset, rsSWC As New ADODB.Recordset

Set schRs = GetRec("b_DEPB", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & JobNo & "' and Inv_No=" & InvNo)
Set rs3 = GetRec("b_assValue", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "' and Inv_Sr_No=" & InvNo & " order by Item_No")
Set rsSWC = GetRec("b_assValue_Addl", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & JobNo & "' and Inv_Sr_No=" & InvNo & " order by Item_No")
    strRange = mRange
                
         Set Rs2 = GetRec("b_Item", "", "yCode=" & mYear & " and DocNo='" & JobNo & "' and Inv_No=" & InvNo & " order by Inv_No, Item_No")
                If Not Rs2.EOF Then
                    Range("A" & strRange + 1) = "SlNo"
                    Range("A" & strRange + 2) = "Qty"
                    Range("A" & strRange + 3) = "Unit"
                    Range("A" & strRange + 4) = "Qty (Tariff)"
                    Range("A" & strRange + 5) = "Unit (Tariff)"
                    Range("B" & strRange + 1) = "RITC"
                    Range("B" & strRange + 2) = "End Use"
                    Range("B" & strRange + 3) = "Country"
                    Range("C" & strRange + 1) = "  Description"
                    Range("C" & strRange + 2) = "Unit Price"
                    Range("C" & strRange + 3) = "Ass Val"
                    Range("D" & strRange + 2).HorizontalAlignment = xlCenter
                    Range("D" & strRange + 2) = "CTH"
                    Range("D" & strRange + 3).HorizontalAlignment = xlCenter
                    Range("D" & strRange + 3) = "CETH"
                    Range("E" & strRange + 2 & ":F" & strRange + 2).Merge
                    Range("E" & strRange + 2).HorizontalAlignment = xlLeft
                    Range("E" & strRange + 2) = "C.Notn C.NSNO"
                    
                    Range("E" & strRange + 3 & ":F" & strRange + 3).Merge
                    Range("E" & strRange + 3).HorizontalAlignment = xlLeft
                    Range("E" & strRange + 3) = "E.Notn E.NSNO"
                    
                    Range("G" & strRange + 1) = "RSP"
                    Range("G" & strRange + 2) = "Cus Duty"
                    Range("G" & strRange + 3) = "Exc Duty"
                    Range("H" & strRange + 1) = "Load"
                    Range("H" & strRange + 1).HorizontalAlignment = xlRight
                    
                    Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
                    Range("H" & strRange + 2).HorizontalAlignment = xlRight
                    Range("H" & strRange + 2) = "BCD Amt (Rs)"
                    
                    Range("H" & strRange + 3 & ":I" & strRange + 3).Merge
                    Range("H" & strRange + 3).HorizontalAlignment = xlRight
                    Range("H" & strRange + 3) = "CVD Amt (Rs)"
                    
                    Range("I" & strRange + 1) = "PROV"
                    Range("I" & strRange + 3).HorizontalAlignment = xlRight
                    Range("A" & strRange + 3 & ":I" & strRange + 3).Borders(xlEdgeBottom).LineStyle = 1
                    
                    strRange = strRange + 4
                    Rs2.MoveFirst
                    Do While Not Rs2.EOF
                        Dim rsSchemeBuffer As New ADODB.Recordset
                        Set rsSchemeBuffer = rsScheme.Clone
                        rsSchemeBuffer.Filter = "SCH_CD='" & Rs2!Item_SchemeCode & "'"
                        Dim mDebitDuty As String
                        If Not rsSchemeBuffer.EOF Then
                            mDebtDuty = rsSchemeBuffer.Fields("Debit_Duty").Value & ""
                        End If
                        rsSchemeBuffer.Filter = ""
                        rsSchemeBuffer.Close
                        If mDebtDuty = "Y" Then
                             Dim schRsBuffer As New ADODB.Recordset
                             Set schRsBuffer = schRs.Clone
                             schRsBuffer.Filter = "Item_No=" & Rs2!Item_No
                              If Not schRsBuffer.EOF Then
                                If schRsBuffer!Req_Status = "N" Then
                                    mCVDFlag = False
                                    mACVDFlag = False
                                ElseIf schRsBuffer!Req_Status = "Y" Then
                                    mCVDFlag = True
                                    mACVDFlag = True
                                ElseIf schRsBuffer!Req_Status = "E" Then
                                    mCVDFlag = True
                                    mACVDFlag = False
                                End If
                              Else
                                mCVDFlag = True
                                mACVDFlag = True
                              End If
                              schRsBuffer.Filter = ""
                              schRsBuffer.Close
                        ElseIf mDebtDuty = "N" Then
                            mCVDFlag = True
                            mACVDFlag = True
                        Else
                            mCVDFlag = False
                            mACVDFlag = False
                        End If
                        Dim rs3Buffer As New ADODB.Recordset
                        Set rs3Buffer = rs3.Clone
                        rs3Buffer.Filter = "Item_No=" & Rs2!Item_No & " "
                        If Not rs3Buffer.EOF Then
                            Range("A" & strRange) = Rs2!Item_No
                            Range("A" & strRange).HorizontalAlignment = xlLeft
                            Range("B" & strRange) = Rs2!Item_RITC
                            Range("B" & strRange).HorizontalAlignment = xlLeft
                            Range("B" & strRange + 2) = Rs2!Item_End_Use & ""
                            Range("B" & strRange + 2).HorizontalAlignment = xlLeft
                            'Range("B" & strRange + 3) = Rs2!Item_Country_Org & ""
                            'Range("B" & strRange + 3).HorizontalAlignment = xlLeft
                            Range("C" & strRange & ":I" & strRange).Merge
                            Range("C" & strRange).HorizontalAlignment = xlLeft
                            Range("C" & strRange) = Rs2!Item_Desc1
                            Range("A" & strRange + 1 & ":F" & strRange + 1).Merge
                            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                            Range("A" & strRange + 1) = Rs2!Item_Desc2
                            If Rs2!Item_RSP_Declared = "Y" Then
                                Range("G" & strRange + 1).HorizontalAlignment = xlLeft
                                Range("G" & strRange + 1) = "RSP Item"
                            End If
                            If Rs2!Item_SVB_Ass_Type = "P" And Rs2!Item_SVB_Ref_No <> "" Then
                                Range("I" & strRange + 1).HorizontalAlignment = xlRight
                                Range("I" & strRange + 1) = "Y"
                            End If
                            
                            If Rs2!Item_SchemeCode <> "00" Then
                                Range("H" & strRange + 1).HorizontalAlignment = xlRight
                                Range("H" & strRange + 1) = Rs2!Item_SchemeCode
                            End If
                            If isPDBond Then
                                Range("I" & strRange + 1).HorizontalAlignment = xlCenter
                                Range("I" & strRange + 1) = "Y"
                            End If
                            
                            strRange = strRange + 2
                            Range("A" & strRange) = Rs2!Item_Qty
                            Range("A" & strRange).HorizontalAlignment = xlLeft
                            Range("A" & strRange).Select
                            Range("A" & strRange).NumberFormat = "0.000000"
                            Range("C" & strRange) = Rs2!Item_Unit_Price
                            Range("C" & strRange).HorizontalAlignment = xlLeft
                            Range("C" & strRange).Select
                            Range("C" & strRange).NumberFormat = "0.000000"
                            Range("D" & strRange) = Rs2!Item_CTH
                            Range("D" & strRange).HorizontalAlignment = xlLeft
                        
                            'BCD
                            Range("E" & strRange & ":F" & strRange).Merge
                            Range("E" & strRange).HorizontalAlignment = xlLeft
                            Range("E" & strRange) = rs3Buffer!BCDBuffer
                            If rs3Buffer("BCDBuffer") <> "" Then
                               cusDuty = "'" & Mid(rs3Buffer("BCDBuffer"), InStr(rs3Buffer("BCDBuffer"), "@") + 1)
                            Else
                               cusDuty = "'" & rs3Buffer("TrfBCD")
                            End If
                            Range("G" & strRange).HorizontalAlignment = xlRight
                            Range("G" & strRange) = Format(cusDuty, "0.00") & "%"
                            Range("H" & strRange & ":I" & strRange).Merge
                            Range("H" & strRange).HorizontalAlignment = xlRight
                            If rs3Buffer("AggrNtfn").Value <> "" Then
                                bcdDisplay = "'" & Format(Round(rs3Buffer("BCDAgr"), 1), "0.00")
                            Else
                                bcdDisplay = Format(Round(rs3Buffer!BCD, 1), "0.00")
                            End If
                            Range("H" & strRange) = bcdDisplay
                            Range("H" & strRange).Select
                            Range("H" & strRange).NumberFormat = "0.00"
'                            If rs3Buffer("AggrNtfn").Value <> "" Then
'                                Range("A" & strRange + 1 & ":I" & strRange + 1).Merge
'                                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
'                                Range("A" & strRange + 1) = "Aggr Notification:" & rs3Buffer("AggrNtfn").Value & ""
'                            End If
                            BCDTotal = BCDTotal + Val(Range("H" & strRange).Value)
                            If rs3Buffer("AggrNtfn").Value <> "" Then
                                strRange = strRange + 1
                                Range("A" & strRange & ":I" & strRange).Merge
                                Range("A" & strRange).HorizontalAlignment = xlCenter
                                Range("A" & strRange) = "Aggr Notification:" & rs3Buffer("AggrNtfn").Value & ""
                            End If
                            
                            If InStr(rs3Buffer!BCDNtfn, "#") > 0 Then
                                Dim SchhName As String
                                Dim SchhCode As String
                                SchhCode = Rs2.Fields("Item_SchemeCode").Value & ""
                                SchhName = Rs2.Fields("item_Scheme_Name").Value & ""
                                Range("A" & strRange + 2 & ":I" & strRange + 2).Merge
                                Range("A" & strRange + 2).HorizontalAlignment = xlLeft
                                Range("A" & strRange + 2) = "Exemtion Notn    :" & SchhName & "     " & Replace(Left(rs3Buffer!BCDNtfn, InStr(rs3Buffer!BCDNtfn, "@") - 1), "#", "") & " BCD:" & Right(rs3Buffer!BCDNtfn, Len(rs3Buffer!BCDNtfn) - InStr(rs3Buffer!BCDNtfn, "@"))
                                'Range("A" & strRange + 2) = "Exim Notn        : (SCH)     " & Replace(Left(rs3Buffer!BCDNtfn, InStr(rs3Buffer!BCDNtfn, "@") - 1), "#", "") & " BCD:" & Right(rs3Buffer!BCDNtfn, Len(rs3Buffer!BCDNtfn) - InStr(rs3Buffer!BCDNtfn, "@"))
                                If InStr(rs3Buffer!CVDNtfn, "#") > 0 Then
                                    Range("A" & strRange + 2) = Range("A" & strRange + 2) + " CVD:" & Right(rs3Buffer!CVDNtfn, Len(rs3Buffer!CVDNtfn) - InStr(rs3Buffer!CVDNtfn, "@"))
                                End If
                                strRange = strRange + 2
                            End If
                            
                            If Rs2("Item_TariffValue_Ntfn") & "" <> "" And Rs2("Item_TariffValue_Ntfn_SrNo") & "" <> "" And Rs2("Item_TariffValue_Qty") > 0 Then
                                Range("A" & strRange + 1 & ":F" & strRange + 1).Merge
                                Range("A" & strRange + 1).HorizontalAlignment = xlRight
                                Range("A" & strRange + 1) = "Tarf Duty Item: " & Rs2("Item_TariffValue_Qty").Value & " " & Rs2("Item_TariffValue_Ntfn").Value & "     " & Rs2("Item_TariffValue_Ntfn_SrNo").Value & "  " & Val(sGetRec("ntfn_trf", "", "Notification_No='" & Rs2("Item_TariffValue_Ntfn").Value & "' and Notification_Sl_No='" & Rs2("Item_TariffValue_Ntfn_SrNo") & "'").Fields("DutyRs") & "")
                                strRange = strRange + 1
                            End If
                            
                            If Rs2("Item_ADD_Ntfn") & "" <> "" And Rs2("Item_ADD_Ntfn_SLNo") & "" <> "" Then
                                Range("A" & strRange + 1 & ":H" & strRange + 1).Merge
                                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                                Range("A" & strRange + 1) = "Antidumping: " & rs3Buffer("ADDBuffer") & " CTH: " & Rs2!Item_CTH_Sr_No & " Supplier Sl No.: " & Rs2!Item_Supplier_Sr_No
                                Range("I" & strRange + 1).Select
                                Range("I" & strRange + 1).NumberFormat = "0.00"
                                Range("I" & strRange + 1) = Format(Round(rs3Buffer!AntiDD & "", 1), "0.00")
                                ADDTotal = ADDTotal + Range("I" & strRange + 1)
                                strRange = strRange + 1
                            End If
                            
                            If rs3Buffer!BCDSaptaNtfn <> "" Then
                                Range("A" & strRange + 1 & ":F" & strRange + 1).Merge
                                Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                                Range("A" & strRange + 1) = "SAPTA Notn       :           " & rs3Buffer!BCDSaptaNtfn & " BCD:" & rs3Buffer!BCDSaptaPer
                                strRange = strRange + 1
                            End If
                            
                            Range("A" & strRange + 1) = Rs2!Item_Unit
                            Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                            Range("B" & strRange + 1) = Rs2!Item_Country_Org & ""
                            Range("B" & strRange + 1).HorizontalAlignment = xlLeft
                            
                            Range("A" & strRange + 2) = Val(Rs2!Qty_Tariff & "")
                            Range("A" & strRange + 2).HorizontalAlignment = xlLeft
                            Range("A" & strRange + 2).Select
                            Range("A" & strRange + 2).NumberFormat = "0.000000"
                            Range("A" & strRange + 3) = Rs2!Unit_Tariff & ""
                            Range("A" & strRange + 3).HorizontalAlignment = xlLeft
                            'rs3Buffer.Filter = "Item_No = " & Rs2!Item_No & ""
                            Dim mAV As Double
                            If Not rs3Buffer.EOF Then
                                mAV = Val(rs3Buffer.Fields("Assvalue").Value & "")
                            End If

                            Range("C" & strRange + 1) = mAV
                            Range("C" & strRange + 1).HorizontalAlignment = xlLeft
                            Range("C" & strRange + 1).Select
                            Range("C" & strRange + 1).NumberFormat = "0.000"
                            Range("D" & strRange + 1) = Rs2!Item_CETH
                            Range("D" & strRange + 1).HorizontalAlignment = xlLeft
                            strRange = strRange + 1
                            
                            'CVD
                                Range("E" & strRange + 1 & ":F" & strRange + 1).Merge
                                Range("E" & strRange + 1).HorizontalAlignment = xlLeft
                                Range("E" & strRange + 1) = rs3Buffer!CVDBuffer
                                If rs3Buffer("CVDBuffer") <> "" Then
                                   exDuty = "'" & Mid(rs3Buffer("CVDBuffer"), InStr(rs3Buffer("CVDBuffer"), "@") + 1)
                                Else
                                   exDuty = "'" & rs3Buffer("TrfCVD") & "%"
                                End If
                                Range("G" & strRange + 1).HorizontalAlignment = xlRight
                                Range("G" & strRange + 1) = exDuty
                                Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
                                Range("H" & strRange + 1).HorizontalAlignment = xlRight
                                If mCVDFlag Then
                                    Range("H" & strRange + 1) = Format(Round(Val(rs3Buffer!CVD & ""), 1), "0.00")
                                Else
                                    Range("H" & strRange + 1) = Format(Round(Val(rs3Buffer!CVDActual & ""), 1), "0.00")
                                End If
                                If rs3Buffer("AggrNtfn").Value <> "" Then
                                    Range("H" & strRange + 1) = Format(Round(rs3Buffer("CVDAgr"), 1), "0.00")
                                End If
                                
                                Range("H" & strRange + 1).Select
                                Range("H" & strRange + 1).NumberFormat = "0.00"
                                CVDTotal = CVDTotal + Val(Range("H" & strRange + 1))
                                strRange = strRange + 1
                            'Edu Cess CVD
                            'PrintEduCessCVD rs3Buffer, strRange
                            
                            'Edu Cess BCD
                            'PrintEduCessBCD rs3Buffer, strRange
                            Dim rsSWCBuffer As New ADODB.Recordset
                            Set rsSWCBuffer = rsSWC.Clone
                            rsSWCBuffer.Filter = "Item_No = " & Rs2!Item_No & ""

                            'Social Welfare Cess
                            PrintSWC rsSWCBuffer, strRange
                            rsSWCBuffer.Filter = ""
                            rsSWCBuffer.Close
                            
                            'Addl Duty
                            PrintACVD rs3Buffer, strRange
                            
                            'GSIA
                            PrintGSIA rs3Buffer, strRange
                            
                            'TTA
                            PrintTTA rs3Buffer, strRange
                            
                            'NCD
                            PrintNCD rs3Buffer, strRange
                            
                            'SGD
                            PrintSGD rs3Buffer, strRange
                                                        
                            'Aggregate
                            printAGGR rs3Buffer, strRange
                            
                             
                            'CE SChedule II
                            printSCH rs3Buffer, strRange
                            
                            'Health Notification
                            PrintHealth rs3Buffer, strRange
                             
                              'Health CVD
                            PrintHealthCVD rs3Buffer, strRange
                            
                            'IGST
                            PrintIGST rs3Buffer, strRange
                            
                            'IGST Cess
                            PrintIGSTCess rs3Buffer, strRange
                            'Cess Calculations
                            If Not IsNull(rs3Buffer!CESSvalue) Then
                                Range("A" & strRange & ":D" & strRange).Merge
                                Range("A" & strRange).HorizontalAlignment = xlRight
                                Range("A" & strRange) = "Import Cess     :"
                                Range("E" & strRange & ":F" & strRange).Merge
                                Range("E" & strRange).HorizontalAlignment = xlLeft
                                'Range("E" & StrRange) = rs3Buffer!CESCH2CrNtfn
                                If rs3Buffer!CESSCrPer <> "" Then
                                    Range("G" & strRange).HorizontalAlignment = xlRight
                                    Range("G" & strRange) = "'" & rs3Buffer!CESSCrPer & ""
                                End If
                                Range("H" & strRange & ":I" & strRange).Merge
                                Range("H" & strRange).HorizontalAlignment = xlRight
                                If Not IsNull(rs3Buffer!CessValue_Act) Then
                                    Range("H" & strRange) = Format(rs3Buffer!CessValue_Act, "0.00")
                                Else
                                    Range("H" & strRange) = Format(rs3Buffer!CESSvalue, "0.00")
                                End If
                                'Range("H" & strRange) = Format(rs3Buffer!CESSvalue, "0.00")
                                Range("H" & strRange).Select
                                Range("H" & strRange).NumberFormat = "0.00"
                                CESSTotal = CESSTotal + Val(Range("H" & strRange))
                                strRange = strRange + 1
                             End If
                             strRange = strRange + 1
                        
                            'SVB
                            If Rs2.Fields("Item_SVB_Flag").Value = "B" Or Rs2.Fields("Item_SVB_Flag").Value = "D" Then
                                If rs3Buffer!SVBPer <> "" Then
                                    Range("A" & strRange & ":D" & strRange).Merge
                                    Range("A" & strRange).HorizontalAlignment = xlRight
                                    Range("A" & strRange) = "SVB     :"
                                    Range("E" & strRange & ":F" & strRange).Merge
                                    Range("E" & strRange).HorizontalAlignment = xlLeft
                                    Range("E" & strRange) = ""
                                    Range("G" & strRange).HorizontalAlignment = xlRight
                                    Range("G" & strRange) = Format(rs3Buffer!SVBPer, "0.00") & " %"
                                    Range("H" & strRange & ":I" & strRange).Merge
                                    Range("H" & strRange).HorizontalAlignment = xlRight
                                    Range("H" & strRange) = Format(rs3Buffer!SVBDuty, "0.00")
                                    Range("H" & strRange).Select
                                    Range("H" & strRange).NumberFormat = "0.00"
                                    SVBTotal = SVBTotal + Val(Range("H" & strRange))
                                    strRange = strRange + 1
                                 End If
                             End If
                        End If
                        rs3Buffer.Filter = ""
                        rs3Buffer.Close
                        Rs2.MoveNext
                    Loop
                        strRange = strRange - 1
                        Range("A" & strRange & ":I" & strRange).Borders(xlEdgeBottom).LineStyle = 2
                        strRange = strRange + 2
                    Rs2.Close
                    'Set Rs2 = Nothing
                    Set Rs2 = Nothing
                    BCDFtotal = BCDFtotal + BCDTotal
                    ADDFTotal = ADDFTotal + ADDTotal
                    CVDFTotal = CVDFTotal + CVDTotal
                    EduCusFTotal = EduCusFTotal + EduCusTotal
                    hEduCusFTotal = hEduCusFTotal + hEduCusTotal
                    EduCVDFTotal = EduCVDFTotal + EduCVDTotal
                    hEduCVDFTotal = hEduCVDFTotal + hEduCVDTotal
                    ACVDFTotal = ACVDFTotal + ACVDTotal
                    Sch2FTotal = Sch2FTotal + Sch2Total
                    GSIAFTotal = GSIAFTotal + GSIATotal
                    HealthCvdFTotal = HealthCvdFTotal + HealthCvdTotal
                    TTAFTotal = TTAFTotal + TTATotal
                    NCDFTotal = NCDFTotal + NCDTotal
                    CESSFTotal = CESSFTotal + CESSTotal
                    HealthFTotal = HealthFTotal + HealthTotal
                    AggrFTotal = AggrFTotal + AggrTotal
                    SGDFTotal = SGDFTotal + SGDTotal
                    SVBFtotal = SVBFtotal + SVBTotal
                    IGSTFTotal = IGSTFTotal + IGSTTotal
                    IGSTFCessTotal = IGSTFCessTotal + IGSTCessTotal
                    SWCFTotal = SWCFTotal + SWCTotal
                    Dim avTotal As New ADODB.Recordset
                    Set avTotal = GetRec("", "Select sum(Assvalue) as TotAssValue from b_AssValue where yCode=" & mYear & " and BEDocNo='" & JobNo & "' and Inv_Sr_No=" & InvNo, "")
                    If Not avTotal.EOF Then
                        totav = Val(avTotal.Fields("TotAssValue").Value & "")
                    End If
                    'totav = Val(GetRec("", "Select sum(Assvalue) as TotAssValue from b_AssValue where BEDocNo='" & JobNo & "' and Inv_Sr_No=" & InvNo, "")!TotAssValue & "")
                    OverTotal = BCDTotal + ADDTotal + CVDTotal + EduCusTotal + hEduCusTotal + EduCVDTotal + hEduCVDTotal + ACVDTotal + Sch2Total + GSIATotal + HealthCvdTotal + TTATotal + NCDTotal + CESSTotal + SGDTotal + AggrTotal + HealthTotal + SVBTotal + IGSTTotal + IGSTCessTotal + SWCTotal
                    
                    Range("A" & strRange & ":B" & strRange).Merge
                    Range("A" & strRange).HorizontalAlignment = xlLeft
                    Range("A" & strRange) = ""
                    
                    Range("C" & strRange & ":D" & strRange).Merge
                    Range("C" & strRange).HorizontalAlignment = xlRight
                    Range("C" & strRange) = "Rs." & Format(totav, "0.00")
                    Range("C" & strRange).Font.ColorIndex = 11
                    
                    Range("A" & strRange + 1 & ":B" & strRange + 1).Merge
                    Range("A" & strRange + 1).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 1) = "BCD"
                    
                    Range("C" & strRange + 1 & ":D" & strRange + 1).Merge
                    Range("C" & strRange + 1).HorizontalAlignment = xlRight
                    Range("C" & strRange + 1) = "Rs." & Format(BCDTotal, "0.00")
                    
                    Range("A" & strRange + 2 & ":B" & strRange + 2).Merge
                    Range("A" & strRange + 2).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 2) = "CVD"
                    
                    Range("C" & strRange + 2 & ":D" & strRange + 2).Merge
                    Range("C" & strRange + 2).HorizontalAlignment = xlRight
                    Range("C" & strRange + 2) = "Rs." & Format(CVDTotal, "0.00")
                    
                    Range("A" & strRange + 3 & ":B" & strRange + 3).Merge
                    Range("A" & strRange + 3).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 3) = "ANTID"
                    
                    Range("C" & strRange + 3 & ":D" & strRange + 3).Merge
                    Range("C" & strRange + 3).HorizontalAlignment = xlRight
                    Range("C" & strRange + 3) = "Rs." & Format(ADDTotal, "0.00")
                    
                    Range("A" & strRange + 4 & ":B" & strRange + 4).Merge
                    Range("A" & strRange + 4).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 4) = "CESS"
                    
                    Range("C" & strRange + 4 & ":D" & strRange + 4).Merge
                    Range("C" & strRange + 4).HorizontalAlignment = xlRight
                    Range("C" & strRange + 4) = "Rs." & Format(CESSTotal, "0.00")
                    
                    Range("A" & strRange + 5 & ":B" & strRange + 5).Merge
                    Range("A" & strRange + 5).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 5) = "TTA"
                    
                    Range("C" & strRange + 5 & ":D" & strRange + 5).Merge
                    Range("C" & strRange + 5).HorizontalAlignment = xlRight
                    Range("C" & strRange + 5) = "Rs." & Format(TTATotal, "0.00")
                    
                    'Range("A" & strRange + 6 & ":B" & strRange + 6).Merge
                    'Range("A" & strRange + 6).HorizontalAlignment = xlLeft
                    'Range("A" & strRange + 6) = "Edu. Cess CVD"
                    
                    'Range("C" & strRange + 6 & ":D" & strRange + 6).Merge
                    'Range("C" & strRange + 6).HorizontalAlignment = xlRight
                    'Range("C" & strRange + 6) = "Rs." & Format(EduCVDTotal, "0.00")
                    
                    'Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
                    'Range("A" & strRange + 7).HorizontalAlignment = xlLeft
                    'Range("A" & strRange + 7) = "SHE Cess CVD"
                    
                    'Range("C" & strRange + 7 & ":D" & strRange + 7).Merge
                    'Range("C" & strRange + 7).HorizontalAlignment = xlRight
                    'Range("C" & strRange + 7) = "Rs." & Format(hEduCVDTotal, "0.00")
                    
                    Range("A" & strRange + 6 & ":B" & strRange + 6).Merge
                    Range("A" & strRange + 6).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 6) = "Health duty"
                    
                    Range("C" & strRange + 6 & ":D" & strRange + 6).Merge
                    Range("C" & strRange + 6).HorizontalAlignment = xlRight
                    Range("C" & strRange + 6) = "Rs." & Format(HealthTotal, "0.00")
                    
                    Range("A" & strRange + 7 & ":B" & strRange + 7).Merge
                    Range("A" & strRange + 7).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 7) = "Health Cess"
                    
                    Range("C" & strRange + 7 & ":D" & strRange + 7).Merge
                    Range("C" & strRange + 7).HorizontalAlignment = xlRight
                    Range("C" & strRange + 7) = "Rs." & Format(HealthCvdTotal, "0.00")
                    
                    Range("A" & strRange + 8 & ":A" & strRange + 8).Merge
                    Range("A" & strRange + 8).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 8) = "NCD"
                    
                    Range("C" & strRange + 8 & ":D" & strRange + 8).Merge
                    Range("C" & strRange + 8).HorizontalAlignment = xlRight
                    Range("C" & strRange + 8) = "Rs." & Format(NCDTotal, "0.00")
                    
                    Range("F" & strRange & ":G" & strRange).Merge
                    Range("F" & strRange).HorizontalAlignment = xlLeft
                    Range("F" & strRange) = "SAFEGUARD Duty"
                    
                    Range("H" & strRange & ":I" & strRange).Merge
                    Range("H" & strRange).HorizontalAlignment = xlRight
                    Range("H" & strRange) = "Rs." & Format(SGDTotal, "0.00")
                    
                    Range("F" & strRange + 1 & ":G" & strRange + 1).Merge
                    Range("F" & strRange + 1).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 1) = "Sch 2 Spl Excise Duty"
                    
                    Range("H" & strRange + 1 & ":I" & strRange + 1).Merge
                    Range("H" & strRange + 1).HorizontalAlignment = xlRight
                    Range("H" & strRange + 1) = "Rs." & Format(Sch2Total, "0.00")
                    
                    Range("F" & strRange + 2 & ":G" & strRange + 2).Merge
                    Range("F" & strRange + 2).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 2) = "GSIA"
                    
                    Range("H" & strRange + 2 & ":I" & strRange + 2).Merge
                    Range("H" & strRange + 2).HorizontalAlignment = xlRight
                    Range("H" & strRange + 2) = "Rs." & Format(GSIATotal, "0.00")
                    
                    Range("F" & strRange + 3 & ":G" & strRange + 3).Merge
                    Range("F" & strRange + 3).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 3) = "S.W. Surcharge"
                    
                    Range("H" & strRange + 3 & ":I" & strRange + 3).Merge
                    Range("H" & strRange + 3).HorizontalAlignment = xlRight
                    Range("H" & strRange + 3) = "Rs." & Format(SWCTotal, "0.00")
                    
                    'Range("F" & strRange + 4 & ":G" & strRange + 4).Merge
                    'Range("F" & strRange + 4).HorizontalAlignment = xlLeft
                    'Range("F" & strRange + 4) = "SH Cus Edu. Cess"
                    
                    'Range("H" & strRange + 4 & ":I" & strRange + 4).Merge
                    'Range("H" & strRange + 4).HorizontalAlignment = xlRight
                    'Range("H" & strRange + 4) = "Rs." & Format(hEduCusTotal, "0.00")
                    
                    Range("F" & strRange + 4 & ":G" & strRange + 4).Merge
                    Range("F" & strRange + 4).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 4) = "Addl. Duty"
                    
                    Range("H" & strRange + 4 & ":I" & strRange + 4).Merge
                    Range("H" & strRange + 4).HorizontalAlignment = xlRight
                    Range("H" & strRange + 4) = "Rs." & Format(ACVDTotal, "0.00")
                    
                    Range("F" & strRange + 5 & ":G" & strRange + 5).Merge
                    Range("F" & strRange + 5).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 5) = "SVB"
                    
                    Range("H" & strRange + 5 & ":I" & strRange + 5).Merge
                    Range("H" & strRange + 5).HorizontalAlignment = xlRight
                    Range("H" & strRange + 5) = "Rs." & Format(SVBTotal, "0.00")
                    
                    Range("F" & strRange + 6 & ":G" & strRange + 6).Merge
                    Range("F" & strRange + 6).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 6) = "IGST"
                    
                    Range("H" & strRange + 6 & ":I" & strRange + 6).Merge
                    Range("H" & strRange + 6).HorizontalAlignment = xlRight
                    Range("H" & strRange + 6) = "Rs." & Format(IGSTTotal, "0.00")
                    
                    Range("F" & strRange + 7 & ":G" & strRange + 7).Merge
                    Range("F" & strRange + 7).HorizontalAlignment = xlLeft
                    Range("F" & strRange + 7) = "IGST Cess"
                    
                    Range("H" & strRange + 7 & ":I" & strRange + 7).Merge
                    Range("H" & strRange + 7).HorizontalAlignment = xlRight
                    Range("H" & strRange + 7) = "Rs." & Format(IGSTCessTotal, "0.00")
                    
                    Range("A" & strRange + 8 & ":I" & strRange + 8).Borders(xlEdgeBottom).LineStyle = 2
                    
                    Dim rsAmount As Double
                    If mRevDep <= 0 Then
                        Range("A" & strRange + 9 & ":G" & strRange + 9).Merge
                        Range("A" & strRange + 9).HorizontalAlignment = xlLeft
                        Range("A" & strRange + 9) = "Duty Payable :"
                        Range("H" & strRange + 9 & ":I" & strRange + 9).Merge
                        Range("H" & strRange + 9).HorizontalAlignment = xlRight
                        Range("H" & strRange + 9) = "Rs." & Format(OverTotal, "0.00")
                        Range("H" & strRange + 9).Font.ColorIndex = 9
                        Range("A" & strRange + 9 & ":G" & strRange + 9).Merge
                        Range("A" & strRange + 9).HorizontalAlignment = xlLeft
                        rsAmount = OverTotal
                    Else
                        Range("A" & strRange + 9 & ":G" & strRange + 9).Merge
                        Range("A" & strRange + 9).HorizontalAlignment = xlLeft
                        Range("A" & strRange + 9) = "Total Duty   :"
                        Range("H" & strRange + 9 & ":I" & strRange + 9).Merge
                        Range("H" & strRange + 9).HorizontalAlignment = xlRight
                        Range("H" & strRange + 9) = "Rs." & Format(OverTotal, "0.00")
                        Range("A" & strRange + 10 & ":G" & strRange + 10).Merge
                        Range("A" & strRange + 10).HorizontalAlignment = xlLeft
                        Range("A" & strRange + 10) = "Add Revenue Deposit @ " & mRevDep & "% :"
                        Range("H" & strRange + 10 & ":I" & strRange + 10).Merge
                        Range("H" & strRange + 10).HorizontalAlignment = xlRight
                        Range("H" & strRange + 10) = "Rs." & Format(totav * (mRevDep / 100), "0.00")
                        Range("A" & strRange + 11 & ":G" & strRange + 11).Merge
                        Range("A" & strRange + 11).HorizontalAlignment = xlLeft
                        Range("A" & strRange + 11) = "Duty Payable :"
                        Range("H" & strRange + 11 & ":I" & strRange + 11).Merge
                        Range("H" & strRange + 11).HorizontalAlignment = xlRight
                        rsAmount = OverTotal + (totav * (mRevDep / 100))
                        Range("H" & strRange + 11) = "Rs." & Format(rsAmount, "0.00")
                        Range("H" & strRange + 11).Font.ColorIndex = 11
                    End If
                        If rsAmount > 0 Then
                        On Error Resume Next
                            Range("A" & strRange + 12) = NumToWords(rsAmount) & "Only"
                        Else
                            Range("A" & strRange + 12) = "Rs. Zero Only"
                        End If
                    
                    Range("A" & strRange + 13 & ":I" & strRange + 13).Merge
                    Range("A" & strRange + 13).HorizontalAlignment = xlLeft
                    Range("A" & strRange + 13 & ":I" & strRange + 13).Borders(xlEdgeBottom).LineStyle = 1
                        
                    strRange = strRange + 14
                End If
                    
                    fill_Item_Details = strRange
                
End Function

Function ePortion(JobNo As String, mRange As Double)
    mRange = PrintContainerDetails(Trim(Str(JobNo)), mRange)
    mRange = LicDetails(Trim(Str(JobNo)), mRange)
    mRange = BondDetails(Trim(Str(JobNo)), mRange)
    mRange = TaxDetails(Trim(Str(JobNo)), mRange)
    mRange = MiscDetails(Trim(Str(JobNo)), mRange)
    mRange = perDetails(Trim(Str(JobNo)), mRange)
    mRange = RSPDetails(Trim(Str(JobNo)), mRange)
    mRange = ReImpDetails(Trim(Str(JobNo)), mRange)
    mRange = SBDutyDetails(Trim(Str(JobNo)), mRange)
    mRange = HSSDetails(Trim(Str(JobNo)), mRange)
    mRange = ManufacturerDetails(Trim(Str(JobNo)), mRange)
    mRange = InfoType(Trim(Str(JobNo)), mRange)
    mRange = Constituents(Trim(Str(JobNo)), mRange)
    mRange = Production(Trim(Str(JobNo)), mRange)
    mRange = Control(Trim(Str(JobNo)), mRange)
    mRange = Statement(Trim(Str(JobNo)), mRange)
    With GetRec("b_config", "", "ConfigName='SHOW_SUPPORTING_DOCUMENTS'")
        If Not .EOF Then
          If .Fields("Config") = "YES" Then
              mRange = Support_Docs(Trim(Str(JobNo)), mRange)
          End If
        End If
    End With
    mRange = mRange + 2
    
    Range("A" & mRange & ":I" & mRange).Merge
    Range("A" & mRange).WrapText = True
    Range("A" & mRange) = "DECLARATION"
    Range("A" & mRange).Font.Bold = True
    Range("A" & mRange + 1 & ":I" & mRange + 1).Merge
    Range("A" & mRange + 1) = "1. I/We Certify that the above entries are correct."
    Range("A" & mRange + 2 & ":I" & mRange + 2).Merge
    Range("A" & mRange + 2) = "2. I/We further declare that wherever the RSP is applicable same has been truthfully declared"
    
   mRange = mRange + 4
    
    
    
    Range("A" & mRange + 1 & ":I" & mRange + 1).Merge
    Range("A" & mRange + 1).HorizontalAlignment = xlRight
    Range("A" & mRange + 1) = "Signature of CHA"
    Range("A" & mRange + 1 & ":I" & mRange + 1).Borders(xlEdgeBottom).LineStyle = 2
    Range("A" & mRange + 2 & ":I" & mRange + 2).Merge
    Range("A" & mRange + 2).HorizontalAlignment = xlCenter
    Range("A" & mRange + 2) = "******* End of Checklist for Job No " & JobNo & " *******"
    Range("A" & mRange + 3 & ":I" & mRange + 3).Merge
    Range("A" & mRange + 3).HorizontalAlignment = xlCenter
    Range("A" & mRange + 3) = Range("BA1").Value
    Range("A" & mRange + 2 & ":I" & mRange + 2).Merge
    mRange = mRange + 3
    finalrow = Application.Rows.Count
    Range("A" & mRange & ":A" & finalrow).Select
    Range("A" & mRange & ":A" & finalrow).EntireRow.Delete
    EndArea = "I" & mRange + 3
    SetArea (EndArea)
    Range("A" & mRange + 3).Font.Size = 6
    Range("A1").Select
End Function
    Function OthMisAmount(ByVal JobNo As String, ByVal InvNo As String) As Double
        With GetRec("b_invoice", "", "co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and BEDocNo='" & Trim(JobNo) & "' and Inv_Sr_No=" & InvNo)
            If Not .EOF Then
                Dim ItemAmount As Double
                Dim MisAmount As Double
                ItemAmount = Val(GetRec("", "select Sum(Item_Amount)as TotAmount from b_item where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(Str(JobNo)) & "' and Inv_No=" & InvNo, "").Fields("totAmount").Value & "")
                MisAmount = getOthMisFC(JobNo, InvNo, ItemAmount, Val(.Fields("Inv_Rate").Value & ""), 0)
                OthMisAmount = MisAmount
            Else
                OthMisAmount = 0
            End If
        End With
    End Function
    Function getOthMisFC(ByVal JobNo As String, ByVal InvNo As Integer, ByVal mItemAmount As Double, ByVal invCurRate As Double, ByVal xBondMiscRs As Double)
            Dim MisAmount As Double, MiscFC As Double
            With GetRec("", "Select Misc_Charges_amt, Misc_Charges_Rate from b_miscchg where co_Code='" & mCoCode & "' and br_Code=" & mBrCode & " and yCode=" & mYear & " and DocNo='" & Trim(JobNo) & "' and Inv_No=" & InvNo, "")
                If Not .EOF Then
                    Do While Not .EOF
                        Dim MiscRate As Double
                        MiscRate = Val(.Fields("Misc_Charges_Rate").Value & "")
                        If MiscRate <> 0 Then
                            MiscFC = MiscFC + (mItemAmount) * (MiscRate / 100)
                        Else
                            MiscFC = MiscFC + Val(.Fields("Misc_Charges_amt").Value & "")
                        End If
                        If isXBond Then
                            If xBondMiscRs > 0 Then
                                MiscFC = MiscFC + (Val(xBondMiscRs) * (1 / invCurRate))
                            End If
                        End If
                        .MoveNext
                    Loop
                    getOthMisFC = MiscFC
                Else
                    getOthMisFC = 0
                End If
            End With
    End Function


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Private Sub Worksheet_Change(ByVal Target As Excel.Range)
'  If Target.Address <> "$AZ$6" Then Exit Sub
'    Application.EnableEvents = False
'    MsgBox "Hey, leave me alone!", 48, "Sorry, I'm protected."
'    Application.Undo
'    Application.EnableEvents = True
'End Sub

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
