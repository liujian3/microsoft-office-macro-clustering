Attribute VB_Name = "H|fffd|rok11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "H|fffd|rok7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "H|fffd|rok8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tento_zo|fffd|it"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'Private Sub Workbook_BeforeClose(Cancel As Boolean)

'DeleteVBComponent ActiveWorkbook, "funkcie"
'DeleteVBComponent ActiveWorkbook, "main"
'DeleteVBComponent ActiveWorkbook, "test"
'DeleteVBComponent ActiveWorkbook, "vygenerovat_otazky"
'DeleteVBComponent ActiveWorkbook, "vygenerovat_test"



'End Sub

Private Sub Workbook_Open()






Application.DisplayAlerts = False

If Workbooks(2).Name <> "generovanie_testov.xls" And Workbooks(1).Name <> "generovanie_testov.xls" Then


        Sheets("test").ComboBoxInC12.Object.Clear
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 21)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 22)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 23)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 24)
'
'
        Sheets("test").ComboBoxInC13.Object.Clear
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 21)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 22)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 23)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 24)
'
        Sheets("test").ComboBoxInC14.Object.Clear
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 21)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 22)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 23)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 24)
'
        Sheets("test").ComboBoxInC15.Object.Clear
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 21)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 22)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 23)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 24)
'
'
        Sheets("test").ComboBoxInC16.Object.Clear
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 21)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 22)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 23)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 24)
'
'
        Sheets("test").ComboBoxInC17.Object.Clear
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 21)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 22)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 23)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 24)
'
'
        Sheets("test").ComboBoxInC18.Object.Clear
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 21)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 22)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 23)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 24)
'
        Sheets("test").ComboBoxInC19.Object.Clear
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 21)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 22)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 23)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 24)
'
        Sheets("test").ComboBoxInC20.Object.Clear
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 21)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 22)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 23)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 24)

        Sheets("test").ComboBoxInC21.Object.Clear
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 21)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 22)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 23)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 24)
'
        Sheets("test").ComboBoxInC22.Object.Clear
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 21)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 22)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 23)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 24)

                Sheets("test").ComboBoxInC23.Object.Clear
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 21)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 22)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 23)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 24)
'

                Sheets("test").ComboBoxInC24.Object.Clear
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 21)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 22)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 23)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 24)

                        Sheets("test").ComboBoxInC25.Object.Clear
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 21)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 22)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 23)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 24)

                                Sheets("test").ComboBoxInC26.Object.Clear
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 21)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 22)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 23)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 24)

                                        Sheets("test").ComboBoxInC27.Object.Clear
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 21)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 22)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 23)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 24)

                                                Sheets("test").ComboBoxInC28.Object.Clear
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 21)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 22)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 23)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 24)

                                                        Sheets("test").ComboBoxInC29.Object.Clear
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 21)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 22)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 23)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 24)

                                                              Sheets("test").ComboBoxInC30.Object.Clear
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 21)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 22)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 23)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 24)

                                                                      Sheets("test").ComboBoxInC31.Object.Clear
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 21)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 22)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 23)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 24)
End If

Application.DisplayAlerts = True

End Sub
















Attribute VB_Name = "main"
Sub main()



'**************************************
'autor: milan.botka@ceitgroup.eu
' nakodovane co najjednoduchsie aby to kopirovalo co robi clovek a aby si to uzivatelia pokial mozno mohli upravit
'**************************************


'tieto premenne cas1 a cas2 sluzia na meranie casu vypoctu aby sa dal optimalizovat, napr. pouzitim 'Application.ScreenUpdating = False' sa da vypocet skratit min. o 30%
Dim cas1 As Date
Dim cas2 As Date
Dim interval As Date


' vypnutie preblikavania obrazovky pri vypoctoch a zaroven uspora casu
Application.ScreenUpdating = False

' zaciatok vypoctu
cas1 = Now()

'spustestenie aplikacie / modulu
Application.Run "vygenerovat_otazky.vypocet"

'spustestenie aplikacie / modulu
Application.Run "vygenerovat_test.tvorba_dotaznika"

' zapnutie preblikavania obrazovky pri vypoctoch a zaroven uspora casu
Application.ScreenUpdating = True

'koniec vypoctu
cas2 = Now()

' trvanie vypoctu koniec-zaciatok
interval = cas2 - cas1

MsgBox "Spracovanie trvalo" & interval




End Sub


'''''''''toto je funkcijka na mazanie makier (modulov) aby v novom test.xls nebol modul tykajuci sa generovania testov
'Option Explicit

'Sub DeleteVBComponent(ByVal wb As Workbook, ByVal CompName As String)

'Disabling the alert message
'Application.DisplayAlerts = False

'Ignore errors
'On Error Resume Next


'Delete the component
'wb.VBProject.VBComponents.Remove wb.VBProject.VBComponents(CompName)

'On Error GoTo 0

'Enabling the alert message
'Application.DisplayAlerts = True

'End Sub

Attribute VB_Name = "otazky_kombo"
Sub otazky_kombo()



Application.DisplayAlerts = False

'If Workbooks(2).Name <> "generovanie_testov.xls" And Workbooks(1).Name <> "generovanie_testov.xls" Then


        Sheets("test").ComboBoxInC12.Object.Clear
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 21)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 22)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 23)
        Sheets("test").ComboBoxInC12.Object.AddItem Cells(12, 24)
'
'
        Sheets("test").ComboBoxInC13.Object.Clear
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 21)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 22)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 23)
        Sheets("test").ComboBoxInC13.Object.AddItem Cells(13, 24)
'
        Sheets("test").ComboBoxInC14.Object.Clear
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 21)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 22)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 23)
        Sheets("test").ComboBoxInC14.Object.AddItem Cells(14, 24)
'
        Sheets("test").ComboBoxInC15.Object.Clear
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 21)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 22)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 23)
        Sheets("test").ComboBoxInC15.Object.AddItem Cells(15, 24)
'
'
        Sheets("test").ComboBoxInC16.Object.Clear
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 21)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 22)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 23)
        Sheets("test").ComboBoxInC16.Object.AddItem Cells(16, 24)
'
'
        Sheets("test").ComboBoxInC17.Object.Clear
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 21)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 22)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 23)
        Sheets("test").ComboBoxInC17.Object.AddItem Cells(17, 24)
'
'
        Sheets("test").ComboBoxInC18.Object.Clear
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 21)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 22)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 23)
        Sheets("test").ComboBoxInC18.Object.AddItem Cells(18, 24)
'
        Sheets("test").ComboBoxInC19.Object.Clear
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 21)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 22)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 23)
        Sheets("test").ComboBoxInC19.Object.AddItem Cells(19, 24)
'
        Sheets("test").ComboBoxInC20.Object.Clear
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 21)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 22)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 23)
        Sheets("test").ComboBoxInC20.Object.AddItem Cells(20, 24)

        Sheets("test").ComboBoxInC21.Object.Clear
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 21)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 22)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 23)
        Sheets("test").ComboBoxInC21.Object.AddItem Cells(21, 24)
'
        Sheets("test").ComboBoxInC22.Object.Clear
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 21)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 22)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 23)
        Sheets("test").ComboBoxInC22.Object.AddItem Cells(22, 24)

                Sheets("test").ComboBoxInC23.Object.Clear
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 21)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 22)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 23)
        Sheets("test").ComboBoxInC23.Object.AddItem Cells(23, 24)
'

                Sheets("test").ComboBoxInC24.Object.Clear
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 21)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 22)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 23)
        Sheets("test").ComboBoxInC24.Object.AddItem Cells(24, 24)

                        Sheets("test").ComboBoxInC25.Object.Clear
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 21)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 22)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 23)
        Sheets("test").ComboBoxInC25.Object.AddItem Cells(25, 24)

                                Sheets("test").ComboBoxInC26.Object.Clear
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 21)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 22)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 23)
        Sheets("test").ComboBoxInC26.Object.AddItem Cells(26, 24)

                                        Sheets("test").ComboBoxInC27.Object.Clear
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 21)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 22)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 23)
        Sheets("test").ComboBoxInC27.Object.AddItem Cells(27, 24)

                                                Sheets("test").ComboBoxInC28.Object.Clear
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 21)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 22)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 23)
        Sheets("test").ComboBoxInC28.Object.AddItem Cells(28, 24)

                                                        Sheets("test").ComboBoxInC29.Object.Clear
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 21)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 22)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 23)
        Sheets("test").ComboBoxInC29.Object.AddItem Cells(29, 24)

                                                              Sheets("test").ComboBoxInC30.Object.Clear
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 21)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 22)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 23)
        Sheets("test").ComboBoxInC30.Object.AddItem Cells(30, 24)

                                                                      Sheets("test").ComboBoxInC31.Object.Clear
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 21)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 22)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 23)
        Sheets("test").ComboBoxInC31.Object.AddItem Cells(31, 24)
'End If

Application.DisplayAlerts = True

End Sub
Attribute VB_Name = "test"

Sub nahodne_cislo()
Dim random_cislo As Integer
         
             
                        
                        random_cislo = Int((4 - 1 + 1) * Rnd + 1)

If random_cislo = 1 Then
                                                                otazka1 = Sheets("vypocet").Cells(j, 6).Value
                                                                otazka2 = Sheets("vypocet").Cells(j, 7).Value
                                                                otazka3 = Sheets("vypocet").Cells(j, 8).Value
                                                                otazka4 = Sheets("vypocet").Cells(j, 9).Value
End If

If random_cislo = 2 Then
                                                                otazka2 = Sheets("vypocet").Cells(j, 6).Value
                                                                otazka3 = Sheets("vypocet").Cells(j, 7).Value
                                                                otazka4 = Sheets("vypocet").Cells(j, 8).Value
                                                                otazka1 = Sheets("vypocet").Cells(j, 9).Value
End If

If random_cislo = 3 Then
                                                                otazka3 = Sheets("vypocet").Cells(j, 6).Value
                                                                otazka4 = Sheets("vypocet").Cells(j, 7).Value
                                                                otazka1 = Sheets("vypocet").Cells(j, 8).Value
                                                                otazka2 = Sheets("vypocet").Cells(j, 9).Value
End If

If random_cislo = 4 Then
                                                                otazka4 = Sheets("vypocet").Cells(j, 6).Value
                                                                otazka1 = Sheets("vypocet").Cells(j, 7).Value
                                                                otazka2 = Sheets("vypocet").Cells(j, 8).Value
                                                                otazka3 = Sheets("vypocet").Cells(j, 9).Value
End If



          
End Sub


Sub nahodne()

Dim max_cislo_uroven As Integer
Dim time As Date

time = Now()

max_cislo_uroven = 80


Sheets("test").Cells(11, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(12, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(13, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(14, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(15, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(16, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)
Sheets("test").Cells(17, 1).Value = Int((max_cislo_uroven - 1 + 1) * Rnd * Second(time) / 60 + 1)


End Sub

Sub pocet()


Dim blok As Integer

Dim max_cislo_blok As Integer

Dim random_cislo_blok As Integer



Dim uroven As Integer

Dim max_cislo_uroven As Integer

Dim random_cislo_uroven As Integer





Dim maxrow2 As Long

Dim pocet_otazok_uroven As Integer

Dim nahodne_cisla As Integer

Dim otazka As Integer





For otazka = 2 To 21


Sheets("vypocet").Select


blok = Cells(otazka, 13)
uroven = Cells(otazka, 14)

maxrow2 = Sheets("vypocet").Range("B65536").End(xlUp).row


For pocet_otazok_uroven = 1 To maxrow2


    If Sheets("vypocet").Cells(pocet_otazok_uroven, 14).Value = uroven Then
        'max_cislo_blok = Application.WorksheetFunction.CountIf(Range("M:M"), blok)
        'max_cislo_uroven = Application.WorksheetFunction.CountIf(Range("L:L"), uroven)

            max_cislo_uroven = max_cislo_uroven + 1

    End If




Next pocet_otazok_uroven


Sheets("test").Cells(otazka + 10, 5).Value = max_cislo_uroven

Next otazka





End Sub
Attribute VB_Name = "ulozit"
Sub ulozit()
' toto makro ulozi uz zadane odpovede

Dim r1, r2, r3, r4, r5, r6, r7, r8, r9, r10, r11, r12, r13, r14, r15, r16, r17, r18, r19, r20 As String


 Workbooks("test.xls").Activate
    Worksheets("test").Activate
    r1 = Sheets("test").ComboBoxInC12.Value
    r2 = Sheets("test").ComboBoxInC13.Value
    r3 = Sheets("test").ComboBoxInC14.Value
    r4 = Sheets("test").ComboBoxInC15.Value
    r5 = Sheets("test").ComboBoxInC16.Value
    r6 = Sheets("test").ComboBoxInC17.Value
    r7 = Sheets("test").ComboBoxInC18.Value
    r8 = Sheets("test").ComboBoxInC19.Value
    r9 = Sheets("test").ComboBoxInC20.Value
    r10 = Sheets("test").ComboBoxInC21.Value
    r11 = Sheets("test").ComboBoxInC22.Value
    r12 = Sheets("test").ComboBoxInC23.Value
    r13 = Sheets("test").ComboBoxInC24.Value
    r14 = Sheets("test").ComboBoxInC25.Value
    r15 = Sheets("test").ComboBoxInC26.Value
    r16 = Sheets("test").ComboBoxInC27.Value
    r17 = Sheets("test").ComboBoxInC28.Value
    r18 = Sheets("test").ComboBoxInC29.Value
    r19 = Sheets("test").ComboBoxInC30.Value
    r20 = Sheets("test").ComboBoxInC31.Value

' aktivovanie zositu "vyhodnotenie", h|fffd|rku "vyhodnotenie" a priradenie premenn|fffd|m r1-r20 bunk|fffd|m aby vznikla |fffd|plna kopia testu
   
    Range(Cells(12, 30), Cells(12, 30)).Cells = r1
    Range(Cells(13, 30), Cells(13, 30)).Cells = r2
    Range(Cells(14, 30), Cells(14, 30)).Cells = r3
    Range(Cells(15, 30), Cells(15, 30)).Cells = r4
    Range(Cells(16, 30), Cells(16, 30)).Cells = r5
    Range(Cells(17, 30), Cells(17, 30)).Cells = r6
    Range(Cells(18, 30), Cells(18, 30)).Cells = r7
    Range(Cells(19, 30), Cells(19, 30)).Cells = r8
    Range(Cells(20, 30), Cells(20, 30)).Cells = r9
    Range(Cells(21, 30), Cells(21, 30)).Cells = r10
    Range(Cells(22, 30), Cells(22, 30)).Cells = r11
    Range(Cells(23, 30), Cells(23, 30)).Cells = r12
    Range(Cells(24, 30), Cells(24, 30)).Cells = r13
    Range(Cells(25, 30), Cells(25, 30)).Cells = r14
    Range(Cells(26, 30), Cells(26, 30)).Cells = r15
    Range(Cells(27, 30), Cells(27, 30)).Cells = r16
    Range(Cells(28, 30), Cells(28, 30)).Cells = r17
    Range(Cells(29, 30), Cells(29, 30)).Cells = r18
    Range(Cells(30, 30), Cells(30, 30)).Cells = r19
    Range(Cells(31, 30), Cells(31, 30)).Cells = r20

 
    ActiveWorkbook.Save






       
       
       
       


End Sub

Attribute VB_Name = "vygenerovat_otazky"

Sub vypocet()


'**************************************
'autor: milan.botka@ceitgroup.eu
' nakodovane co najjednoduchsie aby to kopirovalo co robi clovek a aby si to uzivatelia pokial mozno mohli upravit
'**************************************



Dim Zaradenie As String
Dim blok As String
Dim uroven As String
Dim row3 As Integer 'integer moze ist az do 32 767, znamena to ze subor 'data' nesmie mat vacsi pocet riadkov ako tento limit
Dim row4 As Integer
Dim row5 As Integer
Dim row6 As Integer
Dim max_cislo_uroven1 As Integer
Dim max_cislo_uroven2 As Integer
Dim max_cislo_uroven3 As Integer
Dim maxRow As Integer
Dim maxRow1 As Integer
Dim maxrow2 As Integer
Dim sucet_max_cislo_ot As Integer



Application.ScreenUpdating = False



' nacita si blok ktory nalezi cloveku pre ktoreho sa ide generovat test
blok = Sheets("vytvorenie_testu").Cells(5, 7).Value

' nacita si zaradenie ktore nalezi cloveku pre ktoreho sa ide generovat test
Zaradenie = Sheets("vytvorenie_testu").Cells(5, 6).Value

' pociatocne priradenie premennej 'row4' cislo '1'
row4 = 1

'spocita pocet riadkov / otazok ktore su v liste 'data', toto je zaroven hodnota ktora urcuje opakovania v cykle for-next
maxRow1 = Sheets("data").Range("B65536").End(xlUp).row


' vyberie list 'vypocet' a vymaze vsetky bunky ak by tam nieco zostalo z povodnych aby sa to nemiesalo vybraty clovek - to co tam je
Sheets("vypocet").Select
Cells.Select
Selection.ClearContents

' ide rad radom cez list data az na koniec
For row3 = 2 To maxRow1
    

 ' ak sedi v liste 'data' blok a zaradenie tak je tato otazka vybrata / vyberie vsetky otazky pre dany blok a zaradenie
    If blok >= Sheets("data").Cells(row3, 12).Value And Zaradenie = Sheets("data").Cells(row3, 9).Value Then
      
        
         
'vyberie dany potrebny riadok
         Sheets("data").Select
         Sheets("data").Range(Cells(row3, 1), Cells(row3, 15)).Select
         Selection.Copy
         
'toto pocita premenne 'row4' a pridava jej +1 /hlavicka v danom liste/ z kazdym novym cyklom, tzn. kolko cyklov prejde tolko riadkov +1 bude mat list 'vypocet'
         row4 = row4 + 1

'nakopiruje tento riadok do listu 'vypocet'
         Sheets("vypocet").Select
         Sheets("vypocet").Cells(row4, 2).Select
          Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
              
    End If
    

'ak je blok vacsi alebo rovny a zaroven v zaradeni je 'planer, postupar' potom sa to z listu 'data' nakopiruje do listu 'vypocet'
    If blok >= Sheets("data").Cells(row3, 12).Value And Sheets("data").Cells(row3, 9).Value = "planer, postupar" Then
             
             Sheets("data").Select
            Sheets("data").Range(Cells(row3, 1), Cells(row3, 15)).Select
            Selection.Copy
            row4 = row4 + 1
              
            Sheets("vypocet").Select
            Sheets("vypocet").Cells(row4, 2).Select
            Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
            :=False, Transpose:=False

      End If
    
   
   'testovacia uroven je parameter otazky v liste 'data'

    If Sheets("vypocet").Cells(row4, 14).Value = "1" Then
            max_cislo_uroven1 = max_cislo_uroven1 + 1 'pocitadlo max urovne aby bolo mozne vypocitat rovnomerny pomer otazok v liste 'vypocet' / to plati pre vsetky urovne
       
    End If

    If Sheets("vypocet").Cells(row4, 14).Value = "2" Then
            max_cislo_uroven2 = max_cislo_uroven2 + 1
    End If

    If Sheets("vypocet").Cells(row4, 14).Value = "3" Then
            max_cislo_uroven3 = max_cislo_uroven3 + 1
    End If
  

    If Sheets("vypocet").Cells(row4, 14).Value = "1" Then
            Sheets("vypocet").Range(Cells(row4, 12), Cells(row4, 12)).Value = max_cislo_uroven1
    End If

    If Sheets("vypocet").Cells(row4, 14).Value = "2" Then
            Sheets("vypocet").Range(Cells(row4, 12), Cells(row4, 12)).Value = max_cislo_uroven2
    End If

    If Sheets("vypocet").Cells(row4, 14).Value = "3" Then
            Sheets("vypocet").Range(Cells(row4, 12), Cells(row4, 12)).Value = max_cislo_uroven3
    End If
    
Next row3

' zmazanie premennych
row4 = Empty
row3 = Empty
maxrow2 = Empty


If Val(Application.Version) >= 16 Then
Sheets("vypocet").Select
            Sheets("vypocet").Cells(1, 19) = "= MAXIFS(B1:B1400,N1:N1400,1)"
            Sheets("vypocet").Cells(1, 20) = "= MAXIFS(B1:B1400,N1:N1400,2)"
            Sheets("vypocet").Cells(1, 21) = "= MAXIFS(B1:B1400,N1:N1400,3)"

Else
Sheets("vypocet").Select
            Sheets("vypocet").Range(Cells(2, 19), Cells(2, 19)).Formula = "=MAX(IF(B1:B1400=1,N1:N1400))"
            Sheets("vypocet").Range(Cells(2, 20), Cells(2, 20)).Formula = "=MAX(IF(B1:B1400=2,N1:N1400))"
            Sheets("vypocet").Range(Cells(2, 21), Cells(2, 21)).Formula = "=MAX(IF(B1:B1400=3,N1:N1400))"
 ' toto som musel spravit takto lebo v 1. riadku mi to hadzalo 0 ale v 2. to uz fungovalo, neviem preco ale takto je to OK
            Sheets("vypocet").Range(Cells(1, 19), Cells(1, 19)) = Sheets("vypocet").Range(Cells(2, 19), Cells(2, 19))
            Sheets("vypocet").Range(Cells(1, 20), Cells(1, 20)) = Sheets("vypocet").Range(Cells(2, 20), Cells(2, 20))
            Sheets("vypocet").Range(Cells(1, 21), Cells(1, 21)) = Sheets("vypocet").Range(Cells(2, 21), Cells(2, 21))

'pre nizsie verzie treba pouzit namiesto MAXIF tento vzorec =MAX(IF(B1:B1400=1,N1:N1400))

End If



'sucet_max_cislo_ot = max_cislo_uroven1 + max_cislo_uroven2 + max_cislo_uroven3 ' zrata kolko je v liste 'vypocet' otazok 1., 2. a 3. urovne
sucet_max_cislo_ot = Sheets("vypocet").Cells(1, 19).Value + Sheets("vypocet").Cells(1, 20).Value + Sheets("vypocet").Cells(1, 21).Value



' zisti kolko je riadkov v liste 'vypocet'
maxRow = Sheets("vypocet").Range("D65536").End(xlUp).row

For row5 = 2 To maxRow

    If Sheets("vypocet").Cells(row5, 14) = "1" Then
    Range(Cells(row5, 15), Cells(row5, 15)) = sucet_max_cislo_ot * 0.7 ' toto je koeficient aby boli otazky zoradene v spravnom pomere, tak isto pre uroven 2 a 1, tzn. 70/20/10 percent
    End If

    If Sheets("vypocet").Cells(row5, 14) = "2" Then
    Range(Cells(row5, 15), Cells(row5, 15)) = sucet_max_cislo_ot * 0.2
    End If

    If Sheets("vypocet").Cells(row5, 14) = "3" Then
    Range(Cells(row5, 15), Cells(row5, 15)) = sucet_max_cislo_ot * 0.1
    End If



    Next row5
    
    
    
'vyprazdnenie danychpremennych
row5 = Empty
max_cislo_uroven1 = Empty
max_cislo_uroven2 = Empty
max_cislo_uroven3 = Empty
sucet_max_cislo_ot = Empty




'spustestenie aplikacie / modulu na preratavanie kumulativov urovni aby zoradovalo vzdy ine otazky
'********************************************************************************************************

Dim maxrow10 As Integer 'pocet riadkov v liste 'vypocet'
Dim random_cislo_uroven As Integer ' nahodne cislo od 0 do maxrow10 - od tadialto zacne pocitat
Dim row As Integer 'riadok v liste 'vypocet'
Dim time As Date ' cas na zaklade ktoreho sa pocita nahodne cislo
Dim poradie_uroven As Integer 'poradove cislo v ramci urovne

Dim uroven1_kumulativne As Integer
Dim uroven2_kumulativne As Integer
Dim uroven3_kumulativne As Integer

Dim uroven4_kumulativne As Integer
Dim uroven5_kumulativne As Integer
Dim uroven6_kumulativne As Integer

time = Now()

'Dim nahodne_cisla As Integer

'Dim otazka As Integer


'1. najprv treba najst nahodne cislo v intervale 0 do maximalny pocet riadkov


'zisti maximalny pocet riadkov
maxrow10 = Sheets("vypocet").Range("B65536").End(xlUp).row



'najde nahodne cislo od ktoreho ide cislovat
random_cislo_uroven = Int((maxrow10 - 1 + 1) * Rnd * Second(time) / 60 + 1)

Sheets("vypocet").Cells(1, 5).Value = random_cislo_uroven



'2. precislovat od nahodneho cisla po koniec


For row = random_cislo_uroven To maxrow10


    If Sheets("vypocet").Cells(row, 14).Value = 1 Then

            uroven1_kumulativne = uroven1_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven1_kumulativne
     uroven4_kumulativne = uroven1_kumulativne
    End If


    If Sheets("vypocet").Cells(row, 14).Value = 2 Then

            uroven2_kumulativne = uroven2_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven2_kumulativne
     uroven5_kumulativne = uroven2_kumulativne
    End If


    If Sheets("vypocet").Cells(row, 14).Value = 3 Then

            uroven3_kumulativne = uroven3_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven3_kumulativne
    uroven6_kumulativne = uroven3_kumulativne
    End If


Next row

random_cislo_uroven = random_cislo_uroven - 1

'3. precislovat od zaciatku po nahodne cislo, premenne treba nechat


For row = 2 To random_cislo_uroven

uroven = Sheets("vypocet").Cells(row, 14).Value


    If Sheets("vypocet").Cells(row, 14).Value = 1 Then

            uroven4_kumulativne = uroven4_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven4_kumulativne
    End If


    If Sheets("vypocet").Cells(row, 14).Value = 2 Then

            uroven5_kumulativne = uroven5_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven5_kumulativne
    End If


    If Sheets("vypocet").Cells(row, 14).Value = 3 Then

            uroven6_kumulativne = uroven6_kumulativne + 1
            Sheets("vypocet").Cells(row, 2).Value = uroven6_kumulativne
    End If


Next row

'zoradenie podla stlca 17 sa dosiahne spravny pomer urovni
Range(Cells(1, 2), Cells(maxrow10, 17)).Sort Key1:=Range(Cells(1, 17), Cells(maxrow10, 17)), Order1:=xlAscending, Header:=xlYes

'********************************************************************************************************

For row5 = 2 To maxRow
    Range(Cells(row5, 17), Cells(row5, 17)) = Cells(row5, 2) / Cells(row5, 15) ' Cells(row5, 2) / Cells(row5, 15)
Next row5

row5 = Empty

'zoradenie podla stlca 17 sa dosiahne spravny pomer urovni
Range(Cells(1, 1), Cells(maxRow, 17)).Sort Key1:=Range(Cells(1, 17), Cells(maxRow, 17)), Order1:=xlAscending, Header:=xlYes

'zozoomuje sa na 75 perc.
    ActiveWindow.Zoom = 75
Range("A1").Select

'zapne sa aktualizacia grafiky lebo hore je to vypnute aby bezali lepsie vypocty
Application.ScreenUpdating = True


' zmaze sam seba**************************************
Dim vbCom As Object

    MsgBox "Hi, I will delete myself "
    Set vbCom = Application.VBE.ActiveVBProject.VBComponents

    vbCom.Remove VBComponent:= _
    vbCom.Item("vygenerovat_otazky")
'******************************************************


End Sub


Attribute VB_Name = "vygenerovat_test"
Sub tvorba_dotaznika()
Attribute tvorba_dotaznika.VB_ProcData.VB_Invoke_Func = " \n14"

'**************************************
'autor: milan.botka@ceitgroup.eu
' nakodovane co najjednoduchsie aby to kopirovalo co robi clovek a aby si to uzivatelia pokial mozno mohli upravit
' skript generuje test z listu 'vypocet'
'**************************************

Dim time As Date ' premenna sluzi na urcenie nahodneho cisla podla aktualneho casu, pretoze fcia Random vzdy generuje rovnake nahodne cisla a otazky by boli vzdy podobne

Dim otazka As Integer

Dim find As String

Dim otazka1 As String

Dim otazka2 As String

Dim otazka3 As String

Dim otazka4 As String

Dim row As Integer

Dim maxrow2 As Integer

Application.ScreenUpdating = False


' z pripraveneho listu 'vzor' vytvori list 'test'
    Sheets("vzor").Select
    Sheets("vzor").Copy Before:=Sheets(1)
    Sheets("vzor (2)").Select
    Sheets("vzor (2)").Name = "test"
    Range("B42").Select
    
' nakopiruje hlavicku
    Sheets("vzor").Select
    Rows("3:10").Select
    Selection.Copy
    Sheets("test").Select
    Range("A3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("B7").Select
    
 'zisti sucasny cas a pouzije sucasnu sekundu zo systemoveho casu na vypocet nahodneho cisla
time = Now()

'vypne prepinanie obrazovky pri vypoctoch a vyuzije tuto pamat na vypocty cim skrati vypocet o min. 30%
Application.DisplayAlerts = False

For otazka = 2 To 21

'toto su data z listu 'vypocet' ale prvych 20 otazok sa pouziva blok a uroven aby pasoval ich pomer ale otazky su vyberane z celeho dokumentu 'vypocet'
Sheets("vypocet").Select

'nacita si hodnoty blok a uroven z listu 'vypocet'
'blok = Cells(otazka, 13)
'uroven = Cells(otazka, 14)

maxrow2 = Sheets("vypocet").Range("B65536").End(xlUp).row
'max_cislo_uroven = 0
'
                                                                find = Sheets("vypocet").Cells(otazka, 5).Value
                                                                otazka1 = Sheets("vypocet").Cells(otazka, 6).Value
                                                                otazka2 = Sheets("vypocet").Cells(otazka, 7).Value
                                                                otazka3 = Sheets("vypocet").Cells(otazka, 8).Value
                                                                otazka4 = Sheets("vypocet").Cells(otazka, 9).Value


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
'Toto podla vygenerovaneho nahodneho cisla v intervale 1-4 zmeni poradie otazok aby neplatilo, ze 1. je spravna

Dim random_cislo As Integer
                   
                        random_cislo = Int((4 - 1 + 1) * Rnd + 1)

If random_cislo = 1 Then
                                                                otazka1 = Sheets("vypocet").Cells(otazka, 6).Value
                                                                otazka2 = Sheets("vypocet").Cells(otazka, 7).Value
                                                                otazka3 = Sheets("vypocet").Cells(otazka, 8).Value
                                                                otazka4 = Sheets("vypocet").Cells(otazka, 9).Value
End If

If random_cislo = 2 Then
                                                                otazka2 = Sheets("vypocet").Cells(otazka, 6).Value
                                                                otazka3 = Sheets("vypocet").Cells(otazka, 7).Value
                                                                otazka4 = Sheets("vypocet").Cells(otazka, 8).Value
                                                                otazka1 = Sheets("vypocet").Cells(otazka, 9).Value
End If

If random_cislo = 3 Then
                                                                otazka3 = Sheets("vypocet").Cells(otazka, 6).Value
                                                                otazka4 = Sheets("vypocet").Cells(otazka, 7).Value
                                                                otazka1 = Sheets("vypocet").Cells(otazka, 8).Value
                                                                otazka2 = Sheets("vypocet").Cells(otazka, 9).Value
End If

If random_cislo = 4 Then
                                                                otazka4 = Sheets("vypocet").Cells(otazka, 6).Value
                                                                otazka1 = Sheets("vypocet").Cells(otazka, 7).Value
                                                                otazka2 = Sheets("vypocet").Cells(otazka, 8).Value
                                                                otazka3 = Sheets("vypocet").Cells(otazka, 9).Value
End If
                                                                                                    


Sheets("test").Select

Sheets("test").Cells(otazka + 10, 2).Value = find
find = Empty

Cells(otazka + 10, 1) = otazka - 1


  Sheets("test").Select

    Columns("A:A").Select
    Selection.ColumnWidth = 5
 
    Rows("12:31").Select
    Selection.RowHeight = 38
    
    Columns("B:B").Select
    Selection.ColumnWidth = 60
       With Selection.Font
        .Name = "Arial"
        .Size = 10
    End With
    
    Columns("C:C").Select
    Selection.ColumnWidth = 200

   Range(Cells(otazka + 10, 21), Cells(otazka + 10, 21)).Value = otazka1
   Range(Cells(otazka + 10, 22), Cells(otazka + 10, 22)).Value = otazka2
   Range(Cells(otazka + 10, 23), Cells(otazka + 10, 23)).Value = otazka3
   Range(Cells(otazka + 10, 24), Cells(otazka + 10, 24)).Value = otazka4
     
Dim rng As Excel.Range, cmb As OLEObject
For Each rng In Range(Cells(otazka + 10, 3), Cells(otazka + 10, 3)).Cells
    With rng
        Set cmb = .Parent.OLEObjects.Add("Forms.combobox.1")
        
        cmb.Top = .Top
        cmb.Left = .Left
        cmb.Width = .Width
        cmb.Height = .Height

        cmb.Name = "ComboBoxIn" & rng.Address(False, False)
        cmb.Object.List = Array(otazka1, otazka2, otazka3, otazka4)
        'cmb.LinkedCell = Range(Cells(otazka + 10, 3), Cells(otazka + 10, 3)).Value
        
        
        cmb.Placement = xlMoveAndSize
        
 
     End With

Next rng


Next otazka


ActiveWorkbook.SaveAs Filename:=Application.ActiveWorkbook.Path & "\test.xls", FileFormat:= _
xlNormal, Password:="", WriteResPassword:="", ReadOnlyRecommended:=False _
, CreateBackup:=False

Application.DisplayAlerts = False

Worksheets("poznamky").Delete

Worksheets("data").Delete
Worksheets("vypocet").Delete
Worksheets("zamestnanci").Delete
Worksheets("vytvorenie_testu").Delete

Worksheets("vzor").Delete

Application.DisplayAlerts = True


Application.DisplayAlerts = False





Workbooks("test.xls").Save


Application.DisplayAlerts = True


    Sheets("test").Select
    ActiveWindow.Zoom = 70
Range("A1").Select

ActiveWorkbook.Save

' zmaze sam seba**************************************
Dim vbCom As Object

    MsgBox "Hi, I will delete myself "
    Set vbCom = Application.VBE.ActiveVBProject.VBComponents

    vbCom.Remove VBComponent:= _
    vbCom.Item("vygenerovat_test")
'******************************************************

End Sub



INQUEST-PP=macro
