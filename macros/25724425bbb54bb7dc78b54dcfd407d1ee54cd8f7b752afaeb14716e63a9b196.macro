Attribute VB_Name = "F_|fffd|R|fffd||fffd||fffd||fffd||fffd|g"
Attribute VB_Base = "0{EF7A15C3-FA23-4E78-9A0A-F55B0DF9F2B2}{70029DF3-AA00-4C42-B3C0-8B3280036935}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
'*miya_2018.04.09 |fffd||3ce|c_2675 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd|
Dim wLen As Integer

Private Sub btn_|fffd|m|fffd||fffd|_Click()
    '*miya_2018.04.09 |fffd||3ce|c_2675 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd|
    If wLen > 0 Then
        If PF_AnsiLenB(Me.Txt_|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g) > wLen Then
            MsgBox ("|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||341|A|fffd||fffd||fffd|p" & wLen & "|fffd||fffd||fffd||fffd||fffd|i|fffd|S|fffd|p" & Int(wLen / 2) & "|fffd||fffd||fffd||fffd||fffd|j|fffd||213||fffd||fffd||153||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
            Exit Sub
        End If
    End If
    
    gComntI = Me.Txt_|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g
    Unload Me

End Sub

Private Sub btn_|fffd||7c2||fffd|_Click()
    Unload Me

End Sub


Private Sub UserForm_Initialize()
    Me.Txt_|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g = gComntI
    Me.Txt_|fffd|S|fffd|R|fffd||fffd||fffd||fffd||fffd|g = gComntA
    
    '*miya_2018.04.09 |fffd||3ce|c_2675 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd||fffd||1c9||fffd|
    wLen = 3000 - (PF_AnsiLenB(gComntA) + PF_AnsiLenB("|fffd|y" & gSyoriDt & "|fffd|F" & gTantoNm & "|fffd|z ") + 2)
    If wLen <= 0 Then
        Me.Label1.Caption = "|fffd||fffd||fffd||fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|i|fffd||fffd||fffd||34d||3c2||742||303|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c1|A|fffd||fffd||fffd||fffd||20f||fffd||fffd||fffd||342||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|j"
        Me.Txt_|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g.BackColor = &HC0FFFF
        Me.Txt_|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g.Locked = True
    End If
     
End Sub
Attribute VB_Name = "F_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{01C1FFE3-9F6F-4304-8FFE-5F936A66636C}{B9D79C3D-4AED-46EA-BEF2-A7465CAF29E5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub btn_|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|_Click()
    ThisWorkbook.Saved = True
    Application.DisplayAlerts = False
    Application.Quit
    ThisWorkbook.Close False

End Sub

Private Sub btn_|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|_Click()
    F_|fffd|R|fffd||fffd||fffd||fffd||fffd|g.Show

End Sub

Private Sub btn_|fffd||fffd||fffd||7c2||fffd|_Click()
    Dim arrtemp As Variant
    Dim wSkbn As String
    Dim wMsg As String
    
    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'    If Err <> 0 Then
'        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & Err & Err.Description)
'        ThisWorkbook.Saved = True
'        Application.DisplayAlerts = False
'        Application.Quit
'        ThisWorkbook.Close False
'    End If
'
'    oSOAPClient.mssoapinit wOutDbCon
'
'    oSOAPClient.ConnectorProperty("Timeout") = 60000
    '2015.02.16 mimura del |fffd||fffd|
    
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
    'If Me.chk_|fffd||10a|J = True Then
    '    wSkbn = "|fffd|S|fffd||fffd||fffd||fffd|"
    '    wMsg = "|fffd||14f||fffd||fffd||fffd||fffd||fffd||10a|J|fffd|w|fffd||fffd||fffd|"
    'Else
    '    wSkbn = "|fffd||fffd||fffd||fffd|"
    '    wMsg = ""
    'End If
    wSkbn = "|fffd||fffd||fffd||fffd|"
    If Me.cmb_|fffd||10a|J.Column(1) < 0 Then
        wMsg = Me.cmb_|fffd||10a|J.Column(0)
    Else
        wMsg = Me.cmb_|fffd||10a|J.Column(0) & "|fffd||fffd||fffd||fffd||10a|J"
    End If
    wMsg = wMsg & "|fffd|w|fffd||fffd||fffd|"
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
    
    If MsgBox(wMsg & "|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbCritical + vbYesNo) <> vbYes Then
        Exit Sub
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    arrtemp = PF_|fffd||fffd||fffd||654||fffd||fffd||fffd|(wSkbn)
'    arrtemp = oSOAPClient.Kessai_Hantei(wSkbn, gNumber, gBusyo, gTanto, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox (arrtemp)
        Exit Sub
    End If
    
    If gComntI & "" <> "" Then
        gComntA = gComntA & "|fffd|y" & gSyoriDt & "|fffd|F" & gTantoNm & "|fffd|z " & gComntI & vbCrLf
        gComntI = ""
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
    '|fffd||10a|J|fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||153|n|fffd||fffd|
    'arrtemp = PF_|fffd||fffd||fffd||64d|X|fffd|V(wSkbn)
    arrtemp = PF_|fffd||fffd||fffd||64d|X|fffd|V(wSkbn, CStr(Me.cmb_|fffd||10a|J.Column(1)))
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
'    arrtemp = oSOAPClient.Kessai_kousin(wSkbn, gNumber, gComntA, gBusyo, gTanto, gUpid, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox arrtemp, vbCritical
        Exit Sub
    End If
    
    MsgBox "|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"

    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = Nothing
    '2015.02.16 mimura del |fffd||fffd|
    
    Call PS_|fffd||fffd||fffd||657||fffd||fffd||48f|W(wSkbn)
    ThisWorkbook.Sheets("DATA5").Range("B2") = gComntA
    
    Me.btn_|fffd||fffd||fffd|F.Enabled = False
    Me.btn_|fffd||6d4|F.Enabled = False
    Me.btn_|fffd||fffd||fffd||7c2||fffd|.Enabled = False
    
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
    Call updIE
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<
    
    ThisWorkbook.Saved = True
    Application.DisplayAlerts = False
    Application.Quit
    ThisWorkbook.Close False

End Sub

Private Sub btn_|fffd||fffd||fffd|F_Click()
    Dim arrtemp As Variant
    
    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'    If Err <> 0 Then
'        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & Err & Err.Description)
'        ThisWorkbook.Saved = True
'        Application.DisplayAlerts = False
'        Application.Quit
'        ThisWorkbook.Close False
'    End If
'
'    oSOAPClient.mssoapinit wOutDbCon
'
'    oSOAPClient.ConnectorProperty("Timeout") = 60000
    '2015.02.16 mimura del |fffd||fffd|
    
    If MsgBox("|fffd||fffd||fffd|F|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbYesNo) <> vbYes Then
        Exit Sub
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    arrtemp = PF_|fffd||fffd||fffd||654||fffd||fffd||fffd|("|fffd||fffd||fffd|F")
'    arrtemp = oSOAPClient.Kessai_Hantei("|fffd||fffd||fffd|F", gNumber, gBusyo, gTanto, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox (arrtemp)
        Exit Sub
    End If
    
    If gComntI & "" <> "" Then
        gComntA = gComntA & "|fffd|y" & gSyoriDt & "|fffd|F" & gTantoNm & "|fffd|z " & gComntI & vbCrLf
        gComntI = ""
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    arrtemp = PF_|fffd||fffd||fffd||64d|X|fffd|V("|fffd||fffd||fffd|F")
'    arrtemp = oSOAPClient.Kessai_kousin("|fffd||fffd||fffd|F", gNumber, gComntA, gBusyo, gTanto, gUpid, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox arrtemp, vbCritical
        Exit Sub
    End If
    
    MsgBox "|fffd||fffd||fffd|F|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"
   
    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = Nothing
    '2015.02.16 mimura del |fffd||fffd|
    
    Call PS_|fffd||fffd||fffd||657||fffd||fffd||48f|W("|fffd||fffd||fffd|F")
    ThisWorkbook.Sheets("DATA5").Range("B2") = gComntA
    
     Me.btn_|fffd||fffd||fffd|F.Enabled = False
     Me.btn_|fffd||6d4|F.Enabled = False
     Me.btn_|fffd||fffd||fffd||7c2||fffd|.Enabled = False
    
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
    Call updIE
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<
    
    ThisWorkbook.Saved = True
    Application.DisplayAlerts = False
    Application.Quit
    ThisWorkbook.Close False

End Sub

Private Sub btn_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|_Click()
    Dim wOutDbCon As String
    Dim fso As Object
    Dim appEXE As Object
    
    
    wOutDbCon = ThisWorkbook.Sheets("INFO").Range("A1") & ""
    Set fso = CreateObject("Scripting.FileSystemObject")
    
    On Error Resume Next
    
    '*miya_2017.10.30
    If fso.FileExists("C:\4zApp\FLS2\|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.exe") = False Then
        MsgBox "|fffd|N|fffd||fffd||fffd|C|fffd|A|fffd||fffd||fffd|g|fffd|Z|fffd|b|fffd|g|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & "|fffd|g|fffd|b|fffd|v|fffd|y|fffd|[|fffd|W|fffd||596||7c2||fffd|A|fffd|N|fffd||fffd||fffd|C|fffd|A|fffd||fffd||fffd|g|fffd|Z|fffd|b|fffd|g|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|s|fffd||202||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B", vbInformation
    Else
        'VB|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
        Set appEXE = CreateObject("WScript.Shell")
        '*miya_2017.10.30
        appEXE.Run ("C:\4zApp\FLS2\|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.exe " & wOutDbCon & " " & gIp & " " & gNumber & " " & gUserID & " R B K " & gTanto & " " & gDbid)
        Set appEXE = Nothing
    End If
    
    Set fso = Nothing

End Sub

Private Sub btn_|fffd||50d||fffd||fffd||fffd||fffd||fffd|_Click()
    Dim wTenpNo As String
    
    wTenpNo = InputBox("|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||242||34e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Y|fffd|t|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
                       "|fffd||fffd||fffd||fffd||fffd|Y|fffd|t|fffd|p|fffd||fffd||fffd||313|Y|fffd|t|fffd||50d||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & _
                       "|fffd|Y|fffd|t|fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||702||fffd||fffd||34c||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||341|A|fffd||fffd||fffd|F|fffd||142||fffd||fffd||702||fffd||fffd||fffd|B", "|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd|")
    If wTenpNo = PF_|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd||50d||fffd|(ThisWorkbook.Sheets("DATA2").Range("B1"), ThisWorkbook.Sheets("DATA2").Range("B4")) Then
        Me.btn_|fffd||fffd||fffd|F.Visible = True
        '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima UPD_S >>
        '|fffd||fffd||282||fffd||fffd||fffd||303|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^gDenshiKessaiMode(|fffd|d|fffd|q|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h)|fffd||fffd|"|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h"|fffd||30f||a347||fffd||302||755|\|fffd||fffd|
        'Me.btn_|fffd||6d4|F.Visible = True
        'Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = True
        'Me.chk_|fffd||10a|J.Visible = True
        If gDenshiKessaiMode = "|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h" Then
            Me.btn_|fffd||6d4|F.Visible = True
            Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = True
            '2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            'Me.chk_|fffd||10a|J.Visible = True
            Me.lbl_|fffd||10a|J.Visible = True
            Me.cmb_|fffd||10a|J.Visible = True
            '|fffd||fffd|2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            '2019.01.28 mura add|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            Call PS_|fffd||10a|J|fffd||fffd||fffd|X|fffd|g|fffd||c42c|
        Else
            Me.btn_|fffd||6d4|F.Visible = False
            Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = False
            '2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            'Me.chk_|fffd||10a|J.Visible = False
            Me.lbl_|fffd||10a|J.Visible = False
            Me.cmb_|fffd||10a|J.Visible = False
            '|fffd||fffd|2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
        End If
        '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima UPD_E <<
        Me.btn_|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|.Visible = True
    Else
        MsgBox "|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B|fffd||113|x|fffd|A|fffd||fffd||fffd||342||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|I"
    End If

End Sub

Private Sub btn_|fffd||6d4|F_Click()
    Dim arrtemp As Variant
    
    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'    If Err <> 0 Then
'        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & Err & Err.Description)
'        ThisWorkbook.Saved = True
'        Application.DisplayAlerts = False
'        Application.Quit
'        ThisWorkbook.Close False
'    End If
'
'    oSOAPClient.mssoapinit wOutDbCon
'
'    oSOAPClient.ConnectorProperty("Timeout") = 60000
    '2015.02.16 mimura del |fffd||fffd|
    
    If MsgBox("|fffd||6d4|F|fffd||fffd||fffd||702||fffd||fffd|B|fffd||fffd||b0b5||fffd||fffd||fffd||142||fffd||fffd||fffd||fffd|H", vbCritical + vbYesNo) <> vbYes Then
        Exit Sub
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    arrtemp = PF_|fffd||fffd||fffd||654||fffd||fffd||fffd|("|fffd||6d4|F")
'    arrtemp = oSOAPClient.Kessai_Hantei("|fffd||6d4|F", gNumber, gBusyo, gTanto, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox (arrtemp)
        Exit Sub
    End If
    
    If gComntI & "" <> "" Then
        gComntA = gComntA & "|fffd|y" & gSyoriDt & "|fffd|F" & gTantoNm & "|fffd|z " & gComntI & vbCrLf
        gComntI = ""
    End If
    
    '2015.02.16 mimura upd ExSoap|fffd||389||fffd| |fffd||fffd|
    arrtemp = PF_|fffd||fffd||fffd||64d|X|fffd|V("|fffd||6d4|F")
'    arrtemp = oSOAPClient.Kessai_kousin("|fffd||6d4|F", gNumber, gComntA, gBusyo, gTanto, gUpid, gDbid)
    '2015.02.16 mimura upd |fffd||fffd|
    If arrtemp & "" <> "" Then
        MsgBox arrtemp, vbCritical
        Exit Sub
    End If
    
    MsgBox "|fffd||6d4|F|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|I"

    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'    Set oSOAPClient = Nothing
    '2015.02.16 mimura del |fffd||fffd|
    
    Call PS_|fffd||fffd||fffd||657||fffd||fffd||48f|W("|fffd||6d4|F")
    ThisWorkbook.Sheets("DATA5").Range("B2") = gComntA

    Me.btn_|fffd||fffd||fffd|F.Enabled = False
    Me.btn_|fffd||6d4|F.Enabled = False
    Me.btn_|fffd||fffd||fffd||7c2||fffd|.Enabled = False

    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
    Call updIE
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<
    
    ThisWorkbook.Saved = True
    Application.DisplayAlerts = False
    Application.Quit
    ThisWorkbook.Close False

End Sub

Private Sub PS_|fffd||fffd||fffd||657||fffd||fffd||48f|W(pKbn As String)
    Dim i As Integer
    
    i = 2
    Do Until ThisWorkbook.Sheets("DATA4").Cells(i, 1) = ""
        If ThisWorkbook.Sheets("DATA4").Cells(i, 6) = gBusyo And _
           ThisWorkbook.Sheets("DATA4").Cells(i, 9) = gTanto Then
            ThisWorkbook.Sheets("DATA4").Cells(i, 12) = pKbn
            If pKbn = "|fffd||fffd||fffd|F" Or _
               pKbn = "|fffd||6d4|F" Then
                ThisWorkbook.Sheets("DATA4").Cells(i, 13) = gSyoriDt
            End If
            Exit Do
        End If
        i = i + 1
    Loop

End Sub

Private Sub UserForm_Initialize()
    If PF_VerGet() > "2003" Then
        Me.Top = Application.CommandBars("Ribbon").Height + 5
    Else
        Me.Top = 160
    End If
    Me.Left = 600
    If ThisWorkbook.Sheets("DATA3").Range("A2") = "" Then
        Me.btn_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.Visible = False
    Else
        Me.btn_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.Visible = True
    End If
    
    '*|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||752||fffd|
    gComntA = ThisWorkbook.Sheets("DATA5").Range("B2")
    gComntI = ""
    
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima UPD_S >>
    'INFO|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||30e|Q|fffd||192|l|fffd||255||3cd|X
    'If ThisWorkbook.Sheets("DATA2").Range("B28") = "|fffd|L|fffd||fffd|" Then
    If gTenpuBunsyoUmu = "|fffd|L|fffd||fffd|" Then
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima UPD_E <<
        Me.btn_|fffd||50d||fffd||fffd||fffd||fffd||fffd|.Visible = True
        Me.btn_|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|.Visible = False
        Me.btn_|fffd||fffd||fffd|F.Visible = False
        Me.btn_|fffd||6d4|F.Visible = False
        Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = False
        '2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
        'Me.chk_|fffd||10a|J.Visible = False
        Me.lbl_|fffd||10a|J.Visible = False
        Me.cmb_|fffd||10a|J.Visible = False
        '|fffd||fffd|2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
    Else
        Me.btn_|fffd||50d||fffd||fffd||fffd||fffd||fffd|.Visible = False
        Me.btn_|fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|.Visible = True
        Me.btn_|fffd||fffd||fffd|F.Visible = True
        '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima UPD_S >>
        '|fffd||fffd||282||fffd||fffd||fffd||303|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^gDenshiKessaiMode(|fffd|d|fffd|q|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h)|fffd||fffd|"|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h"|fffd||30f||a347||fffd||302||755|\|fffd||fffd|
        'Me.btn_|fffd||6d4|F.Visible = True
        'Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = True
        'Me.chk_|fffd||10a|J.Visible = True
        If gDenshiKessaiMode = "|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h" Then
            Me.btn_|fffd||6d4|F.Visible = True
            Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = True
            '2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            'Me.chk_|fffd||10a|J.Visible = True
            Me.lbl_|fffd||10a|J.Visible = True
            Me.cmb_|fffd||10a|J.Visible = True
            '|fffd||fffd|2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            '2019.01.28 mura add|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            Call PS_|fffd||10a|J|fffd||fffd||fffd|X|fffd|g|fffd||c42c|
        Else
            Me.btn_|fffd||6d4|F.Visible = False
            Me.btn_|fffd||fffd||fffd||7c2||fffd|.Visible = False
            '2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
            'Me.chk_|fffd||10a|J.Visible = False
            Me.lbl_|fffd||10a|J.Visible = False
            Me.cmb_|fffd||10a|J.Visible = False
            '|fffd||fffd|2019.01.28 mura upd|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
        End If
        '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima UPD_E <<
    End If

End Sub

'2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
'|fffd||10f|o|fffd||fffd||fffd||fffd||282||30d|X|fffd|V(|fffd|\|fffd||fffd||fffd||fffd||fffd||30d||150|V|fffd||fffd|)
Private Sub updIE()

    Dim wIE As Object
        
    If gGamenUrl & "" = "" Then
        Exit Sub
    End If
    
    '2016.12.20 |fffd|y|fffd||3ce|c2168|fffd|z kuwajima ADD_S >>
    '|fffd|V|fffd||fffd||fffd|N|fffd||fffd||fffd|C|fffd|A|fffd||fffd||fffd|g|fffd||8b||fffd||fffd||fffd||fffd||fffd|CreateObject("Shell.Application").Windows|fffd||fffd|nothing|fffd||182||202||fffd|G|fffd||fffd||fffd|[|fffd||182||202||fffd||5c1|A
    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||343|G|fffd||fffd||fffd|[|fffd||fffd||fffd|X|fffd||fffd||fffd|[[|fffd||fffd||fffd||30f||a347||fffd||fffd|HTML|fffd|{|fffd|^|fffd||fffd||fffd||30e||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N|fffd||342||202||fffd|]|fffd||fffd||fffd||fffd|(CreateObject|fffd||fffd|OK)
    On Error GoTo END_PROC
    '2016.12.20 |fffd|y|fffd||3ce|c2168|fffd|z kuwajima ADD_E <<
    
    For Each wIE In CreateObject("Shell.Application").Windows()
        If TypeName(wIE.document) = "HTMLDocument" Then
            '|fffd||fffd||fffd||743|E|fffd|B|fffd||fffd||fffd|h|fffd|E|fffd||fffd|HTML|fffd||30f||a347|
            
            If wIE.LocationURL = gGamenUrl Then
                'URL|fffd||fffd||fffd||10f|o|fffd||fffd||fffd||fffd||fffd|URL(|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^)|fffd||188||fffd|v
                If wIE.document.getElementById("txt_|fffd||fffd||fffd||5d4||50d||fffd|").Value = gNumber And _
                        Replace(wIE.document.getElementById("Header1_lbl_|fffd|S|fffd||fffd||fffd||496||fffd||fffd||fffd|").innerText, "|fffd|S|fffd||fffd||fffd||481|F", "") = gTantoNm Then
                    
                    
                    '|fffd||fffd||fffd||5d4||50d||fffd||fffd|A|fffd|S|fffd||fffd||fffd||482||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||188||fffd|v|fffd||fffd||fffd||fffd||fffd||a347||fffd||341|A|fffd||150|V|fffd|\|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd|N|fffd||fffd||fffd|b|fffd|N
                    '2018.02.08 |fffd|y|fffd||3ce|c2630|fffd|z kuwajima UPD_S >>
                    '|fffd||fffd||fffd||64a|J|fffd|n|fffd||3576||fffd||fffd||fffd||3cd|X|fffd||94||6c2||fffd|0:|fffd||6c2||30f||a347||fffd|A|fffd||fffd||fffd||7c2||fffd||fffd||fffd||fffd||155||fffd||fffd||fffd||fffd||fffd||291|S|fffd||302||315|\|fffd||fffd||fffd||fffd||502||fffd|
                    '|fffd||3cd|X|fffd||fffd||fffd||fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||fffd||5c1|A|fffd||102||44f|o|fffd||fffd||fffd|{|fffd|^|fffd||fffd||fffd||fffd|btn_|fffd||fffd||fffd||64a|J|fffd|n|fffd||fffd||fffd||28d|X|fffd|V|fffd||255||3cd|X
                    '|fffd|@|fffd||fffd|btn_|fffd||fffd||fffd||64a|J|fffd|n|fffd||fffd||fffd||28d|X|fffd|V|fffd||142||fffd|Init_Control()|fffd||30c||102||44f|o|fffd||fffd|
                    '|fffd|@|fffd||fffd||fffd||4c2||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||6c2||349||fffd||295||48f|W|fffd||fffd||fffd||142||342||202||fffd||fffd||fffd|Init_Control|fffd||fffd|DB|fffd|f|fffd|[|fffd|^|fffd||10e||64fe|
                    'wIE.document.getElementById("btn_|fffd||150|V|fffd|\|fffd||fffd|").Click
                    wIE.document.getElementById("btn_|fffd||fffd||fffd||64a|J|fffd|n|fffd||fffd||fffd||28d|X|fffd|V").Click
                    '2018.02.08 |fffd|y|fffd||3ce|c2630|fffd|z kuwajima UPD_E <<
                    
                    Exit Sub
                End If
            End If
        End If
    Next
'2016.12.20 |fffd|y|fffd||3ce|c2168|fffd|z kuwajima ADD_S >>
END_PROC:
    On Error GoTo 0
'2016.12.20 |fffd|y|fffd||3ce|c2168|fffd|z kuwajima ADD_E <<
    
End Sub
'2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<

'2019.01.28 mura add|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|
Private Sub PS_|fffd||10a|J|fffd||fffd||fffd|X|fffd|g|fffd||c42c|()

    Dim wCnt As Integer
    Dim wRow As Integer
    Dim wLastRow As Integer
    Dim wMaxLen As Integer
    
    '|fffd||fffd||fffd||7c2||fffd||fffd||482||fffd||fffd||fffd||10a|J
    Me.cmb_|fffd||10a|J.AddItem "|fffd||fffd||fffd||7c2||fffd||fffd||482||fffd||fffd||fffd||10a|J"
    Me.cmb_|fffd||10a|J.List(0, 1) = -1
    
    '|fffd||14f||fffd||fffd||fffd||fffd||fffd||10a|J
    Me.cmb_|fffd||10a|J.AddItem "|fffd||14f||fffd||fffd||fffd||fffd||fffd||10a|J"
    Me.cmb_|fffd||10a|J.List(1, 1) = -2

    'DATA4|fffd||fffd||fffd||fffd||752||fffd|
    wLastRow = ThisWorkbook.Sheets("DATA4").Range("A1").End(xlDown).Row
    For wRow = wLastRow To 2 Step -1
        If ThisWorkbook.Sheets("DATA4").Cells(wRow, 6) & "" = gBusyo And _
           ThisWorkbook.Sheets("DATA4").Cells(wRow, 9) & "" = gTanto And _
           ThisWorkbook.Sheets("DATA4").Cells(wRow, 11) & "" <> "" And _
           ThisWorkbook.Sheets("DATA4").Cells(wRow, 13) & "" = "" Then
           Exit For
        End If
    Next wRow
    If wRow >= 2 Then
        wCnt = 2
        For wRow = wRow + 1 To wLastRow
            If ThisWorkbook.Sheets("DATA4").Cells(wRow, 3) & "" = "" Then
                Me.cmb_|fffd||10a|J.AddItem ThisWorkbook.Sheets("DATA4").Cells(wRow, 10) & "(" & ThisWorkbook.Sheets("DATA4").Cells(wRow, 7) & " " & ThisWorkbook.Sheets("DATA4").Cells(wRow, 8) & ")"
                Me.cmb_|fffd||10a|J.List(wCnt, 1) = ThisWorkbook.Sheets("DATA4").Cells(wRow, 2)
                If wMaxLen < LenB(StrConv(Me.cmb_|fffd||10a|J.List(wCnt, 0), vbFromUnicode)) Then
                    wMaxLen = LenB(StrConv(Me.cmb_|fffd||10a|J.List(wCnt, 0), vbFromUnicode))
                End If
                wCnt = wCnt + 1
            End If
        Next wRow
    End If
    '|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|\|fffd||fffd|
    If wMaxLen > 20 Then
        Me.cmb_|fffd||10a|J.ListWidth = wMaxLen * 4.5
    End If
    Me.cmb_|fffd||10a|J.ListIndex = 1
End Sub
'|fffd||fffd|2019.01.28 mura add|fffd|y|fffd||3ce|c3060|fffd|z|fffd||10a|J|fffd|`|fffd|F|fffd|b|fffd|N|fffd||303||fffd||fffd|X|fffd|g|fffd||fffd|

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "SoapModule"
Option Explicit

'*********************************************************************
'Private|fffd||3d0||fffd|
'*********************************************************************
Private gSoapObjArray() As Object  'SOAP|fffd|N|fffd||fffd||fffd|C|fffd|A|fffd||fffd||fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd|Private|fffd|z|fffd||fffd|
Private gSoapWsArray() As String   'SOAP|fffd|N|fffd||fffd||fffd|C|fffd|A|fffd||fffd||fffd|g|fffd||fffd|WS|fffd||fffd|Private|fffd|z|fffd||fffd|
Private gTimeout As Long 'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd|Timeout|fffd||fffd||fffd||fffd|
Private gUseSoapCode As UseSoapCode '|fffd|g|fffd|p|fffd||fffd||fffd||fffd|SOAP|fffd||fffd|DLL|fffd||311|I|fffd||fffd|

'*********************************************************************
' |fffd||8414|
'*********************************************************************
'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||582||303||fffd||fffd|g|fffd||fffd||fffd|C|fffd||fffd|
Const conWEB_RETRY_MAX As Integer = 5

'DLL|fffd||317||4b4d2|l|fffd||18d||fffd||fffd||d0b9||fffd||fffd|
Private Enum ExSoapErrCode
    ERR_OK = 0      '
    ERR_WEBSVC      '
    ERR_MAX_OVER    '
End Enum

'|fffd|g|fffd|p|fffd||fffd||fffd||fffd|SOAP|fffd||fffd|dll
Private Enum UseSoapCode
    USE_EXSOAP = 0
    USE_MSSOAP
End Enum



'*********************************************************************
' |fffd||590||fffd|
'*********************************************************************

'Soap|fffd||58c|W|fffd||30f||fffd||fffd||fffd||fffd||fffd|
Public Sub PF_SoapModule_Init(pTimeout As Long)
    Dim wSoapObj As Object
    
    '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd|(|fffd|~|fffd||fffd||fffd|b)
    gTimeout = pTimeout

    '|fffd|g|fffd|p|fffd||fffd||fffd||fffd|Soap|fffd||311|I|fffd||fffd|
#If Win64 Then
    '64bit|fffd||202||fffd|A|fffd|g|fffd|p|fffd||fffd||fffd||fffd|Soap|fffd||fffd|ExSoap
    gUseSoapCode = USE_EXSOAP
#Else
    'ExSoap|fffd||fffd||fffd||fffd||fffd||fffd||fffd|ExSoap|fffd||fffd||fffd|g|fffd||fffd||fffd|B|fffd||202||fffd||fffd||fffd||fffd|MSSoap
    On Error Resume Next
    Set wSoapObj = CreateObject("ExSoap.SoapClient")
    If Err = 0 Then
        gUseSoapCode = USE_EXSOAP
    Else
        gUseSoapCode = USE_MSSOAP
    End If
    '|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||309||fffd||fffd|
    Set wSoapObj = Nothing
    On Error GoTo 0
#End If
End Sub

'MSSoap|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||101|AWeb|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s
Private Function PF_MSSoap_RequestWebSvc(pSoapClient As Object, pMethodName As String, pMethodParam As Variant, pRetVal As Variant) As ExSoapErrCode
    
'2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura UPD_S >>
'    'MSSOAP|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||101|AWeb|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
'    On Error Resume Next
'    'Call PF_MSSoap_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd|s(pSoapClient, pMethodName, pMethodParam, pRetVal)
'    If (PF_MSSoap_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd|s(pSoapClient, pMethodName, pMethodParam, pRetVal) = False) Then
'        PF_MSSoap_RequestWebSvc = ExSoapErrCode.ERR_WEBSVC
'        Exit Function
'    End If
    'MSSOAP|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||101|AWeb|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
    On Error Resume Next
    
    Dim wCnt As Integer
    Dim i As Integer
    Dim wParam() As Variant
        
    If IsEmpty(pMethodParam) Then
        '|fffd||fffd||fffd||fffd||fffd||202||fffd||fffd||30f||a347|
        pRetVal = CallByName(pSoapClient, pMethodName, VbMethod)
    Else
        '|fffd||fffd||fffd||fffd||fffd||310||fffd||fffd||fffd||fffd||64fe|
        wCnt = UBound(pMethodParam)
        
        '|fffd||fffd||fffd|[|fffd|J|fffd||fffd||fffd||3d0||fffd||fffd||243|R|fffd|s|fffd|[|fffd||fffd||fffd||fffd|B|fffd|R|fffd|s|fffd|[|fffd||fffd||fffd||202||fffd||fffd||a347||fffd|ACallByName|fffd||30c||102||44f|o|fffd||fffd||fffd||143|G|fffd||fffd||fffd|[|fffd||242||202||fffd|
        ReDim wParam(wCnt)
        For i = 0 To wCnt
            wParam(i) = pMethodParam(i)
        Next
        
        'CallByName|fffd||fffd||fffd|g|fffd||fffd||fffd||10e|w|fffd||80b3||fffd||a0bd|Method|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
        Select Case wCnt
            Case 0
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0))
            Case 1
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1))
            Case 2
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2))
            Case 3
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3))
            Case 4
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4))
            Case 5
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5))
            Case 6
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5), wParam(6))
            Case 7
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5), wParam(6), wParam(7))
            Case 8
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5), wParam(6), wParam(7), wParam(8))
            Case 9
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5), wParam(6), wParam(7), wParam(8), wParam(9))
            Case 10
                pRetVal = CallByName(pSoapClient, pMethodName, VbMethod, wParam(0), wParam(1), wParam(2), wParam(3), wParam(4), wParam(5), wParam(6), wParam(7), wParam(8), wParam(9), wParam(10))
            Case Else
                ReDim pRetVal(0)
                pRetVal(0) = "|fffd||102||44f|o|fffd||fffd||fffd||590||fffd||fffd||fffd||fffd||fffd|`|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|BSoapModule|fffd||303|t|fffd|@|fffd||fffd||fffd|N|fffd|V|fffd||fffd||fffd||fffd||fffd|uPF_MSSoap_RequestWebSvc|fffd|v|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                PF_MSSoap_RequestWebSvc = ExSoapErrCode.ERR_WEBSVC
                Exit Function
        End Select
    End If
    '2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura UPD_E <<
    
    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd|
    If Err.Number <> 0 Then
        ReDim pRetVal(0)
        pRetVal(0) = Err.Description
        PF_MSSoap_RequestWebSvc = ExSoapErrCode.ERR_WEBSVC
        Exit Function
    End If
    On Error GoTo 0
    
    PF_MSSoap_RequestWebSvc = ExSoapErrCode.ERR_OK
End Function

'MSSoap|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||101|A|fffd|f|fffd|[|fffd|^|fffd||64fe|
Private Function PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe|(pSoapClient As Object, pSql As String, pDat As Variant, Optional pMaxChk As Integer = 0) As ExSoapErrCode
    Dim arrtemp As Variant
    Dim wRow As Long
    Dim wCol As Long
    Dim i As Long
    Dim j As Long
    Dim k As Long
    
    'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s
    On Error Resume Next
    If gDbid = "" Then
        arrtemp = pSoapClient.Sql_Select(pSql)
    Else
        arrtemp = pSoapClient.Sql_Select(pSql, gDbid)
    End If
    
    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd|
    If Err.Number <> 0 Then
        ReDim pDat(0)
        pDat(0) = Err.Description
        PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe| = ExSoapErrCode.ERR_WEBSVC
        Exit Function
    End If
    
    '|fffd|z|fffd||42d82||fffd||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s|fffd||24e||fffd||fffd|s
    If IsArray(arrtemp) = False Then
        ReDim pDat(0)
        pDat(0) = "|fffd|f|fffd|[|fffd|^|fffd||30e||64fe||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
        PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe| = ExSoapErrCode.ERR_WEBSVC
        Exit Function
    Else
        '|fffd||64fe||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd|(0)|fffd||250||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||202||fffd||fffd||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[
        If IsNumeric(arrtemp(0)) = False Then
            ReDim pDat(0)
            pDat(0) = arrtemp(0)
            PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe| = ExSoapErrCode.ERR_WEBSVC
            Exit Function
        End If
    End If
    On Error GoTo 0
    
    wRow = arrtemp(0)
    
    '|fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If pMaxChk <> 0 Then
        If wRow > 65535 Then
            PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe| = ExSoapErrCode.ERR_MAX_OVER
            Exit Function
        End If
    End If
    
    wCol = arrtemp(1)
    ReDim pDat(-1 To arrtemp(0), arrtemp(1))
    k = 1
    For i = -1 To wRow
        For j = 1 To wCol
            k = k + 1
            pDat(i, j) = arrtemp(k)
        Next j
    Next i
    
    Erase arrtemp
    
    PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe| = ExSoapErrCode.ERR_OK
End Function

'MSSoap|fffd||30f||fffd||fffd||fffd||fffd||fffd|
Private Function PF_MSSoapInit(pWs As String) As Object
    Dim wSoapClient As Object

    'Object|fffd||310||fffd||fffd||fffd|
    On Error Resume Next
    Set wSoapClient = CreateObject("MSSOAP.SoapClient")
    If Err <> 0 Then
        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(MSSoap|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
        ThisWorkbook.Saved = True
        Application.DisplayAlerts = False
        Application.Quit
        ThisWorkbook.Close False
        Exit Function
    End If
    On Error GoTo 0
    
    '|fffd||189||fffd|n|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||28e||64fe||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd||248||2d7||fffd|
    wSoapClient.mssoapinit pWs

    '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|(|fffd|~|fffd||fffd||fffd|b|fffd|j
    wSoapClient.ConnectorProperty("Timeout") = gTimeout
    
    Set PF_MSSoapInit = wSoapClient
End Function

'ExSoap|fffd||30f||fffd||fffd||fffd||fffd||fffd|
Private Function PF_ExSoapInit(pWs As String) As Object
    Dim wSoapClient As Object
    Dim wErrMsg As String

    'Object|fffd||310||fffd||fffd||fffd|
    On Error Resume Next
    Set wSoapClient = CreateObject("ExSoap.SoapClient")
    If Err <> 0 Then
        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(ExSoap|fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
        ThisWorkbook.Saved = True
        Application.DisplayAlerts = False
        Application.Quit
        ThisWorkbook.Close False
        Exit Function
    End If
    On Error GoTo 0
    
    'SOAP init|fffd||30e||fffd||fffd|s
    If wSoapClient.PF_ExSoapInit(pWs, wErrMsg) <> ExSoapErrCode.ERR_OK Then
        MsgBox (wErrMsg)
        ThisWorkbook.Saved = True
        Application.DisplayAlerts = False
        Application.Quit
        ThisWorkbook.Close False
        Exit Function
    End If
    
    '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|(|fffd|~|fffd||fffd||fffd|b|fffd|j
    wSoapClient.Timeout = gTimeout
    
    Set PF_ExSoapInit = wSoapClient
End Function

'|fffd|w|fffd||80b5||fffd||fffd|WS|fffd||fffd|Soap|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd|
Private Sub PF_ClrSoapInstance(pWs As String)
    Dim i As Integer, j As Integer
    Dim wSize As Integer
    
    '|fffd|z|fffd||fffd||303|T|fffd|C|fffd|Y|fffd||fffd||fffd||64fe|
    wSize = 0
    On Error Resume Next
    wSize = UBound(gSoapObjArray)
    On Error GoTo 0
    
    For i = 0 To wSize - 1
        If pWs = gSoapWsArray(i) Then
            '|fffd||d3dc||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|f|fffd||20d|~|fffd||317|v|fffd|f|fffd||fffd|O|fffd||242||82||7c2||10f||33d1||fffd||fffd||fffd|R|fffd|s|fffd|[
            For j = i To wSize - 1
                gSoapWsArray(j) = gSoapWsArray(j + 1)
                Set gSoapObjArray(j) = gSoapObjArray(j + 1)
            Next j
            '|fffd||14f|I|fffd|s|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||fffd|
            ReDim Preserve gSoapWsArray(UBound(gSoapWsArray) - 1)
            ReDim Preserve gSoapObjArray(UBound(gSoapObjArray) - 1)
            Exit Sub
        End If
    Next i
End Sub

'|fffd|w|fffd||80b5||fffd||fffd|WS|fffd||fffd|Soap|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||502||fffd|
Private Function PF_GetSoapInstance(pWs As String) As Object
    Dim wSoapObj As Object
    Dim i As Integer
    
    '|fffd|z|fffd||fffd||303|T|fffd|C|fffd|Y|fffd||fffd||fffd||64fe|
    Dim wSize As Integer
    wSize = 0
    On Error Resume Next
    wSize = UBound(gSoapObjArray)
    On Error GoTo 0
    
    'Web|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||fffd||c42c||fffd||3c2||742||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    For i = 0 To wSize - 1
        If pWs = gSoapWsArray(i) Then
            '|fffd|w|fffd||80b5||fffd||fffd|WS|fffd||fffd|SoapObject|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||502||fffd||fffd||10f|I|fffd||fffd|
            Set PF_GetSoapInstance = gSoapObjArray(i)
            Exit Function
        End If
    Next i
    
    'SOAP|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||310||fffd||fffd||fffd||fffd||18f||fffd||fffd||fffd||fffd||fffd|
    If gUseSoapCode = USE_EXSOAP Then
        Set wSoapObj = PF_ExSoapInit(pWs)
    Else    'MSSoap Toolkit
        Set wSoapObj = PF_MSSoapInit(pWs)
    End If
        
    '|fffd||c42c||fffd||fffd||fffd||fffd|SOAP|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd|WS|fffd||fffd|z|fffd||fffd||252||1c9||fffd|
    ReDim Preserve gSoapObjArray(wSize + 1)
    ReDim Preserve gSoapWsArray(wSize + 1)
    Set gSoapObjArray(wSize) = wSoapObj
    gSoapWsArray(wSize) = pWs
    
    'SOAP|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd||fffd||502||fffd||fffd||10f|I|fffd||fffd|
    Set PF_GetSoapInstance = wSoapObj
End Function

'|fffd|w|fffd||80b5||fffd||fffd|WebMethod|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||fffd|
Public Function PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(ByVal pWs As String, ByVal pMethodName As String, ByRef pMethodParam As Variant, ByRef pRetVal As Variant) As Integer
    Dim wSoapClient As Object
    Dim wRet As Integer
    Dim i As Integer
    
    i = 1
    'WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||341|A|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50512||fffd||fffd||fffd||fffd||30e||fffd||fffd|s|fffd||14f|I|fffd||fffd|
    Do
        Set wSoapClient = PF_GetSoapInstance(pWs)
    
        'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s
        If gUseSoapCode = USE_EXSOAP Then   'ExSoap|fffd||fffd||fffd|g|fffd|p
            wRet = wSoapClient.PF_RequestWebSvc(pMethodName, pMethodParam, pRetVal)
        Else    'MSSoap|fffd||fffd||fffd|g|fffd|p
            wRet = PF_MSSoap_RequestWebSvc(wSoapClient, pMethodName, pMethodParam, pRetVal)
        End If
        
        If wRet <> ExSoapErrCode.ERR_OK Then
            '|fffd||64f||d52d||fffd||fffd||fffd||fffd||fffd||fffd|Soap|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|j|fffd||fffd|
            Call PF_ClrSoapInstance(pWs)
            
            '5|fffd||fffd|A|fffd||fffd||fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd|
            If i >= conWEB_RETRY_MAX Then
                MsgBox (pRetVal(0) & vbCrLf & _
                        "|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50510||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
                ThisWorkbook.Saved = True
                Application.DisplayAlerts = False
                Application.Quit
                ThisWorkbook.Close False
                Exit Function
            End If
        End If
        i = i + 1
    Loop While (wRet <> ExSoapErrCode.ERR_OK)
    
    PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd| = wRet
End Function

Public Function PF_|fffd|f|fffd|[|fffd|^|fffd||64fe|(pSql As String, pWs As String, pDat As Variant, Optional pMaxChk As Integer = 0, Optional pErrCloseFlg As Boolean = False) As Long
'*********************************************************************
'* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||24e||64fe||fffd||fffd|
'* pSql:|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pWs:|fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|t|fffd|q|fffd|k|fffd|i|fffd||fffd||fffd||341|j
'* pDat|fffd|F|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|i|fffd|z|fffd||fffd|j|fffd|i|fffd|o|fffd||341|j
'*  |fffd|z|fffd||fffd||30d|\|fffd||fffd||fffd|F|fffd|P|fffd||fffd||fffd||fffd||fffd||681|i|fffd|s|fffd|j|fffd||fffd|Ubound(pdat,1)|fffd||14d|s|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd|
'*               |fffd|||fffd|P|fffd|G|fffd||fffd||fffd|g|fffd||fffd|     |fffd|E|fffd|E|fffd|E|fffd||fffd||fffd||691||fffd||fffd||fffd||fffd|iString|fffd|ADecimal|fffd||fffd||fffd|j
'*                 |fffd|O|fffd|G|fffd||fffd||fffd|g|fffd||fffd|     |fffd|E|fffd|E|fffd|E|fffd||fffd||fffd||696||fffd|
'*                 |fffd|P|fffd|G|fffd||fffd||fffd|g|fffd||fffd||fffd||688||20f||fffd|E|fffd|E|fffd|E|fffd|f|fffd|[|fffd|^
'*             |fffd|Q|fffd||fffd||fffd||fffd||fffd||681|i|fffd||fffd|j|fffd||fffd|Ubound(pdat,2)|fffd||157||50502||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd|
'* Optional pMaxChk|fffd|F0:|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd||202||fffd| 0|fffd||20a|O:|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd||303|`|fffd|F|fffd|b|fffd|N|fffd||fffd||fffd|s|fffd||fffd|(65535|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||12d02||fffd||fffd||fffd||fffd||fffd|G|fffd||fffd||fffd|[)
'* Optional pErrCloseFlg|fffd|FFalse:|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|A|fffd|u|fffd|b|fffd|N|fffd||fffd||82||fffd||fffd||fffd| True:|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd|A-1|fffd||fffd||502||fffd|
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|F|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|i|fffd|o|fffd||341|j
'*********************************************************************

    Dim wSoapClient As Object
    Dim wRet As ExSoapErrCode
    Dim wDatArray As Variant
    Dim i As Integer
    
    i = 1
    'WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||310||fffd||fffd||fffd||fffd||fffd||fffd||341|A|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50512||fffd||fffd||fffd||fffd||30e||fffd||fffd|s|fffd||14f|I|fffd||fffd|
    Do
        Set wSoapClient = PF_GetSoapInstance(pWs)
        
        'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||64fe|
        If gUseSoapCode = USE_EXSOAP Then
            wRet = wSoapClient.PF_GetData(pSql, gDbid, wDatArray, pMaxChk)
        Else
            wRet = PF_MSSoap|fffd|f|fffd|[|fffd|^|fffd||64fe|(wSoapClient, pSql, wDatArray, pMaxChk)
        End If
        
        If wRet <> ExSoapErrCode.ERR_OK Then
            '|fffd||64f||d52d||fffd||fffd||fffd||fffd||fffd||fffd|Soap|fffd|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g|fffd|j|fffd||fffd|
            Call PF_ClrSoapInstance(pWs)
            
            Select Case wRet
                Case ExSoapErrCode.ERR_WEBSVC
                    '|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50512||fffd||fffd||fffd||fffd||64f||d52d||fffd||fffd||fffd||14f|I|fffd||fffd|
                    If i >= conWEB_RETRY_MAX Then
                        If pErrCloseFlg = False Then
                            MsgBox (wDatArray(0) & vbCrLf & _
                                    "|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50510||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
                            ThisWorkbook.Saved = True
                            Application.DisplayAlerts = False
                            Application.Quit
                            ThisWorkbook.Close False
                            Exit Function
                        Else
                            PF_|fffd|f|fffd|[|fffd|^|fffd||64fe| = -1
                            Exit Function
                        End If
                    End If
                Case ExSoapErrCode.ERR_MAX_OVER
                    '|fffd||fffd||fffd||fffd|OVER|fffd||202||fffd|I|fffd||fffd|
                    MsgBox ("|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||94|\|fffd||fffd||fffd||fffd||fffd||12d02||fffd||fffd||702||fffd||fffd||fffd||fffd|B")
                    ThisWorkbook.Saved = True
                    Application.DisplayAlerts = False
                    Application.Quit
                    ThisWorkbook.Close False
                    Exit Function
            End Select
        End If
        i = i + 1
    Loop While (wRet <> ExSoapErrCode.ERR_OK)
    
    pDat = wDatArray
   
    PF_|fffd|f|fffd|[|fffd|^|fffd||64fe| = UBound(pDat, 1)
End Function






Attribute VB_Name = "SoapUser"
Option Explicit

'2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura ADD_S |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||fffd||1c9||fffd| >>
'|fffd|g|fffd|p|fffd||fffd||fffd||fffd|Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30c||102||44f|o|fffd||fffd||fffd||242||82||fffd||fffd||10b|L|fffd|q|fffd||fffd||fffd||fffd|
'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30c||102||44f|o|fffd||fffd||fffd||fffd||1c9||fffd||fffd||fffd||fffd||fffd||a347||fffd||341|AFLS2|fffd||303|}|fffd|X|fffd|^|fffd||fffd||fffd||fffd||fffd|e|fffd|i|fffd||fffd||fffd|X.xls|fffd||303||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd|uSoapUser|fffd|v|fffd||fffd||fffd|Q|fffd||fffd|
'2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura ADD_E <<

'2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura DEL_S >>
''Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s
''|fffd|g|fffd|p|fffd||fffd||fffd||fffd|Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30c||102||44f|o|fffd||fffd||fffd||242||82||fffd||fffd||10b|L|fffd|q|fffd||fffd||fffd||fffd|
'Public Sub PF_MSSoap_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||fffd||fffd|s(pSoapClient As Object, pMethodName As String, pMethodParam As Variant, pRetVal As Variant)
'    'Web|fffd|T|fffd|[|fffd|r|fffd|X|fffd||30e||fffd||fffd|s
'    If gDbid = "" Then
'        Select Case pMethodName
'            Case "Sql_Exec"
'                pRetVal = pSoapClient.Sql_Exec(pMethodParam(0))
'            Case "PF_KagamiUp"
'                pRetVal = pSoapClient.PF_KagamiUp(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3), pMethodParam(4))
'            Case "Kessai_Hantei"
'                pRetVal = pSoapClient.Kessai_Hantei(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3))
'            Case "Kessai_kousin"
'                pRetVal = pSoapClient.Kessai_kousin(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3), pMethodParam(4), pMethodParam(5))
'        End Select
'    Else
'        Select Case pMethodName
'            Case "Sql_Exec"
'                pRetVal = pSoapClient.Sql_Exec(pMethodParam(0), pMethodParam(1))
'            Case "PF_KagamiUp"
'                pRetVal = pSoapClient.PF_KagamiUp(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3), pMethodParam(4), pMethodParam(5))
'            Case "Kessai_Hantei"
'                pRetVal = pSoapClient.Kessai_Hantei(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3), pMethodParam(4))
'            Case "Kessai_kousin"
'                pRetVal = pSoapClient.Kessai_kousin(pMethodParam(0), pMethodParam(1), pMethodParam(2), pMethodParam(3), pMethodParam(4), pMethodParam(5), pMethodParam(6))
'        End Select
'    End If
'End Sub
'2015.10.26|fffd|y|fffd||3ce|c1792|fffd|zmimura DEL_E <<

Public Function PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V(pSql As String, pWs As String) As String
'*********************************************************************
'* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|X|fffd|V|fffd||fffd|
'* pSql:|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pWs:|fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|t|fffd|q|fffd|k|fffd|i|fffd||fffd||fffd||341|j
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|F|fffd||fffd||fffd|s|fffd||fffd||fffd||283|R|fffd|[|fffd|h
'*********************************************************************
    Dim wMethodParam() As Variant
    Dim wRetVal As Variant
    
    If gDbid = "" Then
        ReDim wMethodParam(0)
        wMethodParam(0) = pSql
    Else
        ReDim wMethodParam(1)
        wMethodParam(0) = pSql
        wMethodParam(1) = gDbid
    End If
    Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(pWs, "Sql_Exec", wMethodParam, wRetVal)
    
    PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V = wRetVal
End Function

'--------------------------------------------------------------------------
'|fffd||4c3|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'pUpKbn|fffd|F"0"|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd| "1"|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|L|fffd||fffd|
'pkagamiFile|fffd|F|fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd| & |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'--------------------------------------------------------------------------
Public Function PF_|fffd||fffd|UL(pUpKbn As String, pkagamiFile As String) As String
    Dim wMethodParam() As Variant
    Dim wRetVal As Variant
    Dim wFSO As Object
    Dim wPos As Long
    Dim wPassName As String
    Dim wFileName As String
    
    '|fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd|
    wPos = InStrRev(pkagamiFile, "\")
    wPassName = Left(pkagamiFile, wPos)
    wFileName = Mid(pkagamiFile, wPos + 1) '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    
    'chiba_2015.03.03 ActiveSheet|fffd||fffd||fffd||fffd|INFO|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    '|fffd|d|fffd|q|fffd||fffd||fffd||fffd||fffd||fffd||fffd||74bc||fffd||68a|J|fffd||fffd||fffd||fffd||fffd||a347||fffd||311||389||fffd||fffd|i|fffd||4cb||fffd||fffd|L|fffd|p|fffd|X|fffd|N|fffd||fffd||fffd|A|fffd|j
    'INFO|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '*miya_2015.02.22
    ThisWorkbook.Sheets("INFO").Unprotect Password:="zzzz"
    ThisWorkbook.Sheets("INFO").Range("E1").Value = ""
    ThisWorkbook.Sheets("INFO").Protect Password:="zzzz"
    
    '|fffd||33d1||fffd||fffd||fffd||6d1||fffd|
    ThisWorkbook.Save
    'FileSystemObject|fffd||fffd||fffd||c42c| FileCopy|fffd||341|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|G|fffd||fffd||fffd|[|fffd||182||202||fffd||fffd|FSO|fffd|g|fffd|p
    Set wFSO = CreateObject("Scripting.FileSystemObject")
    
    'chiba_2015.03.03 |fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||c42c|
    If wFSO.FolderExists(wPassName) = False Then
        wFSO.CreateFolder wPassName
    End If
    
    'FileSystemObject|fffd||257|p|fffd||4c2||fffd||fffd||fffd||102||fffd||fffd||fffd|uCopyFile|fffd|v|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||115||fffd||fffd||fffd|
    '*miya_2015.02.23
    'wFSO.CopyFile ThisWorkbook.Path & "\" & ThisWorkbook.Name, pkagamiFile, True
    wFSO.CopyFile gThisFile, pkagamiFile, True
    '|fffd||fffd||fffd||fffd||fffd|I|fffd||243||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Set wFSO = Nothing
        
    wOutDbCon = PF_Websvc("D", ThisWorkbook.Sheets("INFO").Range("A1") & "", ThisWorkbook.Sheets("INFO").Range("A3") & "") '|fffd||691||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    gNumber = ThisWorkbook.Sheets("INFO").Range("B3") & ""     '|fffd||fffd||fffd||5d4||50d||fffd|
    gUpid = ThisWorkbook.Sheets("INFO").Range("A5") & ""       '|fffd|X|fffd|V|fffd|h|fffd|c
    gDbid = ThisWorkbook.Sheets("INFO").Range("A8") & ""       'DBID

    '|fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd|
    wPos = InStrRev(pkagamiFile, "\")
    wPassName = Left(pkagamiFile, wPos)
    wFileName = Mid(pkagamiFile, wPos + 1) '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
    
    If gDbid = "" Then
        ReDim wMethodParam(4)
        wMethodParam(0) = "1"
        wMethodParam(1) = gNumber
        wMethodParam(2) = gUpid
        wMethodParam(3) = wPassName
        wMethodParam(4) = wFileName
    Else
        ReDim wMethodParam(5)
        wMethodParam(0) = "1"
        wMethodParam(1) = gNumber
        wMethodParam(2) = gUpid
        wMethodParam(3) = wPassName
        wMethodParam(4) = wFileName
        wMethodParam(5) = gDbid
    End If
    Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(wOutDbCon, "PF_KagamiUp", wMethodParam, wRetVal)
    PF_|fffd||fffd|UL = wRetVal
    
    wMethodParam(0) = "0"
    Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(wOutDbCon, "PF_KagamiUp", wMethodParam, wRetVal)
    
    PF_|fffd||fffd|UL = wRetVal
        
    'chiba_2015.03.03 |fffd||1c9||fffd|
    'INFO|fffd||7c2||fffd|
    ThisWorkbook.Sheets("INFO").Unprotect Password:="zzzz"
    ThisWorkbook.Sheets("INFO").Range("E1").Value = pkagamiFile
    ThisWorkbook.Sheets("INFO").Protect Password:="zzzz"
    '|fffd||33d1||fffd||fffd||fffd||6d1||fffd|
    ThisWorkbook.Save
        
End Function

Public Function PF_|fffd||fffd||fffd||654||fffd||fffd||fffd|(pSkbn As String) As String
    Dim wMethodParam() As Variant
    Dim wRetVal As Variant
    
    If gDbid = "" Then
        ReDim wMethodParam(3)
        wMethodParam(0) = pSkbn
        wMethodParam(1) = gNumber
        wMethodParam(2) = gBusyo
        wMethodParam(3) = gTanto
    Else
        ReDim wMethodParam(4)
        wMethodParam(0) = pSkbn
        wMethodParam(1) = gNumber
        wMethodParam(2) = gBusyo
        wMethodParam(3) = gTanto
        wMethodParam(4) = gDbid
    End If
    Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(wOutDbCon, "Kessai_Hantei", wMethodParam, wRetVal)
    PF_|fffd||fffd||fffd||654||fffd||fffd||fffd| = wRetVal
End Function
    
'2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
'Public Function PF_|fffd||fffd||fffd||64d|X|fffd|V(pSkbn As String) As String
Public Function PF_|fffd||fffd||fffd||64d|X|fffd|V(pSkbn As String, Optional pSaikaisaki As String = "") As String
'2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
    Dim wMethodParam() As Variant
    Dim wRetVal As Variant
    
    If gDbid = "" Then
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
        'ReDim wMethodParam(5)
        ReDim wMethodParam(6)
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
        wMethodParam(0) = pSkbn
        wMethodParam(1) = gNumber
        wMethodParam(2) = gComntA
        wMethodParam(3) = gBusyo
        wMethodParam(4) = gTanto
        wMethodParam(5) = gUpid
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| ADD_S >>
        wMethodParam(6) = pSaikaisaki
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| ADD_E <<
    Else
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
        'ReDim wMethodParam(6)
        ReDim wMethodParam(7)
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
        wMethodParam(0) = pSkbn
        wMethodParam(1) = gNumber
        wMethodParam(2) = gComntA
        wMethodParam(3) = gBusyo
        wMethodParam(4) = gTanto
        wMethodParam(5) = gUpid
        wMethodParam(6) = gDbid
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| ADD_S >>
        wMethodParam(7) = pSaikaisaki
        '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| ADD_E <<
    End If
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_S >>
    'Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(wOutDbCon, "Kessai_kousin", wMethodParam, wRetVal)
    Call PF_WEB|fffd|T|fffd|[|fffd|r|fffd|X|fffd||102||44f|o|fffd||fffd|(wOutDbCon, "Kessai_kousin2", wMethodParam, wRetVal)
    '2019.01.28 |fffd|y|fffd||3ce|c3060|fffd|zkuwaima |fffd||fffd||fffd||7c2||fffd||fffd||30d||10a|J|fffd||fffd|w|fffd||fffd| UPD_E <<
    PF_|fffd||fffd||fffd||64d|X|fffd|V = wRetVal
End Function

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Dim wRtn As String
    Dim wkagamiFile As String
    
    'MsgBox "*BeforeClose"
    
    If gKessai = "|fffd|d|fffd|q|fffd||fffd||fffd||fffd|" Then
        '*|fffd||fffd|FLS2|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303|A|fffd||fffd||fffd||fffd||fffd|[|fffd|h
        Call PF_FontRemove(cFontpath & cFls2FontGNm)
        '*|fffd||fffd|FLS2|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303|A|fffd||fffd||fffd||fffd||fffd|[|fffd|h
    End If
    
End Sub

'chiba_2014.12.16 |fffd||4d5||6d1||fffd||fffd||389||fffd|
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
   '|fffd||3d0||fffd||fffd||310||933e|
    Dim wRtn As String
    Dim wkagamiFile As String
        
    'MsgBox "*BeforeSave"
    
    '*miya_2015.05.30
    If PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N(ThisWorkbook, "INFO") = False Then
        Exit Sub
    End If
    
    '|fffd||4cb||fffd||fffd|L|fffd|p|fffd|X
    wkagamiFile = ThisWorkbook.Sheets("INFO").Range("E1") & ""
    '|fffd||4cb||fffd||fffd|L|fffd||fffd||fffd||33d1||fffd||fffd||fffd||6d1||fffd|
    If wkagamiFile <> "" And SaveAsUI = False Then
        Application.EnableEvents = False
        wRtn = PF_|fffd||fffd|UL("1", wkagamiFile)
        If wRtn & "" <> "" Then
            MsgBox "|fffd||4cb||fffd||fffd|L|fffd|p|fffd|X|fffd||fffd||fffd||fffd|d|fffd|q|fffd||fffd||fffd||fffd||fffd||6d1||fffd||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
        End If
        Application.EnableEvents = True
        'chiba_2015.03.03 |fffd||3cd|X|fffd|L|fffd||fffd||30f||fffd||502||153||fffd||fffd|~|fffd||155||82||fffd||fffd||fffd||181|A|fffd||6d1||fffd||fffd|m|fffd|F|fffd||303||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|x|fffd||fffd||fffd||fffd||fffd||fffd|
        '|fffd||6d1||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
        'Cancel = True
    End If
    
End Sub

'2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
''chiba_2014.12.16 PF_|fffd||fffd|UL |fffd||c42c|
''--------------------------------------------------------------------------
''|fffd||4c3|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
''pUpKbn|fffd|F"0"|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd| "1"|fffd|A|fffd|b|fffd|v|fffd||fffd||fffd|[|fffd|h|fffd|L|fffd||fffd|
''pkagamiFile|fffd|F|fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd| & |fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
''--------------------------------------------------------------------------
'Function PF_|fffd||fffd|UL(pUpKbn As String, pkagamiFile As String) As String
'    Dim wFSO As Object
'    Dim oSOAPClient As Object
'    Dim wPos As Long
'    Dim wPassName As String
'    Dim wFileName As String
'
'    'MsgBox "*PF_|fffd||fffd|UL:|fffd||656a|=" & pUpKbn
'
'    '|fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd|
'    wPos = InStrRev(pkagamiFile, "\")
'    wPassName = Left(pkagamiFile, wPos)
'    wFileName = Mid(pkagamiFile, wPos + 1) '|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'
'    'chiba_2015.03.03 ActiveSheet|fffd||fffd||fffd||fffd|INFO|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'    '|fffd|d|fffd|q|fffd||fffd||fffd||fffd||fffd||fffd||fffd||74bc||fffd||68a|J|fffd||fffd||fffd||fffd||fffd||a347||fffd||311||389||fffd||fffd|i|fffd||4cb||fffd||fffd|L|fffd|p|fffd|X|fffd|N|fffd||fffd||fffd|A|fffd|j
'    'INFO|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    '*miya_2015.02.22
'    ThisWorkbook.Sheets("INFO").Unprotect Password:="zzzz"
'    ThisWorkbook.Sheets("INFO").Range("E1").Value = ""
'    ThisWorkbook.Sheets("INFO").Protect Password:="zzzz"
'    'ThisWorkbook.Sheets("INFO").Activate
'    'ActiveSheet.Unprotect Password:="zzzz"
'    'ActiveSheet.Range("E1").Value = ""
'    'ActiveSheet.Protect Password:="zzzz"
'
'    '|fffd||33d1||fffd||fffd||fffd||6d1||fffd|
'    ThisWorkbook.Save
'    'FileSystemObject|fffd||fffd||fffd||c42c| FileCopy|fffd||341|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||743|G|fffd||fffd||fffd|[|fffd||182||202||fffd||fffd|FSO|fffd|g|fffd|p
'    Set wFSO = CreateObject("Scripting.FileSystemObject")
'
'    'chiba_2015.03.03 |fffd||fffd||fffd|L|fffd|t|fffd|H|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||c42c|
'    If wFSO.FolderExists(wPassName) = False Then
'        wFSO.CreateFolder wPassName
'    End If
'
'    'FileSystemObject|fffd||257|p|fffd||4c2||fffd||fffd||fffd||102||fffd||fffd||fffd|uCopyFile|fffd|v|fffd||fffd||fffd|g|fffd|p|fffd||fffd||fffd||115||fffd||fffd||fffd|
'    '*miya_2015.02.23
'    'wFSO.CopyFile ThisWorkbook.Path & "\" & ThisWorkbook.Name, pkagamiFile, True
'    wFSO.CopyFile gThisFile, pkagamiFile, True
'
'    '|fffd||fffd||fffd||fffd||fffd|I|fffd||243||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    Set wFSO = Nothing
'
'    wOutDbCon = PF_Websvc("D", ThisWorkbook.Sheets("INFO").Range("A1") & "", ThisWorkbook.Sheets("INFO").Range("A3") & "") '|fffd||691||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    gNumber = ThisWorkbook.Sheets("INFO").Range("B3") & ""     '|fffd||fffd||fffd||5d4||50d||fffd|
'    gUpid = ThisWorkbook.Sheets("INFO").Range("A5") & ""       '|fffd|X|fffd|V|fffd|h|fffd|c
'    gDbid = ThisWorkbook.Sheets("INFO").Range("A8") & ""       'DBID
'
'    On Error Resume Next
'    Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'    If Err <> 0 Then
'        MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'        "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'        ThisWorkbook.Close False
'    End If
'    On Error GoTo 0
'
'    '|fffd||189||fffd|n|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||28e||64fe||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd||248||2d7||fffd|
'    oSOAPClient.mssoapinit wOutDbCon
'
'    If gDbid = "" Then
'        PF_|fffd||fffd|UL = oSOAPClient.PF_KagamiUp("1", gNumber, gUpid, wPassName, wFileName)
'        PF_|fffd||fffd|UL = oSOAPClient.PF_KagamiUp("0", gNumber, gUpid, wPassName, wFileName)
'    Else
'        PF_|fffd||fffd|UL = oSOAPClient.PF_KagamiUp("1", gNumber, gUpid, wPassName, wFileName, gDbid)
'        PF_|fffd||fffd|UL = oSOAPClient.PF_KagamiUp("0", gNumber, gUpid, wPassName, wFileName, gDbid)
'    End If
'
'    Set oSOAPClient = Nothing
'
'    'chiba_2015.03.03 |fffd||1c9||fffd|
'    'INFO|fffd||7c2||fffd|
'    ThisWorkbook.Sheets("INFO").Unprotect Password:="zzzz"
'    ThisWorkbook.Sheets("INFO").Range("E1").Value = pkagamiFile
'    ThisWorkbook.Sheets("INFO").Protect Password:="zzzz"
'    '|fffd||33d1||fffd||fffd||fffd||6d1||fffd|
'    ThisWorkbook.Save
'
'End Function
'2015.02.16 mimura del |fffd||fffd|









Attribute VB_Name = "|fffd|f|fffd|[|fffd|^|fffd|A|fffd|N|fffd|Z|fffd|X"
Option Explicit
    '2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
    'Public oSOAPClient As Object
    '2015.02.16 mimura del |fffd||fffd|
    Public dbook As Workbook            '|fffd|N|fffd||fffd||fffd|u|fffd|b|fffd|N
    Public wOutDbCon As String          '|fffd||691||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Public gIp As String                '|fffd|h|fffd|o|fffd|A|fffd|h|fffd||fffd||fffd|X
    Public gSyoriDt As String           '|fffd||fffd||fffd||fffd||fffd||fffd|
    Public gWhere As String             '|fffd||fffd||fffd||fffd|
    Public gOrder As String             '|fffd||fffd||fffd||44f||fffd|
    Public gNumber As String            '|fffd||fffd||fffd||5d4||50d||fffd|
    Public gUserID As String            '|fffd||fffd||fffd|[|fffd|U|fffd|[ID
    Public gTanto As String             '|fffd|S|fffd||fffd||fffd||483|R|fffd|[|fffd|h
    Public gTantoNm As String           '|fffd|S|fffd||fffd||fffd||496||fffd|
    Public gReadOnly As Integer         '|fffd||48f|W|fffd||fffd||fffd||fffd|
    Public gPass As String              '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|i|fffd|[|fffd|p
    Public gUrl As String               'URL|fffd|i|fffd|[|fffd|p
    '2015.03.24 mimura upd JustOffice|fffd||389||fffd| |fffd||fffd|
    'Public xlApp As Excel.Application
    Public xlApp As Object
    '2015.03.24 mimura upd |fffd||fffd|
    Public gDbid As String              '|fffd|c|fffd|a|fffd|h|fffd|c
    Public gKubun As String             '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Public gUpid As String              '|fffd|X|fffd|V|fffd|h|fffd|c
    Public gBusyo As String             '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
    Public gKessai As String            '|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h
    Public gKskbn As String             '|fffd||fffd||fffd||64b||656a|
    Public gComntI As String            '|fffd||fffd||fffd||343|R|fffd||fffd||fffd||fffd||fffd|g
    Public gComntA As String            '|fffd||fffd||fffd||34d||3c2||743|R|fffd||fffd||fffd||fffd||fffd|g
    Public Const cFlgSheet As String = "DATA5" '|fffd|t|fffd||fffd||fffd|O|fffd|p|fffd|V|fffd|[|fffd|g|fffd||fffd|
    Public Const cFlgRange As String = "AA1" 'SOAP CREATE|fffd||3c2||755|\|fffd||fffd|
    Public Const cFlgProc As String = "AA2"  '|fffd|d|fffd|q|fffd||fffd||fffd||64f||fffd||fffd||fffd||fffd||3d5|\|fffd||fffd|
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
    Public gGamenUrl As String          '|fffd||10f|o|fffd||fffd||fffd||fffd||fffd|URL|fffd|i|fffd|[|fffd|p
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima ADD_S >>
    Public gTenpuBunsyoUmu As String    '|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima ADD_E <<
    '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima ADD_S >>
    Public gDenshiKessaiMode As String  '|fffd|d|fffd|q|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h("|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h"|fffd|F|fffd||fffd||fffd|F|fffd|A|fffd||6d4|F|fffd||fffd||fffd|S|fffd||109||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|h":|fffd||fffd||fffd|F|fffd||302||749||fffd| "|fffd|d|fffd|q|fffd||fffd||fffd||655|s|fffd||fffd|":|fffd|d|fffd|q|fffd||fffd||fffd||64f||fffd||fffd||fffd||fffd||355|s|fffd||fffd|)
    '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima ADD_E <<

Public Function PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N(pBook As Workbook, pSnam As String) As Integer
    Dim wSheet As Worksheet
    
    PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N = False
    For Each wSheet In pBook.Sheets
        If wSheet.Name = pSnam Then
            PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N = True
            Exit For
        End If
    Next wSheet

End Function

Public Function PF_|fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||c42c|(pBook As Workbook, pSheet As String, pPos As Long, pTtl As Integer, pSql As String, pWs As String) As Long
'*********************************************************************
'* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||64fe||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||253|W|fffd|J|fffd||fffd|
'* pBook:|fffd|f|fffd|[|fffd|^|fffd|W|fffd|J|fffd|u|fffd|b|fffd|N|fffd|i|fffd||fffd||fffd||341|j
'* pSheet:|fffd|f|fffd|[|fffd|^|fffd|W|fffd|J|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pPos:|fffd|f|fffd|[|fffd|^|fffd|W|fffd|J|fffd||64ea||fffd|s|fffd||50d||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pTtl:|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd|v|fffd||6c1|i|fffd||fffd||fffd||341|j
'* pSql:|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pWs:|fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|t|fffd|q|fffd|k|fffd|i|fffd||fffd||fffd||341|j
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd|:|fffd|W|fffd|J|fffd|s|fffd||fffd||fffd|i|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd||34a||702||702||202||fffd||fffd|j
'*********************************************************************
    Dim arrtemp As Variant
    Dim arrtemp2() As Variant
    Dim i As Long
    Dim j As Long
    Dim k As Integer
    Dim wTline As Integer
    Dim wRow As Long
    Dim wCol As Long
    Dim SvSUpdatingFlg As Boolean
    Dim SvABook As Workbook '|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|u|fffd|b|fffd|N
    Dim SvASheet As Worksheet '|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|V|fffd|[|fffd|g
    Dim wSheet As Worksheet
    
    'l|fffd|F|fffd|J|fffd|n|fffd|s
    
    '|fffd||102||44f|o|fffd||fffd||fffd||fffd||fffd||fffd||fffd||311||794||fffd|
    SvSUpdatingFlg = Application.ScreenUpdating
    Set SvABook = ActiveWorkbook
    Set SvASheet = ActiveSheet
    
    Application.ScreenUpdating = False
    
    Call PF_|fffd|f|fffd|[|fffd|^|fffd||64fe|(pSql, pWs, arrtemp)
    
    wRow = UBound(arrtemp, 1)
    wCol = UBound(arrtemp, 2)
    
    '|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|u|fffd|b|fffd|N|fffd||752||fffd|
    pBook.Activate
    Set wSheet = pBook.Sheets(pSheet)
    '|fffd|V|fffd|[|fffd|g|fffd|\|fffd||fffd|
    wSheet.Visible = True
    '|fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|V|fffd|[|fffd|g|fffd||752||fffd|
    wSheet.Select
    
    If pTtl = True Then '*|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd|K|fffd|v
        wTline = 1
    Else
        wTline = 0
    End If
    '|fffd|f|fffd|[|fffd|^|fffd|^|fffd||64fe|
    If wRow > 0 Then
        For k = 1 To wCol
            Select Case arrtemp(-1, k)
                Case "String"
                    wSheet.Range(wSheet.Cells(pPos + wTline, k), wSheet.Cells(pPos + wTline + wRow - 1, k)).NumberFormatLocal = "@"
                Case "DateTime"
                    wSheet.Range(wSheet.Cells(pPos + wTline, k), wSheet.Cells(pPos + wTline + wRow - 1, k)).NumberFormatLocal = "yyyy/m/d"
                Case Else
                    wSheet.Range(wSheet.Cells(pPos + wTline, k), wSheet.Cells(pPos + wTline + wRow - 1, k)).NumberFormatLocal = "G/|fffd|W|fffd||fffd|"
            End Select
        Next k
    End If
    '|fffd|V|fffd|[|fffd|g|fffd||fffd|\|fffd||fffd|
    wSheet.Visible = False
    
    If pTtl = True Then
         '*|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd||fffd||fffd|K|fffd|v|fffd||20f||a347|
        ReDim arrtemp2(wRow, wCol - 1)
        For i = 0 To wRow
            For j = 0 To wCol - 1
                arrtemp2(i, j) = arrtemp(i, j + 1)
            Next j
        Next i
        '|fffd|f|fffd|[|fffd|^|fffd|\|fffd||fffd|t|fffd||fffd|
        wSheet.Range(wSheet.Cells(pPos, 1), wSheet.Cells(wRow + pPos, wCol)).Value = arrtemp2()
    Else
         '*|fffd|^|fffd|C|fffd|g|fffd||fffd||fffd|s|fffd||fffd||fffd|s|fffd|v|fffd||20f||a347|
        If wRow > 0 Then
            ReDim arrtemp2(wRow - 1, wCol - 1)
            For i = 0 To wRow - 1
                For j = 0 To wCol - 1
                    arrtemp2(i, j) = arrtemp(i + 1, j + 1)
                Next j
            Next i
            '|fffd|f|fffd|[|fffd|^|fffd|\|fffd||fffd|t|fffd||fffd|
            wSheet.Range(wSheet.Cells(pPos, 1), wSheet.Cells(wRow + pPos - 1, wCol)).Value = arrtemp2()
        End If
    End If
    
    Erase arrtemp2
    
    '|fffd||752||fffd||7c2||fffd|
    Application.ScreenUpdating = SvSUpdatingFlg
    '|fffd||794||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|u|fffd|b|fffd|N|fffd||7c2||fffd|
    SvABook.Activate
    '|fffd||794||fffd||fffd|A|fffd|N|fffd|e|fffd|B|fffd|u|fffd|V|fffd|[|fffd|g|fffd||7c2||fffd|
    SvASheet.Select
    PF_|fffd|f|fffd|[|fffd|^|fffd|V|fffd|[|fffd|g|fffd||c42c| = wRow
    
End Function

'2015.02.16 mimura del ExSoap|fffd||389||fffd| |fffd||fffd|
'Public Function PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V(pSql As String, pWs As String) As String
''*********************************************************************
''* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd|X|fffd|V|fffd||fffd|
''* pSql:|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
''* pWs:|fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|t|fffd|q|fffd|k|fffd|i|fffd||fffd||fffd||341|j
''* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|F|fffd||fffd||fffd|s|fffd||fffd||fffd||283|R|fffd|[|fffd|h
''*********************************************************************
'    Dim wCnt As Integer
'
'    On Error Resume Next
'
'    wCnt = 1
'
'PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V_Start:
'    On Error Resume Next
'    If ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = "" Then
'        Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'        If Err <> 0 Then
'            MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                    "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'            ThisWorkbook.Saved = True
'            Application.Quit
'            ThisWorkbook.Close False
'        End If
'        ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = "1"
'        On Error GoTo 0
'
'        '|fffd||189||fffd|n|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||28e||64fe||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd||248||2d7||fffd|
'        oSOAPClient.mssoapinit pWs
'
'        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|(|fffd|~|fffd||fffd||fffd|b|fffd|j
'        oSOAPClient.ConnectorProperty("Timeout") = 60000
'    End If
'
'    On Error Resume Next
'
'    If gDbid = "" Then
'        PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V = oSOAPClient.Sql_Exec(pSql)
'    Else
'        PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V = oSOAPClient.Sql_Exec(pSql, gDbid)
'    End If
'
'    If Err.Number <> 0 Then
'        If wCnt > 5 Then
'            MsgBox (CStr(Error) & vbCrLf & _
'                    "|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50510||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'            ThisWorkbook.Saved = True
'            Application.DisplayAlerts = False
'            Application.Quit
'            ThisWorkbook.Close False
'        End If
'        ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = ""
'        Set oSOAPClient = Nothing
'        wCnt = wCnt + 1
'        GoTo PF_|fffd|f|fffd|[|fffd|^|fffd|X|fffd|V_Start
'    End If
'
'End Function
'
'Public Function PF_|fffd|f|fffd|[|fffd|^|fffd||64fe|(pSql As String, pWs As String, pDat As Variant) As Long
''*********************************************************************
''* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||24e||64fe||fffd||fffd|
''* pSql:|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd|i|fffd||fffd||fffd||341|j
''* pWs:|fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd|t|fffd|q|fffd|k|fffd|i|fffd||fffd||fffd||341|j
''* pDat|fffd|F|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|i|fffd|z|fffd||fffd|j|fffd|i|fffd|o|fffd||341|j
''*  |fffd|z|fffd||fffd||30d|\|fffd||fffd||fffd|F|fffd|P|fffd||fffd||fffd||fffd||fffd||681|i|fffd|s|fffd|j|fffd||fffd|Ubound(pdat,1)|fffd||14d|s|fffd||fffd||fffd||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd|
''*               |fffd|||fffd|P|fffd|G|fffd||fffd||fffd|g|fffd||fffd|     |fffd|E|fffd|E|fffd|E|fffd||fffd||fffd||691||fffd||fffd||fffd||fffd|iString|fffd|ADecimal|fffd||fffd||fffd|j
''*                 |fffd|O|fffd|G|fffd||fffd||fffd|g|fffd||fffd|     |fffd|E|fffd|E|fffd|E|fffd||fffd||fffd||696||fffd|
''*                 |fffd|P|fffd|G|fffd||fffd||fffd|g|fffd||fffd||fffd||688||20f||fffd|E|fffd|E|fffd|E|fffd|f|fffd|[|fffd|^
''*             |fffd|Q|fffd||fffd||fffd||fffd||fffd||681|i|fffd||fffd|j|fffd||fffd|Ubound(pdat,2)|fffd||157||50502||fffd||fffd||64fe||fffd||142||fffd||fffd||fffd|
''* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|F|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|i|fffd|o|fffd||341|j
''*********************************************************************
'    Dim arrtemp As Variant
'    Dim i As Long
'    Dim j As Long
'    Dim k As Long
'    Dim wRow As Long
'    Dim wCol As Long
'    Dim wCnt As Integer
'
'    On Error Resume Next
'    wCnt = 1
'
'PF_|fffd|f|fffd|[|fffd|^|fffd||64fe|_Start:
'    On Error Resume Next
'    If ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = "" Then
'        Set oSOAPClient = CreateObject("MSSOAP.SoapClient")
'        If Err <> 0 Then
'            MsgBox ("|fffd||fffd||fffd|V|fffd|X|fffd|e|fffd||fffd||fffd||255|K|fffd|v|fffd||203|R|fffd||fffd||fffd|||fffd|[|fffd|l|fffd||fffd||fffd|g(|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|C|fffd|u|fffd||fffd||fffd||fffd||fffd|j|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|B" & vbCrLf & _
'                    "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'            ThisWorkbook.Saved = True
'            Application.DisplayAlerts = False
'            Application.Quit
'            ThisWorkbook.Close False
'        End If
'        ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = "1"
'        On Error GoTo 0
'
'        '|fffd||189||fffd|n|fffd|r|fffd|p|fffd|k|fffd||fffd||fffd||30e||fffd||fffd|s|fffd||fffd||fffd||28e||64fe||fffd||fffd||fffd|v|fffd||fffd||fffd||fffd||fffd|T|fffd|[|fffd|r|fffd|X|fffd||248||2d7||fffd|
'        oSOAPClient.mssoapinit pWs
'
'        '|fffd|^|fffd|C|fffd||fffd||fffd|A|fffd|E|fffd|g|fffd||389||fffd|(|fffd|~|fffd||fffd||fffd|b|fffd|j
'        oSOAPClient.ConnectorProperty("Timeout") = 60000
'    End If
'
'    On Error Resume Next
'
'    If gDbid = "" Then
'        arrtemp = oSOAPClient.Sql_Select(pSql)
'    Else
'        arrtemp = oSOAPClient.Sql_Select(pSql, gDbid)
'    End If
'
'    If Err.Number <> 0 Then
'        If wCnt > 5 Then
'            MsgBox (CStr(Error) & vbCrLf & _
'                    "|fffd||fffd||fffd|g|fffd||fffd||fffd|C|fffd||50510||fffd||fffd||fffd||fffd||fffd||fffd|z|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'            ThisWorkbook.Saved = True
'            Application.DisplayAlerts = False
'            Application.Quit
'            ThisWorkbook.Close False
'        End If
'        ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = ""
'        Set oSOAPClient = Nothing
'        wCnt = wCnt + 1
'        GoTo PF_|fffd|f|fffd|[|fffd|^|fffd||64fe|_Start
'    End If
'    On Error GoTo 0
'
'    '|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|
'    If IsArray(arrtemp) = False Or IsNumeric(arrtemp(0)) = False Then
'        Erase arrtemp
'        Set oSOAPClient = Nothing
'        MsgBox ("|fffd|f|fffd|[|fffd|^|fffd||64fe||fffd||fffd||fffd||243|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B" & vbCrLf & _
'                "|fffd|V|fffd|X|fffd|e|fffd||fffd||fffd|S|fffd||fffd||fffd||482||258|A|fffd||fffd||fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B")
'        ThisWorkbook.Saved = True
'        Application.DisplayAlerts = False
'        Application.Quit
'        ActiveWorkbook.Close False
'    End If
'
'    wRow = arrtemp(0)
'    wCol = arrtemp(1)
'    ReDim pDat(-1 To arrtemp(0), arrtemp(1))
'    k = 1
'    For i = -1 To wRow
'        For j = 1 To wCol
'            k = k + 1
'            pDat(i, j) = arrtemp(k)
'        Next j
'    Next i
'    PF_|fffd|f|fffd|[|fffd|^|fffd||64fe| = wRow
'
'    Erase arrtemp
'
'End Function
'2015.02.16 mimura del |fffd||fffd|

Public Function PF_|fffd|l|fffd||64fe|(pRow As Long, pNam As String, pDat As Variant) As Variant
'*********************************************************************
'* |fffd||fffd||fffd|r|fffd|p|fffd|k|fffd|T|fffd|[|fffd|o|fffd|[|fffd|f|fffd|[|fffd|^|fffd|e|fffd|[|fffd|u|fffd||fffd||fffd||fffd||8340||fffd||682||312|l|fffd||fffd||fffd||64fe||fffd||fffd|
'* pRow:|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||50d||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pNam:|fffd||fffd||fffd||696||fffd||fffd|i|fffd||fffd||fffd||341|j
'* pDat|fffd|F|fffd||fffd||fffd|R|fffd|[|fffd|h|fffd||fffd||fffd|G|fffd||fffd||fffd|A|fffd|i|fffd||fffd||fffd||341|j
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|F|fffd|w|fffd||8340||fffd||682||312|l|fffd|i*NOTHING*|fffd|F|fffd|w|fffd||80cc||fffd|R|fffd|[|fffd|h|fffd||50d||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||fffd||202||fffd||fffd||a347||fffd|A
'*                       *ERROR*|fffd|F|fffd||fffd||fffd||696||fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd|j
'*********************************************************************
    Dim arrtemp As Variant
    Dim i As Long
    Dim j As Long
    Dim k As Long
    Dim wRow As Long
    Dim wCol As Long
    Dim wFlg As Integer
    
    wRow = UBound(pDat, 1)
    wCol = UBound(pDat, 2)
    If pRow > wRow Then
        PF_|fffd|l|fffd||64fe| = "*NOTHING*"
        Exit Function
    End If
    
    wFlg = False
    For i = 1 To wCol
        If pNam = pDat(0, i) Then
            wFlg = True
            Exit For
        End If
    Next i
    
    If wFlg = False Then
        PF_|fffd|l|fffd||64fe| = "*ERROR*"
        Exit Function
    End If
    
    Select Case pDat(-1, i)
        Case "String"
           PF_|fffd|l|fffd||64fe| = CStr(pDat(pRow, i))
        Case "Decimal"
           PF_|fffd|l|fffd||64fe| = CDec(pDat(pRow, i))
        Case "Int32"
           PF_|fffd|l|fffd||64fe| = CLng(pDat(pRow, i))
        Case "DateTime"
           PF_|fffd|l|fffd||64fe| = CDate(pDat(pRow, i))
        Case "Boolean"
           PF_|fffd|l|fffd||64fe| = CBool(pDat(pRow, i))
    End Select
        
End Function

'|fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd||4ca4f|o|fffd||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
Public Function PF_|fffd||fffd||3ca||fffd|(lngColumn As Long) As String

    Dim strColumn As String
    
    strColumn = Cells(lngColumn).Address(, False)
    strColumn = Left(strColumn, InStr(strColumn, "$") - 1)
    
    PF_|fffd||fffd||3ca||fffd| = strColumn

End Function

Public Function PF_Encode(pKbn As String, pData As String, pKey As String) As String
    Dim wCnt1 As Integer
    Dim wCnt2 As Integer
    Dim wStr1 As String
    Dim wMoji As Variant
    Dim wNum1 As Integer
    Dim wKey1 As String
    Dim wKey2 As String
    Dim i     As Integer
    Dim j     As Integer
    
    '*|fffd|L|fffd|[|fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||303||fffd||fffd||fffd||fffd|O|fffd|X|fffd||20f||fffd||250||752||fffd|
    wKey1 = pKey
    i = Int(Len(pData) / Len(pKey))
    For j = 1 To i
        wKey1 = wKey1 & pKey
    Next j
    
    '*|fffd|L|fffd|[|fffd||10512|l|fffd||fffd|
    wKey2 = ""
    For wCnt1 = 1 To Len(wKey1)
        wKey2 = wKey2 & Format(Asc(Mid(wKey1, wCnt1, 1)), "000")
    Next wCnt1
        
    Select Case pKbn
        Case "E", "e" '*|fffd||cd||fffd||fffd||fffd|
            wStr1 = ""
            wCnt2 = -2
            For wCnt1 = 1 To Len(pData) Step 1
                wCnt2 = wCnt2 + 3
                wNum1 = Asc(Mid(pData, wCnt1, 1))
                wNum1 = wNum1 + Mid(wKey2, wCnt2, 3)
                wStr1 = wStr1 & Format(256 - wNum1, "000")
            Next wCnt1
            '*|fffd|T|fffd||fffd||fffd||fffd||fffd||209||fffd||fffd||30f||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd|t|fffd||fffd|
            If Len(pData) < 5 Then
                wStr1 = wStr1 & Format(Mid(wStr1, 1, 3) + 256)
                j = 5 - Len(pData)
                For i = 1 To j
                    wStr1 = wStr1 & Format(Mid(wStr1, 1, 3) + (i * 7), "000")
                Next i
            End If
            PF_Encode = wStr1
        Case "D", "d"  '*|fffd||fffd||fffd||fffd||fffd||fffd|
            wStr1 = ""
            For wCnt1 = 1 To Len(pData) Step 3
                If Mid(pData, wCnt1, 3) > 256 Then
                    Exit For
                End If
                wNum1 = 256 - (Mid(pData, wCnt1, 3))
                wNum1 = wNum1 - Mid(wKey2, wCnt1, 3)
                wStr1 = wStr1 & Chr(wNum1)
            Next wCnt1
            PF_Encode = wStr1
    End Select
    
End Function

Public Function PF_Websvc(pKbn As String, pData As String, pUid As String) As String
    Dim wYmd As String
    
    wYmd = Format(Date, "yyyymmdd")

    PF_Websvc = PF_Encode(pKbn, pData, Mid(wYmd, 6, 3) & ThisWorkbook.Sheets("INFO").Range("A2") & Mid(wYmd, 3, 3) & Mid(wYmd, 1, 3))

End Function

Public Function PF_AnsiStrConv(StrArg, flag)
    PF_AnsiStrConv = StrConv(StrArg, flag)
End Function

Public Function PF_AnsiLenB(ByVal StrArg As String) As Long
    PF_AnsiLenB = LenB(PF_AnsiStrConv(StrArg, vbFromUnicode))
End Function

Public Function Ver_Get() As String
'*********************************************************************
'* |fffd||fffd||fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||502||fffd||fffd||fffd|
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|FString|fffd|^
'********************************************************************
    Select Case Val(Application.Version)
        Case Is < 8
            Ver_Get = "97" '"95"
        Case Is < 9
            Ver_Get = "97"
        Case Is < 10
            Ver_Get = "2000"
        Case Is < 11
            Ver_Get = "2002"
        Case Is < 12
            Ver_Get = "2003"
        Case Is < 13
            Ver_Get = "" '"2007"
        Case Else
            Ver_Get = ""
    End Select
    
End Function
Attribute VB_Name = "|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd|h"
'*miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
Option Explicit
'2015.02.16 mimura upd 64bit|fffd||389||fffd| |fffd||fffd|
#If Win64 Then
Private Declare PtrSafe Function AddFontResourceEx Lib "gdi32" Alias "AddFontResourceExA" _
(ByVal sFileName As String, ByVal lFlags As Long, ByVal lReserved As Long) As Long

Private Declare PtrSafe Function RemoveFontResourceEx Lib "gdi32" Alias "RemoveFontResourceExA" _
(ByVal sFileName As String, ByVal lFlags As Long, ByVal lReserved As Long) As Long

Private Declare PtrSafe Function URLDownloadToFile Lib "URLMON" Alias "URLDownloadToFileA" _
(ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
#Else
Private Declare Function AddFontResourceEx Lib "gdi32" Alias "AddFontResourceExA" _
(ByVal sFileName As String, ByVal lFlags As Long, ByVal lReserved As Long) As Long

Private Declare Function RemoveFontResourceEx Lib "gdi32" Alias "RemoveFontResourceExA" _
(ByVal sFileName As String, ByVal lFlags As Long, ByVal lReserved As Long) As Long

Private Declare Function URLDownloadToFile Lib "URLMON" Alias "URLDownloadToFileA" _
(ByVal pCaller As Long, ByVal szURL As String, ByVal szFileName As String, ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
#End If
'2015.02.16 mimura upd |fffd||fffd|

Const FR_PRIVATE As Long = &H10

Dim gsFontPrev As String

Public Const cFontpath As String = "C:\4zApp\FLS2\" '*|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|i|fffd|[|fffd|p|fffd|X
Public Const cBarCdFontNm As String = "CODE39.TTF" '*|fffd|o|fffd|[|fffd|R|fffd|[|fffd|h|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
Public Const cFls2FontGNm As String = "FLS2FONG.TTF" '*|fffd|O|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|

'**********************************************************************
'  PF_FontAdd
'  |fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||308||a39e||fffd||fffd||fffd|[|fffd|h
'  |fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'    pFont(String)|fffd|F|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303|p|fffd|X|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'  |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h(Long)
'    1|fffd||20f||fffd| |fffd|F|fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|)|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||502||fffd|
'    0     |fffd|F|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s
'**********************************************************************
Public Function PF_FontAdd(pFont As String) As Long
    
    PF_FontAdd = AddFontResourceEx(pFont, FR_PRIVATE, 0)

End Function
'**********************************************************************
'  PF_FontAdd
'  |fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303|A|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'  |fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'    pFont(String)|fffd|F|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd|
'  |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h(Long)
'    1 |fffd|F|fffd||fffd||fffd||fffd|
'    0 |fffd|F|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|A|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s
'**********************************************************************
Public Function PF_FontRemove(pFont As String) As Long
    
    PF_FontRemove = RemoveFontResourceEx(pFont, FR_PRIVATE, 0)

End Function
'**********************************************************************
'  PF_UrlDownload
'  HTTP|fffd|w|fffd||fffd||142||303|t|fffd|@|fffd|C|fffd||fffd||fffd||303|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h
'  |fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'    pIfil (String)|fffd|F|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|i|fffd|t|fffd|q|fffd|k|fffd|w|fffd||fffd|j
'          http://.../abc.xls|fffd||302||60a4||fffd||24e|w|fffd||80b7||fffd||fffd|
'          |fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd||fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd||217||fffd|
'    pOfil (String)|fffd|F|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd||301|i|fffd|p|fffd|X|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd|j
'          C:\xxx\abc.xls|fffd||302||60a4||fffd||24e|w|fffd||80b7||fffd||fffd|
'  |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|R|fffd|[|fffd|h(Long)
'    0     |fffd|F|fffd||fffd||fffd||fffd|
'    0|fffd||20a|O |fffd|F|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|s
'**********************************************************************
Public Function PF_UrlDownload(pIfil As String, pOfil As String) As Long
    
    PF_UrlDownload = URLDownloadToFile(0, pIfil, pOfil, 0, 0)

End Function









Attribute VB_Name = "|fffd||4cc||95||fffd|"
Option Explicit
'***********************************************************************
'*|fffd|@PS_|fffd||95||295||48f|W|fffd|O|fffd||fffd||fffd||fffd||fffd|i|fffd||4c3|V|fffd|[|fffd|g|fffd||30c||95||295||48f|W|fffd||1c9||fffd||fffd|p|fffd|j
'*|fffd|@|fffd|@|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'*|fffd|@|fffd|@|fffd|@pSheet|fffd|F|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||241|h|fffd||4c1|h|fffd||fffd||fffd||702||783|V|fffd|[|fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'*|fffd|@|fffd|@|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd||fffd||fffd||fffd||348||350||752||fffd||312||fffd||fffd|O|fffd||24c||102||44f|o|fffd||fffd||fffd||fffd||fffd|
'***********************************************************************
Public Sub PS_|fffd||95||295||48f|W|fffd|O|fffd||fffd||fffd||fffd|(pSheet As Worksheet, pApcnt As Integer)
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim m As Integer
    Dim wGFlg As Integer
    
    '*miya_2018.07.28 |fffd|Y|fffd|t|fffd||4c2||fffd||fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd||fffd||255||3cd|X
    If pSheet.Name = "|fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd|" Or _
       pSheet.Name = "|fffd||fffd|_|fffd|d|fffd|q" Then
        Exit Sub
    End If
    
    If pSheet.Name = "|fffd||fffd|" And _
       gKskbn <> "|fffd|d|fffd|q" Then
'        '*|fffd||fffd||fffd||657||fffd||fffd||309|E|fffd||fffd||fffd||30b||d4497||fffd||fffd|P|fffd||82||24c||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'        For i = 13 To 1 Step -4
'            If pSheet.Cells(8, i) <> "" Then
'                Exit For
'            End If
'        Next i
'        If i < 1 Then
'            i = 1
'        End If
'        If i < 13 Then
'            Application.DisplayAlerts = False
'            pSheet.Range(pSheet.Cells(8, i), pSheet.Cells(12, 16)).MergeCells = True
'            Application.DisplayAlerts = True
'        End If
    End If
    
    '*|fffd|d|fffd|q|fffd||fffd||fffd||64e||fffd||fffd||30c||fffd||fffd||657||fffd||fffd||48f|W
    If pSheet.Name = "|fffd||fffd|" And _
       gKskbn = "|fffd|d|fffd|q" Then
        pSheet.Range("A14:X23").ClearContents
        pSheet.Range("A25:X29").ClearContents
        Application.DisplayAlerts = False
        pSheet.Range("A14:X23").MergeCells = True
        pSheet.Range("A25:X29").MergeCells = True
        Application.DisplayAlerts = True
        pSheet.Range("A14") = "|fffd||28e||fffd||fffd|Q|fffd||fffd|"
        pSheet.Range("A14").HorizontalAlignment = xlRight
        pSheet.Range("A14").VerticalAlignment = xlBottom
        pSheet.Range("A25") = "|fffd||28e||fffd||fffd|Q|fffd||fffd|"
        pSheet.Range("A25").HorizontalAlignment = xlRight
        pSheet.Range("A25").VerticalAlignment = xlBottom
    End If
    
    '*|fffd||fffd||fffd|c|fffd||4c2||fffd|2|fffd|s|fffd||688||20d|~|fffd||252|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||90a9||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
    If pSheet.Name = "|fffd||fffd|" And _
       gKskbn <> "|fffd|d|fffd|q" Then
        wGFlg = False
        k = 11
        For i = 1 To 10
            m = 1
            For j = 1 To 9
                If ThisWorkbook.Sheets("|fffd||fffd||fffd|c|fffd||fffd|").Cells(k, m) <> "" Then
                    wGFlg = True
                    Exit For
                End If
                m = m + 4
            Next j
            If wGFlg = True Then
                Exit For
            End If
            k = k + 5
        Next i
        If wGFlg = True Then
            pSheet.Range("A25:X29").ClearContents
            Application.DisplayAlerts = False
            pSheet.Range("A25:X29").MergeCells = True
            Application.DisplayAlerts = True
            pSheet.Range("A25") = "|fffd||28e||fffd||fffd|Q|fffd||fffd|"
            pSheet.Range("A25").HorizontalAlignment = xlRight
            pSheet.Range("A25").VerticalAlignment = xlBottom
        End If
    End If
    
    '*|fffd|P|fffd|y|fffd|[|fffd|W|fffd||682||196|{|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||702||142||30a||502||251|}|fffd||fffd||fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||310||fffd|
    pApcnt = 0

End Sub
'***********************************************************************
'*|fffd|@PS_|fffd||95||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd|i|fffd||4c3|V|fffd|[|fffd|g|fffd||303|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd|y|fffd||441|A|fffd||95||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd|p|fffd|j
'*|fffd|@|fffd|@|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^
'*|fffd|@|fffd|@|fffd|@pSheet|fffd|F|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||241|h|fffd||4c1|h|fffd||fffd||fffd||702||741|h|fffd||fffd||fffd||fffd||341|h|fffd||fffd||fffd||702||702||202||fffd||fffd|V|fffd|[|fffd|g|fffd||303|I|fffd|u|fffd|W|fffd|F|fffd|N|fffd|g
'*|fffd|@|fffd|@|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd||4d5||48f|W|fffd||30d||14c||fffd||24c||102||44f|o|fffd||fffd||fffd||fffd||fffd|
'***********************************************************************
Public Sub PS_|fffd||95||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd|(pSheet As Worksheet)
    '*|fffd||fffd|j|fffd||4c3|V|fffd|[|fffd|g|fffd||255||6cc||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||302||755||3cd|X|fffd||94|\|fffd||242||fffd||fffd||fffd|j
    'wSheet.Protect Password:="fls2admin", DrawingObjects:=True, Contents:=True, Scenarios:=True, _
                    AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
    
    '*|fffd||fffd|j|fffd||4c2||30a||590||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||48f|W|fffd||fffd||fffd||94|\|fffd||242||fffd||fffd||fffd|
    'Call PS_|fffd||590||fffd||fffd||fffd||fffd||fffd|(wSheet, "A1", "X107")
    
    '*|fffd||4c3|V|fffd|[|fffd|g|fffd||255||6cc||fffd||fffd||fffd|||fffd||fffd||fffd||fffd|
    pSheet.Protect Password:="fls2admin", DrawingObjects:=True, Contents:=True, Scenarios:=True
        
End Sub

'***********************************************************************
'*|fffd|@PS_|fffd||fffd||fffd||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd|i|fffd||4c3|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd|E|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||43c8||fffd||fffd||fffd|p|fffd|j
'*|fffd|@|fffd|@|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd|@|fffd||202||fffd|
'*|fffd|@|fffd|@|fffd||fffd||fffd||30a||590||fffd||fffd||341|A|fffd||4d5||48f|W|fffd||30d||14c||fffd||24c||102||44f|o|fffd||fffd||fffd||fffd||fffd|B
'*|fffd|@|fffd|@|fffd||fffd||fffd||30a||590||fffd||fffd||341|APS_|fffd||95||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||24c||102||44f|o|fffd||fffd||fffd||fffd||fffd|B
'***********************************************************************
Public Sub PS_|fffd||fffd||fffd||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd|()
    Dim wSheet As Worksheet
    Dim i As Integer
    Dim j As Integer
    
    '*|fffd||fffd|miya_2018.07.28 |fffd|Y|fffd|t|fffd||4c2||fffd||fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd||fffd||255||3cd|X
    If gKskbn = "|fffd|d|fffd|q" Then
        If PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N(ThisWorkbook, "|fffd||fffd|_|fffd|d|fffd|q") = True Then
            ThisWorkbook.Sheets("|fffd||fffd|").Visible = False
        End If
        ThisWorkbook.Sheets("|fffd||fffd||fffd|c|fffd||fffd|").Visible = False
        If PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N(ThisWorkbook, "|fffd||fffd||fffd||fffd||34a||fffd|") = True Then
            ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||34a||fffd|").Visible = False
        End If
    Else
        If ThisWorkbook.Sheets("|fffd||fffd|").Range("A25") <> "|fffd||28e||fffd||fffd|Q|fffd||fffd|" Then
            ThisWorkbook.Sheets("|fffd||fffd||fffd|c|fffd||fffd|").Visible = False
        End If
        If PF_|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||743|`|fffd|F|fffd|b|fffd|N(ThisWorkbook, "|fffd||fffd|_|fffd|d|fffd|q") = True Then
            ThisWorkbook.Sheets("|fffd||fffd|_|fffd|d|fffd|q").Visible = False
        End If
        ThisWorkbook.Sheets("|fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd|").Visible = False
    End If
    '*|fffd||fffd|miya_2018.07.28 |fffd|Y|fffd|t|fffd||4c2||fffd||fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd||fffd||255||3cd|X
    
End Sub

'*2019.8.4
Public Function PF_|fffd||fffd||fffd||fffd||fffd||50d||fffd|(pBKnd As String, Optional pCnt As Integer = 0) As String
'*---------------------------------------------------------------------------------------------*
'* PF_|fffd|N|fffd||115||fffd||fffd||fffd||fffd||50d||fffd|
'* |fffd|@|fffd|N|fffd||117|p|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe||fffd|E|fffd||48f|W|fffd||fffd||fffd||fffd|
'* |fffd|@pBknd:|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30e||fffd||796||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||30f||a347||fffd||341|A|fffd|w|fffd|A|fffd|x|fffd||14b||fffd||602||fffd||fffd||10e|w|fffd||80b7||fffd||fffd|
'* |fffd|@pCnt :|fffd||64fe||fffd||fffd||fffd||9576||fffd||fffd||fffd||50d||fffd||fffd||30d||151||5414||fffd|i|fffd|f|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||350||fffd||fffd||fffd||fffd||202||fffd||fffd|j
'*---------------------------------------------------------------------------------------------*
    Dim wBno As Variant
    Dim wBkg As Variant
    Dim wBsu As Variant
    Dim wHno As String
    Dim i As Integer
    
    wBno = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2(pBKnd, 13, "|fffd|A"), "|fffd|A")
    wBkg = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2(pBKnd, 10, "|fffd|A"), "|fffd|A")
    wBsu = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2(pBKnd, 11, "|fffd|A"), "|fffd|A")
    If UBound(wBno) = -1 Then
        PF_|fffd||fffd||fffd||fffd||fffd||50d||fffd| = ""
        Exit Function
    End If
    
    wHno = ""
    For i = 0 To UBound(wBno)
        If i > 0 Then
            wHno = wHno & vbCrLf
        End If
        '*|fffd||209||fffd||fffd||30f||fffd||fffd||fffd||fffd||16782||fffd||fffd||fffd||fffd||202||fffd||fffd||a347||fffd|A|fffd|w|fffd||fffd|@|fffd|@|fffd||fffd||fffd|x|fffd||fffd|t|fffd||fffd||fffd||fffd||fffd||fffd|
        '*|fffd|@|fffd|w|fffd||fffd||fffd|x|fffd||fffd||fffd||202||fffd|
        '*|fffd|@|fffd||50d||fffd||fffd||fffd||fffd||202||fffd|
        '*|fffd|@|fffd|\|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd||fffd|
        '*|fffd|@|fffd|\|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||50d||fffd||fffd||fffd||fffd|w|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd|x
        If InStr(1, wBno(i), "|fffd||fffd|") > 0 Or _
           wBsu(i) <> "" Or _
           wBno(i) = "" Or _
           wBno(i) = "|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd|" Then
            wHno = wHno & wBno(i)
        Else
            wHno = wHno & wBno(i) & "|fffd||fffd|@|fffd|@|fffd|@|fffd||fffd|"
        End If
        If pCnt > 0 And _
           pCnt <= i + 1 Then
            Exit For
        End If
    Next i
    PF_|fffd||fffd||fffd||fffd||fffd||50d||fffd| = wHno
    
End Function

Attribute VB_Name = "|fffd||4cb||fffd||fffd||fffd|"
Option Explicit
'*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
Public gDkCnt As Integer
Public gDkRange(100) As Range
'*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|

'*miya_2015.02.23
Public gThisFile As String

Public Function PF_|fffd||fffd||fffd||657||fffd|(pKkbn As String, pKkns As String, pKno As Integer) As String
    Dim wSsheet As Worksheet
    Dim wKcnt As Integer
    Dim i As Integer
    Dim wKno As Integer
    Dim wSno As Integer
    Dim wEno As Integer
    Dim wFlg As Integer
    
    Set wSsheet = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|\")
    
    wKno = 3
    Do Until wSsheet.Cells(wKno, 2) = ""
        If wSsheet.Cells(wKno, 2) = pKkbn Then
            Exit Do
        End If
        wKno = wKno + 1
    Loop
    If wSsheet.Cells(wKno, 2) = "" Then
        PF_|fffd||fffd||fffd||657||fffd| = "*Err"
        Exit Function
    End If
    
    wSno = 0
    wEno = 0
    i = 3
    Do Until wEno > 0 Or _
            (wSsheet.Cells(1, i) = "" And _
             wSsheet.Cells(2, i) = "")
        If wSno = 0 Then
            If wSsheet.Cells(1, i) = "|fffd||fffd||fffd||657||fffd|" Then
                wSno = i
            End If
        Else
           If wSsheet.Cells(1, i) <> "" Then
                wEno = i - 1
           End If
        End If
        i = i + 1
    Loop
    If wSno = 0 Then
        PF_|fffd||fffd||fffd||657||fffd| = "*Err"
        Exit Function
    End If
    
    wFlg = False
    wKcnt = 0
    For i = wSno To wEno
        wKcnt = wKcnt + 1
        If StrConv(Replace(Replace(Replace(Trim(wSsheet.Cells(wKno, i)), "/", ""), "@", ""), "|fffd||fffd|", ""), vbNarrow) = StrConv(Trim(pKkns), vbNarrow) Then
            wFlg = True
        End If
        If wKcnt = pKno Then
            If wFlg = True Then
                PF_|fffd||fffd||fffd||657||fffd| = Replace(Replace(Replace(Trim(wSsheet.Cells(wKno, i)), "/", Chr(10)), "@", " "), "|fffd||fffd|", "|fffd|@")
            Else
                PF_|fffd||fffd||fffd||657||fffd| = ""
            End If
        End If
    Next i
    If wFlg = False Then
        PF_|fffd||fffd||fffd||657||fffd| = "*Err"
    End If
    
End Function
Public Function PF_|fffd|I|fffd||fffd|(pKkbn As String, pHkbn As String, pItm As String, pOff As String, pOn As String) As String
    Dim wSsheet As Worksheet
    Dim i As Integer
    Dim wKno As Integer
    Dim wSno As Integer
    Dim wEno As Integer
    Dim wMflg As Integer
    Dim wSflg As Integer
    Dim wScnt As Integer
    Dim wstr(30) As String
    Dim wKstr    As String
    
    Set wSsheet = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|\")
    
    wKno = 3
    Do Until wSsheet.Cells(wKno, 2) = ""
        If wSsheet.Cells(wKno, 2) = pKkbn Then
            Exit Do
        End If
        wKno = wKno + 1
    Loop
    If wSsheet.Cells(wKno, 2) = "" Then
        PF_|fffd|I|fffd||fffd| = "*Err"
        Exit Function
    End If
    
    wSno = 0
    wEno = 0
    i = 3
    Do Until wEno > 0 Or _
            (wSsheet.Cells(1, i) = "" And _
             wSsheet.Cells(2, i) = "")
        If wSno = 0 Then
            If wSsheet.Cells(1, i) = pHkbn Then
                wSno = i
            End If
        Else
           If wSsheet.Cells(1, i) <> "" Then
                wEno = i - 1
           End If
        End If
        i = i + 1
    Loop
    If wSno = 0 Then
        PF_|fffd|I|fffd||fffd| = "*Err"
        Exit Function
    End If
    
    wMflg = False
    wScnt = 0
    Erase wstr
    For i = wSno To wEno
        If Trim(wSsheet.Cells(wKno, i)) <> "" Then
            wScnt = wScnt + 1
            If StrConv(Replace(Replace(Replace(Trim(wSsheet.Cells(wKno, i)), "/", ""), "@", ""), "|fffd||fffd|", ""), vbWide) <> "|fffd|i|fffd|C|fffd||4c1|j" Then
                If StrConv(Replace(Replace(Replace(Trim(wSsheet.Cells(wKno, i)), "/", ""), "@", ""), "|fffd||fffd|", ""), vbNarrow) = StrConv(pItm, vbNarrow) Then
                    wstr(wScnt) = pOn
                    wMflg = True
                Else
                    wstr(wScnt) = pOff
                End If
            End If
            wstr(wScnt) = wstr(wScnt) & wSsheet.Cells(wKno, i)
        End If
    Next i
    
    wSflg = False
    wKstr = ""
    For i = 1 To wScnt
        If StrConv(Replace(Replace(Replace(Trim(wstr(i)), "/", ""), "@", ""), "|fffd||fffd|", ""), vbWide) = "|fffd|i|fffd|C|fffd||4c1|j" Then
            If wMflg = False Then
                wstr(i) = pOn & Replace(wstr(i), "|fffd|i|fffd|C|fffd||4c1|j", pItm)
            Else
                wstr(i) = pOff & Replace(wstr(i), "|fffd|i|fffd|C|fffd||4c1|j", "")
            End If
            wSflg = True
        End If
        wKstr = wKstr & Trim(wstr(i))
    Next i
    
    If wMflg = False And _
       wSflg = False Then
        PF_|fffd|I|fffd||fffd| = "*Err"
    Else
        PF_|fffd|I|fffd||fffd| = Replace(Replace(Replace(wKstr, "/", Chr(10)), "@", " "), "|fffd||fffd|", "|fffd|@")
    End If
    
End Function
Public Function PF_|fffd|u|fffd||fffd||fffd||fffd|(pKkbn As String, pHkbn As String) As String
    Dim wSsheet As Worksheet
    Dim i As Integer
    Dim wKno As Integer
    Dim wSno As Integer
    
    Set wSsheet = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|\")
    
    wKno = 3
    Do Until wSsheet.Cells(wKno, 2) = ""
        If wSsheet.Cells(wKno, 2) = pKkbn Then
            Exit Do
        End If
        wKno = wKno + 1
    Loop
    If wSsheet.Cells(wKno, 2) = "" Then
        PF_|fffd|u|fffd||fffd||fffd||fffd| = "*Err"
        Exit Function
    End If
    
    wSno = 0
    i = 3
    Do Until wSno > 0 Or _
            (wSsheet.Cells(1, i) = "" And _
             wSsheet.Cells(2, i) = "")
        If wSsheet.Cells(1, i) = pHkbn Then
            wSno = i
        End If
        i = i + 1
    Loop
    If wSno = 0 Then
        PF_|fffd|u|fffd||fffd||fffd||fffd| = "*Err"
        Exit Function
    End If
    
    PF_|fffd|u|fffd||fffd||fffd||fffd| = Replace(Replace(Replace(Trim(wSsheet.Cells(wKno, wSno)), "/", Chr(10)), "@", " "), "|fffd||fffd|", "|fffd|@")

End Function
Public Function PF_|fffd||fffd||fffd|e|fffd||fffd|(pItm As String, pLine As Integer, Optional pAll As Integer = False) As String
    Dim wLtbl() As String
    Dim i As Integer
    
    PF_|fffd||fffd||fffd|e|fffd||fffd| = ""
    wLtbl = Split(pItm, Chr(10))
   
    If UBound(wLtbl) >= pLine - 1 Then
        If pAll = True Then
            For i = pLine To UBound(wLtbl) + 1
                PF_|fffd||fffd||fffd|e|fffd||fffd| = PF_|fffd||fffd||fffd|e|fffd||fffd| & wLtbl(i - 1) & Chr(10)
            Next i
        Else
            PF_|fffd||fffd||fffd|e|fffd||fffd| = wLtbl(pLine - 1)
        End If
    End If

End Function
Public Function PF_|fffd||fffd||fffd||657||fffd|2(pItm As String, pNo As Integer, Optional pAll As Integer = False) As String
    Dim wLtbl() As String
    Dim wItm As String
    Dim wstr As String
    Dim i As Integer
    
    PF_|fffd||fffd||fffd||657||fffd|2 = ""
    i = InStr(1, pItm, "|fffd|z") + 1
    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_S >>
    '|fffd|S|fffd|p|fffd|J|fffd||fffd||fffd|}|fffd||315||3ca||fffd||fffd|g|fffd||fffd||fffd||fffd|
    'wItm = Replace(Replace(Mid(pItm, i), ",", "|fffd|A"), "|fffd|", "|fffd|A")
    wItm = Replace(Replace(Replace(Mid(pItm, i), ",", "|fffd|A"), "|fffd|", "|fffd|A"), "|fffd|C", "|fffd|A")
    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_E <<
    wLtbl = Split(wItm, "|fffd|A")
   
    If UBound(wLtbl) >= pNo - 1 Then
        If pAll = True Then
            For i = pNo To UBound(wLtbl) + 1
                PF_|fffd||fffd||fffd||657||fffd|2 = PF_|fffd||fffd||fffd||657||fffd|2 & Replace(Trim(wLtbl(i - 1)), "/", Chr(10)) & Chr(10)
            Next i
        Else
            PF_|fffd||fffd||fffd||657||fffd|2 = Replace(Trim(wLtbl(pNo - 1)), "/", Chr(10))
        End If
    End If

End Function
Public Function PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|(pKnd As String, pLine As Integer, Optional pSpt As String = "") As Variant
    Dim wSheet As Worksheet
    Dim wKnd() As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim wHflg As Integer
    Dim wMflg As Integer
    Dim wIcnt As Integer
    Dim wItem(100) As Variant
    Dim wDat As Variant
    
    PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd| = ""
    Set wSheet = ThisWorkbook.Sheets("DATA2")

    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_S >>
    '|fffd|S|fffd|p|fffd|J|fffd||fffd||fffd|}|fffd||315||3ca||fffd||fffd|g|fffd||fffd||fffd||fffd|
    'wKnd = Split(Replace(Replace(pKnd, ",", "|fffd|A"), "|fffd|", "|fffd|A"), "|fffd|A")
    wKnd = Split(Replace(Replace(Replace(pKnd, ",", "|fffd|A"), "|fffd|", "|fffd|A"), "|fffd|C", "|fffd|A"), "|fffd|A")
    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_E <<
    wIcnt = 0
    i = 2
    Do Until wSheet.Cells(2, i) = ""
        wHflg = False
        For j = 0 To UBound(wKnd)
            If wSheet.Cells(2, i) = wKnd(j) Then
                wHflg = True
                Exit For
            End If
        Next j
        If wHflg = True Then
            wMflg = False
            For k = 1 To wIcnt
                If wItem(k) = wSheet.Cells(pLine, i) Then
                    wMflg = True
                    Exit For
                End If
            Next k
            If wMflg = False Then
                wIcnt = wIcnt + 1
                wItem(wIcnt) = wSheet.Cells(pLine, i)
            End If
        End If
        i = i + 1
    Loop
    
    If pSpt = "" Then
        If wIcnt > 0 Then
            PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd| = wItem(1)
        End If
    Else
        wDat = ""
        For i = 1 To wIcnt
            If i > 1 Then
                wDat = wDat & pSpt
            End If
            wDat = wDat & wItem(i)
        Next i
        PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd| = wDat
    End If

End Function
'2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
'pMode=""->|fffd||fffd||fffd|p, ="Z","z"->|fffd|S|fffd|p
'Public Function PF_|fffd||fffd||fffd|t|fffd||48f|W(pDate As Variant) As String
Public Function PF_|fffd||fffd||fffd|t|fffd||48f|W(pDate As Variant, Optional pMode As String = "") As String
    Dim wYY As String
    Dim wMM As String
    Dim wDD As String
    
    If pDate & "" = "" Or _
       pDate = 0 Then
        '2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
        'PF_|fffd||fffd||fffd|t|fffd||48f|W = Format(Date, "ggg") & "  |fffd|N  |fffd||fffd|  |fffd||fffd|"
        If pMode = "z" Or pMode = "Z" Then
            PF_|fffd||fffd||fffd|t|fffd||48f|W = StrConv(Format(Date, "ggg") & "  |fffd|N  |fffd||fffd|  |fffd||fffd|", vbWide)
            
        Else
            PF_|fffd||fffd||fffd|t|fffd||48f|W = Format(Date, "ggg") & "  |fffd|N  |fffd||fffd|  |fffd||fffd|"
        End If
        '|fffd||fffd|2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
    Else
        '*miya_2018.01.19|fffd|y|fffd||3ce|c|fffd|F2614|fffd|z|fffd|a|fffd||fffd||302|P|fffd|N|fffd||fffd||fffd||fffd||fffd|N|fffd||255||3ca||fffd|
        'wYY = Format(pDate, "ggge|fffd|N")
        '2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
        'If Format(pDate, "e") = "1" Then
        '    wYY = Format(pDate, "ggg|fffd||fffd||fffd|N")
        'Else
        '    wYY = Format(pDate, "ggge|fffd|N")
        'End If
        If Format(pDate, "e") = "1" Then
            If pMode = "z" Or pMode = "Z" Then
                wYY = Format(pDate, "ggg") & " |fffd||fffd||fffd|N"
            Else
                wYY = Format(pDate, "ggg|fffd||fffd||fffd|N")
            End If
        ElseIf Val(Format(pDate, "e")) < 10 Then    '|fffd|a|fffd||fffd|N|fffd||fffd|1|fffd||fffd||fffd||30f||a347||fffd|X|fffd|y|fffd|[|fffd|X|fffd||1c9||fffd|
            wYY = Format(pDate, "ggg") & " " & Format(pDate, "e|fffd|N")
        Else
            wYY = Format(pDate, "ggge|fffd|N")
        End If
        '|fffd||fffd|2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
        
        wMM = Format(pDate, "m|fffd||fffd|")
        If Len(wMM) < 3 Then
            wMM = " " & wMM
        End If
        wDD = Format(pDate, "d|fffd||fffd|")
        If Len(wDD) < 3 Then
            wDD = " " & wDD
        End If
        '2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
        'PF_|fffd||fffd||fffd|t|fffd||48f|W = wYY & wMM & wDD
        If pMode = "z" Or pMode = "Z" Then
            PF_|fffd||fffd||fffd|t|fffd||48f|W = StrConv(wYY & wMM & wDD, vbWide)
        Else
            PF_|fffd||fffd||fffd|t|fffd||48f|W = wYY & wMM & wDD
        End If
        '|fffd||fffd|2019.04.02 mura upd |fffd|y|fffd||3ce|c3173|fffd|F|fffd||3ca||fffd||fffd||fffd||fffd|[|fffd|h|fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||1c9||fffd||fffd|z
    End If

End Function

Public Function PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd|(pItm As String, pNo As Integer, Optional pAll As Integer = False) As String
    Dim i As Integer
    Dim j As Integer
    Dim wSheet As Worksheet
    
    PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = ""
    If gKskbn = "|fffd|d|fffd|q" Then
        Set wSheet = ThisWorkbook.Sheets("DATA4")
        i = 2
        j = 0
        Do Until wSheet.Cells(i, 1) = ""
            If wSheet.Cells(i, 5) = "" And _
               wSheet.Cells(i, 15) <> "|fffd||fffd||44c||fffd|" And _
               wSheet.Cells(i, 15) <> "|fffd||fffd|{" Then
                j = j + 1
                If j = pNo Then
                    Exit Do
                End If
            End If
            i = i + 1
        Loop
        If wSheet.Cells(i, 1) = "" Then
            Exit Function
        End If
        
        Select Case wSheet.Cells(i, 12)
            Case ""
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||fffd|F"
                '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
                'PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8) & vbLf & wSheet.Cells(i, 10) & vbLf & "(|fffd||fffd||fffd|F)"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8) & vbLf & wSheet.Cells(i, 10) & vbLf & Chr(&HF9F4)
                gDkCnt = gDkCnt + 1
                Set gDkRange(gDkCnt) = Application.Caller
                '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
            Case "|fffd||6d4|F"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||fffd||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8)
            Case "|fffd|S|fffd||fffd||fffd||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||44c||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = wSheet.Cells(i, 8)
        End Select
    Else
        PF_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd| = PF_|fffd||fffd||fffd||657||fffd|2(pItm, pNo, pAll)
    End If
    

End Function
Public Function PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd|(pItm As String, pNo As Integer, Optional pNo2 As Integer = 0, Optional pAll As Integer = False) As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim wNo As Integer
    Dim wSheet As Worksheet
    Dim wArr() As String
    
    PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = ""
    If gKskbn = "|fffd|d|fffd|q" Then
        Set wSheet = ThisWorkbook.Sheets("DATA4")
        If pNo2 = 0 Then
            i = 2
            j = 0
            Do Until wSheet.Cells(i, 1) = ""
                If wSheet.Cells(i, 5) = "|fffd||fffd||fffd|c" Then
                    j = j + 1
                    If j = pNo Then
                        Exit Do
                    End If
                End If
                i = i + 1
            Loop
        Else
            wNo = 0
            i = 2
            j = 0
            k = 0
            Do Until wSheet.Cells(i, 1) = ""
                If wSheet.Cells(i, 5) = "|fffd||fffd||fffd|c" Then
                    If wSheet.Cells(i, 3) <> wNo Then
                        j = j + 1
                        wNo = wSheet.Cells(i, 3)
                        k = 0
                    End If
                    k = k + 1
                    If j = pNo2 And _
                       k = pNo Then
                        Exit Do
                    End If
                End If
                i = i + 1
            Loop
        End If
        If wSheet.Cells(i, 1) = "" Then
            Exit Function
        End If
        
        Select Case wSheet.Cells(i, 12)
            Case ""
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||fffd|F"
                '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
                'PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 7) & " " & wSheet.Cells(i, 8) & vbLf & wSheet.Cells(i, 10) & vbLf & "(|fffd||fffd||fffd|F)"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 7) & " " & wSheet.Cells(i, 8) & vbLf & wSheet.Cells(i, 10) & vbLf & Chr(&HF9F4)
                gDkCnt = gDkCnt + 1
                Set gDkRange(gDkCnt) = Application.Caller
                '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
            Case "|fffd||6d4|F"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||fffd||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 8)
            Case "|fffd|S|fffd||fffd||fffd||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 8)
            Case "|fffd||fffd||44c||fffd|"
                PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = wSheet.Cells(i, 8)
        End Select
    Else
        'wArr = Split(pItm, "/")
        'If pNo2 > UBound(wArr) + 1 Then
        '    PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = ""
        'Else
        '    PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = PF_|fffd||fffd||fffd||657||fffd|2(wArr(pNo2 - 1), pNo, pAll)
        'End If
         PF_|fffd|d|fffd|q|fffd||fffd||fffd|c|fffd||fffd| = PF_|fffd||fffd||fffd||657||fffd|2(pItm, pNo, pAll)
    End If

End Function
Public Function PF_|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd||50d||fffd|(pNo As String, pDate As String) As String
    Dim wNo As Long
    Dim wDate As Long
    
    wNo = CLng(Right(pNo, 4))
    wDate = CLng(Format(CVDate(pDate), "mmdd")) + 5339
    PF_|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd||50d||fffd| = Right(CStr(wNo + wDate), 4)

End Function

Public Function PF_VerGet() As String
'*********************************************************************
'* |fffd||fffd||fffd|G|fffd|N|fffd|Z|fffd||fffd||fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||502||fffd||fffd||fffd|
'* |fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd|FString|fffd|^
'********************************************************************
    Select Case Val(Application.Version)
        Case Is < 8
            PF_VerGet = "97" '"95"
        Case Is < 9
            PF_VerGet = "97"
        Case Is < 10
            PF_VerGet = "2000"
        Case Is < 11
            PF_VerGet = "2002"
        Case Is < 12
            PF_VerGet = "2003"
        Case Is < 13
            PF_VerGet = "2007"
        Case Is < 15
            PF_VerGet = "2010"
        Case Is < 16
            PF_VerGet = "2013"
        Case Else
            PF_VerGet = "9999"
    End Select
    
End Function

Public Function PF_|fffd||fffd||fffd|c|fffd||fffd|(pItm As String, pNo1 As Integer, pNo2 As Integer, Optional pAll As Integer = False) As String
    Dim wRtbl() As String
    Dim wLtbl() As String
    Dim wItm As String
    Dim wstr As String
    Dim i As Integer
    
    PF_|fffd||fffd||fffd|c|fffd||fffd| = ""
    '*miya_2015.07.12
    'i = InStr(1, pItm, "|fffd|z") + 1
    'wItm = Replace(Replace(Mid(pItm, i), ",", "|fffd|A"), "|fffd|", "|fffd|A")
    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_S >>
    '|fffd|S|fffd|p|fffd|J|fffd||fffd||fffd|}|fffd||315||3ca||fffd||fffd|g|fffd||fffd||fffd||fffd|
    'wItm = Replace(Replace(pItm, ",", "|fffd|A"), "|fffd|", "|fffd|A")
    wItm = Replace(Replace(Replace(pItm, ",", "|fffd|A"), "|fffd|", "|fffd|A"), "|fffd|C", "|fffd|A")
    '2017.09.06 |fffd|y|fffd||3ce|c2480|fffd|z kuwajima UPD_E <<
    
    wRtbl = Split(wItm, "/")
    If UBound(wRtbl) >= pNo1 - 1 Then
        
        '*miya_2015.07.12
        'wLtbl = Split(wRtbl(pNo1 - 1), "|fffd|A")
        i = InStr(1, wRtbl(pNo1 - 1), "|fffd|z") + 1
        wLtbl = Split(Mid(wRtbl(pNo1 - 1), i), "|fffd|A")
        
        If UBound(wLtbl) >= pNo2 - 1 Then
            If pAll = True Then
                For i = pNo2 To UBound(wLtbl) + 1
                    PF_|fffd||fffd||fffd|c|fffd||fffd| = PF_|fffd||fffd||fffd|c|fffd||fffd| & Replace(Trim(wLtbl(i - 1)), "/", Chr(10)) & Chr(10)
                Next i
            Else
                PF_|fffd||fffd||fffd|c|fffd||fffd| = Replace(Trim(wLtbl(pNo2 - 1)), "/", Chr(10))
            End If
        End If
    End If

End Function
Public Function PF_|fffd||fffd||fffd||293||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o(pItm As String, pStr As String) As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    
    PF_|fffd||fffd||fffd||293||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o = ""
    
    i = InStr(1, pItm, pStr)
    If i = 0 Then
        Exit Function
    End If
    
    For i = i + Len(pStr) To Len(pItm)
        '*miya_2016.08.17 |fffd|S|fffd|p|fffd||fffd||fffd||282||251||389||fffd|
        If Mid(pItm, i, 1) = "(" Or Mid(pItm, i, 1) = "|fffd|i" Then
            Exit For
        End If
    Next i
    If i > Len(pItm) Then
        Exit Function
    End If
    
    For j = i + 1 To Len(pItm)
        '*miya_2016.08.17 |fffd|S|fffd|p|fffd||fffd||fffd||282||251||389||fffd|
        If Mid(pItm, j, 1) = ")" Or Mid(pItm, j, 1) = "|fffd|j" Then
            Exit For
        End If
    Next j

    PF_|fffd||fffd||fffd||293||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o = Mid(pItm, i + 1, j - i - 1)

End Function
'*miya_2015.05.08
Public Function PF_|fffd||fffd||fffd||7d5||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(pDat As String, Optional pDlm As String = ":") As String
    Dim i As Integer
    
    i = InStr(1, pDat, pDlm, vbTextCompare)
    
    If i = 0 Then
        PF_|fffd||fffd||fffd||7d5||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = pDat
    Else
        PF_|fffd||fffd||fffd||7d5||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Mid(pDat, i + 1)
    End If

End Function

'*miya_2015.05.08
Public Function PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|o(pDat As String, pNo As Integer, Optional pDlm As String = ",") As String
    Dim wRnm() As String
    
    wRnm = Split(pDat, pDlm)
    If UBound(wRnm) < pNo - 1 Then
        PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|o = ""
    Else
        PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd|o = wRnm(pNo - 1)
    End If

End Function

'*miya_2015.05.30
Public Sub PS_|fffd||390||fffd|(pRange As Range, pMode As Integer)
    If pMode = True Then
        pRange.Borders(xlDiagonalUp).LineStyle = xlContinuous
        pRange.Borders(xlDiagonalUp).ColorIndex = xlAutomatic
        'pRange.Borders(xlDiagonalUp).TintAndShade = 0
        pRange.Borders(xlDiagonalUp).Weight = xlThin
    Else
        pRange.Borders(xlDiagonalUp).LineStyle = xlNone
    End If

End Sub

'*miya_2015.07.16
'***********************************************************************
'* PS_|fffd|r|fffd||fffd||fffd|@pType2(|fffd|r|fffd||fffd||fffd||fffd||fffd|)|fffd||30e|w|fffd||fffd||fffd||fffd|@
'*|fffd|@|fffd||fffd||fffd||fffd||fffd|E|fffd|E|fffd|ExlEdgeLeft
'*|fffd|@|fffd|E|fffd||fffd||fffd|E|fffd|E|fffd|ExlEdgeRight
'*|fffd|@|fffd||fffd||fffd||fffd|E|fffd|E|fffd|ExlEdgeTop
'*|fffd|@|fffd||fffd||fffd||fffd||fffd|E|fffd|E|fffd|ExlEdgeBottom
'*|fffd|@|fffd||390||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd|j|fffd|E|fffd|E|fffd|ExlDiagonalUp
'*|fffd|@|fffd||390||fffd||fffd|i|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|E|fffd||fffd||fffd|j|fffd|E|fffd|E|fffd|ExlDiagonalDown
'***********************************************************************
Public Sub PS_|fffd|r|fffd||fffd|(pRange As Range, pType As Integer, pMode As Integer)
    If pMode = True Then
        pRange.Borders(pType).LineStyle = xlContinuous
        pRange.Borders(pType).ColorIndex = xlAutomatic
        pRange.Borders(pType).Weight = xlThin
    Else
        pRange.Borders(pType).LineStyle = xlNone
    End If

End Sub

'*miya_2015.09.05
Public Function PF_|fffd|s|fffd||fffd|o(pDat As String, pNo As Integer, Optional pDlm As String = vbLf, Optional pCcnt As Integer = 0) As String
    Dim wDat As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    
    j = 1
    wDat = ""
    For i = 1 To Len(pDat)
        If Mid(pDat, i, 1) = pDlm Then
            j = j + 1
            k = 0
        Else
            k = k + 1
            If j = pNo Then
                wDat = wDat & Mid(pDat, i, 1)
            End If
            If pCcnt > 0 And _
               k = pCcnt Then
                j = j + 1
                k = 0
            End If
        End If
    Next i
    
    PF_|fffd|s|fffd||fffd|o = wDat
End Function
'*miya_2015.09.16
Public Sub PS_|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|(ByRef pKey As Variant, ByRef pDat As Variant, Optional pSort As String = "A", Optional pStart As Integer = 0)
    Dim wKey As Variant
    Dim wDat As Variant
    Dim i As Integer
    Dim j As Integer
    
    If UBound(pKey) <= pStart Then
        Exit Sub
    End If
    
    For i = pStart To UBound(pKey)
        For j = i + 1 To UBound(pKey)
            If (pSort = "A" And _
                pKey(i) > pKey(j)) Or _
               (pSort = "D" And _
                pKey(i) < pKey(j)) Then
                wKey = pKey(i)
                pKey(i) = pKey(j)
                pKey(j) = wKey
                wDat = pDat(i)
                pDat(i) = pDat(j)
                pDat(j) = wDat
            End If
        Next j
    Next i

End Sub
'*miya_2015.09.16
Public Function PF_|fffd|\|fffd|[|fffd|g|fffd|l|fffd||64fe|(pKbn As String, pKline As Integer, pDline As Integer, pNo As Integer, Optional pSort As String = "A") As Variant
    Dim wKey As Variant
    Dim wDat As Variant
    
    wKey = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|(pKbn, pKline, "|fffd|A"), "|fffd|A")
    wDat = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|(pKbn, pDline, "|fffd|A"), "|fffd|A")
    Call PS_|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|(wKey, wDat, StrConv(pSort, vbUpperCase))
    If pNo - 1 > UBound(wKey) Or _
       pNo - 1 < LBound(wKey) Then
        PF_|fffd|\|fffd|[|fffd|g|fffd|l|fffd||64fe| = ""
    Else
        PF_|fffd|\|fffd|[|fffd|g|fffd|l|fffd||64fe| = wDat(pNo - 1)
    End If
    
End Function

'*miya_2015.09.19
Public Function PF_|fffd||fffd||fffd||7d2|l|fffd||64fe|(pKbn As String, pKline As Integer, pDline As Integer) As Variant
    Dim wKey As Variant
    Dim wDat As Variant
    Dim i As Integer
    
    PF_|fffd||fffd||fffd||7d2|l|fffd||64fe| = ""
    wKey = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|(pKbn, pKline, "|fffd|A"), "|fffd|A")
    wDat = Split(PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|(pKbn, pDline, "|fffd|A"), "|fffd|A")
    Call PS_|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|(wKey, wDat, "D")
    For i = 0 To UBound(wKey)
        If ThisWorkbook.Sheets("DATA2").Range("B1") > wKey(i) Then
            PF_|fffd||fffd||fffd||7d2|l|fffd||64fe| = wDat(i)
            Exit For
        End If
    Next i
    
End Function

'*miya_2015.10.09
Public Function PF_|fffd|f|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||1c9||fffd|(pDat As String, Optional pCcnt As Integer = 0, Optional pDlm As String = "/", Optional pLcnt As Integer = 1) As String
'*---------------------------------------------------------------------------------------------*
'* PF_|fffd|f|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||1c9||fffd|
'* |fffd|@|fffd|w|fffd||80b3||fffd||a0bd||fffd|f|fffd||fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||18c||fffd||fffd||fffd||fffd||142||fffd||fffd||fffd|`|fffd||fffd||fffd||255||3ca||fffd||fffd||fffd||fffd||fffd|
'* |fffd|@|fffd|@pDat |fffd|c|fffd|f|fffd||fffd||fffd||fffd||fffd||313||fffd||fffd|e
'* |fffd|@|fffd|ApCcnt|fffd|c|fffd|f|fffd||fffd||fffd||fffd||fffd||fffd|1|fffd|s|fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||fffd||12d02||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd|j
'* |fffd|@         |fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||342||fffd||fffd||fffd||702||fffd||fffd||fffd|
'* |fffd|@|fffd|BpDlm |fffd|c|fffd|f|fffd||fffd||fffd||fffd||fffd||309||fffd||fffd|s|fffd||fffd||fffd||fffd|
'* |fffd|@         |fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|u/|fffd|v|fffd||182||202||fffd||702||fffd||fffd|B
'* |fffd|@|fffd|CpLcnt|fffd|c|fffd|f|fffd||fffd||fffd||fffd||fffd||196|{|fffd||fffd||fffd||30a||502||30b||d448d|s|fffd||fffd|
'* |fffd|@         |fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd|u1|fffd|v|fffd||182||202||fffd||702||fffd||fffd|B
'* |fffd|@|fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||1044|
'* |fffd|@|fffd|@=PF_|fffd||fffd||fffd|e|fffd||fffd|(PF_|fffd|f|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||1c9||fffd|(DATA2!$B$50,48) & DATA2!B$14,AM39)
'* |fffd|@|fffd|@=PF_|fffd||fffd||fffd|e|fffd||fffd|(PF_|fffd|f|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||1c9||fffd|(DATA2!$B$50,48,,0) & DATA2!B$14,AM39)
'*---------------------------------------------------------------------------------------------*
    Dim wDat As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim wFlg As Integer
    
    wDat = ""
    wFlg = False
    For i = 1 To Len(pDat)
        If Mid(pDat, i, 1) = pDlm Then
            If wFlg = False Then
                wDat = wDat & vbLf
            End If
            k = 0
            wFlg = False
        Else
            wFlg = False
            wDat = wDat & Mid(pDat, i, 1)
            k = k + 1
            If pCcnt > 0 And _
               k = pCcnt Then
                wDat = wDat & vbLf
                k = 0
                wFlg = True
            End If
        End If
    Next i
    
    '*miya_2015.12.30
    If wDat <> "" Then
        '*miya_2018.08.22 |fffd|f|fffd||fffd||fffd||fffd||fffd||196|{|fffd||fffd||fffd||30a||502||30b||d448d|s|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||142||fffd||fffd||fffd||60a4||fffd||255||3cd|X
        'wDat = wDat & vbLf & vbLf
        wDat = wDat & vbLf & String(pLcnt, vbLf)
    End If
    
    PF_|fffd|f|fffd||fffd||fffd||fffd||fffd|{|fffd||fffd||fffd||1c9||fffd| = wDat
End Function
'*miya_2015.12.23
'**********************************************************************
'* PS_|fffd||fffd||fffd||fffd||348||350||752||fffd|
'* |fffd||38f||6c3|V|fffd|[|fffd|g|fffd|@|fffd|@|fffd|@|fffd|@|fffd|E|fffd|E|fffd|EpSheet
'**********************************************************************
'*miya_2018.12.25 |fffd||1c9||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd|[|fffd|^|fffd||fffd||1c9||fffd|
Public Sub PS_|fffd||fffd||fffd||fffd||348||350||752||fffd|(pSheet As Worksheet, Optional pApcnt As Integer = 0)
    Dim wPLcnt As Integer '*1|fffd|y|fffd|[|fffd|W|fffd||30d|s|fffd||fffd|
    Dim wApcnt As Integer '*|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd|
    Dim wPend As Integer
    Dim wHsta As Integer
    Dim wHend As Integer
    Dim w2Flg As Integer
    Dim i As Integer
    Dim j As Integer
    Dim wCol As Integer
    Dim wPSrange As String
    Dim wPErange As String
    Dim wSLine As Integer
    Dim wLcnt As Integer
    Dim wBUcnt As Integer
    Dim wBLcnt As Integer
    Dim wLint As Integer
    Dim wLpos As Integer
    Dim wLend As Integer
    
    i = 2
    j = 0
    Do
        i = i + 1
        If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(2, i) = "" Then
            Exit Do
        End If
        If ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(2, i) = pSheet.Name Then
            j = i
            Exit Do
        End If
    Loop
    If j = 0 Then
        Exit Sub
    End If
    
    wCol = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(3, j) '|fffd|{|fffd||fffd||fffd||fffd||50d||fffd|
    wPSrange = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(4, j) '|fffd||fffd||fffd||fffd||348||34d||fffd||fffd||fffd|
    wPErange = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(5, j) '|fffd||fffd||fffd||fffd||348||349||fffd|
    wSLine = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(6, j) '|fffd|Q|fffd|y|fffd|[|fffd|W|fffd||68a|J|fffd|n|fffd|s
    wLcnt = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(7, j) '|fffd|Q|fffd|y|fffd|[|fffd|W|fffd||696|{|fffd||fffd||fffd|s|fffd||fffd|
    wBUcnt = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(8, j) '|fffd||fffd|]|fffd||fffd||fffd|s|fffd||fffd|
    wBLcnt = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(9, j) '|fffd||fffd||fffd|]|fffd||fffd||fffd|s|fffd||fffd|
    wLint = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(10, j) '|fffd|{|fffd||fffd||fffd|s|fffd||50a|u
    wLpos = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(11, j) '|fffd|{|fffd||fffd||fffd|s|fffd||292|u
    wLend = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||348||350||752||fffd|").Cells(12, j) '|fffd||151||fffd|{|fffd||fffd||fffd|s|fffd||fffd|

    '*1|fffd|y|fffd|[|fffd|W|fffd||30d|s|fffd||fffd|
    wPLcnt = wBUcnt + wBLcnt + (wLcnt * wLint)
    '*|fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd|
    wApcnt = wLend / wLcnt
    If wLend Mod wLcnt > 0 Then
        wApcnt = wApcnt + 1
    End If
    
    w2Flg = False
    wPend = wSLine + (wPLcnt * wApcnt)
    
    For i = wApcnt To 1 Step -1
        '*|fffd|l|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|J|fffd|n|fffd|s
        wHsta = wPend - wPLcnt + wBUcnt + wLpos - 1
        '*|fffd|l|fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N|fffd|I|fffd||fffd||fffd|s
        wHend = wPend - wPLcnt + wBUcnt + ((wLcnt - 1) * wLint) + wLpos - 1
        For j = wHsta To wHend Step wLint
            If Trim(pSheet.Cells(j, wCol)) <> "" Then
                w2Flg = True
                Exit For
            End If
        Next j
        If w2Flg = True Then
            Exit For
        End If
        wPend = wPend - wPLcnt
    Next i
    
    '*miya_2018.12.25 |fffd||1c9||fffd||fffd|y|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|Z
    i = i + pApcnt
    
    '*|fffd||fffd||fffd||fffd||348||350||752||fffd|
    pSheet.PageSetup.PrintArea = wPSrange & ":" & wPErange & wPend - 1
    
    '*|fffd||fffd||282||30a|g|fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||24d||fffd||fffd||fffd||fffd||103|V|fffd|[|fffd|g|fffd||30a|g|fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||12c90||fffd||fffd||fffd||fffd||fffd|B|fffd|i|fffd||151||fffd|10%|fffd||702||142||312||fffd||fffd||fffd||fffd|j
    '*miya_2018.03.07 EXCEL2007|fffd||308||a554||fffd||fffd|SP|fffd||143|G|fffd||fffd||fffd|[|fffd||242||202||fffd||fffd||fffd||302||fffd||fffd||fffd||fffd||fffd||5c1|A2007|fffd||211|O|fffd||34e||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||60a4||fffd||24f|C|fffd||fffd|
    'If PF_VerGet() > "2003" Then    '2003|fffd||211|O|fffd||341|A|fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||60a4||fffd|C|fffd||fffd|
    If PF_VerGet() > "2007" Then    '2007|fffd||211|O|fffd||341|A|fffd||fffd||fffd|s|fffd||fffd||fffd||202||fffd||fffd||60a4||fffd|C|fffd||fffd|
        '*miya_2018.10.08 |fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||80aa||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||242||fffd||fffd||30e|||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd|
        On Error Resume Next
        j = 0
        Do Until pSheet.PageSetup.Pages.Count = i + 1 Or _
                 j >= 10
            Application.PrintCommunication = False
            pSheet.PageSetup.Zoom = pSheet.PageSetup.Zoom - 1
            
            '*miya_2018.10.08 |fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||80aa||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||242||fffd||fffd||30e|||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd|
            If Err <> 0 Then
                MsgBox "|fffd|y|fffd|[|fffd|W|fffd||30a|g|fffd||fffd|k|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||702||fffd||fffd||fffd|B|fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|B" & vbCrLf & Err & Err.Description, vbCritical
                j = 10
            End If
            
            Application.PrintCommunication = True
            'MsgBox "|fffd||fffd||fffd||fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||3cd|X|fffd|F" & pSheet.PageSetup.Zoom & "%"
            j = j + 1
        Loop
        '*miya_2018.10.08 |fffd|v|fffd||fffd||fffd||fffd||fffd|^|fffd||310||752||80aa||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||242||fffd||fffd||30e|||fffd||303|G|fffd||fffd||fffd|[|fffd||fffd||fffd|b|fffd|Z|fffd|[|fffd|W|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||24f|C|fffd||fffd|
        On Error GoTo 0
    End If
        
End Sub
'*miya_2015.12.27
Public Function PF_|fffd||fffd||fffd||657||fffd|3(pKbn As String, pItm As String, Optional pNo As Integer = 0) As String
    Dim wLtbl() As String
    Dim wItm As String
    Dim wItm2 As String
    Dim wstr As String
    Dim wNo As Integer
    Dim i As Integer
    Dim j As Integer
    
    PF_|fffd||fffd||fffd||657||fffd|3 = ""
    i = 0
    i = InStr(1, pItm, "|fffd|z") + 1
    wItm = Replace(Replace(Replace(Replace(Replace(Mid(pItm, i), ",", "|fffd|A"), "|fffd|", "|fffd|A"), ":", "|fffd|F"), "(", "|fffd|i"), ")", "|fffd|j")
    i = 0
    i = InStr(1, wItm, "|fffd|F")
    If pKbn = "K" Then
        If i > 0 Then
            PF_|fffd||fffd||fffd||657||fffd|3 = Mid(wItm, 1, i - 1)
        End If
        Exit Function
    End If
    
    wLtbl = Split(Mid(wItm, i + 1), "|fffd|A")
    
    'wNo = UBound(wLtbl) - pNo + 2
   
    If UBound(wLtbl) >= pNo - 1 Then
        'wItm2 = Trim(wLtbl(wNo - 1))
        wItm2 = Trim(wLtbl(pNo - 1))
        i = 0
        i = InStr(1, wItm2, "|fffd|i")
        If pKbn = "R1" Then
            If i > 0 Then
                PF_|fffd||fffd||fffd||657||fffd|3 = Mid(wItm2, 1, i - 1)
            Else
                PF_|fffd||fffd||fffd||657||fffd|3 = wItm2
            End If
        Else
            If i > 0 Then
                If Right(wItm2, 1) = "|fffd|j" Then
                    PF_|fffd||fffd||fffd||657||fffd|3 = Mid(wItm2, i + 1, Len(wItm2) - i - 1)
                Else
                    PF_|fffd||fffd||fffd||657||fffd|3 = Mid(wItm2, i + 1)
                End If
            End If
        End If
    End If

End Function
'*miya_2016.05.31
'**********************************************************************
'* PS_|fffd||590||fffd||fffd||fffd||fffd||fffd|
'**********************************************************************
Public Sub PS_|fffd||590||fffd||fffd||fffd||fffd||fffd|(pSheet As Worksheet, pRangeS As String, pRangeE As String)
    Dim wLineS As Integer
    Dim wLineE As Integer
    Dim wColS As Integer
    Dim wColE As Integer
    Dim i As Integer
    Dim j As Integer
    
    wLineS = pSheet.Range(pRangeS).Row
    wLineE = pSheet.Range(pRangeE).Row
    wColS = pSheet.Range(pRangeS).Column
    wColE = pSheet.Range(pRangeE).Column
    
    For i = wLineS To wLineE
        For j = wColS To wColE
            If pSheet.Cells(i, j).Formula <> "" Then
                pSheet.Cells(i, j) = pSheet.Cells(i, j).Value
            End If
        Next j
    Next i
        
End Sub

'*2016.08.04 sato add |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||682||153||fffd||fffd||fffd||fffd|P|fffd||fffd||fffd||fffd||702||791|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||181|ASEARCH|fffd||150||fffd||fffd||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||202||fffd||fffd||fffd||fffd||7c1|A|fffd||95||282||243|`|fffd|F|fffd|b|fffd|N
'pDat|fffd|E|fffd|E|fffd|E|fffd|EDATA2|fffd|V|fffd|[|fffd|g|fffd||30e|Q|fffd||183|Z|fffd||fffd||fffd||312|l
'pTarget |fffd|E|fffd|E|fffd|T|fffd||fffd||fffd|o|fffd||fffd||fffd|P|fffd||fffd|
'pDlm|fffd|E|fffd|E|fffd|E|fffd|E|fffd||fffd||602||8576||fffd||fffd|
Public Function PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|L|fffd||fffd|(pDat As String, pTarget As String, Optional pDlm As String = ",") As String
    
    Dim wRnm() As String
    Dim wCnt As Long
    
    PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|L|fffd||fffd| = "|fffd||fffd|"
    
    wRnm = Split(pDat, pDlm) '|fffd|l|fffd||fffd||fffd||fffd||602||8576||fffd||fffd||fffd||155||fffd||fffd||fffd|
    
    For wCnt = 0 To UBound(wRnm)
        If wRnm(wCnt) = pTarget Then
            PF_|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|L|fffd||fffd| = "|fffd||fffd|"
            Exit Function
        End If
    Next wCnt

End Function

'*miya_2017.11.12
Public Function PF_|fffd||fffd||fffd|c|fffd||fffd|3(pKbn As String, pItm As String, pLine As Integer, Optional pNo As Integer = 0) As String
    Dim wLtbl() As String
    Dim wItm As String
    Dim wItm2 As String
    Dim wstr As String
    Dim wNo As Integer
    Dim i As Integer
    Dim j As Integer
    
    wLtbl = Split(pItm, "/")
    If UBound(wLtbl) + 1 >= pLine Then
        PF_|fffd||fffd||fffd|c|fffd||fffd|3 = PF_|fffd||fffd||fffd||657||fffd|3(pKbn, wLtbl(pLine - 1), pNo)
    Else
        PF_|fffd||fffd||fffd|c|fffd||fffd|3 = ""
    End If

End Function
'*miya_2017.12.13
Public Function PF_|fffd||fffd||fffd||28a|O|fffd||fffd||fffd||fffd||fffd||fffd|o(pItm As String) As String
    Dim wItm As String
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    
    PF_|fffd||fffd||fffd||28a|O|fffd||fffd||fffd||fffd||fffd||fffd|o = ""
    
    wItm = ""
    i = InStr(1, Replace(Trim(pItm), "|fffd|i", "("), "(")
    If i = 0 Then
        PF_|fffd||fffd||fffd||28a|O|fffd||fffd||fffd||fffd||fffd||fffd|o = pItm
        Exit Function
    End If
    
    For j = 1 To i - 1
        wItm = wItm & Mid(pItm, j, 1)
    Next j

    PF_|fffd||fffd||fffd||28a|O|fffd||fffd||fffd||fffd||fffd||fffd|o = wItm

End Function

'*miya_2017.12.20
Public Function PF_|fffd||390||fffd||fffd||fffd||fffd||657||fffd|(pKbn As String, pItm As String, pNo As Integer, Optional pAll As Integer = False) As String
    Dim i As Integer
    Dim j As Integer
    Dim wItm As String
    
        wItm = PF_|fffd||fffd||fffd||657||fffd|2(pItm, pNo, pAll)
        If Right(StrConv(wItm, vbNarrow), 3) = "(*)" Then
            If pKbn = "K" Then
               PF_|fffd||390||fffd||fffd||fffd||fffd||657||fffd| = Left(wItm, Len(wItm) - 3)
            Else
               PF_|fffd||390||fffd||fffd||fffd||fffd||657||fffd| = "*"
            End If
        Else
            If pKbn = "K" Then
               PF_|fffd||390||fffd||fffd||fffd||fffd||657||fffd| = wItm
            Else
               PF_|fffd||390||fffd||fffd||fffd||fffd||657||fffd| = ""
            End If
        End If

End Function
'*miya_2018.07.29
Public Function PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2(pKnd As String, pLine As Integer, Optional pSpt As String = "") As Variant
'*---------------------------------------------------------------------------------------------*
'* PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2
'* |fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||782||fffd||fffd|w|fffd||80b5||fffd||fffd|DATA2|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd|w|fffd||fffd|s|fffd||312|l|fffd||fffd||fffd|w|fffd||80b5||fffd||fffd||fffd||348||342||14e||64fe||fffd||fffd||fffd||fffd|
'* |fffd|@|fffd|@pKnd|fffd|c|fffd||fffd||fffd||fffd||fffd||38f||6c2||315||fffd||fffd||fffd||fffd||fffd||781|i|fffd||fffd||fffd||fffd||fffd|w|fffd||fffd||30f||a347||fffd||341|A|fffd|u|fffd|A|fffd|v|fffd||14b||fffd||602||fffd|j
'* |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||782||341|u|fffd||fffd||fffd||fffd||fffd||fffd||781|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||30c|`|fffd||fffd||fffd||14e|w|fffd||80b7||fffd||fffd|i|fffd|u|fffd|F|fffd|v|fffd||14b||fffd||602||fffd|j
'* |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|iF|fffd|c|fffd|O|fffd||fffd||fffd|AB|fffd|c|fffd||fffd||fffd||fffd|i|fffd|A|fffd||fffd||fffd||e3c0||fffd||fffd||fffd||fffd||fffd||315||fffd||fffd||fffd||fffd||fffd||782||193||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||782||702||141|j|fffd|AA|fffd|E|fffd|E|fffd|E|fffd|O|fffd||fffd||fffd||18c||fffd||fffd||fffd|j
'* |fffd|@|fffd|@|fffd|@|fffd|@|fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A'|fffd||fffd||fffd||fffd|'|fffd||fffd|'F'|fffd|A'|fffd||fffd||fffd||fffd|'|fffd||702||fffd||fffd||fffd|'|fffd||fffd||fffd||fffd||fffd||fffd|'|fffd|A'|fffd||fffd||fffd||fffd||fffd||fffd|'|fffd||fffd|'B'|fffd||182||202||fffd|
'* |fffd|@|fffd|ApLine|fffd|c|fffd||fffd||fffd||fffd||fffd||38f||6c2||30d|s|fffd||50d||fffd|
'* |fffd|@|fffd|BpSpt|fffd|c|fffd||fffd||fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||fffd||303|Z|fffd|p|fffd||fffd||fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd|B|fffd||217||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||64ea||fffd||312|l|fffd||302||74e||64fe||fffd||fffd||fffd||fffd|
'* |fffd|@|fffd||fffd||fffd||102||44f|o|fffd||fffd||fffd||1044|
'* |fffd|@|fffd|@PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2("|fffd||fffd||fffd||fffd|FF|fffd|A|fffd||fffd||fffd||fffd||fffd|FB,|fffd||fffd||fffd||fffd||fffd||fffd||fffd|FB,|fffd||fffd||fffd||fffd||fffd||fffd||fffd|FF",4)
'* |fffd|@|fffd|@PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2("|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd|",4)
'*---------------------------------------------------------------------------------------------*
    Dim wSheet As Worksheet
    Dim wKnd() As String
    Dim wCrt() As String
    Dim wKey() As String
    Dim wSDt() As Variant
    Dim i As Integer
    Dim j As Integer
    Dim k As Integer
    Dim wHflg As Integer
    Dim wMflg As Integer
    Dim wIcnt As Integer
    Dim wItem(100) As Variant
    Dim wDat As Variant
    Dim wBkd As String
    Dim wKdt As String
    Dim wSpt As Integer
    
    PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2 = ""
    Set wSheet = ThisWorkbook.Sheets("DATA2")

    '* |fffd||fffd||fffd||fffd||fffd||fffd||782||15a8a||fffd|
    wKnd = Split(Replace(Replace(Replace(Replace(pKnd, ",", "|fffd|A"), "|fffd|", "|fffd|A"), "|fffd|C", "|fffd|A"), ":", "|fffd|F"), "|fffd|A")
    
    '* |fffd||fffd||fffd||fffd||fffd||fffd||782||15d8f||fffd||fffd||fffd||782||18c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||255||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    '* |fffd|@|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||217||fffd||fffd||fffd||fffd||310||752||fffd||fffd||fffd|s|fffd||fffd|
    '* |fffd|@|fffd|@|fffd|E|fffd||fffd||fffd||fffd|FF
    '* |fffd|@|fffd|@|fffd|E|fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd|FB
    '* |fffd|@|fffd|@|fffd|E|fffd||fffd|L|fffd||20a|O|fffd|FA
    
    ReDim wCrt(UBound(wKnd))
    For i = 0 To UBound(wKnd)
        j = InStr(1, wKnd(i), "|fffd|F")
        If j > 0 Then
            wCrt(i) = StrConv(Mid(wKnd(i), j + 1), vbNarrow)
            wKnd(i) = Left(wKnd(i), j - 1)
        Else
            Select Case wKnd(i)
                Case "|fffd||fffd||fffd||fffd|"
                    wCrt(i) = "F"
                Case "|fffd||fffd||fffd||fffd|"
                    wCrt(i) = "B"
                Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
                    wCrt(i) = "B"
                Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
                    wCrt(i) = "B"
                Case Else
                    wCrt(i) = "A"
            End Select
        End If
    Next i
    
    '* |fffd||598|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||50502||fffd||fffd||fffd|J|fffd|E|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd|
    i = 2
    Do
        If wSheet.Cells(1, i) = "" Then
            Exit Do
        End If
        i = i + 1
    Loop
    i = i - 3
    
    '* |fffd||fffd||fffd||fffd||fffd||38f||6c2||30d|s|fffd||312|l|fffd||16f8d||5d4||50d||fffd||fffd||fffd||fffd||243|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|
    ReDim wKey(i)
    ReDim wSDt(i)
    For j = 0 To i
        '* |fffd|\|fffd|[|fffd|g|fffd|L|fffd|[|fffd||310||752||fffd|i|fffd||598|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||44f||fffd||fffd|{|fffd||fffd||fffd||5d4||50d||fffd||fffd|j
        '*|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||5c3|f|fffd|[|fffd|^|fffd||24a||598|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||44f||fffd||fffd||fffd||fffd||1c9||fffd||fffd||fffd||fffd||a0bd||fffd||fffd||209||fffd||fffd||30d|s|fffd||fffd||fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd||242||fffd||fffd|A
        '*|fffd||fffd| |fffd||fffd||fffd||309||fffd||fffd||30d|s|fffd||301|Z|fffd||fffd|V|fffd||742||30d|s|fffd||50d||fffd||fffd||255||3cd|X|fffd||fffd||fffd||90b1||fffd||fffd|
        wKey(j) = Format(1, "000") & wSheet.Cells(1, j + 2)
        'wKey(j) = format(wSheet.Cells(|fffd|Z, j + 2),"000" &|fffd|@wSheet.Cells(1, j + 2)
        
        '* |fffd|\|fffd|[|fffd|g|fffd|f|fffd|[|fffd|^|fffd||310||752||fffd|i|fffd||fffd||50d||fffd||fffd|j
        wSDt(j) = j + 2
    Next j
    Call PS_|fffd|\|fffd|[|fffd|g|fffd||fffd||fffd||fffd|(wKey, wSDt)
    
    '* |fffd||fffd|{|fffd||315||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd|[|fffd|g|fffd|\|fffd||309||fffd||fffd|G|fffd||fffd||fffd|g|fffd||fffd||fffd||682||fffd||fffd||fffd||fffd|m|fffd|F
    For i = 0 To UBound(wKey)
        If wSheet.Cells(1, 2) = Mid(wKey(i), 4) Then
            Exit For
        End If
    Next i
    wSpt = i
    
    '* |fffd|\|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    wIcnt = 0
    For i = wSpt - 1 To 0 Step -1
        wHflg = False
        For j = 0 To UBound(wKnd)
            If wSheet.Cells(2, wSDt(i)) = wKnd(j) And _
               (wCrt(j) = "F" Or wCrt(j) = "A") Then
                wHflg = True
                Exit For
            End If
        Next j
        If wHflg = True Then
            '* |fffd||64fe||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||3c2||742||312|l|fffd||30f||a347||fffd|A|fffd|P|fffd||82||24f|W|fffd||42dc2||fffd|
            wMflg = False
            For k = 1 To wIcnt
                If wItem(k) = wSheet.Cells(pLine, wSDt(i)) Then
                    wMflg = True
                    Exit For
                End If
            Next k
            If wMflg = False Then
                wIcnt = wIcnt + 1
                wItem(wIcnt) = wSheet.Cells(pLine, wSDt(i))
            End If
        End If
    Next i
    
    '* |fffd|\|fffd|[|fffd|g|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    For i = wSpt + 1 To UBound(wKey)
        '* |fffd||fffd||fffd||313||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||782||303|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||38f||6c2||242||fffd||fffd||fffd|
        If wSheet.Cells(2, wSDt(i)) = wSheet.Cells(2, 2) Then
            Exit For
        End If
        
        wHflg = False
        For j = 0 To UBound(wKnd)
            If wSheet.Cells(2, wSDt(i)) = wKnd(j) And _
               (wCrt(j) = "B" Or wCrt(j) = "A") Then
                wHflg = True
                Exit For
            End If
        Next j
        If wHflg = True Then
            '* |fffd||64fe||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||3c2||742||312|l|fffd||30f||a347||fffd|A|fffd|P|fffd||82||24f|W|fffd||42dc2||fffd|
            wMflg = False
            For k = 1 To wIcnt
                If wItem(k) = wSheet.Cells(pLine, wSDt(i)) Then
                    wMflg = True
                    Exit For
                End If
            Next k
            If wMflg = False Then
                wIcnt = wIcnt + 1
                wItem(wIcnt) = wSheet.Cells(pLine, wSDt(i))
            End If
        End If
    Next i
    
    If pSpt = "" Then
        '* |fffd|Z|fffd|p|fffd||fffd||fffd|[|fffd|^|fffd|w|fffd||80aa||fffd||202||fffd||fffd||a347||fffd|A|fffd||64fe||fffd||fffd||fffd||fffd||fffd|l|fffd||310||64ea||fffd||312|l|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
        If wIcnt > 0 Then
            PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2 = wItem(1)
        End If
    Else
        '* |fffd|Z|fffd|p|fffd||fffd||fffd|[|fffd|^|fffd|w|fffd||80aa||fffd||fffd||fffd||fffd||a347||fffd|A|fffd||64fe||fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd|Z|fffd|p|fffd||fffd||fffd|[|fffd|^|fffd||14b||fffd||602||fffd||fffd||111|S|fffd||102||30e||64fe||fffd|l|fffd||fffd||fffd||fffd||fffd|^|fffd|[|fffd||fffd||fffd||fffd||fffd||fffd|
        wDat = ""
        For i = 1 To wIcnt
            If i > 1 Then
                wDat = wDat & pSpt
            End If
            wDat = wDat & wItem(i)
        Next i
        PF_|fffd||fffd||fffd||fffd||fffd||fffd||78e|w|fffd||fffd|Q|fffd||fffd|2 = wDat
    End If

End Function
'*miya_2018.08.25
Public Sub PS_|fffd||fffd||fffd|{|fffd||fffd|()
'*---------------------------------------------------------------------------------------------*
'* PS_|fffd||fffd||fffd|{|fffd||fffd|
'* |fffd|@Web|fffd||fffd||282||fffd||fffd||fffd||c42c||fffd||fffd||fffd||a0bd||fffd||4c2||30a||590||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||241|w|fffd||4c1|x|fffd||fffd||fffd||702||702||fffd||202||fffd||fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||fffd||fffd||5c2||10d||d3dc||fffd||fffd||fffd||fffd|
'*---------------------------------------------------------------------------------------------*
    Dim wSheet As Worksheet

    For Each wSheet In ThisWorkbook.Sheets
        If InStr(1, wSheet.Name, "|fffd||fffd|") > 0 Then
            wSheet.Unprotect Password:="fls2admin"
            Call PS_|fffd||590||fffd||fffd||fffd||fffd||fffd|(wSheet, "A1", "BZ1000")
        End If
    Next wSheet
    MsgBox "|fffd||590||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B|fffd||fffd||fffd||fffd||fffd||115|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd|B"
    
    Application.DisplayAlerts = False
    For Each wSheet In ThisWorkbook.Sheets
        If InStr(1, wSheet.Name, "|fffd||fffd|") > 0 Then
        Else
            If wSheet.Name = "INFO" Then
                wSheet.Unprotect Password:="zzzz"
                wSheet.Visible = xlSheetVisible
            End If
            wSheet.Delete
        End If
    Next wSheet
    Application.DisplayAlerts = True
    MsgBox "|fffd|s|fffd|v|fffd|V|fffd|[|fffd|g|fffd||d3dc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"

End Sub
'*miya_2019.07.24
Public Function PF_|fffd|a|fffd||fffd||48f|W(pDate As Variant, Optional pMode As String = "") As String
    Dim wDate As Variant
    Dim wDate2 As String
    Dim wGyy As String
    Dim wGnm As String
    Dim wYY As String
    Dim wMM As String
    Dim wDD As String
    Dim i As Integer
    
    If pDate & "" = "" Or _
       pDate = 0 Then
        wDate = Date
    Else
        If IsDate(pDate) = True Then
            wDate = pDate
        Else
            wDate = CVDate(pDate)
        End If
    End If
    wDate2 = Format(wDate, "yyyymmdd")
    i = 2
    wGyy = 0
    wGnm = ""
    Do Until ThisWorkbook.Sheets("|fffd|a|fffd||f333||fffd||fffd||fffd|\").Cells(i, 1) = ""
        If wDate2 >= CStr(ThisWorkbook.Sheets("|fffd|a|fffd||f333||fffd||fffd||fffd|\").Cells(i, 1)) Then
            wGyy = Left(ThisWorkbook.Sheets("|fffd|a|fffd||f333||fffd||fffd||fffd|\").Cells(i, 1), 4)
            wGnm = ThisWorkbook.Sheets("|fffd|a|fffd||f333||fffd||fffd||fffd|\").Cells(i, 2)
        Else
            Exit Do
        End If
        i = i + 1
    Loop
    
    If wGnm = "" Then
        PF_|fffd|a|fffd||fffd||48f|W = ""
        Exit Function
    End If
    
    If pDate & "" = "" Or _
       pDate = 0 Then
        If pMode = "z" Or pMode = "Z" Then
            PF_|fffd|a|fffd||fffd||48f|W = StrConv(wGnm & "  |fffd|N  |fffd||fffd|  |fffd||fffd|", vbWide)
        Else
            PF_|fffd|a|fffd||fffd||48f|W = wGnm & "  |fffd|N  |fffd||fffd|  |fffd||fffd|"
        End If
        Exit Function
    End If
    
    If Format(wDate, "yyyy") = wGyy Then
        wYY = "|fffd||fffd||fffd|N"
    Else
        wYY = CStr(CInt(Left(wDate, 4)) - CInt(wGyy) + 1) & "|fffd|N"
    End If
    
    If wYY = "|fffd||fffd||fffd|N" Then
        If pMode = "z" Or pMode = "Z" Then
            wYY = " " & wYY
        End If
    Else
        If Len(wYY) < 3 Then
            wYY = " " & wYY
        End If
    End If
   
    wMM = Format(wDate, "m|fffd||fffd|")
    If Len(wMM) < 3 Then
        wMM = " " & wMM
    End If
    wDD = Format(wDate, "d|fffd||fffd|")
    If Len(wDD) < 3 Then
        wDD = " " & wDD
    End If
    If pMode = "z" Or pMode = "Z" Then
        PF_|fffd|a|fffd||fffd||48f|W = StrConv(wGnm & wYY & wMM & wDD, vbWide)
    Else
        PF_|fffd|a|fffd||fffd||48f|W = wGnm & wYY & wMM & wDD
    End If

End Function

'*miya_2019.01.14
Public Function PF_|fffd|\|fffd||48f|W(pItm As String, pNo1 As Integer, pNo2 As Integer, Optional pAll As Integer = False) As String
    Dim wRtbl() As String
    Dim wLtbl() As String
    Dim wItm As String
    Dim wstr As String
    Dim i As Integer
    
    PF_|fffd|\|fffd||48f|W = ""
    wItm = pItm
    
    wRtbl = Split(wItm, "/")
    If UBound(wRtbl) >= pNo1 - 1 Then
        
        i = InStr(1, wRtbl(pNo1 - 1), "|fffd|z") + 1
        wLtbl = Split(Mid(wRtbl(pNo1 - 1), i), "|fffd|A")
        
        If UBound(wLtbl) >= pNo2 - 1 Then
            If pAll = True Then
                For i = pNo2 To UBound(wLtbl) + 1
                    PF_|fffd|\|fffd||48f|W = PF_|fffd|\|fffd||48f|W & Replace(Trim(wLtbl(i - 1)), "/", Chr(10)) & Chr(10)
                Next i
            Else
                PF_|fffd|\|fffd||48f|W = Replace(Trim(wLtbl(pNo2 - 1)), "/", Chr(10))
            End If
        End If
    End If

End Function


Attribute VB_Name = "|fffd||4ce||fffd||fffd|s"
Option Explicit
Public Sub PS_|fffd||4d5||48f|W()
    Dim wSheet As Worksheet
    Dim i As Integer
    Dim wRange As Range
    Dim wFaddr As String
    Dim wEflg As Integer
    Dim w2Flg As Integer
    Dim wPend As Integer
    Dim wFCell As Range
    Dim wApcnt As Integer
    
    'WebService|fffd||752||fffd|
    wOutDbCon = PF_Websvc("D", ThisWorkbook.Sheets("INFO").Range("A1") & "", ThisWorkbook.Sheets("INFO").Range("A3") & "") '|fffd||691||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    gUserID = ThisWorkbook.Sheets("INFO").Range("A3") & ""     '|fffd||fffd||fffd|[|fffd|U|fffd|[ID
    gIp = ThisWorkbook.Sheets("INFO").Range("A2") & ""         'IP|fffd|A|fffd|h|fffd||fffd||fffd|X
    gSyoriDt = ThisWorkbook.Sheets("INFO").Range("A4") & ""    '|fffd||fffd||fffd||fffd||fffd||fffd|
    gWhere = ThisWorkbook.Sheets("INFO").Range("B1") & ""      '|fffd||fffd||fffd||fffd|
    gOrder = ThisWorkbook.Sheets("INFO").Range("B2") & ""      '|fffd||fffd||fffd||44f||fffd|
    gNumber = ThisWorkbook.Sheets("INFO").Range("B3") & ""     '|fffd||fffd||fffd||5d4||50d||fffd|
    gUpid = ThisWorkbook.Sheets("INFO").Range("A5") & ""       '|fffd|X|fffd|V|fffd|h|fffd|c
    gPass = ThisWorkbook.Sheets("INFO").Range("A6") & ""        '|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h
    gUrl = ThisWorkbook.Sheets("INFO").Range("A7") & ""        'URL
    gKubun = ThisWorkbook.Sheets("INFO").Range("C1") & ""      '|fffd|N|fffd||101|^|fffd||fffd||fffd||fffd|
    gTanto = ThisWorkbook.Sheets("INFO").Range("C2") & ""      '|fffd|S|fffd||fffd||fffd||483|R|fffd|[|fffd|h
    gTantoNm = ThisWorkbook.Sheets("INFO").Range("C3") & ""    '|fffd|S|fffd||fffd||fffd||496||fffd|
    gBusyo = ThisWorkbook.Sheets("INFO").Range("C4") & ""      '|fffd||fffd||fffd||fffd||fffd|R|fffd|[|fffd|h
    gKessai = ThisWorkbook.Sheets("INFO").Range("C5") & ""     '|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h
    gDbid = ThisWorkbook.Sheets("INFO").Range("A8") & ""       'DBID
    gKskbn = ThisWorkbook.Sheets("DATA2").Range("B120") & ""     '|fffd||fffd||fffd||64b||656a|
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_S >>
    gGamenUrl = ThisWorkbook.Sheets("INFO").Range("C6") & ""     '|fffd||10f|o|fffd||fffd||fffd||fffd||fffd|URL
    '2014.08.26 |fffd|y|fffd||3ce|c1471|fffd|z kuwajima ADD_E <<
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima ADD_S >>
    gTenpuBunsyoUmu = ThisWorkbook.Sheets("INFO").Range("C7") & ""  '|fffd|Y|fffd|t|fffd||fffd||fffd||fffd||fffd|L|fffd||fffd|
    '2014.09.16 |fffd|y|fffd||3ce|c1484|fffd|z kuwajima ADD_E <<
    '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima ADD_S >>
    gDenshiKessaiMode = ThisWorkbook.Sheets("INFO").Range("C8") & ""   '|fffd|d|fffd|q|fffd||fffd||fffd||643||fffd||fffd|[|fffd|h
    '2017.11.14 |fffd|y|fffd||3ce|c2507|fffd|z kuwajima ADD_E <<

    '*miya_2015.02.23
    gThisFile = ThisWorkbook.Path & "\" & ThisWorkbook.Name
    
    '2015.02.16 mimura add ExSoap|fffd||389||fffd||fffd||fffd|
    'SOAP|fffd||58c|W|fffd||30f||fffd||fffd||fffd||fffd||fffd|
    If IsNumeric(ThisWorkbook.Sheets("INFO").Range("A12") & "") Then
        Call PF_SoapModule_Init(ThisWorkbook.Sheets("INFO").Range("A12") * 1000)
    Else
        Call PF_SoapModule_Init(60000)
    End If
    '2015.02.16 mimura add |fffd||fffd|

    ThisWorkbook.Sheets(cFlgSheet).Range(cFlgRange) = ""
    ThisWorkbook.Sheets(cFlgSheet).Range(cFlgProc) = ""
    
    gDkCnt = 0
    
    wEflg = False
    
    For Each wSheet In ThisWorkbook.Sheets
        '*miya_2015.02.22
        ''*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
        'If gKskbn = "|fffd|d|fffd|q" Then
        '    If PF_FontAdd(cFontpath & cFls2FontGNm) < 1 Then
        '        Application.Cursor = xlDefault
        '        MsgBox "|fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303||fffd||fffd|[|fffd|h|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
        '        Exit Sub
        '    End If
        'End If
        ''*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
        '
        'If gKessai = "|fffd|d|fffd|q|fffd||fffd||fffd||fffd|" Then
        '    F_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.Show (0)
        'End If
                
        '*|fffd||fffd|miya_2014.10.26 |fffd|Y|fffd|t|fffd||4c2||341|A|fffd|d|fffd|q|fffd||fffd||fffd||64e||fffd||fffd||302||755|\|fffd||fffd||fffd||fffd||fffd||fffd|
        '*|fffd||fffd|miya_2018.07.28 |fffd|Y|fffd|t|fffd||4c2||fffd||fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd||fffd||255||3cd|X
        'If wSheet.Name = "|fffd|Y|fffd|t|fffd||fffd|" Then
        '    If gKskbn = "|fffd|d|fffd|q" Then
        '        If ThisWorkbook.Sheets("DATA2").Range("B5") = gTanto Then
        '            wSheet.Visible = True
        '        Else
        '            wSheet.Visible = False
        '        End If
        '    Else
        '        wSheet.Visible = False
        '    End If
        'End If
        If wSheet.Name = "|fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd|" Then
            If gKskbn = "|fffd|d|fffd|q" Then
                If ThisWorkbook.Sheets("DATA2").Range("B5") <> gTanto Then
                    wSheet.Range("B8") = ""
                    wSheet.Range("E8") = ""
                End If
            End If
        End If
        '*|fffd||fffd|miya_2018.07.28 |fffd|Y|fffd|t|fffd||4c2||fffd||fffd||fffd|_|fffd|d|fffd|q|fffd||fffd||fffd||657||fffd||fffd||255||3cd|X
        '*|fffd||fffd|miya_2014.10.26 |fffd|Y|fffd|t|fffd||4c2||341|A|fffd|d|fffd|q|fffd||fffd||fffd||64e||fffd||fffd||302||755|\|fffd||fffd||fffd||fffd||fffd||fffd|
                
        If InStr(1, wSheet.Name, "|fffd||fffd|") > 0 Then
            With wSheet.Range(wSheet.Cells(1, 1), wSheet.Cells(wSheet.Cells.SpecialCells(xlCellTypeLastCell).Row, wSheet.Cells.SpecialCells(xlCellTypeLastCell).Column))
                Set wRange = .Find("*Err", LookAt:=xlPart, LookIn:=xlValues, _
                              SearchOrder:=xlByRows, MatchCase:=True, MatchByte:=True)
                If Not wRange Is Nothing Then
                    wEflg = True
                    wFaddr = wRange.Address
                    Do
                        wRange.Font.ColorIndex = 3
                        Set wRange = .FindNext(wRange)
                        If wRange Is Nothing Then Exit Do
                        If wRange.Address = wFaddr Then Exit Do
                    Loop
                End If
            End With
            
            '*|fffd||95||295||48f|W|fffd|O|fffd||fffd||fffd||fffd||fffd|i|fffd|K|fffd|v|fffd||249||fffd||fffd||fffd||fffd||101|A|fffd||4c3|V|fffd|[|fffd|g|fffd||30c||95||295||48f|W|fffd||fffd||fffd|s|fffd||fffd||fffd|j
            wApcnt = 0
            Call PS_|fffd||95||295||48f|W|fffd|O|fffd||fffd||fffd||fffd|(wSheet, wApcnt)
            
            '*|fffd|l|fffd||fffd||fffd||fffd||fffd||fffd|y|fffd|[|fffd|W|fffd||302||748||fffd||fffd||fffd||fffd||fffd||fffd|
            Call PS_|fffd||fffd||fffd||fffd||348||350||752||fffd|(wSheet, wApcnt)
            
            '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
            'wSheet.Protect Password:="fls2admin", DrawingObjects:=True, Contents:=True, Scenarios:=True
            '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
        End If
    Next wSheet
    
    '*miya_2015.02.22
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
    If gKskbn = "|fffd|d|fffd|q" Then
        If PF_FontAdd(cFontpath & cFls2FontGNm) < 1 Then
            Application.Cursor = xlDefault
            MsgBox "|fffd||fffd||fffd||fffd||fffd|Q|fffd||fffd||fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||303||fffd||fffd|[|fffd|h|fffd||24e||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B"
            Exit Sub
        End If
    End If
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
    If gKessai = "|fffd|d|fffd|q|fffd||fffd||fffd||fffd|" Then
        F_|fffd|d|fffd|q|fffd||fffd||fffd||fffd|.Show (0)
    End If
    
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
    'If wEflg = True Then
    '    MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||4c2||301|w*Err|fffd|x|fffd||313||fffd||fffd|e|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|I", vbExclamation
    'End If
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
    
    Application.CalculateFull
    
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
    If gKskbn = "|fffd|d|fffd|q" Then
        For i = 1 To gDkCnt
            gDkRange(i) = gDkRange(i).Value
            With gDkRange(i).Characters(Start:=Len(gDkRange(i).Value), Length:=1).Font
                .Name = "FLS2|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|i|fffd|S|fffd|V|fffd|b|fffd|N|fffd|j"
                .Size = 16
                .Color = vbRed
            End With
        Next i
    End If
    
    For Each wSheet In ThisWorkbook.Sheets
        '*miya_2014.12.28|fffd|@|fffd||4ce||fffd||fffd||fffd||351||389||fffd|
        'If InStr(1, wSheet.Name, "|fffd||fffd|") > 0 Then
        If InStr(1, wSheet.Name, "|fffd||fffd|") > 0 And _
           InStr(1, wSheet.Name, "|fffd||fffd||fffd||fffd||fffd|") = 0 Then
            
            '*|fffd||95||295||48f|W|fffd||33c8||fffd||fffd||fffd|i|fffd||4c3|V|fffd|[|fffd|g|fffd||303|v|fffd||fffd||fffd|e|fffd|N|fffd|g|fffd|y|fffd||441|A|fffd|K|fffd|v|fffd||249||fffd||fffd||fffd||fffd||102||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|j
            Call PS_|fffd||95||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd|(wSheet)
            
        End If
    Next wSheet
    
    '*|fffd||fffd||fffd||295||48f|W|fffd||33c8||fffd||fffd||fffd|i|fffd|K|fffd|v|fffd||249||fffd||fffd||fffd||fffd||101|A|fffd||4c3|V|fffd|[|fffd|g|fffd||315|\|fffd||fffd||fffd|E|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd|j
    Call PS_|fffd||fffd||fffd||295||48f|W|fffd||fffd||fffd||7cf||fffd||fffd||fffd|
    
    If wEflg = True Then
        MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B|fffd||4c2||301|w*Err|fffd|x|fffd||313||fffd||fffd|e|fffd||fffd||fffd|m|fffd|F|fffd||fffd||fffd||109||fffd||fffd||fffd||fffd||fffd||fffd|I", vbExclamation
    End If
    '*|fffd||fffd|miya_2014.10.19 |fffd|d|fffd|q|fffd||fffd||fffd||642||30f||fffd||fffd|F|fffd|}|fffd|[|fffd|N|fffd||310||fffd|p|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd||fffd|
   
End Sub


INQUEST-PP=macro
