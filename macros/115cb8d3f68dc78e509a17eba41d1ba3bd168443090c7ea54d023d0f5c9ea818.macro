Attribute VB_Name = "Module1"
Sub AddRows()
On Error Resume Next
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
Dim ws As Worksheet
Dim i As Long
Dim i2 As Long
Dim i3 As Long

Set Register = ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
For i = 4 To 1048570
    If (Range("A" & i).Value = "") Then
        For i2 = 1 To Register.Range("ZZ1000000").Value
            Register.Range("A" & (i + i2 - 1) & ":N" & (i + i2 - 1)).Locked = False
            Register.Range("AA" & (i + i2 - 1)).Locked = False
            Register.Cells(i - 2 + i2, 1).Copy
            Register.Cells(i + i2 - 1, 1).PasteSpecial Paste:=xlFormats
            Register.Cells(i + i2 - 1, 1) = Register.Cells(i - 1 + i2 - 1, 1) + 1
            For i3 = 2 To 28
                Register.Cells(i - 2 + i2, i3).Copy
                Register.Cells(i + i2 - 1, i3).PasteSpecial (xlPasteValidation)
                Register.Cells(i + i2 - 1, i3).PasteSpecial (xlPasteFormats)
                If Left(Register.Cells(i + i2 - 2, i3).Formula, 1) = "=" Then Register.Cells(i + i2 - 1, i3).PasteSpecial (xlPasteFormulas)
                Register.Cells(i + i2 - 1, i3).Interior.ColorIndex = 0
            Next i3
        Next i2
        Exit For
    End If
Next i
    SendKeys "{ESC}", True
    Register.Range("B" & i).Select
    SendKeys "{ESC}", True
End Sub

Sub Unblock()

ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
Set Model = ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
strName = InputBox(Prompt:="|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
          Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")

          

        If strName = "Sberbank2012)" Then
            Model.Range("B114:L125").Locked = False
            Model.Range("B132:L169").Locked = False
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
            Exit Sub
        Else
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
        End If

End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub ChangeAmounOfAdd_SpinDown()
On Error Resume Next
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
If (ActiveSheet.Range("ZZ1000000").Value <> "1") Then ActiveSheet.Range("ZZ1000000").Value = ActiveSheet.Range("ZZ1000000").Value - 1
End Sub

Private Sub ChangeAmounOfAdd_SpinUp()
On Error Resume Next
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
If (ActiveSheet.Range("ZZ1000000").Value <> "1048570") Then ActiveSheet.Range("ZZ1000000").Value = ActiveSheet.Range("ZZ1000000").Value + 1
End Sub

Private Sub change_delta_spindown()

On Error Resume Next
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
If (ActiveSheet.Range("ZY1000000").Value <> 0.4) Then ActiveSheet.Range("Zy1000000").Value = ActiveSheet.Range("Zy1000000").Value - 0.1
End Sub


Private Sub change_delta_spinup()
On Error Resume Next
ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
If (ActiveSheet.Range("ZY1000000").Value <> "1") Then ActiveSheet.Range("Zy1000000").Value = ActiveSheet.Range("Zy1000000").Value + 0.1
End Sub

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("service").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").EnableAutoFilter = True
    ThisWorkbook.Sheets("service").EnableAutoFilter = True
    
    
End Sub
Attribute VB_Name = "Val_by_Nikita_L"

Public Sub RunVal()
    On Error Resume Next
    
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Protect Password:="Hgas6@v", userinterfaceonly:=True
    ThisWorkbook.Sheets("service").Protect Password:="Hgas6@v", userinterfaceonly:=True
            
    Dim Func
    
    Dim Register, Model, SRV As Worksheet
    Dim RegisterIDs, idR As Range
    Dim Selected_idR, FV, ParentMedian, ParentSize, RMSdev, deltaMM  As Range
    Dim AnalogueIDs, AnalogueAdj, AnalogueAdjBV, AnalogueFV_adjusted As Range
    
    Dim limBV, limAdj, use_delta As Double
    Dim FVmed, FVmin, FVmax, FVdelta As Double
    Dim SelTop, SelBtm, SelNum As Integer
    Dim exT, exB, exD, purpose_override As Boolean
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim Purpose_override_1, Purpose_override_2, Purpose_override_3, Purpose_override_4, Purpose_override_5, Purpose_override_6 As Boolean
    Dim Condition_1, Condition_2, Condition_3, Condition_4, Condition_5 As Boolean
    Dim exD_1, exD_2, exD_3, exD_4, exD_5, exD_6, For_comment, Flag, Flagtel As Boolean
    Dim Condition_number As Integer
    
    
    Dim cursor As Integer
    
    Dim cur_date, cur_time As Date
    Dim f_path, f_name, txt As String
    
    Application.ScreenUpdating = False
    
    Set Func = Application.WorksheetFunction
    
    Set Register = ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
    Set Model = ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
    Set SRV = ThisWorkbook.Worksheets("service")
    
    With Register
        Set RegisterIDs = .Range(.Cells(3, 1), .Cells(2, 1).End(xlDown))
    End With
    
    Set AnalogueIDs = Model.Range("$B$8:$B$107")
    Set AnalogueAdj = Model.Range("$ai$8:$ai$107")
    Set AnalogueAdjBV = Model.Range("$aj$8:$aj$107")
    Set AnalogueFV_adjusted = Model.Range("$ah$8:$ah$107")
    
    Set Selected_idR = Model.Range("B3")
    Set FV = Model.Range("D170")
    Set ParentMedian = Model.Range("AH4")
    Set ParentSize = Model.Range("AH5")
    Set RMSdev = Model.Range("C190")
    Set deltaMM = Model.Range("A194")
    
    use_delta = Register.Range("ZY1000000").Value
    purpose_override = False
    
    If use_delta <> 0.4 Then
        
        strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & use_delta & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
          Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")

        If strName <> "Hgas6@v" Then
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
            Exit Sub
        End If
    End If
    
    cur_date = Date
    cur_time = Time
    txt = CStr(Year(cur_date)) & "-" & CStr(Month(cur_date)) & "-" & CStr(Day(cur_date)) & "__" & CStr(Hour(cur_time)) & "-" & CStr(Minute(cur_time))
    f_path = ThisWorkbook.Path & "\val_" & txt
    
    MkDir (f_path)
    
    
'    ErrorLog = f_path & "\error_log.txt"
'    ELF = FreeFile()
'    Open ErrorLog For Output As ELF
    
    'rotation of valuation objects
    
    
    
    'Condition_1 = True
    'Condition_2 = True
    'Condition_3 = True
    'Condition_4 = True
    'Condition_5 = True
    
    For Each idR In RegisterIDs.Cells
        'select object for valuation and get 50 analogues
        Selected_idR.Value = idR.Value
        Model.Calculate
        
        
        SelNum = 0
        limBV = 10
        limAdj = 0.4
        exD = False
        Flagtel = False
        
' 1|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.ShowAllData
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value

If Purpose_override_1 Then
    If sl Then
        If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            GoTo Overall
        End If
    End If
' ?
Else
    Condition_1 = True
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        
        Do
            resp = MsgBox( _
                            Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & idR.Value & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|? " _
                                    & "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            resp_add = MsgBox( _
                            Prompt:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            If resp_add = vbYes Then
                Purpose_override_1 = True
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        'If Condition_1 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        'End If
                        'If Condition_2 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        'End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_1 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_1 = False
                        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2
                    sl = True
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    GoTo Overall
                End If

            Else
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        'If Condition_1 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        'End If
                        'If Condition_2 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        'End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_1 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_1 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2
                    GoTo Overall
                End If
            End If
        Loop Until exD_1
    End If
End If

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd| 1|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
Model.ShowAllData
If Condition_1 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
End If
    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'-------------------------------------------------------------------------------

If Purpose_override_2 Then
    If sl1 Then
        If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|"
            GoTo Overall
        End If
    End If ' ?
Else
    Condition_2 = True
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        If Condition_1 Or (Not Condition_1 And purporse_override_1) Then
        
        Do
            resp = MsgBox( _
                            Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & idR.Value & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|? " _
                                    & "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            resp_add = MsgBox( _
                            Prompt:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            If resp_add = vbYes Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Purpose_override_2 = True
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        'If Condition_2 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        'End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_2 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_2 = False
                        
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|"
                    sl1 = True
                    GoTo Overall
                End If

            Else
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        'If Condition_2 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        'End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_2 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_2 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3
                
                    GoTo Overall
                End If
            End If
        Loop Until exD_2
        Else
            GoTo Overall
        End If
    End If
End If

Model.ShowAllData
If Condition_1 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
End If
If Condition_2 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
End If
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"


If Purpose_override_3 Then
    If sl2 Then
        If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            GoTo Overall
        End If
    End If
' ?
Else
    Condition_3 = True
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        If (Condition_1 Or (Not Condition_1 And purporse_override_1)) _
            And _
            (Condition_2 Or (Not Condition_2 And purporse_override_2)) _
        Then
        
        
        Do
            resp = MsgBox( _
                            Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & idR.Value & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|? " _
                                    & "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            resp_add = MsgBox( _
                            Prompt:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            If resp_add = vbYes Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Purpose_override_3 = True
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_3 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_3 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4
                    sl2 = True
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    GoTo Overall
                End If

            Else
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        'If Condition_3 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        'End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_3 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_3 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4
                
                    GoTo Overall
                    
                End If
            End If
        Loop Until exD_3
        Else
            GoTo Overall
        End If
    End If
End If

Model.ShowAllData
If Condition_1 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
End If
If Condition_2 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
End If
If Condition_3 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
End If
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1


If Purpose_override_4 Then
' ?
    If sl3 Then
        If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            GoTo Overall
        End If
    End If
Else
    Condition_4 = True
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        If (Condition_1 Or (Not Condition_1 And purporse_override_1)) _
            And _
            (Condition_2 Or (Not Condition_2 And purporse_override_2)) _
            And _
             (Condition_3 Or (Not Condition_3 And purporse_override_3)) _
            Then
        ' if Condition_1 And Condition_2 And Condition_3 Then
        
        Do
            resp = MsgBox( _
                            Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & idR.Value & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|? " _
                                    & "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            resp_add = MsgBox( _
                            Prompt:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            If resp_add = vbYes Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Purpose_override_4 = True
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        If Condition_3 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_4 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_4 = False
                        
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5
                    sl3 = True
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    GoTo Overall
                End If

            Else
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        If Condition_3 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        End If
                        'If Condition_4 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        'End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_4 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_4 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5
                
                    GoTo Overall
                End If
            End If
        Loop Until exD_4
        Else
            GoTo Overall
        End If
    End If
End If

Model.ShowAllData
If Condition_1 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
End If
If Condition_2 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
End If
If Condition_3 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
End If
If Condition_4 Then
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
End If
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"

If Purpose_override_5 Then
' ?
    If sl4 Then
        If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            GoTo Overall
        End If
    End If
Else
    Condition_5 = True
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        If (Condition_1 Or (Not Condition_1 And purporse_override_1)) _
            And _
            (Condition_2 Or (Not Condition_2 And purporse_override_2)) _
            And _
             (Condition_3 Or (Not Condition_3 And purporse_override_3)) _
             And _
              (Condition_4 Or (Not Condition_4 And purporse_override_4)) _
            Then

        
        Do
            resp = MsgBox( _
                            Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & idR.Value & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|? " _
                                    & "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. " _
                                    & "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            resp_add = MsgBox( _
                            Prompt:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" _
                            , Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" _
                            , Buttons:=vbYesNo + vbQuestion _
                            )
            If resp_add = vbYes Then
                ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
                Purpose_override_5 = True
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        If Condition_3 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        End If
                        If Condition_4 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_5 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_5 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                    sl4 = True
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    GoTo Overall
                End If

            Else
                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If resp = vbYes Then
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5
                    strName = InputBox(Prompt:="|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.", _
                    Title:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", Default:="")
                
                    If strName = "Hgas6@v" Then
                        
                        '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
                        Model.ShowAllData
                        If Condition_1 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
                        End If
                        If Condition_2 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
                        End If
                        If Condition_3 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
                        End If
                        If Condition_4 Then
                            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
                        End If
                        'If Condition_5 Then
                        '    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                        '    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
                        'End If
                        '--------------------------------------------------------------------------
                        
                        exD_5 = True
                        ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                        Condition_5 = False
                        
                    Else
                        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|."
                    End If
                Else
                    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
                
                    GoTo Overall
                End If
            End If
        Loop Until exD_5
        Else
            GoTo Overall
        End If
    End If
End If

Overall:

    Model.ShowAllData
    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
    Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
    Flag = True
If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
    '---------------------- |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -----------------------
    Model.ShowAllData
    If Condition_1 Then
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
    End If
    If Condition_2 Then
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
        Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
    End If
    If Condition_3 Then
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
    End If
    If Condition_4 Then
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 : |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
    End If
    If Condition_5 Then
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5 : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
    End If
    '-------------------------------------------------------------------------------
    Flag = False
    
    If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
        Flagtel = False
        GoTo skb
    End If
End If

If Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
    Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    GoTo sk
End If

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Flagtel = True
        '#################################################################################################################
        Do
        '#################################################################################################################

        'copy analogue ids and adjustment rating to tmp sheet for sorting
        AnalogueIDs.Copy
            SRV.Range("g1").PasteSpecial Paste:=xlPasteValues
        AnalogueAdj.Copy
            SRV.Range("h1").PasteSpecial Paste:=xlPasteValues
        AnalogueAdjBV.Copy
            SRV.Range("i1").PasteSpecial Paste:=xlPasteValues
        AnalogueFV_adjusted.Copy
            SRV.Range("j1").PasteSpecial Paste:=xlPasteValues
        
        
        'sort by adj
        With SRV.Sort
            .SortFields.Clear
            .SortFields.Add Key:=Range("h:h"), _
                            SortOn:=xlSortOnValues, _
                            Order:=xlAscending, _
                            DataOption:=xlSortNormal
            .SetRange Range("g:j")
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        
        'look for rows where adj >40%+x and claer them
        cursor = 0
        '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        Do
            cursor = cursor + 1
        Loop Until SRV.Cells(cursor, 8).Value >= limAdj _
                    Or Len(SRV.Cells(cursor, 8).Value) = 0
        SRV.Range(SRV.Cells(cursor, 7), SRV.Cells(10000, 10)).Clear
        
        
        'is remainig population not blank?
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| "service" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
        If Func.Count(SRV.Range("g:g")) = 0 Then
            SelNum = 0
        ElseIf Func.Count(SRV.Range("g:g")) > 2 Then
            'sort by adjusted FV
            With SRV.Sort
                .SortFields.Clear
                .SortFields.Add Key:=Range("j:j"), _
                                SortOn:=xlSortOnValues, _
                                Order:=xlAscending, _
                                DataOption:=xlSortNormal
                .SetRange Range("g:j")
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
            
            '-----------------------------------------------------------------------------
            '1st algorithm: go up and down from median
            FVmed = Func.Median(SRV.Range("j:j"))
            SelNum = Func.Count(SRV.Range("j:j"))
            
            'select median or values around median for initial iteration
            If Func.IsOdd(SelNum) Then
                SelTop = SelNum / 2 + 0.5
                SelBtm = SelTop
                SelNum = 1
            Else
                SelTop = SelNum / 2
                SelBtm = SelNum / 2 + 1
                SelNum = 2
            End If 'Func.IsOdd(SelNum)
            
            
            FVmin = Func.Min(SRV.Cells(SelTop, 10), SRV.Cells(SelBtm, 10))
            FVmax = Func.Max(SRV.Cells(SelTop, 10), SRV.Cells(SelBtm, 10))
            FVdelta = (FVmax / FVmin) - 1
            
            If FVdelta <= use_delta Then
                Do
                    exT = False
                    exB = False
                    
                    If SelTop - 1 = 0 Then
                        exT = True
                    ElseIf SelNum + 1 <= 8 _
                            And (Func.Max(SRV.Cells(SelTop - 1, 10), SRV.Cells(SelBtm, 10)) _
                                    / Func.Min(SRV.Cells(SelTop - 1, 10), SRV.Cells(SelBtm, 10))) _
                                    - 1 <= use_delta Then
                                        SelTop = SelTop - 1
                                        SelNum = SelNum + 1
                    Else
                        exT = True
                    End If
                    
                    If SRV.Cells(SelBtm + 1, 10).Value = 0 Then
                        exB = True
                    ElseIf SelNum + 1 <= 8 _
                        And (Func.Max(SRV.Cells(SelTop, 10), SRV.Cells(SelBtm + 1, 10)) _
                                / Func.Min(SRV.Cells(SelTop, 10), SRV.Cells(SelBtm + 1, 10))) _
                                - 1 <= use_delta Then
                                        SelBtm = SelBtm + 1
                                        SelNum = SelNum + 1
                    Else
                        exB = True
                    End If
                Loop Until (exT And exB) Or SelNum > Func.Count(SRV.Range("g:g"))
            End If 'FVdelta <= 0.4
            '-----------------------------------------------------------------------------
        End If 'Func.Count(SRV.Range("a:a")) = 0
        
        ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|.
        
        ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        If SelNum < 3 Then
            'raise adj limit
            If limAdj < 1 Then
                limAdj = limAdj + 0.1
            Else
                limAdj = 10
            End If
        End If 'SelNum < 3
        
        '#################################################################################################################
        Loop Until SelNum >= 3 _
                Or (limBV = 10 And limAdj = 10)
        '#################################################################################################################
        
        '-----------------------------------------------------------------------------
        '2nd algorithm: select median, 1 up and 1 down
        'it is used when 1st algorithm returns less than 3 analogue
        If SelNum < 3 Then
        
            SRV.Range("G:j").Clear
            AnalogueIDs.Copy
                SRV.Range("g1").PasteSpecial Paste:=xlPasteValues
            AnalogueAdj.Copy
                SRV.Range("h1").PasteSpecial Paste:=xlPasteValues
            AnalogueAdjBV.Copy
                SRV.Range("i1").PasteSpecial Paste:=xlPasteValues
            AnalogueFV_adjusted.Copy
                SRV.Range("j1").PasteSpecial Paste:=xlPasteValues
            
            'sort by adjusted FV
            With SRV.Sort
                .SortFields.Clear
                .SortFields.Add Key:=Range("j:j"), _
                                SortOn:=xlSortOnValues, _
                                Order:=xlAscending, _
                                DataOption:=xlSortNormal
                .SetRange Range("g:j")
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
            
            FVmed = Func.Median(SRV.Range("j:j"))
            SelNum = Func.Count(SRV.Range("j:j"))
            
            'select median or values around median
            If Func.IsOdd(SelNum) Then
                SelTop = SelNum / 2 - 0.5
                SelBtm = SelTop + 2
                SelNum = 3
            Else
                SelTop = SelNum / 2 - 1
                SelBtm = SelNum / 2 + 2
                SelNum = 4
            End If 'Func.IsOdd(SelNum)
        
        End If 'SelNum < 3
        '-----------------------------------------------------------------------------
        
        
        With Model
            .Range(.Cells(112, 5), .Cells(112, 12)).Clear
        End With
        
        'return best analogues ids
        If SelNum <> 0 Then
            d = SelTop - 1
            For i = SelTop To SelBtm
                Model.Cells(112, i + 4 - d).Value = SRV.Cells(i, 7).Value
            Next i
        End If 'SelNum <> 0
        
        
        Model.Range("A112:L199").Calculate
        
        
        Register.Cells(idR.Row, 16).Value = Round(FV.Value, 2)
        Register.Cells(idR.Row, 19).Value = Func.Min(Model.Range("E165:L165")) 'min FV
        Register.Cells(idR.Row, 20).Value = Func.Max(Model.Range("E165:L165")) 'max FV
        Register.Cells(idR.Row, 21).Value = ParentMedian.Value
        Register.Cells(idR.Row, 22).Value = ParentSize.Value
        Register.Cells(idR.Row, 23).Value = Func.Count(SRV.Range("g:g")) 'num of analogues that were evaluated
        
        'Register.Cells(idR.Row, 23).Value = limBV
        Register.Cells(idR.Row, 24).Value = limAdj
        'Register.Cells(idR.Row, 24).Value = Not (limBV = 10 And limAdj = 10) 'true if delta limit was used
        
        Register.Cells(idR.Row, 25).Value = Func.Count(Model.Range("E162:L162")) 'num of analogues selected
        Register.Cells(idR.Row, 26).Value = deltaMM.Value
        Register.Cells(idR.Row, 27).Value = RMSdev.Value
        

               
        'save model state to a separate file
'        f_name = CStr(idR.Value)
'        f_name = Left("0000000000", 10 - Len(f_name)) & f_name
'        f_name = "\id" & f_name & "_" & txt & ".xlsm"
        f_name = "\" & ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(idR.Row, idR.Column + 2).Value & "_" & ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(idR.Row, idR.Column + 3).Value & "_" & ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Cells(idR.Row, idR.Column + 5).Value & ".xlsm"
        
        ThisWorkbook.SaveCopyAs (f_path & f_name)
        SRV.Range("A:j").Clear
        Model.ShowAllData
    
skb:
If Flagtel Then
    If Flag Then
        Register.Cells(idR.Row, 28).Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Else
        If Condition_1 Then
            If Condition_2 Then
                If Condition_3 Then
                    If Condition_4 Then
                        If Condition_5 Then
                            Register.Cells(idR.Row, 28).Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                        Else
                            Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                        End If
                    Else
                        Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                    End If
                Else
                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
                End If
            Else
                Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|"
            End If
        Else
            Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        End If
    End If
Else
'    If Flag Then
'        Register.Cells(idR.Row, 28).Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'    Else
'        Model.ShowAllData
'        Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
'        'Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'        'Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
'        'Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
'        'Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
'        If (Condition_1 Or (Not Condition_1 And Purpose_override_1)) _
'                And Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
'            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'        Else
'            Model.ShowAllData
'            Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
'            Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'            'Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
'            'Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
'            'Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
'            If (Condition_2 Or (Not Condition_2 And Purpose_override_2)) _
'                     And Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
'                Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|"
'            Else
'                Model.ShowAllData
'                Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
'                Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'                'Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
'                Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
'                'Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
'                If (Condition_3 Or (Not Condition_3 And Purpose_override_3)) _
'                         And Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
'                    Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                Else
'                    Model.ShowAllData
'                    Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
'                    Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'                    Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
'                    Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
'                    'Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
'                    If (Condition_4 Or (Not Condition_4 And Purpose_override_4)) _
'                             And Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
'                        Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                    Else
'                        Model.ShowAllData
'                        Model.Range("A7:AI107").AutoFilter Field:=13, Criteria1:=Model.Range("J3").Value
'                        Model.Range("A7:AI107").AutoFilter Field:=7, Criteria1:=Model.Range("K3").Value
'                        Model.Range("A7:AI107").AutoFilter Field:=37, Criteria1:="<365"
'                        Model.Range("A7:AI107").AutoFilter Field:=38, Criteria1:=1
'                        Model.Range("A7:AI107").AutoFilter Field:=20, Criteria1:="<0.15"
'                        If (Condition_5 Or (Not Condition_5 And Purpose_override_5)) _
'                                 And Func.Subtotal(102, Model.Range("A7:A107")) = 0 Then
'                            Register.Cells(idR.Row, 28).Value = "|fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                        Else
'                            Register.Cells(idR.Row, 28).Value = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'                        End If
'                    End If
'                End If
'            End If
'        End If
'    End If
End If

sk:
    
    Next idR
    
    Model.ShowAllData
    ThisWorkbook.SaveCopyAs (f_path & "\|fffd||fffd||fffd||fffd||fffd|.xlsm")
    
    Set Register = Nothing
    Set Model = Nothing
    Set SRV = Nothing
    Set RegisterIDs = Nothing
    Set AnalogueIDs = Nothing
    Set AnalogueAdj = Nothing
    Set AnalogueAdjBV = Nothing
    Set AnalogueFV_adjusted = Nothing
    Set Selected_idR = Nothing
    Set FV = Nothing
    Set ParentMedian = Nothing
    Set ParentSize = Nothing
    Set RMSdev = Nothing
    Set deltaMM = Nothing
    Set BackUp = Nothing
    
    
    Application.ScreenUpdating = True
 '   ThisWorkbook.Save
    MsgBox ("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
    
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
