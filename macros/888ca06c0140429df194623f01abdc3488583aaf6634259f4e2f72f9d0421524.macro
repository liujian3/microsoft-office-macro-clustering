Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "TextBoxRightClickHdlClass"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private WithEvents myTxtBox As MSForms.TextBox
Attribute myTxtBox.VB_VarHelpID = -1
Private myFrm As MSForms.UserForm

'Private WithEvents myUndoBtn        As Office.CommandBarButton
'Private WithEvents myRedoBtn        As Office.CommandBarButton
Private WithEvents myCutBtn         As Office.CommandBarButton
Attribute myCutBtn.VB_VarHelpID = -1
Private WithEvents myCopyBtn        As Office.CommandBarButton
Attribute myCopyBtn.VB_VarHelpID = -1
Private WithEvents myPasteBtn       As Office.CommandBarButton
Attribute myPasteBtn.VB_VarHelpID = -1
Private WithEvents myDeleteBtn      As Office.CommandBarButton
Attribute myDeleteBtn.VB_VarHelpID = -1
Private WithEvents myAllSelectBtn   As Office.CommandBarButton
Attribute myAllSelectBtn.VB_VarHelpID = -1

Public Sub Init(ByVal myNewTxtBox As MSForms.TextBox)
    Set myTxtBox = myNewTxtBox
    Set myFrm = myTxtBox.Parent
End Sub

'Private Sub myUndoBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    myFrm.UndoAction
'End Sub
'
'Private Sub myRedoBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
'    myFrm.RedoAction
'End Sub

Private Sub myCutBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    myTxtBox.Cut
'    SendKeys "^x"
End Sub

Private Sub myCopyBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    myTxtBox.Copy
End Sub

Private Sub myPasteBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    myTxtBox.Paste
'    SendKeys "^v"
End Sub

Private Sub myDeleteBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    myTxtBox.SelText = ""
'    SendKeys "{DELETE}"
End Sub

Private Sub myAllSelectBtn_Click(ByVal Ctrl As Office.CommandBarButton, CancelDefault As Boolean)
    With myTxtBox
        .SelStart = 0
        .SelLength = Len(.Value)
    End With
End Sub

Private Sub myTxtBox_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    If Button <> 2 Then Exit Sub
    With Application.CommandBars.Add(Position:=msoBarPopup)
'        Set myUndoBtn = .Controls.Add(msoControlButton)
'        With myUndoBtn
'            .Caption = "|fffd||fffd||fffd||256||7c2||fffd|(&U)"
'            .Enabled = myFrm.CanUndo
'        End With
'        Set myRedoBtn = .Controls.Add(msoControlButton)
'        With myRedoBtn
'            .Caption = "|fffd||fffd||84bc||fffd||fffd|(&Y)"
'            .Enabled = myFrm.CanRedo
'        End With
        Set myCutBtn = .Controls.Add(msoControlButton)
        With myCutBtn
            .Caption = "|fffd||602||fffd||fffd||fffd|(&X)"
            .Enabled = myTxtBox.SelLength > 0
'            .BeginGroup = True
        End With
        Set myCopyBtn = .Controls.Add(msoControlButton)
        With myCopyBtn
            .Caption = "|fffd|R|fffd|s|fffd|[(&C)"
            .Enabled = myTxtBox.SelLength > 0
        End With
        Set myPasteBtn = .Controls.Add(msoControlButton)
        With myPasteBtn
            .Caption = "|fffd|\|fffd||fffd|t|fffd||fffd|(&V)"
            .Enabled = myTxtBox.CanPaste
        End With
        Set myDeleteBtn = .Controls.Add(msoControlButton)
        With myDeleteBtn
            .Caption = "|fffd||d3dc|(&D)"
            .Enabled = myTxtBox.SelLength > 0
        End With
        Set myAllSelectBtn = .Controls.Add(msoControlButton)
        With myAllSelectBtn
            .Caption = "|fffd||fffd||fffd||5c2||111|I|fffd||fffd|(&A)"
            .Enabled = VBA.Len(myTxtBox.Value) > 0
            .BeginGroup = True
        End With
        .ShowPopup
        .Delete
    End With
End Sub



Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Top_import"
Option Private Module
Option Explicit

Sub import()
'2016/12/3 Ver.1620
'2016/12/14 Ver.1622
'2016/12/14 Ver.1623
'2016/12/15 Ver.1624
'2017/1/8 Ver.1700
'2018/1/2 Ver.1800
'2019/1/2 Ver.1900

    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim myMsg As String
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = gn Then
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    Workbooks(e).Activate
    Application.ScreenUpdating = True
    
    On Error GoTo 0
    If hn = gn Then
        If h >= 1900 And h <= g Then                 '|fffd|{|fffd|N|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd||635e||fffd|m|fffd|F") = vbYes Then
                                    
                Dim mysht As Worksheet, myshs As Worksheet, myshd As Worksheet
                
                Set mysht = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshs = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                Set myshd = Workbooks(f).Worksheets("|fffd|f|fffd|[|fffd|^")
                
                Application.ScreenUpdating = False
                                
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
'                    .Unprotect Password:="2343t"
'                    .Range("G7") = mysht.Range("G7").Value
'                    .Range("E10") = mysht.Range("E10").Value
'                    .Range("E12") = mysht.Range("E12").Value
                    .Range("E14") = mysht.Range("E14").Value
                    .Range("E18:L18") = mysht.Range("E18:L18").Value
                    .Range("E19:E34") = mysht.Range("E19:E34").Value
                    .Range("E35:Q35") = mysht.Range("E35:Q35").Value
'                    .Protect Password:="2343t"
'                    .Activate
                End With
                
                With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                    .Unprotect Password:="as2343t"
                    .Range("E9") = myshs.Range("E9").Value
                    .Range("G9") = myshs.Range("G9").Value
                    .Range("I9") = myshs.Range("I9").Value
                    .Range("K11") = myshs.Range("K11").Value
                    .Range("N11") = myshs.Range("N11").Value
                    .Range("R11") = myshs.Range("R11").Value
                    .Range("I21") = myshs.Range("I21").Value
                    .Range("L26") = myshs.Range("L26").Value
                    .Range("L27") = myshs.Range("L27").Value
                    .Range("AB17") = myshs.Range("AB17").Value
                    .Range("AB18") = myshs.Range("AB18").Value
                    .Range("AB20") = myshs.Range("AB20").Value
                    .Range("AB23") = myshs.Range("AB23").Value
                    .Range("AB24") = myshs.Range("AB24").Value
                    .Range("AB25") = myshs.Range("AB25").Value
                    .Range("AB26") = myshs.Range("AB26").Value
                    If .Range("AM1").Value = 1 Then
                        .Shapes("maru1").Visible = True
                        .Shapes("maru2").Visible = False
                        .Shapes("maru3").Visible = True
                        .Shapes("maru4").Visible = False
                    Else
                        .Shapes("maru2").Visible = True
                        .Shapes("maru1").Visible = False
                        .Shapes("maru4").Visible = True
                        .Shapes("maru3").Visible = False
                    End If
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                
                 With ThisWorkbook.Worksheets("|fffd|f|fffd|[|fffd|^")
                    .Unprotect Password:="as2343t"
                    
'                    .Range("A1").Value = myshd.Range("A1").Value
'                    myshd.Range("A5:B44").Copy
'                        .Range("A5").PasteSpecial Paste:=xlPasteValues
                    myshd.Range("M5:AZ133").Copy
                        .Range("M5").PasteSpecial Paste:=xlPasteValues
                    
                    Application.CutCopyMode = False
                    
                    '2016/12/14 Ver.1622
'                    Range("M19:AZ21,M64:AZ83").Replace What:="|fffd|Y|fffd||fffd|", Replacement:="1", LookAt:=xlPart, _
'                             SearchOrder:=xlByRows, MatchCase:=False
                    
                    .Protect Password:="as2343t"
                End With
                
                
                
                With ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
                    .Unprotect Password:="as2343t"
                    .Range("A36").Value = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A36").Value  '|fffd|Y|fffd||fffd||fffd|L|fffd||fffd|
                    .Range("A2:D10") = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A2:D10").Value    '|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N Ver.1610
                    
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set mysht = Nothing
                Set myshs = Nothing
                Set myshd = Nothing
            End If
        Else
            MsgBox "|fffd|{|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|V|fffd||fffd||fffd||fffd||fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||303|f|fffd|[|fffd|^|fffd||fffd||835e||fffd||742||342||142||fffd||fffd||702||fffd||fffd||fffd|"
        End If
    Else
        MsgBox "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|A|fffd|b|fffd|v|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{ACB5A3B1-7C1D-407B-8B0F-50F2E8A4D053}{115BD1A8-CC0D-475C-BCDE-72C9668FAE52}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub CheckBox1_Click()
'|fffd||fffd||fffd||fffd|
    If Me.CheckBox1.Value Or Me.CheckBox2.Value Then
            Me.CommandButton1.Enabled = True
    Else
        Me.CommandButton1.Enabled = False
    End If
End Sub

Private Sub CheckBox2_Click()
'|fffd|E|fffd||fffd|
    If Me.CheckBox1.Value Or Me.CheckBox2.Value Then
            Me.CommandButton1.Enabled = True
    Else
        Me.CommandButton1.Enabled = False
    End If
End Sub

Private Sub ComboBox1_Change()
'2009/11/28 Ver.920

    Me.Label4.BackColor = Worksheets("|fffd|r|fffd||fffd|").Cells(Me.ComboBox1.ListIndex + 12, 31).Interior.Color
End Sub

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd|s
'2005/11/18 Ver.520
'2008/11/3 Ver.810
'2009/2/27 Ver.901
'2009/11/27 Ver.920|fffd|@|fffd||292|u|fffd||3cd|X
'2010/1/1 Ver.1000
'2016/11/21 Ver.1610
'2016/11/29 Ver.1614

    Dim i As Long, j As Long, k As Long, n As Long, a As Long
    Dim myArray As Variant, myArray2 As Variant
    Dim ws As Worksheet, ws2 As Worksheet
    
    On Error GoTo myErr
    
    Set ws = Worksheets("|fffd|r|fffd||fffd|")
    Set ws2 = Worksheets("|fffd||4d40f||fffd|")
    
    a = Val(Left(Me.ComboBox1.Value, 2))
    
    Me.Hide
    DoEvents
    Application.ScreenUpdating = False
    
    n = ws.Range("AG65536").End(xlUp).Row
    myArray2 = ws.Range("AG12").Resize(n - 11, 2).Value
    
    ws2.Unprotect Password:="as2343t"
    For j = 1 To 2
        If Me.Controls("CheckBox" & j).Value Then
            
            n = ws.Cells(65536, j).End(xlUp).Row
            myArray = ws.Cells(12, 1).Resize(n - 11, 14).Value
            
            For i = 1 To UBound(myArray)
                If Not IsEmpty(myArray(i, j)) Then
                    With ws2.Range(myArray(i, j))
                        If Not IsEmpty(myArray(i, 3)) Then
                           .Borders(xlEdgeLeft).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 5)) Then
                            .Borders(xlEdgeTop).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 7)) Then
                            .Borders(xlEdgeBottom).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 9)) Then
                            .Borders(xlEdgeRight).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 11)) Then
                            .Borders(xlInsideVertical).ColorIndex = a
                        End If
                        
                        If Not IsEmpty(myArray(i, 13)) Then
                            .Borders(xlInsideHorizontal).ColorIndex = a
                        End If
                    End With
                End If
            Next i
            
            ws2.Range(myArray2(1, j)).SpecialCells(xlCellTypeConstants, 23).Font.ColorIndex = a
            ws2.Range("N45:V45").Font.ColorIndex = 0
            For k = 2 To UBound(myArray2)
                If Not IsEmpty(myArray2(k, j)) Then
                    ws2.Range(myArray2(k, j)).Font.ColorIndex = a
                End If
            Next k
            
            ws2.Shapes("maru" & j).Line.ForeColor.RGB = _
                    Worksheets("|fffd|r|fffd||fffd|").Cells(a + 12, 31).Interior.Color
        End If
    Next j
    
    ws2.Protect Password:="as2343t"
    Application.ScreenUpdating = True
    Set ws = Nothing
    Set ws2 = Nothing
    
    For i = 1 To 2
        Me.Controls("CheckBox" & i).Value = False
    Next i
    
    MsgBox "|fffd|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    Me.Show
'    Unload Me
    Exit Sub
myErr:
    myflg = True
    ws2.Protect Password:="2343t"
    Application.ScreenUpdating = True
    MsgBox "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|" & Chr(13) & _
            "|fffd||fffd||fffd||303|t|fffd|@|fffd|C|fffd||fffd||fffd|i|fffd|u|fffd|b|fffd|N|fffd|j|fffd||fffd||82||fffd||fffd||fffd||fffd||fffd|A|fffd||102||44a|J|fffd||fffd||fffd||103|G|fffd||fffd||fffd|[|fffd||302||fffd||fffd||fffd||fffd||fffd||fffd||348||342||fffd|" & Chr(13) & _
            "|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X|fffd||fffd||fffd||fffd||fffd|s|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|G|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd|"
    Set ws = Nothing
    Set ws2 = Nothing
    
    Unload Me
    
End Sub

Private Sub CommandButton2_Click()
'|fffd|I|fffd||fffd|

    Unload Me
End Sub

Private Sub CommandButton3_Click()
'|fffd|r|fffd||fffd||fffd||fffd||fffd||fffd||fffd||3cd|X
'2008/11/2 Ver.810
'2011/8/20 Ver.1110

    Me.Hide
    
    keisenhutosa
    
    Me.Show
    
     If myflg Then Unload Me
End Sub

Private Sub UserForm_Initialize()
'2018/1/2 Ver.1800

    Me.CommandButton1.Enabled = False
'    Me.Label1.Caption = "|fffd|I|fffd||fffd||348||342||303|t|fffd|H|fffd||fffd||fffd|g|fffd|E|fffd|r|fffd||fffd||fffd||310|F|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B" & vbCrLf & _
'                        "|fffd||3cd|X|fffd||343|u|fffd|b|fffd|N|fffd|I|fffd||fffd||fffd||702||142||30a||502||fffd|1|fffd|`2|fffd||fffd||302||749||94|\|fffd||142||fffd||fffd|B"
    Me.Label1.Caption = "|fffd|I|fffd||fffd||348||342||303|t|fffd|H|fffd||fffd||fffd|g|fffd|E|fffd|r|fffd||fffd||fffd||310|F|fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B"
    Me.ComboBox1.List = Worksheets("|fffd|r|fffd||fffd|").Range("AE12:AE68").Value
    Me.ComboBox1.ListIndex = 0
    Me.Label4.BackColor = RGB(0, 0, 0)
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{31144D2C-EC34-49E8-B1F9-3B5439775292}{B23CB294-0412-4700-8B4E-592CC9651D7D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private myflg As Boolean
'Private myflg2 As Boolean
Private opfg As Boolean

'Private Sub CheckBox6_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("C6").Value = Me.CheckBox6.Value
'        Me.OptionButton7.Enabled = Me.CheckBox6.Value
'        Me.OptionButton8.Enabled = Me.CheckBox6.Value
'    End If
'End Sub

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|s
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615
'2019/11/14 Ver.1910
    
    Dim i As Long, n As Long, m As Variant, k As Variant
    Dim lfg As Boolean
    Dim mytime As Single
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    Application.GoTo Range("A130"), True
    
    Me.CommandButton2.Enabled = True
    Me.CommandButton3.Enabled = False
    Me.CommandButton4.Enabled = False
    Me.CommandButton5.Enabled = False
    Me.CommandButton2.Cancel = True
    Me.Label3.Visible = True
    Me.ListBox1.Enabled = False
    Me.Frame1.Enabled = False
    Me.Frame2.Enabled = False
'    Me.Frame5.Enabled = False
    
'    Me.Hide
'    DoEvents
    
    k = 1
    Me.Label3.Caption = "|fffd||fffd||fffd||fffd||fffd|"
    
    With Worksheets("|fffd||4d40f||fffd|")
        n = .Range("A1").Value
        
        DoEvents
        For i = 0 To Me.ListBox1.ListCount - 1
            If Me.ListBox1.Selected(i) = True Then
                If myflg = True Then
                    MsgBox k & " |fffd||fffd||fffd||688||20d|~|fffd||fffd||fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|B", , "|fffd||fffd||fffd|~"
                    Exit For
                End If
                
                If Me.OptionButton1 Then
                    
                Else
                    .Range("A1").Value = i + 1
                End If
                
                DoEvents
                .PrintOut Copies:=1
'                    .PrintPreview
                Me.Label3.Caption = k & " |fffd||fffd||fffd||688||fffd||fffd||fffd||fffd|"
                DoEvents
                k = k + 1
                
                mytime = Timer + 1
                Do While mytime > Timer
                    DoEvents
                    If myflg Then Exit Do
                Loop
            End If
        Next i
        
        .Range("A1").Value = n
    End With
    
    Me.CommandButton2.Enabled = False
    Me.CommandButton3.Enabled = True
    Me.CommandButton4.Enabled = True
    Me.CommandButton5.Enabled = True
    Me.CommandButton3.Cancel = True
    Me.Label3.Visible = False
    Me.ListBox1.Enabled = True
    Me.Frame1.Enabled = True
    Me.Frame2.Enabled = True
'    Me.Frame5.Enabled = True
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                Me.CommandButton1.Enabled = True
                Exit For
            End If
        Next i
    End With
    
    Application.GoTo Range("A19"), True
    myflg = False
    DoEvents
'    Me.Show
End Sub

Private Sub CommandButton2_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
''|fffd||fffd||fffd||fffd||fffd||fffd|~

    myflg = True
End Sub

Private Sub CommandButton3_Click()

    Unload Me
End Sub

Private Sub CommandButton4_Click()
'|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd||682||fffd||fffd||5c2||111|I|fffd||fffd|

    Dim i As Long
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            .Selected(i) = True
        Next i
    End With
End Sub

Private Sub CommandButton5_Click()
'|fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|r|fffd||fffd||fffd|[
'2005/11/20 Ver.520
'2008/11/10 Ver.810
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615

    Dim i As Long, n As Variant, m As Variant
    Dim a As String
    Dim lfg As Boolean
    
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If .Selected(i) = True Then
                lfg = True
                Exit For
            End If
        Next i
        If lfg = False Then
            MsgBox "|fffd||fffd||fffd|X|fffd|g|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
            Exit Sub
        End If
    End With
    
    Me.Hide
    DoEvents
    ActiveWindow.ScrollColumn = 148
    DoEvents
    
    With Worksheets("|fffd||4d40f||fffd|")
        n = .Range("A1").Value
                
        DoEvents
        If Me.OptionButton1 Then
            
        Else
            .Range("A1").Value = i + 1
        End If
        DoEvents
        .PrintPreview
        
        .Range("A1").Value = n
    End With
    
    ActiveWindow.ScrollColumn = 1
    DoEvents
    
    Me.Show
End Sub

Private Sub ListBox1_Change()
    Dim i As Long
    With Me.ListBox1
        For i = 0 To .ListCount - 1
            If (.Selected(i) = True) Then
                Me.CommandButton1.Enabled = True
                Exit Sub
            End If
        Next i
        Me.CommandButton1.Enabled = False
    End With
End Sub

Private Sub OptionButton1_Click()
'|fffd||fffd||fffd||fffd|@|fffd|\|fffd||fffd||fffd||fffd||fffd||302||fffd|
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615

    
    opfg = False
    
    With Me.ListBox1
        .Clear
        If (Worksheets("|fffd||4d40f||fffd|").Range("A1").Value > 0) And (Worksheets("|fffd|f|fffd|[|fffd|^").Range("A2").Value > 0) Then
            .AddItem Worksheets("|fffd||4d40f||fffd|").Range("B1").Value
        Else
            .AddItem ""
        End If
            .Selected(0) = True
    End With
    opfg = True
End Sub

Private Sub OptionButton2_Click()
'|fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|X|fffd|g|fffd||151|I|fffd||fffd|
'2016/11/21 Ver.1610
'2016/11/29 Ver.1615

    Dim i As Long, n As Long
    
    Me.ListBox1.Clear
    With Worksheets("|fffd|f|fffd|[|fffd|^")
        n = .Range("A65536").End(xlUp).Row
        
        If n > 4 Then
            For i = 5 To n
                If .Cells(i, 1).Value <> "" Then
                    Me.ListBox1.AddItem .Cells(i, 1).Value
                End If
            Next i
        End If
        If Me.ListBox1.ListCount = 0 Then
            Me.ListBox1.AddItem ""
        End If
    End With
End Sub

Private Sub OptionButton3_Click()
'|fffd||fffd||fffd||fffd||348||341|@4|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = True
        .Range("D4").Value = False
        .Range("D5").Value = False
        Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR12").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
            If a Is Nothing Then
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR12").Value
            End If
        End If
    End With
End Sub

Private Sub OptionButton4_Click()
'|fffd||fffd||fffd||fffd||348||341|@|fffd||fffd|2|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = False
        .Range("D4").Value = True
        .Range("D5").Value = False
        Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR13").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
            If a Is Nothing Then
            Else
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR13").Value
            End If
        End If
    End With
End Sub

Private Sub OptionButton5_Click()
'|fffd||fffd||fffd||fffd||348||341|@|fffd||fffd|2|fffd||fffd|
'2016/11/21 Ver.1610

    Dim a As Range
    
    With Worksheets("|fffd||4d40f||fffd|")
        .Range("D3").Value = False
        .Range("D4").Value = False
        .Range("D5").Value = True
        Set a = Application.Intersect(.Range("Print_Area"), .Range("D75"))
        If a Is Nothing Then
            .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR14").Value
        Else
            Set a = Application.Intersect(.Range("Print_Area"), .Range("C21"))
            If a Is Nothing Then
            Else
                .PageSetup.PrintArea = Worksheets("|fffd|r|fffd||fffd|").Range("AR14").Value
            End If
        End If
    End With
End Sub

'Private Sub OptionButton7_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||fffd||fffd||fffd||fffd||939e||fffd||302||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("D7").Value = True
'        Worksheets("|fffd||4d40f||fffd|").Range("D8").Value = False
'    End If
'End Sub
'
'Private Sub OptionButton8_Click()
''|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd||314|N|fffd||fffd||fffd||fffd||fffd|@|fffd||d39e|
''2014/1/09 Ver.1400|fffd|@|fffd||1c9||fffd|
''2016/11/21 Ver.1610
'
'    If myflg2 = False Then
'        Worksheets("|fffd||4d40f||fffd|").Range("D7").Value = False
'        Worksheets("|fffd||4d40f||fffd|").Range("D8").Value = True
'    End If
'End Sub

Private Sub UserForm_Initialize()
'2016/11/21 Ver.1610
'2016/12/3 Ver.1620

    With Me
        opfg = False
        .CommandButton2.Enabled = False
        .CommandButton3.Cancel = True
              
'        myflg2 = True
        
        .OptionButton1.Value = True
        
        If Worksheets("|fffd||4d40f||fffd|").Range("D3").Value = True Then
            .OptionButton3.Value = True
        ElseIf Worksheets("|fffd||4d40f||fffd|").Range("D4").Value = True Then
            .OptionButton4.Value = True
        ElseIf Worksheets("|fffd||4d40f||fffd|").Range("D5").Value = True Then
            .OptionButton5.Value = True
        End If
        
'        .CheckBox6.Value = Worksheets("|fffd||4d40f||fffd|").Range("C6").Value
'        .OptionButton7.Value = Worksheets("|fffd||4d40f||fffd|").Range("D7").Value
'        .OptionButton8.Value = Worksheets("|fffd||4d40f||fffd|").Range("D8").Value
'
'
'        .OptionButton7.Enabled = .CheckBox6.Value
'        .OptionButton8.Enabled = .CheckBox6.Value
'
'        myflg2 = False
        
        opfg = True
        
        .Label1.Caption = "|fffd||fffd||fffd|X|fffd|g|fffd|{|fffd|b|fffd|N|fffd|X|fffd||151|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||30c||fffd||fffd||9294e||fffd||fffd|[|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||702||fffd||fffd|B" & Chr(10) & _
                            "|fffd|K|fffd|v|fffd||fffd||fffd||fffd||fffd||317|p|fffd||fffd||fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(10) & _
                            "|fffd|u|fffd||fffd||fffd||fffd||fffd||fffd|s|fffd|v|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||188||fffd||fffd||fffd||fffd||fffd|J|fffd|n|fffd||fffd||fffd||702||fffd||fffd|B"
    End With
End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{B916FD3A-30CC-48A7-BED3-4220247CCE9B}{48F96CAC-EFDA-4F2A-A56B-246CDB2E6DFF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub CheckBox1_Click()

    If Me.CheckBox1.Value Then
        Me.TextBox1.PasswordChar = ""
        Me.TextBox2.PasswordChar = ""
    Else
        Me.TextBox1.PasswordChar = "*"
        Me.TextBox2.PasswordChar = "*"
    End If
    
End Sub

Private Sub CommandButton1_Click()
'OK

    If Me.TextBox1.Text = Me.TextBox2.Text Then
        Unload Me
        
        Application.DisplayAlerts = False
        ThisWorkbook.SaveAs Filename:=ThisWorkbook.FullName, Password:=Me.TextBox1.Text
        Application.DisplayAlerts = True
    Else
        MsgBox "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & Chr(13) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , "|fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd|m|fffd|F"
        
        Me.TextBox1.Text = ""
        Me.TextBox2.Text = ""
    End If
    
End Sub

Private Sub CommandButton2_Click()
'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|

    Unload Me
End Sub

Private Sub UserForm_Initialize()

    Me.Label1.Caption = "|fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||6cc||c0b7||fffd||90bd||fffd||7c2||313||1c2||74e||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h|fffd||fffd|15|fffd||fffd||fffd||fffd||fffd||213||fffd||fffd||153||fffd||fffd||342||fffd||fffd||702||fffd||fffd|B" & _
            Chr(13) & "|fffd||5576||fffd||fffd||fffd||18f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||282||fffd||fffd||fffd||702||fffd||fffd|B" & _
            Chr(13) & Chr(13) & "|fffd|V|fffd||fffd||fffd||fffd||fffd|p|fffd|X|fffd||fffd||fffd|[|fffd|h"
    
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{396E9AA9-A012-45B3-B2CB-0A7BD585DED0}{163AF96C-9A4B-4FB3-9A7F-0EB27CA29C0B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Dim f2 As Boolean
Dim ln As Long

Private Sub CommandButton1_Click()
'|fffd|o|fffd|^
'2016/12/5 Ver.1621

    Dim i As Long, n As Long
    
    For i = 77 To 101 Step 3
        n = n + CLng(Me.Controls("TextBox" & i).Tag)
        If n > 0 Then Exit For
    Next i
    n = n + CLng(Me.Controls("TextBox112").Tag)
    
    If n > 0 Then
        MsgBox "|fffd||90|l|fffd||50d||fffd||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B", , "|fffd|m|fffd|F"
        Exit Sub
    End If

    f2 = True
    Me.touroku
    f2 = False
    
    Me.hyouji
    
End Sub

Public Sub touroku()
'|fffd|o|fffd|^
'2011/8/20 Ver.1110
'2012/11/12 Ver.1210
'2013/1/10 Ver.1300
'2016/12/3 Ver.1620
'2016/12/13 Ver.1622

    Dim i As Long, n As Long, j As Long, nn As Long
    Dim a As Variant
    Dim b(1 To 129, 1 To 1) As Variant
    
    n = Me.ListBox1.ListIndex
    a = Worksheets("|fffd|f|fffd|[|fffd|^").Range("D5:D133").Value
    
    For i = 1 To 129
        Select Case Left(a(i, 1), 4)
            Case "Text"
                b(i, 1) = Me.Controls(a(i, 1)).Value
            Case "Comb"
                b(i, 1) = Me.Controls(a(i, 1)).Value
            Case Else
                If Me.Controls(a(i, 1)).Value Then
                    b(i, 1) = 1
                Else
                    b(i, 1) = Empty
                End If
        End Select
    Next i
    
    With Worksheets("|fffd|f|fffd|[|fffd|^")
'        .Unprotect Password:="as2343t"
        .Cells(5, n + 13).Resize(129, 1).Value = b
'        .Cells(n + 5, 1).Value = Me.TextBox6.Value
'        .Protect Password:="as2343t"
    End With
    
    Me.ListBox1.ListIndex = n
        
End Sub

Private Sub CommandButton2_Click()
'|fffd|L|fffd||fffd||fffd||fffd||fffd|Z|fffd||fffd|
    
    Me.hyouji
    
End Sub

Private Sub CommandButton3_Click()
'|fffd|I|fffd||fffd|

    Unload Me
    
End Sub

Private Sub CommandButton4_Click()
'|fffd||d3dc|
'2011/8/20 Ver.1110
'2012/11/12 Ver.1210
'2013/1/10 Ver.1300
'2016/12/1 Ver.1620
'2016/12/13 Ver.1622

    Dim n As Long
    
    n = Me.ListBox1.ListIndex
    
    With Worksheets("|fffd|f|fffd|[|fffd|^")
        If MsgBox("|fffd|I|fffd||12182||303|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc||fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbDefaultButton2 + vbYesNo, "|fffd|f|fffd|[|fffd|^|fffd||d3dc||fffd|m|fffd|F") = vbNo Then Exit Sub
        f2 = True
'        .Unprotect Password:="as2343t"
        .Cells(5, n + 13).Resize(129, 1).ClearContents
        .Cells(5, n + 14).Resize(129, 41 - n).Copy
            .Cells(5, n + 13).PasteSpecial Paste:=xlPasteValues
        .Cells(5, n + 13).Value = n + 1
        .Cells(5, n + 13).Select
'        .Protect Password:="as2343t"
    End With
    
    Me.ListBox1.ListIndex = n
    f2 = False
    
    Me.hyouji
    
End Sub

Private Sub CommandButton5_Click()
'|fffd|l|fffd||303|N|fffd||fffd||fffd|A|fffd|[
'2011/8/20 Ver.1110
'2012/11/12 Ver.1210
'2016/12/1 Ver.1620

    Dim i As Long
    
    For i = 1 To 42
        Me.Controls("TextBox" & i).Value = ""
    Next i
    
    For i = 59 To 113
        Me.Controls("TextBox" & i).Value = ""
    Next i
    
    For i = 1 To 11
        Me.Controls("ComboBox" & i).Value = ""
    Next i
    
    For i = 1 To 16
        Me.Controls("CheckBox" & i).Value = False
    Next i
    
    For i = 1 To 4
        Me.Controls("OptionButton" & i).Value = False
    Next i
    
End Sub

Private Sub CommandButton7_Click()
'|fffd|O|fffd||596||7c2||fffd|

    Dim n As Long
    
    f2 = True
    
    With Me.ListBox1
        n = .ListIndex
        
        Me.henkoukakunin
        
        If n > 0 Then
            .ListIndex = n - 1
            ln = n - 1
        End If
    End With
    
    f2 = False
    
    Me.hyouji
    
End Sub

Private Sub CommandButton7_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd|O|fffd||596||7c2||fffd|

    Dim n As Long
    
    f2 = True
    
    With Me.ListBox1
        n = .ListIndex
        
        Me.henkoukakunin
        
        If n > 0 Then
            .ListIndex = n - 1
            ln = n - 1
        End If
    End With
    
    f2 = False
    
    Me.hyouji
    
End Sub

Private Sub CommandButton8_Click()
'|fffd||fffd||fffd||590|i|fffd||fffd|

    Dim n As Long
    
    f2 = True
    
    With Me.ListBox1
        n = .ListIndex
        
        Me.henkoukakunin
        
        If n + 1 < .ListCount Then
            .ListIndex = n + 1
            ln = n + 1
        End If
    End With
    
    f2 = False
    
    Me.hyouji
    
End Sub

Private Sub CommandButton8_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||590|i|fffd||fffd|

    Dim n As Long
    
    f2 = True
    
    With Me.ListBox1
        n = .ListIndex
        
        Me.henkoukakunin
        
        If n + 1 < .ListCount Then
            .ListIndex = n + 1
            ln = n + 1
        End If
    End With
    
    f2 = False
    
    Me.hyouji
    
End Sub

Private Sub CommandButton9_Click()
'|fffd||fffd||fffd|

    Me.Frame1.Top = 0
    If Me.Frame1.ActiveControl.TabIndex > 62 Then Me.TextBox1.SetFocus
End Sub

Private Sub CommandButton10_Click()
'|fffd||fffd||fffd||fffd|

    Me.Frame1.Top = -370
    If Me.Frame1.ActiveControl.TabIndex < 39 Then Me.TextBox36.SetFocus
End Sub

Private Sub ListBox1_Click()
'2016/12/1 Ver.1620

    Dim n As Long
    
    If f2 Then Exit Sub
    
    n = Me.ListBox1.ListIndex
    
    If n <> ln Then
        f2 = True
        Me.ListBox1.ListIndex = ln
        
        Me.henkoukakunin
        
        Me.ListBox1.ListIndex = n
        ln = n
        f2 = False
    End If
    
    Me.hyouji
    
End Sub

Public Sub hyouji()

'2011/8/20 Ver.1110
'2012/11/12 Ver.1210
'2013/1/10 Ver.1300
'2016/12/1 Ver.1620
'2016/12/13 Ver.1622

    Dim i As Long, n As Long, k As Long
    Dim s As String
    Dim a As Variant, b As Variant
    
    n = Me.ListBox1.ListIndex
    a = Worksheets("|fffd|f|fffd|[|fffd|^").Range("D5:D133").Value
    b = Worksheets("|fffd|f|fffd|[|fffd|^").Cells(5, n + 13).Resize(129, 1).Value
    Me.Label1.Caption = "|fffd|o|fffd|^ No." & n + 1
    
    For i = 1 To 129
        Select Case Left(a(i, 1), 4)
            Case "Text"
                Select Case Val(Mid(a(i, 1), 8))
                    Case 8 To 14, 25 To 31, 35 To 37, 60 To 63, 73 To 74
                        Me.Controls(a(i, 1)).Value = Format(b(i, 1), "#,##0")
                    Case Else
                        Me.Controls(a(i, 1)).Value = b(i, 1)
                End Select
            Case "Comb"
                Me.Controls(a(i, 1)).Value = b(i, 1)
            Case Else
                If b(i, 1) = 1 Then
                    Me.Controls(a(i, 1)).Value = True
                Else
                    Me.Controls(a(i, 1)).Value = False
                End If
        End Select
    Next i
    
End Sub

Public Sub henkoukakunin()

'2011/8/20 Ver.1110
'2012/11/12 Ver.1210
'2016/12/1 Ver.1620
'2016/12/13 Ver.1622
'2016/12/14 Ver.1623

    Dim i As Long, n As Long, k As Long
    Dim s As String
    Dim a As Variant, b As Variant
    Dim f As Boolean
    
    n = Me.ListBox1.ListIndex
    a = Worksheets("|fffd|f|fffd|[|fffd|^").Range("D6:D133").Value
    b = Worksheets("|fffd|f|fffd|[|fffd|^").Cells(6, n + 13).Resize(129, 1).Value
    
    For i = 1 To 128
        Select Case Left(a(i, 1), 4)
            Case "Text"
                Select Case Val(Mid(a(i, 1), 8))
                    Case 8 To 14, 25 To 31, 35 To 37, 60 To 63, 73 To 74
                        If Me.Controls(a(i, 1)).Value <> Format(b(i, 1), "#,##0") Then
                            f = True
                            Exit For
                        End If
                    Case Else
                        If Me.Controls(a(i, 1)).Value <> CStr(b(i, 1)) Then
                            f = True
                            Exit For
                        End If
                End Select
            Case "Comb"
                If Me.Controls(a(i, 1)).Value <> b(i, 1) Then
                    f = True
                    Exit For
                End If
            Case Else
                If b(i, 1) = 1 Then
                    If Me.Controls(a(i, 1)).Value = False Then
                        f = True
                        Exit For
                    End If
                Else
                    If Me.Controls(a(i, 1)).Value = True Then
                        f = True
                        Exit For
                    End If
                End If
        End Select
    Next i
    
    If f Then
        If MsgBox("|fffd||3cd|X|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & vbCrLf & "|fffd|o|fffd|^|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", vbYesNo, "|fffd|o|fffd|^|fffd|m|fffd|F") = vbYes Then
            Me.touroku
        End If
    End If
        
End Sub

Private Sub TextBox3_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||cb2ce||494||50d||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox8_Enter()
'|fffd|x|fffd||fffd||fffd||fffd||fffd|z|fffd|@|fffd||fffd|

    With Me.TextBox8
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox8_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox8
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox8_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox9_Enter()
'|fffd|x|fffd||fffd||fffd||fffd||fffd|z

    With Me.TextBox9
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox9_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox9
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox9_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox10_Enter()
'|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox10
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox10_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox10
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox10_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox11_Enter()
'|fffd||fffd||fffd|^|fffd||fffd||fffd||fffd||fffd|T|fffd||fffd||fffd||30a|z|fffd||30d||fffd||fffd|v|fffd|z

    With Me.TextBox11
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox11_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox11
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox11_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox12_Enter()
'|fffd||fffd||fffd||9294e||fffd||fffd||14a|z|fffd|@|fffd||fffd|

    With Me.TextBox12
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox12_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox12
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox12_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox13_Enter()
'|fffd||fffd||fffd||9294e||fffd||fffd||14a|z

    With Me.TextBox13
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox13_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox13
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox13_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox14_Enter()
'|fffd|z|fffd||fffd||493||fffd||fffd||28d|T|fffd||fffd||fffd||30a|z

    With Me.TextBox14
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox14_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox14
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox14_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox15_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd||fffd||fffd||fffd|@|fffd|l

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox16_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd||fffd||fffd||fffd|@|fffd|]

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox17_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd|V|fffd|l|fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox18_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd|V|fffd|l |fffd|l

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox19_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd|V|fffd|l|fffd|@|fffd|]

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox20_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd||fffd||fffd||311||fffd||fffd|@|fffd|l

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox21_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd||fffd|@|fffd||fffd||fffd||311||fffd||fffd|@|fffd|]

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox22_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd|Q|fffd||482||310||fffd||fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox23_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd|Q|fffd||482||310||fffd||fffd|@|fffd|l

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox24_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd|Q|fffd||482||310||fffd||fffd|@|fffd||fffd||fffd||311||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox25_Enter()
'|fffd||409||fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd|z|fffd|@|fffd||fffd|

    With Me.TextBox25
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox25_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox25
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox25_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox26_Enter()
'|fffd||409||fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox26
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox26_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox26
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox26_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox27_Enter()
'|fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd|z

    With Me.TextBox27
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox27_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox27
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox27_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox28_Enter()
'|fffd|n|fffd|k|fffd||6cc||fffd||fffd||fffd||fffd||30d|T|fffd||fffd||fffd|z

    With Me.TextBox28
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox28_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox28
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox28_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox29_Enter()
'|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd||30a|z

    With Me.TextBox29
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox29_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox29
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox29_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox30_Enter()
'|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||28d|T|fffd||fffd||fffd||94|\|fffd|z

    With Me.TextBox30
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox30_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox30
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox30_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox31_Enter()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox31
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox31_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox31
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox31_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox32_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox35_Enter()
'|fffd|z|fffd||fffd||482||30d||fffd||fffd|v|fffd||fffd||fffd||fffd|

    With Me.TextBox35
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox35_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox35
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox35_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox36_Enter()
'|fffd|V|fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox36
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox36_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox36
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox36_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox37_Enter()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox37
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox37_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox37
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox37_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox38_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd|@|fffd||fffd|

    If Val(Me.TextBox38.Text) > 12 Then Cancel = True
End Sub

Private Sub TextBox38_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox38.Text) > 1 And Me.TextBox38.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox39_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd|@|fffd||fffd|

    If Val(Me.TextBox39.Text) > 31 Then Cancel = True
End Sub

Private Sub TextBox39_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox39.Text) > 1 And Me.TextBox39.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox40_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd|N

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox40.Text) > 1 And Me.TextBox40.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox41_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd|

    If Val(Me.TextBox41.Text) > 12 Then Cancel = True
End Sub

Private Sub TextBox41_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox41.Text) > 1 And Me.TextBox41.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox42_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd|

    If Val(Me.TextBox42.Text) > 31 Then Cancel = True
End Sub

Private Sub TextBox42_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox42.Text) > 1 And Me.TextBox42.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox59_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'16|fffd||396||fffd||fffd||fffd||fffd|}|fffd|{|fffd|e|fffd||fffd||fffd||310||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox60_Enter()
'|fffd||fffd||fffd||fffd||d5||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox60
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox60_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox60
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox60_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox61_Enter()
'|fffd|V|fffd||90|l|fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox61
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox61_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox61
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox61_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox62_Enter()
'|fffd||fffd||fffd||90|l|fffd|N|fffd||fffd||fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox62
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox62_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox62
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox62_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox63_Enter()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Q|fffd||6cc||fffd||fffd||fffd||fffd||30b||fffd||fffd|z

    With Me.TextBox63
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox63_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox63
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox63_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox64_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||4b3cf|Z|fffd||482||142||fffd||fffd||fffd|e|fffd||fffd||fffd||310||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox65_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd|N 1|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox65.Text) > 1 And Me.TextBox65.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox66_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 1|fffd||fffd||fffd|

    If Val(Me.TextBox66.Text) > 12 Then Cancel = True
End Sub

Private Sub TextBox66_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 1|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox66.Text) > 1 And Me.TextBox66.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox67_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 1|fffd||fffd||fffd|

    If Val(Me.TextBox67.Text) > 31 Then Cancel = True
End Sub

Private Sub TextBox67_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 1|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox67.Text) > 1 And Me.TextBox67.SelLength = 0 Then KeyAscii = 0
End Sub
Private Sub TextBox68_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd|N 2|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox68.Text) > 1 And Me.TextBox68.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox69_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 2|fffd||fffd||fffd|

    If Val(Me.TextBox69.Text) > 12 Then Cancel = True
End Sub

Private Sub TextBox69_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 2|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox69.Text) > 1 And Me.TextBox69.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox70_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 2|fffd||fffd||fffd|

    If Val(Me.TextBox70.Text) > 31 Then Cancel = True
End Sub

Private Sub TextBox70_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|Z|fffd|J|fffd|n|fffd|N|fffd||fffd||fffd||fffd||fffd|@|fffd||fffd| 2|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox70.Text) > 1 And Me.TextBox70.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub TextBox73_Enter()
'|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|c|fffd||fffd| 1|fffd||fffd||fffd|

    With Me.TextBox73
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox73_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox73
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox73_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox74_Enter()
'|fffd|Z|fffd||fffd||613||fffd||fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd|c|fffd||fffd||fffd|@2|fffd||fffd||fffd|

    With Me.TextBox74
        .Text = Format(.Text, "0")
    End With
End Sub

Private Sub TextBox74_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    With Me.TextBox74
        .Text = Format(.Text, "#,##0")
    End With
End Sub

Private Sub TextBox74_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox77_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox77"
End Sub

Private Sub TextBox77_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|T|fffd||fffd||fffd||38f||6d4|z|fffd||fffd||fffd|

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox80_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox80"
End Sub

Private Sub TextBox80_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|T|fffd||fffd||fffd||38f||6d5|}|fffd|{|fffd|e|fffd||fffd| 1

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox83_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox83"
End Sub

Private Sub TextBox83_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|T|fffd||fffd||fffd||38f||6d5|}|fffd|{|fffd|e|fffd||fffd| 2

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox86_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox86"
End Sub

Private Sub TextBox86_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|T|fffd||fffd||fffd||38f||6d5|}|fffd|{|fffd|e|fffd||fffd| 3

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox89_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox89"
End Sub

Private Sub TextBox89_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|T|fffd||fffd||fffd||38f||6d5|}|fffd|{|fffd|e|fffd||fffd| 4

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox92_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox92"
End Sub

Private Sub TextBox92_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| 16|fffd||396||fffd||fffd||fffd||fffd||315|}|fffd|{|fffd|e|fffd||fffd| 1

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox95_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox95"
End Sub

Private Sub TextBox95_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| 16|fffd||396||fffd||fffd||fffd||fffd||315|}|fffd|{|fffd|e|fffd||fffd||fffd||fffd| 2

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox98_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox98"
End Sub

Private Sub TextBox98_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| 16|fffd||396||fffd||fffd||fffd||fffd||315|}|fffd|{|fffd|e|fffd||fffd| 3

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox101_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox101"
End Sub

Private Sub TextBox101_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| 16|fffd||396||fffd||fffd||fffd||fffd||315|}|fffd|{|fffd|e|fffd||fffd| 4

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub TextBox112_Change()
'2016/12/5 Ver.1621

    checkdigit_intcolor "TextBox112"
End Sub

Private Sub TextBox112_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||90|l|fffd||50d||fffd| |fffd|x|fffd||fffd||fffd||fffd||fffd||c2bc2||fffd||fffd| 1

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
End Sub

Private Sub checkdigit_intcolor(mytextbox As String)

    Dim mynumber As String
    Dim digits As String
    Dim chkDigit As String
    Dim cd As Integer
    Dim i As Long, n As Long, pn As Long, qn As Long, m As Long
    Dim sum1 As Long
    
    mynumber = Me.Controls(mytextbox).Text
    cd = -1

    ' 12|fffd||fffd||fffd||142||202||fffd||fffd||fffd||396||fffd||fffd||fffd|
    If Len(mynumber) = 0 Then
        Me.Controls(mytextbox).BackColor = RGB(204, 255, 204)
        Me.Controls(mytextbox).Tag = 0
    ElseIf Len(mynumber) <> 12 Then
        Me.Controls(mytextbox).BackColor = RGB(255, 204, 0)
        Me.Controls(mytextbox).Tag = 1
    Else
        
        ' |fffd|`|fffd|F|fffd|b|fffd|N|fffd|f|fffd|W|fffd|b|fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|o|fffd||fffd|
        chkDigit = Right(mynumber, 1)
        
        ' |fffd|}|fffd|C|fffd|i|fffd||fffd||fffd|o|fffd|[11|fffd||fffd||fffd||fffd|o|fffd||fffd|
        digits = Left(mynumber, 11)
        
        sum1 = 0
        
        For n = 1 To 11
            ' n|fffd||fffd||fffd||682||310||fffd||fffd||fffd|
            ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd|Z(|fffd||fffd||fffd||fffd||fffd|p|fffd||fffd||fffd||fffd||fffd||20a|O|fffd||30f|\|fffd||a305||fffd||314||50d||fffd||fffd||30d||149||fffd||fffd||282||30c||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd|)
            pn = CInt(Mid(digits, 11 - n + 1, 1))
            
            If n <= 6 Then
                qn = n + 1
            Else
                qn = n - 5
            End If
            
            sum1 = sum1 + pn * qn
        Next
        
        m = sum1 Mod 11
    
        ' |fffd|in=1|fffd|i|fffd|V|fffd|O|fffd|}|fffd|j11|fffd|i|fffd|o|fffd||fffd||fffd|~|fffd|p|fffd||fffd||fffd|j|fffd|j|fffd||fffd|11|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||8045|1|fffd||30f||a347||fffd||341|A0|fffd||182||fffd||fffd||fffd|
        If m <= 1 Then
            cd = 0
        ' 11-|fffd|in=1|fffd|i|fffd|V|fffd|O|fffd|}|fffd|j11|fffd|i|fffd|o|fffd||fffd||fffd|~|fffd|p|fffd||fffd||fffd|j|fffd|j|fffd||fffd|11|fffd||14f||fffd||fffd||fffd||fffd||fffd||fffd|]|fffd||fffd|j
        Else
            cd = 11 - m
        End If
    
        If (cd = chkDigit) Then
            Me.Controls(mytextbox).BackColor = RGB(0, 255, 255)
            Me.Controls(mytextbox).Tag = 0
        Else
            Me.Controls(mytextbox).BackColor = RGB(255, 204, 0)
            Me.Controls(mytextbox).Tag = 1
        End If
    End If
    
    n = 0
    For i = 77 To 101 Step 3
        n = n + CLng(Me.Controls("TextBox" & i).Tag)
        If n > 0 Then Exit For
    Next i
    n = n + CLng(Me.Controls("TextBox112").Tag)
    
    If n > 0 Then
        Me.CommandButton1.Enabled = False
        Me.CommandButton7.Enabled = False
        Me.CommandButton8.Enabled = False
        Me.ListBox1.Enabled = False
    Else
        Me.CommandButton1.Enabled = True
        Me.CommandButton7.Enabled = True
        Me.CommandButton8.Enabled = True
        Me.ListBox1.Enabled = True
    End If
    
End Sub

Private Sub TextBox113_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd|r|fffd|A|fffd|E|fffd||790|E|fffd|@|fffd|N

    If (KeyAscii < Asc(0)) Or (KeyAscii > Asc(9)) Then KeyAscii = 0
    If Len(Me.TextBox113.Text) > 1 And Me.TextBox113.SelLength = 0 Then KeyAscii = 0
End Sub

Private Sub UserForm_Initialize()
'2011/1/7 Ver.1200
'2016/12/1 Ver.1620
'2016/12/5 Ver.1621

    Dim i As Long, n As Long
    
    For i = 77 To 101 Step 3
        Me.Controls("TextBox" & i).Tag = 0
        Me.Controls("TextBox" & i).ControlTipText = "|fffd||50d||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd|@|fffd||81|FOK|fffd|A|fffd|S|fffd||fffd||fffd|h|fffd|FNG"
    Next i
    Me.Controls("TextBox112").Tag = 0
    Me.Controls("TextBox112").ControlTipText = "|fffd||50d||fffd||fffd||fffd||fffd||343|`|fffd|F|fffd|b|fffd|N|fffd|@|fffd||81|FOK|fffd|A|fffd|S|fffd||fffd||fffd|h|fffd|FNG"
    
    ln = 0
    
    Me.ListBox1.ListIndex = ln
    Me.Label1.Caption = "|fffd|o|fffd|^ No." & ln + 1

    With Worksheets("|fffd|g|fffd|b|fffd|v")
        Me.TextBox43.Value = .Range("E20").Value
        Me.TextBox44.Value = .Range("E23").Value
        Me.TextBox45.Value = .Range("E26").Value & "-" & .Range("E27").Value

        For i = 1 To 13
            Me.Controls("TextBox" & i + 45).Value = .Cells(35, i + 4).Value
        Next i
    End With

    Me.ComboBox1.List = Worksheets("|fffd|f|fffd|[|fffd|^").Range("C6:C14").Value
    Me.ComboBox2.List = Worksheets("|fffd|f|fffd|[|fffd|^").Range("C6:C14").Value
    
    For i = 3 To 11
        Me.Controls("ComboBox" & i).AddItem ""
        Me.Controls("ComboBox" & i).AddItem "|fffd||fffd|"
    Next i

    Static myTxtBoxRClkHdlClsArray() As TextBoxRightClickHdlClass
    Dim myCtrl As MSForms.Control
    Dim myCnt As Long
    For Each myCtrl In Controls
        If TypeOf myCtrl Is MSForms.TextBox Then
            Select Case VBA.CLng(VBA.Mid(myCtrl.Name, 8))
                Case 1 To 2, 4 To 7, 33 To 34, 71 To 72
                    myCnt = myCnt + 1
                    ReDim Preserve myTxtBoxRClkHdlClsArray(1 To myCnt) As TextBoxRightClickHdlClass
                    Set myTxtBoxRClkHdlClsArray(myCnt) = New TextBoxRightClickHdlClass
                    myTxtBoxRClkHdlClsArray(myCnt).Init myCtrl
            End Select
        End If
    Next

End Sub

Attribute VB_Name = "insatuiti"
Option Private Module
Option Explicit

Sub tyuuouiti()
'2016/11/19 Ver.1610

    Dim a As Double, b As Double
    Dim c As String, d As String
    Dim k As Long, n As Long
    
    b = Range("A31").Value
    c = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
        "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
    d = "|fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|"
        
    a = Application.InputBox(Prompt:=c, Title:=d, Default:=b, Type:=1)
    
    If a > 0 And a <= 20 Then
        ActiveSheet.Unprotect Password:="as2343t"
        Rows(29).RowHeight = a / 0.306
        Range("A31").Value = WorksheetFunction.Round(a, 1)
        ActiveSheet.Protect Password:="as2343t"
    ElseIf a <> 0 Then
        MsgBox "|fffd|l|fffd||fffd||fffd||348||353||fffd||fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub

Sub hidariiti()
'2016/11/19 Ver.1610

    Dim a As Double, b As Double
    Dim c As String, d As String
    Dim k As Long, n As Long
    
    k = Range("A7").Value
    n = ActiveSheet.Buttons(Application.Caller).TopLeftCell.Column
    
    If n < 20 Then
        b = Range("A29").Value
        c = "|fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
        d = "|fffd||fffd||fffd||292|u|fffd||fffd||fffd||fffd|"
    Else
        b = Range("A31").Value
        c = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|}|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd|i0.1|fffd|j|fffd||fffd||fffd||fffd|i20|fffd|j|fffd||702||142||312|l|fffd|B|fffd|i|fffd|P|fffd||283|~|fffd||fffd||fffd||fffd||fffd|[|fffd|g|fffd||fffd||fffd|j"
        d = "|fffd||fffd||fffd||fffd||fffd|]|fffd||fffd||fffd||fffd||fffd||fffd|"
    End If
        
    a = Application.InputBox(Prompt:=c, Title:=d, Default:=b, Type:=1)
    
    If a > 0 And a <= 20 Then
        ActiveSheet.Unprotect Password:="as2343t"
        If n < 20 Then
            Columns("B").ColumnWidth = a * 0.86
            Range("A29").Value = WorksheetFunction.Round(a, 1)
        Else
            Columns("BX").ColumnWidth = a * 0.86
            Range("A31").Value = WorksheetFunction.Round(a, 1)
        End If
        ActiveSheet.Protect Password:="as2343t"
        
    ElseIf a <> 0 Then
        MsgBox "|fffd|l|fffd||fffd||fffd||348||353||fffd||fffd||242||fffd||fffd||fffd||702||fffd||fffd||fffd|"
    End If
    
End Sub

Attribute VB_Name = "keisenirohenkou"
Option Private Module
Option Explicit

Public myflg As Boolean

Sub keiseniro()
'2003/5/22
'2010/1/1 Ver.1000

'    If MsgBox("|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X|fffd||343|u|fffd|b|fffd|N|fffd|I|fffd||fffd||fffd||702||142||30a||502||fffd|1|fffd|`2|fffd||fffd||302||749||94|\|fffd||142||fffd||fffd|B" & Chr(13) & Chr(13) & _
'            "|fffd||fffd||fffd|s|fffd||fffd||fffd||702||fffd||fffd||fffd||fffd|H", _
'            vbOKCancel, "|fffd|r|fffd||fffd||fffd|E|fffd|t|fffd|H|fffd||fffd||fffd|g|fffd|F|fffd||3cd|X") = vbOK Then
        UserForm1.Show
'    End If
End Sub

Sub keisenhutosa()
'2017/7/7 H29
'2018/3/29 H30

    Dim myWeight As Variant
    Dim k As Long
mylabel:
    myWeight = Application.InputBox("|fffd||fffd|2|fffd||fffd||fffd||30c|r|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||702||fffd||fffd|B" & Chr(13) & _
            "|fffd|r|fffd||fffd||fffd||311||fffd||fffd||fffd||fffd||fffd||fffd|w|fffd||80b5||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B" & Chr(13) & _
            "|fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||24d||5d0||fffd||fffd|A 2 |fffd||5d0||fffd| |fffd||142||fffd||fffd|B", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd|")
    If VarType(myWeight) = vbBoolean Then
        Exit Sub
    ElseIf myWeight = "1" Or myWeight = "|fffd|P" Then
        k = 1
    ElseIf myWeight = "2" Or myWeight = "|fffd|Q" Then
        k = 2
    Else
        MsgBox "|fffd||fffd||fffd||30e|w|fffd||80aa||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd|B" & Chr(13) & "|fffd||fffd||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "|fffd|m|fffd|F"
        GoTo mylabel
    End If

    
    Dim i As Long, j As Long, n As Long
    Dim myArray As Variant
    Dim ws As Worksheet, ws2 As Worksheet
'    Const k As Long = 1     '|fffd||24d||5d0||fffd|
'    Const k As Long = 2     '|fffd||5d0||fffd|
    
    Set ws = ThisWorkbook.Worksheets("|fffd|r|fffd||fffd|")
    Set ws2 = ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
    
    Application.ScreenUpdating = False
    ws2.Unprotect Password:="as2343t"
    
    For j = 1 To 2
        Select Case j
            Case 1
                n = ws.Cells(65536, 16).End(xlUp).Row
                myArray = ws.Cells(12, 16).Resize(n - 11, 14).Value
            Case 2
                n = ws.Cells(65536, 17).End(xlUp).Row
                myArray = ws.Cells(12, 16).Resize(n - 11, 14).Value
        End Select
        
        For i = 1 To UBound(myArray)
            If Not IsEmpty(myArray(i, j)) Then
                With ws2.Range(myArray(i, j))
                    If Not IsEmpty(myArray(i, 3)) Then
                        With .Borders(xlEdgeLeft)
                            .LineStyle = myArray(i, 3)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 4)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 5)) Then
                        With .Borders(xlEdgeTop)
                            .LineStyle = myArray(i, 5)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 6)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 7)) Then
                        With .Borders(xlEdgeBottom)
                            .LineStyle = myArray(i, 7)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 8)
                            End If
                        End With
                    End If
                    
                    If Not IsEmpty(myArray(i, 9)) Then
                        With .Borders(xlEdgeRight)
                            .LineStyle = myArray(i, 9)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 10)
                            End If
                        End With
                    End If
                    
'                    If Not IsEmpty(myArray(i, 11)) Then
'                        With .Borders(xlInsideVertical)
'                            .LineStyle = myArray(i, 11)
'                            If k = 2 Then
'                                .Weight = k
'                            Else
'                                .Weight = myArray(i, 12)
'                            End If
'                        End With
'                    End If
'
'                    If Not IsEmpty(myArray(i, 13)) Then
'                        With .Borders(xlInsideHorizontal)
'                            .LineStyle = myArray(i, 13)
'                            If k = 2 Then
'                                .Weight = k
'                            Else
'                                .Weight = myArray(i, 14)
'                            End If
'                        End With
'                    End If
                    
                End With
            End If
        Next i
    Next j
    
    n = ws.Range("BB65536").End(xlUp).Row
    myArray = ws.Range("BB12").Resize(n - 11, 4).Value
    
    For j = 1 To 2
        For i = 1 To UBound(myArray)
            If Not IsEmpty(myArray(i, j)) Then
                With ws2.Range(myArray(i, j))
                    If Not IsEmpty(myArray(i, 3)) Then
                        With .Borders(xlDiagonalUp)
                            .LineStyle = myArray(i, 3)
                            If k = 2 Then
                                .Weight = k
                            Else
                                .Weight = myArray(i, 4)
                            End If
                        End With
                    End If
                End With
            End If
        Next i
    Next j
    
    n = ws.Range("AL65536").End(xlUp).Row
    myArray = ws.Range("AL12").Resize(n - 11, 5).Value
    
    For i = 1 To UBound(myArray)
        With ws2.Range(myArray(i, 1))
            If Not IsEmpty(myArray(i, 2)) Then
                With .Borders(xlEdgeLeft)
                    .LineStyle = myArray(i, 2)
                    .Weight = k
                End With
            End If
            
            If Not IsEmpty(myArray(i, 4)) Then
                With .Borders(xlEdgeTop)
                    .LineStyle = myArray(i, 4)
                    .Weight = k
                End With
            End If
        End With
    Next i
    
    ws2.Protect Password:="as2343t"
    Application.ScreenUpdating = True
        
    Set ws = Nothing
    Set ws2 = Nothing
End Sub


Attribute VB_Name = "sheetselect"
Option Private Module
Option Explicit

'Public mybk As String

Sub herupu()
'2003/5/24
'2016/12/3 Ver.1620

    Dim mybk As String
    mybk = ActiveSheet.Name
    With Worksheets("|fffd|w|fffd||fffd||fffd|v")
        .Select
        .Range("D6").Value = mybk
    End With
    
End Sub

Sub modoru()
    Worksheets(Range("D6").Value).Select
End Sub

Sub main()
    Worksheets("|fffd|g|fffd|b|fffd|v").Select
    Range("A5").Select
End Sub

Sub houkokusyo()
    Worksheets("|fffd||4d40f||fffd|").Select
    Range("A19").Select
End Sub

Sub soukatuhyou()
    Worksheets("|fffd||fffd||fffd||fffd||fffd|\").Select
    Range("A4").Select
End Sub

Sub tyousyuubokakunin()
'2016/12/3

    Worksheets("|fffd|f|fffd|[|fffd|^").Select
End Sub

Sub insatu()
'2010/1/1 Ver.1000
'2016/11/19 Ver.1610

    With ActiveSheet
'        If .Name = "|fffd||fffd||fffd||68b|L|fffd||fffd||fffd|f|fffd|[|fffd|^" Then
'            .Range("B1").Value = 1
'            .PrintPreview
'            .Range("B1").ClearContents
'        Else
            .PrintPreview
'        End If
    End With
End Sub

Sub insatusettei()
'2004/1/27 Ver.400

    UserForm2.Show
End Sub

Sub data_nyuuryoku()
'2010/1/1 Ver.1000
'2016/12/3 Ver.1620

    UserForm4.Show
End Sub

Attribute VB_Name = "soukatu_kubun"
Option Explicit
Option Private Module

Sub kubun()
'2005/11/23 Ver.520

    With Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
        .Unprotect Password:="as2343t"
        If .Range("AM1").Value = 1 Then
            .Shapes("maru1").Visible = True
            .Shapes("maru2").Visible = False
            .Shapes("maru3").Visible = True
            .Shapes("maru4").Visible = False
        Else
            .Shapes("maru2").Visible = True
            .Shapes("maru1").Visible = False
            .Shapes("maru4").Visible = True
            .Shapes("maru3").Visible = False
        End If
        .Protect Password:="as2343t"
    End With
End Sub
Attribute VB_Name = "top_gen"
Option Private Module
Option Explicit


Sub passhozon()

    DoEvents
    UserForm3.Show
End Sub
Attribute VB_Name = "top_nenkousin"
Option Explicit
Option Private Module

Sub nendokousin()
'2017/1/8 Ver.1700
'2018/1/2 Ver.1800
'2018/11/11 Ver.1811
'2019/1/2 Ver.1900
    
    Dim e As String, f As String, gn As String, hn As String
    Dim g As Long, h As Long
    Dim i As Long, n As Long
    Dim myMsg As String
    Dim mysht As Worksheet, myshs As Worksheet, myshd As Worksheet
    Dim myBook As Workbook
    
    Application.ScreenUpdating = False
    
    With ThisWorkbook
        e = .Name
        g = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
        gn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
    End With
    
    On Error Resume Next
    
    For Each myBook In Workbooks
        If myBook.Name <> e And myBook.Name <> "PERSONAL.XLS" Then
            With myBook
                hn = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C6").Value
                If hn = "|fffd||fffd||fffd||fffd||fffd|[30" Then                         '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
                    f = myBook.Name
                    h = .Worksheets("|fffd|w|fffd||fffd||fffd|v").Range("C5").Value
                    Exit For
                End If
            End With
        End If
    Next
    
    ThisWorkbook.Activate
    
    On Error GoTo 0
    If hn = "|fffd||fffd||fffd||fffd||fffd|[30" Then                                     '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||30e||fffd||fffd||296||fffd|
        If h >= 1800 And h < 1900 Then                           '|fffd||fffd||fffd|u|fffd|b|fffd|N|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd|
            myMsg = f & "|fffd|@|fffd||fffd|" & Chr(13) & _
                    e & "|fffd||24e||fffd||835e||fffd||742||702||fffd||fffd||fffd||fffd|H"
            If MsgBox(myMsg, vbYesNo, "|fffd|N|fffd|x|fffd|X|fffd|V|fffd|m|fffd|F") = vbYes Then
                
                Set mysht = Workbooks(f).Worksheets("|fffd|g|fffd|b|fffd|v")
                Set myshs = Workbooks(f).Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
                Set myshd = Workbooks(f).Worksheets("|fffd|f|fffd|[|fffd|^")
                
                Application.ScreenUpdating = False
                                
                With ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v")
'                    .Unprotect Password:="2343t"
'                    .Range("G7") = mysht.Range("G7").Value
'                    .Range("E10") = mysht.Range("E10").Value
'                    .Range("E12") = mysht.Range("E12").Value
                    .Range("E14") = mysht.Range("E14").Value
                    .Range("E18:L18") = mysht.Range("E18:L18").Value
                    .Range("E19:E34") = mysht.Range("E19:E34").Value
                    .Range("E35:Q35") = mysht.Range("E35:Q35").Value
'                    .Protect Password:="2343t"
'                    .Activate
                End With
                
                With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|\")
'                    .Unprotect Password:="as2343t"
'                    .Range("E9") = myshs.Range("E9").Value
'                    .Range("G9") = myshs.Range("G9").Value
'                    .Range("I9") = myshs.Range("I9").Value
'                    .Range("K11") = myshs.Range("K11").Value
'                    .Range("N11") = myshs.Range("N11").Value
'                    .Range("R11") = myshs.Range("R11").Value
                    .Range("I21") = myshs.Range("I21").Value
                    .Range("L26") = myshs.Range("L26").Value
                    .Range("L27") = myshs.Range("L27").Value
'                    .Range("AB17") = myshs.Range("AB17").Value
'                    .Range("AB18") = myshs.Range("AB18").Value
'                    .Range("AB20") = myshs.Range("AB20").Value
                    .Range("AB23") = myshs.Range("AB23").Value
                    .Range("AB24") = myshs.Range("AB24").Value
                    .Range("AB25") = myshs.Range("AB25").Value
                    .Range("AB26") = myshs.Range("AB26").Value
'                    If .Range("AM1").Value = 1 Then
'                        .Shapes("maru1").Visible = True
'                        .Shapes("maru2").Visible = False
'                        .Shapes("maru3").Visible = True
'                        .Shapes("maru4").Visible = False
'                    Else
'                        .Shapes("maru2").Visible = True
'                        .Shapes("maru1").Visible = False
'                        .Shapes("maru4").Visible = True
'                        .Shapes("maru3").Visible = False
'                    End If
'                    .Protect Password:="as2343t"
'                    .Activate
                End With
                
                
                 With ThisWorkbook.Worksheets("|fffd|f|fffd|[|fffd|^")
                    .Unprotect Password:="as2343t"
                    
'                    .Range("A1").Value = myshd.Range("A1").Value
'                    myshd.Range("A5:B44").Copy
'                        .Range("A5").PasteSpecial Paste:=xlPasteValues
                    myshd.Range("M5:AZ133").Copy
                        .Range("M5").PasteSpecial Paste:=xlPasteValues
                    
                    Application.CutCopyMode = False
                    
                    .Range("M12:AZ79").ClearContents        '2019/1/2 Ver.1900 12:41-12:79
'                    .Range("M44:AZ79").ClearContents
                    
                    .Protect Password:="as2343t"
                End With
                
                
                
                With ThisWorkbook.Worksheets("|fffd||4d40f||fffd|")
                    .Unprotect Password:="as2343t"
                    .Range("A36").Value = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A36").Value  '|fffd|Y|fffd||fffd||fffd|L|fffd||fffd|
                    .Range("A2:D10") = Workbooks(f).Worksheets("|fffd||4d40f||fffd|").Range("A2:D10").Value    '|fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N Ver.1610
                    
                    .Protect Password:="as2343t"
                    .Activate
                End With
                
                ThisWorkbook.Worksheets("|fffd|g|fffd|b|fffd|v").Activate
                Workbooks(f).Close False
                Application.ScreenUpdating = True
                MsgBox "|fffd||fffd||835e||fffd||742||34f|I|fffd||fffd||fffd||fffd||fffd||702||fffd||fffd||fffd|"
                
                Set mysht = Nothing
                Set myshs = Nothing
                Set myshd = Nothing
            End If
        Else
            MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||311|I|fffd||fffd||fffd||fffd||fffd||508||fffd||fffd||fffd||102||fffd||fffd||702||fffd|"
        End If
    Else
        MsgBox "|fffd|N|fffd|x|fffd|X|fffd|V|fffd||311||38f||6c2||182||202||fffd|t|fffd|@|fffd|C|fffd||fffd||fffd||fffd||fffd|J|fffd||fffd||fffd||fffd||102||fffd||fffd||702||fffd||fffd||fffd|"
    End If
End Sub

' InQuest injected base64 decoded content
' 1D)d

INQUEST-PP=macro
