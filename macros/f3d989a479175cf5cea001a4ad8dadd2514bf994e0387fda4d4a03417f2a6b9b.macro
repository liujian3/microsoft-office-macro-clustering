Attribute VB_Name = "InputForm"
Attribute VB_Base = "0{D6DCE84B-0FEC-4BDB-B50A-10C457F82B65}{BBB52539-050D-4A70-B765-50CA6C877F76}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
Call save_data

End Sub

Private Sub CommandButton2_Click()
Call Open_debit_file
End Sub

Private Sub CommandButton3_Click()
Call open_time_file
End Sub

Private Sub CommandButton4_Click()
confirm = MsgBox("are you sure you want to say bye bye to this employee..no get any more pay??", 4)
If confirm = 6 Then
terminated_employee = Label1.Caption
terminated_emp_no = TextBox59.Value

InputForm.Hide
UserForm6.Show

End If
End Sub

Private Sub Label18_Click()

End Sub

Private Sub TextBox18_AfterUpdate()
bb = MsgBox("do you want to change the salary for this employee for all ensuing pay periods?", 4)
If bb = 6 Then
'change salary forever rouitne
Call change_salary
End If

End Sub
Sub change_shift()
Dim mydb As Database
Dim mytable, mytable2 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"
For i = 1 To 24
If paydatetable(i) = master_pay_date Then
start_here = i
End If
Next i
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

For i = start_here To 24
dancriteria = "select * from [" + paydatetable(i) + "]" + " where employeenumber = " + Str(TextBox59.Value)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF
mytable2.Edit
mytable2("shift") = TextBox60.Value
mytable2.Update

mytable2.MoveNext
Loop
Next i
mydb.Close
InputForm.Hide
Call Sheets(1).get_employee_list
End Sub
Sub change_salary()
Dim mydb As Database
Dim mytable, mytable2 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"
For i = 1 To 24
If paydatetable(i) = master_pay_date Then
start_here = i
End If
Next i
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

For i = start_here To 24
dancriteria = "select * from [" + paydatetable(i) + "]" + " where employeenumber = " + Str(TextBox59.Value)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF
mytable2.Edit
mytable2("dailysalary") = TextBox18.Value
mytable2.Update

mytable2.MoveNext
Loop
Next i
mydb.Close
InputForm.Hide
Call Sheets(1).get_employee_list
End Sub


Private Sub TextBox18_Change()

End Sub

Private Sub TextBox21_Change()
Call refresh_pays
End Sub

Private Sub TextBox21_Enter()
Call refresh_pays
End Sub

Private Sub TextBox21_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox22_Change()
Call refresh_pays
End Sub

Private Sub TextBox22_Enter()
Call refresh_pays
End Sub

Private Sub TextBox22_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox23_Change()
Call refresh_pays
End Sub

Private Sub TextBox23_Enter()
Call refresh_pays
End Sub

Private Sub TextBox23_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox24_Change()
Call refresh_pays
End Sub

Private Sub TextBox24_Enter()
Call refresh_pays
End Sub

Private Sub TextBox24_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox25_Change()
Call refresh_pays
End Sub

Private Sub TextBox25_Enter()
Call refresh_pays
End Sub

Private Sub TextBox25_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox27_Change()
Call refresh_pays
End Sub

Private Sub TextBox27_Enter()
Call refresh_pays
End Sub

Private Sub TextBox27_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox29_Change()
Call refresh_pays
End Sub

Private Sub TextBox29_Enter()
Call refresh_pays
End Sub

Private Sub TextBox29_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox30_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox30_Change()
Call refresh_pays
End Sub

Private Sub TextBox30_Enter()
Call refresh_pays
End Sub

Private Sub TextBox30_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox31_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox31_Change()
Call refresh_pays
End Sub

Private Sub TextBox31_Enter()
Call refresh_pays
End Sub

Private Sub TextBox31_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Call refresh_pays
End Sub

Private Sub TextBox48_Change()

End Sub

Private Sub TextBox49_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox49_Change()
Call refresh_pays
End Sub

Private Sub TextBox49_Enter()
Call refresh_pays
End Sub

Private Sub TextBox51_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox51_Change()
Call refresh_pays
End Sub

Private Sub TextBox51_Enter()
Call refresh_pays
End Sub

Private Sub TextBox52_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox52_Change()
Call refresh_pays
End Sub

Private Sub TextBox52_Enter()
Call refresh_pays
End Sub

Private Sub TextBox53_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox53_Change()
Call refresh_pays
End Sub

Private Sub TextBox53_Enter()
Call refresh_pays
End Sub

Private Sub TextBox55_AfterUpdate()
Call refresh_pays
End Sub

Private Sub TextBox55_Change()
Call refresh_pays
End Sub

Private Sub TextBox55_Enter()
Call refresh_pays
End Sub

Private Sub TextBox60_AfterUpdate()
bb = MsgBox("do you want to change the shift for this employee for all ensuing pay periods? " + master_pay_date, 4)
If bb = 6 Then
'change shift forever rouitne
Call change_shift
End If
End Sub

Private Sub TextBox60_Change()

End Sub

Private Sub TextBox64_Change()

End Sub

Private Sub UserForm_Click()

End Sub

Private Sub UserForm_Deactivate()


End Sub

Private Sub UserForm_Terminate()
'MsgBox ("Did you save the data")
SaveForm.Show



'ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub
Sub save_data()
Debug.Print master_pay_date
'data_table_name = "Jan 1"
'worker = InputBox("input employee number")
'Call clear_data
'data_employee_no = Val(worker)
bb = Selection.Row

selection_key = Range("AJ" + Trim(Str(bb))).Value

dancriteria = "select * from [" + master_pay_date + "] where key = " + Str(selection_key)

'Data_paydate = "2/1/2004"
'Goback to A5
'Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2 As Recordset
'Dim db As TableDefs
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

 cc = Selection.Column
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
rec_count = mytable2.RecordCount
Debug.Print rec_count
mytable2.Edit
mytable2("dailysalary") = Range("b" + Trim(Str(bb))).Value
mytable2("hourlysalary") = Range("c" + Trim(Str(bb))).Value
mytable2("normaldaysworked") = Range("d" + Trim(Str(bb))).Value
mytable2("normalpay") = Range("e" + Trim(Str(bb))).Value
mytable2("undertimehours") = Range("f" + Trim(Str(bb))).Value
mytable2("MinusUT") = Range("g" + Trim(Str(bb))).Value
mytable2("MidshiftHoursWorked") = Range("h" + Trim(Str(bb))).Value
mytable2("MidIncentivePay") = Range("i" + Trim(Str(bb))).Value
mytable2("CatAHoursWorked") = Range("j" + Trim(Str(bb))).Value
mytable2("OvertimeCatAPay") = Range("k" + Trim(Str(bb))).Value
mytable2("CatBHoursWorked") = Range("l" + Trim(Str(bb))).Value
mytable2("OvertimeCatBPay") = Range("m" + Trim(Str(bb))).Value
mytable2("CatCHoursWorked") = Range("n" + Trim(Str(bb))).Value
mytable2("OvertimeCatCPay") = Range("o" + Trim(Str(bb))).Value
mytable2("CatFDaysWorked") = Range("p" + Trim(Str(bb))).Value
mytable2("HolidayCatFPay") = Range("q" + Trim(Str(bb))).Value
mytable2("CatHDaysWorked") = Range("r" + Trim(Str(bb))).Value
mytable2("HolidayCatHPay") = Range("s" + Trim(Str(bb))).Value
mytable2("CatJDaysWorked") = Range("t" + Trim(Str(bb))).Value
mytable2("HolidayCatJPay") = Range("u" + Trim(Str(bb))).Value
mytable2("CatPDaysWorked") = Range("v" + Trim(Str(bb))).Value
mytable2("PremiumCatPPay") = Range("w" + Trim(Str(bb))).Value
mytable2("SILDays") = Range("x" + Trim(Str(bb))).Value
mytable2("SILPay") = Range("y" + Trim(Str(bb))).Value
mytable2("GrossPay") = Range("z" + Trim(Str(bb))).Value
mytable2("remarks") = Range("aa" + Trim(Str(bb))).Value
mytable2("otherdeductions") = Range("ab" + Trim(Str(bb))).Value
mytable2("cashadvances") = Range("ac" + Trim(Str(bb))).Value
mytable2("SSS") = Range("ad" + Trim(Str(bb))).Value
mytable2("EmployeeMeals") = Range("ae" + Trim(Str(bb))).Value
mytable2("employeecharges") = Range("af" + Trim(Str(bb))).Value
mytable2("NetPay") = Range("ag" + Trim(Str(bb))).Value

mytable2("Othercomments") = Range("ah" + Trim(Str(bb))).Value
mytable2("Shift") = Range("ai" + Trim(Str(bb))).Value
mytable2.Update
mytable2.Close


End Sub
Sub open_time_file()
If UCase(Environ$("computername")) = "BOOKKEEPER" Or UCase(Environ$("computername")) = "VIDEOMACHINE2" Then
backup_path = "\\snap\drive1\backup\"
Else
backup_path = "c:\backup\"
End If

On Error GoTo error_routine
    bb = Trim(Str(TextBox59.Text))
   If Val(bb) > 1 And bb < 1500 Then
    
    
    Workbooks.Open Filename:=backup_path + bb + "_emp.dbf"
    Columns("C").Hidden = True
Columns("b").Hidden = True
Columns("i").Hidden = True
Columns("k").Hidden = True
Columns("i").Hidden = True
Columns("j").Hidden = True
Columns("l").Hidden = True
Columns("m").Hidden = True
Columns("n").Hidden = True
Columns("o").Hidden = True
Columns("p").Hidden = True
Load UserForm1
UserForm1.Show 0
   UserForm1.CommandButton1.Visible = False
   UserForm1.TextBox1.Visible = False
   UserForm1.TextBox2.Visible = False
   UserForm1.CommandButton3.Visible = True
   UserForm1.Label1.Visible = False
   UserForm1.Label2.Visible = False
   UserForm1.Label3.Visible = False
   
   
   
   
   
   Else
MsgBox ("Got to open a workbook first and go his/her page")
    Exit Sub
    End If
Exit Sub
error_routine:
'If Err = 1004 Then
bb = MsgBox("Can't find that employees time file.  You'll have to find the data elsewhere!!", 0)
'End If

End Sub
Sub Open_debit_file()
'
' Macro1 Macro
' Macro recorded 6/15/2001 by Danno
'

'
If UCase(Environ$("computername")) = "BOOKKEEPER" Or UCase(Environ$("computername")) = "VIDEOMACHINE2" Then
backup_path = "\\snap\drive1\backup\"
Else
backup_path = "c:\backup\"
End If
  On Error GoTo error_routine
    bb = Trim(Str(TextBox59.Text))
   If Val(bb) > 1 And bb < 1500 Then
    
    
    Workbooks.Open Filename:=backup_path + bb + "_deb.dbf"
    Columns("C").Hidden = True
Columns("b").Hidden = True
Columns("c").Hidden = True
Columns("h").Hidden = True
Columns("i").Hidden = True
Load UserForm1
UserForm1.Show 0
   Else
MsgBox ("Got to open a workbook first and go his/her page")
    Exit Sub
    End If
    Exit Sub
error_routine:
'If Err = 1004 Then
bb = MsgBox("Can't find that employees debit file.  You'll have to find the data elsewhere!!", 0)
'End If
End Sub
Attribute VB_Name = "Module1"
Global master_pay_date As String
Global terminated_employee As String, terminated_emp_no As Integer

Sub refresh_controlSource()
bb = Selection.Row
'TextBox1.Text = Trim(Str(bb))
'TextBox1.Text = Range("Normal_Pay").Rows(bb - 4).Value

'TextBox1.Text = ActiveSheet.Range("GrossPay").Address

'TextBox1.Text = Mid(TextBox1.Text, 2, 1)

'This is for employee Number
'inputform.TextBox59.Text = ActiveSheet.Range("EmployeeNumber").Value

'This is for shift working
'inputform.TextBox60.Text = ActiveSheet.Range("Shift").Value

'This for Daily Salary
nameaddress = ActiveSheet.Range("DailySalary").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox18.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox18.ControlSource = "B" + Trim(Str(bb))

'This for Hourly Salary
'nameaddress = ActiveSheet.Range("HourlySalary").Address
'columnLetter = Mid(nameaddress, 2, 1)
'InputForm.TextBox19.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox19.ControlSource = "C" + Trim(Str(bb))

'This for Normal Days Worked
nameaddress = ActiveSheet.Range("NormalDaysWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox21.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox21.ControlSource = "D" + Trim(Str(bb))

'This for UndertimeHours
nameaddress = ActiveSheet.Range("UnderTimeHours").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox22.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox22.ControlSource = "F" + Trim(Str(bb))

'This for Midshifts Hours worked
nameaddress = ActiveSheet.Range("MidshiftHoursWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox23.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox23.ControlSource = "H" + Trim(Str(bb))

'This for Overtime Cat A hours Worked
nameaddress = ActiveSheet.Range("CatAHoursWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox24.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox24.ControlSource = "J" + Trim(Str(bb))


'This for Overtime Cat B hours Worked
nameaddress = ActiveSheet.Range("CatBHoursWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox25.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox25.ControlSource = "L" + Trim(Str(bb))

'This is for Overtime Cat C hours Worked
nameaddress = ActiveSheet.Range("CatCHoursWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox57.ControlSource = columnLetter + Trim(Str(bb))


'This for Holiday Cat F Days worked
nameaddress = ActiveSheet.Range("CatFDaysWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox27.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox27.ControlSource = "N" + Trim(Str(bb))

'This for Holiday Cat H Days worked
nameaddress = ActiveSheet.Range("CatHDaysWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox29.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox29.ControlSource = "P" + Trim(Str(bb))

'This for Holiday Cat J Days worked
nameaddress = ActiveSheet.Range("CatJDaysWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox30.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox30.ControlSource = "R" + Trim(Str(bb))

'This for Premium Cat P Days worked
nameaddress = ActiveSheet.Range("CatPDaysWorked").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox31.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox31.ControlSource = "T" + Trim(Str(bb))

'This for SIL days
nameaddress = ActiveSheet.Range("SILDays").Address
columnLetter = Mid(nameaddress, 2, 1)
InputForm.TextBox49.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox49.ControlSource = "V" + Trim(Str(bb))

'This for Other Decutions
nameaddress = ActiveSheet.Range("OtherDeductions").Address
columnLetter = Mid(nameaddress, 2, 2)
InputForm.TextBox51.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox51.ControlSource = "AA" + Trim(Str(bb))

'This for Cash Advances
nameaddress = ActiveSheet.Range("CashAdvances").Address
columnLetter = Mid(nameaddress, 2, 2)
InputForm.TextBox52.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox52.ControlSource = "AB" + Trim(Str(bb))

'This for SSS
nameaddress = ActiveSheet.Range("SSS").Address
columnLetter = Mid(nameaddress, 2, 2)
InputForm.TextBox53.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox53.ControlSource = "AC" + Trim(Str(bb))

'This for Employee charges
nameaddress = ActiveSheet.Range("EmployeeCharges").Address
columnLetter = Mid(nameaddress, 2, 2)
InputForm.TextBox55.ControlSource = columnLetter + Trim(Str(bb))
'inputform.TextBox55.ControlSource = "AE" + Trim(Str(bb))
'This is for shift
nameaddress = ActiveSheet.Range("Shift").Address
columnLetter = Mid(nameaddress, 2, 2)
InputForm.TextBox60.ControlSource = columnLetter + Trim(Str(bb))

End Sub
Sub refresh_pays()
bb = Selection.Row
'TextBox1.Text = Range("Normal_Pay").Rows(bb - 4).Value

'inputform.TextBox20.Text = Format(Range("A" + Trim(Str(bb))), "0.00")
InputForm.TextBox20.Text = Format(Range("PayDate").Rows(bb - 4).Value, "dddd, mmm d yyyy")
InputForm.TextBox32.Text = Format(Range("NormalPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox33.Text = Format(Range("MinusUT").Rows(bb - 4).Value, "0.00")
InputForm.TextBox34.Text = Format(Range("MidIncentivePay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox35.Text = Format(Range("OvertimeCatAPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox36.Text = Format(Range("OvertimeCatBPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox38.Text = Format(Range("HolidayCatFPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox40.Text = Format(Range("HolidayCatHPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox41.Text = Format(Range("HolidayCatJPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox47.Text = Format(Range("PremiumCatPPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox48.Text = Format(Range("GrossPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox50.Text = Format(Range("SILPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox58.Text = Format(Range("OvertimeCatCPay").Rows(bb - 4).Value, "0.00")
InputForm.TextBox54.Text = Format(Range("EmployeeMeals").Rows(bb - 4).Value, "0.00")
InputForm.TextBox56.Text = Format(Range("NetPay").Rows(bb - 4).Value, "0.00")

End Sub


Attribute VB_Name = "Module10"
Sub Macro11()
Attribute Macro11.VB_Description = "Macro recorded 2/23/2004 by Nad"
Attribute Macro11.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro11 Macro
' Macro recorded 2/23/2004 by Nad
'

'
    
End Sub
Attribute VB_Name = "Module2"
Sub Macro1()
Attribute Macro1.VB_Description = "Macro recorded 1/10/2004 by Newbedroom"
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
' Macro recorded 1/10/2004 by Newbedroom
'

'
    Rows("5:21").Select
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Rows("12:12").Select
    Selection.Interior.ColorIndex = xlNone
   
End Sub
Attribute VB_Name = "Module4"
Sub Macro3()
Attribute Macro3.VB_Description = "Macro recorded 1/11/2004 by Danno"
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
' Macro recorded 1/11/2004 by Danno
'

'
    ActiveWindow.SelectedSheets.Visible = False
    Sheets("StartHere").Visible = True
End Sub
Attribute VB_Name = "Module5"
Sub Macro4()
Attribute Macro4.VB_Description = "Macro recorded 1/11/2004 by Danno"
Attribute Macro4.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro4 Macro
' Macro recorded 1/11/2004 by Danno
'

'
    Columns("C:I").Select
    Selection.EntireColumn.Hidden = True
End Sub
Sub Macro5()
Attribute Macro5.VB_Description = "Macro recorded 1/11/2004 by Danno"
Attribute Macro5.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro5 Macro
' Macro recorded 1/11/2004 by Danno
'

'
    With ActiveWindow
        .DisplayGridlines = False
        .DisplayHeadings = False
    End With
    With ActiveWindow
        .DisplayGridlines = True
        .DisplayHeadings = True
    End With
End Sub
Attribute VB_Name = "Module6"
Sub Macro6()
Attribute Macro6.VB_Description = "Macro recorded 1/12/2004 by Danno"
Attribute Macro6.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro6 Macro
' Macro recorded 1/12/2004 by Danno
'

'
    Columns("D:D").Select
    Selection.EntireColumn.Hidden = True
    Selection.EntireColumn.Hidden = False
End Sub
Sub Macro7()
Attribute Macro7.VB_Description = "Macro recorded 1/12/2004 by Danno"
Attribute Macro7.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro7 Macro
' Macro recorded 1/12/2004 by Danno
'

'
    Range("C5:C83").Select
    Selection.ClearContents
End Sub
Attribute VB_Name = "Module7"
Sub Macro8()
Attribute Macro8.VB_Description = "Macro recorded 1/12/2004 by Danno"
Attribute Macro8.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro8 Macro
' Macro recorded 1/12/2004 by Danno
'

'
    Rows("5:39").Select
    Selection.RowHeight = 17
End Sub
Sub Macro9()
Attribute Macro9.VB_Description = "Macro recorded 1/12/2004 by Danno"
Attribute Macro9.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro9 Macro
' Macro recorded 1/12/2004 by Danno
'

'
    Columns("A:AN").Select
    Selection.EntireColumn.Hidden = False
End Sub
Attribute VB_Name = "Module8"
Sub Macro10()
Attribute Macro10.VB_Description = "Macro recorded 1/12/2004 by Danno"
Attribute Macro10.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro10 Macro
' Macro recorded 1/12/2004 by Danno
'

'
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
End Sub
Attribute VB_Name = "Module9"
Sub Macro13()
Attribute Macro13.VB_Description = "Macro recorded 2/23/2004 by Nad"
Attribute Macro13.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro13 Macro
' Macro recorded 2/23/2004 by Nad
'

'
    Columns("E:H").Select
    Range("E35").Activate
    Selection.Columns.AutoFit
    ActiveWindow.SmallScroll Down:=-34
End Sub
Attribute VB_Name = "SaveForm"
Attribute VB_Base = "0{4762C003-28C5-4B4E-ACE6-E6D3DFA42D95}{75EA275C-DF32-41B6-A9AF-4CCCF8F34A22}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
SaveForm.Hide
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub

Private Sub CommandButton2_Click()
Call InputForm.save_data
SaveForm.Hide
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub

Private Sub CommandButton3_Click()
SaveForm.Hide
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub

Private Sub CommandButton4_Click()

End Sub

Private Sub UserForm_Activate()
Label1.Caption = "Did you save the data before you closed the form?"

End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 10, 0, MSForms, CommandButton"
Attribute VB_Control = "Label1, 21, 4, MSForms, Label"
Attribute VB_Control = "ComboBox1, 16, 5, MSForms, ComboBox"

Private Sub CommandButton4_Click()

End Sub
Sub clear_data()
    Application.GoTo Reference:="Key"
    Selection.ClearContents
    Application.GoTo Reference:="Shift"
    Selection.ClearContents
    Application.GoTo Reference:="EmployeeNumber"
    Selection.ClearContents
    Application.GoTo Reference:="PayDate"
    Selection.ClearContents
    Application.GoTo Reference:="DailySalary"
    Selection.ClearContents
    Application.GoTo Reference:="NormalDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="UndertimeHours"
    Selection.ClearContents
    Application.GoTo Reference:="MidshiftHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatAHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatBHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatChoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatFDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatHDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatJDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatPDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="SILDays"
    Selection.ClearContents
    Application.GoTo Reference:="Remarks"
    Selection.ClearContents
    Application.GoTo Reference:="OtherDeductions"
    Selection.ClearContents
        Application.GoTo Reference:="CashAdvances"
    Selection.ClearContents
        Application.GoTo Reference:="SSS"
    Selection.ClearContents
        Application.GoTo Reference:="EmployeeCharges"
    Selection.ClearContents
        Application.GoTo Reference:="OtherComments"
    Selection.ClearContents
    ActiveSheet.Name = "Employee"
    Range("A5").Select
End Sub

Sub get_data(data_employee_no)

'data_table_name = "Jan 1"
'worker = InputBox("input employee number")
'Call clear_data
'data_employee_no = Val(worker)
dancriteria = "select * from [" + data_table_name + "] where employeenumber = " + Str(data_employee_no)

'Data_paydate = "2/1/2004"
'Goback to A5
Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2, mytable3 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"





'shift_file(1) = "Payroll 2001 Day Shift.xls"
'shift_file(2) = "Payroll 2001 Night Shift.xls"
'shift_file(3) = "Payroll 2001 Mid Shift.xls"
'shift_file(4) = "Payroll 2001 Kitchen.xls"
'shift_file(5) = "Payroll 2001 Other.xls"
'
'mycriteraxx = "buggy" ' where employeenumber = 29"

'Dim db As TableDefs

'Debug.Print mytable4(1)




Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")
  bb = Selection.Row
 cc = Selection.Column
For i = 1 To 24
dancriteria = "select * from [" + paydatetable(i) + "] where employeenumber = " + Str(data_employee_no)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
dancriteria3 = "select * from [" + master_pay_date + "] where employeenumber = " + Str(data_employee_no)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Set mytable3 = mydb.OpenRecordset(dancriteria3, dbOpenDynaset)

If mytable3("trainee") = True Then
 Label1.Visible = True
 Else
 Label1.Visible = False
 End If
Do Until mytable2.EOF

 Range("a" + Trim(Str(bb))).Value = mytable2("paydate")
Range("b" + Trim(Str(bb))).Value = mytable2("dailysalary")
'Range("c" + Trim(Str(bb))).Value = mytable2("hourlysalary")
Range("d" + Trim(Str(bb))).Value = mytable2("normaldaysworked")
'Range("e" + Trim(Str(bb))).Value = mytable2("normalpay")
Range("f" + Trim(Str(bb))).Value = mytable2("undertimehours")
'Range("g" + Trim(Str(bb))).Value = mytable2("MinusUT")
Range("h" + Trim(Str(bb))).Value = mytable2("MidshiftHoursWorked")
'Range("i" + Trim(Str(bb))).Value = mytable2("MidIncentivePay")
Range("j" + Trim(Str(bb))).Value = mytable2("CatAHoursWorked")
'Range("k" + Trim(Str(bb))).Value = mytable2("OvertimeCatAPay")
Range("l" + Trim(Str(bb))).Value = mytable2("CatBHoursWorked")
'Range("m" + Trim(Str(bb))).Value = mytable2("OvertimeCatBPay")
Range("n" + Trim(Str(bb))).Value = mytable2("CatCHoursWorked")
'Range("o" + Trim(Str(bb))).Value = mytable2("OvertimeCatCPay")
Range("p" + Trim(Str(bb))).Value = mytable2("CatFDaysWorked")
'Range("q" + Trim(Str(bb))).Value = mytable2("HolidayCatFPay")
Range("r" + Trim(Str(bb))).Value = mytable2("CatHDaysWorked")
'Range("s" + Trim(Str(bb))).Value = mytable2("HolidayCatHPay")
Range("t" + Trim(Str(bb))).Value = mytable2("CatJDaysWorked")
'Range("u" + Trim(Str(bb))).Value = mytable2("HolidayCatJPay")
Range("v" + Trim(Str(bb))).Value = mytable2("CatPDaysWorked")
'Range("w" + Trim(Str(bb))).Value = mytable2("PremiumCatPPay")
Range("x" + Trim(Str(bb))).Value = mytable2("SILDays")
'Range("y" + Trim(Str(bb))).Value = mytable2("SILPay")
'Range("z" + Trim(Str(bb))).Value = mytable2("GrossPay")

'Range(Cells(1, 1), Cells(5, 3)).
 Range("aj" + Trim(Str(bb))).Value = mytable2("key")
 Range("aa" + Trim(Str(bb))).Value = (mytable2("remarks"))
 Range("ab" + Trim(Str(bb))).Value = (mytable2("otherdeductions"))
 Range("ac" + Trim(Str(bb))).Value = (mytable2("cashadvances"))
 Range("ad" + Trim(Str(bb))).Value = (mytable2("SSS"))
 'Range("ae" + Trim(Str(bb))).Value = (mytable2("employeemeals"))
 Range("af" + Trim(Str(bb))).Value = (mytable2("employeecharges"))
 'Range("ag" + Trim(Str(bb))).Value = (mytable2("netpay"))
 Range("ah" + Trim(Str(bb))).Value = (mytable2("Othercomments"))
   Range("ai" + Trim(Str(bb))).Value = (mytable2("Shift"))
ActiveSheet.Name = mytable2("employeename")

   'range ab=mytable("otherdedutions")
   'range ac=mytable(cashadvances)
   'range ad=mytable("SSS")
   'range ae=mytable("employeemeals") dont input
   'range af=mytable("employeecharges")
   'range ag=mytable("netpay") don't input
   'range ah=mytable("Othercomments")
   
   'Cells(bb, vc + cc).Value = mytable2(vc + 3)
   
   'Range(bb, vc + cc).Value = mytable2(vc)

 
 'saveform.ListBox1.AddItem mytable2("employeename")
mytable2.MoveNext
bb = bb + 1
Loop

Next i

End Sub

Sub get_employee_list()
ComboBox1.Clear
'ComboBox1.Text = "What"
'ComboBox1.AddItem "employee"
ComboBox1.Text = "Select Employee"

Call clear_data
'ListBox1.AddItem "danno"
data_table_name = master_pay_date
Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2 As Recordset
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")
dancriteria = "select employeename,employeenumber from [" + data_table_name + "] order by shift,employeename" ' where employeenumber = " + Str(Data_employee_no)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF
emp_no_string = Format$(mytable2("employeenumber"), "0000")

'ListBox1.AddItem emp_no_string + " " + mytable2("employeename")
ComboBox1.AddItem emp_no_string + " " + mytable2("employeename")



mytable2.MoveNext
Loop
'New stuff here:
'Dim mydb2 As dao.Database
'Dim mytable4 As Recordset
'Set mydb2 = DBEngine.OpenDatabase("c:\margarit\vbemploy\", False, False, "Dbase III;")
'mycriteria = "select * from employ where terminated=false"
'Set mytable4 = mydb2.OpenRecordset(mycriteria, dbOpenDynaset)
''***************end of new stuff
'Debug.Print mytable4(0), mytable4(1), mytable4(2)
'
'mytable2.Close
End Sub

Private Sub ComboBox1_Change()

End Sub

Private Sub ComboBox1_Click()
ActiveSheet.Unprotect
qq = ComboBox1.ListIndex
CommandButton1.Left = 213
da_employee = ComboBox1.List(qq)
'da_employee = Combobox1.List(ListIndex)
Debug.Print da_employee
da_employee_number_string = Left(da_employee, 4)
da_employee_number = Val(da_employee_number_string)
'Check if temp
'*******************************************************************
'Dim employdb As DAO.Database
'Dim employmyset As DAO.Recordset
'Set employdb = DBEngine.OpenDatabase("c:\VB6 Programs\", False, False, "Dbase IV;")
'Set employmyset = employdb.OpenRecordset("select * from employ where (terminated=false or terminated=null) and serialno<1000 and serialno=" + da_employee_number_string)
'If employmyset.EOF Then GoTo exit_this
'employmyset.MoveLast
'employmyset.MoveFirst
'If employmyset("trainee") = True Then
' Label1.Caption = "Trainee"
' Label1.Visible = True
' Else
' Label1.Visible = False
'End If
'exit_this:
'employmyset.Close
'employdb.Close


'*********************************************************************

Debug.Print da_employee_number

ActiveSheet.Columns("a:aj").Select
    Selection.EntireColumn.Hidden = False
   With ActiveWindow
        .DisplayGridlines = True
        .DisplayHeadings = True
    End With






Call get_data(da_employee_number)


ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
End Sub


Private Sub CommandButton1_Click()
notta = MsgBox("Make sure you have selected a pay date in Col A before proceeding!!! Proceed??", vbYesNo)
If notta = 7 Then Exit Sub



If Selection.Column <> 1 Then
  MsgBox ("you didn't select a paydate in column 1--'The A column'")
  Exit Sub
End If

'Make master date based on selection
ActiveSheet.Unprotect
rr = Selection.Row
myaddress = "A" + Trim(Str(rr))
Dummy1 = ActiveSheet.Range(myaddress).Value
Dummy2 = Format(Dummy1, "mmm d")
master_pay_date = Dummy2
'Dummy3 = Day(Dummy1)
'Color all rows except one working with
    Rows("5:63").Select
    With Selection.Interior
        .ColorIndex = 8
        .Pattern = xlSolid
    End With
    Rows(rr).Select
    Selection.Interior.ColorIndex = xlNone


Dim bb As Integer
Workbooks("Payroll 2020.xls").Activate



InputForm.Label1.Caption = ActiveCell.Worksheet.Name
InputForm.Label6.Caption = "Normal Days Worked"
InputForm.Label7.Caption = "Undertime Hours"
InputForm.Label8.Caption = "Mid Shift Hours Worked"
InputForm.Label9.Caption = "Cat A Overtime Hours"
InputForm.Label10.Caption = "Cat B Overtime Hours"
InputForm.Label23.Caption = "Cat C Overtime Hours"

InputForm.Label11.Caption = "Cat F Holiday Days Worked"
InputForm.Label12.Caption = "Cat H Holiday Days Worked"
InputForm.Label13.Caption = "Cat J Holiday Days Worked"
InputForm.Label14.Caption = "Cat P Premium Days Worked"
InputForm.Label16.Caption = "SIL Days"
InputForm.Label17.Caption = "Pag-ibig"
InputForm.Label18.Caption = "SSS Loans"

InputForm.Label19.Caption = "SSS"
InputForm.Label20.Caption = "Employee Meals"
InputForm.Label21.Caption = "Employee Charges"

'Next is to put in employee number
qq = ComboBox1.ListIndex
da_employee1 = ComboBox1.List(qq)
'da_employee = Combobox1.List(ListIndex)
da_employee_number_string1 = Left(da_employee1, 4)
da_employee_number1 = Val(da_employee_number_string1)
InputForm.TextBox59.Text = da_employee_number1




Call refresh_controlSource
Call refresh_pays

InputForm.Show

End Sub


Private Sub TextBox1_Change()

End Sub
Private Sub CommandButton2_Click()
'data_table_name = "Jan 1"
'worker = InputBox("input employee number")
'Call clear_data
'data_employee_no = Val(worker)
dancriteria = "select * from [" + data_table_name + "] where employeenumber = " + Str(data_employee_no)

'Data_paydate = "2/1/2004"
'Goback to A5
Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"





'shift_file(1) = "Payroll 2001 Day Shift.xls"
'shift_file(2) = "Payroll 2001 Night Shift.xls"
'shift_file(3) = "Payroll 2001 Mid Shift.xls"
'shift_file(4) = "Payroll 2001 Kitchen.xls"
'shift_file(5) = "Payroll 2001 Other.xls"

'mycriteraxx = "buggy" ' where employeenumber = 29"

'Dim db As TableDefs
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")
  bb = Selection.Row
 cc = Selection.Column
For i = 1 To 24
dancriteria = "select * from [" + paydatetable(i) + "] where employeenumber = " + Str(data_employee_no)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF

 Range("a" + Trim(Str(bb))).Value = mytable2("paydate")
Range("b" + Trim(Str(bb))).Value = mytable2("dailysalary")
'Range("c" + Trim(Str(bb))).Value = mytable2("hourlysalary")
Range("d" + Trim(Str(bb))).Value = mytable2("normaldaysworked")
'Range("e" + Trim(Str(bb))).Value = mytable2("normalpay")
Range("f" + Trim(Str(bb))).Value = mytable2("undertimehours")
'Range("g" + Trim(Str(bb))).Value = mytable2("MinusUT")
Range("h" + Trim(Str(bb))).Value = mytable2("MidshiftHoursWorked")
'Range("i" + Trim(Str(bb))).Value = mytable2("MidIncentivePay")
Range("j" + Trim(Str(bb))).Value = mytable2("CatAHoursWorked")
'Range("k" + Trim(Str(bb))).Value = mytable2("OvertimeCatAPay")
Range("l" + Trim(Str(bb))).Value = mytable2("CatBHoursWorked")
'Range("m" + Trim(Str(bb))).Value = mytable2("OvertimeCatBPay")
Range("n" + Trim(Str(bb))).Value = mytable2("CatCHoursWorked")
'Range("o" + Trim(Str(bb))).Value = mytable2("OvertimeCatCPay")
Range("p" + Trim(Str(bb))).Value = mytable2("CatFDaysWorked")
'Range("q" + Trim(Str(bb))).Value = mytable2("HolidayCatFPay")
Range("r" + Trim(Str(bb))).Value = mytable2("CatHDaysWorked")
'Range("s" + Trim(Str(bb))).Value = mytable2("HolidayCatHPay")
Range("t" + Trim(Str(bb))).Value = mytable2("CatJDaysWorked")
'Range("u" + Trim(Str(bb))).Value = mytable2("HolidayCatJPay")
Range("v" + Trim(Str(bb))).Value = mytable2("CatPDaysWorked")
'Range("w" + Trim(Str(bb))).Value = mytable2("PremiumCatPPay")
Range("x" + Trim(Str(bb))).Value = mytable2("SILDays")
'Range("y" + Trim(Str(bb))).Value = mytable2("SILPay")
'Range("z" + Trim(Str(bb))).Value = mytable2("GrossPay")

'Range(Cells(1, 1), Cells(5, 3)).
 Range("aj" + Trim(Str(bb))).Value = mytable2("key")
 Range("aa" + Trim(Str(bb))).Value = (mytable2("remarks"))
 Range("ab" + Trim(Str(bb))).Value = (mytable2("otherdeductions"))
 Range("ac" + Trim(Str(bb))).Value = (mytable2("cashadvances"))
 Range("ad" + Trim(Str(bb))).Value = (mytable2("SSS"))
 'Range("ae" + Trim(Str(bb))).Value = (mytable2("employeemeals"))
 Range("af" + Trim(Str(bb))).Value = (mytable2("employeecharges"))
 'Range("ag" + Trim(Str(bb))).Value = (mytable2("netpay"))
 Range("ah" + Trim(Str(bb))).Value = (mytable2("Othercomments"))
   Range("ai" + Trim(Str(bb))).Value = (mytable2("Shift"))
ActiveSheet.Name = mytable2("employeename")

   'range ab=mytable("otherdedutions")
   'range ac=mytable(cashadvances)
   'range ad=mytable("SSS")
   'range ae=mytable("employeemeals") dont input
   'range af=mytable("employeecharges")
   'range ag=mytable("netpay") don't input
   'range ah=mytable("Othercomments")
   
   'Cells(bb, vc + cc).Value = mytable2(vc + 3)
   
   'Range(bb, vc + cc).Value = mytable2(vc)

 
 'saveform.ListBox1.AddItem mytable2("employeename")
mytable2.MoveNext
bb = bb + 1
Loop

Next i
End Sub

Private Sub CommandButton3_Click()
ActiveSheet.Unprotect
Call get_employee_list
ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True

End Sub


Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
qq = ListBox1.ListIndex

da_employee = ListBox1.List(qq)
'da_employee = ListBox1.List(ListIndex)
Debug.Print da_employee
da_employee_number_string = Left(da_employee, 4)
da_employee_number = Val(da_employee_number_string)
Debug.Print da_employee_number
Call get_data(da_employee_number)

End Sub

Private Sub Worksheet_Activate()
Label1.Visible = False
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "ListBox1, 2, 1, MSForms, ListBox"
Attribute VB_Control = "Label1, 3, 2, MSForms, Label"

Private Sub CommandButton1_Click()

Sheets(1).Activate
Label1.Visible = True
ListBox1.Visible = True
ListBox1.Clear
 Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"

For i = 1 To 24
ListBox1.AddItem paydatetable(i)
Next i

 
 
 
 
 
 'Sheets(1).Visible = True
 
'Call Sheets(1).get_employee_list
 
End Sub
Private Sub Experiment()
'Expirement

Dim db As DAO.Database
Dim myset As DAO.Recordset
Set db = DBEngine.OpenDatabase("c:\VB6 Programs\", False, False, "Dbase IV;")
Set myset = db.OpenRecordset("select * from employ where terminated=false or terminated=null")
myset.MoveFirst
Do Until myset.EOF
bb = Trim(Str(myset("Serialno")))
        Dim mydb As Database
        Dim mytable, mytable2 As Recordset
        Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")
        dancriteria = "select * from [" + master_pay_date + "] where employeenumber = " + bb + " order by employeenumber"
        'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
        Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
       Do Until mytable2.EOF
        emp_no_string = Format$(mytable2("employeenumber"), "0000")
        
        'ListBox1.AddItem emp_no_string + " " + mytable2("employeename")
        cc = emp_no_string + " " + mytable2("employeename")
        mytable2.Edit
        mytable2("permanent") = myset("permanent")
        mytable2("Trainee") = myset("Trainee")
        mytable2("PartTime") = myset("PartTime")
        mytable2.Update
        
       mytable2.MoveNext
     Loop
myset.MoveNext
Loop
'End of Expirement
End Sub

Private Sub Label1_Click()

End Sub

Private Sub ListBox1_Click()

End Sub

Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
qq = ListBox1.ListIndex
Sheets(1).Unprotect


master_pay_date = ListBox1.List(qq)
'''''''''''''''''*****************************update status***************
'Call update_status  (not used put into update databases program in vb5
''''''''''''''''''''************************************



ListBox1.Clear
ListBox1.Visible = False
Label1.Visible = False
Sheets(1).Visible = True
 Sheets(1).Activate
'******************Take the color out
   ActiveSheet.Rows("1:63").Select
    'With Selection.Interior
    '    .ColorIndex = 8
    '    .Pattern = xlSolid
    'End With
    'Rows(rr).Select
    Selection.Interior.ColorIndex = xlNone


'***********Hide columns
    ActiveSheet.Columns("a:aj").Select
    Selection.EntireColumn.Hidden = True
   
   With ActiveWindow
        .DisplayGridlines = False
        .DisplayHeadings = False
    End With
 
'Call Experiment
Call Sheets(1).get_employee_list
End Sub

Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Label1, 11, 5, MSForms, Label"
Attribute VB_Control = "CommandButton2, 7, 6, MSForms, CommandButton"

Sub clear_columns()
    ActiveSheet.Range("A6:O83").Select
    Selection.ClearContents
        ActiveSheet.Range("Q6:V83").Select
    Selection.ClearContents
        ActiveSheet.Range("X6:AL83").Select
    Selection.ClearContents
'Set Row Heights
    ActiveSheet.Rows("6:39").Select
    Selection.RowHeight = 17
   
 'Unhide Columns
 
        ActiveSheet.Columns("A:AN").Select
    Selection.EntireColumn.Hidden = False
     ActiveSheet.Range("A6").Select
End Sub
Private Sub CommandButton1_Click()
Debug.Print master_pay_date
Sheets(4).Activate
Sheets(4).Range("A6").Select

'First call clear the columns
Call clear_columns

'data_table_name = "Jan 1"
'worker = InputBox("input employee number")
'Call clear_data
'data_employee_no = Val(worker)
bb = Selection.Row

'selection_key = ActiveSheet.Range("AJ" + Trim(Str(bb))).Value
If OptionButton1.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 1"
End If
If OptionButton2.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 2"
End If
If OptionButton3.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 3"
End If
If OptionButton4.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 4"
End If
If OptionButton5.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 5"
End If

'Data_paydate = "2/1/2004"
'Goback to A5
'ActiveSheet.Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2 As Recordset
'Dim db As TableDefs
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

 cc = Selection.Column
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF


    ActiveSheet.Range("a" + Trim(Str(bb))).Value = mytable2("employeename")
    ActiveSheet.Range("b" + Trim(Str(bb))).Value = mytable2("dailysalary")
    ActiveSheet.Range("c" + Trim(Str(bb))).Value = mytable2("hourlysalary")
    ActiveSheet.Range("d" + Trim(Str(bb))).Value = mytable2("normaldaysworked")
    ActiveSheet.Range("e" + Trim(Str(bb))).Value = mytable2("normalpay")
    ActiveSheet.Range("f" + Trim(Str(bb))).Value = mytable2("undertimehours")
    ActiveSheet.Range("g" + Trim(Str(bb))).Value = mytable2("MinusUT")
    ActiveSheet.Range("h" + Trim(Str(bb))).Value = mytable2("MidshiftHoursWorked")
    ActiveSheet.Range("i" + Trim(Str(bb))).Value = mytable2("MidIncentivePay")
    ActiveSheet.Range("j" + Trim(Str(bb))).Value = mytable2("CatAHoursWorked")
    ActiveSheet.Range("k" + Trim(Str(bb))).Value = mytable2("OvertimeCatAPay")
    ActiveSheet.Range("l" + Trim(Str(bb))).Value = mytable2("CatBHoursWorked")
    ActiveSheet.Range("m" + Trim(Str(bb))).Value = mytable2("OvertimeCatBPay")
    ActiveSheet.Range("n" + Trim(Str(bb))).Value = mytable2("CatCHoursWorked")
    ActiveSheet.Range("o" + Trim(Str(bb))).Value = mytable2("OvertimeCatCPay")
    ActiveSheet.Range("q" + Trim(Str(bb))).Value = mytable2("CatFDaysWorked")
    ActiveSheet.Range("r" + Trim(Str(bb))).Value = mytable2("HolidayCatFPay")
    ActiveSheet.Range("s" + Trim(Str(bb))).Value = mytable2("CatHDaysWorked")
    ActiveSheet.Range("t" + Trim(Str(bb))).Value = mytable2("HolidayCatHPay")
    ActiveSheet.Range("u" + Trim(Str(bb))).Value = mytable2("CatJDaysWorked")
    ActiveSheet.Range("v" + Trim(Str(bb))).Value = mytable2("HolidayCatJPay")
    ActiveSheet.Range("x" + Trim(Str(bb))).Value = mytable2("CatPDaysWorked")
    ActiveSheet.Range("y" + Trim(Str(bb))).Value = mytable2("PremiumCatPPay")
    ActiveSheet.Range("z" + Trim(Str(bb))).Value = mytable2("SILDays")
    ActiveSheet.Range("aa" + Trim(Str(bb))).Value = mytable2("SILPay")
    ActiveSheet.Range("ab" + Trim(Str(bb))).Value = mytable2("GrossPay")
    
    'ActiveSheet.Range(Cells(1, 1), Cells(5, 3)).
     ActiveSheet.Range("al" + Trim(Str(bb))).Value = mytable2("key")
     ActiveSheet.Range("ac" + Trim(Str(bb))).Value = (mytable2("remarks"))
     ActiveSheet.Range("ad" + Trim(Str(bb))).Value = (mytable2("otherdeductions"))
     ActiveSheet.Range("ae" + Trim(Str(bb))).Value = (mytable2("cashadvances"))
     ActiveSheet.Range("af" + Trim(Str(bb))).Value = (mytable2("SSS"))
    ActiveSheet.Range("ag" + Trim(Str(bb))).Value = (mytable2("employeemeals"))
     ActiveSheet.Range("ah" + Trim(Str(bb))).Value = (mytable2("employeecharges"))
    ActiveSheet.Range("ai" + Trim(Str(bb))).Value = (mytable2("netpay"))
     ActiveSheet.Range("aj" + Trim(Str(bb))).Value = (mytable2("Othercomments"))
       ActiveSheet.Range("ak" + Trim(Str(bb))).Value = (mytable2("Shift"))
    
'ActiveSheet.Name = mytable2("employeename")

   'range ab=mytable("otherdedutions")
   'range ac=mytable(cashadvances)
   'range ad=mytable("SSS")
   'range ae=mytable("employeemeals") dont input
   'range af=mytable("employeecharges")
   'range ag=mytable("netpay") don't input
   'range ah=mytable("Othercomments")
   
   'Cells(bb, vc + cc).Value = mytable2(vc + 3)
   
   'ActiveSheet.Range(bb, vc + cc).Value = mytable2(vc)

 
 'saveform.ListBox1.AddItem mytable2("employeename")




mytable2.MoveNext
bb = bb + 1
Loop

mytable2.Close

End Sub

Private Sub CommandButton2_Click()
UserForm5.Show

End Sub
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub CommandButton1_Click()
    Columns("C:C").Select
    Selection.EntireColumn.Hidden = True
        Columns("F:F").Select
    Selection.EntireColumn.Hidden = True
        Columns("J:O").Select
    Selection.EntireColumn.Hidden = True
        Columns("Q:V").Select
    Selection.EntireColumn.Hidden = True
        Columns("X:X").Select
    Selection.EntireColumn.Hidden = True
        Columns("Z:Z").Select
    Selection.EntireColumn.Hidden = True
        Columns("AC:AC").Select
    Selection.EntireColumn.Hidden = True
        Columns("AJ:AJ").Select
    Selection.EntireColumn.Hidden = True
        Columns("AK:AK").Select
    Selection.EntireColumn.Hidden = True
        Columns("AL:AL").Select
    Selection.EntireColumn.Hidden = True
    Range("A5").Select
End Sub
Sub clear_columns()
    ActiveSheet.Range("A6:O130").Select
    Selection.ClearContents
        ActiveSheet.Range("Q6:V130").Select
    Selection.ClearContents
        ActiveSheet.Range("X6:AL130").Select
    Selection.ClearContents
'Set Row Heights
    ActiveSheet.Rows("6:130").Select
    Selection.RowHeight = 17
   
 'Unhide Columns
 
        ActiveSheet.Columns("A:AN").Select
    Selection.EntireColumn.Hidden = False
     ActiveSheet.Range("A6").Select
End Sub
Private Sub CommandButton2_Click()
' garbage Macro
' Macro recorded 5/26/2001 by Danno
'

'
    With ActiveSheet.PageSetup
        .PrintTitleRows = ""
        .PrintTitleColumns = ""
    End With
    'ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
        .LeftMargin = Application.InchesToPoints(1.3)
        .CenterHeader = "Margarita Station Paysheet for paydate" _
 + Chr$(13) + (master_pay_date)
 '" 16 June 2001 to 30 June 2001"
 .CenterFooter = "We herby acknowledge to have received from Margarita Station" _
+ Chr$(13) + " the sum specified opposite our name as full" _
+ Chr$(13) + " compensation for services rendered"
 
'      .LeftHeader = "We herby acknowledge to have received from Margarita Station" _
'+ Chr$(13) + " the sum specified opposite our name as full" _
'+ Chr$(13) + " compensation for services rendered"
        
        .RightMargin = Application.InchesToPoints(0.5)
        .TopMargin = Application.InchesToPoints(1)
        .BottomMargin = Application.InchesToPoints(1)
        .HeaderMargin = Application.InchesToPoints(0.5)
        .FooterMargin = Application.InchesToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = True
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperLegal
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = True
        .Zoom = 85
    End With

End Sub

Private Sub Worksheet_Activate()
Call clear_columns
UserForm4.Show


End Sub

Private Sub Worksheet_Deactivate()
UserForm4.Hide
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Sheets(1).Visible = False
Workbooks("Payroll 2020.xls").Close SaveChanges:=False
End Sub

Private Sub Workbook_Open()
Sheets(1).Visible = True
Sheets(1).Unprotect

Application.GoTo Reference:="Key"
    Selection.ClearContents
    Application.GoTo Reference:="Shift"
    Selection.ClearContents
    Application.GoTo Reference:="EmployeeNumber"
    Selection.ClearContents
    Application.GoTo Reference:="PayDate"
    Selection.ClearContents
    Application.GoTo Reference:="DailySalary"
    Selection.ClearContents
    Application.GoTo Reference:="NormalDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="UndertimeHours"
    Selection.ClearContents
    Application.GoTo Reference:="MidshiftHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatAHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatBHoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatChoursWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatFDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatHDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatJDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="CatPDaysWorked"
    Selection.ClearContents
    Application.GoTo Reference:="SILDays"
    Selection.ClearContents
    Application.GoTo Reference:="Remarks"
    Selection.ClearContents
    Application.GoTo Reference:="OtherDeductions"
    Selection.ClearContents
        Application.GoTo Reference:="CashAdvances"
    Selection.ClearContents
        Application.GoTo Reference:="SSS"
    Selection.ClearContents
        Application.GoTo Reference:="EmployeeCharges"
    Selection.ClearContents
        Application.GoTo Reference:="OtherComments"
    Selection.ClearContents
    ActiveSheet.Name = "Employee"
    Range("A5").Select
   ActiveSheet.Protect DrawingObjects:=True, Contents:=True, Scenarios:=True
   Sheets(1).Visible = False
   
End Sub

Private Sub Workbook_SheetActivate(ByVal Sh As Object)
 
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{BB4F5DDD-BDE3-4F90-93BC-A711BD2E3A79}{DD2763ED-A329-446F-8469-C3D25FB5072A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



Dim start_range As String
Dim end_range As String
Dim rng1 As Range
Dim start_date As Date
Dim end_date As Date



Private Sub Calendar1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)

End Sub

Public Sub Calendar1_Click()


start_date = Calendar1.Value
TextBox3 = start_date
 Selection.AutoFilter
    ActiveSheet.Range("$A$1:$P$4938").AutoFilter Field:=4, Criteria1:= _
        ">1/1/2012", Operator:=xlAnd
Range("d2").Select
Range(ActiveCell, ActiveCell.End(xlDown)).Select
For Each cell In Selection
  
  
  If cell.Value >= start_date Then
   
    
     
   
   
   Range(cell.Address).Select
   
 start_range = (cell.Address)
  Debug.Print start_range
  
  Exit Sub
 
  
  End If
 
 Next cell
 
  
  MsgBox ("This employee had no credits or advances during this pay period!")
  
    
End Sub

Private Sub Calendar2_Click()
If start_date = 0 Then
MsgBox ("You didn't pick a start date.  Pick again")
Exit Sub
End If

Calendar1.Visible = False

end_date = Calendar2.Value
TextBox4 = end_date
If ActiveCell.Offset(1, 0) <> "" Then
Range(ActiveCell, ActiveCell.End(xlDown)).Select
End If
'Range(ActiveCell, ActiveCell.End(xlDown)).Select
For Each cell In Selection
'  If cell.Value = "" Then
'    MsgBox ("can't find the end date,  choose again")
'    GoTo start_again
'End If

  If cell.Value > end_date Then
   Range(cell.Address).Select
   ActiveCell.Offset(-1, 0).Select
   
 end_range = ActiveCell.Address
  Debug.Print end_range
  
  Exit For
 '*****new stuff
  Else
  Range(cell.Address).Select
   ActiveCell.Offset(0, 0).Select
   
 end_range = ActiveCell.Address
  Debug.Print end_range
  '*****************
  End If
 Next cell
'end_range = end_range + ":" + ActiveCell.End(xlToRight)
Range(start_range, end_range).Select
If CommandButton3.Visible = False Then
Call compute_debits
Else
Call compute_times
End If






Calendar2.Visible = False
Calendar1.Visible = False

start_again:

End Sub
Sub compute_times()
Dim total_advance As Single
Dim total_debits As Single
Set rng1 = Range(start_range, ActiveCell.End(xlToRight))
Set rng1 = Range(end_range, ActiveCell.End(xlToRight))
rng1.Select

rng1.Copy

Selection.Interior.ColorIndex = 6

End Sub
Sub compute_debits()
'Dim this_row As Range
Dim total_advance As Single
Dim total_debits As Single
Set rng1 = Range(start_range, ActiveCell.End(xlToRight))
Set rng1 = Range(end_range, ActiveCell.End(xlToRight))
rng1.Select
Selection.Interior.ColorIndex = 6

'rng1.Interior.ColorIndex = 6

For Each cell In Selection
  If cell.Value = 380000 Then
   
  'range.Cells.
      
    cell.Interior.ColorIndex = 3
  cell.Offset(0, 4).Interior.ColorIndex = 3

   total_advance = total_advance + cell.Offset(0, 4).Value
   
    'Row.cell.Interior.ColorIndex = 3
   'this_row.Interior.ColorIndex = 3
   End If
 
   If cell.Value = 1200 Or cell.Value = 2200 Then
    cell.Interior.ColorIndex = 8
    cell.Offset(0, 4).Interior.ColorIndex = 8
    total_debits = total_debits + cell.Offset(0, 4).Value
   
   
   End If
 
 
 Next cell
 Range(end_range).Select
 
 
 
TextBox1 = Abs(total_advance)
TextBox2 = Abs(total_debits)
'UserForm2.TextBox1 = Abs(total_advance)
'UserForm2.TextBox2 = Abs(total_debits)
InputForm.TextBox61.Text = Str(Abs(total_advance))
InputForm.TextBox62.Text = Str(Abs(total_debits))

End Sub

Private Sub CommandButton1_Click()
 
'CommandButton1.Visible = False
Application.DisplayAlerts = False
ActiveWorkbook.Close
Application.DisplayAlerts = True
If current_workbook <> "" Then
Workbooks(current_workbook).Activate
End If

Unload UserForm1
If end_date <> 0 Then
'UserForm2.Show 0
End If
End Sub

Private Sub CommandButton2_Click()
Calendar1.Visible = True
Calendar2.Visible = True
'Range(start_range, end_range).Select
If rng1.Rows <> 0 Then

rng1.Select

Selection.Interior.ColorIndex = xlNone
End If


Range("a1").Select

End Sub

Private Sub CommandButton3_Click()

'InputForm.ListBox1.Clear
If end_date <> 0 Then
 bb = rng1.Rows.Count
 
'For i = 1 To 3
'InputForm.DataGrid1.Columns.Add (i)
'Next i

 
 InputForm.ListBox1.RowSource = rng1.Address
 'UserForm3.ListBox1.RowSource = rng1.Address
'InputForm.DataGrid1.RowSource = rng1.Address
 
 InputForm.ListBox1.ColumnWidths = "55;30;55;30;5"
 'UserForm3.ListBox1.ColumnWidths = "55;30;55;30;5"
  InputForm.TextBox63.Value = bb
 'UserForm3.TextBox1.Value = bb
 
 
 
 
 ' Next Row
End If
Application.DisplayAlerts = False
ActiveWorkbook.Close
Application.DisplayAlerts = True
If current_workbook <> "" Then
Workbooks(current_workbook).Activate
End If


Unload UserForm1
If end_date <> 0 Then
'UserForm3.Show 0
End If

End Sub

Private Sub CommandButton4_Click()
Debug.Print start_date, end_date

End Sub

Private Sub UserForm_Activate()
UserForm1.Height = 347.25
UserForm1.Left = 400

Calendar2.Month = Month(Date)
Calendar2.Day = Day(Date)
Calendar2.Year = Year(Date)
Calendar1.Month = Month(Date)
Calendar1.Day = Day(Date) - 15
Calendar1.Year = Year(Date)
Set rng1 = Range("a1")
End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{07293D53-3308-49EE-A6E8-E26403D774DE}{6DF333AC-D14B-47DF-84DC-9C34AB6A35FA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
Unload UserForm2
Unload UserForm1

End Sub

Private Sub CommandButton2_Click()
TextBox1.Copy
ActiveCell.Value = Val(TextBox1)


End Sub

Private Sub CommandButton3_Click()
TextBox2.Copy
ActiveCell.Value = Val(TextBox2)
End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{B7A153A0-3326-4128-AA10-0312B6AD7B3C}{DEA9CDB8-8DFF-4E45-B628-F5D4D6BE5196}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
'Unload UserForm1
'Unload UserForm3
End Sub

Private Sub CommandButton2_Click()

End Sub

Private Sub ListBox1_Click()

End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub UserForm_Activate()


End Sub

Private Sub UserForm_Click()

End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{92B7293F-B94C-4441-B18E-7EAA4AFEB57D}{389F3227-77C3-4818-925C-0FBA77766DD8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Sub Hide_columns()
    Columns("C:C").Select
    Selection.EntireColumn.Hidden = True
        Columns("F:F").Select
    Selection.EntireColumn.Hidden = True
        Columns("J:O").Select
    Selection.EntireColumn.Hidden = True
        Columns("Q:V").Select
    Selection.EntireColumn.Hidden = True
        Columns("X:X").Select
    Selection.EntireColumn.Hidden = True
        Columns("Z:Z").Select
    Selection.EntireColumn.Hidden = True
        Columns("AC:AC").Select
    Selection.EntireColumn.Hidden = True
        Columns("AJ:AJ").Select
    Selection.EntireColumn.Hidden = True
        Columns("AK:AK").Select
    Selection.EntireColumn.Hidden = True
        Columns("AL:AL").Select
    Selection.EntireColumn.Hidden = True
    Range("A5").Select
End Sub

Sub refresh_paysheet()


Debug.Print master_pay_date
Sheets(4).Activate
Sheets(4).Range("A6").Select
Call Sheets("Printsheet").clear_columns

'First call clear the columns
'Call clear_columns

'data_table_name = "Jan 1"
'worker = InputBox("input employee number")
'Call clear_data
'data_employee_no = Val(worker)
bb = Selection.Row

'selection_key = ActiveSheet.Range("AJ" + Trim(Str(bb))).Value
If OptionButton1.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 1 order by employeename"
End If
If OptionButton2.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 2 order by employeename"
End If
If OptionButton3.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 3 order by employeename"
End If
If OptionButton4.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 4 order by employeename"
End If
If OptionButton5.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where shift = 5 order by employeename"
End If
If OptionButton6.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where Trainee<>true order by employeename"
End If
If OptionButton7.Value = True Then
dancriteria = "select * from [" + master_pay_date + "] where Trainee=true order by employeename"
End If
If master_pay_date = "" Then
xxx = MsgBox("You haven't established a Pay date yet.  Goto the Start Page and start over", 0)
Exit Sub
End If

'Data_paydate = "2/1/2004"
'Goback to A5
'ActiveSheet.Range("A5").Select
' Open the access database
Dim mydb As Database
Dim mytable, mytable2 As Recordset
'Dim db As TableDefs
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

 cc = Selection.Column
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF


    ActiveSheet.Range("a" + Trim(Str(bb))).Value = mytable2("employeename")
    ActiveSheet.Range("b" + Trim(Str(bb))).Value = mytable2("dailysalary")
    ActiveSheet.Range("c" + Trim(Str(bb))).Value = mytable2("hourlysalary")
    ActiveSheet.Range("d" + Trim(Str(bb))).Value = mytable2("normaldaysworked")
    ActiveSheet.Range("e" + Trim(Str(bb))).Value = mytable2("normalpay")
    ActiveSheet.Range("f" + Trim(Str(bb))).Value = mytable2("undertimehours")
    ActiveSheet.Range("g" + Trim(Str(bb))).Value = mytable2("MinusUT")
    ActiveSheet.Range("h" + Trim(Str(bb))).Value = mytable2("MidshiftHoursWorked")
    ActiveSheet.Range("i" + Trim(Str(bb))).Value = mytable2("MidIncentivePay")
    ActiveSheet.Range("j" + Trim(Str(bb))).Value = mytable2("CatAHoursWorked")
    ActiveSheet.Range("k" + Trim(Str(bb))).Value = mytable2("OvertimeCatAPay")
    ActiveSheet.Range("l" + Trim(Str(bb))).Value = mytable2("CatBHoursWorked")
    ActiveSheet.Range("m" + Trim(Str(bb))).Value = mytable2("OvertimeCatBPay")
    ActiveSheet.Range("n" + Trim(Str(bb))).Value = mytable2("CatCHoursWorked")
    ActiveSheet.Range("o" + Trim(Str(bb))).Value = mytable2("OvertimeCatCPay")
    ActiveSheet.Range("q" + Trim(Str(bb))).Value = mytable2("CatFDaysWorked")
    ActiveSheet.Range("r" + Trim(Str(bb))).Value = mytable2("HolidayCatFPay")
    ActiveSheet.Range("s" + Trim(Str(bb))).Value = mytable2("CatHDaysWorked")
    ActiveSheet.Range("t" + Trim(Str(bb))).Value = mytable2("HolidayCatHPay")
    ActiveSheet.Range("u" + Trim(Str(bb))).Value = mytable2("CatJDaysWorked")
    ActiveSheet.Range("v" + Trim(Str(bb))).Value = mytable2("HolidayCatJPay")
    ActiveSheet.Range("x" + Trim(Str(bb))).Value = mytable2("CatPDaysWorked")
    ActiveSheet.Range("y" + Trim(Str(bb))).Value = mytable2("PremiumCatPPay")
    ActiveSheet.Range("z" + Trim(Str(bb))).Value = mytable2("SILDays")
    ActiveSheet.Range("aa" + Trim(Str(bb))).Value = mytable2("SILPay")
    ActiveSheet.Range("ab" + Trim(Str(bb))).Value = mytable2("GrossPay")
    
    'ActiveSheet.Range(Cells(1, 1), Cells(5, 3)).
     ActiveSheet.Range("al" + Trim(Str(bb))).Value = mytable2("key")
     ActiveSheet.Range("ac" + Trim(Str(bb))).Value = (mytable2("remarks"))
     ActiveSheet.Range("ad" + Trim(Str(bb))).Value = (mytable2("otherdeductions"))
     ActiveSheet.Range("ae" + Trim(Str(bb))).Value = (mytable2("cashadvances"))
     ActiveSheet.Range("af" + Trim(Str(bb))).Value = (mytable2("SSS"))
    ActiveSheet.Range("ag" + Trim(Str(bb))).Value = (mytable2("employeemeals"))
     ActiveSheet.Range("ah" + Trim(Str(bb))).Value = (mytable2("employeecharges"))
    ActiveSheet.Range("ai" + Trim(Str(bb))).Value = (mytable2("netpay"))
     ActiveSheet.Range("aj" + Trim(Str(bb))).Value = (mytable2("Othercomments"))
       ActiveSheet.Range("ak" + Trim(Str(bb))).Value = (mytable2("Shift"))
    
'ActiveSheet.Name = mytable2("employeename")

   'range ab=mytable("otherdedutions")
   'range ac=mytable(cashadvances)
   'range ad=mytable("SSS")
   'range ae=mytable("employeemeals") dont input
   'range af=mytable("employeecharges")
   'range ag=mytable("netpay") don't input
   'range ah=mytable("Othercomments")
   
   'Cells(bb, vc + cc).Value = mytable2(vc + 3)
   
   'ActiveSheet.Range(bb, vc + cc).Value = mytable2(vc)

 
 'saveform.ListBox1.AddItem mytable2("employeename")




mytable2.MoveNext
bb = bb + 1
Loop

mytable2.Close
End Sub



Private Sub CommandButton2_Click()


   
    'ActiveSheet.PageSetup.PrintArea = ""
    With ActiveSheet.PageSetup
    
    .LeftMargin = Application.InchesToPoints(1.3)
        .PrintTitleRows = "$1:$5"
        .PrintTitleColumns = ""
        .CenterHeader = "Margarita Station Paysheet for paydate" _
 + Chr$(13) + (master_pay_date)
 '" 16 June 2001 to 30 June 2001"
      .CenterFooter = "We herby acknowledge to have received from Margarita Station" _
+ Chr$(13) + " the sum specified opposite our name as full" _
+ Chr$(13) + " compensation for services rendered"
        
        .RightMargin = Application.InchesToPoints(0.5)
        .TopMargin = Application.InchesToPoints(1)
        .BottomMargin = Application.InchesToPoints(1)
        .HeaderMargin = Application.InchesToPoints(0.5)
        .FooterMargin = Application.InchesToPoints(0.5)
        .PrintHeadings = False
        .PrintGridlines = True
        .PrintComments = xlPrintNoComments
        .CenterHorizontally = False
        .CenterVertically = False
        .Orientation = xlLandscape
        .Draft = False
        .PaperSize = xlPaperLegal
        .FirstPageNumber = xlAutomatic
        .Order = xlDownThenOver
        .BlackAndWhite = True
        .Zoom = 83
    End With
UserForm4.Hide
Rows("6:150").Select
'set the row height
Selection.RowHeight = 15
'set the font
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "Regular"
        .Size = 11
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ColorIndex = xlAutomatic
    End With
'select columns
Columns("a:am").Select
'autofit columns
Selection.Columns.AutoFit
Columns("am").Select
Selection.ColumnWidth = 30

Call Hide_columns
Call shade_rows

paper_size = MsgBox("Have you put a legal size sheet of paper in the printer?", 4)
If paper_size = 7 Then Exit Sub


ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
Call print_statement
End Sub
Sub shade_rows()
' Shades alternate rows with data
    Dim R As Long   'Row Ref
    Dim LastRow As Long
    Dim Tbl
    ActiveSheet.UsedRange
    Set Tbl = Range(Cells(1, 1), ActiveSheet.Cells.SpecialCells(xlCellTypeLastCell))
    LastRow = Tbl.Rows.Count
'   Shade even rows

 For R = 6 To LastRow Step 2
        With Tbl.Rows(R).Interior
            .ColorIndex = 15
            .Pattern = xlSolid
        End With
'   Do not shade odd row above
        Tbl.Rows(R - 1).Interior.ColorIndex = xlNone
    Next

'   Need to Check last row
    If LastRow Mod 2 Then Tbl.Rows(LastRow).Interior.ColorIndex = xlNone
    [A1].Select



End Sub
Sub print_statement()
Sheets("Statement").Select
'ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Preview _
        :=True, Collate:=True
    With ActiveSheet.PageSetup
    
    .LeftMargin = Application.InchesToPoints(1.5)
    End With
    
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Preview:=False, Collate:=True
End Sub

Private Sub CommandButton3_Click()

End Sub

Private Sub OptionButton1_Click()
Call refresh_paysheet
End Sub


Private Sub OptionButton2_Click()
Call refresh_paysheet
End Sub


Private Sub OptionButton3_Click()
Call refresh_paysheet
End Sub


Private Sub OptionButton4_Click()
Call refresh_paysheet
End Sub


Private Sub OptionButton5_Click()
Call refresh_paysheet
End Sub


Private Sub OptionButton6_Click()
Call refresh_paysheet
End Sub

Private Sub OptionButton7_Click()
Call refresh_paysheet
End Sub

Private Sub UserForm_Activate()
OptionButton1.Value = False
OptionButton2.Value = False
OptionButton3.Value = False
OptionButton4.Value = False
OptionButton5.Value = False
OptionButton6.Value = False

End Sub

Private Sub UserForm_Click()

End Sub

Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{EA7C2983-050A-43AB-B5F0-42F1D4CCDA32}{34B95DC3-700F-48C7-981E-1BF3005878F1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub CommandButton1_Click()
If TextBox2.Text = "" Then
cc = MsgBox("You must have an employee number, or you can't add this guy", 0)
If cc = 0 Then Exit Sub
End If

Dim mydb As Database
Dim mytable, mytable2 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

For i = 1 To 24
dancriteria = "select * from [" + paydatetable(i) + "]" ' where employeenumber = " + Str(data_employee_no)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
ff = CDate(paydatetable(i) + ",2020")
mytable2.AddNew
mytable2("paydate") = ff

mytable2("EmployeeName") = UserForm5.TextBox1
mytable2("employeenumber") = Val(UserForm5.TextBox2)
If UserForm5.OptionButton1 = True Then mytable2("shift") = 1
If UserForm5.OptionButton2 = True Then mytable2("shift") = 2
If UserForm5.OptionButton3 = True Then mytable2("shift") = 3
If UserForm5.OptionButton4 = True Then mytable2("shift") = 4
If UserForm5.OptionButton5 = True Then mytable2("shift") = 5
'make number columns 0
  For fieldno = 4 To 28
   mytable2(fieldno) = 0
  Next fieldno
  For fieldno = 30 To 35
  mytable2(fieldno) = 0
  Next fieldno
  

mytable2.Update
Next i
UserForm5.Hide

End Sub

Attribute VB_Name = "UserForm6"
Attribute VB_Base = "0{49242665-ADAF-4073-9EFD-A320F72517CA}{55E8D679-AC4B-4781-A8C4-461C214D2EA0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim terminated_date As Date

Private Sub Calendar1_Click()
terminated_date = Calendar1.Value
CommandButton1.Visible = True
End Sub

Private Sub CommandButton1_Click()
Dim mydb As Database
Dim mytable, mytable2 As Recordset
Dim paydatetable(26) As String

Dim shift_file(10)
'Dim mycriteria As String
'Dim mytabledynaset As snapshot
paydatetable(1) = "Jan 1"
paydatetable(2) = "Jan 16"
paydatetable(3) = "Feb 1"
paydatetable(4) = "Feb 16"
paydatetable(5) = "Mar 1"
paydatetable(6) = "Mar 16"
paydatetable(7) = "Apr 1"
paydatetable(8) = "Apr 16"
paydatetable(9) = "May 1"
paydatetable(10) = "May 16"
paydatetable(11) = "Jun 1"
paydatetable(12) = "Jun 16"
paydatetable(13) = "Jul 1"
paydatetable(14) = "Jul 16"
paydatetable(15) = "Aug 1"
paydatetable(16) = "Aug 16"
paydatetable(17) = "Sep 1"
paydatetable(18) = "Sep 16"
paydatetable(19) = "Oct 1"
paydatetable(20) = "Oct 16"
paydatetable(21) = "Nov 1"
paydatetable(22) = "Nov 16"
paydatetable(23) = "Dec 1"
paydatetable(24) = "Dec 16"
Set mydb = DBEngine.Workspaces(0).OpenDatabase("c:\Payroll 2020\payroll2020.mdb")

For i = 1 To 24
dancriteria = "select * from [" + paydatetable(i) + "]" + " where employeenumber = " + Str(terminated_emp_no)
'Set mytable = mydb.OpenRecordset("buggy", dbOpenDynaset)
Set mytable2 = mydb.OpenRecordset(dancriteria, dbOpenDynaset)
Do Until mytable2.EOF
If mytable2("paydate") >= terminated_date Then
mytable2.Delete
End If
mytable2.MoveNext
Loop
Next i
mydb.Close
UserForm6.Hide
Call Sheets(1).get_employee_list
End Sub

Private Sub UserForm_Activate()
Label2.Caption = terminated_employee
Label3.Caption = terminated_emp_no
CommandButton1.Visible = False

End Sub

Private Sub UserForm_Click()

End Sub


INQUEST-PP=macro
