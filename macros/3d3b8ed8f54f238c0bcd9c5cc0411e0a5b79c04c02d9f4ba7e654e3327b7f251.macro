Attribute VB_Name = "Blad3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Blad6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Sub hyp1()

Application.Goto (Worksheets("Nieuwe aanvraag"))

End Sub
Sub zoekbegrip(row As Integer)

Dim rangerZoek As Range

Set rangerZoek = Worksheets("Nieuwe aanvraag").Range("H" & row)

rangerZoek.Interior.ColorIndex = 0

For Each cell In rangerZoek
    If cell.Value <> "" And Len(cell) > 20 Then
        cell.Interior.ColorIndex = 3
                        
        ElseIf cell.Value = "" Then
        
        cell.Interior.ColorIndex = 15
        
        End If
Next cell

End Sub

Sub RRN()

Dim controlegetal As Double
Dim Deler As Double
Dim laatste2 As Double
Dim eerstecijfer As Double
Dim ranger As Range
Dim ranger1 As Range
Dim counter As Integer

'eerstecijfer = Left(Range("A1"), 1)

Deler = 97
'controlegetal = CDbl(Left(Range("A1"), 9))
'laatste2 = CDbl(Right(Range("A1"), 2))

Set ranger = Worksheets("Nieuwe aanvraag").Range("C11:AO11")
'ranger.Select

For Each cel In ranger
Select Case cel
    Case "Rijksregisternummer (enkel cijfers)":
    counter = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(1, 0).End(xlDown)).Rows.Count
    Set ranger1 = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(counter, 0))
    'MsgBox counter
           'Set rangg4 = Worksheets("Output").Range(cel.Offset(1, 0), cel.Offset((1 + counter), 0))

End Select
Next cel

'ranger1.Select

For Each cell In ranger1

eerstecijfer = Left(cell.Offset(0, 0), 1)
'MsgBox eerstecijfer


Select Case eerstecijfer

Case 1 To 9:

On Error GoTo errcell

controlegetal = CDbl(Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))


If 97 - (controlegetal Mod Deler) = laatste2 Then
   'cell.Offset(0, 1) = "OK"
   cell.Offset(0, 0).Interior.ColorIndex = 50
   
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3

End If

Case 0:

On Error GoTo errcell
controlegetal = CDbl("2" & Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))

If 97 - (controlegetal Mod Deler) = laatste2 Then
    'cell.Offset(0, 1) = "OK"
    cell.Offset(0, 0).Interior.ColorIndex = 50
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3
    
End If
End Select

nextcell:
Next cell
Exit Sub

errcell:
cell.Interior.ColorIndex = 3

Resume nextcell

Call boodschap

finprocedure:
End Sub
Sub boodschap()

For Each celll In ranger1
    If celll.Interior.ColorIndex > 1 Then
    MsgBox "Oei, probleem bij het rijksregisternummer in lijn:" & " " & celll.Offset(0, 0).row
    
    End If
    Next celll
    
End Sub

Sub RRNv2()
Dim controlegetal As Double
Dim Deler As Double
Dim laatste2 As Double
Dim eerstecijfer As String
Dim ranger As Range
Dim ranger1 As Range
Dim counter As Integer
Dim teller As Integer
Dim boodschapRRN As String

boodschapRRN = "Log RRN:" & vbNewLine
'eerstecijfer = Left(Range("A1"), 1)
teller = 0
Deler = 97
'controlegetal = CDbl(Left(Range("A1"), 9))
'laatste2 = CDbl(Right(Range("A1"), 2))

Set ranger = Worksheets("Nieuwe aanvraag").Range("C11:AO11")
'ranger.Select

For Each cel In ranger
Select Case cel
    Case "Rijksregisternummer":
    If cel.Offset(1, 0).Value <> "" Then
    counter = Worksheets("Nieuwe aanvraag").Range(cel.Offset(0, 0), cel.Offset(0, 0).End(xlDown)).Rows.Count
    Set ranger1 = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(counter - 1, 0))
    
    'MsgBox counter
           'Set rangg4 = Worksheets("Output").Range(cel.Offset(1, 0), cel.Offset((1 + counter), 0))
    Else
    GoTo finprocedure
    End If
End Select
Next cel

'ranger1.Select

For Each cell In ranger1

eerstecijfer = Left(cell.Offset(0, 0), 1)
'MsgBox eerstecijfer

Select Case eerstecijfer

Case 1 To 9:

On Error GoTo errcell

controlegetal = CDbl(Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))

If 97 - (controlegetal Mod Deler) = laatste2 Then
   'cell.Offset(0, 1) = "OK"
   cell.Offset(0, 0).Interior.ColorIndex = 4
   cell.Offset(0, 1) = "Rijksregisternummer is ok|fffd|"
   
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3
    'cell.Offset(0, 1) = "controlegetal niet ok, gelieve RRN te checken"
    
    If Len(cell) = 11 Then
        cell.Offset(0, 1).Value = "Rijksregisternummer heeft de juiste lengte (11 karakters), maar er staat een fout in."
        boodschapRRN = boodschapRRN & vbNewLine & "Probleem met het ingevoerde Rijksregisternummer onder lijn " & cell.row
        Else
        cell.Offset(0, 1).Value = "Rijksregisternummer heeft niet de juiste lengte (11 karakters)"
        End If

End If

Case "0":

On Error GoTo errcell
controlegetal = CDbl("2" & Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))

If 97 - (controlegetal Mod Deler) = laatste2 Then
    'cell.Offset(0, 1) = "OK"
    cell.Offset(0, 0).Interior.ColorIndex = 4
    cell.Offset(0, 1) = "Rijksregisternummer is ok|fffd|"
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3
    
        If Len(cell) = 11 Then
        cell.Offset(0, 1).Value = "Rijksregisternummer heeft de juiste lengte (11 karakters), maar er staat een fout in."
        Else
        cell.Offset(0, 1).Value = "Rijksregisternummer heeft niet de juiste lengte (11 karakters)"
        boodschapRRN = boodschapRRN & vbNewLine & "Probleem met het ingevoerde Rijksregisternummer onder lijn " & cell.row
        End If
    
    'cell.Offset(0, 1) = "controlegetal niet ok, gelieve RRN te checken"

End If

Case "N":

If cell.Value = "N/A" Then
    cell.Offset(0, 0).Interior.ColorIndex = 44
    cell.Offset(0, 1) = "Er is geen gewoon Rijksregisternummer"
Else
    cell.Offset(0, 0).Interior.ColorIndex = 3
    cell.Offset(0, 1) = "Gelieve een geldig RR-nummer in te vullen of N/A"
    
End If

Case Else:

cell.Offset(0, 0).Interior.ColorIndex = 3
cell.Offset(0, 1) = "Het eerste teken is foutief, gelieve cijfers te gebruiken"
boodschapRRN = boodschapRRN & vbNewLine & "Probleem met het ingevoerde Rijksregisternummer onder lijn " & cell.row

End Select

nextcell:
Next cell

Exit Sub

errcell:
cell.Interior.ColorIndex = 3

    If Len(cell) = 11 Then
    cell.Offset(0, 1).Value = "Rijksregisternummer heeft de juiste lengte (11 karakters), maar er staat een fout in"
    Else
    cell.Offset(0, 1).Value = "Rijksregisternummer heeft niet de juiste lengte (11 karakters)"
    End If
    
'    If teller > 0 Then MsgBox teller & " " & ("Er bevinden zich fouten, gelieve de feedback bij de rode cellen te checken.")

Resume nextcell

'For Each celll In ranger1
'    If celll.Interior.ColorIndex = 3 Then
'        teller = teller + 1
'
'    End If
'Next celll

finprocedure:
End Sub
Sub bankrekening()
Dim ranger As Range
Dim ranger1 As Range
Dim counter As Integer
Dim links As String
Dim controle As Double
Dim controle2 As Double
Dim test As Long
Dim last2 As Variant
Dim check As Double
Dim checkje As Variant
Dim testNL As Double
Dim resultaat As Variant
Dim ranger2 As Range
Dim ranger3 As Range

Set ranger = Worksheets("Nieuwe aanvraag").Range("C11:AO11")

For Each cel In ranger
    Select Case cel
    Case "Bankrekening":
    If cel.Offset(1, 0) <> "" Then
    
    counter = Worksheets("Nieuwe aanvraag").Range(cel.Offset(0, 0), cel.Offset(0, 0).End(xlDown)).Rows.Count
    
    Set ranger1 = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(counter - 1, 0))
    
    Set ranger2 = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 2), cel.Offset(counter - 1, 2))
    Else
    GoTo finProcedure2
    End If
    End Select
    Next cel
    
ranger2.Interior.ColorIndex = 0

For Each cell In ranger1

cell.Offset(0, 2).Font.Bold = True
    cell.Offset(0, 2).Font.Size = 12
    
    If cell.Offset(0, -2) = "" Then
    cell.Offset(0, -2).Interior.ColorIndex = 3
    cell.Offset(0, 2) = "Zie rode cellen, er ontbreken bank gegevens"
    End If
    
    If cell.Offset(0, -1) = "" Then
    cell.Offset(0, -1).Interior.ColorIndex = 3
    cell.Offset(0, 2) = "Zie rode cellen, er ontbreken bank gegevens"
    End If
    
    If cell.Offset(0, 0) = "" Then
    cell.Offset(0, 0).Interior.ColorIndex = 3
    End If
    
    If cell.Offset(0, 1) = "" Then
    cell.Offset(0, 1).Interior.ColorIndex = 3
    End If
    
    If cell.Offset(0, 3) = "" Then
    cell.Offset(0, 3).Interior.ColorIndex = 3
    End If
    
    

If cell.Offset(0, -2).Value = "BE" Or cell.Offset(0, -2).Value = "be" Then
    
    links = Left(cell.Value, 3)
   'controlegetal = Application.WorksheetFunction.VLookup(links, Worksheets("List_BIC").Range("A1:B5000"), 2, False)
   controle = CDbl(Mid(Replace(cell.Value, "-", ""), 1, 3) & Mid(Replace(cell.Value, "-", ""), 4, 7))
   
   controle2 = Mod97(controle)
   
   'MsgBox controle2
      
   If controle2 = 0 Then
   controle2 = 97
   Else
      controle2 = Mod97(CDbl(Mid(Replace(cell.Value, "-", ""), 1, 3) & Mid(Replace(cell.Value, "-", ""), 4, 7)))
   End If
      
    If (CDbl(Mid(Replace(cell.Value, "-", ""), 11, 2)) - controle2) = 0 Then
    cell.Offset(0, 2).Value = "Controlegetal van rekeningnummer is OK"
    Else
    cell.Offset(0, 2).Value = "Controlegetal van rekeningnummer is niet OK"
    cell.Offset(0, 2).Interior.ColorIndex = 3
    End If
    
resultaat = IsError(Application.VLookup(Trim(Replace(cell.Offset(0, 1), " ", "")), Worksheets("List_BIC").Range("B:B"), 1, False))
'    If Replace(cell.Offset(0, 1).Value, " ", "") = Replace(Application.WorksheetFunction.VLookup(links, Worksheets("List_BIC").Range("A:B"), 2, False), " ", "") Then
'        'spaties spelen geen rol meer, we kijken enkel naar de cijfers
'        cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "Swift-code ok|fffd|"
'        Else
'        'cell.Offset(0, 1).Interior.ColorIndex = 3
'        cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "Swift-code niet ok|fffd|"

    If resultaat = True Then
    cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "Swift-code niet ok|fffd|"
    cell.Offset(0, 2).Interior.ColorIndex = 3
    Else
    cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "Swift-code ok|fffd|"
           
    End If
   
   If Len(cell) <> 14 Then
   cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "Lengte van het rekeningnummer bestaat niet uit 14 tekens"
   
    cell.Offset(0, 2).Interior.ColorIndex = 3
   End If

   last2 = Right(cell.Value, 2)
   check = CDbl(last2 & last2 & "111400")
   checkje = Mid(cell.Offset(0, 3), 3, 2)
        
   test = 98 - XMod(check, 97)
   
   Select Case test
   
   Case 0 To 9:
   
   test = "0" & test
    If test = checkje Then
    cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "controlegetal van IBAN is OK"
    Else: cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "controlegetal van IBAN is niet OK"
    End If
       
   Case Is > 9:
   
    If test = checkje Then
    cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "controlegetal van IBAN is OK"
    Else: cell.Offset(0, 2).Value = cell.Offset(0, 2).Value & vbNewLine & "controlegetal van IBAN is niet OK"
   End If
   End Select
   
    If Len(Replace(cell.Value, "-", "")) <> 12 Then
   cell.Offset(0, 2) = cell.Offset(0, 2) + vbNewLine + "lengte rekeningnummer voldoet niet aan de vereiste (12 karakters)"
    cell.Offset(0, 2).Interior.ColorIndex = 3
    Else
    cell.Offset(0, 2) = cell.Offset(0, 2) + vbNewLine + "lengte IBAN voldoet aan de vereiste (12 karakters)"
    End If
   
    If Len(Replace(cell.Offset(0, 3), " ", "")) <> 16 Then
    cell.Offset(0, 2) = cell.Offset(0, 2) + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (16 karakters)"
    cell.Offset(0, 2).Interior.ColorIndex = 3
    Else
    cell.Offset(0, 2) = cell.Offset(0, 2) + vbNewLine + "lengte IBAN voldoet aan de vereiste (16 karakters)"
    End If
   
    '2
    ElseIf cell.Offset(0, -2).Value = "NL" Or cell.Offset(0, -2).Value = "nl" Then
    
    Call checkNL(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
 
    '3
    ElseIf cell.Offset(0, -2).Value = "DE" Or cell.Offset(0, -2).Value = "de" Then
 
    Call checkDE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '4
    ElseIf cell.Offset(0, -2).Value = "FR" Or cell.Offset(0, -2).Value = "fr" Then
 
    Call checkFR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '5
    ElseIf cell.Offset(0, -2).Value = "LU" Or cell.Offset(0, -2).Value = "lu" Then
 
    Call checkLU(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '6
    ElseIf cell.Offset(0, -2).Value = "MC" Or cell.Offset(0, -2).Value = "mc" Then
 
    Call checkMC(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '7
    ElseIf cell.Offset(0, -2).Value = "GB" Or cell.Offset(0, -2).Value = "gb" Then
 
    Call checkGB(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '8
    ElseIf cell.Offset(0, -2).Value = "PT" Or cell.Offset(0, -2).Value = "pt" Then
 
    Call checkPT(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '9
    ElseIf cell.Offset(0, -2).Value = "TR" Or cell.Offset(0, -2).Value = "tr" Then
 
    Call checkTR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '10
    ElseIf cell.Offset(0, -2).Value = "FI" Or cell.Offset(0, -2).Value = "fi" Then
 
    Call checkFI(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '11
    ElseIf cell.Offset(0, -2).Value = "IT" Or cell.Offset(0, -2).Value = "it" Then
 
    Call checkIT(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '12
    ElseIf cell.Offset(0, -2).Value = "EE" Or cell.Offset(0, -2).Value = "ee" Then
 
    Call checkEE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '13
    ElseIf cell.Offset(0, -2).Value = "CZ" Or cell.Offset(0, -2).Value = "cz" Then
 
    Call checkCZ(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '14
    ElseIf cell.Offset(0, -2).Value = "LB" Or cell.Offset(0, -2).Value = "lb" Then
 
    Call checkLB(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '15
    ElseIf cell.Offset(0, -2).Value = "TN" Or cell.Offset(0, -2).Value = "tn" Then
 
    Call checkTN(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '16
    ElseIf cell.Offset(0, -2).Value = "SE" Or cell.Offset(0, -2).Value = "se" Then
 
    Call checkSE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '17
    ElseIf cell.Offset(0, -2).Value = "CH" Or cell.Offset(0, -2).Value = "ch" Then
 
    Call checkCH(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '18
    ElseIf cell.Offset(0, -2).Value = "AT" Or cell.Offset(0, -2).Value = "at" Then

    Call checkAT(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '19
    ElseIf cell.Offset(0, -2).Value = "ES" Or cell.Offset(0, -2).Value = "es" Then

    Call checkES(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '20
    ElseIf cell.Offset(0, -2).Value = "SK" Or cell.Offset(0, -2).Value = "sk" Then

    Call checkSK(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '21
    ElseIf cell.Offset(0, -2).Value = "PK" Or cell.Offset(0, -2).Value = "pk" Then

    Call checkPK(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '22
    ElseIf cell.Offset(0, -2).Value = "MT" Or cell.Offset(0, -2).Value = "mt" Then

    Call checkMT(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '23
    ElseIf cell.Offset(0, -2).Value = "LV" Or cell.Offset(0, -2).Value = "lv" Then

    Call checkLV(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '24
    ElseIf cell.Offset(0, -2).Value = "QA" Or cell.Offset(0, -2).Value = "qa" Then

    Call checkQA(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '25
    ElseIf cell.Offset(0, -2).Value = "ME" Or cell.Offset(0, -2).Value = "me" Then

    Call checkME(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '26
    ElseIf cell.Offset(0, -2).Value = "SA" Or cell.Offset(0, -2).Value = "sa" Then

    Call checkSA(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '27
    ElseIf cell.Offset(0, -2).Value = "RO" Or cell.Offset(0, -2).Value = "ro" Then

    Call checkRO(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '28
    ElseIf cell.Offset(0, -2).Value = "NO" Or cell.Offset(0, -2).Value = "no" Then

    Call checkNO(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '29
    ElseIf cell.Offset(0, -2).Value = "PL" Or cell.Offset(0, -2).Value = "pl" Then

    Call checkPL(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '30
    ElseIf cell.Offset(0, -2).Value = "RS" Or cell.Offset(0, -2).Value = "rs" Then

    Call checkRS(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '31
    ElseIf cell.Offset(0, -2).Value = "AE" Or cell.Offset(0, -2).Value = "ae" Then

    Call checkAE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '32
    ElseIf cell.Offset(0, -2).Value = "SI" Or cell.Offset(0, -2).Value = "si" Then

    Call checkSI(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '33
    ElseIf cell.Offset(0, -2).Value = "BG" Or cell.Offset(0, -2).Value = "bg" Then

    Call checkBG(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '34
    ElseIf cell.Offset(0, -2).Value = "MU" Or cell.Offset(0, -2).Value = "mu" Then

    Call checkMU(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '35
    ElseIf cell.Offset(0, -2).Value = "GI" Or cell.Offset(0, -2).Value = "gi" Then

    Call checkGI(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '36
    ElseIf cell.Offset(0, -2).Value = "IS" Or cell.Offset(0, -2).Value = "is" Then

    Call checkIS(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '37
    ElseIf cell.Offset(0, -2).Value = "GL" Or cell.Offset(0, -2).Value = "gl" Then

    Call checkGL(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '38
    ElseIf cell.Offset(0, -2).Value = "CY" Or cell.Offset(0, -2).Value = "cy" Then

    Call checkCY(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '39
    ElseIf cell.Offset(0, -2).Value = "LI" Or cell.Offset(0, -2).Value = "li" Then

    Call checkLI(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '40
    ElseIf cell.Offset(0, -2).Value = "JO" Or cell.Offset(0, -2).Value = "jo" Then

    Call checkJO(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '41
    ElseIf cell.Offset(0, -2).Value = "DK" Or cell.Offset(0, -2).Value = "dk" Then

    Call checkDK(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '42
    ElseIf cell.Offset(0, -2).Value = "MA" Or cell.Offset(0, -2).Value = "ma" Then

    Call checkMA(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '43
    ElseIf cell.Offset(0, -2).Value = "AL" Or cell.Offset(0, -2).Value = "al" Then

    Call checkAL(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '44
    ElseIf cell.Offset(0, -2).Value = "BA" Or cell.Offset(0, -2).Value = "ba" Then

    Call checkBA(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '45
    ElseIf cell.Offset(0, -2).Value = "GR" Or cell.Offset(0, -2).Value = "gr" Then

    Call checkGR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '46
    ElseIf cell.Offset(0, -2).Value = "HU" Or cell.Offset(0, -2).Value = "hu" Then

    Call checkHU(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '47
    ElseIf cell.Offset(0, -2).Value = "IE" Or cell.Offset(0, -2).Value = "ie" Then

    Call checkIE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '48
    ElseIf cell.Offset(0, -2).Value = "HR" Or cell.Offset(0, -2).Value = "hr" Then

    Call checkHR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '49
    ElseIf cell.Offset(0, -2).Value = "GE" Or cell.Offset(0, -2).Value = "ge" Then

    Call checkGE(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '50
    ElseIf cell.Offset(0, -2).Value = "AD" Or cell.Offset(0, -2).Value = "ad" Then

    Call checkAD(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '51
    ElseIf cell.Offset(0, -2).Value = "LT" Or cell.Offset(0, -2).Value = "lt" Then

    Call checkLT(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '52
    ElseIf cell.Offset(0, -2).Value = "MK" Or cell.Offset(0, -2).Value = "mk" Then

    Call checkMK(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '53
    ElseIf cell.Offset(0, -2).Value = "FO" Or cell.Offset(0, -2).Value = "fo" Then

    Call checkFO(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '54
    ElseIf cell.Offset(0, -2).Value = "SM" Or cell.Offset(0, -2).Value = "sm" Then
    
    Call checkSM(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '55
    ElseIf cell.Offset(0, -2).Value = "AZ" Or cell.Offset(0, -2).Value = "az" Then

    Call checkAZ(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '56
    ElseIf cell.Offset(0, -2).Value = "BH" Or cell.Offset(0, -2).Value = "bh" Then

    Call checkBH(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '57
    ElseIf cell.Offset(0, -2).Value = "BY" Or cell.Offset(0, -2).Value = "by" Then

    Call checkBY(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '58
    ElseIf cell.Offset(0, -2).Value = "BR" Or cell.Offset(0, -2).Value = "br" Then

    Call checkBR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '59
    ElseIf cell.Offset(0, -2).Value = "CR" Or cell.Offset(0, -2).Value = "cr" Then

    Call checkCR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '60
    ElseIf cell.Offset(0, -2).Value = "DO" Or cell.Offset(0, -2).Value = "do" Then

    Call checkDO(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '61
    ElseIf cell.Offset(0, -2).Value = "KZ" Or cell.Offset(0, -2).Value = "kz" Then

    Call checkKZ(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '62
    ElseIf cell.Offset(0, -2).Value = "XK" Or cell.Offset(0, -2).Value = "xk" Then
   
    Call checkXK(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '63
    ElseIf cell.Offset(0, -2).Value = "KW" Or cell.Offset(0, -2).Value = "kw" Then
    
    Call checkKW(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '64
    ElseIf cell.Offset(0, -2).Value = "MR" Or cell.Offset(0, -2).Value = "mr" Then

    Call checkMR(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '65
    ElseIf cell.Offset(0, -2).Value = "MD" Or cell.Offset(0, -2).Value = "md" Then

    Call checkMD(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))
    '66
    
    ElseIf cell.Offset(0, -2).Value = "DZ" Or cell.Offset(0, -2).Value = "dz" Then

    Call checkDZ(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))

    '67
    
    ElseIf cell.Offset(0, -2).Value = "IQ" Or cell.Offset(0, -2).Value = "iq" Then

    Call checkIQ(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))

    '68
    
    ElseIf cell.Offset(0, -2).Value = "PS" Or cell.Offset(0, -2).Value = "ps" Then

    Call checkPS(cell.Offset(0, 0), cell.Offset(0, -1), Replace(cell.Offset(0, 1), " ", ""), cell.Offset(0, 3), cell.Offset(0, 2))

    
    Else
 
    cell.Offset(0, 2).Value = "Gelieve het bankland BE, NL, DE, FR, LU, GB, PT, TR, IT, EE, CZ, LB, TN, SE, CH, AT, " + _
    "ES, SK, PK, MT, LV, QA, ME, SA, RO, NO, PL, SE, SI, BG, MU, GI, IS, GL, CY, " + _
    "LI, JO, DK, MA, AL, BA, GR, HU, IE, HR, GE, LT, MK, FO, AZ, BH, BY, BR, CR, DO, KZ, XK, KW, MR, MD, DZ, IQ of PS in te vullen, andere landen nog in testfase"
    cell.Offset(0, 2).Interior.ColorIndex = 3
   
    End If
 
 'testNL = XMod(301611180709932375232100D, 97)
'MsgBox 98 - testNL

   Next cell
   
finProcedure2:
End Sub

'Function XMod(ByVal Number As Double, ByVal Divisor As Double) As Double
'        Number = Int(Abs(Number))
'        Divisor = Int(Abs(Divisor))
'        XMod = Number - (Int(Number / Divisor) * Divisor)
'End Function

Function XMod(ByVal Getal As Double, ByVal Deler As Double) As Double
        Getal = Int(Abs(Getal))
        Deler = Int(Abs(Deler))
        XMod = Getal - (Int(Getal / Deler) * Deler)
        
End Function

Sub checkNL(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

Dim eerste As String
Dim tweede As String
Dim derde As String
Dim vierde As String
Dim vijfde As String
Dim zesde As String
Dim zevende As String
Dim achtste As String
Dim negende As String

feedback = ""

Dim controlegetal As Double

If Mid(iban, 5, 4) <> "INGB" Then

eerste = CDbl(Mid(bankrekening, 1, 1) * 1)
tweede = CDbl(Mid(bankrekening, 2, 1) * 2)
derde = CDbl(Mid(bankrekening, 3, 1) * 3)
vierde = CDbl(Mid(bankrekening, 4, 1) * 4)
vijfde = CDbl(Mid(bankrekening, 5, 1) * 5)
zesde = CDbl(Mid(bankrekening, 6, 1) * 6)
zevende = CDbl(Mid(bankrekening, 7, 1) * 7)
achtste = CDbl(Mid(bankrekening, 8, 1) * 8)
negende = CDbl(Mid(bankrekening, 9, 1) * 9)

controlegetal = CDbl(Mid(bankrekening, 1, 1) * 1) + CDbl(Mid(bankrekening, 2, 1) * 2) + CDbl(Mid(bankrekening, 3, 1) * 3) + CDbl(Mid(bankrekening, 4, 1) * 4) + CDbl(Mid(bankrekening, 5, 1) * 5) + CDbl(Mid(bankrekening, 6, 1) * 6) + CDbl(Mid(bankrekening, 7, 1) * 7) + CDbl(Mid(bankrekening, 8, 1) * 8) + CDbl(Mid(bankrekening, 9, 1) * 9)

controlegetal = Mod11(controlegetal)

If controlegetal = Right(bankrekening, 1) And controlegetal = Right(iban, 1) Then
feedback = "Controlenummer rekeningnummer OK"
Else
feedback = "Controlenummer rekeningnummer niet OK"
End If

End If

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(swift1, 4)
'MsgBox swift

reknr = Right(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "2321" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback + vbNewLine + "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback + vbNewLine + "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("D:D"), 1, False))

If resultaat Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If


If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 18 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (18 karakters)"
End If

End Sub

Sub checkDE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Right(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "DE" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("E:E"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub

Sub checkFR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim resultaat As Variant

feedback = ""

reknr = Left(bankrekening, 11)
tester1 = Bankkey & reknr & "00"

tester1 = Replace(tester1, "A", "1")
tester1 = Replace(tester1, "J", "1")
tester1 = Replace(tester1, "B", "2")
tester1 = Replace(tester1, "K", "2")
tester1 = Replace(tester1, "S", "2")
tester1 = Replace(tester1, "T", "3")
tester1 = Replace(tester1, "C", "3")
tester1 = Replace(tester1, "L", "3")
tester1 = Replace(tester1, "M", "4")
tester1 = Replace(tester1, "D", "4")
tester1 = Replace(tester1, "U", "4")
tester1 = Replace(tester1, "V", "5")
tester1 = Replace(tester1, "E", "5")
tester1 = Replace(tester1, "N", "5")
tester1 = Replace(tester1, "O", "6")
tester1 = Replace(tester1, "F", "6")
tester1 = Replace(tester1, "W", "6")
tester1 = Replace(tester1, "X", "7")
tester1 = Replace(tester1, "G", "7")
tester1 = Replace(tester1, "P", "7")
tester1 = Replace(tester1, "H", "8")
tester1 = Replace(tester1, "Y", "8")
tester1 = Replace(tester1, "Q", "8")
tester1 = Replace(tester1, "R", "9")
tester1 = Replace(tester1, "Z", "9")
tester1 = Replace(tester1, "I", "9")

tester1 = 97 - Mod97(tester1)
'MsgBox tester1
rechts = Right(iban, 2)

If tester1 = rechts Then
feedback = "controlegetal rekeningnummer ok|fffd|"
Else
feedback = "controlegetal rekeningnummer niet ok|fffd|"
End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 10)
'MsgBox swift

reknr = Left(bankrekening, 11)
'MsgBox reknr

tester = bankkeytest & reknr & tester1 & "FR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value
cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("F:F"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If


If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If

End Sub

Sub checkLU(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)
'MsgBox swift

reknr = Right(bankrekening, 13)
'MsgBox reknr

tester = bankkeytest & reknr & "LU" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("G:G"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub
Sub checkMC(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim resultaat As Variant

feedback = ""

reknr = Left(bankrekening, 11)
tester1 = Bankkey & reknr & "00"

tester1 = Replace(tester1, "A", "1")
tester1 = Replace(tester1, "J", "1")
tester1 = Replace(tester1, "B", "2")
tester1 = Replace(tester1, "K", "2")
tester1 = Replace(tester1, "S", "2")
tester1 = Replace(tester1, "T", "3")
tester1 = Replace(tester1, "C", "3")
tester1 = Replace(tester1, "L", "3")
tester1 = Replace(tester1, "M", "4")
tester1 = Replace(tester1, "D", "4")
tester1 = Replace(tester1, "U", "4")
tester1 = Replace(tester1, "V", "5")
tester1 = Replace(tester1, "E", "5")
tester1 = Replace(tester1, "N", "5")
tester1 = Replace(tester1, "O", "6")
tester1 = Replace(tester1, "F", "6")
tester1 = Replace(tester1, "W", "6")
tester1 = Replace(tester1, "X", "7")
tester1 = Replace(tester1, "G", "7")
tester1 = Replace(tester1, "P", "7")
tester1 = Replace(tester1, "H", "8")
tester1 = Replace(tester1, "Y", "8")
tester1 = Replace(tester1, "Q", "8")
tester1 = Replace(tester1, "R", "9")
tester1 = Replace(tester1, "Z", "9")
tester1 = Replace(tester1, "I", "9")

tester1 = 97 - Mod97(tester1)
'MsgBox tester1
rechts = Right(iban, 2)

If tester1 = rechts Then
feedback = "controlegetal rekeningnummer ok|fffd|"
Else
feedback = "controlegetal rekeningnummer niet ok|fffd|"
End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 10)
'MsgBox swift

reknr = Left(bankrekening, 11)
'MsgBox reknr

tester = bankkeytest & reknr & tester1 & "MC" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("F:F"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If
End Sub

Sub checkGB(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant
'opletten met bancode en banfiliaalcode die zitten al in de IBAN gelijk met Frankrijk

feedback = ""

bankkeytest = Left(Bankkey, 10)
'MsgBox swift

reknr = Right(bankrekening, 8)
'MsgBox reknr

tester = bankkeytest & reknr & "GB" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("I:I"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 8 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (8 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (8 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub

Sub checkPT(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim resultaat As Variant

feedback = ""

tester1 = Bankkey & bankrekening & "00"

tester1 = Replace(tester1, "A", "1")
tester1 = Replace(tester1, "J", "1")
tester1 = Replace(tester1, "B", "2")
tester1 = Replace(tester1, "K", "2")
tester1 = Replace(tester1, "S", "2")
tester1 = Replace(tester1, "T", "3")
tester1 = Replace(tester1, "C", "3")
tester1 = Replace(tester1, "L", "3")
tester1 = Replace(tester1, "M", "4")
tester1 = Replace(tester1, "D", "4")
tester1 = Replace(tester1, "U", "4")
tester1 = Replace(tester1, "V", "5")
tester1 = Replace(tester1, "E", "5")
tester1 = Replace(tester1, "N", "5")
tester1 = Replace(tester1, "O", "6")
tester1 = Replace(tester1, "F", "6")
tester1 = Replace(tester1, "W", "6")
tester1 = Replace(tester1, "X", "7")
tester1 = Replace(tester1, "G", "7")
tester1 = Replace(tester1, "P", "7")
tester1 = Replace(tester1, "H", "8")
tester1 = Replace(tester1, "Y", "8")
tester1 = Replace(tester1, "Q", "8")
tester1 = Replace(tester1, "R", "9")
tester1 = Replace(tester1, "Z", "9")
tester1 = Replace(tester1, "I", "9")

tester1 = 98 - Mod97(tester1)
'MsgBox tester1
rechts = Right(iban, 2)

If tester1 = rechts Then
feedback = "controlegetal rekeningnummer ok|fffd|"
Else
feedback = "controlegetal rekeningnummer niet ok|fffd|"
End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Right(bankrekening, 11)
'MsgBox reknr

tester = bankkeytest & reknr & tester1 & "PT" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("J:J"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
End If

If Len(bankrekening) <> 11 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (11 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (11 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 25 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (25 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (25 karakters)"
End If

End Sub

Sub checkTR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant
'opletten met bancode en banfiliaalcode die zitten al in de IBAN gelijk met Frankrijk

feedback = ""

bankkeytest = Left(Bankkey, 5)
'MsgBox swift

reknr = Right(bankrekening, 17)
'MsgBox reknr

tester = bankkeytest & reknr & "TR" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("K:K"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 17 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (17 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (17 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 26 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (26 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (26 karakters)"
End If

End Sub

Sub checkFI(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim resultaat As Variant
Dim eerste As String
Dim tweede As String
Dim derde As String
Dim vierde As String
Dim vijfde As String
Dim zesde As String
Dim zevende As String

feedback = ""

Dim controlegetal As Double

controlegetal = CDbl(Mid(bankrekening, 1, 1) * -2) + CDbl(Mid(bankrekening, 2, 1) * -3) + CDbl(Mid(bankrekening, 3, 1) * 6) + CDbl(Mid(bankrekening, 4, 1) * 2) + CDbl(Mid(bankrekening, 5, 1) * 3) + CDbl(Mid(bankrekening, 6, 1) * -6) + CDbl(Mid(bankrekening, 7, 1) * -2)

controlegetal = controlegetal Mod 7

If controlegetal < 0 Then
controlegetal = controlegetal + 7
End If

If controlegetal = Right(bankrekening, 1) And controlegetal = Right(iban, 1) Then
feedback = "Controlenummer rekeningnummer OK"
Else
feedback = "Controlenummer rekeningnummer niet OK"
feedback.Interior.ColorIndex = 3
End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 6)
'MsgBox swift

reknr = Right(bankrekening, 8)
'MsgBox reknr

tester = bankkeytest & reknr & "FI" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback + vbNewLine + "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback + vbNewLine + "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("L:L"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 8 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (8 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (8 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 18 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (18 karakters)"
End If

End Sub

Sub checkIT(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim checkCharBBAN As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 11)
'MsgBox swift

reknr = Right(bankrekening, 12)
'MsgBox reknr
checkCharBBAN = Right(Left(iban, 5), 1)

tester = checkCharBBAN & bankkeytest & reknr & "IT" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN OK"

Else

feedback = "Controlegetal IBAN niet OK"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("M:M"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet OK"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT OK"
    
End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If

End Sub


Sub checkEE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 2)

reknr = Right(bankrekening, 14)

tester = bankkeytest & reknr & "EE" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("N:N"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 14 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (14 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (14 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub
Sub checkCZ(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 16)

tester = bankkeytest & reknr & "CZ" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("O:O"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkLB(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim ibantje As String
Dim resultaat As Variant

feedback = ""

ibantje = Right(iban, 24)

'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 16)

tester = ibantje & "LB" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("P:P"), 1, False))

If IsError(resultaat) Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub

Sub checkTN(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)

reknr = Right(bankrekening, 15)

tester = bankkeytest & reknr & "TN" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("Q:Q"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 15 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (15 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (15 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkSE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)


reknr = Right(bankrekening, 16)


tester = bankkeytest & reknr & "SE" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("R:R"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If


If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkCH(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)

reknr = Right(bankrekening, 16)

tester = bankkeytest & reknr & "CH" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("S:S"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 21 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (21 karakters)"
End If

End Sub
Sub checkAT(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)

reknr = Right(bankrekening, 11)

tester = bankkeytest & reknr & "AT" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("T:T"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 11 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (11 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (11 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub

Sub checkES(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant
Dim eerste As String
Dim tweede As String
Dim derde As String
Dim vierde As String
Dim vijfde As String
Dim zesde As String
Dim zevende As String
Dim achtste As String
Dim negende As String
Dim tiende As String
Dim elfde As String
Dim twaalfde As String
Dim dertiende As String
Dim veertiende As String
Dim vijftiende As String
Dim zestende As String
Dim zeventiende As String
Dim achtiende As String
Dim negentiende As String
Dim twintigste As String
Dim controlegetal1 As Double
Dim controlegetal2 As Double

eerste = CDbl(Mid(iban, 5, 1) * 4)
tweede = CDbl(Mid(iban, 6, 1) * 8)
derde = CDbl(Mid(iban, 7, 1) * 5)
vierde = CDbl(Mid(iban, 8, 1) * 10)
vijfde = CDbl(Mid(iban, 9, 1) * 9)
zesde = CDbl(Mid(iban, 10, 1) * 7)
zevende = CDbl(Mid(iban, 11, 1) * 3)
achtste = CDbl(Mid(iban, 12, 1) * 6)

feedback = ""
 
 'controlegetal1 = eerste + tweede + derde + vierde + vijfde + zesde + zevende + achtste
 
 controlegetal1 = CDbl(Mid(iban, 5, 1) * 4) + CDbl(Mid(iban, 6, 1) * 8) + CDbl(Mid(iban, 7, 1) * 5) + CDbl(Mid(iban, 8, 1) * 10) + CDbl(Mid(iban, 9, 1) * 9) + CDbl(Mid(iban, 10, 1) * 7) + CDbl(Mid(iban, 11, 1) * 3) + CDbl(Mid(iban, 12, 1) * 6)
  
 controlegetal1 = 11 - Mod11(controlegetal1)
  
 If controlegetal1 = 11 Then
    controlegetal1 = 0
    ElseIf controlegetal1 = 10 Then
    controlegetal1 = 1
    
    End If
    
 elfde = CDbl((Mid(iban, 15, 1) * 1))
 twaalfde = CDbl((Mid(iban, 16, 1) * 2))
 dertiende = CDbl((Mid(iban, 17, 1) * 4))
 veertiende = CDbl((Mid(iban, 18, 1) * 8))
 vijftiende = CDbl((Mid(iban, 19, 1) * 5))
 zestende = CDbl((Mid(iban, 20, 1) * 10))
 zeventiende = CDbl((Mid(iban, 21, 1) * 9))
 achtiende = CDbl((Mid(iban, 22, 1) * 7))
 negentiende = CDbl((Mid(iban, 23, 1) * 3))
 twintigste = CDbl((Mid(iban, 24, 1) * 6))
 
    controlegetal2 = CDbl((Mid(iban, 15, 1) * 1)) + CDbl((Mid(iban, 16, 1) * 2)) + CDbl((Mid(iban, 17, 1) * 4)) + CDbl((Mid(iban, 18, 1) * 8)) + CDbl((Mid(iban, 19, 1) * 5)) + CDbl((Mid(iban, 20, 1) * 10)) + CDbl((Mid(iban, 21, 1) * 9)) + CDbl((Mid(iban, 22, 1) * 7)) + CDbl((Mid(iban, 23, 1) * 3)) + CDbl((Mid(iban, 24, 1) * 6))

    controlegetal2 = 11 - Mod11(controlegetal2)

If controlegetal2 = 11 Then
     controlegetal2 = 0
     ElseIf controlegetal2 = 10 Then
     controlegetal2 = 1
    
End If
    
        
    If controlegetal1 = Mid(iban, 13, 1) And controlegetal2 = Mid(iban, 14, 1) Then
        feedback = "Controlenummer rekeningnummer ok|fffd|"
    Else:
        feedback = "Controlenummer rekeningnummer niet ok|fffd|"
    End If
    
bankkeytest = Left(Bankkey, 8)

reknr = Right(bankrekening, 10)

tester = bankkeytest & controlegetal1 & controlegetal2 & reknr & "ES" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback + vbNewLine + "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback + vbNewLine + "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("U:U"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If


If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub
Sub checkSK(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 10)

reknr = Right(bankrekening, 10)

tester = bankkeytest & reknr & "SK" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("V:V"), 1, False))
'zorgen dat de spaties niet meetellen

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkPK(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 16)

tester = bankkeytest & reknr & "PK" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("W:W"), 1, False))
'zorgen dat de spaties niet meetellen

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkMT(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)

reknr = Right(bankrekening, 19)

tester = bankkeytest & reknr & "MT" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("X:X"), 1, False))
'zorgen dat de spaties niet meetellen

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 19 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (19 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (19 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 31 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (31 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (31 karakters)"
End If

End Sub

Sub checkLV(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 13)

tester = bankkeytest & reknr & "LV" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("Y:Y"), 1, False))
'zorgen dat de spaties niet meetellen

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 21 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (21 karakters)"
End If

End Sub
Sub checkQA(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 21)

tester = bankkeytest & reknr & "QA" & "00"

cel = tester

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(Replace(swift1, " ", ""), Worksheets("List_BIC").Range("Z:Z"), 1, False))
'zorgen dat de spaties niet meetellen

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 21 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (21 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 29 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (29 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (29 karakters)"
End If

End Sub

Sub checkME(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim resultaat As Variant
Dim result As String

feedback = ""

rektester = Bankkey & Left(bankrekening, 13) & "00"
result = 98 - Mod97(rektester)

If result = Right(iban, 2) Then
    feedback = "Controlegetal rekeningnummer ok|fffd|"
    Else
    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)
'MsgBox swift

reknr = Left(bankrekening, 15)
'MsgBox reknr

tester = bankkeytest & reknr & "ME" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AA:AA"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 15 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (15 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (15 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub
Sub checkSA(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 2)

reknr = Right(bankrekening, 18)

tester = bankkeytest & reknr & "SA" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AB:AB"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 18 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (18 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub
Sub checkRO(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 16)

tester = bankkeytest & reknr & "RO" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AC:AC"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub
Sub checkNO(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant
Dim controlegetal As Double
Dim result As String
reknrControle1 = Mid(iban, 5, 10)
Dim eerste As String
Dim tweede As String
Dim derde As String
Dim vierde As String
Dim vijfde As String
Dim zesde As String
Dim zevende As String
Dim achtste As String
Dim negende As String
Dim tiende As String

feedback = ""

controlegetal = CDbl(Mid(reknrControle1, 1, 1) * 5) + _
CDbl(Mid(reknrControle1, 2, 1) * 4) + _
CDbl(Mid(reknrControle1, 3, 1) * 3) + _
CDbl(Mid(reknrControle1, 4, 1) * 2) + _
CDbl(Mid(reknrControle1, 5, 1) * 7) + _
CDbl(Mid(reknrControle1, 6, 1) * 6) + _
CDbl(Mid(reknrControle1, 7, 1) * 5) + _
CDbl(Mid(reknrControle1, 8, 1) * 4) + _
CDbl(Mid(reknrControle1, 9, 1) * 3) + _
CDbl(Mid(reknrControle1, 10, 1) * 2)

result = (11 - Mod11(controlegetal))

If result <> Right(iban, 1) Then
    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
    Else
    feedback = "Controlegetal rekeningnummer ok|fffd|"
End If

bankkeytest = Left(Bankkey, 4)

reknr = Right(bankrekening, 7)

tester = bankkeytest & reknr & "NO" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback + vbNewLine + "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback + vbNewLine + "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AD:AD"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 7 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (7 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (7 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 15 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (15 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (15 karakters)"
End If

End Sub
Sub checkPL(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)

reknr = Right(bankrekening, 16)

tester = bankkeytest & reknr & "PL" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AE:AE"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub
Sub checkRS(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant
Dim rektester As String
Dim result As String

feedback = ""
rektester = Bankkey & Left(bankrekening, 13) & "00"
result = 98 - Mod97(rektester)

If result = Right(iban, 2) Then
    feedback = "Controlegetal rekeningnummer ok|fffd|"
    Else
    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    End If

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)

reknr = Right(bankrekening, 15)

tester = bankkeytest & reknr & "RS" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback + vbNewLine + "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback + vbNewLine + "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AF:AF"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 15 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (15 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (15 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub
Sub checkAE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

'iBan = "301611180709932375232100"
'MsgBox 98 - Mod97(iBan)

'MsgBox cel

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)

reknr = Right(bankrekening, 11)

tester = bankkeytest & reknr & "AE" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AG:AG"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 11 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (11 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (11 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 23 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (23 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (23 karakters)"
End If

End Sub

Sub checkSI(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

rektester = Bankkey & Left(bankrekening, 8) & "00"
result = 98 - Mod97(rektester)

If result = Right(iban, 2) Then
    feedback = "Controlegetal rekeningnummer ok|fffd|"
    Else
    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)
'MsgBox swift

reknr = Left(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "SI" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AH:AH"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 19 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (19 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (19 karakters)"
End If


End Sub

Sub checkBG(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'rektester = Bankkey & Left(bankrekening, 8) & "00"
'result = 98 - Mod97(rektester)
'
'If result = Right(iban, 2) Then
'    feedback = "Controlegetal rekeningnummer ok|fffd|"
'    Else
'    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
'    feedback.Interior.ColorIndex = 3
'    End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Left(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "BG" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AI:AI"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub
Sub checkMU(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'rektester = Bankkey & Left(bankrekening, 8) & "00"
'result = 98 - Mod97(rektester)
'
'If result = Right(iban, 2) Then
'    feedback = "Controlegetal rekeningnummer ok|fffd|"
'    Else
'    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
'    feedback.Interior.ColorIndex = 3
'    End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Left(bankrekening, 18)
'MsgBox reknr

tester = bankkeytest & reknr & "MU" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AJ:AJ"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 18 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (18 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 30 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (30 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (30 karakters)"
End If

End Sub

Sub checkGI(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'rektester = Bankkey & Left(bankrekening, 8) & "00"
'result = 98 - Mod97(rektester)
'
'If result = Right(iban, 2) Then
'    feedback = "Controlegetal rekeningnummer ok|fffd|"
'    Else
'    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
'    feedback.Interior.ColorIndex = 3
'    End If

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 15)
'MsgBox reknr

tester = bankkeytest & reknr & "GI" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AK:AK"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 15 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (15 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (15 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 23 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (23 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (23 karakters)"
End If

End Sub

Sub checkIS(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim persIdent As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 6)
'MsgBox swift

reknr = Left(bankrekening, 6)
'MsgBox reknr
persIdent = Right(iban, 10)


tester = bankkeytest & reknr & persIdent & "IS" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AL:AL"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 6 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (6 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (6 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 26 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (26 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (26 karakters)"
End If

End Sub
Sub checkGL(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "GL" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AM:AM"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 18 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (18 karakters)"
End If

End Sub
Sub checkCY(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Left(bankrekening, 16)
'MsgBox reknr

tester = bankkeytest & reknr & "CY" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AN:AN"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub
Sub checkLI(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = bankkeytest & reknr & "LI" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AO:AO"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 21 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (21 karakters)"
End If

End Sub
Sub checkJO(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 22)
'MsgBox reknr

tester = bankkeytest & reknr & "JO" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AP:AP"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 22 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (22 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 30 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (30 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (30 karakters)"
End If

End Sub

Sub checkDK(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & "DK" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AQ:AQ"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 18 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (18 karakters)"
End If

End Sub

Sub checkMA(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

'marokko is een geval apart, hebben ze nu een bankkey en branch key of geen van beide ?
'af te toetsen met de eerste aanvraag

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 0)
'MsgBox swift

reknr = Left(bankrekening, 24)
'MsgBox reknr

tester = bankkeytest & reknr & "MA" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AR:AR"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 24 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (24 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub

Sub checkAL(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 7)
'MsgBox swift

reknr = Left(bankrekening, 17)
'MsgBox reknr

tester = bankkeytest & reknr & "AL" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AS:AS"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 17 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (17 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (17 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub
Sub checkBA(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 6)
'MsgBox swift

reknr = Left(bankrekening, 8)
'MsgBox reknr

testje = bankkeytest & reknr & "00"

 resultaat = 98 - Mod97(testje)

If resultaat = Right(iban, 2) Then

    feedback = "Controlegetal rekeningnummer ok|fffd|"
    
    Else
    
    feeback = "Controlegetal rekeningnummer niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    
    End If

tester = bankkeytest & reknr & resultaat & "BA" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AT:AT"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub

Sub checkGR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 7)
'MsgBox swift

reknr = Left(bankrekening, 16)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "GR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AU:AU"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If

End Sub
Sub checkHU(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 7)
'MsgBox swift

reknr = Left(bankrekening, 17)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "HU" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AV:AV"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 17 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (17 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (17 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub

Sub checkIE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 10)
'MsgBox swift

reknr = Left(bankrekening, 8)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "IE" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AW:AW"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 8 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (8 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (8 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub

Sub checkHR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 7)
'MsgBox swift

reknr = Left(bankrekening, 10)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "HR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AX:AX"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 10 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (10 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (10 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 21 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (21 karakters)"
End If

End Sub

Sub checkAD(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "AD" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AZ:AZ"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkGE(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)
Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 2)
'MsgBox swift

reknr = Left(bankrekening, 16)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "GE" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("AY:AY"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub
Sub checkLT(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 5)
'MsgBox swift

reknr = Left(bankrekening, 11)
'MsgBox reknr

tester = bankkeytest & reknr & resultaat & "LT" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BA:BA"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 11 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (11 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (11 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub
Sub checkMK(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String
Dim tester0 As String

feedback = ""
testje = Left(bankrekening, 10)
tester0 = Bankkey & testje & "00"
resultaat = (98 - Mod97(tester0))

If resultaat = Right(iban, 2) Then
    feedback = "Controlegetal rekeningnummer ok|fffd|"
    
    Else
    feedback = "Controlegetal rekeningnummer niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    
End If
    
'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = bankkeytest & testje & resultaat & "MK" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BB:BB"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 19 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (19 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (19 karakters)"
End If

End Sub

Sub checkFO(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 0)
'MsgBox swift

reknr = Left(bankrekening, 14)
'MsgBox reknr

tester = bankkeytest & reknr & "FO" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BC:BC"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 14 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (14 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (14 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 18 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (18 karakters)"
End If

End Sub
Sub checkSM(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String
Dim bankkeytest As String
Dim bankkeytester As String

feedback = ""

'geen idee hoe ze de check van de bankkey doen, na te gaan

'bankkeytester = ""
'bankkeytest = Left(Bankkey, 1)
'
'bankkeytest = Replace(bankkeytest, "A", "1")
'bankkeytest = Replace(bankkeytest, "B", "2")
'bankkeytest = Replace(bankkeytest, "C", "3")
'bankkeytest = Replace(bankkeytest, "D", "4")
'bankkeytest = Replace(bankkeytest, "E", "5")
'bankkeytest = Replace(bankkeytest, "F", "6")
'bankkeytest = Replace(bankkeytest, "G", "7")
'bankkeytest = Replace(bankkeytest, "H", "8")
'bankkeytest = Replace(bankkeytest, "I", "9")
'bankkeytest = Replace(bankkeytest, "J", "10")
'bankkeytest = Replace(bankkeytest, "K", "11")
'bankkeytest = Replace(bankkeytest, "L", "12")
'bankkeytest = Replace(bankkeytest, "M", "13")
'bankkeytest = Replace(bankkeytest, "N", "14")
'bankkeytest = Replace(bankkeytest, "O", "15")
'bankkeytest = Replace(bankkeytest, "P", "16")
'bankkeytest = Replace(bankkeytest, "Q", "17")
'bankkeytest = Replace(bankkeytest, "R", "18")
'bankkeytest = Replace(bankkeytest, "S", "19")
'bankkeytest = Replace(bankkeytest, "T", "20")
'bankkeytest = Replace(bankkeytest, "U", "21")
'bankkeytest = Replace(bankkeytest, "V", "22")
'bankkeytest = Replace(bankkeytest, "W", "23")
'bankkeytest = Replace(bankkeytest, "X", "24")
'bankkeytest = Replace(bankkeytest, "Y", "25")
'bankkeytest = Replace(bankkeytest, "Z", "26")
'
'
'
'
'bankkeytester = CDbl(Mid(Bankkey, 2, 1) * 1) + CDbl(Mid(Bankkey, 3, 1) * 2) + CDbl(Mid(Bankkey, 4, 1) * 3) + _
'CDbl(Mid(Bankkey, 5, 1) * 4) + CDbl(Mid(Bankkey, 6, 1) * 5) + CDbl(Mid(Bankkey, 7, 1) * 6) + CDbl(Mid(Bankkey, 8, 1) * 7) + _
'CDbl(Mid(Bankkey, 9, 1) * 8) + CDbl(Mid(Bankkey, 10, 1) * 9) + CDbl(Mid(Bankkey, 11, 1) * 10)
'MsgBox CDbl(Mid(Bankkey, 2, 1))
'
'bankkeytester = Mod11(bankkeytester)
'
'If bankkeytest = bankkeytester Then
'    feedback = "Controlegetal bankkey is ok|fffd|"
'
'    Else
'    feedback = "Controlegetal bankkey is niet ok|fffd|"
'    feedback.Interior.ColorIndex = 3
'End If
''MsgBox bankkeytest
''MsgBox bankkeytester

'SWIFT-CODE
bankkeytest = Left(Bankkey, 11)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = bankkeytest & reknr & "SM" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BD:BD"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If

End Sub
Sub checkAZ(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 20)
'MsgBox reknr

tester = bankkeytest & reknr & "AZ" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BE:BE"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 20 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (20 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub
Sub checkBH(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)
Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 14)
'MsgBox reknr

tester = bankkeytest & reknr & "BH" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BF:BF"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 14 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (14 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (14 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub

Sub checkBY(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 8)
'MsgBox swift

reknr = Left(bankrekening, 16)
'MsgBox reknr

tester = bankkeytest & reknr & "BY" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BG:BG"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 16 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (16 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (16 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub

Sub checkBR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 13)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = bankkeytest & reknr & "BR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BH:BH"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 29 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (29 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (29 karakters)"
End If

End Sub
Sub checkCR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)
'MsgBox swift

reknr = Left(bankrekening, 14)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "CR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BI:BI"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 14 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (14 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (14 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 22 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (22 karakters)"
End If

End Sub
Sub checkDO(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String

Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 20)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "DO" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BJ:BJ"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 20 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (20 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 28 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (28 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (28 karakters)"
End If

End Sub
Sub checkKZ(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String

Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 3)
'MsgBox swift

reknr = Left(bankrekening, 13)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "KZ" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BK:BK"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub

Sub checkXK(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 12)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "XK" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BL:BL"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If


If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 20 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (20 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (20 karakters)"
End If

End Sub

Sub checkKW(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String

Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""


'SWIFT-CODE
bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Left(bankrekening, 22)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "KW" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BM:BM"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If


If Len(bankrekening) <> 22 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (22 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (22 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 30 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (30 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (30 karakters)"
End If

End Sub

Sub checkMR(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String
Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 10)
'MsgBox swift

reknr = Left(bankrekening, 13)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "MR" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BN:BN"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 13 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (13 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (13 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 27 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (27 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (27 karakters)"
End If

End Sub

Sub checkMD(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim rechts As String

Dim result As String
Dim rektester As String
Dim testje As String
Dim resultaat As String

feedback = ""

'SWIFT-CODE
bankkeytest = Left(Bankkey, 2)
'MsgBox swift

reknr = Left(bankrekening, 18)
'MsgBox reknr

tester = "0" & bankkeytest & reknr & "MD" & "00"
'MsgBox tester

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)
'MsgBox controlegetal
'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = feedback & vbNewLine & "Controlegetal IBAN ok|fffd|"

Else

feedback = feedback & vbNewLine & "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BO:BO"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"

End If

If Len(bankrekening) <> 18 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (18 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (18 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub
Sub checkDZ(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

bankkeytest = Left(Bankkey, 8)

reknr = Right(bankrekening, 12)

tester = bankkeytest & reknr & "DZ" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN ok|fffd|"

Else

feedback = "Controlegetal IBAN niet ok|fffd|"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BP:BP"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet ok|fffd|"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT ok|fffd|"
    
End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If

If Len(Replace(iban, " ", "")) <> 24 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (24 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (24 karakters)"
End If

End Sub

Sub checkIQ(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim checkCharBBAN As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

bankkeytest = Left(Bankkey, 7)
'MsgBox swift

reknr = Right(bankrekening, 12)
'MsgBox reknr
'checkCharBBAN = Right(Left(iban, 5), 1)

tester = bankkeytest & reknr & "IQ" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN OK"

Else

feedback = "Controlegetal IBAN niet OK"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BQ:BQ"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet OK"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT OK"
    
End If

If Len(bankrekening) <> 12 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (12 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (12 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 23 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (23 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (23 karakters)"
End If

End Sub

Sub checkPS(ByRef bankrekening As String, ByRef Bankkey As String, ByRef swift1 As String, ByRef iban As String, ByRef feedback As Range)

Dim cel As String
Dim checkCharBBAN As String
Dim reknr As String
Dim tester As String
Dim resultaat As Variant

feedback = ""

bankkeytest = Left(Bankkey, 4)
'MsgBox swift

reknr = Right(bankrekening, 21)
'MsgBox reknr
'checkCharBBAN = Right(Left(iban, 5), 1)

tester = bankkeytest & reknr & "PS" & "00"

cel = tester

'cel = Range("D14").Value

cel = Replace(cel, "A", "10")
cel = Replace(cel, "B", "11")
cel = Replace(cel, "C", "12")
cel = Replace(cel, "D", "13")
cel = Replace(cel, "E", "14")
cel = Replace(cel, "F", "15")
cel = Replace(cel, "G", "16")
cel = Replace(cel, "H", "17")
cel = Replace(cel, "I", "18")
cel = Replace(cel, "J", "19")
cel = Replace(cel, "K", "20")
cel = Replace(cel, "L", "21")
cel = Replace(cel, "M", "22")
cel = Replace(cel, "N", "23")
cel = Replace(cel, "O", "24")
cel = Replace(cel, "P", "25")
cel = Replace(cel, "Q", "26")
cel = Replace(cel, "R", "27")
cel = Replace(cel, "S", "28")
cel = Replace(cel, "T", "29")
cel = Replace(cel, "U", "30")
cel = Replace(cel, "V", "31")
cel = Replace(cel, "W", "32")
cel = Replace(cel, "X", "33")
cel = Replace(cel, "Y", "34")
cel = Replace(cel, "Z", "35")

controlegetal = 98 - Mod97(cel)

'moet overeen komen met de cijfers na de NL in het veld IBAN

If Mid(iban, 3, 2) - controlegetal = 0 Then

feedback = "Controlegetal IBAN OK"

Else

feedback = "Controlegetal IBAN niet OK"
feedback.Interior.ColorIndex = 3

End If

resultaat = IsError(Application.VLookup(swift1, Worksheets("List_BIC").Range("BR:BR"), 1, False))

If resultaat = True Then
    feedback = feedback + vbNewLine + "SWIFT niet OK"
    feedback.Interior.ColorIndex = 3
    Else
    feedback = feedback + vbNewLine + "SWIFT OK"
    
End If

If Len(bankrekening) <> 21 Then
feedback = feedback + vbNewLine + "lengte bankrekening voldoet niet aan de vereiste (21 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte bankrekening voldoet aan de vereiste (21 karakters)"
End If
'MsgBox Len(bankrekening)

If Len(Replace(iban, " ", "")) <> 29 Then
feedback = feedback + vbNewLine + "lengte IBAN voldoet niet aan de vereiste (29 karakters)"
feedback.Interior.ColorIndex = 3
Else
feedback = feedback + vbNewLine + "lengte IBAN voldoet aan de vereiste (29 karakters)"
End If

End Sub
Function Mod97(ByVal vIban)
    Dim i, m, digit
    m = 0
    For i = 1 To Len(vIban)
        digit = CInt(Mid(vIban, i, 1))
        m = (10 * m + digit) Mod 97
    Next
    Mod97 = m
End Function

Function Mod11(ByVal vIban)
    Dim i, m, digit
    m = 0
    For i = 1 To Len(vIban)
        digit = CInt(Mid(vIban, i, 1))
        m = (10 * m + digit) Mod 11
    Next
    Mod11 = m
End Function
'Function Mod7(ByVal vIban)
'    Dim i, m, digit
'    m = 0
'    For i = 1 To Len(vIban)
'        digit = CDbl(Mid(vIban, i, 1))
'        m = (10 * m + digit) Mod 7
'    Next
'    Mod7 = m
'End Function


Sub Ondnummer(row As Integer)
Dim ranger As Range
Dim eerste As String
Dim tweede As String
Dim derde As String
Dim result As String
Dim rechts As String
Dim Onummer As String


eerste = ""
tweede = ""
derde = ""
result = ""
Onummer = ""

Set ranger = Worksheets("Nieuwe aanvraag").Range("P" & row)
ranger.Interior.ColorIndex = 0


For Each cel In ranger
    If cel.Value <> "" Then
       
        Onummer = Replace(cel.Value, "BE", "")
        Onummer = Replace(Onummer, ".", "")
               
'        eerste = CDbl(Mid(cel.Value, 3, 4))
'        tweede = CDbl(Mid(cel.Value, 8, 3))
'        derde = CDbl(Mid(cel.Value, 12, 1))

        eerste = CDbl(Mid(Onummer, 1, 8))

        result = eerste

        result = 97 - Mod97(result)

        If result <> Right(cel.Value, 2) Then
            cel.Interior.ColorIndex = 3
            Else
            cel.Interior.ColorIndex = 4
        End If
            
        
    End If
    Next cel
        

End Sub

Sub ON_v2(row As Integer)
Dim ranger As Range
Dim result As String

Set ranger = Worksheets("Nieuwe aanvraag").Range("P" & row)
ranger.Interior.ColorIndex = 0

For Each cel In ranger

    If cel.Value <> "" And Len(cel) = 10 And Mid(cel, 9, 1) <> 0 Then
       
        Onummer = Replace(cel.Value, "BE", "")
        Onummer = Replace(Onummer, ".", "")
               
'        eerste = CDbl(Mid(cel.Value, 3, 4))
'        tweede = CDbl(Mid(cel.Value, 8, 3))
'        derde = CDbl(Mid(cel.Value, 12, 1))
        eerste = CDbl(Mid(Onummer, 1, 8))

        result = eerste

        result = 97 - Mod97(result)

        If result <> Right(cel.Value, 2) Then
            cel.Interior.ColorIndex = 3
            Else
            cel.Interior.ColorIndex = 4
        End If
        
        ElseIf cel.Value <> "" And Len(cel) = 10 And Mid(cel, 9, 1) = 0 Then
        
        Onummer = Replace(cel.Value, "BE", "")
        Onummer = Replace(Onummer, ".", "")
               
'        eerste = CDbl(Mid(cel.Value, 3, 4))
'        tweede = CDbl(Mid(cel.Value, 8, 3))
'        derde = CDbl(Mid(cel.Value, 12, 1))
        eerste = CDbl(Mid(Onummer, 1, 8))

        result = eerste

        result = 97 - Mod97(result)

        If result <> Right(cel.Value, 1) Then
            cel.Interior.ColorIndex = 3
            Else
            cel.Interior.ColorIndex = 4
        End If
        
        ElseIf Len(cel) > 0 And Len(cel) <> 10 Then
            cel.Interior.ColorIndex = 3
            
        
    End If
    Next cel
    
    
        
    'MsgBox CDbl(Mid(Onummer, 1, 8))


End Sub




Attribute VB_Name = "Module2"
Sub Knop3_Klikken()

Dim ranger As Range

'Set ranger = Worksheets("Nieuwe aanvraag").Range("A1")
Application.Goto (Worksheets("Nieuwe aanvraag").Range("A1"))



End Sub


Sub Knop4_Klikken()
Application.Goto (Worksheets("Uitbreiding").Range("A1"))
End Sub
Attribute VB_Name = "Module3"
Sub Knop17_Klikken()
Call Knop15_Klikken
Call bankrekening

End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
Call Knop15_Klikken
Call bankrekening
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)

'deze controles worden gelimiteerd tot 500 lijnen/ aanvragen
On Error GoTo finprocedure

Dim boodschap As String
Dim ranger0 As Range
Dim ranger1 As Range
Dim ranger As Range
Dim ranger2 As Range
Dim ranger3 As Range
Dim ranger4 As Range
Dim ranger5 As Range
Dim ranger6 As Range
Dim ranger7 As Range
Dim ranger8 As Range
Dim ranger9 As Range
Dim ranger10 As Range

Dim counter0 As Integer
Dim counter As Integer
Dim counter2 As Integer
Dim counter3 As Integer
Dim counter4 As Integer
Dim counter5 As Integer
Dim counter6 As Integer
Dim counter7 As Integer
Dim counter8 As Integer
Dim counter9 As Integer
Dim counter10 As Integer


Dim respons As Integer
Dim respons2 As Integer

counter0 = 0
counter = 0
counter2 = 0
counter3 = 0
counter4 = 0
counter5 = 0
counter6 = 0
counter7 = 0
counter8 = 0
counter9 = 0
counter10 = 0

boodschap = ""

Worksheets("Nieuwe aanvraag").Range("D12:AG500").Borders.LineStyle = xlNone
Worksheets("Nieuwe aanvraag").Range("D12:AG500").Interior.ColorIndex = 0

Set ranger0 = Worksheets("Nieuwe aanvraag").Range("D12:D500")
ranger0.Interior.ColorIndex = 0

'basis is de rekeninggroep, eens dit ingevuld is zullen de volgende 9 verplichte cellen gecontroleerd worden
'is dit niet ingevuld gebeurt er niks

    For Each cel0 In ranger0
    If IsEmpty(cel0) = False Then
        
        Worksheets("Nieuwe aanvraag").Range(cel0, cel0.Offset(0, 29)).Borders.LineStyle = xlContinuous
        'Worksheets("Nieuwe aanvraag").Range(cel0, cel0.Offset(0, 28)).Borders.Weight = xlMedium
                
        If UCase(cel0.Value) = "FED1" Or UCase(cel0.Value) = "FED2" Or UCase(cel0.Value) = "FED2" Or UCase(cel0.Value) = "FED3" Or _
        UCase(cel0.Value) = "FED4" Or UCase(cel0.Value) = "FED5" Or UCase(cel0.Value) = "FED6" Or UCase(cel0.Value) = "FED7" Then
        
        For Each cel01 In Range(cel0.Offset(0, 1), cel0.Offset(0, 6))
            If cel01.Value = "" Then
            cel01.Interior.ColorIndex = 3
            counter0 = counter0 + 1
            boodschap = boodschap & vbNewLine & "Gelieve de cel " & _
            Col_Letter(cel01.Column) & cel01.row & " (verplicht veld)" & " in te vullen"
            
            ElseIf cel01.Value <> "" Then
            cel01.Interior.ColorIndex = 0
            End If
            Next cel01
            
            For Each cel02 In Range(cel0.Offset(0, 8), cel0.Offset(0, 11)) 'toevoeging is optioneel, valt dus buiten de controle
            If cel02.Value = "" Then
            cel02.Interior.ColorIndex = 3
            counter0 = counter0 + 1
            boodschap = boodschap & vbNewLine & "Gelieve de cel " & _
            Col_Letter(cel02.Column) & cel02.row & " (verplicht veld)" & " in te vullen"
            
            ElseIf cel02.Value <> "" Then
            cel02.Interior.ColorIndex = 0
            End If
            Next cel02
            
            For Each cel03 In Range(cel0.Offset(0, 27), cel0.Offset(0, 27))
            If cel03.Value = "" Then
            cel03.Interior.ColorIndex = 3
            End If
            Next cel03
            
    
        'Call Ondnummer(cel0.row) 'ondernemingsnummer is optioneel, enkel foutmelding als het een foutie Ondernemingsnummer betreft
        Call ON_v2(cel0.row)
        Call zoekbegrip(cel0.row) 'als er een naam etc. ingevuld is moet het zoekbegrip ingevuld worden
        Call vestNummer(cel0.row)
        
      Else: cel0.Interior.ColorIndex = 3
      
      End If
      
    End If
    
    If UCase(cel0.Value) = "FED3" And cel0.Offset(0, 18) = "" Then 'stamnummer is verplicht voor FED3
        cel0.Offset(0, 18).Interior.ColorIndex = 3
        
    End If
    
    'te kopieren in versie klanten
    
    If UCase(cel0.Value) = "FED3" And cel0.Offset(0, 14) = "" Then 'RRN is verplicht voor FED3
        cel0.Offset(0, 14).Interior.ColorIndex = 46
        
    End If
        
    If UCase(cel0.Value) = "FED1" And cel0.Offset(0, 12) = "" Then 'ON is verplicht voor FED1
        cel0.Offset(0, 12).Interior.ColorIndex = 46
        
    End If
    
    If UCase(cel0.Value) = "FED6" And cel0.Offset(0, 12) = "" Then 'ON is verplicht voor FED6
        cel0.Offset(0, 12).Interior.ColorIndex = 46
        
    End If
    
'    If UCase(cel0.Value) = "FED7" And cel0.Offset(0, 12) = "" Then 'ON is verplicht voor FED7
'        cel0.Offset(0, 12).Interior.ColorIndex = 46
'
'    End If
    
    If UCase(cel0.Value) = "FED1" And cel0.Offset(0, 19) = "" Then 'BTWnummer is verplicht voor FED7
        cel0.Offset(0, 19).Interior.ColorIndex = 46
        
    End If
    
'     If UCase(cel0.Value) = "FED6" And cel0.Offset(0, 19) = "" Then 'BTWnummer is verplicht voor FED7
'        cel0.Offset(0, 19).Interior.ColorIndex = 46
'
'    End If
'
    
    
    'stop
    
    Next cel0
         
Call RRNv2
Call bankrekening

Set ranger = Worksheets("Nieuwe aanvraag").Range("H12:H500")
    For Each cel In ranger
    If cel.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Zoekbegrip te lang (20 karakters max.) onder lijn " & cel.row
        counter = counter + 1
    ElseIf cel.Interior.ColorIndex = 15 Then
        boodschap = boodschap & vbNewLine & "Zoekbegrip leeg onder leeg " & cel.row 'wordt tenietgedaan door de eerste for-lus, komt op hetzelfde neer
        counter = counter + 1
    End If
    Next cel
    
Set ranger2 = Worksheets("Nieuwe aanvraag").Range("R12:R500")
    For Each cell In ranger2
    If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Probleem rijksregisternummer onder lijn " & cell.row
        counter2 = counter2 + 1
        'te kopieren naar klanten
    ElseIf cell.Interior.ColorIndex = 46 Then
        boodschap = boodschap & vbNewLine & "Gelieve het rijksregisternummer onder lijn " & cell.row & " in te vullen"
        counter2 = counter2 + 1
        'stop
    End If
    Next cell
    
Set ranger3 = Worksheets("Nieuwe aanvraag").Range("AB12:AB500")
    For Each cell In ranger3
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Probleem bankgegevens onder lijn " & cell.row
        counter3 = counter3 + 1
    End If
    Next cell
    
    Set ranger4 = Worksheets("Nieuwe aanvraag").Range("P12:P500")
    For Each cell In ranger4
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Probleem ondernemingsnummer onder lijn " & cell.row
        counter4 = counter4 + 1
        'te kopieren naar klanten
        ElseIf cell.Interior.ColorIndex = 46 Then
        boodschap = boodschap & vbNewLine & "Gelieve het ondernemingsnummer onder lijn " & cell.row & " in te vullen"
        counter4 = counter4 + 1
        'stop
    End If
    Next cell
    
    Set ranger5 = Worksheets("Nieuwe aanvraag").Range("D12:D500")
    For Each cell In ranger5
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Gelieve FED1, FED2, FED3, FED4, FED5, FED6 of FED7 in te vullen onder lijn " & cell.row
        counter5 = counter5 + 1
    End If
    Next cell
    
    Set ranger6 = Worksheets("Nieuwe aanvraag").Range("AE12:AE500")
    For Each cell In ranger6
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Gelieve de betalingsconditie in te vullen onder lijn " & cell.row
        counter6 = counter6 + 1
    End If
    Next cell
    
    Set ranger7 = Worksheets("Nieuwe aanvraag").Range("V12:V500")
    For Each cell In ranger7
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Gelieve het stamnummer in te vullen onder lijn " & cell.row
        counter7 = counter7 + 1
    End If
    Next cell
    
    Set ranger8 = Worksheets("Nieuwe aanvraag").Range("Q12:Q500")
    For Each cell In ranger8
     If cell.Interior.ColorIndex = 3 Then
        boodschap = boodschap & vbNewLine & "Probleem vestigingsnummer onder lijn " & cell.row
        counter8 = counter8 + 1
    End If
    Next cell
    
    Set ranger9 = Worksheets("Nieuwe aanvraag").Range("W12:W500")
    For Each cell In ranger9
     If cell.Interior.ColorIndex = 46 Then
        boodschap = boodschap & vbNewLine & "Gelieve het BTW-nummer onder lijn " & cell.row & " in te vullen"
        counter9 = counter9 + 1
    End If
    Next cell
    
If counter0 + counter + counter2 + counter3 + counter4 + counter5 + counter6 + counter7 + counter8 > 0 Then
    MsgBox boodschap, vbCritical, "Error Log: Acties vereist"
    
Else
    respons = MsgBox("De aanvraag bevat geen fouten." & vbNewLine & _
    "Je kan de aanvraag sturen naar Fedmasterdata verzenden door op ja te klikken", vbYesNo + vbQuestion, "Document verzenden?")
    If respons = vbYes Then
    'Call Mail_workbook_Outlook_1
    Call Mail_Sheets_Array
'    ElseIf respons = vbNo Then
'    respons2 = MsgBox("Bent u zeker dat je het document niet wil verzenden", vbYesNo + vbQuestion)
'        If respons2 = vbNo Then
'        Call Mail_Sheets_Array
'        End If
    End If
End If

Exit Sub

finprocedure:

MsgBox "Er is een probleem met de ingevulde gegevens.", vbCritical, "Foute input"

End Sub

Function ColumnLetter(ColumnNumber As Long) As String
    Dim n As Long
    Dim c As Byte
    Dim s As String

    n = ColumnNumber
    Do
        c = ((n - 1) Mod 26)
        s = Chr(c + 65) & s
        n = (n - c) \ 26
        
    Loop While n > 0
    ColumnLetter = s
End Function

Function Col_Letter(lngCol As Long) As String
Dim vArr
vArr = Split(Cells(1, lngCol).Address(True, False), "$")
Col_Letter = vArr(0)
End Function

Sub Mail_workbook_Outlook_1()

'volledige workbook

    Dim OutApp As Object
    Dim OutMail As Object

    Set OutApp = CreateObject("Outlook.Application")
    Set OutMail = OutApp.CreateItem(0)

    On Error Resume Next
    With OutMail
        .To = "fedmasterdata@ibz.fgov.be"
        .CC = ""
        .BCC = ""
        .Subject = "Aanvraag Leverancier"
        .Body = ""
        .Attachments.Add ActiveWorkbook.FullName
        'You can add other files also like this
        '.Attachments.Add ("C:\test.txt")
        '.Send
        .Display
    End With
    On Error GoTo 0

    Set OutMail = Nothing
    Set OutApp = Nothing
End Sub

Sub Mail_Sheets_Array()
'Working in Excel 2000-2016
'For Tips see: http://www.rondebruin.nl/win/winmail/Outlook/tips.htm
    Dim FileExtStr As String
    Dim FileFormatNum As Long
    Dim Sourcewb As Workbook
    Dim Destwb As Workbook
    Dim TempFilePath As String
    Dim TempFileName As String
    Dim OutApp As Object
    Dim OutMail As Object
    Dim sh As Worksheet
    Dim TheActiveWindow As Window
    Dim TempWindow As Window

    With Application
        .ScreenUpdating = False
        .EnableEvents = False
    End With

    Set Sourcewb = ActiveWorkbook

    'Copy the sheets to a new workbook
    'We add a temporary Window to avoid the Copy problem
    'if there is a List or Table in one of the sheets and
    'if the sheets are grouped
    With Sourcewb
        Set TheActiveWindow = ActiveWindow
        Set TempWindow = .NewWindow
        .Sheets(Array("Nieuwe aanvraag", "Uitbreiding")).Copy
    End With

    'Close temporary Window
    TempWindow.Close

    Set Destwb = ActiveWorkbook

    'Determine the Excel version and file extension/format
    With Destwb
        If Val(Application.Version) < 12 Then
            'You use Excel 97-2003
            FileExtStr = ".xls": FileFormatNum = -4143
        Else
            'You use Excel 2007-2016
            Select Case Sourcewb.FileFormat
            Case 51: FileExtStr = ".xlsx": FileFormatNum = 51
            Case 52:
                If .HasVBProject Then
                    FileExtStr = ".xlsm": FileFormatNum = 52
                Else
                    FileExtStr = ".xlsx": FileFormatNum = 51
                End If
            Case 56: FileExtStr = ".xls": FileFormatNum = 56
            Case Else: FileExtStr = ".xlsb": FileFormatNum = 50
            End Select
        End If
    End With

    '    'Change all cells in the worksheets to values if you want
    '    For Each sh In Destwb.Worksheets
    '        sh.Select
    '        With sh.UsedRange
    '            .Cells.Copy
    '            .Cells.PasteSpecial xlPasteValues
    '            .Cells(1).Select
    '        End With
    '        Application.CutCopyMode = False
    '        Destwb.Worksheets(1).Select
    '    Next sh

    'Save the new workbook/Mail it/Delete it
    TempFilePath = Environ$("temp") & "\"
   ' TempFileName = "Nieuwe aanvraag Masterdata leveranciers dd. " & " " & Format(Now, "dd-mmm-yy")
    TempFileName = "Nieuwe aanvraag Masterdata Leveranciers dd. " & " " & Format(Now, "dd-mmm-yy") & " " & Application.UserName
'& Sourcewb.Name & " " '

    Set OutApp = CreateObject("Outlook.Application")
    Set OutMail = OutApp.CreateItem(0)

    With Destwb
        .SaveAs TempFilePath & TempFileName & FileExtStr, FileFormat:=FileFormatNum
        On Error Resume Next
        With OutMail
            .To = "fedmasterdata@ibz.fgov.be"
            .CC = ""
            .BCC = ""
            .Subject = "Nieuwe aanvraag MD leveranciers"
            .Body = "..."
            .Attachments.Add Destwb.FullName
            'You can add other files also like this
            '.Attachments.Add ("C:\test.txt")
            .Display
        End With
        On Error GoTo 0
        .Close savechanges:=False
    End With

    'Delete the file you have send
    Kill TempFilePath & TempFileName & FileExtStr

    Set OutMail = Nothing
    Set OutApp = Nothing

    With Application
        .ScreenUpdating = True
        .EnableEvents = True
    End With
End Sub

Sub RRN()

Dim controlegetal As Double
Dim Deler As Double
Dim laatste2 As Double
Dim eerstecijfer As Double
Dim ranger As Range
Dim ranger1 As Range
Dim counter As Integer

'eerstecijfer = Left(Range("A1"), 1)

Deler = 97
'controlegetal = CDbl(Left(Range("A1"), 9))
'laatste2 = CDbl(Right(Range("A1"), 2))

Set ranger = Worksheets("Nieuwe aanvraag").Range("C11:AM11")
'ranger.Select

For Each cel In ranger
Select Case cel
    Case "Rijksregisternummer (enkel cijfers)":
    counter = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(1, 0).End(xlDown)).Rows.Count
    Set ranger1 = Worksheets("Nieuwe aanvraag").Range(cel.Offset(1, 0), cel.Offset(counter, 0))
    'MsgBox counter
           'Set rangg4 = Worksheets("Output").Range(cel.Offset(1, 0), cel.Offset((1 + counter), 0))

End Select
Next cel

'ranger1.Select

For Each cell In ranger1


eerstecijfer = Left(cell.Offset(0, 0), 1)
'MsgBox eerstecijfer


Select Case eerstecijfer

Case 1 To 9:

On Error GoTo errcell

controlegetal = CDbl(Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))


If 97 - (controlegetal Mod Deler) = laatste2 Then
   'cell.Offset(0, 1) = "OK"
   cell.Offset(0, 0).Interior.ColorIndex = 50
   
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3

End If


Case 0:

On Error GoTo errcell
controlegetal = CDbl("2" & Left(cell, 9))
laatste2 = CDbl(Right(cell, 2))

If 97 - (controlegetal Mod Deler) = laatste2 Then
    'cell.Offset(0, 1) = "OK"
    cell.Offset(0, 0).Interior.ColorIndex = 50
    Else
    'cell.Offset(0, 1) = "NOK"
    cell.Offset(0, 0).Interior.ColorIndex = 3

End If
End Select

nextcell:
Next cell
Exit Sub

errcell:
cell.Interior.ColorIndex = 3

Resume nextcell

Call boodschap

finprocedure:
End Sub
Sub boodschap()

For Each celll In ranger1
    If celll.Interior.ColorIndex > 1 Then
    MsgBox "Oei, probleem bij het rijksregisternummer in lijn:" & " " & celll.Offset(0, 0).row
    
    End If
    Next celll
    
End Sub

Sub vestNummer(row As Integer)
Dim ranger As Range
Dim eerste As String
Dim tweede As String
Dim derde As String
Dim result As String
Dim rechts As String
Dim Onummer As String


eerste = ""
tweede = ""
derde = ""
result = ""
Onummer = ""

Set ranger = Worksheets("Nieuwe aanvraag").Range("Q" & row)
ranger.Interior.ColorIndex = 0


For Each cel In ranger

    If cel.Value <> "" And Len(cel) = 10 And Mid(cel, 9, 1) <> 0 Then
       
        Onummer = Replace(cel.Value, "BE", "")
        Onummer = Replace(Onummer, ".", "")
               
'        eerste = CDbl(Mid(cel.Value, 3, 4))
'        tweede = CDbl(Mid(cel.Value, 8, 3))
'        derde = CDbl(Mid(cel.Value, 12, 1))
        eerste = CDbl(Mid(Onummer, 1, 8))

        result = eerste

        result = 97 - Mod97(result)

        If result <> Right(cel.Value, 2) Then
            cel.Interior.ColorIndex = 3
            Else
            cel.Interior.ColorIndex = 4
        End If
        
        ElseIf cel.Value <> "" And Len(cel) = 10 And Mid(cel, 9, 1) = 0 Then
        
        Onummer = Replace(cel.Value, "BE", "")
        Onummer = Replace(Onummer, ".", "")
               
'        eerste = CDbl(Mid(cel.Value, 3, 4))
'        tweede = CDbl(Mid(cel.Value, 8, 3))
'        derde = CDbl(Mid(cel.Value, 12, 1))
        eerste = CDbl(Mid(Onummer, 1, 8))

        result = eerste

        result = 97 - Mod97(result)

        If result <> Right(cel.Value, 1) Then
            cel.Interior.ColorIndex = 3
            Else
            cel.Interior.ColorIndex = 4
        End If
        
        ElseIf Len(cel) > 0 And Len(cel) <> 10 Then
            cel.Interior.ColorIndex = 3
            
        
    End If
    Next cel
        

End Sub





INQUEST-PP=macro
