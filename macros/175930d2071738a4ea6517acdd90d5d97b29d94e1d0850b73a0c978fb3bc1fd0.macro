Attribute VB_Name = "DATA"
Option Explicit

Public Const color_filled As Long = 16777215 'white
Public Const color_default As Long = 16777215 'white
Public Const color_default_2 As Long = 12632256 'gray
Public Const color_highlighted As Long = 65535 'yellow

Public Const default_country_item_text As String = "Vyberte"

Public Function countries() As String

'data structure:        CODE; NAME; US RELEVANT; CRS RELEVANT|
countries = countries & "AF;AFGHANISTAN;NO;NO|"
countries = countries & "AX;ALAND ISLANDS;NO;NO|"
countries = countries & "AL;ALBANIA;NO;NO|"
countries = countries & "DZ;ALGERIA;NO;NO|"
countries = countries & "AS;AMERICAN SAMOA;NO;NO|"
countries = countries & "AD;ANDORRA;NO;NO|"
countries = countries & "AO;ANGOLA;NO;NO|"
countries = countries & "AI;ANGUILLA;NO;NO|"
countries = countries & "AQ;ANTARCTICA;NO;NO|"
countries = countries & "AG;ANTIGUA AND BARBUDA;NO;NO|"
countries = countries & "AR;ARGENTINA;NO;NO|"
countries = countries & "AM;ARMENIA;NO;YES|"
countries = countries & "AW;ARUBA;NO;NO|"
countries = countries & "AU;AUSTRALIA;NO;NO|"
countries = countries & "AT;AUSTRIA;NO;YES|"
countries = countries & "AZ;AZERBAIJAN;NO;YES|"
countries = countries & "BS;BAHAMAS;NO;NO|"
countries = countries & "BH;BAHRAIN;NO;YES|"
countries = countries & "BD;BANGLADESH;NO;NO|"
countries = countries & "BB;BARBADOS;NO;YES|"
countries = countries & "BY;BELARUS;NO;YES|"
countries = countries & "BE;BELGIUM;NO;YES|"
countries = countries & "BZ;BELIZE;NO;YES|"
countries = countries & "BJ;BENIN;NO;NO|"
countries = countries & "BM;BERMUDA;NO;YES|"
countries = countries & "BT;BHUTAN;NO;NO|"
countries = countries & "BO;BOLIVIA;NO;NO|"
countries = countries & "BQ;BONAIRE,SAINT EUSTATIUS,SABA;NO;NO|"
countries = countries & "BA;BOSNIA AND HERZEGOVINA;NO;YES|"
countries = countries & "BW;BOTSWANA;NO;NO|"
countries = countries & "BV;BOUVET ISLAND;NO;NO|"
countries = countries & "BR;BRAZIL;NO;YES|"
countries = countries & "IO;BRITISH INDIAN OCEAN TERRITORY;NO;NO|"
countries = countries & "BN;BRUNEI DARUSSALAM;NO;YES|"
countries = countries & "BG;BULGARIA;NO;YES|"
countries = countries & "BF;BURKINA FASO;NO;NO|"
countries = countries & "BI;BURUNDI;NO;NO|"
countries = countries & "KH;CAMBODIA;NO;NO|"
countries = countries & "CM;CAMEROON;NO;YES|"
countries = countries & "CA;CANADA;NO;YES|"
countries = countries & "CV;CAPE VERDE;NO;NO|"
countries = countries & "KY;CAYMAN ISLANDS;NO;YES|"
countries = countries & "CF;CENTRAL AFRICAN REPUBLIC;NO;NO|"
countries = countries & "CC;COCOS (KEELING) ISLANDS;NO;NO|"
countries = countries & "CO;COLOMBIA;NO;YES|"
countries = countries & "KM;COMOROS;NO;NO|"
countries = countries & "CG;CONGO;NO;NO|"
countries = countries & "CD;CONGO (THE DEMOCRATIC REPUBLIC OF THE);NO;NO|"
countries = countries & "CK;COOK ISLANDS;NO;YES|"
countries = countries & "CR;COSTA RICA;NO;YES|"
countries = countries & "CI;COTE D' IVOIRE;NO;NO|"
countries = countries & "HR;CROATIA;NO;NO|"
countries = countries & "CU;CUBA;NO;NO|"
countries = countries & "CW;CURA|fffd|AO;NO;YES|"
countries = countries & "CY;CYPRUS;NO;NO|"
countries = countries & "CZ;CZECH REPUBLIC;NO;NO|"
countries = countries & "DK;DENMARK;NO;YES|"
countries = countries & "DJ;DJIBOUTI;NO;NO|"
countries = countries & "DM;DOMINICA;NO;YES|"
countries = countries & "DO;DOMINICAN REPUBLIC;NO;NO|"
countries = countries & "EC;ECUADOR;NO;NO|"
countries = countries & "EG;EGYPT;NO;YES|"
countries = countries & "SV;EL SALVADOR;NO;YES|"
countries = countries & "GQ;EQUATORIAL GUINEA;NO;NO|"
countries = countries & "ER;ERITREA;NO;NO|"
countries = countries & "EE;ESTONIA;NO;YES|"
countries = countries & "ET;ETHIOPIA;NO;YES|"
countries = countries & "FK;FALKLAND ISLANDS (MALVINAS);NO;NO|"
countries = countries & "FO;FAROE ISLANDS;NO;YES|"
countries = countries & "FJ;FIJI;NO;NO|"
countries = countries & "FI;FINLAND;NO;YES|"
countries = countries & "FR;FRANCE;NO;YES|"
countries = countries & "GF;FRENCH GUIANA;NO;NO|"
countries = countries & "PF;FRENCH POLYNESIA;NO;NO|"
countries = countries & "TF;FRENCH SOUTHERN TERRITORIES;NO;NO|"
countries = countries & "GA;GABON;NO;YES|"
countries = countries & "GM;GAMBIA;NO;NO|"
countries = countries & "GE;GEORGIA;NO;YES|"
countries = countries & "DE;GERMANY;NO;YES|"
countries = countries & "GH;GHANA;NO;NO|"
countries = countries & "GI;GIBRALTAR;NO;YES|"
countries = countries & "GR;GREECE;NO;YES|"
countries = countries & "GL;GREENLAND;NO;NO|"
countries = countries & "GD;GRENADA;NO;NO|"
countries = countries & "GP;GUADELOUPE;NO;NO|"
countries = countries & "GU;GUAM;NO;NO|"
countries = countries & "GT;GUATEMALA;NO;YES|"
countries = countries & "GG;GUERNSEY;NO;NO|"
countries = countries & "GN;GUINEA;NO;NO|"
countries = countries & "GW;GUINEA-BISSAU;NO;NO|"
countries = countries & "GY;GUYANA;NO;NO|"
countries = countries & "HT;HAITI;NO;NO|"
countries = countries & "HM;HEARD ISLAND AND MCDONALD ISLAND;NO;NO|"
countries = countries & "VA;HOLY SEE (VATICAN CITY STATE);NO;NO|"
countries = countries & "HN;HONDURAS;NO;NO|"
countries = countries & "HK;HONG KONG;NO;NO|"
countries = countries & "HU;HUNGARY;NO;NO|"
countries = countries & "TD;CHAD;NO;NO|"
countries = countries & "CL;CHILE;NO;YES|"
countries = countries & "CN;CHINA;NO;YES|"
countries = countries & "CX;CHRISTMAS ISLAND;NO;NO|"
countries = countries & "IS;ICELAND;NO;YES|"
countries = countries & "IN;INDIA;NO;YES|"
countries = countries & "ID;INDONESIA;NO;YES|"
countries = countries & "IR;IRAN (THE ISLAMIC REPUBLIC OF);NO;NO|"
countries = countries & "IQ;IRAQ;NO;NO|"
countries = countries & "IE;IRELAND;NO;YES|"
countries = countries & "IM;ISLE OF MAN;NO;YES|"
countries = countries & "IL;ISRAEL;NO;YES|"
countries = countries & "IT;ITALY;NO;YES|"
countries = countries & "JM;JAMAICA;NO;NO|"
countries = countries & "JP;JAPAN;NO;YES|"
countries = countries & "JE;JERSEY;NO;YES|"
countries = countries & "JO;JORDAN;NO;YES|"
countries = countries & "KZ;KAZAKHSTAN;NO;YES|"
countries = countries & "KE;KENYA;NO;NO|"
countries = countries & "KI;KIRIBATI;NO;NO|"
countries = countries & "KP;KOREA (THE DEMOCRATIC PEOPLE'S REPUBLIC OF);NO;NO|"
countries = countries & "KR;KOREA (THE REPUBLIC OF);NO;YES|"
countries = countries & "KW;KUWAIT;NO;YES|"
countries = countries & "KG;KYRGYZSTAN;NO;NO|"
countries = countries & "LA;LAO PEOPLE'S DEMOCRATIC REPUBLIC;NO;NO|"
countries = countries & "LV;LATVIA;NO;NO|"
countries = countries & "LB;LEBANON;NO;YES|"
countries = countries & "LS;LESOTHO;NO;NO|"
countries = countries & "LR;LIBERIA;NO;NO|"
countries = countries & "LY;LIBYAN ARAB JAMAHIRIYA;NO;NO|"
countries = countries & "LI;LIECHTENSTEIN;NO;NO|"
countries = countries & "LT;LITHUANIA;NO;NO|"
countries = countries & "LU;LUXEMBOURG;NO;NO|"
countries = countries & "MO;MACAO;NO;NO|"
countries = countries & "MK;MACEDONIA (THE FORMER YUGOSLAV REPUBLIC OF);NO;YES|"
countries = countries & "MG;MADAGASCAR;NO;NO|"
countries = countries & "MW;MALAWI;NO;NO|"
countries = countries & "MY;MALAYSIA;NO;NO|"
countries = countries & "MV;MALDIVES;NO;NO|"
countries = countries & "ML;MALI;NO;NO|"
countries = countries & "MT;MALTA;NO;YES|"
countries = countries & "MH;MARSHALL ISLANDS;NO;YES|"
countries = countries & "MQ;MARTINIQUE;NO;NO|"
countries = countries & "MR;MAURITANIA;NO;NO|"
countries = countries & "MU;MAURITIUS;NO;YES|"
countries = countries & "YT;MAYOTTE;NO;NO|"
countries = countries & "MX;MEXICO;NO;YES|"
countries = countries & "FM;MICRONESIA FEDERATED STATES OF;NO;NO|"
countries = countries & "MD;MOLDOVA REPUBLIC OF;NO;YES|"
countries = countries & "MC;MONACO;NO;YES|"
countries = countries & "MN;MONGOLIA;NO;YES|"
countries = countries & "ME;MONTENEGRO;NO;YES|"
countries = countries & "MS;MONTSERRAT;NO;YES|"
countries = countries & "MA;MOROCCO;NO;YES|"
countries = countries & "MZ;MOZAMBIQUE;NO;NO|"
countries = countries & "MM;MYANMAR;NO;NO|"
countries = countries & "NA;NAMIBIA;NO;NO|"
countries = countries & "NR;NAURU;NO;NO|"
countries = countries & "NP;NEPAL;NO;NO|"
countries = countries & "NL;NETHERLANDS;NO;NO|"
countries = countries & "NC;NEW CALEDONIA;NO;NO|"
countries = countries & "NZ;NEW ZEALAND;NO;YES|"
countries = countries & "NI;NICARAGUA;NO;NO|"
countries = countries & "NE;NIGER;NO;NO|"
countries = countries & "NG;NIGERIA;NO;YES|"
countries = countries & "NU;NIUE;NO;YES|"
countries = countries & "NF;NORFOLK ISLAND;NO;NO|"
countries = countries & "MP;NORTHERN MARIANA ISLANDS;NO;NO|"
countries = countries & "NO;NORWAY;NO;YES|"
countries = countries & "OM;OMAN;NO;NO|"
countries = countries & "PK;PAKISTAN;NO;NO|"
countries = countries & "PW;PALAU;NO;NO|"
countries = countries & "PS;PALESTINIAN TERRITORY OCCUPIED;NO;NO|"
countries = countries & "PA;PANAMA;NO;NO|"
countries = countries & "PG;PAPUA NEW GUINEA;NO;NO|"
countries = countries & "PY;PARAGUAY;NO;NO|"
countries = countries & "PE;PERU;NO;NO|"
countries = countries & "PH;PHILIPPINES;NO;YES|"
countries = countries & "PN;PITCAIRN;NO;NO|"
countries = countries & "PL;POLAND;NO;YES|"
countries = countries & "PT;PORTUGAL;NO;YES|"
countries = countries & "PR;PUERTO RICO;NO;NO|"
countries = countries & "QA;QATAR;NO;YES|"
countries = countries & "RE;REUNION;NO;NO|"
countries = countries & "RO;ROMANIA;NO;YES|"
countries = countries & "RU;RUSSIAN FEDERATION;NO;YES|"
countries = countries & "RW;RWANDA;NO;NO|"
countries = countries & "SH;SAINT HELENA;NO;NO|"
countries = countries & "KN;SAINT KITTS AND NEVIS;NO;YES|"
countries = countries & "LC;SAINT LUCIA;NO;YES|"
countries = countries & "SX;SAINT MAARTEN;NO;YES|"
countries = countries & "PM;SAINT PIERRE AND MIQUELON;NO;NO|"
countries = countries & "VC;SAINT VINCENT AND THE GRENADINES;NO;YES|"
countries = countries & "WS;SAMOA;NO;YES|"
countries = countries & "SM;SAN MARINO;NO;YES|"
countries = countries & "ST;SAO TOME AND PRINCIPE;NO;NO|"
countries = countries & "SA;SAUDI ARABIA;NO;YES|"
countries = countries & "SN;SENEGAL;NO;NO|"
countries = countries & "RS;SERBIA;NO;YES|"
countries = countries & "SC;SEYCHELLES;NO;NO|"
countries = countries & "SL;SIERRA LEONE;NO;NO|"
countries = countries & "SG;SINGAPORE;NO;YES|"
countries = countries & "SK;SLOVAKIA;NO;YES|"
countries = countries & "SI;SLOVENIA;NO;YES|"
countries = countries & "SB;SOLOMON ISLANDS;NO;NO|"
countries = countries & "SO;SOMALIA;NO;NO|"
countries = countries & "ZA;SOUTH AFRICA;NO;YES|"
countries = countries & "GS;SOUTH GEORGIA AND THE SOUTH SANDWICH ISLANDS;NO;NO|"
countries = countries & "SS;SOUTH SUDAN;NO;NO|"
countries = countries & "ES;SPAIN;NO;YES|"
countries = countries & "LK;SRI LANKA;NO;YES|"
countries = countries & "SD;SUDAN;NO;NO|"
countries = countries & "SR;SURINAME;NO;NO|"
countries = countries & "SJ;SVALBARD AND JAN MAYEN;NO;NO|"
countries = countries & "SZ;SWAZILAND;NO;NO|"
countries = countries & "SE;SWEDEN;NO;YES|"
countries = countries & "CH;SWITZERLAND;NO;YES|"
countries = countries & "SY;SYRIAN ARAB REPUBLIC;NO;YES|"
countries = countries & "TW;TAIWAN PROVINCE OF CHINA;NO;NO|"
countries = countries & "TJ;TAJIKISTAN;NO;YES|"
countries = countries & "TZ;TANZANIA UNITED REPUBLIC OF;NO;NO|"
countries = countries & "TH;THAILAND;NO;YES|"
countries = countries & "TL;TIMOR-LESTE;NO;NO|"
countries = countries & "TG;TOGO;NO;NO|"
countries = countries & "TK;TOKELAU;NO;NO|"
countries = countries & "TO;TONGA;NO;NO|"
countries = countries & "TT;TRINIDAD AND TOBAGO;NO;YES|"
countries = countries & "TN;TUNISIA;NO;YES|"
countries = countries & "TR;TURKEY;NO;YES|"
countries = countries & "TM;TURKMENISTAN;NO;NO|"
countries = countries & "TC;TURKS AND CAICOS ISLANDS;NO;YES|"
countries = countries & "TV;TUVALU;NO;NO|"
countries = countries & "UG;UGANDA;NO;NO|"
countries = countries & "UA;UKRAINE;NO;YES|"
countries = countries & "AE;UNITED ARAB EMIRATES;NO;YES|"
countries = countries & "GB;UNITED KINGDOM;NO;YES|"
countries = countries & "US;UNITED STATES;YES;NO|"
countries = countries & "UM;UNITED STATES MINOR OUTLYING ISLANDS;NO;NO|"
countries = countries & "UY;URUGUAY;NO;YES|"
countries = countries & "UZ;UZBEKISTAN;NO;YES|"
countries = countries & "VU;VANUATU;NO;NO|"
countries = countries & "VE;VENEZUELA;NO;YES|"
countries = countries & "VN;VIET NAM;NO;YES|"
countries = countries & "VG;VIRGIN ISLANDS BRITISH;NO;YES|"
countries = countries & "VI;VIRGIN ISLANDS U. S.;NO;NO|"
countries = countries & "WF;WALLIS AND FUTUNA;NO;NO|"
countries = countries & "EH;WESTERN SAHARA;NO;NO|"
countries = countries & "YE;YEMEN;NO;NO|"
countries = countries & "ZM;ZAMBIA;NO;NO|"
countries = countries & "ZW;ZIMBABWE;NO;NO"


End Function
Attribute VB_Name = "HELPFUNCTIONS"
Option Explicit

Public Function OnlyDigits(s As String) As Long
    ' Variables needed (remember to use "option explicit").   '
    Dim retval As String    ' This is the return string.      '
    Dim i As Integer        ' Counter for character position. '

    ' Initialise return string to empty                       '
    retval = ""

    ' For every character in input string, copy digits to     '
    '   return string.                                        '
    For i = 1 To Len(s)
        If Mid(s, i, 1) >= "0" And Mid(s, i, 1) <= "9" Then
            retval = retval + Mid(s, i, 1)
        End If
    Next

    ' Then return the return string.                          '
    OnlyDigits = retval
End Function
Attribute VB_Name = "InitForm"
Attribute VB_Base = "0{61EE716F-35B1-4B3A-9F5D-0B4517C5077F}{679E15D7-DB51-43B8-8F6B-08FC3DFFA58B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit




Private Sub btn_insert_Click()

On Error Resume Next
    ThisDocument.Unprotect ""
    Call MAIN.ShowStatutarniOrgan(cbx_pocet_ovlad_osob.Value)
    Call MAIN.ShowMajitel(cbx_pocet_majitelu.Value)
   
    ThisDocument.Bookmarks("pomocna").Range.Delete
    
    ThisDocument.Protect wdAllowOnlyFormFields, , ""
    Unload Me
    
End Sub

Private Sub UserForm_Initialize()
    Dim i As Integer
    
    For i = 1 To 30
        InitForm.cbx_pocet_ovlad_osob.AddItem CStr(i)
    Next i
    
    For i = 0 To 4
        InitForm.cbx_pocet_majitelu.AddItem CStr(i)
    Next i
    
    cbx_pocet_ovlad_osob.ListIndex = 0
    cbx_pocet_majitelu.ListIndex = 0
    
End Sub
Attribute VB_Name = "MAIN"
Option Explicit

Public Sub CBXCountriesSelectionChanged()

ThisDocument.tbx_US.BackColor = DATA.color_default
ThisDocument.tbx_CRS.BackColor = DATA.color_default

With ThisDocument.cbx_dan_domicil
    If .Value <> "" Then
    'country is selected
        .BackColor = DATA.color_filled
        
        If IsCountryUSrelevant(.Value) Then
            Call CountryUSrelevantSelected
        ElseIf IsCountryCRSrelevant(.Value) Then
            Call CountryCRSrelevantSelected
        End If
    Else
        .BackColor = DATA.color_highlighted
    End If
End With

End Sub

Public Sub CountryCRSrelevantSelected()

Dim tbx As TextBox
Set tbx = ThisDocument.tbx_CRS

With tbx
    If .Value = "" Then
        .BackColor = DATA.color_highlighted
        .Select
    End If
End With

End Sub

Public Sub CountryUSrelevantSelected()

Dim tbx As TextBox
Set tbx = ThisDocument.tbx_US

With tbx
    If .Value = "" Then
        .BackColor = DATA.color_highlighted
        .Select
    End If
End With

End Sub

Public Function IsCountryUSrelevant(countryName As String) As Boolean

Dim text_data As String
Dim countries() As String
Dim properties() As String
Dim code As String
Dim name As String
Dim US_relevant As String
Dim CRS_relevant As String
    
text_data = DATA.countries
countries = Split(text_data, "|")
        
Dim country As Variant
For Each country In countries
    properties = Split(country, ";")
        
    code = properties(0)
    name = properties(1)
    US_relevant = properties(2)
    CRS_relevant = properties(3)
        
    If name = countryName Then
        If US_relevant = "YES" Then
            IsCountryUSrelevant = True
        Else
            IsCountryUSrelevant = False
        End If
        Exit Function
    End If
Next country

End Function

Public Function IsCountryCRSrelevant(countryName As String) As Boolean

Dim text_data As String
Dim countries() As String
Dim properties() As String
Dim code As String
Dim name As String
Dim US_relevant As String
Dim CRS_relevant As String
    
text_data = DATA.countries
countries = Split(text_data, "|")
        
Dim country As Variant
For Each country In countries
    properties = Split(country, ";")
        
    code = properties(0)
    name = properties(1)
    US_relevant = properties(2)
    CRS_relevant = properties(3)
        
    If name = countryName Then
        If CRS_relevant = "YES" Then
            IsCountryCRSrelevant = True
        Else
            IsCountryCRSrelevant = False
        End If
        Exit Function
    End If
Next country

End Function


Public Sub LoadCountriesToCombobox()
'load countries data to combobox

Dim cbx As ComboBox
Set cbx = ThisDocument.cbx_dan_domicil

'remember selected value in combobox
Dim actual As String
actual = cbx.Value

'clear all items in combobox
cbx.Clear

'add items to combobox
With cbx

    Dim text_data As String
    Dim countries() As String
    Dim properties() As String
    Dim code As String
    Dim name As String
    Dim US_relevant As String
    Dim CRS_relevant As String
    
    text_data = DATA.countries
    countries = Split(text_data, "|")
    
    cbx.AddItem ""
    
    Dim country As Variant
    For Each country In countries
        properties = Split(country, ";")
        
        code = properties(0)
        name = properties(1)
        US_relevant = properties(2)
        CRS_relevant = properties(3)
        
        'Debug.Print code & "-" & name & "-" & US_relevant & "-" & CRS_relevant
        cbx.AddItem name
    Next country

End With

'set selected item in combobox (if combobox has min. one item)
If cbx.ListCount > 0 Then
    'if selected value wasn't empty then select it back again
    If actual <> "" Then
        cbx.Value = actual
    Else
        'else select first item
        cbx.ListIndex = 0
    End If
End If

End Sub



Sub LoadComboboxesStatutarniOrgan()

On Error Resume Next
Dim cb As ComboBox
Dim actual As String
          
Dim s As Variant
For Each s In ActiveDocument.InlineShapes
    With s.OLEFormat
        Set cb = .Object
        If InStr(1, .Object.name, "cbx_statutar_osoba_") > 0 Then
            actual = cb.Value
            
            cb.Clear
            cb.AddItem ""
            cb.AddItem "Ano"
            cb.AddItem "Ne"
            cb.Style = fmStyleDropDownList
            
            cb.Value = actual
          End If
        If InStr(1, .Object.name, "cbx_statutar_pohlavi_") > 0 Then
            actual = cb.Value
            
            cb.Clear
            cb.AddItem ""
            cb.AddItem "Mu|fffd|"
            cb.AddItem "|fffd|ena"
            cb.Style = fmStyleDropDownList
            
            cb.Value = actual
        End If
        
    End With
Next s

End Sub


Sub LoadComboboxesMajitel()

On Error Resume Next
Dim cb As ComboBox
Dim actual As String
          
Dim s As Variant
For Each s In ActiveDocument.InlineShapes
    With s.OLEFormat
        Set cb = .Object
        If InStr(1, .Object.name, "cbx_majitel_pohlavi_") > 0 Then
            actual = cb.Value
            
            cb.Clear
            cb.AddItem ""
            cb.AddItem "Mu|fffd|"
            cb.AddItem "|fffd|ena"
            cb.Style = fmStyleDropDownList
            
            cb.Value = actual
        End If
        
    End With
Next s

End Sub


Sub ShowStatutarniOrgan(count As Integer)

On Error Resume Next
Application.ScreenUpdating = False

If count = 0 Then
    ThisDocument.Bookmarks("statutar_organ").Range.Delete
Else
    Dim i As Integer
    For i = count + 1 To 30
        ThisDocument.Bookmarks("statutar_organ_" & i).Range.Delete
    Next i
End If

Application.ScreenUpdating = True

End Sub


Sub StatutarniOrganBanka_Changed(cbx As ComboBox)

Dim number As Long
number = HELPFUNCTIONS.OnlyDigits(cbx.name)

If cbx.Value = "Ano" Then
    ThisDocument.Bookmarks("statutar_udaje_" & number).Range.Font.Hidden = True
    ThisDocument.Bookmarks("statutar_jmeno_" & number).Range.Font.Hidden = False
    ThisDocument.Bookmarks("statutar_narozeni_" & number).Range.Font.Hidden = False
    Call HideCombobox(GetCombobox("cbx_statutar_pohlavi_" & number))
Else
    ThisDocument.Bookmarks("statutar_udaje_" & number).Range.Font.Hidden = False
    Call ShowCombobox(GetCombobox("cbx_statutar_pohlavi_" & number))
End If

Call ComboboxColorHandler(cbx)


End Sub

Sub StatutarniOrganPohlavi_Changed(cbx As ComboBox)

Call ComboboxColorHandler2(cbx)

End Sub


Sub ShowMajitel(count As Integer)

On Error Resume Next
Application.ScreenUpdating = False

If count = 0 Then
    ThisDocument.Bookmarks("majitel").Range.Delete
Else
    Dim i As Integer
    For i = count + 1 To 4
        ThisDocument.Bookmarks("majitel_" & i).Range.Delete
    Next i
    ThisDocument.Bookmarks("majitel_prohlaseni").Range.Delete
End If

Application.ScreenUpdating = True

End Sub




Sub MajitelPohlavi_Changed(cbx As ComboBox)

Call ComboboxColorHandler2(cbx)

End Sub



Function GetCombobox(cbxName As String) As ComboBox

On Error Resume Next
Dim cb As ComboBox

Dim s As Variant
For Each s In ActiveDocument.InlineShapes
    With s.OLEFormat
        Set cb = .Object
        If cb.name = cbxName Then
            Set GetCombobox = cb
            Exit Function
        End If
    End With
Next s

Set GetCombobox = Nothing

End Function


Sub ShowCombobox(cbx As Object)

With cbx
    '.Value = "" 'Gets rid of any text the user typed in textbox1 box
    .SpecialEffect = 0 'makes flat, rather than sunken by default.
    .BorderStyle = 0 'Gets rid of single line border around textbox1 box
    .BackColor = &HC0C0C0 'makes box a white background - not really necessary
    .Locked = False 'Locks box, to prevent user from typing in it
    .Width = 72
    '.TabKeyBehavior = True
End With

Call ComboboxColorHandler2(cbx)

End Sub

Sub HideCombobox(cbx As Object)

With cbx
    '.Value = "" 'Gets rid of any text the user typed in textbox1 box
    .SpecialEffect = 0 'makes flat, rather than sunken by default.
    .BorderStyle = 0 'Gets rid of single line border around textbox1 box
    .BackColor = &HFFFFFF    'makes box a white background - not really necessary
    .Locked = True 'Locks box, to prevent user from typing in it
    .Width = 0.6
    '.TabKeyBehavior = False
End With

End Sub


Sub ComboboxColorHandler(cbx As ComboBox)

If cbx.Value <> "" Then
    cbx.BackColor = DATA.color_filled
Else
    cbx.BackColor = DATA.color_highlighted
End If

End Sub

Sub ComboboxColorHandler2(cbx As ComboBox)

If cbx.Value <> "" Then
    cbx.BackColor = DATA.color_filled
Else
    cbx.BackColor = DATA.color_default_2
End If

End Sub



'Sub ShowAllBookmarks()
'
'Dim i As Long
'For i = 1 To 30
'    ThisDocument.Bookmarks("statutar_organ_" & i).Range.Font.Hidden = False
'Next i
'
'End Sub
'

Sub test()

On Error Resume Next
Dim cb As ComboBox

Dim s As Variant
For Each s In ActiveDocument.InlineShapes
    With s.OLEFormat
        Set cb = .Object
'            If InStr(1, cb.name, "cbx_majitel") > 0 Or InStr(1, cb.name, "cbx_statutar") > 0 Then
'                Call ComboboxColorHandler(cb)
'            End If
'        If InStr(1, cb.name, "cbx_statutar_pohlavi_") > 0 Or InStr(1, cb.name, "cbx_majitel_pohlavi_") > 0 Then
'            Call ComboboxColorHandler2(cb)
'        End If

        If InStr(1, cb.name, "cbx_statutar_pohlavi_") > 0 Or InStr(1, cb.name, "cbx_majitel_pohlavi_") > 0 Then
            cb.SelectionMargin = False
        End If

    End With
Next s

End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "tbx_CRS, 6, 61, MSForms, TextBox"
Attribute VB_Control = "tbx_US, 5, 62, MSForms, TextBox"
Attribute VB_Control = "cbx_majitel_pohlavi_2, 4, 63, MSForms, ComboBox"
Attribute VB_Control = "cbx_majitel_pohlavi_1, 3, 64, MSForms, ComboBox"
Attribute VB_Control = "cbx_statutar_pohlavi_2, 2, 65, MSForms, ComboBox"
Attribute VB_Control = "cbx_statutar_pohlavi_1, 1, 66, MSForms, ComboBox"
Attribute VB_Control = "cbx_dan_domicil, 0, 67, MSForms, ComboBox"



Private Sub cbx_majitel_pohlavi_1_Change()
Call MAIN.MajitelPohlavi_Changed(ThisDocument.cbx_majitel_pohlavi_1)
End Sub

Private Sub cbx_majitel_pohlavi_2_Change()
Call MAIN.MajitelPohlavi_Changed(ThisDocument.cbx_majitel_pohlavi_2)
End Sub

Private Sub cbx_majitel_pohlavi_3_Change()
Call MAIN.MajitelPohlavi_Changed(ThisDocument.cbx_majitel_pohlavi_3)
End Sub

Private Sub cbx_majitel_pohlavi_4_Change()
Call MAIN.MajitelPohlavi_Changed(ThisDocument.cbx_majitel_pohlavi_4)
End Sub


Private Sub cbx_statutar_osoba_1_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_1)
End Sub

Private Sub cbx_statutar_osoba_2_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_2)
End Sub

Private Sub cbx_statutar_osoba_3_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_3)
End Sub

Private Sub cbx_statutar_osoba_4_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_4)
End Sub

Private Sub cbx_statutar_osoba_5_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_5)
End Sub

Private Sub cbx_statutar_osoba_6_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_6)
End Sub

Private Sub cbx_statutar_osoba_7_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_7)
End Sub

Private Sub cbx_statutar_osoba_8_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_8)
End Sub

Private Sub cbx_statutar_osoba_9_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_9)
End Sub

Private Sub cbx_statutar_osoba_10_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_10)
End Sub

Private Sub cbx_statutar_osoba_11_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_11)
End Sub

Private Sub cbx_statutar_osoba_12_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_12)
End Sub

Private Sub cbx_statutar_osoba_13_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_13)
End Sub

Private Sub cbx_statutar_osoba_14_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_14)
End Sub

Private Sub cbx_statutar_osoba_15_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_15)
End Sub

Private Sub cbx_statutar_osoba_16_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_16)
End Sub

Private Sub cbx_statutar_osoba_17_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_17)
End Sub

Private Sub cbx_statutar_osoba_18_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_18)
End Sub

Private Sub cbx_statutar_osoba_19_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_19)
End Sub

Private Sub cbx_statutar_osoba_20_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_20)
End Sub

Private Sub cbx_statutar_osoba_21_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_21)
End Sub

Private Sub cbx_statutar_osoba_22_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_22)
End Sub

Private Sub cbx_statutar_osoba_23_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_23)
End Sub

Private Sub cbx_statutar_osoba_24_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_24)
End Sub

Private Sub cbx_statutar_osoba_25_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_25)
End Sub

Private Sub cbx_statutar_osoba_26_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_26)
End Sub

Private Sub cbx_statutar_osoba_27_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_27)
End Sub

Private Sub cbx_statutar_osoba_28_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_28)
End Sub

Private Sub cbx_statutar_osoba_29_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_29)
End Sub

Private Sub cbx_statutar_osoba_30_Change()
Call MAIN.StatutarniOrganBanka_Changed(ThisDocument.cbx_statutar_osoba_30)
End Sub







Private Sub cbx_statutar_pohlavi_1_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_1)
End Sub

Private Sub cbx_statutar_pohlavi_2_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_2)
End Sub

Private Sub cbx_statutar_pohlavi_3_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_3)
End Sub

Private Sub cbx_statutar_pohlavi_4_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_4)
End Sub

Private Sub cbx_statutar_pohlavi_5_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_5)
End Sub

Private Sub cbx_statutar_pohlavi_6_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_6)
End Sub

Private Sub cbx_statutar_pohlavi_7_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_7)
End Sub

Private Sub cbx_statutar_pohlavi_8_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_8)
End Sub

Private Sub cbx_statutar_pohlavi_9_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_9)
End Sub

Private Sub cbx_statutar_pohlavi_10_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_10)
End Sub

Private Sub cbx_statutar_pohlavi_11_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_11)
End Sub

Private Sub cbx_statutar_pohlavi_12_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_12)
End Sub

Private Sub cbx_statutar_pohlavi_13_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_13)
End Sub

Private Sub cbx_statutar_pohlavi_14_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_14)
End Sub

Private Sub cbx_statutar_pohlavi_15_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_15)
End Sub

Private Sub cbx_statutar_pohlavi_16_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_16)
End Sub

Private Sub cbx_statutar_pohlavi_17_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_17)
End Sub

Private Sub cbx_statutar_pohlavi_18_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_18)
End Sub

Private Sub cbx_statutar_pohlavi_19_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_19)
End Sub

Private Sub cbx_statutar_pohlavi_20_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_20)
End Sub

Private Sub cbx_statutar_pohlavi_21_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_21)
End Sub

Private Sub cbx_statutar_pohlavi_22_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_23)
End Sub

Private Sub cbx_statutar_pohlavi_24_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_24)
End Sub

Private Sub cbx_statutar_pohlavi_25_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_25)
End Sub

Private Sub cbx_statutar_pohlavi_26_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_26)
End Sub

Private Sub cbx_statutar_pohlavi_27_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_27)
End Sub

Private Sub cbx_statutar_pohlavi_28_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_28)
End Sub

Private Sub cbx_statutar_pohlavi_29_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_29)
End Sub

Private Sub cbx_statutar_pohlavi_30_Change()
Call MAIN.StatutarniOrganPohlavi_Changed(ThisDocument.cbx_statutar_pohlavi_30)
End Sub



'Sub test()
'
'tbx_US.Select
'
'End Sub


'Private Sub tbx_US_LostFocus()
'
'If Len(tbx_US.Text) > 0 Then
'    tbx_US.BackColor = color_white
'Else
'    tbx_US.BackColor = color_gray
'End If
'
'End Sub

Private Sub Document_Open()

Call MAIN.LoadCountriesToCombobox
Call MAIN.LoadComboboxesStatutarniOrgan
Call MAIN.LoadComboboxesMajitel

If ThisDocument.Bookmarks.Exists("pomocna") Then
    Load InitForm
    InitForm.show
    Unload InitForm
End If

End Sub

Private Sub cbx_dan_domicil_Change()

Call MAIN.CBXCountriesSelectionChanged

End Sub



Private Sub tbx_CRS_LostFocus()

Dim tbx As TextBox
Set tbx = ThisDocument.tbx_CRS

With tbx
    If MAIN.IsCountryCRSrelevant(ThisDocument.cbx_dan_domicil.Value) Then
        If .Value = "" Then
            .BackColor = DATA.color_highlighted
        Else
            .BackColor = DATA.color_filled
        End If
    Else
        .BackColor = DATA.color_default
    End If
End With

End Sub

Private Sub tbx_US_LostFocus()

Dim tbx As TextBox
Set tbx = ThisDocument.tbx_US

With tbx
    If MAIN.IsCountryUSrelevant(ThisDocument.cbx_dan_domicil.Value) Then
        If .Value = "" Then
            .BackColor = DATA.color_highlighted
        Else
            .BackColor = DATA.color_filled
        End If
    Else
        .BackColor = DATA.color_default
    End If
End With

End Sub


INQUEST-PP=macro
