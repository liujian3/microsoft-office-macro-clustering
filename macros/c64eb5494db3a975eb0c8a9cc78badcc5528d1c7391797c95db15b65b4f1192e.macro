Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Option Explicit

'Email signature maker created for DXC Technology
'April 2017

'Set up variables that will be used in several userforms

Public SourceFileName As String

Public EnteredName As String
Public EnteredTitle As String
Public EnteredDivision As String
Public EnteredTelephone1 As String
Public EnteredTelephone1Label As String
Public EnteredTelephone2 As String
Public EnteredTelephone2Label As String
Public EnteredEmail As String
Public EnteredAddress1 As String
Public EnteredAddress2 As String

Public WebsiteLinkText As String
Public WebsiteLinkURL As String
Public IncludeTwitter As String
Public TwitterLinkURL As String
Public IncludeFacebook As String
Public FacebookLinkURL As String
Public IncludeLinkedIn As String
Public LinkedInLinkURL As String

Public IncludePromotion As String
Public PromotionMessage As String
Public PromotionLinkText As String
Public PromotionLinkURL As String

Public DefaultTelephone As String
Public InProgress1 As String
Public InProgress2 As String
Public InProgress3 As String


Private Sub Document_Open()

    'Capture document name to be used later
    
    SourceFileName = ActiveDocument.Name
        
    'Change the message in the main window
    
    ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Customization in progress..."
    
    'Set the document to saved so that it won't prompt if the user cancels out
    
    ActiveDocument.Saved = True
    
    'Set some defaults here for convenience
    DefaultTelephone = "+0.000.000.0000"
    WebsiteLinkText = "dxc.technology"
    WebsiteLinkURL = "http://www.dxc.technology"
    TwitterLinkURL = "https://twitter.com/dxctechnology"
    FacebookLinkURL = "https://www.facebook.com/DXCTechnology"
    LinkedInLinkURL = "https://www.linkedin.com/company/dxctechnology"
    PromotionMessage = "Get the insights that matter."
    PromotionLinkText = "dxc.technology/optin"
    PromotionLinkURL = "http://www.dxc.technology/opt-in?utm_campaign=1805-GDC-SPU-MUL-MUL-MUL-OptIn&utm_source=emailsignature&utm_medium=email&utm_term=signaturewizard%20&utm_content=2019"

    
    'Minimize the window for Macs (to allow desktop to be visible) or maximize for PC
    
    If Environ("OS") = "" Then
            Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMinimize
    Else
            Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
    End If
    
    'Show first UserForm
    
    ThisDocument.InProgress1 = ""
    ThisDocument.InProgress2 = ""
    frmWelcome.Show
    
End Sub
Attribute VB_Name = "frmCustomize"
Attribute VB_Base = "0{83972224-436E-9D49-B363-2863DB9A4840}{07494B78-D7A8-E84C-A913-BFB3E3030066}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private ErrorAlerts As String

Private Sub UserForm_Initialize()

    'Check to see if data has already been entered
    'If so, initialize with information already captured

    If ThisDocument.InProgress1 = "Yes" Then
        With ThisDocument
            txtName.Value = .EnteredName
            txtTitle.Value = .EnteredTitle
            txtDivision.Value = .EnteredDivision
            txtTelephone1.Value = .EnteredTelephone1
            If txtTelephone1.Value = "" Then txtTelephone1.Value = .DefaultTelephone
            If .EnteredTelephone1Label = "T" Then optTelephone1 = True
            If .EnteredTelephone1Label = "M" Then optMobile1 = True
            txtTelephone2.Value = .EnteredTelephone2
            If txtTelephone2.Value = "" Then txtTelephone2.Value = .DefaultTelephone
            If .EnteredTelephone2Label = "T" Then optTelephone2 = True
            If .EnteredTelephone2Label = "M" Then optMobile2 = True
            txtEmail.Value = .EnteredEmail
            txtAddress1.Value = .EnteredAddress1
            txtAddress2.Value = .EnteredAddress2
            If txtAddress1.Value = "" Then txtAddress1.Value = "123 Street Address, 4th Floor"
            If txtAddress2.Value = "" Then txtAddress2.Value = "City, ST 12345"
        End With
    
    'Or else with standard information
        
    Else
        With ThisDocument
            txtTelephone1.Value = .DefaultTelephone
            txtTelephone2.Value = .DefaultTelephone
            optTelephone1 = True
            optMobile2 = True
            txtAddress1.Value = "123 Street Address, 4th Floor"
            txtAddress2.Value = "City, ST 12345"
        End With
    End If

End Sub

Private Sub txtName_Enter()
    
    'Select the contents of the first field
 
     With Me.txtName
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

Private Sub cmdCustomizeBack_Click()

    'Save data (no need to check for errors here)
    
    saveData
    
    'Show previous UserForm
    
    Unload frmCustomize
    frmIntro.Show

End Sub

Private Sub cmdCustomizeCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmCustomize
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmCustomize
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdCustomizeContinue_Click()
    
    'Save data and check for errors
    
    saveData
    checkErrors
    
    'Stop if errors
    
    If ErrorAlerts <> "" Then Exit Sub
    
    'Show next UserForm
    
    Unload frmCustomize
    frmLinks.Show
    
End Sub

Private Sub saveData()
    
    'Trim leading and trailing spaces from manually entered values
    
    txtName.Value = Trim(txtName.Value)
    txtTitle.Value = Trim(txtTitle.Value)
    txtDivision.Value = Trim(txtDivision.Value)
    txtTelephone1.Value = Trim(txtTelephone1.Value)
    txtTelephone2.Value = Trim(txtTelephone2.Value)
    txtEmail.Value = Trim(txtEmail.Value)
    txtAddress1.Value = Trim(txtAddress1.Value)
    txtAddress2.Value = Trim(txtAddress2.Value)
    
    'Store the entered information in public variables for later
    
    With ThisDocument
        .EnteredName = txtName.Value
        .EnteredTitle = txtTitle.Value
        .EnteredDivision = txtDivision.Value
        If txtTelephone1.Value = .DefaultTelephone Then .EnteredTelephone1 = "" Else .EnteredTelephone1 = txtTelephone1.Value
        If optTelephone1 = True Then .EnteredTelephone1Label = "T"
        If optMobile1 = True Then .EnteredTelephone1Label = "M"
        If txtTelephone2.Value = .DefaultTelephone Then .EnteredTelephone2 = "" Else .EnteredTelephone2 = txtTelephone2.Value
        If optTelephone2 = True Then .EnteredTelephone2Label = "T"
        If optMobile2 = True Then .EnteredTelephone2Label = "M"
        .EnteredEmail = txtEmail.Value
        If txtAddress1.Value = "123 Street Address, 4th Floor" Then .EnteredAddress1 = "" Else .EnteredAddress1 = txtAddress1.Value
        If txtAddress2.Value = "City, ST 12345" Then .EnteredAddress2 = "" Else .EnteredAddress2 = txtAddress2.Value
    End With
    
    'In case we come back to this UserForm
    
    ThisDocument.InProgress1 = "Yes"
    
End Sub

Private Sub checkErrors()
    
    'Run through entered information to see what is missing
    'Populate message box content
    
    ErrorAlerts = ""
    
    With ThisDocument
        If .EnteredName = "" Then ErrorAlerts = ErrorAlerts & "Your name" & vbNewLine
        If .EnteredTitle = "" Then ErrorAlerts = ErrorAlerts & "Your title" & vbNewLine
    End With
    
    'Show message box if anything is missing
    
    If ErrorAlerts <> "" Then
        MsgBox ErrorAlerts, _
        vbExclamation, "Please fill out these required fields"
    End If
    
End Sub
Attribute VB_Name = "frmGoodbyeMac"
Attribute VB_Base = "0{5A2EADFB-7F11-954C-889F-A8AC587D029B}{2B359696-49C7-0A48-AAA6-ECCD71F99F85}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdDone_Click()
    
    'Word 2016 was crashing when VBA closed document so manual close for version >= 15
    
    If Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Customization complete. Please close this document."
        Unload frmGoodbyeMac
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmGoodbyeMac
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If
    
    'End of signature maker

End Sub
Attribute VB_Name = "frmGoodbyePC"
Attribute VB_Base = "0{705BD03C-6AB4-3E48-82CF-04CB920CA540}{0C4C048F-193C-DF47-90B0-16024878EFC1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdDone_Click()
    
    Unload frmGoodbyePC
    Documents(ThisDocument.SourceFileName).Activate
    ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    
    'End of signature maker

End Sub
Attribute VB_Name = "frmIntro"
Attribute VB_Base = "0{B40B1754-6C67-7D46-8B50-F360A02595BF}{886B57B2-A4D0-164C-BF87-D268ABA468CA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Initialize()
    
    'Populate UserForm with platform-specific information
    
    If Environ("OS") = "" Then
        lblPlatformType = "It looks like you're on a Mac"
        lblPlatformInformation = "This installer cannot automatically install your signature in Outlook on a Mac. However, it will generate an HTML file that you'll use to set up your new signature manually. It's not so bad really. Just follow the instructions."
    Else
        lblPlatformType = "Great. You're using Windows."
        lblPlatformInformation = "After you run this installer, your customized email signature will be immediately available in Outlook just as your current signatures are."
    End If

End Sub

Private Sub cmdIntroBack_Click()

    'Show previous UserForm
    
    Unload frmIntro
    frmWelcome.Show

End Sub

Private Sub cmdIntroCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmIntro
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmIntro
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdIntroContinue_Click()

    'Show next UserForm
    
    Unload frmIntro
    frmCustomize.Show

End Sub
Attribute VB_Name = "frmLinks"
Attribute VB_Base = "0{2C1EB78E-FB9C-7E42-BDE4-0A0A9001E0C1}{8A31B56F-4C72-6941-97AB-29C33430CE37}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private ErrorAlerts As String

Private Sub UserForm_Initialize()

    'Check to see if data has already been entered
    'If so, initialize with information already captured
    
    If ThisDocument.InProgress2 = "Yes" Then
        With ThisDocument
            txtWebsiteLinkText.Value = .WebsiteLinkText
            txtWebsiteLinkURL.Value = .WebsiteLinkURL
            If .IncludeTwitter = False Then checkIncludeTwitter = False Else checkIncludeTwitter = True
            txtTwitterLinkURL.Value = .TwitterLinkURL
            If .IncludeFacebook = False Then checkIncludeFacebook = False Else checkIncludeFacebook = True
            txtFacebookLinkURL.Value = .FacebookLinkURL
            If .IncludeLinkedIn = False Then checkIncludeLinkedIn = False Else checkIncludeLinkedIn = True
            txtLinkedInLinkURL.Value = .LinkedInLinkURL
        End With
    
    'Or else with standard information
        
    Else
        With ThisDocument
            txtWebsiteLinkText.Value = .WebsiteLinkText
            txtWebsiteLinkURL.Value = .WebsiteLinkURL
            checkIncludeTwitter = True
            txtTwitterLinkURL.Value = .TwitterLinkURL
            checkIncludeFacebook = True
            txtFacebookLinkURL.Value = .FacebookLinkURL
            checkIncludeLinkedIn = True
            txtLinkedInLinkURL.Value = .LinkedInLinkURL
        End With
    End If

End Sub

Private Sub txtWebsiteLinkText_Enter()
    
    'Select the contents of the first field
 
     With Me.txtWebsiteLinkText
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

Private Sub cmdLinksBack_Click()

    'Save data (no need to check for errors here)
    
    saveData
    
    'Show previous UserForm
    
    Unload frmLinks
    frmCustomize.Show

End Sub

Private Sub cmdLinksCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmLinks
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmLinks
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdLinksContinue_Click()
    
    'Save data and check for errors
    
    saveData
    checkErrors
    
    'Stop if errors
    
    If ErrorAlerts <> "" Then Exit Sub
    
    'Show next UserForm
    
    Unload frmLinks
    frmPromotion.Show
    
End Sub

Private Sub saveData()
    
    'Trim leading and trailing spaces from manually entered values
    
    txtWebsiteLinkText.Value = Trim(txtWebsiteLinkText.Value)
    txtWebsiteLinkURL.Value = Trim(txtWebsiteLinkURL.Value)
    txtTwitterLinkURL.Value = Trim(txtTwitterLinkURL.Value)
    txtFacebookLinkURL.Value = Trim(txtFacebookLinkURL.Value)
    txtLinkedInLinkURL.Value = Trim(txtLinkedInLinkURL.Value)
    
    'Store the entered information in public variables for later
    
    With ThisDocument
        If txtWebsiteLinkText.Value <> "" Then .WebsiteLinkText = txtWebsiteLinkText.Value
        If txtWebsiteLinkURL.Value <> "" Then .WebsiteLinkURL = txtWebsiteLinkURL.Value
        .IncludeTwitter = checkIncludeTwitter.Value
        If txtTwitterLinkURL.Value <> "" Then .TwitterLinkURL = txtTwitterLinkURL.Value
        .IncludeFacebook = checkIncludeFacebook.Value
        If txtFacebookLinkURL.Value <> "" Then .FacebookLinkURL = txtFacebookLinkURL.Value
        .IncludeLinkedIn = checkIncludeLinkedIn.Value
        If txtLinkedInLinkURL.Value <> "" Then .LinkedInLinkURL = txtLinkedInLinkURL.Value
    End With
    
    'In case we come back to this UserForm
    
    ThisDocument.InProgress2 = "Yes"
    
End Sub

Private Sub checkErrors()
    
    'Run through entered information to see what is missing
    'Populate message box content
    
    ErrorAlerts = ""
    
    With ThisDocument
        If .WebsiteLinkText = "" Then ErrorAlerts = ErrorAlerts & "Website display text" & vbNewLine
        If .WebsiteLinkURL = "" Then ErrorAlerts = ErrorAlerts & "Website URL" & vbNewLine
        If .IncludeTwitter = True And .TwitterLinkURL = "" Then ErrorAlerts = ErrorAlerts & "Twitter link" & vbNewLine
        If .IncludeFacebook = True And .FacebookLinkURL = "" Then ErrorAlerts = ErrorAlerts & "Facebook link" & vbNewLine
        If .IncludeLinkedIn = True And .LinkedInLinkURL = "" Then ErrorAlerts = ErrorAlerts & "LinkedIn link" & vbNewLine
        
    End With
    
    'Show message box if anything is missing
    
    If ErrorAlerts <> "" Then
        MsgBox ErrorAlerts, _
        vbExclamation, "Please fill out these required fields"
    End If
    
End Sub

Private Sub checkIncludeTwitter_Change()
    If checkIncludeTwitter.Value = False Then txtTwitterLinkURL.Enabled = False Else txtTwitterLinkURL.Enabled = True
End Sub

Private Sub checkIncludeFacebook_Change()
    If checkIncludeFacebook.Value = False Then txtFacebookLinkURL.Enabled = False Else txtFacebookLinkURL.Enabled = True
End Sub

Private Sub checkIncludeLinkedIn_Change()
    If checkIncludeLinkedIn.Value = False Then txtLinkedInLinkURL.Enabled = False Else txtLinkedInLinkURL.Enabled = True
End Sub
Attribute VB_Name = "frmPromotion"
Attribute VB_Base = "0{2C40B7FF-1AB9-9340-8C3C-F65D9D076DB8}{306401BD-4AFA-154F-B98C-18255F0EBE12}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private ErrorAlerts As String

Private Sub UserForm_Initialize()

    'Check to see if data has already been entered
    'If so, initialize with information already captured

    If ThisDocument.InProgress3 = "Yes" Then
        With ThisDocument
            If .IncludePromotion = True Then checkIncludePromotion = True Else checkIncludePromotion = False
            txtPromotionMessage.Value = .PromotionMessage
            txtPromotionLinkText.Value = .PromotionLinkText
            txtPromotionLinkURL.Value = .PromotionLinkURL
        End With
    
    'Or else with standard information
        
    Else
        With ThisDocument
            checkIncludePromotion = False
            txtPromotionMessage.Value = .PromotionMessage
            txtPromotionLinkText.Value = .PromotionLinkText
            txtPromotionLinkURL.Value = .PromotionLinkURL
        End With
    End If

End Sub

Private Sub txtPromotionMessage_Enter()
    
    'Select the contents of the first field
 
     With Me.txtPromotionMessage
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

Private Sub cmdPromotionBack_Click()

    'Save data (no need to check for errors here)
    
    saveData
    
    'Show previous UserForm
    
    Unload frmPromotion
    frmLinks.Show

End Sub

Private Sub cmdPromotionCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmPromotion
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmPromotion
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdPromotionContinue_Click()
    
    'Save data and check for errors
    
    saveData
    checkErrors
    
    'Stop if errors
    
    If ErrorAlerts <> "" Then Exit Sub
    
    'Show next UserForm
    
    Unload frmPromotion
    frmReview.Show
    
End Sub

Private Sub saveData()
    
    'Trim leading and trailing spaces from manually entered values
    
    txtPromotionMessage.Value = Trim(txtPromotionMessage.Value)
    txtPromotionLinkText.Value = Trim(txtPromotionLinkText.Value)
    txtPromotionLinkURL.Value = Trim(txtPromotionLinkURL.Value)
    
    'Store the entered information in public variables for later
    
    With ThisDocument
        .IncludePromotion = checkIncludePromotion.Value
        If txtPromotionMessage.Value <> "" Then .PromotionMessage = txtPromotionMessage.Value
        If txtPromotionLinkText.Value <> "" Then .PromotionLinkText = txtPromotionLinkText.Value
        If txtPromotionLinkURL.Value <> "" Then .PromotionLinkURL = txtPromotionLinkURL.Value
    End With
    
    'In case we come back to this UserForm
    
    ThisDocument.InProgress3 = "Yes"
    
End Sub

Private Sub checkErrors()
    
    'Run through entered information to see what is missing
    'Populate message box content
    
    ErrorAlerts = ""
    
    With ThisDocument
        If .IncludePromotion = True Then
            If .PromotionMessage = "" Then ErrorAlerts = ErrorAlerts & "Promotion message" & vbNewLine
            If .PromotionLinkText = "" Then ErrorAlerts = ErrorAlerts & "Text for link" & vbNewLine
            If .PromotionLinkURL = "" Then ErrorAlerts = ErrorAlerts & "URL for link" & vbNewLine
        End If
    End With
    
    'Show message box if anything is missing
    
    If ErrorAlerts <> "" Then
        MsgBox ErrorAlerts, _
        vbExclamation, "Please fill out these required fields"
    End If
    
End Sub

Private Sub checkIncludePromotion_Change()
    If checkIncludePromotion.Value = False Then
        txtPromotionMessage.Enabled = False
        txtPromotionLinkText.Enabled = False
        txtPromotionLinkURL.Enabled = False
    Else
        txtPromotionMessage.Enabled = True
        txtPromotionLinkText.Enabled = True
        txtPromotionLinkURL.Enabled = True
    End If
End Sub
Attribute VB_Name = "frmReview"
Attribute VB_Base = "0{35393F06-51B8-DB4D-A108-EF83CA708F44}{DCDCAB99-56DD-AE46-BD9E-6847F819C716}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private ConfirmationText As String

Private Sub UserForm_Initialize()
    
    'Populate UserForm with entered information
    
    With ThisDocument
        ConfirmationText = .EnteredName & vbNewLine & .EnteredTitle
        If .EnteredDivision <> "" Then ConfirmationText = ConfirmationText & ", " & .EnteredDivision
        ConfirmationText = ConfirmationText & vbNewLine
        
        If .EnteredTelephone1 <> "" Then ConfirmationText = ConfirmationText & vbNewLine & .EnteredTelephone1Label & " " & .EnteredTelephone1
        If .EnteredTelephone2 <> "" Then ConfirmationText = ConfirmationText & vbNewLine & .EnteredTelephone2Label & " " & .EnteredTelephone2
        If .EnteredEmail <> "" Then ConfirmationText = ConfirmationText & vbNewLine & .EnteredEmail
        If .EnteredTelephone1 <> "" Or .EnteredTelephone2 <> "" Or .EnteredEmail <> "" Then ConfirmationText = ConfirmationText & vbNewLine
        
        ConfirmationText = ConfirmationText & vbNewLine & "DXC Technology"
        If .EnteredAddress1 <> "" Then ConfirmationText = ConfirmationText & vbNewLine & .EnteredAddress1
        If .EnteredAddress2 <> "" Then ConfirmationText = ConfirmationText & vbNewLine & .EnteredAddress2
        ConfirmationText = ConfirmationText & vbNewLine
        
        ConfirmationText = ConfirmationText & vbNewLine & .WebsiteLinkText
        If .IncludeTwitter = True Then ConfirmationText = ConfirmationText & " / Twitter"
        If .IncludeFacebook = True Then ConfirmationText = ConfirmationText & " / Facebook"
        If .IncludeLinkedIn = True Then ConfirmationText = ConfirmationText & " / LinkedIn"
        ConfirmationText = ConfirmationText & vbNewLine
        
        If .IncludePromotion = True Then ConfirmationText = ConfirmationText & vbNewLine & .PromotionMessage & vbNewLine & .PromotionLinkText
    End With

    lblConfirmationText = ConfirmationText

End Sub

Private Sub cmdConfirmBack_Click()

    'Show previous UserForm

    Unload frmReview
    frmPromotion.Show
    
End Sub

Private Sub cmdConfirmCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmReview
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmReview
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdConfirmContinue_Click()

    'Show next UserForm based on Mac vs PC
    
    If Environ("OS") = "" Then
        Unload frmReview
        frmSaveMac.Show
    Else
        Unload frmReview
        frmSavePC.Show
    End If
    
End Sub
Attribute VB_Name = "frmSaveMac"
Attribute VB_Base = "0{7ED55265-0D41-DA4B-9D73-7BD0C25BA8F1}{8DC646BD-6DAD-8046-B0B3-F62705DFC5CB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Public Function HTMLEncodeMac(data As String) As String
    Dim strTemp As String
    strTemp = data
    
    'Used Chr codes since Windows didn't recognize characters
    'Chr codes are Mac OS Roman NOT Windows Latin 1
    
    'Ampersand first to avoid double replacement
    strTemp = Replace(strTemp, Chr(38), "&amp;")
    
    strTemp = Replace(strTemp, Chr(34), "&quot;")
    strTemp = Replace(strTemp, Chr(39), "&#39;")
    strTemp = Replace(strTemp, Chr(60), "&lt;")
    strTemp = Replace(strTemp, Chr(62), "&gt;")
    strTemp = Replace(strTemp, Chr(128), "&Auml;")
    strTemp = Replace(strTemp, Chr(129), "&Aring;")
    strTemp = Replace(strTemp, Chr(130), "&Ccedil;")
    strTemp = Replace(strTemp, Chr(131), "&Eacute;")
    strTemp = Replace(strTemp, Chr(132), "&Ntilde;")
    strTemp = Replace(strTemp, Chr(133), "&Ouml;")
    strTemp = Replace(strTemp, Chr(134), "&Uuml;")
    strTemp = Replace(strTemp, Chr(135), "&aacute;")
    strTemp = Replace(strTemp, Chr(136), "&agrave;")
    strTemp = Replace(strTemp, Chr(137), "&acirc;")
    strTemp = Replace(strTemp, Chr(138), "&auml;")
    strTemp = Replace(strTemp, Chr(139), "&atilde;")
    strTemp = Replace(strTemp, Chr(140), "&aring;")
    strTemp = Replace(strTemp, Chr(141), "&ccedil;")
    strTemp = Replace(strTemp, Chr(142), "&eacute;")
    strTemp = Replace(strTemp, Chr(143), "&egrave;")
    strTemp = Replace(strTemp, Chr(144), "&ecirc;")
    strTemp = Replace(strTemp, Chr(145), "&euml;")
    strTemp = Replace(strTemp, Chr(146), "&iacute;")
    strTemp = Replace(strTemp, Chr(147), "&igrave;")
    strTemp = Replace(strTemp, Chr(148), "&icirc;")
    strTemp = Replace(strTemp, Chr(149), "&iuml;")
    strTemp = Replace(strTemp, Chr(150), "&ntilde;")
    strTemp = Replace(strTemp, Chr(151), "&oacute;")
    strTemp = Replace(strTemp, Chr(152), "&ograve;")
    strTemp = Replace(strTemp, Chr(153), "&ocirc;")
    strTemp = Replace(strTemp, Chr(154), "&ouml;")
    strTemp = Replace(strTemp, Chr(155), "&otilde;")
    strTemp = Replace(strTemp, Chr(156), "&uacute;")
    strTemp = Replace(strTemp, Chr(157), "&ugrave;")
    strTemp = Replace(strTemp, Chr(158), "&ucirc;")
    strTemp = Replace(strTemp, Chr(159), "&uuml;")
    strTemp = Replace(strTemp, Chr(160), "&dagger;")
    strTemp = Replace(strTemp, Chr(161), "&deg;")
    strTemp = Replace(strTemp, Chr(162), "&cent;")
    strTemp = Replace(strTemp, Chr(163), "&pound;")
    strTemp = Replace(strTemp, Chr(164), "&sect;")
    strTemp = Replace(strTemp, Chr(165), "&bull;")
    strTemp = Replace(strTemp, Chr(166), "&para;")
    strTemp = Replace(strTemp, Chr(167), "&szlig;")
    strTemp = Replace(strTemp, Chr(168), "&reg;")
    strTemp = Replace(strTemp, Chr(169), "&copy;")
    strTemp = Replace(strTemp, Chr(170), "&trade;")
    strTemp = Replace(strTemp, Chr(171), "&acute;")
    strTemp = Replace(strTemp, Chr(172), "&uml;")
    strTemp = Replace(strTemp, Chr(173), "&ne;")
    strTemp = Replace(strTemp, Chr(174), "&AElig;")
    strTemp = Replace(strTemp, Chr(175), "&Oslash;")
    strTemp = Replace(strTemp, Chr(176), "&infin;")
    strTemp = Replace(strTemp, Chr(177), "&plusmn;")
    strTemp = Replace(strTemp, Chr(178), "&le;")
    strTemp = Replace(strTemp, Chr(179), "&ge;")
    strTemp = Replace(strTemp, Chr(180), "&yen;")
    strTemp = Replace(strTemp, Chr(181), "&micro;")
    strTemp = Replace(strTemp, Chr(182), "&part;")
    strTemp = Replace(strTemp, Chr(183), "&sum;")
    strTemp = Replace(strTemp, Chr(184), "&prod;")
    strTemp = Replace(strTemp, Chr(185), "&pi;")
    strTemp = Replace(strTemp, Chr(186), "&int;")
    strTemp = Replace(strTemp, Chr(187), "&ordf;")
    strTemp = Replace(strTemp, Chr(188), "&ordm;")
    strTemp = Replace(strTemp, Chr(189), "&Omega;")
    strTemp = Replace(strTemp, Chr(190), "&aelig;")
    strTemp = Replace(strTemp, Chr(191), "&oslash;")
    strTemp = Replace(strTemp, Chr(192), "&iquest;")
    strTemp = Replace(strTemp, Chr(193), "&iexcl;")
    strTemp = Replace(strTemp, Chr(194), "&not;")
    strTemp = Replace(strTemp, Chr(195), "&radic;")
    strTemp = Replace(strTemp, Chr(196), "&fnof;")
    strTemp = Replace(strTemp, Chr(197), "&asymp;")
    strTemp = Replace(strTemp, Chr(199), "&laquo;")
    strTemp = Replace(strTemp, Chr(200), "&raquo;")
    strTemp = Replace(strTemp, Chr(201), "&hellip;")
    strTemp = Replace(strTemp, Chr(202), "&nbsp;")
    strTemp = Replace(strTemp, Chr(203), "&Agrave;")
    strTemp = Replace(strTemp, Chr(204), "&Atilde;")
    strTemp = Replace(strTemp, Chr(205), "&Otilde;")
    strTemp = Replace(strTemp, Chr(206), "&OElig;")
    strTemp = Replace(strTemp, Chr(207), "&oelig;")
    strTemp = Replace(strTemp, Chr(208), "&ndash;")
    strTemp = Replace(strTemp, Chr(209), "&mdash;")
    strTemp = Replace(strTemp, Chr(210), "&ldquo;")
    strTemp = Replace(strTemp, Chr(211), "&rdquo;")
    strTemp = Replace(strTemp, Chr(212), "&lsquo;")
    strTemp = Replace(strTemp, Chr(213), "&rsquo;")
    strTemp = Replace(strTemp, Chr(214), "&divide;")
    strTemp = Replace(strTemp, Chr(215), "&loz;")
    strTemp = Replace(strTemp, Chr(216), "&yuml;")
    strTemp = Replace(strTemp, Chr(217), "&Yuml;")
    strTemp = Replace(strTemp, Chr(218), "&frasl;")
    strTemp = Replace(strTemp, Chr(219), "&euro;")
    strTemp = Replace(strTemp, Chr(220), "&lsaquo;")
    strTemp = Replace(strTemp, Chr(221), "&rsaquo;")
    strTemp = Replace(strTemp, Chr(222), "fi")
    strTemp = Replace(strTemp, Chr(223), "fl")
    strTemp = Replace(strTemp, Chr(224), "&Dagger;")
    strTemp = Replace(strTemp, Chr(225), "&middot;")
    strTemp = Replace(strTemp, Chr(226), "&sbquo;")
    strTemp = Replace(strTemp, Chr(227), "&bdquo;")
    strTemp = Replace(strTemp, Chr(228), "&permil;")
    strTemp = Replace(strTemp, Chr(229), "&Acirc;")
    strTemp = Replace(strTemp, Chr(230), "&Ecirc;")
    strTemp = Replace(strTemp, Chr(231), "&Aacute;")
    strTemp = Replace(strTemp, Chr(232), "&Euml;")
    strTemp = Replace(strTemp, Chr(233), "&Egrave;")
    strTemp = Replace(strTemp, Chr(234), "&Iacute;")
    strTemp = Replace(strTemp, Chr(235), "&Icirc;")
    strTemp = Replace(strTemp, Chr(236), "&Iuml;")
    strTemp = Replace(strTemp, Chr(237), "&Igrave;")
    strTemp = Replace(strTemp, Chr(238), "&Oacute;")
    strTemp = Replace(strTemp, Chr(239), "&Ocirc;")
    strTemp = Replace(strTemp, Chr(241), "&Ograve;")
    strTemp = Replace(strTemp, Chr(242), "&Uacute;")
    strTemp = Replace(strTemp, Chr(243), "&Ucirc;")
    strTemp = Replace(strTemp, Chr(244), "&Ugrave;")
    strTemp = Replace(strTemp, Chr(246), "&circ;")
    strTemp = Replace(strTemp, Chr(247), "&tilde;")
    strTemp = Replace(strTemp, Chr(248), "&macr;")
    strTemp = Replace(strTemp, Chr(252), "&cedil;")
    
    HTMLEncodeMac = strTemp
End Function

Private Sub UserForm_Initialize()

    'Initialize with recommended options
    
    Dim LastName As String
    
    If ThisDocument.EnteredName <> "" Then
        LastName = Replace(ThisDocument.EnteredName, Chr(34), "")
        LastName = Replace(LastName, Chr(39), "")
        LastName = Replace(LastName, Chr(47), "")
        LastName = Replace(LastName, Chr(58), "")
        LastName = Replace(LastName, Chr(92), "")
        
        If InStr(LastName, ",") Then
            LastName = Mid(LastName, 1, InStr(LastName, ",") - 1) 'Remove credentials (if any) to keep shorter
        End If
        
        If InStr(LastName, " ") Then
            LastName = Right(LastName, Len(LastName) - InStrRev(LastName, " ")) 'Only leave lastname to keep shorter
        End If
        
        txtSignatureName.Value = LastName & " DXC"
    
    Else
        txtSignatureName.Value = "My DXC Signature"
    
    End If
    
End Sub

Private Sub txtSignatureName_Enter()
    
    'Select the contents of the first field
 
     With Me.txtSignatureName
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

Private Sub cmdSaveBack_Click()

    'Show previous UserForm

    Unload frmSaveMac
    frmReview.Show

End Sub

Private Sub cmdSaveCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmSaveMac
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmSaveMac
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdSaveContinue_Click()

    On Error Resume Next

    'Replace special characters with HTML codes
    'Only needs to be done for Mac version since HTML needs to work with a browser
    
    With ThisDocument
        .EnteredName = HTMLEncodeMac(.EnteredName)
        .EnteredTitle = HTMLEncodeMac(.EnteredTitle)
        .EnteredDivision = HTMLEncodeMac(.EnteredDivision)
        .EnteredTelephone1 = HTMLEncodeMac(.EnteredTelephone1)
        .EnteredTelephone2 = HTMLEncodeMac(.EnteredTelephone2)
        .EnteredAddress1 = HTMLEncodeMac(.EnteredAddress1)
        .EnteredAddress2 = HTMLEncodeMac(.EnteredAddress2)
    End With
    
    'Assemble the HTML
    
    Dim signatureHTML As String
    
    With ThisDocument
        'HTML same for both PC and Mac EXCEPT font sizes - 10pt on PC is 7.5pt on Mac, 11pt on PC is 8.25pt on Mac
        signatureHTML = "<html>" & vbCrLf & "<head>" & vbCrLf & "<title></title>" & vbCrLf & "<meta name=""format-detection"" content=""telephone=no"">" & vbCrLf & "<meta name=""viewport"" content=""width=device-width, initial-scale=1, maximum-scale=1"">" & vbCrLf & "</head>" & vbCrLf & _
        "<body style=""font-size: 7.5pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf & _
        "<div style=""font-size: 7.5pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf & _
        "<span style=""font-size: 7.5pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf
        
        'Name, title and division block
        signatureHTML = signatureHTML & "<span style=""font-size: 8.25pt;""><strong>" & .EnteredName & "</strong><br />" & .EnteredTitle
        If .EnteredDivision <> "" Then signatureHTML = signatureHTML & ", " & .EnteredDivision
        signatureHTML = signatureHTML & "</span><br />" & vbCrLf
        
        'Telephone and email block
        If .EnteredTelephone1 <> "" Or .EnteredTelephone2 <> "" Or .EnteredEmail <> "" Then signatureHTML = signatureHTML & "<br />" & vbCrLf
        If .EnteredTelephone1 <> "" Then signatureHTML = signatureHTML & .EnteredTelephone1Label & " " & .EnteredTelephone1 & "<br />" & vbCrLf
        If .EnteredTelephone2 <> "" Then signatureHTML = signatureHTML & .EnteredTelephone2Label & " " & .EnteredTelephone2 & "<br />" & vbCrLf
        If .EnteredEmail <> "" Then signatureHTML = signatureHTML & "<a href=""mailto:" & .EnteredEmail & """ style=""color: #000000;"">" & .EnteredEmail & "</a><br />" & vbCrLf
        
        'Company name and address block
        signatureHTML = signatureHTML & "<br />" & vbCrLf
        signatureHTML = signatureHTML & "<strong>DXC Technology</strong><br />" & vbCrLf
        If .EnteredAddress1 <> "" Then signatureHTML = signatureHTML & .EnteredAddress1 & "<br />" & vbCrLf
        If .EnteredAddress2 <> "" Then signatureHTML = signatureHTML & .EnteredAddress2 & "<br />" & vbCrLf
        
        'Website and social links block
        signatureHTML = signatureHTML & "<br />" & vbCrLf
        signatureHTML = signatureHTML & "<a href=""" & .WebsiteLinkURL & """ style=""color: #000000;"">" & .WebsiteLinkText & "</a>"
        If .IncludeTwitter = True Then signatureHTML = signatureHTML & " / <a href=""" & .TwitterLinkURL & """ style=""color: #000000;"">Twitter</a>"
        If .IncludeFacebook = True Then signatureHTML = signatureHTML & " / <a href=""" & .FacebookLinkURL & """ style=""color: #000000;"">Facebook</a>"
        If .IncludeLinkedIn = True Then signatureHTML = signatureHTML & " / <a href=""" & .LinkedInLinkURL & """ style=""color: #000000;"">LinkedIn</a>"
        
        'Promotion block
        If .IncludePromotion = True Then
            signatureHTML = signatureHTML & "<br />" & vbCrLf & "<br />" & vbCrLf
            signatureHTML = signatureHTML & .PromotionMessage & "<br />" & vbCrLf
            signatureHTML = signatureHTML & "<a href=""" & .PromotionLinkURL & """ style=""color: #000000;"">" & .PromotionLinkText & "</a>"
        End If
        
        signatureHTML = signatureHTML & vbCrLf & "</span>" & vbCrLf & "</div>" & vbCrLf & "</body>" & vbCrLf & "</html>"
    End With

    'Get path to Desktop
    
    Dim desktopPath As String
    desktopPath = MacScript("return (path to desktop folder) as String")
    
    'Append signature file name to path
    
    Dim filePath As String
    filePath = desktopPath & txtSignatureName.Value & ".html"
    
    'Write the HTML to the file
    
    Dim outputFile
    outputFile = FreeFile
    Open filePath For Output As #outputFile
    Print #outputFile, signatureHTML
    Close #outputFile
    
    'Write the read me file

    Dim fileContent As String
    
    filePath = desktopPath & "Read Me DXC Signature.txt"
    fileContent = "How to install the DXC email signature on a Mac" & vbCrLf & vbCrLf & _
        "1. Locate the HTML file """ & txtSignatureName.Value & ".html"" on your desktop." & vbCrLf & _
        "2. Open the HTML file in Safari by opening a browser window in Safari and then dragging the HTML file into the main window." & vbCrLf & _
        "3. In Safari, select all (Command + A) and copy (Command + C)." & vbCrLf & _
        "4. Close Safari and open Outlook." & vbCrLf & _
        "5. Select Outlook > Preferences > Signatures." & vbCrLf & _
        "6. Create a new signature." & vbCrLf & _
        "7. Delete any placeholder content." & vbCrLf & _
        "8. Paste (Command + V) in the new content." & vbCrLf & _
        "9. Rename the new signature if desired." & vbCrLf & _
        "10. Click ""Default Signatures"" to assign your signature." & vbCrLf & vbCrLf & _
        "After creating your new signature in Outlook, you can delete the HTML and Read Me files from your desktop."
    
    outputFile = FreeFile
    Open filePath For Output As #outputFile
    Print #outputFile, fileContent
    Close #outputFile
    
    'Show next UserForm
    
    Unload frmSaveMac
    frmGoodbyeMac.Show

End Sub
Attribute VB_Name = "frmSavePC"
Attribute VB_Base = "0{B3377A71-A38E-F843-A1A8-56E29D3A8A07}{FB42AEDB-D57A-EB48-8D0C-0A222AF7731F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Initialize()

    'Initialize with recommended options
    
    Dim LastName As String
    
    If ThisDocument.EnteredName <> "" Then
        LastName = Replace(ThisDocument.EnteredName, Chr(34), "")
        LastName = Replace(LastName, Chr(39), "")
        LastName = Replace(LastName, Chr(47), "")
        LastName = Replace(LastName, Chr(58), "")
        LastName = Replace(LastName, Chr(92), "")
        
        If InStr(LastName, ",") Then
            LastName = Mid(LastName, 1, InStr(LastName, ",") - 1) 'Remove credentials to keep shorter
        End If
        
        If InStr(LastName, " ") Then
            LastName = Right(LastName, Len(LastName) - InStrRev(LastName, " ")) 'Only leave lastname to keep shorter
        End If
        
        txtSignatureName.Value = LastName & " DXC"
    
    Else
        txtSignatureName.Value = "My DXC Signature"
    
    End If
    
End Sub

Private Sub txtSignatureName_Enter()
    
    'Select the contents of the first field
 
     With Me.txtSignatureName
        .SelStart = 0
        .SelLength = Len(.Text)
    End With
End Sub

Private Sub cmdSaveBack_Click()

    'Show previous UserForm

    Unload frmSavePC
    frmReview.Show

End Sub

Private Sub cmdSaveCancel_Click()

    'Cancel and close appropriate windows
    
    Unload frmSavePC
    Documents(ThisDocument.SourceFileName).Activate
    ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    
End Sub

Private Sub cmdSaveContinue_Click()
    
    On Error Resume Next

    Dim strSigName
    Dim boolUpdateStyle
    Dim strSigFolder
    Dim strHTMFile, strTXTFile, strRTFFile

    'Set variables not already captured
    
    strSigName = txtSignatureName.Value
   
    'If signature exists, overwrite (true) or leave alone (false)?
    
    boolUpdateStyle = True

    'Get signature folder
    
    Dim objShell
    Set objShell = CreateObject("WScript.Shell")
    strSigFolder = objShell.ExpandEnvironmentStrings("%appdata%") & "\Microsoft\Signatures\"
    Set objShell = Nothing
    
    Dim objFSO, objFile
    Set objFSO = CreateObject("Scripting.FileSystemObject")

    If Not (objFSO.FolderExists(strSigFolder)) Then
        Call objFSO.CreateFolder(strSigFolder)
    End If

    strHTMFile = strSigFolder & strSigName & ".htm"
    strTXTFile = strSigFolder & strSigName & ".txt"
    strRTFFile = strSigFolder & strSigName & ".rtf"
    
    'Create HTM file

    Err.Clear
    Set objFile = objFSO.CreateTextFile(strHTMFile, boolUpdateStyle, False)
    
    Dim signatureHTML As String
    
    With ThisDocument
        'HTML same for both PC and Mac EXCEPT font sizes - 10pt on PC is 7.5pt on Mac, 11pt on PC is 8.25pt on Mac
        signatureHTML = "<html>" & vbCrLf & "<head>" & vbCrLf & "<title></title>" & vbCrLf & "<meta name=""format-detection"" content=""telephone=no"">" & vbCrLf & "<meta name=""viewport"" content=""width=device-width, initial-scale=1, maximum-scale=1"">" & vbCrLf & "</head>" & vbCrLf & _
        "<body style=""font-size: 10pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf & _
        "<div style=""font-size: 10pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf & _
        "<span style=""font-size: 10pt; color: #000000; font-family: Arial, sans-serif; -webkit-text-size-adjust: 100%; -moz-text-size-adjust: 100%; -ms-text-size-adjust: 100%;"">" & vbCrLf
        
        'Name, title and division block
        signatureHTML = signatureHTML & "<span style=""font-size: 11pt;""><strong>" & .EnteredName & "</strong><br />" & .EnteredTitle
        If .EnteredDivision <> "" Then signatureHTML = signatureHTML & ", " & .EnteredDivision
        signatureHTML = signatureHTML & "</span><br />" & vbCrLf
        
        'Telephone and email block
        If .EnteredTelephone1 <> "" Or .EnteredTelephone2 <> "" Or .EnteredEmail <> "" Then signatureHTML = signatureHTML & "<br />" & vbCrLf
        If .EnteredTelephone1 <> "" Then signatureHTML = signatureHTML & .EnteredTelephone1Label & " " & .EnteredTelephone1 & "<br />" & vbCrLf
        If .EnteredTelephone2 <> "" Then signatureHTML = signatureHTML & .EnteredTelephone2Label & " " & .EnteredTelephone2 & "<br />" & vbCrLf
        If .EnteredEmail <> "" Then signatureHTML = signatureHTML & "<a href=""mailto:" & .EnteredEmail & """ style=""color: #000000;"">" & .EnteredEmail & "</a><br />" & vbCrLf
        
        'Company name and address block
        signatureHTML = signatureHTML & "<br />" & vbCrLf
        signatureHTML = signatureHTML & "<strong>DXC Technology</strong><br />" & vbCrLf
        If .EnteredAddress1 <> "" Then signatureHTML = signatureHTML & .EnteredAddress1 & "<br />" & vbCrLf
        If .EnteredAddress2 <> "" Then signatureHTML = signatureHTML & .EnteredAddress2 & "<br />" & vbCrLf
        
        'Website and social links block
        signatureHTML = signatureHTML & "<br />" & vbCrLf
        signatureHTML = signatureHTML & "<a href=""" & .WebsiteLinkURL & """ style=""color: #000000;"">" & .WebsiteLinkText & "</a>"
        If .IncludeTwitter = True Then signatureHTML = signatureHTML & " / <a href=""" & .TwitterLinkURL & """ style=""color: #000000;"">Twitter</a>"
        If .IncludeFacebook = True Then signatureHTML = signatureHTML & " / <a href=""" & .FacebookLinkURL & """ style=""color: #000000;"">Facebook</a>"
        If .IncludeLinkedIn = True Then signatureHTML = signatureHTML & " / <a href=""" & .LinkedInLinkURL & """ style=""color: #000000;"">LinkedIn</a>"
        
        'Promotion block
        If .IncludePromotion = True Then
            signatureHTML = signatureHTML & "<br />" & vbCrLf & "<br />" & vbCrLf
            signatureHTML = signatureHTML & .PromotionMessage & "<br />" & vbCrLf
            signatureHTML = signatureHTML & "<a href=""" & .PromotionLinkURL & """ style=""color: #000000;"">" & .PromotionLinkText & "</a>"
        End If
        
        signatureHTML = signatureHTML & vbCrLf & "</span>" & vbCrLf & "</div>" & vbCrLf & "</body>" & vbCrLf & "</html>"
    End With

    objFile.write signatureHTML
    objFile.Close
    
    'Create TXT file
    
    Err.Clear
    Set objFile = objFSO.CreateTextFile(strTXTFile, boolUpdateStyle, False)
    
    If Err.Number = 0 Then
        With ThisDocument
            'Name, title and division block
            objFile.write .EnteredName & vbCrLf & .EnteredTitle
            If .EnteredDivision <> "" Then objFile.write ", " & .EnteredDivision
            objFile.write vbCrLf
            
            'Telephone and email block
            If .EnteredTelephone1 <> "" Or .EnteredTelephone2 <> "" Or .EnteredEmail <> "" Then objFile.write vbCrLf
            If .EnteredTelephone1 <> "" Then objFile.write .EnteredTelephone1Label & " " & .EnteredTelephone1 & vbCrLf
            If .EnteredTelephone2 <> "" Then objFile.write .EnteredTelephone2Label & " " & .EnteredTelephone2 & vbCrLf
            If .EnteredEmail <> "" Then objFile.write .EnteredEmail & vbCrLf

            'Company name and address block
            objFile.write vbCrLf
            objFile.write "DXC Technology" & vbCrLf
            If .EnteredAddress1 <> "" Then objFile.write .EnteredAddress1 & vbCrLf
            If .EnteredAddress2 <> "" Then objFile.write .EnteredAddress2 & vbCrLf
            
            'Website (no other links for TXT)
            objFile.write vbCrLf
            objFile.write .WebsiteLinkText
            
            objFile.Close
        End With
    End If

    'Create RTF file
    'No images in RTF because of Office 2007 problems

    Err.Clear
    Set objFile = objFSO.CreateTextFile(strRTFFile, boolUpdateStyle, False)

    If Err.Number = 0 Then
        With ThisDocument
            objFile.write "{\rtf1\ansi{\fonttbl{\f0 Arial;}}" & vbCrLf
            objFile.write "{\colortbl;\red0\green0\blue0;}" & vbCrLf
            
            'Set font color 1, font 0, 11pt
            objFile.write "\cf1\f0\fs22 "
            
            'Name, title and division block
            objFile.write "\b " & .EnteredName & "\b0" & "\line " & vbCrLf & .EnteredTitle
            If .EnteredDivision <> "" Then objFile.write ", " & .EnteredDivision
            objFile.write "\line " & vbCrLf
            
            'Set font 10pt
            objFile.write "\fs20 "
            
            'Telephone and email block
            If .EnteredTelephone1 <> "" Or .EnteredTelephone2 <> "" Or .EnteredEmail <> "" Then objFile.write "\line " & vbCrLf
            If .EnteredTelephone1 <> "" Then objFile.write .EnteredTelephone1Label & " " & .EnteredTelephone1 & "\line " & vbCrLf
            If .EnteredTelephone2 <> "" Then objFile.write .EnteredTelephone2Label & " " & .EnteredTelephone2 & "\line " & vbCrLf
            If .EnteredEmail <> "" Then objFile.write "{\field{\*\fldinst HYPERLINK ""mailto:" & .EnteredEmail & """}{\fldrslt\ul " & .EnteredEmail & "\ul0}}\line " & vbCrLf

            'Company name and address block
            objFile.write "\line " & vbCrLf
            objFile.write "\b DXC Technology" & "\b0" & "\line " & vbCrLf
            If .EnteredAddress1 <> "" Then objFile.write .EnteredAddress1 & "\line " & vbCrLf
            If .EnteredAddress2 <> "" Then objFile.write .EnteredAddress2 & "\line " & vbCrLf
            
            'Website and social links block
            objFile.write "\line " & vbCrLf
            objFile.write "\ul{\field{\*\fldinst HYPERLINK """ & .WebsiteLinkURL & """ }{\fldrslt " & .WebsiteLinkText & "}}\ul0 "
            If .IncludeTwitter = True Then objFile.write " / {\field{\*\fldinst HYPERLINK """ & .TwitterLinkURL & """ }{\fldrslt\ul Twitter\ul0 }}"
            If .IncludeFacebook = True Then objFile.write " / {\field{\*\fldinst HYPERLINK """ & .FacebookLinkURL & """ }{\fldrslt\ul Facebook\ul0 }}"
            If .IncludeLinkedIn = True Then objFile.write " / {\field{\*\fldinst HYPERLINK """ & .LinkedInLinkURL & """ }{\fldrslt\ul Linkedin\ul0 }}"
            
            'Promotion block
            If .IncludePromotion = True Then
                objFile.write "\line " & vbCrLf & "\line " & vbCrLf
                objFile.write .PromotionMessage & "\line " & vbCrLf
                objFile.write "\ul{\field{\*\fldinst HYPERLINK """ & .PromotionLinkURL & """ }{\fldrslt " & .PromotionLinkText & "}}\ul0"
            End If
            
            objFile.write "}"
            objFile.Close
        End With
    End If

    'Tidy-up
    
    Set objFile = Nothing
    Set objFSO = Nothing

    'Show next UserForm
    
    Unload frmSavePC
    frmGoodbyePC.Show

End Sub
Attribute VB_Name = "frmWelcome"
Attribute VB_Base = "0{14B21CEF-0DEE-384C-B35D-12F41F3402F8}{4D57C6E7-A1F0-CD4E-B4DD-91C502B8986C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdWelcomeCancel_Click()

    'Cancel and close appropriate windows
    
    If Environ("OS") = "" And Split(Application.Version, ".")(0) >= 15 Then
        ActiveDocument.Shapes("PleaseEnableMacros").TextFrame.TextRange = "Installation canceled. Please close this document."
        Unload frmWelcome
        Documents(ThisDocument.SourceFileName).ActiveWindow.WindowState = wdWindowStateMaximize
        ActiveDocument.Saved = True
    Else
        Unload frmWelcome
        Documents(ThisDocument.SourceFileName).Activate
        ActiveDocument.Close SaveChanges:=wdDoNotSaveChanges
    End If

End Sub

Private Sub cmdWelcomeContinue_Click()

    'Show next UserForm
    
    Unload frmWelcome
    frmIntro.Show

End Sub


INQUEST-PP=macro
