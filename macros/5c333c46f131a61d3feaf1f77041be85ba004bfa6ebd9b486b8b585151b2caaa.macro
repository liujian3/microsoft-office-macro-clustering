Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Address = "$E$2" Then
        Application.Run "Cout_Periode"
    End If
End Sub
Attribute VB_Name = "Feuil17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Address = "$AY$2" Then
        Application.Run "Traduire_" & Target.Value
    End If
End Sub
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil71"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module_Actions_Onglets"
Sub Masquage_Onglets_OFF()
    For Each WS In ThisWorkbook.Worksheets
        WS.Visible = True
    Next
End Sub
Sub Masquage_Onglets_ON()
    For Each WS In ThisWorkbook.Worksheets
        If WS.Tab.Color = RGB(255, 0, 0) Then
            WS.Visible = False
        End If
    Next
End Sub
Sub Verrouillage_Onglets_OFF()
    For Each WS In ThisWorkbook.Worksheets
        WS.Unprotect
    Next
End Sub
Sub Verrouillage_Onglets_ON()
    For Each WS In ThisWorkbook.Worksheets
        WS.Protect
        WS.EnableSelection = xlUnlockedCells
    Next
End Sub
Attribute VB_Name = "Module_D|fffd|clarations"
Option Explicit
Public WS, WS_Plan, WS_Todo_Rep, WS_Todo_Det, WS_Prod, WS_Comb, WS_Form, WS_Bati, WS_Amel, WS_Hero, WS_Cout_Ame, WS_Gain, WS_Trop, WS_Cout_For, WS_Cale, WS_Trad, WS_Para_Admin, WS_Para, WS_Jour As Worksheet
Public Plage, c, Remplacement As Range
Public msg As String
Public NumLigne, FinLigne, DernLigne, NumColonne, FinColonne, x, y, z, Ligne As Integer
Public Var1, Var_Or, Var_Elixir, Var_Elixir_Noir, NB As Long
Public Var, Upg As Variant
Sub D|fffd|claration_Onglets()

    On Error GoTo English

    Set WS_Plan = Worksheets("Planning")
    Set WS_Todo_Rep = Worksheets("|fffd| Faire - R|fffd|capitulatif")
    Set WS_Todo_Det = Worksheets("|fffd| Faire - D|fffd|tails")
    Set WS_Prod = Worksheets("Production")
    Set WS_Comb = Worksheets("Combats - Loots")
    Set WS_Form = Worksheets("Formation de Troupes")

    Set WS_Bati = Worksheets("B|fffd|timents")
    Set WS_Amel = Worksheets("Am|fffd|liorations - Sorts & Troupes")
    Set WS_Hero = Worksheets("H|fffd|ros")
    Set WS_Cout_Ame = Worksheets("Co|fffd|ts des Am|fffd|liorations")
    Set WS_Gain = Worksheets("Gains et Stockage")
    Set WS_Trop = Worksheets("Troph|fffd|es")
    Set WS_Cout_For = Worksheets("Co|fffd|ts de Formation")
    Set WS_Cale = Worksheets("Calendrier")
    Set WS_Trad = Worksheets("Traduction")

    Set WS_Para_Admin = Worksheets("Param|fffd|tres - Admin")
    Set WS_Para = Worksheets("Param|fffd|tres")

    Set WS_Jour = Worksheets("Journal des Modifications")
    Exit Sub

English:
    Set WS_Plan = Worksheets("Planning")
    Set WS_Todo_Rep = Worksheets("TO DO - Summary")
    Set WS_Todo_Det = Worksheets("TO DO - Details")
    Set WS_Prod = Worksheets("Production")
    Set WS_Comb = Worksheets("Raidings - Loots")
    Set WS_Form = Worksheets("Troops Training")

    Set WS_Bati = Worksheets("Buildings")
    Set WS_Amel = Worksheets("Upgrades - Spells & Troops")
    Set WS_Hero = Worksheets("Heroes")
    Set WS_Cout_Ame = Worksheets("Upgrades Costs")
    Set WS_Gain = Worksheets("Earnings & Storage")
    Set WS_Trop = Worksheets("Trophies")
    Set WS_Cout_For = Worksheets("Training Costs")
    Set WS_Cale = Worksheets("Calendar")
    Set WS_Trad = Worksheets("Translation")

    Set WS_Para_Admin = Worksheets("Parameters - Admin")
    Set WS_Para = Worksheets("Parameters")

    Set WS_Jour = Worksheets("ChangeLog")
End Sub
Attribute VB_Name = "Module_Planning"
Option Explicit
Sub Cr|fffd|er_Planning()
'Fonction qui d|fffd|fini le nom des feuilles
    D|fffd|claration_Onglets

    'D|fffd|but du tableau Planning - Ligne
    x = 5

    'D|fffd|but du tableau Planning - Colonne
    y = 1

    'Fin du tableau Param|fffd|tres - Ligne
    FinLigne = 88

    'Fin du tableau Param|fffd|tres - Colonne
    FinColonne = 47

    With ThisWorkbook
        With WS_Plan
            'D|fffd|verrouille la feuille
            .Unprotect

            'Afficher toutes les lignes
            With .Cells
                .EntireRow.Hidden = False
            End With

            'De la colonne B |fffd| la fin
            For NumColonne = 2 To FinColonne

                'Si "Rempart" / "Wall"
                If (WS_Para.Cells(2, NumColonne) = "Rempart" Or WS_Para.Cells(2, NumColonne) = "Wall") Then

                    'De la ligne 49 |fffd| la fin
                    For NumLigne = 49 To FinLigne

                        'Le nombre est inscrit dans Var
                        Var = WS_Para.Cells(NumLigne, NumColonne)

                        'Si la valeur n'est pas vide alors
                        If Var <> 0 Then

                            'De 1 jusqu'|fffd| 1
                            For z = 1 To 1

                                'Le num|fffd|ro de l'upgrade |fffd| faire est inscit dans Upg
                                Upg = WS_Para.Cells(NumLigne, 1)

                                'V|fffd|rification pour placer correctement la ligne
                                For Each c In .Range("A1:A" & x)
                                    If c.Value = WS_Para.Cells(2, NumColonne) Then
                                        x = c.Row
                                    End If
                                Next c

                                'Insertion de la ligne
                                .Rows(x + 1 & ":" & x + 1).Insert Shift:=xlDown

                                'On passe |fffd| la ligne suivante
                                x = x + 1

                                'La colonne 1 re|fffd|oit le nom de l'objet |fffd| upgrader
                                .Cells(x, y) = WS_Para.Cells(2, NumColonne) & " - x" & Var

                                'La colonne 2 re|fffd|oit la valeur de l'upgrade |fffd| faire
                                .Cells(x, y + 1) = Upg

                                'Recopier formules (s|fffd|lectionner glisser)
                                .Range("C" & x - 1 & ":BP" & x - 1).Select
                                Selection.AutoFill Destination:=.Range("C" & x - 1 & ":BP" & x), Type:=xlFillDefault

                                'On saute les lignes
                                x = x + Var + 300
                            Next
                        End If

                        'On passe |fffd| la ligne suivante pour inscrire
                        x = x + 1
                    Next

                Else

                    'De la ligne 49 |fffd| la fin
                    For NumLigne = 49 To FinLigne

                        'Le nombre est inscrit dans Var
                        Var = WS_Para.Cells(NumLigne, NumColonne)

                        'Si la valeur n'est pas vide alors
                        If Var <> 0 Then

                            'De 1 jusqu'|fffd| Var
                            For z = 1 To Var

                                'Le num|fffd|ro de l'upgrade |fffd| faire est inscit dans Upg
                                Upg = WS_Para.Cells(NumLigne, 1)

                                'V|fffd|rification pour placer correctement la ligne
                                For Each c In .Range("A1:A" & x)
                                    If c.Value = WS_Para.Cells(2, NumColonne) Then
                                        x = c.Row
                                    End If
                                Next c

                                'Insertion de la ligne
                                .Rows(x + 1 & ":" & x + 1).Insert Shift:=xlDown

                                'On passe |fffd| la ligne suivante
                                x = x + 1

                                'La colonne 1 re|fffd|oit le nom de l'objet |fffd| upgrader
                                .Cells(x, y) = WS_Para.Cells(2, NumColonne)

                                'La colonne 2 re|fffd|oit la valeur de l'upgrade |fffd| faire
                                .Cells(x, y + 1) = Upg

                                'Recopier formules (s|fffd|lectionner glisser)
                                .Range("C" & x - 1 & ":BP" & x - 1).Select
                                Selection.AutoFill Destination:=.Range("C" & x - 1 & ":BP" & x), Type:=xlFillDefault
                            Next
                        End If

                        'On passe |fffd| la ligne suivante pour inscrire
                        x = x + 1
                    Next
                End If
            Next


            'Masque la ligne 6
            .Range("I6").EntireRow.Hidden = True

            'D|fffd|termine la derni|fffd|re ligne
            DernLigne = .Columns(1).Find("*", , , , xlByColumns, xlPrevious).Row

            'De la ligne 8 |fffd| la derni|fffd|re ligne
            For NumLigne = 8 To DernLigne

                'Le nombre est inscrit dans Var
                Var = .Cells(NumLigne, 2)

                'Si la valeur n'est pas vide alors supprimer la ligne
                If Var = "" And .Range(NumLigne & ":" & NumLigne).MergeCells = False Then
                    .Rows(NumLigne & ":" & NumLigne).EntireRow.Hidden = True
                End If
            Next

            'Verrouille la feuille
            .Protect
            .EnableSelection = xlUnlockedCells
        End With
    End With
End Sub
Sub Reinitialiser_Planning()
'Fonction qui d|fffd|fini le nom des feuilles
    D|fffd|claration_Onglets

    With ThisWorkbook
        With WS_Plan

            'D|fffd|verrouille la feuille
            .Unprotect

            'Afficher toutes les lignes
            With .Cells
                .EntireRow.Hidden = False
            End With

            'D|fffd|termine la derni|fffd|re ligne
            DernLigne = .Columns(1).Find("*", , , , xlByColumns, xlPrevious).Row

            'De la ligne 8 |fffd| la derni|fffd|re ligne
            For NumLigne = 8 To DernLigne

                'Le nombre est inscrit dans Var
                Var = .Cells(NumLigne, 2)

                'Si la valeur n'est pas vide alors supprimer la ligne
                If Var <> "" Then
                    .Rows(NumLigne & ":" & NumLigne).EntireRow.Delete xlShiftUp
                    NumLigne = NumLigne - 1
                End If
            Next

            'Masque la ligne 6
            .Range("I6").EntireRow.Hidden = True

            'Verrouille la feuille
            .Protect
            .EnableSelection = xlUnlockedCells
        End With
    End With
End Sub
Sub Cout_Periode()
'Fonction qui d|fffd|fini le nom des feuilles
    D|fffd|claration_Onglets
    
    Rafraichissement_Ecran_OFF

    With ThisWorkbook
        With WS_Plan

            'D|fffd|verrouille la feuille
            .Unprotect

            'D|fffd|termine la derni|fffd|re ligne
            DernLigne = .Columns(1).Find("*", , , , xlByColumns, xlPrevious).Row

            NB = 0
            Var1 = 0
            Var_Or = 0
            Var_Elixir = 0
            Var_Elixir_Noir = 0

            'De la ligne 5 |fffd| la derni|fffd|re ligne
            For NumLigne = 5 To DernLigne

                'Si "Rempart" / "Wall"
                If (Left(.Cells(NumLigne, 1), 4) <> "Remp" And Left(.Cells(NumLigne, 1), 4) <> "Wall") Then

                    'Si P|fffd|riode S|fffd|lectionn|fffd|e
                    If .Cells(NumLigne, 5) = .Cells(2, 5) Then

                        'Le nombre est inscrit dans Var1
                        Var1 = .Cells(NumLigne, 3)

                        If Var1 <> "" Then
                            'Si la couleur de la cellule est "Or" alors
                            Select Case .Cells(NumLigne, 3).Interior.Color
                            Case Is = RGB(255, 192, 0)
                                Var_Or = Var1 + Var_Or
                                'MsgBox Var
                            Case Is = RGB(164, 30, 178)
                                Var_Elixir = Var1 + Var_Elixir
                                'MsgBox Var
                            Case Is = RGB(38, 38, 38)
                                Var_Elixir_Noir = Var1 + Var_Elixir_Noir
                                'MsgBox Var
                            End Select
                            NB = NB + 1
                        End If
                    End If
                End If
            Next

            .Cells(2, 11) = NB
            .Cells(2, 12) = Var_Or
            .Cells(2, 14) = Var_Elixir
            .Cells(2, 16) = Var_Elixir_Noir


            NB = 0
            Var1 = 0
            Var_Or = 0
            Var_Elixir = 0
            Var_Elixir_Noir = 0

            'De la ligne 5 |fffd| la derni|fffd|re ligne
            For NumLigne = 5 To DernLigne

                'Si "Rempart" / "Wall"
                If (Left(.Cells(NumLigne, 1), 4) <> "Remp" And Left(.Cells(NumLigne, 1), 4) <> "Wall") Then

                    'Si P|fffd|riode S|fffd|lectionn|fffd|e +1
                    If .Cells(NumLigne, 5) = .Cells(2, 5) + .Cells(2, 4) Then

                        'Le nombre est inscrit dans Var1
                        Var1 = .Cells(NumLigne, 3)

                        If Var1 <> "" Then
                            'Si la couleur de la cellule est "Or" alors
                            Select Case .Cells(NumLigne, 3).Interior.Color
                            Case Is = RGB(255, 192, 0)
                                Var_Or = Var1 + Var_Or
                                'MsgBox Var
                            Case Is = RGB(164, 30, 178)
                                Var_Elixir = Var1 + Var_Elixir
                                'MsgBox Var
                            Case Is = RGB(38, 38, 38)
                                Var_Elixir_Noir = Var1 + Var_Elixir_Noir
                                'MsgBox Var
                            End Select
                            NB = NB + 1
                        End If
                    End If
                End If
            Next

            .Cells(3, 11) = NB
            .Cells(3, 12) = Var_Or
            .Cells(3, 14) = Var_Elixir
            .Cells(3, 16) = Var_Elixir_Noir


            NB = 0
            Var1 = 0
            Var_Or = 0
            Var_Elixir = 0
            Var_Elixir_Noir = 0

            'De la ligne 5 |fffd| la derni|fffd|re ligne
            For NumLigne = 5 To DernLigne

                'Si "Rempart" / "Wall"
                If (Left(.Cells(NumLigne, 1), 4) <> "Remp" And Left(.Cells(NumLigne, 1), 4) <> "Wall") Then

                    'Si P|fffd|riode S|fffd|lectionn|fffd|e +2
                    If .Cells(NumLigne, 5) = .Cells(2, 5) + (2 * .Cells(2, 4)) Then

                        'Le nombre est inscrit dans Var
                        Var1 = .Cells(NumLigne, 3)

                        If Var1 <> "" Then
                            'Si la couleur de la cellule est "Or" alors
                            Select Case .Cells(NumLigne, 3).Interior.Color
                            Case Is = RGB(255, 192, 0)
                                Var_Or = Var1 + Var_Or
                                'MsgBox Var
                            Case Is = RGB(164, 30, 178)
                                Var_Elixir = Var1 + Var_Elixir
                                'MsgBox Var
                            Case Is = RGB(38, 38, 38)
                                Var_Elixir_Noir = Var1 + Var_Elixir_Noir
                                'MsgBox Var
                            End Select
                            NB = NB + 1
                        End If
                    End If
                End If
            Next

            .Cells(4, 11) = NB
            .Cells(4, 12) = Var_Or
            .Cells(4, 14) = Var_Elixir
            .Cells(4, 16) = Var_Elixir_Noir


            NB = 0
            Var1 = 0
            Var_Or = 0
            Var_Elixir = 0
            Var_Elixir_Noir = 0

            'De la ligne 5 |fffd| la derni|fffd|re ligne
            For NumLigne = 5 To DernLigne

                'Si "Rempart" / "Wall"
                If (Left(.Cells(NumLigne, 1), 4) <> "Remp" And Left(.Cells(NumLigne, 1), 4) <> "Wall") Then

                    'Si P|fffd|riode S|fffd|lectionn|fffd|e +2
                    If .Cells(NumLigne, 5) = .Cells(2, 5) + (3 * .Cells(2, 4)) Then

                        'Le nombre est inscrit dans Var1
                        Var1 = .Cells(NumLigne, 3)

                        If Var1 <> "" Then
                            'Si la couleur de la cellule est "Or" alors
                            Select Case .Cells(NumLigne, 3).Interior.Color
                            Case Is = RGB(255, 192, 0)
                                Var_Or = Var1 + Var_Or
                                'MsgBox Var
                            Case Is = RGB(164, 30, 178)
                                Var_Elixir = Var1 + Var_Elixir
                                'MsgBox Var
                            Case Is = RGB(38, 38, 38)
                                Var_Elixir_Noir = Var1 + Var_Elixir_Noir
                                'MsgBox Var
                            End Select
                            NB = NB + 1
                        End If
                    End If
                End If
            Next
            
            .Cells(5, 11) = NB
            .Cells(5, 12) = Var_Or
            .Cells(5, 14) = Var_Elixir
            .Cells(5, 16) = Var_Elixir_Noir

            'Verrouille la feuille
            .Protect
            .EnableSelection = xlUnlockedCells
        End With
    End With
    
    Rafraichissement_Ecran_ON
End Sub

Attribute VB_Name = "Module_Rafraichissement"
Option Explicit
Sub Rafraichissement_Ecran_OFF()
    Application.ScreenUpdating = False
End Sub
Sub Rafraichissement_Ecran_ON()
    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module_Traduction"
Option Explicit
Sub Traduire_Donnees_Anglais()
    For Each WS In ThisWorkbook.Worksheets
        WS.Select

        If (ActiveSheet.Name <> "Translation") Then
            Set Remplacement = Range("A1:" & Range("A1").SpecialCells(xlCellTypeLastCell).Address)
            For Each c In Remplacement
                On Error Resume Next
                c.Value = WorksheetFunction.Index(Range("Translation!A:B"), Application.Match(c.Value, Range("Translation!A:A"), 0), 2)
            Next c
        End If

        If (ActiveSheet.Name = "ChangeLog") Then
            Cacher_Colonne_Anglais
        End If
    Next WS
End Sub
Sub Traduire_Donnees_Fran|fffd|ais()
    For Each WS In ThisWorkbook.Worksheets
        WS.Select

        If (ActiveSheet.Name <> "Traduction") Then
            Set Remplacement = Range("A1:" & Range("A1").SpecialCells(xlCellTypeLastCell).Address)
            For Each c In Remplacement
                On Error Resume Next
                c.Value = WorksheetFunction.Index(Range("Traduction!A:B"), Application.Match(c.Value, Range("Traduction!B:B"), 0), 1)
            Next c
        End If

        If (ActiveSheet.Name = "Journal des Modifications") Then
            Cacher_Colonne_Fran|fffd|ais
        End If
    Next WS
End Sub
Sub Traduire_Onglet_Fran|fffd|ais()
    With ThisWorkbook
        WS_Plan.Name = "Planning"
        WS_Todo_Rep.Name = "|fffd| Faire - R|fffd|capitulatif"
        WS_Todo_Det.Name = "|fffd| Faire - D|fffd|tails"
        WS_Prod.Name = "Production"
        WS_Comb.Name = "Combats - Loots"
        WS_Form.Name = "Formation de Troupes"

        WS_Bati.Name = "B|fffd|timents"
        WS_Amel.Name = "Am|fffd|liorations - Sorts & Troupes"
        WS_Hero.Name = "H|fffd|ros"
        WS_Cout_Ame.Name = "Co|fffd|ts des Am|fffd|liorations"
        WS_Gain.Name = "Gains et Stockage"
        WS_Trop.Name = "Troph|fffd|es"
        WS_Cout_For.Name = "Co|fffd|ts de Formation"
        WS_Cale.Name = "Calendrier"
        WS_Trad.Name = "Traduction"

        WS_Para_Admin.Name = "Param|fffd|tres - Admin"
        WS_Para.Name = "Param|fffd|tres"

        WS_Jour.Name = "Journal des Modifications"
    End With
End Sub
Sub Traduire_Onglet_Anglais()
    With ThisWorkbook
        WS_Plan.Name = "Planning"
        WS_Todo_Rep.Name = "TO DO - Summary"
        WS_Todo_Det.Name = "TO DO - Details"
        WS_Prod.Name = "Production"
        WS_Comb.Name = "Raidings - Loots"
        WS_Form.Name = "Troops Training"

        WS_Bati.Name = "Buildings"
        WS_Amel.Name = "Upgrades - Spells & Troops"
        WS_Hero.Name = "Heroes"
        WS_Cout_Ame.Name = "Upgrades Costs"
        WS_Gain.Name = "Earnings & Storage"
        WS_Trop.Name = "Trophies"
        WS_Cout_For.Name = "Training Costs"
        WS_Cale.Name = "Calendar"
        WS_Trad.Name = "Translation"

        WS_Para_Admin.Name = "Parameters - Admin"
        WS_Para.Name = "Parameters"

        WS_Jour.Name = "ChangeLog"
    End With
End Sub
Sub Cacher_Colonne_Fran|fffd|ais()
    With ThisWorkbook
        WS_Jour.Columns("A:F").EntireColumn.Hidden = False
        WS_Jour.Columns("D:D").EntireColumn.Hidden = True
    End With
End Sub
Sub Cacher_Colonne_Anglais()
    With ThisWorkbook
        WS_Jour.Columns("A:F").EntireColumn.Hidden = False
        WS_Jour.Columns("E:E").EntireColumn.Hidden = True
    End With
End Sub
Attribute VB_Name = "Module_Traitements"
Option Explicit
Sub Traduire_Fran|fffd|ais()
    D|fffd|claration_Onglets

    With ThisWorkbook
        With WS_Para
            If Range("AY1") = "Language" Then
                Rafraichissement_Ecran_OFF
                Masquage_Onglets_OFF
                Verrouillage_Onglets_OFF

                Traduire_Onglet_Fran|fffd|ais
                Traduire_Donnees_Fran|fffd|ais

                Sheets("Param|fffd|tres").Select

                Rafraichissement_Ecran_ON
                Masquage_Onglets_ON
                Verrouillage_Onglets_ON
            Else
                msg = "La langue du fichier est d|fffd|j|fffd| le Fran|fffd|ais."
                MsgBox msg
            End If
        End With
    End With
End Sub
Sub Traduire_English()
    D|fffd|claration_Onglets

    With ThisWorkbook
        With WS_Para
            If Range("AY1") = "Langue" Then
                Rafraichissement_Ecran_OFF
                Masquage_Onglets_OFF
                Verrouillage_Onglets_OFF

                Traduire_Onglet_Anglais
                Traduire_Donnees_Anglais

                Sheets("Parameters").Select

                Rafraichissement_Ecran_ON
                Masquage_Onglets_ON
                Verrouillage_Onglets_ON
            Else
                msg = "The file's language is already English."
                MsgBox msg
            End If
        End With
    End With
End Sub
Sub Plannifier()
'Test si FR
    On Error GoTo English
    Set WS_Para = Worksheets("Param|fffd|tres")

    If MsgBox("Souhaitez-vous vraiment cr|fffd|er le planning ? Votre ancienne configuration sera perdue. L'op|fffd|ration peut prendre quelques minutes.", 36, "Confirmation") = vbYes Then
        On Error GoTo Erreur

        Rafraichissement_Ecran_OFF

        Reinitialiser_Planning

        Cr|fffd|er_Planning

        Rafraichissement_Ecran_ON

        Exit Sub

Erreur:
        msg = "Erreur"
        MsgBox msg
    End If
    Exit Sub


English:

    If MsgBox("Do you really want to create the planning? Your previous configuration will be lost. The operation may last few minutes.", 36, "Confirmation") = vbYes Then
        On Error GoTo Error

        Rafraichissement_Ecran_OFF

        Reinitialiser_Planning

        Cr|fffd|er_Planning

        Rafraichissement_Ecran_ON

        Exit Sub

Error:
        msg = "Error"
        MsgBox msg
    End If
End Sub
Sub RAZ_Planning()
'Test si FR
    On Error GoTo English
    Set WS_Para = Worksheets("Param|fffd|tres")

    If MsgBox("Souhaitez-vous vraiment r|fffd|initialiser le planning ? Votre configuration va |fffd|tre perdue.", 36, "Confirmation") = vbYes Then
        On Error GoTo Erreur

        Rafraichissement_Ecran_OFF

        Reinitialiser_Planning

        Rafraichissement_Ecran_ON
        Exit Sub

Erreur:
        msg = "Erreur"
        MsgBox msg
    End If
    Exit Sub



English:

    If MsgBox("Do you really want to reset the planning? Your configuration will be lost.", 36, "Confirmation") = vbYes Then
        On Error GoTo Error

        Rafraichissement_Ecran_OFF

        Reinitialiser_Planning

        Rafraichissement_Ecran_ON

        Exit Sub

Error:
        msg = "Error"
        MsgBox msg
    End If
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
