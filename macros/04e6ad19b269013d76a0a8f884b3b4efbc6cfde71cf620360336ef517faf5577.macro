Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()

    On Error Resume Next
    
    If MsgBox("Voulez-vous mettre |fffd| jour les donn|fffd|es?", vbInformation + vbYesNo, "Question") = vbYes Then
        ThisWorkbook.RefreshAll
    End If
    
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Module1"
Sub ImpEp()
Attribute ImpEp.VB_ProcData.VB_Invoke_Func = " \n14"
'
' ImpEp Macro
'

'
    
    Dim MonFichieR As Variant
    MonFichieR = ThisWorkbook.Name
    
    Workbooks.Open FileName:= _
        "Y:\PLAN FICHES RECETTES\Production - |fffd|pice.xlsx"
    Windows(MonFichieR).Activate
    Sheets("|fffd|pices imp").Select
    Columns("A:E").Select
    Selection.Copy
    Windows("Production - |fffd|pice.xlsx").Activate
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows(MonFichieR).Activate
    Sheets("|fffd|pices imp").Select
    Range("A1").Select
    
End Sub
Sub ImpSal()


'
' ImpEp Macro
'

    Dim MonFichieR As Variant
    MonFichieR = ThisWorkbook.Name
    
    Workbooks.Open FileName:= _
        "Y:\PLAN FICHES RECETTES\Production - Salade.xlsx"
    Windows(MonFichieR).Activate
    Sheets("Salade Impr").Select
    Columns("A:E").Select
    Selection.Copy
    Windows("Production - Salade.xlsx").Activate
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows(MonFichieR).Activate
    Sheets("Salade Impr").Select
    Range("A1").Select
    
End Sub
Sub ImpVin()


'
' ImpEp Macro
'

'
    Dim MonFichieR As Variant
    MonFichieR = ThisWorkbook.Name
    
    Workbooks.Open FileName:= _
        "Y:\PLAN FICHES RECETTES\Production - Vinaigrette.xlsx"
    Windows(MonFichieR).Activate
    Sheets("Vinaigrette imp").Select
    Columns("A:E").Select
    Selection.Copy
    Windows("Production - Vinaigrette.xlsx").Activate
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows(MonFichieR).Activate
    Sheets("Vinaigrette imp").Select
    Range("A1").Select
    
End Sub
Sub ImpCui()


'
' ImpEp Macro
'

'
    Dim MonFichieR As Variant
    MonFichieR = ThisWorkbook.Name
    
    Workbooks.Open FileName:= _
        "Y:\PLAN FICHES RECETTES\Production - Cuisine.xlsx"
    Windows(MonFichieR).Activate
    Sheets("Cuisine Impr").Select
    Columns("A:E").Select
    Selection.Copy
    Windows("Production - Cuisine.xlsx").Activate
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows(MonFichieR).Activate
    Sheets("Cuisine Impr").Select
    Range("A1").Select
    
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeClose(Cancel As Boolean)

    RemoveToolbar TB_NAME, TB_NAME_SAP

End Sub

Private Sub Workbook_Open()
    RemoveToolbar TB_NAME
    CreateToolBar TB_NAME

'    If UCase(Left(ActiveSheet.Name, 12)) = UCase("DATA Semaine") Then
'        CreateToolBar TB_NAME
'    ElseIf UCase(Left(ActiveSheet.Name, Len("Sommaire Semaine"))) = UCase("Sommaire Semaine") Then
'        CreateToolBar TB_NAME_SAP
'    End If
End Sub

Private Sub Workbook_SheetActivate(ByVal Sh As Object)
    
    RemoveToolbar TB_NAME

    CreateToolBar TB_NAME

'    If UCase(Left(Sh.Name, 12)) = UCase("DATA Semaine") Then
'        CreateToolBar TB_NAME
'    ElseIf UCase(Left(Sh.Name, Len("Sommaire Semaine"))) = UCase("Sommaire Semaine") Then
'        CreateToolBar TB_NAME_SAP
'    End If

End Sub

Private Sub Worksheet_ProdAllergenes()

    
    
ThisWorkbook.RefreshAll


End Sub

Attribute VB_Name = "modDeclaration"
Option Explicit

Public gsToolBarName As String
Public gcmbToolbar As CommandBar
Public gbtnImp As CommandBarButton
Public gbtnImpCuisson As CommandBarButton
Public gbtnImpLegum As CommandBarButton
Public gbtnImpManuel As CommandBarButton

Public Const TB_NAME = "PUTTY"

Public DoNotUpdate As Boolean

Attribute VB_Name = "modGeneral"
Sub PrintManuel()
'
' Macro1 Macro
' Macro enregistr|fffd|e le 01-12-2009 par rbedard
'

'
   
    Dim MaRecettE As String
    Dim MaBatcH As Integer
    Dim CompTeuR As Integer
        
    Sheets("Fiche L|fffd|gumes Manuel").Select
    Range("I6").Select
    MaBatcH = Range("I6").Value
    CompTeuR = 1
    For CompTeuR = 1 To 9
    MaBatcH = ActiveCell.Value
    MaRecettE = ActiveCell.Offset(0, -1).Value
    If MaBatcH > 0 Then
    Range("B3").Value = MaRecettE
    Range("B4").Value = MaBatcH
    Calculate
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
    End If
    
    ActiveCell.Offset(1, 0).Select
    Next
    Range("I6").Select
    
    
    
    
    
    
End Sub



Public Sub ImprimerFiche(ByVal recette As String, ByVal Valeur As Double)

    'ActiveSheet.PageSetup.PrintArea = .Range(.Cells(lRow - 14, lCol - 4), .Cells(lRow, lCol + 1)).Address
    ActiveSheet.Range("B3").Value = recette
    ActiveSheet.Range("B4").Value = Valeur
    ActiveSheet.PrintOut 1, 1

End Sub

Sub MainImprimerFiche(ByVal nomOnglet As String)

 On Error GoTo Err_ImprimerCuisson
    
    Dim shtData As Worksheet
    
    Dim lCol As Long
    Dim sCol As String
    
    Dim lRow As Long
    Dim ColRecette As String
    Dim ColBatch As String
    Dim ColMax As String
    Dim Batch As String
    Dim Max As String
    Dim Valeur As String
    Dim recette As String
    Dim Index As Integer
    Dim Decimale As Double
    
    
    ColRecette = "Q"
    ColBatch = "R"
    ColMax = "S"
    
    Set shtData = ThisWorkbook.Sheets(nomOnglet)
    
    If MsgBox("Voulez-vous imprimer toutes les pages ayant un lot sup|fffd|rieur |fffd| 0?", vbQuestion + vbYesNo, "Question") = vbYes Then
        With shtData
            For lRow = 2 To .UsedRange.Rows.Count
            recette = .Rows.Cells(lRow, ColRecette).Value
                If recette = "" Then
                    Exit For
                Else
                    Valeur = .Rows.Cells(lRow, ColBatch).Value
                    Batch = Valeur
                    Max = .Rows.Cells(lRow, ColMax).Value
                    
                    If IsNumeric(Valeur) And IsNumeric(Max) Then
                    
                        If Valeur > 0 Then
                            If CInt(Valeur) <= CInt(Max) Then
                                    Call ImprimerFiche(recette, Batch)
                            ElseIf Max = 100 Then
                                    Call ImprimerFiche(recette, Batch)
                            ElseIf Max = 1 Then
                                    For Index = 1 To Valeur
                                        Call ImprimerFiche(recette, 1)
                                    Next
                            ElseIf Valeur >= (Max * 2) Then
                                    Batch = Max
                                    Do While CInt(Batch) <= CInt(Valeur)
                                        Decimale = Batch / Max
                                        If InStr(1, Decimale, ",") > 0 Or InStr(1, Decimale, ".") > 0 Then
                                            Index = Application.WorksheetFunction.Ceiling(Batch / 2, 1)
                                            Call ImprimerFiche(recette, Index)
                                            Index = Application.WorksheetFunction.RoundDown(Batch / 2, 0)
                                            Call ImprimerFiche(recette, Index)
                                            Exit Do
                                        Else
                                            Call ImprimerFiche(recette, Max)
                                            Batch = CInt(Batch) + CInt(Max)
                                            If Batch = CInt(Valeur) Then
                                                Call ImprimerFiche(recette, Max)
                                                Exit Do
                                            ElseIf (CInt(Valeur) - CInt(Batch)) < Max Then
                                                Batch = CInt(Max) + (CInt(Valeur) - CInt(Batch))
                                            End If
                                        End If
                                    Loop
                            ElseIf Valeur < (Max * 2) Then
                                Index = Application.WorksheetFunction.Ceiling(Valeur / 2, 1)
                                Call ImprimerFiche(recette, Index)
                                Index = Application.WorksheetFunction.RoundDown(Valeur / 2, 0)
                                Call ImprimerFiche(recette, Index)
                            End If
                        End If
                    
                    
                    End If
                    'ActiveSheet.PageSetup.PrintArea = .Range(.Cells(lRow - 14, lCol - 4), .Cells(lRow, lCol + 1)).Address
                    'ActiveSheet.PrintOut 1, 1

                End If
            Next
            .Cells(1, 1).Select
        End With
     End If

    Exit Sub
    Resume
Err_ImprimerCuisson:
    MsgBox Err.Description, vbCritical, "Erreur"
End Sub

Function ENTIER(Nombre) As Boolean
 ENTIER = Int(Nombre) = Nombre
End Function

Attribute VB_Name = "modToolBar"
Option Explicit

'-----------------------------------------------------------------------------------------------------
'Permet de cr|fffd|er la toolbar pour dupliquer la ligne courrante, masquer les lignes avec un X
'dans la colonne A et pour masquer les lignes |fffd| 0.
'-----------------------------------------------------------------------------------------------------
'
'   IN :
'       psToolbarName = Nom de la barre d'outils
'
'   OUT :
'       N/A
'-----------------------------------------------------------------------------------------------------
Public Sub CreateToolBar(ByVal psToolbarName As String)
'-----------------------------------------------------------------------------------------------------

    On Error GoTo Err_CreateToolBar
    
    Select Case psToolbarName
        Case TB_NAME
            Set gcmbToolbar = CommandBars.Add(TB_NAME, msoBarTop, , True) '(Name:=psToolbarName, Position:=msoBarTop, Temporary:=True)
            
            With gcmbToolbar
                gsToolBarName = TB_NAME '.Name
                .Visible = True
                .Protection = msoBarNoChangeVisible
            End With
            
            'Set gbtnImp = gcmbToolbar.Controls.Add(Type:=msoControlButton, ID:=1)
            'With gbtnImp
            '    .Caption = "Imprimer"
            '    .TooltipText = "Imprimer"
            '    .Style = msoButtonIconAndCaption
            '    .FaceId = 4 '462
            '    .OnAction = "Imprimer"
            'End With
            
            Set gbtnImpCuisson = gcmbToolbar.Controls.Add(Type:=msoControlButton, ID:=1)
            With gbtnImpCuisson
                .Caption = "Imprimer cuisson"
                .TooltipText = "Imprimer cuisson"
                .Style = msoButtonIconAndCaption
                .FaceId = 4 '462
                .OnAction = "ImprimerCuisson"
            End With
            Set gbtnImpLegum = gcmbToolbar.Controls.Add(Type:=msoControlButton, ID:=1)
            With gbtnImpLegum
                .Caption = "Imprimer l|fffd|gume"
                .TooltipText = "Imprimer l|fffd|gume"
                .Style = msoButtonIconAndCaption
                .FaceId = 4 '462
                .OnAction = "ImprimerLegume"
            End With
            Set gbtnImpManuel = gcmbToolbar.Controls.Add(Type:=msoControlButton, ID:=1)
            With gbtnImpManuel
                .Caption = "Imprimer manuel"
                .TooltipText = "Imprimer manuel"
                .Style = msoButtonIconAndCaption
                .FaceId = 4 '462
                .OnAction = "PrintManuel"
            End With
            
    End Select
    
    Exit Sub
    Resume
Err_CreateToolBar:
    MsgBox Err.Description, vbCritical, "CreateToolBar : Error"
End Sub

'-----------------------------------------------------------------------------------------------------
'Permet de supprimer une barre d'outils
'-----------------------------------------------------------------------------------------------------
'
'   IN :
'       psToolbarName = Nom de la barre d'outils
'
'   OUT :
'       N/A
'-----------------------------------------------------------------------------------------------------
Public Function RemoveToolbar(ParamArray args() As Variant) As String
'-----------------------------------------------------------------------------------------------------

    On Error GoTo Err_ToolbarExist
    
    Dim iIndex As Integer
    Dim sToolbarName As Variant
    
    For Each sToolbarName In args()
        sToolbarName = sToolbarName
        
        For iIndex = 1 To CommandBars.Count
            If UCase(CommandBars.Item(iIndex).Name) = UCase(sToolbarName) Then
                CommandBars.Item(iIndex).Delete
                Exit For
            End If
        Next
    Next
    

    Exit Function
    Resume
Err_ToolbarExist:
    MsgBox Err.Description, vbCritical, "RemoveToolbar : Error"
End Function

Public Sub Imprimer()
   
    On Error GoTo Err_Imprimer
    
    Dim shtData As Worksheet
    Dim lRow As Long
    Dim lCol As Long
    Dim sCol As String
    
    Set shtData = ThisWorkbook.Sheets("FICHES LEGUMES")
    
    If MsgBox("Voulez-vous imprimer toutes les pages ayant un besoin r|fffd|el sup|fffd|rieur |fffd| 0?", vbQuestion + vbYesNo, "Question") = vbYes Then
        With shtData
            For lCol = 5 To 48 Step 6
                '"G", "M", "S", "Y", "AE", AK
                
                For lRow = 2 To 269
                    If UCase(.Cells(lRow, lCol)) = "BESOIN R|fffd|EL :" And .Cells(lRow, lCol + 1).Value > 0 Then
                        .Range(.Cells(lRow - 14, lCol - 4), .Cells(lRow, lCol + 1)).Select
                        ActiveSheet.PageSetup.PrintArea = .Range(.Cells(lRow - 14, lCol - 4), .Cells(lRow, lCol + 1)).Address
                        ActiveSheet.PrintOut 1, 1
                        lRow = lRow
                    End If
                Next
            Next
            .Cells(1, 1).Select
        End With
     End If

    Exit Sub
    Resume
Err_Imprimer:
    MsgBox Err.Description, vbCritical, "Erreur"

End Sub


Public Sub ImprimerCuisson()
   
   Call MainImprimerFiche("Fiche Cuisson")

End Sub

Public Sub ImprimerLegume()
   
   Call MainImprimerFiche("Fiche L|fffd|gumes")

End Sub


INQUEST-PP=macro
