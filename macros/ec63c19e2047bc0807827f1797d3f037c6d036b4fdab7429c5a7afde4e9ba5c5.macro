Attribute VB_Name = "Module1"
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

End Sub
Private Sub KillTheForm()
   Unload UserForm1
End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: Ctrl+k
'

    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|$ = 560
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|& = 3
 
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    arr = [b4:ai1400].Value
 
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ss$ = SearchString(arr, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|&)
    

End Sub
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd|()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: Ctrl+t
'
    ActiveCell.Range( _
        "A1,D1:Y1,A63,D63:Y63,A125,D125:Y125,A187,D187:Y187,A249,D249:Y249,A311,D311:Y311,A373,D373:Y373,A435,D435:Y435,A497,D497:Y497,A559,D559:Y559,A621,D621:Y621,A683,D683:Y683" _
        ).Select
    'ActiveCell.Offset(9, 3).Range("A1").Activate
    'Application.CutCopyMode = False
    Selection.Copy
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("B3").Select
    ActiveSheet.Paste
    Range("Z5").Select
    Application.CutCopyMode = False
    
End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd|()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: Ctrl+i
'
ActiveCell.Offset(0, 0).Rows("1:12").EntireRow.RowHeight = 0
End Sub

Attribute VB_Name = "Reports"
  Public Const str_nachala_tabl_report2_1 = 51 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
  Public Const str_nachala_tabl_report2_2 = 73 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd| 2-|fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
 
  Public Const stlb_nachala_tabl_report2 = 11 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const qty_ex_in_report2 = 8   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const adr_cycle_name2 = "M43" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5
  Public Const adr_date_name2_1 = "M46" ' |fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd|
  Public Const adr_date_name2_2 = "M69" ' |fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd|
  
  Public Const adr_weight_name2_1 = "K48"
  Public Const adr_weight_name2_2 = "K70"
    
  Public Const adr_time_name2_1 = "Q48"
  Public Const adr_time_name2_2 = "Q70"
  
  Public Const report_N_row = 195     ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const report_N_column = 77   ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Sub make_microcycle_report()
  
     adr = ActiveCell.Address
     n_str = ActiveCell.Row
     Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  
     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  
     n_days = 0
   For i = 0 To 5 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| 5 |fffd||fffd||fffd| 6 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
     n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week + i * (qty_ex_day + 1) ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    If cur_cycle(n_str_day1, Upr_column) <> "" Then  ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     n_days = n_days + 1
    End If
   Next i
  
    If n_days = 0 Then
        Msg = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        Style = vbOK
        Title = "LMS"
        Response = MsgBox(Msg, Style, Title)
    ElseIf n_days = 1 Then  ' 1 |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Call make_day_report
    Else

     Call show_my_report(n_days) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     ' |fffd||fffd||fffd||fffd||fffd|
      Select Case n_days
         Case 2
         Call make_week_report_2
        Case 3
         Call make_week_report_3
        Case 4
         Call make_week_report_4
        Case 5, 6
         Call make_week_report_6
      End Select
        
     Worksheets(sheet_reports_name).Select
    End If
    
  End Sub
  
  
  Sub show_my_report(n_days)
'  n_days = 0   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'  n_days = 2   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'  n_days = 3   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 3-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'  n_days = 4   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 4-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'  n_days = 6   |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 5-|fffd| |fffd| 6-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

  Worksheets(sheet_reports_name).Select
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  Columns("A:" & get_ch(report_N_column)).EntireColumn.Hidden = False
  Rows("1:" & report_N_row).EntireRow.Hidden = False
 
      Select Case n_days
        Case 0
          Columns(get_ch(9) & ":" & get_ch(report_N_column)).EntireColumn.Hidden = True
          Rows("42:" & report_N_row).EntireRow.Hidden = True
          ActiveSheet.PageSetup.Orientation = xlPortrait     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
             
        Case 2
          Columns("A:" & get_ch(9)).EntireColumn.Hidden = True
          Rows("1:" & 41).EntireRow.Hidden = True
          Columns(get_ch(18) & ":" & get_ch(report_N_column)).EntireColumn.Hidden = True
          Rows("89:" & report_N_row).EntireRow.Hidden = True
          ActiveSheet.PageSetup.Orientation = xlPortrait     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               
        Case 3
          Columns("A:" & get_ch(18)).EntireColumn.Hidden = True
          Rows("1:" & 89).EntireRow.Hidden = True
          Columns(get_ch(39) & ":" & get_ch(report_N_column)).EntireColumn.Hidden = True
          Rows("124:" & report_N_row).EntireRow.Hidden = True
          ActiveSheet.PageSetup.Orientation = xlLandscape    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          
        Case 4
          Columns("A:" & get_ch(39)).EntireColumn.Hidden = True
          Rows("1:" & 124).EntireRow.Hidden = True
          Columns(get_ch(57) & ":" & get_ch(report_N_column)).EntireColumn.Hidden = True
          Rows("160:" & report_N_row).EntireRow.Hidden = True
          ActiveSheet.PageSetup.Orientation = xlLandscape    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          
        Case 5, 6
          Columns("A:" & get_ch(57)).EntireColumn.Hidden = True
          Rows("1:" & 160).EntireRow.Hidden = True
          ActiveSheet.PageSetup.Orientation = xlLandscape    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       Case Else
        
     End Select

     Worksheets(sheet_cycle_name).Select

  End Sub
  
  
 Sub make_week_report_2() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 2-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   Worksheets(sheet_cycle_name).Unprotect Password:=aaa
   Worksheets(sheet_reports_name).Unprotect Password:=aaa
    
On Error GoTo ERROR_make_day_report2
   
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_r = Worksheets(sheet_reports_name).Range("A1:CC1000")
 
 '-------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      
     n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     
     
  ' 88888888888888888888888888888888888888888888888888888888888888888888888888888     -----1-|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-----
     While Cells(n_str_day1, Upr_column) = "" ' |fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       n_str_day1 = n_str_day1 + qty_ex_day + 1
     Wend

   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Worksheets(sheet_reports_name).Range(get_ch(stlb_nachala_tabl_report2) & str_nachala_tabl_report2_1 & ":" & _
       get_ch(stlb_nachala_tabl_report2 + qty_w_steps) & str_nachala_tabl_report2_1 + 2 * qty_ex_in_report2 - 1).ClearContents
       
      Worksheets(sheet_reports_name).Range(get_ch(stlb_nachala_tabl_report2) & str_nachala_tabl_report2_2 & ":" & _
       get_ch(stlb_nachala_tabl_report2 + qty_w_steps) & str_nachala_tabl_report2_2 + 2 * qty_ex_in_report2 - 1).ClearContents
       
     n_str1 = n_str_day1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd|
  ' |fffd||fffd||fffd||fffd||fffd|
  
   ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
   number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6

   Worksheets(sheet_reports_name).Range(adr_cycle_name2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & n_cycle
   Worksheets(sheet_reports_name).Range(adr_date_name2_1) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"   '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(adr_weight_name2_1) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(adr_time_name2_1) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")

' |fffd||fffd||fffd||fffd||fffd|
     m1 = stlb_nachala_tabl_report2 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = str_nachala_tabl_report2_1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report2 + 1

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
      s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
     Else
      s_w_pr = w & " (" & pr & "%)"
     End If
      cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
       cur_r(n + 1, m) = s_povt
      
       m = m + 1
      step_w = step_w + 4
     Wend
  
     n = n + 2
     n_str1 = n_str1 + 1
    Wend
   
   
   
  ' 88888888888888888888888888888888888888888888888888888888888888888888888888888     -----2-|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-----
       n_str_day1 = n_str_day1 + qty_ex_day + 1
     While Cells(n_str_day1, Upr_column) = "" ' |fffd||fffd||fffd||fffd| 2-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       n_str_day1 = n_str_day1 + qty_ex_day + 1
     Wend

     n_str1 = n_str_day1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd|
  ' |fffd||fffd||fffd||fffd||fffd|
  
   ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
   number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6

   Worksheets(sheet_reports_name).Range(adr_date_name2_2) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"   '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(adr_weight_name2_2) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(adr_time_name2_2) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")

' |fffd||fffd||fffd||fffd||fffd|
     m1 = stlb_nachala_tabl_report2 ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = str_nachala_tabl_report2_2 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report2 + 1

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
      s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
     Else
      s_w_pr = w & " (" & pr & "%)"
     End If
      cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
       cur_r(n + 1, m) = s_povt
      
       m = m + 1
      step_w = step_w + 4
     Wend
  
     n = n + 2
     n_str1 = n_str1 + 1
    Wend
    
   
   
       Application.ScreenUpdating = True
       Worksheets(sheet_reports_name).Select
       Range("I43").Select
  
ERROR_make_day_report2:
       
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
        
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   Application.ScreenUpdating = True
   

 End Sub



 Sub make_week_report_3() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 3-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   
   adr_cycle_name3 = "S90" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5
   
   arr_adr_weight_name = Array("S95", "Z95", "AG95")
   arr_adr_time_name = Array("X95", "AE95", "AL95")
   arr_adr_date_name = Array("S93", "Z93", "AG93")

   arr_adr_param1 = Array("S122", "Z122", "AG122")
   arr_adr_param2 = Array("S123", "Z123", "AG123")

   arr_stolb_tabl_desc = Array(19, 26, 33)
   str_tabl_desc = 97

   Worksheets(sheet_cycle_name).Unprotect Password:=aaa
   Worksheets(sheet_reports_name).Unprotect Password:=aaa
    
On Error GoTo ERROR_make_day_report3
   
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_r = Worksheets(sheet_reports_name).Range("A1:CC1000")
 
 '-------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row
     
        ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
 

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      
     n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     
      Worksheets(sheet_reports_name).Range(adr_cycle_name3) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & n_cycle
  
  
 For i = 0 To 2
     
     While Cells(n_str_day1, Upr_column) = "" ' |fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       n_str_day1 = n_str_day1 + qty_ex_day + 1
     Wend
     
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Worksheets(sheet_reports_name).Range(get_ch(arr_stolb_tabl_desc(i)) & str_tabl_desc & ":" & _
       get_ch(arr_stolb_tabl_desc(i) + 5) & str_tabl_desc + 3 * qty_ex_in_report2 - 1).ClearContents

      n_str1 = n_str_day1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd|
      number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6
  
     ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd|
   Worksheets(sheet_reports_name).Range(arr_adr_date_name(i)) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"    '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(arr_adr_weight_name(i)) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(arr_adr_time_name(i)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")
     
   s = "|fffd||fffd||fffd| = " & cur_cycle(n_str1 + qty_ex_day, KPS_column) & ", "
   s = s & "|fffd| = " & Round(cur_cycle(n_str1 + qty_ex_day, T_column), 0) & " |fffd||fffd|" & ", "
   s = s & "|fffd||fffd|. |fffd||fffd||fffd| = " & Round(cur_cycle(n_str1 + qty_ex_day, w_sr_column), 0) & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(arr_adr_param1(i)) = s
   
   s = "|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|. = " & Round(cur_cycle(n_str1 + qty_ex_day, I_Funt_column), 0) & ", "
   s = s & "|fffd||fffd||fffd| = " & Round(100 * cur_cycle(n_str1 + qty_ex_day, YOI_column), 0) & "%"
   Worksheets(sheet_reports_name).Range(arr_adr_param2(i)) = s
   
 '/////////////////////////////////////////////////////////////
     m1 = arr_stolb_tabl_desc(i)  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = str_tabl_desc  ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report2 + 3

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
      s = ""
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
     '  s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
       s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & IIf(pr > 72, " (" & pr & "%)", "")
     Else
    '  s_w_pr = w & " (" & pr & "%)"
       s_w_pr = w & IIf(pr > 72, " (" & pr & "%)", "")
     End If
   '   cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    '   cur_r(n + 1, m) = s_povt
      m = m + 1
      step_w = step_w + 4
      s = s & s_w_pr & "x " & s_povt & "; "
     Wend
      
      If s <> "" Then
        s = Left(s, Len(s) - 2)  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "; "
      End If
      
     cur_r(n, m1 + 3) = s
     
     n = n + 3
     n_str1 = n_str1 + 1
    Wend
 '/////////////////////////////////////////////////////////////
     
  n_str_day1 = n_str_day1 + qty_ex_day + 1
Next i


ERROR_make_day_report3:
       
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
        
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   Application.ScreenUpdating = True
   
 End Sub


 Sub make_week_report_4() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 4-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   
   adr_cycle_name4 = "AN125" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5
   
   arr_adr_weight_name = Array("AN127", "AW127", "AN144", "AW144")
   arr_adr_time_name = Array("AU127", "BD127", "AU144", "BD144")
   arr_adr_date_name = Array("AQ127", "AZ127", "AQ144", "AZ144")

   arr_stolb_tabl_desc = Array(40, 49, 40, 49)
   arr_str_tabl_desc = Array(128, 128, 145, 145)
   
   Worksheets(sheet_cycle_name).Unprotect Password:=aaa
   Worksheets(sheet_reports_name).Unprotect Password:=aaa
    
 On Error GoTo ERROR_make_day_report4
   
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_r = Worksheets(sheet_reports_name).Range("A1:CC1000")
 
 '-------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row
     
        ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
 

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      
     n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     
      Worksheets(sheet_reports_name).Range(adr_cycle_name4) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & n_cycle
  
  
 For i = 0 To 3
     
     While Cells(n_str_day1, Upr_column) = "" ' |fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       n_str_day1 = n_str_day1 + qty_ex_day + 1
     Wend
     
 
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Worksheets(sheet_reports_name).Range(get_ch(arr_stolb_tabl_desc(i)) & arr_str_tabl_desc(i) & ":" & _
       get_ch(arr_stolb_tabl_desc(i) + 7) & arr_str_tabl_desc(i) + 2 * qty_ex_in_report2 - 1).ClearContents

      n_str1 = n_str_day1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd|
      number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6
  
     ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd|
   Worksheets(sheet_reports_name).Range(arr_adr_date_name(i)) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"    '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(arr_adr_weight_name(i)) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(arr_adr_time_name(i)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")
     
   
 '/////////////////////////////////////////////////////////////
     m1 = arr_stolb_tabl_desc(i)  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = arr_str_tabl_desc(i) ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report2 + 3

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
      s = ""
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
     '  s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
       s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & IIf(pr > 72, " (" & pr & "%)", "")
     Else
    '  s_w_pr = w & " (" & pr & "%)"
       s_w_pr = w & IIf(pr > 72, " (" & pr & "%)", "")
     End If
   '   cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    '   cur_r(n + 1, m) = s_povt
      m = m + 1
      step_w = step_w + 4
      s = s & s_w_pr & "x " & s_povt & "; "
     Wend
      
      If s <> "" Then
        s = Left(s, Len(s) - 2)  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "; "
      End If
      
     cur_r(n, m1 + 3) = s
     
     n = n + 2
     n_str1 = n_str1 + 1
    Wend
 '/////////////////////////////////////////////////////////////
     
  n_str_day1 = n_str_day1 + qty_ex_day + 1
Next i


ERROR_make_day_report4:
       
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
        
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   Application.ScreenUpdating = True
   
  
 End Sub
   
   
    Sub make_week_report_6() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 5 |fffd| 6-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   
   adr_cycle_name6 = "BF161" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|5
   
   arr_adr_weight_name = Array("BF164", "BM164", "BT164", "BF181", "BM181", "BT181")
   arr_adr_time_name = Array("BK164", "BR164", "BY164", "BK181", "BR181", "BY181")
   arr_adr_date_name = Array("BF163", "BM163", "BT163", "BF180", "BM180", "BT180")

   arr_stolb_tabl_desc = Array(58, 65, 72, 58, 65, 72)
   arr_str_tabl_desc = Array(165, 165, 165, 182, 182, 182)
      
   
   Worksheets(sheet_cycle_name).Unprotect Password:=aaa
   Worksheets(sheet_reports_name).Unprotect Password:=aaa
    
 On Error GoTo ERROR_make_day_report6
   
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_r = Worksheets(sheet_reports_name).Range("A1:CC1000")
 
 '-------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row
     
        ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
 

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      
   ' n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     
      Worksheets(sheet_reports_name).Range(adr_cycle_name6) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & n_cycle
   
   i_dec = 0 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

 For i = 0 To 5 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| 5 |fffd||fffd||fffd| 6 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets(sheet_reports_name).Range(get_ch(arr_stolb_tabl_desc(i)) & arr_str_tabl_desc(i) - 1 & ":" & _
    get_ch(arr_stolb_tabl_desc(i) + 5) & arr_str_tabl_desc(i) + 2 * qty_ex_in_report2 - 1).ClearContents
       
    n_str_day1 = 4 + (n_cycle - 1) * qty_rows_in_week + i * (qty_ex_day + 1) ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
 
 If Cells(n_str_day1, Upr_column) <> "" Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     
     n_str1 = n_str_day1 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd|
      number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6
  
     ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd|
   Worksheets(sheet_reports_name).Range(arr_adr_date_name(i - i_dec)) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"  '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(arr_adr_weight_name(i - i_dec)) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(arr_adr_time_name(i - i_dec)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")
     
   
 '/////////////////////////////////////////////////////////////
     m1 = arr_stolb_tabl_desc(i - i_dec) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = arr_str_tabl_desc(i - i_dec) ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report2 + 3

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
      s = ""
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
     '  s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
       s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & IIf(pr > 72, " (" & pr & "%)", "")
     Else
    '  s_w_pr = w & " (" & pr & "%)"
       s_w_pr = w & IIf(pr > 72, " (" & pr & "%)", "")
     End If
   '   cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    '   cur_r(n + 1, m) = s_povt
      m = m + 1
      step_w = step_w + 4
      s = s & s_w_pr & "x " & s_povt & "; "
     Wend
      
      If s <> "" Then
        s = Left(s, Len(s) - 2)  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "; "
      End If
      
     cur_r(n, m1 + 3) = s
     
     n = n + IIf(n - arr_str_tabl_desc(i - i_dec) <= 11, 2, 1)
     n_str1 = n_str1 + 1
    Wend
 '/////////////////////////////////////////////////////////////
 Else
    i_dec = 1
 End If
  
Next i


ERROR_make_day_report6:
       
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
        
      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
      Application.ScreenUpdating = True
   
  
 End Sub
   



Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{1F8275CF-425D-4FCE-807F-18B233DF37FB}{15D9BEDD-557E-4841-A9E3-D2D8802FA2EF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Image1_Click()
    Unload UserForm1
End Sub

Private Sub UserForm_Activate()
End Sub
Attribute VB_Name = "Vadim_1"
  Public Const time_koef_adr = "T35" ' |fffd||fffd||fffd||fffd| F - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const time_t_worming_up_adr = "V37" ' |fffd||fffd||fffd||fffd| F - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const time_estimated_adr = "W43" ' |fffd||fffd||fffd||fffd| F - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const time_real_adr = "W44" ' |fffd||fffd||fffd||fffd| F - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  
  Public Const name_graph_KPS = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  Public Const name_graph_w_sr = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 7" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  Public Const name_graph_T_IF = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 6" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  Public Const name_graph_YOI = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 8" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

  Public Const qty_rows_in_week = 56 ' |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd|"
  Public Const Nagr_column = 2 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const Group_column = 3 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const Upr_column = 4 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const Koef_column = 5 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|.
  Public Const Mnoj_column = 6 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

  Public Const weight_1step_column = 7 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
  Public Const T_column = 31 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const w_sr_column = 32 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd|
  Public Const YOI_column = 33 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  Public Const PM_column = 34 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| PM
  Public Const I_Funt_column = 35 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|.
  Public Const KPS_column = 36 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  Public Const time_column = 37 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  Public Const info_column = 38 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  
  Public Const sheet_F = "F"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| F (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
  Public Const sheet_cycle_name = "1 |fffd| |fffd||fffd||fffd||fffd|"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const sheet_exercise_name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const max_qty_weeks = 25 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const qty_w_steps = 6 ' |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
 
  Public Const qty_ex_day = 8 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
  Public Const qty_workouts_week = 6 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Sub freeze_graphics(fl As Boolean)
    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
    If fl Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_KPS).Activate:    Selection.Placement = xlFreeFloating ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_w_sr).Activate:     Selection.Placement = xlFreeFloating ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_T_IF).Activate:    Selection.Placement = xlFreeFloating ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_YOI).Activate:    Selection.Placement = xlFreeFloating ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_KPS).Activate:    Selection.Placement = xlMoveAndSize ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_w_sr).Activate:     Selection.Placement = xlMoveAndSize ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_T_IF).Activate:    Selection.Placement = xlMoveAndSize ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.ChartObjects(name_graph_YOI).Activate:    Selection.Placement = xlMoveAndSize ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
  End Sub

Sub Print_ex_parameters()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)

Worksheets(sheet_exercise_name).Unprotect Password:=aaa
Worksheets(sheet_cycle_name).Unprotect Password:=aaa
    
On Error GoTo ERROR_Print_ex_parameters

  Application.ScreenUpdating = False
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_ex = Worksheets(sheet_exercise_name).Range("A1:CC1000")
    
 adr = ActiveCell.Address
 i_row = ActiveCell.Row
 i_column = ActiveCell.Column
 ' qty_rows_in_week = 56 ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
   If InStr(Cells(i_row, T_column).FormulaR1C1, "*") = 0 Then    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Msg = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    
   ElseIf Cells(i_row, PM_column) = "" Then  '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    
   ElseIf Cells(i_row, Upr_column) = "" Then  '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    Msg = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    
    ElseIf Cells(i_row, Koef_column) = "" Then  '|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    
    
   Else ' everything OK
'===================================================================================
  nagr_ = Cells(i_row, Nagr_column)
  '------------ |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd| 6 --------------------------
      n_str_pp = 3 + (ActiveCell.Row - 3) Mod qty_rows_in_week ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      n_day = 1 + Application.WorksheetFunction.RoundDown((n_str_pp - 3 - 0.01) / (qty_ex_day + 1), 0)
      n_day = IIf(n_day = 7, 6, n_day) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  '------------ |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ---------------------------
    n_cycle = 1 + Application.WorksheetFunction.RoundDown(((ActiveCell.Row - 1 - 0.001) / qty_rows_in_week), 0)
     
    day_1st_row = 4 + (n_cycle - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) '  1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      
    '!'  date1 = cur_cycle(day_1st_row + 1, 1) ' date1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "21.07.2015"
    '!'  ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
    '!'  number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(date1), 3) ' 0-6
      
    ex_name = cur_cycle(i_row, Upr_column)
    cur_ex(ex_name_row_1ex, Mnoj_column_1ex) = cur_cycle(i_row, Upr_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.
    cur_ex(ex_week_day_row_1ex, Mnoj_column_1ex) = n_day   ' ar_week_days(number_of_week_day) ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd|
    cur_ex(Koef_row_1ex, Mnoj_column_1ex) = cur_cycle(i_row, Koef_column)  ' |fffd||fffd||fffd||fffd||fffd|.
    cur_ex(Mnoj_row_1ex, Mnoj_column_1ex) = Trim(cur_cycle(i_row, Mnoj_column))   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets(sheet_exercise_name).Range(get_ch(PM_column - column_delta) & stroka_nachala_tabl & ":" & get_ch(PM_column - column_delta) & stroka_nachala_tabl + max_qty_weeks - 1).ClearContents
    Worksheets(sheet_exercise_name).Range(get_ch(column_number_ex) & stroka_nachala_tabl & ":" & get_ch(weight_1step_column + 4 * qty_w_steps - 1 - column_delta) & stroka_nachala_tabl + max_qty_weeks - 1).ClearContents
    
   ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n = n_str_pp ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   For i = 1 To max_qty_weeks
      
       day_1st_row = 4 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) '  1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
       n_ex = 0
     
     If StrComp(cur_cycle(n, Upr_column), ex_name) = 0 Then ' |fffd||fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       n_ex = n
     Else ' |fffd||fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
           For j = day_1st_row To day_1st_row + qty_ex_day - 1
        If StrComp(cur_cycle(j, Upr_column), ex_name) = 0 Then ' |fffd||fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          n_ex = j
          Exit For
        End If
       Next j
     End If
 
    If n_ex <> 0 Then ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     cur_ex(stroka_nachala_tabl + i - 1, PM_column - column_delta) = cur_cycle(n_ex, PM_column) ' |fffd||fffd|
     cur_ex(stroka_nachala_tabl + i - 1, column_number_ex) = n_ex - day_1st_row + 1 ' |fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
 
     For j = weight_1step_column To weight_1step_column + 4 * qty_w_steps - 1
      cur_ex(stroka_nachala_tabl + i - 1, j - column_delta) = cur_cycle(n_ex, j)
     Next j
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ElseIf (StrComp(Worksheets(sheet_exercise_name).Range(adr_find_other_days), "|fffd||fffd|") = 0) Then ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd|" |fffd| "S3"
     ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      For nn_day = 1 To qty_workouts_week
       For nn_n_pp = 1 To qty_ex_day
         n_ex = 3 + (i - 1) * qty_rows_in_week + (nn_day - 1) * (qty_ex_day + 1) + nn_n_pp
           
          If StrComp(cur_cycle(n_ex, Upr_column), ex_name) = 0 Then  ' |fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            cur_ex(stroka_nachala_tabl + i - 1, PM_column - column_delta) = cur_cycle(n_ex, PM_column) ' |fffd||fffd|
            cur_ex(stroka_nachala_tabl + i - 1, column_number_ex) = nn_n_pp ' |fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|
        
            For j = weight_1step_column To weight_1step_column + 4 * qty_w_steps - 1
             cur_ex(stroka_nachala_tabl + i - 1, j - column_delta) = cur_cycle(n_ex, j)
            Next j
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            GoTo mm11
           End If
       Next nn_n_pp
      Next nn_day
      
mm11:
       
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End If
    
     n = n + qty_rows_in_week
   Next i
   
   
   
   
   
   
 Range(adr).Select
 Worksheets(sheet_exercise_name).Select
 
  If InStr(cur_cycle(i_row, weight_1step_column).FormulaR1C1, "<>") <> 0 Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| %
   Call make_formulas_with_procent_exercise
  Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
   Call make_formulas_with_weigth_exercise
 End If

Call auto_scaling_parameters_axle_OY_of_exercise(nagr_)
'''Call axles_scaling_parameters_axle_OY_of_exercise

'===================================================================================
   End If
   
ERROR_Print_ex_parameters:
        Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
                    Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    
       Application.ScreenUpdating = True
       
   
End Sub


 
Sub axles_scaling_parameters_axle_OY_of_main_cycle()

   On Error GoTo ERR_sc_OY
    Worksheets(sheet_cycle_name).Unprotect Password:=aaa
      
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
 
  KPS_min = 100000: KPS_max = 0
  w_sr_min = 100000: w_sr_max = 0
  T_min = 100000: T_max = 0
  IFunt_min = 100000: IFunt_max = 0
  YOI_min = 10000: YOI_max = 0
 
 i = 2
 i_ERR = 1
 s_ERR = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ""1 |fffd| |fffd||fffd||fffd||fffd|"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1. |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|."
 
    While cur_ex_par(i, KPS_column) <> 0
   
      KPS_min = IIf(cur_ex_par(i, KPS_column) < KPS_min, cur_ex_par(i, KPS_column), KPS_min)
      KPS_max = IIf(cur_ex_par(i, KPS_column) > KPS_max, cur_ex_par(i, KPS_column), KPS_max)
      
      w_sr_min = IIf(cur_ex_par(i, w_sr_column) < w_sr_min, cur_ex_par(i, w_sr_column), w_sr_min)
      w_sr_max = IIf(cur_ex_par(i, w_sr_column) > w_sr_max, cur_ex_par(i, w_sr_column), w_sr_max)
  
      T_min = IIf(cur_ex_par(i, T_column) < T_min, cur_ex_par(i, T_column), T_min)
      T_max = IIf(cur_ex_par(i, T_column) > T_max, cur_ex_par(i, T_column), T_max)
      
      IFunt_min = IIf(cur_ex_par(i, I_Funt_column) < IFunt_min, cur_ex_par(i, I_Funt_column), IFunt_min)
      IFunt_max = IIf(cur_ex_par(i, I_Funt_column) > IFunt_max, cur_ex_par(i, I_Funt_column), IFunt_max)
  
      YOI_min = IIf(cur_ex_par(i, YOI_column) < YOI_min, cur_ex_par(i, YOI_column), YOI_min)
      YOI_max = IIf(cur_ex_par(i, YOI_column) > YOI_max, cur_ex_par(i, YOI_column), YOI_max)

      i = i + qty_rows_in_week
      i_ERR = i_ERR + 1
      s_ERR = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ""1 |fffd| |fffd||fffd||fffd||fffd|"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & i_ERR & ". |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|."
       
    Wend
    
    s_ERR = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
     
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  Set cur = Worksheets(sheet_info).Range(get_ch(KPS_table_1st_column) & KPS_table_1st_row & ":CC1000")
   
   Worksheets(sheet_cycle_name).ChartObjects(name_graph_KPS).Activate
   x_max = ActiveChart.Axes(xlCategory).MaximumScale
   
   For i = 1 To x_max
    If cur(i, 1) <> "" Then
       KPS_min = IIf(cur(i, 1) < KPS_min, cur(i, 1), KPS_min)
       KPS_max = IIf(cur(i, 1) > KPS_max, cur(i, 1), KPS_max)
       w_sr_min = IIf(cur(i, 2) < w_sr_min, cur(i, 2), w_sr_min)
       w_sr_max = IIf(cur(i, 2) > w_sr_max, cur(i, 2), w_sr_max)
    End If
   Next i
    
    ' |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    T_min = IIf(IFunt_min < T_min, IFunt_min, T_min)
    T_max = IIf(IFunt_max > T_max, IFunt_max, T_max)
            
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((KPS_max + 5) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((KPS_min - 5) / 10, 0)
      fff55 = ActiveChart.Axes(xlCategory).MaximumScale
     
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 2.5, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 2.5, 0)
          
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_T_IF).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 1000 * WorksheetFunction.RoundUp((T_max + 100) / 1000, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 1000 * WorksheetFunction.RoundDown((T_min - 100) / 1000, 0)
     
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_YOI).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.01 * WorksheetFunction.RoundUp((YOI_max + 0.005) / 0.01, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.01 * WorksheetFunction.RoundDown((YOI_min - 0.005) / 0.01, 0)


GoTo OK_sc_OY

ERR_sc_OY:
 
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| OY. " & s_ERR & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)


OK_sc_OY:


      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
 End Sub
 
Sub axles_scaling_parameters_axle_OX_of_main_cycle(n_week)
 
  ' n_week ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| OY
   On Error GoTo ERR_sc_OX
      Worksheets(sheet_cycle_name).Unprotect Password:=aaa
          
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_KPS).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_w_sr).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_T_IF).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
       
     Worksheets(sheet_cycle_name).ChartObjects(name_graph_YOI).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
  ''''' Call axles_scaling_parameters_axle_OY_of_main_cycle


ERR_sc_OX:
 
      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
 End Sub
 
Sub axles_scaling_parameters_axle_OX_of_main_cycle_max()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd| 1 |fffd||fffd| 25 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Call axles_scaling_parameters_axle_OX_of_main_cycle(max_qty_weeks)
End Sub

Sub axles_scaling_parameters_axle_OX_of_main_cycle_auto()
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd| 1 |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
   i = 2
   n_week = 0
   
    While cur_ex_par(i, KPS_column) <> 0
     n_week = n_week + 1
     i = i + qty_rows_in_week
    Wend
    
  n_week = IIf(n_week < 2, 2, n_week)
  Call axles_scaling_parameters_axle_OX_of_main_cycle(n_week)
  
End Sub

Sub axles_scaling_parameters_axle_OX_of_main_cycle_6()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd| 1 |fffd||fffd| 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Call axles_scaling_parameters_axle_OX_of_main_cycle(6)
End Sub

Sub axles_scaling_parameters_axle_OX_of_main_cycle_12()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd| 1 |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Call axles_scaling_parameters_axle_OX_of_main_cycle(12)
End Sub

Sub axles_scaling_parameters_axle_OX_of_main_cycle_18()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd| 1 |fffd||fffd| 18 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Call axles_scaling_parameters_axle_OX_of_main_cycle(18)
End Sub

Sub menu_sheet_cycle()

    Dim myMenuBar As CommandBar
    Dim ctrl(1 To 1000) As CommandBarControl
    Set myMenuBar = Application.CommandBars("Cell")
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    myMenuBar.Reset

    Set ctrl(1) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(1).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).BeginGroup = True
    
    Set ctrl(2) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(2).Caption = "|fffd||fffd||fffd| Y"
    ctrl(2).TooltipText = "|fffd||fffd||fffd| Y"
    ctrl(2).OnAction = "axles_scaling_parameters_axle_OY_of_main_cycle"
    
    Set ctrl(3) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(3).Caption = "|fffd||fffd||fffd| X |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(3).TooltipText = "|fffd||fffd||fffd| X |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(3).OnAction = "axles_scaling_parameters_axle_OX_of_main_cycle_auto"

    Set ctrl(4) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(4).Caption = "|fffd||fffd||fffd| X |fffd||fffd| 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(4).TooltipText = "|fffd||fffd||fffd| X |fffd||fffd| 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(4).OnAction = "axles_scaling_parameters_axle_OX_of_main_cycle_6"

    Set ctrl(5) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(5).Caption = "|fffd||fffd||fffd| X |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(5).TooltipText = "|fffd||fffd||fffd| X |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(5).OnAction = "axles_scaling_parameters_axle_OX_of_main_cycle_12"

    Set ctrl(6) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(6).Caption = "|fffd||fffd||fffd| X |fffd||fffd| 18 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(6).TooltipText = "|fffd||fffd||fffd| X |fffd||fffd| 18 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(6).OnAction = "axles_scaling_parameters_axle_OX_of_main_cycle_18"

    Set ctrl(7) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(7).Caption = "|fffd||fffd||fffd| X |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(7).TooltipText = "|fffd||fffd||fffd| X |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(7).OnAction = "axles_scaling_parameters_axle_OX_of_main_cycle_max"

'-----------------------------------------------------------------------------------------------

    Set ctrl(8) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(8).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(8).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
 
    Set ctrl(9) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(9).Caption = "|fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(9).TooltipText = "|fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(9).OnAction = "make_formulas_with_procent_active_row"

    Set ctrl(10) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(10).Caption = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(10).TooltipText = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(10).OnAction = "make_formulas_with_weights_active_row"

    Set ctrl(11) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(11).Caption = "|fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)"
    ctrl(11).TooltipText = "|fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)"
    ctrl(11).OnAction = "make_formulas_with_procent_cycle"

    Set ctrl(12) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(12).Caption = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)"
    ctrl(12).TooltipText = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)"
    ctrl(12).OnAction = "make_formulas_with_weights_cycle"

'-----------------------------------------------------------------------------------------------

    Set ctrl(13) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(13).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(13).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    
    Set ctrl(14) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(14).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(14).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(14).OnAction = "Clear_sheet_whole_cycle"
    
    Set ctrl(15) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(15).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(15).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
   ctrl(15).OnAction = "Clear_sheet_layouts_cycle"
    
'      Set ctrl(16) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
'      ctrl(16).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'      ctrl(16).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'    ' ctrl(16).OnAction =  "Clear_sheet_layouts_cycle"
  
    Set ctrl(17) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(17).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(17).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(17).OnAction = "Clear_layouts_micro_cycle"
    
    Set ctrl(18) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(18).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(18).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(18).OnAction = "Hide_empty_columns"
    
    Set ctrl(19) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(19).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    ctrl(19).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    ctrl(19).OnAction = "Hide_empty_days"
    
    Set ctrl(20) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(20).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(20).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(20).OnAction = "Hide_Current_Day"
  
    Set ctrl(21) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(21).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(21).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(21).OnAction = "Hide_rows_without_ex_cycle"
    
    Set ctrl(22) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(22).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(22).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(22).OnAction = "Open_all_columns"
  
'    Set ctrl(23) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
'    ctrl(23).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
'    ctrl(23).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
'  ' ctrl(23).OnAction = "Clear_micro_cycle"
    
    Set ctrl(24) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(24).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(24).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
    ctrl(24).OnAction = "Open_all_rows"
       
    Set ctrl(25) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(25).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(25).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(25).OnAction = "Open_all_rows_columns"
    
    Set ctrl(26) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(26).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(26).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(26).OnAction = "set_columns_width"
    
    Set ctrl(27) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(27).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(27).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(27).OnAction = "save_week_formulas_as_values"
  '-----------------------------------------------------------------------------------------------

    Set ctrl(30) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(30).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(30).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        
    Set ctrl(31) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(31).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(31).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(31).OnAction = "Copy_week_layouts"
    
    Set ctrl(32) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(32).Caption = "|fffd||fffd||fffd||fffd|"
    ctrl(32).TooltipText = "|fffd||fffd||fffd||fffd|"
    ctrl(32).OnAction = "Copy_day_layouts"
 
    Set ctrl(33) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(33).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(33).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(33).OnAction = "Copy_Ex_layouts"
   
    Set ctrl(34) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(34).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(34).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(34).OnAction = "Copy_week_layouts_without_heavy_ex"
  '-----------------------------------------------------------------------------------------------

    Set ctrl(35) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(35).Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(35).TooltipText = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    
    Set ctrl(36) = myMenuBar.Controls("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(36).Caption = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(36).TooltipText = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(36).OnAction = "New_design_of_traning_plan"
   
    Set ctrl(37) = myMenuBar.Controls("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(37).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(37).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(37).OnAction = "Old_design_of_traning_plan"
    
    

    Set ctrl(38) = myMenuBar.Controls("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(38).Caption = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(38).TooltipText = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(38).OnAction = "design_of_traning_plan_6ex_4raskl"
    
    Set ctrl(39) = myMenuBar.Controls("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(39).Caption = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(39).TooltipText = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(39).OnAction = "design_of_traning_plan_6ex_5raskl"
    
    Set ctrl(40) = myMenuBar.Controls("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(40).Caption = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(40).TooltipText = "6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 6 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(40).OnAction = "design_of_traning_plan_6ex_6raskl"
        
        
    Set ctrl(45) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(45).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(45).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    'ctrl(45).OnAction = "Fill_in_group_tables"
    
    
   Set ctrl(46) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
   ctrl(46).Caption = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd|"""
   ctrl(46).TooltipText = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd|"""
   ctrl(46).OnAction = "Fill_in_group_tables"
   ctrl(46).Parameter = True
    
   Set ctrl(47) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
   ctrl(47).Caption = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd|"""
   ctrl(47).TooltipText = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd|"""
   ctrl(47).OnAction = "Fill_in_group_tables"
   ctrl(47).Parameter = False
    

    Set ctrl(51) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
    ctrl(51).Caption = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(51).TooltipText = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    
    Set ctrl(52) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(52).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(52).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(52).OnAction = "make_day_report"
        
    Set ctrl(53) = myMenuBar.Controls("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|").Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(53).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(53).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(53).OnAction = "make_microcycle_report"
            
        
    Set ctrl(60) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(60).Caption = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(60).TooltipText = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(60).OnAction = "Print_ex_parameters"
    
    
  '' '---------------------------------------- |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| -------------------
    On Error GoTo menu1
    Set cur_ex = Sheets("|fffd||fffd||fffd|").Range("A1:BB" & Sheets("|fffd||fffd||fffd|").UsedRange.Rows.Count)
  ' Set cur_ex = Sheets("|fffd||fffd||fffd|").Range("A1:BB333")
  
 
    n = 101
    nn = n
   
    For i = 2 To cur_ex.Rows.Count
      If cur_ex(i, 2) <> "" Then   ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
       Set ctrl(n) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
        ctrl(n).Caption = cur_ex(i, 2)
        ctrl(n).TooltipText = cur_ex(i, 2)
      name_menu_1st_level = cur_ex(i, 2)
        n = n + 1
    End If
     ctrl(nn).BeginGroup = True
    
     If cur_ex(i, 3) <> "" Then   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd||fffd|
            Set ctrl(n) = myMenuBar.Controls(name_menu_1st_level).Controls.Add(Type:=msoControlButton, Temporary:=True)
            ctrl(n).Caption = cur_ex(i, 3)
            ctrl(n).TooltipText = cur_ex(i, 3)
            ctrl(n).OnAction = "write_down_exercise"
            ctrl(n).Parameter = cur_ex(i, 3) & ";" & cur_ex(i, 4) & ";" & cur_ex(i, 5) & ";" & cur_ex(i, 6) & ";" & cur_ex(i, 7)
           n = n + 1
    End If
    Next i

menu1:

End Sub
Function get_ch(n_stolb)
  ' |fffd|-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   my_adr = Cells(1, n_stolb).Address ' $C$76
   get_ch = Mid(my_adr, 2, InStr(2, my_adr, "$") - 2)
End Function
Sub New_design_of_traning_plan()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Call Open_all_rows_columns
   Call axles_scaling_parameters_axle_OX_of_main_cycle_max

End Sub

Sub design_of_traning_plan_6ex_4raskl()
 Call design_of_traning_plan_6ex_Nraskl(4)
End Sub
Sub design_of_traning_plan_6ex_5raskl()
 Call design_of_traning_plan_6ex_Nraskl(5)
End Sub
Sub design_of_traning_plan_6ex_6raskl()
 Call design_of_traning_plan_6ex_Nraskl(6)
End Sub

Sub save_week_formulas_as_values()
    
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        
     If n_cycle = 1 Then
       Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
       Style = vbOK
       Title = "LMS"
       Response = MsgBox(Msg, Style, Title)
     Else

      For j = 1 To qty_workouts_week
         n_str1 = 4 + (n_cycle - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1)
         n_str2 = 4 + (n_cycle - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + qty_ex_day - 1
         
         Range(Cells(n_str1, Nagr_column), Cells(n_str2, Mnoj_column)).Copy
         Range(Cells(n_str1, Nagr_column), Cells(n_str2, Mnoj_column)).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
      
         Range(Cells(n_str1, PM_column), Cells(n_str2, PM_column)).Copy
         Range(Cells(n_str1, PM_column), Cells(n_str2, PM_column)).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
      Next j
    
    End If
    
     Application.CutCopyMode = False
     Application.ScreenUpdating = True
    
End Sub

Sub design_of_traning_plan_6ex_Nraskl(Nraskl)
' |fffd|-|fffd| c|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| Nraskl+1
      
      Call Open_all_rows_columns
      
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     
     '----------------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 7-|fffd||fffd| |fffd| 8-|fffd||fffd| ex |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ------------------
     For i = 1 To max_qty_weeks
       For j = 1 To qty_workouts_week
              n_str1 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + 7
              n_str2 = n_str1 + 1
              Rows(n_str1 & ":" & n_str2).EntireRow.RowHeight = 0
        Next j
     Next i
     '--------------------------------------------------------------------------------
     
     If Nraskl < 6 Then
      Call Hide_columns_begining_with_steps(Nraskl)
    End If
    
      Range(adr).Select
      Application.ScreenUpdating = True

End Sub
Sub Old_design_of_traning_plan()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 5 |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1 |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
      Call Open_all_rows_columns
     Cells(qty_rows_in_week - 1, 10).Select ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 6-|fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Call freeze_graphics(True)
   '  Columns(get_ch(time_column + 1) & ":" & get_ch(time_column + 4)).EntireColumn.Hidden = True
     Call freeze_graphics(False)
    
     Call Hide_Current_Day
     Call Hide_columns_begining_with_steps(4)
    
     Call axles_scaling_parameters_axle_OX_of_main_cycle_12
     
     Rows(1 + 12 * qty_rows_in_week + 1 & ":" & 2000).EntireRow.RowHeight = 0
        
    
      Range(adr).Select
      Application.ScreenUpdating = True
End Sub


Sub Copy_day_layouts()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   On Error GoTo ERR_copy_day
      Worksheets(sheet_cycle_name).Unprotect Password:=aaa
      
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     
      n_str_pp = 3 + (ActiveCell.Row - 3) Mod qty_rows_in_week ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      n_day = 1 + Application.WorksheetFunction.RoundDown((n_str_pp - 3 - 0.01) / (qty_ex_day + 1), 0)
      n_day = IIf(n_day = 7, 6, n_day) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
 If n_cycle = 1 Then
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title) '1-ok, 2-|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Else ' |fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
   If Not ((InStr(Cells(n_str, T_column).FormulaR1C1, "*") <> 0) Or (InStr(Cells(n_str - 1, T_column).FormulaR1C1, "*") <> 0)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd|
    Msg = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
   Else ' everything is OK
'---------------------------------------------------
    fl = True ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd| " & n_cycle - 1
    
   While fl

    Style = vbOKCancel
    Title = "LMS"
    Response = InputBox(Msg, Title, IIf(n_cycle - 4 > 1, n_cycle - 4, 1))
   
   If IsNumeric(Response) Then  ' |fffd||fffd||fffd||fffd||fffd|
     If (1 * Response Mod 1 = 0) And (1 * Response >= 1) And (1 * Response <= n_cycle - 1) Then
     ' OK
       n_str1 = 4 + (Response - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1)
       n_str2 = 4 + (Response - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + qty_ex_day
        
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Copy
    
       n_str1 = 4 + (n_cycle - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1)
       n_str2 = 4 + (n_cycle - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + qty_ex_day
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Select
      ActiveSheet.Paste
      Application.CutCopyMode = False
       Range(adr).Select
      fl = False
     End If
   Else '---------------
   
     GoTo ERR_copy_day:
   End If

   Wend
'---------------------------------------------------
   End If
 End If
   
ERR_copy_day:
       Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   
 Application.ScreenUpdating = True

End Sub
Sub Copy_Ex_layouts()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

   On Error GoTo ERR_copy_exers
      Worksheets(sheet_cycle_name).Unprotect Password:=aaa

     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     
 If n_cycle = 1 Then
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
 Else ' |fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
   If InStr(Cells(n_str, T_column).FormulaR1C1, "*") = 0 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Msg = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
   Else ' everything OK
'---------------------------------------------------
    fl = True ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd| " & n_cycle - 1
    
   While fl

    Style = vbOKCancel
    Title = "LMS"
    Response = InputBox(Msg, Title, IIf(n_cycle - 4 > 1, n_cycle - 4, 1))
   
   If IsNumeric(Response) Then  ' |fffd||fffd||fffd||fffd||fffd|
     If (1 * Response Mod 1 = 0) And (1 * Response >= 1) And (1 * Response <= n_cycle - 1) Then
     ' OK
      n_str1 = n_str - (n_cycle - Response) * qty_rows_in_week
      n_str2 = n_str - (n_cycle - Response) * qty_rows_in_week
   
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Copy
    
      n_str1 = n_str
      n_str2 = n_str
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Select
      ActiveSheet.Paste
      Application.CutCopyMode = False
       Range(adr).Select
      fl = False
 
      End If
         Else '---------------
   
     GoTo ERR_copy_exers:

     End If
   

   Wend
'---------------------------------------------------
   End If
 End If
   
ERR_copy_exers:
        Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
 
 Application.ScreenUpdating = True
 
End Sub

Sub Copy_week_layouts()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     
   If n_cycle = 1 Then
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
   Else ' |fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
    fl = True ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd| " & n_cycle - 1
    
   While fl

    Style = vbOKCancel
    Title = "LMS"
    Response = InputBox(Msg, Title, IIf(n_cycle - 4 > 1, n_cycle - 4, 1))
   
   If IsNumeric(Response) Then  ' |fffd||fffd||fffd||fffd||fffd|
     If (1 * Response Mod 1 = 0) And (1 * Response >= 1) And (1 * Response <= n_cycle - 1) Then
     ' OK
      n_str1 = 4 + (Response - 1) * qty_rows_in_week
      n_str2 = 1 + (Response) * qty_rows_in_week
   
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Copy
    
      n_str1 = 4 + (n_cycle - 1) * qty_rows_in_week
      n_str2 = 1 + (n_cycle) * qty_rows_in_week
      Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Select
      ActiveSheet.Paste
      Application.CutCopyMode = False
       Range(adr).Select
      fl = False
      
      End If
      
        Else '---------------
   
        GoTo ERR_copy_mc1
        

   End If
  

 Wend

 End If
 
ERR_copy_mc1:
 
 Application.ScreenUpdating = True
 
End Sub

Sub Copy_week_layouts_without_heavy_ex()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

  
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     
   If n_cycle = 1 Then
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
   Else ' |fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       
    fl = True ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd| " & n_cycle - 1
    
   While fl

    Style = vbOKCancel
    Title = "LMS"
    Response = InputBox(Msg, Title, IIf(n_cycle - 4 > 1, n_cycle - 4, 1))
   
   If IsNumeric(Response) Then  ' |fffd||fffd||fffd||fffd||fffd|
     If (1 * Response Mod 1 = 0) And (1 * Response >= 1) And (1 * Response <= n_cycle - 1) Then
        delta_rows = qty_rows_in_week * (n_cycle - Response)
     '------------------------------------------------------------------------------------
      n_str1 = 4 + (Response - 1) * qty_rows_in_week
      While Cells(n_str1 + delta_rows, Nagr_column) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
       n_str1 = n_str1 + 1
      Wend
      
      i_str1 = n_str1
      i_str2 = 1 + (Response) * qty_rows_in_week
      
     For i_str = i_str1 To i_str2
      If i_str >= n_str1 Then
        If Cells(i_str + delta_rows, Nagr_column) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
         n_str2 = i_str - 1
         Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Copy
         Range(Cells(n_str1 + delta_rows, weight_1step_column), Cells(n_str2 + delta_rows, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Select
         ActiveSheet.Paste
         n_str1 = n_str2 + 1
         While Cells(n_str1 + delta_rows, Nagr_column) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
           n_str1 = n_str1 + 1
         Wend
       End If
      End If
    Next i_str
    
     n_str2 = i_str2
    If n_str2 - n_str1 >= 1 Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
        Range(Cells(n_str1, weight_1step_column), Cells(n_str2, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Copy
        Range(Cells(n_str1 + delta_rows, weight_1step_column), Cells(n_str2 + delta_rows, weight_1step_column + 4 * (qty_w_steps - 1) + 3)).Select
        ActiveSheet.Paste
    End If
    
    ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
      Application.CutCopyMode = False
       Range(adr).Select
       
      '------------------------------------------------------------------------------------
      fl = False
     End If
     
     Else '---------------
   
        GoTo ERR_copy_mc2
        
        
   End If
  

 Wend
 


 End If
 
ERR_copy_mc2:
 
 Application.ScreenUpdating = True
 
 
End Sub
Sub Hide_empty_columns()

 Call freeze_graphics(True)
 Application.ScreenUpdating = False
  n_st_end = weight_1step_column + 4 * (qty_w_steps - 1)  ' 26 -  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| (6-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|)
 
 For n_stolb = n_st_end To weight_1step_column Step -4

    fl = True
   For i = 1 To max_qty_weeks
      For j = 1 To qty_workouts_week
         For k = 1 To qty_ex_day
             n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + k
             If (Cells(n_str, n_stolb) <> 0) And (Cells(n_str, n_stolb) <> "") Then
               fl = False
               GoTo m1
             End If
         Next k
      Next j
   Next i
   
m1:
   
  If fl Then
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4 |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Columns(get_ch(n_stolb) & ":" & get_ch(n_stolb + 3)).EntireColumn.Hidden = True
  End If
Next n_stolb
 
 Application.ScreenUpdating = False
   Call freeze_graphics(False)
End Sub

Sub Hide_columns_begining_with_steps(my_step)
 ' my_step - |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 '  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| my_step + 1 |fffd||fffd| 6
   Call freeze_graphics(True)
     Application.ScreenUpdating = False
     Columns(get_ch(weight_1step_column + 4 * my_step) & ":" & get_ch(weight_1step_column + 4 * (qty_w_steps - 1) + 3)).EntireColumn.Hidden = True
     Application.ScreenUpdating = True
   Call freeze_graphics(False)
End Sub



Sub Hide_rows_without_ex_cycle()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

 ''' Call Hide_empty_days
 
      Application.ScreenUpdating = False
     
    For i = 1 To max_qty_weeks
           n_str = 2 + (i - 1) * qty_rows_in_week ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|) - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'''        If Cells(n_str, w_sr_column) = 0 Then
'''          Application.ScreenUpdating = True
'''          Exit Sub
'''        End If
        
      For j = 1 To qty_workouts_week
       
       n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + qty_ex_day + 1 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd|.|fffd|.
       my_fl = True
       
          For k = qty_ex_day To 1 Step -1
           n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + k
           If Cells(n_str, Upr_column) <> "" Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
              n_str1 = n_str + 1
              my_fl = False
             Exit For
            End If
          Next k
            
           If my_fl Then ' |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
            n_str1 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + 1
            n_str2 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + qty_ex_day + 1
           Else ' |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
            n_str1 = n_str1 ' :))))
            n_str2 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + qty_ex_day
           End If
           
          If n_str1 <= n_str2 Then ' |fffd| |fffd||fffd||fffd| 8 |fffd||fffd||fffd|
             Rows(n_str1 & ":" & n_str2).EntireRow.RowHeight = 0
          End If
                
        
      Next j
   Next i

      Application.ScreenUpdating = True

End Sub

Sub Hide_empty_days()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Application.ScreenUpdating = False
     
    For i = 1 To max_qty_weeks
          
          n_str = 2 + (i - 1) * qty_rows_in_week
        If Cells(n_str, w_sr_column) = 0 Then   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          Rows(n_str & ":" & 2000).EntireRow.RowHeight = 0
          Application.ScreenUpdating = True
          Exit Sub
        End If
        
      For j = 1 To qty_workouts_week
      
'         kol_upr_day = 0
'        For k = 1 To qty_ex_day
'          n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + k
'          If Cells(n_str, weight_1step_column) <> "" Then
'           kol_upr_day = kol_upr_day + 1
'           Exit For
'          End If
'        Next k
      
       n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + qty_ex_day + 1 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd|.|fffd|.
      
   '     If kol_upr_day = 0 Then
        If Cells(n_str, w_sr_column) = 0 Then
         n_str1 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + 1
         n_str2 = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + 1 + qty_ex_day
         Rows(n_str1 & ":" & n_str2).EntireRow.RowHeight = 0
        End If
      Next j
   Next i

      Application.ScreenUpdating = True
End Sub
Sub Hide_Current_Day()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

     Application.ScreenUpdating = False
     
     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
      n_str = ActiveCell.Row
      n_str_pp = 3 + (ActiveCell.Row - 3) Mod qty_rows_in_week ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
      n_day = 1 + Application.WorksheetFunction.RoundDown((n_str_pp - 3 - 0.01) / (qty_ex_day + 1), 0)
      n_day = IIf(n_day = 7, 6, n_day) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           
      For i = 1 To max_qty_weeks
        n_str1 = 4 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1)
        n_str2 = 4 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + qty_ex_day
        Rows(n_str1 & ":" & n_str2).EntireRow.RowHeight = 0
      Next i
      
       Application.ScreenUpdating = True
End Sub

Sub Clear_layouts_micro_cycle()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

     Application.ScreenUpdating = False
     ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      n_str = ActiveCell.Row
      
      n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
      n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
      
    Msg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & n_cycle & "-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
    Style = vbYesNo
    Title = "LMS"
 
    Response = MsgBox(Msg, Style, Title)
  
  If Response = vbYes Then    ' Yes

      adr = ActiveCell.Address
   
   n_str1 = 4 + (n_cycle - 1) * qty_rows_in_week
   n_str2 = 1 + (n_cycle) * qty_rows_in_week

   s = get_ch(weight_1step_column) & n_str1 & ":" & get_ch(weight_1step_column + 4 * qty_w_steps - 1) & n_str2
   Worksheets(sheet_cycle_name).Range(s).ClearContents
        
          
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
          n_str = (n_str1 - 4) + 3 + (j - 1) * (qty_ex_day + 1) + k
          n_stolb = weight_1step_column
       '   Cells(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0,(IFERROR(IF(RC" & PM_column & ">50,MROUND(RC" & PM_column & "*RC[3],2.5),IF(AND(RC" & PM_column & "<15, RC" & Mnoj_column & ">2  ),MROUND(RC" & PM_column & "*RC[3],0.1),MROUND(RC" & PM_column & "*RC[3],1))),)),"""")"
        '   Cells(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2,  MROUND(RC" & PM_column & "*RC[3],1),IF( RC" & Mnoj_column & ">2, MROUND(RC" & PM_column & "*RC[3], 0.1), MROUND(RC" & PM_column & "*RC[3],2.5))), """" ), """")"
           Cells(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2, " & _
           " MROUND(RC" & PM_column & "*RC[3],1),    IF( OR(RC" & Mnoj_column & "="""",RC" & Mnoj_column & "=1),  " & _
           " MROUND(RC" & PM_column & "*RC[3],2.5),  MROUND(RC" & PM_column & "*RC[3], 0.1))), """" ), """")"
        
        Next k
      Next j
      
    
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n_stolb = weight_1step_column + 0
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
   
   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 + 0
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    ActiveSheet.Paste
   Next n

   Application.CutCopyMode = False
   Range(adr).Select
    
  End If

  Application.ScreenUpdating = True


End Sub

Sub Clear_sheet_layouts_cycle()

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

       Application.ScreenUpdating = False
     
    Msg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
    Style = vbYesNo
    Title = "LMS"
 
     Response = MsgBox(Msg, Style, Title)
  
  If Response = vbYes Then    ' Yes
    Rows("3:3000").EntireRow.Hidden = False
    Columns("A:AN").EntireColumn.Hidden = False
      adr = ActiveCell.Address
    
   n_str1 = 4
   n_str2 = qty_rows_in_week + 1

  For i = 1 To max_qty_weeks
    s = ""
    s = s & get_ch(weight_1step_column) & n_str1 & ":" & get_ch(weight_1step_column + 4 * qty_w_steps - 1) & n_str2
     Worksheets(sheet_cycle_name).Range(s).ClearContents
      n_str1 = n_str1 + qty_rows_in_week
      n_str2 = n_str2 + qty_rows_in_week
  Next i
      
   Application.CutCopyMode = False
   Range(adr).Select
   Call make_formulas_with_procent_cycle
    
  End If

  Application.ScreenUpdating = True


End Sub
Sub Clear_sheet_whole_cycle()
' "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| B-E, AG |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       

   On Error GoTo ERR_sheet_whole_cycle
      Worksheets(sheet_cycle_name).Unprotect Password:=aaa
       
       Application.ScreenUpdating = False
     
    Msg = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|, |fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| % |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?"
    Style = vbYesNo
    Title = "LMS"
 
     Response = MsgBox(Msg, Style, Title)
  
  If Response = vbYes Then    ' Yes
    Rows("3:3000").EntireRow.Hidden = False
    Columns("A:AN").EntireColumn.Hidden = False
    adr = ActiveCell.Address
    
   n_str1 = 4
   n_str2 = qty_rows_in_week + 1

  For i = 1 To max_qty_weeks
    s = "" ' get_ch(Nagr_column) & n_str1 & ":" & get_ch(Nagr_column) & n_str2 & ","  ' "B3:B57,"
    s = s & get_ch(weight_1step_column) & n_str1 & ":" & get_ch(weight_1step_column + 4 * qty_w_steps - 1) & n_str2
   ' s = s & & "," & get_ch(PM_column) & n_str1 & ":" & get_ch(PM_column) & n_str2
   
     Worksheets(sheet_cycle_name).Range(s).ClearContents

      n_str1 = n_str1 + qty_rows_in_week
      n_str2 = n_str2 + qty_rows_in_week
  Next i
    
    For j = 1 To qty_workouts_week ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      n_str1 = 4 + (j - 1) * (qty_ex_day + 1)
      n_str2 = 3 + j * (qty_ex_day + 1) - 1
      ' Group_column
      Range(Cells(n_str1, Group_column), Cells(n_str2, Group_column)).ClearContents
      Range(Cells(n_str1, Nagr_column), Cells(n_str2, Nagr_column)).ClearContents
      Range(Cells(n_str1, Upr_column), Cells(n_str2, Upr_column)).ClearContents
      Range(Cells(n_str1, Koef_column), Cells(n_str2, Koef_column)).ClearContents
      Range(Cells(n_str1, Mnoj_column), Cells(n_str2, Mnoj_column)).ClearContents
      Range(Cells(n_str1, PM_column), Cells(n_str2, PM_column)).ClearContents
    Next j
     
    
    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 2-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
          n_str = qty_rows_in_week + 3 + (j - 1) * (qty_ex_day + 1) + k
          Cells(n_str, Group_column).FormulaR1C1 = "=IF(R[-" & qty_rows_in_week & "]C="""","""",R[-" & qty_rows_in_week & "]C)"
          Cells(n_str, Nagr_column).FormulaR1C1 = "=IF(R[-" & qty_rows_in_week & "]C="""","""",R[-" & qty_rows_in_week & "]C)"
          Cells(n_str, Upr_column).FormulaR1C1 = "=IF(R[-" & qty_rows_in_week & "]C="""","""",R[-" & qty_rows_in_week & "]C)"
          Cells(n_str, Koef_column).FormulaR1C1 = "=IF(R[-" & qty_rows_in_week & "]C="""","""",R[-" & qty_rows_in_week & "]C)"
          Cells(n_str, Mnoj_column).FormulaR1C1 = "=IF(R[-" & qty_rows_in_week & "]C="""","""",R[-" & qty_rows_in_week & "]C)"
        Next k
       Cells(5 + qty_rows_in_week + (j - 1) * (qty_ex_day + 1), 1).FormulaR1C1 = _
       "=R[-" & qty_rows_in_week & "]C+R[-" & 3 + qty_rows_in_week + (j - 1) * (qty_ex_day + 1) & "]C"
      Next j

 '  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    
    n_str1 = qty_rows_in_week + 3 + 1
    n_str2 = 2 * qty_rows_in_week + 1
   'Range(Cells(n_str1, Nagr_column), Cells(n_str2, Mnoj_column)).Select
    Range(Cells(n_str1, 1), Cells(n_str2, Mnoj_column)).Select
    Application.CutCopyMode = False
    Selection.Copy
    
    Cells(2 + qty_rows_in_week, 1).FormulaR1C1 = "=R[-" & qty_rows_in_week & "]C" ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| 2)
    
 For i = 3 To max_qty_weeks
    Cells(2 + (i - 1) * qty_rows_in_week, 1).FormulaR1C1 = "=R[-" & qty_rows_in_week & "]C"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| i)
    Cells(2 + (i - 1) * qty_rows_in_week, PM_column).FormulaR1C1 = "=R[-" & qty_rows_in_week & "]C"  ' % |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| i)
    n_str1 = 3 + (i - 1) * qty_rows_in_week + 1
    n_str2 = 3 + i * qty_rows_in_week - 2
   'Range(Cells(n_str1, Nagr_column), Cells(n_str2, Mnoj_column)).Select
    Range(Cells(n_str1, 1), Cells(n_str2, Mnoj_column)).Select
    ActiveSheet.Paste
 Next i
    
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|
  str_proc_corr = qty_rows_in_week + 2 ' 58
     For i = 1 To max_qty_weeks - 1
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
        
          n_str = qty_rows_in_week * i + 3 + (j - 1) * (qty_ex_day + 1) + k
          Cells(n_str, PM_column).FormulaR1C1 = "=IF(ISNUMBER(R[-" & qty_rows_in_week & "]C), R[-" & qty_rows_in_week & "]C+(R[-" & _
            qty_rows_in_week & "]C*R" & str_proc_corr & "C" & PM_column & "),"""")"
            
        Next k
      Next j
      str_proc_corr = str_proc_corr + qty_rows_in_week
    Next i
      
   Application.CutCopyMode = False
   Range(adr).Select
   Call make_formulas_with_procent_cycle
    
  End If


ERR_sheet_whole_cycle:
         Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
 
  Application.ScreenUpdating = True
  
End Sub


Sub Open_all_rows()
    Rows("3:3000").EntireRow.Hidden = False
End Sub

Sub Open_all_columns()
   Call freeze_graphics(True)
    Columns("A:AO").EntireColumn.Hidden = False
   Call freeze_graphics(False)
End Sub

Sub Open_all_rows_columns()
    Call freeze_graphics(True)
    Rows("3:3000").EntireRow.Hidden = False
    Columns("A:AO").EntireColumn.Hidden = False
    Call freeze_graphics(False)
End Sub

Sub make_formulas_with_weights_cycle()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)

  Application.ScreenUpdating = False
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  adr = ActiveCell.Address
  
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 For i = 1 To max_qty_weeks
    n_str1 = 3 + (i - 1) * qty_rows_in_week + 1
    n_str2 = 3 + i * qty_rows_in_week - 2
  For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n
 Next i

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
          n_str = 3 + (j - 1) * (qty_ex_day + 1) + k
          n_stolb = weight_1step_column
          cur_ex_par(n_str, n_stolb + 3).FormulaR1C1 = "=IFERROR(ROUND(RC[-3]/RC" & PM_column & ",2),"""")"
        Next k
      Next j
      
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n_str1 = 3 + 1
    n_str2 = 3 + 1 * qty_rows_in_week - 2
    n_stolb = weight_1step_column + 3
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy

    
 For i = 1 To max_qty_weeks
    n_str1 = 3 + (i - 1) * qty_rows_in_week + 1
    n_str2 = 3 + i * qty_rows_in_week - 2
   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 + 3
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    ActiveSheet.Paste
   Next n
 Next i
 
 Application.CutCopyMode = False
 Range(adr).Select
 Application.ScreenUpdating = True
 
End Sub

Sub make_formulas_with_weights_active_row()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)

   On Error GoTo ERR_make_formulas_with_weights_active_row
     Worksheets(sheet_cycle_name).Unprotect Password:=aaa
     
  Application.ScreenUpdating = False
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  adr = ActiveCell.Address
  n_str = ActiveCell.Row
'++++++++++++++++++++++++++++
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If InStr(Cells(n_str, T_column).FormulaR1C1, "*") = 0 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Msg = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
Else ' everything OK
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'++++++++++++++++++++++++++++
  For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   n_stolb = 3 + weight_1step_column
   cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IFERROR(ROUND(RC[-3]/RC" & PM_column & ",2),"""")"
 
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy

    
   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 + 3
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    ActiveSheet.Paste
   Next n
 
End If

ERR_make_formulas_with_weights_active_row:
      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
  
 Application.CutCopyMode = False
 Range(adr).Select
 Application.ScreenUpdating = True
 
End Sub

Sub make_formulas_with_procent_cycle()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|)

  Application.ScreenUpdating = False
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  adr = ActiveCell.Address
 
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 For i = 1 To max_qty_weeks
    n_str1 = 3 + (i - 1) * qty_rows_in_week + 1
    n_str2 = 3 + i * qty_rows_in_week - 2
  For n = 1 To qty_w_steps
    n_stolb = 3 + weight_1step_column + (n - 1) * 4
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n
 Next i

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
          n_str = 3 + (j - 1) * (qty_ex_day + 1) + k
          n_stolb = weight_1step_column
       '   cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0,(IFERROR(IF(RC" & PM_column & ">50,MROUND(RC" & PM_column & "*RC[3],2.5),IF(AND(RC" & PM_column & "<15, RC" & Mnoj_column & ">2  ),MROUND(RC" & PM_column & "*RC[3],0.1),MROUND(RC" & PM_column & "*RC[3],1))),)),"""")"
       '    cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2,  MROUND(RC" & PM_column & "*RC[3],1),IF( RC" & Mnoj_column & ">2, MROUND(RC" & PM_column & "*RC[3], 0.1), MROUND(RC" & PM_column & "*RC[3],2.5))), """" ), """")"
           cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2, " & _
           " MROUND(RC" & PM_column & "*RC[3],1),    IF( OR(RC" & Mnoj_column & "="""",RC" & Mnoj_column & "=1),  " & _
           " MROUND(RC" & PM_column & "*RC[3],2.5),  MROUND(RC" & PM_column & "*RC[3], 0.1))), """" ), """")"
           
        Next k
      Next j
      
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n_str1 = 3 + 1
    n_str2 = 3 + 1 * qty_rows_in_week - 2
    n_stolb = weight_1step_column + 0
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy

    
 For i = 1 To max_qty_weeks
    n_str1 = 3 + (i - 1) * qty_rows_in_week + 1
    n_str2 = 3 + i * qty_rows_in_week - 2
   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 + 0
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    ActiveSheet.Paste
   Next n
 Next i
 
 Application.CutCopyMode = False
 Range(adr).Select
 Application.ScreenUpdating = True
 
End Sub


Sub make_formulas_with_procent_active_row()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|)
   On Error GoTo ERR_make_formulas_with_procent_active_row
     Worksheets(sheet_cycle_name).Unprotect Password:=aaa
      
  Application.ScreenUpdating = False
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  adr = ActiveCell.Address
  n_str = ActiveCell.Row
 '++++++++++++++++++++++++++++
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If InStr(Cells(n_str, T_column).FormulaR1C1, "*") = 0 Then  '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Msg = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
Else ' everything OK
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'++++++++++++++++++++++++++++
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

  For n = 1 To qty_w_steps
    n_stolb = 3 + weight_1step_column + (n - 1) * 4
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   n_stolb = weight_1step_column
 '  cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0,(IFERROR(IF(RC" & PM_column & ">50,MROUND(RC" & PM_column & "*RC[3],2.5),IF(AND(RC" & PM_column & "<15, RC" & Mnoj_column & ">2  ),MROUND(RC" & PM_column & "*RC[3],0.1),MROUND(RC" & PM_column & "*RC[3],1))),)),"""")"
 '  cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2,  MROUND(RC" & PM_column & "*RC[3],1),IF( RC" & Mnoj_column & ">2, MROUND(RC" & PM_column & "*RC[3], 0.1), MROUND(RC" & PM_column & "*RC[3],2.5))), """" ), """")"
           cur_ex_par(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF( RC" & Mnoj_column & "=2, " & _
           " MROUND(RC" & PM_column & "*RC[3],1),    IF( OR(RC" & Mnoj_column & "="""",RC" & Mnoj_column & "=1),  " & _
           " MROUND(RC" & PM_column & "*RC[3],2.5),  MROUND(RC" & PM_column & "*RC[3], 0.1))), """" ), """")"
        
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    
   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 + 0
    Range(Cells(n_str, n_stolb), Cells(n_str, n_stolb)).Select
    ActiveSheet.Paste
   Next n
 
 End If
 
ERR_make_formulas_with_procent_active_row:
        Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
      
 Application.CutCopyMode = False
 Range(adr).Select
 Application.ScreenUpdating = True
 
End Sub

Sub Delete_All_Text_Box()

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|


    k = 0
    Dim oSh As Shape
    For Each oSh In ActiveSheet.Shapes
    
    k = k + 1
    If oSh.Type = 17 Then
      oSh.Delete
    End If
    Next oSh



'Stop

End Sub

Sub set_columns_width()
  
    Call freeze_graphics(True)
   Application.ScreenUpdating = False
   ' |fffd|
Columns(1).ColumnWidth = 5.43 ' |fffd||fffd||fffd||fffd|
Columns(Nagr_column).ColumnWidth = 8.43 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Columns(Group_column).ColumnWidth = 6.5  ' |fffd||fffd||fffd||fffd||fffd||fffd|
Columns(Upr_column).ColumnWidth = 32.43  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Columns(Koef_column).ColumnWidth = 5.43 ' |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd|-/|fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Columns(Mnoj_column).ColumnWidth = 5.86 ' |fffd||fffd||fffd||fffd|

Columns(weight_1step_column).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 1).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 2).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 3).ColumnWidth = 5.43 ' %

Columns(weight_1step_column + 4).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 5).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 6).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 7).ColumnWidth = 5.43 ' %

Columns(weight_1step_column + 8).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 9).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 10).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 11).ColumnWidth = 5.43 ' %

Columns(weight_1step_column + 12).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 13).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 14).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 15).ColumnWidth = 5.43 ' %

Columns(weight_1step_column + 16).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 17).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 18).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 19).ColumnWidth = 5.43 ' %

Columns(weight_1step_column + 20).ColumnWidth = 5.57 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 21).ColumnWidth = 3.86 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 22).ColumnWidth = 4.14 ' |fffd||fffd||fffd|
Columns(weight_1step_column + 23).ColumnWidth = 5.43 ' %

Columns(T_column).ColumnWidth = 7.29 ' |fffd||fffd||fffd||fffd||fffd||fffd|
Columns(w_sr_column).ColumnWidth = 7 ' |fffd||fffd||fffd||fffd|.|fffd||fffd||fffd|
Columns(YOI_column).ColumnWidth = 6.57 ' |fffd||fffd||fffd|.|fffd||fffd||fffd|
Columns(PM_column).ColumnWidth = 5.3 ' |fffd||fffd|
Columns(I_Funt_column).ColumnWidth = 8.43 ' |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|
Columns(KPS_column).ColumnWidth = 5 ' |fffd||fffd||fffd|
Columns(time_column).ColumnWidth = 6.86 ' |fffd||fffd||fffd||fffd||fffd|
 
 Application.ScreenUpdating = True
 Call freeze_graphics(False)
 
End Sub

Sub set_width_of_diagrams()
'  Public Const name_graph_KPS = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'  Public Const name_graph_w_sr = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'  Public Const name_graph_T_IF = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
' 'Public Const name_graph_YOI = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

  w1 = 380
   
  ActiveSheet.Shapes(name_graph_KPS).Width = w1
  ActiveSheet.Shapes(name_graph_w_sr).Width = w1
  ActiveSheet.Shapes(name_graph_T_IF).Width = w1
  ActiveSheet.Shapes(name_graph_YOI).Width = w1

  h1 = 93
  ActiveSheet.Shapes(name_graph_KPS).Height = h1
  ActiveSheet.Shapes(name_graph_w_sr).Height = h1
  ActiveSheet.Shapes(name_graph_T_IF).Height = h1
  ActiveSheet.Shapes(name_graph_YOI).Height = h1
  

End Sub



Sub write_down_exercise()

 Dim arg As Variant
 arg = Split(CommandBars.ActionControl.Parameter, ";")
    
 ' ----------------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| -------------------------
      n = ActiveCell.Row
     fl = (n <= 3) ' |fffd||fffd||fffd||fffd| fl=true - |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     fl = fl Or (((n - 2) Mod qty_rows_in_week) = 0) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5"
     fl = fl Or (((n - 3) Mod qty_rows_in_week) = 0) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     
 If fl Then ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", , "LMS"
 Else ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|? |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| :)
      n_str_pp = 3 + (ActiveCell.Row - 3) Mod qty_rows_in_week ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| 4 |fffd||fffd| 57). 3 |fffd| 58 |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   If (((n_str_pp - 3) Mod (qty_ex_day + 1)) = 0) Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", , "LMS"
   Else
'oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
      
      Cells(n, Upr_column).Select  ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
      
   If InStr(1 / 2, ",") = 0 Then ' Application.DecimalSeparator = "." Then
      Cells(n, Upr_column) = arg(0) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(n, Koef_column) = arg(1) ' |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(n, Mnoj_column) = arg(2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        ' |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      koef = arg(3)
      ot_upr = Trim(arg(4))
   Else  '  Application.DecimalSeparator = ","
      Cells(n, Upr_column) = arg(0)  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(n, Koef_column) = 1 * arg(1) ' |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
    If arg(2) <> "" Then
      Cells(n, Mnoj_column) = 1 * arg(2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Else
      Cells(n, Mnoj_column) = ""
    End If
        ' |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     If (arg(3) <> "") And (arg(3) <> "-") Then
      koef = 1 * arg(3)
     Else
      koef = arg(3)
     End If
     
      ot_upr = Trim(arg(4))
   End If
   
     Select Case ot_upr
      ' Case "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
     '      my_formula = "=" & koef & "*R" & nstr_BP & "C" & column_BP_SQ_DL
    '   Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    '       my_formula = "=" & koef & "*R" & nstr_DL & "C" & column_BP_SQ_DL
   '    Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  '         my_formula = "=" & koef & "*R" & nstr_SQ & "C" & column_BP_SQ_DL
       Case "", "-" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          my_formula = ""
       Case Else ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| % |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
           my_formula = koef & " * |fffd||fffd| |fffd| |fffd||fffd||fffd|. """ & ot_upr & """"
     End Select
   
    If InStr(1 / 2, ",") = 0 Then 'Application.DecimalSeparator = "." Then
      Cells(n, PM_column).FormulaR1C1 = my_formula
     Else ' ","
      Cells(n, PM_column).FormulaR1C1 = Replace(my_formula, ",", ".")
    End If

'oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
      End If
    End If
    
    
End Sub

Sub correct_time() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

 If (Range(time_real_adr) <> "") And (Range(time_estimated_adr) <> "") Then
 
 jjj = CDate("00:" & Range(time_t_worming_up_adr))
  Range(time_koef_adr) = Round(Range(time_koef_adr) * (Range(time_real_adr) - jjj) / (Range(time_estimated_adr) - jjj), 3)
    
  Range(time_real_adr) = ""
  Range(time_estimated_adr) = ""

    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
  
  Else
     Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
  
  End If
    
   ' Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")

End Sub

Function GetKFunt(i) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd|

 n_str = Round(i * 100, 0) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| F
 GetKFunt = Worksheets("F").Cells(n_str, 2)

End Function







Attribute VB_Name = "Vadim_2"
  Public Const name_graph_1ex_KPS = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_1ex_w_sr = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_1ex_T = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_1ex_IF = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_1ex_YOI = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  
  Public Const stroka_nachala_tabl = 7 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const column_delta = 4        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const column_number_ex = 2    ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const Mnoj_column_1ex = 8 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const ex_name_row_1ex = 1 ' |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.
  Public Const ex_week_day_row_1ex = 2 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const Koef_row_1ex = 3 ' |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd|.
  Public Const Mnoj_row_1ex = 4 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  
  Public Const adr_find_other_days = "S3" ' |fffd||fffd|; |fffd||fffd||fffd| - |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|

Sub set_width_of_diagrams_1ex()

'  w1 = 350
'
'  ActiveSheet.Shapes(name_graph_1ex_KPS).Width = w1
'  ActiveSheet.Shapes(name_graph_1ex_w_sr).Width = w1
'  ActiveSheet.Shapes(name_graph_1ex_YOI).Width = w1
'
'  h1 = 210
'  ActiveSheet.Shapes(name_graph_1ex_KPS).Height = h1
'  ActiveSheet.Shapes(name_graph_1ex_w_sr).Height = h1
'  ActiveSheet.Shapes(name_graph_1ex_YOI).Height = h1
  
 w2 = 450
 ActiveSheet.Shapes(name_graph_1ex_T).Width = w2
 ActiveSheet.Shapes(name_graph_1ex_IF).Width = w2
 
 h2 = 236
 ActiveSheet.Shapes(name_graph_1ex_T).Height = h2
 ActiveSheet.Shapes(name_graph_1ex_IF).Height = h2
 
 
 
End Sub

'Sub change_places_of_graphes()
'
'    ActiveSheet.ChartObjects("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 3").Activate
'    ActiveSheet.Shapes.Range(Array("Chart 3")).Select
'    Selection.Cut
'    Range("AI6").Select
'    ActiveSheet.Paste
'
'
'    ActiveSheet.ChartObjects("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 5").Activate
'    ActiveSheet.Shapes.Range(Array("Chart 5")).Select
'    Selection.Cut
'    Range("AI33").Select
'    ActiveSheet.Paste
'
'End Sub

Sub menu_sheet_exercise()

    Dim myMenuBar As CommandBar
    Dim ctrl(1 To 10) As CommandBarControl
    Set myMenuBar = Application.CommandBars("Cell")
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    myMenuBar.Reset

    Set ctrl(1) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(1).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).OnAction = "set_12_weeks_interface"
    ctrl(1).BeginGroup = True
    
    Set ctrl(2) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(2).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(2).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(2).OnAction = "set_max_weeks_interface"
        
    Set ctrl(3) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(3).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| Y"
    ctrl(3).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| Y"
    ctrl(3).OnAction = "axles_scaling_parameters_axle_OY_of_exercise"
   
    Set ctrl(4) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(4).Caption = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(4).TooltipText = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| % (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(4).OnAction = "make_formulas_with_procent_exercise"
    
    Set ctrl(5) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(5).Caption = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(5).TooltipText = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)"
    ctrl(5).OnAction = "make_formulas_with_weigth_exercise"
    
   
End Sub

Sub make_formulas_with_procent_exercise()

   Worksheets(sheet_exercise_name).Unprotect Password:=aaa
   On Error GoTo ERROR_make_formulas_with_procent_exercise
   
Application.ScreenUpdating = False
  adr = ActiveCell.Address
 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

  For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 - column_delta + 3 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 6
    
    Range(Cells(stroka_nachala_tabl, n_stolb), Cells(stroka_nachala_tabl + max_qty_weeks - 1, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    s_mn = "R" & Mnoj_row_1ex & "C" & Mnoj_column_1ex

      For n_str = stroka_nachala_tabl To stroka_nachala_tabl + max_qty_weeks - 1
          n_stolb = weight_1step_column - column_delta + 0 ' 3
        '  Cells(n_str, n_stolb).FormulaR1C1 = _
        ' "=IF(RC[3]<>0, IFERROR(IF( " & s_mn & "=2,  MROUND(RC" & PM_column - column_delta & "*RC[3],1),IF( " & s_mn & ">2, MROUND(RC" & PM_column - column_delta & "*RC[3], 0.1), MROUND(RC" & PM_column - column_delta & "*RC[3],2.5))), """" ), """")"
           
          Cells(n_str, n_stolb).FormulaR1C1 = "=IF(RC[3]<>0, IFERROR(IF(" & s_mn & "=2, " & _
          " MROUND(RC" & PM_column - column_delta & "*RC[3],1),    IF( OR(" & s_mn & "=""""," & s_mn & "=1),  " & _
          " MROUND(RC" & PM_column - column_delta & "*RC[3],2.5),  MROUND(RC" & PM_column - column_delta & "*RC[3], 0.1))), """" ), """")"
      
      Next n_str
      
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n_str1 = stroka_nachala_tabl
    n_str2 = stroka_nachala_tabl + max_qty_weeks - 1
    n_stolb = weight_1step_column - column_delta + 0 ' 3
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy


   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column - column_delta + 0 + 4 * (n - 1)
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    ActiveSheet.Paste
   Next n

 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Call Paint_columns_ex(False)
 
 Application.CutCopyMode = False
 
ERROR_make_formulas_with_procent_exercise:
 Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
       
 Range(adr).Select
 Application.ScreenUpdating = True
 
End Sub

Sub write_ex_to_cycle()
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

Worksheets(sheet_cycle_name).Unprotect Password:=aaa
On Error GoTo ERROR_write_ex_to_cycle

   Application.ScreenUpdating = False
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_ex = Worksheets(sheet_exercise_name).Range("A1:CC1000")
  
    ex_name = cur_ex(ex_name_row_1ex, Mnoj_column_1ex)
    
    n_day = cur_ex(ex_week_day_row_1ex, Mnoj_column_1ex) ' |fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'!'    Week_day = cur_ex(ex_week_day_row_1ex, Mnoj_column_1ex)
'!'    ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
   
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   j = 1
  While cur_ex(stroka_nachala_tabl + j - 1, weight_1step_column - column_delta) = ""
    j = j + 1
   If j = stroka_nachala_tabl + qty_workouts_week Then
    Msg = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
          Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    Exit Sub
   End If
  Wend
  n_str_1_raskl = j ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   
'''  For j = 0 To 6
'''   If StrComp(ar_week_days(j), Week_day) = 0 Then
'''      n_day = j
'''      Exit For
'''   End If
'''  Next j
    
'''''''''    fl1 = True
'''''''''  For i = 1 To qty_workouts_week
'''''''''   n_str = 5 + (n_str_1_raskl - 1) * qty_workouts_week + (i - 1) * (qty_ex_day + 1)
'''''''''   date1 = cur_cycle(n_str, 1) ' date1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "21.07.2015"
'''''''''   number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(date1), 3) ' 0-6
'''''''''   If StrComp(n_day, number_of_week_day) = 0 Then ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'''''''''     n_day = i ' |fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'''''''''     fl1 = False
'''''''''     Exit For
'''''''''   End If
'''''''''  Next i
  
'''''''''  '//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\
'''''''''  If StrComp(Worksheets(sheet_exercise_name).Range(adr_find_other_days), "|fffd||fffd|") = 0 Then
'''''''''     fl1 = False ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'''''''''  End If
'''''''''  '\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//
  
'''''''''If fl1 Then ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'''''''''    Msg = "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd| """ & Week_day & """ |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
'''''''''    Style = vbOK
'''''''''    Title = "LMS"
'''''''''    Response = MsgBox(Msg, Style, Title)
'''''''''Else
'-------------------------------------------------------------------------------
  
If Not (StrComp(Worksheets(sheet_exercise_name).Range(adr_find_other_days), "|fffd||fffd|") = 0) Then
  For i = 1 To max_qty_weeks ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (2-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
    n_str = stroka_nachala_tabl + i - 1 ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_ex_in_day = cur_ex(n_str, column_number_ex) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_str_cycle = 3 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + n_ex_in_day ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    If n_ex_in_day <> "" Then
    If StrComp(cur_cycle(n_str_cycle, Upr_column), ex_name) <> 0 Then
        Application.ScreenUpdating = True
        Cells(n_str, column_number_ex).Select
        Worksheets(sheet_cycle_name).Select
        Cells(n_str_cycle, Upr_column).Select
        
        Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & i & ": |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd| |fffd||fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        Style = vbOK
        Title = "LMS"
        Response = MsgBox(Msg, Style, Title)
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
        Exit Sub
    End If
    End If
  Next i
End If
'----------------- |fffd||fffd| |fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -------------
  Worksheets(sheet_cycle_name).Select
  Application.ScreenUpdating = False
         
If Not (StrComp(Worksheets(sheet_exercise_name).Range(adr_find_other_days), "|fffd||fffd|") = 0) Then

  For i = 1 To max_qty_weeks
    n_str = stroka_nachala_tabl + i - 1 ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_ex_in_day = cur_ex(n_str, column_number_ex) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_str_cycle = 3 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + n_ex_in_day ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
        
       If InStr(cur_cycle(n_str_cycle, weight_1step_column).FormulaR1C1, "<>") <> 0 Then
        fl_form = True ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       Else
        fl_form = False ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
       End If
 
   For j = 1 To qty_w_steps
     n_column = weight_1step_column + 4 * (j - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd|
     cur_cycle(n_str_cycle, n_column + 1) = cur_ex(n_str, n_column + 1 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     cur_cycle(n_str_cycle, n_column + 2) = cur_ex(n_str, n_column + 2 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If fl_form Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       cur_cycle(n_str_cycle, n_column + 3) = cur_ex(n_str, n_column + 3 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Else ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
       cur_cycle(n_str_cycle, n_column + 0) = cur_ex(n_str, n_column + 0 - column_delta) ' |fffd||fffd||fffd|
     End If
   Next j

  Next i


  '//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\//||\\
 Else
' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. '
' |fffd| 1-|fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd| 2-|fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd|) |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

  For i = 1 To max_qty_weeks
    n_str = stroka_nachala_tabl + i - 1 ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_ex_in_day = cur_ex(n_str, column_number_ex) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
    n_str_cycle = 3 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + n_ex_in_day ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
        
     If StrComp(cur_cycle(n_str_cycle, Upr_column), ex_name) <> 0 Then  ' |fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
      n_str_cycle1 = n_str_cycle
     ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd|) |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
        fl_no_ex = True
       For n_day = 1 To qty_workouts_week
         n_str_cycle = 3 + (i - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) + n_ex_in_day ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
         If StrComp(cur_cycle(n_str_cycle, Upr_column), ex_name) = 0 Then ' |fffd| i-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| n_day  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|!!!
           fl_no_ex = False
           Exit For
         End If
       Next n_day
       
       If fl_no_ex Then ' |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd|  n_ex_in_day
        Worksheets(sheet_exercise_name).Select
        Cells(n_str, column_number_ex).Select
        Application.ScreenUpdating = True
        Worksheets(sheet_cycle_name).Select
        Cells(n_str_cycle1, Upr_column).Select
        Msg = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & i & ": |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| """ & ex_name & """, |fffd||fffd||fffd||fffd||fffd||fffd| " & n_ex_in_day & "-|fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd| |fffd||fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
        Style = vbOK
        Title = "LMS"
        Response = MsgBox(Msg, Style, Title)
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
        Exit Sub
       End If
     End If
        
       If InStr(cur_cycle(n_str_cycle, weight_1step_column).FormulaR1C1, "<>") <> 0 Then
        fl_form = True ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       Else
        fl_form = False ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
       End If
 
   For j = 1 To qty_w_steps
     n_column = weight_1step_column + 4 * (j - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd|
     cur_cycle(n_str_cycle, n_column + 1) = cur_ex(n_str, n_column + 1 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     cur_cycle(n_str_cycle, n_column + 2) = cur_ex(n_str, n_column + 2 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      If fl_form Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       cur_cycle(n_str_cycle, n_column + 3) = cur_ex(n_str, n_column + 3 - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Else ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
       cur_cycle(n_str_cycle, n_column + 0) = cur_ex(n_str, n_column + 0 - column_delta) ' |fffd||fffd||fffd|
     End If
   Next j
  Next i

 End If
  '\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//\\||//
'''''''''' End If

ERROR_write_ex_to_cycle:
      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True

 Application.ScreenUpdating = True
    
End Sub


Sub make_formulas_with_weigth_exercise()

   Worksheets(sheet_exercise_name).Unprotect Password:=aaa
   On Error GoTo ERROR_make_formulas_with_weigth_exercise
   
  Application.ScreenUpdating = False
  adr = ActiveCell.Address
 
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

  For n = 1 To qty_w_steps
    n_stolb = weight_1step_column + (n - 1) * 4 - column_delta ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 3
    
    Range(Cells(stroka_nachala_tabl, n_stolb), Cells(stroka_nachala_tabl + max_qty_weeks - 1, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Next n

' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| %
      For n_str = stroka_nachala_tabl To stroka_nachala_tabl + max_qty_weeks - 1
          n_stolb = weight_1step_column - column_delta + 3 ' 6
          Cells(n_str, n_stolb).FormulaR1C1 = "=IFERROR(ROUND(RC[-3]/RC" & PM_column - column_delta & ",2),"""")"
      Next n_str
      
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    n_str1 = stroka_nachala_tabl
    n_str2 = stroka_nachala_tabl + max_qty_weeks - 1
    n_stolb = weight_1step_column - column_delta + 3 ' 6
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    Application.CutCopyMode = False
    Selection.Copy


   For n = 1 To qty_w_steps
    n_stolb = weight_1step_column - column_delta + 3 + 4 * (n - 1)
    Range(Cells(n_str1, n_stolb), Cells(n_str2, n_stolb)).Select
    ActiveSheet.Paste
   Next n

 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 Call Paint_columns_ex(True)
 
ERROR_make_formulas_with_weigth_exercise:
  Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
   
 Application.CutCopyMode = False
 Range(adr).Select
 Application.ScreenUpdating = True
    
End Sub

Sub Paint_columns_ex(fl)
' fl=true - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
' fl=false - |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| %

On Error GoTo m_er1
   
   s_w = ""
   s_pr = ""
   str1 = stroka_nachala_tabl
   str2 = stroka_nachala_tabl + max_qty_weeks - 1
   
  For n = 1 To qty_w_steps
    n_stolb_w = weight_1step_column - column_delta + 4 * (n - 1)
    n_stolb_pr = weight_1step_column - column_delta + 3 + 4 * (n - 1)
    ch_w = get_ch(n_stolb_w)
    ch_pr = get_ch(n_stolb_pr)
    s_w = s_w & ch_w & str1 & ":" & ch_w & str2 & ","
    s_pr = s_pr & ch_pr & str1 & ":" & ch_pr & str2 & ","
  Next n
  
    s_w = Left(s_w, Len(s_w) - 1)
    s_pr = Left(s_pr, Len(s_pr) - 1)
  
  If fl Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
   s_green = s_w
   s_grey = s_pr
  Else ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| %
   s_green = s_pr
   s_grey = s_w
  End If

     Range(s_green).Select

     With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorAccent1
        .TintAndShade = 0.799981688894314
        .PatternTintAndShade = 0
    End With
    Selection.Locked = False '!!!
    Selection.FormulaHidden = False '!!!
        
    Range(s_grey).Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = -4.99893185216834E-02
        .PatternTintAndShade = 0
    End With
    Selection.Locked = True '!!!
    Selection.FormulaHidden = False '!!!
    
m_er1:
End Sub


Sub axles_scaling_parameters_axle_OX_of_exercise(n_week)

Worksheets(sheet_exercise_name).Unprotect Password:=aaa
On Error GoTo ERROR_OX_ex
  ' n_week ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| OY
          
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_KPS).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_w_sr).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_T).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
       
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_IF).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_YOI).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
ERROR_OX_ex:
    Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
         
 '   Call axles_scaling_parameters_axle_OY_of_exercise

 End Sub
 

 
  Sub auto_scaling_parameters_axle_OY_of_exercise(nagr)
  ' nagr - |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
       ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
  Worksheets(sheet_exercise_name).Unprotect Password:=aaa
On Error GoTo ERROR_OY_ex2

  Set cur_ex_par = Worksheets(sheet_exercise_name).Range("A" & stroka_nachala_tabl & ":CC1000")
    adr = ActiveCell.Address
    
  KPS_min = 100000: KPS_max = 0
  w_sr_min = 100000: w_sr_max = 0
  YOI_min = 100000: YOI_max = 0
  T_min = 100000: T_max = 0
  IFunt_min = 100000: IFunt_max = 0
  
  PM_r = 0
  For i = 1 To max_qty_weeks
    If (PM_r = 0) And (cur_ex_par(i, PM_column - column_delta) <> "") And (cur_ex_par(i, PM_column - column_delta) <> 0) Then
       PM_r = cur_ex_par(i, PM_column - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    End If
  Next i
  
     nn = max_qty_weeks
   While cur_ex_par(nn, KPS_column - column_delta) = 0 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    nn = nn - 1
   Wend
  
    For i = 1 To nn
          
     If (PM_r = 0) And (cur_ex_par(i, PM_column - column_delta) <> "") And (cur_ex_par(i, PM_column - column_delta) <> 0) Then
       PM_r = cur_ex_par(i, PM_column - column_delta) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     End If
     
    If cur_ex_par(i, KPS_column - column_delta) <> 0 Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

      
      KPS_min = IIf(cur_ex_par(i, KPS_column - column_delta) < KPS_min, cur_ex_par(i, KPS_column - column_delta), KPS_min)
      KPS_max = IIf(cur_ex_par(i, KPS_column - column_delta) > KPS_max, cur_ex_par(i, KPS_column - column_delta), KPS_max)
      
      w_sr_min = IIf(cur_ex_par(i, w_sr_column - column_delta) < w_sr_min, cur_ex_par(i, w_sr_column - column_delta), w_sr_min)
      w_sr_max = IIf(cur_ex_par(i, w_sr_column - column_delta) > w_sr_max, cur_ex_par(i, w_sr_column - column_delta), w_sr_max)
  
      T_min = IIf(cur_ex_par(i, T_column - column_delta) < T_min, cur_ex_par(i, T_column - column_delta), T_min)
      T_max = IIf(cur_ex_par(i, T_column - column_delta) > T_max, cur_ex_par(i, T_column - column_delta), T_max)
      
      IFunt_min = IIf(cur_ex_par(i, I_Funt_column - column_delta) < IFunt_min, cur_ex_par(i, I_Funt_column - column_delta), IFunt_min)
      IFunt_max = IIf(cur_ex_par(i, I_Funt_column - column_delta) > IFunt_max, cur_ex_par(i, I_Funt_column - column_delta), IFunt_max)
  
      YOI_min = IIf(cur_ex_par(i, YOI_column - column_delta) < YOI_min, cur_ex_par(i, YOI_column - column_delta), YOI_min)
      YOI_max = IIf(cur_ex_par(i, YOI_column - column_delta) > YOI_max, cur_ex_par(i, YOI_column - column_delta), YOI_max)
    End If
   Next i
  
        If PM_r = 0 Then
         PM_r = 100
        End If

        k_n = Worksheets(sheet_exercise_name).Cells(Koef_row_1ex, Mnoj_column_1ex)
        mn = Worksheets(sheet_exercise_name).Cells(Mnoj_row_1ex, Mnoj_column_1ex)
        If mn = "" Then
          mn = 1
        End If

  KPS_min_r = 20: KPS_max_r = 50
  
  If StrComp(nagr, "|fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
   YOI_min_r = 31 / 100: YOI_max_r = 50 / 100
  ElseIf StrComp(nagr, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
   YOI_min_r = 50 / 100: YOI_max_r = 68 / 100
  ElseIf StrComp(nagr, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
   YOI_min_r = 58 / 100: YOI_max_r = 80 / 100
  Else
   YOI_min_r = 40 / 100: YOI_max_r = 75 / 100
  End If
  
  k_korr_T = 0.75 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  T_min_r = Round(mn * PM_r * YOI_min_r * KPS_min_r, 0)
  T_max_r = Round(k_korr_T * mn * PM_r * YOI_max_r * KPS_max_r, 0)
  
  w_sr_min_r = Round(T_min_r / KPS_min_r, 0): w_sr_max_r = Round(T_max_r / k_korr_T / KPS_max_r, 0)

 k_korr_IF = 0.55 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
  IFunt_min_r = Round(k_korr_IF * k_n * mn * PM_r * YOI_min_r * KPS_min_r * GetKFunt(YOI_min_r), 0)
  IFunt_max_r = Round(k_korr_IF * k_n * mn * PM_r * YOI_max_r * KPS_max_r * GetKFunt(YOI_max_r), 0)
'------------------------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| OY -----------

 If T_min <> 100000 Then
' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   KPS_min = KPS_min * 0.8
   YOI_min = YOI_min * 0.8
   IFunt_min = IFunt_min * 0.8
   w_sr_min = w_sr_min * 0.8
   T_min = T_min * 0.8
 Else
 ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   KPS_min = KPS_min_r
   YOI_min = YOI_min_r
   IFunt_min = IFunt_min_r
   w_sr_min = w_sr_min_r
   T_min = T_min_r
 End If
  
  If T_max <> 0 Then
 ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   KPS_max = IIf(KPS_max > KPS_max_r, KPS_max * 1.2, KPS_max_r)
   YOI_max = IIf(YOI_max > YOI_max_r, YOI_max * 1.2, YOI_max_r)
   IFunt_max = IIf(IFunt_max > IFunt_max_r, IFunt_max * 1.2, IFunt_max_r)
   w_sr_max = IIf(w_sr_max > w_sr_max_r, w_sr_max * 1.2, w_sr_max_r)
   T_max = IIf(T_max > T_max_r, T_max * 1.2, T_max_r)
 Else
 ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
   KPS_max = KPS_max_r
   YOI_max = YOI_max_r
   IFunt_max = IFunt_max_r
   w_sr_max = w_sr_max_r
   T_max = T_max_r
 End If
  
  
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 2 * WorksheetFunction.RoundUp((KPS_max + 2) / 2, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 2 * WorksheetFunction.RoundDown((KPS_min - 2) / 2, 0)
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 1, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 1, 0)
          
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_T).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 100 * WorksheetFunction.RoundUp((T_max + 30) / 100, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 100 * WorksheetFunction.RoundDown((T_min - 30) / 100, 0)
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_IF).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 100 * WorksheetFunction.RoundUp((IFunt_max + 30) / 100, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 100 * WorksheetFunction.RoundDown((IFunt_min - 30) / 100, 0)
          
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_YOI).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.01 * WorksheetFunction.RoundUp((YOI_max + 0.02) / 0.01, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.01 * WorksheetFunction.RoundDown((YOI_min - 0.02) / 0.01, 0)
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
ERROR_OY_ex2:
    Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
          
          Range(adr).Select
  End Sub
  
  Sub axles_scaling_parameters_axle_OY_of_exercise()
     ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
  Worksheets(sheet_exercise_name).Unprotect Password:=aaa
On Error GoTo ERROR_OY_ex

  Set cur_ex_par = Worksheets(sheet_exercise_name).Range("A" & stroka_nachala_tabl & ":CC1000")
    adr = ActiveCell.Address
    
  KPS_min = 100000: KPS_max = 0
  w_sr_min = 100000: w_sr_max = 0
  YOI_min = 100000: YOI_max = 0
  T_min = 100000: T_max = 0
  IFunt_min = 100000: IFunt_max = 0
  
   nn = max_qty_weeks
   While cur_ex_par(nn, KPS_column - column_delta) = 0 ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    nn = nn - 1
   Wend
   
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| 1-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   For i = 1 To nn
    If cur_ex_par(i, KPS_column - column_delta) <> 0 Then ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      KPS_min = IIf(cur_ex_par(i, KPS_column - column_delta) < KPS_min, cur_ex_par(i, KPS_column - column_delta), KPS_min)
      KPS_max = IIf(cur_ex_par(i, KPS_column - column_delta) > KPS_max, cur_ex_par(i, KPS_column - column_delta), KPS_max)
      
      w_sr_min = IIf(cur_ex_par(i, w_sr_column - column_delta) < w_sr_min, cur_ex_par(i, w_sr_column - column_delta), w_sr_min)
      w_sr_max = IIf(cur_ex_par(i, w_sr_column - column_delta) > w_sr_max, cur_ex_par(i, w_sr_column - column_delta), w_sr_max)
  
      T_min = IIf(cur_ex_par(i, T_column - column_delta) < T_min, cur_ex_par(i, T_column - column_delta), T_min)
      T_max = IIf(cur_ex_par(i, T_column - column_delta) > T_max, cur_ex_par(i, T_column - column_delta), T_max)
      
      IFunt_min = IIf(cur_ex_par(i, I_Funt_column - column_delta) < IFunt_min, cur_ex_par(i, I_Funt_column - column_delta), IFunt_min)
      IFunt_max = IIf(cur_ex_par(i, I_Funt_column - column_delta) > IFunt_max, cur_ex_par(i, I_Funt_column - column_delta), IFunt_max)
  
      YOI_min = IIf(cur_ex_par(i, YOI_column - column_delta) < YOI_min, cur_ex_par(i, YOI_column - column_delta), YOI_min)
      YOI_max = IIf(cur_ex_par(i, YOI_column - column_delta) > YOI_max, cur_ex_par(i, YOI_column - column_delta), YOI_max)
    End If
   Next i
    
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 2 * WorksheetFunction.RoundUp((KPS_max + 2) / 2, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 2 * WorksheetFunction.RoundDown((KPS_min - 2) / 2, 0)
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 1, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 1, 0)
          
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_T).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 100 * WorksheetFunction.RoundUp((T_max + 30) / 100, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 100 * WorksheetFunction.RoundDown((T_min - 30) / 100, 0)
     
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_IF).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 100 * WorksheetFunction.RoundUp((IFunt_max + 30) / 100, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 100 * WorksheetFunction.RoundDown((IFunt_min - 30) / 100, 0)
          
     Worksheets(sheet_exercise_name).ChartObjects(name_graph_1ex_YOI).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.01 * WorksheetFunction.RoundUp((YOI_max + 0.02) / 0.01, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.01 * WorksheetFunction.RoundDown((YOI_min - 0.02) / 0.01, 0)
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
ERROR_OY_ex:
    Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
          
          Range(adr).Select
       
 End Sub
 
 Sub set_12_weeks_interface()
 
   Worksheets(sheet_exercise_name).Unprotect Password:=aaa
   On Error GoTo ERROR_12w

   adr = ActiveCell.Address
   n_str1 = stroka_nachala_tabl + 12
   n_str2 = stroka_nachala_tabl + max_qty_weeks - 1
   Rows(n_str1 & ":" & n_str2).EntireRow.RowHeight = 0
   Call axles_scaling_parameters_axle_OX_of_exercise(12)
ERROR_12w:
   Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
         
   Range(adr).Select
 End Sub

Sub set_max_weeks_interface()

   Worksheets(sheet_exercise_name).Unprotect Password:=aaa
   On Error GoTo ERROR_max_w
   
  adr = ActiveCell.Address
   n_str1 = stroka_nachala_tabl + 12
   n_str2 = stroka_nachala_tabl + max_qty_weeks - 1
   Rows(n_str1 & ":" & n_str2).EntireRow.Hidden = False
   Call axles_scaling_parameters_axle_OX_of_exercise(max_qty_weeks)
ERROR_max_w:
   Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
   
   Range(adr).Select
End Sub




Attribute VB_Name = "Vadim_3"
  Public Const name_graph_group_KPS = "|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_group_w_sr = "|fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_group_T = "|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_group_IF = "|fffd||fffd||fffd|_|fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const name_graph_group_YOI = "|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  
  Public Const name_graph_week_KPS = "|fffd||fffd||fffd|_|fffd||fffd||fffd|"
  Public Const name_graph_week_w_sr = "|fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd|"
  Public Const name_graph_week_T_IF = "|fffd|_|fffd||fffd||fffd|_|fffd|_|fffd|_|fffd||fffd||fffd|"
  Public Const name_graph_week_YOI = "|fffd||fffd||fffd|_|fffd||fffd||fffd|"
  
  Public Const name_graph_body_weight = "|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|"
  Public Const name_graph_sleep = "|fffd||fffd||fffd|_|fffd||fffd||fffd|"
  
   Public Const name_graph_ccal = "|fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|"
   Public Const name_graph_BJU = "|fffd||fffd||fffd|_|fffd||fffd||fffd|"
   Public Const name_graph_an_protein_1kg_BW = "|fffd|_|fffd||fffd||fffd|_|fffd||fffd|_1|fffd||fffd|"
   Public Const name_graph_BJU_proc = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|"
  
  Public Const table_nutr_1str = 56 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd| ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const table_nutr_1stolb = 39 ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd| |fffd| ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  
  Public Const stroka_nachala_1_st_tabl = 122 ' 105 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  Public Const solbec_nachala_1_st_tabl = 20 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  
  Public Const delta_rows_group = 32 '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd|. |fffd||fffd||fffd| |fffd| |fffd|.|fffd|.)
  Public Const max_qty_groups = 10 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

  Public Const sheet_graphics_name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Sub axles_scaling_parameters_axle_OX_of_graphics(n_week)
  
   Worksheets(sheet_graphics_name).Unprotect Password:=aaa
   On Error GoTo ERROR_axles_scaling_parameters_axle_OX_of_graphics
  ' n_week ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| OY
          
 If n_week = 35 Then
          
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_body_weight).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_sleep).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
   
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_ccal).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_BJU).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_an_protein_1kg_BW).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
   
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_BJU_proc).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
 Else
   
      Worksheets(sheet_graphics_name).ChartObjects(name_graph_body_weight).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_sleep).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
   
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_ccal).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_BJU).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_an_protein_1kg_BW).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
   
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_BJU_proc).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
   
   
      Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_KPS).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
     
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_w_sr).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
     
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_T_IF).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1

   Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_YOI).Activate
   ActiveChart.Axes(xlCategory).MaximumScale = n_week
   ActiveChart.Axes(xlCategory).MinimumScale = 1
      
      
'------------------------------------------------------------------------------------------
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_KPS).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_w_sr).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_T).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
       
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_IF).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_YOI).Activate
     ActiveChart.Axes(xlCategory).MaximumScale = n_week
     ActiveChart.Axes(xlCategory).MinimumScale = 1
     
 End If
   
     
  Call axles_scaling_parameters_axle_OY_of_graphics

ERROR_axles_scaling_parameters_axle_OX_of_graphics:
      Worksheets(sheet_graphics_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
        
 End Sub
 
    Sub axles_scaling_parameters_axle_OY_of_graphics()
    
      Worksheets(sheet_graphics_name).Unprotect Password:=aaa
      On Error GoTo ERROR_axles_scaling_parameters_axle_OY_of_graphics
         
      Set cur_gr = Worksheets(sheet_graphics_name).Range("A1:CC3000")
 
      adr = ActiveCell.Address
      
      
  Set cur_ex_par = Worksheets(sheet_cycle_name).Range("A1:CC5000")
 
  KPS_min = 100000: KPS_max = 0
  w_sr_min = 100000: w_sr_max = 0
  T_min = 100000: T_max = 0
  IFunt_min = 100000: IFunt_max = 0
  YOI_min = 10000: YOI_max = 0
 
 i = 2
   
    While cur_ex_par(i, KPS_column) <> 0
   
      KPS_min = IIf(cur_ex_par(i, KPS_column) < KPS_min, cur_ex_par(i, KPS_column), KPS_min)
      KPS_max = IIf(cur_ex_par(i, KPS_column) > KPS_max, cur_ex_par(i, KPS_column), KPS_max)
      
      w_sr_min = IIf(cur_ex_par(i, w_sr_column) < w_sr_min, cur_ex_par(i, w_sr_column), w_sr_min)
      w_sr_max = IIf(cur_ex_par(i, w_sr_column) > w_sr_max, cur_ex_par(i, w_sr_column), w_sr_max)
  
      T_min = IIf(cur_ex_par(i, T_column) < T_min, cur_ex_par(i, T_column), T_min)
      T_max = IIf(cur_ex_par(i, T_column) > T_max, cur_ex_par(i, T_column), T_max)
      
      IFunt_min = IIf(cur_ex_par(i, I_Funt_column) < IFunt_min, cur_ex_par(i, I_Funt_column), IFunt_min)
      IFunt_max = IIf(cur_ex_par(i, I_Funt_column) > IFunt_max, cur_ex_par(i, I_Funt_column), IFunt_max)
  
      YOI_min = IIf(cur_ex_par(i, YOI_column) < YOI_min, cur_ex_par(i, YOI_column), YOI_min)
      YOI_max = IIf(cur_ex_par(i, YOI_column) > YOI_max, cur_ex_par(i, YOI_column), YOI_max)

      i = i + qty_rows_in_week
    
    Wend
    
    ' |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    T_min = IIf(IFunt_min < T_min, IFunt_min, T_min)
    T_max = IIf(IFunt_max > T_max, IFunt_max, T_max)
    
        
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((KPS_max + 5) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((KPS_min - 5) / 10, 0)
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 2.5, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 2.5, 0)
          
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_T_IF).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 1000 * WorksheetFunction.RoundUp((T_max + 100) / 1000, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 1000 * WorksheetFunction.RoundDown((T_min - 100) / 1000, 0)
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_week_YOI).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.01 * WorksheetFunction.RoundUp((YOI_max + 0.005) / 0.01, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.01 * WorksheetFunction.RoundDown((YOI_min - 0.005) / 0.01, 0)
      

    '-------------------------------------------------------------------------------
    
    BW_min = cur_gr(table_nutr_1str, table_nutr_1stolb)    ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    BW_max = cur_gr(table_nutr_1str + 1, table_nutr_1stolb) ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    
    sleep_min = cur_gr(table_nutr_1str, table_nutr_1stolb + 1)  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
    sleep_max = cur_gr(table_nutr_1str + 1, table_nutr_1stolb + 1) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
        
    kkal_min = cur_gr(table_nutr_1str, table_nutr_1stolb + 2)  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    kkal_max = cur_gr(table_nutr_1str + 1, table_nutr_1stolb + 2) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    BJU_min = cur_gr(table_nutr_1str, table_nutr_1stolb + 3)  ' |fffd||fffd||fffd|
    BJU_max = cur_gr(table_nutr_1str + 1, table_nutr_1stolb + 3) ' |fffd||fffd||fffd|
    
    B_jiv_min = cur_gr(table_nutr_1str, table_nutr_1stolb + 4)  ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    B_jiv_max = cur_gr(table_nutr_1str + 1, table_nutr_1stolb + 4) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_body_weight).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 2 * WorksheetFunction.RoundUp((BW_max + 1) / 2, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 2 * WorksheetFunction.RoundDown((BW_min - 1) / 2, 0)
    
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_sleep).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.0417 * WorksheetFunction.RoundUp((sleep_max + 0.5 * 0.0417) / 0.0417, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.0417 * WorksheetFunction.RoundDown((sleep_min - 0.5 * 0.0417) / 0.0417, 0)
    
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_ccal).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 500 * WorksheetFunction.RoundUp((kkal_max + 200) / 500, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 500 * WorksheetFunction.RoundDown((kkal_min - 200) / 500, 0)
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_BJU).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((BJU_max + 5) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((BJU_min - 5) / 10, 0)
    
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_an_protein_1kg_BW).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.5 * WorksheetFunction.RoundUp((B_jiv_min + 0.2) / 0.5, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.5 * WorksheetFunction.RoundDown((B_jiv_max - 0.2) / 0.5, 0)
    
    
    '-------------------------------------------------------------------------------
    
    KPS_max = cur_gr(stroka_nachala_1_st_tabl + 0 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 5)
    KPS_min = cur_gr(stroka_nachala_1_st_tabl + 0 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 4)
    
    T_max = cur_gr(stroka_nachala_1_st_tabl + 1 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 5)
    T_min = cur_gr(stroka_nachala_1_st_tabl + 1 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 4)
    
    w_sr_max = cur_gr(stroka_nachala_1_st_tabl + 2 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 5)
    w_sr_min = cur_gr(stroka_nachala_1_st_tabl + 2 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 4)
    
    IF_max = cur_gr(stroka_nachala_1_st_tabl + 3 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 5)
    IF_min = cur_gr(stroka_nachala_1_st_tabl + 3 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 4)
    
    YOI_max = cur_gr(stroka_nachala_1_st_tabl + 4 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 5)
    YOI_min = cur_gr(stroka_nachala_1_st_tabl + 4 * delta_rows_group, solbec_nachala_1_st_tabl + 2 * max_qty_groups + 4)
    
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((KPS_max + 5) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((KPS_min - 5) / 10, 0)
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 2.5, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 2.5, 0)
          
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_T).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 1000 * WorksheetFunction.RoundUp((T_max + 100) / 1000, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 1000 * WorksheetFunction.RoundDown((T_min - 100) / 1000, 0)
     
      Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_IF).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 1000 * WorksheetFunction.RoundUp((IF_max + 100) / 1000, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 1000 * WorksheetFunction.RoundDown((IF_min - 100) / 1000, 0)
     
     Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_YOI).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 0.01 * WorksheetFunction.RoundUp((YOI_max + 0.005) / 0.01, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 0.01 * WorksheetFunction.RoundDown((YOI_min - 0.005) / 0.01, 0)
 
       
ERROR_axles_scaling_parameters_axle_OY_of_graphics:
       
       Range(adr).Select
       
        Worksheets(sheet_graphics_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
       
 End Sub
    
Sub Fill_in_group_tables()

 Worksheets(sheet_graphics_name).Unprotect Password:=aaa
      On Error GoTo m_gr_ERR
 
 fl_with_empty = IIf(CommandBars.ActionControl.Parameter = "True", True, False)
 
  'fl_with_empty = true - |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
  'fl_with_empty = false - |fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Application.ScreenUpdating = False
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_ex = Worksheets(sheet_exercise_name).Range("A1:CC1000")
  Set cur_gr = Worksheets(sheet_graphics_name).Range("A1:CC3000")
  
  Dim group_name_ar()
  ReDim group_name_ar(1 To max_qty_groups)
  
  Dim KPS_ar()
  ReDim KPS_ar(1 To max_qty_weeks, 1 To max_qty_groups)
  Dim T_ar()
  ReDim T_ar(1 To max_qty_weeks, 1 To max_qty_groups)
  Dim w_sr_ar()
  ReDim w_sr_ar(1 To max_qty_weeks, 1 To max_qty_groups)
  Dim I_F_ar()
  ReDim I_F_ar(1 To max_qty_weeks, 1 To max_qty_groups)
  Dim YOI_ar()
  ReDim YOI_ar(1 To max_qty_weeks, 1 To max_qty_groups)

  kol_gr = 0 ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

    For i = 1 To max_qty_weeks
    
    For kk = 1 To max_qty_groups ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     KPS_ar(i, kk) = 0: T_ar(i, kk) = 0: w_sr_ar(i, kk) = 0: I_F_ar(i, kk) = 0: YOI_ar(i, kk) = 0
    Next kk
      
      If cur_cycle(2 + (i - 1) * qty_rows_in_week, KPS_column) = 0 Then
       kol_ned = i - 1
       Exit For
      End If
      
      For j = 1 To qty_workouts_week
        For k = 1 To qty_ex_day
          n_str = 3 + (i - 1) * qty_rows_in_week + (j - 1) * (qty_ex_day + 1) + k
          
     If Trim(cur_cycle(n_str, weight_1step_column + 1)) <> "" Then ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
          
          my_gr = cur_cycle(n_str, Group_column)
          
     If ((fl_with_empty) And (my_gr = "")) Or (my_gr <> "") Then
          my_gr = IIf(my_gr = "", "|fffd||fffd||fffd||fffd||fffd||fffd|", my_gr)
          
          '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
           fl = True ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
          For m = 1 To kol_gr
             If (StrComp(my_gr, group_name_ar(m)) = 0) Then
              fl = False
              n_gr = m
              Exit For
             End If
          Next m
          
        If fl Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
          kol_gr = kol_gr + 1
          group_name_ar(kol_gr) = my_gr
          n_gr = kol_gr
        End If
          
        ' ------------ |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| -------------------------------------
          KPS_ar(i, n_gr) = KPS_ar(i, n_gr) + cur_cycle(n_str, KPS_column)
          T_ar(i, n_gr) = T_ar(i, n_gr) + cur_cycle(n_str, T_column)
          I_F_ar(i, n_gr) = I_F_ar(i, n_gr) + cur_cycle(n_str, I_Funt_column)
          YOI_ar(i, n_gr) = YOI_ar(i, n_gr) + cur_cycle(n_str, YOI_column) * cur_cycle(n_str, KPS_column)
        ' -------------------------------------------------------------------------------
        
       End If
    
    End If

        Next k
      Next j
      
   Next i
   
   '---------------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| --------------------------------
       For i = 1 To max_qty_weeks
          For n_gr = 1 To max_qty_groups
           If KPS_ar(i, n_gr) <> 0 Then
            YOI_ar(i, n_gr) = YOI_ar(i, n_gr) / KPS_ar(i, n_gr)
            w_sr_ar(i, n_gr) = T_ar(i, n_gr) / KPS_ar(i, n_gr)
           End If
        Next n_gr
      Next i
    
    
    For kk = 1 To max_qty_groups ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     KPS_ar(kol_ned + 1, kk) = "": T_ar(kol_ned + 1, kk) = "": w_sr_ar(kol_ned + 1, kk) = "": I_F_ar(kol_ned + 1, kk) = "": YOI_ar(kol_ned + 1, kk) = ""
    Next kk

    For kk = kol_gr + 1 To max_qty_groups   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     For jj = 1 To max_qty_weeks
       KPS_ar(jj, kk) = "": T_ar(jj, kk) = "": w_sr_ar(jj, kk) = "": I_F_ar(jj, kk) = "": YOI_ar(jj, kk) = ""
     Next jj
    Next kk
      
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
   column_other = 0
  For i = 1 To kol_gr
    If StrComp(group_name_ar(i), "|fffd||fffd||fffd||fffd||fffd||fffd|") = 0 Then
      column_other = i
      Exit For
    End If
  Next i
 
  If (column_other <> 0) Then ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    buf = group_name_ar(column_other)
    group_name_ar(column_other) = group_name_ar(kol_gr)
    group_name_ar(kol_gr) = buf
  
  For i = 1 To kol_ned
   buf = KPS_ar(i, column_other): KPS_ar(i, column_other) = KPS_ar(i, kol_gr): KPS_ar(i, kol_gr) = buf
   buf = T_ar(i, column_other): T_ar(i, column_other) = T_ar(i, kol_gr): T_ar(i, kol_gr) = buf
   buf = w_sr_ar(i, column_other): w_sr_ar(i, column_other) = w_sr_ar(i, kol_gr): w_sr_ar(i, kol_gr) = buf
   buf = I_F_ar(i, column_other): I_F_ar(i, column_other) = I_F_ar(i, kol_gr): I_F_ar(i, kol_gr) = buf
   buf = YOI_ar(i, column_other): YOI_ar(i, column_other) = YOI_ar(i, kol_gr): YOI_ar(i, kol_gr) = buf
  Next i
 
  End If
 
'----------------- |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" ----------

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 Worksheets(sheet_graphics_name).Select
 str1 = stroka_nachala_1_st_tabl
 str2 = str1 + max_qty_weeks - 1
 
 For i = 1 To 5 ' 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd|, |fffd|, |fffd||fffd||fffd|, |fffd||fffd|. |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd|+|fffd|
   Worksheets(sheet_graphics_name).Range(get_ch(solbec_nachala_1_st_tabl) & str1 & ":" & _
       get_ch(solbec_nachala_1_st_tabl + max_qty_groups - 1) & str2).ClearContents
   str1 = str1 + delta_rows_group
   str2 = str2 + delta_rows_group
 Next i

' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 For j = 1 To max_qty_groups
         cur_gr(stroka_nachala_1_st_tabl + 0 * delta_rows_group - 1, solbec_nachala_1_st_tabl + j - 1) = group_name_ar(j)
         cur_gr(stroka_nachala_1_st_tabl + 1 * delta_rows_group - 1, solbec_nachala_1_st_tabl + j - 1) = group_name_ar(j)
         cur_gr(stroka_nachala_1_st_tabl + 2 * delta_rows_group - 1, solbec_nachala_1_st_tabl + j - 1) = group_name_ar(j)
         cur_gr(stroka_nachala_1_st_tabl + 3 * delta_rows_group - 1, solbec_nachala_1_st_tabl + j - 1) = group_name_ar(j)
         cur_gr(stroka_nachala_1_st_tabl + 4 * delta_rows_group - 1, solbec_nachala_1_st_tabl + j - 1) = group_name_ar(j)
   For i = 1 To max_qty_weeks
     cur_gr(stroka_nachala_1_st_tabl + 0 * delta_rows_group + i - 1, solbec_nachala_1_st_tabl + j - 1) = KPS_ar(i, j)
     cur_gr(stroka_nachala_1_st_tabl + 1 * delta_rows_group + i - 1, solbec_nachala_1_st_tabl + j - 1) = T_ar(i, j)
     cur_gr(stroka_nachala_1_st_tabl + 2 * delta_rows_group + i - 1, solbec_nachala_1_st_tabl + j - 1) = w_sr_ar(i, j)
     cur_gr(stroka_nachala_1_st_tabl + 3 * delta_rows_group + i - 1, solbec_nachala_1_st_tabl + j - 1) = I_F_ar(i, j)
     cur_gr(stroka_nachala_1_st_tabl + 4 * delta_rows_group + i - 1, solbec_nachala_1_st_tabl + j - 1) = YOI_ar(i, j)
   Next i
 Next j
 
 
 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 
  ' On Error GoTo m_gr_ERR
  '  Worksheets(sheet_graphics_name).Unprotect Password:=aaa
    
  Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_KPS).Activate
 For j = 1 To max_qty_groups
     ActiveChart.SeriesCollection(j).Name = group_name_ar(j)
 Next j
 
  Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_w_sr).Activate
 For j = 1 To max_qty_groups
     ActiveChart.SeriesCollection(j).Name = group_name_ar(j)
 Next j
 
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_T).Activate
 For j = 1 To max_qty_groups
     ActiveChart.SeriesCollection(j).Name = group_name_ar(j)
 Next j
 
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_IF).Activate
 For j = 1 To max_qty_groups
     ActiveChart.SeriesCollection(j).Name = group_name_ar(j)
 Next j
 
   Worksheets(sheet_graphics_name).ChartObjects(name_graph_group_YOI).Activate
 For j = 1 To max_qty_groups
     ActiveChart.SeriesCollection(j).Name = group_name_ar(j)
 Next j


        
 Call axles_scaling_parameters_axle_OX_of_graphics(kol_ned)
 
    ActiveWindow.Zoom = 60: ActiveWindow.Zoom = 50: ActiveWindow.Zoom = 40: ActiveWindow.Zoom = 30: ActiveWindow.Zoom = 20: ActiveWindow.Zoom = 10
    ActiveWindow.Zoom = 20
    ActiveWindow.Zoom = 30
    ActiveWindow.Zoom = 40
    ActiveWindow.Zoom = 50
    ActiveWindow.Zoom = 60
    ActiveWindow.Zoom = 70
    
m_gr_ERR:
   
         Worksheets(sheet_graphics_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
   Application.ScreenUpdating = True
   
 Cells(stroka_nachala_1_st_tabl - 4, 1).Select
 
End Sub
Sub set_35_weeks_interface_gr()
 Call axles_scaling_parameters_axle_OX_of_graphics(35)
End Sub
Sub set_max_weeks_interface_gr()
 Call axles_scaling_parameters_axle_OX_of_graphics(max_qty_weeks)
End Sub

Sub set_12_weeks_interface_gr()
 Call axles_scaling_parameters_axle_OX_of_graphics(12)
End Sub

Sub menu_sheet_graphics()

    Dim myMenuBar As CommandBar
    Dim ctrl(1 To 10) As CommandBarControl
    Set myMenuBar = Application.CommandBars("Cell")
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    myMenuBar.Reset

    Set ctrl(1) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(1).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(1).OnAction = "set_12_weeks_interface_gr"
    ctrl(1).BeginGroup = True
    
    Set ctrl(2) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(2).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(2).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & max_qty_weeks & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    ctrl(2).OnAction = "set_max_weeks_interface_gr"
        
    Set ctrl(3) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(3).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 35 |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
    ctrl(3).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 35 |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|"
    ctrl(3).OnAction = "set_35_weeks_interface_gr"
    
    Set ctrl(4) = myMenuBar.Controls.Add(Type:=msoControlButton, Temporary:=True)
    ctrl(4).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| Y"
    ctrl(4).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| Y"
    ctrl(4).OnAction = "axles_scaling_parameters_axle_OY_of_graphics"
   
   
End Sub



Sub Change_graphs_values()

    gr_name = "|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|"
    kol = 10
    x_kol = 25
    str1 = 233
    stolb1 = 20
    ActiveSheet.ChartObjects(gr_name).Activate
    ActiveChart.Axes(xlValue).MajorGridlines.Select


  For i = 1 To kol
    ActiveChart.SeriesCollection(i).XValues = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd|!R" & str1 & ":R" & str1 + x_kol - 1
    ActiveChart.SeriesCollection(i).Values = "=|fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & get_ch(stolb1 + i - 1) & str1 & ":" & get_ch(stolb1 + i - 1) & str1 + x_kol - 1
  Next i
    
End Sub







Attribute VB_Name = "Vadim_4"
  Public Const str_nachala_tabl_report = 8 ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const stlb_nachala_tabl_report = 2 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const qty_ex_in_report = 10   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const adr_cycle_name = "D1"
  Public Const adr_date_name = "D3"
  Public Const adr_weight_name = "H4"
  Public Const adr_time_name = "H5"
  
  Public Const adr_KPS_name = "B29"
  Public Const adr_T_name = "B30"
  Public Const adr_w_sr_name = "B31"
  Public Const adr_I_F_name = "B32"
  Public Const adr_YOI_name = "B33"
  Public Const sheet_reports_name = "|fffd||fffd||fffd||fffd||fffd||fffd|"  ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const sheet_calc_food_name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const sheet_food_kurs = "|fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|" ' |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
  Public Const product_column = 3 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Const Proteins_column = 5 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  Public Const adr_date_calc_nutr_name = "D2"
  Public Const adr_weigth_calc_nutr_name = "D3"
  
  Public Const date_column_t = 2 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const BW_column_t = 3 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  
  Public Const prot_column_t = 6 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const fat_column_t = 7 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const carb_column_t = 8 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const ccal_column_t = 9 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  
  Public Const GI_column_t = 10 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const prot_an_column_t = 11 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const fat_an_column_t = 12 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  Public Const fat_pl_column_t = 13 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|  "|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"
  
  Public Const aaa = "LMS111|fffd||fffd||fffd||fffd||fffd||fffd||fffd|111"
  
 Sub make_day_report() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     Worksheets(sheet_cycle_name).Unprotect Password:=aaa
   Worksheets(sheet_reports_name).Unprotect Password:=aaa
    
On Error GoTo ERROR_make_day_report
   
  Set cur_cycle = Worksheets(sheet_cycle_name).Range("A1:CC5000")
  Set cur_r = Worksheets(sheet_reports_name).Range("A1:CC1000")
 
 '-------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
 
     Application.ScreenUpdating = False
     adr = ActiveCell.Address
     n_str = ActiveCell.Row

     n_cycle = 1 + Application.WorksheetFunction.RoundDown(((n_str - 1 - 0.001) / qty_rows_in_week), 0)
     n_cycle = IIf(n_str = 1, 1, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     n_cycle = IIf(n_str > 1 + qty_rows_in_week * max_qty_weeks, max_qty_weeks, n_cycle) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     
      n_str_pp = 3 + (ActiveCell.Row - 3) Mod qty_rows_in_week ' |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      n_day = 1 + Application.WorksheetFunction.RoundDown((n_str_pp - 3 - 0.01) / (qty_ex_day + 1), 0)
      n_day = IIf(n_day = 7, 6, n_day) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
   If Not ((InStr(Cells(n_str, T_column).FormulaR1C1, "*") <> 0) Or (InStr(Cells(n_str - 1, T_column).FormulaR1C1, "*") <> 0)) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "|fffd||fffd||fffd||fffd||fffd||fffd|" |fffd||fffd||fffd|
    Msg = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
   Else ' everything is OK
  
   Call show_my_report(0)  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   
   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      Worksheets(sheet_reports_name).Range(get_ch(stlb_nachala_tabl_report) & str_nachala_tabl_report & ":" & _
       get_ch(stlb_nachala_tabl_report + qty_w_steps) & str_nachala_tabl_report + 2 * qty_ex_in_report - 1).ClearContents
       
       
     n_str1 = 4 + (n_cycle - 1) * qty_rows_in_week + (n_day - 1) * (qty_ex_day + 1) ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  ' |fffd||fffd||fffd||fffd||fffd|
  
   ar_week_days = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|")
   number_of_week_day = Application.WorksheetFunction.Weekday(DateValue(cur_cycle(n_str1 + 1, 1)), 3) ' 0-6

   Worksheets(sheet_reports_name).Range(adr_cycle_name) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & n_cycle
   Worksheets(sheet_reports_name).Range(adr_date_name) = cur_cycle(n_str1 + 1, 1) & " (" & ar_week_days(number_of_week_day) & ")"   '13.08.2015 (|fffd||fffd|)
   Worksheets(sheet_reports_name).Range(adr_weight_name) = "|fffd||fffd||fffd|: " & "_____" & " |fffd||fffd|" ' IIf(cur_cycle(n_str1, info_column) <> "", cur_cycle(n_str1, info_column), "_____") & " |fffd||fffd|"
   Worksheets(sheet_reports_name).Range(adr_time_name) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Format(cur_cycle(n_str1 + qty_ex_day, time_column), "hh:mm")

' |fffd||fffd||fffd||fffd||fffd|
    Worksheets(sheet_reports_name).Range(adr_KPS_name) = "|fffd||fffd||fffd| = " & cur_cycle(n_str1 + qty_ex_day, KPS_column)
    Worksheets(sheet_reports_name).Range(adr_T_name) = "|fffd| = " & Round(cur_cycle(n_str1 + qty_ex_day, T_column), 0) & " |fffd||fffd|"
    Worksheets(sheet_reports_name).Range(adr_w_sr_name) = "|fffd||fffd|. |fffd||fffd||fffd| = " & Round(cur_cycle(n_str1 + qty_ex_day, w_sr_column), 1) & " |fffd||fffd|"
    Worksheets(sheet_reports_name).Range(adr_I_F_name) = "|fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|. = " & Round(cur_cycle(n_str1 + qty_ex_day, I_Funt_column), 0)
    Worksheets(sheet_reports_name).Range(adr_YOI_name) = "|fffd||fffd||fffd| = " & Round(100 * cur_cycle(n_str1 + qty_ex_day, YOI_column), 0) & "%"


     m1 = stlb_nachala_tabl_report ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
     n = str_nachala_tabl_report ' 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    
    While cur_cycle(n_str1, Upr_column) <> ""
    
     step_w = weight_1step_column ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd|" 1-|fffd||fffd| |fffd||fffd||fffd||fffd|
     m = stlb_nachala_tabl_report + 1

     cur_r(n, m1) = cur_cycle(n_str1, Upr_column)
     
     While (cur_cycle(n_str1, step_w + 1) <> "") And (step_w + 1 < T_column) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      w = cur_cycle(n_str1, step_w)
      kol_povt = cur_cycle(n_str1, step_w + 1)
      kol_podh = cur_cycle(n_str1, step_w + 2)
      pr = Round(100 * cur_cycle(n_str1, step_w + 3), 0)
      
     If cur_cycle(n_str1, Mnoj_column) <> "" Then '50 (47%)
      s_w_pr = w & IIf(cur_cycle(n_str1, Mnoj_column) > 2, "|fffd||fffd|", "") & " (" & pr & "%)"
     Else
      s_w_pr = w & " (" & pr & "%)"
     End If
      cur_r(n, m) = s_w_pr
      
       s_povt = ""
      For k = 1 To kol_podh
       s_povt = s_povt & kol_povt & ","
      Next k
       s_povt = Left(s_povt, Len(s_povt) - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
       cur_r(n + 1, m) = s_povt
      
       m = m + 1
      step_w = step_w + 4
     Wend
  
     n = n + 2
     n_str1 = n_str1 + 1
    Wend
   
       Application.ScreenUpdating = True
       Worksheets(sheet_reports_name).Select
       Range("d5").Select
  
  End If
  
ERROR_make_day_report:
       
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
        
              Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   Application.ScreenUpdating = True
   

 End Sub
 
 Sub menu_calculator_of_food()
 
     Dim myMenuBar As CommandBar
    Dim ctrl(1 To 1000) As CommandBarControl
    Set myMenuBar = Application.CommandBars("Cell")
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    myMenuBar.Reset

'    Set ctrl(1) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
'    ctrl(1).Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'    ctrl(1).TooltipText = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'    ctrl(1).BeginGroup = True
'
 
 
   '' '---------------------------------------- |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| -------------------
    On Error GoTo menu2
    Set cur_pr = Worksheets("|fffd||fffd||fffd||fffd|").Range("A1:BB" & Worksheets("|fffd||fffd||fffd||fffd|").UsedRange.Rows.Count)
  'Set cur_pr = Worksheets("|fffd||fffd||fffd||fffd|").Range("A1:BB500")
    n = 1
    nn = n
   
    For i = 2 To cur_pr.Rows.Count
      If cur_pr(i, 2) <> "" Then   ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
       Set ctrl(n) = myMenuBar.Controls.Add(Type:=msoControlPopup, Temporary:=True)
        ctrl(n).Caption = cur_pr(i, 2)
        ctrl(n).TooltipText = cur_pr(i, 2)
      name_menu_1st_level = cur_pr(i, 2)
        n = n + 1
    End If
     ctrl(nn).BeginGroup = True
    
     If cur_pr(i, 3) <> "" Then   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd||fffd|
            Set ctrl(n) = myMenuBar.Controls(name_menu_1st_level).Controls.Add(Type:=msoControlButton, Temporary:=True)
            ctrl(n).Caption = cur_pr(i, 3) & ":      " & cur_pr(i, 7) & "|fffd||fffd||fffd||fffd|, |fffd|=" & cur_pr(i, 4) & ", |fffd|=" & cur_pr(i, 5) & ", |fffd|=" & cur_pr(i, 6)
            ctrl(n).TooltipText = cur_pr(i, 3)
            ctrl(n).OnAction = "write_down_product"
            ctrl(n).Parameter = cur_pr(i, 3) & ";" & cur_pr(i, 4) & ";" & cur_pr(i, 5) & ";" & cur_pr(i, 6) & ";" & cur_pr(i, 7) _
            & ";" & cur_pr(i, 8) & ";" & cur_pr(i, 9) & ";" & cur_pr(i, 10) & ";" & cur_pr(i, 11) & ";" & cur_pr(i, 12)
           n = n + 1
    End If
    Next i
 
menu2:
 
 End Sub
 
 
 Sub write_down_product()
 
  Dim arg As Variant
 arg = Split(CommandBars.ActionControl.Parameter, ";")
    
      Worksheets(sheet_calc_food_name).Unprotect Password:=aaa
      On Error GoTo ERR_write_down_product
 ' ----------------- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| -------------------------
  i1 = 7 ' |fffd||fffd||fffd||fffd| 1-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd|
  For i1 = 1 To 100
   If (Cells(i1, 1) = 1) Or (Cells(i1, 1) = "1") Then
       Exit For
   End If
  Next i1
  
 i2 = 55
 stolb = 5
  
 For i2 = 6 To 200
   my_formula = Cells(i2, stolb).Formula
    If InStr(my_formula, ":") <> 0 Then
      Exit For
    End If
 Next i2
  
       n = ActiveCell.Row
      fl = (n < i1) Or (n >= i2)

 If fl Then ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
      MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", , "LMS"
 Else ' |fffd||fffd||fffd| |fffd||fffd|
  'oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
  
      Cells(n, product_column).Select  ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      Cells(n, product_column) = arg(0) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
'    ActiveCell.FormulaR1C1 = "=1.45*RC[-2]/100"
        
  For i = 1 To 9
    If (arg(i) = "") Or (arg(i) = "-") Then  ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       my_formula = ""
    Else
       my_formula = "=" & 1 * arg(i) & "*RC[-" & i & "]/100"
    End If
          
    If InStr(1 / 2, ",") = 0 Then 'Application.DecimalSeparator = "." Then
      Cells(n, Proteins_column + i - 1).FormulaR1C1 = my_formula
    Else ' ","
      Cells(n, Proteins_column + i - 1).FormulaR1C1 = Replace(my_formula, ",", ".")
    End If
    
  Next i
    
'oooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooooo
  End If
   
ERR_write_down_product:
       Worksheets(sheet_calc_food_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingRows:=True, _
        AllowInsertingHyperlinks:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
   
 End Sub
 
 
 Sub Write_daily_nutrition()
   Set cur_calc_nutrition = Worksheets(sheet_calc_food_name).Range("A1:BB1000")
   Set cur_eda_farma = Worksheets(sheet_food_kurs).Range("A1:DD5000")

   my_date = Worksheets(sheet_calc_food_name).Range(adr_date_calc_nutr_name)
   
   Worksheets(sheet_calc_food_name).Unprotect Password:=aaa
   On Error GoTo ERR_write_d_n
   
   i = 2
   fl = True ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
 Do While (cur_eda_farma(i, date_column_t) <> "")  ' Or (cur_eda_farma(i, date_column_t) <> my_date)
   If my_date = cur_eda_farma(i, date_column_t) Then
    fl = False
    Exit Do
   End If
     i = i + 1
 Loop
 
 n_str = i
  
  If fl Then ' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    Msg = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd|"" |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd|"" |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|."
    Style = vbOK
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    Exit Sub
 End If
   
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd| |fffd|.|fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    fl = False
    
    fl = (cur_eda_farma(n_str, BW_column_t) <> "") Or (cur_eda_farma(n_str, prot_column_t) <> "") Or (cur_eda_farma(n_str, fat_column_t) <> "") Or _
         (cur_eda_farma(n_str, carb_column_t) <> "") Or (cur_eda_farma(n_str, ccal_column_t) <> "") Or (cur_eda_farma(n_str, GI_column_t) <> "") Or _
         (cur_eda_farma(n_str, prot_an_column_t) <> "") Or (cur_eda_farma(n_str, fat_an_column_t) <> "") Or (cur_eda_farma(n_str, fat_pl_column_t) <> "")
            
 If fl Then
    Msg = "|fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|) |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd|)?"    ' Define message.
    Style = vbYesNo   ' Define buttons.
    Title = "LMS"
    Response = MsgBox(Msg, Style, Title)
    If Response = vbNo Then     ' |fffd||fffd||fffd||fffd||fffd|
       Exit Sub
    End If
 End If
 
 cur_eda_farma(n_str, BW_column_t) = Worksheets(sheet_calc_food_name).Range(adr_weigth_calc_nutr_name)
  
' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|

 i2 = 55
 stolb = 5
 
 For i2 = 1 To 200
   my_formula = Cells(i2, stolb).Formula
    If InStr(my_formula, ":") <> 0 Then
      Exit For
    End If
 Next i2

  cur_eda_farma(n_str, prot_column_t) = cur_calc_nutrition(i2, Proteins_column + 0)
  cur_eda_farma(n_str, fat_column_t) = cur_calc_nutrition(i2, Proteins_column + 1)
  cur_eda_farma(n_str, carb_column_t) = cur_calc_nutrition(i2, Proteins_column + 2)
  cur_eda_farma(n_str, ccal_column_t) = cur_calc_nutrition(i2, Proteins_column + 3)
  
  cur_eda_farma(n_str, GI_column_t) = cur_calc_nutrition(i2, Proteins_column + 4)
  cur_eda_farma(n_str, prot_an_column_t) = cur_calc_nutrition(i2, Proteins_column + 5)
  cur_eda_farma(n_str, fat_an_column_t) = cur_calc_nutrition(i2, Proteins_column + 7)
  cur_eda_farma(n_str, fat_pl_column_t) = cur_calc_nutrition(i2, Proteins_column + 8)
 
 Worksheets(sheet_food_kurs).Select
 cur_eda_farma(n_str, BW_column_t).Select
 
ERR_write_d_n:
        Worksheets(sheet_food_kurs).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    Worksheets(sheet_food_kurs).EnableOutlining = True ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   
 End Sub
 
 
Sub p_r_o_t_e_c_t__worksheets()

 On Error GoTo ERR_protect

     Worksheets("|fffd||fffd||fffd||fffd|").Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingRows:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingRows:=True, AllowSorting:= _
        True, AllowFiltering:=True, AllowUsingPivotTables:=True
        
    Worksheets("|fffd||fffd||fffd|").Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingRows:=True, _
        AllowInsertingHyperlinks:=True, AllowDeletingRows:=True, AllowSorting:= _
        True, AllowFiltering:=True, AllowUsingPivotTables:=True
        
    Worksheets(sheet_info).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
        
    Worksheets("2 |fffd| |fffd||fffd||fffd||fffd|").Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
        
      Worksheets(sheet_graphics_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, AllowFormattingRows:=True
        
    Worksheets(sheet_calc_food_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, _
        AllowInsertingHyperlinks:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
        
    Worksheets(sheet_food_kurs).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    Worksheets(sheet_food_kurs).EnableOutlining = True ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                
       Worksheets(sheet_reports_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
                     
       Worksheets(sheet_F).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowInsertingHyperlinks:=True, AllowUsingPivotTables:=True
                                     
       Worksheets(sheet_exercise_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
                
                   
      Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
                         
ERR_protect:
     
End Sub
 
'Sub u_n_p_r_o_t_e_c_t__worksheets()
'
'   Worksheets("|fffd||fffd||fffd||fffd|").Unprotect Password:=aaa
'   Worksheets("|fffd||fffd||fffd|").Unprotect Password:=aaa
'   Worksheets(sheet_info).Unprotect Password:=aaa
'   Worksheets("2 |fffd| |fffd||fffd||fffd||fffd|").Unprotect Password:=aaa
'
'   Worksheets(sheet_graphics_name).Unprotect Password:=aaa
'   Worksheets(sheet_calc_food_name).Unprotect Password:=aaa
'   Worksheets(sheet_food_kurs).Unprotect Password:=aaa
'
'   Worksheets(sheet_reports_name).Unprotect Password:=aaa
'
'   Worksheets(sheet_F).Unprotect Password:=aaa
'   Worksheets(sheet_exercise_name).Unprotect Password:=aaa
'   Worksheets(sheet_cycle_name).Unprotect Password:=aaa
'
'End Sub



 
 
 
 
 
 
 
 
 
 
 


Attribute VB_Name = "Vadim_5"
  Public Const adr_1st_cycle = "N30" ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
  Public Const adr_qty_cycle = "N31" ' |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd|
  
  Public Const adr_napr_KPS = "N32"
  Public Const adr_kol_shagov_KPS_vniz = "N33"
  Public Const adr_kol_shagov_KPS_vverh = "N34"
  Public Const adr_shag_proc_KPS_vniz = "N35"
  Public Const adr_shag_proc_KPS_vverh = "N36"
  Public Const adr_KPS_0 = "N37"
  
  Public Const adr_shag_proc_w_sr_vniz = "T35"
  Public Const adr_shag_proc_w_sr_vverh = "T36"
  Public Const adr_w_sr_0 = "T37"
  
  Public Const KPS_table_1st_column = 15
  Public Const KPS_table_1st_row = 44

  Public Const sheet_info = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"   ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  
  
  Sub fill_estimated_KPS_w_sr()
  
    On Error GoTo ERR_fill_estimated_KPS
    Worksheets(sheet_info).Unprotect Password:=aaa
    adr = ActiveCell.Address
    
   Set cur = Worksheets(sheet_info).Range(get_ch(KPS_table_1st_column) & KPS_table_1st_row & ":CC1000")
   napr_KPS = Worksheets(sheet_info).Range(adr_napr_KPS)
   kol_shagov_KPS_vniz = Worksheets(sheet_info).Range(adr_kol_shagov_KPS_vniz)
   kol_shagov_KPS_vverh = Worksheets(sheet_info).Range(adr_kol_shagov_KPS_vverh)
   cycle_1st = Worksheets(sheet_info).Range(adr_1st_cycle)
   qty_cycle = Worksheets(sheet_info).Range(adr_qty_cycle)
   
   
   shag_proc_w_sr_vniz = Worksheets(sheet_info).Range(adr_shag_proc_w_sr_vniz)
   shag_proc_w_sr_vverh = Worksheets(sheet_info).Range(adr_shag_proc_w_sr_vverh)

   
   cycle_1st = IIf(cycle_1st = "", 1, cycle_1st)
   cycle_N = IIf(qty_cycle = "", max_qty_weeks, qty_cycle + cycle_1st - 1) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|

   shag_proc_KPS_vniz = Worksheets(sheet_info).Range(adr_shag_proc_KPS_vniz)
   shag_proc_KPS_vverh = Worksheets(sheet_info).Range(adr_shag_proc_KPS_vverh)
   
   KPS_0 = Worksheets(sheet_info).Range(adr_KPS_0)
   w_sr_0 = Worksheets(sheet_info).Range(adr_w_sr_0)
   
   cur(cycle_1st, 1) = KPS_0
   cur(cycle_1st, 2) = w_sr_0

  i = cycle_1st + 1
  fl_up = (StrComp(napr_KPS, "|fffd||fffd||fffd||fffd|") = 0)
  fl_up2 = (StrComp(napr_KPS, "|fffd||fffd||fffd||fffd|") = 0)
  
  pr_delta_vverh = shag_proc_KPS_vverh / (kol_shagov_KPS_vverh * 1.3)
  pr_delta_vniz = shag_proc_KPS_vniz / (kol_shagov_KPS_vniz * 1.5)
  
  pr_delta_vverh2 = shag_proc_w_sr_vverh / (kol_shagov_KPS_vniz * 1.5)
  pr_delta_vniz2 = shag_proc_w_sr_vniz / (kol_shagov_KPS_vverh * 1.3)
  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
  qty_up = 0: qty_down = 0
  qty_up2 = 0: qty_down2 = 0
  
While i <= cycle_N

'------------------------------------ |fffd||fffd||fffd| -------------------------------
  If fl_up Then
   '  cur(i, 1) = Round(cur(i - 1, 1) * (1 + shag_proc_KPS_vverh - pr_delta_vverh * qty_up), 0)
      cur(i, 1) = Round(cur(i - 1, 1) + KPS_0 * (shag_proc_KPS_vverh - 1 * pr_delta_vverh * qty_up), 0)
      
     qty_up = qty_up + 1
     If qty_up >= kol_shagov_KPS_vverh Then
      fl_up = False
      qty_up = 0
     End If
  Else
 '   cur(i, 1) = Round(cur(i - 1, 1) * (1 - shag_proc_KPS_vniz + pr_delta_vniz * (kol_shagov_KPS_vniz - qty_down - 1)), 0)
      cur(i, 1) = Round(cur(i - 1, 1) - KPS_0 * (shag_proc_KPS_vniz - 1 * pr_delta_vniz * (kol_shagov_KPS_vniz - qty_down)), 0)
      
    qty_down = qty_down + 1
     If qty_down >= kol_shagov_KPS_vniz Then
      fl_up = True
      qty_down = 0
     End If
  End If

'------------------------------------ |fffd||fffd| |fffd||fffd||fffd| -------------------------------
  If fl_up2 Then

      cur(i, 2) = Round(cur(i - 1, 2) + w_sr_0 * (shag_proc_w_sr_vverh - 1 * pr_delta_vverh2 * qty_up2), 1)
      
     qty_up2 = qty_up2 + 1
     If qty_up2 >= kol_shagov_KPS_vniz Then
      fl_up2 = False
      qty_up2 = 0
     End If
  Else

      cur(i, 2) = Round(cur(i - 1, 2) - w_sr_0 * (shag_proc_w_sr_vniz - 1 * pr_delta_vniz2 * (kol_shagov_KPS_vverh - qty_down2)), 1) ' !!! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
      
    qty_down2 = qty_down2 + 1
     If qty_down2 >= kol_shagov_KPS_vverh Then
      fl_up2 = True
      qty_down2 = 0
     End If
  End If


   i = i + 1
Wend

'  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     KPS_max = 0
     KPS_min = 100000
     w_sr_max = 0
     w_sr_min = 100000
     T_max = 0
     T_min = 100000
     
   For i = 1 To max_qty_weeks
    If cur(i, 1) <> "" Then
       KPS_min = IIf(cur(i, 1) < KPS_min, cur(i, 1), KPS_min)
       KPS_max = IIf(cur(i, 1) > KPS_max, cur(i, 1), KPS_max)
       w_sr_min = IIf(cur(i, 2) < w_sr_min, cur(i, 2), w_sr_min)
       w_sr_max = IIf(cur(i, 2) > w_sr_max, cur(i, 2), w_sr_max)
       T_min = IIf(cur(i, 3) < T_min, cur(i, 3), T_min)
       T_max = IIf(cur(i, 3) > T_max, cur(i, 3), T_max)
    End If
   Next i
   
     Worksheets(sheet_info).ChartObjects("|fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|").Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((KPS_max + 20) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((KPS_min - 20) / 10, 0)
     
     Worksheets(sheet_info).ChartObjects("w_|fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|").Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp((w_sr_max + 2.5), 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown((w_sr_min - 2.5), 0)
     
     Worksheets(sheet_info).ChartObjects("|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|").Activate
     ActiveChart.Axes(xlValue).MaximumScale = 1000 * WorksheetFunction.RoundUp((T_max + 700) / 1000, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 1000 * WorksheetFunction.RoundDown((T_min - 100) / 1000, 0)
     
ERR_fill_estimated_KPS:

    Worksheets(sheet_info).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:=False
    Range(adr).Select

 End Sub
 
 
 Sub scaling_KPS_w_sr_sheet_cycle()
  
   adr = ActiveCell.Address
    On Error GoTo ERR_scaling_KPS_sheet_cycle
    Worksheets(sheet_cycle_name).Unprotect Password:=aaa
    
   Set cur = Worksheets(sheet_info).Range(get_ch(KPS_table_1st_column) & KPS_table_1st_row & ":CC1000")
     KPS_max = 0
     KPS_min = 100000
    w_sr_max = 0
    w_sr_min = 100000
   
   Worksheets(sheet_cycle_name).ChartObjects(name_graph_KPS).Activate
   x_max = ActiveChart.Axes(xlCategory).MaximumScale
   
   For i = 1 To x_max
    If cur(i, 1) <> "" Then
       KPS_min = IIf(cur(i, 1) < KPS_min, cur(i, 1), KPS_min)
       KPS_max = IIf(cur(i, 1) > KPS_max, cur(i, 1), KPS_max)
       w_sr_min = IIf(cur(i, 2) < w_sr_min, cur(i, 2), w_sr_min)
       w_sr_max = IIf(cur(i, 2) > w_sr_max, cur(i, 2), w_sr_max)
    End If
   Next i

  If KPS_max <> 0 Then  '|fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
      Worksheets(sheet_cycle_name).ChartObjects(name_graph_KPS).Activate
     ActiveChart.Axes(xlValue).MaximumScale = 10 * WorksheetFunction.RoundUp((KPS_max + 5) / 10, 0)
     ActiveChart.Axes(xlValue).MinimumScale = 10 * WorksheetFunction.RoundDown((KPS_min - 5) / 10, 0)
     
      Worksheets(sheet_cycle_name).ChartObjects(name_graph_w_sr).Activate
     ActiveChart.Axes(xlValue).MaximumScale = WorksheetFunction.RoundUp(w_sr_max + 2.5, 0)
     ActiveChart.Axes(xlValue).MinimumScale = WorksheetFunction.RoundDown(w_sr_min - 2.5, 0)
     
  End If
   
ERR_scaling_KPS_sheet_cycle:
       Worksheets(sheet_cycle_name).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
      False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
      AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
        Range(adr).Select
      
 End Sub
 
 
 
 
 
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Button_Correct_Time_Parameters, 1, 0, MSForms, CommandButton"
Private Sub Button_Correct_Time_Parameters_Click()
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

  Call correct_time

' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Button_Clear_food, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "Button_Write_daily_nutrition, 1, 1, MSForms, CommandButton"

Private Sub Button_Clear_food_Click()
 Range("B7:M56").ClearContents
End Sub

Private Sub Button_Write_daily_nutrition_Click()
  Call Write_daily_nutrition
End Sub



Private Sub Worksheet_Activate()
 Call menu_calculator_of_food
End Sub

Private Sub Worksheet_Deactivate()
  Dim myMenuBar As CommandBar
  Set myMenuBar = Application.CommandBars("Cell")
  myMenuBar.Reset
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
    
    Worksheets(sheet_food_kurs).Unprotect Password:=aaa
    
    Worksheets(sheet_food_kurs).Protect Password:=aaa, UserInterfaceOnly:=True, DrawingObjects:=False, Contents:=True, Scenarios:= _
        False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True, AllowFiltering:=True, AllowUsingPivotTables:=True
    
    Worksheets(sheet_food_kurs).EnableOutlining = True ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Button_fill_in_plan, 2, 0, MSForms, CommandButton"
Private Sub Button_fill_in_plan_Click()
 Call write_ex_to_cycle
End Sub

Private Sub Worksheet_Activate()
 Call menu_sheet_exercise
End Sub


Private Sub Worksheet_Deactivate()
  Dim myMenuBar As CommandBar
  Set myMenuBar = Application.CommandBars("Cell")
  myMenuBar.Reset
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Button_fill_KPS, 2, 0, MSForms, CommandButton"
Private Sub Button_fill_KPS_Click()
  Call fill_estimated_KPS_w_sr
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()

 Call menu_sheet_cycle
 Call scaling_KPS_w_sr_sheet_cycle

End Sub



Private Sub Worksheet_Deactivate()
  Dim myMenuBar As CommandBar
  Set myMenuBar = Application.CommandBars("Cell")
  myMenuBar.Reset
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()
 Call menu_sheet_graphics
End Sub


Private Sub Worksheet_Deactivate()
  Dim myMenuBar As CommandBar
  Set myMenuBar = Application.CommandBars("Cell")
  myMenuBar.Reset
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
   UserForm1.Show
  
    Call p_r_o_t_e_c_t__worksheets
    
   If StrComp(ActiveSheet.Name, sheet_cycle_name) = 0 Then
     Call menu_sheet_cycle
   End If
   
   If StrComp(ActiveSheet.Name, sheet_exercise_name) = 0 Then
    Call menu_sheet_exercise
   End If
   
   If StrComp(ActiveSheet.Name, sheet_graphics_name) = 0 Then
     Call menu_sheet_graphics
   End If
   
  If StrComp(ActiveSheet.Name, sheet_calc_food_name) = 0 Then
    Call menu_calculator_of_food
  End If
    
    
    
End Sub





INQUEST-PP=macro
