Attribute VB_Name = "Article_39"
Attribute VB_Base = "0{CBD8BAB6-6800-4EC4-8A8D-80E3D4CBE55D}{E74483B0-232C-4284-B4E1-9C813B00256C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Bouton_cliquez_ici_39_Click()

With Feuille_Synth|fffd|se

If .Range("Fractionnement_art39").Value = "Annuel" Or .Range("Fractionnement_art39").Value = "Semestriel" Then
    MsgBox "L'outil n'|fffd|dite que les titres pour les rentes 39 mensuelles ou trimestrielles."
    Initialisation_Feuille_Synthese
    Article_39.Hide
    Unload Article_39
    Exit Sub

End If

.Range("Test_art39") = 1

End With

Article_39.Hide
Unload Article_39
     
Load Formulaire
Formulaire.Show

End Sub

Attribute VB_Name = "Article_83"
Attribute VB_Base = "0{A9DDC8E2-68C6-4FF4-88BA-B6D7FFF31847}{002AB782-DB68-49BC-97D6-4265F183D584}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Sub Ouverture_article_83()
 
    Call Initialisation_Feuille_Synthese

    Load Article_83

    Article_83.Show
 
End Sub
Private Sub Bouton_cliquez_ici_Click()

If Rte_82.Value = False And Rte_83.Value = False Then
    MsgBox "Veuillez choisir un type de rente"

Else:
    Article_83.Hide
    Unload Article_83
         
    Load Formulaire
    Formulaire.Show
End If
End Sub
Private Sub Rte_82_Click()

If Range("option_rente_art83").Value = "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s" Then
    MsgBox "V|fffd|rifiez l'option de rente choisie. L'option *Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s* n'est pas disponible pour les rentes 82"
    Article_83.Hide
    Unload Article_83
    Exit Sub
End If


If Rte_82.Value = True Then
    Rte_83.Value = False
    Range("Test_art83") = 82
Else: Range("Test_art83") = ""
End If

End Sub

Private Sub Rte_83_Click()

If Rte_83.Value = True Then
    Rte_82.Value = False
    Range("Test_art83") = 83
Else: Range("Test_art83") = ""
End If

End Sub
Attribute VB_Name = "Bar|fffd|me"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Bouton_Rte_bar, 1686, 2, MSForms, CommandButton"
Attribute VB_Control = "BouBaremeMenu, 1685, 3, MSForms, CommandButton"
Attribute VB_Control = "CacheAnticipation, 1588, 4, MSForms, Image"
Attribute VB_Control = "CacheFormule, 1589, 5, MSForms, Image"
Attribute VB_Control = "CacheLimiteAge, 1590, 6, MSForms, Image"
Attribute VB_Control = "Formule, 1681, 7, MSForms, CheckBox"
Attribute VB_Control = "CacheDateProro, 1620, 8, MSForms, Image"
Attribute VB_Control = "LimiteAge, 1678, 9, MSForms, CheckBox"
Attribute VB_Control = "CachePM, 1616, 10, MSForms, Image"
Attribute VB_Control = "CachePensionSS, 1591, 11, MSForms, Image"
Attribute VB_Control = "LanceCCR, 973, 12, MSForms, CommandButton"
Attribute VB_Control = "LanceAxe3, 132, 13, MSForms, CommandButton"
Attribute VB_Control = "LanceIBM, 107, 14, MSForms, CommandButton"
Attribute VB_Control = "LanceHopitauxStMarie, 106, 15, MSForms, CommandButton"
Attribute VB_Control = "CachePrime2, 105, 16, MSForms, Image"
Attribute VB_Control = "CacheCoefRed2, 104, 17, MSForms, Image"
Attribute VB_Control = "CacheContrAssurance, 29, 18, MSForms, Image"
Attribute VB_Control = "CacheRappelContrAss, 103, 19, MSForms, Image"
Attribute VB_Control = "CacheNbAnAmmort, 99, 20, MSForms, Image"
Attribute VB_Control = "NbAnAmmort, 98, 21, MSForms, ComboBox"
Attribute VB_Control = "CachePrime, 96, 22, MSForms, Image"
Attribute VB_Control = "Sexe, 93, 23, MSForms, ComboBox"
Attribute VB_Control = "CommandButton1, 92, 24, MSForms, CommandButton"
Attribute VB_Control = "EtatCjt, 83, 25, MSForms, CommandButton"
Attribute VB_Control = "CacheRevTitre, 76, 26, MSForms, Image"
Attribute VB_Control = "CacheTxDiff, 80, 27, MSForms, Image"
Attribute VB_Control = "ContrAssurance, 78, 28, MSForms, ComboBox"
Attribute VB_Control = "CacheAnnuit|fffd|Rev, 77, 29, MSForms, Image"
Attribute VB_Control = "CachePartTitre, 75, 30, MSForms, Image"
Attribute VB_Control = "Image4, 73, 31, MSForms, Image"
Attribute VB_Control = "CacheTerme, 49, 32, MSForms, Image"
Attribute VB_Control = "CacheRteImm|fffd|diate, 48, 33, MSForms, Image"
Attribute VB_Control = "CacheCoefR|fffd|duc, 35, 34, MSForms, Image"
Attribute VB_Control = "CacheModificationAge3, 34, 35, MSForms, Image"
Attribute VB_Control = "CacheModificationAge2, 33, 36, MSForms, Image"
Attribute VB_Control = "CacheModificationAge1, 32, 37, MSForms, Image"
Attribute VB_Control = "ModificationAge, 31, 38, MSForms, CheckBox"
Attribute VB_Control = "CbBox_ProrogAnticip, 30, 39, MSForms, ComboBox"
Attribute VB_Control = "CacheProrataD|fffd|c|fffd|s, 26, 40, MSForms, Image"
Attribute VB_Control = "CacheParticularit|fffd|s, 25, 41, MSForms, Image"
Attribute VB_Control = "CacheR|fffd|version2, 24, 42, MSForms, Image"
Attribute VB_Control = "CacheR|fffd|version1, 23, 43, MSForms, Image"
Attribute VB_Control = "ProrataD|fffd|c|fffd|s, 15, 44, MSForms, ComboBox"
Attribute VB_Control = "ApproxAge, 14, 45, MSForms, ComboBox"
Attribute VB_Control = "Fractionnement, 13, 46, MSForms, ComboBox"
Attribute VB_Control = "Terme, 12, 47, MSForms, ComboBox"
Attribute VB_Control = "Table, 11, 48, MSForms, ComboBox"
Attribute VB_Control = "Particularit|fffd|s, 9, 49, MSForms, CheckBox"
Attribute VB_Control = "ExistR|fffd|version2, 3, 50, MSForms, CheckBox"
Attribute VB_Control = "ExistR|fffd|version1, 2, 51, MSForms, CheckBox"
Attribute VB_Control = "TypeRente, 1683, 52, MSForms, ListBox"

Option Explicit

Private Sub CmdImprimer_Click()
ActiveWindow.SelectedSheets.PrintOut Copies:=1
End Sub

Private Sub BouBaremeMenu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
Bar|fffd|me.Visible = False
wMajoLeg.Visible = 2
End Sub


Sub Bouton_Rte_bar_Click()

Call Initialisation_Feuille_Synthese

If TypeRente.Value = "RVI (rente viag|fffd|re imm|fffd|diate)" Then
 
 If Range("TxCroissRte70_75").Value <> 0 Then MsgBox "Attention |fffd| bien saisir le montant MACAO dans le titre de rente LEA en cas d'|fffd|cart"
 Load Choix_rente_bareme
 Choix_rente_bareme.Show

Else:
MsgBox "L'|fffd|dition du titre de rente est uniquement disponible pour la RVI"

End If

Exit Sub 'pas hyper utile

End Sub

Private Sub ContrAssurance_Change()
Range("ContrAss").Value = Bar|fffd|me.ContrAssurance.Value
Select Case Range("ContrAss").Value
Case "Avec": Shapes("CacheRappelContrAss").Visible = False
Case "Sans": Shapes("CacheRappelContrAss").Visible = True
             Bar|fffd|me.Range("O26").Value = ""
End Select
End Sub

Private Sub EtatCjt_Click()
Select Case EtatCjt.Caption
Case "Assur|fffd| : divorc|fffd| et remari|fffd|"
  EtatCjt.Caption = "Assur|fffd| : divorc|fffd| deux fois"
  StatutCjts = "Assur|fffd| : divorc|fffd| deux fois"
  Range("C10").Value = "Date de naissance de l'ex-conjoint 1"
  Range("C14").Value = "Date de naissance de l'ex-conjoint 2"
  Range("D15").Value = "avec l'ex-conjoint 1"
  Range("D16").Value = "avec l'ex-conjoint 2"
Case "Assur|fffd| : divorc|fffd| deux fois"
  EtatCjt.Caption = "Assur|fffd| : divorc|fffd| et remari|fffd|"
  StatutCjts = "Assur|fffd| : divorc|fffd| et remari|fffd|"
  Range("C10").Value = "Date de naissance du conjoint actuel"
  Range("C14").Value = "Date de naissance de l'ex-conjoint"
  Range("D15").Value = "avec le conjoint actuel"
  Range("D16").Value = "avec l'ex-conjoint"
End Select
End Sub

Private Sub LanceAxe3_Click()
'MsgBox "Page en construction - non valid|fffd|e |fffd| ce stade"
wAxe3.Visible = True
wAxe3.Select
'wAxe3.Range("F12:F100").ClearContents
wAxe3.Range("AxeDerniereRenteFinal").Value = ""
Bar|fffd|me.Visible = False
wMajoLeg.Visible = False
End Sub

Private Sub LanceCCR_Click()
wCCR.Visible = True
wCCR.Activate
wCCR.Range("RenteBruteCCR").Value = Bar|fffd|me.Range("Rente83").Value
End Sub

Private Sub LanceHopitauxStMarie_Click()
ContratAHSM.Show
wMajoLeg.Visible = False
End Sub

Private Sub LanceIBM_Click()
Worksheets("CalcIBM").Visible = True
Worksheets("CalcIBM").Select
Bar|fffd|me.Visible = False
Worksheets("MajoLeg").Visible = False
End Sub

Private Sub NbAnAmmort_Change()
Range("NbAmmort").Value = Bar|fffd|me.NbAnAmmort.Value
End Sub

Private Sub Sexe_Change()
Range("Sexe").Value = Bar|fffd|me.Sexe.Value
Call MajAnnuit|fffd|
End Sub

Private Sub Table_Change()
Range("Table").Value = Bar|fffd|me.Table.Value
If Table = "TPG+x/15.TGHF05" Or Table = "TV+x/7.TPG" Then
  Shapes("CacheNbAnAmmort").Visible = False
Else
  Shapes("CacheNbAnAmmort").Visible = True
End If
Call MajAnnuit|fffd|
End Sub

Private Sub TypeRente_Click()
Select Case TypeRente.Value
Case "RVI (rente viag|fffd|re imm|fffd|diate)"
  Range("ChoixRente").Value = 1
  Range("I6").Value = "Date d'effet de la rente"
  Range("I8").Value = "Date de retrait des fonds"
  Range("I24").Value = "Age assur|fffd|(s) |fffd| date d'effet rente"
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 0 Then Shapes("CachePartTitre").Visible = False
  Shapes("CacheRevTitre").Visible = False
  Shapes("CacheTxDiff").Visible = True
  'Shapes("EtatCjt").Visible = True
  ModificationAge.Value = False
  ModificationAge.Visible = False
  Shapes("CacheModificationAge1").Visible = True
  Shapes("CacheModificationAge2").Visible = True
  Shapes("CacheModificationAge3").Visible = True
Case "RVD (rente viag|fffd|re diff|fffd|r|fffd|e)"
  Range("TxFraisDiff").Value = 0.00075 ' Ajout 18/12/17
  Range("TxFraisRente").Value = 0.03 'Ajout 18/12/17
  Range("ChoixRente").Value = 2
  Range("I6").Value = "Date d'|fffd|ch|fffd|ance de la rente"
  Range("I8").Value = "Date de calcul de la prov. ou du CC"
  If Not Bar|fffd|me.ModificationAge Then
    Range("I24").Value = "Age assur|fffd|(s) |fffd| date de calcul"
  Else
    Range("I24").Value = "Age de l'assur|fffd| |fffd| date d'effet rente"
  End If
  Shapes("CachePartTitre").Visible = True
  Shapes("CacheRevTitre").Visible = False
  Shapes("CacheTxDiff").Visible = False
  'Shapes("EtatCjt").Visible = False
  ModificationAge.Visible = True
Case "Capi Fi Transfo Imm|fffd|diate"
  Range("ChoixRente").Value = 3
  Range("TxFraisDiff").Value = 0.00075 ' Ajout 18/12/17
  Range("TxFraisRente").Value = 0.03 'Ajout 18/12/17
  Range("I6").Value = "Date d'|fffd|ch|fffd|ance de la rente"
  Range("I8").Value = "Date de calcul de la prov. ou du CC"
  If Not Bar|fffd|me.ModificationAge Then
    Range("I24").Value = "Age assur|fffd|(s) |fffd| date de calcul"
  Else
    Range("I24").Value = "Age de l'assur|fffd| |fffd| date d'effet rente"
  End If
  Shapes("CachePartTitre").Visible = True
  Shapes("CacheRevTitre").Visible = False
  Shapes("CacheTxDiff").Visible = False
  'Shapes("EtatCjt").Visible = False
  ModificationAge.Visible = True
Case "RTI (rente temporaire imm|fffd|diate)"
  Range("ChoixRente").Value = 3
  Range("I6").Value = "Date d'effet de la rente"
  Range("I8").Value = "Date de retrait des fonds"
  Range("I24").Value = "Age assur|fffd|(s) |fffd| date d'effet rente"
  Shapes("CachePartTitre").Visible = True
  Shapes("CacheRevTitre").Visible = False
  Shapes("CacheTxDiff").Visible = True
  ModificationAge.Value = False
  ModificationAge.Visible = False
  Shapes("CacheModificationAge1").Visible = True
  Shapes("CacheModificationAge2").Visible = True
  Shapes("CacheModificationAge3").Visible = True
End Select
Call CqChoixRente
End Sub

Private Sub Worksheet_Activate()
Bar|fffd|me.TypeRente.Left = 736
Bar|fffd|me.TypeRente.Top = 119
Bar|fffd|me.TypeRente.Width = 150
Bar|fffd|me.TypeRente.Height = 42
Bar|fffd|me.TypeRente.FontSize = 10
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
If Not Ouverture Then Call MajAnnuit|fffd|
End Sub

Private Sub ApproxAge_Change()
Dim Txt As String
Range("ApproxAge").Value = Bar|fffd|me.ApproxAge.Value
Call MajAnnuit|fffd|
Select Case Range("ApproxAge").Value
Case "Age entier le + proche": Txt = "Exemple : un |fffd|ge de 62,57 sera arrondi |fffd| 63 ans"
Case "Semest. + proche": Txt = "Exemple : un |fffd|ge de 62,57 sera arrondi |fffd| 62,5 ans"
Case "Trim + proche": Txt = "Exemple : un |fffd|ge de 62,71 sera arrondi |fffd| 62,75 ans"
Case "Mois + proche": Txt = "Exemple : un |fffd|ge de 62,64 sera arrondi |fffd| 62,666666666666 ans"
Case "Age exact": Txt = "Exemple : l'|fffd|ge est pris en calcul exact, sans aucun arrondi"
Case "Age entier atteint": Txt = "Exemple : un |fffd|ge de 62,57 sera arrondi |fffd| 62 ans"
Case "Semest. atteint": Txt = "Exemple : un |fffd|ge de 62,57 sera arrondi |fffd| 62 ans"
Case "Trim atteint": Txt = "Exemple : un |fffd|ge de 62,98 sera arrondi |fffd| 62,75 ans"
Case "Mois atteint": Txt = "Exemple : un |fffd|ge de 62,68 sera arrondi |fffd| 62,666666666666 ans"
Case Else: Txt = "Valeur non pr|fffd|vue - contacter l'administrateur !"
End Select
If Utilisateur = "Gestion" Then
  Call MsgBox(Txt, vbOKOnly, "Cons|fffd|quence du choix de cette option")
End If
End Sub

Private Sub CbBox_ProrogAnticip_Change()
Range("ProrogAnticip").Value = Bar|fffd|me.CbBox_ProrogAnticip.Value
Call MajAnnuit|fffd|
End Sub

'puce de la r|fffd|version
Private Sub ExistR|fffd|version1_Click()
On Error Resume Next
Select Case ExistR|fffd|version1
Case False
  Bar|fffd|me.Range("ExistR|fffd|version1").Value = 0
  If TypeRente.Value = "RVD (rente viag|fffd|re diff|fffd|r|fffd|e)" Or TypeRente.Value = "Capi Fi Transfo Imm|fffd|diate" Then
    ModificationAge.Visible = True
  End If
  If TypeRente.Value = "RVI (rente viag|fffd|re imm|fffd|diate)" Then
    Shapes("CachePartTitre").Visible = False
  End If
  Range("TxRev").Value = 0
  Shapes("CacheR|fffd|version1").Visible = True
  Shapes("CacheCoefRed2").Visible = True
  Shapes("ExistR|fffd|version2").Visible = False
  Shapes("EtatCjt").Visible = False
  If Not Particularit|fffd|s Then Shapes("CacheCoefR|fffd|duc").Visible = True
  Range("Annuit|fffd|").Select
  Shapes("CacheAnnuit|fffd|Rev").Visible = True
Case True
  Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1
  If TypeRente.Value = "RVD (rente viag|fffd|re diff|fffd|r|fffd|e)" Or TypeRente.Value = "Capi Fi Transfo Imm|fffd|diate" Then
    ModificationAge.Visible = True 'False
  End If
  Range("LibDeuxT|fffd|tes").Value = "PRIME D'INVENTAIRE sur 2 t|fffd|tes"
  Range("TxCroissRte70_75").Value = 0
  Range("NbAnGar").Value = 0
  Shapes("CachePartTitre").Visible = True
  Shapes("CacheR|fffd|version1").Visible = False
  Shapes("CacheCoefRed2").Visible = False
  Shapes("ExistR|fffd|version2").Visible = True
  Shapes("EtatCjt").Visible = True
  Shapes("CacheCoefR|fffd|duc").Visible = False
  ExistR|fffd|version2 = False
  Range("TxRev").Select
  Shapes("CacheAnnuit|fffd|Rev").Visible = False
End Select
Call MajAnnuit|fffd|
End Sub

Private Sub ExistR|fffd|version2_Click()
Select Case Utilisateur
Case "Tech"
  Select Case ExistR|fffd|version2
  Case False
    Shapes("CacheR|fffd|version2").Visible = True
    Range("Annuit|fffd|").Select
    Range("LibDeuxT|fffd|tes").Value = "PRIME D'INVENTAIRE sur 2 t|fffd|tes"
    'EtatCjt.Visible = False
    Range("C10").Value = "Date de naissance du conjoint actuel"
    If EtatCjt.Caption = "Assur|fffd| : divorc|fffd| deux fois" Then
      Call EtatCjt_Click
    End If
  Case True
    If Not DjCjt2 Then MsgBox "Attention, pour des besoins de coh|fffd|rence avec Macao, cette option a |fffd|t|fffd| d|fffd|sactiv|fffd|e dans la version du logiciel mise |fffd| disposition |fffd| la gestion." & Chr(13) & Chr(13) & "Les rentes y sont liquid|fffd|es selon la r|fffd|gle qui consiste |fffd| retenir en unique conjoint LE PLUS JEUNE, sauf sp|fffd|cification contraire du contrat (ex : conjoint actuel, ...)."
    DjCjt2 = True
    Shapes("CacheR|fffd|version2").Visible = False
    Range("DateNaissY2").Select
    Range("LibDeuxT|fffd|tes").Value = "PRIME D'INVENTAIRE sur 3 t|fffd|tes"
    'EtatCjt.Visible = True
  End Select
Case Else
  If Not DjCjt2 Then MsgBox "Pour des besoins de coh|fffd|rence avec Macao, cette option n'est pas activ|fffd|e." & Chr(13) & Chr(13) & "La r|fffd|gle est de retenir en unique conjoint LE PLUS JEUNE, sauf sp|fffd|cification contraire du contrat (ex : conjoint actuel, ...)."
  DjCjt2 = True
  ExistR|fffd|version2 = False
End Select
Call MajAnnuit|fffd|
End Sub

Private Sub Fractionnement_Click()
Range("Fractionnement").Value = Bar|fffd|me.Fractionnement.Value
Call MajAnnuit|fffd|
End Sub


'- Ajout prorogation anticipation
Private Sub Formule_Click()
Dim vrch  As String
On Error GoTo Formule_Err
    If Formule.Value = True Then
        Sheets("Cartographie").Activate
        vrch = Application.VLookup(Bar|fffd|me.Range("RPP").Value, ActiveSheet.Range("a1", ActiveSheet.Range("g65536").End(xlUp)), 6, False)
    '   If IsError(Application.VLookup(Bar|fffd|me.Range("RPP").Value, Cartographie.Columns("A:G").Value, 6, False)) Then 'Range("A1:G4687")
        If IsError(vrch) Then ' Application.VLookup(Bar|fffd|me.Range("RPP").Value, ActiveSheet.Range("a1", ActiveSheet.Range("g65536").End(xlUp)), 6, False)) Then
            Formule.Value = False
            MsgBox ("Saisir la formule")
            Bar|fffd|me.Range("Formule").Value = ""
        Else
            Select Case vrch
            Case "CRP", "IC2"
              Bar|fffd|me.Range("Formule").Value = "ACT_LIQ"
            Case "Z03"
                Bar|fffd|me.Range("Formule").Value = "5% par an"
            Case "Z02"   'Then
                Bar|fffd|me.Range("Formule").Value = "2% par an"
            Case "Z04"  'Then
                Bar|fffd|me.Range("Formule").Value = "1.25% par an"
            Case Else
                Bar|fffd|me.Range("Formule").Value = vrch
            End Select
        End If
        Sheets("Bar|fffd|me").Activate
    End If
    Exit Sub
Formule_Err:
    If Err.Number <> 0 Then
        MsgBox "Veuillez saisir la formule pour cette RPP" '|fffd| revoir selon le type d'erreur
        Sheets("Bar|fffd|me").Activate
    End If
    
    Exit Sub
End Sub


'- ajout prorogation ancitipation
Private Sub LimiteAge_Click()
Dim vrch As String
On Error GoTo Formule_Err
    If LimiteAge.Value = True Then
        Sheets("Cartographie").Activate
        vrch = Application.VLookup(Bar|fffd|me.Range("RPP").Value, ActiveSheet.Range("a1", ActiveSheet.Range("g65536").End(xlUp)), 4, False)
        If IsError(vrch) Then
      ' If IsError(Application.VLookup(Bar|fffd|me.Range("RPP").Value, Cartographie.Columns("A:G").Value, 4, False)) Then
          LimiteAge.Value = False
          MsgBox ("Saisir l'|fffd|ge limite")
          Bar|fffd|me.Range("Age_limite_de_prorogation").Value = ""
        Else
          Bar|fffd|me.Range("Age_limite_de_prorogation").Value = vrch  ' Application.VLookup(Bar|fffd|me.Range("RPP").Value, Cartographie.Columns("A:G").Value, 4, False)
        End If
        Sheets("Bar|fffd|me").Activate
    Else
        Bar|fffd|me.Range("Age_limite_de_prorogation").Value = ""
    End If
Formule_Err:
    If Err.Number <> 0 Then
        MsgBox "Veuillez saisir l'|fffd|ge limite pour cette RPP" '|fffd| revoir selon le type d'erreur
        Sheets("Bar|fffd|me").Activate
    End If
    Exit Sub
End Sub


Private Sub ModificationAge_Click()
Select Case ModificationAge
Case False
  ExistR|fffd|version1.Visible = True
  Shapes("CacheModificationAge1").Visible = True
  Shapes("CacheModificationAge2").Visible = True
  Shapes("CacheModificationAge3").Visible = True
  Shapes("CachePrime2").Visible = True
  Shapes("CacheRappelContrAss").Visible = True
  Range("I8:K8").Select
  Selection.Font.ColorIndex = 0
  Range("K8").Select
  Selection.Interior.ColorIndex = 2
  Range("K6").Select
  Bar|fffd|me.Range("Age_limite_de_prorogation").Value = "" 'modif proro
  Bar|fffd|me.Range("Formule").Value = "" 'modif proro
  LimiteAge.Value = False 'modif proro
  Formule.Value = False 'modif proro
  
Case True
  ExistR|fffd|version1.Visible = True 'False
  Shapes("CacheModificationAge1").Visible = False
  Shapes("CacheModificationAge2").Visible = False
  Shapes("CacheModificationAge3").Visible = False
  Shapes("CachePrime2").Visible = False
  If Range("ContrAss").Value = "Avec" Then
    Shapes("CacheRappelContrAss").Visible = False
  End If
  Range("I8:K8").Select
  Selection.Font.ColorIndex = 2
  Range("K8").Select
  Selection.Interior.ColorIndex = 37
  Range("NbAnn|fffd|esModif").Select
End Select
Call MajAnnuit|fffd|
End Sub

Private Sub Particularit|fffd|s_Click()
Select Case Particularit|fffd|s
Case False
  Bar|fffd|me.Range("ChkParticularit|fffd|").Value = 0
  Shapes("CacheRevTitre").Visible = False
  Shapes("CacheParticularit|fffd|s").Visible = True
  Bar|fffd|me.Range("Annuit|fffd|").Select
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 0 Then Shapes("CacheCoefR|fffd|duc").Visible = True
    Shapes("CacheAnnuit|fffd|Rev").Visible = True

'-- on met |fffd| 0 les donn|fffd|es des options

Range("TxCroissRte70_75").Value = "0"
Range("NbAnGar").Value = "0"


Case True
  Bar|fffd|me.Range("ChkParticularit|fffd|").Value = 1
  Shapes("CacheRevTitre").Visible = True
  Shapes("CacheParticularit|fffd|s").Visible = False
  Bar|fffd|me.Range("TxCroissRte70_75").Select
  Shapes("CacheCoefR|fffd|duc").Visible = False
  Shapes("CacheAnnuit|fffd|Rev").Visible = False
  If Bar|fffd|me.Range("LibDeuxT|fffd|tes").Value <> "Dont PI annuit|fffd|s garanties" Then Bar|fffd|me.Range("LibDeuxT|fffd|tes").Value = "Dont PI annuit|fffd|s garanties"
End Select
Call MajAnnuit|fffd|
End Sub

Private Sub ProrataD|fffd|c|fffd|s_Change()
Range("ProrataD|fffd|c|fffd|s").Value = Bar|fffd|me.ProrataD|fffd|c|fffd|s.Value
Call MajAnnuit|fffd|
End Sub

Private Sub ChoixTable_Change()
Range("Table").Value = Bar|fffd|me.Table.Value
Call MajAnnuit|fffd|
End Sub

Private Sub Terme_Click()
Range("Terme").Value = Bar|fffd|me.Terme.Value
Select Case Range("Terme").Value
Case "Echu"
  Shapes("CacheProrataD|fffd|c|fffd|s").Visible = False
  Bar|fffd|me.Shapes("ProrataD|fffd|c|fffd|s").Visible = True
Case Else
  Shapes("CacheProrataD|fffd|c|fffd|s").Visible = True
  Bar|fffd|me.Shapes("ProrataD|fffd|c|fffd|s").Visible = False
End Select
Call MajAnnuit|fffd|
End Sub
Attribute VB_Name = "CPDependance"
Global NContrat As Double
Global Ref As Variant
Global Adre As String
Global FaitA1 As String

Sub ImprimCPDependance()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
NomChemin = ActiveWorkbook.Path

With AppWord
  Set DocWord = AppWord.Documents.Open(NomChemin & "\CP doublement retraite v2.doc", ReadOnly:=True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
  
  With .Selection
  
  DocWord.bookmarks("NumContrat").Select
        .TypeText Text:="" & NContrat
  DocWord.bookmarks("Reference").Select
        .TypeText Text:="" & Ref
    DocWord.bookmarks("Nom").Select
        .TypeText Text:="" & wArt83.Range("Art83NomX").Value
     DocWord.bookmarks("Prenom").Select
        .TypeText Text:="" & wArt83.Range("Art83PrenomX").Value
     DocWord.bookmarks("DateNaiss").Select
        .TypeText Text:="" & Format(wArt83.Range("Art83DateNaissX").Value, "dd mmmm yyyy")
    DocWord.bookmarks("Adresse").Select
        .TypeText Text:="" & Adre
         DocWord.bookmarks("DateEffet").Select
        .TypeText Text:="" & Format(wArt83.Range("Art83DateEffet").Value, "dd mmmm yyyy")
      DocWord.bookmarks("NumContrat1").Select
        .TypeText Text:="" & NContrat
      DocWord.bookmarks("Rente1").Select
        .TypeText Text:="" & Format(wArt83.Range("G50").Value, "# ###.00 ")
        
      DocWord.bookmarks("Rente2").Select
        .TypeText Text:="" & Format(wArt83.Range("G51").Value / wArt83.Range("D32"), "# ###.00 ")
        
      DocWord.bookmarks("Rente3").Select
        .TypeText Text:="" & Format(wArt83.Range("G51").Value, "# ###.00 ")
        
        DocWord.bookmarks("Rente4").Select
        .TypeText Text:="" & Format(wArt83.Range("G51").Value, "# ###.00 ")
        DocWord.bookmarks("Pourcentage").Select
        .TypeText Text:="" & Format(wArt83.Range("TarifDependance").Value, "#.00% ")
        DocWord.bookmarks("FaitA").Select
        .TypeText Text:="" & FaitA1
       DocWord.bookmarks("Date").Select
        .TypeText Text:="" & Format(Date, "dd mmmm yyyy")
        
End With
End With
End Sub

Sub ImprimArt39CPDependance()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
NomChemin = ActiveWorkbook.Path

With AppWord
  Set DocWord = AppWord.Documents.Open(NomChemin & "\CP doublement retraite v2.doc", ReadOnly:=True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
  
  With .Selection
  
  DocWord.bookmarks("NumContrat").Select
        .TypeText Text:="" & NContrat
  DocWord.bookmarks("Reference").Select
        .TypeText Text:="" & Ref
    DocWord.bookmarks("Nom").Select
        .TypeText Text:="" & wArt39.Range("Art39NomX").Value
     DocWord.bookmarks("Prenom").Select
        .TypeText Text:="" & wArt39.Range("Art39Pr|fffd|nomX").Value
     DocWord.bookmarks("DateNaiss").Select
        .TypeText Text:="" & Format(wArt39.Range("Art39DateNaissX").Value, "dd mmmm yyyy")
    DocWord.bookmarks("Adresse").Select
        .TypeText Text:="" & Adre
         DocWord.bookmarks("DateEffet").Select
        .TypeText Text:="" & Format(wArt39.Range("Art39DateEffet").Value, "dd mmmm yyyy")
      DocWord.bookmarks("NumContrat1").Select
        .TypeText Text:="" & NContrat
      DocWord.bookmarks("Rente1").Select
        .TypeText Text:="" & Format(wArt39.Range("G34").Value, "# ###.00 ")
        
      DocWord.bookmarks("Rente2").Select
        .TypeText Text:="" & Format(wArt39.Range("G37").Value / wArt39.Range("G39"), "# ###.00 ")
        
      DocWord.bookmarks("Rente3").Select
        .TypeText Text:="" & Format(wArt39.Range("G40").Value, "# ###.00 ")
        
        DocWord.bookmarks("Rente4").Select
        .TypeText Text:="" & Format(wArt39.Range("G37").Value, "# ###.00 ")
        DocWord.bookmarks("Pourcentage").Select
        .TypeText Text:="" & Format(wArt39.Range("Art39TarifDependance").Value, "#.00% ")
        DocWord.bookmarks("FaitA").Select
        .TypeText Text:="" & FaitA1
       DocWord.bookmarks("Date").Select
        .TypeText Text:="" & Format(Date, "dd mmmm yyyy")
        
End With
End With
End Sub
Attribute VB_Name = "Calcul1_TPG05"
Function LX05(i, annee, Sexe)
    If i > 120 Then
    LX05 = 0
    Else
        If annee < 1900 Then
            n = 1900
        ElseIf annee > 2005 Then
            n = 2005
        Else
            n = annee
        End If
        If Sexe = 1 Then
            LX05 = Sheets("TPGH05").Cells(n - 1898, 2 + i).Value
        Else
            If Sexe = 2 Then
                LX05 = Sheets("TPGF05").Cells(n - 1898, 2 + i).Value
            End If
        End If
    End If
End Function

Function DX05(age, annee, Sexe, taux)
    DX05 = (1 / (1 + taux) ^ age) * LX05(age, annee, Sexe)
End Function

Function NX05(age, annee, Sexe, taux)
    z = 0
    If age <= 120 Then
        For i = age To 121
            z = z + DX05(i, annee, Sexe, taux)
        Next
    Else
        z = 0
    End If
    NX05 = z
End Function

Function DXY05(age1, annee1, sexe1, age2, annee2, taux)
    sexe2 = 3 - sexe1
    DXY05 = (1 / (1 + taux) ^ ((age1 + age2) / 2)) * LX05(age1, annee1, sexe1) * LX05(age2, annee2, sexe2)
End Function

Function NXY05(age1, annee1, sexe1, age2, annee2, taux)
    sexe2 = 3 - sexe1
    z = 0
    If (age1 <= 120 And age2 <= 120) Then
        For i = 0 To 121
            z = z + (1 / (1 + taux) ^ ((age1 + i + age2 + i) / 2)) * LX05(age1 + i, annee1, sexe1) * LX05(age2 + i, annee2, sexe2)
        Next
    Else
        z = 0
    End If
    NXY05 = z
End Function

Function p05(duree, age, annee, Sexe)
    
    d = Int(duree)
    ud = duree - d
    X = Int(age)
    ux = age - X
           
    If LX05(X, annee, Sexe) < 1 Then
        p1 = 0
        p2 = 0
    Else
        p1 = LX05(X + d, annee, Sexe) / LX05(X, annee, Sexe)
        p2 = LX05(X + d + 1, annee, Sexe) / LX05(X, annee, Sexe)
    End If
   
    If LX05(X + 1, annee, Sexe) < 1 Then
        p3 = 0
        p4 = 0
    Else
        p3 = LX05(X + 1 + d, annee, Sexe) / LX05(X + 1, annee, Sexe)
        p4 = LX05(X + 1 + d + 1, annee, Sexe) / LX05(X + 1, annee, Sexe)
    End If
        
    p05 = p1 + ud * (p2 - p1) - ux * (p1 + ud * (p2 - p1) - (p3 + ud * (p4 - p3)))
        
End Function

Attribute VB_Name = "Calcul1_TPG93"
Function LX93(i, annee)
    If i > 117 Then
    LX93 = 0
    Else
        If annee < 1887 Then
            n = 1887
        ElseIf annee > 1993 Then
            n = 1993
        Else
            n = annee
        End If
        LX93 = Sheets("TPG93").Cells(n - 1885, 2 + i).Value
    End If
End Function

Function DX93(age, annee, taux)
    DX93 = (1 / (1 + taux) ^ age) * LX93(age, annee)
End Function

Function NX93(age, annee, taux)
    z = 0
    If age <= 117 Then
        For i = age To 118
            z = z + DX93(i, annee, taux)
        Next
    Else
        z = 0
    End If
    NX93 = z
End Function

Function DXY93(age1, annee1, age2, annee2, taux)
    DXY93 = (1 / (1 + taux) ^ ((age1 + age2) / 2)) * LX93(age1, annee1) * LX93(age2, annee2)
End Function

Function NXY93(age1, annee1, age2, annee2, taux)
    z = 0
    If (X <= 117 And Y <= 117) Then
        For i = 0 To 118
            z = z + (1 / (1 + taux) ^ ((age1 + i + age2 + i) / 2)) * LX93(age1 + i, annee1) * LX93(age2 + i, annee2)
        Next
    Else
        z = 0
    End If
    NXY93 = z
End Function

Function p93(duree, age, annee)
    
    d = Int(duree)
    ud = duree - d
    X = Int(age)
    ux = age - X
           
    If LX93(X, annee) < 1 Then
        p1 = 0
        p2 = 0
    Else
        p1 = LX93(X + d, annee) / LX93(X, annee)
        p2 = LX93(X + d + 1, annee) / LX93(X, annee)
    End If
   
    If LX93(X + 1, annee) < 1 Then
        p3 = 0
        p4 = 0
    Else
        p3 = LX93(X + 1 + d, annee) / LX93(X + 1, annee)
        p4 = LX93(X + 1 + d + 1, annee) / LX93(X + 1, annee)
    End If
        
    p93 = p1 + ud * (p2 - p1) - ux * (p1 + ud * (p2 - p1) - (p3 + ud * (p4 - p3)))
        
End Function

Attribute VB_Name = "Calcul2_ax_Mill|fffd|sime"
Function P(Table, duree, age, annee, Sexe)

If Table = "TPG93" Then
    P = p93(duree, age, annee)
End If

If Table = "TPG05" Then
    P = p05(duree, age, annee, Sexe)
End If

End Function
Function res(Table, age, annee, Sexe, taux, n)
    'rente |fffd| terme |fffd|chu simple
If Table = "TPG93" Then
    res = NX93(age, annee, taux) / DX93(age, annee, taux) - (n + 1) / (2 * n)
End If

If Table = "TPG05" Then
    res = NX05(age, annee, Sexe, taux) / DX05(age, annee, Sexe, taux) - (n + 1) / (2 * n)
End If

End Function

Function ras(Table, age, annee, Sexe, taux, n)
    'rente d'avance simple
If Table = "TPG93" Then
    ras = NX93(age, annee, taux) / DX93(age, annee, taux) - (n - 1) / (2 * n)
End If

If Table = "TPG05" Then
    ras = NX05(age, annee, Sexe, taux) / DX05(age, annee, Sexe, taux) - (n - 1) / (2 * n)
End If

End Function

Function rer(Table, age1, annee1, sexe1, age2, annee2, taux, n, rev)
    'rente |fffd| terme |fffd|chu avec r|fffd|vesion
If Table = "TPG93" Then
    rer = NX93(age1, annee1, taux) / DX93(age1, annee1, taux) - (n + 1) / (2 * n) + rev * (NX93(age2 + 1, annee2, taux) / DX93(age2, annee2, taux) - NXY93(age1 + 1, annee1, age2 + 1, annee2, taux) / DXY93(age1, annee1, age2, annee2, taux))
End If

If Table = "TPG05" Then
    sexe2 = 3 - sexe1
    rer = NX05(age1, annee1, sexe1, taux) / DX05(age1, annee1, sexe1, taux) - (n + 1) / (2 * n) + rev * (NX05(age2 + 1, annee2, sexe2, taux) / DX05(age2, annee2, sexe2, taux) - NXY05(age1 + 1, annee1, sexe1, age2 + 1, annee2, taux) / DXY05(age1, annee1, sexe1, age2, annee2, taux))
End If

End Function

Function rar(Table, age1, annee1, sexe1, age2, annee2, taux, n, rev)
    'rente d'avance avec r|fffd|vesion
If Table = "TPG93" Then
    rar = NX93(age1, annee1, taux) / DX93(age1, annee1, taux) - (n - 1) / (2 * n) + rev * (NX93(age2, annee2, taux) / DX93(age2, annee2, taux) - NXY93(age1, annee1, age2, annee2, taux) / DXY93(age1, annee1, age2, annee2, taux))
End If

If Table = "TPG05" Then
    sexe2 = 3 - sexe1
    rar = NX05(age1, annee1, sexe1, taux) / DX05(age1, annee1, sexe1, taux) - (n - 1) / (2 * n) + rev * (NX05(age2, annee2, sexe2, taux) / DX05(age2, annee2, sexe2, taux) - NXY05(age1, annee1, sexe1, age2, annee2, taux) / DXY05(age1, annee1, sexe1, age2, annee2, taux))
End If

End Function

Attribute VB_Name = "Calcul3_axViager_AgeExact"
Function ax_echu_simple(Table, Date_Naissance, Date_Calcul, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax rente |fffd| terme |fffd|chu simple avec frais
    
    age = (Date_Calcul - Date_Naissance) / 365.25
    X = Int(age)
    u = age - X
    anneeN = Year(Date_Naissance)
    a = res(Table, X, anneeN, Sexe, taux_technique, Fractionnement)
    b = res(Table, X + 1, anneeN, Sexe, taux_technique, Fractionnement)
    
    ax_echu_simple = ((1 - u) * a + u * b) * (1 + frais_arrerage)

End Function

Function ax_echu_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, sexe1, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax rente |fffd| terme |fffd|chu reversible avec frais
    sexe2 = 3 - sexe1
    age1 = (Date_Calcul - Date_Naissance) / 365.25
    X = Int(age1)
    u = age1 - X
    age2 = (Date_Calcul - Date_Naissance_Conjoint) / 365.25
    Y = Int(age2)
    v = age2 - Y
    anneeN = Year(Date_Naissance)
    anneeNC = Year(Date_Naissance_Conjoint)
    a = rer(Table, X, anneeN, sexe1, Y, anneeNC, taux_technique, Fractionnement, taux_reversion)
    b = rer(Table, X + 1, anneeN, sexe1, Y, anneeNC, taux_technique, Fractionnement, taux_reversion)
    c = rer(Table, X, anneeN, sexe1, Y + 1, anneeNC, taux_technique, Fractionnement, taux_reversion)
    d = rer(Table, X + 1, anneeN, sexe1, Y + 1, anneeNC, taux_technique, Fractionnement, taux_reversion)
    
    ax_echu_reversible = ((1 - u) * (1 - v) * a + u * (1 - v) * b + v * (1 - u) * c + u * v * d) * (1 + frais_arrerage)

End Function

Function ax_avance_simple(Table, Date_Naissance, Date_Calcul, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax rente |fffd| terme avance simple avec frais
    
    age = (Date_Calcul - Date_Naissance) / 365.25
    X = Int(age)
    u = age - X
    anneeN = Year(Date_Naissance)
    a = ras(Table, X, anneeN, Sexe, taux_technique, Fractionnement)
    b = ras(Table, X + 1, anneeN, Sexe, taux_technique, Fractionnement)
    
    ax_avance_simple = ((1 - u) * a + u * b) * (1 + frais_arrerage)

End Function

Function ax_avance_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, sexe1, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax rente |fffd| terme avance reversible avec frais
    sexe2 = 3 - sexe1
    age1 = (Date_Calcul - Date_Naissance) / 365.25
    X = Int(age1)
    u = age1 - X
    age2 = (Date_Calcul - Date_Naissance_Conjoint) / 365.25
    Y = Int(age2)
    v = age2 - Y
    anneeN = Year(Date_Naissance)
    anneeNC = Year(Date_Naissance_Conjoint)
    a = rar(Table, X, anneeN, sexe1, Y, anneeNC, taux_technique, Fractionnement, taux_reversion)
    b = rar(Table, X + 1, anneeN, sexe1, Y, anneeNC, taux_technique, Fractionnement, taux_reversion)
    c = rar(Table, X, anneeN, sexe1, Y + 1, anneeNC, taux_technique, Fractionnement, taux_reversion)
    d = rar(Table, X + 1, anneeN, sexe1, Y + 1, anneeNC, taux_technique, Fractionnement, taux_reversion)
    
    ax_avance_reversible = ((1 - u) * (1 - v) * a + u * (1 - v) * b + v * (1 - u) * c + u * v * d) * (1 + frais_arrerage)

End Function



Attribute VB_Name = "Calcul4_axTempo_AgeExact"
Function ax_echu_simple_temporaire(Table, Date_Naissance, Date_debut, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_echu_simple_temporaire avec frais
            
    temp = (Date_fin - Date_debut) / 365.25
 
    anneeN = Year(Date_Naissance)
    agedebut = (Date_debut - Date_Naissance) / 365.25
     
    axd = ax_echu_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    axf = ax_echu_simple(Table, Date_Naissance, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
 
    If temp <= 0 Then
        temporaire = 0
    Else
        If Table = "TPG93" Then
            temporaire = axd - axf * p93(temp, agedebut, anneeN) * 1 / (1 + taux_technique) ^ temp
        End If
        If Table = "TPG05" Then
            temporaire = axd - axf * p05(temp, agedebut, anneeN, Sexe) * 1 / (1 + taux_technique) ^ temp
        End If
    End If
    
    ax_echu_simple_temporaire = temporaire

End Function


Function ax_avance_simple_temporaire(Table, Date_Naissance, Date_debut, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_avance_simple_temporaire avec frais
    
    temp = (Date_fin - Date_debut) / 365.25
 
    anneeN = Year(Date_Naissance)
    agedebut = (Date_debut - Date_Naissance) / 365.25
     
    axd = ax_avance_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    axf = ax_avance_simple(Table, Date_Naissance, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
 
    If temp <= 0 Then
        temporaire = 0
    Else
        If Table = "TPG93" Then
            temporaire = axd - axf * p93(temp, agedebut, anneeN) * 1 / (1 + taux_technique) ^ temp
        End If
        If Table = "TPG05" Then
            temporaire = axd - axf * p05(temp, agedebut, anneeN, Sexe) * 1 / (1 + taux_technique) ^ temp
        End If
    End If
    
    ax_avance_simple_temporaire = temporaire

End Function


Function ax_echu_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_echu_reversible_temporaire avec frais
    sexe2 = 3 - Sexe
    temp = (Date_fin - Date_debut) / 365.25
 
    anneeN = Year(Date_Naissance)
    agedebut = (Date_debut - Date_Naissance) / 365.25
    anneeNC = Year(Date_Naissance_Conjoint)
    agedebutC = (Date_debut - Date_Naissance_Conjoint) / 365.25
    
    axd = ax_echu_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axf = ax_echu_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axfass = ax_echu_simple(Table, Date_Naissance, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    axfconj = ax_echu_simple(Table, Date_Naissance_Conjoint, Date_fin, sexe2, taux_technique, Fractionnement, frais_arrerage)
   
    If Table = "TPG93" Then
        a = axf * p93(temp, agedebut, anneeN) * p93(temp, agedebutC, anneeNC)
        b = axfass * p93(temp, agedebut, anneeNe) * (1 - p93(temp, agedebutC, anneeNC))
        c = axfconj * (1 - p93(temp, agedebut, anneeN)) * p93(temp, agedebutC, anneeNC)
    End If
        
    If Table = "TPG05" Then
        a = axf * p05(temp, agedebut, anneeN, Sexe) * p05(temp, agedebutC, anneeNC, sexe2)
        b = axfass * p05(temp, agedebut, anneeN, Sexe) * (1 - p05(temp, agedebutC, anneeNC, sexe2))
        c = axfconj * (1 - p05(temp, agedebut, anneeN, Sexe)) * p05(temp, agedebutC, anneeNC, sexe2)
    End If
        
    If temp <= 0 Then
        temporaire = 0
    Else
        temporaire = axd - (a + b + c * taux_reversion) * 1 / (1 + taux_technique) ^ temp
    End If
    
    ax_echu_reversible_temporaire = temporaire

End Function

Function ax_avance_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_avance_reversible_temporaire avec frais
    sexe2 = 3 - Sexe
    temp = (Date_fin - Date_debut) / 365.25
 
    anneeN = Year(Date_Naissance)
    agedebut = (Date_debut - Date_Naissance) / 365.25
    anneeNC = Year(Date_Naissance_Conjoint)
    agedebutC = (Date_debut - Date_Naissance_Conjoint) / 365.25
    
    axd = ax_avance_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axf = ax_avance_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axfass = ax_avance_simple(Table, Date_Naissance, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    axfconj = ax_avance_simple(Table, Date_Naissance_Conjoint, Date_fin, sexe2, taux_technique, Fractionnement, frais_arrerage)
   
    If Table = "TPG93" Then
        a = axf * p93(temp, agedebut, anneeN) * p93(temp, agedebutC, anneeNC)
        b = axfass * p93(temp, agedebut, anneeN) * (1 - p93(temp, agedebutC, anneeNC))
        c = axfconj * (1 - p93(temp, agedebut, anneeN)) * p93(temp, agedebutC, anneeNC)
    End If
        
    If Table = "TPG05" Then
        a = axf * p05(temp, agedebut, anneeN, Sexe) * p05(temp, agedebutC, anneeNC, sexe2)
        b = axfass * p05(temp, agedebut, anneeN, Sexe) * (1 - p05(temp, agedebutC, anneeNC, sexe2))
        c = axfconj * (1 - p05(temp, agedebut, anneeN, Sexe)) * p05(temp, agedebutC, anneeNC, sexe2)
    End If
        
    If temp <= 0 Then
        temporaire = 0
    Else
        temporaire = axd - (a + b + c * taux_reversion) * 1 / (1 + taux_technique) ^ temp
    End If
    
    ax_avance_reversible_temporaire = temporaire

End Function





Attribute VB_Name = "Calcul5_axDiff|fffd|r|fffd|_AgeExact"
Function ax_echu_simple_differe(Table, Date_Naissance, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_echu_simple_differe avec frais
            
    diff = (Date_debut - Date_Calcul) / 365.25
    anneeN = Year(Date_Naissance)
    AgeCalcul = (Date_Calcul - Date_Naissance) / 365.25
    axd = ax_echu_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    If Table = "TPG93" Then
        escompteviager = p93(diff, AgeCalcul, anneeN) * 1 / (1 + taux_technique) ^ diff
    End If
    If Table = "TPG05" Then
        escompteviager = p05(diff, AgeCalcul, anneeN, Sexe) * 1 / (1 + taux_technique) ^ diff
    End If

    ax_echu_simple_differe = escompteviager * axd

End Function
Function ax_avance_simple_differe(Table, Date_Naissance, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_avance_simple_differe avec frais
            
    diff = (Date_debut - Date_Calcul) / 365.25
    anneeN = Year(Date_Naissance)
    AgeCalcul = (Date_Calcul - Date_Naissance) / 365.25
    axd = ax_avance_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    If Table = "TPG93" Then
        escompteviager = p93(diff, AgeCalcul, anneeN) * 1 / (1 + taux_technique) ^ diff
    End If
    If Table = "TPG05" Then
        escompteviager = p05(diff, AgeCalcul, anneeN, Sexe) * 1 / (1 + taux_technique) ^ diff
    End If

    ax_avance_simple_differe = escompteviager * axd

End Function

Function ax_echu_reversible_differe(Table, Date_Naissance, Date_Naissance_Conjoint, Sexe, Date_Calcul, Date_debut, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_echu_reversible_differe avec frais
    Dim px As Double
    
    sexe2 = 3 - Sexe
    diff = (Date_debut - Date_Calcul) / 365.25
    anneeN = Year(Date_Naissance)
    anneeNC = Year(Date_Naissance_Conjoint)

    AgeCalcul = (Date_Calcul - Date_Naissance) / 365.25
    ageconjcalcul = (Date_Calcul - Date_Naissance_Conjoint) / 365.25
    
    axyd = ax_echu_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axd = ax_echu_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    ayd = ax_echu_simple(Table, Date_Naissance_Conjoint, Date_debut, sexe2, taux_technique, Fractionnement, frais_arrerage)

    If Table = "TPG93" Then
        pxy = p93(diff, AgeCalcul, anneeN) * p93(diff, ageconjcalcul, anneeNC)
        px = p93(diff, AgeCalcul, anneeN) * (1 - p93(diff, ageconjcalcul, anneeNC))
        py = (1 - p93(diff, AgeCalcul, anneeN)) * p93(diff, ageconjcalcul, anneeNC)
    End If
    If Table = "TPG05" Then
        pxy = p05(diff, AgeCalcul, anneeN, Sexe) * p05(diff, ageconjcalcul, anneeNC, sexe2)
        px = p05(diff, AgeCalcul, anneeN, Sexe) * (1 - p05(diff, ageconjcalcul, anneeNC, sexe2))
        py = (1 - p05(diff, AgeCalcul, anneeN, Sexe)) * p05(diff, ageconjcalcul, anneeNC, sexe2)
    End If
    
    a = pxy * axyd + px * axd + py * ayd * taux_reversion
    escompteviager = 1 / (1 + taux_technique) ^ diff

    ax_echu_reversible_differe = escompteviager * a

End Function

Function ax_avance_reversible_differe(Table, Date_Naissance, Date_Naissance_Conjoint, Sexe, Date_Calcul, Date_debut, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_avance_reversible_differe avec frais
    Dim px As Double
    
    sexe2 = 3 - Sexe
    diff = (Date_debut - Date_Calcul) / 365.25
    anneeN = Year(Date_Naissance)
    anneeNC = Year(Date_Naissance_Conjoint)

    AgeCalcul = (Date_Calcul - Date_Naissance) / 365.25
    ageconjcalcul = (Date_Calcul - Date_Naissance_Conjoint) / 365.25
    
    axyd = ax_avance_reversible(Table, Date_Naissance, Date_Naissance_Conjoint, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    axd = ax_avance_simple(Table, Date_Naissance, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
    ayd = ax_avance_simple(Table, Date_Naissance_Conjoint, Date_debut, sexe2, taux_technique, Fractionnement, frais_arrerage)
    
    If Table = "TPG93" Then
        pxy = p93(diff, AgeCalcul, anneeN) * p93(diff, ageconjcalcul, anneeNC)
        px = p93(diff, AgeCalcul, anneeN) * (1 - p93(diff, ageconjcalcul, anneeNC))
        py = (1 - p93(diff, AgeCalcul, anneeN)) * p93(diff, ageconjcalcul, anneeNC)
    End If
    If Table = "TPG05" Then
        pxy = p05(diff, AgeCalcul, anneeN, Sexe) * p05(diff, ageconjcalcul, anneeNC, sexe2)
        px = p05(diff, AgeCalcul, anneeN, Sexe) * (1 - p05(diff, ageconjcalcul, anneeNC, sexe2))
        py = (1 - p05(diff, AgeCalcul, anneeN, Sexe)) * p05(diff, ageconjcalcul, anneeNC, sexe2)
    End If
    
    a = pxy * axyd + px * axd + py * ayd * taux_reversion
    escompteviager = 1 / (1 + taux_technique) ^ diff

    ax_avance_reversible_differe = escompteviager * a

End Function


Attribute VB_Name = "Calcul6_axDiff|fffd|r|fffd|Tempo_AgeExact"
Function ax_echu_simple_differe_temporaire(Table, Date_Naissance, Sexe, Date_Calcul, Date_debut, Date_fin, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_echu_simple_differe_temporaire avec frais
    
    a = ax_echu_simple_temporaire(Table, Date_Naissance, Date_Calcul, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    b = ax_echu_simple_temporaire(Table, Date_Naissance, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
     
    ax_echu_simple_differe_temporaire = a - b
    
End Function

Function ax_echu_reversible_differe_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Sexe, Date_Calcul, Date_debut, Date_fin, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_echu_reversible_differe_temporaire avec frais
            
    a = ax_echu_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    b = ax_echu_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    
    ax_echu_reversible_differe_temporaire = a - b

End Function

Function ax_avance_simple_differe_temporaire(Table, Date_Naissance, Sexe, Date_Calcul, Date_debut, Date_fin, taux_technique, Fractionnement, frais_arrerage)
    'ax_rente_avance_simple_differe_temporaire avec frais
    
    a = ax_avance_simple_temporaire(Table, Date_Naissance, Date_Calcul, Date_fin, Sexe, taux_technique, Fractionnement, frais_arrerage)
    b = ax_avance_simple_temporaire(Table, Date_Naissance, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, frais_arrerage)
     
    ax_avance_simple_differe_temporaire = a - b
    
End Function

Function ax_avance_reversible_differe_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Sexe, Date_Calcul, Date_debut, Date_fin, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    'ax_rente_avance_reversible_differe_temporaire avec frais
            
    a = ax_avance_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, Date_fin, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    b = ax_avance_reversible_temporaire(Table, Date_Naissance, Date_Naissance_Conjoint, Date_Calcul, Date_debut, Sexe, taux_technique, Fractionnement, taux_reversion, frais_arrerage)
    
    ax_avance_reversible_differe_temporaire = a - b

End Function


Attribute VB_Name = "Calculs"

Option Explicit

Global Ouverture As Boolean, ChoixRente As Integer, LibChoixRente As String, DjCjt2 As Boolean
Global Const Version = 20
Global Const NomCheminSuiviTech = "\\Prnas02\4d\acr1_actuariat\OUTILS\Bases\"
Global Const NomCheminSuiviTechBis = "OUTILS\Bases\"
Global Const NomCheminSuiviGestion = "\\Prnas01\4b\Ugips\01-Commun\LEA\LEA - UGIPS\LEA\"
'Global Const NomCheminSuiviGestionBis = "Boite |fffd| outil\"
Global Const NomCheminDoc = "\\Prnas01\3\llg2_gr\LOGICEL CALCUL D'ANNUITE\BAREME DE RENTE ERE\Doc\"
Global Const NomCheminDocBis = "BAREME DE RENTE ERE\Doc\"
Global Const NomFichSuivi = "BaseNumVersions.xls"
Global Const NomCheminDocIBM = "\\Prnas01\3\llg2_gr\LOGICEL CALCUL D'ANNUITE\BAREME DE RENTE ERE\LEA\DOCS\" '"\\Prnas01\4b\Ugips\01-Commun\LEA DEV\Version de test\PASRAU\"
'Global Const NomCheminDocIBMBis = "01-Commun\LEA\LEA - UGIPS\LEA\DOCS\"
Global Const NomLettreLiquidIBM = "IBM - Lettre accomp + Notification de rente.docx"
Global Const NomLettreM|fffd|thodo = "IBM - M|fffd|thodologie Calcul des rentes - Annexe aux |fffd|valuations et liquidations.docx"
Global Const NomLettreEstimIBM = "IBM - Lettre Estimation rente2.docx"
Global Const ChoixOptionRente = "Choix option rente.doc"
Public Utilisateur As String
Public UtilisateurIni As String
Public ApproxAge As String
Public StatutCjts As String
Public NbEvalIbm  As Integer

Public Function MajAnnuit|fffd|()
If Bar|fffd|me.Range("ApproxAge").Value = "Age exact" Then
    Call MajAnnuit|fffd|AgeExact
Else
    Call MajAnnuit|fffd|SansAgeExact
End If
End Function


Public Function MajAnnuit|fffd|AgeExact()
Dim DateNaissX As Date, DateCalcul As Date, Table1 As String, Table2 As String
Dim TxTech As Double, Fractionnement As String, Frac As Integer, Txrev As Double
Dim DateNaissY1 As Date, DateNaissY2 As Date, DurMariage1 As Double, Msg As String, Msg2 As String
Dim DurMariage2 As Double, DateDebRente As Date, DateTerme As Date, NbAnGar As Integer
Dim TxCroissRte70_75 As Double, Terme As String, An As Double, TxFraisRente As Double
Dim Approx As Integer, CoefReduc As Double, AgeTerme As Double, An2 As Double
Dim ProrataD|fffd|c|fffd|s As String, IdContrAssurance As String, DateFinGar As Date
Dim ProrogAnticip As String, NbAnn|fffd|esModif As Integer, NbMoisModif As Integer
Dim TxFraisDiff As Double, DateFinDiff As Date, AgeMinRev As Double, AnRvi As Double
Dim RVD_N1 As Double, RVI As Double, RVD_N As Double, RVI_N As Double, AgeDebRente As Double, AgeEffetR|fffd|el As Double, RVD_N2 As Double, RVI2 As Double 'ajout 05/18
Dim CoefA As Double, CoefB As Double, DateMinRev1 As Date, DateMinRev2 As Date
Dim ContrAssurance As String, Prorata As String, TxReval As Double, Sexe As String
Dim Rte83 As Double, Rte39 As Double, Cap83 As Double, Cap39 As Double, NbMoisCert As Integer
Dim NbMoisTh As Integer, DateNaissXini As Date, d As Date, DateMsg As Date
Dim AgeX As Double, AgeY1 As Double, AgeY2 As Double, AgeFinGar As Double, AgeFinDiff As Double
Dim AnNaissX As Integer, AnNaissY1 As Integer, AnNaissY2 As Integer
Dim AnBis As Double, An2Bis As Double, CoefR|fffd|ducBis As Double, DateNaissXBis As Date
Dim AgeDebRenteBis As Double, DateNaissY1Bis As Date, AgeY1Bis As Double, DateNaissY1Ini As Date
Dim NumContract As Double, MsgEch As Double, MsgFormule As String
Dim rattrapage As Double, PM As Double, MsgDateProro As Date, DebRenteProro As Date, LimiteAge As Double
Dim Tab1 As String, Tab2 As String, TxVigueur As Double

CqChoixRente
ApproxAge = Bar|fffd|me.Range("ApproxAge").Value
Approx = 0
DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
AnNaissX = Year(DateNaissX)

NumContract = Bar|fffd|me.Range("RPP") 'proro
TxVigueur = Bar|fffd|me.Range("TauxVigueur").Value 'proro

'---- Date de calcul
DateDebRente = DebMois(Bar|fffd|me.Range("DateDebRente").Value + 1)
DateCalcul = Bar|fffd|me.Range("DateCalcul").Value

'----- Masque des cellules en fonction du type de capitalisation et param|fffd|trage de la date de calcul
Select Case LibChoixRente
Case "RVI":
Bar|fffd|me.Shapes("CacheAnticipation").Visible = True 'proro
Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True 'proro
Bar|fffd|me.Shapes("CacheFormule").Visible = True 'proro

If DateDebRente > DateCalcul + 1 Then DateCalcul = DateDebRente
            Select Case DateDebRente = DateCalcul
            Case True:  Range("DateCalcul").Interior.ColorIndex = xlNone
            Case False: Range("DateCalcul").Interior.ColorIndex = 15
            End Select
Case "RVD": Select Case Bar|fffd|me.ModificationAge
            Case True:  DateCalcul = DateDebRente
            Case False: DateCalcul = Bar|fffd|me.Range("DateCalcul").Value
            End Select
            Bar|fffd|me.Shapes("CacheAnticipation").Visible = True 'proro
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True 'proro
            Bar|fffd|me.Shapes("CacheFormule").Visible = True 'proro

Case "CaF": Select Case Bar|fffd|me.ModificationAge
            Case True:  DateCalcul = DateDebRente
            Case False: DateCalcul = Bar|fffd|me.Range("DateCalcul").Value
            End Select
            Bar|fffd|me.Shapes("CacheAnticipation").Visible = True 'proro
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True 'proro
            Bar|fffd|me.Shapes("CacheFormule").Visible = True 'proro

Case "RTI": DateCalcul = DateDebRente
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select


'---- proro
'Pour calculer le coefficient de prorogation avec les tables TGH05 et TGF05 (table en vigueur)
'D|fffd|finition des tab1 et 2 en fonction de la cellule Sexe

Select Case Bar|fffd|me.Range("Sexe").Value
 
 Case "H/F":  Tab1 = "TGH05"
              Tab2 = "TGF05"
 Case "F/H":  Tab1 = "TGF05"
              Tab2 = "TGH05"
 Case "H/H":  Tab1 = "TGH05"
              Tab2 = "TGH05"
 Case Else:   Tab1 = "TGF05"
              Tab2 = "TGF05"
End Select

'-------fin proro


DateNaissXini = DateNaissX
DateNaissX = ApproximAge(DateNaissX, DateCalcul, Approx)
AgeX = nbann|fffd|es2(DateNaissX, DateCalcul)
AgeDebRente = nbann|fffd|es2(DateNaissX, DateDebRente)

If DateDebRente <> Bar|fffd|me.Range("DateDebRente").Value Then Bar|fffd|me.Range("DateDebRente").Value = DateDebRente
If DateCalcul <> Bar|fffd|me.Range("DateCalcul").Value Then Bar|fffd|me.Range("DateCalcul").Value = DateCalcul
If AgeDebRente <> Bar|fffd|me.Range("AgeDebRente").Value Then Bar|fffd|me.Range("AgeDebRente").Value = AgeDebRente

'---- Modification d'affichage concernant la contrassurance
If (DateDebRente > DateCalcul + 1 Or Bar|fffd|me.ModificationAge) And LibChoixRente <> "CaF" Then
  Bar|fffd|me.Shapes("CacheContrAssurance").Visible = False
  
  Select Case Bar|fffd|me.Range("ContrAss").Value
  Case "Avec": IdContrAssurance = "Avec"
  Case "Sans": IdContrAssurance = "Sans"
  Case Else
    MsgBox "Erreur ContrAssurance - contacter l'administrateur"
    Exit Function
  End Select

Else
  Bar|fffd|me.Shapes("CacheContrAssurance").Visible = True
  IdContrAssurance = "Sans"
End If

'---- Tables de mortalit|fffd|
Table1 = Bar|fffd|me.Range("Table").Value
Table2 = Table1

Sexe = Bar|fffd|me.Range("Sexe").Value
Select Case Table1
Case "TGHF05"
  
  Select Case Sexe
  Case "H/F": Table1 = "TGH05"
              Table2 = "TGF05"
  Case "F/H": Table1 = "TGF05"
              Table2 = "TGH05"
  Case "H/H": Table1 = "TGH05"
              Table2 = "TGH05"
  Case "F/F": Table1 = "TGF05"
              Table2 = "TGF05"
  Case Else: MsgBox "Bug table"
  End Select

Case "TPG+x/15.TGHF05"
  
  If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
    
    Select Case Sexe
    Case "H/F": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/H": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "H/H": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/F": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
    Case Else:  MsgBox "Bug table"
    End Select
  
  Else
    
    Select Case Sexe
    Case "H/F": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/H": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "H/H": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/F": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
    Case Else:  MsgBox "Bug table"
    End Select
  
  End If

Case "TV+x/7.TPG"
  
  If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
    Table1 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
    Table2 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
  Else
    Table1 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
    Table2 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
  End If

End Select

'---- Affichage des alertes
If (Year(DateDebRente) <= 2006 And Table1 <> "TPG") Or (Year(DateDebRente) >= 2007 And (Table1 = "TPG" Or Table1 = "TV8890" Or Table1 = "TV7377")) Then
  If Range("AvTable").Value <> " =>" Then Range("AvTable").Value = " =>"
Else
  If Range("AvTable").Value <> "" Then Range("AvTable").Value = ""
End If
If DateDebRente - DateCalcul <> 1 And DateDebRente - DateCalcul <> 0 Then
  If Range("AvDateCalcul").Value <> " =>" Then Range("AvDateCalcul").Value = " =>"
Else
  If Range("AvDateCalcul").Value <> "" Then Range("AvDateCalcul").Value = ""
End If
If Range("TxFraisRente").Value <> 0.03 Then
  If Range("AvTxFraisRente").Value <> " =>" Then Range("AvTxFraisRente").Value = " =>"
Else
  If Range("AvTxFraisRente").Value <> "" Then Range("AvTxFraisRente").Value = ""
End If

Select Case Range("TxFraisDiff").Value
Case 0.00075: If Range("AvTxFraisDiff").Value <> "" Then Range("AvTxFraisDiff").Value = ""
Case 0.0005: If Range("AvTxFraisDiff").Value <> "IBM" Then Range("AvTxFraisDiff").Value = "IBM"
Case Else: If Range("AvTxFraisDiff").Value <> " =>" Then Range("AvTxFraisDiff").Value = " =>"
End Select

If Range("Fractionnement").Value <> "Trimestriel" Then 'pour le moment on laisse trimestriel pour que le valideur soit vigilant sur les liquidations |fffd| venir, souvent trimestrielle
  If Range("AvFractionnement").Value <> " =>" Then Range("AvFractionnement").Value = " =>"
Else
  If Range("AvFractionnement").Value <> "" Then Range("AvFractionnement").Value = ""
End If
If Range("Terme").Value <> "Echu" Then
  If Range("AvTerme").Value <> " =>" Then Range("AvTerme").Value = " =>"
Else
  If Range("AvTerme").Value <> "" Then Range("AvTerme").Value = ""
End If
If Range("ProrataD|fffd|c|fffd|s").Value <> "Sans" Then
  If Range("AvProrataD|fffd|c|fffd|s").Value <> " =>" Then Range("AvProrataD|fffd|c|fffd|s").Value = " =>"
Else
  If Range("AvProrataD|fffd|c|fffd|s").Value <> "" Then Range("AvProrataD|fffd|c|fffd|s").Value = ""
End If
If Range("ContrAss").Value <> "Sans" Then
  If Range("AvContrAss").Value <> " =>" Then Range("AvContrAss").Value = " =>"
Else
  If Range("AvContrAss").Value <> "" Then Range("AvContrAss").Value = ""
End If

'---- Param|fffd|tres de calcul de l'annuit|fffd|
TxReval = 0
TxTech = Bar|fffd|me.Range("TxTech").Value
Terme = Bar|fffd|me.Range("Terme").Value
Select Case Terme
Case "Echu":   ProrataD|fffd|c|fffd|s = Bar|fffd|me.Range("ProrataD|fffd|c|fffd|s").Value
               Select Case ProrataD|fffd|c|fffd|s
               Case "Sans": Prorata = "Sans"
               Case "Proportionnel": Prorata = "PROP"
               Case "Complet": Prorata = "COMP"
               End Select
Case "Avance": Prorata = "Sans"
Case Else:     MsgBox "Terme inconnu : " & Terme
End Select

Select Case LibChoixRente
Case "RVI": AgeTerme = 0
Case "RVD": AgeTerme = 0
Case "CaF": AgeTerme = 0
Case "RTI": AgeTerme = Bar|fffd|me.Range("AgeTerme").Value
            If AgeTerme <> 0 Then DateTerme = AnPlus(DateNaissX, AgeTerme) - 1
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select
Fractionnement = Bar|fffd|me.Range("Fractionnement").Value
Select Case Range("Fractionnement").Value
  Case "Mensuel": Frac = 12
  Case "Trimestriel": Frac = 4
  Case "Semestriel": Frac = 2
  Case "Annuel": Frac = 1
  Case Else
    MsgBox "Fractionnement inconnu : " & Fractionnement
End Select
DateFinDiff = DateDebRente - 1
AgeFinDiff = AgeDebRente
TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
Select Case LibChoixRente
Case "RVI": TxFraisDiff = 0
Case "RVD": TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Case "CaF": TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Case "RTI": TxFraisDiff = 0
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select

'---- Particularit|fffd|s |fffd|ventuelles (annuit|fffd|s garanties ou rente croissante)
Select Case LibChoixRente
Case "RVI"
  Select Case Bar|fffd|me.Range("ChkParticularit|fffd|").Value
  Case 1:     NbAnGar = Bar|fffd|me.Range("NbAnGar").Value
              DateFinGar = AnPlus(DateDebRente, NbAnGar) - 1
              AgeFinGar = AgeDebRente + NbAnGar
              TxCroissRte70_75 = Bar|fffd|me.Range("TxCroissRte70_75").Value
              If NbAnGar <> 0 And TxCroissRte70_75 <> 0 Then
                MsgBox "Les contrats ne proposent pas de choisir |fffd| la fois Annuit|fffd|es garanties ET Croissance de la rente par palier" & Chr(13) & Chr(13) & " => Ces deux param|fffd|tres ont |fffd|t|fffd| r|fffd|initialis|fffd|s |fffd| 0"
                TxCroissRte70_75 = 0
                Bar|fffd|me.Range("TxCroissRte70_75").Value = 0
                NbAnGar = 0
                Bar|fffd|me.Range("NbAnGar").Value = 0
              End If
  Case False: NbAnGar = 0
              TxCroissRte70_75 = 0
  Case Else:  MsgBox "Pb identication choix particularit|fffd| - contacter l'administrateur"
              Exit Function
  End Select
  
'--- ajout CFTI Annuit|fffd|s garanties
Case "CaF"

Select Case Bar|fffd|me.Range("ChkParticularit|fffd|").Value
  Case 1:     NbAnGar = Bar|fffd|me.Range("NbAnGar").Value
              DateFinGar = AnPlus(DateDebRente, NbAnGar) - 1
              AgeFinGar = AgeDebRente + NbAnGar
              TxCroissRte70_75 = 0
  Case False: NbAnGar = 0
              TxCroissRte70_75 = 0
  Case Else:  MsgBox "Pb identication choix particularit|fffd| - contacter l'administrateur"
              Exit Function
  End Select
'------------------

 
Case Else
  NbAnGar = 0
  TxCroissRte70_75 = 0
End Select

'---- R|fffd|version
Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 1
  Txrev = Bar|fffd|me.Range("TxRev").Value
  DateNaissY1 = Bar|fffd|me.Range("DateNaissY1").Value
  DateNaissY1Ini = Bar|fffd|me.Range("DateNaissY1").Value
  AnNaissY1 = Year(DateNaissY1)
  DateNaissY1 = ApproximAge(DateNaissY1, DateCalcul, Approx)
  AgeY1 = nbann|fffd|es2(DateNaissY1, DateCalcul)
  AgeMinRev = 0
  DateMinRev1 = AnPlus(DateNaissY1, AgeMinRev)
  
  Select Case Bar|fffd|me.ExistR|fffd|version2
  Case True
    DateNaissY2 = Bar|fffd|me.Range("DateNaissY2").Value
    AnNaissY2 = Year(DateNaissY2)
    DateNaissY2 = ApproximAge(DateNaissY2, DateCalcul, Approx)
    AgeY2 = nbann|fffd|es2(DateNaissY2, DateCalcul)
    DateMinRev2 = AnPlus(DateNaissY2, AgeMinRev)
    DurMariage1 = Bar|fffd|me.Range("DurMariage1").Value
    DurMariage2 = Bar|fffd|me.Range("DurMariage2").Value
    An = sAnnuit|fffd|3(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeY2, AnNaissY2, AgeDebRente, Table1, Table2, 0, AgeMinRev, DurMariage1, DurMariage2, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    An2 = sAnnuit|fffd|3(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeY2, AnNaissY2, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, DurMariage1, DurMariage2, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  Case False
    An = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateCalcul, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, DateFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
    'An = sannuit|fffd|X2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, 0, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    An2 = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateCalcul, Table1, Table2, Txrev, DateMinRev1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, DateFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
    'An2 = sannuit|fffd|X2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, TxRev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  Case Else
    MsgBox "Pb identication code r|fffd|version 1 - contacter l'administrateur"
    Exit Function
  End Select

Case 0
    An = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateCalcul, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, DateFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
   If NbAnGar <> 0 Then
    An2 = An - annuit|fffd|X2(DateNaissX, DateNaissY1, DateFinGar, DateCalcul, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, DateFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
  Else
    An2 = An
  End If
  CoefReduc = 1
  CoefR|fffd|ducBis = 1
Case Else
  MsgBox "Pb identication code r|fffd|version 1 - contacter l'administrateur"
  Exit Function
End Select

If An <> Bar|fffd|me.Range("Annuit|fffd|").Value Then Bar|fffd|me.Range("Annuit|fffd|").Value = An
If CStr(An2) <> CStr(Bar|fffd|me.Range("Annuit|fffd|Rev").Value) Then Bar|fffd|me.Range("Annuit|fffd|Rev").Value = An2

'---- Coefficient de r|fffd|duction r|fffd|version
If An <> 0 And (Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Or DateFinGar > 0 Or TxCroissRte70_75) Then
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: 'CoefReduc = sannuit|fffd|X1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance) / An2
          CoefReduc = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateCalcul, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance) / An2
  Case 0: 'CoefReduc = sannuit|fffd|X1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance) / An
          CoefReduc = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateCalcul, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance) / An
  End Select
  CoefR|fffd|ducBis = CoefReduc
End If


If CoefReduc <> Bar|fffd|me.Range("CoefR|fffd|duc").Value Then Bar|fffd|me.Range("CoefR|fffd|duc").Value = CoefReduc

'--- ajout proro

'---- Anticipation et Prorogation

CoefA = 1
CoefB = 0
If Not Bar|fffd|me.ModificationAge Then
  
  With Bar|fffd|me
  If Range("LibAgeEffet") <> "Age d'effet r|fffd|el de la rente" Then Range("LibAgeEffet") = "Age d'effet r|fffd|el de la rente"
  If Range("Th|fffd|orie").Value <> "" Then Range("Th|fffd|orie").Value = ""
  If .Range("Age_limite_de_prorogation").Value <> "" Then .Range("Age_limite_de_prorogation").Value = ""
  If .Range("Formule").Value <> "" Then .Range("Formule").Value = ""
  If .Range("DateProro").Value <> "" Then .Range("DateProro").Value = ""
  End With

Else
  
  With Bar|fffd|me
  ProrogAnticip = .Range("ProrogAnticip").Value
  NbAnn|fffd|esModif = .Range("NbAnn|fffd|esModif").Value
  NbMoisModif = .Range("NbMoisModif").Value
  End With
  
  Select Case ProrogAnticip
  Case "Prorogation"
  
  'Calcul du coefficient de prorogation jusqu'|fffd| l'|fffd|ge limite de prorogation
  With Bar|fffd|me
  
  'ajout proro
  If .Range("Formule") = "ACT_LIQ" Then
    If .Range("Pension_SS").Value = "" Or .Range("Pension_SS").Value = 0 Then
        LimiteAge = .Range("Age_limite_de_prorogation").Value
      If .Range("Age_limite_de_prorogation").Value = "" Or .Range("Age_limite_de_prorogation").Value = 0 Then
      LimiteAge = 75
      End If
    Else
      If .Range("Age_limite_de_prorogation").Value = "" Or .Range("Age_limite_de_prorogation").Value = 0 Then
      LimiteAge = Bar|fffd|me.Range("Pension_SS")
        If .Range("Pension_SS").Value = "" Or .Range("Pension_SS").Value = 0 Then
        LimiteAge = 75
        End If
      Else
        LimiteAge = Mini(.Range("Pension_SS").Value, .Range("Age_limite_de_prorogation").Value)
      End If
    End If
  Else
    If .Range("Age_limite_de_prorogation").Value = "" Or .Range("Age_limite_de_prorogation").Value = 0 Then
    LimiteAge = 75
    Else
    LimiteAge = .Range("Age_limite_de_prorogation")
    End If
  End If
 
 End With

    
    If AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif) > AnPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge) Then
      DebRenteProro = AnPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge)
    Else
      DebRenteProro = AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif)
    End If
  '---------- fin proro
  
  '---- modif proro car taux en vigueur |fffd| utiliser
  
    Select Case LibChoixRente
    Case "RVD"
      'RVD_N = annuit|fffd|X2(DateNaissX, DateNaissY1, AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif), DateDebRente, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
      'RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateDebRente, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , , DateFinDiff, Prorata, 0)
      RVD_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DebRenteProro, DateDebRente, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
      RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateDebRente, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , , DateFinDiff, Prorata, 0)
      
      'Ajout prorogation mai 2018 - cas de la pension SS liquid|fffd| avant l'|fffd|ch|fffd|ance
      RVD_N2 = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DebRenteProro, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
      RVI2 = annuit|fffd|X2(DateNaissX, DateNaissY1, DebRenteProro, DebRenteProro, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , , DateFinDiff, Prorata, 0)
      '------------------------
      
      If IdContrAssurance = "Avec" Then
        CoefB = (sDivNx(AgeX, AgeX, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeX, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8))
        CoefB = CoefB - (sDivNx(AgeX, AgeX + 1, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeX, AgeDebRente + NbAnn|fffd|esModif + 1 + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8)) * (1 + TxTech)
        CoefB = CoefB * 1 / (1 + TxTech) ^ (1 / 2) / RVD_N
      Else
        CoefB = 0
      End If
      
      If (NbMoisModif = 0 And NbAnn|fffd|esModif = 0) Or DebMois(Bar|fffd|me.Range("DateProro").Value + 1) = Bar|fffd|me.Range("DateDebRente").Value Then
        CoefA = 1
      Else
          If (Bar|fffd|me.Range("Formule").Value = "1.25% par an" Or Bar|fffd|me.Range("Formule").Value = "5% par an" Or Bar|fffd|me.Range("Formule").Value = "2% par an") Then
          CoefA = CoefPRORO(Bar|fffd|me.Range("Formule").Value)
          Else
           If DebRenteProro < DateDebRente Then 'si on avant l'|fffd|ch|fffd|ance
           CoefA = RVD_N2 / RVI2 'on anticipe
           Else
           CoefA = RVI / RVD_N 'sinon on proroge
           End If
          End If
      End If

    
    Case "CaF"
     ' RVI_N = annuit|fffd|X2(DateNaissX, DateNaissY1, AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif), AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
     ' RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateDebRente, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , , DateFinDiff, Prorata, 0)
     ' RVD_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DebRenteProro, DateDebRente, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
      
       RVI_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DebRenteProro, DebRenteProro, Tab1, Tab2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, NbMoisModif), NbAnn|fffd|esModif), Prorata, "Sans")
       RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateDebRente, Tab1, Tab2, 0, DateMinRev1, 0, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, DateTerme, , , , DateFinDiff, Prorata, 0)
            
       CoefB = 0
            
    If (NbMoisModif = 0 And NbAnn|fffd|esModif = 0) Or DebMois(Bar|fffd|me.Range("DateProro").Value + 1) = Bar|fffd|me.Range("DateDebRente").Value Then
        CoefA = 1
    Else
     '  If (Bar|fffd|me.Range("Formule").Value = "1.25% par an" Or Bar|fffd|me.Range("Formule").Value = "5% par an" Or Bar|fffd|me.Range("Formule").Value = "2% par an") Then
      '   CoefA = CoefPRORO(Bar|fffd|me.Range("Formule").Value)
      ' Else
      '  If DebRenteProro < DateDebRente Then
        CoefA = RVI / RVI_N
       ' Else
        'CoefA = RVI_N / RVI
        'End If
       'End If
    End If
    End Select 'fin du select prorogation

  Case "Anticipation"
    Select Case LibChoixRente
    Case "RVD"
      'RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, -NbMoisModif), -NbAnn|fffd|esModif), Prorata, "Sans")
      'RVD_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, -NbMoisModif), -NbAnn|fffd|esModif), Prorata, "Sans")
      RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, -NbMoisModif), -NbAnn|fffd|esModif), Prorata, "Sans")
      RVD_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, -NbMoisModif), -NbAnn|fffd|esModif), Prorata, "Sans")
      
      If IdContrAssurance = "Avec" Then
        CoefB = (sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeX, AnNaissX, Table1, TxReval, TxTech, TxTech, 8))
        CoefB = CoefB - (sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente + 1 - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeX + 1, AnNaissX, Table1, TxReval, TxTech, TxTech, 8)) * (1 + TxTech)
        CoefB = CoefB * 1 / (1 + TxTech) ^ (1 / 2) / RVI
      Else
        CoefB = 0
      End If
      CoefA = RVD_N / RVI
      
    Case "CaF"
      
      RVI = annuit|fffd|X2(DateNaissX, DateNaissY1, AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), AnPlus(MoisPlus(DateDebRente, -NbMoisModif), -NbAnn|fffd|esModif), Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, AnPlus(MoisPlus(DateFinDiff, -NbMoisModif), -NbAnn|fffd|esModif), Prorata, "Sans")
      
      'correction en RVI
      RVI_N = annuit|fffd|X2(DateNaissX, DateNaissY1, DateDebRente, DateDebRente, Table1, Table2, 0, DateMinRev1, 0, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, , , TxFraisDiff, DateFinDiff, Prorata, "Sans")

        CoefB = 0
      'End If
      CoefA = RVI_N / RVI
    End Select
  
  Case Else
    MsgBox "Bug code ProrogAnticip - contacter l'administrateur"
    Exit Function
  End Select
  If Range("LibAgeEffet") <> "Age contractuel de la rente" Then Range("LibAgeEffet") = "Age contractuel de la rente"
  
  Select Case ProrogAnticip
  Case "Prorogation": DateMsg = FinMois(DateCalcul, NbAnn|fffd|esModif * 12 + NbMoisModif) + 1 & " "
                         
                    'MsgDateProro = AnPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge)
                     MsgDateProro = MoisPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge * 12)
  
                       Bar|fffd|me.Shapes("CacheAnticipation").Visible = False
                       Bar|fffd|me.Shapes("CacheLimiteAge").Visible = False
                       Bar|fffd|me.Shapes("CacheFormule").Visible = False
  Case "Anticipation": DateMsg = FinMois(DateCalcul, -NbAnn|fffd|esModif * 12 - NbMoisModif) + 1 & " "
                       Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
                       Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True
                       Bar|fffd|me.Shapes("CacheFormule").Visible = True
  End Select
  
  If Range("Th|fffd|orie").Value <> DateMsg Then Range("Th|fffd|orie").Value = DateMsg

  If Bar|fffd|me.Range("DateProro").Value <> MsgDateProro Then Bar|fffd|me.Range("DateProro").Value = MsgDateProro
  
  If Bar|fffd|me.Range("Age_limite_de_prorogation") = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation") = 0 Then
    Bar|fffd|me.Shapes("CacheDateProro").Visible = True
    Else
    Bar|fffd|me.Shapes("CacheDateProro").Visible = False
  End If
   
  If Bar|fffd|me.Range("Formule") = "ACT_LIQ" Then
  Bar|fffd|me.Shapes("CachePensionSS").Visible = False
  Else
  Bar|fffd|me.Shapes("CachePensionSS").Visible = True
  End If
  
End If
  
  
If CoefA <> Bar|fffd|me.Range("CoefA").Value Then Bar|fffd|me.Range("CoefA").Value = CoefA
If CoefB <> Bar|fffd|me.Range("CoefB").Value Then Bar|fffd|me.Range("CoefB").Value = CoefB
'---- Affichage des |fffd|ges auxquels les primes d'inventaire sont calcul|fffd|es
If Not Bar|fffd|me.ModificationAge Then
  If DateDebRente < DateCalcul + 1 Then
    NbMoisCert = NbMoisPlein(DateDebRente, DateCalcul)
    If Range("LibPrimInv").Value <> "PRIME D'INVENTAIRE sur 1 t|fffd|te" Then Range("LibPrimInv").Value = "PRIME D'INVENTAIRE sur 1 t|fffd|te"
  Else
    Msg = ""
  End If
  Msg2 = ""
Else
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: Msg = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRente & "/" & AgeY1 & " ans"
  Case 0: Msg = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRente & " ans"
  End Select
  If Range("LibPrimInv").Value <> "PRIME D'INVENTAIRE sur 1 t|fffd|te" Then Range("LibPrimInv").Value = "PRIME D'INVENTAIRE sur 1 t|fffd|te"
  AgeEffetR|fffd|el = nbann|fffd|es2(DateNaissX, DateMsg)

  
  '*********************** Ajout du 13/02/07
  DateNaissXBis = ApproximAge(DateNaissX - 1, DateMsg, Approx)
  AgeDebRenteBis = nbann|fffd|es2(DateNaissXBis, DateMsg)
  DateNaissY1Bis = ApproximAge(DateNaissY1Ini - 1, DateMsg, Approx)
  AgeY1Bis = nbann|fffd|es2(DateNaissY1Bis, DateMsg)
  '***********************
  
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: Msg2 = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRenteBis & "/" & AgeY1Bis & " ans"
  Case 0: Msg2 = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRenteBis & " ans"
  End Select
  
  AnBis = annuit|fffd|X2(DateNaissXBis, DateNaissY1Bis, DateMsg, DateMsg, Table1, Table2, 0, DateMinRev1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
  
  If AnBis <> Bar|fffd|me.Range("Annuit|fffd|Bis").Value Then Bar|fffd|me.Range("Annuit|fffd|Bis").Value = AnBis
  
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
  
  An2Bis = annuit|fffd|X2(DateNaissXBis, DateNaissY1Bis, DateMsg, DateMsg, Table1, Table2, Txrev, DateMinRev1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, DateTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, DateFinDiff, Prorata, IdContrAssurance)
  
  CoefR|fffd|ducBis = AnBis / An2Bis
  
  If An2Bis <> Range("Annuit|fffd|BisRev").Value Then Range("Annuit|fffd|BisRev").Value = An2Bis
  End If

End If

If Msg <> Range("Msg").Value Then Range("Msg").Value = Msg

If Msg2 <> Range("Message2").Value Then Range("Message2").Value = Msg2

If CoefR|fffd|ducBis <> Range("CoefR|fffd|ducBis").Value Then Range("CoefR|fffd|ducBis").Value = CoefR|fffd|ducBis

'---- Age des assur|fffd|s |fffd| date de calcul
Select Case LibChoixRente
Case "RVD", "CaF"
  
  If Not Bar|fffd|me.ModificationAge Then
    Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
    Case 0: If Bar|fffd|me.Range("Age").Value <> nbann|fffd|es2(DateNaissX, DateCalcul) Then Bar|fffd|me.Range("Age").Value = nbann|fffd|es2(DateNaissX, DateCalcul)
    Case 1: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es2(DateNaissX, DateCalcul), 3) & " // " & Arrondi(nbann|fffd|es2(DateNaissY1, DateCalcul), 3) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es2(DateNaissX, DateCalcul), 3) & " // " & Arrondi(nbann|fffd|es2(DateNaissY1, DateCalcul), 3)
    End Select
  Else
  
    Select Case ProrogAnticip
    Case "Prorogation": d = FinMois(DateCalcul, NbAnn|fffd|esModif * 12 + NbMoisModif) + 1
    Case "Anticipation": d = FinMois(DateCalcul, -NbAnn|fffd|esModif * 12 - NbMoisModif) + 1
    End Select
    
    If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es2(DateNaissX, d), 5) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es2(DateNaissX, d), 5)
  End If
Case "RVI", "RTI"
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 0: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es2(DateNaissX, DateDebRente), 7) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es2(DateNaissX, DateDebRente), 7)
  Case 1: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es2(DateNaissX, DateDebRente), 3) & " // " & Arrondi(nbann|fffd|es2(DateNaissY1, DateDebRente), 3) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es2(DateNaissX, DateDebRente), 3) & " // " & Arrondi(nbann|fffd|es2(DateNaissY1, DateDebRente), 3)
  End Select
End Select

'---- Transformation Capital - Rente
Cap83 = Bar|fffd|me.Range("Capital83").Value
Rte39 = Bar|fffd|me.Range("Rente39").Value
Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 1: Rte83 = 0
        Select Case Bar|fffd|me.ModificationAge
        Case False: If An2 > 0 Then Rte83 = Cap83 / An2
                    Cap39 = Rte39 * An2
        Case True:  If An2Bis > 0 Then Rte83 = Cap83 / An2Bis
                    Cap39 = Rte39 * An2Bis
        End Select
Case 0: Rte83 = 0
        Select Case Bar|fffd|me.ModificationAge
        Case False: If An > 0 Then Rte83 = Cap83 / An
                    Cap39 = Rte39 * An
        Case True:  If AnBis > 0 Then Rte83 = Cap83 / AnBis
                    Cap39 = Rte39 * AnBis
        End Select
End Select
If Bar|fffd|me.Range("Rente83").Value <> Rte83 Then Bar|fffd|me.Range("Rente83").Value = Rte83
If Bar|fffd|me.Range("Capital39").Value <> Cap39 Then Bar|fffd|me.Range("Capital39").Value = Cap39
If NbAnGar <> 0 Then
  If Bar|fffd|me.Range("LibAnGar").Value <> "dont " & Int(Rte83 * An2 * 100 + 0.5) / 100 & " CC des annuit|fffd|s certaines" Then Bar|fffd|me.Range("LibAnGar").Value = "dont " & Int(Rte83 * An2 * 100 + 0.5) / 100 & " CC des annuit|fffd|s certaines"
Else
  If Bar|fffd|me.Range("LibAnGar").Value <> "" Then Bar|fffd|me.Range("LibAnGar").Value = ""
End If

'----Calcul Rattrapage et PM

If ProrogAnticip = "Prorogation" Then
 Bar|fffd|me.Shapes("CachePM").Visible = False
  
  'If (Bar|fffd|me.Range("Pension_SS").Value <> 0 And Bar|fffd|me.Range("Pension_SS").Value <> "" And Bar|fffd|me.Range("Pension_SS").Value > LimiteAge) Then
  rattrapage = Bar|fffd|me.Range("RenteProro").Value * Maxi(AgeDebRenteBis - Maxi(LimiteAge, Bar|fffd|me.Range("Pension_SS")), 0)
   
  PM = Bar|fffd|me.Range("rattrapage").Value + Bar|fffd|me.Range("RenteProro").Value * Bar|fffd|me.Range("Annuit|fffd|Bis").Value
Else
  Bar|fffd|me.Shapes("CachePM").Visible = True
End If

If Bar|fffd|me.Range("rattrapage").Value <> Arrondi(rattrapage, 3) Then Bar|fffd|me.Range("rattrapage").Value = Arrondi(rattrapage, 3)

If Bar|fffd|me.Range("PM").Value <> PM Then Bar|fffd|me.Range("PM").Value = PM

exitFunction:
End Function

Public Function CoefPRORO(ch As String) As Double
Dim LimiteAge As Double, Echeance As Double
If Bar|fffd|me.Range("Age_limite_de_prorogation").Value = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation").Value = 0 Then
  LimiteAge = 75
Else
  LimiteAge = Range("Age_limite_de_prorogation").Value
End If
Echeance = Range("AgeDebRente").Value
If Bar|fffd|me.Range("ApproxAge").Value = "Age exact" Then
    If ch = "1.25% par an" Then CoefPRORO = 1 + 0.0125 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif")))
    If ch = "2% par an" Then CoefPRORO = 1 + 0.02 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif")))
    If ch = "5% par an" Then CoefPRORO = 1 + 0.05 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif")))
Else
    If ch = "1.25% par an" Then CoefPRORO = 1 + 0.0125 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif") + Bar|fffd|me.Range("NbMoisModif") / 12))
    If ch = "2% par an" Then CoefPRORO = 1 + 0.02 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif") + Bar|fffd|me.Range("NbMoisModif") / 12))
    If ch = "5% par an" Then CoefPRORO = 1 + 0.05 * (Mini((LimiteAge - Echeance), Bar|fffd|me.Range("NbAnn|fffd|esModif") + Bar|fffd|me.Range("NbMoisModif") / 12))
End If
End Function


Public Function CqChoixRente()
ChoixRente = Range("ChoixRente").Value
Select Case ChoixRente
Case 1: LibChoixRente = "RVI"
Case 2: LibChoixRente = "RVD"
Case 3: LibChoixRente = "CaF"
Case 4: LibChoixRente = "RTI"
End Select
Select Case LibChoixRente
Case "RVI"
  Bar|fffd|me.Shapes("CacheRteImm|fffd|diate").Visible = True
  Bar|fffd|me.Shapes("CacheTerme").Visible = True
Case "RVD"
  Bar|fffd|me.Shapes("CacheRteImm|fffd|diate").Visible = False
  Bar|fffd|me.Shapes("CacheTerme").Visible = True
Case "CaF"
  Bar|fffd|me.Shapes("CacheRteImm|fffd|diate").Visible = False
  Bar|fffd|me.Shapes("CacheTerme").Visible = True
Case "RTI"
  Bar|fffd|me.Shapes("CacheRteImm|fffd|diate").Visible = True
  Bar|fffd|me.Shapes("CacheTerme").Visible = False
  If Bar|fffd|me.Range("DateDebRente").Value <> Bar|fffd|me.Range("DateCalcul").Value + 1 Then
    Bar|fffd|me.Range("DateDebRente").Value = Bar|fffd|me.Range("DateCalcul").Value + 1
  End If
End Select
End Function

Public Function DateRevalos(DateEffet As Date, DateCalcul As Date, DateAnnivRevalo As Date)
Dim d As Date, Txt As String
d = DateSerial(Year(DateEffet), Month(DateAnnivRevalo), Day(DateAnnivRevalo))
If d <= DateEffet Then d = AnPlus(d, 1)
While d < DateCalcul
  Txt = Txt & d & " - "
  d = AnPlus(d, 1)
Wend
If Txt <> "" Then Txt = Left(Txt, Len(Txt) - 3)
DateRevalos = Txt
End Function

Public Function TxTechMaxVigueur(DateEffetRente As Date)
Select Case DateEffetRente
Case Is < DateSerial(2007, 10, 1): TxTechMaxVigueur = 2.25 / 100
Case Is < DateSerial(2009, 4, 1): TxTechMaxVigueur = 2.5 / 100
Case Is < DateSerial(2010, 7, 1): TxTechMaxVigueur = 2.25 / 100
Case Is < DateSerial(2011, 1, 1): TxTechMaxVigueur = 2 / 100
Case Is < DateSerial(2011, 7, 1): TxTechMaxVigueur = 1.75 / 100
Case Is < DateSerial(2012, 4, 1): TxTechMaxVigueur = 2 / 100
Case Is < DateSerial(2012, 10, 1): TxTechMaxVigueur = 1.75 / 100
Case Is < DateSerial(2013, 1, 1): TxTechMaxVigueur = 1.5 / 100
Case Is < DateSerial(2014, 10, 1): TxTechMaxVigueur = 1.25 / 100
Case Is < DateSerial(2015, 1, 1): TxTechMaxVigueur = 1 / 100
Case Is < DateSerial(2015, 4, 1): TxTechMaxVigueur = 0.75 / 100
Case Is < DateSerial(2016, 8, 1): TxTechMaxVigueur = 0.5 / 100
Case Is >= DateSerial(2016, 8, 1): TxTechMaxVigueur = 0.25 / 100
Case Else: MsgBox "cas non pr|fffd|vu"
End Select
End Function

Public Function TableVigueur(DateEffetRente As Date)
Select Case Year(DateEffetRente)
Case Is <= 2006: TableVigueur = "TPG"
Case Is >= 2007: TableVigueur = "TGHF05"
End Select
End Function

Public Function CalcDateEffet(Syst|fffd|me As String, DateEval As Date, CotisMoisEnCours As Boolean, JourEffet As String)
CalcDateEffet = 0
Select Case Syst|fffd|me
Case "Macao"
  Select Case JourEffet
  Case "Mois":      CalcDateEffet = DebMois(DateEval)
  Case "Trimestre": CalcDateEffet = DebTrim(DateEval)
  End Select
Case "Axiome"
  Select Case CotisMoisEnCours
  Case False: CalcDateEffet = DebMois(DateEval)
  Case True:  CalcDateEffet = MoisPlus(DebMois(DateEval), 1)
  End Select
End Select
End Function

Function BouHelpCalcul()
Dim Txt As String
Txt = "Minimum r|fffd|version :"
Txt = Txt & Chr(13) & "            date |fffd| partir de laquelle la pension de r|fffd|version est vers|fffd|e" & Chr(13)
Txt = Txt & Chr(13) & "Terme (tempo) :"
Txt = Txt & Chr(13) & "            date de fin de rente (pour faire des rentes temporaires !)" & Chr(13)
Txt = Txt & Chr(13) & "Fin Garantie :"
Txt = Txt & Chr(13) & "            date de fin d'annuit|fffd|s garantie (5, 10 ou 15 ans sup|fffd|rieure |fffd| la date d'effet de la rente" & Chr(13)
Txt = Txt & Chr(13) & "ApproxAge : "
Txt = Txt & Chr(13) & "            1 = |fffd|ge arrondi |fffd| l'entier le plus proche"
Txt = Txt & Chr(13) & "            4 = |fffd|ge arrondi au trimestre le plus proche ..."
Txt = Txt & Chr(13) & "            12 = |fffd|ge arrondi au mois le plus proche ..."
Txt = Txt & Chr(13) & "            10 = |fffd|ge entier atteint"
Txt = Txt & Chr(13) & "            40 = |fffd|ge au trimestre atteint"
Txt = Txt & Chr(13) & "            0 = |fffd|ge au jours pr|fffd|s" & Chr(13)
Txt = Txt & Chr(13) & "Table de mortalit|fffd| :"
Txt = Txt & Chr(13) & "                     TPG, TGH05, TGF05 ..."
Txt = Txt & Chr(13) & "                     amTGH0501 : 1er 1/15|fffd|me d'amortissement TPG => TGH05"
Txt = Txt & Chr(13) & "                     amTGH0514 : 14/15|fffd|me d'amortissement TPG => TGH05"
Txt = Txt & Chr(13) & "                     amTGH0500 = TPG et amTGH0515 = TGH05"
Txt = Txt & Chr(13) & "           idem   amTGF0505 = 5/15|fffd|me d'amortissement TPG => TGF05"
Txt = Txt & Chr(13) & "             et     amTV05 = 5/7|fffd|me d'amortissement TVG => TPG"
MsgBox Txt, , "Help en ligne"
End Function

Public Function MajAnnuit|fffd|SansAgeExact()
Dim DateNaissX As Date, DateCalcul As Date, Table1 As String, Table2 As String
Dim TxTech As Double, Fractionnement As String, Frac As Integer, Txrev As Double
Dim DateNaissY1 As Date, DateNaissY2 As Date, DurMariage1 As Double, Msg As String, Msg2 As String
Dim DurMariage2 As Double, DateDebRente As Date, DateTerme As Date, NbAnGar As Integer
Dim TxCroissRte70_75 As Double, Terme As String, An As Double, TxFraisRente As Double
Dim Approx As Integer, CoefReduc As Double, AgeTerme As Double, An2 As Double
Dim ProrataD|fffd|c|fffd|s As String, IdContrAssurance As String, DateFinGar As Date
Dim ProrogAnticip As String, NbAnn|fffd|esModif As Integer, NbMoisModif As Integer
Dim TxFraisDiff As Double, DateFinDiff As Date, AgeMinRev As Double, AnRvi As Double
Dim RVD_N1 As Double, RVI As Double, RVD_N As Double, RVI_N As Double, AgeDebRente As Double, AgeEffetR|fffd|el As Double, RVI2 As Double, RVD_N2 As Double, RVI_N2 As Double
Dim CoefA As Double, CoefB As Double, DateMinRev1 As Date, DateMinRev2 As Date
Dim ContrAssurance As String, Prorata As String, TxReval As Double, Sexe As String
Dim Rte83 As Double, Rte39 As Double, Cap83 As Double, Cap39 As Double, NbMoisCert As Integer
Dim NbMoisTh As Integer, DateNaissXini As Date, d As Date, DateMsg As Date
Dim AgeX As Double, AgeY1 As Double, AgeY2 As Double, AgeFinGar As Double, AgeFinDiff As Double
Dim AnNaissX As Integer, AnNaissY1 As Integer, AnNaissY2 As Integer
Dim AnBis As Double, An2Bis As Double, CoefR|fffd|ducBis As Double, DateNaissXBis As Date
Dim AgeDebRenteBis As Double, DateNaissY1Bis As Date, AgeY1Bis As Double, DateNaissY1Ini As Date
Dim NumContract As String, MsgEch As Double, MsgFormule As String
Dim rattrapage As Double, PM As Double, MsgDateProro As Date, LimiteAge As Double, AgeDebRenteProro As Double, DebRenteProro As Date
Dim Tab1 As String, Tab2 As String, TxVigueur As Double

CqChoixRente
ApproxAge = Bar|fffd|me.Range("ApproxAge").Value
NumContract = Bar|fffd|me.Range("RPP").Value
TxVigueur = Bar|fffd|me.Range("TauxVigueur").Value

Select Case ApproxAge
  Case "Age entier le + proche": Approx = 1
  Case "Semest. + proche": Approx = 2
  Case "Trim + proche": Approx = 4
  Case "Mois + proche": Approx = 12
  'Case "Date exacte": Approx = 0
  Case "Age entier atteint": Approx = 10
  Case "Semest. atteint": Approx = 20
  Case "Trim atteint": Approx = 40
  Case "Mois atteint": Approx = 120
End Select
DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
AnNaissX = Year(DateNaissX)
'---- Date de calcul
DateDebRente = DebMois(Bar|fffd|me.Range("DateDebRente").Value + 1)
DateCalcul = FinMois(Bar|fffd|me.Range("DateCalcul").Value - 1)
Select Case LibChoixRente
Case "RVI":
Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True
            Bar|fffd|me.Shapes("CacheFormule").Visible = True
If DateDebRente > DateCalcul + 1 Then DateCalcul = DateDebRente - 1
            Select Case DateDebRente = DateCalcul + 1
            Case True:  Range("DateCalcul").Interior.ColorIndex = xlNone
            Case False: Range("DateCalcul").Interior.ColorIndex = 15
            End Select
                        Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True
            Bar|fffd|me.Shapes("CacheFormule").Visible = True

Case "RVD": Select Case Bar|fffd|me.ModificationAge
            Case True:  DateCalcul = DateDebRente - 1
            Case False: DateCalcul = Bar|fffd|me.Range("DateCalcul").Value
            End Select
            Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True
            Bar|fffd|me.Shapes("CacheFormule").Visible = True

Case "CaF": Select Case Bar|fffd|me.ModificationAge
            Case True:  DateCalcul = DateDebRente - 1
            Case False: DateCalcul = Bar|fffd|me.Range("DateCalcul").Value
            End Select
            Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
            Bar|fffd|me.Shapes("CacheLimiteAge").Visible = True
            Bar|fffd|me.Shapes("CacheFormule").Visible = True

Case "RTI": DateCalcul = DateDebRente - 1
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select

'--- proro
Select Case Bar|fffd|me.Range("Sexe").Value
 Case "H/F":  Tab1 = "TGH05"
              Tab2 = "TGF05"
 Case "F/H":  Tab1 = "TGF05"
              Tab2 = "TGH05"
 Case "H/H":  Tab1 = "TGH05"
              Tab2 = "TGH05"
Case Else:    Tab1 = "TGF05"
              Tab2 = "TGF05"
End Select
'-----

DateNaissXini = DateNaissX
DateNaissX = ApproximAge(DateNaissX - 1, DateCalcul, Approx)
AgeX = nbann|fffd|es(DateNaissX, DateCalcul)
AgeDebRente = nbann|fffd|es(DateNaissX, DateDebRente)
If Day(DateCalcul) = 1 Then DateCalcul = DateCalcul - 1
If FinMois(DateCalcul) <> DateCalcul Then DateCalcul = FinMois(DateCalcul - 1)
If DateDebRente <> Bar|fffd|me.Range("DateDebRente").Value Then Bar|fffd|me.Range("DateDebRente").Value = DateDebRente
If DateCalcul <> Bar|fffd|me.Range("DateCalcul").Value Then Bar|fffd|me.Range("DateCalcul").Value = DateCalcul
If AgeDebRente <> Bar|fffd|me.Range("AgeDebRente").Value Then Bar|fffd|me.Range("AgeDebRente").Value = AgeDebRente


'---- Modification d'affichage concernant la contrassurance
If (DateDebRente > DateCalcul + 1 Or Bar|fffd|me.ModificationAge) And LibChoixRente <> "CaF" Then
  Bar|fffd|me.Shapes("CacheContrAssurance").Visible = False
  Select Case Bar|fffd|me.Range("ContrAss").Value
  Case "Avec": IdContrAssurance = "Avec"
  Case "Sans": IdContrAssurance = "Sans"
  Case Else
    MsgBox "Erreur ContrAssurance - contacter l'administrateur"
    Exit Function
  End Select
Else
  Bar|fffd|me.Shapes("CacheContrAssurance").Visible = True
  IdContrAssurance = "Sans"
End If
'---- Tables de mortalit|fffd|
Table1 = Bar|fffd|me.Range("Table").Value
Table2 = Table1
Sexe = Bar|fffd|me.Range("Sexe").Value
Select Case Table1
Case "TGHF05"
  Select Case Sexe
  Case "H/F": Table1 = "TGH05"
              Table2 = "TGF05"
  Case "F/H": Table1 = "TGF05"
              Table2 = "TGH05"
  Case "H/H": Table1 = "TGH05"
              Table2 = "TGH05"
  Case "F/F": Table1 = "TGF05"
              Table2 = "TGF05"
  Case Else: MsgBox "Bug table"
  End Select
Case "TPG+x/15.TGHF05"
  If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
    Select Case Sexe
    Case "H/F": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/H": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "H/H": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/F": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
    Case Else:  MsgBox "Bug table"
    End Select
  Else
    Select Case Sexe
    Case "H/F": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/H": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "H/H": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
    Case "F/F": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
    Case Else:  MsgBox "Bug table"
    End Select
  End If
Case "TV+x/7.TPG"
  If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
    Table1 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
    Table2 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
  Else
    Table1 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
    Table2 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
  End If
End Select

'---- Affichage des alertes
If (Year(DateDebRente) <= 2006 And Table1 <> "TPG") Or (Year(DateDebRente) >= 2007 And (Table1 = "TPG" Or Table1 = "TV8890" Or Table1 = "TV7377")) Then
  If Range("AvTable").Value <> " =>" Then Range("AvTable").Value = " =>"
Else
  If Range("AvTable").Value <> "" Then Range("AvTable").Value = ""
End If
If DateDebRente - DateCalcul <> 1 Then
  If Range("AvDateCalcul").Value <> " =>" Then Range("AvDateCalcul").Value = " =>"
Else
  If Range("AvDateCalcul").Value <> "" Then Range("AvDateCalcul").Value = ""
End If
If Range("TxFraisRente").Value <> 0.03 Then
  If Range("AvTxFraisRente").Value <> " =>" Then Range("AvTxFraisRente").Value = " =>"
Else
  If Range("AvTxFraisRente").Value <> "" Then Range("AvTxFraisRente").Value = ""
End If
Select Case Range("TxFraisDiff").Value
Case 0.00075: If Range("AvTxFraisDiff").Value <> "" Then Range("AvTxFraisDiff").Value = ""
Case 0.0005: If Range("AvTxFraisDiff").Value <> "IBM" Then Range("AvTxFraisDiff").Value = "IBM"
Case Else: If Range("AvTxFraisDiff").Value <> " =>" Then Range("AvTxFraisDiff").Value = " =>"
End Select
If Range("Fractionnement").Value <> "Trimestriel" Then
  If Range("AvFractionnement").Value <> " =>" Then Range("AvFractionnement").Value = " =>"
Else
  If Range("AvFractionnement").Value <> "" Then Range("AvFractionnement").Value = ""
End If
If Range("Terme").Value <> "Echu" Then
  If Range("AvTerme").Value <> " =>" Then Range("AvTerme").Value = " =>"
Else
  If Range("AvTerme").Value <> "" Then Range("AvTerme").Value = ""
End If
If Range("ProrataD|fffd|c|fffd|s").Value <> "Sans" Then
  If Range("AvProrataD|fffd|c|fffd|s").Value <> " =>" Then Range("AvProrataD|fffd|c|fffd|s").Value = " =>"
Else
  If Range("AvProrataD|fffd|c|fffd|s").Value <> "" Then Range("AvProrataD|fffd|c|fffd|s").Value = ""
End If
If Range("ContrAss").Value <> "Sans" Then
  If Range("AvContrAss").Value <> " =>" Then Range("AvContrAss").Value = " =>"
Else
  If Range("AvContrAss").Value <> "" Then Range("AvContrAss").Value = ""
End If
'---- Param|fffd|tres de calcul de l'annuit|fffd|
TxReval = 0
TxTech = Bar|fffd|me.Range("TxTech").Value
Terme = Bar|fffd|me.Range("Terme").Value
Select Case Terme
Case "Echu":   ProrataD|fffd|c|fffd|s = Bar|fffd|me.Range("ProrataD|fffd|c|fffd|s").Value
               Select Case ProrataD|fffd|c|fffd|s
               Case "Sans": Prorata = "Sans"
               Case "Proportionnel": Prorata = "Prop"
               Case "Complet": Prorata = "COMP"
               End Select
Case "Avance": Prorata = "Sans"
Case Else:     MsgBox "Terme inconnu : " & Terme
End Select
Select Case LibChoixRente
Case "RVI": AgeTerme = 0
Case "RVD": AgeTerme = 0
Case "CaF": AgeTerme = 0
Case "RTI": AgeTerme = Bar|fffd|me.Range("AgeTerme").Value
            If AgeTerme <> 0 Then DateTerme = AnPlus(DateNaissX, AgeTerme) - 1
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select
Fractionnement = Bar|fffd|me.Range("Fractionnement").Value
Select Case Range("Fractionnement").Value
  Case "Mensuel": Frac = 12
  Case "Trimestriel": Frac = 4
  Case "Semestriel": Frac = 2
  Case "Annuel": Frac = 1
  Case Else
    MsgBox "Fractionnement inconnu : " & Fractionnement
End Select
DateFinDiff = DateDebRente - 1
AgeFinDiff = AgeDebRente
TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
Select Case LibChoixRente
Case "RVI": TxFraisDiff = 0
Case "RVD": TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Case "CaF": TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Case "RTI": TxFraisDiff = 0
Case Else:  MsgBox "Choix de type de rente inconnu - Contacter l'administrateur"
            Exit Function
End Select

'---- Particularit|fffd|s |fffd|ventuelles (annuit|fffd|s garanties ou rente croissante)
Select Case LibChoixRente
Case "RVI"
  Select Case Bar|fffd|me.Range("ChkParticularit|fffd|").Value
  Case 1:     NbAnGar = Bar|fffd|me.Range("NbAnGar").Value
              DateFinGar = AnPlus(DateDebRente, NbAnGar) - 1
              AgeFinGar = AgeDebRente + NbAnGar
              TxCroissRte70_75 = Bar|fffd|me.Range("TxCroissRte70_75").Value
              If NbAnGar <> 0 And TxCroissRte70_75 <> 0 Then
                MsgBox "Les contrats ne proposent pas de choisir |fffd| la fois Annuit|fffd|es garanties ET Croissance de la rente par palier" & Chr(13) & Chr(13) & " => Ces deux param|fffd|tres ont |fffd|t|fffd| r|fffd|initialis|fffd|s |fffd| 0"
                TxCroissRte70_75 = 0
                Bar|fffd|me.Range("TxCroissRte70_75").Value = 0
                NbAnGar = 0
                Bar|fffd|me.Range("NbAnGar").Value = 0
              End If
  Case False: NbAnGar = 0
              TxCroissRte70_75 = 0
  Case Else:  MsgBox "Pb identication choix particularit|fffd| - contacter l'administrateur"
              Exit Function
  End Select
  
  '--- ajout CFTI Annuit|fffd|s garanties
Case "CaF"

Select Case Bar|fffd|me.Range("ChkParticularit|fffd|").Value
  Case 1:     NbAnGar = Bar|fffd|me.Range("NbAnGar").Value
              DateFinGar = AnPlus(DateDebRente, NbAnGar) - 1
              AgeFinGar = AgeDebRente + NbAnGar
              TxCroissRte70_75 = 0
  Case False: NbAnGar = 0
              TxCroissRte70_75 = 0
  Case Else:  MsgBox "Pb identication choix particularit|fffd| - contacter l'administrateur"
              Exit Function
  End Select
'------------------
Case Else
  NbAnGar = 0
  TxCroissRte70_75 = 0
End Select

'---- R|fffd|version
Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 1
  Txrev = Bar|fffd|me.Range("TxRev").Value
  DateNaissY1 = Bar|fffd|me.Range("DateNaissY1").Value
  DateNaissY1Ini = Bar|fffd|me.Range("DateNaissY1").Value
  AnNaissY1 = Year(DateNaissY1)
  DateNaissY1 = ApproximAge(DateNaissY1, DateCalcul, Approx)
  AgeY1 = nbann|fffd|es(DateNaissY1, DateCalcul)
  AgeMinRev = 0
  DateMinRev1 = AnPlus(DateNaissY1, AgeMinRev)
  Select Case Bar|fffd|me.ExistR|fffd|version2
  Case True
    DateNaissY2 = Bar|fffd|me.Range("DateNaissY2").Value
    AnNaissY2 = Year(DateNaissY2)
    DateNaissY2 = ApproximAge(DateNaissY2, DateCalcul, Approx)
    AgeY2 = nbann|fffd|es(DateNaissY2, DateCalcul)
    DateMinRev2 = AnPlus(DateNaissY2, AgeMinRev)
    DurMariage1 = Bar|fffd|me.Range("DurMariage1").Value
    DurMariage2 = Bar|fffd|me.Range("DurMariage2").Value
    An = sAnnuit|fffd|3(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeY2, AnNaissY2, AgeDebRente, Table1, Table2, 0, AgeMinRev, DurMariage1, DurMariage2, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    An2 = sAnnuit|fffd|3(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeY2, AnNaissY2, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, DurMariage1, DurMariage2, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  Case False
    An = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, 0, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    An2 = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  Case Else
    MsgBox "Pb identication code r|fffd|version 1 - contacter l'administrateur"
    Exit Function
  End Select
Case 0
  An = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  If NbAnGar <> 0 Then
    An2 = An - sannuit|fffd|1(AgeX, AgeFinGar, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  Else
    An2 = An
  End If
  CoefReduc = 1
  CoefR|fffd|ducBis = 1
Case Else
  MsgBox "Pb identication code r|fffd|version 1 - contacter l'administrateur"
  Exit Function
End Select
If An <> Bar|fffd|me.Range("Annuit|fffd|").Value Then Bar|fffd|me.Range("Annuit|fffd|").Value = An
If CStr(An2) <> CStr(Bar|fffd|me.Range("Annuit|fffd|Rev").Value) Then Bar|fffd|me.Range("Annuit|fffd|Rev").Value = An2

'---- Coefficient de r|fffd|duction
If An <> 0 And (Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Or DateFinGar > 0 Or TxCroissRte70_75) Then
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: CoefReduc = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance) / An2
  Case 0: CoefReduc = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance) / An
  End Select
  CoefR|fffd|ducBis = CoefReduc
End If
If CoefReduc <> Bar|fffd|me.Range("CoefR|fffd|duc").Value Then Bar|fffd|me.Range("CoefR|fffd|duc").Value = CoefReduc


'---- Anticipation et Prorogation
CoefA = 1
CoefB = 0
If Not Bar|fffd|me.ModificationAge Then
  If Range("LibAgeEffet") <> "Age d'effet r|fffd|el de la rente" Then Range("LibAgeEffet") = "Age d'effet r|fffd|el de la rente"
  If Range("Th|fffd|orie").Value <> "" Then Range("Th|fffd|orie").Value = ""
  
  
    If Bar|fffd|me.Range("Age_limite_de_prorogation").Value <> "" Then Bar|fffd|me.Range("Age_limite_de_prorogation").Value = ""
  If Bar|fffd|me.Range("Formule").Value <> "" Then Bar|fffd|me.Range("Formule").Value = ""
  If Bar|fffd|me.Range("DateProro").Value <> "" Then Bar|fffd|me.Range("DateProro").Value = ""
  If Bar|fffd|me.Range("Pension_SS").Value <> "" Then Bar|fffd|me.Range("Pension_SS").Value = ""
Else
  ProrogAnticip = Bar|fffd|me.Range("ProrogAnticip").Value
  NbAnn|fffd|esModif = Bar|fffd|me.Range("NbAnn|fffd|esModif").Value
  NbMoisModif = Bar|fffd|me.Range("NbMoisModif").Value
'-------------
  Select Case ProrogAnticip
  Case "Prorogation"
  
  If Bar|fffd|me.Range("Formule") = "ACT_LIQ" Then
    If Bar|fffd|me.Range("Pension_SS").Value = "" Or Bar|fffd|me.Range("Pension_SS").Value = 0 Then
      LimiteAge = Bar|fffd|me.Range("Age_limite_de_prorogation").Value
      If Bar|fffd|me.Range("Age_limite_de_prorogation").Value = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation").Value = 0 Then
         LimiteAge = 75
      End If
   Else
      If Bar|fffd|me.Range("Age_limite_de_prorogation").Value = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation").Value = 0 Then
         LimiteAge = Bar|fffd|me.Range("Pension_SS")
      If Bar|fffd|me.Range("Pension_SS").Value = "" Or Bar|fffd|me.Range("Pension_SS").Value = 0 Then
         LimiteAge = 75
      End If
      Else
      LimiteAge = Mini(Bar|fffd|me.Range("Pension_SS").Value, Bar|fffd|me.Range("Age_limite_de_prorogation").Value)
      End If
  End If
  Else
 If Bar|fffd|me.Range("Age_limite_de_prorogation").Value = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation").Value = 0 Then
    LimiteAge = 75
 Else
 LimiteAge = Bar|fffd|me.Range("Age_limite_de_prorogation")
 End If
End If
 '---------------------
         
    If (AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12) > LimiteAge Then
      DebRenteProro = ApproximAge(AnPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge), DateCalcul, Approx)
    Else
       DebRenteProro = AnPlus(MoisPlus(DateDebRente, NbMoisModif), NbAnn|fffd|esModif)
    End If
    AgeDebRenteProro = nbann|fffd|es(Bar|fffd|me.Range("DateNaissX").Value, DebRenteProro)
'------------------
  
    Select Case LibChoixRente
    Case "RVD"
      'RVD_N = sannuit|fffd|1(AgeDebRente, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, Prorata, "Sans")
      'RVI = sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeFinDiff, Prorata, 0)
      
      RVD_N = sannuit|fffd|1(AgeDebRente, AgeDebRenteProro, AnNaissX, Tab1, TxReval, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRenteProro, Prorata, "Sans")
      RVI = sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaissX, Tab1, TxReval, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeFinDiff, Prorata, 0)
      
      '--- Ajout 05/18
      RVD_N2 = sannuit|fffd|1(AgeDebRenteProro, AgeDebRente, AnNaissX, Tab1, TxReval, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRenteProro, Prorata, "Sans")
      RVI2 = sannuit|fffd|1(AgeDebRenteProro, AgeDebRenteProro, AnNaissX, Tab1, TxReval, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeFinDiff, Prorata, 0)
      
      If IdContrAssurance = "Avec" Then
        CoefB = (sDivNx(AgeX, AgeX, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeX, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8))
        CoefB = CoefB - (sDivNx(AgeX, AgeX + 1, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeX, AgeDebRente + NbAnn|fffd|esModif + 1 + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8)) * (1 + TxTech)
        CoefB = CoefB * 1 / (1 + TxTech) ^ (1 / 2) / RVD_N
      Else
        CoefB = 0
      End If
      
    If (NbMoisModif = 0 And NbAnn|fffd|esModif = 0) Or (Bar|fffd|me.Range("DateProro").Value = Bar|fffd|me.Range("DateDebRente").Value) Then
       CoefA = 1
    Else
     If (Bar|fffd|me.Range("Formule").Value = "1.25% par an" Or Bar|fffd|me.Range("Formule").Value = "5% par an" Or Bar|fffd|me.Range("Formule").Value = "2% par an") Then
         CoefA = CoefPRORO(Bar|fffd|me.Range("Formule").Value)
       Else
           If DebRenteProro > DateDebRente Then
           CoefA = RVI / RVD_N
           Else
           CoefA = RVD_N2 / RVI2
           End If
       End If
    End If

    Case "CaF"
      'RVI_N = sannuit|fffd|1(AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, Prorata, "Sans")
      'RVI = sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeFinDiff, Prorata, 0)
      'RVD_N = sannuit|fffd|1(AgeDebRente, AgeDebRenteProro, AnNaissX, Tab1, TxReval, TxVigueur, TxVigueur, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRenteProro, Prorata, "Sans")
      
       RVI_N = sannuit|fffd|1(AgeDebRenteProro, AgeDebRenteProro, AnNaissX, Tab1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12, Prorata, "Sans")
       RVI = sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaissX, Tab1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeFinDiff, Prorata, 0)

        CoefB = 0
          If (NbMoisModif = 0 And NbAnn|fffd|esModif = 0) Or (Bar|fffd|me.Range("DateProro").Value = Bar|fffd|me.Range("DateDebRente").Value) Then
        CoefA = 1
    Else
       
      ' If (Bar|fffd|me.Range("Formule").Value = "1.25% par an" Or Bar|fffd|me.Range("Formule").Value = "5% par an" Or Bar|fffd|me.Range("Formule").Value = "2% par an") Then
       '  CoefA = CoefPRORO(Bar|fffd|me.Range("Formule").Value)
       'Else
       ' If DebRenteProro < DateDebRente Then
        CoefA = RVI / RVI_N
        'Else
        'CoefA = RVI_N / RVI
        'End If
      'End If
    End If
    
    End Select

  Case "Anticipation"
    Select Case LibChoixRente
    Case "RVD"
      RVI = sannuit|fffd|1(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, Prorata, "Sans")
      RVD_N = sannuit|fffd|1(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRente, Prorata, "Sans")
      If IdContrAssurance = "Avec" Then
        CoefB = (sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeX, AnNaissX, Table1, TxReval, TxTech, TxTech, 8))
        CoefB = CoefB - (sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente + 1 - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8) - sDivNx(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeX + 1, AnNaissX, Table1, TxReval, TxTech, TxTech, 8)) * (1 + TxTech)
        CoefB = CoefB * 1 / (1 + TxTech) ^ (1 / 2) / RVI
      Else
        CoefB = 0
      End If
      CoefA = RVD_N / RVI
    Case "CaF"
      RVI = sannuit|fffd|1(AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, 0, AgeDebRente - NbAnn|fffd|esModif - NbMoisModif / 12, Prorata, "Sans")
      RVI_N = sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, 0, 0, TxFraisDiff, AgeDebRente, Prorata, "Sans")

        CoefB = 0

      CoefA = RVI_N / RVI
    End Select
  Case Else
    MsgBox "Bug code ProrogAnticip - contacter l'administrateur"
    Exit Function
  End Select
  
  If Range("LibAgeEffet") <> "Age contractuel de la rente" Then Range("LibAgeEffet") = "Age contractuel de la rente"
  
  'xxxxxxxxxxxxxxxx
  
 Select Case ProrogAnticip
  Case "Prorogation": DateMsg = FinMois(DateCalcul, NbAnn|fffd|esModif * 12 + NbMoisModif) + 1 & " "
                      'MsgDateProro = ApproximAge(AnPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge), DateCalcul, Approx)
                       MsgDateProro = ApproximAge(MoisPlus(Bar|fffd|me.Range("DateNaissX").Value, LimiteAge * 12), DateCalcul, Approx)

                       Bar|fffd|me.Shapes("CacheAnticipation").Visible = False
                       Bar|fffd|me.Shapes("CacheLimiteAge").Visible = False
                       Bar|fffd|me.Shapes("CacheFormule").Visible = False
     
                   
                       
  Case "Anticipation": DateMsg = FinMois(DateCalcul, -NbAnn|fffd|esModif * 12 - NbMoisModif) + 1 & " "
                       Bar|fffd|me.Shapes("CacheAnticipation").Visible = True
  End Select
  If Range("Th|fffd|orie").Value <> DateMsg Then Range("Th|fffd|orie").Value = DateMsg

  If Bar|fffd|me.Range("DateProro").Value <> MsgDateProro Then Bar|fffd|me.Range("DateProro").Value = MsgDateProro
    If Bar|fffd|me.Range("Age_limite_de_prorogation") = "" Or Bar|fffd|me.Range("Age_limite_de_prorogation") = 0 Then
    Bar|fffd|me.Shapes("CacheDateProro").Visible = True
   Else
    Bar|fffd|me.Shapes("CacheDateProro").Visible = False
  End If
     If Bar|fffd|me.Range("Formule") = "ACT_LIQ" Then
   Bar|fffd|me.Shapes("CachePensionSS").Visible = False
   Else
   Bar|fffd|me.Shapes("CachePensionSS").Visible = True
   End If
End If
If CoefA <> Bar|fffd|me.Range("CoefA").Value Then Bar|fffd|me.Range("CoefA").Value = CoefA
If CoefB <> Bar|fffd|me.Range("CoefB").Value Then Bar|fffd|me.Range("CoefB").Value = CoefB

'---- Affichage des |fffd|ges auxquels les primes d'inventaire sont calcul|fffd|es
If Not Bar|fffd|me.ModificationAge Then
  If DateDebRente < DateCalcul + 1 Then
    NbMoisCert = NbMoisPlein(DateDebRente, DateCalcul)
    Msg = "[inclu "
    Select Case Int(NbMoisCert / 12)
    Case 0:
    Case 1: Msg = Msg & "1 an "
    Case Is > 1: Msg = Msg & Int(NbMoisCert / 12) & " ans "
    End Select
    If NbMoisCert - 12 * Int(NbMoisCert / 12) > 0 Then
      If Int(NbMoisCert / 12) > 0 Then Msg = Msg & "et "
      Msg = Msg & NbMoisCert - 12 * Int(NbMoisCert / 12) & " mois "
    End If
    Msg = Msg & "d'arr|fffd|rages certains]"
    If Range("LibPrimInv").Value <> "PRIME D'INVENTAIRE sur 1 t|fffd|te" Then Range("LibPrimInv").Value = "PRIME D'INVENTAIRE sur 1 t|fffd|te"
  Else
    Msg = ""
  End If
  Msg2 = ""
Else
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: Msg = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRente & "/" & AgeY1 & " ans"
  Case 0: Msg = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRente & " ans"
  End Select
  If Range("LibPrimInv").Value <> "PRIME D'INVENTAIRE sur 1 t|fffd|te" Then Range("LibPrimInv").Value = "PRIME D'INVENTAIRE sur 1 t|fffd|te"
  AgeEffetR|fffd|el = nbann|fffd|es(DateNaissX, DateMsg)

  
  '*********************** Ajout du 13/02/07
  DateNaissXBis = ApproximAge(DateNaissX - 1, DateMsg, Approx)
  AgeDebRenteBis = nbann|fffd|es(DateNaissXBis, DateMsg)
  DateNaissY1Bis = ApproximAge(DateNaissY1Ini - 1, DateMsg, Approx)
  AgeY1Bis = nbann|fffd|es(DateNaissY1Bis, DateMsg)
  '***********************
  
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 1: Msg2 = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRenteBis & "/" & AgeY1Bis & " ans"
  Case 0: Msg2 = "Ici Prime inv = Coef RVI |fffd| " & AgeDebRenteBis & " ans"
  End Select
  AnBis = sannuit|fffd|1(AgeDebRenteBis, AgeDebRenteBis, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
  If AnBis <> Bar|fffd|me.Range("Annuit|fffd|Bis").Value Then Bar|fffd|me.Range("Annuit|fffd|Bis").Value = AnBis
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
    An2Bis = sannuit|fffd|2(AgeDebRenteBis, AnNaissX, AgeY1Bis, AnNaissY1, AgeDebRenteBis, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    CoefR|fffd|ducBis = AnBis / An2Bis
    If An2Bis <> Range("Annuit|fffd|BisRev").Value Then Range("Annuit|fffd|BisRev").Value = An2Bis
  End If
End If
If Msg <> Range("Msg").Value Then Range("Msg").Value = Msg
If Msg2 <> Range("Message2").Value Then Range("Message2").Value = Msg2
If CoefR|fffd|ducBis <> Range("CoefR|fffd|ducBis").Value Then Range("CoefR|fffd|ducBis").Value = CoefR|fffd|ducBis
'---- Age des assur|fffd|s |fffd| date de calcul
Select Case LibChoixRente
Case "RVD", "CaF"
  If Not Bar|fffd|me.ModificationAge Then
    Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
    Case 0: If Bar|fffd|me.Range("Age").Value <> nbann|fffd|es(DateNaissX, DateCalcul) & "" Then Bar|fffd|me.Range("Age").Value = nbann|fffd|es(DateNaissX, DateCalcul) & ""
    Case 1: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es(DateNaissX, DateCalcul), 3) & " // " & Arrondi(nbann|fffd|es(DateNaissY1, DateCalcul), 3) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es(DateNaissX, DateCalcul), 3) & " // " & Arrondi(nbann|fffd|es(DateNaissY1, DateCalcul), 3)
    End Select
  Else
    Select Case ProrogAnticip
    Case "Prorogation": d = FinMois(DateCalcul, NbAnn|fffd|esModif * 12 + NbMoisModif) + 1
    Case "Anticipation": d = FinMois(DateCalcul, -NbAnn|fffd|esModif * 12 - NbMoisModif) + 1
    End Select
    If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es(DateNaissX, d), 5) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es(DateNaissX, d), 5)
  End If
Case "RVI", "RTI"
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  Case 0: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es(DateNaissX, DateDebRente), 7) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es(DateNaissX, DateDebRente), 7)
  Case 1: If Bar|fffd|me.Range("Age").Value <> Arrondi(nbann|fffd|es(DateNaissX, DateDebRente), 3) & " // " & Arrondi(nbann|fffd|es(DateNaissY1, DateDebRente), 3) Then Bar|fffd|me.Range("Age").Value = Arrondi(nbann|fffd|es(DateNaissX, DateDebRente), 3) & " // " & Arrondi(nbann|fffd|es(DateNaissY1, DateDebRente), 3)
  End Select
End Select
'---- Transformation Capital - Rente
Cap83 = Bar|fffd|me.Range("Capital83").Value
Rte39 = Bar|fffd|me.Range("Rente39").Value
Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 1: Rte83 = 0
        Select Case Bar|fffd|me.ModificationAge
        Case False: If An2 > 0 Then Rte83 = Cap83 / An2
                    Cap39 = Rte39 * An2
        Case True:  If An2Bis > 0 Then Rte83 = Cap83 / An2Bis
                    Cap39 = Rte39 * An2Bis
        End Select
Case 0: Rte83 = 0
        Select Case Bar|fffd|me.ModificationAge
        Case False: If An > 0 Then Rte83 = Cap83 / An
                    Cap39 = Rte39 * An
        Case True:  If AnBis > 0 Then Rte83 = Cap83 / AnBis
                    Cap39 = Rte39 * AnBis
        End Select
End Select
If Bar|fffd|me.Range("Rente83").Value <> Rte83 Then Bar|fffd|me.Range("Rente83").Value = Rte83
If Bar|fffd|me.Range("Capital39").Value <> Cap39 Then Bar|fffd|me.Range("Capital39").Value = Cap39
If NbAnGar <> 0 Then
  If Bar|fffd|me.Range("LibAnGar").Value <> "dont " & Int(Rte83 * An2 * 100 + 0.5) / 100 & " CC des annuit|fffd|s certaines" Then Bar|fffd|me.Range("LibAnGar").Value = "dont " & Int(Rte83 * An2 * 100 + 0.5) / 100 & " CC des annuit|fffd|s certaines"
Else
  If Bar|fffd|me.Range("LibAnGar").Value <> "" Then Bar|fffd|me.Range("LibAnGar").Value = ""
End If

'----Calcul Rattrapage et PM
If ProrogAnticip = "Prorogation" Then
 Bar|fffd|me.Shapes("CachePM").Visible = False
    'Modif
    rattrapage = Bar|fffd|me.Range("RenteProro").Value * Maxi((AgeDebRente + NbAnn|fffd|esModif + NbMoisModif / 12 - Maxi(LimiteAge, Bar|fffd|me.Range("Pension_SS"))), 0)
    PM = Bar|fffd|me.Range("rattrapage").Value + Bar|fffd|me.Range("RenteProro").Value * Bar|fffd|me.Range("Annuit|fffd|Bis").Value
  Else
  Bar|fffd|me.Shapes("CachePM").Visible = True
End If
If Bar|fffd|me.Range("rattrapage").Value <> Arrondi(rattrapage, 3) Then Bar|fffd|me.Range("rattrapage").Value = Arrondi(rattrapage, 3)
If Bar|fffd|me.Range("PM").Value <> PM Then Bar|fffd|me.Range("PM").Value = PM

Exit Function:
End Function

Attribute VB_Name = "Cartographie"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Choix_rente_bareme"
Attribute VB_Base = "0{10976BDA-2ACA-4D1B-A7EC-985F8D1AA01D}{833D60BD-30D6-4168-89B4-42526840169B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
'Sub Ouverture()
'
'Call Initialisation_Feuille_Synthese
'
' Load Choix_rente_bareme
' Choix_rente_bareme.Show
'End Sub
Private Sub Bouton_cliquez_ici_Click()

If Rente_83.Value = False And Rente_39.Value = False And Rente_82.Value = False Then
    MsgBox ("Vous devez choisir un type de rente !")
Else:
    Choix_rente_bareme.Hide
    Unload Choix_rente_bareme

    Load Formulaire
    Formulaire.Show
    
End If
End Sub


Private Sub Rente_39_Click()

If Range("Fractionnement_bar39").Value = "Annuel" Or Range("Fractionnement_bar39").Value = "Semestriel" Then
    MsgBox "D|fffd|sol|fffd|, l'outil n'|fffd|dite que les titres pour les rentes 39 mensuelles ou trimestrielles."
    Choix_rente_bareme.Hide
    Unload Choix_rente_bareme
    'Initialisation_Feuille_Synthese
    Exit Sub
End If

If Range("option_rente_bar39").Value <> "Non r|fffd|versible" And Range("option_rente_bar39").Value <> "R|fffd|versible" Then
   MsgBox "V|fffd|rifiez l'option de rente choisie. La rente 39 ne peut |fffd|tre que r|fffd|versible ou non r|fffd|versible"
    Choix_rente_bareme.Hide
    Unload Choix_rente_bareme
    Exit Sub
End If
If Rente_39.Value = True Then
    Rente_83.Value = False
    Rente_82.Value = False
    
    Range("Test_bar39") = 1 'On pr|fffd|cise qu'on prend les informations de cette colonne
Else:
    Range("Test_bar39") = ""
End If
End Sub

Private Sub Rente_83_Click()

If Rente_83.Value = True Then
    Rente_39.Value = False
    Rente_82.Value = False
    Range("Test_bar83") = 83 'On pr|fffd|cise qu'on prend les informations de cette colonne
Else:
    Range("Test_bar83") = ""
End If
End Sub
Private Sub Rente_82_Click()

If Rente_82.Value = True Then
    Rente_39.Value = False
    Rente_83.Value = False
    Range("Test_bar83") = 82 'On pr|fffd|cise qu'on prend les informations de cette colonne
Else:
    Range("Test_bar83") = ""
End If
End Sub


Attribute VB_Name = "ContratAHSM"
Attribute VB_Base = "0{62BA80FB-AB17-4EEB-A2CF-54C047050ED0}{D5F5C05B-FAC4-49E2-9619-20BA766D267C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Me.Hide
wHop.Visible = True
wHop.Select
Bar|fffd|me.Visible = False
End Sub

Private Sub CommandButton2_Click()
Me.Hide
H|fffd|pBis.Visible = True
H|fffd|pBis.Select
Bar|fffd|me.Visible = False
End Sub


Attribute VB_Name = "DependanceRef"
Attribute VB_Base = "0{D436A629-9430-4B86-96CE-B93B43BD94D5}{048AC103-7ADB-4F7A-9C7A-8AA815A83D1E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub TextBox1_Change()

End Sub

Private Sub CommandButton1_Click()
NContrat = DependanceRef.NumContrat.Value
Ref = DependanceRef.RefCG.Value
Adre = DependanceRef.Adresse.Value
FaitA1 = DependanceRef.FaitA.Value
Unload Me
End Sub

Attribute VB_Name = "Droits"

Sub ChangeDroits()
If UtilisateurIni <> "Gestion" Then
  Select Case Utilisateur
  Case "Tech": Utilisateur = "Gestion"
  Case Else:   Utilisateur = "Tech"
  End Select
  Call AfficheFenetres
End If
End Sub

Public Function AfficheFenetres()
Application.ScreenUpdating = False
Select Case Utilisateur
Case "Tech"
  Bar|fffd|me.Visible = True
  Bar|fffd|me.Select
  wMenu.Visible = 2
  wExact.Visible = True
  wEntier.Visible = True
  wD|fffd|tail.Visible = True
Case "Gestion"
  wMenu.Visible = True
  wMenu.Select
  Bar|fffd|me.Visible = False
  wExact.Visible = 2
  wEntier.Visible = 2
  wD|fffd|tail.Visible = 2
End Select
End Function

Attribute VB_Name = "Edition_courrier_art_39"
Sub Edition_courrier_art39()

Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc39 = "Art_39_Rentier_Notification_Rente_ 03_18_V2_PASRAU.docx"

With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc39, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1
  
'---- Remplissage en-t|fffd|te page 1

With .Selection

   DocWord.bookmarks("Sexe_assur|fffd|").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    
    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If
        
    DocWord.bookmarks("Code_postal_assur|fffd|").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP").Select
        .TypeText Text:="" & Range("RPP_art39").Value

    DocWord.bookmarks("Ref_entreprise").Select
        .TypeText Text:="" & Range("Ref_entreprise_art39").Value

    DocWord.bookmarks("Adhesion").Select
        .TypeText Text:="" & Range("Adhesion_art39").Value

    DocWord.bookmarks("Num_rente").Select
        .TypeText Text:="" & Range("Num_rente_art39").Value

    DocWord.bookmarks("Demande").Select
        .TypeText Text:="" & Range("Demande_art39").Value



    '----- Remplissage fin page 1
    
    DocWord.bookmarks("Option").Select
    Select Case Range("option_rente_art39").Value
        Case "Avec r|fffd|version": .TypeText Text:="" & "avec r|fffd|version   "
        Case "Sans r|fffd|version": .TypeText Text:="" & "sans r|fffd|version   "
        Case "Temporaire": .TypeText Text:="" & "temporaire       "
        Case "Temporaire avec r|fffd|version": .TypeText Text:="" & "temporaire r|fffd|versible"
    End Select
    
    DocWord.bookmarks("Date_du_jour_1").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If
    
    
    DocWord.bookmarks("Sexe_assur|fffd|_1").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Ref_entreprise_1").Select
        .TypeText Text:="" & Range("Ref_entreprise_art39").Value
        
    DocWord.bookmarks("Date_effet").Select
    If Day(CDate(Range("Date_effet_art39"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_art39").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_art39").Value, "dd mmmm yyyy")
    End If
    

    'On supprime le passage |fffd| la fin de la page 1 sur les PS si on a exo totale ou |fffd|tranger
   If Range("Montant_brut_art39").Value = Range("Montant_net_art39").Value Or Range("PS_etranger").Value = 1 Then
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
   End If
   
    DocWord.bookmarks("Sexe_assur|fffd|_2").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
     '--- Entrer dans l'en-t|fffd|te
    DocWord.ActiveWindow.ActivePane.View.SeekView = 9
    
     '-----Remplissage en-t|fffd|te de toutes les feuilles du courrier
    
     DocWord.bookmarks("RPP_1").Select
         .TypeText Text:="" & Range("RPP_art39").Value
    
     DocWord.bookmarks("Ref_entreprise_2").Select
         .TypeText Text:="" & Range("Ref_entreprise_art39").Value
    
     DocWord.bookmarks("Num_rente_2").Select
         .TypeText Text:="" & Range("Num_rente_art39").Value
    
     DocWord.bookmarks("Demande_1").Select
         .TypeText Text:="" & Range("Demande_art39").Value
            
    '---- Repasser dans le corps
    DocWord.ActiveWindow.ActivePane.View.SeekView = 0
    
    
    '------ NOTIFICATION DE RENTE
    
    DocWord.bookmarks("Sexe_assur|fffd|_3").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_2").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value
        
    DocWord.bookmarks("Sexe_assur|fffd|_4").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "le"
        Case "F": .TypeText Text:="" & "la"
    End Select

    DocWord.bookmarks("Num_rente_1").Select
        .TypeText Text:="" & Range("Num_rente_art39").Value
        
    DocWord.bookmarks("Date_effet_1").Select
    If Day(CDate(Range("Date_effet_art39"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_art39").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_art39").Value, "dd mmmm yyyy")
    End If
    
    
    DocWord.bookmarks("Brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_art39").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Frac").Select
    Select Case Range("Fractionnement_art39").Value
        Case "Trimestriel": .TypeText Text:="" & "trimestrielle"
        Case "Mensuel": .TypeText Text:="" & "mensuelle"
    End Select
    
    'DocWord.bookmarks("Frac_1").Select
    'Select Case Range("Fractionnement_art39").Value
    '    Case "Trimestriel": .TypeText Text:="" & "trimestriel"
    '    Case "Mensuel": .TypeText Text:="" & "mensuel"
    'End Select
    
    DocWord.bookmarks("Brut_frac").Select
        .TypeText Text:="" & Format(Range("Montant_brut_frac_art39").Value, "##,##0.00 ")
        
    'DocWord.bookmarks("Net_frac").Select
    '    .TypeText Text:="" & Format(Range("Montant_net_frac_art39").Value, "##,##0.00 ")
        
  '-----Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If (Range("Montant_brut_art39").Value + Range("Mt_contribution_specifique_art39").Value) = Range("Montant_net_art39").Value Then  'on ajoute la contribution sp|fffd|cifique
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS_1")
            .Range.Delete
        End With
    
    End If



  '----- Pour la contribution sociale de l'article L137-11 du Code de la S|fffd|curit|fffd| Sociale

    Select Case Range("Fractionnement_art39").Value
        
        Case "Mensuel":
            If Range("Ref_contribution_specifique_art39").Value < 446 Then 'MODIF IDEM
                With DocWord.bookmarks("Contribution_SS")
                    .Range.Delete
                End With
            Else:
                DocWord.bookmarks("Frac_4").Select
                    .TypeText Text:="" & "mois"
                DocWord.bookmarks("Frac_5").Select
                    .TypeText Text:="" & "mois"
                DocWord.bookmarks("Borne_inf").Select
                    .TypeText Text:="" & Format(446, "##,##0.00 ") ' 437 modifi|fffd| en 446 LE 24 05 19
                DocWord.bookmarks("Borne_sup").Select
                    .TypeText Text:="" & Format(668, "##,##0.00 ") '656 modifi|fffd| en 668 LE 24 05 19
                DocWord.bookmarks("Borne_sup1").Select
                    .TypeText Text:="" & Format(668, "##,##0.00 ")
                If Range("Ref_contribution_specifique_art39").Value < 668 Then
                    With DocWord.bookmarks("Part_sup")
                        .Range.Delete
                    End With
                End If
            End If
        

        Case "Trimestriel":
            If Range("Ref_contribution_specifique_art39").Value < 1338 Then '1311 remplc|fffd| par 1338
                With DocWord.bookmarks("Contribution_SS")
                    .Range.Delete
                End With
            Else:
                DocWord.bookmarks("Frac_4").Select
                    .TypeText Text:="" & "trimestre"
                DocWord.bookmarks("Frac_5").Select
                    .TypeText Text:="" & "trimestre"
                DocWord.bookmarks("Borne_inf").Select
                    .TypeText Text:="" & Format(1338, "##,##0 ")
                DocWord.bookmarks("Borne_sup").Select
                    .TypeText Text:="" & Format(2004, "##,##0 ")
                DocWord.bookmarks("Borne_sup1").Select
                    .TypeText Text:="" & Format(2004, "##,##0 ") '1968 remplac|fffd| par 2004
                If Range("Ref_contribution_specifique_art39").Value < 2004 Then
                    With DocWord.bookmarks("Part_sup")
                        .Range.Delete
                    End With
                End If
            End If

    End Select

        
    'Le paiement de votre rente
    
    DocWord.bookmarks("Fractionnement_2").Select
    Select Case Range("Fractionnement_art39").Value
        Case "Trimestriel": .TypeText Text:="" & "trimestriellement"
        Case "Mensuel": .TypeText Text:="" & "mensuellement"
    End Select
    
    DocWord.bookmarks("Terme_1").Select
    Select Case Range("Terme_art39").Value
        Case "Echu": .TypeText Text:="" & "|fffd| la fin de chaque"
        Case "Avance": .TypeText Text:="" & "au d|fffd|but de chaque "
    End Select
    
    DocWord.bookmarks("Fractionnement_3").Select
    Select Case Range("Fractionnement_art39").Value
        Case "Annuel": .TypeText Text:="" & "ann|fffd|e civile"
        Case "Semestriel": .TypeText Text:="" & "semestre civil"
        Case "Trimestriel": .TypeText Text:="" & "trimestre civil"
        Case "Mensuel": .TypeText Text:="" & "mois"
    End Select
    
    DocWord.bookmarks("Premier_paiement_2").Select
        Select Case Range("Premier_paiement").Value
            Case "Oui": .TypeText Text:="" & "est intervenu le"
            Case "Non":
                If Range("Date_PP").Value <> "" Then
                ' a revoir si on int|fffd|gre une date fixe
                    If Day(CDate(Range("Date_PP"))) = 1 Then
                        .TypeText Text:="" & "interviendra le " & "1er " & Format(Range("Date_PP").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & "interviendra le " & Format(Range("Date_PP").Value, "dd mmmm yyyy")
                    End If
                
                Else: .TypeText Text:="" & "interviendra dans les tous prochains jours"
                .Delete
                End If
        End Select
    
    If Range("Premier_paiement").Value = "Oui" Then
        DocWord.bookmarks("Date_PP").Select
        If Day(CDate(Range("Date_PP"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_PP").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_PP").Value, "dd mmmm yyyy")
        End If
    End If
              
    DocWord.bookmarks("Premier_paiement_1").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "a |fffd|t|fffd|"
        Case "Non": .TypeText Text:="" & "sera"
    End Select
    
    If Range("Premier_paiement").Value = "Non" Then
        With DocWord.bookmarks("P|fffd|riode")
            .Range.Delete
        End With
    Else:
        DocWord.bookmarks("Date_debut").Select
        If Day(CDate(Range("Date_deb"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_deb").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
        End If
        
        DocWord.bookmarks("Date_fin").Select
        If Day(CDate(Range("Date_f"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_f").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
        End If
    

    End If
  

    Select Case Range("option_rente_art39").Value

    Case "Sans r|fffd|version": 'Si la rente est non r|fffd|versible
        
        'On supprime le bloc rente r|fffd|versible
        With DocWord.bookmarks("Rente_rev")
            .Range.Delete
        End With
        
        
        'On supprime le bloc rente temporaire r|fffd|versible
        With DocWord.bookmarks("Rente_tempo_rev")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire
        With DocWord.bookmarks("Rente_tempo")
            .Range.Delete
        End With
        
        'On modifie le bloc rente non r|fffd|versible
        
        If Range("Terme_art39").Value = "Echu" Then
            DocWord.bookmarks("Fractionnement_4").Select
            Select Case Range("Fractionnement_art39").Value
                Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                Case "Mensuel": .TypeText Text:="" & "le mois"
            End Select


             DocWord.bookmarks("Prorata").Select
             Select Case Range("Prorata_art39").Value
                 Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                 Case "COMP": .TypeText Text:="" & "de"
             End Select
        End If
    
        If Range("Terme_art39").Value = "Avance" Or Range("Prorata_art39") = "PROP" Then
            With DocWord.bookmarks("Terme_avance")
                .Range.Delete
            End With
        End If
        
     Case "Temporaire avec r|fffd|version":
    
        'On supprime le bloc rente non r|fffd|versible
        With DocWord.bookmarks("Rente_non_rev")
            .Range.Delete
        End With

        'On supprime le bloc rente r|fffd|versible
        With DocWord.bookmarks("Rente_rev")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire
        With DocWord.bookmarks("Rente_tempo")
            .Range.Delete
        End With
        
        'On modifie le bloc rente temporaire r|fffd|versible
        
        DocWord.bookmarks("Taux_rev_1").Select
             .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")
        
        
        DocWord.bookmarks("Duree_tempo1").Select
            .TypeText Text:="" & Format(Range("Duree_tempo").Value, "dd mmmm yyyy")

        Select Case Range("Fractionnement_art39").Value
            Case "Mensuel":
                With DocWord.bookmarks("Prorata_3")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Prorata_4")
                    .Range.Delete
                End With

            Case "Trimestriel":
                With DocWord.bookmarks("Rente_mens_1")
                    .Range.Delete
                End With

                If Range("Prorata_art39").Value = "Sans" Then
                    With DocWord.bookmarks("Prorata_3")
                        .Range.Delete
                    End With
'                    DocWord.bookmarks("Fractionnement_5").Select
'                        .TypeText Text:="" & "le trimestre"
'                    DocWord.bookmarks("Fractionnement_6").Select
'                        .TypeText Text:="" & "du trimestre civil"
'                    DocWord.bookmarks("Fractionnement_7").Select
'                        .TypeText Text:="" & "le trimestre"
                End If

                If Range("Prorata_art39").Value = "COMP" Then
                    With DocWord.bookmarks("Prorata_4")
                        .Range.Delete
                    End With
'                    DocWord.bookmarks("Fractionnement_8").Select
'                        .TypeText Text:="" & "le trimestre"
'                    DocWord.bookmarks("Fractionnement_9").Select
'                        .TypeText Text:="" & "du trimestre civil"
'                    DocWord.bookmarks("Fractionnement_10").Select
'                        .TypeText Text:="" & "le trimestre"
                End If
                
                If Range("Prorata_art39") = "PROP" Then
                    With DocWord.bookmarks("Prorata_prop_2")
                        .Range.Delete
                    End With
                End If
       
            
                
        End Select

        DocWord.bookmarks("Duree_tempo2").Select
            .TypeText Text:="" & Format(Range("Duree_tempo").Value, "dd mmmm yyyy")
        
        
    Case "Temporaire":
    
        'On supprime le bloc rente non r|fffd|versible
        With DocWord.bookmarks("Rente_non_rev")
            .Range.Delete
        End With

        'On supprime le bloc rente r|fffd|versible
        With DocWord.bookmarks("Rente_rev")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire r|fffd|versible
        With DocWord.bookmarks("Rente_tempo_rev")
            .Range.Delete
        End With
        
        'On modifie le bloc rente rente temporaire
        
        DocWord.bookmarks("Duree_tempo").Select
            .TypeText Text:="" & Format(Range("Duree_tempo").Value, "dd mmmm yyyy")
            

            
        DocWord.bookmarks("Frac_2").Select
         Select Case Range("Fractionnement_art39").Value
             Case "Trimestriel": .TypeText Text:="" & "trimestre"
             Case "Mensuel": .TypeText Text:="" & "mois"
         End Select
         
        DocWord.bookmarks("Terme_3").Select
        Select Case Range("Terme_art39").Value
            Case "Echu": .TypeText Text:="" & "de"
            Case "Avance": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
        End Select
        
    Case "Avec r|fffd|version":
    
        DocWord.bookmarks("Taux_rev").Select
             .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")
        
        'On supprime le bloc rente non r|fffd|versible
        With DocWord.bookmarks("Rente_non_rev")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire r|fffd|versible
        With DocWord.bookmarks("Rente_tempo_rev")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire
        With DocWord.bookmarks("Rente_tempo")
            .Range.Delete
        End With
        
        'On modifie le bloc rente non r|fffd|versible
        
        Select Case Range("Fractionnement_art39").Value
            Case "Mensuel":
                With DocWord.bookmarks("Prorata_1")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Prorata_2")
                    .Range.Delete
                End With

            Case "Trimestriel":
                With DocWord.bookmarks("Rente_mens")
                    .Range.Delete
                End With

                If Range("Prorata_art39").Value = "Sans" Then
                    With DocWord.bookmarks("Prorata_1")
                        .Range.Delete
                    End With
                    DocWord.bookmarks("Fractionnement_5").Select
                        .TypeText Text:="" & "le trimestre"
                    DocWord.bookmarks("Fractionnement_6").Select
                        .TypeText Text:="" & "du trimestre civil"
                    DocWord.bookmarks("Fractionnement_7").Select
                        .TypeText Text:="" & "le trimestre"
                End If

                If Range("Prorata_art39").Value = "COMP" Then
                    With DocWord.bookmarks("Prorata_2")
                        .Range.Delete
                    End With
                    DocWord.bookmarks("Fractionnement_8").Select
                        .TypeText Text:="" & "le trimestre"
                    DocWord.bookmarks("Fractionnement_9").Select
                        .TypeText Text:="" & "du trimestre civil"
                    DocWord.bookmarks("Fractionnement_10").Select
                        .TypeText Text:="" & "le trimestre"
                End If
                
                If Range("Prorata_art39") = "PROP" Then
                    With DocWord.bookmarks("Prorata_prop_1")
                        .Range.Delete
                    End With
                End If
                
        End Select
    
    End Select
    


    '-----Remplissage de la fin du documemnt
    
    If Range("Garantie_dep") = "Non" Then
        With DocWord.bookmarks("Garantie_dep")
            .Range.Delete
        End With
    End If
    
    DocWord.bookmarks("Date_du_jour").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If
       
    

End With
End With
End Sub
Attribute VB_Name = "Edition_courrier_art_83"

Sub Edition_courrier_art83()

Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc83 = "Titre_de_rente_83_toutes_options_de rente_version_valid|fffd|e_le_29012018_V2_PASRAU.docx"
Dim start, fin As Integer
'Dim signet, signet2 As Bookmark


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc83, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1
    
'On supprime la partie R|fffd|gularisation
With DocWord.bookmarks("Regularisation")
    .Range.Delete
End With

'---- Remplissage en-t|fffd|te page 1


With .Selection

''ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
' 'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate

   DocWord.bookmarks("Sexe_assur|fffd|").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If

    DocWord.bookmarks("Code_postal_assur|fffd|").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP").Select
        .TypeText Text:="" & Range("RPP_art83").Value

    DocWord.bookmarks("Ref_entreprise").Select
        .TypeText Text:="" & Range("Ref_entreprise_art83").Value

    DocWord.bookmarks("Adhesion").Select
        .TypeText Text:="" & Range("Adhesion_art83").Value

    DocWord.bookmarks("Num_rente").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value

    DocWord.bookmarks("Demande").Select
        .TypeText Text:="" & Range("Demande_art83").Value


    '----- Remplissage fin page 1

    DocWord.bookmarks("Date_du_jour").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If


    DocWord.bookmarks("Sexe_assur|fffd|_1").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Date_effet").Select
    If Day(CDate(Range("Date_effet_art83"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_art83").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_art83").Value, "dd mmmm yyyy")
    End If
    
    
   
   If Range("Test_art83").Value = 82 Or Range("PS_exo_partielle") = 1 Then
        With DocWord.bookmarks("Rte_82")
            .Range.Delete
        End With
   End If
   
   'On supprime le passage |fffd| la fin de la page 1 sur les PS si on a exo totale ou |fffd|tranger
   If Range("Montant_brut_art83").Value = Range("Montant_net_art83").Value Or Range("PS_etranger").Value = 1 Then
        With DocWord.bookmarks("PS_1")
            .Range.Delete
        End With
   End If
       
'--- Entrer dans l'en-t|fffd|te
   DocWord.ActiveWindow.ActivePane.View.SeekView = 9
   
    '-----Remplissage en-t|fffd|te de toutes les feuilles du courrier

    DocWord.bookmarks("RPP_2").Select
        .TypeText Text:="" & Range("RPP_art83").Value

    DocWord.bookmarks("Ref_entreprise_2").Select
        .TypeText Text:="" & Range("Ref_entreprise_art83").Value

    DocWord.bookmarks("Num_rente_4").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value

    DocWord.bookmarks("Demande_2").Select
        .TypeText Text:="" & Range("Demande_art83").Value
        
'---- Repasser dans le corps
DocWord.ActiveWindow.ActivePane.View.SeekView = 0

    '-----Remplissage PAGE 2

    DocWord.bookmarks("Sexe_assur|fffd|_2").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select


    '-----Remplissage PAGE 3
    If Range("Test_art83").Value = 82 Or Range("PS_exo_partielle") = 1 Then
        With DocWord.bookmarks("Rte_82_1")
            .Range.Delete
        End With
    End If

    '-----Remplissage PAGE 4 : Notification de rente

    DocWord.bookmarks("Sexe_assur|fffd|_3").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_2").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Sexe_assur|fffd|_4").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "le"
        Case "F": .TypeText Text:="" & "la"
    End Select
    
    DocWord.bookmarks("Num_rente_1").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value

    DocWord.bookmarks("Date_effet_1").Select
    If Day(CDate(Range("Date_effet_art83"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_art83").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_art83").Value, "dd mmmm yyyy")
    End If


    DocWord.bookmarks("Montant_brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_art83").Value, "##,##0.00 ")

    DocWord.bookmarks("K").Select
        .TypeText Text:="" & Format(Range("K_art83").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Tarif").Select
        .TypeText Text:="" & Range("Tarif").Value

    DocWord.bookmarks("Fractionnement").Select
    Select Case Range("Fractionnement_art83").Value
        Case "Annuel": .TypeText Text:="" & "annuelle"
        Case "Semestriel": .TypeText Text:="" & "semestrielle"
        Case "Trimestriel": .TypeText Text:="" & "trimestrielle"
        Case "Mensuel": .TypeText Text:="" & "mensuelle"
    End Select

    DocWord.bookmarks("Montant_brut_frac").Select
        .TypeText Text:="" & Format(Range("Montant_brut_frac_art83").Value, "##,##0.00 ")
        
'--- Concerne le net donc a supprimer pour PASRAU

    'DocWord.bookmarks("Fractionnement_1").Select
'    Select Case Range("Fractionnement_art83").Value
'        Case "Annuel": .TypeText Text:="" & "annuel"
'        Case "Semestriel": .TypeText Text:="" & "semestriel"
'        Case "Trimestriel": .TypeText Text:="" & "trimestriel"
'        Case "Mensuel": .TypeText Text:="" & "mensuel"
'    End Select
'
'    DocWord.bookmarks("Montant_net_frac").Select
'        .TypeText Text:="" & Format(Range("Montant_net_frac_art83").Value, "##,##0.00 ")

    'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82_1")
            .Range.Delete
        End With
    
    End If

    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_art83").Value = Range("Montant_net_art83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
    
    End If
    
    
    'Le paiement de votre rente
    
    DocWord.bookmarks("Fractionnement_2").Select
    Select Case Range("Fractionnement_art83").Value
        Case "Annuel": .TypeText Text:="" & "annuellement"
        Case "Semestriel": .TypeText Text:="" & "semestriellement"
        Case "Trimestriel": .TypeText Text:="" & "trimestriellement"
        Case "Mensuel": .TypeText Text:="" & "mensuellement"
    End Select
    
    DocWord.bookmarks("Terme").Select
    Select Case Range("Terme_art83").Value
        Case "Echu": .TypeText Text:="" & "|fffd| la fin de chaque"
        Case "Avance": .TypeText Text:="" & "au d|fffd|but de chaque "
    End Select
    
    DocWord.bookmarks("Fractionnement_3").Select
    Select Case Range("Fractionnement_art83").Value
        Case "Annuel": .TypeText Text:="" & "ann|fffd|e civile"
        Case "Semestriel": .TypeText Text:="" & "semestre civil"
        Case "Trimestriel": .TypeText Text:="" & "trimestre civil"
        Case "Mensuel": .TypeText Text:="" & "mois"
    End Select
    
    DocWord.bookmarks("Premier_paiement").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "est intervenu"
        Case "Non": .TypeText Text:="" & "interviendra dans les tous prochains jours"
        .Delete 'ajout
    End Select
    
    
    DocWord.bookmarks("Date_PP").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "le " & Range("Date_PP").Value 'ajout d'un espace
    End Select
    
        
    DocWord.bookmarks("Premier_paiement_1").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "a |fffd|t|fffd|"
        Case "Non": .TypeText Text:="" & "sera"
    End Select
    
    If Range("Premier_paiement").Value = "Non" Then
        With DocWord.bookmarks("P|fffd|riode")
            .Range.Delete
        End With
    Else:
        DocWord.bookmarks("Date_debut").Select
            .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
        DocWord.bookmarks("Date_fin").Select
            .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
      
    End If
     

    'Les caract|fffd|ristiques de votre rente : Choix de l'option

    Select Case Range("option_rente_art83").Value

        Case "Sans r|fffd|version": 'Si la rente est non r|fffd|versible

            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With

            'On modifie le bloc rente non r|fffd|versible

            If Range("Terme_art83").Value = "Echu" Then

                 DocWord.bookmarks("Fractionnement_4").Select
                 Select Case Range("Fractionnement_art83").Value
                     Case "Annuel": .TypeText Text:="" & "l'ann|fffd|e"
                     Case "Semestriel": .TypeText Text:="" & "le semestre"
                     Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                     Case "Mensuel": .TypeText Text:="" & "le mois"
                 End Select


                 DocWord.bookmarks("Prorata").Select
                 Select Case Range("Prorata_art83").Value
                     Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                     Case "COMP": .TypeText Text:="" & "de"
                 End Select
            End If
        
            If Range("Terme_art83").Value = "Avance" Or Range("Prorata_art83") = "PROP" Then
                With DocWord.bookmarks("Terme_avance")
                    .Range.Delete
                End With
            End If
            
            Case "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s":  'Si la rente est viag|fffd|re avec arr|fffd|rage major|fffd| au d|fffd|c|fffd|s
            
            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With
            
            'On modifie le bloc Arr|fffd|rage Major|fffd| (AM)
        
            If Range("Terme_art83").Value = "Echu" Then

                 DocWord.bookmarks("Fractionnement_11").Select
                 Select Case Range("Fractionnement_art83").Value
                     Case "Annuel": .TypeText Text:="" & "l'ann|fffd|e"
                     Case "Semestriel": .TypeText Text:="" & "le semestre"
                     Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                     Case "Mensuel": .TypeText Text:="" & "le mois"
                 End Select


                 DocWord.bookmarks("Prorata_11").Select
                 Select Case Range("Prorata_art83").Value
                     Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                     Case "COMP": .TypeText Text:="" & "de"
                 End Select
            End If
        
            If Range("Terme_art83").Value = "Avance" Or Range("Prorata_art83") = "PROP" Then
                With DocWord.bookmarks("Terme_avance_2")
                    .Range.Delete
                End With
            End If
            
            DocWord.bookmarks("Taux_arrerage").Select
                .TypeText Text:="" & Format(Range("Taux_arr|fffd|rage_art83").Value, "0%")
                
                
            If Range("Nb_benef").Value > 1 Then 'S'il y a plus d'un b|fffd|n|fffd|ficiare
                DocWord.bookmarks("Nb_be").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_be1").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_be4").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_be2").Select
                    .TypeText Text:="" & "sont"
                DocWord.bookmarks("Nb_be3").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_be6").Select
                    .TypeText Text:="" & "s"
      

            Else:
                DocWord.bookmarks("Nb_be2").Select
                    .TypeText Text:="" & "est"
                With DocWord.bookmarks("Nb_be5")
                    .Range.Delete
                End With
            End If
            
        '    If Range("Nb_benef").Value = 0 Then
         '       With DocWord.bookmarks("Aucun_benef2")
          '          .Range.Delete
           '     End With
            'End If
            
            
'Remplissage tableau de b|fffd|n|fffd|ficaires

         If Range("Nb_benef").Value >= 1 Then

                DocWord.bookmarks("Nom_ben1").Select
                    .TypeText Text:="" & Range("Nom_benef1").Value

                ' Ajout condition sur le nom de naissance
                DocWord.bookmarks("Nom_nais_ben1").Select
                If Range("Nom_naissance_benef1").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef1").Value
                    Else:
                    .Delete
                End If

                DocWord.bookmarks("Prenom_ben1").Select
                    .TypeText Text:="" & Range("Prenom_benef1").Value

                DocWord.bookmarks("Date_nais_ben1").Select
                If Day(CDate(Range("Date_naissance_benef1"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef1").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef1").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_ben1").Select
                    .TypeText Text:="" & Range("Commune_naissance_benef1").Value

                DocWord.bookmarks("Lien_ben1").Select
                    .TypeText Text:="" & Range("Lien_parent|fffd|_benef1").Value

                DocWord.bookmarks("Pourcentage_ben1").Select
                    .TypeText Text:="" & Range("Pourcentage_rep_benef1").Value

            End If

            If Range("Nb_benef").Value >= 2 Then

                   DocWord.bookmarks("Nom_ben2").Select
                       .TypeText Text:="" & Range("Nom_benef2").Value

                   DocWord.bookmarks("Nom_nais_ben2").Select
                If Range("Nom_naissance_benef2").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef2").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_ben2").Select
                       .TypeText Text:="" & Range("Prenom_benef2").Value

                DocWord.bookmarks("Date_nais_ben2").Select
                If Day(CDate(Range("Date_naissance_benef2"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef2").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef2").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_ben2").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef2").Value


                   DocWord.bookmarks("Lien_ben2").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef2").Value

                   DocWord.bookmarks("Pourcentage_ben2").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef2").Value

               End If

            If Range("Nb_benef").Value >= 3 Then

                   DocWord.bookmarks("Nom_ben3").Select
                       .TypeText Text:="" & Range("Nom_benef3").Value

                   DocWord.bookmarks("Nom_nais_ben3").Select
                If Range("Nom_naissance_benef3").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef3").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_ben3").Select
                       .TypeText Text:="" & Range("Prenom_benef3").Value

                DocWord.bookmarks("Date_nais_ben3").Select
                If Day(CDate(Range("Date_naissance_benef3"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef3").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef3").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_ben3").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef3").Value
                    
                   DocWord.bookmarks("Lien_ben3").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef3").Value

                   DocWord.bookmarks("Pourcentage_ben3").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef3").Value

               End If

            If Range("Nb_benef").Value = 4 Then

                   DocWord.bookmarks("Nom_ben4").Select
                       .TypeText Text:="" & Range("Nom_benef4").Value

                   DocWord.bookmarks("Nom_nais_ben4").Select
                If Range("Nom_naissance_benef4").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef4").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_ben4").Select
                       .TypeText Text:="" & Range("Prenom_benef4").Value

                    DocWord.bookmarks("Date_nais_ben4").Select
                    If Day(CDate(Range("Date_naissance_benef4"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef4").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef4").Value, "dd mmmm yyyy")
                    End If
                
                    DocWord.bookmarks("Commune_ben4").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef4").Value

                   DocWord.bookmarks("Lien_ben4").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef4").Value

                   DocWord.bookmarks("Pourcentage_ben4").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef4").Value

               End If

                If Range("Nb_benef").Value = 1 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 2).Delete
                End If

                If Range("Nb_benef").Value <= 2 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 1).Delete
                End If

                If Range("Nb_benef").Value <= 3 Then
                    DocWord.Tables(1).Rows(DocWord.Tables(1).Rows.Count).Delete
                End If

                If Range("Nb_benef").Value = 0 Then
                    With DocWord.bookmarks("Aucun_benef1")
                        .Range.Delete
                    End With
                End If

                'Fin du remplissage du tableau des b|fffd|n|fffd|ficiaires
        
        Case "Avec r|fffd|version": 'Si la rente est r|fffd|versible


            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With

            'On modifie le bloc rente r|fffd|versible

            DocWord.bookmarks("Taux_rev").Select
                .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")

            If Range("Qualite_reversataire").Value <> "Ajout PACS" Then
                With DocWord.bookmarks("qualite_rev")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Qualite_rev_2")
                    .Range.Delete
                End With
            End If

            Select Case Range("Fractionnement_art83").Value
         ' Fractionnement mensuel
                Case "Mensuel":
                    With DocWord.bookmarks("Prorata_1")
                        .Range.Delete
                    End With
                    With DocWord.bookmarks("Prorata_2")
                        .Range.Delete
                    End With
        ' Fractionnement semestriel
                Case "Semestriel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_art83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "du semestre civil"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "le semestre"
                    End If

                    If Range("Prorata_art83").Value = "COMP" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "du semestre civil"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "le semestre"
                    End If
                    

        ' Fractionnement trimestriel
                Case "Trimestriel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_art83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "du trimestre civil"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "le trimestre"
                    End If

                    If Range("Prorata_art83").Value = "COMP" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "du trimestre civil"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "le trimestre"
                    End If

            'Fractionnement annuel
                Case "Annuel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_art83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "de l'ann|fffd|e civile"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                    End If

                    If Range("Prorata_art83").Value = "COMP" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "de l'ann|fffd|e civile"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                    End If


            End Select
            
            If Range("Fractionnement_art83").Value <> "Mensuel" And Range("Prorata_art83").Value = "PROP" Then
                With DocWord.bookmarks("Prorata_prop")
                    .Range.Delete
                End With
            End If



        Case "Paliers 70 et 75 ans":
            
            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With
            
            'On modifie le bloc rente croissante par palier
            
            If Range("Terme_art83").Value = "Echu" Then

                 DocWord.bookmarks("Frac_2").Select
                 Select Case Range("Fractionnement_art83").Value
                     Case "Annuel": .TypeText Text:="" & "l'ann|fffd|e"
                     Case "Semestriel": .TypeText Text:="" & "le semestre"
                     Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                     Case "Mensuel": .TypeText Text:="" & "le mois"
                 End Select


                 DocWord.bookmarks("Prorata_5").Select
                 Select Case Range("Prorata_art83").Value
                     Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                     Case "COMP": .TypeText Text:="" & "de"
                 End Select
            End If
        
            If Range("Terme_art83").Value = "Avance" Or Range("Prorata_art83") = "PROP" Then
                With DocWord.bookmarks("Prorata_prop_2")
                    .Range.Delete
                End With
            End If
            
        Case "Annuit|fffd|s garanties avec r|fffd|version": 'Si la rente est r|fffd|versible avec annuit|fffd|s garanties

            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With
            
            'On modifie le bloc Annuit|fffd|s garanties avec r|fffd|version
        
            DocWord.bookmarks("Nb_AG_3").Select
                .TypeText Text:="" & Range("Nb_AG_art83").Value
                
            DocWord.bookmarks("Taux_rev_2").Select
                .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")

            If Range("Qualite_reversataire").Value <> "Partenaire PACS" Then
                With DocWord.bookmarks("Qualite_rev_3")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Qualite_rev_4")
                    .Range.Delete
                End With
            End If
            
            Select Case Range("Fractionnement_art83").Value

                Case "Mensuel":
                    DocWord.bookmarks("Frac_3").Select
                        .TypeText Text:="" & "le mois"
                    DocWord.bookmarks("Frac_4").Select
                        .TypeText Text:="" & "le mois"
                     DocWord.bookmarks("Frac_5").Select
                        .TypeText Text:="" & "du mois"
                
                Case "Trimestriel":
                    DocWord.bookmarks("Frac_3").Select
                        .TypeText Text:="" & "le trimestre"
                    DocWord.bookmarks("Frac_4").Select
                        .TypeText Text:="" & "le trimestre"
                     DocWord.bookmarks("Frac_5").Select
                        .TypeText Text:="" & "du trimestre civil"

                Case "Semestriel":
                    DocWord.bookmarks("Frac_3").Select
                        .TypeText Text:="" & "le semestre"
                    DocWord.bookmarks("Frac_4").Select
                        .TypeText Text:="" & "le semestre"
                     DocWord.bookmarks("Frac_5").Select
                        .TypeText Text:="" & "du semestre civil"
                        
                Case "Annuel":
                    DocWord.bookmarks("Frac_3").Select
                        .TypeText Text:="" & "l'ann|fffd|e"
                    DocWord.bookmarks("Frac_4").Select
                        .TypeText Text:="" & "l'ann|fffd|e"
                     DocWord.bookmarks("Frac_5").Select
                        .TypeText Text:="" & "de l'ann|fffd|e civile"
            End Select
                        
            If Range("Prorata_art83").Value = "Sans" Then
                If Range("Terme_art83").Value = "Echu" Then
                    DocWord.bookmarks("Prorata_7").Select
                        .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                    DocWord.bookmarks("Prorata_8").Select
                         .TypeText Text:="" & "pr|fffd|c|fffd|dent celui "
                Else:
                    With DocWord.bookmarks("Terme_avance_1")
                        .Range.Delete
                    End With
                End If
            
            End If
            
            If Range("Prorata_art83").Value = "COMP" Then
                DocWord.bookmarks("Prorata_7").Select
                    .TypeText Text:="" & "de"
                DocWord.bookmarks("Prorata_6").Select
                    .TypeText Text:="" & "suivant celui "
            
            End If
            
            If Range("Prorata_art83").Value = "PROP" Then
                With DocWord.bookmarks("Terme_avance_1")
                    .Range.Delete
                End With
            End If
            
            DocWord.bookmarks("Nb_AG_4").Select
                .TypeText Text:="" & Range("Nb_AG_art83").Value
                
                
            If Range("Nb_benef").Value > 1 Then 'S'il y a plus d'un b|fffd|n|fffd|ficiare
                DocWord.bookmarks("Nb_b").Select
                    .TypeText Text:="" & "x"
                DocWord.bookmarks("Nb_b1").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b2").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b3").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b5").Select
                    .TypeText Text:="" & "sont"
                DocWord.bookmarks("Nb_b4").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b6").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b7").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_b8").Select
                    .TypeText Text:="" & "s"


            Else:
                DocWord.bookmarks("Nb_b5").Select
                    .TypeText Text:="" & "est"
                With DocWord.bookmarks("Nb_b9")
                    .Range.Delete
                End With
            End If
            
'            If Range("Nb_benef").Value = 0 Then
'                With DocWord.bookmarks("Aucun_benef")
'                    .Range.Delete
'                End With
'            End If
            
'Remplissage tableau de b|fffd|n|fffd|ficaires

         If Range("Nb_benef").Value >= 1 Then

                DocWord.bookmarks("Nom_be1").Select
                    .TypeText Text:="" & Range("Nom_benef1").Value

                DocWord.bookmarks("Nom_nais_be1").Select
                If Range("Nom_naissance_benef1").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef1").Value
                    Else:
                    .Delete
                End If

                DocWord.bookmarks("Prenom_be1").Select
                    .TypeText Text:="" & Range("Prenom_benef1").Value

                DocWord.bookmarks("Date_nais_be1").Select
                If Day(CDate(Range("Date_naissance_benef1"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef1").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef1").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_be1").Select
                    .TypeText Text:="" & Range("Commune_naissance_benef1").Value

                DocWord.bookmarks("Lien_be1").Select
                    .TypeText Text:="" & Range("Lien_parent|fffd|_benef1").Value

                DocWord.bookmarks("Pourcentage_be1").Select
                    .TypeText Text:="" & Range("Pourcentage_rep_benef1").Value

            End If

            If Range("Nb_benef").Value >= 2 Then

                   DocWord.bookmarks("Nom_be2").Select
                       .TypeText Text:="" & Range("Nom_benef2").Value

                DocWord.bookmarks("Nom_nais_be2").Select
                If Range("Nom_naissance_benef2").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef2").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_be2").Select
                       .TypeText Text:="" & Range("Prenom_benef2").Value

                DocWord.bookmarks("Date_nais_be2").Select
                If Day(CDate(Range("Date_naissance_benef2"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef2").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef2").Value, "dd mmmm yyyy")
                End If
                          
                    DocWord.bookmarks("Commune_be2").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef2").Value


                   DocWord.bookmarks("Lien_be2").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef2").Value

                   DocWord.bookmarks("Pourcentage_be2").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef2").Value

               End If

            If Range("Nb_benef").Value >= 3 Then

                   DocWord.bookmarks("Nom_be3").Select
                       .TypeText Text:="" & Range("Nom_benef3").Value

                   DocWord.bookmarks("Nom_nais_be3").Select
                If Range("Nom_naissance_benef3").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef3").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_be3").Select
                       .TypeText Text:="" & Range("Prenom_benef3").Value

                    DocWord.bookmarks("Date_nais_be3").Select
                    If Day(CDate(Range("Date_naissance_benef3"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef3").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef3").Value, "dd mmmm yyyy")
                    End If
                    
                    DocWord.bookmarks("Commune_be3").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef3").Value
                    
                   DocWord.bookmarks("Lien_be3").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef3").Value

                   DocWord.bookmarks("Pourcentage_be3").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef3").Value

               End If

            If Range("Nb_benef").Value = 4 Then

                   DocWord.bookmarks("Nom_be4").Select
                       .TypeText Text:="" & Range("Nom_benef4").Value

                   DocWord.bookmarks("Nom_nais_be4").Select
                If Range("Nom_naissance_benef4").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef4").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_be4").Select
                       .TypeText Text:="" & Range("Prenom_benef4").Value

                    DocWord.bookmarks("Date_nais_be4").Select
                    If Day(CDate(Range("Date_naissance_benef4"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef4").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef4").Value, "dd mmmm yyyy")
                    End If
                    
                    DocWord.bookmarks("Commune_be4").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef4").Value

                   DocWord.bookmarks("Lien_be4").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef4").Value

                   DocWord.bookmarks("Pourcentage_be4").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef4").Value

               End If

'-----
                If Range("Nb_benef").Value = 1 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 2).Delete
                End If

                If Range("Nb_benef").Value <= 2 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 1).Delete
                End If

                If Range("Nb_benef").Value <= 3 Then
                    DocWord.Tables(1).Rows(DocWord.Tables(1).Rows.Count).Delete
                End If

                If Range("Nb_benef").Value = 0 Then
                    With DocWord.bookmarks("Aucun_benef")
                        .Range.Delete
                    End With
                End If


                'Fin du remplissage du tableau des b|fffd|n|fffd|ficiaires
        
                DocWord.bookmarks("Nb_AG_5").Select
                    .TypeText Text:="" & Range("Nb_AG_art83").Value


                Select Case Range("Fractionnement_art83").Value

                    Case "Trimestriel":
                        DocWord.bookmarks("Frac_6").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Frac_7").Select
                            .TypeText Text:="" & "le trimestre"

                    Case "Semestriel":
                        DocWord.bookmarks("Frac_6").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Frac_7").Select
                            .TypeText Text:="" & "le semestre"
                    Case "Annuel":
                        DocWord.bookmarks("Frac_6").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Frac_7").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                            
                    Case "Mensuel":
                        DocWord.bookmarks("Frac_6").Select
                            .TypeText Text:="" & "le mois"
                        DocWord.bookmarks("Frac_7").Select
                            .TypeText Text:="" & "le mois"
                End Select

                Select Case Range("Prorata_art83").Value

                    Case "Sans":
                        DocWord.bookmarks("Prorata_9").Select
                            .TypeText Text:="" & "du"
                        DocWord.bookmarks("Prorata_10").Select
                            .TypeText Text:="" & "pr|fffd|c|fffd|dant le"

                    Case "COMP":

                        DocWord.bookmarks("Prorata_9").Select
                            .TypeText Text:="" & "qui suit le"
                        DocWord.bookmarks("Prorata_10").Select
                            .TypeText Text:="" & "du"
                            
                    Case "PROP"
                        With DocWord.bookmarks("Prorata_prop_3")
                            .Range.Delete
                        End With
                End Select
    'End Select



        Case "Annuit|fffd|s garanties": 'Si la rente est avec annuit|fffd|s garanties

            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With


            'On modifie le bloc Annuit|fffd|s Garanties (AG)

            DocWord.bookmarks("Nb_AG").Select
                .TypeText Text:="" & Range("Nb_AG_art83").Value
            DocWord.bookmarks("Nb_AG_1").Select
                .TypeText Text:="" & Range("Nb_AG_art83").Value

            If Range("Nb_benef").Value > 1 Then 'S'il y a plus d'un b|fffd|n|fffd|ficiare
                DocWord.bookmarks("Nb_ben").Select
                    .TypeText Text:="" & "x"
                DocWord.bookmarks("Nb_ben1").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben2").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben3").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben4").Select
                    .TypeText Text:="" & "sont"
                DocWord.bookmarks("Nb_ben5").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben6").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben7").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben8").Select
                    .TypeText Text:="" & "s"


            Else:
                DocWord.bookmarks("Nb_ben4").Select
                    .TypeText Text:="" & "est"
                With DocWord.bookmarks("Nb_ben9")
                    .Range.Delete
                End With
            End If

            'Remplissage tableau de b|fffd|n|fffd|ficaires

         If Range("Nb_benef").Value >= 1 Then

                DocWord.bookmarks("Nom_b1").Select
                    .TypeText Text:="" & Range("Nom_benef1").Value
                If Range("Nom_naissance_benef1").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef1").Value
                    Else:
                    .Delete
                End If
                '---- pour correction
                
                DocWord.bookmarks("Prenom_b1").Select
                    .TypeText Text:="" & Range("Prenom_benef1").Value

                DocWord.bookmarks("Date_nais_b1").Select
                If Day(CDate(Range("Date_naissance_benef1"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef1").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef1").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_b1").Select
                    .TypeText Text:="" & Range("Commune_naissance_benef1").Value

                DocWord.bookmarks("Lien_b1").Select
                    .TypeText Text:="" & Range("Lien_parent|fffd|_benef1").Value

                DocWord.bookmarks("Pourcentage_b1").Select
                    .TypeText Text:="" & Range("Pourcentage_rep_benef1").Value

            End If

            If Range("Nb_benef").Value >= 2 Then

                   DocWord.bookmarks("Nom_b2").Select
                       .TypeText Text:="" & Range("Nom_benef2").Value

                   DocWord.bookmarks("Nom_nais_b2").Select
                If Range("Nom_naissance_benef2").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef2").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b2").Select
                       .TypeText Text:="" & Range("Prenom_benef2").Value

                   DocWord.bookmarks("Date_nais_b2").Select
                    If Day(CDate(Range("Date_naissance_benef2"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef2").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef2").Value, "dd mmmm yyyy")
                    End If
                    
                    DocWord.bookmarks("Commune_b2").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef2").Value


                   DocWord.bookmarks("Lien_b2").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef2").Value

                   DocWord.bookmarks("Pourcentage_b2").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef2").Value

               End If

            If Range("Nb_benef").Value >= 3 Then

                   DocWord.bookmarks("Nom_b3").Select
                       .TypeText Text:="" & Range("Nom_benef3").Value

                   DocWord.bookmarks("Nom_nais_b3").Select
                If Range("Nom_naissance_benef3").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef3").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b3").Select
                       .TypeText Text:="" & Range("Prenom_benef3").Value

                   DocWord.bookmarks("Date_nais_b3").Select
                     If Day(CDate(Range("Date_naissance_benef3"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef3").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef3").Value, "dd mmmm yyyy")
                    End If
                    
                    DocWord.bookmarks("Commune_b3").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef3").Value
                    
                   DocWord.bookmarks("Lien_b3").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef3").Value

                   DocWord.bookmarks("Pourcentage_b3").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef3").Value

               End If

            If Range("Nb_benef").Value = 4 Then

                   DocWord.bookmarks("Nom_b4").Select
                       .TypeText Text:="" & Range("Nom_benef4").Value

                   DocWord.bookmarks("Nom_nais_b4").Select
                If Range("Nom_naissance_benef4").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef4").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b4").Select
                       .TypeText Text:="" & Range("Prenom_benef4").Value
                   DocWord.bookmarks("Date_nais_b4").Select
                    If Day(CDate(Range("Date_naissance_benef4"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef4").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef4").Value, "dd mmmm yyyy")
                    End If
                    
                    DocWord.bookmarks("Commune_b4").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef4").Value

                   DocWord.bookmarks("Lien_b4").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef4").Value

                   DocWord.bookmarks("Pourcentage_b4").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef4").Value

               End If

                If Range("Nb_benef").Value = 1 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 2).Delete
                End If

                If Range("Nb_benef").Value <= 2 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 1).Delete
                End If

                If Range("Nb_benef").Value <= 3 Then
                    DocWord.Tables(1).Rows(DocWord.Tables(1).Rows.Count).Delete
                End If

                If Range("Nb_benef").Value = 0 Then
                    With DocWord.bookmarks("Aucun_benef1")
                        .Range.Delete
                    End With
                End If


                'Fin du remplissage du tableau des b|fffd|n|fffd|ficiaires

                DocWord.bookmarks("Nb_AG_2").Select
                    .TypeText Text:="" & Range("Nb_AG_art83").Value


                Select Case Range("Fractionnement_art83").Value

                    Case "Mensuel":
                       DocWord.bookmarks("Frac").Select
                           .TypeText Text:="" & "le mois"
                       DocWord.bookmarks("Frac_1").Select
                           .TypeText Text:="" & "le mois"
                    
                    Case "Trimestriel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "le trimestre"

                    Case "Semestriel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "le semestre"
                    Case "Annuel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                End Select

                Select Case Range("Prorata_art83").Value

                    Case "Sans":
                        DocWord.bookmarks("Prorata_3").Select
                            .TypeText Text:="" & "du"
                        DocWord.bookmarks("Prorata_4").Select
                            .TypeText Text:="" & "pr|fffd|c|fffd|dant le"

                    Case "COMP":

                        DocWord.bookmarks("Prorata_3").Select
                            .TypeText Text:="" & "qui suit le"
                        DocWord.bookmarks("Prorata_4").Select
                            .TypeText Text:="" & "du"
                            
                    Case "PROP"
                        With DocWord.bookmarks("Prorata_prop_1")
                            .Range.Delete
                        End With
                End Select
    End Select

    'Remplissage fin page 8
    
        If Range("Garantie_dep") = "Non" Then
            With DocWord.bookmarks("Garantie_dep")
                .Range.Delete
            End With
        End If

        DocWord.bookmarks("Date_du_jour_1").Select
        If Day(CDate(Range("Date_du_jour"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
        End If


        
End With

End With

End Sub

Sub Regularisation_art83()

Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc83 = "Titre_de_rente_83_toutes_options_de rente_version_valid|fffd|e_le_29012018_V2_PASRAU.docx"
Dim start, fin As Integer
'Dim signet, signet2 As Bookmark


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc83, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1


With .Selection



'------- VOTRE RETRAITE SUPPLEMENTAIRE -------


'On supprime la partie Mise en service
With DocWord.bookmarks("Mise_en_service")
    .Range.Delete
End With


'Remplissage en t|fffd|te

   DocWord.bookmarks("Sexe_assur|fffd|_5").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_3").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    
    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|_1").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If


    DocWord.bookmarks("Code_postal_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP_1").Select
        .TypeText Text:="" & Range("RPP_art83").Value

    DocWord.bookmarks("Ref_entreprise_1").Select
        .TypeText Text:="" & Range("Ref_entreprise_art83").Value

    DocWord.bookmarks("Adhesion_1").Select
        .TypeText Text:="" & Range("Adhesion_art83").Value

    DocWord.bookmarks("Num_rente_2").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value

    DocWord.bookmarks("Demande_1").Select
        .TypeText Text:="" & Range("Demande_art83").Value
        
'Remplissage partie R|fffd|gularisation de votre rente
    
    'suppression de la page en trop
    With DocWord.bookmarks("Regularisation_2")
    .Range.Delete
    End With

    DocWord.bookmarks("Date_du_jour_2").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If


    DocWord.bookmarks("Sexe_assur|fffd|_6").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_4").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value
            
    DocWord.bookmarks("Num_rente_3").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value
        
    DocWord.bookmarks("Sexe_assur|fffd|_7").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
    
'Montant suppl|fffd|mentaire net
    DocWord.bookmarks("Suppl|fffd|ment_net").Select
        .TypeText Text:="" & Format(Range("Sup_net").Value, "##,##0.00 ")

    'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle_1")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger_1")
            .Range.Delete
        End With
    
    End If
    
     If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82")
            .Range.Delete
        End With
        
    End If


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo_1")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger_1")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo_1")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle_1")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_art83").Value = Range("Montant_net_art83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
    DocWord.bookmarks("PS_2").Select
        .TypeText Text:="" & "."

    End If
    
    DocWord.bookmarks("Nouveau_brut_annuel").Select
        '.TypeText Text:="" & Format(Range("Montant_brut_art83").Value + Range("Date_PP").Value, "##,##0.00 ")
        .TypeText Text:="" & Format(Range("Montant_brut_bar83").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Date_deb").Select
    If Day(CDate(Range("Date_deb"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_deb").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
    End If
    
    DocWord.bookmarks("Date_fin_1").Select
    If Day(CDate(Range("Date_f"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_f").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
    End If
      

End With
End With


End Sub
    

Attribute VB_Name = "Edition_courrier_bar_39"
Sub Edition_courrier_bar39()


Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc39 = "Art_39_Rentier_Notification_Rente_ 03_18_V2_PASRAU.docx"


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc39, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1
  
'---- Remplissage en-t|fffd|te page 1


With .Selection


   DocWord.bookmarks("Sexe_assur|fffd|").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If

    DocWord.bookmarks("Code_postal_assur|fffd|").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP").Select
        .TypeText Text:="" & Range("RPP_bar39").Value

    DocWord.bookmarks("Ref_entreprise").Select
        .TypeText Text:="" & Range("Ref_entreprise_bar39").Value

    DocWord.bookmarks("Adhesion").Select
        .TypeText Text:="" & Range("Adhesion_bar39").Value

    DocWord.bookmarks("Num_rente").Select
        .TypeText Text:="" & Range("Num_rente_bar39").Value

    DocWord.bookmarks("Demande").Select
        .TypeText Text:="" & Range("Demande_bar39").Value



    '----- Remplissage fin page 1
    
    DocWord.bookmarks("Option").Select
    Select Case Range("option_rente_bar39").Value
        Case "R|fffd|versible": .TypeText Text:="" & "avec r|fffd|version     "
        Case "Non r|fffd|versible": .TypeText Text:="" & "sans r|fffd|version   "
        'Case "Temporaire": .TypeText Text:="" & "temporaire"
    End Select
    
    DocWord.bookmarks("Date_du_jour_1").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If
    
    
    DocWord.bookmarks("Sexe_assur|fffd|_1").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Ref_entreprise_1").Select
        .TypeText Text:="" & Range("Ref_entreprise_bar39").Value
        
    DocWord.bookmarks("Date_effet").Select
    If Day(CDate(Range("Date_effet_bar39"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar39").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_bar39").Value, "dd mmmm yyyy")
    End If
    
    'On supprime le passage |fffd| la fin de la page 1 sur les PS si on a exo totale ou |fffd|tranger
   If Range("Montant_brut_bar39").Value = Range("Montant_net_bar39").Value Or Range("PS_etranger").Value = 1 Then
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
   End If
   
    DocWord.bookmarks("Sexe_assur|fffd|_2").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
     '--- Entrer dans l'en-t|fffd|te
    DocWord.ActiveWindow.ActivePane.View.SeekView = 9
    
     '-----Remplissage en-t|fffd|te de toutes les feuilles du courrier
    
     DocWord.bookmarks("RPP_1").Select
         .TypeText Text:="" & Range("RPP_bar39").Value
    
     DocWord.bookmarks("Ref_entreprise_2").Select
         .TypeText Text:="" & Range("Ref_entreprise_bar39").Value
    
     DocWord.bookmarks("Num_rente_2").Select
         .TypeText Text:="" & Range("Num_rente_bar39").Value
    
     DocWord.bookmarks("Demande_1").Select
         .TypeText Text:="" & Range("Demande_bar39").Value
            
    '---- Repasser dans le corps
    DocWord.ActiveWindow.ActivePane.View.SeekView = 0
          
        
    '------ NOTIFICATION DE RENTE
    
    DocWord.bookmarks("Sexe_assur|fffd|_3").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Sexe_assur|fffd|_4").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "le"
        Case "F": .TypeText Text:="" & "la"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_2").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Num_rente_1").Select
        .TypeText Text:="" & Range("Num_rente_bar39").Value
        
    DocWord.bookmarks("Date_effet_1").Select
    If Day(CDate(Range("Date_effet_bar39"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar39").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_bar39").Value, "dd mmmm yyyy")
    End If
    
    
    DocWord.bookmarks("Brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_bar39").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Frac").Select
    Select Case Range("Fractionnement_bar39").Value
        Case "Trimestriel": .TypeText Text:="" & "trimestrielle"
        Case "Mensuel": .TypeText Text:="" & "mensuelle"
    End Select
    
    '---- Concerne le net donc |fffd| supprimer
    'DocWord.bookmarks("Frac_1").Select
    'Select Case Range("Fractionnement_bar39").Value
     '   Case "Trimestriel": .TypeText Text:="" & "trimestriel"
      '  Case "Mensuel": .TypeText Text:="" & "mensuel"
   ' End Select
    
    DocWord.bookmarks("Brut_frac").Select
        .TypeText Text:="" & Format(Range("Montant_brut_frac_bar39").Value, "##,##0.00 ")
        
    'DocWord.bookmarks("Net_frac").Select
     '   .TypeText Text:="" & Format(Range("Montant_net_frac_bar39").Value, "##,##0.00 ")
        
  '-----Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If (Range("Montant_brut_bar39").Value - Range("Mt_contribution_specifique_art39").Value) = Range("Montant_net_bar39").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS_1")
            .Range.Delete
        End With
    
    End If



    '----- Pour la contribution sociale de l'article L137-11 du Code de la S|fffd|curit|fffd| Sociale
    Select Case Range("Fractionnement_bar39").Value
        
        Case "Mensuel":
            If Range("Ref_contribution_specifique_art39").Value < 446 Then
                With DocWord.bookmarks("Contribution_SS")
                    .Range.Delete
                End With
            Else:
                DocWord.bookmarks("Frac_4").Select
                    .TypeText Text:="" & "mois"
                DocWord.bookmarks("Frac_5").Select
                    .TypeText Text:="" & "mois"
                DocWord.bookmarks("Borne_inf").Select
                    .TypeText Text:="" & Format(446, "##,##0.00 ")
                DocWord.bookmarks("Borne_sup").Select
                    .TypeText Text:="" & Format(668, "##,##0.00 ")
                DocWord.bookmarks("Borne_sup1").Select
                    .TypeText Text:="" & Format(668, "##,##0.00 ")
                If Range("Ref_contribution_specifique_art39").Value < 668 Then
                    With DocWord.bookmarks("Part_sup") 'Pbar_sup
                        .Range.Delete
                    End With
                End If
            End If
        

        Case "Trimestriel":
            If Range("Ref_contribution_specifique_art39").Value < 1338 Then
                With DocWord.bookmarks("Contribution_SS")
                    .Range.Delete
                End With
            Else:
                DocWord.bookmarks("Frac_4").Select
                    .TypeText Text:="" & "trimestre"
                DocWord.bookmarks("Frac_5").Select
                    .TypeText Text:="" & "trimestre"
                DocWord.bookmarks("Borne_inf").Select
                    .TypeText Text:="" & Format(1338, "##,##0 ")
                DocWord.bookmarks("Borne_sup").Select
                    .TypeText Text:="" & Format(2004, "##,##0 ")
                DocWord.bookmarks("Borne_sup1").Select
                    .TypeText Text:="" & Format(2004, "##,##0 ")
                If Range("Ref_contribution_specifique_art39").Value < 2004 Then
                    With DocWord.bookmarks("Part_sup")
                        .Range.Delete
                    End With
                End If
            End If

    End Select


 
    'Le paiement de votre rente
    
    DocWord.bookmarks("Fractionnement_2").Select
    Select Case Range("Fractionnement_bar39").Value
        Case "Trimestriel": .TypeText Text:="" & "trimestriellement"
        Case "Mensuel": .TypeText Text:="" & "mensuellement"
    End Select
    
    DocWord.bookmarks("Terme_1").Select
    Select Case Range("Terme_bar39").Value
        Case "Echu": .TypeText Text:="" & "|fffd| la fin de chaque"
        Case "Avance": .TypeText Text:="" & "au d|fffd|but de chaque "
    End Select
    
    DocWord.bookmarks("Fractionnement_3").Select
    Select Case Range("Fractionnement_bar39").Value
        Case "Annuel": .TypeText Text:="" & "ann|fffd|e civile"
        Case "Semestriel": .TypeText Text:="" & "semestre civil"
        Case "Trimestriel": .TypeText Text:="" & "trimestre civil"
        Case "Mensuel": .TypeText Text:="" & "mois"
    End Select
    
     DocWord.bookmarks("Premier_paiement_2").Select
        Select Case Range("Premier_paiement").Value
            Case "Oui": .TypeText Text:="" & "est intervenu le"
            Case "Non":
                
                If Range("Date_PP").Value <> "" Then
                
                    If Day(CDate(Range("Date_PP"))) = 1 Then
                        .TypeText Text:="" & "interviendra le " & "1er " & Format(Range("Date_PP").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & "interviendra le " & Format(Range("Date_PP").Value, "dd mmmm yyyy")
                    End If
                
                Else: .TypeText Text:="" & "interviendra dans les tous prochains jours"
                .Delete
                End If
        End Select
    
    
    If Range("Premier_paiement").Value = "Oui" Then
        DocWord.bookmarks("Date_PP").Select
        If Day(CDate(Range("Date_PP"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_PP").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_PP").Value, "dd mmmm yyyy")
        End If
    End If
              
    DocWord.bookmarks("Premier_paiement_1").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "a |fffd|t|fffd|"
        Case "Non": .TypeText Text:="" & "sera"
    End Select
    
    If Range("Premier_paiement").Value = "Non" Then
        With DocWord.bookmarks("P|fffd|riode")
            .Range.Delete
        End With
    Else:
        DocWord.bookmarks("Date_debut").Select
            .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
        DocWord.bookmarks("Date_fin").Select
            .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
      
    End If
  

    Select Case Range("option_rente_bar39").Value

    Case "Non r|fffd|versible": 'Si la rente est non r|fffd|versible
        
        'On supprime le bloc rente r|fffd|versible
        With DocWord.bookmarks("Rente_rev")
            .Range.Delete
        End With
    
        'On supprime le bloc rente temporaire
        With DocWord.bookmarks("Rente_tempo")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire r|fffd|versible
        With DocWord.bookmarks("Rente_tempo_rev")
            .Range.Delete
        End With
        
        'On modifie le bloc rente non r|fffd|versible
        
        If Range("Terme_bar39").Value = "Echu" Then
            DocWord.bookmarks("Fractionnement_4").Select
            Select Case Range("Fractionnement_bar39").Value
                Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                Case "Mensuel": .TypeText Text:="" & "le mois"
            End Select


             DocWord.bookmarks("Prorata").Select
             Select Case Range("Prorata_bar39").Value
                 Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                 Case "Complet": .TypeText Text:="" & "de"
             End Select
        End If
    
        If Range("Terme_bar39").Value = "Avance" Or Range("Prorata_bar39") = "Proportionnel" Then
            With DocWord.bookmarks("Terme_avance")
                .Range.Delete
            End With
        End If
        
        
   Case "R|fffd|versible":
        
        'On supprime le bloc rente non r|fffd|versible
        With DocWord.bookmarks("Rente_non_rev")
            .Range.Delete
        End With
        'On supprime le bloc rente temporaire
        With DocWord.bookmarks("Rente_tempo")
            .Range.Delete
        End With
        
        'On supprime le bloc rente temporaire r|fffd|versible
        With DocWord.bookmarks("Rente_tempo_rev")
            .Range.Delete
        End With
        
        'On modifie le bloc rente r|fffd|versible
        
        DocWord.bookmarks("Taux_rev").Select
                .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")
        
        Select Case Range("Fractionnement_bar39").Value
            Case "Mensuel":
                With DocWord.bookmarks("Prorata_1")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Prorata_2")
                    .Range.Delete
                End With

            Case "Trimestriel":
                With DocWord.bookmarks("Rente_mens")
                    .Range.Delete
                End With

                If Range("Prorata_bar39").Value = "Sans" Then
                    With DocWord.bookmarks("Prorata_1")
                        .Range.Delete
                    End With
                    DocWord.bookmarks("Fractionnement_5").Select
                        .TypeText Text:="" & "le trimestre"
                    DocWord.bookmarks("Fractionnement_6").Select
                        .TypeText Text:="" & "du trimestre civil"
                    DocWord.bookmarks("Fractionnement_7").Select
                        .TypeText Text:="" & "le trimestre"
                End If

                If Range("Prorata_bar39").Value = "Complet" Then
                    With DocWord.bookmarks("Prorata_2")
                        .Range.Delete
                    End With
                    DocWord.bookmarks("Fractionnement_8").Select
                        .TypeText Text:="" & "le trimestre"
                    DocWord.bookmarks("Fractionnement_9").Select
                        .TypeText Text:="" & "du trimestre civil"
                    DocWord.bookmarks("Fractionnement_10").Select
                        .TypeText Text:="" & "le trimestre"
                End If
                
                If Range("Prorata_bar39") = "Proportionnel" Then
                    With DocWord.bookmarks("Prorata_prop_1")
                        .Range.Delete
                    End With
                End If
                
        End Select
    
    End Select
    


    '-----Remplissage de la fin du documemnt
    
    If Range("Garantie_dep") = "Non" Then
        With DocWord.bookmarks("Garantie_dep")
            .Range.Delete
        End With
    End If
    
    DocWord.bookmarks("Date_du_jour").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If

End With
End With
End Sub
Attribute VB_Name = "Edition_courrier_bar_83"
Sub Edition_courrier_bar83()

Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc83 = "Titre_de_rente_83_toutes_options_de rente_version_valid|fffd|e_le_29012018_V2_PASRAU.docx"
Dim start, fin As Integer
'Dim signet, signet2 As Bookmark


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc83, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1
  
'---- Remplissage en-t|fffd|te page 1

'On supprime la partie R|fffd|gularisation
With DocWord.bookmarks("Regularisation")
    .Range.Delete
End With

With .Selection

   DocWord.bookmarks("Sexe_assur|fffd|").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If

    DocWord.bookmarks("Code_postal_assur|fffd|").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP").Select
        .TypeText Text:="" & Range("RPP_bar83").Value

    DocWord.bookmarks("Ref_entreprise").Select
        .TypeText Text:="" & Range("Ref_entreprise_bar83").Value

    DocWord.bookmarks("Adhesion").Select
        .TypeText Text:="" & Range("Adhesion_bar83").Value

    DocWord.bookmarks("Num_rente").Select
        .TypeText Text:="" & Range("Num_rente_bar83").Value

    DocWord.bookmarks("Demande").Select
        .TypeText Text:="" & Range("Demande_bar83").Value


    '----- Remplissage fin page 1
    DocWord.bookmarks("Date_du_jour").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If
    
        

    DocWord.bookmarks("Sexe_assur|fffd|_1").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Date_effet").Select
    If Day(CDate(Range("Date_effet_bar83"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar83").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_bar83").Value, "dd mmmm yyyy")
    End If
          
'----- Suppression du [ou partielle] si
   If Range("Test_bar83").Value = 82 Or Range("PS_exo_partielle").Value = 1 Then 'on ajoute la condition de partiel (pas de sens sinon)
        With DocWord.bookmarks("Rte_82")
            .Range.Delete
        End With
   End If
          
    'On supprime le passage |fffd| la fin de la page 1 sur les PS si on a exo totale ou |fffd|tranger
   If Range("Montant_brut_bar83").Value = Range("Montant_net_bar83").Value Or Range("PS_etranger").Value = 1 Then
        With DocWord.bookmarks("PS_1")
            .Range.Delete
        End With
   End If
   
   
'--- Entrer dans l'en-t|fffd|te
   DocWord.ActiveWindow.ActivePane.View.SeekView = 9
   
    '-----Remplissage en-t|fffd|te de toutes les feuilles du courrier

    DocWord.bookmarks("RPP_2").Select
        .TypeText Text:="" & Range("RPP_bar83").Value

    DocWord.bookmarks("Ref_entreprise_2").Select
        .TypeText Text:="" & Range("Ref_entreprise_bar83").Value

    DocWord.bookmarks("Num_rente_4").Select
        .TypeText Text:="" & Range("Num_rente_bar83").Value

    DocWord.bookmarks("Demande_2").Select
        .TypeText Text:="" & Range("Demande_bar83").Value
        
'---- Repasser dans le corps
DocWord.ActiveWindow.ActivePane.View.SeekView = 0
    
    '-----Remplissage PAGE 2

    DocWord.bookmarks("Sexe_assur|fffd|_2").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
    '-----Remplissage PAGE 3
    
   If Range("Test_bar83").Value = 82 Or Range("PS_exo_partielle").Value = 1 Then 'on ajoute la condition de partiel (pas de sens sinon)
        With DocWord.bookmarks("Rte_82_1")
            .Range.Delete
        End With
   End If

    '-----Remplissage PAGE 4 : Notification de rente

    DocWord.bookmarks("Sexe_assur|fffd|_3").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_2").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Sexe_assur|fffd|_4").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "le"
        Case "F": .TypeText Text:="" & "la"
    End Select
    
    DocWord.bookmarks("Num_rente_1").Select
        .TypeText Text:="" & Range("Num_rente_bar83").Value

    DocWord.bookmarks("Date_effet_1").Select
    If Day(CDate(Range("Date_effet_bar83"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar83").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_effet_bar83").Value, "dd mmmm yyyy")
    End If

    DocWord.bookmarks("Montant_brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_bar83").Value, "##,##0.00 ")

    DocWord.bookmarks("K").Select
        .TypeText Text:="" & Format(Range("K_bar83").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Tarif").Select
        .TypeText Text:="" & Range("Tarif").Value

    DocWord.bookmarks("Fractionnement").Select
    Select Case Range("Fractionnement_bar83").Value
        Case "Annuel": .TypeText Text:="" & "annuelle"
        Case "Semestriel": .TypeText Text:="" & "semestrielle"
        Case "Trimestriel": .TypeText Text:="" & "trimestrielle"
        Case "Mensuel": .TypeText Text:="" & "mensuelle"
    End Select

    DocWord.bookmarks("Montant_brut_frac").Select
        .TypeText Text:="" & Format(Range("Montant_brut_frac_bar83").Value, "##,##0.00 ")
        
'Concerne le net donc |fffd| enlever pour PASRAU
    'DocWord.bookmarks("Fractionnement_1").Select
    'Select Case Range("Fractionnement_bar83").Value
     '   Case "Annuel": .TypeText Text:="" & "annuel"
      '  Case "Semestriel": .TypeText Text:="" & "semestriel"
       ' Case "Trimestriel": .TypeText Text:="" & "trimestriel"
        'Case "Mensuel": .TypeText Text:="" & "mensuel"
    'End Select

    'DocWord.bookmarks("Montant_net_frac").Select
     '   .TypeText Text:="" & Format(Range("Montant_net_frac_bar83").Value, "##,##0.00 ")

    'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
     If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82_1")
            .Range.Delete
        End With
    
    End If

    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
       With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_bar83").Value = Range("Montant_net_bar83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
    
    End If
    
    'Le paiement de votre rente
    
    DocWord.bookmarks("Fractionnement_2").Select
    Select Case Range("Fractionnement_bar83").Value
        Case "Annuel": .TypeText Text:="" & "annuellement"
        Case "Semestriel": .TypeText Text:="" & "semestriellement"
        Case "Trimestriel": .TypeText Text:="" & "trimestriellement"
        Case "Mensuel": .TypeText Text:="" & "mensuellement"
    End Select
    
    DocWord.bookmarks("Terme").Select
    Select Case Range("Terme_bar83").Value
        Case "Echu": .TypeText Text:="" & "|fffd| la fin de chaque"
        Case "Avance": .TypeText Text:="" & "au d|fffd|but de chaque "
    End Select
    
    DocWord.bookmarks("Fractionnement_3").Select
    Select Case Range("Fractionnement_bar83").Value
        Case "Annuel": .TypeText Text:="" & "ann|fffd|e civile"
        Case "Semestriel": .TypeText Text:="" & "semestre civil"
        Case "Trimestriel": .TypeText Text:="" & "trimestre civil"
        Case "Mensuel": .TypeText Text:="" & "mois"
    End Select
    
    DocWord.bookmarks("Premier_paiement").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "est intervenu"
        Case "Non": .TypeText Text:="" & "interviendra dans les tous prochains jours"
        .Delete
    End Select
    
    
    DocWord.bookmarks("Date_PP").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "le " & Range("Date_PP").Value 'ajout d'un espace
    End Select
    
        
    DocWord.bookmarks("Premier_paiement_1").Select
    Select Case Range("Premier_paiement").Value
        Case "Oui": .TypeText Text:="" & "a |fffd|t|fffd|"
        Case "Non": .TypeText Text:="" & "sera"
    End Select
    
    If Range("Premier_paiement").Value = "Non" Then
        With DocWord.bookmarks("P|fffd|riode")
            .Range.Delete
        End With
    Else:
        DocWord.bookmarks("Date_debut").Select
        If Day(CDate(Range("Date_deb"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_deb").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
        End If
        
        DocWord.bookmarks("Date_fin").Select
        If Day(CDate(Range("Date_f"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_f").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
        End If
        
      
    End If
     
    
    'Les caract|fffd|ristiques de votre rente : Choix de l'option

    Select Case Range("option_rente_bar83").Value

        Case "Non r|fffd|versible": 'Si la rente est non r|fffd|versible

            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                .Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With


            'On modifie le bloc rente non r|fffd|versible

            If Range("Terme_bar83").Value = "Echu" Then

                 DocWord.bookmarks("Fractionnement_4").Select
                 Select Case Range("Fractionnement_bar83").Value
                     Case "Annuel": .TypeText Text:="" & "l'ann|fffd|e"
                     Case "Semestriel": .TypeText Text:="" & "le semestre"
                     Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                     Case "Mensuel": .TypeText Text:="" & "le mois"
                 End Select


                 DocWord.bookmarks("Prorata").Select
                 Select Case Range("Prorata_bar83").Value
                     Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                     Case "Complet": .TypeText Text:="" & "de"
                 End Select
            End If
        
            If Range("Terme_bar83").Value = "Avance" Or Range("Prorata_bar83") = "Proportionnel" Then
                With DocWord.bookmarks("Terme_avance")
                    .Range.Delete
                End With
            End If
            
        Case "R|fffd|versible": 'Si la rente est r|fffd|versible


            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With

            'On modifie le bloc rente r|fffd|versible

            DocWord.bookmarks("Taux_rev").Select
                .TypeText Text:="" & Format(Range("Taux_reversion").Value, "0%")

            If Range("Qualite_reversataire").Value <> "Ajout PACS" Then
                With DocWord.bookmarks("qualite_rev")
                    .Range.Delete
                End With
                With DocWord.bookmarks("Qualite_rev_2")
                    .Range.Delete
                End With
            End If

            Select Case Range("Fractionnement_bar83").Value
                Case "Mensuel":
                    With DocWord.bookmarks("Prorata_1")
                        .Range.Delete
                    End With
                    With DocWord.bookmarks("Prorata_2")
                        .Range.Delete
                    End With

                Case "Semestriel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_bar83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "du semestre civil"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "le semestre"
                    End If

                    If Range("Prorata_bar83").Value = "Complet" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "du semestre civil"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "le semestre"
                    End If
                    

                Case "Trimestriel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_bar83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "du trimestre civil"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "le trimestre"
                    End If

                    If Range("Prorata_bar83").Value = "Complet" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "du trimestre civil"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "le trimestre"
                    End If


                Case "Annuel":

                    With DocWord.bookmarks("Rente_mens")
                        .Range.Delete
                    End With

                    If Range("Prorata_bar83").Value = "Sans" Then
                        With DocWord.bookmarks("Prorata_1")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_5").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Fractionnement_6").Select
                            .TypeText Text:="" & "de l'ann|fffd|e civile"
                        DocWord.bookmarks("Fractionnement_7").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                    End If

                    If Range("Prorata_bar83").Value = "Complet" Then
                        With DocWord.bookmarks("Prorata_2")
                            .Range.Delete
                        End With
                        DocWord.bookmarks("Fractionnement_8").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Fractionnement_9").Select
                            .TypeText Text:="" & "de l'ann|fffd|e civile"
                        DocWord.bookmarks("Fractionnement_10").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                    End If


            End Select
            
            If Range("Fractionnement_bar83").Value <> "Mensuel" And Range("Prorata_bar83").Value = "Proportionnel" Then
                With DocWord.bookmarks("Prorata_prop")
                    .Range.Delete
                End With
            End If


        Case "Croissante par palier":
            
            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete
            End With

            With DocWord.bookmarks("Rente_AG")
                .Range.Delete
            End With
            
            'On modifie le bloc rente croissante par palier
            
            If Range("Terme_bar83").Value = "Echu" Then

                 DocWord.bookmarks("Frac_2").Select
                 Select Case Range("Fractionnement_bar83").Value
                     Case "Annuel": .TypeText Text:="" & "l'ann|fffd|e"
                     Case "Semestriel": .TypeText Text:="" & "le semestre"
                     Case "Trimestriel": .TypeText Text:="" & "le trimestre"
                     Case "Mensuel": .TypeText Text:="" & "le mois"
                 End Select


                 DocWord.bookmarks("Prorata_5").Select
                 Select Case Range("Prorata_bar83").Value
                     Case "Sans": .TypeText Text:="" & "pr|fffd|c|fffd|dent"
                     Case "Complet": .TypeText Text:="" & "de"
                 End Select
            End If
        
            If Range("Terme_bar83").Value = "Avance" Or Range("Prorata_bar83") = "Proportionnel" Then
                With DocWord.bookmarks("Prorata_prop_2")
                    .Range.Delete
                End With
            End If

        Case "Annuit|fffd|s garanties": 'Si la rente est avec annuit|fffd|s garanties

            'On supprime les blocs r|fffd|serv|fffd|s aux autres options de rente
            With DocWord.bookmarks("Rente_non_rev")
                .Range.Delete

            End With

            With DocWord.bookmarks("Rente_rev")
                .Range.Delete
                
            End With

            With DocWord.bookmarks("Rente_palier")
                .Range.Delete

            End With

            With DocWord.bookmarks("Rente_AM")
                .Range.Delete

            End With

            With DocWord.bookmarks("Rente_rev_AG")
                .Range.Delete

            End With


            'On modifie le bloc Annuit|fffd|s Garanties (AG)

            DocWord.bookmarks("Nb_AG").Select
                .TypeText Text:="" & Range("Nb_AG_bar83").Value
            DocWord.bookmarks("Nb_AG_1").Select
                .TypeText Text:="" & Range("Nb_AG_bar83").Value

            If Range("Nb_benef").Value > 1 Then 'S'il y a plus d'un b|fffd|n|fffd|ficiare
                DocWord.bookmarks("Nb_ben").Select
                    .TypeText Text:="" & "x"
                DocWord.bookmarks("Nb_ben1").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben2").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben3").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben4").Select
                    .TypeText Text:="" & "sont"
                DocWord.bookmarks("Nb_ben5").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben6").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben7").Select
                    .TypeText Text:="" & "s"
                DocWord.bookmarks("Nb_ben8").Select
                    .TypeText Text:="" & "s"


            Else:
                DocWord.bookmarks("Nb_ben4").Select
                    .TypeText Text:="" & "est"
                With DocWord.bookmarks("Nb_ben9")
                    .Range.Delete
                End With
            End If

            'Remplissage tableau de b|fffd|n|fffd|ficaires

         If Range("Nb_benef").Value >= 1 Then

                DocWord.bookmarks("Nom_b1").Select
                    .TypeText Text:="" & Range("Nom_benef1").Value

                ' Ajout condition sur le nom de naissance
                DocWord.bookmarks("Nom_nais_b1").Select
                If Range("Nom_naissance_benef1").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef1").Value
                    Else:
                    .Delete
                End If
                '--------

                DocWord.bookmarks("Prenom_b1").Select
                    .TypeText Text:="" & Range("Prenom_benef1").Value

                DocWord.bookmarks("Date_nais_b1").Select
                If Day(CDate(Range("Date_naissance_benef1"))) = 1 Then
                    .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef1").Value, "mmmm yyyy")
                Else:
                    .TypeText Text:="" & Format(Range("Date_naissance_benef1").Value, "dd mmmm yyyy")
                End If
                
                DocWord.bookmarks("Commune_b1").Select
                    .TypeText Text:="" & Range("Commune_naissance_benef1").Value

                DocWord.bookmarks("Lien_b1").Select
                    .TypeText Text:="" & Range("Lien_parent|fffd|_benef1").Value

                DocWord.bookmarks("Pourcentage_b1").Select
                    .TypeText Text:="" & Range("Pourcentage_rep_benef1").Value

            End If

            If Range("Nb_benef").Value >= 2 Then

                   DocWord.bookmarks("Nom_b2").Select
                       .TypeText Text:="" & Range("Nom_benef2").Value

                   DocWord.bookmarks("Nom_nais_b2").Select
                If Range("Nom_naissance_benef2").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef2").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b2").Select
                       .TypeText Text:="" & Range("Prenom_benef2").Value

                   DocWord.bookmarks("Date_nais_b2").Select
                    If Day(CDate(Range("Date_naissance_benef2"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef2").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef2").Value, "dd mmmm yyyy")
                    End If
                        
                    DocWord.bookmarks("Commune_b2").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef2").Value


                   DocWord.bookmarks("Lien_b2").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef2").Value

                   DocWord.bookmarks("Pourcentage_b2").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef2").Value

               End If

            If Range("Nb_benef").Value >= 3 Then

                   DocWord.bookmarks("Nom_b3").Select
                       .TypeText Text:="" & Range("Nom_benef3").Value

                   DocWord.bookmarks("Nom_nais_b3").Select
                If Range("Nom_naissance_benef3").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef3").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b3").Select
                       .TypeText Text:="" & Range("Prenom_benef3").Value

                   DocWord.bookmarks("Date_nais_b3").Select
                     If Day(CDate(Range("Date_naissance_benef3"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef3").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef3").Value, "dd mmmm yyyy")
                    End If

                    DocWord.bookmarks("Commune_b3").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef3").Value
                    
                   DocWord.bookmarks("Lien_b3").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef3").Value

                   DocWord.bookmarks("Pourcentage_b3").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef3").Value

               End If

            If Range("Nb_benef").Value = 4 Then

                   DocWord.bookmarks("Nom_b4").Select
                       .TypeText Text:="" & Range("Nom_benef4").Value

                   DocWord.bookmarks("Nom_nais_b4").Select
                If Range("Nom_naissance_benef4").Value <> "" Then
                    .TypeText Text:="" & Range("Nom_naissance_benef4").Value
                    Else:
                    .Delete
                End If

                   DocWord.bookmarks("Prenom_b4").Select
                       .TypeText Text:="" & Range("Prenom_benef4").Value

                   DocWord.bookmarks("Date_nais_b4").Select
                    If Day(CDate(Range("Date_naissance_benef4"))) = 1 Then
                        .TypeText Text:="" & "1er " & Format(Range("Date_naissance_benef4").Value, "mmmm yyyy")
                    Else:
                        .TypeText Text:="" & Format(Range("Date_naissance_benef4").Value, "dd mmmm yyyy")
                    End If
                       
                    DocWord.bookmarks("Commune_b4").Select
                        .TypeText Text:="" & Range("Commune_naissance_benef4").Value

                   DocWord.bookmarks("Lien_b4").Select
                       .TypeText Text:="" & Range("Lien_parent|fffd|_benef4").Value

                   DocWord.bookmarks("Pourcentage_b4").Select
                       .TypeText Text:="" & Range("Pourcentage_rep_benef4").Value

               End If
               

                If Range("Nb_benef").Value = 1 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 2).Delete
                End If

                If Range("Nb_benef").Value <= 2 Then
                    DocWord.Tables(1).Rows((DocWord.Tables(1).Rows.Count) - 1).Delete
                End If

                If Range("Nb_benef").Value <= 3 Then
                    DocWord.Tables(1).Rows(DocWord.Tables(1).Rows.Count).Delete
                End If

                If Range("Nb_benef").Value = 0 Then
                    With DocWord.bookmarks("Aucun_benef1")
                        .Range.Delete
                    End With
                End If


                'Fin du remplissage du tableau des b|fffd|n|fffd|ficiaires

                DocWord.bookmarks("Nb_AG_2").Select
                    .TypeText Text:="" & Range("Nb_AG_bar83").Value


                Select Case Range("Fractionnement_bar83").Value
                    Case "Mensuel":
                        If Range("Prorata_bar83").Value = "Complet" Then
                            DocWord.bookmarks("Frac").Select
                                .TypeText Text:="" & "le mois"
                            DocWord.bookmarks("Frac_1").Select
                                .TypeText Text:="" & "le mois"
                        Else:
                            With DocWord.bookmarks("Prorata_prop_1")
                                .Range.Delete
                            End With
                        End If
                        
                    Case "Trimestriel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "le trimestre"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "le trimestre"

                    Case "Semestriel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "le semestre"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "le semestre"
                    Case "Annuel":
                        DocWord.bookmarks("Frac").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                        DocWord.bookmarks("Frac_1").Select
                            .TypeText Text:="" & "l'ann|fffd|e"
                End Select

                Select Case Range("Prorata_bar83").Value

                    Case "Sans":
                        DocWord.bookmarks("Prorata_3").Select
                            .TypeText Text:="" & "du"
                        DocWord.bookmarks("Prorata_4").Select
                            .TypeText Text:="" & "pr|fffd|c|fffd|dant le"

                    Case "Complet":

                        DocWord.bookmarks("Prorata_3").Select
                            .TypeText Text:="" & "qui suit le"
                        DocWord.bookmarks("Prorata_4").Select
                            .TypeText Text:="" & "du"
                            
                    Case "Proportionnel"
                        With DocWord.bookmarks("Prorata_prop_1")
                            .Range.Delete
                        End With
                End Select
    End Select

    'Remplissage fin page 8
    
        If Range("Garantie_dep") = "Non" Then
            With DocWord.bookmarks("Garantie_dep")
                .Range.Delete
            End With
        End If

        DocWord.bookmarks("Date_du_jour_1").Select
        If Day(CDate(Range("Date_du_jour"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
        End If

End With

End With

End Sub

Sub Regularisation_bar83()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDoc83 = "Titre_de_rente_83_toutes_options_de rente_version_valid|fffd|e_le_29012018_V2_PASRAU.docx"
Dim start, fin As Integer
'Dim signet, signet2 As Bookmark


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDoc83, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1


With .Selection


'------- VOTRE RETRAITE SUPPLEMENTAIRE -------


'On supprime la partie Mise en service
With DocWord.bookmarks("Mise_en_service")
    .Range.Delete
End With


'Remplissage en t|fffd|te

   DocWord.bookmarks("Sexe_assur|fffd|_5").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_3").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|_1").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value
    End If

    DocWord.bookmarks("Code_postal_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

    DocWord.bookmarks("RPP_1").Select
        .TypeText Text:="" & Range("RPP_bar83").Value

    DocWord.bookmarks("Ref_entreprise_1").Select
        .TypeText Text:="" & Range("Ref_entreprise_bar83").Value

    DocWord.bookmarks("Adhesion_1").Select
        .TypeText Text:="" & Range("Adhesion_bar83").Value

    DocWord.bookmarks("Num_rente_2").Select
        .TypeText Text:="" & Range("Num_rente_bar83").Value

    DocWord.bookmarks("Demande_1").Select
        .TypeText Text:="" & Range("Demande_bar83").Value
        
'Remplissage partie R|fffd|gularisation de votre rente

    'suppression de la page en trop
    With DocWord.bookmarks("Regularisation_2")
    .Range.Delete
    End With

    DocWord.bookmarks("Date_du_jour_2").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If


    DocWord.bookmarks("Sexe_assur|fffd|_6").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_4").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value
            
    DocWord.bookmarks("Num_rente_3").Select
        .TypeText Text:="" & Range("Num_rente_bar83").Value
        
    DocWord.bookmarks("Sexe_assur|fffd|_7").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
'Montant suppl|fffd|mentaire net
    DocWord.bookmarks("Suppl|fffd|ment_net").Select
        .TypeText Text:="" & Format(Range("Sup_net").Value, "##,##0.00 ")
    
    'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle_1")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger_1")
            .Range.Delete
        End With
    
    End If
    
     If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82")
            .Range.Delete
        End With
        
    End If


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo_1")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger_1")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo_1")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle_1")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_bar83").Value = Range("Montant_net_bar83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
    DocWord.bookmarks("PS_2").Select
        .TypeText Text:="" & "."

    End If
    
    DocWord.bookmarks("Nouveau_brut_annuel").Select
        '.TypeText Text:="" & Format(Range("Montant_brut_bar83").Value + Range("Date_PP").Value, "##,##0.00 ")
        .TypeText Text:="" & Format(Range("Montant_brut_bar83").Value, "##,##0.00 ")
        
        
    DocWord.bookmarks("Date_deb").Select
    If Day(CDate(Range("Date_deb"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_deb").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_deb").Value, "dd mmmm yyyy")
    End If
    
    DocWord.bookmarks("Date_fin_1").Select
    If Day(CDate(Range("Date_f"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_f").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_f").Value, "dd mmmm yyyy")
    End If
      

End With
End With

End Sub




Attribute VB_Name = "Edition_courrier_rachat_rente"
Sub Edition_courrier_rachat()

Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
Dim NomChemin As String
NomChemin = ActiveWorkbook.Path
Const NomDocRachat = "Sortie_K480_PASRAU.docx"


With AppWord
    Set DocWord = AppWord.Documents.Open(NomChemin & "\" & NomDocRachat, ReadOnly:=True)
    AppWord.ShowMe
    AppWord.Visible = True
    AppWord.Application.WindowState = 1
  
'---- Remplissage en-t|fffd|te page 1


With .Selection

   DocWord.bookmarks("Sexe_assur|fffd|").Select
    
    Select Case Range("Sexe_assur|fffd|").Value
         Case "H": .TypeText Text:="" & "Monsieur"
         Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|").Select
           .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Adresse_assur|fffd|").Select
        .TypeText Text:="" & Range("Adresse_assur|fffd|").Value

    
    If Range("Comp_adresse_assur|fffd|").Value <> "" Then
        DocWord.bookmarks("Comp_adresse_assur|fffd|").Select
            .TypeText Text:="" & Range("Comp_adresse_assur|fffd|").Value 's|fffd|paration adresse et comp
    End If

    DocWord.bookmarks("Code_postal_assur|fffd|").Select
        .TypeText Text:="" & Range("Code_postal_assur|fffd|").Value

    DocWord.bookmarks("Commune_assur|fffd|").Select
        .TypeText Text:="" & Range("Commune_assur|fffd|").Value

    DocWord.bookmarks("Pays_assur|fffd|").Select
        .TypeText Text:="" & Range("Pays_assur|fffd|").Value

'--- ajouter une condition pour s|fffd|lection de la RPP si bar|fffd|me ou 83


    DocWord.bookmarks("RPP").Select
If Range("Test_bar83").Value = 83 Or Range("Test_bar83").Value = 82 Then
        .TypeText Text:="" & Range("RPP_bar83").Value
Else
    .TypeText Text:="" & Range("RPP_art83").Value
End If


'-------
    
    DocWord.bookmarks("Ref_entreprise").Select
        .TypeText Text:="" & Range("Ref_entreprise_art83").Value

    DocWord.bookmarks("Adhesion").Select
        .TypeText Text:="" & Range("Adhesion_art83").Value

    DocWord.bookmarks("Num_rente").Select
        .TypeText Text:="" & Range("Num_rente_art83").Value

    DocWord.bookmarks("Demande").Select
        .TypeText Text:="" & Range("Demande_art83").Value


    '----- Remplissage fin page 1

    DocWord.bookmarks("Date_du_jour").Select
    If Day(CDate(Range("Date_du_jour"))) = 1 Then
        .TypeText Text:="" & "1er " & Format(Range("Date_du_jour").Value, "mmmm yyyy")
    Else:
        .TypeText Text:="" & Format(Range("Date_du_jour").Value, "dd mmmm yyyy")
    End If


    DocWord.bookmarks("Sexe_assur|fffd|_1").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select

    DocWord.bookmarks("Nom_assur|fffd|_1").Select
        .TypeText Text:="" & Range("Nom_assur|fffd|").Value

    DocWord.bookmarks("Date_effet").Select
    
    
 '-----S'il s'agit d'un rachat pour un 83 ou un 82 depuis Art83
        
    If Range("Test_art83").Value = 83 Or Range("Test_art83").Value = 82 Then
        
        If Day(CDate(Range("Date_effet_art83"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_effet_art83").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_effet_art83").Value, "dd mmmm yyyy")
        End If
        
     DocWord.bookmarks("Capital").Select
        .TypeText Text:="" & Format(Range("K_art83").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Montant_brut_annuel").Select
    .TypeText Text:="" & Format(Range("Montant_brut_art83").Value, "##,##0.00 ")
        
     'Calcul montant capital net
    
    '------- Modification PASRAU
    DocWord.bookmarks("Capital_net").Select
               .TypeText Text:="" & Format(Range("Net_480").Value, "##,##0.00 ")
     
'
'     If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
'        Select Case Range("Test_art83").Value
'
'        Case 83:
'            DocWord.bookmarks("Capital_net").Select
'                .TypeText Text:="" & Format(Range("K_art83") * (1 - Range("Tx_PS_sans_exo")), "##,##0.00 ")
'        Case 82:
'           DocWord.bookmarks("Capital_net").Select
'                .TypeText Text:="" & Format(Range("K_art83") * (1 - Range("AM")), "##,##0.00 ")
'
'        End Select
'     End If
'
'
'    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
'        DocWord.bookmarks("Capital_net").Select
'           .TypeText Text:="" & Format(Range("K_art83") * (1 - Range("Tx_PS_exo_partielle")), "##,##0.00 ")
'    End If
'
'    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_art83") * (1 - Range("Tx_PS_etranger")), "##,##0.00 ")
'    End If
'
'    'Si on a une exon|fffd|ration totale
'    If Range("Montant_brut_art83").Value = Range("Montant_net_art83").Value Then
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_art83"), "##,##0.00 ")
'
'    End If
                   
        
   'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
     If Range("PS_sans_exo").Value = 1 And Range("Test_art83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82_1")
            .Range.Delete
        End With
    
    End If

    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_art83").Value = Range("Montant_net_art83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
        
        DocWord.bookmarks("PSbis").Select
        .TypeText Text:="" & "."
    
    End If
        
    End If
    
'-----S'il s'agit d'un rachat pour un 83 ou un 82 depuis Bar|fffd|me

    If Range("Test_bar83").Value = 83 Or Range("Test_bar83").Value = 82 Then
        
        If Day(CDate(Range("Date_effet_bar83"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar83").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_effet_bar83").Value, "dd mmmm yyyy")
        End If
        
      DocWord.bookmarks("Capital").Select
        .TypeText Text:="" & Format(Range("K_bar83").Value, "##,##0.00 ")
        
      DocWord.bookmarks("Montant_brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_bar83").Value, "##,##0.00 ")
        
        
  'Calcul montant capital net
    DocWord.bookmarks("Capital_net").Select
               .TypeText Text:="" & Format(Range("Net_480").Value, "##,##0.00 ")
        
        
'    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
'       Select Case Range("Test_bar83").Value
'
'       Case 83:
'           DocWord.bookmarks("Capital_net").Select
'               .TypeText Text:="" & Format(Range("K_bar83") * (1 - Range("Tx_PS_sans_exo")), "##,##0.00 ")
'       Case 82:
'          DocWord.bookmarks("Capital_net").Select
'               .TypeText Text:="" & Format(Range("K_bar83") * (1 - Range("AM")), "##,##0.00 ")
'
'       End Select
'    End If
'
'
'    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
'        DocWord.bookmarks("Capital_net").Select
'           .TypeText Text:="" & Format(Range("K_bar83") * (1 - Range("Tx_PS_exo_partielle")), "##,##0.00 ")
'    End If
'
'    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_bar83") * (1 - Range("Tx_PS_etranger")), "##,##0.00 ")
'    End If
'
'    'Si on a une exon|fffd|ration totale
'    If Range("Montant_brut_bar83").Value = Range("Montant_net_bar83").Value Then
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_bar83"), "##,##0.00 ")
'
'    End If
  
    
  'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 83 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 83
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
     If Range("PS_sans_exo").Value = 1 And Range("Test_bar83").Value = 82 Then 'S'il n'y a pas d'exon|fffd|ration et qu'il s'agit d'un 82
        
        'On ne garde que la ligne sur l'AM
        With DocWord.bookmarks("PS_82_1")
            .Range.Delete
        End With
    
    End If

    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_bar83").Value = Range("Montant_net_bar83").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
        
        DocWord.bookmarks("PSbis").Select
        .TypeText Text:="" & "."
    
    End If
          
        
    End If


'-----S'il s'agit d'un rachat pour un 39 depuis bar|fffd|me
    If Range("Test_bar39").Value = 1 Then
        
        If Day(CDate(Range("Date_effet_bar39"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_effet_bar39").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_effet_bar39").Value, "dd mmmm yyyy")
        End If
        
      DocWord.bookmarks("Capital").Select
        .TypeText Text:="" & Format(Range("K_bar39").Value, "##,##0.00 ")
        
        DocWord.bookmarks("Montant_brut_annuel").Select
        .TypeText Text:="" & Format(Range("Montant_brut_bar39").Value, "##,##0.00 ")
        
        
   'Calcul montant capital net
        
        DocWord.bookmarks("Capital_net").Select
               .TypeText Text:="" & Format(Range("Net_480").Value, "##,##0.00 ")
               
'    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
'
'           DocWord.bookmarks("Capital_net").Select
'               .TypeText Text:="" & Format(Range("K_bar39") * (1 - Range("Tx_PS_sans_exo")), "##,##0.00 ")
'    End If
'
'
'    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
'        DocWord.bookmarks("Capital_net").Select
'           .TypeText Text:="" & Format(Range("K_bar39") * (1 - Range("Tx_PS_exo_partielle")), "##,##0.00 ")
'    End If
'
'    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_bar39") * (1 - Range("Tx_PS_etranger")), "##,##0.00 ")
'    End If
'
'    'Si on a une exon|fffd|ration totale
'    If (Range("Montant_brut_bar39").Value - Range("Mt_contribution_specifique_art39").Value) = Range("Montant_net_bar39").Value Then
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_bar39"), "##,##0.00 ")
'
'    End If
                 
  'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_bar39").Value = Range("Montant_net_bar39").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
    
    End If
        
    End If
    
    
'-----S'il s'agit d'un rachat pour un 39 depuis Art39
    If Range("Test_art39").Value = 1 Then
        
        If Day(CDate(Range("Date_effet_art39"))) = 1 Then
            .TypeText Text:="" & "1er " & Format(Range("Date_effet_art39").Value, "mmmm yyyy")
        Else:
            .TypeText Text:="" & Format(Range("Date_effet_art39").Value, "dd mmmm yyyy")
        End If
        
     DocWord.bookmarks("Capital").Select
        .TypeText Text:="" & Format(Range("K_art39").Value, "##,##0.00 ")
        
    DocWord.bookmarks("Montant_brut_annuel").Select
    .TypeText Text:="" & Format(Range("Montant_brut_art39").Value, "##,##0.00 ")
    
    
   'Calcul montant capital net
        DocWord.bookmarks("Capital_net").Select
               .TypeText Text:="" & Format(Range("Net_480").Value, "##,##0.00 ")
        
'    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
'
'           DocWord.bookmarks("Capital_net").Select
'               .TypeText Text:="" & Format(Range("K_art39") * (1 - Range("Tx_PS_sans_exo")), "##,##0.00 ")
'    End If
'
'
'    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
'        DocWord.bookmarks("Capital_net").Select
'           .TypeText Text:="" & Format(Range("K_art39") * (1 - Range("Tx_PS_exo_partielle")), "##,##0.00 ")
'    End If
'
'    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_art39") * (1 - Range("Tx_PS_etranger")), "##,##0.00 ")
'    End If
'
'    'Si on a une exon|fffd|ration totale
'    If Range("Montant_brut_art39").Value = Range("Montant_net_art39").Value Then
'        DocWord.bookmarks("Capital_net").Select
'            .TypeText Text:="" & Format(Range("K_art39"), "##,##0.00 ")
'
'    End If
                 
  'Partie pr|fffd|l|fffd|vements sociaux (PS)
    
    
    If Range("PS_sans_exo").Value = 1 Then 'S'il n'y a pas d'exon|fffd|ration
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    


    If Range("PS_exo_partielle").Value = 1 Then 'S'il y a exon|fffd|ration partielle
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc |fffd|tranger
        With DocWord.bookmarks("PS_etranger")
            .Range.Delete
        End With
    
    End If
    
    If Range("PS_etranger").Value = 1 Then 'Si on choisit les pr|fffd|l|fffd|vements sociaux pour |fffd|tranger
        
        'On supprime le bloc sans exon|fffd|ration
        With DocWord.bookmarks("PS_sans_exo")
            .Range.Delete
        End With
        
        'On supprime le bloc exon|fffd|ration partielle
        With DocWord.bookmarks("PS_exo_partielle")
            .Range.Delete
        End With
        
    End If

    'Si on a une exon|fffd|ration totale
    If Range("Montant_brut_art39").Value = Range("Montant_net_art39").Value Then
        'On supprime le bloc pr|fffd|vu pour les pr|fffd|l|fffd|vements sociaux
        With DocWord.bookmarks("PS")
            .Range.Delete
        End With
    
    End If
    
        
    End If


    DocWord.bookmarks("Sexe_assur|fffd|_2").Select
    Select Case Range("Sexe_assur|fffd|").Value
        Case "H": .TypeText Text:="" & "Monsieur"
        Case "F": .TypeText Text:="" & "Madame"
    End Select
    
End With
End With

End Sub
Attribute VB_Name = "FctAnnuit|fffd|s"

Option Explicit

Global PF4649(0 To 117) As Double
Global PM4649(0 To 117) As Double
Global PM6064(0 To 117) As Double
Global PF6064(0 To 117) As Double
Global TV7377(0 To 117) As Double
Global TD7377(0 To 117) As Double
Global TV8890(0 To 117) As Double
Global TD8890(0 To 117) As Double
Global TPRV93(0 To 117) As Double
Global TV2000(0 To 117) As Double
Global MR93(0 To 117) As Double
Global TPG(1887 To 1993, 0 To 117) As Double

Function IniTPG1()
TPG(1887, 0) = 100000
TPG(1887, 1) = 71822
TPG(1887, 2) = 63771
TPG(1887, 3) = 61643
TPG(1887, 4) = 60570
TPG(1887, 5) = 60015
TPG(1887, 6) = 59903
TPG(1887, 7) = 59807
TPG(1887, 8) = 59723
TPG(1887, 9) = 59650
TPG(1887, 10) = 59586
TPG(1887, 11) = 59542
TPG(1887, 12) = 59499
TPG(1887, 13) = 59457
TPG(1887, 14) = 59414
TPG(1887, 15) = 59372
TPG(1887, 16) = 59336
TPG(1887, 17) = 59296
TPG(1887, 18) = 59253
TPG(1887, 19) = 59207
TPG(1887, 20) = 59156
TPG(1887, 21) = 59101
TPG(1887, 22) = 59041
TPG(1887, 23) = 58976
TPG(1887, 24) = 58905
TPG(1887, 25) = 58828
TPG(1887, 26) = 58743
TPG(1887, 27) = 58653
TPG(1887, 28) = 58555
TPG(1887, 29) = 58451
TPG(1887, 30) = 58341
TPG(1887, 31) = 58218
TPG(1887, 32) = 58089
TPG(1887, 33) = 57955
TPG(1887, 34) = 57815
TPG(1887, 35) = 57669
TPG(1887, 36) = 57522
TPG(1887, 37) = 57365
TPG(1887, 38) = 57356
TPG(1887, 39) = 57179
TPG(1887, 40) = 56991
TPG(1887, 41) = 56794
TPG(1887, 42) = 56585
TPG(1887, 43) = 56360
TPG(1887, 44) = 56121
TPG(1887, 45) = 55865
TPG(1887, 46) = 55580
TPG(1887, 47) = 55283
TPG(1887, 48) = 54972
TPG(1887, 49) = 54648
TPG(1887, 50) = 54309
TPG(1887, 51) = 53967
TPG(1887, 52) = 53602
TPG(1887, 53) = 53214
TPG(1887, 54) = 52802
TPG(1887, 55) = 52364
TPG(1887, 56) = 51919
TPG(1887, 57) = 51437
TPG(1887, 58) = 50915
TPG(1887, 59) = 50351
TPG(1887, 60) = 49744
TPG(1887, 61) = 49077
TPG(1887, 62) = 48371
TPG(1887, 63) = 47622
TPG(1887, 64) = 46831
TPG(1887, 65) = 45995
TPG(1887, 66) = 45114
TPG(1887, 67) = 44187
TPG(1887, 68) = 43212
TPG(1887, 69) = 42191
TPG(1887, 70) = 41120
TPG(1887, 71) = 39998
TPG(1887, 72) = 38824
TPG(1887, 73) = 37595
TPG(1887, 74) = 36285
TPG(1887, 75) = 34892
TPG(1887, 76) = 33413
TPG(1887, 77) = 31849
TPG(1887, 78) = 30199
TPG(1887, 79) = 28464
TPG(1887, 80) = 26648
TPG(1887, 81) = 24758
TPG(1887, 82) = 22805
TPG(1887, 83) = 20802
TPG(1887, 84) = 18793
TPG(1887, 85) = 16797
TPG(1887, 86) = 14833
TPG(1887, 87) = 12922
TPG(1887, 88) = 11086
TPG(1887, 89) = 9371
TPG(1887, 90) = 7791
TPG(1887, 91) = 6359
TPG(1887, 92) = 5082
TPG(1887, 93) = 3968
TPG(1887, 94) = 3026
TPG(1887, 95) = 2247
TPG(1887, 96) = 1620
TPG(1887, 97) = 1129
TPG(1887, 98) = 758
TPG(1887, 99) = 487
TPG(1887, 100) = 298
TPG(1887, 101) = 172
TPG(1887, 102) = 93
TPG(1887, 103) = 46
TPG(1887, 104) = 21
TPG(1887, 105) = 8
TPG(1887, 106) = 3
TPG(1887, 107) = 1
TPG(1887, 108) = 0
TPG(1887, 109) = 0
TPG(1887, 110) = 0
TPG(1887, 111) = 0
TPG(1887, 112) = 0
TPG(1887, 113) = 0
TPG(1887, 114) = 0
TPG(1887, 115) = 0
TPG(1887, 116) = 0
TPG(1887, 117) = 0
TPG(1888, 0) = 100000
TPG(1888, 1) = 72636
TPG(1888, 2) = 64756
TPG(1888, 3) = 62686
TPG(1888, 4) = 61637
TPG(1888, 5) = 61092
TPG(1888, 6) = 60981
TPG(1888, 7) = 60884
TPG(1888, 8) = 60800
TPG(1888, 9) = 60727
TPG(1888, 10) = 60664
TPG(1888, 11) = 60621
TPG(1888, 12) = 60578
TPG(1888, 13) = 60535
TPG(1888, 14) = 60492
TPG(1888, 15) = 60450
TPG(1888, 16) = 60413
TPG(1888, 17) = 60373
TPG(1888, 18) = 60330
TPG(1888, 19) = 60283
TPG(1888, 20) = 60231
TPG(1888, 21) = 60176
TPG(1888, 22) = 60116
TPG(1888, 23) = 60050
TPG(1888, 24) = 59979
TPG(1888, 25) = 59901
TPG(1888, 26) = 59816
TPG(1888, 27) = 59725
TPG(1888, 28) = 59628
TPG(1888, 29) = 59524
TPG(1888, 30) = 59412
TPG(1888, 31) = 59289
TPG(1888, 32) = 59161
TPG(1888, 33) = 59027
TPG(1888, 34) = 58887
TPG(1888, 35) = 58741
TPG(1888, 36) = 58593
TPG(1888, 37) = 58583
TPG(1888, 38) = 58416
TPG(1888, 39) = 58239
TPG(1888, 40) = 58051
TPG(1888, 41) = 57855
TPG(1888, 42) = 57644
TPG(1888, 43) = 57420
TPG(1888, 44) = 57180
TPG(1888, 45) = 56924
TPG(1888, 46) = 56639
TPG(1888, 47) = 56342
TPG(1888, 48) = 56031
TPG(1888, 49) = 55705
TPG(1888, 50) = 55365
TPG(1888, 51) = 55022
TPG(1888, 52) = 54657
TPG(1888, 53) = 54268
TPG(1888, 54) = 53854
TPG(1888, 55) = 53415
TPG(1888, 56) = 52969
TPG(1888, 57) = 52485
TPG(1888, 58) = 51962
TPG(1888, 59) = 51397
TPG(1888, 60) = 50788
TPG(1888, 61) = 50122
TPG(1888, 62) = 49416
TPG(1888, 63) = 48667
TPG(1888, 64) = 47876
TPG(1888, 65) = 47040
TPG(1888, 66) = 46158
TPG(1888, 67) = 45230
TPG(1888, 68) = 44255
TPG(1888, 69) = 43232
TPG(1888, 70) = 42157
TPG(1888, 71) = 41030
TPG(1888, 72) = 39849
TPG(1888, 73) = 38612
TPG(1888, 74) = 37291
TPG(1888, 75) = 35885
TPG(1888, 76) = 34390
TPG(1888, 77) = 32807
TPG(1888, 78) = 31135
TPG(1888, 79) = 29374
TPG(1888, 80) = 27528
TPG(1888, 81) = 25604
TPG(1888, 82) = 23613
TPG(1888, 83) = 21568
TPG(1888, 84) = 19513
TPG(1888, 85) = 17468
TPG(1888, 86) = 15451
TPG(1888, 87) = 13485
TPG(1888, 88) = 11592
TPG(1888, 89) = 9819
TPG(1888, 90) = 8182
TPG(1888, 91) = 6694
TPG(1888, 92) = 5365
TPG(1888, 93) = 4201
TPG(1888, 94) = 3213
TPG(1888, 95) = 2394
TPG(1888, 96) = 1732
TPG(1888, 97) = 1212
TPG(1888, 98) = 816
TPG(1888, 99) = 527
TPG(1888, 100) = 324
TPG(1888, 101) = 188
TPG(1888, 102) = 102
TPG(1888, 103) = 51
TPG(1888, 104) = 23
TPG(1888, 105) = 10
TPG(1888, 106) = 3
TPG(1888, 107) = 1
TPG(1888, 108) = 0
TPG(1888, 109) = 0
TPG(1888, 110) = 0
TPG(1888, 111) = 0
TPG(1888, 112) = 0
TPG(1888, 113) = 0
TPG(1888, 114) = 0
TPG(1888, 115) = 0
TPG(1888, 116) = 0
TPG(1888, 117) = 0
TPG(1889, 0) = 100000
TPG(1889, 1) = 73436
TPG(1889, 2) = 65727
TPG(1889, 3) = 63715
TPG(1889, 4) = 62689
TPG(1889, 5) = 62154
TPG(1889, 6) = 62043
TPG(1889, 7) = 61947
TPG(1889, 8) = 61864
TPG(1889, 9) = 61791
TPG(1889, 10) = 61728
TPG(1889, 11) = 61684
TPG(1889, 12) = 61641
TPG(1889, 13) = 61598
TPG(1889, 14) = 61556
TPG(1889, 15) = 61513
TPG(1889, 16) = 61476
TPG(1889, 17) = 61436
TPG(1889, 18) = 61392
TPG(1889, 19) = 61344
TPG(1889, 20) = 61293
TPG(1889, 21) = 61237
TPG(1889, 22) = 61176
TPG(1889, 23) = 61110
TPG(1889, 24) = 61038
TPG(1889, 25) = 60961
TPG(1889, 26) = 60875
TPG(1889, 27) = 60784
TPG(1889, 28) = 60686
TPG(1889, 29) = 60582
TPG(1889, 30) = 60470
TPG(1889, 31) = 60347
TPG(1889, 32) = 60219
TPG(1889, 33) = 60085
TPG(1889, 34) = 59945
TPG(1889, 35) = 59799
TPG(1889, 36) = 59789
TPG(1889, 37) = 59632
TPG(1889, 38) = 59465
TPG(1889, 39) = 59287
TPG(1889, 40) = 59099
TPG(1889, 41) = 58902
TPG(1889, 42) = 58692
TPG(1889, 43) = 58467
TPG(1889, 44) = 58227
TPG(1889, 45) = 57971
TPG(1889, 46) = 57686
TPG(1889, 47) = 57389
TPG(1889, 48) = 57077
TPG(1889, 49) = 56752
TPG(1889, 50) = 56411
TPG(1889, 51) = 56067
TPG(1889, 52) = 55701
TPG(1889, 53) = 55311
TPG(1889, 54) = 54896
TPG(1889, 55) = 54456
TPG(1889, 56) = 54008
TPG(1889, 57) = 53523
TPG(1889, 58) = 52999
TPG(1889, 59) = 52433
TPG(1889, 60) = 51824
TPG(1889, 61) = 51159
TPG(1889, 62) = 50459
TPG(1889, 63) = 49711
TPG(1889, 64) = 48920
TPG(1889, 65) = 48084
TPG(1889, 66) = 47203
TPG(1889, 67) = 46275
TPG(1889, 68) = 45299
TPG(1889, 69) = 44274
TPG(1889, 70) = 43197
TPG(1889, 71) = 42065
TPG(1889, 72) = 40878
TPG(1889, 73) = 39633
TPG(1889, 74) = 38302
TPG(1889, 75) = 36883
TPG(1889, 76) = 35374
TPG(1889, 77) = 33772
TPG(1889, 78) = 32078
TPG(1889, 79) = 30292
TPG(1889, 80) = 28417
TPG(1889, 81) = 26461
TPG(1889, 82) = 24432
TPG(1889, 83) = 22345
TPG(1889, 84) = 20246
TPG(1889, 85) = 18151
TPG(1889, 86) = 16082
TPG(1889, 87) = 14061
TPG(1889, 88) = 12111
TPG(1889, 89) = 10280
TPG(1889, 90) = 8586
TPG(1889, 91) = 7041
TPG(1889, 92) = 5657
TPG(1889, 93) = 4442
TPG(1889, 94) = 3408
TPG(1889, 95) = 2547
TPG(1889, 96) = 1849
TPG(1889, 97) = 1299
TPG(1889, 98) = 879
TPG(1889, 99) = 570
TPG(1889, 100) = 352
TPG(1889, 101) = 205
TPG(1889, 102) = 112
TPG(1889, 103) = 57
TPG(1889, 104) = 26
TPG(1889, 105) = 11
TPG(1889, 106) = 4
TPG(1889, 107) = 1
TPG(1889, 108) = 0
TPG(1889, 109) = 0
TPG(1889, 110) = 0
TPG(1889, 111) = 0
TPG(1889, 112) = 0
TPG(1889, 113) = 0
TPG(1889, 114) = 0
TPG(1889, 115) = 0
TPG(1889, 116) = 0
TPG(1889, 117) = 0
TPG(1890, 0) = 100000
TPG(1890, 1) = 74220
TPG(1890, 2) = 66683
TPG(1890, 3) = 64728
TPG(1890, 4) = 63726
TPG(1890, 5) = 63200
TPG(1890, 6) = 63090
TPG(1890, 7) = 62995
TPG(1890, 8) = 62912
TPG(1890, 9) = 62839
TPG(1890, 10) = 62776
TPG(1890, 11) = 62733
TPG(1890, 12) = 62690
TPG(1890, 13) = 62647
TPG(1890, 14) = 62604
TPG(1890, 15) = 62561
TPG(1890, 16) = 62524
TPG(1890, 17) = 62483
TPG(1890, 18) = 62439
TPG(1890, 19) = 62391
TPG(1890, 20) = 62339
TPG(1890, 21) = 62283
TPG(1890, 22) = 62222
TPG(1890, 23) = 62155
TPG(1890, 24) = 62083
TPG(1890, 25) = 62005
TPG(1890, 26) = 61919
TPG(1890, 27) = 61828
TPG(1890, 28) = 61730
TPG(1890, 29) = 61625
TPG(1890, 30) = 61514
TPG(1890, 31) = 61391
TPG(1890, 32) = 61263
TPG(1890, 33) = 61129
TPG(1890, 34) = 60989
TPG(1890, 35) = 60843
TPG(1890, 36) = 60695
TPG(1890, 37) = 60538
TPG(1890, 38) = 60371
TPG(1890, 39) = 60195
TPG(1890, 40) = 60007
TPG(1890, 41) = 59810
TPG(1890, 42) = 59600
TPG(1890, 43) = 59376
TPG(1890, 44) = 59137
TPG(1890, 45) = 58881
TPG(1890, 46) = 58597
TPG(1890, 47) = 58300
TPG(1890, 48) = 57989
TPG(1890, 49) = 57664
TPG(1890, 50) = 57324
TPG(1890, 51) = 56980
TPG(1890, 52) = 56613
TPG(1890, 53) = 56223
TPG(1890, 54) = 55809
TPG(1890, 55) = 55369
TPG(1890, 56) = 54921
TPG(1890, 57) = 54436
TPG(1890, 58) = 53912
TPG(1890, 59) = 53347
TPG(1890, 60) = 52740
TPG(1890, 61) = 52087
TPG(1890, 62) = 51389
TPG(1890, 63) = 50644
TPG(1890, 64) = 49855
TPG(1890, 65) = 49022
TPG(1890, 66) = 48143
TPG(1890, 67) = 47217
TPG(1890, 68) = 46244
TPG(1890, 69) = 45220
TPG(1890, 70) = 44142
TPG(1890, 71) = 43010
TPG(1890, 72) = 41820
TPG(1890, 73) = 40570
TPG(1890, 74) = 39233
TPG(1890, 75) = 37805
TPG(1890, 76) = 36284
TPG(1890, 77) = 34669
TPG(1890, 78) = 32958
TPG(1890, 79) = 31151
TPG(1890, 80) = 29252
TPG(1890, 81) = 27268
TPG(1890, 82) = 25208
TPG(1890, 83) = 23085
TPG(1890, 84) = 20945
TPG(1890, 85) = 18807
TPG(1890, 86) = 16690
TPG(1890, 87) = 14618
TPG(1890, 88) = 12615
TPG(1890, 89) = 10730
TPG(1890, 90) = 8981
TPG(1890, 91) = 7383
TPG(1890, 92) = 5947
TPG(1890, 93) = 4683
TPG(1890, 94) = 3603
TPG(1890, 95) = 2702
TPG(1890, 96) = 1968
TPG(1890, 97) = 1388
TPG(1890, 98) = 943
TPG(1890, 99) = 614
TPG(1890, 100) = 381
TPG(1890, 101) = 224
TPG(1890, 102) = 123
TPG(1890, 103) = 63
TPG(1890, 104) = 29
TPG(1890, 105) = 12
TPG(1890, 106) = 4
TPG(1890, 107) = 1
TPG(1890, 108) = 0
TPG(1890, 109) = 0
TPG(1890, 110) = 0
TPG(1890, 111) = 0
TPG(1890, 112) = 0
TPG(1890, 113) = 0
TPG(1890, 114) = 0
TPG(1890, 115) = 0
TPG(1890, 116) = 0
TPG(1890, 117) = 0
TPG(1891, 0) = 100000
TPG(1891, 1) = 74989
TPG(1891, 2) = 67623
TPG(1891, 3) = 65726
TPG(1891, 4) = 64747
TPG(1891, 5) = 64231
TPG(1891, 6) = 64121
TPG(1891, 7) = 64027
TPG(1891, 8) = 63944
TPG(1891, 9) = 63872
TPG(1891, 10) = 63809
TPG(1891, 11) = 63766
TPG(1891, 12) = 63723
TPG(1891, 13) = 63680
TPG(1891, 14) = 63637
TPG(1891, 15) = 63594
TPG(1891, 16) = 63556
TPG(1891, 17) = 63516
TPG(1891, 18) = 63471
TPG(1891, 19) = 63423
TPG(1891, 20) = 63370
TPG(1891, 21) = 63313
TPG(1891, 22) = 63252
TPG(1891, 23) = 63185
TPG(1891, 24) = 63113
TPG(1891, 25) = 63034
TPG(1891, 26) = 62948
TPG(1891, 27) = 62857
TPG(1891, 28) = 62759
TPG(1891, 29) = 62654
TPG(1891, 30) = 62543
TPG(1891, 31) = 62420
TPG(1891, 32) = 62292
TPG(1891, 33) = 62158
TPG(1891, 34) = 62018
TPG(1891, 35) = 61872
TPG(1891, 36) = 61724
TPG(1891, 37) = 61568
TPG(1891, 38) = 61401
TPG(1891, 39) = 61224
TPG(1891, 40) = 61036
TPG(1891, 41) = 60840
TPG(1891, 42) = 60630
TPG(1891, 43) = 60406
TPG(1891, 44) = 60166
TPG(1891, 45) = 59911
TPG(1891, 46) = 59627
TPG(1891, 47) = 59330
TPG(1891, 48) = 59019
TPG(1891, 49) = 58694
TPG(1891, 50) = 58354
TPG(1891, 51) = 58009
TPG(1891, 52) = 57642
TPG(1891, 53) = 57251
TPG(1891, 54) = 56836
TPG(1891, 55) = 56395
TPG(1891, 56) = 55947
TPG(1891, 57) = 55461
TPG(1891, 58) = 54937
TPG(1891, 59) = 54372
TPG(1891, 60) = 53764
TPG(1891, 61) = 53113
TPG(1891, 62) = 52415
TPG(1891, 63) = 51671
TPG(1891, 64) = 50884
TPG(1891, 65) = 50052
TPG(1891, 66) = 49174
TPG(1891, 67) = 48249
TPG(1891, 68) = 47276
TPG(1891, 69) = 46252
TPG(1891, 70) = 45173
TPG(1891, 71) = 44038
TPG(1891, 72) = 42843
TPG(1891, 73) = 41587
TPG(1891, 74) = 40242
TPG(1891, 75) = 38803
TPG(1891, 76) = 37269
TPG(1891, 77) = 35637
TPG(1891, 78) = 33907
TPG(1891, 79) = 32077
TPG(1891, 80) = 30152
TPG(1891, 81) = 28136
TPG(1891, 82) = 26041
TPG(1891, 83) = 23878
TPG(1891, 84) = 21695
TPG(1891, 85) = 19509
TPG(1891, 86) = 17342
TPG(1891, 87) = 15215
TPG(1891, 88) = 13155
TPG(1891, 89) = 11213
TPG(1891, 90) = 9406
TPG(1891, 91) = 7750
TPG(1891, 92) = 6259
TPG(1891, 93) = 4941
TPG(1891, 94) = 3813
TPG(1891, 95) = 2869
TPG(1891, 96) = 2097
TPG(1891, 97) = 1484
TPG(1891, 98) = 1012
TPG(1891, 99) = 662
TPG(1891, 100) = 413
TPG(1891, 101) = 244
TPG(1891, 102) = 135
TPG(1891, 103) = 69
TPG(1891, 104) = 32
TPG(1891, 105) = 14
TPG(1891, 106) = 5
TPG(1891, 107) = 2
TPG(1891, 108) = 0
TPG(1891, 109) = 0
TPG(1891, 110) = 0
TPG(1891, 111) = 0
TPG(1891, 112) = 0
TPG(1891, 113) = 0
TPG(1891, 114) = 0
TPG(1891, 115) = 0
TPG(1891, 116) = 0
TPG(1891, 117) = 0
TPG(1892, 0) = 100000
TPG(1892, 1) = 75742
TPG(1892, 2) = 68549
TPG(1892, 3) = 66707
TPG(1892, 4) = 65751
TPG(1892, 5) = 65245
TPG(1892, 6) = 65136
TPG(1892, 7) = 65042
TPG(1892, 8) = 64960
TPG(1892, 9) = 64888
TPG(1892, 10) = 64825
TPG(1892, 11) = 64783
TPG(1892, 12) = 64740
TPG(1892, 13) = 64697
TPG(1892, 14) = 64654
TPG(1892, 15) = 64611
TPG(1892, 16) = 64573
TPG(1892, 17) = 64532
TPG(1892, 18) = 64487
TPG(1892, 19) = 64438
TPG(1892, 20) = 64385
TPG(1892, 21) = 64328
TPG(1892, 22) = 64266
TPG(1892, 23) = 64199
TPG(1892, 24) = 64126
TPG(1892, 25) = 64048
TPG(1892, 26) = 63962
TPG(1892, 27) = 63870
TPG(1892, 28) = 63772
TPG(1892, 29) = 63667
TPG(1892, 30) = 63556
TPG(1892, 31) = 63433
TPG(1892, 32) = 63305
TPG(1892, 33) = 63172
TPG(1892, 34) = 63032
TPG(1892, 35) = 62886
TPG(1892, 36) = 62739
TPG(1892, 37) = 62582
TPG(1892, 38) = 62416
TPG(1892, 39) = 62239
TPG(1892, 40) = 62051
TPG(1892, 41) = 61855
TPG(1892, 42) = 61645
TPG(1892, 43) = 61421
TPG(1892, 44) = 61182
TPG(1892, 45) = 60926
TPG(1892, 46) = 60643
TPG(1892, 47) = 60346
TPG(1892, 48) = 60036
TPG(1892, 49) = 59711
TPG(1892, 50) = 59370
TPG(1892, 51) = 59025
TPG(1892, 52) = 58657
TPG(1892, 53) = 58266
TPG(1892, 54) = 57851
TPG(1892, 55) = 57410
TPG(1892, 56) = 56961
TPG(1892, 57) = 56475
TPG(1892, 58) = 55950
TPG(1892, 59) = 55385
TPG(1892, 60) = 54778
TPG(1892, 61) = 54127
TPG(1892, 62) = 53431
TPG(1892, 63) = 52689
TPG(1892, 64) = 51903
TPG(1892, 65) = 51073
TPG(1892, 66) = 50196
TPG(1892, 67) = 49273
TPG(1892, 68) = 48302
TPG(1892, 69) = 47278
TPG(1892, 70) = 46198
TPG(1892, 71) = 45060
TPG(1892, 72) = 43862
TPG(1892, 73) = 42601
TPG(1892, 74) = 41248
TPG(1892, 75) = 39800
TPG(1892, 76) = 38254
TPG(1892, 77) = 36606
TPG(1892, 78) = 34857
TPG(1892, 79) = 33006
TPG(1892, 80) = 31055
TPG(1892, 81) = 29010
TPG(1892, 82) = 26880
TPG(1892, 83) = 24679
TPG(1892, 84) = 22453
TPG(1892, 85) = 20220
TPG(1892, 86) = 18002
TPG(1892, 87) = 15823
TPG(1892, 88) = 13706
TPG(1892, 89) = 11706
TPG(1892, 90) = 9840
TPG(1892, 91) = 8127
TPG(1892, 92) = 6580
TPG(1892, 93) = 5209
TPG(1892, 94) = 4032
TPG(1892, 95) = 3042
TPG(1892, 96) = 2232
TPG(1892, 97) = 1585
TPG(1892, 98) = 1086
TPG(1892, 99) = 714
TPG(1892, 100) = 447
TPG(1892, 101) = 265
TPG(1892, 102) = 148
TPG(1892, 103) = 76
TPG(1892, 104) = 36
TPG(1892, 105) = 15
TPG(1892, 106) = 6
TPG(1892, 107) = 2
TPG(1892, 108) = 0
TPG(1892, 109) = 0
TPG(1892, 110) = 0
TPG(1892, 111) = 0
TPG(1892, 112) = 0
TPG(1892, 113) = 0
TPG(1892, 114) = 0
TPG(1892, 115) = 0
TPG(1892, 116) = 0
TPG(1892, 117) = 0
TPG(1893, 0) = 100000
TPG(1893, 1) = 76480
TPG(1893, 2) = 69458
TPG(1893, 3) = 67671
TPG(1893, 4) = 66738
TPG(1893, 5) = 66242
TPG(1893, 6) = 66135
TPG(1893, 7) = 66041
TPG(1893, 8) = 65959
TPG(1893, 9) = 65888
TPG(1893, 10) = 65825
TPG(1893, 11) = 65783
TPG(1893, 12) = 65740
TPG(1893, 13) = 65697
TPG(1893, 14) = 65654
TPG(1893, 15) = 65611
TPG(1893, 16) = 65573
TPG(1893, 17) = 65531
TPG(1893, 18) = 65486
TPG(1893, 19) = 65437
TPG(1893, 20) = 65384
TPG(1893, 21) = 65326
TPG(1893, 22) = 65264
TPG(1893, 23) = 65196
TPG(1893, 24) = 65123
TPG(1893, 25) = 65045
TPG(1893, 26) = 64958
TPG(1893, 27) = 64866
TPG(1893, 28) = 64768
TPG(1893, 29) = 64664
TPG(1893, 30) = 64552
TPG(1893, 31) = 64430
TPG(1893, 32) = 64303
TPG(1893, 33) = 64169
TPG(1893, 34) = 64030
TPG(1893, 35) = 63885
TPG(1893, 36) = 63737
TPG(1893, 37) = 63581
TPG(1893, 38) = 63415
TPG(1893, 39) = 63238
TPG(1893, 40) = 63051
TPG(1893, 41) = 62855
TPG(1893, 42) = 62645
TPG(1893, 43) = 62422
TPG(1893, 44) = 62182
TPG(1893, 45) = 61927
TPG(1893, 46) = 61644
TPG(1893, 47) = 61348
TPG(1893, 48) = 61038
TPG(1893, 49) = 60713
TPG(1893, 50) = 60373
TPG(1893, 51) = 60027
TPG(1893, 52) = 59660
TPG(1893, 53) = 59268
TPG(1893, 54) = 58853
TPG(1893, 55) = 58412
TPG(1893, 56) = 57962
TPG(1893, 57) = 57476
TPG(1893, 58) = 56951
TPG(1893, 59) = 56387
TPG(1893, 60) = 55780
TPG(1893, 61) = 55131
TPG(1893, 62) = 54436
TPG(1893, 63) = 53696
TPG(1893, 64) = 52912
TPG(1893, 65) = 52084
TPG(1893, 66) = 51210
TPG(1893, 67) = 50289
TPG(1893, 68) = 49320
TPG(1893, 69) = 48297
TPG(1893, 70) = 47217
TPG(1893, 71) = 46078
TPG(1893, 72) = 44876
TPG(1893, 73) = 43610
TPG(1893, 74) = 42251
TPG(1893, 75) = 40794
TPG(1893, 76) = 39236
TPG(1893, 77) = 37575
TPG(1893, 78) = 35809
TPG(1893, 79) = 33936
TPG(1893, 80) = 31960
TPG(1893, 81) = 29887
TPG(1893, 82) = 27725
TPG(1893, 83) = 25486
TPG(1893, 84) = 23218
TPG(1893, 85) = 20940
TPG(1893, 86) = 18673
TPG(1893, 87) = 16440
TPG(1893, 88) = 14267
TPG(1893, 89) = 12209
TPG(1893, 90) = 10285
TPG(1893, 91) = 8514
TPG(1893, 92) = 6910
TPG(1893, 93) = 5485
TPG(1893, 94) = 4258
TPG(1893, 95) = 3223
TPG(1893, 96) = 2372
TPG(1893, 97) = 1691
TPG(1893, 98) = 1163
TPG(1893, 99) = 768
TPG(1893, 100) = 484
TPG(1893, 101) = 288
TPG(1893, 102) = 162
TPG(1893, 103) = 84
TPG(1893, 104) = 40
TPG(1893, 105) = 17
TPG(1893, 106) = 6
TPG(1893, 107) = 2
TPG(1893, 108) = 1
TPG(1893, 109) = 0
TPG(1893, 110) = 0
TPG(1893, 111) = 0
TPG(1893, 112) = 0
TPG(1893, 113) = 0
TPG(1893, 114) = 0
TPG(1893, 115) = 0
TPG(1893, 116) = 0
TPG(1893, 117) = 0
TPG(1894, 0) = 100000
TPG(1894, 1) = 77202
TPG(1894, 2) = 70350
TPG(1894, 3) = 68617
TPG(1894, 4) = 67708
TPG(1894, 5) = 67222
TPG(1894, 6) = 67115
TPG(1894, 7) = 67023
TPG(1894, 8) = 66941
TPG(1894, 9) = 66870
TPG(1894, 10) = 66808
TPG(1894, 11) = 66765
TPG(1894, 12) = 66723
TPG(1894, 13) = 66680
TPG(1894, 14) = 66637
TPG(1894, 15) = 66594
TPG(1894, 16) = 66555
TPG(1894, 17) = 66513
TPG(1894, 18) = 66468
TPG(1894, 19) = 66419
TPG(1894, 20) = 66365
TPG(1894, 21) = 66307
TPG(1894, 22) = 66245
TPG(1894, 23) = 66177
TPG(1894, 24) = 66104
TPG(1894, 25) = 66025
TPG(1894, 26) = 65939
TPG(1894, 27) = 65847
TPG(1894, 28) = 65748
TPG(1894, 29) = 65644
TPG(1894, 30) = 65533
TPG(1894, 31) = 65411
TPG(1894, 32) = 65284
TPG(1894, 33) = 65151
TPG(1894, 34) = 65012
TPG(1894, 35) = 64867
TPG(1894, 36) = 64720
TPG(1894, 37) = 64564
TPG(1894, 38) = 64398
TPG(1894, 39) = 64222
TPG(1894, 40) = 64035
TPG(1894, 41) = 63839
TPG(1894, 42) = 63630
TPG(1894, 43) = 63406
TPG(1894, 44) = 63168
TPG(1894, 45) = 62913
TPG(1894, 46) = 62630
TPG(1894, 47) = 62335
TPG(1894, 48) = 62025
TPG(1894, 49) = 61701
TPG(1894, 50) = 61361
TPG(1894, 51) = 61015
TPG(1894, 52) = 60648
TPG(1894, 53) = 60256
TPG(1894, 54) = 59841
TPG(1894, 55) = 59400
TPG(1894, 56) = 58950
TPG(1894, 57) = 58454
TPG(1894, 58) = 57930
TPG(1894, 59) = 57367
TPG(1894, 60) = 56761
TPG(1894, 61) = 56113
TPG(1894, 62) = 55421
TPG(1894, 63) = 54684
TPG(1894, 64) = 53903
TPG(1894, 65) = 53077
TPG(1894, 66) = 52206
TPG(1894, 67) = 51288
TPG(1894, 68) = 50321
TPG(1894, 69) = 49300
TPG(1894, 70) = 48221
TPG(1894, 71) = 47081
TPG(1894, 72) = 45878
TPG(1894, 73) = 44608
TPG(1894, 74) = 43243
TPG(1894, 75) = 41779
TPG(1894, 76) = 40211
TPG(1894, 77) = 38537
TPG(1894, 78) = 36754
TPG(1894, 79) = 34862
TPG(1894, 80) = 32864
TPG(1894, 81) = 30763
TPG(1894, 82) = 28569
TPG(1894, 83) = 26294
TPG(1894, 84) = 23986
TPG(1894, 85) = 21664
TPG(1894, 86) = 19348
TPG(1894, 87) = 17063
TPG(1894, 88) = 14835
TPG(1894, 89) = 12720
TPG(1894, 90) = 10739
TPG(1894, 91) = 8910
TPG(1894, 92) = 7249
TPG(1894, 93) = 5770
TPG(1894, 94) = 4491
TPG(1894, 95) = 3410
TPG(1894, 96) = 2518
TPG(1894, 97) = 1802
TPG(1894, 98) = 1244
TPG(1894, 99) = 825
TPG(1894, 100) = 522
TPG(1894, 101) = 313
TPG(1894, 102) = 176
TPG(1894, 103) = 92
TPG(1894, 104) = 44
TPG(1894, 105) = 19
TPG(1894, 106) = 7
TPG(1894, 107) = 2
TPG(1894, 108) = 1
TPG(1894, 109) = 0
TPG(1894, 110) = 0
TPG(1894, 111) = 0
TPG(1894, 112) = 0
TPG(1894, 113) = 0
TPG(1894, 114) = 0
TPG(1894, 115) = 0
TPG(1894, 116) = 0
TPG(1894, 117) = 0
TPG(1895, 0) = 100000
TPG(1895, 1) = 77908
TPG(1895, 2) = 71226
TPG(1895, 3) = 69547
TPG(1895, 4) = 68661
TPG(1895, 5) = 68184
TPG(1895, 6) = 68079
TPG(1895, 7) = 67986
TPG(1895, 8) = 67906
TPG(1895, 9) = 67835
TPG(1895, 10) = 67773
TPG(1895, 11) = 67731
TPG(1895, 12) = 67688
TPG(1895, 13) = 67646
TPG(1895, 14) = 67603
TPG(1895, 15) = 67559
TPG(1895, 16) = 67521
TPG(1895, 17) = 67478
TPG(1895, 18) = 67433
TPG(1895, 19) = 67383
TPG(1895, 20) = 67329
TPG(1895, 21) = 67271
TPG(1895, 22) = 67208
TPG(1895, 23) = 67140
TPG(1895, 24) = 67067
TPG(1895, 25) = 66988
TPG(1895, 26) = 66901
TPG(1895, 27) = 66810
TPG(1895, 28) = 66711
TPG(1895, 29) = 66607
TPG(1895, 30) = 66496
TPG(1895, 31) = 66375
TPG(1895, 32) = 66248
TPG(1895, 33) = 66115
TPG(1895, 34) = 65977
TPG(1895, 35) = 65832
TPG(1895, 36) = 65686
TPG(1895, 37) = 65530
TPG(1895, 38) = 65364
TPG(1895, 39) = 65189
TPG(1895, 40) = 65002
TPG(1895, 41) = 64807
TPG(1895, 42) = 64598
TPG(1895, 43) = 64375
TPG(1895, 44) = 64137
TPG(1895, 45) = 63882
TPG(1895, 46) = 63601
TPG(1895, 47) = 63306
TPG(1895, 48) = 62997
TPG(1895, 49) = 62674
TPG(1895, 50) = 62334
TPG(1895, 51) = 61989
TPG(1895, 52) = 61621
TPG(1895, 53) = 61230
TPG(1895, 54) = 60815
TPG(1895, 55) = 60374
TPG(1895, 56) = 59907
TPG(1895, 57) = 59412
TPG(1895, 58) = 58889
TPG(1895, 59) = 58326
TPG(1895, 60) = 57723
TPG(1895, 61) = 57077
TPG(1895, 62) = 56387
TPG(1895, 63) = 55653
TPG(1895, 64) = 54875
TPG(1895, 65) = 54053
TPG(1895, 66) = 53185
TPG(1895, 67) = 52270
TPG(1895, 68) = 51307
TPG(1895, 69) = 50288
TPG(1895, 70) = 49210
TPG(1895, 71) = 48071
TPG(1895, 72) = 46866
TPG(1895, 73) = 45594
TPG(1895, 74) = 44225
TPG(1895, 75) = 42754
TPG(1895, 76) = 41177
TPG(1895, 77) = 39491
TPG(1895, 78) = 37694
TPG(1895, 79) = 35784
TPG(1895, 80) = 33764
TPG(1895, 81) = 31638
TPG(1895, 82) = 29414
TPG(1895, 83) = 27104
TPG(1895, 84) = 24758
TPG(1895, 85) = 22392
TPG(1895, 86) = 20029
TPG(1895, 87) = 17694
TPG(1895, 88) = 15411
TPG(1895, 89) = 13240
TPG(1895, 90) = 11201
TPG(1895, 91) = 9314
TPG(1895, 92) = 7596
TPG(1895, 93) = 6062
TPG(1895, 94) = 4732
TPG(1895, 95) = 3604
TPG(1895, 96) = 2671
TPG(1895, 97) = 1918
TPG(1895, 98) = 1330
TPG(1895, 99) = 885
TPG(1895, 100) = 563
TPG(1895, 101) = 339
TPG(1895, 102) = 192
TPG(1895, 103) = 101
TPG(1895, 104) = 49
TPG(1895, 105) = 21
TPG(1895, 106) = 8
TPG(1895, 107) = 3
TPG(1895, 108) = 1
TPG(1895, 109) = 0
TPG(1895, 110) = 0
TPG(1895, 111) = 0
TPG(1895, 112) = 0
TPG(1895, 113) = 0
TPG(1895, 114) = 0
TPG(1895, 115) = 0
TPG(1895, 116) = 0
TPG(1895, 117) = 0
TPG(1896, 0) = 100000
TPG(1896, 1) = 78599
TPG(1896, 2) = 72086
TPG(1896, 3) = 70458
TPG(1896, 4) = 69595
TPG(1896, 5) = 69128
TPG(1896, 6) = 69024
TPG(1896, 7) = 68932
TPG(1896, 8) = 68852
TPG(1896, 9) = 68782
TPG(1896, 10) = 68721
TPG(1896, 11) = 68678
TPG(1896, 12) = 68636
TPG(1896, 13) = 68594
TPG(1896, 14) = 68551
TPG(1896, 15) = 68507
TPG(1896, 16) = 68468
TPG(1896, 17) = 68426
TPG(1896, 18) = 68380
TPG(1896, 19) = 68330
TPG(1896, 20) = 68276
TPG(1896, 21) = 68217
TPG(1896, 22) = 68154
TPG(1896, 23) = 68086
TPG(1896, 24) = 68012
TPG(1896, 25) = 67933
TPG(1896, 26) = 67847
TPG(1896, 27) = 67755
TPG(1896, 28) = 67657
TPG(1896, 29) = 67553
TPG(1896, 30) = 67442
TPG(1896, 31) = 67321
TPG(1896, 32) = 67195
TPG(1896, 33) = 67063
TPG(1896, 34) = 66925
TPG(1896, 35) = 66781
TPG(1896, 36) = 66634
TPG(1896, 37) = 66479
TPG(1896, 38) = 66314
TPG(1896, 39) = 66139
TPG(1896, 40) = 65953
TPG(1896, 41) = 65758
TPG(1896, 42) = 65550
TPG(1896, 43) = 65328
TPG(1896, 44) = 65090
TPG(1896, 45) = 64836
TPG(1896, 46) = 64556
TPG(1896, 47) = 64262
TPG(1896, 48) = 63954
TPG(1896, 49) = 63631
TPG(1896, 50) = 63292
TPG(1896, 51) = 62947
TPG(1896, 52) = 62579
TPG(1896, 53) = 62189
TPG(1896, 54) = 61774
TPG(1896, 55) = 61334
TPG(1896, 56) = 60867
TPG(1896, 57) = 60373
TPG(1896, 58) = 59851
TPG(1896, 59) = 59290
TPG(1896, 60) = 58688
TPG(1896, 61) = 58044
TPG(1896, 62) = 57357
TPG(1896, 63) = 56626
TPG(1896, 64) = 55852
TPG(1896, 65) = 55033
TPG(1896, 66) = 54169
TPG(1896, 67) = 53257
TPG(1896, 68) = 52298
TPG(1896, 69) = 51282
TPG(1896, 70) = 50206
TPG(1896, 71) = 49067
TPG(1896, 72) = 47862
TPG(1896, 73) = 46587
TPG(1896, 74) = 45214
TPG(1896, 75) = 43737
TPG(1896, 76) = 42152
TPG(1896, 77) = 40455
TPG(1896, 78) = 38643
TPG(1896, 79) = 36716
TPG(1896, 80) = 34675
TPG(1896, 81) = 32524
TPG(1896, 82) = 30271
TPG(1896, 83) = 27927
TPG(1896, 84) = 25542
TPG(1896, 85) = 23134
TPG(1896, 86) = 20724
TPG(1896, 87) = 18337
TPG(1896, 88) = 16000
TPG(1896, 89) = 13772
TPG(1896, 90) = 11676
TPG(1896, 91) = 9730
TPG(1896, 92) = 7955
TPG(1896, 93) = 6365
TPG(1896, 94) = 4983
TPG(1896, 95) = 3807
TPG(1896, 96) = 2830
TPG(1896, 97) = 2039
TPG(1896, 98) = 1419
TPG(1896, 99) = 949
TPG(1896, 100) = 607
TPG(1896, 101) = 368
TPG(1896, 102) = 210
TPG(1896, 103) = 111
TPG(1896, 104) = 54
TPG(1896, 105) = 24
TPG(1896, 106) = 9
TPG(1896, 107) = 3
TPG(1896, 108) = 1
TPG(1896, 109) = 0
TPG(1896, 110) = 0
TPG(1896, 111) = 0
TPG(1896, 112) = 0
TPG(1896, 113) = 0
TPG(1896, 114) = 0
TPG(1896, 115) = 0
TPG(1896, 116) = 0
TPG(1896, 117) = 0
TPG(1897, 0) = 100000
TPG(1897, 1) = 79274
TPG(1897, 2) = 72928
TPG(1897, 3) = 71351
TPG(1897, 4) = 70511
TPG(1897, 5) = 70054
TPG(1897, 6) = 69950
TPG(1897, 7) = 69860
TPG(1897, 8) = 69781
TPG(1897, 9) = 69711
TPG(1897, 10) = 69650
TPG(1897, 11) = 69608
TPG(1897, 12) = 69566
TPG(1897, 13) = 69523
TPG(1897, 14) = 69480
TPG(1897, 15) = 69435
TPG(1897, 16) = 69396
TPG(1897, 17) = 69353
TPG(1897, 18) = 69307
TPG(1897, 19) = 69257
TPG(1897, 20) = 69203
TPG(1897, 21) = 69144
TPG(1897, 22) = 69081
TPG(1897, 23) = 69012
TPG(1897, 24) = 68939
TPG(1897, 25) = 68859
TPG(1897, 26) = 68773
TPG(1897, 27) = 68681
TPG(1897, 28) = 68584
TPG(1897, 29) = 68480
TPG(1897, 30) = 68369
TPG(1897, 31) = 68249
TPG(1897, 32) = 68123
TPG(1897, 33) = 67992
TPG(1897, 34) = 67854
TPG(1897, 35) = 67710
TPG(1897, 36) = 67565
TPG(1897, 37) = 67410
TPG(1897, 38) = 67245
TPG(1897, 39) = 67071
TPG(1897, 40) = 66885
TPG(1897, 41) = 66691
TPG(1897, 42) = 66484
TPG(1897, 43) = 66262
TPG(1897, 44) = 66025
TPG(1897, 45) = 65772
TPG(1897, 46) = 65493
TPG(1897, 47) = 65200
TPG(1897, 48) = 64893
TPG(1897, 49) = 64571
TPG(1897, 50) = 64233
TPG(1897, 51) = 63888
TPG(1897, 52) = 63521
TPG(1897, 53) = 63131
TPG(1897, 54) = 62717
TPG(1897, 55) = 62277
TPG(1897, 56) = 61812
TPG(1897, 57) = 61319
TPG(1897, 58) = 60798
TPG(1897, 59) = 60238
TPG(1897, 60) = 59638
TPG(1897, 61) = 58997
TPG(1897, 62) = 58313
TPG(1897, 63) = 57585
TPG(1897, 64) = 56815
TPG(1897, 65) = 56000
TPG(1897, 66) = 55140
TPG(1897, 67) = 54233
TPG(1897, 68) = 53278
TPG(1897, 69) = 52265
TPG(1897, 70) = 51191
TPG(1897, 71) = 50053
TPG(1897, 72) = 48848
TPG(1897, 73) = 47572
TPG(1897, 74) = 46196
TPG(1897, 75) = 44714
TPG(1897, 76) = 43121
TPG(1897, 77) = 41414
TPG(1897, 78) = 39589
TPG(1897, 79) = 37646
TPG(1897, 80) = 35585
TPG(1897, 81) = 33410
TPG(1897, 82) = 31129
TPG(1897, 83) = 28753
TPG(1897, 84) = 26331
TPG(1897, 85) = 23881
TPG(1897, 86) = 21426
TPG(1897, 87) = 18989
TPG(1897, 88) = 16598
TPG(1897, 89) = 14314
TPG(1897, 90) = 12160
TPG(1897, 91) = 10156
TPG(1897, 92) = 8323
TPG(1897, 93) = 6676
TPG(1897, 94) = 5241
TPG(1897, 95) = 4016
TPG(1897, 96) = 2995
TPG(1897, 97) = 2166
TPG(1897, 98) = 1514
TPG(1897, 99) = 1017
TPG(1897, 100) = 653
TPG(1897, 101) = 398
TPG(1897, 102) = 228
TPG(1897, 103) = 122
TPG(1897, 104) = 60
TPG(1897, 105) = 27
TPG(1897, 106) = 10
TPG(1897, 107) = 3
TPG(1897, 108) = 1
TPG(1897, 109) = 0
TPG(1897, 110) = 0
TPG(1897, 111) = 0
TPG(1897, 112) = 0
TPG(1897, 113) = 0
TPG(1897, 114) = 0
TPG(1897, 115) = 0
TPG(1897, 116) = 0
TPG(1897, 117) = 0
TPG(1898, 0) = 100000
TPG(1898, 1) = 79932
TPG(1898, 2) = 73752
TPG(1898, 3) = 72226
TPG(1898, 4) = 71408
TPG(1898, 5) = 70961
TPG(1898, 6) = 70859
TPG(1898, 7) = 70769
TPG(1898, 8) = 70690
TPG(1898, 9) = 70621
TPG(1898, 10) = 70560
TPG(1898, 11) = 70519
TPG(1898, 12) = 70477
TPG(1898, 13) = 70434
TPG(1898, 14) = 70390
TPG(1898, 15) = 70347
TPG(1898, 16) = 70307
TPG(1898, 17) = 70264
TPG(1898, 18) = 70218
TPG(1898, 19) = 70167
TPG(1898, 20) = 70113
TPG(1898, 21) = 70054
TPG(1898, 22) = 69991
TPG(1898, 23) = 69922
TPG(1898, 24) = 69848
TPG(1898, 25) = 69769
TPG(1898, 26) = 69683
TPG(1898, 27) = 69591
TPG(1898, 28) = 69493
TPG(1898, 29) = 69390
TPG(1898, 30) = 69280
TPG(1898, 31) = 69160
TPG(1898, 32) = 69035
TPG(1898, 33) = 68904
TPG(1898, 34) = 68767
TPG(1898, 35) = 68624
TPG(1898, 36) = 68479
TPG(1898, 37) = 68324
TPG(1898, 38) = 68161
TPG(1898, 39) = 67987
TPG(1898, 40) = 67802
TPG(1898, 41) = 67608
TPG(1898, 42) = 67402
TPG(1898, 43) = 67181
TPG(1898, 44) = 66945
TPG(1898, 45) = 66693
TPG(1898, 46) = 66414
TPG(1898, 47) = 66123
TPG(1898, 48) = 65817
TPG(1898, 49) = 65496
TPG(1898, 50) = 65159
TPG(1898, 51) = 64814
TPG(1898, 52) = 64448
TPG(1898, 53) = 64059
TPG(1898, 54) = 63645
TPG(1898, 55) = 63207
TPG(1898, 56) = 62743
TPG(1898, 57) = 62251
TPG(1898, 58) = 61731
TPG(1898, 59) = 61173
TPG(1898, 60) = 60576
TPG(1898, 61) = 59937
TPG(1898, 62) = 59257
TPG(1898, 63) = 58533
TPG(1898, 64) = 57767
TPG(1898, 65) = 56957
TPG(1898, 66) = 56101
TPG(1898, 67) = 55198
TPG(1898, 68) = 54247
TPG(1898, 69) = 53239
TPG(1898, 70) = 52168
TPG(1898, 71) = 51032
TPG(1898, 72) = 49827
TPG(1898, 73) = 48551
TPG(1898, 74) = 47172
TPG(1898, 75) = 45686
TPG(1898, 76) = 44087
TPG(1898, 77) = 42370
TPG(1898, 78) = 40534
TPG(1898, 79) = 38575
TPG(1898, 80) = 36495
TPG(1898, 81) = 34298
TPG(1898, 82) = 31990
TPG(1898, 83) = 29582
TPG(1898, 84) = 27124
TPG(1898, 85) = 24635
TPG(1898, 86) = 22134
TPG(1898, 87) = 19648
TPG(1898, 88) = 17205
TPG(1898, 89) = 14865
TPG(1898, 90) = 12653
TPG(1898, 91) = 10591
TPG(1898, 92) = 8700
TPG(1898, 93) = 6996
TPG(1898, 94) = 5507
TPG(1898, 95) = 4233
TPG(1898, 96) = 3167
TPG(1898, 97) = 2299
TPG(1898, 98) = 1612
TPG(1898, 99) = 1087
TPG(1898, 100) = 701
TPG(1898, 101) = 430
TPG(1898, 102) = 248
TPG(1898, 103) = 133
TPG(1898, 104) = 66
TPG(1898, 105) = 30
TPG(1898, 106) = 12
TPG(1898, 107) = 4
TPG(1898, 108) = 1
TPG(1898, 109) = 0
TPG(1898, 110) = 0
TPG(1898, 111) = 0
TPG(1898, 112) = 0
TPG(1898, 113) = 0
TPG(1898, 114) = 0
TPG(1898, 115) = 0
TPG(1898, 116) = 0
TPG(1898, 117) = 0
TPG(1899, 0) = 100000
TPG(1899, 1) = 80576
TPG(1899, 2) = 74559
TPG(1899, 3) = 73082
TPG(1899, 4) = 72286
TPG(1899, 5) = 71849
TPG(1899, 6) = 71748
TPG(1899, 7) = 71659
TPG(1899, 8) = 71581
TPG(1899, 9) = 71513
TPG(1899, 10) = 71452
TPG(1899, 11) = 71411
TPG(1899, 12) = 71369
TPG(1899, 13) = 71326
TPG(1899, 14) = 71283
TPG(1899, 15) = 71239
TPG(1899, 16) = 71200
TPG(1899, 17) = 71157
TPG(1899, 18) = 71110
TPG(1899, 19) = 71059
TPG(1899, 20) = 71005
TPG(1899, 21) = 70946
TPG(1899, 22) = 70882
TPG(1899, 23) = 70813
TPG(1899, 24) = 70739
TPG(1899, 25) = 70660
TPG(1899, 26) = 70574
TPG(1899, 27) = 70482
TPG(1899, 28) = 70385
TPG(1899, 29) = 70282
TPG(1899, 30) = 70172
TPG(1899, 31) = 70053
TPG(1899, 32) = 69928
TPG(1899, 33) = 69798
TPG(1899, 34) = 69662
TPG(1899, 35) = 69519
TPG(1899, 36) = 69375
TPG(1899, 37) = 69221
TPG(1899, 38) = 69058
TPG(1899, 39) = 68885
TPG(1899, 40) = 68701
TPG(1899, 41) = 68508
TPG(1899, 42) = 68302
TPG(1899, 43) = 68082
TPG(1899, 44) = 67847
TPG(1899, 45) = 67596
TPG(1899, 46) = 67319
TPG(1899, 47) = 67029
TPG(1899, 48) = 66724
TPG(1899, 49) = 66404
TPG(1899, 50) = 66069
TPG(1899, 51) = 65725
TPG(1899, 52) = 65355
TPG(1899, 53) = 64967
TPG(1899, 54) = 64554
TPG(1899, 55) = 64117
TPG(1899, 56) = 63654
TPG(1899, 57) = 63164
TPG(1899, 58) = 62646
TPG(1899, 59) = 62090
TPG(1899, 60) = 61495
TPG(1899, 61) = 60860
TPG(1899, 62) = 60183
TPG(1899, 63) = 59464
TPG(1899, 64) = 58702
TPG(1899, 65) = 57896
TPG(1899, 66) = 57046
TPG(1899, 67) = 56148
TPG(1899, 68) = 55202
TPG(1899, 69) = 54198
TPG(1899, 70) = 53131
TPG(1899, 71) = 51998
TPG(1899, 72) = 50794
TPG(1899, 73) = 49518
TPG(1899, 74) = 48137
TPG(1899, 75) = 46648
TPG(1899, 76) = 45044
TPG(1899, 77) = 43319
TPG(1899, 78) = 41472
TPG(1899, 79) = 39499
TPG(1899, 80) = 37402
TPG(1899, 81) = 35184
TPG(1899, 82) = 32851
TPG(1899, 83) = 30413
TPG(1899, 84) = 27920
TPG(1899, 85) = 25391
TPG(1899, 86) = 22847
TPG(1899, 87) = 20314
TPG(1899, 88) = 17818
TPG(1899, 89) = 15423
TPG(1899, 90) = 13155
TPG(1899, 91) = 11035
TPG(1899, 92) = 9086
TPG(1899, 93) = 7325
TPG(1899, 94) = 5782
TPG(1899, 95) = 4457
TPG(1899, 96) = 3345
TPG(1899, 97) = 2437
TPG(1899, 98) = 1715
TPG(1899, 99) = 1162
TPG(1899, 100) = 753
TPG(1899, 101) = 464
TPG(1899, 102) = 269
TPG(1899, 103) = 146
TPG(1899, 104) = 73
TPG(1899, 105) = 33
TPG(1899, 106) = 13
TPG(1899, 107) = 4
TPG(1899, 108) = 1
TPG(1899, 109) = 0
TPG(1899, 110) = 0
TPG(1899, 111) = 0
TPG(1899, 112) = 0
TPG(1899, 113) = 0
TPG(1899, 114) = 0
TPG(1899, 115) = 0
TPG(1899, 116) = 0
TPG(1899, 117) = 0
TPG(1900, 0) = 100000
TPG(1900, 1) = 81203
TPG(1900, 2) = 75349
TPG(1900, 3) = 73920
TPG(1900, 4) = 73146
TPG(1900, 5) = 72719
TPG(1900, 6) = 72619
TPG(1900, 7) = 72531
TPG(1900, 8) = 72454
TPG(1900, 9) = 72385
TPG(1900, 10) = 72325
TPG(1900, 11) = 72284
TPG(1900, 12) = 72241
TPG(1900, 13) = 72199
TPG(1900, 14) = 72157
TPG(1900, 15) = 72113
TPG(1900, 16) = 72073
TPG(1900, 17) = 72030
TPG(1900, 18) = 71983
TPG(1900, 19) = 71933
TPG(1900, 20) = 71878
TPG(1900, 21) = 71819
TPG(1900, 22) = 71755
TPG(1900, 23) = 71686
TPG(1900, 24) = 71612
TPG(1900, 25) = 71532
TPG(1900, 26) = 71447
TPG(1900, 27) = 71355
TPG(1900, 28) = 71258
TPG(1900, 29) = 71155
TPG(1900, 30) = 71046
TPG(1900, 31) = 70928
TPG(1900, 32) = 70804
TPG(1900, 33) = 70674
TPG(1900, 34) = 70539
TPG(1900, 35) = 70397
TPG(1900, 36) = 70253
TPG(1900, 37) = 70100
TPG(1900, 38) = 69938
TPG(1900, 39) = 69766
TPG(1900, 40) = 69582
TPG(1900, 41) = 69391
TPG(1900, 42) = 69186
TPG(1900, 43) = 68966
TPG(1900, 44) = 68732
TPG(1900, 45) = 68483
TPG(1900, 46) = 68207
TPG(1900, 47) = 67918
TPG(1900, 48) = 67614
TPG(1900, 49) = 67296
TPG(1900, 50) = 66962
TPG(1900, 51) = 66611
TPG(1900, 52) = 66242
TPG(1900, 53) = 65855
TPG(1900, 54) = 65444
TPG(1900, 55) = 65008
TPG(1900, 56) = 64546
TPG(1900, 57) = 64058
TPG(1900, 58) = 63542
TPG(1900, 59) = 62988
TPG(1900, 60) = 62396
TPG(1900, 61) = 61764
TPG(1900, 62) = 61092
TPG(1900, 63) = 60377
TPG(1900, 64) = 59621
TPG(1900, 65) = 58820
TPG(1900, 66) = 57975
TPG(1900, 67) = 57082
TPG(1900, 68) = 56143
TPG(1900, 69) = 55143
TPG(1900, 70) = 54080
TPG(1900, 71) = 52950
TPG(1900, 72) = 51749
TPG(1900, 73) = 50473
TPG(1900, 74) = 49092
TPG(1900, 75) = 47601
TPG(1900, 76) = 45992
TPG(1900, 77) = 44261
TPG(1900, 78) = 42403
TPG(1900, 79) = 40418
TPG(1900, 80) = 38305
TPG(1900, 81) = 36067
TPG(1900, 82) = 33710
TPG(1900, 83) = 31244
TPG(1900, 84) = 28718
TPG(1900, 85) = 26151
TPG(1900, 86) = 23565
TPG(1900, 87) = 20985
TPG(1900, 88) = 18438
TPG(1900, 89) = 15989
TPG(1900, 90) = 13664
TPG(1900, 91) = 11487
TPG(1900, 92) = 9479
TPG(1900, 93) = 7661
TPG(1900, 94) = 6064
TPG(1900, 95) = 4688
TPG(1900, 96) = 3530
TPG(1900, 97) = 2580
TPG(1900, 98) = 1823
TPG(1900, 99) = 1240
TPG(1900, 100) = 807
TPG(1900, 101) = 500
TPG(1900, 102) = 292
TPG(1900, 103) = 159
TPG(1900, 104) = 80
TPG(1900, 105) = 36
TPG(1900, 106) = 15
TPG(1900, 107) = 5
TPG(1900, 108) = 1
TPG(1900, 109) = 0
TPG(1900, 110) = 0
TPG(1900, 111) = 0
TPG(1900, 112) = 0
TPG(1900, 113) = 0
TPG(1900, 114) = 0
TPG(1900, 115) = 0
TPG(1900, 116) = 0
TPG(1900, 117) = 0
TPG(1901, 0) = 100000
TPG(1901, 1) = 81814
TPG(1901, 2) = 76121
TPG(1901, 3) = 74739
TPG(1901, 4) = 73986
TPG(1901, 5) = 73569
TPG(1901, 6) = 73470
TPG(1901, 7) = 73383
TPG(1901, 8) = 73307
TPG(1901, 9) = 73239
TPG(1901, 10) = 73180
TPG(1901, 11) = 73137
TPG(1901, 12) = 73096
TPG(1901, 13) = 73054
TPG(1901, 14) = 73012
TPG(1901, 15) = 72968
TPG(1901, 16) = 72928
TPG(1901, 17) = 72885
TPG(1901, 18) = 72838
TPG(1901, 19) = 72787
TPG(1901, 20) = 72732
TPG(1901, 21) = 72673
TPG(1901, 22) = 72609
TPG(1901, 23) = 72540
TPG(1901, 24) = 72466
TPG(1901, 25) = 72386
TPG(1901, 26) = 72301
TPG(1901, 27) = 72210
TPG(1901, 28) = 72113
TPG(1901, 29) = 72011
TPG(1901, 30) = 71902
TPG(1901, 31) = 71784
TPG(1901, 32) = 71661
TPG(1901, 33) = 71532
TPG(1901, 34) = 71397
TPG(1901, 35) = 71256
TPG(1901, 36) = 71113
TPG(1901, 37) = 70961
TPG(1901, 38) = 70800
TPG(1901, 39) = 70628
TPG(1901, 40) = 70446
TPG(1901, 41) = 70255
TPG(1901, 42) = 70051
TPG(1901, 43) = 69833
TPG(1901, 44) = 69600
TPG(1901, 45) = 69351
TPG(1901, 46) = 69077
TPG(1901, 47) = 68790
TPG(1901, 48) = 68488
TPG(1901, 49) = 68171
TPG(1901, 50) = 67838
TPG(1901, 51) = 67488
TPG(1901, 52) = 67121
TPG(1901, 53) = 66735
TPG(1901, 54) = 66325
TPG(1901, 55) = 65891
TPG(1901, 56) = 65431
TPG(1901, 57) = 64945
TPG(1901, 58) = 64430
TPG(1901, 59) = 63879
TPG(1901, 60) = 63291
TPG(1901, 61) = 62663
TPG(1901, 62) = 61994
TPG(1901, 63) = 61285
TPG(1901, 64) = 60533
TPG(1901, 65) = 59738
TPG(1901, 66) = 58898
TPG(1901, 67) = 58012
TPG(1901, 68) = 57078
TPG(1901, 69) = 56084
TPG(1901, 70) = 55025
TPG(1901, 71) = 53899
TPG(1901, 72) = 52701
TPG(1901, 73) = 51426
TPG(1901, 74) = 50045
TPG(1901, 75) = 48552
TPG(1901, 76) = 46939
TPG(1901, 77) = 45202
TPG(1901, 78) = 43336
TPG(1901, 79) = 41339
TPG(1901, 80) = 39211
TPG(1901, 81) = 36954
TPG(1901, 82) = 34574
TPG(1901, 83) = 32080
TPG(1901, 84) = 29522
TPG(1901, 85) = 26919
TPG(1901, 86) = 24291
TPG(1901, 87) = 21664
TPG(1901, 88) = 19067
TPG(1901, 89) = 16565
TPG(1901, 90) = 14184
TPG(1901, 91) = 11949
TPG(1901, 92) = 9883
TPG(1901, 93) = 8008
TPG(1901, 94) = 6355
TPG(1901, 95) = 4927
TPG(1901, 96) = 3721
TPG(1901, 97) = 2729
TPG(1901, 98) = 1936
TPG(1901, 99) = 1322
TPG(1901, 100) = 865
TPG(1901, 101) = 538
TPG(1901, 102) = 316
TPG(1901, 103) = 173
TPG(1901, 104) = 88
TPG(1901, 105) = 40
TPG(1901, 106) = 16
TPG(1901, 107) = 6
TPG(1901, 108) = 2
TPG(1901, 109) = 0
TPG(1901, 110) = 0
TPG(1901, 111) = 0
TPG(1901, 112) = 0
TPG(1901, 113) = 0
TPG(1901, 114) = 0
TPG(1901, 115) = 0
TPG(1901, 116) = 0
TPG(1901, 117) = 0
TPG(1902, 0) = 100000
TPG(1902, 1) = 82411
TPG(1902, 2) = 76875
TPG(1902, 3) = 75539
TPG(1902, 4) = 74807
TPG(1902, 5) = 74400
TPG(1902, 6) = 74302
TPG(1902, 7) = 74216
TPG(1902, 8) = 74141
TPG(1902, 9) = 74074
TPG(1902, 10) = 74015
TPG(1902, 11) = 73974
TPG(1902, 12) = 73933
TPG(1902, 13) = 73892
TPG(1902, 14) = 73849
TPG(1902, 15) = 73806
TPG(1902, 16) = 73766
TPG(1902, 17) = 73722
TPG(1902, 18) = 73675
TPG(1902, 19) = 73624
TPG(1902, 20) = 73569
TPG(1902, 21) = 73509
TPG(1902, 22) = 73445
TPG(1902, 23) = 73376
TPG(1902, 24) = 73302
TPG(1902, 25) = 73223
TPG(1902, 26) = 73138
TPG(1902, 27) = 73047
TPG(1902, 28) = 72951
TPG(1902, 29) = 72849
TPG(1902, 30) = 72740
TPG(1902, 31) = 72623
TPG(1902, 32) = 72501
TPG(1902, 33) = 72373
TPG(1902, 34) = 72239
TPG(1902, 35) = 72099
TPG(1902, 36) = 71957
TPG(1902, 37) = 71805
TPG(1902, 38) = 71645
TPG(1902, 39) = 71474
TPG(1902, 40) = 71293
TPG(1902, 41) = 71103
TPG(1902, 42) = 70900
TPG(1902, 43) = 70683
TPG(1902, 44) = 70451
TPG(1902, 45) = 70204
TPG(1902, 46) = 69931
TPG(1902, 47) = 69645
TPG(1902, 48) = 69345
TPG(1902, 49) = 69030
TPG(1902, 50) = 68698
TPG(1902, 51) = 68350
TPG(1902, 52) = 67984
TPG(1902, 53) = 67600
TPG(1902, 54) = 67192
TPG(1902, 55) = 66759
TPG(1902, 56) = 66301
TPG(1902, 57) = 65817
TPG(1902, 58) = 65305
TPG(1902, 59) = 64757
TPG(1902, 60) = 64171
TPG(1902, 61) = 63547
TPG(1902, 62) = 62883
TPG(1902, 63) = 62179
TPG(1902, 64) = 61432
TPG(1902, 65) = 60643
TPG(1902, 66) = 59809
TPG(1902, 67) = 58929
TPG(1902, 68) = 58002
TPG(1902, 69) = 57013
TPG(1902, 70) = 55960
TPG(1902, 71) = 54838
TPG(1902, 72) = 53643
TPG(1902, 73) = 52370
TPG(1902, 74) = 50990
TPG(1902, 75) = 49495
TPG(1902, 76) = 47880
TPG(1902, 77) = 46138
TPG(1902, 78) = 44264
TPG(1902, 79) = 42256
TPG(1902, 80) = 40114
TPG(1902, 81) = 37840
TPG(1902, 82) = 35438
TPG(1902, 83) = 32918
TPG(1902, 84) = 30329
TPG(1902, 85) = 27690
TPG(1902, 86) = 25022
TPG(1902, 87) = 22351
TPG(1902, 88) = 19704
TPG(1902, 89) = 17149
TPG(1902, 90) = 14712
TPG(1902, 91) = 12420
TPG(1902, 92) = 10296
TPG(1902, 93) = 8362
TPG(1902, 94) = 6654
TPG(1902, 95) = 5173
TPG(1902, 96) = 3920
TPG(1902, 97) = 2885
TPG(1902, 98) = 2054
TPG(1902, 99) = 1408
TPG(1902, 100) = 925
TPG(1902, 101) = 578
TPG(1902, 102) = 341
TPG(1902, 103) = 189
TPG(1902, 104) = 96
TPG(1902, 105) = 45
TPG(1902, 106) = 18
TPG(1902, 107) = 7
TPG(1902, 108) = 2
TPG(1902, 109) = 0
TPG(1902, 110) = 0
TPG(1902, 111) = 0
TPG(1902, 112) = 0
TPG(1902, 113) = 0
TPG(1902, 114) = 0
TPG(1902, 115) = 0
TPG(1902, 116) = 0
TPG(1902, 117) = 0
TPG(1903, 0) = 100000
TPG(1903, 1) = 82991
TPG(1903, 2) = 77612
TPG(1903, 3) = 76320
TPG(1903, 4) = 75610
TPG(1903, 5) = 75212
TPG(1903, 6) = 75116
TPG(1903, 7) = 75031
TPG(1903, 8) = 74956
TPG(1903, 9) = 74889
TPG(1903, 10) = 74831
TPG(1903, 11) = 74791
TPG(1903, 12) = 74750
TPG(1903, 13) = 74708
TPG(1903, 14) = 74666
TPG(1903, 15) = 74623
TPG(1903, 16) = 74583
TPG(1903, 17) = 74539
TPG(1903, 18) = 74492
TPG(1903, 19) = 74441
TPG(1903, 20) = 74385
TPG(1903, 21) = 74326
TPG(1903, 22) = 74262
TPG(1903, 23) = 74193
TPG(1903, 24) = 74119
TPG(1903, 25) = 74040
TPG(1903, 26) = 73954
TPG(1903, 27) = 73864
TPG(1903, 28) = 73768
TPG(1903, 29) = 73666
TPG(1903, 30) = 73559
TPG(1903, 31) = 73442
TPG(1903, 32) = 73321
TPG(1903, 33) = 73194
TPG(1903, 34) = 73061
TPG(1903, 35) = 72922
TPG(1903, 36) = 72780
TPG(1903, 37) = 72630
TPG(1903, 38) = 72470
TPG(1903, 39) = 72300
TPG(1903, 40) = 72120
TPG(1903, 41) = 71931
TPG(1903, 42) = 71729
TPG(1903, 43) = 71514
TPG(1903, 44) = 71283
TPG(1903, 45) = 71037
TPG(1903, 46) = 70767
TPG(1903, 47) = 70482
TPG(1903, 48) = 70184
TPG(1903, 49) = 69870
TPG(1903, 50) = 69540
TPG(1903, 51) = 69194
TPG(1903, 52) = 68830
TPG(1903, 53) = 68447
TPG(1903, 54) = 68040
TPG(1903, 55) = 67610
TPG(1903, 56) = 67154
TPG(1903, 57) = 66672
TPG(1903, 58) = 66162
TPG(1903, 59) = 65617
TPG(1903, 60) = 65035
TPG(1903, 61) = 64415
TPG(1903, 62) = 63756
TPG(1903, 63) = 63057
TPG(1903, 64) = 62317
TPG(1903, 65) = 61533
TPG(1903, 66) = 60706
TPG(1903, 67) = 59832
TPG(1903, 68) = 58911
TPG(1903, 69) = 57929
TPG(1903, 70) = 56882
TPG(1903, 71) = 55764
TPG(1903, 72) = 54573
TPG(1903, 73) = 53303
TPG(1903, 74) = 51924
TPG(1903, 75) = 50430
TPG(1903, 76) = 48812
TPG(1903, 77) = 47066
TPG(1903, 78) = 45185
TPG(1903, 79) = 43168
TPG(1903, 80) = 41013
TPG(1903, 81) = 38723
TPG(1903, 82) = 36300
TPG(1903, 83) = 33755
TPG(1903, 84) = 31137
TPG(1903, 85) = 28464
TPG(1903, 86) = 25757
TPG(1903, 87) = 23042
TPG(1903, 88) = 20347
TPG(1903, 89) = 17740
TPG(1903, 90) = 15248
TPG(1903, 91) = 12898
TPG(1903, 92) = 10717
TPG(1903, 93) = 8725
TPG(1903, 94) = 6960
TPG(1903, 95) = 5427
TPG(1903, 96) = 4125
TPG(1903, 97) = 3046
TPG(1903, 98) = 2177
TPG(1903, 99) = 1499
TPG(1903, 100) = 989
TPG(1903, 101) = 621
TPG(1903, 102) = 369
TPG(1903, 103) = 205
TPG(1903, 104) = 105
TPG(1903, 105) = 49
TPG(1903, 106) = 20
TPG(1903, 107) = 7
TPG(1903, 108) = 2
TPG(1903, 109) = 1
TPG(1903, 110) = 0
TPG(1903, 111) = 0
TPG(1903, 112) = 0
TPG(1903, 113) = 0
TPG(1903, 114) = 0
TPG(1903, 115) = 0
TPG(1903, 116) = 0
TPG(1903, 117) = 0
TPG(1904, 0) = 100000
TPG(1904, 1) = 83556
TPG(1904, 2) = 78330
TPG(1904, 3) = 77083
TPG(1904, 4) = 76393
TPG(1904, 5) = 76005
TPG(1904, 6) = 75909
TPG(1904, 7) = 75826
TPG(1904, 8) = 75751
TPG(1904, 9) = 75686
TPG(1904, 10) = 75628
TPG(1904, 11) = 75588
TPG(1904, 12) = 75547
TPG(1904, 13) = 75506
TPG(1904, 14) = 75464
TPG(1904, 15) = 75421
TPG(1904, 16) = 75381
TPG(1904, 17) = 75337
TPG(1904, 18) = 75289
TPG(1904, 19) = 75238
TPG(1904, 20) = 75183
TPG(1904, 21) = 75123
TPG(1904, 22) = 75059
TPG(1904, 23) = 74990
TPG(1904, 24) = 74916
TPG(1904, 25) = 74837
TPG(1904, 26) = 74752
TPG(1904, 27) = 74662
TPG(1904, 28) = 74567
TPG(1904, 29) = 74466
TPG(1904, 30) = 74358
TPG(1904, 31) = 74243
TPG(1904, 32) = 74122
TPG(1904, 33) = 73996
TPG(1904, 34) = 73864
TPG(1904, 35) = 73726
TPG(1904, 36) = 73585
TPG(1904, 37) = 73436
TPG(1904, 38) = 73277
TPG(1904, 39) = 73108
TPG(1904, 40) = 72929
TPG(1904, 41) = 72741
TPG(1904, 42) = 72541
TPG(1904, 43) = 72326
TPG(1904, 44) = 72098
TPG(1904, 45) = 71853
TPG(1904, 46) = 71584
TPG(1904, 47) = 71306
TPG(1904, 48) = 71009
TPG(1904, 49) = 70697
TPG(1904, 50) = 70369
TPG(1904, 51) = 70025
TPG(1904, 52) = 69662
TPG(1904, 53) = 69281
TPG(1904, 54) = 68876
TPG(1904, 55) = 68448
TPG(1904, 56) = 67994
TPG(1904, 57) = 67514
TPG(1904, 58) = 67007
TPG(1904, 59) = 66465
TPG(1904, 60) = 65887
TPG(1904, 61) = 65271
TPG(1904, 62) = 64617
TPG(1904, 63) = 63924
TPG(1904, 64) = 63190
TPG(1904, 65) = 62413
TPG(1904, 66) = 61592
TPG(1904, 67) = 60725
TPG(1904, 68) = 59811
TPG(1904, 69) = 58836
TPG(1904, 70) = 57794
TPG(1904, 71) = 56682
TPG(1904, 72) = 55495
TPG(1904, 73) = 54228
TPG(1904, 74) = 52852
TPG(1904, 75) = 51358
TPG(1904, 76) = 49739
TPG(1904, 77) = 47989
TPG(1904, 78) = 46103
TPG(1904, 79) = 44077
TPG(1904, 80) = 41911
TPG(1904, 81) = 39605
TPG(1904, 82) = 37164
TPG(1904, 83) = 34595
TPG(1904, 84) = 31948
TPG(1904, 85) = 29242
TPG(1904, 86) = 26498
TPG(1904, 87) = 23739
TPG(1904, 88) = 20997
TPG(1904, 89) = 18338
TPG(1904, 90) = 15792
TPG(1904, 91) = 13386
TPG(1904, 92) = 11146
TPG(1904, 93) = 9097
TPG(1904, 94) = 7276
TPG(1904, 95) = 5689
TPG(1904, 96) = 4337
TPG(1904, 97) = 3213
TPG(1904, 98) = 2305
TPG(1904, 99) = 1593
TPG(1904, 100) = 1056
TPG(1904, 101) = 667
TPG(1904, 102) = 398
TPG(1904, 103) = 223
TPG(1904, 104) = 115
TPG(1904, 105) = 54
TPG(1904, 106) = 23
TPG(1904, 107) = 8
TPG(1904, 108) = 3
TPG(1904, 109) = 1
TPG(1904, 110) = 0
TPG(1904, 111) = 0
TPG(1904, 112) = 0
TPG(1904, 113) = 0
TPG(1904, 114) = 0
TPG(1904, 115) = 0
TPG(1904, 116) = 0
TPG(1904, 117) = 0
TPG(1905, 0) = 100000
TPG(1905, 1) = 84106
TPG(1905, 2) = 79032
TPG(1905, 3) = 77827
TPG(1905, 4) = 77157
TPG(1905, 5) = 76778
TPG(1905, 6) = 76684
TPG(1905, 7) = 76601
TPG(1905, 8) = 76528
TPG(1905, 9) = 76463
TPG(1905, 10) = 76405
TPG(1905, 11) = 76366
TPG(1905, 12) = 76326
TPG(1905, 13) = 76285
TPG(1905, 14) = 76243
TPG(1905, 15) = 76200
TPG(1905, 16) = 76159
TPG(1905, 17) = 76115
TPG(1905, 18) = 76068
TPG(1905, 19) = 76017
TPG(1905, 20) = 75961
TPG(1905, 21) = 75902
TPG(1905, 22) = 75837
TPG(1905, 23) = 75768
TPG(1905, 24) = 75695
TPG(1905, 25) = 75616
TPG(1905, 26) = 75531
TPG(1905, 27) = 75442
TPG(1905, 28) = 75347
TPG(1905, 29) = 75246
TPG(1905, 30) = 75139
TPG(1905, 31) = 75025
TPG(1905, 32) = 74905
TPG(1905, 33) = 74780
TPG(1905, 34) = 74649
TPG(1905, 35) = 74511
TPG(1905, 36) = 74372
TPG(1905, 37) = 74223
TPG(1905, 38) = 74066
TPG(1905, 39) = 73898
TPG(1905, 40) = 73720
TPG(1905, 41) = 73534
TPG(1905, 42) = 73334
TPG(1905, 43) = 73121
TPG(1905, 44) = 72894
TPG(1905, 45) = 72651
TPG(1905, 46) = 72392
TPG(1905, 47) = 72115
TPG(1905, 48) = 71820
TPG(1905, 49) = 71510
TPG(1905, 50) = 71184
TPG(1905, 51) = 70841
TPG(1905, 52) = 70481
TPG(1905, 53) = 70101
TPG(1905, 54) = 69699
TPG(1905, 55) = 69273
TPG(1905, 56) = 68821
TPG(1905, 57) = 68344
TPG(1905, 58) = 67840
TPG(1905, 59) = 67301
TPG(1905, 60) = 66727
TPG(1905, 61) = 66116
TPG(1905, 62) = 65467
TPG(1905, 63) = 64779
TPG(1905, 64) = 64051
TPG(1905, 65) = 63281
TPG(1905, 66) = 62466
TPG(1905, 67) = 61607
TPG(1905, 68) = 60701
TPG(1905, 69) = 59732
TPG(1905, 70) = 58697
TPG(1905, 71) = 57590
TPG(1905, 72) = 56408
TPG(1905, 73) = 55145
TPG(1905, 74) = 53771
TPG(1905, 75) = 52279
TPG(1905, 76) = 50660
TPG(1905, 77) = 48907
TPG(1905, 78) = 47016
TPG(1905, 79) = 44983
TPG(1905, 80) = 42806
TPG(1905, 81) = 40486
TPG(1905, 82) = 38027
TPG(1905, 83) = 35435
TPG(1905, 84) = 32762
TPG(1905, 85) = 30024
TPG(1905, 86) = 27243
TPG(1905, 87) = 24443
TPG(1905, 88) = 21653
TPG(1905, 89) = 18945
TPG(1905, 90) = 16345
TPG(1905, 91) = 13882
TPG(1905, 92) = 11585
TPG(1905, 93) = 9477
TPG(1905, 94) = 7599
TPG(1905, 95) = 5959
TPG(1905, 96) = 4556
TPG(1905, 97) = 3387
TPG(1905, 98) = 2438
TPG(1905, 99) = 1692
TPG(1905, 100) = 1126
TPG(1905, 101) = 715
TPG(1905, 102) = 429
TPG(1905, 103) = 241
TPG(1905, 104) = 126
TPG(1905, 105) = 60
TPG(1905, 106) = 25
TPG(1905, 107) = 9
TPG(1905, 108) = 3
TPG(1905, 109) = 1
TPG(1905, 110) = 0
TPG(1905, 111) = 0
TPG(1905, 112) = 0
TPG(1905, 113) = 0
TPG(1905, 114) = 0
TPG(1905, 115) = 0
TPG(1905, 116) = 0
TPG(1905, 117) = 0
End Function

Function IniTPG2()
TPG(1906, 0) = 100000
TPG(1906, 1) = 84641
TPG(1906, 2) = 79715
TPG(1906, 3) = 78552
TPG(1906, 4) = 77902
TPG(1906, 5) = 77533
TPG(1906, 6) = 77440
TPG(1906, 7) = 77358
TPG(1906, 8) = 77285
TPG(1906, 9) = 77221
TPG(1906, 10) = 77164
TPG(1906, 11) = 77125
TPG(1906, 12) = 77085
TPG(1906, 13) = 77045
TPG(1906, 14) = 77003
TPG(1906, 15) = 76960
TPG(1906, 16) = 76919
TPG(1906, 17) = 76875
TPG(1906, 18) = 76828
TPG(1906, 19) = 76776
TPG(1906, 20) = 76721
TPG(1906, 21) = 76661
TPG(1906, 22) = 76597
TPG(1906, 23) = 76528
TPG(1906, 24) = 76454
TPG(1906, 25) = 76376
TPG(1906, 26) = 76292
TPG(1906, 27) = 76202
TPG(1906, 28) = 76108
TPG(1906, 29) = 76008
TPG(1906, 30) = 75902
TPG(1906, 31) = 75788
TPG(1906, 32) = 75670
TPG(1906, 33) = 75545
TPG(1906, 34) = 75415
TPG(1906, 35) = 75279
TPG(1906, 36) = 75140
TPG(1906, 37) = 74993
TPG(1906, 38) = 74836
TPG(1906, 39) = 74670
TPG(1906, 40) = 74493
TPG(1906, 41) = 74308
TPG(1906, 42) = 74110
TPG(1906, 43) = 73898
TPG(1906, 44) = 73672
TPG(1906, 45) = 73431
TPG(1906, 46) = 73173
TPG(1906, 47) = 72899
TPG(1906, 48) = 72606
TPG(1906, 49) = 72298
TPG(1906, 50) = 71974
TPG(1906, 51) = 71633
TPG(1906, 52) = 71274
TPG(1906, 53) = 70897
TPG(1906, 54) = 70497
TPG(1906, 55) = 70073
TPG(1906, 56) = 69624
TPG(1906, 57) = 69150
TPG(1906, 58) = 68649
TPG(1906, 59) = 68113
TPG(1906, 60) = 67543
TPG(1906, 61) = 66937
TPG(1906, 62) = 66293
TPG(1906, 63) = 65612
TPG(1906, 64) = 64891
TPG(1906, 65) = 64127
TPG(1906, 66) = 63320
TPG(1906, 67) = 62468
TPG(1906, 68) = 61569
TPG(1906, 69) = 60608
TPG(1906, 70) = 59580
TPG(1906, 71) = 58480
TPG(1906, 72) = 57303
TPG(1906, 73) = 56045
TPG(1906, 74) = 54674
TPG(1906, 75) = 53184
TPG(1906, 76) = 51565
TPG(1906, 77) = 49812
TPG(1906, 78) = 47916
TPG(1906, 79) = 45877
TPG(1906, 80) = 43691
TPG(1906, 81) = 41359
TPG(1906, 82) = 38883
TPG(1906, 83) = 36270
TPG(1906, 84) = 33572
TPG(1906, 85) = 30804
TPG(1906, 86) = 27988
TPG(1906, 87) = 25147
TPG(1906, 88) = 22313
TPG(1906, 89) = 19555
TPG(1906, 90) = 16903
TPG(1906, 91) = 14385
TPG(1906, 92) = 12030
TPG(1906, 93) = 9864
TPG(1906, 94) = 7930
TPG(1906, 95) = 6235
TPG(1906, 96) = 4782
TPG(1906, 97) = 3566
TPG(1906, 98) = 2576
TPG(1906, 99) = 1795
TPG(1906, 100) = 1200
TPG(1906, 101) = 765
TPG(1906, 102) = 462
TPG(1906, 103) = 261
TPG(1906, 104) = 137
TPG(1906, 105) = 66
TPG(1906, 106) = 28
TPG(1906, 107) = 11
TPG(1906, 108) = 3
TPG(1906, 109) = 1
TPG(1906, 110) = 0
TPG(1906, 111) = 0
TPG(1906, 112) = 0
TPG(1906, 113) = 0
TPG(1906, 114) = 0
TPG(1906, 115) = 0
TPG(1906, 116) = 0
TPG(1906, 117) = 0
TPG(1907, 0) = 100000
TPG(1907, 1) = 85161
TPG(1907, 2) = 80381
TPG(1907, 3) = 79258
TPG(1907, 4) = 78628
TPG(1907, 5) = 78268
TPG(1907, 6) = 78176
TPG(1907, 7) = 78096
TPG(1907, 8) = 78024
TPG(1907, 9) = 77960
TPG(1907, 10) = 77904
TPG(1907, 11) = 77865
TPG(1907, 12) = 77826
TPG(1907, 13) = 77785
TPG(1907, 14) = 77744
TPG(1907, 15) = 77701
TPG(1907, 16) = 77660
TPG(1907, 17) = 77616
TPG(1907, 18) = 77569
TPG(1907, 19) = 77517
TPG(1907, 20) = 77462
TPG(1907, 21) = 77402
TPG(1907, 22) = 77338
TPG(1907, 23) = 77269
TPG(1907, 24) = 77195
TPG(1907, 25) = 77117
TPG(1907, 26) = 77033
TPG(1907, 27) = 76945
TPG(1907, 28) = 76850
TPG(1907, 29) = 76751
TPG(1907, 30) = 76646
TPG(1907, 31) = 76533
TPG(1907, 32) = 76415
TPG(1907, 33) = 76292
TPG(1907, 34) = 76163
TPG(1907, 35) = 76028
TPG(1907, 36) = 75890
TPG(1907, 37) = 75743
TPG(1907, 38) = 75588
TPG(1907, 39) = 75423
TPG(1907, 40) = 75247
TPG(1907, 41) = 75063
TPG(1907, 42) = 74867
TPG(1907, 43) = 74657
TPG(1907, 44) = 74432
TPG(1907, 45) = 74193
TPG(1907, 46) = 73937
TPG(1907, 47) = 73665
TPG(1907, 48) = 73374
TPG(1907, 49) = 73068
TPG(1907, 50) = 72746
TPG(1907, 51) = 72407
TPG(1907, 52) = 72051
TPG(1907, 53) = 71675
TPG(1907, 54) = 71278
TPG(1907, 55) = 70856
TPG(1907, 56) = 70410
TPG(1907, 57) = 69939
TPG(1907, 58) = 69441
TPG(1907, 59) = 68909
TPG(1907, 60) = 68344
TPG(1907, 61) = 67742
TPG(1907, 62) = 67104
TPG(1907, 63) = 66430
TPG(1907, 64) = 65715
TPG(1907, 65) = 64958
TPG(1907, 66) = 64159
TPG(1907, 67) = 63314
TPG(1907, 68) = 62424
TPG(1907, 69) = 61471
TPG(1907, 70) = 60450
TPG(1907, 71) = 59356
TPG(1907, 72) = 58186
TPG(1907, 73) = 56932
TPG(1907, 74) = 55566
TPG(1907, 75) = 54078
TPG(1907, 76) = 52461
TPG(1907, 77) = 50707
TPG(1907, 78) = 48809
TPG(1907, 79) = 46765
TPG(1907, 80) = 44571
TPG(1907, 81) = 42227
TPG(1907, 82) = 39736
TPG(1907, 83) = 37104
TPG(1907, 84) = 34382
TPG(1907, 85) = 31585
TPG(1907, 86) = 28735
TPG(1907, 87) = 25856
TPG(1907, 88) = 22977
TPG(1907, 89) = 20171
TPG(1907, 90) = 17467
TPG(1907, 91) = 14894
TPG(1907, 92) = 12483
TPG(1907, 93) = 10259
TPG(1907, 94) = 8268
TPG(1907, 95) = 6519
TPG(1907, 96) = 5014
TPG(1907, 97) = 3751
TPG(1907, 98) = 2720
TPG(1907, 99) = 1902
TPG(1907, 100) = 1278
TPG(1907, 101) = 819
TPG(1907, 102) = 497
TPG(1907, 103) = 283
TPG(1907, 104) = 149
TPG(1907, 105) = 72
TPG(1907, 106) = 31
TPG(1907, 107) = 12
TPG(1907, 108) = 4
TPG(1907, 109) = 1
TPG(1907, 110) = 0
TPG(1907, 111) = 0
TPG(1907, 112) = 0
TPG(1907, 113) = 0
TPG(1907, 114) = 0
TPG(1907, 115) = 0
TPG(1907, 116) = 0
TPG(1907, 117) = 0
TPG(1908, 0) = 100000
TPG(1908, 1) = 85667
TPG(1908, 2) = 81030
TPG(1908, 3) = 79947
TPG(1908, 4) = 79335
TPG(1908, 5) = 78984
TPG(1908, 6) = 78894
TPG(1908, 7) = 78814
TPG(1908, 8) = 78744
TPG(1908, 9) = 78681
TPG(1908, 10) = 78625
TPG(1908, 11) = 78586
TPG(1908, 12) = 78547
TPG(1908, 13) = 78507
TPG(1908, 14) = 78466
TPG(1908, 15) = 78423
TPG(1908, 16) = 78382
TPG(1908, 17) = 78338
TPG(1908, 18) = 78291
TPG(1908, 19) = 78239
TPG(1908, 20) = 78184
TPG(1908, 21) = 78124
TPG(1908, 22) = 78060
TPG(1908, 23) = 77991
TPG(1908, 24) = 77918
TPG(1908, 25) = 77840
TPG(1908, 26) = 77756
TPG(1908, 27) = 77668
TPG(1908, 28) = 77575
TPG(1908, 29) = 77476
TPG(1908, 30) = 77371
TPG(1908, 31) = 77260
TPG(1908, 32) = 77143
TPG(1908, 33) = 77020
TPG(1908, 34) = 76892
TPG(1908, 35) = 76758
TPG(1908, 36) = 76621
TPG(1908, 37) = 76476
TPG(1908, 38) = 76322
TPG(1908, 39) = 76158
TPG(1908, 40) = 75984
TPG(1908, 41) = 75801
TPG(1908, 42) = 75606
TPG(1908, 43) = 75398
TPG(1908, 44) = 75175
TPG(1908, 45) = 74937
TPG(1908, 46) = 74683
TPG(1908, 47) = 74413
TPG(1908, 48) = 74124
TPG(1908, 49) = 73820
TPG(1908, 50) = 73501
TPG(1908, 51) = 73164
TPG(1908, 52) = 72810
TPG(1908, 53) = 72437
TPG(1908, 54) = 72041
TPG(1908, 55) = 71623
TPG(1908, 56) = 71180
TPG(1908, 57) = 70711
TPG(1908, 58) = 70217
TPG(1908, 59) = 69689
TPG(1908, 60) = 69128
TPG(1908, 61) = 68532
TPG(1908, 62) = 67900
TPG(1908, 63) = 67232
TPG(1908, 64) = 66524
TPG(1908, 65) = 65775
TPG(1908, 66) = 64983
TPG(1908, 67) = 64147
TPG(1908, 68) = 63265
TPG(1908, 69) = 62320
TPG(1908, 70) = 61306
TPG(1908, 71) = 60220
TPG(1908, 72) = 59056
TPG(1908, 73) = 57808
TPG(1908, 74) = 56446
TPG(1908, 75) = 54962
TPG(1908, 76) = 53348
TPG(1908, 77) = 51594
TPG(1908, 78) = 49694
TPG(1908, 79) = 47645
TPG(1908, 80) = 45444
TPG(1908, 81) = 43090
TPG(1908, 82) = 40586
TPG(1908, 83) = 37935
TPG(1908, 84) = 35191
TPG(1908, 85) = 32367
TPG(1908, 86) = 29484
TPG(1908, 87) = 26567
TPG(1908, 88) = 23646
TPG(1908, 89) = 20793
TPG(1908, 90) = 18038
TPG(1908, 91) = 15411
TPG(1908, 92) = 12943
TPG(1908, 93) = 10662
TPG(1908, 94) = 8614
TPG(1908, 95) = 6810
TPG(1908, 96) = 5254
TPG(1908, 97) = 3943
TPG(1908, 98) = 2869
TPG(1908, 99) = 2014
TPG(1908, 100) = 1359
TPG(1908, 101) = 875
TPG(1908, 102) = 534
TPG(1908, 103) = 306
TPG(1908, 104) = 163
TPG(1908, 105) = 79
TPG(1908, 106) = 35
TPG(1908, 107) = 13
TPG(1908, 108) = 4
TPG(1908, 109) = 1
TPG(1908, 110) = 0
TPG(1908, 111) = 0
TPG(1908, 112) = 0
TPG(1908, 113) = 0
TPG(1908, 114) = 0
TPG(1908, 115) = 0
TPG(1908, 116) = 0
TPG(1908, 117) = 0
TPG(1909, 0) = 100000
TPG(1909, 1) = 86158
TPG(1909, 2) = 81662
TPG(1909, 3) = 80616
TPG(1909, 4) = 80023
TPG(1909, 5) = 79682
TPG(1909, 6) = 79593
TPG(1909, 7) = 79514
TPG(1909, 8) = 79444
TPG(1909, 9) = 79382
TPG(1909, 10) = 79327
TPG(1909, 11) = 79289
TPG(1909, 12) = 79250
TPG(1909, 13) = 79210
TPG(1909, 14) = 79169
TPG(1909, 15) = 79127
TPG(1909, 16) = 79086
TPG(1909, 17) = 79042
TPG(1909, 18) = 78994
TPG(1909, 19) = 78943
TPG(1909, 20) = 78887
TPG(1909, 21) = 78827
TPG(1909, 22) = 78763
TPG(1909, 23) = 78695
TPG(1909, 24) = 78622
TPG(1909, 25) = 78544
TPG(1909, 26) = 78461
TPG(1909, 27) = 78373
TPG(1909, 28) = 78280
TPG(1909, 29) = 78182
TPG(1909, 30) = 78078
TPG(1909, 31) = 77968
TPG(1909, 32) = 77852
TPG(1909, 33) = 77730
TPG(1909, 34) = 77603
TPG(1909, 35) = 77470
TPG(1909, 36) = 77335
TPG(1909, 37) = 77191
TPG(1909, 38) = 77038
TPG(1909, 39) = 76875
TPG(1909, 40) = 76702
TPG(1909, 41) = 76521
TPG(1909, 42) = 76326
TPG(1909, 43) = 76120
TPG(1909, 44) = 75899
TPG(1909, 45) = 75663
TPG(1909, 46) = 75411
TPG(1909, 47) = 75142
TPG(1909, 48) = 74856
TPG(1909, 49) = 74555
TPG(1909, 50) = 74237
TPG(1909, 51) = 73903
TPG(1909, 52) = 73551
TPG(1909, 53) = 73180
TPG(1909, 54) = 72788
TPG(1909, 55) = 72372
TPG(1909, 56) = 71932
TPG(1909, 57) = 71467
TPG(1909, 58) = 70975
TPG(1909, 59) = 70452
TPG(1909, 60) = 69895
TPG(1909, 61) = 69305
TPG(1909, 62) = 68679
TPG(1909, 63) = 68017
TPG(1909, 64) = 67317
TPG(1909, 65) = 66575
TPG(1909, 66) = 65791
TPG(1909, 67) = 64963
TPG(1909, 68) = 64090
TPG(1909, 69) = 63154
TPG(1909, 70) = 62148
TPG(1909, 71) = 61070
TPG(1909, 72) = 59912
TPG(1909, 73) = 58671
TPG(1909, 74) = 57314
TPG(1909, 75) = 55835
TPG(1909, 76) = 54223
TPG(1909, 77) = 52470
TPG(1909, 78) = 50569
TPG(1909, 79) = 48518
TPG(1909, 80) = 46311
TPG(1909, 81) = 43948
TPG(1909, 82) = 41431
TPG(1909, 83) = 38764
TPG(1909, 84) = 35998
TPG(1909, 85) = 33148
TPG(1909, 86) = 30234
TPG(1909, 87) = 27281
TPG(1909, 88) = 24319
TPG(1909, 89) = 21420
TPG(1909, 90) = 18614
TPG(1909, 91) = 15935
TPG(1909, 92) = 13411
TPG(1909, 93) = 11072
TPG(1909, 94) = 8967
TPG(1909, 95) = 7108
TPG(1909, 96) = 5500
TPG(1909, 97) = 4141
TPG(1909, 98) = 3023
TPG(1909, 99) = 2131
TPG(1909, 100) = 1443
TPG(1909, 101) = 934
TPG(1909, 102) = 573
TPG(1909, 103) = 330
TPG(1909, 104) = 177
TPG(1909, 105) = 87
TPG(1909, 106) = 38
TPG(1909, 107) = 15
TPG(1909, 108) = 5
TPG(1909, 109) = 1
TPG(1909, 110) = 0
TPG(1909, 111) = 0
TPG(1909, 112) = 0
TPG(1909, 113) = 0
TPG(1909, 114) = 0
TPG(1909, 115) = 0
TPG(1909, 116) = 0
TPG(1909, 117) = 0
TPG(1910, 0) = 100000
TPG(1910, 1) = 86635
TPG(1910, 2) = 82276
TPG(1910, 3) = 81268
TPG(1910, 4) = 80693
TPG(1910, 5) = 80361
TPG(1910, 6) = 80273
TPG(1910, 7) = 80196
TPG(1910, 8) = 80127
TPG(1910, 9) = 80065
TPG(1910, 10) = 80010
TPG(1910, 11) = 79973
TPG(1910, 12) = 79934
TPG(1910, 13) = 79895
TPG(1910, 14) = 79854
TPG(1910, 15) = 79812
TPG(1910, 16) = 79771
TPG(1910, 17) = 79727
TPG(1910, 18) = 79679
TPG(1910, 19) = 79628
TPG(1910, 20) = 79572
TPG(1910, 21) = 79512
TPG(1910, 22) = 79448
TPG(1910, 23) = 79380
TPG(1910, 24) = 79307
TPG(1910, 25) = 79229
TPG(1910, 26) = 79147
TPG(1910, 27) = 79060
TPG(1910, 28) = 78967
TPG(1910, 29) = 78870
TPG(1910, 30) = 78767
TPG(1910, 31) = 78657
TPG(1910, 32) = 78543
TPG(1910, 33) = 78422
TPG(1910, 34) = 78297
TPG(1910, 35) = 78165
TPG(1910, 36) = 78030
TPG(1910, 37) = 77887
TPG(1910, 38) = 77736
TPG(1910, 39) = 77574
TPG(1910, 40) = 77403
TPG(1910, 41) = 77221
TPG(1910, 42) = 77028
TPG(1910, 43) = 76823
TPG(1910, 44) = 76604
TPG(1910, 45) = 76370
TPG(1910, 46) = 76120
TPG(1910, 47) = 75854
TPG(1910, 48) = 75570
TPG(1910, 49) = 75271
TPG(1910, 50) = 74956
TPG(1910, 51) = 74624
TPG(1910, 52) = 74275
TPG(1910, 53) = 73906
TPG(1910, 54) = 73516
TPG(1910, 55) = 73103
TPG(1910, 56) = 72666
TPG(1910, 57) = 72204
TPG(1910, 58) = 71717
TPG(1910, 59) = 71198
TPG(1910, 60) = 70646
TPG(1910, 61) = 70061
TPG(1910, 62) = 69441
TPG(1910, 63) = 68787
TPG(1910, 64) = 68093
TPG(1910, 65) = 67359
TPG(1910, 66) = 66584
TPG(1910, 67) = 65765
TPG(1910, 68) = 64901
TPG(1910, 69) = 63973
TPG(1910, 70) = 62976
TPG(1910, 71) = 61905
TPG(1910, 72) = 60755
TPG(1910, 73) = 59520
TPG(1910, 74) = 58170
TPG(1910, 75) = 56695
TPG(1910, 76) = 55087
TPG(1910, 77) = 53336
TPG(1910, 78) = 51435
TPG(1910, 79) = 49381
TPG(1910, 80) = 47170
TPG(1910, 81) = 44800
TPG(1910, 82) = 42271
TPG(1910, 83) = 39589
TPG(1910, 84) = 36803
TPG(1910, 85) = 33928
TPG(1910, 86) = 30985
TPG(1910, 87) = 27998
TPG(1910, 88) = 24995
TPG(1910, 89) = 22051
TPG(1910, 90) = 19197
TPG(1910, 91) = 16464
TPG(1910, 92) = 13885
TPG(1910, 93) = 11490
TPG(1910, 94) = 9328
TPG(1910, 95) = 7414
TPG(1910, 96) = 5753
TPG(1910, 97) = 4345
TPG(1910, 98) = 3183
TPG(1910, 99) = 2252
TPG(1910, 100) = 1532
TPG(1910, 101) = 995
TPG(1910, 102) = 614
TPG(1910, 103) = 356
TPG(1910, 104) = 192
TPG(1910, 105) = 95
TPG(1910, 106) = 42
TPG(1910, 107) = 17
TPG(1910, 108) = 5
TPG(1910, 109) = 1
TPG(1910, 110) = 0
TPG(1910, 111) = 0
TPG(1910, 112) = 0
TPG(1910, 113) = 0
TPG(1910, 114) = 0
TPG(1910, 115) = 0
TPG(1910, 116) = 0
TPG(1910, 117) = 0
TPG(1911, 0) = 100000
TPG(1911, 1) = 87098
TPG(1911, 2) = 82874
TPG(1911, 3) = 81902
TPG(1911, 4) = 81345
TPG(1911, 5) = 81027
TPG(1911, 6) = 80941
TPG(1911, 7) = 80864
TPG(1911, 8) = 80796
TPG(1911, 9) = 80736
TPG(1911, 10) = 80681
TPG(1911, 11) = 80644
TPG(1911, 12) = 80606
TPG(1911, 13) = 80567
TPG(1911, 14) = 80526
TPG(1911, 15) = 80484
TPG(1911, 16) = 80443
TPG(1911, 17) = 80399
TPG(1911, 18) = 80351
TPG(1911, 19) = 80300
TPG(1911, 20) = 80245
TPG(1911, 21) = 80185
TPG(1911, 22) = 80121
TPG(1911, 23) = 80053
TPG(1911, 24) = 79980
TPG(1911, 25) = 79903
TPG(1911, 26) = 79821
TPG(1911, 27) = 79734
TPG(1911, 28) = 79642
TPG(1911, 29) = 79546
TPG(1911, 30) = 79443
TPG(1911, 31) = 79335
TPG(1911, 32) = 79221
TPG(1911, 33) = 79102
TPG(1911, 34) = 78977
TPG(1911, 35) = 78847
TPG(1911, 36) = 78713
TPG(1911, 37) = 78572
TPG(1911, 38) = 78421
TPG(1911, 39) = 78261
TPG(1911, 40) = 78092
TPG(1911, 41) = 77912
TPG(1911, 42) = 77720
TPG(1911, 43) = 77517
TPG(1911, 44) = 77299
TPG(1911, 45) = 77067
TPG(1911, 46) = 76820
TPG(1911, 47) = 76556
TPG(1911, 48) = 76274
TPG(1911, 49) = 75977
TPG(1911, 50) = 75665
TPG(1911, 51) = 75336
TPG(1911, 52) = 74989
TPG(1911, 53) = 74623
TPG(1911, 54) = 74235
TPG(1911, 55) = 73825
TPG(1911, 56) = 73392
TPG(1911, 57) = 72933
TPG(1911, 58) = 72450
TPG(1911, 59) = 71935
TPG(1911, 60) = 71388
TPG(1911, 61) = 70808
TPG(1911, 62) = 70195
TPG(1911, 63) = 69548
TPG(1911, 64) = 68862
TPG(1911, 65) = 68136
TPG(1911, 66) = 67368
TPG(1911, 67) = 66558
TPG(1911, 68) = 65703
TPG(1911, 69) = 64784
TPG(1911, 70) = 63796
TPG(1911, 71) = 62733
TPG(1911, 72) = 61591
TPG(1911, 73) = 60363
TPG(1911, 74) = 59019
TPG(1911, 75) = 57550
TPG(1911, 76) = 55946
TPG(1911, 77) = 54198
TPG(1911, 78) = 52298
TPG(1911, 79) = 50242
TPG(1911, 80) = 48027
TPG(1911, 81) = 45650
TPG(1911, 82) = 43111
TPG(1911, 83) = 40414
TPG(1911, 84) = 37610
TPG(1911, 85) = 34712
TPG(1911, 86) = 31740
TPG(1911, 87) = 28719
TPG(1911, 88) = 25677
TPG(1911, 89) = 22689
TPG(1911, 90) = 19787
TPG(1911, 91) = 17002
TPG(1911, 92) = 14368
TPG(1911, 93) = 11916
TPG(1911, 94) = 9697
TPG(1911, 95) = 7727
TPG(1911, 96) = 6013
TPG(1911, 97) = 4556
TPG(1911, 98) = 3349
TPG(1911, 99) = 2379
TPG(1911, 100) = 1625
TPG(1911, 101) = 1061
TPG(1911, 102) = 657
TPG(1911, 103) = 383
TPG(1911, 104) = 208
TPG(1911, 105) = 104
TPG(1911, 106) = 47
TPG(1911, 107) = 18
TPG(1911, 108) = 6
TPG(1911, 109) = 2
TPG(1911, 110) = 0
TPG(1911, 111) = 0
TPG(1911, 112) = 0
TPG(1911, 113) = 0
TPG(1911, 114) = 0
TPG(1911, 115) = 0
TPG(1911, 116) = 0
TPG(1911, 117) = 0
TPG(1912, 0) = 100000
TPG(1912, 1) = 87547
TPG(1912, 2) = 83455
TPG(1912, 3) = 82518
TPG(1912, 4) = 81986
TPG(1912, 5) = 81641
TPG(1912, 6) = 81556
TPG(1912, 7) = 81481
TPG(1912, 8) = 81414
TPG(1912, 9) = 81354
TPG(1912, 10) = 81300
TPG(1912, 11) = 81263
TPG(1912, 12) = 81226
TPG(1912, 13) = 81187
TPG(1912, 14) = 81147
TPG(1912, 15) = 81105
TPG(1912, 16) = 81064
TPG(1912, 17) = 81019
TPG(1912, 18) = 80972
TPG(1912, 19) = 80921
TPG(1912, 20) = 80865
TPG(1912, 21) = 80806
TPG(1912, 22) = 80742
TPG(1912, 23) = 80674
TPG(1912, 24) = 80601
TPG(1912, 25) = 80524
TPG(1912, 26) = 80443
TPG(1912, 27) = 80357
TPG(1912, 28) = 80266
TPG(1912, 29) = 80170
TPG(1912, 30) = 80069
TPG(1912, 31) = 79961
TPG(1912, 32) = 79849
TPG(1912, 33) = 79731
TPG(1912, 34) = 79607
TPG(1912, 35) = 79478
TPG(1912, 36) = 79346
TPG(1912, 37) = 79205
TPG(1912, 38) = 79056
TPG(1912, 39) = 78898
TPG(1912, 40) = 78730
TPG(1912, 41) = 78552
TPG(1912, 42) = 78362
TPG(1912, 43) = 78160
TPG(1912, 44) = 77945
TPG(1912, 45) = 77715
TPG(1912, 46) = 77470
TPG(1912, 47) = 77208
TPG(1912, 48) = 76929
TPG(1912, 49) = 76635
TPG(1912, 50) = 76325
TPG(1912, 51) = 75999
TPG(1912, 52) = 75654
TPG(1912, 53) = 75291
TPG(1912, 54) = 74907
TPG(1912, 55) = 74500
TPG(1912, 56) = 74070
TPG(1912, 57) = 73615
TPG(1912, 58) = 73136
TPG(1912, 59) = 72626
TPG(1912, 60) = 72084
TPG(1912, 61) = 71510
TPG(1912, 62) = 70904
TPG(1912, 63) = 70264
TPG(1912, 64) = 69586
TPG(1912, 65) = 68868
TPG(1912, 66) = 68109
TPG(1912, 67) = 67308
TPG(1912, 68) = 66463
TPG(1912, 69) = 65554
TPG(1912, 70) = 64575
TPG(1912, 71) = 63521
TPG(1912, 72) = 62388
TPG(1912, 73) = 61168
TPG(1912, 74) = 59831
TPG(1912, 75) = 58368
TPG(1912, 76) = 56770
TPG(1912, 77) = 55026
TPG(1912, 78) = 53128
TPG(1912, 79) = 51073
TPG(1912, 80) = 48857
TPG(1912, 81) = 46475
TPG(1912, 82) = 43927
TPG(1912, 83) = 41219
TPG(1912, 84) = 38398
TPG(1912, 85) = 35479
TPG(1912, 86) = 32482
TPG(1912, 87) = 29429
TPG(1912, 88) = 26351
TPG(1912, 89) = 23322
TPG(1912, 90) = 20373
TPG(1912, 91) = 17539
TPG(1912, 92) = 14851
TPG(1912, 93) = 12344
TPG(1912, 94) = 10070
TPG(1912, 95) = 8045
TPG(1912, 96) = 6278
TPG(1912, 97) = 4771
TPG(1912, 98) = 3519
TPG(1912, 99) = 2509
TPG(1912, 100) = 1720
TPG(1912, 101) = 1128
TPG(1912, 102) = 703
TPG(1912, 103) = 412
TPG(1912, 104) = 226
TPG(1912, 105) = 113
TPG(1912, 106) = 51
TPG(1912, 107) = 21
TPG(1912, 108) = 7
TPG(1912, 109) = 2
TPG(1912, 110) = 0
TPG(1912, 111) = 0
TPG(1912, 112) = 0
TPG(1912, 113) = 0
TPG(1912, 114) = 0
TPG(1912, 115) = 0
TPG(1912, 116) = 0
TPG(1912, 117) = 0
TPG(1913, 0) = 100000
TPG(1913, 1) = 87983
TPG(1913, 2) = 84019
TPG(1913, 3) = 83125
TPG(1913, 4) = 82566
TPG(1913, 5) = 82260
TPG(1913, 6) = 82176
TPG(1913, 7) = 82102
TPG(1913, 8) = 82035
TPG(1913, 9) = 81976
TPG(1913, 10) = 81923
TPG(1913, 11) = 81887
TPG(1913, 12) = 81850
TPG(1913, 13) = 81811
TPG(1913, 14) = 81771
TPG(1913, 15) = 81730
TPG(1913, 16) = 81688
TPG(1913, 17) = 81644
TPG(1913, 18) = 81597
TPG(1913, 19) = 81545
TPG(1913, 20) = 81490
TPG(1913, 21) = 81431
TPG(1913, 22) = 81367
TPG(1913, 23) = 81299
TPG(1913, 24) = 81227
TPG(1913, 25) = 81150
TPG(1913, 26) = 81070
TPG(1913, 27) = 80984
TPG(1913, 28) = 80894
TPG(1913, 29) = 80798
TPG(1913, 30) = 80698
TPG(1913, 31) = 80592
TPG(1913, 32) = 80480
TPG(1913, 33) = 80363
TPG(1913, 34) = 80241
TPG(1913, 35) = 80113
TPG(1913, 36) = 79982
TPG(1913, 37) = 79843
TPG(1913, 38) = 79696
TPG(1913, 39) = 79539
TPG(1913, 40) = 79373
TPG(1913, 41) = 79196
TPG(1913, 42) = 79008
TPG(1913, 43) = 78808
TPG(1913, 44) = 78595
TPG(1913, 45) = 78367
TPG(1913, 46) = 78124
TPG(1913, 47) = 77864
TPG(1913, 48) = 77588
TPG(1913, 49) = 77297
TPG(1913, 50) = 76989
TPG(1913, 51) = 76666
TPG(1913, 52) = 76324
TPG(1913, 53) = 75964
TPG(1913, 54) = 75582
TPG(1913, 55) = 75179
TPG(1913, 56) = 74752
TPG(1913, 57) = 74302
TPG(1913, 58) = 73826
TPG(1913, 59) = 73320
TPG(1913, 60) = 72784
TPG(1913, 61) = 72216
TPG(1913, 62) = 71616
TPG(1913, 63) = 70984
TPG(1913, 64) = 70314
TPG(1913, 65) = 69604
TPG(1913, 66) = 68854
TPG(1913, 67) = 68062
TPG(1913, 68) = 67227
TPG(1913, 69) = 66327
TPG(1913, 70) = 65357
TPG(1913, 71) = 64313
TPG(1913, 72) = 63188
TPG(1913, 73) = 61976
TPG(1913, 74) = 60647
TPG(1913, 75) = 59191
TPG(1913, 76) = 57598
TPG(1913, 77) = 55859
TPG(1913, 78) = 53964
TPG(1913, 79) = 51910
TPG(1913, 80) = 49691
TPG(1913, 81) = 47305
TPG(1913, 82) = 44750
TPG(1913, 83) = 42030
TPG(1913, 84) = 39194
TPG(1913, 85) = 36255
TPG(1913, 86) = 33232
TPG(1913, 87) = 30149
TPG(1913, 88) = 27034
TPG(1913, 89) = 23964
TPG(1913, 90) = 20970
TPG(1913, 91) = 18086
TPG(1913, 92) = 15345
TPG(1913, 93) = 12782
TPG(1913, 94) = 10452
TPG(1913, 95) = 8371
TPG(1913, 96) = 6551
TPG(1913, 97) = 4994
TPG(1913, 98) = 3696
TPG(1913, 99) = 2645
TPG(1913, 100) = 1821
TPG(1913, 101) = 1200
TPG(1913, 102) = 751
TPG(1913, 103) = 443
TPG(1913, 104) = 244
TPG(1913, 105) = 124
TPG(1913, 106) = 57
TPG(1913, 107) = 23
TPG(1913, 108) = 8
TPG(1913, 109) = 2
TPG(1913, 110) = 0
TPG(1913, 111) = 0
TPG(1913, 112) = 0
TPG(1913, 113) = 0
TPG(1913, 114) = 0
TPG(1913, 115) = 0
TPG(1913, 116) = 0
TPG(1913, 117) = 0
TPG(1914, 0) = 100000
TPG(1914, 1) = 88405
TPG(1914, 2) = 84568
TPG(1914, 3) = 83659
TPG(1914, 4) = 83153
TPG(1914, 5) = 82855
TPG(1914, 6) = 82773
TPG(1914, 7) = 82699
TPG(1914, 8) = 82634
TPG(1914, 9) = 82576
TPG(1914, 10) = 82523
TPG(1914, 11) = 82487
TPG(1914, 12) = 82450
TPG(1914, 13) = 82412
TPG(1914, 14) = 82373
TPG(1914, 15) = 82331
TPG(1914, 16) = 82290
TPG(1914, 17) = 82246
TPG(1914, 18) = 82198
TPG(1914, 19) = 82147
TPG(1914, 20) = 82092
TPG(1914, 21) = 82033
TPG(1914, 22) = 81969
TPG(1914, 23) = 81902
TPG(1914, 24) = 81830
TPG(1914, 25) = 81754
TPG(1914, 26) = 81673
TPG(1914, 27) = 81588
TPG(1914, 28) = 81499
TPG(1914, 29) = 81404
TPG(1914, 30) = 81305
TPG(1914, 31) = 81199
TPG(1914, 32) = 81089
TPG(1914, 33) = 80974
TPG(1914, 34) = 80853
TPG(1914, 35) = 80726
TPG(1914, 36) = 80596
TPG(1914, 37) = 80457
TPG(1914, 38) = 80311
TPG(1914, 39) = 80156
TPG(1914, 40) = 79992
TPG(1914, 41) = 79816
TPG(1914, 42) = 79630
TPG(1914, 43) = 79432
TPG(1914, 44) = 79221
TPG(1914, 45) = 78995
TPG(1914, 46) = 78754
TPG(1914, 47) = 78497
TPG(1914, 48) = 78223
TPG(1914, 49) = 77935
TPG(1914, 50) = 77630
TPG(1914, 51) = 77309
TPG(1914, 52) = 76970
TPG(1914, 53) = 76613
TPG(1914, 54) = 76235
TPG(1914, 55) = 75835
TPG(1914, 56) = 75412
TPG(1914, 57) = 74965
TPG(1914, 58) = 74493
TPG(1914, 59) = 73993
TPG(1914, 60) = 73462
TPG(1914, 61) = 72900
TPG(1914, 62) = 72307
TPG(1914, 63) = 71682
TPG(1914, 64) = 71020
TPG(1914, 65) = 70319
TPG(1914, 66) = 69578
TPG(1914, 67) = 68795
TPG(1914, 68) = 67970
TPG(1914, 69) = 67080
TPG(1914, 70) = 66120
TPG(1914, 71) = 65085
TPG(1914, 72) = 63969
TPG(1914, 73) = 62766
TPG(1914, 74) = 61445
TPG(1914, 75) = 59996
TPG(1914, 76) = 58410
TPG(1914, 77) = 56676
TPG(1914, 78) = 54784
TPG(1914, 79) = 52732
TPG(1914, 80) = 50513
TPG(1914, 81) = 48124
TPG(1914, 82) = 45563
TPG(1914, 83) = 42833
TPG(1914, 84) = 39983
TPG(1914, 85) = 37025
TPG(1914, 86) = 33979
TPG(1914, 87) = 30867
TPG(1914, 88) = 27718
TPG(1914, 89) = 24608
TPG(1914, 90) = 21570
TPG(1914, 91) = 18637
TPG(1914, 92) = 15844
TPG(1914, 93) = 13226
TPG(1914, 94) = 10840
TPG(1914, 95) = 8704
TPG(1914, 96) = 6830
TPG(1914, 97) = 5223
TPG(1914, 98) = 3878
TPG(1914, 99) = 2785
TPG(1914, 100) = 1926
TPG(1914, 101) = 1275
TPG(1914, 102) = 802
TPG(1914, 103) = 476
TPG(1914, 104) = 264
TPG(1914, 105) = 135
TPG(1914, 106) = 62
TPG(1914, 107) = 25
TPG(1914, 108) = 9
TPG(1914, 109) = 3
TPG(1914, 110) = 0
TPG(1914, 111) = 0
TPG(1914, 112) = 0
TPG(1914, 113) = 0
TPG(1914, 114) = 0
TPG(1914, 115) = 0
TPG(1914, 116) = 0
TPG(1914, 117) = 0
TPG(1915, 0) = 100000
TPG(1915, 1) = 88815
TPG(1915, 2) = 85100
TPG(1915, 3) = 84263
TPG(1915, 4) = 83774
TPG(1915, 5) = 83484
TPG(1915, 6) = 83403
TPG(1915, 7) = 83331
TPG(1915, 8) = 83266
TPG(1915, 9) = 83208
TPG(1915, 10) = 83157
TPG(1915, 11) = 83121
TPG(1915, 12) = 83085
TPG(1915, 13) = 83047
TPG(1915, 14) = 83007
TPG(1915, 15) = 82967
TPG(1915, 16) = 82926
TPG(1915, 17) = 82882
TPG(1915, 18) = 82834
TPG(1915, 19) = 82783
TPG(1915, 20) = 82728
TPG(1915, 21) = 82669
TPG(1915, 22) = 82605
TPG(1915, 23) = 82538
TPG(1915, 24) = 82467
TPG(1915, 25) = 82391
TPG(1915, 26) = 82311
TPG(1915, 27) = 82227
TPG(1915, 28) = 82138
TPG(1915, 29) = 82044
TPG(1915, 30) = 81945
TPG(1915, 31) = 81841
TPG(1915, 32) = 81732
TPG(1915, 33) = 81617
TPG(1915, 34) = 81498
TPG(1915, 35) = 81372
TPG(1915, 36) = 81241
TPG(1915, 37) = 81103
TPG(1915, 38) = 80958
TPG(1915, 39) = 80805
TPG(1915, 40) = 80641
TPG(1915, 41) = 80468
TPG(1915, 42) = 80283
TPG(1915, 43) = 80087
TPG(1915, 44) = 79877
TPG(1915, 45) = 79654
TPG(1915, 46) = 79415
TPG(1915, 47) = 79161
TPG(1915, 48) = 78889
TPG(1915, 49) = 78603
TPG(1915, 50) = 78302
TPG(1915, 51) = 77983
TPG(1915, 52) = 77647
TPG(1915, 53) = 77293
TPG(1915, 54) = 76917
TPG(1915, 55) = 76520
TPG(1915, 56) = 76101
TPG(1915, 57) = 75658
TPG(1915, 58) = 75190
TPG(1915, 59) = 74694
TPG(1915, 60) = 74169
TPG(1915, 61) = 73613
TPG(1915, 62) = 73026
TPG(1915, 63) = 72408
TPG(1915, 64) = 71754
TPG(1915, 65) = 71061
TPG(1915, 66) = 70329
TPG(1915, 67) = 69555
TPG(1915, 68) = 68739
TPG(1915, 69) = 67859
TPG(1915, 70) = 66908
TPG(1915, 71) = 65882
TPG(1915, 72) = 64775
TPG(1915, 73) = 63580
TPG(1915, 74) = 62267
TPG(1915, 75) = 60826
TPG(1915, 76) = 59246
TPG(1915, 77) = 57516
TPG(1915, 78) = 55628
TPG(1915, 79) = 53577
TPG(1915, 80) = 51358
TPG(1915, 81) = 48965
TPG(1915, 82) = 46398
TPG(1915, 83) = 43658
TPG(1915, 84) = 40793
TPG(1915, 85) = 37816
TPG(1915, 86) = 34746
TPG(1915, 87) = 31604
TPG(1915, 88) = 28420
TPG(1915, 89) = 25270
TPG(1915, 90) = 22187
TPG(1915, 91) = 19204
TPG(1915, 92) = 16359
TPG(1915, 93) = 13684
TPG(1915, 94) = 11242
TPG(1915, 95) = 9050
TPG(1915, 96) = 7121
TPG(1915, 97) = 5461
TPG(1915, 98) = 4068
TPG(1915, 99) = 2932
TPG(1915, 100) = 2036
TPG(1915, 101) = 1353
TPG(1915, 102) = 856
TPG(1915, 103) = 511
TPG(1915, 104) = 285
TPG(1915, 105) = 147
TPG(1915, 106) = 68
TPG(1915, 107) = 28
TPG(1915, 108) = 10
TPG(1915, 109) = 3
TPG(1915, 110) = 0
TPG(1915, 111) = 0
TPG(1915, 112) = 0
TPG(1915, 113) = 0
TPG(1915, 114) = 0
TPG(1915, 115) = 0
TPG(1915, 116) = 0
TPG(1915, 117) = 0
TPG(1916, 0) = 100000
TPG(1916, 1) = 89212
TPG(1916, 2) = 85617
TPG(1916, 3) = 84811
TPG(1916, 4) = 84338
TPG(1916, 5) = 84056
TPG(1916, 6) = 83976
TPG(1916, 7) = 83905
TPG(1916, 8) = 83841
TPG(1916, 9) = 83784
TPG(1916, 10) = 83733
TPG(1916, 11) = 83698
TPG(1916, 12) = 83662
TPG(1916, 13) = 83625
TPG(1916, 14) = 83586
TPG(1916, 15) = 83545
TPG(1916, 16) = 83504
TPG(1916, 17) = 83460
TPG(1916, 18) = 83413
TPG(1916, 19) = 83362
TPG(1916, 20) = 83307
TPG(1916, 21) = 83248
TPG(1916, 22) = 83184
TPG(1916, 23) = 83117
TPG(1916, 24) = 83046
TPG(1916, 25) = 82971
TPG(1916, 26) = 82891
TPG(1916, 27) = 82808
TPG(1916, 28) = 82720
TPG(1916, 29) = 82627
TPG(1916, 30) = 82529
TPG(1916, 31) = 82426
TPG(1916, 32) = 82318
TPG(1916, 33) = 82205
TPG(1916, 34) = 82086
TPG(1916, 35) = 81962
TPG(1916, 36) = 81832
TPG(1916, 37) = 81696
TPG(1916, 38) = 81553
TPG(1916, 39) = 81401
TPG(1916, 40) = 81239
TPG(1916, 41) = 81067
TPG(1916, 42) = 80884
TPG(1916, 43) = 80690
TPG(1916, 44) = 80482
TPG(1916, 45) = 80261
TPG(1916, 46) = 80025
TPG(1916, 47) = 79773
TPG(1916, 48) = 79504
TPG(1916, 49) = 79221
TPG(1916, 50) = 78922
TPG(1916, 51) = 78606
TPG(1916, 52) = 78273
TPG(1916, 53) = 77921
TPG(1916, 54) = 77549
TPG(1916, 55) = 77156
TPG(1916, 56) = 76740
TPG(1916, 57) = 76301
TPG(1916, 58) = 75838
TPG(1916, 59) = 75347
TPG(1916, 60) = 74827
TPG(1916, 61) = 74277
TPG(1916, 62) = 73697
TPG(1916, 63) = 73087
TPG(1916, 64) = 72441
TPG(1916, 65) = 71757
TPG(1916, 66) = 71034
TPG(1916, 67) = 70270
TPG(1916, 68) = 69464
TPG(1916, 69) = 68593
TPG(1916, 70) = 67653
TPG(1916, 71) = 66637
TPG(1916, 72) = 65539
TPG(1916, 73) = 64353
TPG(1916, 74) = 63049
TPG(1916, 75) = 61616
TPG(1916, 76) = 60043
TPG(1916, 77) = 58320
TPG(1916, 78) = 56436
TPG(1916, 79) = 54389
TPG(1916, 80) = 52171
TPG(1916, 81) = 49777
TPG(1916, 82) = 47206
TPG(1916, 83) = 44457
TPG(1916, 84) = 41581
TPG(1916, 85) = 38588
TPG(1916, 86) = 35496
TPG(1916, 87) = 32328
TPG(1916, 88) = 29111
TPG(1916, 89) = 25924
TPG(1916, 90) = 22798
TPG(1916, 91) = 19769
TPG(1916, 92) = 16872
TPG(1916, 93) = 14143
TPG(1916, 94) = 11645
TPG(1916, 95) = 9398
TPG(1916, 96) = 7415
TPG(1916, 97) = 5703
TPG(1916, 98) = 4263
TPG(1916, 99) = 3084
TPG(1916, 100) = 2149
TPG(1916, 101) = 1435
TPG(1916, 102) = 912
TPG(1916, 103) = 548
TPG(1916, 104) = 307
TPG(1916, 105) = 159
TPG(1916, 106) = 75
TPG(1916, 107) = 31
TPG(1916, 108) = 11
TPG(1916, 109) = 3
TPG(1916, 110) = 0
TPG(1916, 111) = 0
TPG(1916, 112) = 0
TPG(1916, 113) = 0
TPG(1916, 114) = 0
TPG(1916, 115) = 0
TPG(1916, 116) = 0
TPG(1916, 117) = 0
TPG(1943, 0) = 100000
TPG(1943, 1) = 96115
TPG(1943, 2) = 94743
TPG(1943, 3) = 94471
TPG(1943, 4) = 94289
TPG(1943, 5) = 94166
TPG(1943, 6) = 94119
TPG(1943, 7) = 94075
TPG(1943, 8) = 94035
TPG(1943, 9) = 93998
TPG(1943, 10) = 93964
TPG(1943, 11) = 93941
TPG(1943, 12) = 93916
TPG(1943, 13) = 93888
TPG(1943, 14) = 93859
TPG(1943, 15) = 93826
TPG(1943, 16) = 93791
TPG(1943, 17) = 93753
TPG(1943, 18) = 93710
TPG(1943, 19) = 93665
TPG(1943, 20) = 93618
TPG(1943, 21) = 93567
TPG(1943, 22) = 93514
TPG(1943, 23) = 93457
TPG(1943, 24) = 93399
TPG(1943, 25) = 93339
TPG(1943, 26) = 93277
TPG(1943, 27) = 93213
TPG(1943, 28) = 93147
TPG(1943, 29) = 93079
TPG(1943, 30) = 93008
TPG(1943, 31) = 92934
TPG(1943, 32) = 92858
TPG(1943, 33) = 92779
TPG(1943, 34) = 92697
TPG(1943, 35) = 92609
TPG(1943, 36) = 92518
TPG(1943, 37) = 92421
TPG(1943, 38) = 92319
TPG(1943, 39) = 92211
TPG(1943, 40) = 92096
TPG(1943, 41) = 91974
TPG(1943, 42) = 91844
TPG(1943, 43) = 91705
TPG(1943, 44) = 91558
TPG(1943, 45) = 91401
TPG(1943, 46) = 91233
TPG(1943, 47) = 91054
TPG(1943, 48) = 90864
TPG(1943, 49) = 90661
TPG(1943, 50) = 90446
TPG(1943, 51) = 90218
TPG(1943, 52) = 89974
TPG(1943, 53) = 89715
TPG(1943, 54) = 89443
TPG(1943, 55) = 89156
TPG(1943, 56) = 88854
TPG(1943, 57) = 88538
TPG(1943, 58) = 88205
TPG(1943, 59) = 87859
TPG(1943, 60) = 87499
TPG(1943, 61) = 87126
TPG(1943, 62) = 86739
TPG(1943, 63) = 86340
TPG(1943, 64) = 85917
TPG(1943, 65) = 85470
TPG(1943, 66) = 84998
TPG(1943, 67) = 84500
TPG(1943, 68) = 83975
TPG(1943, 69) = 83395
TPG(1943, 70) = 82754
TPG(1943, 71) = 82045
TPG(1943, 72) = 81260
TPG(1943, 73) = 80391
TPG(1943, 74) = 79413
TPG(1943, 75) = 78312
TPG(1943, 76) = 77073
TPG(1943, 77) = 75680
TPG(1943, 78) = 74116
TPG(1943, 79) = 72377
TPG(1943, 80) = 70447
TPG(1943, 81) = 68311
TPG(1943, 82) = 65954
TPG(1943, 83) = 63361
TPG(1943, 84) = 60566
TPG(1943, 85) = 57566
TPG(1943, 86) = 54360
TPG(1943, 87) = 50957
TPG(1943, 88) = 47366
TPG(1943, 89) = 43660
TPG(1943, 90) = 39864
TPG(1943, 91) = 36010
TPG(1943, 92) = 32137
TPG(1943, 93) = 28289
TPG(1943, 94) = 24566
TPG(1943, 95) = 21011
TPG(1943, 96) = 17666
TPG(1943, 97) = 14570
TPG(1943, 98) = 11760
TPG(1943, 99) = 9261
TPG(1943, 100) = 7092
TPG(1943, 101) = 5262
TPG(1943, 102) = 3764
TPG(1943, 103) = 2582
TPG(1943, 104) = 1687
TPG(1943, 105) = 1041
TPG(1943, 106) = 601
TPG(1943, 107) = 320
TPG(1943, 108) = 155
TPG(1943, 109) = 66
TPG(1943, 110) = 24
TPG(1943, 111) = 7
TPG(1943, 112) = 2
TPG(1943, 113) = 0
TPG(1943, 114) = 0
TPG(1943, 115) = 0
TPG(1943, 116) = 0
TPG(1943, 117) = 0
TPG(1944, 0) = 100000
TPG(1944, 1) = 96263
TPG(1944, 2) = 94942
TPG(1944, 3) = 94681
TPG(1944, 4) = 94506
TPG(1944, 5) = 94387
TPG(1944, 6) = 94341
TPG(1944, 7) = 94298
TPG(1944, 8) = 94259
TPG(1944, 9) = 94223
TPG(1944, 10) = 94189
TPG(1944, 11) = 94166
TPG(1944, 12) = 94141
TPG(1944, 13) = 94115
TPG(1944, 14) = 94085
TPG(1944, 15) = 94053
TPG(1944, 16) = 94019
TPG(1944, 17) = 93980
TPG(1944, 18) = 93938
TPG(1944, 19) = 93894
TPG(1944, 20) = 93846
TPG(1944, 21) = 93796
TPG(1944, 22) = 93743
TPG(1944, 23) = 93687
TPG(1944, 24) = 93629
TPG(1944, 25) = 93569
TPG(1944, 26) = 93508
TPG(1944, 27) = 93445
TPG(1944, 28) = 93380
TPG(1944, 29) = 93313
TPG(1944, 30) = 93243
TPG(1944, 31) = 93170
TPG(1944, 32) = 93095
TPG(1944, 33) = 93018
TPG(1944, 34) = 92936
TPG(1944, 35) = 92850
TPG(1944, 36) = 92760
TPG(1944, 37) = 92664
TPG(1944, 38) = 92564
TPG(1944, 39) = 92458
TPG(1944, 40) = 92344
TPG(1944, 41) = 92224
TPG(1944, 42) = 92095
TPG(1944, 43) = 91959
TPG(1944, 44) = 91814
TPG(1944, 45) = 91659
TPG(1944, 46) = 91494
TPG(1944, 47) = 91318
TPG(1944, 48) = 91130
TPG(1944, 49) = 90931
TPG(1944, 50) = 90718
TPG(1944, 51) = 90493
TPG(1944, 52) = 90253
TPG(1944, 53) = 89997
TPG(1944, 54) = 89728
TPG(1944, 55) = 89446
TPG(1944, 56) = 89148
TPG(1944, 57) = 88836
TPG(1944, 58) = 88508
TPG(1944, 59) = 88168
TPG(1944, 60) = 87813
TPG(1944, 61) = 87446
TPG(1944, 62) = 87066
TPG(1944, 63) = 86673
TPG(1944, 64) = 86258
TPG(1944, 65) = 85819
TPG(1944, 66) = 85356
TPG(1944, 67) = 84867
TPG(1944, 68) = 84352
TPG(1944, 69) = 83782
TPG(1944, 70) = 83152
TPG(1944, 71) = 82454
TPG(1944, 72) = 81681
TPG(1944, 73) = 80824
TPG(1944, 74) = 79859
TPG(1944, 75) = 78772
TPG(1944, 76) = 77548
TPG(1944, 77) = 76170
TPG(1944, 78) = 74622
TPG(1944, 79) = 72900
TPG(1944, 80) = 70987
TPG(1944, 81) = 68867
TPG(1944, 82) = 66526
TPG(1944, 83) = 63949
TPG(1944, 84) = 61168
TPG(1944, 85) = 58180
TPG(1944, 86) = 54985
TPG(1944, 87) = 51587
TPG(1944, 88) = 47999
TPG(1944, 89) = 44290
TPG(1944, 90) = 40487
TPG(1944, 91) = 36620
TPG(1944, 92) = 32727
TPG(1944, 93) = 28852
TPG(1944, 94) = 25097
TPG(1944, 95) = 21505
TPG(1944, 96) = 18118
TPG(1944, 97) = 14977
TPG(1944, 98) = 12118
TPG(1944, 99) = 9569
TPG(1944, 100) = 7350
TPG(1944, 101) = 5472
TPG(1944, 102) = 3929
TPG(1944, 103) = 2706
TPG(1944, 104) = 1777
TPG(1944, 105) = 1103
TPG(1944, 106) = 641
TPG(1944, 107) = 344
TPG(1944, 108) = 168
TPG(1944, 109) = 73
TPG(1944, 110) = 27
TPG(1944, 111) = 8
TPG(1944, 112) = 2
TPG(1944, 113) = 0
TPG(1944, 114) = 0
TPG(1944, 115) = 0
TPG(1944, 116) = 0
TPG(1944, 117) = 0
TPG(1968, 0) = 100000
TPG(1968, 1) = 98556
TPG(1968, 2) = 98033
TPG(1968, 3) = 97939
TPG(1968, 4) = 97869
TPG(1968, 5) = 97816
TPG(1968, 6) = 97789
TPG(1968, 7) = 97763
TPG(1968, 8) = 97738
TPG(1968, 9) = 97715
TPG(1968, 10) = 97693
TPG(1968, 11) = 97678
TPG(1968, 12) = 97662
TPG(1968, 13) = 97643
TPG(1968, 14) = 97621
TPG(1968, 15) = 97597
TPG(1968, 16) = 97569
TPG(1968, 17) = 97538
TPG(1968, 18) = 97502
TPG(1968, 19) = 97465
TPG(1968, 20) = 97425
TPG(1968, 21) = 97384
TPG(1968, 22) = 97341
TPG(1968, 23) = 97296
TPG(1968, 24) = 97251
TPG(1968, 25) = 97205
TPG(1968, 26) = 97159
TPG(1968, 27) = 97112
TPG(1968, 28) = 97065
TPG(1968, 29) = 97017
TPG(1968, 30) = 96968
TPG(1968, 31) = 96917
TPG(1968, 32) = 96866
TPG(1968, 33) = 96813
TPG(1968, 34) = 96758
TPG(1968, 35) = 96699
TPG(1968, 36) = 96637
TPG(1968, 37) = 96571
TPG(1968, 38) = 96502
TPG(1968, 39) = 96429
TPG(1968, 40) = 96351
TPG(1968, 41) = 96267
TPG(1968, 42) = 96179
TPG(1968, 43) = 96085
TPG(1968, 44) = 95985
TPG(1968, 45) = 95879
TPG(1968, 46) = 95765
TPG(1968, 47) = 95644
TPG(1968, 48) = 95516
TPG(1968, 49) = 95378
TPG(1968, 50) = 95231
TPG(1968, 51) = 95073
TPG(1968, 52) = 94905
TPG(1968, 53) = 94724
TPG(1968, 54) = 94535
TPG(1968, 55) = 94337
TPG(1968, 56) = 94130
TPG(1968, 57) = 93913
TPG(1968, 58) = 93687
TPG(1968, 59) = 93456
TPG(1968, 60) = 93221
TPG(1968, 61) = 92981
TPG(1968, 62) = 92736
TPG(1968, 63) = 92488
TPG(1968, 64) = 92226
TPG(1968, 65) = 91951
TPG(1968, 66) = 91660
TPG(1968, 67) = 91355
TPG(1968, 68) = 91034
TPG(1968, 69) = 90673
TPG(1968, 70) = 90266
TPG(1968, 71) = 89807
TPG(1968, 72) = 89289
TPG(1968, 73) = 88704
TPG(1968, 74) = 88033
TPG(1968, 75) = 87263
TPG(1968, 76) = 86379
TPG(1968, 77) = 85366
TPG(1968, 78) = 84204
TPG(1968, 79) = 82890
TPG(1968, 80) = 81406
TPG(1968, 81) = 79732
TPG(1968, 82) = 77849
TPG(1968, 83) = 75734
TPG(1968, 84) = 73406
TPG(1968, 85) = 70850
TPG(1968, 86) = 68055
TPG(1968, 87) = 65010
TPG(1968, 88) = 61709
TPG(1968, 89) = 58203
TPG(1968, 90) = 54501
TPG(1968, 91) = 50617
TPG(1968, 92) = 46573
TPG(1968, 93) = 42400
TPG(1968, 94) = 38203
TPG(1968, 95) = 34026
TPG(1968, 96) = 29913
TPG(1968, 97) = 25916
TPG(1968, 98) = 22086
TPG(1968, 99) = 18474
TPG(1968, 100) = 15131
TPG(1968, 101) = 12099
TPG(1968, 102) = 9414
TPG(1968, 103) = 7100
TPG(1968, 104) = 5166
TPG(1968, 105) = 3605
TPG(1968, 106) = 2398
TPG(1968, 107) = 1507
TPG(1968, 108) = 886
TPG(1968, 109) = 480
TPG(1968, 110) = 236
TPG(1968, 111) = 103
TPG(1968, 112) = 38
TPG(1968, 113) = 12
TPG(1968, 114) = 3
TPG(1968, 115) = 0
TPG(1968, 116) = 0
TPG(1968, 117) = 0
TPG(1982, 0) = 100000
TPG(1982, 1) = 99176
TPG(1982, 2) = 98876
TPG(1982, 3) = 98825
TPG(1982, 4) = 98784
TPG(1982, 5) = 98752
TPG(1982, 6) = 98732
TPG(1982, 7) = 98712
TPG(1982, 8) = 98694
TPG(1982, 9) = 98677
TPG(1982, 10) = 98660
TPG(1982, 11) = 98648
TPG(1982, 12) = 98635
TPG(1982, 13) = 98620
TPG(1982, 14) = 98602
TPG(1982, 15) = 98582
TPG(1982, 16) = 98558
TPG(1982, 17) = 98530
TPG(1982, 18) = 98498
TPG(1982, 19) = 98464
TPG(1982, 20) = 98429
TPG(1982, 21) = 98393
TPG(1982, 22) = 98355
TPG(1982, 23) = 98317
TPG(1982, 24) = 98278
TPG(1982, 25) = 98239
TPG(1982, 26) = 98200
TPG(1982, 27) = 98161
TPG(1982, 28) = 98123
TPG(1982, 29) = 98084
TPG(1982, 30) = 98044
TPG(1982, 31) = 98004
TPG(1982, 32) = 97963
TPG(1982, 33) = 97922
TPG(1982, 34) = 97878
TPG(1982, 35) = 97831
TPG(1982, 36) = 97782
TPG(1982, 37) = 97730
TPG(1982, 38) = 97675
TPG(1982, 39) = 97617
TPG(1982, 40) = 97554
TPG(1982, 41) = 97488
TPG(1982, 42) = 97418
TPG(1982, 43) = 97343
TPG(1982, 44) = 97264
TPG(1982, 45) = 97179
TPG(1982, 46) = 97089
TPG(1982, 47) = 96994
TPG(1982, 48) = 96892
TPG(1982, 49) = 96783
TPG(1982, 50) = 96665
TPG(1982, 51) = 96539
TPG(1982, 52) = 96404
TPG(1982, 53) = 96258
TPG(1982, 54) = 96106
TPG(1982, 55) = 95947
TPG(1982, 56) = 95782
TPG(1982, 57) = 95610
TPG(1982, 58) = 95431
TPG(1982, 59) = 95250
TPG(1982, 60) = 95066
TPG(1982, 61) = 94882
TPG(1982, 62) = 94696
TPG(1982, 63) = 94509
TPG(1982, 64) = 94312
TPG(1982, 65) = 94106
TPG(1982, 66) = 93889
TPG(1982, 67) = 93661
TPG(1982, 68) = 93422
TPG(1982, 69) = 93150
TPG(1982, 70) = 92841
TPG(1982, 71) = 92489
TPG(1982, 72) = 92087
TPG(1982, 73) = 91629
TPG(1982, 74) = 91098
TPG(1982, 75) = 90483
TPG(1982, 76) = 89771
TPG(1982, 77) = 88945
TPG(1982, 78) = 87987
TPG(1982, 79) = 86896
TPG(1982, 80) = 85653
TPG(1982, 81) = 84239
TPG(1982, 82) = 82632
TPG(1982, 83) = 80810
TPG(1982, 84) = 78785
TPG(1982, 85) = 76538
TPG(1982, 86) = 74054
TPG(1982, 87) = 71316
TPG(1982, 88) = 68311
TPG(1982, 89) = 65076
TPG(1982, 90) = 61612
TPG(1982, 91) = 57923
TPG(1982, 92) = 54020
TPG(1982, 93) = 49920
TPG(1982, 94) = 45726
TPG(1982, 95) = 41472
TPG(1982, 96) = 37198
TPG(1982, 97) = 32951
TPG(1982, 98) = 28780
TPG(1982, 99) = 24742
TPG(1982, 100) = 20891
TPG(1982, 101) = 17284
TPG(1982, 102) = 13972
TPG(1982, 103) = 11001
TPG(1982, 104) = 8403
TPG(1982, 105) = 6199
TPG(1982, 106) = 4393
TPG(1982, 107) = 2970
TPG(1982, 108) = 1901
TPG(1982, 109) = 1140
TPG(1982, 110) = 633
TPG(1982, 111) = 320
TPG(1982, 112) = 144
TPG(1982, 113) = 56
TPG(1982, 114) = 18
TPG(1982, 115) = 4
TPG(1982, 116) = 1
TPG(1982, 117) = 0
TPG(1929, 0) = 100000
TPG(1929, 1) = 93340
TPG(1929, 2) = 91044
TPG(1929, 3) = 90560
TPG(1929, 4) = 90257
TPG(1929, 5) = 90065
TPG(1929, 6) = 90002
TPG(1929, 7) = 89945
TPG(1929, 8) = 89894
TPG(1929, 9) = 89847
TPG(1929, 10) = 89804
TPG(1929, 11) = 89775
TPG(1929, 12) = 89744
TPG(1929, 13) = 89711
TPG(1929, 14) = 89677
TPG(1929, 15) = 89640
TPG(1929, 16) = 89600
TPG(1929, 17) = 89558
TPG(1929, 18) = 89512
TPG(1929, 19) = 89463
TPG(1929, 20) = 89411
TPG(1929, 21) = 89354
TPG(1929, 22) = 89296
TPG(1929, 23) = 89233
TPG(1929, 24) = 89167
TPG(1929, 25) = 89099
TPG(1929, 26) = 89027
TPG(1929, 27) = 88952
TPG(1929, 28) = 88875
TPG(1929, 29) = 88794
TPG(1929, 30) = 88709
TPG(1929, 31) = 88620
TPG(1929, 32) = 88528
TPG(1929, 33) = 88432
TPG(1929, 34) = 88330
TPG(1929, 35) = 88224
TPG(1929, 36) = 88113
TPG(1929, 37) = 87995
TPG(1929, 38) = 87872
TPG(1929, 39) = 87741
TPG(1929, 40) = 87602
TPG(1929, 41) = 87454
TPG(1929, 42) = 87296
TPG(1929, 43) = 87129
TPG(1929, 44) = 86950
TPG(1929, 45) = 86759
TPG(1929, 46) = 86556
TPG(1929, 47) = 86339
TPG(1929, 48) = 86108
TPG(1929, 49) = 85863
TPG(1929, 50) = 85604
TPG(1929, 51) = 85329
TPG(1929, 52) = 85038
TPG(1929, 53) = 84730
TPG(1929, 54) = 84405
TPG(1929, 55) = 84061
TPG(1929, 56) = 83699
TPG(1929, 57) = 83318
TPG(1929, 58) = 82917
TPG(1929, 59) = 82495
TPG(1929, 60) = 82052
TPG(1929, 61) = 81588
TPG(1929, 62) = 81102
TPG(1929, 63) = 80596
TPG(1929, 64) = 80059
TPG(1929, 65) = 79492
TPG(1929, 66) = 78892
TPG(1929, 67) = 78259
TPG(1929, 68) = 77590
TPG(1929, 69) = 76860
TPG(1929, 70) = 76062
TPG(1929, 71) = 75190
TPG(1929, 72) = 74236
TPG(1929, 73) = 73193
TPG(1929, 74) = 72032
TPG(1929, 75) = 70740
TPG(1929, 76) = 69305
TPG(1929, 77) = 67712
TPG(1929, 78) = 65947
TPG(1929, 79) = 64006
TPG(1929, 80) = 61877
TPG(1929, 81) = 59550
TPG(1929, 82) = 57014
TPG(1929, 83) = 54264
TPG(1929, 84) = 51341
TPG(1929, 85) = 48251
TPG(1929, 86) = 45002
TPG(1929, 87) = 41611
TPG(1929, 88) = 38100
TPG(1929, 89) = 34546
TPG(1929, 90) = 30982
TPG(1929, 91) = 27444
TPG(1929, 92) = 23973
TPG(1929, 93) = 20612
TPG(1929, 94) = 17446
TPG(1929, 95) = 14509
TPG(1929, 96) = 11829
TPG(1929, 97) = 9433
TPG(1929, 98) = 7334
TPG(1929, 99) = 5543
TPG(1929, 100) = 4055
TPG(1929, 101) = 2858
TPG(1929, 102) = 1931
TPG(1929, 103) = 1241
TPG(1929, 104) = 753
TPG(1929, 105) = 427
TPG(1929, 106) = 223
TPG(1929, 107) = 106
TPG(1929, 108) = 45
TPG(1929, 109) = 16
TPG(1929, 110) = 5
TPG(1929, 111) = 1
TPG(1929, 112) = 0
TPG(1929, 113) = 0
TPG(1929, 114) = 0
TPG(1929, 115) = 0
TPG(1929, 116) = 0
TPG(1929, 117) = 0
TPG(1930, 0) = 100000
TPG(1930, 1) = 93588
TPG(1930, 2) = 91373
TPG(1930, 3) = 90908
TPG(1930, 4) = 90615
TPG(1930, 5) = 90430
TPG(1930, 6) = 90368
TPG(1930, 7) = 90312
TPG(1930, 8) = 90261
TPG(1930, 9) = 90215
TPG(1930, 10) = 90173
TPG(1930, 11) = 90144
TPG(1930, 12) = 90114
TPG(1930, 13) = 90082
TPG(1930, 14) = 90048
TPG(1930, 15) = 90011
TPG(1930, 16) = 89971
TPG(1930, 17) = 89929
TPG(1930, 18) = 89883
TPG(1930, 19) = 89835
TPG(1930, 20) = 89783
TPG(1930, 21) = 89728
TPG(1930, 22) = 89669
TPG(1930, 23) = 89607
TPG(1930, 24) = 89542
TPG(1930, 25) = 89474
TPG(1930, 26) = 89403
TPG(1930, 27) = 89329
TPG(1930, 28) = 89252
TPG(1930, 29) = 89172
TPG(1930, 30) = 89088
TPG(1930, 31) = 89001
TPG(1930, 32) = 88910
TPG(1930, 33) = 88815
TPG(1930, 34) = 88715
TPG(1930, 35) = 88610
TPG(1930, 36) = 88500
TPG(1930, 37) = 88384
TPG(1930, 38) = 88263
TPG(1930, 39) = 88133
TPG(1930, 40) = 87996
TPG(1930, 41) = 87849
TPG(1930, 42) = 87694
TPG(1930, 43) = 87528
TPG(1930, 44) = 87352
TPG(1930, 45) = 87164
TPG(1930, 46) = 86963
TPG(1930, 47) = 86749
TPG(1930, 48) = 86521
TPG(1930, 49) = 86279
TPG(1930, 50) = 86023
TPG(1930, 51) = 85752
TPG(1930, 52) = 85464
TPG(1930, 53) = 85159
TPG(1930, 54) = 84838
TPG(1930, 55) = 84498
TPG(1930, 56) = 84141
TPG(1930, 57) = 83764
TPG(1930, 58) = 83368
TPG(1930, 59) = 82951
TPG(1930, 60) = 82514
TPG(1930, 61) = 82057
TPG(1930, 62) = 81579
TPG(1930, 63) = 81080
TPG(1930, 64) = 80552
TPG(1930, 65) = 79994
TPG(1930, 66) = 79404
TPG(1930, 67) = 78780
TPG(1930, 68) = 78122
TPG(1930, 69) = 77403
TPG(1930, 70) = 76617
TPG(1930, 71) = 75756
TPG(1930, 72) = 74814
TPG(1930, 73) = 73783
TPG(1930, 74) = 72635
TPG(1930, 75) = 71356
TPG(1930, 76) = 69934
TPG(1930, 77) = 68354
TPG(1930, 78) = 66602
TPG(1930, 79) = 64673
TPG(1930, 80) = 62555
TPG(1930, 81) = 60238
TPG(1930, 82) = 57711
TPG(1930, 83) = 54968
TPG(1930, 84) = 52048
TPG(1930, 85) = 48958
TPG(1930, 86) = 45706
TPG(1930, 87) = 42308
TPG(1930, 88) = 38783
TPG(1930, 89) = 35210
TPG(1930, 90) = 31621
TPG(1930, 91) = 28052
TPG(1930, 92) = 24545
TPG(1930, 93) = 21142
TPG(1930, 94) = 17930
TPG(1930, 95) = 14943
TPG(1930, 96) = 12212
TPG(1930, 97) = 9763
TPG(1930, 98) = 7613
TPG(1930, 99) = 5771
TPG(1930, 100) = 4237
TPG(1930, 101) = 2998
TPG(1930, 102) = 2034
TPG(1930, 103) = 1314
TPG(1930, 104) = 802
TPG(1930, 105) = 458
TPG(1930, 106) = 241
TPG(1930, 107) = 115
TPG(1930, 108) = 49
TPG(1930, 109) = 18
TPG(1930, 110) = 5
TPG(1930, 111) = 1
TPG(1930, 112) = 0
TPG(1930, 113) = 0
TPG(1930, 114) = 0
TPG(1930, 115) = 0
TPG(1930, 116) = 0
TPG(1930, 117) = 0
TPG(1957, 0) = 100000
TPG(1957, 1) = 97761
TPG(1957, 2) = 96958
TPG(1957, 3) = 96808
TPG(1957, 4) = 96701
TPG(1957, 5) = 96623
TPG(1957, 6) = 96588
TPG(1957, 7) = 96556
TPG(1957, 8) = 96525
TPG(1957, 9) = 96497
TPG(1957, 10) = 96470
TPG(1957, 11) = 96452
TPG(1957, 12) = 96431
TPG(1957, 13) = 96408
TPG(1957, 14) = 96384
TPG(1957, 15) = 96356
TPG(1957, 16) = 96325
TPG(1957, 17) = 96291
TPG(1957, 18) = 96252
TPG(1957, 19) = 96211
TPG(1957, 20) = 96168
TPG(1957, 21) = 96123
TPG(1957, 22) = 96075
TPG(1957, 23) = 96025
TPG(1957, 24) = 95974
TPG(1957, 25) = 95922
TPG(1957, 26) = 95869
TPG(1957, 27) = 95816
TPG(1957, 28) = 95761
TPG(1957, 29) = 95705
TPG(1957, 30) = 95647
TPG(1957, 31) = 95587
TPG(1957, 32) = 95525
TPG(1957, 33) = 95462
TPG(1957, 34) = 95396
TPG(1957, 35) = 95325
TPG(1957, 36) = 95251
TPG(1957, 37) = 95173
TPG(1957, 38) = 95091
TPG(1957, 39) = 95003
TPG(1957, 40) = 94910
TPG(1957, 41) = 94811
TPG(1957, 42) = 94706
TPG(1957, 43) = 94594
TPG(1957, 44) = 94475
TPG(1957, 45) = 94348
TPG(1957, 46) = 94212
TPG(1957, 47) = 94068
TPG(1957, 48) = 93915
TPG(1957, 49) = 93751
TPG(1957, 50) = 93576
TPG(1957, 51) = 93389
TPG(1957, 52) = 93190
TPG(1957, 53) = 92977
TPG(1957, 54) = 92754
TPG(1957, 55) = 92519
TPG(1957, 56) = 92274
TPG(1957, 57) = 92017
TPG(1957, 58) = 91747
TPG(1957, 59) = 91470
TPG(1957, 60) = 91184
TPG(1957, 61) = 90891
TPG(1957, 62) = 90590
TPG(1957, 63) = 90282
TPG(1957, 64) = 89957
TPG(1957, 65) = 89614
TPG(1957, 66) = 89252
TPG(1957, 67) = 88871
TPG(1957, 68) = 88470
TPG(1957, 69) = 88021
TPG(1957, 70) = 87520
TPG(1957, 71) = 86960
TPG(1957, 72) = 86334
TPG(1957, 73) = 85632
TPG(1957, 74) = 84833
TPG(1957, 75) = 83924
TPG(1957, 76) = 82890
TPG(1957, 77) = 81713
TPG(1957, 78) = 80376
TPG(1957, 79) = 78875
TPG(1957, 80) = 77191
TPG(1957, 81) = 75308
TPG(1957, 82) = 73205
TPG(1957, 83) = 70864
TPG(1957, 84) = 68308
TPG(1957, 85) = 65529
TPG(1957, 86) = 62518
TPG(1957, 87) = 59273
TPG(1957, 88) = 55794
TPG(1957, 89) = 52141
TPG(1957, 90) = 48332
TPG(1957, 91) = 44389
TPG(1957, 92) = 40342
TPG(1957, 93) = 36230
TPG(1957, 94) = 32160
TPG(1957, 95) = 28176
TPG(1957, 96) = 24326
TPG(1957, 97) = 20658
TPG(1957, 98) = 17219
TPG(1957, 99) = 14053
TPG(1957, 100) = 11199
TPG(1957, 101) = 8685
TPG(1957, 102) = 6530
TPG(1957, 103) = 4738
TPG(1957, 104) = 3299
TPG(1957, 105) = 2190
TPG(1957, 106) = 1375
TPG(1957, 107) = 809
TPG(1957, 108) = 439
TPG(1957, 109) = 217
TPG(1957, 110) = 95
TPG(1957, 111) = 36
TPG(1957, 112) = 11
TPG(1957, 113) = 3
TPG(1957, 114) = 0
TPG(1957, 115) = 0
TPG(1957, 116) = 0
TPG(1957, 117) = 0
TPG(1958, 0) = 100000
TPG(1958, 1) = 97848
TPG(1958, 2) = 97075
TPG(1958, 3) = 96932
TPG(1958, 4) = 96829
TPG(1958, 5) = 96754
TPG(1958, 6) = 96720
TPG(1958, 7) = 96688
TPG(1958, 8) = 96658
TPG(1958, 9) = 96630
TPG(1958, 10) = 96604
TPG(1958, 11) = 96585
TPG(1958, 12) = 96565
TPG(1958, 13) = 96543
TPG(1958, 14) = 96519
TPG(1958, 15) = 96491
TPG(1958, 16) = 96461
TPG(1958, 17) = 96427
TPG(1958, 18) = 96388
TPG(1958, 19) = 96348
TPG(1958, 20) = 96305
TPG(1958, 21) = 96260
TPG(1958, 22) = 96213
TPG(1958, 23) = 96163
TPG(1958, 24) = 96113
TPG(1958, 25) = 96062
TPG(1958, 26) = 96009
TPG(1958, 27) = 95956
TPG(1958, 28) = 95902
TPG(1958, 29) = 95847
TPG(1958, 30) = 95789
TPG(1958, 31) = 95731
TPG(1958, 32) = 95670
TPG(1958, 33) = 95608
TPG(1958, 34) = 95542
TPG(1958, 35) = 95473
TPG(1958, 36) = 95401
TPG(1958, 37) = 95324
TPG(1958, 38) = 95243
TPG(1958, 39) = 95156
TPG(1958, 40) = 95065
TPG(1958, 41) = 94967
TPG(1958, 42) = 94864
TPG(1958, 43) = 94753
TPG(1958, 44) = 94636
TPG(1958, 45) = 94511
TPG(1958, 46) = 94378
TPG(1958, 47) = 94236
TPG(1958, 48) = 94085
TPG(1958, 49) = 93923
TPG(1958, 50) = 93751
TPG(1958, 51) = 93567
TPG(1958, 52) = 93371
TPG(1958, 53) = 93161
TPG(1958, 54) = 92941
TPG(1958, 55) = 92710
TPG(1958, 56) = 92468
TPG(1958, 57) = 92215
TPG(1958, 58) = 91950
TPG(1958, 59) = 91677
TPG(1958, 60) = 91396
TPG(1958, 61) = 91108
TPG(1958, 62) = 90813
TPG(1958, 63) = 90511
TPG(1958, 64) = 90192
TPG(1958, 65) = 89855
TPG(1958, 66) = 89500
TPG(1958, 67) = 89127
TPG(1958, 68) = 88733
TPG(1958, 69) = 88294
TPG(1958, 70) = 87802
TPG(1958, 71) = 87252
TPG(1958, 72) = 86635
TPG(1958, 73) = 85945
TPG(1958, 74) = 85158
TPG(1958, 75) = 84262
TPG(1958, 76) = 83242
TPG(1958, 77) = 82081
TPG(1958, 78) = 80760
TPG(1958, 79) = 79276
TPG(1958, 80) = 77611
TPG(1958, 81) = 75746
TPG(1958, 82) = 73663
TPG(1958, 83) = 71342
TPG(1958, 84) = 68806
TPG(1958, 85) = 66046
TPG(1958, 86) = 63053
TPG(1958, 87) = 59823
TPG(1958, 88) = 56358
TPG(1958, 89) = 52715
TPG(1958, 90) = 48912
TPG(1958, 91) = 44970
TPG(1958, 92) = 40919
TPG(1958, 93) = 36797
TPG(1958, 94) = 32710
TPG(1958, 95) = 28703
TPG(1958, 96) = 24824
TPG(1958, 97) = 21121
TPG(1958, 98) = 17643
TPG(1958, 99) = 14433
TPG(1958, 100) = 11532
TPG(1958, 101) = 8970
TPG(1958, 102) = 6766
TPG(1958, 103) = 4927
TPG(1958, 104) = 3446
TPG(1958, 105) = 2299
TPG(1958, 106) = 1451
TPG(1958, 107) = 859
TPG(1958, 108) = 470
TPG(1958, 109) = 234
TPG(1958, 110) = 104
TPG(1958, 111) = 40
TPG(1958, 112) = 13
TPG(1958, 113) = 3
TPG(1958, 114) = 0
TPG(1958, 115) = 0
TPG(1958, 116) = 0
TPG(1958, 117) = 0
End Function

Function IniTPG3()
TPG(1975, 0) = 100000
TPG(1975, 1) = 98909
TPG(1975, 2) = 98512
TPG(1975, 3) = 98443
TPG(1975, 4) = 98390
TPG(1975, 5) = 98348
TPG(1975, 6) = 98325
TPG(1975, 7) = 98302
TPG(1975, 8) = 98281
TPG(1975, 9) = 98261
TPG(1975, 10) = 98242
TPG(1975, 11) = 98229
TPG(1975, 12) = 98214
TPG(1975, 13) = 98197
TPG(1975, 14) = 98178
TPG(1975, 15) = 98155
TPG(1975, 16) = 98130
TPG(1975, 17) = 98100
TPG(1975, 18) = 98066
TPG(1975, 19) = 98031
TPG(1975, 20) = 97994
TPG(1975, 21) = 97955
TPG(1975, 22) = 97915
TPG(1975, 23) = 97873
TPG(1975, 24) = 97831
TPG(1975, 25) = 97789
TPG(1975, 26) = 97746
TPG(1975, 27) = 97704
TPG(1975, 28) = 97661
TPG(1975, 29) = 97618
TPG(1975, 30) = 97574
TPG(1975, 31) = 97529
TPG(1975, 32) = 97483
TPG(1975, 33) = 97436
TPG(1975, 34) = 97386
TPG(1975, 35) = 97334
TPG(1975, 36) = 97279
TPG(1975, 37) = 97221
TPG(1975, 38) = 97159
TPG(1975, 39) = 97093
TPG(1975, 40) = 97023
TPG(1975, 41) = 96949
TPG(1975, 42) = 96870
TPG(1975, 43) = 96787
TPG(1975, 44) = 96697
TPG(1975, 45) = 96602
TPG(1975, 46) = 96501
TPG(1975, 47) = 96394
TPG(1975, 48) = 96279
TPG(1975, 49) = 96156
TPG(1975, 50) = 96025
TPG(1975, 51) = 95884
TPG(1975, 52) = 95732
TPG(1975, 53) = 95570
TPG(1975, 54) = 95400
TPG(1975, 55) = 95223
TPG(1975, 56) = 95038
TPG(1975, 57) = 94845
TPG(1975, 58) = 94643
TPG(1975, 59) = 94439
TPG(1975, 60) = 94231
TPG(1975, 61) = 94020
TPG(1975, 62) = 93806
TPG(1975, 63) = 93591
TPG(1975, 64) = 93364
TPG(1975, 65) = 93125
TPG(1975, 66) = 92874
TPG(1975, 67) = 92610
TPG(1975, 68) = 92332
TPG(1975, 69) = 92019
TPG(1975, 70) = 91663
TPG(1975, 71) = 91261
TPG(1975, 72) = 90804
TPG(1975, 73) = 90285
TPG(1975, 74) = 89688
TPG(1975, 75) = 88999
TPG(1975, 76) = 88204
TPG(1975, 77) = 87287
TPG(1975, 78) = 86231
TPG(1975, 79) = 85031
TPG(1975, 80) = 83670
TPG(1975, 81) = 82128
TPG(1975, 82) = 80385
TPG(1975, 83) = 78417
TPG(1975, 84) = 76240
TPG(1975, 85) = 73837
TPG(1975, 86) = 71195
TPG(1975, 87) = 68298
TPG(1975, 88) = 65139
TPG(1975, 89) = 61760
TPG(1975, 90) = 58165
TPG(1975, 91) = 54364
TPG(1975, 92) = 50374
TPG(1975, 93) = 46219
TPG(1975, 94) = 42003
TPG(1975, 95) = 37765
TPG(1975, 96) = 33548
TPG(1975, 97) = 29402
TPG(1975, 98) = 25379
TPG(1975, 99) = 21533
TPG(1975, 100) = 17917
TPG(1975, 101) = 14583
TPG(1975, 102) = 11574
TPG(1975, 103) = 8926
TPG(1975, 104) = 6660
TPG(1975, 105) = 4784
TPG(1975, 106) = 3289
TPG(1975, 107) = 2147
TPG(1975, 108) = 1319
TPG(1975, 109) = 754
TPG(1975, 110) = 395
TPG(1975, 111) = 186
TPG(1975, 112) = 77
TPG(1975, 113) = 27
TPG(1975, 114) = 7
TPG(1975, 115) = 1
TPG(1975, 116) = 0
TPG(1975, 117) = 0
TPG(1989, 0) = 100000
TPG(1989, 1) = 99379
TPG(1989, 2) = 99151
TPG(1989, 3) = 99114
TPG(1989, 4) = 99083
TPG(1989, 5) = 99057
TPG(1989, 6) = 99040
TPG(1989, 7) = 99024
TPG(1989, 8) = 99008
TPG(1989, 9) = 98993
TPG(1989, 10) = 98978
TPG(1989, 11) = 98968
TPG(1989, 12) = 98956
TPG(1989, 13) = 98942
TPG(1989, 14) = 98926
TPG(1989, 15) = 98908
TPG(1989, 16) = 98886
TPG(1989, 17) = 98860
TPG(1989, 18) = 98829
TPG(1989, 19) = 98797
TPG(1989, 20) = 98765
TPG(1989, 21) = 98731
TPG(1989, 22) = 98696
TPG(1989, 23) = 98659
TPG(1989, 24) = 98623
TPG(1989, 25) = 98587
TPG(1989, 26) = 98552
TPG(1989, 27) = 98517
TPG(1989, 28) = 98482
TPG(1989, 29) = 98447
TPG(1989, 30) = 98412
TPG(1989, 31) = 98376
TPG(1989, 32) = 98339
TPG(1989, 33) = 98303
TPG(1989, 34) = 98264
TPG(1989, 35) = 98222
TPG(1989, 36) = 98179
TPG(1989, 37) = 98133
TPG(1989, 38) = 98084
TPG(1989, 39) = 98031
TPG(1989, 40) = 97976
TPG(1989, 41) = 97917
TPG(1989, 42) = 97855
TPG(1989, 43) = 97788
TPG(1989, 44) = 97718
TPG(1989, 45) = 97643
TPG(1989, 46) = 97563
TPG(1989, 47) = 97478
TPG(1989, 48) = 97387
TPG(1989, 49) = 97290
TPG(1989, 50) = 97185
TPG(1989, 51) = 97073
TPG(1989, 52) = 96952
TPG(1989, 53) = 96821
TPG(1989, 54) = 96685
TPG(1989, 55) = 96544
TPG(1989, 56) = 96396
TPG(1989, 57) = 96243
TPG(1989, 58) = 96084
TPG(1989, 59) = 95924
TPG(1989, 60) = 95763
TPG(1989, 61) = 95601
TPG(1989, 62) = 95440
TPG(1989, 63) = 95278
TPG(1989, 64) = 95108
TPG(1989, 65) = 94930
TPG(1989, 66) = 94743
TPG(1989, 67) = 94546
TPG(1989, 68) = 94341
TPG(1989, 69) = 94106
TPG(1989, 70) = 93837
TPG(1989, 71) = 93530
TPG(1989, 72) = 93177
TPG(1989, 73) = 92774
TPG(1989, 74) = 92303
TPG(1989, 75) = 91756
TPG(1989, 76) = 91119
TPG(1989, 77) = 90376
TPG(1989, 78) = 89512
TPG(1989, 79) = 88522
TPG(1989, 80) = 87390
TPG(1989, 81) = 86098
TPG(1989, 82) = 84623
TPG(1989, 83) = 82942
TPG(1989, 84) = 81066
TPG(1989, 85) = 78975
TPG(1989, 86) = 76651
TPG(1989, 87) = 74077
TPG(1989, 88) = 71234
TPG(1989, 89) = 68157
TPG(1989, 90) = 64841
TPG(1989, 91) = 61285
TPG(1989, 92) = 57495
TPG(1989, 93) = 53483
TPG(1989, 94) = 49347
TPG(1989, 95) = 45117
TPG(1989, 96) = 40829
TPG(1989, 97) = 36525
TPG(1989, 98) = 32253
TPG(1989, 99) = 28066
TPG(1989, 100) = 24022
TPG(1989, 101) = 20178
TPG(1989, 102) = 16592
TPG(1989, 103) = 13316
TPG(1989, 104) = 10393
TPG(1989, 105) = 7858
TPG(1989, 106) = 5727
TPG(1989, 107) = 3999
TPG(1989, 108) = 2657
TPG(1989, 109) = 1665
TPG(1989, 110) = 973
TPG(1989, 111) = 523
TPG(1989, 112) = 254
TPG(1989, 113) = 108
TPG(1989, 114) = 39
TPG(1989, 115) = 11
TPG(1989, 116) = 2
TPG(1989, 117) = 0
TPG(1919, 0) = 100000
TPG(1919, 1) = 90329
TPG(1919, 2) = 87077
TPG(1919, 3) = 86358
TPG(1919, 4) = 85929
TPG(1919, 5) = 85671
TPG(1919, 6) = 85595
TPG(1919, 7) = 85527
TPG(1919, 8) = 85467
TPG(1919, 9) = 85412
TPG(1919, 10) = 85363
TPG(1919, 11) = 85330
TPG(1919, 12) = 85295
TPG(1919, 13) = 85258
TPG(1919, 14) = 85220
TPG(1919, 15) = 85181
TPG(1919, 16) = 85140
TPG(1919, 17) = 85096
TPG(1919, 18) = 85049
TPG(1919, 19) = 84998
TPG(1919, 20) = 84944
TPG(1919, 21) = 84885
TPG(1919, 22) = 84822
TPG(1919, 23) = 84756
TPG(1919, 24) = 84686
TPG(1919, 25) = 84612
TPG(1919, 26) = 84534
TPG(1919, 27) = 84453
TPG(1919, 28) = 84367
TPG(1919, 29) = 84276
TPG(1919, 30) = 84181
TPG(1919, 31) = 84082
TPG(1919, 32) = 83978
TPG(1919, 33) = 83869
TPG(1919, 34) = 83754
TPG(1919, 35) = 83634
TPG(1919, 36) = 83508
TPG(1919, 37) = 83376
TPG(1919, 38) = 83237
TPG(1919, 39) = 83090
TPG(1919, 40) = 82933
TPG(1919, 41) = 82767
TPG(1919, 42) = 82589
TPG(1919, 43) = 82401
TPG(1919, 44) = 82200
TPG(1919, 45) = 81985
TPG(1919, 46) = 81756
TPG(1919, 47) = 81512
TPG(1919, 48) = 81252
TPG(1919, 49) = 80977
TPG(1919, 50) = 80687
TPG(1919, 51) = 80380
TPG(1919, 52) = 80056
TPG(1919, 53) = 79714
TPG(1919, 54) = 79352
TPG(1919, 55) = 78969
TPG(1919, 56) = 78565
TPG(1919, 57) = 78139
TPG(1919, 58) = 77689
TPG(1919, 59) = 77213
TPG(1919, 60) = 76710
TPG(1919, 61) = 76179
TPG(1919, 62) = 75621
TPG(1919, 63) = 75034
TPG(1919, 64) = 74413
TPG(1919, 65) = 73755
TPG(1919, 66) = 73060
TPG(1919, 67) = 72325
TPG(1919, 68) = 71550
TPG(1919, 69) = 70711
TPG(1919, 70) = 69802
TPG(1919, 71) = 68816
TPG(1919, 72) = 67749
TPG(1919, 73) = 66593
TPG(1919, 74) = 65317
TPG(1919, 75) = 63911
TPG(1919, 76) = 62364
TPG(1919, 77) = 60664
TPG(1919, 78) = 58799
TPG(1919, 79) = 56766
TPG(1919, 80) = 54557
TPG(1919, 81) = 52165
TPG(1919, 82) = 49588
TPG(1919, 83) = 46823
TPG(1919, 84) = 43918
TPG(1919, 85) = 40884
TPG(1919, 86) = 37737
TPG(1919, 87) = 34497
TPG(1919, 88) = 31192
TPG(1919, 89) = 27900
TPG(1919, 90) = 24654
TPG(1919, 91) = 21489
TPG(1919, 92) = 18444
TPG(1919, 93) = 15557
TPG(1919, 94) = 12896
TPG(1919, 95) = 10483
TPG(1919, 96) = 8337
TPG(1919, 97) = 6469
TPG(1919, 98) = 4882
TPG(1919, 99) = 3569
TPG(1919, 100) = 2517
TPG(1919, 101) = 1703
TPG(1919, 102) = 1098
TPG(1919, 103) = 670
TPG(1919, 104) = 383
TPG(1919, 105) = 203
TPG(1919, 106) = 98
TPG(1919, 107) = 42
TPG(1919, 108) = 16
TPG(1919, 109) = 5
TPG(1919, 110) = 0
TPG(1919, 111) = 0
TPG(1919, 112) = 0
TPG(1919, 113) = 0
TPG(1919, 114) = 0
TPG(1919, 115) = 0
TPG(1919, 116) = 0
TPG(1919, 117) = 0
TPG(1920, 0) = 100000
TPG(1920, 1) = 90678
TPG(1920, 2) = 87534
TPG(1920, 3) = 86842
TPG(1920, 4) = 86428
TPG(1920, 5) = 86177
TPG(1920, 6) = 86102
TPG(1920, 7) = 86036
TPG(1920, 8) = 85976
TPG(1920, 9) = 85922
TPG(1920, 10) = 85874
TPG(1920, 11) = 85840
TPG(1920, 12) = 85806
TPG(1920, 13) = 85770
TPG(1920, 14) = 85733
TPG(1920, 15) = 85693
TPG(1920, 16) = 85652
TPG(1920, 17) = 85608
TPG(1920, 18) = 85561
TPG(1920, 19) = 85510
TPG(1920, 20) = 85456
TPG(1920, 21) = 85398
TPG(1920, 22) = 85335
TPG(1920, 23) = 85269
TPG(1920, 24) = 85200
TPG(1920, 25) = 85126
TPG(1920, 26) = 85049
TPG(1920, 27) = 84968
TPG(1920, 28) = 84883
TPG(1920, 29) = 84794
TPG(1920, 30) = 84700
TPG(1920, 31) = 84601
TPG(1920, 32) = 84498
TPG(1920, 33) = 84390
TPG(1920, 34) = 84277
TPG(1920, 35) = 84158
TPG(1920, 36) = 84034
TPG(1920, 37) = 83903
TPG(1920, 38) = 83766
TPG(1920, 39) = 83620
TPG(1920, 40) = 83465
TPG(1920, 41) = 83300
TPG(1920, 42) = 83125
TPG(1920, 43) = 82939
TPG(1920, 44) = 82740
TPG(1920, 45) = 82528
TPG(1920, 46) = 82301
TPG(1920, 47) = 82059
TPG(1920, 48) = 81802
TPG(1920, 49) = 81530
TPG(1920, 50) = 81243
TPG(1920, 51) = 80939
TPG(1920, 52) = 80618
TPG(1920, 53) = 80279
TPG(1920, 54) = 79921
TPG(1920, 55) = 79542
TPG(1920, 56) = 79142
TPG(1920, 57) = 78720
TPG(1920, 58) = 78275
TPG(1920, 59) = 77804
TPG(1920, 60) = 77307
TPG(1920, 61) = 76783
TPG(1920, 62) = 76232
TPG(1920, 63) = 75653
TPG(1920, 64) = 75040
TPG(1920, 65) = 74391
TPG(1920, 66) = 73705
TPG(1920, 67) = 72981
TPG(1920, 68) = 72216
TPG(1920, 69) = 71387
TPG(1920, 70) = 70489
TPG(1920, 71) = 69514
TPG(1920, 72) = 68457
TPG(1920, 73) = 67311
TPG(1920, 74) = 66046
TPG(1920, 75) = 64650
TPG(1920, 76) = 63113
TPG(1920, 77) = 61421
TPG(1920, 78) = 59563
TPG(1920, 79) = 57537
TPG(1920, 80) = 55333
TPG(1920, 81) = 52944
TPG(1920, 82) = 50366
TPG(1920, 83) = 47598
TPG(1920, 84) = 44687
TPG(1920, 85) = 41642
TPG(1920, 86) = 38478
TPG(1920, 87) = 35218
TPG(1920, 88) = 31886
TPG(1920, 89) = 28561
TPG(1920, 90) = 25278
TPG(1920, 91) = 22071
TPG(1920, 92) = 18979
TPG(1920, 93) = 16040
TPG(1920, 94) = 13325
TPG(1920, 95) = 10858
TPG(1920, 96) = 8658
TPG(1920, 97) = 6737
TPG(1920, 98) = 5100
TPG(1920, 99) = 3741
TPG(1920, 100) = 2648
TPG(1920, 101) = 1800
TPG(1920, 102) = 1166
TPG(1920, 103) = 716
TPG(1920, 104) = 412
TPG(1920, 105) = 220
TPG(1920, 106) = 107
TPG(1920, 107) = 47
TPG(1920, 108) = 18
TPG(1920, 109) = 6
TPG(1920, 110) = 0
TPG(1920, 111) = 0
TPG(1920, 112) = 0
TPG(1920, 113) = 0
TPG(1920, 114) = 0
TPG(1920, 115) = 0
TPG(1920, 116) = 0
TPG(1920, 117) = 0
TPG(1947, 0) = 100000
TPG(1947, 1) = 96677
TPG(1947, 2) = 95498
TPG(1947, 3) = 95268
TPG(1947, 4) = 95112
TPG(1947, 5) = 95004
TPG(1947, 6) = 94961
TPG(1947, 7) = 94920
TPG(1947, 8) = 94883
TPG(1947, 9) = 94849
TPG(1947, 10) = 94817
TPG(1947, 11) = 94795
TPG(1947, 12) = 94772
TPG(1947, 13) = 94746
TPG(1947, 14) = 94718
TPG(1947, 15) = 94687
TPG(1947, 16) = 94653
TPG(1947, 17) = 94615
TPG(1947, 18) = 94574
TPG(1947, 19) = 94530
TPG(1947, 20) = 94484
TPG(1947, 21) = 94435
TPG(1947, 22) = 94383
TPG(1947, 23) = 94329
TPG(1947, 24) = 94272
TPG(1947, 25) = 94214
TPG(1947, 26) = 94155
TPG(1947, 27) = 94094
TPG(1947, 28) = 94032
TPG(1947, 29) = 93967
TPG(1947, 30) = 93900
TPG(1947, 31) = 93830
TPG(1947, 32) = 93759
TPG(1947, 33) = 93685
TPG(1947, 34) = 93607
TPG(1947, 35) = 93525
TPG(1947, 36) = 93438
TPG(1947, 37) = 93347
TPG(1947, 38) = 93251
TPG(1947, 39) = 93149
TPG(1947, 40) = 93041
TPG(1947, 41) = 92925
TPG(1947, 42) = 92803
TPG(1947, 43) = 92672
TPG(1947, 44) = 92533
TPG(1947, 45) = 92385
TPG(1947, 46) = 92227
TPG(1947, 47) = 92059
TPG(1947, 48) = 91879
TPG(1947, 49) = 91689
TPG(1947, 50) = 91485
TPG(1947, 51) = 91269
TPG(1947, 52) = 91039
TPG(1947, 53) = 90794
TPG(1947, 54) = 90536
TPG(1947, 55) = 90265
TPG(1947, 56) = 89980
TPG(1947, 57) = 89681
TPG(1947, 58) = 89367
TPG(1947, 59) = 89042
TPG(1947, 60) = 88704
TPG(1947, 61) = 88355
TPG(1947, 62) = 87994
TPG(1947, 63) = 87623
TPG(1947, 64) = 87229
TPG(1947, 65) = 86814
TPG(1947, 66) = 86376
TPG(1947, 67) = 85914
TPG(1947, 68) = 85426
TPG(1947, 69) = 84886
TPG(1947, 70) = 84287
TPG(1947, 71) = 83623
TPG(1947, 72) = 82885
TPG(1947, 73) = 82065
TPG(1947, 74) = 81140
TPG(1947, 75) = 80094
TPG(1947, 76) = 78914
TPG(1947, 77) = 77583
TPG(1947, 78) = 76084
TPG(1947, 79) = 74411
TPG(1947, 80) = 72549
TPG(1947, 81) = 70481
TPG(1947, 82) = 68191
TPG(1947, 83) = 65664
TPG(1947, 84) = 62929
TPG(1947, 85) = 59981
TPG(1947, 86) = 56819
TPG(1947, 87) = 53446
TPG(1947, 88) = 49871
TPG(1947, 89) = 46161
TPG(1947, 90) = 42341
TPG(1947, 91) = 38441
TPG(1947, 92) = 34496
TPG(1947, 93) = 30550
TPG(1947, 94) = 26705
TPG(1947, 95) = 23007
TPG(1947, 96) = 19499
TPG(1947, 97) = 16225
TPG(1947, 98) = 13222
TPG(1947, 99) = 10525
TPG(1947, 100) = 8158
TPG(1947, 101) = 6133
TPG(1947, 102) = 4453
TPG(1947, 103) = 3107
TPG(1947, 104) = 2069
TPG(1947, 105) = 1305
TPG(1947, 106) = 773
TPG(1947, 107) = 424
TPG(1947, 108) = 213
TPG(1947, 109) = 95
TPG(1947, 110) = 37
TPG(1947, 111) = 12
TPG(1947, 112) = 3
TPG(1947, 113) = 1
TPG(1947, 114) = 0
TPG(1947, 115) = 0
TPG(1947, 116) = 0
TPG(1947, 117) = 0
TPG(1948, 0) = 100000
TPG(1948, 1) = 96805
TPG(1948, 2) = 95670
TPG(1948, 3) = 95450
TPG(1948, 4) = 95299
TPG(1948, 5) = 95195
TPG(1948, 6) = 95152
TPG(1948, 7) = 95113
TPG(1948, 8) = 95077
TPG(1948, 9) = 95043
TPG(1948, 10) = 95011
TPG(1948, 11) = 94990
TPG(1948, 12) = 94967
TPG(1948, 13) = 94941
TPG(1948, 14) = 94913
TPG(1948, 15) = 94883
TPG(1948, 16) = 94849
TPG(1948, 17) = 94812
TPG(1948, 18) = 94771
TPG(1948, 19) = 94728
TPG(1948, 20) = 94682
TPG(1948, 21) = 94633
TPG(1948, 22) = 94582
TPG(1948, 23) = 94527
TPG(1948, 24) = 94472
TPG(1948, 25) = 94414
TPG(1948, 26) = 94356
TPG(1948, 27) = 94295
TPG(1948, 28) = 94234
TPG(1948, 29) = 94170
TPG(1948, 30) = 94104
TPG(1948, 31) = 94035
TPG(1948, 32) = 93965
TPG(1948, 33) = 93892
TPG(1948, 34) = 93815
TPG(1948, 35) = 93734
TPG(1948, 36) = 93649
TPG(1948, 37) = 93560
TPG(1948, 38) = 93465
TPG(1948, 39) = 93364
TPG(1948, 40) = 93258
TPG(1948, 41) = 93144
TPG(1948, 42) = 93023
TPG(1948, 43) = 92895
TPG(1948, 44) = 92758
TPG(1948, 45) = 92612
TPG(1948, 46) = 92456
TPG(1948, 47) = 92290
TPG(1948, 48) = 92114
TPG(1948, 49) = 91926
TPG(1948, 50) = 91725
TPG(1948, 51) = 91512
TPG(1948, 52) = 91285
TPG(1948, 53) = 91043
TPG(1948, 54) = 90789
TPG(1948, 55) = 90522
TPG(1948, 56) = 90241
TPG(1948, 57) = 89946
TPG(1948, 58) = 89637
TPG(1948, 59) = 89317
TPG(1948, 60) = 88985
TPG(1948, 61) = 88642
TPG(1948, 62) = 88287
TPG(1948, 63) = 87922
TPG(1948, 64) = 87536
TPG(1948, 65) = 87129
TPG(1948, 66) = 86699
TPG(1948, 67) = 86245
TPG(1948, 68) = 85767
TPG(1948, 69) = 85237
TPG(1948, 70) = 84648
TPG(1948, 71) = 83994
TPG(1948, 72) = 83268
TPG(1948, 73) = 82461
TPG(1948, 74) = 81548
TPG(1948, 75) = 80517
TPG(1948, 76) = 79351
TPG(1948, 77) = 78036
TPG(1948, 78) = 76552
TPG(1948, 79) = 74896
TPG(1948, 80) = 73051
TPG(1948, 81) = 71001
TPG(1948, 82) = 68729
TPG(1948, 83) = 66219
TPG(1948, 84) = 63500
TPG(1948, 85) = 60567
TPG(1948, 86) = 57418
TPG(1948, 87) = 54055
TPG(1948, 88) = 50485
TPG(1948, 89) = 46778
TPG(1948, 90) = 42954
TPG(1948, 91) = 39045
TPG(1948, 92) = 35085
TPG(1948, 93) = 31117
TPG(1948, 94) = 27245
TPG(1948, 95) = 23514
TPG(1948, 96) = 19967
TPG(1948, 97) = 16650
TPG(1948, 98) = 13601
TPG(1948, 99) = 10855
TPG(1948, 100) = 8438
TPG(1948, 101) = 6364
TPG(1948, 102) = 4638
TPG(1948, 103) = 3249
TPG(1948, 104) = 2174
TPG(1948, 105) = 1379
TPG(1948, 106) = 821
TPG(1948, 107) = 454
TPG(1948, 108) = 230
TPG(1948, 109) = 104
TPG(1948, 110) = 41
TPG(1948, 111) = 13
TPG(1948, 112) = 3
TPG(1948, 113) = 1
TPG(1948, 114) = 0
TPG(1948, 115) = 0
TPG(1948, 116) = 0
TPG(1948, 117) = 0
TPG(1970, 0) = 100000
TPG(1970, 1) = 98667
TPG(1970, 2) = 98183
TPG(1970, 3) = 98098
TPG(1970, 4) = 98033
TPG(1970, 5) = 97983
TPG(1970, 6) = 97957
TPG(1970, 7) = 97932
TPG(1970, 8) = 97909
TPG(1970, 9) = 97887
TPG(1970, 10) = 97865
TPG(1970, 11) = 97851
TPG(1970, 12) = 97835
TPG(1970, 13) = 97816
TPG(1970, 14) = 97796
TPG(1970, 15) = 97773
TPG(1970, 16) = 97746
TPG(1970, 17) = 97715
TPG(1970, 18) = 97680
TPG(1970, 19) = 97643
TPG(1970, 20) = 97604
TPG(1970, 21) = 97563
TPG(1970, 22) = 97521
TPG(1970, 23) = 97477
TPG(1970, 24) = 97433
TPG(1970, 25) = 97388
TPG(1970, 26) = 97343
TPG(1970, 27) = 97297
TPG(1970, 28) = 97252
TPG(1970, 29) = 97205
TPG(1970, 30) = 97157
TPG(1970, 31) = 97108
TPG(1970, 32) = 97059
TPG(1970, 33) = 97008
TPG(1970, 34) = 96954
TPG(1970, 35) = 96897
TPG(1970, 36) = 96837
TPG(1970, 37) = 96774
TPG(1970, 38) = 96707
TPG(1970, 39) = 96636
TPG(1970, 40) = 96560
TPG(1970, 41) = 96479
TPG(1970, 42) = 96394
TPG(1970, 43) = 96303
TPG(1970, 44) = 96206
TPG(1970, 45) = 96103
TPG(1970, 46) = 95993
TPG(1970, 47) = 95876
TPG(1970, 48) = 95752
TPG(1970, 49) = 95619
TPG(1970, 50) = 95476
TPG(1970, 51) = 95323
TPG(1970, 52) = 95160
TPG(1970, 53) = 94984
TPG(1970, 54) = 94801
TPG(1970, 55) = 94609
TPG(1970, 56) = 94408
TPG(1970, 57) = 94199
TPG(1970, 58) = 93980
TPG(1970, 59) = 93757
TPG(1970, 60) = 93530
TPG(1970, 61) = 93298
TPG(1970, 62) = 93063
TPG(1970, 63) = 92825
TPG(1970, 64) = 92573
TPG(1970, 65) = 92309
TPG(1970, 66) = 92030
TPG(1970, 67) = 91737
TPG(1970, 68) = 91429
TPG(1970, 69) = 91082
TPG(1970, 70) = 90690
TPG(1970, 71) = 90248
TPG(1970, 72) = 89748
TPG(1970, 73) = 89183
TPG(1970, 74) = 88534
TPG(1970, 75) = 87787
TPG(1970, 76) = 86930
TPG(1970, 77) = 85945
TPG(1970, 78) = 84813
TPG(1970, 79) = 83532
TPG(1970, 80) = 82084
TPG(1970, 81) = 80448
TPG(1970, 82) = 78605
TPG(1970, 83) = 76532
TPG(1970, 84) = 74247
TPG(1970, 85) = 71734
TPG(1970, 86) = 68982
TPG(1970, 87) = 65978
TPG(1970, 88) = 62716
TPG(1970, 89) = 59244
TPG(1970, 90) = 55570
TPG(1970, 91) = 51706
TPG(1970, 92) = 47674
TPG(1970, 93) = 43501
TPG(1970, 94) = 39295
TPG(1970, 95) = 35095
TPG(1970, 96) = 30948
TPG(1970, 97) = 26904
TPG(1970, 98) = 23014
TPG(1970, 99) = 19331
TPG(1970, 100) = 15906
TPG(1970, 101) = 12785
TPG(1970, 102) = 10006
TPG(1970, 103) = 7596
TPG(1970, 104) = 5568
TPG(1970, 105) = 3919
TPG(1970, 106) = 2632
TPG(1970, 107) = 1673
TPG(1970, 108) = 996
TPG(1970, 109) = 549
TPG(1970, 110) = 275
TPG(1970, 111) = 123
TPG(1970, 112) = 47
TPG(1970, 113) = 15
TPG(1970, 114) = 4
TPG(1970, 115) = 1
TPG(1970, 116) = 0
TPG(1970, 117) = 0
TPG(1984, 0) = 100000
TPG(1984, 1) = 99240
TPG(1984, 2) = 98962
TPG(1984, 3) = 98916
TPG(1984, 4) = 98878
TPG(1984, 5) = 98848
TPG(1984, 6) = 98829
TPG(1984, 7) = 98810
TPG(1984, 8) = 98793
TPG(1984, 9) = 98776
TPG(1984, 10) = 98760
TPG(1984, 11) = 98749
TPG(1984, 12) = 98736
TPG(1984, 13) = 98721
TPG(1984, 14) = 98704
TPG(1984, 15) = 98684
TPG(1984, 16) = 98661
TPG(1984, 17) = 98634
TPG(1984, 18) = 98602
TPG(1984, 19) = 98569
TPG(1984, 20) = 98534
TPG(1984, 21) = 98499
TPG(1984, 22) = 98462
TPG(1984, 23) = 98424
TPG(1984, 24) = 98386
TPG(1984, 25) = 98348
TPG(1984, 26) = 98310
TPG(1984, 27) = 98272
TPG(1984, 28) = 98235
TPG(1984, 29) = 98197
TPG(1984, 30) = 98159
TPG(1984, 31) = 98120
TPG(1984, 32) = 98080
TPG(1984, 33) = 98040
TPG(1984, 34) = 97998
TPG(1984, 35) = 97953
TPG(1984, 36) = 97905
TPG(1984, 37) = 97855
TPG(1984, 38) = 97802
TPG(1984, 39) = 97745
TPG(1984, 40) = 97685
TPG(1984, 41) = 97621
TPG(1984, 42) = 97553
TPG(1984, 43) = 97481
TPG(1984, 44) = 97404
TPG(1984, 45) = 97322
TPG(1984, 46) = 97235
TPG(1984, 47) = 97143
TPG(1984, 48) = 97044
TPG(1984, 49) = 96939
TPG(1984, 50) = 96825
TPG(1984, 51) = 96703
TPG(1984, 52) = 96572
TPG(1984, 53) = 96430
TPG(1984, 54) = 96283
TPG(1984, 55) = 96130
TPG(1984, 56) = 95970
TPG(1984, 57) = 95803
TPG(1984, 58) = 95630
TPG(1984, 59) = 95455
TPG(1984, 60) = 95278
TPG(1984, 61) = 95101
TPG(1984, 62) = 94922
TPG(1984, 63) = 94743
TPG(1984, 64) = 94554
TPG(1984, 65) = 94356
TPG(1984, 66) = 94148
TPG(1984, 67) = 93930
TPG(1984, 68) = 93701
TPG(1984, 69) = 93440
TPG(1984, 70) = 93143
TPG(1984, 71) = 92804
TPG(1984, 72) = 92417
TPG(1984, 73) = 91975
TPG(1984, 74) = 91462
TPG(1984, 75) = 90867
TPG(1984, 76) = 90177
TPG(1984, 77) = 89375
TPG(1984, 78) = 88445
TPG(1984, 79) = 87384
TPG(1984, 80) = 86173
TPG(1984, 81) = 84794
TPG(1984, 82) = 83226
TPG(1984, 83) = 81445
TPG(1984, 84) = 79462
TPG(1984, 85) = 77260
TPG(1984, 86) = 74822
TPG(1984, 87) = 72130
TPG(1984, 88) = 69171
TPG(1984, 89) = 65980
TPG(1984, 90) = 62557
TPG(1984, 91) = 58904
TPG(1984, 92) = 55031
TPG(1984, 93) = 50953
TPG(1984, 94) = 46772
TPG(1984, 95) = 42521
TPG(1984, 96) = 38239
TPG(1984, 97) = 33971
TPG(1984, 98) = 29767
TPG(1984, 99) = 25681
TPG(1984, 100) = 21771
TPG(1984, 101) = 18092
TPG(1984, 102) = 14699
TPG(1984, 103) = 11638
TPG(1984, 104) = 8946
TPG(1984, 105) = 6648
TPG(1984, 106) = 4750
TPG(1984, 107) = 3242
TPG(1984, 108) = 2098
TPG(1984, 109) = 1275
TPG(1984, 110) = 718
TPG(1984, 111) = 369
TPG(1984, 112) = 170
TPG(1984, 113) = 68
TPG(1984, 114) = 22
TPG(1984, 115) = 6
TPG(1984, 116) = 1
TPG(1984, 117) = 0
TPG(1933, 0) = 100000
TPG(1933, 1) = 94281
TPG(1933, 2) = 92294
TPG(1933, 3) = 91882
TPG(1933, 4) = 91620
TPG(1933, 5) = 91450
TPG(1933, 6) = 91392
TPG(1933, 7) = 91339
TPG(1933, 8) = 91291
TPG(1933, 9) = 91247
TPG(1933, 10) = 91207
TPG(1933, 11) = 91180
TPG(1933, 12) = 91151
TPG(1933, 13) = 91120
TPG(1933, 14) = 91086
TPG(1933, 15) = 91051
TPG(1933, 16) = 91011
TPG(1933, 17) = 90969
TPG(1933, 18) = 90925
TPG(1933, 19) = 90877
TPG(1933, 20) = 90826
TPG(1933, 21) = 90772
TPG(1933, 22) = 90715
TPG(1933, 23) = 90654
TPG(1933, 24) = 90590
TPG(1933, 25) = 90524
TPG(1933, 26) = 90455
TPG(1933, 27) = 90383
TPG(1933, 28) = 90309
TPG(1933, 29) = 90232
TPG(1933, 30) = 90151
TPG(1933, 31) = 90067
TPG(1933, 32) = 89979
TPG(1933, 33) = 89888
TPG(1933, 34) = 89792
TPG(1933, 35) = 89692
TPG(1933, 36) = 89586
TPG(1933, 37) = 89475
TPG(1933, 38) = 89358
TPG(1933, 39) = 89233
TPG(1933, 40) = 89101
TPG(1933, 41) = 88960
TPG(1933, 42) = 88811
TPG(1933, 43) = 88652
TPG(1933, 44) = 88482
TPG(1933, 45) = 88301
TPG(1933, 46) = 88108
TPG(1933, 47) = 87902
TPG(1933, 48) = 87683
TPG(1933, 49) = 87451
TPG(1933, 50) = 87204
TPG(1933, 51) = 86943
TPG(1933, 52) = 86666
TPG(1933, 53) = 86371
TPG(1933, 54) = 86061
TPG(1933, 55) = 85734
TPG(1933, 56) = 85389
TPG(1933, 57) = 85027
TPG(1933, 58) = 84645
TPG(1933, 59) = 84245
TPG(1933, 60) = 83827
TPG(1933, 61) = 83389
TPG(1933, 62) = 82933
TPG(1933, 63) = 82458
TPG(1933, 64) = 81955
TPG(1933, 65) = 81424
TPG(1933, 66) = 80862
TPG(1933, 67) = 80268
TPG(1933, 68) = 79642
TPG(1933, 69) = 78956
TPG(1933, 70) = 78204
TPG(1933, 71) = 77378
TPG(1933, 72) = 76473
TPG(1933, 73) = 75479
TPG(1933, 74) = 74369
TPG(1933, 75) = 73130
TPG(1933, 76) = 71748
TPG(1933, 77) = 70208
TPG(1933, 78) = 68495
TPG(1933, 79) = 66605
TPG(1933, 80) = 64525
TPG(1933, 81) = 62243
TPG(1933, 82) = 59746
TPG(1933, 83) = 57028
TPG(1933, 84) = 54126
TPG(1933, 85) = 51043
TPG(1933, 86) = 47787
TPG(1933, 87) = 44371
TPG(1933, 88) = 40814
TPG(1933, 89) = 37192
TPG(1933, 90) = 33537
TPG(1933, 91) = 29884
TPG(1933, 92) = 26274
TPG(1933, 93) = 22751
TPG(1933, 94) = 19406
TPG(1933, 95) = 16276
TPG(1933, 96) = 13394
TPG(1933, 97) = 10789
TPG(1933, 98) = 8483
TPG(1933, 99) = 6491
TPG(1933, 100) = 4814
TPG(1933, 101) = 3446
TPG(1933, 102) = 2368
TPG(1933, 103) = 1552
TPG(1933, 104) = 963
TPG(1933, 105) = 560
TPG(1933, 106) = 302
TPG(1933, 107) = 148
TPG(1933, 108) = 65
TPG(1933, 109) = 25
TPG(1933, 110) = 8
TPG(1933, 111) = 2
TPG(1933, 112) = 0
TPG(1933, 113) = 0
TPG(1933, 114) = 0
TPG(1933, 115) = 0
TPG(1933, 116) = 0
TPG(1933, 117) = 0
TPG(1934, 0) = 100000
TPG(1934, 1) = 94496
TPG(1934, 2) = 92580
TPG(1934, 3) = 92185
TPG(1934, 4) = 91931
TPG(1934, 5) = 91768
TPG(1934, 6) = 91711
TPG(1934, 7) = 91659
TPG(1934, 8) = 91611
TPG(1934, 9) = 91569
TPG(1934, 10) = 91529
TPG(1934, 11) = 91502
TPG(1934, 12) = 91473
TPG(1934, 13) = 91442
TPG(1934, 14) = 91410
TPG(1934, 15) = 91374
TPG(1934, 16) = 91335
TPG(1934, 17) = 91294
TPG(1934, 18) = 91250
TPG(1934, 19) = 91202
TPG(1934, 20) = 91152
TPG(1934, 21) = 91098
TPG(1934, 22) = 91041
TPG(1934, 23) = 90980
TPG(1934, 24) = 90917
TPG(1934, 25) = 90852
TPG(1934, 26) = 90783
TPG(1934, 27) = 90713
TPG(1934, 28) = 90639
TPG(1934, 29) = 90563
TPG(1934, 30) = 90483
TPG(1934, 31) = 90400
TPG(1934, 32) = 90313
TPG(1934, 33) = 90224
TPG(1934, 34) = 90129
TPG(1934, 35) = 90030
TPG(1934, 36) = 89925
TPG(1934, 37) = 89816
TPG(1934, 38) = 89700
TPG(1934, 39) = 89578
TPG(1934, 40) = 89447
TPG(1934, 41) = 89308
TPG(1934, 42) = 89161
TPG(1934, 43) = 89004
TPG(1934, 44) = 88836
TPG(1934, 45) = 88658
TPG(1934, 46) = 88468
TPG(1934, 47) = 88265
TPG(1934, 48) = 88048
TPG(1934, 49) = 87819
TPG(1934, 50) = 87575
TPG(1934, 51) = 87317
TPG(1934, 52) = 87044
TPG(1934, 53) = 86753
TPG(1934, 54) = 86446
TPG(1934, 55) = 86123
TPG(1934, 56) = 85783
TPG(1934, 57) = 85425
TPG(1934, 58) = 85049
TPG(1934, 59) = 84654
TPG(1934, 60) = 84242
TPG(1934, 61) = 83811
TPG(1934, 62) = 83362
TPG(1934, 63) = 82895
TPG(1934, 64) = 82400
TPG(1934, 65) = 81877
TPG(1934, 66) = 81325
TPG(1934, 67) = 80741
TPG(1934, 68) = 80126
TPG(1934, 69) = 79450
TPG(1934, 70) = 78709
TPG(1934, 71) = 77896
TPG(1934, 72) = 77002
TPG(1934, 73) = 76021
TPG(1934, 74) = 74924
TPG(1934, 75) = 73698
TPG(1934, 76) = 72330
TPG(1934, 77) = 70804
TPG(1934, 78) = 69105
TPG(1934, 79) = 67229
TPG(1934, 80) = 65162
TPG(1934, 81) = 62892
TPG(1934, 82) = 60407
TPG(1934, 83) = 57698
TPG(1934, 84) = 54804
TPG(1934, 85) = 51726
TPG(1934, 86) = 48471
TPG(1934, 87) = 45051
TPG(1934, 88) = 41486
TPG(1934, 89) = 37850
TPG(1934, 90) = 34175
TPG(1934, 91) = 30496
TPG(1934, 92) = 26855
TPG(1934, 93) = 23295
TPG(1934, 94) = 19907
TPG(1934, 95) = 16730
TPG(1934, 96) = 13798
TPG(1934, 97) = 11143
TPG(1934, 98) = 8786
TPG(1934, 99) = 6742
TPG(1934, 100) = 5017
TPG(1934, 101) = 3605
TPG(1934, 102) = 2488
TPG(1934, 103) = 1638
TPG(1934, 104) = 1022
TPG(1934, 105) = 598
TPG(1934, 106) = 325
TPG(1934, 107) = 161
TPG(1934, 108) = 71
TPG(1934, 109) = 27
TPG(1934, 110) = 9
TPG(1934, 111) = 2
TPG(1934, 112) = 0
TPG(1934, 113) = 0
TPG(1934, 114) = 0
TPG(1934, 115) = 0
TPG(1934, 116) = 0
TPG(1934, 117) = 0
TPG(1961, 0) = 100000
TPG(1961, 1) = 98090
TPG(1961, 2) = 97402
TPG(1961, 3) = 97276
TPG(1961, 4) = 97184
TPG(1961, 5) = 97117
TPG(1961, 6) = 97085
TPG(1961, 7) = 97055
TPG(1961, 8) = 97026
TPG(1961, 9) = 96999
TPG(1961, 10) = 96974
TPG(1961, 11) = 96957
TPG(1961, 12) = 96938
TPG(1961, 13) = 96917
TPG(1961, 14) = 96894
TPG(1961, 15) = 96868
TPG(1961, 16) = 96838
TPG(1961, 17) = 96805
TPG(1961, 18) = 96767
TPG(1961, 19) = 96727
TPG(1961, 20) = 96686
TPG(1961, 21) = 96642
TPG(1961, 22) = 96596
TPG(1961, 23) = 96548
TPG(1961, 24) = 96499
TPG(1961, 25) = 96449
TPG(1961, 26) = 96399
TPG(1961, 27) = 96348
TPG(1961, 28) = 96296
TPG(1961, 29) = 96243
TPG(1961, 30) = 96188
TPG(1961, 31) = 96132
TPG(1961, 32) = 96074
TPG(1961, 33) = 96015
TPG(1961, 34) = 95953
TPG(1961, 35) = 95887
TPG(1961, 36) = 95817
TPG(1961, 37) = 95744
TPG(1961, 38) = 95667
TPG(1961, 39) = 95585
TPG(1961, 40) = 95497
TPG(1961, 41) = 95404
TPG(1961, 42) = 95305
TPG(1961, 43) = 95200
TPG(1961, 44) = 95088
TPG(1961, 45) = 94969
TPG(1961, 46) = 94842
TPG(1961, 47) = 94707
TPG(1961, 48) = 94562
TPG(1961, 49) = 94409
TPG(1961, 50) = 94244
TPG(1961, 51) = 94069
TPG(1961, 52) = 93881
TPG(1961, 53) = 93680
TPG(1961, 54) = 93470
TPG(1961, 55) = 93249
TPG(1961, 56) = 93018
TPG(1961, 57) = 92776
TPG(1961, 58) = 92524
TPG(1961, 59) = 92264
TPG(1961, 60) = 91997
TPG(1961, 61) = 91724
TPG(1961, 62) = 91445
TPG(1961, 63) = 91160
TPG(1961, 64) = 90859
TPG(1961, 65) = 90542
TPG(1961, 66) = 90208
TPG(1961, 67) = 89856
TPG(1961, 68) = 89486
TPG(1961, 69) = 89071
TPG(1961, 70) = 88606
TPG(1961, 71) = 88084
TPG(1961, 72) = 87499
TPG(1961, 73) = 86841
TPG(1961, 74) = 86090
TPG(1961, 75) = 85234
TPG(1961, 76) = 84255
TPG(1961, 77) = 83140
TPG(1961, 78) = 81867
TPG(1961, 79) = 80435
TPG(1961, 80) = 78824
TPG(1961, 81) = 77017
TPG(1961, 82) = 74993
TPG(1961, 83) = 72732
TPG(1961, 84) = 70257
TPG(1961, 85) = 67556
TPG(1961, 86) = 64619
TPG(1961, 87) = 61440
TPG(1961, 88) = 58019
TPG(1961, 89) = 54411
TPG(1961, 90) = 50630
TPG(1961, 91) = 46697
TPG(1961, 92) = 42639
TPG(1961, 93) = 38491
TPG(1961, 94) = 34360
TPG(1961, 95) = 30292
TPG(1961, 96) = 26332
TPG(1961, 97) = 22531
TPG(1961, 98) = 18938
TPG(1961, 99) = 15601
TPG(1961, 100) = 12561
TPG(1961, 101) = 9855
TPG(1961, 102) = 7506
TPG(1961, 103) = 5526
TPG(1961, 104) = 3912
TPG(1961, 105) = 2647
TPG(1961, 106) = 1699
TPG(1961, 107) = 1024
TPG(1961, 108) = 573
TPG(1961, 109) = 294
TPG(1961, 110) = 135
TPG(1961, 111) = 54
TPG(1961, 112) = 18
TPG(1961, 113) = 5
TPG(1961, 114) = 1
TPG(1961, 115) = 0
TPG(1961, 116) = 0
TPG(1961, 117) = 0
TPG(1962, 0) = 100000
TPG(1962, 1) = 98165
TPG(1962, 2) = 97503
TPG(1962, 3) = 97382
TPG(1962, 4) = 97294
TPG(1962, 5) = 97229
TPG(1962, 6) = 97197
TPG(1962, 7) = 97167
TPG(1962, 8) = 97140
TPG(1962, 9) = 97114
TPG(1962, 10) = 97089
TPG(1962, 11) = 97072
TPG(1962, 12) = 97054
TPG(1962, 13) = 97033
TPG(1962, 14) = 97010
TPG(1962, 15) = 96984
TPG(1962, 16) = 96955
TPG(1962, 17) = 96921
TPG(1962, 18) = 96884
TPG(1962, 19) = 96845
TPG(1962, 20) = 96803
TPG(1962, 21) = 96760
TPG(1962, 22) = 96715
TPG(1962, 23) = 96667
TPG(1962, 24) = 96619
TPG(1962, 25) = 96569
TPG(1962, 26) = 96520
TPG(1962, 27) = 96469
TPG(1962, 28) = 96418
TPG(1962, 29) = 96366
TPG(1962, 30) = 96312
TPG(1962, 31) = 96256
TPG(1962, 32) = 96200
TPG(1962, 33) = 96141
TPG(1962, 34) = 96080
TPG(1962, 35) = 96015
TPG(1962, 36) = 95947
TPG(1962, 37) = 95875
TPG(1962, 38) = 95799
TPG(1962, 39) = 95718
TPG(1962, 40) = 95632
TPG(1962, 41) = 95540
TPG(1962, 42) = 95443
TPG(1962, 43) = 95339
TPG(1962, 44) = 95229
TPG(1962, 45) = 95112
TPG(1962, 46) = 94987
TPG(1962, 47) = 94854
TPG(1962, 48) = 94712
TPG(1962, 49) = 94560
TPG(1962, 50) = 94399
TPG(1962, 51) = 94226
TPG(1962, 52) = 94041
TPG(1962, 53) = 93843
TPG(1962, 54) = 93636
TPG(1962, 55) = 93418
TPG(1962, 56) = 93191
TPG(1962, 57) = 92953
TPG(1962, 58) = 92704
TPG(1962, 59) = 92449
TPG(1962, 60) = 92187
TPG(1962, 61) = 91919
TPG(1962, 62) = 91645
TPG(1962, 63) = 91365
TPG(1962, 64) = 91070
TPG(1962, 65) = 90759
TPG(1962, 66) = 90432
TPG(1962, 67) = 90087
TPG(1962, 68) = 89724
TPG(1962, 69) = 89317
TPG(1962, 70) = 88861
TPG(1962, 71) = 88348
TPG(1962, 72) = 87773
TPG(1962, 73) = 87126
TPG(1962, 74) = 86387
TPG(1962, 75) = 85543
TPG(1962, 76) = 84579
TPG(1962, 77) = 83478
TPG(1962, 78) = 82222
TPG(1962, 79) = 80806
TPG(1962, 80) = 79214
TPG(1962, 81) = 77425
TPG(1962, 82) = 75421
TPG(1962, 83) = 73182
TPG(1962, 84) = 70727
TPG(1962, 85) = 68046
TPG(1962, 86) = 65128
TPG(1962, 87) = 61968
TPG(1962, 88) = 58562
TPG(1962, 89) = 54967
TPG(1962, 90) = 51195
TPG(1962, 91) = 47267
TPG(1962, 92) = 43208
TPG(1962, 93) = 39053
TPG(1962, 94) = 34911
TPG(1962, 95) = 30823
TPG(1962, 96) = 26839
TPG(1962, 97) = 23007
TPG(1962, 98) = 19377
TPG(1962, 99) = 15999
TPG(1962, 100) = 12914
TPG(1962, 101) = 10160
TPG(1962, 102) = 7763
TPG(1962, 103) = 5735
TPG(1962, 104) = 4077
TPG(1962, 105) = 2771
TPG(1962, 106) = 1788
TPG(1962, 107) = 1085
TPG(1962, 108) = 612
TPG(1962, 109) = 316
TPG(1962, 110) = 146
TPG(1962, 111) = 59
TPG(1962, 112) = 20
TPG(1962, 113) = 5
TPG(1962, 114) = 1
TPG(1962, 115) = 0
TPG(1962, 116) = 0
TPG(1962, 117) = 0
TPG(1977, 0) = 100000
TPG(1977, 1) = 98993
TPG(1977, 2) = 98626
TPG(1977, 3) = 98563
TPG(1977, 4) = 98514
TPG(1977, 5) = 98475
TPG(1977, 6) = 98453
TPG(1977, 7) = 98431
TPG(1977, 8) = 98412
TPG(1977, 9) = 98392
TPG(1977, 10) = 98374
TPG(1977, 11) = 98361
TPG(1977, 12) = 98346
TPG(1977, 13) = 98330
TPG(1977, 14) = 98311
TPG(1977, 15) = 98289
TPG(1977, 16) = 98264
TPG(1977, 17) = 98235
TPG(1977, 18) = 98202
TPG(1977, 19) = 98167
TPG(1977, 20) = 98130
TPG(1977, 21) = 98092
TPG(1977, 22) = 98053
TPG(1977, 23) = 98012
TPG(1977, 24) = 97971
TPG(1977, 25) = 97929
TPG(1977, 26) = 97888
TPG(1977, 27) = 97847
TPG(1977, 28) = 97805
TPG(1977, 29) = 97763
TPG(1977, 30) = 97721
TPG(1977, 31) = 97677
TPG(1977, 32) = 97632
TPG(1977, 33) = 97587
TPG(1977, 34) = 97539
TPG(1977, 35) = 97489
TPG(1977, 36) = 97435
TPG(1977, 37) = 97379
TPG(1977, 38) = 97319
TPG(1977, 39) = 97256
TPG(1977, 40) = 97188
TPG(1977, 41) = 97116
TPG(1977, 42) = 97040
TPG(1977, 43) = 96959
TPG(1977, 44) = 96873
TPG(1977, 45) = 96781
TPG(1977, 46) = 96683
TPG(1977, 47) = 96579
TPG(1977, 48) = 96468
TPG(1977, 49) = 96349
TPG(1977, 50) = 96222
TPG(1977, 51) = 96085
TPG(1977, 52) = 95939
TPG(1977, 53) = 95781
TPG(1977, 54) = 95617
TPG(1977, 55) = 95445
TPG(1977, 56) = 95266
TPG(1977, 57) = 95079
TPG(1977, 58) = 94884
TPG(1977, 59) = 94686
TPG(1977, 60) = 94486
TPG(1977, 61) = 94283
TPG(1977, 62) = 94077
TPG(1977, 63) = 93870
TPG(1977, 64) = 93652
TPG(1977, 65) = 93423
TPG(1977, 66) = 93182
TPG(1977, 67) = 92929
TPG(1977, 68) = 92663
TPG(1977, 69) = 92362
TPG(1977, 70) = 92021
TPG(1977, 71) = 91633
TPG(1977, 72) = 91193
TPG(1977, 73) = 90692
TPG(1977, 74) = 90114
TPG(1977, 75) = 89447
TPG(1977, 76) = 88676
TPG(1977, 77) = 87786
TPG(1977, 78) = 86759
TPG(1977, 79) = 85590
TPG(1977, 80) = 84264
TPG(1977, 81) = 82759
TPG(1977, 82) = 81055
TPG(1977, 83) = 79129
TPG(1977, 84) = 76995
TPG(1977, 85) = 74637
TPG(1977, 86) = 72039
TPG(1977, 87) = 69188
TPG(1977, 88) = 66071
TPG(1977, 89) = 62732
TPG(1977, 90) = 59172
TPG(1977, 91) = 55401
TPG(1977, 92) = 51433
TPG(1977, 93) = 47289
TPG(1977, 94) = 43076
TPG(1977, 95) = 38829
TPG(1977, 96) = 34591
TPG(1977, 97) = 30411
TPG(1977, 98) = 26342
TPG(1977, 99) = 22436
TPG(1977, 100) = 18749
TPG(1977, 101) = 15333
TPG(1977, 102) = 12236
TPG(1977, 103) = 9493
TPG(1977, 104) = 7133
TPG(1977, 105) = 5164
TPG(1977, 106) = 3581
TPG(1977, 107) = 2362
TPG(1977, 108) = 1469
TPG(1977, 109) = 852
TPG(1977, 110) = 454
TPG(1977, 111) = 218
TPG(1977, 112) = 92
TPG(1977, 113) = 33
TPG(1977, 114) = 9
TPG(1977, 115) = 2
TPG(1977, 116) = 0
TPG(1977, 117) = 0
TPG(1991, 0) = 100000
TPG(1991, 1) = 99427
TPG(1991, 2) = 99217
TPG(1991, 3) = 99183
TPG(1991, 4) = 99154
TPG(1991, 5) = 99130
TPG(1991, 6) = 99114
TPG(1991, 7) = 99098
TPG(1991, 8) = 99083
TPG(1991, 9) = 99068
TPG(1991, 10) = 99054
TPG(1991, 11) = 99044
TPG(1991, 12) = 99033
TPG(1991, 13) = 99020
TPG(1991, 14) = 99004
TPG(1991, 15) = 98986
TPG(1991, 16) = 98964
TPG(1991, 17) = 98939
TPG(1991, 18) = 98909
TPG(1991, 19) = 98878
TPG(1991, 20) = 98845
TPG(1991, 21) = 98812
TPG(1991, 22) = 98778
TPG(1991, 23) = 98742
TPG(1991, 24) = 98707
TPG(1991, 25) = 98672
TPG(1991, 26) = 98637
TPG(1991, 27) = 98603
TPG(1991, 28) = 98570
TPG(1991, 29) = 98536
TPG(1991, 30) = 98501
TPG(1991, 31) = 98466
TPG(1991, 32) = 98431
TPG(1991, 33) = 98396
TPG(1991, 34) = 98358
TPG(1991, 35) = 98318
TPG(1991, 36) = 98276
TPG(1991, 37) = 98231
TPG(1991, 38) = 98184
TPG(1991, 39) = 98134
TPG(1991, 40) = 98080
TPG(1991, 41) = 98023
TPG(1991, 42) = 97963
TPG(1991, 43) = 97898
TPG(1991, 44) = 97830
TPG(1991, 45) = 97757
TPG(1991, 46) = 97680
TPG(1991, 47) = 97598
TPG(1991, 48) = 97511
TPG(1991, 49) = 97417
TPG(1991, 50) = 97315
TPG(1991, 51) = 97206
TPG(1991, 52) = 97089
TPG(1991, 53) = 96963
TPG(1991, 54) = 96831
TPG(1991, 55) = 96694
TPG(1991, 56) = 96551
TPG(1991, 57) = 96403
TPG(1991, 58) = 96249
TPG(1991, 59) = 96095
TPG(1991, 60) = 95940
TPG(1991, 61) = 95784
TPG(1991, 62) = 95629
TPG(1991, 63) = 95474
TPG(1991, 64) = 95311
TPG(1991, 65) = 95140
TPG(1991, 66) = 94961
TPG(1991, 67) = 94773
TPG(1991, 68) = 94576
TPG(1991, 69) = 94351
TPG(1991, 70) = 94093
TPG(1991, 71) = 93797
TPG(1991, 72) = 93458
TPG(1991, 73) = 93068
TPG(1991, 74) = 92614
TPG(1991, 75) = 92085
TPG(1991, 76) = 91468
TPG(1991, 77) = 90748
TPG(1991, 78) = 89909
TPG(1991, 79) = 88947
TPG(1991, 80) = 87846
TPG(1991, 81) = 86587
TPG(1991, 82) = 85148
TPG(1991, 83) = 83507
TPG(1991, 84) = 81673
TPG(1991, 85) = 79626
TPG(1991, 86) = 77348
TPG(1991, 87) = 74820
TPG(1991, 88) = 72025
TPG(1991, 89) = 68995
TPG(1991, 90) = 65723
TPG(1991, 91) = 62209
TPG(1991, 92) = 58455
TPG(1991, 93) = 54473
TPG(1991, 94) = 50360
TPG(1991, 95) = 46144
TPG(1991, 96) = 41859
TPG(1991, 97) = 37546
TPG(1991, 98) = 33253
TPG(1991, 99) = 29032
TPG(1991, 100) = 24940
TPG(1991, 101) = 21036
TPG(1991, 102) = 17378
TPG(1991, 103) = 14019
TPG(1991, 104) = 11007
TPG(1991, 105) = 8378
TPG(1991, 106) = 6152
TPG(1991, 107) = 4334
TPG(1991, 108) = 2908
TPG(1991, 109) = 1844
TPG(1991, 110) = 1093
TPG(1991, 111) = 597
TPG(1991, 112) = 295
TPG(1991, 113) = 129
TPG(1991, 114) = 48
TPG(1991, 115) = 15
TPG(1991, 116) = 3
TPG(1991, 117) = 0
TPG(1917, 0) = 100000
TPG(1917, 1) = 89596
TPG(1917, 2) = 86119
TPG(1917, 3) = 85343
TPG(1917, 4) = 84885
TPG(1917, 5) = 84610
TPG(1917, 6) = 84532
TPG(1917, 7) = 84462
TPG(1917, 8) = 84400
TPG(1917, 9) = 84343
TPG(1917, 10) = 84293
TPG(1917, 11) = 84258
TPG(1917, 12) = 84223
TPG(1917, 13) = 84186
TPG(1917, 14) = 84147
TPG(1917, 15) = 84107
TPG(1917, 16) = 84066
TPG(1917, 17) = 84022
TPG(1917, 18) = 83974
TPG(1917, 19) = 83923
TPG(1917, 20) = 83869
TPG(1917, 21) = 83809
TPG(1917, 22) = 83746
TPG(1917, 23) = 83680
TPG(1917, 24) = 83609
TPG(1917, 25) = 83534
TPG(1917, 26) = 83455
TPG(1917, 27) = 83372
TPG(1917, 28) = 83285
TPG(1917, 29) = 83193
TPG(1917, 30) = 83096
TPG(1917, 31) = 82994
TPG(1917, 32) = 82887
TPG(1917, 33) = 82775
TPG(1917, 34) = 82658
TPG(1917, 35) = 82535
TPG(1917, 36) = 82407
TPG(1917, 37) = 82272
TPG(1917, 38) = 82130
TPG(1917, 39) = 81980
TPG(1917, 40) = 81820
TPG(1917, 41) = 81649
TPG(1917, 42) = 81468
TPG(1917, 43) = 81276
TPG(1917, 44) = 81071
TPG(1917, 45) = 80851
TPG(1917, 46) = 80618
TPG(1917, 47) = 80368
TPG(1917, 48) = 80102
TPG(1917, 49) = 79822
TPG(1917, 50) = 79526
TPG(1917, 51) = 79213
TPG(1917, 52) = 78883
TPG(1917, 53) = 78534
TPG(1917, 54) = 78166
TPG(1917, 55) = 77776
TPG(1917, 56) = 77364
TPG(1917, 57) = 76929
TPG(1917, 58) = 76470
TPG(1917, 59) = 75984
TPG(1917, 60) = 75469
TPG(1917, 61) = 74926
TPG(1917, 62) = 74353
TPG(1917, 63) = 73751
TPG(1917, 64) = 73113
TPG(1917, 65) = 72438
TPG(1917, 66) = 71724
TPG(1917, 67) = 70969
TPG(1917, 68) = 70174
TPG(1917, 69) = 69313
TPG(1917, 70) = 68383
TPG(1917, 71) = 67377
TPG(1917, 72) = 66289
TPG(1917, 73) = 65113
TPG(1917, 74) = 63818
TPG(1917, 75) = 62393
TPG(1917, 76) = 60829
TPG(1917, 77) = 59113
TPG(1917, 78) = 57234
TPG(1917, 79) = 55191
TPG(1917, 80) = 52975
TPG(1917, 81) = 50581
TPG(1917, 82) = 48007
TPG(1917, 83) = 45252
TPG(1917, 84) = 42364
TPG(1917, 85) = 39356
TPG(1917, 86) = 36245
TPG(1917, 87) = 33052
TPG(1917, 88) = 29804
TPG(1917, 89) = 26580
TPG(1917, 90) = 23413
TPG(1917, 91) = 20338
TPG(1917, 92) = 17391
TPG(1917, 93) = 14609
TPG(1917, 94) = 12056
TPG(1917, 95) = 9753
TPG(1917, 96) = 7716
TPG(1917, 97) = 5952
TPG(1917, 98) = 4463
TPG(1917, 99) = 3240
TPG(1917, 100) = 2267
TPG(1917, 101) = 1521
TPG(1917, 102) = 971
TPG(1917, 103) = 586
TPG(1917, 104) = 331
TPG(1917, 105) = 173
TPG(1917, 106) = 82
TPG(1917, 107) = 35
TPG(1917, 108) = 13
TPG(1917, 109) = 4
TPG(1917, 110) = 0
TPG(1917, 111) = 0
TPG(1917, 112) = 0
TPG(1917, 113) = 0
TPG(1917, 114) = 0
TPG(1917, 115) = 0
TPG(1917, 116) = 0
TPG(1917, 117) = 0
TPG(1918, 0) = 100000
TPG(1918, 1) = 89969
TPG(1918, 2) = 86605
TPG(1918, 3) = 85858
TPG(1918, 4) = 85415
TPG(1918, 5) = 85149
TPG(1918, 6) = 85072
TPG(1918, 7) = 85003
TPG(1918, 8) = 84941
TPG(1918, 9) = 84886
TPG(1918, 10) = 84836
TPG(1918, 11) = 84802
TPG(1918, 12) = 84767
TPG(1918, 13) = 84730
TPG(1918, 14) = 84692
TPG(1918, 15) = 84651
TPG(1918, 16) = 84611
TPG(1918, 17) = 84566
TPG(1918, 18) = 84519
TPG(1918, 19) = 84468
TPG(1918, 20) = 84414
TPG(1918, 21) = 84355
TPG(1918, 22) = 84292
TPG(1918, 23) = 84225
TPG(1918, 24) = 84155
TPG(1918, 25) = 84081
TPG(1918, 26) = 84002
TPG(1918, 27) = 83920
TPG(1918, 28) = 83833
TPG(1918, 29) = 83742
TPG(1918, 30) = 83646
TPG(1918, 31) = 83545
TPG(1918, 32) = 83440
TPG(1918, 33) = 83329
TPG(1918, 34) = 83214
TPG(1918, 35) = 83092
TPG(1918, 36) = 82965
TPG(1918, 37) = 82832
TPG(1918, 38) = 82691
TPG(1918, 39) = 82542
TPG(1918, 40) = 82384
TPG(1918, 41) = 82216
TPG(1918, 42) = 82036
TPG(1918, 43) = 81846
TPG(1918, 44) = 81643
TPG(1918, 45) = 81426
TPG(1918, 46) = 81195
TPG(1918, 47) = 80948
TPG(1918, 48) = 80685
TPG(1918, 49) = 80407
TPG(1918, 50) = 80114
TPG(1918, 51) = 79804
TPG(1918, 52) = 79477
TPG(1918, 53) = 79131
TPG(1918, 54) = 78766
TPG(1918, 55) = 78380
TPG(1918, 56) = 77972
TPG(1918, 57) = 77541
TPG(1918, 58) = 77087
TPG(1918, 59) = 76606
TPG(1918, 60) = 76097
TPG(1918, 61) = 75560
TPG(1918, 62) = 74994
TPG(1918, 63) = 74400
TPG(1918, 64) = 73770
TPG(1918, 65) = 73104
TPG(1918, 66) = 72399
TPG(1918, 67) = 71654
TPG(1918, 68) = 70869
TPG(1918, 69) = 70019
TPG(1918, 70) = 69099
TPG(1918, 71) = 68104
TPG(1918, 72) = 67026
TPG(1918, 73) = 65859
TPG(1918, 74) = 64574
TPG(1918, 75) = 63158
TPG(1918, 76) = 61602
TPG(1918, 77) = 59894
TPG(1918, 78) = 58022
TPG(1918, 79) = 55983
TPG(1918, 80) = 53770
TPG(1918, 81) = 51377
TPG(1918, 82) = 48801
TPG(1918, 83) = 46040
TPG(1918, 84) = 43143
TPG(1918, 85) = 40122
TPG(1918, 86) = 36992
TPG(1918, 87) = 33774
TPG(1918, 88) = 30497
TPG(1918, 89) = 27239
TPG(1918, 90) = 24032
TPG(1918, 91) = 20911
TPG(1918, 92) = 17915
TPG(1918, 93) = 15080
TPG(1918, 94) = 12473
TPG(1918, 95) = 10115
TPG(1918, 96) = 8023
TPG(1918, 97) = 6208
TPG(1918, 98) = 4669
TPG(1918, 99) = 3402
TPG(1918, 100) = 2390
TPG(1918, 101) = 1610
TPG(1918, 102) = 1033
TPG(1918, 103) = 627
TPG(1918, 104) = 357
TPG(1918, 105) = 187
TPG(1918, 106) = 90
TPG(1918, 107) = 38
TPG(1918, 108) = 14
TPG(1918, 109) = 4
TPG(1918, 110) = 0
TPG(1918, 111) = 0
TPG(1918, 112) = 0
TPG(1918, 113) = 0
TPG(1918, 114) = 0
TPG(1918, 115) = 0
TPG(1918, 116) = 0
TPG(1918, 117) = 0
TPG(1945, 0) = 100000
TPG(1945, 1) = 96407
TPG(1945, 2) = 95134
TPG(1945, 3) = 94884
TPG(1945, 4) = 94716
TPG(1945, 5) = 94601
TPG(1945, 6) = 94555
TPG(1945, 7) = 94513
TPG(1945, 8) = 94475
TPG(1945, 9) = 94439
TPG(1945, 10) = 94406
TPG(1945, 11) = 94384
TPG(1945, 12) = 94359
TPG(1945, 13) = 94333
TPG(1945, 14) = 94304
TPG(1945, 15) = 94272
TPG(1945, 16) = 94238
TPG(1945, 17) = 94200
TPG(1945, 18) = 94158
TPG(1945, 19) = 94114
TPG(1945, 20) = 94066
TPG(1945, 21) = 94017
TPG(1945, 22) = 93964
TPG(1945, 23) = 93909
TPG(1945, 24) = 93851
TPG(1945, 25) = 93792
TPG(1945, 26) = 93731
TPG(1945, 27) = 93669
TPG(1945, 28) = 93605
TPG(1945, 29) = 93538
TPG(1945, 30) = 93469
TPG(1945, 31) = 93398
TPG(1945, 32) = 93324
TPG(1945, 33) = 93248
TPG(1945, 34) = 93167
TPG(1945, 35) = 93083
TPG(1945, 36) = 92994
TPG(1945, 37) = 92900
TPG(1945, 38) = 92801
TPG(1945, 39) = 92696
TPG(1945, 40) = 92584
TPG(1945, 41) = 92465
TPG(1945, 42) = 92339
TPG(1945, 43) = 92205
TPG(1945, 44) = 92062
TPG(1945, 45) = 91909
TPG(1945, 46) = 91746
TPG(1945, 47) = 91573
TPG(1945, 48) = 91388
TPG(1945, 49) = 91191
TPG(1945, 50) = 90982
TPG(1945, 51) = 90760
TPG(1945, 52) = 90523
TPG(1945, 53) = 90271
TPG(1945, 54) = 90006
TPG(1945, 55) = 89727
TPG(1945, 56) = 89434
TPG(1945, 57) = 89126
TPG(1945, 58) = 88803
TPG(1945, 59) = 88467
TPG(1945, 60) = 88119
TPG(1945, 61) = 87758
TPG(1945, 62) = 87384
TPG(1945, 63) = 86998
TPG(1945, 64) = 86591
TPG(1945, 65) = 86160
TPG(1945, 66) = 85705
TPG(1945, 67) = 85225
TPG(1945, 68) = 84719
TPG(1945, 69) = 84159
TPG(1945, 70) = 83539
TPG(1945, 71) = 82853
TPG(1945, 72) = 82091
TPG(1945, 73) = 81247
TPG(1945, 74) = 80296
TPG(1945, 75) = 79222
TPG(1945, 76) = 78013
TPG(1945, 77) = 76651
TPG(1945, 78) = 75119
TPG(1945, 79) = 73413
TPG(1945, 80) = 71516
TPG(1945, 81) = 69414
TPG(1945, 82) = 67090
TPG(1945, 83) = 64529
TPG(1945, 84) = 61763
TPG(1945, 85) = 58787
TPG(1945, 86) = 55602
TPG(1945, 87) = 52212
TPG(1945, 88) = 48627
TPG(1945, 89) = 44918
TPG(1945, 90) = 41107
TPG(1945, 91) = 37228
TPG(1945, 92) = 33317
TPG(1945, 93) = 29417
TPG(1945, 94) = 25631
TPG(1945, 95) = 22003
TPG(1945, 96) = 18575
TPG(1945, 97) = 15388
TPG(1945, 98) = 12481
TPG(1945, 99) = 9882
TPG(1945, 100) = 7614
TPG(1945, 101) = 5687
TPG(1945, 102) = 4099
TPG(1945, 103) = 2836
TPG(1945, 104) = 1871
TPG(1945, 105) = 1167
TPG(1945, 106) = 683
TPG(1945, 107) = 369
TPG(1945, 108) = 182
TPG(1945, 109) = 80
TPG(1945, 110) = 30
TPG(1945, 111) = 9
TPG(1945, 112) = 2
TPG(1945, 113) = 0
TPG(1945, 114) = 0
TPG(1945, 115) = 0
TPG(1945, 116) = 0
TPG(1945, 117) = 0
TPG(1946, 0) = 100000
TPG(1946, 1) = 96545
TPG(1946, 2) = 95320
TPG(1946, 3) = 95080
TPG(1946, 4) = 94917
TPG(1946, 5) = 94806
TPG(1946, 6) = 94762
TPG(1946, 7) = 94721
TPG(1946, 8) = 94683
TPG(1946, 9) = 94648
TPG(1946, 10) = 94615
TPG(1946, 11) = 94593
TPG(1946, 12) = 94569
TPG(1946, 13) = 94543
TPG(1946, 14) = 94515
TPG(1946, 15) = 94483
TPG(1946, 16) = 94449
TPG(1946, 17) = 94411
TPG(1946, 18) = 94370
TPG(1946, 19) = 94326
TPG(1946, 20) = 94279
TPG(1946, 21) = 94230
TPG(1946, 22) = 94177
TPG(1946, 23) = 94122
TPG(1946, 24) = 94066
TPG(1946, 25) = 94007
TPG(1946, 26) = 93947
TPG(1946, 27) = 93885
TPG(1946, 28) = 93822
TPG(1946, 29) = 93756
TPG(1946, 30) = 93688
TPG(1946, 31) = 93618
TPG(1946, 32) = 93545
TPG(1946, 33) = 93470
TPG(1946, 34) = 93391
TPG(1946, 35) = 93308
TPG(1946, 36) = 93220
TPG(1946, 37) = 93127
TPG(1946, 38) = 93030
TPG(1946, 39) = 92926
TPG(1946, 40) = 92816
TPG(1946, 41) = 92699
TPG(1946, 42) = 92575
TPG(1946, 43) = 92442
TPG(1946, 44) = 92301
TPG(1946, 45) = 92151
TPG(1946, 46) = 91991
TPG(1946, 47) = 91820
TPG(1946, 48) = 91638
TPG(1946, 49) = 91444
TPG(1946, 50) = 91238
TPG(1946, 51) = 91018
TPG(1946, 52) = 90785
TPG(1946, 53) = 90536
TPG(1946, 54) = 90275
TPG(1946, 55) = 90000
TPG(1946, 56) = 89711
TPG(1946, 57) = 89407
TPG(1946, 58) = 89089
TPG(1946, 59) = 88759
TPG(1946, 60) = 88416
TPG(1946, 61) = 88060
TPG(1946, 62) = 87693
TPG(1946, 63) = 87315
TPG(1946, 64) = 86914
TPG(1946, 65) = 86491
TPG(1946, 66) = 86045
TPG(1946, 67) = 85574
TPG(1946, 68) = 85077
TPG(1946, 69) = 84527
TPG(1946, 70) = 83918
TPG(1946, 71) = 83242
TPG(1946, 72) = 82493
TPG(1946, 73) = 81661
TPG(1946, 74) = 80722
TPG(1946, 75) = 79663
TPG(1946, 76) = 78468
TPG(1946, 77) = 77122
TPG(1946, 78) = 75606
TPG(1946, 79) = 73916
TPG(1946, 80) = 72037
TPG(1946, 81) = 69952
TPG(1946, 82) = 67645
TPG(1946, 83) = 65100
TPG(1946, 84) = 62349
TPG(1946, 85) = 59388
TPG(1946, 86) = 56214
TPG(1946, 87) = 52832
TPG(1946, 88) = 49251
TPG(1946, 89) = 45541
TPG(1946, 90) = 41726
TPG(1946, 91) = 37835
TPG(1946, 92) = 33906
TPG(1946, 93) = 29983
TPG(1946, 94) = 26167
TPG(1946, 95) = 22503
TPG(1946, 96) = 19035
TPG(1946, 97) = 15804
TPG(1946, 98) = 12849
TPG(1946, 99) = 10201
TPG(1946, 100) = 7883
TPG(1946, 101) = 5907
TPG(1946, 102) = 4274
TPG(1946, 103) = 2969
TPG(1946, 104) = 1968
TPG(1946, 105) = 1235
TPG(1946, 106) = 727
TPG(1946, 107) = 396
TPG(1946, 108) = 197
TPG(1946, 109) = 87
TPG(1946, 110) = 33
TPG(1946, 111) = 11
TPG(1946, 112) = 3
TPG(1946, 113) = 0
TPG(1946, 114) = 0
TPG(1946, 115) = 0
TPG(1946, 116) = 0
TPG(1946, 117) = 0
TPG(1969, 0) = 100000
TPG(1969, 1) = 98612
TPG(1969, 2) = 98110
TPG(1969, 3) = 98020
TPG(1969, 4) = 97953
TPG(1969, 5) = 97901
TPG(1969, 6) = 97874
TPG(1969, 7) = 97849
TPG(1969, 8) = 97825
TPG(1969, 9) = 97803
TPG(1969, 10) = 97781
TPG(1969, 11) = 97766
TPG(1969, 12) = 97750
TPG(1969, 13) = 97731
TPG(1969, 14) = 97710
TPG(1969, 15) = 97686
TPG(1969, 16) = 97659
TPG(1969, 17) = 97628
TPG(1969, 18) = 97592
TPG(1969, 19) = 97555
TPG(1969, 20) = 97516
TPG(1969, 21) = 97475
TPG(1969, 22) = 97432
TPG(1969, 23) = 97388
TPG(1969, 24) = 97343
TPG(1969, 25) = 97298
TPG(1969, 26) = 97252
TPG(1969, 27) = 97206
TPG(1969, 28) = 97160
TPG(1969, 29) = 97112
TPG(1969, 30) = 97064
TPG(1969, 31) = 97014
TPG(1969, 32) = 96964
TPG(1969, 33) = 96912
TPG(1969, 34) = 96857
TPG(1969, 35) = 96799
TPG(1969, 36) = 96738
TPG(1969, 37) = 96674
TPG(1969, 38) = 96606
TPG(1969, 39) = 96534
TPG(1969, 40) = 96457
TPG(1969, 41) = 96375
TPG(1969, 42) = 96288
TPG(1969, 43) = 96195
TPG(1969, 44) = 96097
TPG(1969, 45) = 95992
TPG(1969, 46) = 95881
TPG(1969, 47) = 95762
TPG(1969, 48) = 95635
TPG(1969, 49) = 95500
TPG(1969, 50) = 95355
TPG(1969, 51) = 95200
TPG(1969, 52) = 95034
TPG(1969, 53) = 94856
TPG(1969, 54) = 94669
TPG(1969, 55) = 94474
TPG(1969, 56) = 94271
TPG(1969, 57) = 94058
TPG(1969, 58) = 93836
TPG(1969, 59) = 93609
TPG(1969, 60) = 93377
TPG(1969, 61) = 93141
TPG(1969, 62) = 92901
TPG(1969, 63) = 92658
TPG(1969, 64) = 92402
TPG(1969, 65) = 92132
TPG(1969, 66) = 91847
TPG(1969, 67) = 91548
TPG(1969, 68) = 91234
TPG(1969, 69) = 90880
TPG(1969, 70) = 90480
TPG(1969, 71) = 90030
TPG(1969, 72) = 89521
TPG(1969, 73) = 88946
TPG(1969, 74) = 88286
TPG(1969, 75) = 87528
TPG(1969, 76) = 86657
TPG(1969, 77) = 85658
TPG(1969, 78) = 84511
TPG(1969, 79) = 83214
TPG(1969, 80) = 81748
TPG(1969, 81) = 80093
TPG(1969, 82) = 78230
TPG(1969, 83) = 76136
TPG(1969, 84) = 73829
TPG(1969, 85) = 71295
TPG(1969, 86) = 68521
TPG(1969, 87) = 65496
TPG(1969, 88) = 62215
TPG(1969, 89) = 58726
TPG(1969, 90) = 55037
TPG(1969, 91) = 51163
TPG(1969, 92) = 47125
TPG(1969, 93) = 42951
TPG(1969, 94) = 38749
TPG(1969, 95) = 34560
TPG(1969, 96) = 30430
TPG(1969, 97) = 26409
TPG(1969, 98) = 22548
TPG(1969, 99) = 18901
TPG(1969, 100) = 15516
TPG(1969, 101) = 12440
TPG(1969, 102) = 9708
TPG(1969, 103) = 7345
TPG(1969, 104) = 5364
TPG(1969, 105) = 3760
TPG(1969, 106) = 2513
TPG(1969, 107) = 1588
TPG(1969, 108) = 940
TPG(1969, 109) = 514
TPG(1969, 110) = 255
TPG(1969, 111) = 113
TPG(1969, 112) = 43
TPG(1969, 113) = 13
TPG(1969, 114) = 3
TPG(1969, 115) = 0
TPG(1969, 116) = 0
TPG(1969, 117) = 0
End Function

Function IniTPG4()
TPG(1983, 0) = 100000
TPG(1983, 1) = 99209
TPG(1983, 2) = 98920
TPG(1983, 3) = 98871
TPG(1983, 4) = 98832
TPG(1983, 5) = 98801
TPG(1983, 6) = 98781
TPG(1983, 7) = 98762
TPG(1983, 8) = 98744
TPG(1983, 9) = 98727
TPG(1983, 10) = 98711
TPG(1983, 11) = 98699
TPG(1983, 12) = 98686
TPG(1983, 13) = 98671
TPG(1983, 14) = 98654
TPG(1983, 15) = 98634
TPG(1983, 16) = 98610
TPG(1983, 17) = 98583
TPG(1983, 18) = 98551
TPG(1983, 19) = 98517
TPG(1983, 20) = 98483
TPG(1983, 21) = 98447
TPG(1983, 22) = 98410
TPG(1983, 23) = 98371
TPG(1983, 24) = 98333
TPG(1983, 25) = 98294
TPG(1983, 26) = 98256
TPG(1983, 27) = 98218
TPG(1983, 28) = 98180
TPG(1983, 29) = 98142
TPG(1983, 30) = 98102
TPG(1983, 31) = 98063
TPG(1983, 32) = 98023
TPG(1983, 33) = 97982
TPG(1983, 34) = 97939
TPG(1983, 35) = 97893
TPG(1983, 36) = 97845
TPG(1983, 37) = 97794
TPG(1983, 38) = 97739
TPG(1983, 39) = 97682
TPG(1983, 40) = 97621
TPG(1983, 41) = 97556
TPG(1983, 42) = 97487
TPG(1983, 43) = 97413
TPG(1983, 44) = 97335
TPG(1983, 45) = 97252
TPG(1983, 46) = 97163
TPG(1983, 47) = 97069
TPG(1983, 48) = 96969
TPG(1983, 49) = 96862
TPG(1983, 50) = 96746
TPG(1983, 51) = 96622
TPG(1983, 52) = 96489
TPG(1983, 53) = 96345
TPG(1983, 54) = 96196
TPG(1983, 55) = 96040
TPG(1983, 56) = 95877
TPG(1983, 57) = 95708
TPG(1983, 58) = 95532
TPG(1983, 59) = 95354
TPG(1983, 60) = 95174
TPG(1983, 61) = 94993
TPG(1983, 62) = 94810
TPG(1983, 63) = 94627
TPG(1983, 64) = 94435
TPG(1983, 65) = 94233
TPG(1983, 66) = 94020
TPG(1983, 67) = 93797
TPG(1983, 68) = 93563
TPG(1983, 69) = 93297
TPG(1983, 70) = 92994
TPG(1983, 71) = 92648
TPG(1983, 72) = 92254
TPG(1983, 73) = 91804
TPG(1983, 74) = 91282
TPG(1983, 75) = 90677
TPG(1983, 76) = 89976
TPG(1983, 77) = 89162
TPG(1983, 78) = 88219
TPG(1983, 79) = 87142
TPG(1983, 80) = 85915
TPG(1983, 81) = 84519
TPG(1983, 82) = 82931
TPG(1983, 83) = 81130
TPG(1983, 84) = 79126
TPG(1983, 85) = 76902
TPG(1983, 86) = 74440
TPG(1983, 87) = 71726
TPG(1983, 88) = 68743
TPG(1983, 89) = 65531
TPG(1983, 90) = 62087
TPG(1983, 91) = 58416
TPG(1983, 92) = 54527
TPG(1983, 93) = 50438
TPG(1983, 94) = 46250
TPG(1983, 95) = 41997
TPG(1983, 96) = 37719
TPG(1983, 97) = 33461
TPG(1983, 98) = 29273
TPG(1983, 99) = 25210
TPG(1983, 100) = 21329
TPG(1983, 101) = 17686
TPG(1983, 102) = 14334
TPG(1983, 103) = 11317
TPG(1983, 104) = 8672
TPG(1983, 105) = 6421
TPG(1983, 106) = 4569
TPG(1983, 107) = 3104
TPG(1983, 108) = 1998
TPG(1983, 109) = 1206
TPG(1983, 110) = 674
TPG(1983, 111) = 344
TPG(1983, 112) = 156
TPG(1983, 113) = 61
TPG(1983, 114) = 20
TPG(1983, 115) = 5
TPG(1983, 116) = 1
TPG(1983, 117) = 0
TPG(1931, 0) = 100000
TPG(1931, 1) = 93827
TPG(1931, 2) = 91690
TPG(1931, 3) = 91244
TPG(1931, 4) = 90962
TPG(1931, 5) = 90782
TPG(1931, 6) = 90721
TPG(1931, 7) = 90666
TPG(1931, 8) = 90616
TPG(1931, 9) = 90571
TPG(1931, 10) = 90530
TPG(1931, 11) = 90501
TPG(1931, 12) = 90472
TPG(1931, 13) = 90440
TPG(1931, 14) = 90406
TPG(1931, 15) = 90370
TPG(1931, 16) = 90330
TPG(1931, 17) = 90287
TPG(1931, 18) = 90242
TPG(1931, 19) = 90194
TPG(1931, 20) = 90143
TPG(1931, 21) = 90088
TPG(1931, 22) = 90030
TPG(1931, 23) = 89968
TPG(1931, 24) = 89903
TPG(1931, 25) = 89836
TPG(1931, 26) = 89765
TPG(1931, 27) = 89692
TPG(1931, 28) = 89616
TPG(1931, 29) = 89537
TPG(1931, 30) = 89454
TPG(1931, 31) = 89368
TPG(1931, 32) = 89278
TPG(1931, 33) = 89184
TPG(1931, 34) = 89086
TPG(1931, 35) = 88982
TPG(1931, 36) = 88874
TPG(1931, 37) = 88759
TPG(1931, 38) = 88639
TPG(1931, 39) = 88512
TPG(1931, 40) = 88376
TPG(1931, 41) = 88231
TPG(1931, 42) = 88078
TPG(1931, 43) = 87915
TPG(1931, 44) = 87740
TPG(1931, 45) = 87555
TPG(1931, 46) = 87357
TPG(1931, 47) = 87145
TPG(1931, 48) = 86920
TPG(1931, 49) = 86681
TPG(1931, 50) = 86429
TPG(1931, 51) = 86161
TPG(1931, 52) = 85876
TPG(1931, 53) = 85575
TPG(1931, 54) = 85257
TPG(1931, 55) = 84922
TPG(1931, 56) = 84569
TPG(1931, 57) = 84197
TPG(1931, 58) = 83805
TPG(1931, 59) = 83394
TPG(1931, 60) = 82964
TPG(1931, 61) = 82513
TPG(1931, 62) = 82042
TPG(1931, 63) = 81551
TPG(1931, 64) = 81032
TPG(1931, 65) = 80482
TPG(1931, 66) = 79902
TPG(1931, 67) = 79288
TPG(1931, 68) = 78641
TPG(1931, 69) = 77933
TPG(1931, 70) = 77158
TPG(1931, 71) = 76309
TPG(1931, 72) = 75379
TPG(1931, 73) = 74360
TPG(1931, 74) = 73225
TPG(1931, 75) = 71959
TPG(1931, 76) = 70550
TPG(1931, 77) = 68983
TPG(1931, 78) = 67244
TPG(1931, 79) = 65328
TPG(1931, 80) = 63222
TPG(1931, 81) = 60916
TPG(1931, 82) = 58398
TPG(1931, 83) = 55662
TPG(1931, 84) = 52748
TPG(1931, 85) = 49659
TPG(1931, 86) = 46405
TPG(1931, 87) = 42999
TPG(1931, 88) = 39463
TPG(1931, 89) = 35872
TPG(1931, 90) = 32260
TPG(1931, 91) = 28662
TPG(1931, 92) = 25119
TPG(1931, 93) = 21675
TPG(1931, 94) = 18418
TPG(1931, 95) = 15382
TPG(1931, 96) = 12600
TPG(1931, 97) = 10099
TPG(1931, 98) = 7897
TPG(1931, 99) = 6005
TPG(1931, 100) = 4424
TPG(1931, 101) = 3143
TPG(1931, 102) = 2141
TPG(1931, 103) = 1390
TPG(1931, 104) = 853
TPG(1931, 105) = 490
TPG(1931, 106) = 260
TPG(1931, 107) = 126
TPG(1931, 108) = 54
TPG(1931, 109) = 20
TPG(1931, 110) = 6
TPG(1931, 111) = 1
TPG(1931, 112) = 0
TPG(1931, 113) = 0
TPG(1931, 114) = 0
TPG(1931, 115) = 0
TPG(1931, 116) = 0
TPG(1931, 117) = 0
TPG(1932, 0) = 100000
TPG(1932, 1) = 94058
TPG(1932, 2) = 91997
TPG(1932, 3) = 91569
TPG(1932, 4) = 91296
TPG(1932, 5) = 91122
TPG(1932, 6) = 91062
TPG(1932, 7) = 91009
TPG(1932, 8) = 90960
TPG(1932, 9) = 90915
TPG(1932, 10) = 90874
TPG(1932, 11) = 90847
TPG(1932, 12) = 90817
TPG(1932, 13) = 90786
TPG(1932, 14) = 90752
TPG(1932, 15) = 90716
TPG(1932, 16) = 90676
TPG(1932, 17) = 90634
TPG(1932, 18) = 90589
TPG(1932, 19) = 90541
TPG(1932, 20) = 90490
TPG(1932, 21) = 90436
TPG(1932, 22) = 90378
TPG(1932, 23) = 90317
TPG(1932, 24) = 90252
TPG(1932, 25) = 90185
TPG(1932, 26) = 90116
TPG(1932, 27) = 90044
TPG(1932, 28) = 89969
TPG(1932, 29) = 89890
TPG(1932, 30) = 89809
TPG(1932, 31) = 89723
TPG(1932, 32) = 89634
TPG(1932, 33) = 89542
TPG(1932, 34) = 89445
TPG(1932, 35) = 89343
TPG(1932, 36) = 89235
TPG(1932, 37) = 89123
TPG(1932, 38) = 89004
TPG(1932, 39) = 88878
TPG(1932, 40) = 88744
TPG(1932, 41) = 88602
TPG(1932, 42) = 88450
TPG(1932, 43) = 88289
TPG(1932, 44) = 88117
TPG(1932, 45) = 87934
TPG(1932, 46) = 87738
TPG(1932, 47) = 87530
TPG(1932, 48) = 87307
TPG(1932, 49) = 87072
TPG(1932, 50) = 86822
TPG(1932, 51) = 86558
TPG(1932, 52) = 86277
TPG(1932, 53) = 85979
TPG(1932, 54) = 85665
TPG(1932, 55) = 85334
TPG(1932, 56) = 84985
TPG(1932, 57) = 84618
TPG(1932, 58) = 84231
TPG(1932, 59) = 83826
TPG(1932, 60) = 83401
TPG(1932, 61) = 82957
TPG(1932, 62) = 82493
TPG(1932, 63) = 82011
TPG(1932, 64) = 81500
TPG(1932, 65) = 80959
TPG(1932, 66) = 80388
TPG(1932, 67) = 79784
TPG(1932, 68) = 79148
TPG(1932, 69) = 78451
TPG(1932, 70) = 77687
TPG(1932, 71) = 76850
TPG(1932, 72) = 75932
TPG(1932, 73) = 74925
TPG(1932, 74) = 73803
TPG(1932, 75) = 72550
TPG(1932, 76) = 71155
TPG(1932, 77) = 69601
TPG(1932, 78) = 67875
TPG(1932, 79) = 65972
TPG(1932, 80) = 63879
TPG(1932, 81) = 61584
TPG(1932, 82) = 59077
TPG(1932, 83) = 56349
TPG(1932, 84) = 53440
TPG(1932, 85) = 50354
TPG(1932, 86) = 47099
TPG(1932, 87) = 43687
TPG(1932, 88) = 40140
TPG(1932, 89) = 36533
TPG(1932, 90) = 32899
TPG(1932, 91) = 29272
TPG(1932, 92) = 25695
TPG(1932, 93) = 22212
TPG(1932, 94) = 18910
TPG(1932, 95) = 15826
TPG(1932, 96) = 12994
TPG(1932, 97) = 10441
TPG(1932, 98) = 8187
TPG(1932, 99) = 6245
TPG(1932, 100) = 4616
TPG(1932, 101) = 3292
TPG(1932, 102) = 2253
TPG(1932, 103) = 1470
TPG(1932, 104) = 907
TPG(1932, 105) = 524
TPG(1932, 106) = 280
TPG(1932, 107) = 137
TPG(1932, 108) = 59
TPG(1932, 109) = 22
TPG(1932, 110) = 7
TPG(1932, 111) = 2
TPG(1932, 112) = 0
TPG(1932, 113) = 0
TPG(1932, 114) = 0
TPG(1932, 115) = 0
TPG(1932, 116) = 0
TPG(1932, 117) = 0
TPG(1959, 0) = 100000
TPG(1959, 1) = 97932
TPG(1959, 2) = 97189
TPG(1959, 3) = 97051
TPG(1959, 4) = 96952
TPG(1959, 5) = 96880
TPG(1959, 6) = 96846
TPG(1959, 7) = 96815
TPG(1959, 8) = 96785
TPG(1959, 9) = 96758
TPG(1959, 10) = 96731
TPG(1959, 11) = 96714
TPG(1959, 12) = 96694
TPG(1959, 13) = 96673
TPG(1959, 14) = 96648
TPG(1959, 15) = 96621
TPG(1959, 16) = 96591
TPG(1959, 17) = 96557
TPG(1959, 18) = 96519
TPG(1959, 19) = 96479
TPG(1959, 20) = 96436
TPG(1959, 21) = 96392
TPG(1959, 22) = 96345
TPG(1959, 23) = 96296
TPG(1959, 24) = 96246
TPG(1959, 25) = 96196
TPG(1959, 26) = 96144
TPG(1959, 27) = 96091
TPG(1959, 28) = 96038
TPG(1959, 29) = 95983
TPG(1959, 30) = 95927
TPG(1959, 31) = 95869
TPG(1959, 32) = 95810
TPG(1959, 33) = 95748
TPG(1959, 34) = 95684
TPG(1959, 35) = 95616
TPG(1959, 36) = 95544
TPG(1959, 37) = 95469
TPG(1959, 38) = 95389
TPG(1959, 39) = 95304
TPG(1959, 40) = 95214
TPG(1959, 41) = 95118
TPG(1959, 42) = 95016
TPG(1959, 43) = 94907
TPG(1959, 44) = 94792
TPG(1959, 45) = 94669
TPG(1959, 46) = 94537
TPG(1959, 47) = 94398
TPG(1959, 48) = 94249
TPG(1959, 49) = 94090
TPG(1959, 50) = 93921
TPG(1959, 51) = 93740
TPG(1959, 52) = 93546
TPG(1959, 53) = 93339
TPG(1959, 54) = 93122
TPG(1959, 55) = 92895
TPG(1959, 56) = 92657
TPG(1959, 57) = 92408
TPG(1959, 58) = 92147
TPG(1959, 59) = 91878
TPG(1959, 60) = 91602
TPG(1959, 61) = 91319
TPG(1959, 62) = 91029
TPG(1959, 63) = 90733
TPG(1959, 64) = 90420
TPG(1959, 65) = 90090
TPG(1959, 66) = 89742
TPG(1959, 67) = 89376
TPG(1959, 68) = 88991
TPG(1959, 69) = 88559
TPG(1959, 70) = 88077
TPG(1959, 71) = 87536
TPG(1959, 72) = 86930
TPG(1959, 73) = 86251
TPG(1959, 74) = 85476
TPG(1959, 75) = 84593
TPG(1959, 76) = 83587
TPG(1959, 77) = 82441
TPG(1959, 78) = 81137
TPG(1959, 79) = 79670
TPG(1959, 80) = 78023
TPG(1959, 81) = 76177
TPG(1959, 82) = 74113
TPG(1959, 83) = 71813
TPG(1959, 84) = 69297
TPG(1959, 85) = 66556
TPG(1959, 86) = 63581
TPG(1959, 87) = 60368
TPG(1959, 88) = 56917
TPG(1959, 89) = 53285
TPG(1959, 90) = 49489
TPG(1959, 91) = 45549
TPG(1959, 92) = 41494
TPG(1959, 93) = 37362
TPG(1959, 94) = 33260
TPG(1959, 95) = 29232
TPG(1959, 96) = 25325
TPG(1959, 97) = 21588
TPG(1959, 98) = 18071
TPG(1959, 99) = 14818
TPG(1959, 100) = 11870
TPG(1959, 101) = 9260
TPG(1959, 102) = 7007
TPG(1959, 103) = 5122
TPG(1959, 104) = 3596
TPG(1959, 105) = 2411
TPG(1959, 106) = 1530
TPG(1959, 107) = 911
TPG(1959, 108) = 503
TPG(1959, 109) = 253
TPG(1959, 110) = 114
TPG(1959, 111) = 44
TPG(1959, 112) = 14
TPG(1959, 113) = 4
TPG(1959, 114) = 1
TPG(1959, 115) = 0
TPG(1959, 116) = 0
TPG(1959, 117) = 0
TPG(1960, 0) = 100000
TPG(1960, 1) = 98012
TPG(1960, 2) = 97298
TPG(1960, 3) = 97166
TPG(1960, 4) = 97070
TPG(1960, 5) = 97001
TPG(1960, 6) = 96968
TPG(1960, 7) = 96937
TPG(1960, 8) = 96908
TPG(1960, 9) = 96881
TPG(1960, 10) = 96855
TPG(1960, 11) = 96838
TPG(1960, 12) = 96819
TPG(1960, 13) = 96797
TPG(1960, 14) = 96773
TPG(1960, 15) = 96747
TPG(1960, 16) = 96717
TPG(1960, 17) = 96683
TPG(1960, 18) = 96645
TPG(1960, 19) = 96605
TPG(1960, 20) = 96563
TPG(1960, 21) = 96519
TPG(1960, 22) = 96473
TPG(1960, 23) = 96424
TPG(1960, 24) = 96375
TPG(1960, 25) = 96325
TPG(1960, 26) = 96274
TPG(1960, 27) = 96222
TPG(1960, 28) = 96169
TPG(1960, 29) = 96116
TPG(1960, 30) = 96060
TPG(1960, 31) = 96003
TPG(1960, 32) = 95944
TPG(1960, 33) = 95884
TPG(1960, 34) = 95821
TPG(1960, 35) = 95754
TPG(1960, 36) = 95683
TPG(1960, 37) = 95609
TPG(1960, 38) = 95530
TPG(1960, 39) = 95447
TPG(1960, 40) = 95358
TPG(1960, 41) = 95263
TPG(1960, 42) = 95163
TPG(1960, 43) = 95056
TPG(1960, 44) = 94942
TPG(1960, 45) = 94821
TPG(1960, 46) = 94692
TPG(1960, 47) = 94555
TPG(1960, 48) = 94408
TPG(1960, 49) = 94252
TPG(1960, 50) = 94085
TPG(1960, 51) = 93907
TPG(1960, 52) = 93716
TPG(1960, 53) = 93512
TPG(1960, 54) = 93299
TPG(1960, 55) = 93075
TPG(1960, 56) = 92840
TPG(1960, 57) = 92595
TPG(1960, 58) = 92338
TPG(1960, 59) = 92074
TPG(1960, 60) = 91802
TPG(1960, 61) = 91524
TPG(1960, 62) = 91240
TPG(1960, 63) = 90949
TPG(1960, 64) = 90643
TPG(1960, 65) = 90319
TPG(1960, 66) = 89978
TPG(1960, 67) = 89619
TPG(1960, 68) = 89241
TPG(1960, 69) = 88818
TPG(1960, 70) = 88344
TPG(1960, 71) = 87813
TPG(1960, 72) = 87218
TPG(1960, 73) = 86549
TPG(1960, 74) = 85787
TPG(1960, 75) = 84917
TPG(1960, 76) = 83925
TPG(1960, 77) = 82794
TPG(1960, 78) = 81506
TPG(1960, 79) = 80056
TPG(1960, 80) = 78427
TPG(1960, 81) = 76601
TPG(1960, 82) = 74557
TPG(1960, 83) = 72276
TPG(1960, 84) = 69781
TPG(1960, 85) = 67059
TPG(1960, 86) = 64103
TPG(1960, 87) = 60907
TPG(1960, 88) = 57470
TPG(1960, 89) = 53850
TPG(1960, 90) = 50061
TPG(1960, 91) = 46124
TPG(1960, 92) = 42068
TPG(1960, 93) = 37927
TPG(1960, 94) = 33810
TPG(1960, 95) = 29761
TPG(1960, 96) = 25827
TPG(1960, 97) = 22058
TPG(1960, 98) = 18502
TPG(1960, 99) = 15207
TPG(1960, 100) = 12213
TPG(1960, 101) = 9555
TPG(1960, 102) = 7254
TPG(1960, 103) = 5321
TPG(1960, 104) = 3752
TPG(1960, 105) = 2527
TPG(1960, 106) = 1613
TPG(1960, 107) = 966
TPG(1960, 108) = 537
TPG(1960, 109) = 273
TPG(1960, 110) = 124
TPG(1960, 111) = 49
TPG(1960, 112) = 16
TPG(1960, 113) = 4
TPG(1960, 114) = 1
TPG(1960, 115) = 0
TPG(1960, 116) = 0
TPG(1960, 117) = 0
TPG(1976, 0) = 100000
TPG(1976, 1) = 98952
TPG(1976, 2) = 98570
TPG(1976, 3) = 98504
TPG(1976, 4) = 98453
TPG(1976, 5) = 98413
TPG(1976, 6) = 98390
TPG(1976, 7) = 98368
TPG(1976, 8) = 98347
TPG(1976, 9) = 98328
TPG(1976, 10) = 98309
TPG(1976, 11) = 98296
TPG(1976, 12) = 98282
TPG(1976, 13) = 98265
TPG(1976, 14) = 98246
TPG(1976, 15) = 98224
TPG(1976, 16) = 98198
TPG(1976, 17) = 98169
TPG(1976, 18) = 98135
TPG(1976, 19) = 98100
TPG(1976, 20) = 98063
TPG(1976, 21) = 98025
TPG(1976, 22) = 97985
TPG(1976, 23) = 97944
TPG(1976, 24) = 97902
TPG(1976, 25) = 97860
TPG(1976, 26) = 97818
TPG(1976, 27) = 97776
TPG(1976, 28) = 97735
TPG(1976, 29) = 97692
TPG(1976, 30) = 97648
TPG(1976, 31) = 97604
TPG(1976, 32) = 97559
TPG(1976, 33) = 97513
TPG(1976, 34) = 97464
TPG(1976, 35) = 97413
TPG(1976, 36) = 97359
TPG(1976, 37) = 97301
TPG(1976, 38) = 97240
TPG(1976, 39) = 97176
TPG(1976, 40) = 97107
TPG(1976, 41) = 97034
TPG(1976, 42) = 96957
TPG(1976, 43) = 96874
TPG(1976, 44) = 96786
TPG(1976, 45) = 96693
TPG(1976, 46) = 96594
TPG(1976, 47) = 96488
TPG(1976, 48) = 96375
TPG(1976, 49) = 96254
TPG(1976, 50) = 96125
TPG(1976, 51) = 95986
TPG(1976, 52) = 95837
TPG(1976, 53) = 95677
TPG(1976, 54) = 95510
TPG(1976, 55) = 95335
TPG(1976, 56) = 95153
TPG(1976, 57) = 94963
TPG(1976, 58) = 94765
TPG(1976, 59) = 94564
TPG(1976, 60) = 94360
TPG(1976, 61) = 94153
TPG(1976, 62) = 93944
TPG(1976, 63) = 93732
TPG(1976, 64) = 93510
TPG(1976, 65) = 93276
TPG(1976, 66) = 93030
TPG(1976, 67) = 92771
TPG(1976, 68) = 92500
TPG(1976, 69) = 92193
TPG(1976, 70) = 91844
TPG(1976, 71) = 91449
TPG(1976, 72) = 91001
TPG(1976, 73) = 90491
TPG(1976, 74) = 89903
TPG(1976, 75) = 89225
TPG(1976, 76) = 88442
TPG(1976, 77) = 87539
TPG(1976, 78) = 86497
TPG(1976, 79) = 85313
TPG(1976, 80) = 83970
TPG(1976, 81) = 82446
TPG(1976, 82) = 80723
TPG(1976, 83) = 78776
TPG(1976, 84) = 76621
TPG(1976, 85) = 74240
TPG(1976, 86) = 71620
TPG(1976, 87) = 68746
TPG(1976, 88) = 65607
TPG(1976, 89) = 62248
TPG(1976, 90) = 58671
TPG(1976, 91) = 54885
TPG(1976, 92) = 50905
TPG(1976, 93) = 46755
TPG(1976, 94) = 42540
TPG(1976, 95) = 38297
TPG(1976, 96) = 34070
TPG(1976, 97) = 29906
TPG(1976, 98) = 25859
TPG(1976, 99) = 21983
TPG(1976, 100) = 18331
TPG(1976, 101) = 14956
TPG(1976, 102) = 11902
TPG(1976, 103) = 9207
TPG(1976, 104) = 6894
TPG(1976, 105) = 4972
TPG(1976, 106) = 3433
TPG(1976, 107) = 2253
TPG(1976, 108) = 1393
TPG(1976, 109) = 802
TPG(1976, 110) = 424
TPG(1976, 111) = 202
TPG(1976, 112) = 84
TPG(1976, 113) = 30
TPG(1976, 114) = 8
TPG(1976, 115) = 2
TPG(1976, 116) = 0
TPG(1976, 117) = 0
TPG(1990, 0) = 100000
TPG(1990, 1) = 99403
TPG(1990, 2) = 99185
TPG(1990, 3) = 99149
TPG(1990, 4) = 99119
TPG(1990, 5) = 99094
TPG(1990, 6) = 99078
TPG(1990, 7) = 99062
TPG(1990, 8) = 99046
TPG(1990, 9) = 99031
TPG(1990, 10) = 99017
TPG(1990, 11) = 99007
TPG(1990, 12) = 98995
TPG(1990, 13) = 98982
TPG(1990, 14) = 98966
TPG(1990, 15) = 98948
TPG(1990, 16) = 98926
TPG(1990, 17) = 98900
TPG(1990, 18) = 98870
TPG(1990, 19) = 98838
TPG(1990, 20) = 98806
TPG(1990, 21) = 98772
TPG(1990, 22) = 98737
TPG(1990, 23) = 98701
TPG(1990, 24) = 98666
TPG(1990, 25) = 98630
TPG(1990, 26) = 98595
TPG(1990, 27) = 98561
TPG(1990, 28) = 98527
TPG(1990, 29) = 98492
TPG(1990, 30) = 98457
TPG(1990, 31) = 98422
TPG(1990, 32) = 98386
TPG(1990, 33) = 98350
TPG(1990, 34) = 98312
TPG(1990, 35) = 98271
TPG(1990, 36) = 98228
TPG(1990, 37) = 98183
TPG(1990, 38) = 98135
TPG(1990, 39) = 98083
TPG(1990, 40) = 98029
TPG(1990, 41) = 97971
TPG(1990, 42) = 97910
TPG(1990, 43) = 97844
TPG(1990, 44) = 97775
TPG(1990, 45) = 97701
TPG(1990, 46) = 97622
TPG(1990, 47) = 97539
TPG(1990, 48) = 97450
TPG(1990, 49) = 97354
TPG(1990, 50) = 97251
TPG(1990, 51) = 97141
TPG(1990, 52) = 97021
TPG(1990, 53) = 96893
TPG(1990, 54) = 96759
TPG(1990, 55) = 96620
TPG(1990, 56) = 96475
TPG(1990, 57) = 96324
TPG(1990, 58) = 96168
TPG(1990, 59) = 96010
TPG(1990, 60) = 95852
TPG(1990, 61) = 95694
TPG(1990, 62) = 95535
TPG(1990, 63) = 95377
TPG(1990, 64) = 95211
TPG(1990, 65) = 95036
TPG(1990, 66) = 94853
TPG(1990, 67) = 94661
TPG(1990, 68) = 94460
TPG(1990, 69) = 94230
TPG(1990, 70) = 93967
TPG(1990, 71) = 93665
TPG(1990, 72) = 93319
TPG(1990, 73) = 92923
TPG(1990, 74) = 92461
TPG(1990, 75) = 91923
TPG(1990, 76) = 91295
TPG(1990, 77) = 90564
TPG(1990, 78) = 89712
TPG(1990, 79) = 88737
TPG(1990, 80) = 87620
TPG(1990, 81) = 86344
TPG(1990, 82) = 84888
TPG(1990, 83) = 83227
TPG(1990, 84) = 81372
TPG(1990, 85) = 79303
TPG(1990, 86) = 77002
TPG(1990, 87) = 74451
TPG(1990, 88) = 71632
TPG(1990, 89) = 68579
TPG(1990, 90) = 65284
TPG(1990, 91) = 61749
TPG(1990, 92) = 57977
TPG(1990, 93) = 53980
TPG(1990, 94) = 49855
TPG(1990, 95) = 45632
TPG(1990, 96) = 41344
TPG(1990, 97) = 37036
TPG(1990, 98) = 32753
TPG(1990, 99) = 28548
TPG(1990, 100) = 24480
TPG(1990, 101) = 20606
TPG(1990, 102) = 16983
TPG(1990, 103) = 13665
TPG(1990, 104) = 10698
TPG(1990, 105) = 8115
TPG(1990, 106) = 5937
TPG(1990, 107) = 4164
TPG(1990, 108) = 2781
TPG(1990, 109) = 1753
TPG(1990, 110) = 1031
TPG(1990, 111) = 559
TPG(1990, 112) = 274
TPG(1990, 113) = 118
TPG(1990, 114) = 43
TPG(1990, 115) = 13
TPG(1990, 116) = 3
TPG(1990, 117) = 0
TPG(1921, 0) = 100000
TPG(1921, 1) = 91015
TPG(1921, 2) = 87977
TPG(1921, 3) = 87312
TPG(1921, 4) = 86911
TPG(1921, 5) = 86667
TPG(1921, 6) = 86594
TPG(1921, 7) = 86529
TPG(1921, 8) = 86470
TPG(1921, 9) = 86417
TPG(1921, 10) = 86369
TPG(1921, 11) = 86336
TPG(1921, 12) = 86302
TPG(1921, 13) = 86267
TPG(1921, 14) = 86229
TPG(1921, 15) = 86190
TPG(1921, 16) = 86149
TPG(1921, 17) = 86105
TPG(1921, 18) = 86058
TPG(1921, 19) = 86008
TPG(1921, 20) = 85954
TPG(1921, 21) = 85895
TPG(1921, 22) = 85833
TPG(1921, 23) = 85767
TPG(1921, 24) = 85698
TPG(1921, 25) = 85625
TPG(1921, 26) = 85549
TPG(1921, 27) = 85469
TPG(1921, 28) = 85384
TPG(1921, 29) = 85296
TPG(1921, 30) = 85203
TPG(1921, 31) = 85106
TPG(1921, 32) = 85004
TPG(1921, 33) = 84897
TPG(1921, 34) = 84785
TPG(1921, 35) = 84668
TPG(1921, 36) = 84545
TPG(1921, 37) = 84416
TPG(1921, 38) = 84280
TPG(1921, 39) = 84136
TPG(1921, 40) = 83983
TPG(1921, 41) = 83819
TPG(1921, 42) = 83646
TPG(1921, 43) = 83462
TPG(1921, 44) = 83265
TPG(1921, 45) = 83055
TPG(1921, 46) = 82831
TPG(1921, 47) = 82592
TPG(1921, 48) = 82338
TPG(1921, 49) = 82069
TPG(1921, 50) = 81784
TPG(1921, 51) = 81484
TPG(1921, 52) = 81166
TPG(1921, 53) = 80831
TPG(1921, 54) = 80476
TPG(1921, 55) = 80100
TPG(1921, 56) = 79704
TPG(1921, 57) = 79287
TPG(1921, 58) = 78846
TPG(1921, 59) = 78381
TPG(1921, 60) = 77890
TPG(1921, 61) = 77372
TPG(1921, 62) = 76828
TPG(1921, 63) = 76258
TPG(1921, 64) = 75653
TPG(1921, 65) = 75013
TPG(1921, 66) = 74337
TPG(1921, 67) = 73622
TPG(1921, 68) = 72868
TPG(1921, 69) = 72050
TPG(1921, 70) = 71162
TPG(1921, 71) = 70199
TPG(1921, 72) = 69153
TPG(1921, 73) = 68017
TPG(1921, 74) = 66763
TPG(1921, 75) = 65377
TPG(1921, 76) = 63850
TPG(1921, 77) = 62167
TPG(1921, 78) = 60318
TPG(1921, 79) = 58298
TPG(1921, 80) = 56100
TPG(1921, 81) = 53714
TPG(1921, 82) = 51138
TPG(1921, 83) = 48368
TPG(1921, 84) = 45450
TPG(1921, 85) = 42395
TPG(1921, 86) = 39218
TPG(1921, 87) = 35937
TPG(1921, 88) = 32580
TPG(1921, 89) = 29225
TPG(1921, 90) = 25905
TPG(1921, 91) = 22656
TPG(1921, 92) = 19518
TPG(1921, 93) = 16529
TPG(1921, 94) = 13761
TPG(1921, 95) = 11240
TPG(1921, 96) = 8985
TPG(1921, 97) = 7012
TPG(1921, 98) = 5324
TPG(1921, 99) = 3919
TPG(1921, 100) = 2785
TPG(1921, 101) = 1900
TPG(1921, 102) = 1238
TPG(1921, 103) = 764
TPG(1921, 104) = 442
TPG(1921, 105) = 238
TPG(1921, 106) = 117
TPG(1921, 107) = 51
TPG(1921, 108) = 20
TPG(1921, 109) = 6
TPG(1921, 110) = 2
TPG(1921, 111) = 0
TPG(1921, 112) = 0
TPG(1921, 113) = 0
TPG(1921, 114) = 0
TPG(1921, 115) = 0
TPG(1921, 116) = 0
TPG(1921, 117) = 0
TPG(1922, 0) = 100000
TPG(1922, 1) = 91341
TPG(1922, 2) = 88405
TPG(1922, 3) = 87766
TPG(1922, 4) = 87379
TPG(1922, 5) = 87142
TPG(1922, 6) = 87070
TPG(1922, 7) = 87006
TPG(1922, 8) = 86948
TPG(1922, 9) = 86896
TPG(1922, 10) = 86848
TPG(1922, 11) = 86816
TPG(1922, 12) = 86783
TPG(1922, 13) = 86747
TPG(1922, 14) = 86710
TPG(1922, 15) = 86671
TPG(1922, 16) = 86630
TPG(1922, 17) = 86587
TPG(1922, 18) = 86540
TPG(1922, 19) = 86490
TPG(1922, 20) = 86436
TPG(1922, 21) = 86378
TPG(1922, 22) = 86316
TPG(1922, 23) = 86250
TPG(1922, 24) = 86182
TPG(1922, 25) = 86109
TPG(1922, 26) = 86034
TPG(1922, 27) = 85954
TPG(1922, 28) = 85870
TPG(1922, 29) = 85783
TPG(1922, 30) = 85691
TPG(1922, 31) = 85595
TPG(1922, 32) = 85494
TPG(1922, 33) = 85389
TPG(1922, 34) = 85278
TPG(1922, 35) = 85162
TPG(1922, 36) = 85041
TPG(1922, 37) = 84913
TPG(1922, 38) = 84779
TPG(1922, 39) = 84636
TPG(1922, 40) = 84485
TPG(1922, 41) = 84323
TPG(1922, 42) = 84152
TPG(1922, 43) = 83970
TPG(1922, 44) = 83775
TPG(1922, 45) = 83568
TPG(1922, 46) = 83346
TPG(1922, 47) = 83110
TPG(1922, 48) = 82858
TPG(1922, 49) = 82592
TPG(1922, 50) = 82311
TPG(1922, 51) = 82014
TPG(1922, 52) = 81699
TPG(1922, 53) = 81367
TPG(1922, 54) = 81016
TPG(1922, 55) = 80644
TPG(1922, 56) = 80252
TPG(1922, 57) = 79839
TPG(1922, 58) = 79404
TPG(1922, 59) = 78943
TPG(1922, 60) = 78458
TPG(1922, 61) = 77947
TPG(1922, 62) = 77411
TPG(1922, 63) = 76848
TPG(1922, 64) = 76252
TPG(1922, 65) = 75621
TPG(1922, 66) = 74954
TPG(1922, 67) = 74250
TPG(1922, 68) = 73506
TPG(1922, 69) = 72699
TPG(1922, 70) = 71822
TPG(1922, 71) = 70870
TPG(1922, 72) = 69835
TPG(1922, 73) = 68710
TPG(1922, 74) = 67466
TPG(1922, 75) = 66092
TPG(1922, 76) = 64574
TPG(1922, 77) = 62901
TPG(1922, 78) = 61061
TPG(1922, 79) = 59049
TPG(1922, 80) = 56857
TPG(1922, 81) = 54476
TPG(1922, 82) = 51901
TPG(1922, 83) = 49130
TPG(1922, 84) = 46208
TPG(1922, 85) = 43145
TPG(1922, 86) = 39954
TPG(1922, 87) = 36655
TPG(1922, 88) = 33274
TPG(1922, 89) = 29889
TPG(1922, 90) = 26534
TPG(1922, 91) = 23245
TPG(1922, 92) = 20061
TPG(1922, 93) = 17022
TPG(1922, 94) = 14202
TPG(1922, 95) = 11627
TPG(1922, 96) = 9319
TPG(1922, 97) = 7292
TPG(1922, 98) = 5554
TPG(1922, 99) = 4103
TPG(1922, 100) = 2926
TPG(1922, 101) = 2005
TPG(1922, 102) = 1312
TPG(1922, 103) = 814
TPG(1922, 104) = 474
TPG(1922, 105) = 256
TPG(1922, 106) = 127
TPG(1922, 107) = 56
TPG(1922, 108) = 22
TPG(1922, 109) = 7
TPG(1922, 110) = 2
TPG(1922, 111) = 0
TPG(1922, 112) = 0
TPG(1922, 113) = 0
TPG(1922, 114) = 0
TPG(1922, 115) = 0
TPG(1922, 116) = 0
TPG(1922, 117) = 0
TPG(1949, 0) = 100000
TPG(1949, 1) = 96928
TPG(1949, 2) = 95836
TPG(1949, 3) = 95625
TPG(1949, 4) = 95479
TPG(1949, 5) = 95379
TPG(1949, 6) = 95337
TPG(1949, 7) = 95298
TPG(1949, 8) = 95263
TPG(1949, 9) = 95230
TPG(1949, 10) = 95199
TPG(1949, 11) = 95178
TPG(1949, 12) = 95155
TPG(1949, 13) = 95130
TPG(1949, 14) = 95102
TPG(1949, 15) = 95072
TPG(1949, 16) = 95039
TPG(1949, 17) = 95002
TPG(1949, 18) = 94961
TPG(1949, 19) = 94918
TPG(1949, 20) = 94872
TPG(1949, 21) = 94824
TPG(1949, 22) = 94773
TPG(1949, 23) = 94719
TPG(1949, 24) = 94664
TPG(1949, 25) = 94607
TPG(1949, 26) = 94549
TPG(1949, 27) = 94490
TPG(1949, 28) = 94429
TPG(1949, 29) = 94366
TPG(1949, 30) = 94301
TPG(1949, 31) = 94233
TPG(1949, 32) = 94164
TPG(1949, 33) = 94092
TPG(1949, 34) = 94016
TPG(1949, 35) = 93937
TPG(1949, 36) = 93853
TPG(1949, 37) = 93765
TPG(1949, 38) = 93672
TPG(1949, 39) = 93573
TPG(1949, 40) = 93467
TPG(1949, 41) = 93355
TPG(1949, 42) = 93236
TPG(1949, 43) = 93110
TPG(1949, 44) = 92975
TPG(1949, 45) = 92831
TPG(1949, 46) = 92678
TPG(1949, 47) = 92514
TPG(1949, 48) = 92340
TPG(1949, 49) = 92155
TPG(1949, 50) = 91958
TPG(1949, 51) = 91748
TPG(1949, 52) = 91524
TPG(1949, 53) = 91285
TPG(1949, 54) = 91035
TPG(1949, 55) = 90771
TPG(1949, 56) = 90494
TPG(1949, 57) = 90204
TPG(1949, 58) = 89900
TPG(1949, 59) = 89584
TPG(1949, 60) = 89258
TPG(1949, 61) = 88920
TPG(1949, 62) = 88572
TPG(1949, 63) = 88214
TPG(1949, 64) = 87835
TPG(1949, 65) = 87435
TPG(1949, 66) = 87013
TPG(1949, 67) = 86568
TPG(1949, 68) = 86099
TPG(1949, 69) = 85578
TPG(1949, 70) = 85000
TPG(1949, 71) = 84357
TPG(1949, 72) = 83642
TPG(1949, 73) = 82847
TPG(1949, 74) = 81947
TPG(1949, 75) = 80929
TPG(1949, 76) = 79779
TPG(1949, 77) = 78479
TPG(1949, 78) = 77011
TPG(1949, 79) = 75372
TPG(1949, 80) = 73545
TPG(1949, 81) = 71513
TPG(1949, 82) = 69259
TPG(1949, 83) = 66766
TPG(1949, 84) = 64064
TPG(1949, 85) = 61146
TPG(1949, 86) = 58010
TPG(1949, 87) = 54657
TPG(1949, 88) = 51095
TPG(1949, 89) = 47390
TPG(1949, 90) = 43565
TPG(1949, 91) = 39647
TPG(1949, 92) = 35673
TPG(1949, 93) = 31685
TPG(1949, 94) = 27787
TPG(1949, 95) = 24023
TPG(1949, 96) = 20439
TPG(1949, 97) = 17079
TPG(1949, 98) = 13984
TPG(1949, 99) = 11190
TPG(1949, 100) = 8723
TPG(1949, 101) = 6601
TPG(1949, 102) = 4828
TPG(1949, 103) = 3396
TPG(1949, 104) = 2283
TPG(1949, 105) = 1456
TPG(1949, 106) = 872
TPG(1949, 107) = 486
TPG(1949, 108) = 248
TPG(1949, 109) = 113
TPG(1949, 110) = 45
TPG(1949, 111) = 15
TPG(1949, 112) = 4
TPG(1949, 113) = 1
TPG(1949, 114) = 0
TPG(1949, 115) = 0
TPG(1949, 116) = 0
TPG(1949, 117) = 0
TPG(1950, 0) = 100000
TPG(1950, 1) = 97047
TPG(1950, 2) = 95995
TPG(1950, 3) = 95793
TPG(1950, 4) = 95653
TPG(1950, 5) = 95556
TPG(1950, 6) = 95515
TPG(1950, 7) = 95477
TPG(1950, 8) = 95442
TPG(1950, 9) = 95410
TPG(1950, 10) = 95379
TPG(1950, 11) = 95359
TPG(1950, 12) = 95336
TPG(1950, 13) = 95311
TPG(1950, 14) = 95284
TPG(1950, 15) = 95254
TPG(1950, 16) = 95221
TPG(1950, 17) = 95185
TPG(1950, 18) = 95144
TPG(1950, 19) = 95101
TPG(1950, 20) = 95056
TPG(1950, 21) = 95008
TPG(1950, 22) = 94957
TPG(1950, 23) = 94904
TPG(1950, 24) = 94850
TPG(1950, 25) = 94794
TPG(1950, 26) = 94736
TPG(1950, 27) = 94677
TPG(1950, 28) = 94617
TPG(1950, 29) = 94555
TPG(1950, 30) = 94491
TPG(1950, 31) = 94424
TPG(1950, 32) = 94356
TPG(1950, 33) = 94285
TPG(1950, 34) = 94211
TPG(1950, 35) = 94133
TPG(1950, 36) = 94050
TPG(1950, 37) = 93963
TPG(1950, 38) = 93871
TPG(1950, 39) = 93774
TPG(1950, 40) = 93670
TPG(1950, 41) = 93560
TPG(1950, 42) = 93442
TPG(1950, 43) = 93318
TPG(1950, 44) = 93185
TPG(1950, 45) = 93043
TPG(1950, 46) = 92892
TPG(1950, 47) = 92732
TPG(1950, 48) = 92560
TPG(1950, 49) = 92378
TPG(1950, 50) = 92183
TPG(1950, 51) = 91976
TPG(1950, 52) = 91756
TPG(1950, 53) = 91520
TPG(1950, 54) = 91273
TPG(1950, 55) = 91013
TPG(1950, 56) = 90741
TPG(1950, 57) = 90455
TPG(1950, 58) = 90155
TPG(1950, 59) = 89844
TPG(1950, 60) = 89523
TPG(1950, 61) = 89191
TPG(1950, 62) = 88849
TPG(1950, 63) = 88498
TPG(1950, 64) = 88126
TPG(1950, 65) = 87733
TPG(1950, 66) = 87319
TPG(1950, 67) = 86882
TPG(1950, 68) = 86422
TPG(1950, 69) = 85911
TPG(1950, 70) = 85343
TPG(1950, 71) = 84711
TPG(1950, 72) = 84007
TPG(1950, 73) = 83224
TPG(1950, 74) = 82337
TPG(1950, 75) = 81333
TPG(1950, 76) = 80198
TPG(1950, 77) = 78913
TPG(1950, 78) = 77462
TPG(1950, 79) = 75840
TPG(1950, 80) = 74030
TPG(1950, 81) = 72016
TPG(1950, 82) = 69780
TPG(1950, 83) = 67306
TPG(1950, 84) = 64621
TPG(1950, 85) = 61719
TPG(1950, 86) = 58596
TPG(1950, 87) = 55255
TPG(1950, 88) = 51700
TPG(1950, 89) = 47999
TPG(1950, 90) = 44172
TPG(1950, 91) = 40248
TPG(1950, 92) = 36261
TPG(1950, 93) = 32253
TPG(1950, 94) = 28330
TPG(1950, 95) = 24535
TPG(1950, 96) = 20914
TPG(1950, 97) = 17513
TPG(1950, 98) = 14373
TPG(1950, 99) = 11530
TPG(1950, 100) = 9014
TPG(1950, 101) = 6843
TPG(1950, 102) = 5023
TPG(1950, 103) = 3547
TPG(1950, 104) = 2395
TPG(1950, 105) = 1535
TPG(1950, 106) = 926
TPG(1950, 107) = 519
TPG(1950, 108) = 267
TPG(1950, 109) = 123
TPG(1950, 110) = 50
TPG(1950, 111) = 17
TPG(1950, 112) = 5
TPG(1950, 113) = 1
TPG(1950, 114) = 0
TPG(1950, 115) = 0
TPG(1950, 116) = 0
TPG(1950, 117) = 0
TPG(1971, 0) = 100000
TPG(1971, 1) = 98719
TPG(1971, 2) = 98254
TPG(1971, 3) = 98172
TPG(1971, 4) = 98110
TPG(1971, 5) = 98062
TPG(1971, 6) = 98036
TPG(1971, 7) = 98012
TPG(1971, 8) = 97989
TPG(1971, 9) = 97967
TPG(1971, 10) = 97947
TPG(1971, 11) = 97932
TPG(1971, 12) = 97916
TPG(1971, 13) = 97898
TPG(1971, 14) = 97879
TPG(1971, 15) = 97855
TPG(1971, 16) = 97828
TPG(1971, 17) = 97798
TPG(1971, 18) = 97763
TPG(1971, 19) = 97726
TPG(1971, 20) = 97688
TPG(1971, 21) = 97648
TPG(1971, 22) = 97606
TPG(1971, 23) = 97562
TPG(1971, 24) = 97518
TPG(1971, 25) = 97474
TPG(1971, 26) = 97429
TPG(1971, 27) = 97385
TPG(1971, 28) = 97340
TPG(1971, 29) = 97294
TPG(1971, 30) = 97247
TPG(1971, 31) = 97199
TPG(1971, 32) = 97149
TPG(1971, 33) = 97099
TPG(1971, 34) = 97047
TPG(1971, 35) = 96991
TPG(1971, 36) = 96932
TPG(1971, 37) = 96869
TPG(1971, 38) = 96803
TPG(1971, 39) = 96733
TPG(1971, 40) = 96659
TPG(1971, 41) = 96580
TPG(1971, 42) = 96496
TPG(1971, 43) = 96406
TPG(1971, 44) = 96311
TPG(1971, 45) = 96209
TPG(1971, 46) = 96101
TPG(1971, 47) = 95986
TPG(1971, 48) = 95864
TPG(1971, 49) = 95733
TPG(1971, 50) = 95593
TPG(1971, 51) = 95442
TPG(1971, 52) = 95281
TPG(1971, 53) = 95109
TPG(1971, 54) = 94928
TPG(1971, 55) = 94739
TPG(1971, 56) = 94542
TPG(1971, 57) = 94335
TPG(1971, 58) = 94120
TPG(1971, 59) = 93901
TPG(1971, 60) = 93678
TPG(1971, 61) = 93450
TPG(1971, 62) = 93220
TPG(1971, 63) = 92986
TPG(1971, 64) = 92740
TPG(1971, 65) = 92480
TPG(1971, 66) = 92208
TPG(1971, 67) = 91921
TPG(1971, 68) = 91619
TPG(1971, 69) = 91279
TPG(1971, 70) = 90895
TPG(1971, 71) = 90460
TPG(1971, 72) = 89969
TPG(1971, 73) = 89414
TPG(1971, 74) = 88775
TPG(1971, 75) = 88040
TPG(1971, 76) = 87196
TPG(1971, 77) = 86225
TPG(1971, 78) = 85108
TPG(1971, 79) = 83844
TPG(1971, 80) = 82413
TPG(1971, 81) = 80796
TPG(1971, 82) = 78973
TPG(1971, 83) = 76922
TPG(1971, 84) = 74658
TPG(1971, 85) = 72167
TPG(1971, 86) = 69436
TPG(1971, 87) = 66453
TPG(1971, 88) = 63211
TPG(1971, 89) = 59757
TPG(1971, 90) = 56098
TPG(1971, 91) = 52245
TPG(1971, 92) = 48220
TPG(1971, 93) = 44049
TPG(1971, 94) = 39839
TPG(1971, 95) = 35630
TPG(1971, 96) = 31467
TPG(1971, 97) = 27400
TPG(1971, 98) = 23482
TPG(1971, 99) = 19765
TPG(1971, 100) = 16300
TPG(1971, 101) = 13135
TPG(1971, 102) = 10310
TPG(1971, 103) = 7852
TPG(1971, 104) = 5776
TPG(1971, 105) = 4083
TPG(1971, 106) = 2755
TPG(1971, 107) = 1761
TPG(1971, 108) = 1055
TPG(1971, 109) = 586
TPG(1971, 110) = 296
TPG(1971, 111) = 134
TPG(1971, 112) = 52
TPG(1971, 113) = 17
TPG(1971, 114) = 4
TPG(1971, 115) = 1
TPG(1971, 116) = 0
TPG(1971, 117) = 0
TPG(1985, 0) = 100000
TPG(1985, 1) = 99270
TPG(1985, 2) = 99003
TPG(1985, 3) = 98959
TPG(1985, 4) = 98923
TPG(1985, 5) = 98893
TPG(1985, 6) = 98874
TPG(1985, 7) = 98857
TPG(1985, 8) = 98839
TPG(1985, 9) = 98823
TPG(1985, 10) = 98807
TPG(1985, 11) = 98796
TPG(1985, 12) = 98783
TPG(1985, 13) = 98769
TPG(1985, 14) = 98752
TPG(1985, 15) = 98732
TPG(1985, 16) = 98709
TPG(1985, 17) = 98682
TPG(1985, 18) = 98651
TPG(1985, 19) = 98618
TPG(1985, 20) = 98584
TPG(1985, 21) = 98549
TPG(1985, 22) = 98512
TPG(1985, 23) = 98474
TPG(1985, 24) = 98437
TPG(1985, 25) = 98399
TPG(1985, 26) = 98362
TPG(1985, 27) = 98325
TPG(1985, 28) = 98288
TPG(1985, 29) = 98251
TPG(1985, 30) = 98213
TPG(1985, 31) = 98174
TPG(1985, 32) = 98136
TPG(1985, 33) = 98096
TPG(1985, 34) = 98054
TPG(1985, 35) = 98010
TPG(1985, 36) = 97964
TPG(1985, 37) = 97914
TPG(1985, 38) = 97862
TPG(1985, 39) = 97806
TPG(1985, 40) = 97747
TPG(1985, 41) = 97684
TPG(1985, 42) = 97617
TPG(1985, 43) = 97546
TPG(1985, 44) = 97471
TPG(1985, 45) = 97390
TPG(1985, 46) = 97305
TPG(1985, 47) = 97214
TPG(1985, 48) = 97117
TPG(1985, 49) = 97013
TPG(1985, 50) = 96901
TPG(1985, 51) = 96781
TPG(1985, 52) = 96652
TPG(1985, 53) = 96513
TPG(1985, 54) = 96368
TPG(1985, 55) = 96217
TPG(1985, 56) = 96060
TPG(1985, 57) = 95896
TPG(1985, 58) = 95726
TPG(1985, 59) = 95554
TPG(1985, 60) = 95380
TPG(1985, 61) = 95206
TPG(1985, 62) = 95031
TPG(1985, 63) = 94855
TPG(1985, 64) = 94670
TPG(1985, 65) = 94476
TPG(1985, 66) = 94273
TPG(1985, 67) = 94059
TPG(1985, 68) = 93835
TPG(1985, 69) = 93580
TPG(1985, 70) = 93288
TPG(1985, 71) = 92956
TPG(1985, 72) = 92576
TPG(1985, 73) = 92142
TPG(1985, 74) = 91638
TPG(1985, 75) = 91053
TPG(1985, 76) = 90373
TPG(1985, 77) = 89584
TPG(1985, 78) = 88667
TPG(1985, 79) = 87620
TPG(1985, 80) = 86426
TPG(1985, 81) = 85064
TPG(1985, 82) = 83515
TPG(1985, 83) = 81754
TPG(1985, 84) = 79793
TPG(1985, 85) = 77614
TPG(1985, 86) = 75198
TPG(1985, 87) = 72530
TPG(1985, 88) = 69594
TPG(1985, 89) = 66425
TPG(1985, 90) = 63023
TPG(1985, 91) = 59389
TPG(1985, 92) = 55531
TPG(1985, 93) = 51465
TPG(1985, 94) = 47292
TPG(1985, 95) = 43044
TPG(1985, 96) = 38759
TPG(1985, 97) = 34481
TPG(1985, 98) = 30262
TPG(1985, 99) = 26154
TPG(1985, 100) = 22216
TPG(1985, 101) = 18502
TPG(1985, 102) = 15069
TPG(1985, 103) = 11964
TPG(1985, 104) = 9226
TPG(1985, 105) = 6880
TPG(1985, 106) = 4935
TPG(1985, 107) = 3385
TPG(1985, 108) = 2202
TPG(1985, 109) = 1346
TPG(1985, 110) = 764
TPG(1985, 111) = 397
TPG(1985, 112) = 184
TPG(1985, 113) = 75
TPG(1985, 114) = 25
TPG(1985, 115) = 7
TPG(1985, 116) = 1
TPG(1985, 117) = 0
TPG(1935, 0) = 100000
TPG(1935, 1) = 94703
TPG(1935, 2) = 92856
TPG(1935, 3) = 92477
TPG(1935, 4) = 92233
TPG(1935, 5) = 92074
TPG(1935, 6) = 92018
TPG(1935, 7) = 91967
TPG(1935, 8) = 91921
TPG(1935, 9) = 91878
TPG(1935, 10) = 91840
TPG(1935, 11) = 91813
TPG(1935, 12) = 91785
TPG(1935, 13) = 91754
TPG(1935, 14) = 91722
TPG(1935, 15) = 91687
TPG(1935, 16) = 91649
TPG(1935, 17) = 91608
TPG(1935, 18) = 91564
TPG(1935, 19) = 91517
TPG(1935, 20) = 91467
TPG(1935, 21) = 91414
TPG(1935, 22) = 91357
TPG(1935, 23) = 91297
TPG(1935, 24) = 91234
TPG(1935, 25) = 91169
TPG(1935, 26) = 91101
TPG(1935, 27) = 91031
TPG(1935, 28) = 90959
TPG(1935, 29) = 90883
TPG(1935, 30) = 90805
TPG(1935, 31) = 90723
TPG(1935, 32) = 90637
TPG(1935, 33) = 90549
TPG(1935, 34) = 90456
TPG(1935, 35) = 90358
TPG(1935, 36) = 90255
TPG(1935, 37) = 90146
TPG(1935, 38) = 90033
TPG(1935, 39) = 89912
TPG(1935, 40) = 89783
TPG(1935, 41) = 89646
TPG(1935, 42) = 89500
TPG(1935, 43) = 89346
TPG(1935, 44) = 89180
TPG(1935, 45) = 89004
TPG(1935, 46) = 88816
TPG(1935, 47) = 88616
TPG(1935, 48) = 88403
TPG(1935, 49) = 88176
TPG(1935, 50) = 87936
TPG(1935, 51) = 87682
TPG(1935, 52) = 87411
TPG(1935, 53) = 87124
TPG(1935, 54) = 86821
TPG(1935, 55) = 86502
TPG(1935, 56) = 86167
TPG(1935, 57) = 85813
TPG(1935, 58) = 85442
TPG(1935, 59) = 85053
TPG(1935, 60) = 84646
TPG(1935, 61) = 84222
TPG(1935, 62) = 83780
TPG(1935, 63) = 83320
TPG(1935, 64) = 82834
TPG(1935, 65) = 82320
TPG(1935, 66) = 81777
TPG(1935, 67) = 81203
TPG(1935, 68) = 80598
TPG(1935, 69) = 79934
TPG(1935, 70) = 79204
TPG(1935, 71) = 78402
TPG(1935, 72) = 77520
TPG(1935, 73) = 76551
TPG(1935, 74) = 75467
TPG(1935, 75) = 74255
TPG(1935, 76) = 72901
TPG(1935, 77) = 71389
TPG(1935, 78) = 69705
TPG(1935, 79) = 67843
TPG(1935, 80) = 65790
TPG(1935, 81) = 63533
TPG(1935, 82) = 61060
TPG(1935, 83) = 58362
TPG(1935, 84) = 55475
TPG(1935, 85) = 52402
TPG(1935, 86) = 49149
TPG(1935, 87) = 45727
TPG(1935, 88) = 42154
TPG(1935, 89) = 38506
TPG(1935, 90) = 34813
TPG(1935, 91) = 31110
TPG(1935, 92) = 27437
TPG(1935, 93) = 23841
TPG(1935, 94) = 20412
TPG(1935, 95) = 17189
TPG(1935, 96) = 14209
TPG(1935, 97) = 11502
TPG(1935, 98) = 9093
TPG(1935, 99) = 6999
TPG(1935, 100) = 5226
TPG(1935, 101) = 3769
TPG(1935, 102) = 2612
TPG(1935, 103) = 1728
TPG(1935, 104) = 1084
TPG(1935, 105) = 638
TPG(1935, 106) = 349
TPG(1935, 107) = 174
TPG(1935, 108) = 78
TPG(1935, 109) = 30
TPG(1935, 110) = 10
TPG(1935, 111) = 3
TPG(1935, 112) = 0
TPG(1935, 113) = 0
TPG(1935, 114) = 0
TPG(1935, 115) = 0
TPG(1935, 116) = 0
TPG(1935, 117) = 0
TPG(1936, 0) = 100000
TPG(1936, 1) = 94903
TPG(1936, 2) = 93122
TPG(1936, 3) = 92759
TPG(1936, 4) = 92523
TPG(1936, 5) = 92369
TPG(1936, 6) = 92315
TPG(1936, 7) = 92265
TPG(1936, 8) = 92219
TPG(1936, 9) = 92178
TPG(1936, 10) = 92139
TPG(1936, 11) = 92113
TPG(1936, 12) = 92085
TPG(1936, 13) = 92055
TPG(1936, 14) = 92023
TPG(1936, 15) = 91988
TPG(1936, 16) = 91951
TPG(1936, 17) = 91911
TPG(1936, 18) = 91867
TPG(1936, 19) = 91820
TPG(1936, 20) = 91770
TPG(1936, 21) = 91717
TPG(1936, 22) = 91661
TPG(1936, 23) = 91601
TPG(1936, 24) = 91539
TPG(1936, 25) = 91474
TPG(1936, 26) = 91407
TPG(1936, 27) = 91338
TPG(1936, 28) = 91267
TPG(1936, 29) = 91192
TPG(1936, 30) = 91114
TPG(1936, 31) = 91033
TPG(1936, 32) = 90949
TPG(1936, 33) = 90862
TPG(1936, 34) = 90770
TPG(1936, 35) = 90673
TPG(1936, 36) = 90572
TPG(1936, 37) = 90465
TPG(1936, 38) = 90353
TPG(1936, 39) = 90233
TPG(1936, 40) = 90106
TPG(1936, 41) = 89971
TPG(1936, 42) = 89828
TPG(1936, 43) = 89675
TPG(1936, 44) = 89512
TPG(1936, 45) = 89338
TPG(1936, 46) = 89153
TPG(1936, 47) = 88956
TPG(1936, 48) = 88745
TPG(1936, 49) = 88522
TPG(1936, 50) = 88285
TPG(1936, 51) = 88034
TPG(1936, 52) = 87767
TPG(1936, 53) = 87483
TPG(1936, 54) = 87184
TPG(1936, 55) = 86869
TPG(1936, 56) = 86538
TPG(1936, 57) = 86189
TPG(1936, 58) = 85823
TPG(1936, 59) = 85439
TPG(1936, 60) = 85038
TPG(1936, 61) = 84621
TPG(1936, 62) = 84186
TPG(1936, 63) = 83734
TPG(1936, 64) = 83256
TPG(1936, 65) = 82750
TPG(1936, 66) = 82216
TPG(1936, 67) = 81652
TPG(1936, 68) = 81058
TPG(1936, 69) = 80404
TPG(1936, 70) = 79686
TPG(1936, 71) = 78895
TPG(1936, 72) = 78026
TPG(1936, 73) = 77070
TPG(1936, 74) = 75999
TPG(1936, 75) = 74800
TPG(1936, 76) = 73460
TPG(1936, 77) = 71963
TPG(1936, 78) = 70292
TPG(1936, 79) = 68445
TPG(1936, 80) = 66406
TPG(1936, 81) = 64163
TPG(1936, 82) = 61703
TPG(1936, 83) = 59016
TPG(1936, 84) = 56138
TPG(1936, 85) = 53071
TPG(1936, 86) = 49821
TPG(1936, 87) = 46398
TPG(1936, 88) = 42819
TPG(1936, 89) = 39160
TPG(1936, 90) = 35449
TPG(1936, 91) = 31723
TPG(1936, 92) = 28021
TPG(1936, 93) = 24389
TPG(1936, 94) = 20920
TPG(1936, 95) = 17652
TPG(1936, 96) = 14624
TPG(1936, 97) = 11867
TPG(1936, 98) = 9407
TPG(1936, 99) = 7262
TPG(1936, 100) = 5440
TPG(1936, 101) = 3938
TPG(1936, 102) = 2740
TPG(1936, 103) = 1821
TPG(1936, 104) = 1148
TPG(1936, 105) = 681
TPG(1936, 106) = 375
TPG(1936, 107) = 189
TPG(1936, 108) = 85
TPG(1936, 109) = 34
TPG(1936, 110) = 11
TPG(1936, 111) = 3
TPG(1936, 112) = 1
TPG(1936, 113) = 0
TPG(1936, 114) = 0
TPG(1936, 115) = 0
TPG(1936, 116) = 0
TPG(1936, 117) = 0
TPG(1963, 0) = 100000
TPG(1963, 1) = 98236
TPG(1963, 2) = 97600
TPG(1963, 3) = 97484
TPG(1963, 4) = 97399
TPG(1963, 5) = 97336
TPG(1963, 6) = 97305
TPG(1963, 7) = 97276
TPG(1963, 8) = 97249
TPG(1963, 9) = 97224
TPG(1963, 10) = 97200
TPG(1963, 11) = 97183
TPG(1963, 12) = 97165
TPG(1963, 13) = 97144
TPG(1963, 14) = 97121
TPG(1963, 15) = 97096
TPG(1963, 16) = 97067
TPG(1963, 17) = 97034
TPG(1963, 18) = 96997
TPG(1963, 19) = 96958
TPG(1963, 20) = 96917
TPG(1963, 21) = 96874
TPG(1963, 22) = 96829
TPG(1963, 23) = 96782
TPG(1963, 24) = 96734
TPG(1963, 25) = 96685
TPG(1963, 26) = 96636
TPG(1963, 27) = 96586
TPG(1963, 28) = 96536
TPG(1963, 29) = 96484
TPG(1963, 30) = 96431
TPG(1963, 31) = 96376
TPG(1963, 32) = 96321
TPG(1963, 33) = 96263
TPG(1963, 34) = 96203
TPG(1963, 35) = 96139
TPG(1963, 36) = 96072
TPG(1963, 37) = 96001
TPG(1963, 38) = 95926
TPG(1963, 39) = 95846
TPG(1963, 40) = 95762
TPG(1963, 41) = 95672
TPG(1963, 42) = 95576
TPG(1963, 43) = 95474
TPG(1963, 44) = 95366
TPG(1963, 45) = 95250
TPG(1963, 46) = 95127
TPG(1963, 47) = 94996
TPG(1963, 48) = 94857
TPG(1963, 49) = 94708
TPG(1963, 50) = 94548
TPG(1963, 51) = 94378
TPG(1963, 52) = 94196
TPG(1963, 53) = 94001
TPG(1963, 54) = 93797
TPG(1963, 55) = 93583
TPG(1963, 56) = 93359
TPG(1963, 57) = 93125
TPG(1963, 58) = 92880
TPG(1963, 59) = 92628
TPG(1963, 60) = 92371
TPG(1963, 61) = 92108
TPG(1963, 62) = 91839
TPG(1963, 63) = 91565
TPG(1963, 64) = 91276
TPG(1963, 65) = 90971
TPG(1963, 66) = 90650
TPG(1963, 67) = 90312
TPG(1963, 68) = 89956
TPG(1963, 69) = 89557
TPG(1963, 70) = 89109
TPG(1963, 71) = 88606
TPG(1963, 72) = 88041
TPG(1963, 73) = 87404
TPG(1963, 74) = 86677
TPG(1963, 75) = 85846
TPG(1963, 76) = 84895
TPG(1963, 77) = 83809
TPG(1963, 78) = 82569
TPG(1963, 79) = 81170
TPG(1963, 80) = 79596
TPG(1963, 81) = 77827
TPG(1963, 82) = 75843
TPG(1963, 83) = 73624
TPG(1963, 84) = 71190
TPG(1963, 85) = 68529
TPG(1963, 86) = 65631
TPG(1963, 87) = 62489
TPG(1963, 88) = 59100
TPG(1963, 89) = 55518
TPG(1963, 90) = 51756
TPG(1963, 91) = 47833
TPG(1963, 92) = 43775
TPG(1963, 93) = 39615
TPG(1963, 94) = 35460
TPG(1963, 95) = 31356
TPG(1963, 96) = 27347
TPG(1963, 97) = 23485
TPG(1963, 98) = 19820
TPG(1963, 99) = 16401
TPG(1963, 100) = 13272
TPG(1963, 101) = 10471
TPG(1963, 102) = 8025
TPG(1963, 103) = 5950
TPG(1963, 104) = 4246
TPG(1963, 105) = 2899
TPG(1963, 106) = 1880
TPG(1963, 107) = 1148
TPG(1963, 108) = 652
TPG(1963, 109) = 339
TPG(1963, 110) = 159
TPG(1963, 111) = 65
TPG(1963, 112) = 22
TPG(1963, 113) = 6
TPG(1963, 114) = 1
TPG(1963, 115) = 0
TPG(1963, 116) = 0
TPG(1963, 117) = 0
TPG(1964, 0) = 100000
TPG(1964, 1) = 98305
TPG(1964, 2) = 97694
TPG(1964, 3) = 97583
TPG(1964, 4) = 97501
TPG(1964, 5) = 97437
TPG(1964, 6) = 97407
TPG(1964, 7) = 97378
TPG(1964, 8) = 97352
TPG(1964, 9) = 97327
TPG(1964, 10) = 97303
TPG(1964, 11) = 97287
TPG(1964, 12) = 97269
TPG(1964, 13) = 97249
TPG(1964, 14) = 97227
TPG(1964, 15) = 97201
TPG(1964, 16) = 97172
TPG(1964, 17) = 97140
TPG(1964, 18) = 97103
TPG(1964, 19) = 97064
TPG(1964, 20) = 97024
TPG(1964, 21) = 96981
TPG(1964, 22) = 96936
TPG(1964, 23) = 96890
TPG(1964, 24) = 96842
TPG(1964, 25) = 96794
TPG(1964, 26) = 96746
TPG(1964, 27) = 96696
TPG(1964, 28) = 96647
TPG(1964, 29) = 96596
TPG(1964, 30) = 96544
TPG(1964, 31) = 96490
TPG(1964, 32) = 96435
TPG(1964, 33) = 96379
TPG(1964, 34) = 96319
TPG(1964, 35) = 96257
TPG(1964, 36) = 96190
TPG(1964, 37) = 96121
TPG(1964, 38) = 96047
TPG(1964, 39) = 95968
TPG(1964, 40) = 95885
TPG(1964, 41) = 95796
TPG(1964, 42) = 95702
TPG(1964, 43) = 95602
TPG(1964, 44) = 95495
TPG(1964, 45) = 95382
TPG(1964, 46) = 95261
TPG(1964, 47) = 95132
TPG(1964, 48) = 94994
TPG(1964, 49) = 94848
TPG(1964, 50) = 94691
TPG(1964, 51) = 94523
TPG(1964, 52) = 94344
TPG(1964, 53) = 94152
TPG(1964, 54) = 93951
TPG(1964, 55) = 93740
TPG(1964, 56) = 93519
TPG(1964, 57) = 93289
TPG(1964, 58) = 93048
TPG(1964, 59) = 92801
TPG(1964, 60) = 92548
TPG(1964, 61) = 92289
TPG(1964, 62) = 92026
TPG(1964, 63) = 91757
TPG(1964, 64) = 91473
TPG(1964, 65) = 91175
TPG(1964, 66) = 90860
TPG(1964, 67) = 90529
TPG(1964, 68) = 90180
TPG(1964, 69) = 89789
TPG(1964, 70) = 89350
TPG(1964, 71) = 88856
TPG(1964, 72) = 88300
TPG(1964, 73) = 87674
TPG(1964, 74) = 86959
TPG(1964, 75) = 86140
TPG(1964, 76) = 85203
TPG(1964, 77) = 84131
TPG(1964, 78) = 82907
TPG(1964, 79) = 81526
TPG(1964, 80) = 79970
TPG(1964, 81) = 78220
TPG(1964, 82) = 76256
TPG(1964, 83) = 74058
TPG(1964, 84) = 71645
TPG(1964, 85) = 69004
TPG(1964, 86) = 66126
TPG(1964, 87) = 63003
TPG(1964, 88) = 59631
TPG(1964, 89) = 56063
TPG(1964, 90) = 52312
TPG(1964, 91) = 48396
TPG(1964, 92) = 44338
TPG(1964, 93) = 40174
TPG(1964, 94) = 36009
TPG(1964, 95) = 31888
TPG(1964, 96) = 27857
TPG(1964, 97) = 23966
TPG(1964, 98) = 20266
TPG(1964, 99) = 16807
TPG(1964, 100) = 13634
TPG(1964, 101) = 10786
TPG(1964, 102) = 8292
TPG(1964, 103) = 6170
TPG(1964, 104) = 4420
TPG(1964, 105) = 3032
TPG(1964, 106) = 1976
TPG(1964, 107) = 1214
TPG(1964, 108) = 694
TPG(1964, 109) = 365
TPG(1964, 110) = 172
TPG(1964, 111) = 72
TPG(1964, 112) = 25
TPG(1964, 113) = 7
TPG(1964, 114) = 1
TPG(1964, 115) = 0
TPG(1964, 116) = 0
TPG(1964, 117) = 0
TPG(1978, 0) = 100000
TPG(1978, 1) = 99033
TPG(1978, 2) = 98680
TPG(1978, 3) = 98620
TPG(1978, 4) = 98572
TPG(1978, 5) = 98535
TPG(1978, 6) = 98513
TPG(1978, 7) = 98493
TPG(1978, 8) = 98473
TPG(1978, 9) = 98454
TPG(1978, 10) = 98435
TPG(1978, 11) = 98423
TPG(1978, 12) = 98409
TPG(1978, 13) = 98393
TPG(1978, 14) = 98374
TPG(1978, 15) = 98352
TPG(1978, 16) = 98328
TPG(1978, 17) = 98299
TPG(1978, 18) = 98266
TPG(1978, 19) = 98231
TPG(1978, 20) = 98195
TPG(1978, 21) = 98157
TPG(1978, 22) = 98118
TPG(1978, 23) = 98078
TPG(1978, 24) = 98037
TPG(1978, 25) = 97996
TPG(1978, 26) = 97955
TPG(1978, 27) = 97914
TPG(1978, 28) = 97874
TPG(1978, 29) = 97832
TPG(1978, 30) = 97790
TPG(1978, 31) = 97747
TPG(1978, 32) = 97703
TPG(1978, 33) = 97659
TPG(1978, 34) = 97612
TPG(1978, 35) = 97562
TPG(1978, 36) = 97510
TPG(1978, 37) = 97454
TPG(1978, 38) = 97395
TPG(1978, 39) = 97333
TPG(1978, 40) = 97266
TPG(1978, 41) = 97196
TPG(1978, 42) = 97121
TPG(1978, 43) = 97041
TPG(1978, 44) = 96956
TPG(1978, 45) = 96866
TPG(1978, 46) = 96770
TPG(1978, 47) = 96667
TPG(1978, 48) = 96558
TPG(1978, 49) = 96442
TPG(1978, 50) = 96316
TPG(1978, 51) = 96182
TPG(1978, 52) = 96037
TPG(1978, 53) = 95882
TPG(1978, 54) = 95720
TPG(1978, 55) = 95551
TPG(1978, 56) = 95375
TPG(1978, 57) = 95191
TPG(1978, 58) = 94999
TPG(1978, 59) = 94805
TPG(1978, 60) = 94608
TPG(1978, 61) = 94409
TPG(1978, 62) = 94208
TPG(1978, 63) = 94005
TPG(1978, 64) = 93791
TPG(1978, 65) = 93567
TPG(1978, 66) = 93331
TPG(1978, 67) = 93083
TPG(1978, 68) = 92823
TPG(1978, 69) = 92528
TPG(1978, 70) = 92193
TPG(1978, 71) = 91812
TPG(1978, 72) = 91380
TPG(1978, 73) = 90888
TPG(1978, 74) = 90320
TPG(1978, 75) = 89664
TPG(1978, 76) = 88905
TPG(1978, 77) = 88028
TPG(1978, 78) = 87015
TPG(1978, 79) = 85862
TPG(1978, 80) = 84552
TPG(1978, 81) = 83066
TPG(1978, 82) = 81381
TPG(1978, 83) = 79477
TPG(1978, 84) = 77365
TPG(1978, 85) = 75029
TPG(1978, 86) = 72453
TPG(1978, 87) = 69624
TPG(1978, 88) = 66529
TPG(1978, 89) = 63210
TPG(1978, 90) = 59669
TPG(1978, 91) = 55913
TPG(1978, 92) = 51957
TPG(1978, 93) = 47821
TPG(1978, 94) = 43609
TPG(1978, 95) = 39359
TPG(1978, 96) = 35113
TPG(1978, 97) = 30918
TPG(1978, 98) = 26826
TPG(1978, 99) = 22892
TPG(1978, 100) = 19170
TPG(1978, 101) = 15715
TPG(1978, 102) = 12574
TPG(1978, 103) = 9785
TPG(1978, 104) = 7377
TPG(1978, 105) = 5361
TPG(1978, 106) = 3734
TPG(1978, 107) = 2476
TPG(1978, 108) = 1549
TPG(1978, 109) = 904
TPG(1978, 110) = 486
TPG(1978, 111) = 236
TPG(1978, 112) = 101
TPG(1978, 113) = 37
TPG(1978, 114) = 11
TPG(1978, 115) = 2
TPG(1978, 116) = 0
TPG(1978, 117) = 0
TPG(1992, 0) = 100000
TPG(1992, 1) = 99450
TPG(1992, 2) = 99248
TPG(1992, 3) = 99215
TPG(1992, 4) = 99187
TPG(1992, 5) = 99164
TPG(1992, 6) = 99148
TPG(1992, 7) = 99133
TPG(1992, 8) = 99118
TPG(1992, 9) = 99104
TPG(1992, 10) = 99090
TPG(1992, 11) = 99080
TPG(1992, 12) = 99069
TPG(1992, 13) = 99056
TPG(1992, 14) = 99041
TPG(1992, 15) = 99023
TPG(1992, 16) = 99001
TPG(1992, 17) = 98976
TPG(1992, 18) = 98946
TPG(1992, 19) = 98915
TPG(1992, 20) = 98883
TPG(1992, 21) = 98850
TPG(1992, 22) = 98816
TPG(1992, 23) = 98781
TPG(1992, 24) = 98746
TPG(1992, 25) = 98712
TPG(1992, 26) = 98678
TPG(1992, 27) = 98644
TPG(1992, 28) = 98611
TPG(1992, 29) = 98578
TPG(1992, 30) = 98544
TPG(1992, 31) = 98509
TPG(1992, 32) = 98475
TPG(1992, 33) = 98440
TPG(1992, 34) = 98403
TPG(1992, 35) = 98364
TPG(1992, 36) = 98322
TPG(1992, 37) = 98278
TPG(1992, 38) = 98232
TPG(1992, 39) = 98182
TPG(1992, 40) = 98129
TPG(1992, 41) = 98074
TPG(1992, 42) = 98014
TPG(1992, 43) = 97951
TPG(1992, 44) = 97884
TPG(1992, 45) = 97812
TPG(1992, 46) = 97736
TPG(1992, 47) = 97656
TPG(1992, 48) = 97570
TPG(1992, 49) = 97477
TPG(1992, 50) = 97378
TPG(1992, 51) = 97271
TPG(1992, 52) = 97155
TPG(1992, 53) = 97031
TPG(1992, 54) = 96901
TPG(1992, 55) = 96766
TPG(1992, 56) = 96626
TPG(1992, 57) = 96480
TPG(1992, 58) = 96329
TPG(1992, 59) = 96177
TPG(1992, 60) = 96025
TPG(1992, 61) = 95873
TPG(1992, 62) = 95720
TPG(1992, 63) = 95568
TPG(1992, 64) = 95409
TPG(1992, 65) = 95242
TPG(1992, 66) = 95066
TPG(1992, 67) = 94882
TPG(1992, 68) = 94689
TPG(1992, 69) = 94469
TPG(1992, 70) = 94216
TPG(1992, 71) = 93926
TPG(1992, 72) = 93593
TPG(1992, 73) = 93211
TPG(1992, 74) = 92765
TPG(1992, 75) = 92245
TPG(1992, 76) = 91637
TPG(1992, 77) = 90929
TPG(1992, 78) = 90102
TPG(1992, 79) = 89154
TPG(1992, 80) = 88067
TPG(1992, 81) = 86825
TPG(1992, 82) = 85404
TPG(1992, 83) = 83783
TPG(1992, 84) = 81969
TPG(1992, 85) = 79944
TPG(1992, 86) = 77689
TPG(1992, 87) = 75185
TPG(1992, 88) = 72414
TPG(1992, 89) = 69407
TPG(1992, 90) = 66158
TPG(1992, 91) = 62664
TPG(1992, 92) = 58930
TPG(1992, 93) = 54963
TPG(1992, 94) = 50862
TPG(1992, 95) = 46654
TPG(1992, 96) = 42372
TPG(1992, 97) = 38056
TPG(1992, 98) = 33754
TPG(1992, 99) = 29518
TPG(1992, 100) = 25403
TPG(1992, 101) = 21470
TPG(1992, 102) = 17776
TPG(1992, 103) = 14377
TPG(1992, 104) = 11321
TPG(1992, 105) = 8645
TPG(1992, 106) = 6372
TPG(1992, 107) = 4508
TPG(1992, 108) = 3040
TPG(1992, 109) = 1939
TPG(1992, 110) = 1157
TPG(1992, 111) = 637
TPG(1992, 112) = 318
TPG(1992, 113) = 141
TPG(1992, 114) = 53
TPG(1992, 115) = 16
TPG(1992, 116) = 4
TPG(1992, 117) = 1
End Function

Function IniTPG5()
TPG(1923, 0) = 100000
TPG(1923, 1) = 91657
TPG(1923, 2) = 88821
TPG(1923, 3) = 88206
TPG(1923, 4) = 87832
TPG(1923, 5) = 87602
TPG(1923, 6) = 87531
TPG(1923, 7) = 87468
TPG(1923, 8) = 87411
TPG(1923, 9) = 87360
TPG(1923, 10) = 87313
TPG(1923, 11) = 87282
TPG(1923, 12) = 87248
TPG(1923, 13) = 87213
TPG(1923, 14) = 87176
TPG(1923, 15) = 87138
TPG(1923, 16) = 87097
TPG(1923, 17) = 87053
TPG(1923, 18) = 87007
TPG(1923, 19) = 86957
TPG(1923, 20) = 86903
TPG(1923, 21) = 86845
TPG(1923, 22) = 86783
TPG(1923, 23) = 86718
TPG(1923, 24) = 86650
TPG(1923, 25) = 86578
TPG(1923, 26) = 86503
TPG(1923, 27) = 86424
TPG(1923, 28) = 86342
TPG(1923, 29) = 86255
TPG(1923, 30) = 86165
TPG(1923, 31) = 86069
TPG(1923, 32) = 85970
TPG(1923, 33) = 85866
TPG(1923, 34) = 85757
TPG(1923, 35) = 85642
TPG(1923, 36) = 85522
TPG(1923, 37) = 85396
TPG(1923, 38) = 85263
TPG(1923, 39) = 85122
TPG(1923, 40) = 84972
TPG(1923, 41) = 84813
TPG(1923, 42) = 84643
TPG(1923, 43) = 84463
TPG(1923, 44) = 84271
TPG(1923, 45) = 84066
TPG(1923, 46) = 83847
TPG(1923, 47) = 83613
TPG(1923, 48) = 83364
TPG(1923, 49) = 83101
TPG(1923, 50) = 82823
TPG(1923, 51) = 82529
TPG(1923, 52) = 82218
TPG(1923, 53) = 81889
TPG(1923, 54) = 81541
TPG(1923, 55) = 81174
TPG(1923, 56) = 80786
TPG(1923, 57) = 80377
TPG(1923, 58) = 79947
TPG(1923, 59) = 79492
TPG(1923, 60) = 79012
TPG(1923, 61) = 78508
TPG(1923, 62) = 77979
TPG(1923, 63) = 77424
TPG(1923, 64) = 76837
TPG(1923, 65) = 76215
TPG(1923, 66) = 75557
TPG(1923, 67) = 74863
TPG(1923, 68) = 74130
TPG(1923, 69) = 73334
TPG(1923, 70) = 72468
TPG(1923, 71) = 71527
TPG(1923, 72) = 70503
TPG(1923, 73) = 69390
TPG(1923, 74) = 68157
TPG(1923, 75) = 66793
TPG(1923, 76) = 65287
TPG(1923, 77) = 63624
TPG(1923, 78) = 61793
TPG(1923, 79) = 59789
TPG(1923, 80) = 57604
TPG(1923, 81) = 55229
TPG(1923, 82) = 52657
TPG(1923, 83) = 49886
TPG(1923, 84) = 46961
TPG(1923, 85) = 43890
TPG(1923, 86) = 40687
TPG(1923, 87) = 37371
TPG(1923, 88) = 33967
TPG(1923, 89) = 30554
TPG(1923, 90) = 27166
TPG(1923, 91) = 23837
TPG(1923, 92) = 20609
TPG(1923, 93) = 17521
TPG(1923, 94) = 14650
TPG(1923, 95) = 12021
TPG(1923, 96) = 9659
TPG(1923, 97) = 7580
TPG(1923, 98) = 5791
TPG(1923, 99) = 4291
TPG(1923, 100) = 3072
TPG(1923, 101) = 2114
TPG(1923, 102) = 1390
TPG(1923, 103) = 867
TPG(1923, 104) = 508
TPG(1923, 105) = 277
TPG(1923, 106) = 138
TPG(1923, 107) = 62
TPG(1923, 108) = 24
TPG(1923, 109) = 8
TPG(1923, 110) = 2
TPG(1923, 111) = 0
TPG(1923, 112) = 0
TPG(1923, 113) = 0
TPG(1923, 114) = 0
TPG(1923, 115) = 0
TPG(1923, 116) = 0
TPG(1923, 117) = 0
TPG(1924, 0) = 100000
TPG(1924, 1) = 91962
TPG(1924, 2) = 89223
TPG(1924, 3) = 88632
TPG(1924, 4) = 88270
TPG(1924, 5) = 88047
TPG(1924, 6) = 87978
TPG(1924, 7) = 87916
TPG(1924, 8) = 87860
TPG(1924, 9) = 87809
TPG(1924, 10) = 87763
TPG(1924, 11) = 87732
TPG(1924, 12) = 87699
TPG(1924, 13) = 87664
TPG(1924, 14) = 87628
TPG(1924, 15) = 87589
TPG(1924, 16) = 87548
TPG(1924, 17) = 87505
TPG(1924, 18) = 87458
TPG(1924, 19) = 87409
TPG(1924, 20) = 87355
TPG(1924, 21) = 87297
TPG(1924, 22) = 87236
TPG(1924, 23) = 87171
TPG(1924, 24) = 87103
TPG(1924, 25) = 87032
TPG(1924, 26) = 86958
TPG(1924, 27) = 86880
TPG(1924, 28) = 86798
TPG(1924, 29) = 86712
TPG(1924, 30) = 86622
TPG(1924, 31) = 86528
TPG(1924, 32) = 86430
TPG(1924, 33) = 86327
TPG(1924, 34) = 86219
TPG(1924, 35) = 86106
TPG(1924, 36) = 85987
TPG(1924, 37) = 85863
TPG(1924, 38) = 85732
TPG(1924, 39) = 85592
TPG(1924, 40) = 85444
TPG(1924, 41) = 85287
TPG(1924, 42) = 85119
TPG(1924, 43) = 84941
TPG(1924, 44) = 84751
TPG(1924, 45) = 84548
TPG(1924, 46) = 84332
TPG(1924, 47) = 84101
TPG(1924, 48) = 83855
TPG(1924, 49) = 83595
TPG(1924, 50) = 83320
TPG(1924, 51) = 83029
TPG(1924, 52) = 82722
TPG(1924, 53) = 82396
TPG(1924, 54) = 82052
TPG(1924, 55) = 81688
TPG(1924, 56) = 81305
TPG(1924, 57) = 80901
TPG(1924, 58) = 80475
TPG(1924, 59) = 80025
TPG(1924, 60) = 79552
TPG(1924, 61) = 79054
TPG(1924, 62) = 78532
TPG(1924, 63) = 77986
TPG(1924, 64) = 77407
TPG(1924, 65) = 76794
TPG(1924, 66) = 76146
TPG(1924, 67) = 75462
TPG(1924, 68) = 74740
TPG(1924, 69) = 73955
TPG(1924, 70) = 73100
TPG(1924, 71) = 72170
TPG(1924, 72) = 71157
TPG(1924, 73) = 70055
TPG(1924, 74) = 68834
TPG(1924, 75) = 67482
TPG(1924, 76) = 65986
TPG(1924, 77) = 64334
TPG(1924, 78) = 62513
TPG(1924, 79) = 60519
TPG(1924, 80) = 58341
TPG(1924, 81) = 55972
TPG(1924, 82) = 53404
TPG(1924, 83) = 50634
TPG(1924, 84) = 47707
TPG(1924, 85) = 44630
TPG(1924, 86) = 41416
TPG(1924, 87) = 38084
TPG(1924, 88) = 34659
TPG(1924, 89) = 31220
TPG(1924, 90) = 27798
TPG(1924, 91) = 24432
TPG(1924, 92) = 21161
TPG(1924, 93) = 18025
TPG(1924, 94) = 15102
TPG(1924, 95) = 12421
TPG(1924, 96) = 10006
TPG(1924, 97) = 7873
TPG(1924, 98) = 6033
TPG(1924, 99) = 4486
TPG(1924, 100) = 3223
TPG(1924, 101) = 2227
TPG(1924, 102) = 1471
TPG(1924, 103) = 922
TPG(1924, 104) = 544
TPG(1924, 105) = 298
TPG(1924, 106) = 150
TPG(1924, 107) = 68
TPG(1924, 108) = 27
TPG(1924, 109) = 9
TPG(1924, 110) = 2
TPG(1924, 111) = 0
TPG(1924, 112) = 0
TPG(1924, 113) = 0
TPG(1924, 114) = 0
TPG(1924, 115) = 0
TPG(1924, 116) = 0
TPG(1924, 117) = 0
TPG(1951, 0) = 100000
TPG(1951, 1) = 97161
TPG(1951, 2) = 96149
TPG(1951, 3) = 95955
TPG(1951, 4) = 95820
TPG(1951, 5) = 95726
TPG(1951, 6) = 95686
TPG(1951, 7) = 95649
TPG(1951, 8) = 95615
TPG(1951, 9) = 95583
TPG(1951, 10) = 95553
TPG(1951, 11) = 95533
TPG(1951, 12) = 95511
TPG(1951, 13) = 95486
TPG(1951, 14) = 95459
TPG(1951, 15) = 95430
TPG(1951, 16) = 95397
TPG(1951, 17) = 95361
TPG(1951, 18) = 95321
TPG(1951, 19) = 95278
TPG(1951, 20) = 95233
TPG(1951, 21) = 95185
TPG(1951, 22) = 95135
TPG(1951, 23) = 95083
TPG(1951, 24) = 95029
TPG(1951, 25) = 94973
TPG(1951, 26) = 94916
TPG(1951, 27) = 94858
TPG(1951, 28) = 94799
TPG(1951, 29) = 94738
TPG(1951, 30) = 94674
TPG(1951, 31) = 94609
TPG(1951, 32) = 94541
TPG(1951, 33) = 94472
TPG(1951, 34) = 94399
TPG(1951, 35) = 94321
TPG(1951, 36) = 94240
TPG(1951, 37) = 94154
TPG(1951, 38) = 94064
TPG(1951, 39) = 93968
TPG(1951, 40) = 93866
TPG(1951, 41) = 93757
TPG(1951, 42) = 93642
TPG(1951, 43) = 93519
TPG(1951, 44) = 93388
TPG(1951, 45) = 93249
TPG(1951, 46) = 93100
TPG(1951, 47) = 92942
TPG(1951, 48) = 92773
TPG(1951, 49) = 92593
TPG(1951, 50) = 92402
TPG(1951, 51) = 92198
TPG(1951, 52) = 91980
TPG(1951, 53) = 91748
TPG(1951, 54) = 91504
TPG(1951, 55) = 91248
TPG(1951, 56) = 90980
TPG(1951, 57) = 90698
TPG(1951, 58) = 90403
TPG(1951, 59) = 90097
TPG(1951, 60) = 89781
TPG(1951, 61) = 89455
TPG(1951, 62) = 89119
TPG(1951, 63) = 88774
TPG(1951, 64) = 88409
TPG(1951, 65) = 88024
TPG(1951, 66) = 87618
TPG(1951, 67) = 87189
TPG(1951, 68) = 86738
TPG(1951, 69) = 86236
TPG(1951, 70) = 85677
TPG(1951, 71) = 85056
TPG(1951, 72) = 84364
TPG(1951, 73) = 83592
TPG(1951, 74) = 82719
TPG(1951, 75) = 81729
TPG(1951, 76) = 80607
TPG(1951, 77) = 79338
TPG(1951, 78) = 77903
TPG(1951, 79) = 76299
TPG(1951, 80) = 74507
TPG(1951, 81) = 72511
TPG(1951, 82) = 70293
TPG(1951, 83) = 67837
TPG(1951, 84) = 65170
TPG(1951, 85) = 62284
TPG(1951, 86) = 59176
TPG(1951, 87) = 55846
TPG(1951, 88) = 52300
TPG(1951, 89) = 48603
TPG(1951, 90) = 44776
TPG(1951, 91) = 40846
TPG(1951, 92) = 36848
TPG(1951, 93) = 32822
TPG(1951, 94) = 28874
TPG(1951, 95) = 25049
TPG(1951, 96) = 21393
TPG(1951, 97) = 17950
TPG(1951, 98) = 14766
TPG(1951, 99) = 11875
TPG(1951, 100) = 9310
TPG(1951, 101) = 7090
TPG(1951, 102) = 5223
TPG(1951, 103) = 3703
TPG(1951, 104) = 2512
TPG(1951, 105) = 1618
TPG(1951, 106) = 982
TPG(1951, 107) = 555
TPG(1951, 108) = 287
TPG(1951, 109) = 134
TPG(1951, 110) = 55
TPG(1951, 111) = 19
TPG(1951, 112) = 5
TPG(1951, 113) = 1
TPG(1951, 114) = 0
TPG(1951, 115) = 0
TPG(1951, 116) = 0
TPG(1951, 117) = 0
TPG(1952, 0) = 100000
TPG(1952, 1) = 97271
TPG(1952, 2) = 96297
TPG(1952, 3) = 96111
TPG(1952, 4) = 95981
TPG(1952, 5) = 95890
TPG(1952, 6) = 95851
TPG(1952, 7) = 95815
TPG(1952, 8) = 95781
TPG(1952, 9) = 95750
TPG(1952, 10) = 95721
TPG(1952, 11) = 95701
TPG(1952, 12) = 95679
TPG(1952, 13) = 95655
TPG(1952, 14) = 95628
TPG(1952, 15) = 95599
TPG(1952, 16) = 95567
TPG(1952, 17) = 95531
TPG(1952, 18) = 95491
TPG(1952, 19) = 95448
TPG(1952, 20) = 95404
TPG(1952, 21) = 95357
TPG(1952, 22) = 95307
TPG(1952, 23) = 95255
TPG(1952, 24) = 95201
TPG(1952, 25) = 95146
TPG(1952, 26) = 95090
TPG(1952, 27) = 95033
TPG(1952, 28) = 94974
TPG(1952, 29) = 94914
TPG(1952, 30) = 94851
TPG(1952, 31) = 94787
TPG(1952, 32) = 94720
TPG(1952, 33) = 94652
TPG(1952, 34) = 94580
TPG(1952, 35) = 94504
TPG(1952, 36) = 94424
TPG(1952, 37) = 94339
TPG(1952, 38) = 94250
TPG(1952, 39) = 94156
TPG(1952, 40) = 94055
TPG(1952, 41) = 93948
TPG(1952, 42) = 93835
TPG(1952, 43) = 93714
TPG(1952, 44) = 93585
TPG(1952, 45) = 93447
TPG(1952, 46) = 93301
TPG(1952, 47) = 93145
TPG(1952, 48) = 92979
TPG(1952, 49) = 92802
TPG(1952, 50) = 92613
TPG(1952, 51) = 92412
TPG(1952, 52) = 92198
TPG(1952, 53) = 91969
TPG(1952, 54) = 91729
TPG(1952, 55) = 91476
TPG(1952, 56) = 91212
TPG(1952, 57) = 90934
TPG(1952, 58) = 90643
TPG(1952, 59) = 90342
TPG(1952, 60) = 90032
TPG(1952, 61) = 89711
TPG(1952, 62) = 89381
TPG(1952, 63) = 89043
TPG(1952, 64) = 88685
TPG(1952, 65) = 88307
TPG(1952, 66) = 87908
TPG(1952, 67) = 87488
TPG(1952, 68) = 87045
TPG(1952, 69) = 86553
TPG(1952, 70) = 86004
TPG(1952, 71) = 85393
TPG(1952, 72) = 84712
TPG(1952, 73) = 83953
TPG(1952, 74) = 83091
TPG(1952, 75) = 82115
TPG(1952, 76) = 81008
TPG(1952, 77) = 79755
TPG(1952, 78) = 78336
TPG(1952, 79) = 76749
TPG(1952, 80) = 74975
TPG(1952, 81) = 72998
TPG(1952, 82) = 70799
TPG(1952, 83) = 68361
TPG(1952, 84) = 65711
TPG(1952, 85) = 62842
TPG(1952, 86) = 59749
TPG(1952, 87) = 56432
TPG(1952, 88) = 52895
TPG(1952, 89) = 49204
TPG(1952, 90) = 45377
TPG(1952, 91) = 41442
TPG(1952, 92) = 37433
TPG(1952, 93) = 33390
TPG(1952, 94) = 29419
TPG(1952, 95) = 25565
TPG(1952, 96) = 21874
TPG(1952, 97) = 18392
TPG(1952, 98) = 15163
TPG(1952, 99) = 12226
TPG(1952, 100) = 9612
TPG(1952, 101) = 7342
TPG(1952, 102) = 5428
TPG(1952, 103) = 3863
TPG(1952, 104) = 2632
TPG(1952, 105) = 1705
TPG(1952, 106) = 1040
TPG(1952, 107) = 592
TPG(1952, 108) = 309
TPG(1952, 109) = 146
TPG(1952, 110) = 60
TPG(1952, 111) = 21
TPG(1952, 112) = 6
TPG(1952, 113) = 1
TPG(1952, 114) = 0
TPG(1952, 115) = 0
TPG(1952, 116) = 0
TPG(1952, 117) = 0
TPG(1972, 0) = 100000
TPG(1972, 1) = 98769
TPG(1972, 2) = 98323
TPG(1972, 3) = 98244
TPG(1972, 4) = 98184
TPG(1972, 5) = 98138
TPG(1972, 6) = 98113
TPG(1972, 7) = 98089
TPG(1972, 8) = 98067
TPG(1972, 9) = 98045
TPG(1972, 10) = 98025
TPG(1972, 11) = 98011
TPG(1972, 12) = 97995
TPG(1972, 13) = 97978
TPG(1972, 14) = 97958
TPG(1972, 15) = 97935
TPG(1972, 16) = 97908
TPG(1972, 17) = 97878
TPG(1972, 18) = 97843
TPG(1972, 19) = 97807
TPG(1972, 20) = 97769
TPG(1972, 21) = 97729
TPG(1972, 22) = 97687
TPG(1972, 23) = 97644
TPG(1972, 24) = 97601
TPG(1972, 25) = 97557
TPG(1972, 26) = 97513
TPG(1972, 27) = 97469
TPG(1972, 28) = 97424
TPG(1972, 29) = 97379
TPG(1972, 30) = 97333
TPG(1972, 31) = 97285
TPG(1972, 32) = 97237
TPG(1972, 33) = 97188
TPG(1972, 34) = 97136
TPG(1972, 35) = 97081
TPG(1972, 36) = 97023
TPG(1972, 37) = 96962
TPG(1972, 38) = 96897
TPG(1972, 39) = 96828
TPG(1972, 40) = 96755
TPG(1972, 41) = 96677
TPG(1972, 42) = 96594
TPG(1972, 43) = 96506
TPG(1972, 44) = 96412
TPG(1972, 45) = 96312
TPG(1972, 46) = 96206
TPG(1972, 47) = 96093
TPG(1972, 48) = 95973
TPG(1972, 49) = 95844
TPG(1972, 50) = 95706
TPG(1972, 51) = 95558
TPG(1972, 52) = 95399
TPG(1972, 53) = 95229
TPG(1972, 54) = 95051
TPG(1972, 55) = 94865
TPG(1972, 56) = 94671
TPG(1972, 57) = 94468
TPG(1972, 58) = 94257
TPG(1972, 59) = 94041
TPG(1972, 60) = 93821
TPG(1972, 61) = 93598
TPG(1972, 62) = 93372
TPG(1972, 63) = 93143
TPG(1972, 64) = 92902
TPG(1972, 65) = 92648
TPG(1972, 66) = 92380
TPG(1972, 67) = 92099
TPG(1972, 68) = 91804
TPG(1972, 69) = 91471
TPG(1972, 70) = 91094
TPG(1972, 71) = 90668
TPG(1972, 72) = 90185
TPG(1972, 73) = 89639
TPG(1972, 74) = 89011
TPG(1972, 75) = 88288
TPG(1972, 76) = 87456
TPG(1972, 77) = 86499
TPG(1972, 78) = 85398
TPG(1972, 79) = 84149
TPG(1972, 80) = 82736
TPG(1972, 81) = 81138
TPG(1972, 82) = 79335
TPG(1972, 83) = 77305
TPG(1972, 84) = 75062
TPG(1972, 85) = 72594
TPG(1972, 86) = 69884
TPG(1972, 87) = 66923
TPG(1972, 88) = 63701
TPG(1972, 89) = 60265
TPG(1972, 90) = 56621
TPG(1972, 91) = 52781
TPG(1972, 92) = 48763
TPG(1972, 93) = 44595
TPG(1972, 94) = 40382
TPG(1972, 95) = 36164
TPG(1972, 96) = 31986
TPG(1972, 97) = 27898
TPG(1972, 98) = 23952
TPG(1972, 99) = 20202
TPG(1972, 100) = 16698
TPG(1972, 101) = 13490
TPG(1972, 102) = 10618
TPG(1972, 103) = 8112
TPG(1972, 104) = 5989
TPG(1972, 105) = 4251
TPG(1972, 106) = 2882
TPG(1972, 107) = 1852
TPG(1972, 108) = 1117
TPG(1972, 109) = 625
TPG(1972, 110) = 319
TPG(1972, 111) = 146
TPG(1972, 112) = 58
TPG(1972, 113) = 19
TPG(1972, 114) = 5
TPG(1972, 115) = 1
TPG(1972, 116) = 0
TPG(1972, 117) = 0
TPG(1986, 0) = 100000
TPG(1986, 1) = 99299
TPG(1986, 2) = 99043
TPG(1986, 3) = 99000
TPG(1986, 4) = 98965
TPG(1986, 5) = 98937
TPG(1986, 6) = 98918
TPG(1986, 7) = 98901
TPG(1986, 8) = 98884
TPG(1986, 9) = 98868
TPG(1986, 10) = 98852
TPG(1986, 11) = 98841
TPG(1986, 12) = 98829
TPG(1986, 13) = 98815
TPG(1986, 14) = 98798
TPG(1986, 15) = 98779
TPG(1986, 16) = 98756
TPG(1986, 17) = 98729
TPG(1986, 18) = 98698
TPG(1986, 19) = 98665
TPG(1986, 20) = 98632
TPG(1986, 21) = 98597
TPG(1986, 22) = 98561
TPG(1986, 23) = 98523
TPG(1986, 24) = 98486
TPG(1986, 25) = 98449
TPG(1986, 26) = 98412
TPG(1986, 27) = 98375
TPG(1986, 28) = 98339
TPG(1986, 29) = 98303
TPG(1986, 30) = 98265
TPG(1986, 31) = 98227
TPG(1986, 32) = 98189
TPG(1986, 33) = 98150
TPG(1986, 34) = 98109
TPG(1986, 35) = 98066
TPG(1986, 36) = 98020
TPG(1986, 37) = 97972
TPG(1986, 38) = 97920
TPG(1986, 39) = 97865
TPG(1986, 40) = 97807
TPG(1986, 41) = 97745
TPG(1986, 42) = 97680
TPG(1986, 43) = 97610
TPG(1986, 44) = 97535
TPG(1986, 45) = 97456
TPG(1986, 46) = 97372
TPG(1986, 47) = 97283
TPG(1986, 48) = 97188
TPG(1986, 49) = 97085
TPG(1986, 50) = 96976
TPG(1986, 51) = 96857
TPG(1986, 52) = 96730
TPG(1986, 53) = 96593
TPG(1986, 54) = 96451
TPG(1986, 55) = 96302
TPG(1986, 56) = 96147
TPG(1986, 57) = 95986
TPG(1986, 58) = 95819
TPG(1986, 59) = 95650
TPG(1986, 60) = 95480
TPG(1986, 61) = 95309
TPG(1986, 62) = 95137
TPG(1986, 63) = 94965
TPG(1986, 64) = 94784
TPG(1986, 65) = 94594
TPG(1986, 66) = 94395
TPG(1986, 67) = 94185
TPG(1986, 68) = 93966
TPG(1986, 69) = 93716
TPG(1986, 70) = 93431
TPG(1986, 71) = 93105
TPG(1986, 72) = 92732
TPG(1986, 73) = 92305
TPG(1986, 74) = 91810
TPG(1986, 75) = 91235
TPG(1986, 76) = 90566
TPG(1986, 77) = 89788
TPG(1986, 78) = 88885
TPG(1986, 79) = 87852
TPG(1986, 80) = 86674
TPG(1986, 81) = 85330
TPG(1986, 82) = 83799
TPG(1986, 83) = 82059
TPG(1986, 84) = 80119
TPG(1986, 85) = 77962
TPG(1986, 86) = 75569
TPG(1986, 87) = 72924
TPG(1986, 88) = 70011
TPG(1986, 89) = 66865
TPG(1986, 90) = 63484
TPG(1986, 91) = 59869
TPG(1986, 92) = 56027
TPG(1986, 93) = 51974
TPG(1986, 94) = 47809
TPG(1986, 95) = 43565
TPG(1986, 96) = 39278
TPG(1986, 97) = 34992
TPG(1986, 98) = 30758
TPG(1986, 99) = 26629
TPG(1986, 100) = 22663
TPG(1986, 101) = 18916
TPG(1986, 102) = 15444
TPG(1986, 103) = 12295
TPG(1986, 104) = 9510
TPG(1986, 105) = 7117
TPG(1986, 106) = 5126
TPG(1986, 107) = 3532
TPG(1986, 108) = 2310
TPG(1986, 109) = 1421
TPG(1986, 110) = 813
TPG(1986, 111) = 426
TPG(1986, 112) = 200
TPG(1986, 113) = 82
TPG(1986, 114) = 28
TPG(1986, 115) = 8
TPG(1986, 116) = 1
TPG(1986, 117) = 0
TPG(1937, 0) = 100000
TPG(1937, 1) = 95096
TPG(1937, 2) = 93380
TPG(1937, 3) = 93031
TPG(1937, 4) = 92804
TPG(1937, 5) = 92655
TPG(1937, 6) = 92601
TPG(1937, 7) = 92552
TPG(1937, 8) = 92507
TPG(1937, 9) = 92466
TPG(1937, 10) = 92429
TPG(1937, 11) = 92403
TPG(1937, 12) = 92375
TPG(1937, 13) = 92346
TPG(1937, 14) = 92314
TPG(1937, 15) = 92280
TPG(1937, 16) = 92243
TPG(1937, 17) = 92203
TPG(1937, 18) = 92159
TPG(1937, 19) = 92112
TPG(1937, 20) = 92063
TPG(1937, 21) = 92010
TPG(1937, 22) = 91954
TPG(1937, 23) = 91895
TPG(1937, 24) = 91833
TPG(1937, 25) = 91769
TPG(1937, 26) = 91703
TPG(1937, 27) = 91635
TPG(1937, 28) = 91564
TPG(1937, 29) = 91490
TPG(1937, 30) = 91413
TPG(1937, 31) = 91334
TPG(1937, 32) = 91251
TPG(1937, 33) = 91165
TPG(1937, 34) = 91074
TPG(1937, 35) = 90979
TPG(1937, 36) = 90879
TPG(1937, 37) = 90773
TPG(1937, 38) = 90663
TPG(1937, 39) = 90545
TPG(1937, 40) = 90420
TPG(1937, 41) = 90286
TPG(1937, 42) = 90145
TPG(1937, 43) = 89994
TPG(1937, 44) = 89834
TPG(1937, 45) = 89662
TPG(1937, 46) = 89480
TPG(1937, 47) = 89285
TPG(1937, 48) = 89077
TPG(1937, 49) = 88857
TPG(1937, 50) = 88623
TPG(1937, 51) = 88375
TPG(1937, 52) = 88111
TPG(1937, 53) = 87831
TPG(1937, 54) = 87536
TPG(1937, 55) = 87225
TPG(1937, 56) = 86898
TPG(1937, 57) = 86554
TPG(1937, 58) = 86193
TPG(1937, 59) = 85815
TPG(1937, 60) = 85420
TPG(1937, 61) = 85009
TPG(1937, 62) = 84581
TPG(1937, 63) = 84137
TPG(1937, 64) = 83667
TPG(1937, 65) = 83170
TPG(1937, 66) = 82645
TPG(1937, 67) = 82091
TPG(1937, 68) = 81506
TPG(1937, 69) = 80863
TPG(1937, 70) = 80156
TPG(1937, 71) = 79378
TPG(1937, 72) = 78520
TPG(1937, 73) = 77577
TPG(1937, 74) = 76519
TPG(1937, 75) = 75334
TPG(1937, 76) = 74008
TPG(1937, 77) = 72525
TPG(1937, 78) = 70870
TPG(1937, 79) = 69037
TPG(1937, 80) = 67013
TPG(1937, 81) = 64784
TPG(1937, 82) = 62337
TPG(1937, 83) = 59661
TPG(1937, 84) = 56793
TPG(1937, 85) = 53734
TPG(1937, 86) = 50487
TPG(1937, 87) = 47064
TPG(1937, 88) = 43480
TPG(1937, 89) = 39811
TPG(1937, 90) = 36084
TPG(1937, 91) = 32336
TPG(1937, 92) = 28607
TPG(1937, 93) = 24940
TPG(1937, 94) = 21431
TPG(1937, 95) = 18120
TPG(1937, 96) = 15044
TPG(1937, 97) = 12237
TPG(1937, 98) = 9726
TPG(1937, 99) = 7531
TPG(1937, 100) = 5660
TPG(1937, 101) = 4111
TPG(1937, 102) = 2872
TPG(1937, 103) = 1918
TPG(1937, 104) = 1216
TPG(1937, 105) = 725
TPG(1937, 106) = 402
TPG(1937, 107) = 204
TPG(1937, 108) = 93
TPG(1937, 109) = 37
TPG(1937, 110) = 13
TPG(1937, 111) = 3
TPG(1937, 112) = 1
TPG(1937, 113) = 0
TPG(1937, 114) = 0
TPG(1937, 115) = 0
TPG(1937, 116) = 0
TPG(1937, 117) = 0
TPG(1938, 0) = 100000
TPG(1938, 1) = 95282
TPG(1938, 2) = 93628
TPG(1938, 3) = 93293
TPG(1938, 4) = 93074
TPG(1938, 5) = 92930
TPG(1938, 6) = 92877
TPG(1938, 7) = 92829
TPG(1938, 8) = 92785
TPG(1938, 9) = 92745
TPG(1938, 10) = 92708
TPG(1938, 11) = 92683
TPG(1938, 12) = 92655
TPG(1938, 13) = 92626
TPG(1938, 14) = 92595
TPG(1938, 15) = 92561
TPG(1938, 16) = 92524
TPG(1938, 17) = 92484
TPG(1938, 18) = 92441
TPG(1938, 19) = 92394
TPG(1938, 20) = 92345
TPG(1938, 21) = 92293
TPG(1938, 22) = 92237
TPG(1938, 23) = 92179
TPG(1938, 24) = 92117
TPG(1938, 25) = 92054
TPG(1938, 26) = 91989
TPG(1938, 27) = 91921
TPG(1938, 28) = 91851
TPG(1938, 29) = 91778
TPG(1938, 30) = 91702
TPG(1938, 31) = 91624
TPG(1938, 32) = 91542
TPG(1938, 33) = 91457
TPG(1938, 34) = 91368
TPG(1938, 35) = 91274
TPG(1938, 36) = 91175
TPG(1938, 37) = 91071
TPG(1938, 38) = 90962
TPG(1938, 39) = 90846
TPG(1938, 40) = 90722
TPG(1938, 41) = 90591
TPG(1938, 42) = 90451
TPG(1938, 43) = 90303
TPG(1938, 44) = 90144
TPG(1938, 45) = 89976
TPG(1938, 46) = 89795
TPG(1938, 47) = 89603
TPG(1938, 48) = 89399
TPG(1938, 49) = 89181
TPG(1938, 50) = 88951
TPG(1938, 51) = 88706
TPG(1938, 52) = 88446
TPG(1938, 53) = 88169
TPG(1938, 54) = 87878
TPG(1938, 55) = 87571
TPG(1938, 56) = 87248
TPG(1938, 57) = 86909
TPG(1938, 58) = 86552
TPG(1938, 59) = 86180
TPG(1938, 60) = 85791
TPG(1938, 61) = 85386
TPG(1938, 62) = 84965
TPG(1938, 63) = 84529
TPG(1938, 64) = 84067
TPG(1938, 65) = 83578
TPG(1938, 66) = 83062
TPG(1938, 67) = 82518
TPG(1938, 68) = 81943
TPG(1938, 69) = 81311
TPG(1938, 70) = 80615
TPG(1938, 71) = 79848
TPG(1938, 72) = 79003
TPG(1938, 73) = 78072
TPG(1938, 74) = 77028
TPG(1938, 75) = 75857
TPG(1938, 76) = 74545
TPG(1938, 77) = 73077
TPG(1938, 78) = 71436
TPG(1938, 79) = 69618
TPG(1938, 80) = 67609
TPG(1938, 81) = 65395
TPG(1938, 82) = 62962
TPG(1938, 83) = 60298
TPG(1938, 84) = 57441
TPG(1938, 85) = 54390
TPG(1938, 86) = 51148
TPG(1938, 87) = 47725
TPG(1938, 88) = 44138
TPG(1938, 89) = 40459
TPG(1938, 90) = 36718
TPG(1938, 91) = 32950
TPG(1938, 92) = 29193
TPG(1938, 93) = 25493
TPG(1938, 94) = 21946
TPG(1938, 95) = 18592
TPG(1938, 96) = 15469
TPG(1938, 97) = 12613
TPG(1938, 98) = 10051
TPG(1938, 99) = 7805
TPG(1938, 100) = 5885
TPG(1938, 101) = 4290
TPG(1938, 102) = 3009
TPG(1938, 103) = 2019
TPG(1938, 104) = 1286
TPG(1938, 105) = 771
TPG(1938, 106) = 431
TPG(1938, 107) = 221
TPG(1938, 108) = 102
TPG(1938, 109) = 41
TPG(1938, 110) = 14
TPG(1938, 111) = 4
TPG(1938, 112) = 1
TPG(1938, 113) = 0
TPG(1938, 114) = 0
TPG(1938, 115) = 0
TPG(1938, 116) = 0
TPG(1938, 117) = 0
TPG(1965, 0) = 100000
TPG(1965, 1) = 98372
TPG(1965, 2) = 97783
TPG(1965, 3) = 97677
TPG(1965, 4) = 97594
TPG(1965, 5) = 97535
TPG(1965, 6) = 97506
TPG(1965, 7) = 97478
TPG(1965, 8) = 97452
TPG(1965, 9) = 97428
TPG(1965, 10) = 97405
TPG(1965, 11) = 97389
TPG(1965, 12) = 97371
TPG(1965, 13) = 97351
TPG(1965, 14) = 97329
TPG(1965, 15) = 97304
TPG(1965, 16) = 97276
TPG(1965, 17) = 97243
TPG(1965, 18) = 97207
TPG(1965, 19) = 97168
TPG(1965, 20) = 97128
TPG(1965, 21) = 97086
TPG(1965, 22) = 97041
TPG(1965, 23) = 96995
TPG(1965, 24) = 96948
TPG(1965, 25) = 96901
TPG(1965, 26) = 96853
TPG(1965, 27) = 96804
TPG(1965, 28) = 96755
TPG(1965, 29) = 96705
TPG(1965, 30) = 96654
TPG(1965, 31) = 96601
TPG(1965, 32) = 96547
TPG(1965, 33) = 96491
TPG(1965, 34) = 96433
TPG(1965, 35) = 96371
TPG(1965, 36) = 96306
TPG(1965, 37) = 96237
TPG(1965, 38) = 96165
TPG(1965, 39) = 96088
TPG(1965, 40) = 96006
TPG(1965, 41) = 95918
TPG(1965, 42) = 95826
TPG(1965, 43) = 95727
TPG(1965, 44) = 95622
TPG(1965, 45) = 95510
TPG(1965, 46) = 95391
TPG(1965, 47) = 95264
TPG(1965, 48) = 95129
TPG(1965, 49) = 94985
TPG(1965, 50) = 94830
TPG(1965, 51) = 94665
TPG(1965, 52) = 94489
TPG(1965, 53) = 94300
TPG(1965, 54) = 94101
TPG(1965, 55) = 93894
TPG(1965, 56) = 93677
TPG(1965, 57) = 93450
TPG(1965, 58) = 93213
TPG(1965, 59) = 92970
TPG(1965, 60) = 92721
TPG(1965, 61) = 92468
TPG(1965, 62) = 92209
TPG(1965, 63) = 91945
TPG(1965, 64) = 91667
TPG(1965, 65) = 91375
TPG(1965, 66) = 91066
TPG(1965, 67) = 90742
TPG(1965, 68) = 90400
TPG(1965, 69) = 90017
TPG(1965, 70) = 89586
TPG(1965, 71) = 89101
TPG(1965, 72) = 88554
TPG(1965, 73) = 87939
TPG(1965, 74) = 87235
TPG(1965, 75) = 86428
TPG(1965, 76) = 85505
TPG(1965, 77) = 84448
TPG(1965, 78) = 83240
TPG(1965, 79) = 81875
TPG(1965, 80) = 80337
TPG(1965, 81) = 78606
TPG(1965, 82) = 76663
TPG(1965, 83) = 74485
TPG(1965, 84) = 72093
TPG(1965, 85) = 69474
TPG(1965, 86) = 66616
TPG(1965, 87) = 63512
TPG(1965, 88) = 60157
TPG(1965, 89) = 56604
TPG(1965, 90) = 52865
TPG(1965, 91) = 48955
TPG(1965, 92) = 44900
TPG(1965, 93) = 40732
TPG(1965, 94) = 36558
TPG(1965, 95) = 32421
TPG(1965, 96) = 28368
TPG(1965, 97) = 24450
TPG(1965, 98) = 20716
TPG(1965, 99) = 17218
TPG(1965, 100) = 14001
TPG(1965, 101) = 11107
TPG(1965, 102) = 8565
TPG(1965, 103) = 6394
TPG(1965, 104) = 4599
TPG(1965, 105) = 3169
TPG(1965, 106) = 2076
TPG(1965, 107) = 1282
TPG(1965, 108) = 739
TPG(1965, 109) = 391
TPG(1965, 110) = 187
TPG(1965, 111) = 79
TPG(1965, 112) = 28
TPG(1965, 113) = 8
TPG(1965, 114) = 2
TPG(1965, 115) = 0
TPG(1965, 116) = 0
TPG(1965, 117) = 0
TPG(1979, 0) = 100000
TPG(1979, 1) = 99071
TPG(1979, 2) = 98732
TPG(1979, 3) = 98674
TPG(1979, 4) = 98629
TPG(1979, 5) = 98592
TPG(1979, 6) = 98571
TPG(1979, 7) = 98551
TPG(1979, 8) = 98532
TPG(1979, 9) = 98513
TPG(1979, 10) = 98495
TPG(1979, 11) = 98483
TPG(1979, 12) = 98469
TPG(1979, 13) = 98453
TPG(1979, 14) = 98434
TPG(1979, 15) = 98413
TPG(1979, 16) = 98389
TPG(1979, 17) = 98360
TPG(1979, 18) = 98327
TPG(1979, 19) = 98293
TPG(1979, 20) = 98257
TPG(1979, 21) = 98220
TPG(1979, 22) = 98181
TPG(1979, 23) = 98141
TPG(1979, 24) = 98101
TPG(1979, 25) = 98060
TPG(1979, 26) = 98020
TPG(1979, 27) = 97980
TPG(1979, 28) = 97940
TPG(1979, 29) = 97899
TPG(1979, 30) = 97857
TPG(1979, 31) = 97815
TPG(1979, 32) = 97772
TPG(1979, 33) = 97728
TPG(1979, 34) = 97682
TPG(1979, 35) = 97633
TPG(1979, 36) = 97582
TPG(1979, 37) = 97527
TPG(1979, 38) = 97469
TPG(1979, 39) = 97408
TPG(1979, 40) = 97342
TPG(1979, 41) = 97273
TPG(1979, 42) = 97199
TPG(1979, 43) = 97121
TPG(1979, 44) = 97037
TPG(1979, 45) = 96948
TPG(1979, 46) = 96854
TPG(1979, 47) = 96753
TPG(1979, 48) = 96646
TPG(1979, 49) = 96531
TPG(1979, 50) = 96408
TPG(1979, 51) = 96275
TPG(1979, 52) = 96133
TPG(1979, 53) = 95980
TPG(1979, 54) = 95821
TPG(1979, 55) = 95655
TPG(1979, 56) = 95481
TPG(1979, 57) = 95300
TPG(1979, 58) = 95112
TPG(1979, 59) = 94921
TPG(1979, 60) = 94727
TPG(1979, 61) = 94532
TPG(1979, 62) = 94335
TPG(1979, 63) = 94136
TPG(1979, 64) = 93927
TPG(1979, 65) = 93707
TPG(1979, 66) = 93476
TPG(1979, 67) = 93233
TPG(1979, 68) = 92978
TPG(1979, 69) = 92689
TPG(1979, 70) = 92361
TPG(1979, 71) = 91988
TPG(1979, 72) = 91563
TPG(1979, 73) = 91080
TPG(1979, 74) = 90521
TPG(1979, 75) = 89875
TPG(1979, 76) = 89128
TPG(1979, 77) = 88264
TPG(1979, 78) = 87265
TPG(1979, 79) = 86128
TPG(1979, 80) = 84835
TPG(1979, 81) = 83367
TPG(1979, 82) = 81702
TPG(1979, 83) = 79818
TPG(1979, 84) = 77728
TPG(1979, 85) = 75415
TPG(1979, 86) = 72862
TPG(1979, 87) = 70055
TPG(1979, 88) = 66982
TPG(1979, 89) = 63684
TPG(1979, 90) = 60162
TPG(1979, 91) = 56422
TPG(1979, 92) = 52478
TPG(1979, 93) = 48350
TPG(1979, 94) = 44142
TPG(1979, 95) = 39889
TPG(1979, 96) = 35635
TPG(1979, 97) = 31425
TPG(1979, 98) = 27312
TPG(1979, 99) = 23350
TPG(1979, 100) = 19595
TPG(1979, 101) = 16101
TPG(1979, 102) = 12916
TPG(1979, 103) = 10081
TPG(1979, 104) = 7625
TPG(1979, 105) = 5563
TPG(1979, 106) = 3892
TPG(1979, 107) = 2593
TPG(1979, 108) = 1632
TPG(1979, 109) = 959
TPG(1979, 110) = 520
TPG(1979, 111) = 255
TPG(1979, 112) = 111
TPG(1979, 113) = 41
TPG(1979, 114) = 12
TPG(1979, 115) = 3
TPG(1979, 116) = 0
TPG(1979, 117) = 0
TPG(1993, 0) = 100000
TPG(1993, 1) = 99471
TPG(1993, 2) = 99277
TPG(1993, 3) = 99246
TPG(1993, 4) = 99220
TPG(1993, 5) = 99197
TPG(1993, 6) = 99182
TPG(1993, 7) = 99167
TPG(1993, 8) = 99152
TPG(1993, 9) = 99138
TPG(1993, 10) = 99124
TPG(1993, 11) = 99115
TPG(1993, 12) = 99104
TPG(1993, 13) = 99091
TPG(1993, 14) = 99076
TPG(1993, 15) = 99058
TPG(1993, 16) = 99037
TPG(1993, 17) = 99012
TPG(1993, 18) = 98983
TPG(1993, 19) = 98952
TPG(1993, 20) = 98920
TPG(1993, 21) = 98887
TPG(1993, 22) = 98854
TPG(1993, 23) = 98819
TPG(1993, 24) = 98784
TPG(1993, 25) = 98750
TPG(1993, 26) = 98717
TPG(1993, 27) = 98684
TPG(1993, 28) = 98651
TPG(1993, 29) = 98618
TPG(1993, 30) = 98585
TPG(1993, 31) = 98551
TPG(1993, 32) = 98517
TPG(1993, 33) = 98483
TPG(1993, 34) = 98446
TPG(1993, 35) = 98408
TPG(1993, 36) = 98367
TPG(1993, 37) = 98324
TPG(1993, 38) = 98278
TPG(1993, 39) = 98229
TPG(1993, 40) = 98177
TPG(1993, 41) = 98122
TPG(1993, 42) = 98064
TPG(1993, 43) = 98002
TPG(1993, 44) = 97936
TPG(1993, 45) = 97866
TPG(1993, 46) = 97791
TPG(1993, 47) = 97711
TPG(1993, 48) = 97627
TPG(1993, 49) = 97536
TPG(1993, 50) = 97438
TPG(1993, 51) = 97333
TPG(1993, 52) = 97219
TPG(1993, 53) = 97097
TPG(1993, 54) = 96969
TPG(1993, 55) = 96836
TPG(1993, 56) = 96699
TPG(1993, 57) = 96555
TPG(1993, 58) = 96407
TPG(1993, 59) = 96258
TPG(1993, 60) = 96108
TPG(1993, 61) = 95959
TPG(1993, 62) = 95809
TPG(1993, 63) = 95661
TPG(1993, 64) = 95504
TPG(1993, 65) = 95341
TPG(1993, 66) = 95169
TPG(1993, 67) = 94989
TPG(1993, 68) = 94800
TPG(1993, 69) = 94584
TPG(1993, 70) = 94337
TPG(1993, 71) = 94052
TPG(1993, 72) = 93726
TPG(1993, 73) = 93350
TPG(1993, 74) = 92912
TPG(1993, 75) = 92400
TPG(1993, 76) = 91803
TPG(1993, 77) = 91105
TPG(1993, 78) = 90290
TPG(1993, 79) = 89356
TPG(1993, 80) = 88285
TPG(1993, 81) = 87058
TPG(1993, 82) = 85656
TPG(1993, 83) = 84054
TPG(1993, 84) = 82261
TPG(1993, 85) = 80258
TPG(1993, 86) = 78025
TPG(1993, 87) = 75544
TPG(1993, 88) = 72797
TPG(1993, 89) = 69814
TPG(1993, 90) = 66588
TPG(1993, 91) = 63116
TPG(1993, 92) = 59400
TPG(1993, 93) = 55450
TPG(1993, 94) = 51362
TPG(1993, 95) = 47162
TPG(1993, 96) = 42883
TPG(1993, 97) = 38566
TPG(1993, 98) = 34255
TPG(1993, 99) = 30004
TPG(1993, 100) = 25868
TPG(1993, 101) = 21907
TPG(1993, 102) = 18179
TPG(1993, 103) = 14740
TPG(1993, 104) = 11640
TPG(1993, 105) = 8917
TPG(1993, 106) = 6597
TPG(1993, 107) = 4687
TPG(1993, 108) = 3177
TPG(1993, 109) = 2038
TPG(1993, 110) = 1224
TPG(1993, 111) = 680
TPG(1993, 112) = 343
TPG(1993, 113) = 154
TPG(1993, 114) = 59
TPG(1993, 115) = 19
TPG(1993, 116) = 4
TPG(1993, 117) = 1
TPG(1925, 0) = 100000
TPG(1925, 1) = 92257
TPG(1925, 2) = 89612
TPG(1925, 3) = 89044
TPG(1925, 4) = 88695
TPG(1925, 5) = 88478
TPG(1925, 6) = 88410
TPG(1925, 7) = 88349
TPG(1925, 8) = 88294
TPG(1925, 9) = 88244
TPG(1925, 10) = 88199
TPG(1925, 11) = 88168
TPG(1925, 12) = 88135
TPG(1925, 13) = 88101
TPG(1925, 14) = 88065
TPG(1925, 15) = 88026
TPG(1925, 16) = 87986
TPG(1925, 17) = 87943
TPG(1925, 18) = 87896
TPG(1925, 19) = 87847
TPG(1925, 20) = 87794
TPG(1925, 21) = 87736
TPG(1925, 22) = 87675
TPG(1925, 23) = 87611
TPG(1925, 24) = 87543
TPG(1925, 25) = 87472
TPG(1925, 26) = 87398
TPG(1925, 27) = 87321
TPG(1925, 28) = 87240
TPG(1925, 29) = 87155
TPG(1925, 30) = 87066
TPG(1925, 31) = 86973
TPG(1925, 32) = 86876
TPG(1925, 33) = 86775
TPG(1925, 34) = 86668
TPG(1925, 35) = 86556
TPG(1925, 36) = 86439
TPG(1925, 37) = 86316
TPG(1925, 38) = 86186
TPG(1925, 39) = 86048
TPG(1925, 40) = 85902
TPG(1925, 41) = 85746
TPG(1925, 42) = 85581
TPG(1925, 43) = 85405
TPG(1925, 44) = 85217
TPG(1925, 45) = 85017
TPG(1925, 46) = 84803
TPG(1925, 47) = 84575
TPG(1925, 48) = 84332
TPG(1925, 49) = 84075
TPG(1925, 50) = 83803
TPG(1925, 51) = 83516
TPG(1925, 52) = 83211
TPG(1925, 53) = 82889
TPG(1925, 54) = 82548
TPG(1925, 55) = 82189
TPG(1925, 56) = 81810
TPG(1925, 57) = 81410
TPG(1925, 58) = 80989
TPG(1925, 59) = 80545
TPG(1925, 60) = 80078
TPG(1925, 61) = 79587
TPG(1925, 62) = 79072
TPG(1925, 63) = 78533
TPG(1925, 64) = 77963
TPG(1925, 65) = 77359
TPG(1925, 66) = 76721
TPG(1925, 67) = 76047
TPG(1925, 68) = 75336
TPG(1925, 69) = 74562
TPG(1925, 70) = 73718
TPG(1925, 71) = 72799
TPG(1925, 72) = 71798
TPG(1925, 73) = 70708
TPG(1925, 74) = 69498
TPG(1925, 75) = 68158
TPG(1925, 76) = 66674
TPG(1925, 77) = 65033
TPG(1925, 78) = 63222
TPG(1925, 79) = 61237
TPG(1925, 80) = 59068
TPG(1925, 81) = 56706
TPG(1925, 82) = 54143
TPG(1925, 83) = 51375
TPG(1925, 84) = 48446
TPG(1925, 85) = 45364
TPG(1925, 86) = 42141
TPG(1925, 87) = 38795
TPG(1925, 88) = 35350
TPG(1925, 89) = 31885
TPG(1925, 90) = 28433
TPG(1925, 91) = 25030
TPG(1925, 92) = 21716
TPG(1925, 93) = 18534
TPG(1925, 94) = 15561
TPG(1925, 95) = 12827
TPG(1925, 96) = 10358
TPG(1925, 97) = 8172
TPG(1925, 98) = 6281
TPG(1925, 99) = 4686
TPG(1925, 100) = 3379
TPG(1925, 101) = 2345
TPG(1925, 102) = 1556
TPG(1925, 103) = 980
TPG(1925, 104) = 581
TPG(1925, 105) = 321
TPG(1925, 106) = 163
TPG(1925, 107) = 74
TPG(1925, 108) = 30
TPG(1925, 109) = 10
TPG(1925, 110) = 3
TPG(1925, 111) = 1
TPG(1925, 112) = 0
TPG(1925, 113) = 0
TPG(1925, 114) = 0
TPG(1925, 115) = 0
TPG(1925, 116) = 0
TPG(1925, 117) = 0
TPG(1926, 0) = 100000
TPG(1926, 1) = 92542
TPG(1926, 2) = 89988
TPG(1926, 3) = 89442
TPG(1926, 4) = 89105
TPG(1926, 5) = 88895
TPG(1926, 6) = 88828
TPG(1926, 7) = 88768
TPG(1926, 8) = 88714
TPG(1926, 9) = 88665
TPG(1926, 10) = 88620
TPG(1926, 11) = 88590
TPG(1926, 12) = 88558
TPG(1926, 13) = 88524
TPG(1926, 14) = 88488
TPG(1926, 15) = 88450
TPG(1926, 16) = 88410
TPG(1926, 17) = 88366
TPG(1926, 18) = 88320
TPG(1926, 19) = 88271
TPG(1926, 20) = 88218
TPG(1926, 21) = 88160
TPG(1926, 22) = 88100
TPG(1926, 23) = 88036
TPG(1926, 24) = 87969
TPG(1926, 25) = 87899
TPG(1926, 26) = 87825
TPG(1926, 27) = 87748
TPG(1926, 28) = 87668
TPG(1926, 29) = 87584
TPG(1926, 30) = 87497
TPG(1926, 31) = 87405
TPG(1926, 32) = 87309
TPG(1926, 33) = 87209
TPG(1926, 34) = 87103
TPG(1926, 35) = 86993
TPG(1926, 36) = 86877
TPG(1926, 37) = 86755
TPG(1926, 38) = 86627
TPG(1926, 39) = 86491
TPG(1926, 40) = 86347
TPG(1926, 41) = 86193
TPG(1926, 42) = 86029
TPG(1926, 43) = 85856
TPG(1926, 44) = 85670
TPG(1926, 45) = 85472
TPG(1926, 46) = 85261
TPG(1926, 47) = 85036
TPG(1926, 48) = 84796
TPG(1926, 49) = 84542
TPG(1926, 50) = 84273
TPG(1926, 51) = 83989
TPG(1926, 52) = 83687
TPG(1926, 53) = 83369
TPG(1926, 54) = 83032
TPG(1926, 55) = 82676
TPG(1926, 56) = 82301
TPG(1926, 57) = 81906
TPG(1926, 58) = 81490
TPG(1926, 59) = 81052
TPG(1926, 60) = 80590
TPG(1926, 61) = 80106
TPG(1926, 62) = 79599
TPG(1926, 63) = 79068
TPG(1926, 64) = 78506
TPG(1926, 65) = 77912
TPG(1926, 66) = 77283
TPG(1926, 67) = 76619
TPG(1926, 68) = 75919
TPG(1926, 69) = 75156
TPG(1926, 70) = 74324
TPG(1926, 71) = 73416
TPG(1926, 72) = 72427
TPG(1926, 73) = 71348
TPG(1926, 74) = 70150
TPG(1926, 75) = 68822
TPG(1926, 76) = 67349
TPG(1926, 77) = 65720
TPG(1926, 78) = 63920
TPG(1926, 79) = 61945
TPG(1926, 80) = 59785
TPG(1926, 81) = 57430
TPG(1926, 82) = 54873
TPG(1926, 83) = 52108
TPG(1926, 84) = 49180
TPG(1926, 85) = 46094
TPG(1926, 86) = 42863
TPG(1926, 87) = 39504
TPG(1926, 88) = 36040
TPG(1926, 89) = 32551
TPG(1926, 90) = 29069
TPG(1926, 91) = 25630
TPG(1926, 92) = 22275
TPG(1926, 93) = 19047
TPG(1926, 94) = 16024
TPG(1926, 95) = 13239
TPG(1926, 96) = 10717
TPG(1926, 97) = 8478
TPG(1926, 98) = 6535
TPG(1926, 99) = 4892
TPG(1926, 100) = 3541
TPG(1926, 101) = 2466
TPG(1926, 102) = 1644
TPG(1926, 103) = 1041
TPG(1926, 104) = 621
TPG(1926, 105) = 345
TPG(1926, 106) = 176
TPG(1926, 107) = 81
TPG(1926, 108) = 33
TPG(1926, 109) = 11
TPG(1926, 110) = 3
TPG(1926, 111) = 1
TPG(1926, 112) = 0
TPG(1926, 113) = 0
TPG(1926, 114) = 0
TPG(1926, 115) = 0
TPG(1926, 116) = 0
TPG(1926, 117) = 0
TPG(1953, 0) = 100000
TPG(1953, 1) = 97377
TPG(1953, 2) = 96439
TPG(1953, 3) = 96261
TPG(1953, 4) = 96136
TPG(1953, 5) = 96048
TPG(1953, 6) = 96010
TPG(1953, 7) = 95974
TPG(1953, 8) = 95941
TPG(1953, 9) = 95911
TPG(1953, 10) = 95882
TPG(1953, 11) = 95862
TPG(1953, 12) = 95841
TPG(1953, 13) = 95817
TPG(1953, 14) = 95791
TPG(1953, 15) = 95762
TPG(1953, 16) = 95730
TPG(1953, 17) = 95694
TPG(1953, 18) = 95655
TPG(1953, 19) = 95613
TPG(1953, 20) = 95568
TPG(1953, 21) = 95521
TPG(1953, 22) = 95472
TPG(1953, 23) = 95420
TPG(1953, 24) = 95367
TPG(1953, 25) = 95313
TPG(1953, 26) = 95258
TPG(1953, 27) = 95201
TPG(1953, 28) = 95143
TPG(1953, 29) = 95084
TPG(1953, 30) = 95022
TPG(1953, 31) = 94959
TPG(1953, 32) = 94893
TPG(1953, 33) = 94826
TPG(1953, 34) = 94755
TPG(1953, 35) = 94680
TPG(1953, 36) = 94601
TPG(1953, 37) = 94518
TPG(1953, 38) = 94431
TPG(1953, 39) = 94337
TPG(1953, 40) = 94238
TPG(1953, 41) = 94133
TPG(1953, 42) = 94021
TPG(1953, 43) = 93902
TPG(1953, 44) = 93775
TPG(1953, 45) = 93640
TPG(1953, 46) = 93496
TPG(1953, 47) = 93342
TPG(1953, 48) = 93178
TPG(1953, 49) = 93004
TPG(1953, 50) = 92818
TPG(1953, 51) = 92620
TPG(1953, 52) = 92409
TPG(1953, 53) = 92183
TPG(1953, 54) = 91946
TPG(1953, 55) = 91698
TPG(1953, 56) = 91437
TPG(1953, 57) = 91164
TPG(1953, 58) = 90877
TPG(1953, 59) = 90581
TPG(1953, 60) = 90275
TPG(1953, 61) = 89961
TPG(1953, 62) = 89637
TPG(1953, 63) = 89304
TPG(1953, 64) = 88953
TPG(1953, 65) = 88582
TPG(1953, 66) = 88191
TPG(1953, 67) = 87779
TPG(1953, 68) = 87345
TPG(1953, 69) = 86861
TPG(1953, 70) = 86323
TPG(1953, 71) = 85722
TPG(1953, 72) = 85052
TPG(1953, 73) = 84304
TPG(1953, 74) = 83456
TPG(1953, 75) = 82493
TPG(1953, 76) = 81401
TPG(1953, 77) = 80163
TPG(1953, 78) = 78761
TPG(1953, 79) = 77190
TPG(1953, 80) = 75435
TPG(1953, 81) = 73476
TPG(1953, 82) = 71296
TPG(1953, 83) = 68877
TPG(1953, 84) = 66245
TPG(1953, 85) = 63393
TPG(1953, 86) = 60316
TPG(1953, 87) = 57012
TPG(1953, 88) = 53485
TPG(1953, 89) = 49800
TPG(1953, 90) = 45975
TPG(1953, 91) = 42037
TPG(1953, 92) = 38018
TPG(1953, 93) = 33959
TPG(1953, 94) = 29966
TPG(1953, 95) = 26084
TPG(1953, 96) = 22359
TPG(1953, 97) = 18838
TPG(1953, 98) = 15566
TPG(1953, 99) = 12582
TPG(1953, 100) = 9919
TPG(1953, 101) = 7600
TPG(1953, 102) = 5638
TPG(1953, 103) = 4029
TPG(1953, 104) = 2757
TPG(1953, 105) = 1795
TPG(1953, 106) = 1102
TPG(1953, 107) = 631
TPG(1953, 108) = 332
TPG(1953, 109) = 158
TPG(1953, 110) = 66
TPG(1953, 111) = 24
TPG(1953, 112) = 7
TPG(1953, 113) = 1
TPG(1953, 114) = 0
TPG(1953, 115) = 0
TPG(1953, 116) = 0
TPG(1953, 117) = 0
TPG(1954, 0) = 100000
TPG(1954, 1) = 97478
TPG(1954, 2) = 96576
TPG(1954, 3) = 96406
TPG(1954, 4) = 96286
TPG(1954, 5) = 96200
TPG(1954, 6) = 96163
TPG(1954, 7) = 96128
TPG(1954, 8) = 96096
TPG(1954, 9) = 96066
TPG(1954, 10) = 96037
TPG(1954, 11) = 96018
TPG(1954, 12) = 95997
TPG(1954, 13) = 95974
TPG(1954, 14) = 95948
TPG(1954, 15) = 95918
TPG(1954, 16) = 95886
TPG(1954, 17) = 95851
TPG(1954, 18) = 95812
TPG(1954, 19) = 95770
TPG(1954, 20) = 95726
TPG(1954, 21) = 95679
TPG(1954, 22) = 95631
TPG(1954, 23) = 95579
TPG(1954, 24) = 95527
TPG(1954, 25) = 95473
TPG(1954, 26) = 95418
TPG(1954, 27) = 95362
TPG(1954, 28) = 95305
TPG(1954, 29) = 95247
TPG(1954, 30) = 95186
TPG(1954, 31) = 95123
TPG(1954, 32) = 95059
TPG(1954, 33) = 94993
TPG(1954, 34) = 94923
TPG(1954, 35) = 94849
TPG(1954, 36) = 94772
TPG(1954, 37) = 94690
TPG(1954, 38) = 94603
TPG(1954, 39) = 94512
TPG(1954, 40) = 94414
TPG(1954, 41) = 94310
TPG(1954, 42) = 94200
TPG(1954, 43) = 94083
TPG(1954, 44) = 93958
TPG(1954, 45) = 93825
TPG(1954, 46) = 93683
TPG(1954, 47) = 93532
TPG(1954, 48) = 93371
TPG(1954, 49) = 93199
TPG(1954, 50) = 93016
TPG(1954, 51) = 92821
TPG(1954, 52) = 92612
TPG(1954, 53) = 92390
TPG(1954, 54) = 92157
TPG(1954, 55) = 91912
TPG(1954, 56) = 91655
TPG(1954, 57) = 91385
TPG(1954, 58) = 91103
TPG(1954, 59) = 90812
TPG(1954, 60) = 90512
TPG(1954, 61) = 90202
TPG(1954, 62) = 89884
TPG(1954, 63) = 89558
TPG(1954, 64) = 89213
TPG(1954, 65) = 88850
TPG(1954, 66) = 88466
TPG(1954, 67) = 88062
TPG(1954, 68) = 87636
TPG(1954, 69) = 87162
TPG(1954, 70) = 86633
TPG(1954, 71) = 86042
TPG(1954, 72) = 85383
TPG(1954, 73) = 84647
TPG(1954, 74) = 83811
TPG(1954, 75) = 82862
TPG(1954, 76) = 81785
TPG(1954, 77) = 80562
TPG(1954, 78) = 79176
TPG(1954, 79) = 77623
TPG(1954, 80) = 75885
TPG(1954, 81) = 73945
TPG(1954, 82) = 71784
TPG(1954, 83) = 69384
TPG(1954, 84) = 66771
TPG(1954, 85) = 63937
TPG(1954, 86) = 60876
TPG(1954, 87) = 57585
TPG(1954, 88) = 54069
TPG(1954, 89) = 50391
TPG(1954, 90) = 46569
TPG(1954, 91) = 42628
TPG(1954, 92) = 38601
TPG(1954, 93) = 34527
TPG(1954, 94) = 30513
TPG(1954, 95) = 26604
TPG(1954, 96) = 22846
TPG(1954, 97) = 19287
TPG(1954, 98) = 15972
TPG(1954, 99) = 12942
TPG(1954, 100) = 10231
TPG(1954, 101) = 7864
TPG(1954, 102) = 5853
TPG(1954, 103) = 4199
TPG(1954, 104) = 2886
TPG(1954, 105) = 1888
TPG(1954, 106) = 1166
TPG(1954, 107) = 672
TPG(1954, 108) = 357
TPG(1954, 109) = 171
TPG(1954, 110) = 73
TPG(1954, 111) = 26
TPG(1954, 112) = 8
TPG(1954, 113) = 2
TPG(1954, 114) = 0
TPG(1954, 115) = 0
TPG(1954, 116) = 0
TPG(1954, 117) = 0
TPG(1973, 0) = 100000
TPG(1973, 1) = 98818
TPG(1973, 2) = 98388
TPG(1973, 3) = 98313
TPG(1973, 4) = 98255
TPG(1973, 5) = 98211
TPG(1973, 6) = 98186
TPG(1973, 7) = 98163
TPG(1973, 8) = 98141
TPG(1973, 9) = 98120
TPG(1973, 10) = 98100
TPG(1973, 11) = 98086
TPG(1973, 12) = 98071
TPG(1973, 13) = 98054
TPG(1973, 14) = 98034
TPG(1973, 15) = 98011
TPG(1973, 16) = 97985
TPG(1973, 17) = 97955
TPG(1973, 18) = 97920
TPG(1973, 19) = 97884
TPG(1973, 20) = 97846
TPG(1973, 21) = 97807
TPG(1973, 22) = 97766
TPG(1973, 23) = 97723
TPG(1973, 24) = 97680
TPG(1973, 25) = 97637
TPG(1973, 26) = 97593
TPG(1973, 27) = 97550
TPG(1973, 28) = 97506
TPG(1973, 29) = 97462
TPG(1973, 30) = 97416
TPG(1973, 31) = 97369
TPG(1973, 32) = 97322
TPG(1973, 33) = 97273
TPG(1973, 34) = 97222
TPG(1973, 35) = 97168
TPG(1973, 36) = 97111
TPG(1973, 37) = 97051
TPG(1973, 38) = 96987
TPG(1973, 39) = 96919
TPG(1973, 40) = 96847
TPG(1973, 41) = 96771
TPG(1973, 42) = 96689
TPG(1973, 43) = 96603
TPG(1973, 44) = 96510
TPG(1973, 45) = 96412
TPG(1973, 46) = 96308
TPG(1973, 47) = 96196
TPG(1973, 48) = 96078
TPG(1973, 49) = 95951
TPG(1973, 50) = 95815
TPG(1973, 51) = 95670
TPG(1973, 52) = 95513
TPG(1973, 53) = 95346
TPG(1973, 54) = 95171
TPG(1973, 55) = 94988
TPG(1973, 56) = 94797
TPG(1973, 57) = 94597
TPG(1973, 58) = 94389
TPG(1973, 59) = 94177
TPG(1973, 60) = 93961
TPG(1973, 61) = 93743
TPG(1973, 62) = 93521
TPG(1973, 63) = 93296
TPG(1973, 64) = 93060
TPG(1973, 65) = 92811
TPG(1973, 66) = 92549
TPG(1973, 67) = 92274
TPG(1973, 68) = 91985
TPG(1973, 69) = 91658
TPG(1973, 70) = 91288
TPG(1973, 71) = 90870
TPG(1973, 72) = 90396
TPG(1973, 73) = 89860
TPG(1973, 74) = 89242
TPG(1973, 75) = 88530
TPG(1973, 76) = 87711
TPG(1973, 77) = 86767
TPG(1973, 78) = 85681
TPG(1973, 79) = 84449
TPG(1973, 80) = 83053
TPG(1973, 81) = 81474
TPG(1973, 82) = 79691
TPG(1973, 83) = 77681
TPG(1973, 84) = 75461
TPG(1973, 85) = 73014
TPG(1973, 86) = 70327
TPG(1973, 87) = 67387
TPG(1973, 88) = 64185
TPG(1973, 89) = 60768
TPG(1973, 90) = 57140
TPG(1973, 91) = 53312
TPG(1973, 92) = 49303
TPG(1973, 93) = 45138
TPG(1973, 94) = 40923
TPG(1973, 95) = 36698
TPG(1973, 96) = 32506
TPG(1973, 97) = 28398
TPG(1973, 98) = 24426
TPG(1973, 99) = 20642
TPG(1973, 100) = 17101
TPG(1973, 101) = 13850
TPG(1973, 102) = 10932
TPG(1973, 103) = 8378
TPG(1973, 104) = 6208
TPG(1973, 105) = 4424
TPG(1973, 106) = 3013
TPG(1973, 107) = 1947
TPG(1973, 108) = 1182
TPG(1973, 109) = 666
TPG(1973, 110) = 343
TPG(1973, 111) = 158
TPG(1973, 112) = 63
TPG(1973, 113) = 21
TPG(1973, 114) = 6
TPG(1973, 115) = 1
TPG(1973, 116) = 0
TPG(1973, 117) = 0
TPG(1987, 0) = 100000
TPG(1987, 1) = 99327
TPG(1987, 2) = 99080
TPG(1987, 3) = 99039
TPG(1987, 4) = 99006
TPG(1987, 5) = 98978
TPG(1987, 6) = 98961
TPG(1987, 7) = 98943
TPG(1987, 8) = 98927
TPG(1987, 9) = 98911
TPG(1987, 10) = 98896
TPG(1987, 11) = 98885
TPG(1987, 12) = 98873
TPG(1987, 13) = 98859
TPG(1987, 14) = 98842
TPG(1987, 15) = 98823
TPG(1987, 16) = 98801
TPG(1987, 17) = 98774
TPG(1987, 18) = 98743
TPG(1987, 19) = 98711
TPG(1987, 20) = 98678
TPG(1987, 21) = 98643
TPG(1987, 22) = 98607
TPG(1987, 23) = 98570
TPG(1987, 24) = 98533
TPG(1987, 25) = 98497
TPG(1987, 26) = 98460
TPG(1987, 27) = 98424
TPG(1987, 28) = 98389
TPG(1987, 29) = 98353
TPG(1987, 30) = 98316
TPG(1987, 31) = 98279
TPG(1987, 32) = 98241
TPG(1987, 33) = 98203
TPG(1987, 34) = 98163
TPG(1987, 35) = 98120
TPG(1987, 36) = 98075
TPG(1987, 37) = 98027
TPG(1987, 38) = 97976
TPG(1987, 39) = 97923
TPG(1987, 40) = 97865
TPG(1987, 41) = 97804
TPG(1987, 42) = 97740
TPG(1987, 43) = 97671
TPG(1987, 44) = 97598
TPG(1987, 45) = 97520
TPG(1987, 46) = 97438
TPG(1987, 47) = 97350
TPG(1987, 48) = 97256
TPG(1987, 49) = 97156
TPG(1987, 50) = 97048
TPG(1987, 51) = 96931
TPG(1987, 52) = 96806
TPG(1987, 53) = 96671
TPG(1987, 54) = 96531
TPG(1987, 55) = 96385
TPG(1987, 56) = 96232
TPG(1987, 57) = 96074
TPG(1987, 58) = 95909
TPG(1987, 59) = 95743
TPG(1987, 60) = 95576
TPG(1987, 61) = 95409
TPG(1987, 62) = 95240
TPG(1987, 63) = 95072
TPG(1987, 64) = 94895
TPG(1987, 65) = 94709
TPG(1987, 66) = 94513
TPG(1987, 67) = 94309
TPG(1987, 68) = 94094
TPG(1987, 69) = 93849
TPG(1987, 70) = 93569
TPG(1987, 71) = 93250
TPG(1987, 72) = 92884
TPG(1987, 73) = 92465
TPG(1987, 74) = 91978
TPG(1987, 75) = 91412
TPG(1987, 76) = 90754
TPG(1987, 77) = 89988
TPG(1987, 78) = 89098
TPG(1987, 79) = 88080
TPG(1987, 80) = 86917
TPG(1987, 81) = 85590
TPG(1987, 82) = 84078
TPG(1987, 83) = 82358
TPG(1987, 84) = 80440
TPG(1987, 85) = 78305
TPG(1987, 86) = 75935
TPG(1987, 87) = 73313
TPG(1987, 88) = 70424
TPG(1987, 89) = 67301
TPG(1987, 90) = 63941
TPG(1987, 91) = 60345
TPG(1987, 92) = 56520
TPG(1987, 93) = 52480
TPG(1987, 94) = 48325
TPG(1987, 95) = 44084
TPG(1987, 96) = 39796
TPG(1987, 97) = 35503
TPG(1987, 98) = 31255
TPG(1987, 99) = 27107
TPG(1987, 100) = 23113
TPG(1987, 101) = 19333
TPG(1987, 102) = 15822
TPG(1987, 103) = 12630
TPG(1987, 104) = 9800
TPG(1987, 105) = 7359
TPG(1987, 106) = 5321
TPG(1987, 107) = 3683
TPG(1987, 108) = 2422
TPG(1987, 109) = 1499
TPG(1987, 110) = 864
TPG(1987, 111) = 456
TPG(1987, 112) = 217
TPG(1987, 113) = 90
TPG(1987, 114) = 31
TPG(1987, 115) = 9
TPG(1987, 116) = 2
TPG(1987, 117) = 0
TPG(1939, 0) = 100000
TPG(1939, 1) = 95461
TPG(1939, 2) = 93867
TPG(1939, 3) = 93546
TPG(1939, 4) = 93335
TPG(1939, 5) = 93195
TPG(1939, 6) = 93144
TPG(1939, 7) = 93097
TPG(1939, 8) = 93054
TPG(1939, 9) = 93014
TPG(1939, 10) = 92977
TPG(1939, 11) = 92953
TPG(1939, 12) = 92926
TPG(1939, 13) = 92897
TPG(1939, 14) = 92866
TPG(1939, 15) = 92832
TPG(1939, 16) = 92796
TPG(1939, 17) = 92756
TPG(1939, 18) = 92713
TPG(1939, 19) = 92667
TPG(1939, 20) = 92618
TPG(1939, 21) = 92566
TPG(1939, 22) = 92511
TPG(1939, 23) = 92453
TPG(1939, 24) = 92392
TPG(1939, 25) = 92329
TPG(1939, 26) = 92265
TPG(1939, 27) = 92198
TPG(1939, 28) = 92129
TPG(1939, 29) = 92057
TPG(1939, 30) = 91982
TPG(1939, 31) = 91904
TPG(1939, 32) = 91823
TPG(1939, 33) = 91740
TPG(1939, 34) = 91652
TPG(1939, 35) = 91559
TPG(1939, 36) = 91462
TPG(1939, 37) = 91360
TPG(1939, 38) = 91252
TPG(1939, 39) = 91138
TPG(1939, 40) = 91016
TPG(1939, 41) = 90886
TPG(1939, 42) = 90748
TPG(1939, 43) = 90602
TPG(1939, 44) = 90446
TPG(1939, 45) = 90279
TPG(1939, 46) = 90102
TPG(1939, 47) = 89912
TPG(1939, 48) = 89710
TPG(1939, 49) = 89496
TPG(1939, 50) = 89269
TPG(1939, 51) = 89027
TPG(1939, 52) = 88770
TPG(1939, 53) = 88497
TPG(1939, 54) = 88210
TPG(1939, 55) = 87907
TPG(1939, 56) = 87589
TPG(1939, 57) = 87254
TPG(1939, 58) = 86902
TPG(1939, 59) = 86535
TPG(1939, 60) = 86152
TPG(1939, 61) = 85753
TPG(1939, 62) = 85340
TPG(1939, 63) = 84910
TPG(1939, 64) = 84456
TPG(1939, 65) = 83977
TPG(1939, 66) = 83470
TPG(1939, 67) = 82935
TPG(1939, 68) = 82370
TPG(1939, 69) = 81749
TPG(1939, 70) = 81064
TPG(1939, 71) = 80309
TPG(1939, 72) = 79476
TPG(1939, 73) = 78557
TPG(1939, 74) = 77526
TPG(1939, 75) = 76369
TPG(1939, 76) = 75071
TPG(1939, 77) = 73618
TPG(1939, 78) = 71992
TPG(1939, 79) = 70190
TPG(1939, 80) = 68196
TPG(1939, 81) = 65997
TPG(1939, 82) = 63578
TPG(1939, 83) = 60928
TPG(1939, 84) = 58081
TPG(1939, 85) = 55038
TPG(1939, 86) = 51802
TPG(1939, 87) = 48382
TPG(1939, 88) = 44791
TPG(1939, 89) = 41105
TPG(1939, 90) = 37351
TPG(1939, 91) = 33563
TPG(1939, 92) = 29780
TPG(1939, 93) = 26049
TPG(1939, 94) = 22464
TPG(1939, 95) = 19068
TPG(1939, 96) = 15899
TPG(1939, 97) = 12994
TPG(1939, 98) = 10382
TPG(1939, 99) = 8085
TPG(1939, 100) = 6115
TPG(1939, 101) = 4474
TPG(1939, 102) = 3151
TPG(1939, 103) = 2124
TPG(1939, 104) = 1360
TPG(1939, 105) = 820
TPG(1939, 106) = 461
TPG(1939, 107) = 238
TPG(1939, 108) = 111
TPG(1939, 109) = 45
TPG(1939, 110) = 16
TPG(1939, 111) = 4
TPG(1939, 112) = 1
TPG(1939, 113) = 0
TPG(1939, 114) = 0
TPG(1939, 115) = 0
TPG(1939, 116) = 0
TPG(1939, 117) = 0
TPG(1940, 0) = 100000
TPG(1940, 1) = 95633
TPG(1940, 2) = 94098
TPG(1940, 3) = 93790
TPG(1940, 4) = 93587
TPG(1940, 5) = 93451
TPG(1940, 6) = 93401
TPG(1940, 7) = 93355
TPG(1940, 8) = 93312
TPG(1940, 9) = 93274
TPG(1940, 10) = 93238
TPG(1940, 11) = 93213
TPG(1940, 12) = 93187
TPG(1940, 13) = 93158
TPG(1940, 14) = 93128
TPG(1940, 15) = 93094
TPG(1940, 16) = 93058
TPG(1940, 17) = 93019
TPG(1940, 18) = 92976
TPG(1940, 19) = 92930
TPG(1940, 20) = 92881
TPG(1940, 21) = 92830
TPG(1940, 22) = 92775
TPG(1940, 23) = 92717
TPG(1940, 24) = 92657
TPG(1940, 25) = 92595
TPG(1940, 26) = 92531
TPG(1940, 27) = 92465
TPG(1940, 28) = 92397
TPG(1940, 29) = 92326
TPG(1940, 30) = 92252
TPG(1940, 31) = 92175
TPG(1940, 32) = 92096
TPG(1940, 33) = 92013
TPG(1940, 34) = 91927
TPG(1940, 35) = 91835
TPG(1940, 36) = 91740
TPG(1940, 37) = 91639
TPG(1940, 38) = 91532
TPG(1940, 39) = 91420
TPG(1940, 40) = 91299
TPG(1940, 41) = 91172
TPG(1940, 42) = 91036
TPG(1940, 43) = 90892
TPG(1940, 44) = 90738
TPG(1940, 45) = 90573
TPG(1940, 46) = 90398
TPG(1940, 47) = 90212
TPG(1940, 48) = 90013
TPG(1940, 49) = 89801
TPG(1940, 50) = 89577
TPG(1940, 51) = 89339
TPG(1940, 52) = 89085
TPG(1940, 53) = 88816
TPG(1940, 54) = 88532
TPG(1940, 55) = 88233
TPG(1940, 56) = 87919
TPG(1940, 57) = 87589
TPG(1940, 58) = 87242
TPG(1940, 59) = 86880
TPG(1940, 60) = 86503
TPG(1940, 61) = 86111
TPG(1940, 62) = 85704
TPG(1940, 63) = 85282
TPG(1940, 64) = 84836
TPG(1940, 65) = 84365
TPG(1940, 66) = 83867
TPG(1940, 67) = 83341
TPG(1940, 68) = 82787
TPG(1940, 69) = 82176
TPG(1940, 70) = 81502
TPG(1940, 71) = 80758
TPG(1940, 72) = 79937
TPG(1940, 73) = 79031
TPG(1940, 74) = 78013
TPG(1940, 75) = 76870
TPG(1940, 76) = 75587
TPG(1940, 77) = 74149
TPG(1940, 78) = 72538
TPG(1940, 79) = 70752
TPG(1940, 80) = 68773
TPG(1940, 81) = 66589
TPG(1940, 82) = 64185
TPG(1940, 83) = 61548
TPG(1940, 84) = 58714
TPG(1940, 85) = 55681
TPG(1940, 86) = 52451
TPG(1940, 87) = 49033
TPG(1940, 88) = 45441
TPG(1940, 89) = 41748
TPG(1940, 90) = 37982
TPG(1940, 91) = 34176
TPG(1940, 92) = 30369
TPG(1940, 93) = 26606
TPG(1940, 94) = 22985
TPG(1940, 95) = 19548
TPG(1940, 96) = 16334
TPG(1940, 97) = 13381
TPG(1940, 98) = 10718
TPG(1940, 99) = 8370
TPG(1940, 100) = 6351
TPG(1940, 101) = 4663
TPG(1940, 102) = 3297
TPG(1940, 103) = 2232
TPG(1940, 104) = 1437
TPG(1940, 105) = 872
TPG(1940, 106) = 493
TPG(1940, 107) = 257
TPG(1940, 108) = 121
TPG(1940, 109) = 50
TPG(1940, 110) = 18
TPG(1940, 111) = 5
TPG(1940, 112) = 1
TPG(1940, 113) = 0
TPG(1940, 114) = 0
TPG(1940, 115) = 0
TPG(1940, 116) = 0
TPG(1940, 117) = 0
End Function

Function IniTPG6()
TPG(1966, 0) = 100000
TPG(1966, 1) = 98435
TPG(1966, 2) = 97870
TPG(1966, 3) = 97762
TPG(1966, 4) = 97687
TPG(1966, 5) = 97630
TPG(1966, 6) = 97601
TPG(1966, 7) = 97574
TPG(1966, 8) = 97549
TPG(1966, 9) = 97525
TPG(1966, 10) = 97502
TPG(1966, 11) = 97486
TPG(1966, 12) = 97469
TPG(1966, 13) = 97449
TPG(1966, 14) = 97427
TPG(1966, 15) = 97403
TPG(1966, 16) = 97375
TPG(1966, 17) = 97343
TPG(1966, 18) = 97306
TPG(1966, 19) = 97268
TPG(1966, 20) = 97228
TPG(1966, 21) = 97186
TPG(1966, 22) = 97142
TPG(1966, 23) = 97097
TPG(1966, 24) = 97050
TPG(1966, 25) = 97003
TPG(1966, 26) = 96956
TPG(1966, 27) = 96908
TPG(1966, 28) = 96860
TPG(1966, 29) = 96810
TPG(1966, 30) = 96759
TPG(1966, 31) = 96707
TPG(1966, 32) = 96654
TPG(1966, 33) = 96600
TPG(1966, 34) = 96542
TPG(1966, 35) = 96482
TPG(1966, 36) = 96418
TPG(1966, 37) = 96350
TPG(1966, 38) = 96279
TPG(1966, 39) = 96203
TPG(1966, 40) = 96122
TPG(1966, 41) = 96036
TPG(1966, 42) = 95945
TPG(1966, 43) = 95848
TPG(1966, 44) = 95744
TPG(1966, 45) = 95634
TPG(1966, 46) = 95517
TPG(1966, 47) = 95392
TPG(1966, 48) = 95259
TPG(1966, 49) = 95117
TPG(1966, 50) = 94965
TPG(1966, 51) = 94803
TPG(1966, 52) = 94629
TPG(1966, 53) = 94443
TPG(1966, 54) = 94247
TPG(1966, 55) = 94043
TPG(1966, 56) = 93830
TPG(1966, 57) = 93606
TPG(1966, 58) = 93373
TPG(1966, 59) = 93134
TPG(1966, 60) = 92890
TPG(1966, 61) = 92641
TPG(1966, 62) = 92387
TPG(1966, 63) = 92128
TPG(1966, 64) = 91856
TPG(1966, 65) = 91569
TPG(1966, 66) = 91267
TPG(1966, 67) = 90949
TPG(1966, 68) = 90615
TPG(1966, 69) = 90239
TPG(1966, 70) = 89816
TPG(1966, 71) = 89339
TPG(1966, 72) = 88803
TPG(1966, 73) = 88198
TPG(1966, 74) = 87504
TPG(1966, 75) = 86710
TPG(1966, 76) = 85800
TPG(1966, 77) = 84758
TPG(1966, 78) = 83565
TPG(1966, 79) = 82218
TPG(1966, 80) = 80698
TPG(1966, 81) = 78986
TPG(1966, 82) = 77063
TPG(1966, 83) = 74906
TPG(1966, 84) = 72535
TPG(1966, 85) = 69937
TPG(1966, 86) = 67100
TPG(1966, 87) = 64015
TPG(1966, 88) = 60678
TPG(1966, 89) = 57141
TPG(1966, 90) = 53413
TPG(1966, 91) = 49511
TPG(1966, 92) = 45459
TPG(1966, 93) = 41288
TPG(1966, 94) = 37106
TPG(1966, 95) = 32955
TPG(1966, 96) = 28881
TPG(1966, 97) = 24935
TPG(1966, 98) = 21169
TPG(1966, 99) = 17632
TPG(1966, 100) = 14373
TPG(1966, 101) = 11432
TPG(1966, 102) = 8843
TPG(1966, 103) = 6624
TPG(1966, 104) = 4783
TPG(1966, 105) = 3310
TPG(1966, 106) = 2179
TPG(1966, 107) = 1354
TPG(1966, 108) = 785
TPG(1966, 109) = 419
TPG(1966, 110) = 202
TPG(1966, 111) = 86
TPG(1966, 112) = 31
TPG(1966, 113) = 9
TPG(1966, 114) = 2
TPG(1966, 115) = 0
TPG(1966, 116) = 0
TPG(1966, 117) = 0
TPG(1980, 0) = 100000
TPG(1980, 1) = 99107
TPG(1980, 2) = 98782
TPG(1980, 3) = 98727
TPG(1980, 4) = 98683
TPG(1980, 5) = 98647
TPG(1980, 6) = 98627
TPG(1980, 7) = 98607
TPG(1980, 8) = 98588
TPG(1980, 9) = 98569
TPG(1980, 10) = 98552
TPG(1980, 11) = 98540
TPG(1980, 12) = 98526
TPG(1980, 13) = 98510
TPG(1980, 14) = 98492
TPG(1980, 15) = 98471
TPG(1980, 16) = 98447
TPG(1980, 17) = 98419
TPG(1980, 18) = 98386
TPG(1980, 19) = 98352
TPG(1980, 20) = 98316
TPG(1980, 21) = 98279
TPG(1980, 22) = 98241
TPG(1980, 23) = 98201
TPG(1980, 24) = 98161
TPG(1980, 25) = 98121
TPG(1980, 26) = 98082
TPG(1980, 27) = 98042
TPG(1980, 28) = 98003
TPG(1980, 29) = 97962
TPG(1980, 30) = 97921
TPG(1980, 31) = 97880
TPG(1980, 32) = 97837
TPG(1980, 33) = 97795
TPG(1980, 34) = 97749
TPG(1980, 35) = 97701
TPG(1980, 36) = 97650
TPG(1980, 37) = 97597
TPG(1980, 38) = 97540
TPG(1980, 39) = 97479
TPG(1980, 40) = 97415
TPG(1980, 41) = 97347
TPG(1980, 42) = 97274
TPG(1980, 43) = 97197
TPG(1980, 44) = 97115
TPG(1980, 45) = 97027
TPG(1980, 46) = 96934
TPG(1980, 47) = 96835
TPG(1980, 48) = 96730
TPG(1980, 49) = 96617
TPG(1980, 50) = 96496
TPG(1980, 51) = 96365
TPG(1980, 52) = 96226
TPG(1980, 53) = 96075
TPG(1980, 54) = 95918
TPG(1980, 55) = 95755
TPG(1980, 56) = 95584
TPG(1980, 57) = 95406
TPG(1980, 58) = 95221
TPG(1980, 59) = 95033
TPG(1980, 60) = 94843
TPG(1980, 61) = 94651
TPG(1980, 62) = 94458
TPG(1980, 63) = 94263
TPG(1980, 64) = 94058
TPG(1980, 65) = 93843
TPG(1980, 66) = 93617
TPG(1980, 67) = 93379
TPG(1980, 68) = 93130
TPG(1980, 69) = 92846
TPG(1980, 70) = 92525
TPG(1980, 71) = 92158
TPG(1980, 72) = 91742
TPG(1980, 73) = 91267
TPG(1980, 74) = 90718
TPG(1980, 75) = 90082
TPG(1980, 76) = 89347
TPG(1980, 77) = 88496
TPG(1980, 78) = 87511
TPG(1980, 79) = 86389
TPG(1980, 80) = 85113
TPG(1980, 81) = 83663
TPG(1980, 82) = 82017
TPG(1980, 83) = 80154
TPG(1980, 84) = 78085
TPG(1980, 85) = 75794
TPG(1980, 86) = 73264
TPG(1980, 87) = 70480
TPG(1980, 88) = 67430
TPG(1980, 89) = 64153
TPG(1980, 90) = 60650
TPG(1980, 91) = 56926
TPG(1980, 92) = 52995
TPG(1980, 93) = 48876
TPG(1980, 94) = 44672
TPG(1980, 95) = 40418
TPG(1980, 96) = 36156
TPG(1980, 97) = 31933
TPG(1980, 98) = 27800
TPG(1980, 99) = 23811
TPG(1980, 100) = 20024
TPG(1980, 101) = 16491
TPG(1980, 102) = 13264
TPG(1980, 103) = 10383
TPG(1980, 104) = 7879
TPG(1980, 105) = 5770
TPG(1980, 106) = 4054
TPG(1980, 107) = 2715
TPG(1980, 108) = 1718
TPG(1980, 109) = 1017
TPG(1980, 110) = 555
TPG(1980, 111) = 275
TPG(1980, 112) = 121
TPG(1980, 113) = 45
TPG(1980, 114) = 14
TPG(1980, 115) = 3
TPG(1980, 116) = 0
TPG(1980, 117) = 0
TPG(1927, 0) = 100000
TPG(1927, 1) = 92817
TPG(1927, 2) = 90352
TPG(1927, 3) = 89827
TPG(1927, 4) = 89502
TPG(1927, 5) = 89298
TPG(1927, 6) = 89233
TPG(1927, 7) = 89174
TPG(1927, 8) = 89120
TPG(1927, 9) = 89072
TPG(1927, 10) = 89028
TPG(1927, 11) = 88998
TPG(1927, 12) = 88966
TPG(1927, 13) = 88933
TPG(1927, 14) = 88897
TPG(1927, 15) = 88860
TPG(1927, 16) = 88820
TPG(1927, 17) = 88776
TPG(1927, 18) = 88730
TPG(1927, 19) = 88681
TPG(1927, 20) = 88629
TPG(1927, 21) = 88571
TPG(1927, 22) = 88511
TPG(1927, 23) = 88448
TPG(1927, 24) = 88381
TPG(1927, 25) = 88311
TPG(1927, 26) = 88238
TPG(1927, 27) = 88162
TPG(1927, 28) = 88083
TPG(1927, 29) = 88000
TPG(1927, 30) = 87913
TPG(1927, 31) = 87823
TPG(1927, 32) = 87728
TPG(1927, 33) = 87629
TPG(1927, 34) = 87525
TPG(1927, 35) = 87416
TPG(1927, 36) = 87302
TPG(1927, 37) = 87181
TPG(1927, 38) = 87055
TPG(1927, 39) = 86921
TPG(1927, 40) = 86778
TPG(1927, 41) = 86626
TPG(1927, 42) = 86464
TPG(1927, 43) = 86293
TPG(1927, 44) = 86109
TPG(1927, 45) = 85914
TPG(1927, 46) = 85705
TPG(1927, 47) = 85483
TPG(1927, 48) = 85246
TPG(1927, 49) = 84995
TPG(1927, 50) = 84729
TPG(1927, 51) = 84448
TPG(1927, 52) = 84150
TPG(1927, 53) = 83835
TPG(1927, 54) = 83502
TPG(1927, 55) = 83151
TPG(1927, 56) = 82780
TPG(1927, 57) = 82389
TPG(1927, 58) = 81978
TPG(1927, 59) = 81545
TPG(1927, 60) = 81090
TPG(1927, 61) = 80613
TPG(1927, 62) = 80113
TPG(1927, 63) = 79590
TPG(1927, 64) = 79037
TPG(1927, 65) = 78451
TPG(1927, 66) = 77832
TPG(1927, 67) = 77178
TPG(1927, 68) = 76489
TPG(1927, 69) = 75736
TPG(1927, 70) = 74916
TPG(1927, 71) = 74020
TPG(1927, 72) = 73042
TPG(1927, 73) = 71975
TPG(1927, 74) = 70790
TPG(1927, 75) = 69473
TPG(1927, 76) = 68013
TPG(1927, 77) = 66395
TPG(1927, 78) = 64607
TPG(1927, 79) = 62643
TPG(1927, 80) = 60492
TPG(1927, 81) = 58146
TPG(1927, 82) = 55595
TPG(1927, 83) = 52834
TPG(1927, 84) = 49907
TPG(1927, 85) = 46818
TPG(1927, 86) = 43580
TPG(1927, 87) = 40209
TPG(1927, 88) = 36729
TPG(1927, 89) = 33217
TPG(1927, 90) = 29706
TPG(1927, 91) = 26233
TPG(1927, 92) = 22838
TPG(1927, 93) = 19564
TPG(1927, 94) = 16493
TPG(1927, 95) = 13656
TPG(1927, 96) = 11082
TPG(1927, 97) = 8790
TPG(1927, 98) = 6796
TPG(1927, 99) = 5103
TPG(1927, 100) = 3707
TPG(1927, 101) = 2592
TPG(1927, 102) = 1736
TPG(1927, 103) = 1105
TPG(1927, 104) = 663
TPG(1927, 105) = 371
TPG(1927, 106) = 191
TPG(1927, 107) = 89
TPG(1927, 108) = 37
TPG(1927, 109) = 13
TPG(1927, 110) = 4
TPG(1927, 111) = 1
TPG(1927, 112) = 0
TPG(1927, 113) = 0
TPG(1927, 114) = 0
TPG(1927, 115) = 0
TPG(1927, 116) = 0
TPG(1927, 117) = 0
TPG(1928, 0) = 100000
TPG(1928, 1) = 93083
TPG(1928, 2) = 90704
TPG(1928, 3) = 90200
TPG(1928, 4) = 89886
TPG(1928, 5) = 89688
TPG(1928, 6) = 89624
TPG(1928, 7) = 89566
TPG(1928, 8) = 89514
TPG(1928, 9) = 89466
TPG(1928, 10) = 89423
TPG(1928, 11) = 89393
TPG(1928, 12) = 89362
TPG(1928, 13) = 89329
TPG(1928, 14) = 89294
TPG(1928, 15) = 89257
TPG(1928, 16) = 89217
TPG(1928, 17) = 89174
TPG(1928, 18) = 89128
TPG(1928, 19) = 89079
TPG(1928, 20) = 89027
TPG(1928, 21) = 88970
TPG(1928, 22) = 88910
TPG(1928, 23) = 88847
TPG(1928, 24) = 88781
TPG(1928, 25) = 88711
TPG(1928, 26) = 88639
TPG(1928, 27) = 88564
TPG(1928, 28) = 88486
TPG(1928, 29) = 88403
TPG(1928, 30) = 88318
TPG(1928, 31) = 88228
TPG(1928, 32) = 88134
TPG(1928, 33) = 88037
TPG(1928, 34) = 87934
TPG(1928, 35) = 87827
TPG(1928, 36) = 87714
TPG(1928, 37) = 87595
TPG(1928, 38) = 87470
TPG(1928, 39) = 87337
TPG(1928, 40) = 87196
TPG(1928, 41) = 87046
TPG(1928, 42) = 86887
TPG(1928, 43) = 86717
TPG(1928, 44) = 86536
TPG(1928, 45) = 86343
TPG(1928, 46) = 86137
TPG(1928, 47) = 85917
TPG(1928, 48) = 85683
TPG(1928, 49) = 85435
TPG(1928, 50) = 85173
TPG(1928, 51) = 84895
TPG(1928, 52) = 84601
TPG(1928, 53) = 84289
TPG(1928, 54) = 83960
TPG(1928, 55) = 83612
TPG(1928, 56) = 83246
TPG(1928, 57) = 82860
TPG(1928, 58) = 82454
TPG(1928, 59) = 82026
TPG(1928, 60) = 81577
TPG(1928, 61) = 81106
TPG(1928, 62) = 80614
TPG(1928, 63) = 80099
TPG(1928, 64) = 79554
TPG(1928, 65) = 78978
TPG(1928, 66) = 78369
TPG(1928, 67) = 77725
TPG(1928, 68) = 77046
TPG(1928, 69) = 76305
TPG(1928, 70) = 75495
TPG(1928, 71) = 74611
TPG(1928, 72) = 73645
TPG(1928, 73) = 72590
TPG(1928, 74) = 71417
TPG(1928, 75) = 70113
TPG(1928, 76) = 68665
TPG(1928, 77) = 67060
TPG(1928, 78) = 65283
TPG(1928, 79) = 63330
TPG(1928, 80) = 61190
TPG(1928, 81) = 58853
TPG(1928, 82) = 56309
TPG(1928, 83) = 53553
TPG(1928, 84) = 50627
TPG(1928, 85) = 47537
TPG(1928, 86) = 44293
TPG(1928, 87) = 40912
TPG(1928, 88) = 37415
TPG(1928, 89) = 33882
TPG(1928, 90) = 30344
TPG(1928, 91) = 26837
TPG(1928, 92) = 23404
TPG(1928, 93) = 20086
TPG(1928, 94) = 16967
TPG(1928, 95) = 14080
TPG(1928, 96) = 11453
TPG(1928, 97) = 9108
TPG(1928, 98) = 7062
TPG(1928, 99) = 5320
TPG(1928, 100) = 3878
TPG(1928, 101) = 2723
TPG(1928, 102) = 1831
TPG(1928, 103) = 1172
TPG(1928, 104) = 707
TPG(1928, 105) = 398
TPG(1928, 106) = 207
TPG(1928, 107) = 97
TPG(1928, 108) = 40
TPG(1928, 109) = 14
TPG(1928, 110) = 4
TPG(1928, 111) = 1
TPG(1928, 112) = 0
TPG(1928, 113) = 0
TPG(1928, 114) = 0
TPG(1928, 115) = 0
TPG(1928, 116) = 0
TPG(1928, 117) = 0
TPG(1955, 0) = 100000
TPG(1955, 1) = 97576
TPG(1955, 2) = 96708
TPG(1955, 3) = 96545
TPG(1955, 4) = 96429
TPG(1955, 5) = 96347
TPG(1955, 6) = 96310
TPG(1955, 7) = 96276
TPG(1955, 8) = 96244
TPG(1955, 9) = 96215
TPG(1955, 10) = 96187
TPG(1955, 11) = 96168
TPG(1955, 12) = 96147
TPG(1955, 13) = 96124
TPG(1955, 14) = 96098
TPG(1955, 15) = 96070
TPG(1955, 16) = 96038
TPG(1955, 17) = 96003
TPG(1955, 18) = 95964
TPG(1955, 19) = 95922
TPG(1955, 20) = 95879
TPG(1955, 21) = 95833
TPG(1955, 22) = 95784
TPG(1955, 23) = 95734
TPG(1955, 24) = 95681
TPG(1955, 25) = 95628
TPG(1955, 26) = 95574
TPG(1955, 27) = 95519
TPG(1955, 28) = 95463
TPG(1955, 29) = 95405
TPG(1955, 30) = 95345
TPG(1955, 31) = 95283
TPG(1955, 32) = 95220
TPG(1955, 33) = 95155
TPG(1955, 34) = 95086
TPG(1955, 35) = 95014
TPG(1955, 36) = 94937
TPG(1955, 37) = 94857
TPG(1955, 38) = 94772
TPG(1955, 39) = 94681
TPG(1955, 40) = 94585
TPG(1955, 41) = 94483
TPG(1955, 42) = 94375
TPG(1955, 43) = 94259
TPG(1955, 44) = 94136
TPG(1955, 45) = 94005
TPG(1955, 46) = 93865
TPG(1955, 47) = 93716
TPG(1955, 48) = 93558
TPG(1955, 49) = 93389
TPG(1955, 50) = 93209
TPG(1955, 51) = 93016
TPG(1955, 52) = 92811
TPG(1955, 53) = 92592
TPG(1955, 54) = 92362
TPG(1955, 55) = 92120
TPG(1955, 56) = 91867
TPG(1955, 57) = 91602
TPG(1955, 58) = 91324
TPG(1955, 59) = 91038
TPG(1955, 60) = 90742
TPG(1955, 61) = 90438
TPG(1955, 62) = 90126
TPG(1955, 63) = 89806
TPG(1955, 64) = 89468
TPG(1955, 65) = 89111
TPG(1955, 66) = 88735
TPG(1955, 67) = 88339
TPG(1955, 68) = 87921
TPG(1955, 69) = 87455
TPG(1955, 70) = 86936
TPG(1955, 71) = 86356
TPG(1955, 72) = 85708
TPG(1955, 73) = 84983
TPG(1955, 74) = 84160
TPG(1955, 75) = 83224
TPG(1955, 76) = 82161
TPG(1955, 77) = 80954
TPG(1955, 78) = 79584
TPG(1955, 79) = 78048
TPG(1955, 80) = 76329
TPG(1955, 81) = 74407
TPG(1955, 82) = 72265
TPG(1955, 83) = 69885
TPG(1955, 84) = 67291
TPG(1955, 85) = 64475
TPG(1955, 86) = 61429
TPG(1955, 87) = 58154
TPG(1955, 88) = 54649
TPG(1955, 89) = 50979
TPG(1955, 90) = 47160
TPG(1955, 91) = 43217
TPG(1955, 92) = 39183
TPG(1955, 93) = 35095
TPG(1955, 94) = 31062
TPG(1955, 95) = 27126
TPG(1955, 96) = 23337
TPG(1955, 97) = 19741
TPG(1955, 98) = 16383
TPG(1955, 99) = 13308
TPG(1955, 100) = 10548
TPG(1955, 101) = 8132
TPG(1955, 102) = 6073
TPG(1955, 103) = 4373
TPG(1955, 104) = 3020
TPG(1955, 105) = 1985
TPG(1955, 106) = 1233
TPG(1955, 107) = 715
TPG(1955, 108) = 383
TPG(1955, 109) = 186
TPG(1955, 110) = 80
TPG(1955, 111) = 29
TPG(1955, 112) = 9
TPG(1955, 113) = 2
TPG(1955, 114) = 0
TPG(1955, 115) = 0
TPG(1955, 116) = 0
TPG(1955, 117) = 0
TPG(1956, 0) = 100000
TPG(1956, 1) = 97670
TPG(1956, 2) = 96835
TPG(1956, 3) = 96679
TPG(1956, 4) = 96568
TPG(1956, 5) = 96488
TPG(1956, 6) = 96452
TPG(1956, 7) = 96419
TPG(1956, 8) = 96387
TPG(1956, 9) = 96358
TPG(1956, 10) = 96331
TPG(1956, 11) = 96313
TPG(1956, 12) = 96292
TPG(1956, 13) = 96269
TPG(1956, 14) = 96243
TPG(1956, 15) = 96215
TPG(1956, 16) = 96184
TPG(1956, 17) = 96150
TPG(1956, 18) = 96111
TPG(1956, 19) = 96069
TPG(1956, 20) = 96026
TPG(1956, 21) = 95980
TPG(1956, 22) = 95932
TPG(1956, 23) = 95882
TPG(1956, 24) = 95831
TPG(1956, 25) = 95778
TPG(1956, 26) = 95724
TPG(1956, 27) = 95670
TPG(1956, 28) = 95615
TPG(1956, 29) = 95557
TPG(1956, 30) = 95499
TPG(1956, 31) = 95438
TPG(1956, 32) = 95375
TPG(1956, 33) = 95311
TPG(1956, 34) = 95244
TPG(1956, 35) = 95172
TPG(1956, 36) = 95097
TPG(1956, 37) = 95018
TPG(1956, 38) = 94934
TPG(1956, 39) = 94845
TPG(1956, 40) = 94751
TPG(1956, 41) = 94650
TPG(1956, 42) = 94543
TPG(1956, 43) = 94429
TPG(1956, 44) = 94308
TPG(1956, 45) = 94179
TPG(1956, 46) = 94042
TPG(1956, 47) = 93895
TPG(1956, 48) = 93739
TPG(1956, 49) = 93573
TPG(1956, 50) = 93395
TPG(1956, 51) = 93206
TPG(1956, 52) = 93003
TPG(1956, 53) = 92787
TPG(1956, 54) = 92561
TPG(1956, 55) = 92323
TPG(1956, 56) = 92073
TPG(1956, 57) = 91812
TPG(1956, 58) = 91539
TPG(1956, 59) = 91257
TPG(1956, 60) = 90966
TPG(1956, 61) = 90668
TPG(1956, 62) = 90361
TPG(1956, 63) = 90047
TPG(1956, 64) = 89716
TPG(1956, 65) = 89366
TPG(1956, 66) = 88997
TPG(1956, 67) = 88608
TPG(1956, 68) = 88199
TPG(1956, 69) = 87742
TPG(1956, 70) = 87232
TPG(1956, 71) = 86662
TPG(1956, 72) = 86024
TPG(1956, 73) = 85311
TPG(1956, 74) = 84500
TPG(1956, 75) = 83578
TPG(1956, 76) = 82529
TPG(1956, 77) = 81337
TPG(1956, 78) = 79984
TPG(1956, 79) = 78465
TPG(1956, 80) = 76764
TPG(1956, 81) = 74861
TPG(1956, 82) = 72739
TPG(1956, 83) = 70378
TPG(1956, 84) = 67803
TPG(1956, 85) = 65005
TPG(1956, 86) = 61977
TPG(1956, 87) = 58716
TPG(1956, 88) = 55224
TPG(1956, 89) = 51562
TPG(1956, 90) = 47748
TPG(1956, 91) = 43804
TPG(1956, 92) = 39763
TPG(1956, 93) = 35663
TPG(1956, 94) = 31610
TPG(1956, 95) = 27650
TPG(1956, 96) = 23830
TPG(1956, 97) = 20197
TPG(1956, 98) = 16799
TPG(1956, 99) = 13678
TPG(1956, 100) = 10871
TPG(1956, 101) = 8406
TPG(1956, 102) = 6299
TPG(1956, 103) = 4553
TPG(1956, 104) = 3157
TPG(1956, 105) = 2086
TPG(1956, 106) = 1303
TPG(1956, 107) = 761
TPG(1956, 108) = 410
TPG(1956, 109) = 201
TPG(1956, 110) = 87
TPG(1956, 111) = 33
TPG(1956, 112) = 10
TPG(1956, 113) = 2
TPG(1956, 114) = 0
TPG(1956, 115) = 0
TPG(1956, 116) = 0
TPG(1956, 117) = 0
TPG(1974, 0) = 100000
TPG(1974, 1) = 98864
TPG(1974, 2) = 98451
TPG(1974, 3) = 98379
TPG(1974, 4) = 98324
TPG(1974, 5) = 98281
TPG(1974, 6) = 98257
TPG(1974, 7) = 98234
TPG(1974, 8) = 98212
TPG(1974, 9) = 98192
TPG(1974, 10) = 98172
TPG(1974, 11) = 98159
TPG(1974, 12) = 98144
TPG(1974, 13) = 98127
TPG(1974, 14) = 98107
TPG(1974, 15) = 98085
TPG(1974, 16) = 98059
TPG(1974, 17) = 98029
TPG(1974, 18) = 97995
TPG(1974, 19) = 97959
TPG(1974, 20) = 97921
TPG(1974, 21) = 97882
TPG(1974, 22) = 97842
TPG(1974, 23) = 97799
TPG(1974, 24) = 97757
TPG(1974, 25) = 97714
TPG(1974, 26) = 97671
TPG(1974, 27) = 97628
TPG(1974, 28) = 97585
TPG(1974, 29) = 97541
TPG(1974, 30) = 97496
TPG(1974, 31) = 97450
TPG(1974, 32) = 97404
TPG(1974, 33) = 97356
TPG(1974, 34) = 97306
TPG(1974, 35) = 97253
TPG(1974, 36) = 97196
TPG(1974, 37) = 97137
TPG(1974, 38) = 97074
TPG(1974, 39) = 97008
TPG(1974, 40) = 96937
TPG(1974, 41) = 96861
TPG(1974, 42) = 96781
TPG(1974, 43) = 96696
TPG(1974, 44) = 96605
TPG(1974, 45) = 96509
TPG(1974, 46) = 96406
TPG(1974, 47) = 96297
TPG(1974, 48) = 96180
TPG(1974, 49) = 96055
TPG(1974, 50) = 95922
TPG(1974, 51) = 95778
TPG(1974, 52) = 95625
TPG(1974, 53) = 95460
TPG(1974, 54) = 95287
TPG(1974, 55) = 95107
TPG(1974, 56) = 94919
TPG(1974, 57) = 94723
TPG(1974, 58) = 94518
TPG(1974, 59) = 94309
TPG(1974, 60) = 94098
TPG(1974, 61) = 93883
TPG(1974, 62) = 93665
TPG(1974, 63) = 93445
TPG(1974, 64) = 93214
TPG(1974, 65) = 92970
TPG(1974, 66) = 92713
TPG(1974, 67) = 92444
TPG(1974, 68) = 92161
TPG(1974, 69) = 91840
TPG(1974, 70) = 91478
TPG(1974, 71) = 91068
TPG(1974, 72) = 90603
TPG(1974, 73) = 90075
TPG(1974, 74) = 89467
TPG(1974, 75) = 88767
TPG(1974, 76) = 87960
TPG(1974, 77) = 87030
TPG(1974, 78) = 85958
TPG(1974, 79) = 84743
TPG(1974, 80) = 83364
TPG(1974, 81) = 81804
TPG(1974, 82) = 80041
TPG(1974, 83) = 78052
TPG(1974, 84) = 75853
TPG(1974, 85) = 73429
TPG(1974, 86) = 70764
TPG(1974, 87) = 67845
TPG(1974, 88) = 64665
TPG(1974, 89) = 61266
TPG(1974, 90) = 57655
TPG(1974, 91) = 53840
TPG(1974, 92) = 49840
TPG(1974, 93) = 45680
TPG(1974, 94) = 41464
TPG(1974, 95) = 37231
TPG(1974, 96) = 33027
TPG(1974, 97) = 28900
TPG(1974, 98) = 24901
TPG(1974, 99) = 21086
TPG(1974, 100) = 17507
TPG(1974, 101) = 14214
TPG(1974, 102) = 11250
TPG(1974, 103) = 8649
TPG(1974, 104) = 6432
TPG(1974, 105) = 4602
TPG(1974, 106) = 3149
TPG(1974, 107) = 2045
TPG(1974, 108) = 1249
TPG(1974, 109) = 709
TPG(1974, 110) = 368
TPG(1974, 111) = 172
TPG(1974, 112) = 70
TPG(1974, 113) = 24
TPG(1974, 114) = 6
TPG(1974, 115) = 1
TPG(1974, 116) = 0
TPG(1974, 117) = 0
TPG(1988, 0) = 100000
TPG(1988, 1) = 99353
TPG(1988, 2) = 99116
TPG(1988, 3) = 99077
TPG(1988, 4) = 99045
TPG(1988, 5) = 99019
TPG(1988, 6) = 99001
TPG(1988, 7) = 98984
TPG(1988, 8) = 98968
TPG(1988, 9) = 98953
TPG(1988, 10) = 98938
TPG(1988, 11) = 98927
TPG(1988, 12) = 98915
TPG(1988, 13) = 98901
TPG(1988, 14) = 98885
TPG(1988, 15) = 98866
TPG(1988, 16) = 98844
TPG(1988, 17) = 98818
TPG(1988, 18) = 98787
TPG(1988, 19) = 98755
TPG(1988, 20) = 98722
TPG(1988, 21) = 98688
TPG(1988, 22) = 98652
TPG(1988, 23) = 98616
TPG(1988, 24) = 98579
TPG(1988, 25) = 98543
TPG(1988, 26) = 98507
TPG(1988, 27) = 98471
TPG(1988, 28) = 98436
TPG(1988, 29) = 98401
TPG(1988, 30) = 98365
TPG(1988, 31) = 98328
TPG(1988, 32) = 98291
TPG(1988, 33) = 98254
TPG(1988, 34) = 98214
TPG(1988, 35) = 98172
TPG(1988, 36) = 98128
TPG(1988, 37) = 98081
TPG(1988, 38) = 98031
TPG(1988, 39) = 97978
TPG(1988, 40) = 97922
TPG(1988, 41) = 97862
TPG(1988, 42) = 97798
TPG(1988, 43) = 97731
TPG(1988, 44) = 97659
TPG(1988, 45) = 97582
TPG(1988, 46) = 97501
TPG(1988, 47) = 97415
TPG(1988, 48) = 97323
TPG(1988, 49) = 97224
TPG(1988, 50) = 97117
TPG(1988, 51) = 97003
TPG(1988, 52) = 96880
TPG(1988, 53) = 96747
TPG(1988, 54) = 96609
TPG(1988, 55) = 96465
TPG(1988, 56) = 96315
TPG(1988, 57) = 96160
TPG(1988, 58) = 95998
TPG(1988, 59) = 95835
TPG(1988, 60) = 95671
TPG(1988, 61) = 95506
TPG(1988, 62) = 95341
TPG(1988, 63) = 95176
TPG(1988, 64) = 95003
TPG(1988, 65) = 94820
TPG(1988, 66) = 94629
TPG(1988, 67) = 94429
TPG(1988, 68) = 94219
TPG(1988, 69) = 93979
TPG(1988, 70) = 93705
TPG(1988, 71) = 93391
TPG(1988, 72) = 93032
TPG(1988, 73) = 92621
TPG(1988, 74) = 92143
TPG(1988, 75) = 91586
TPG(1988, 76) = 90938
TPG(1988, 77) = 90184
TPG(1988, 78) = 89307
TPG(1988, 79) = 88303
TPG(1988, 80) = 87156
TPG(1988, 81) = 85846
TPG(1988, 82) = 84353
TPG(1988, 83) = 82653
TPG(1988, 84) = 80755
TPG(1988, 85) = 78642
TPG(1988, 86) = 76296
TPG(1988, 87) = 73697
TPG(1988, 88) = 70832
TPG(1988, 89) = 67731
TPG(1988, 90) = 64393
TPG(1988, 91) = 60817
TPG(1988, 92) = 57009
TPG(1988, 93) = 52983
TPG(1988, 94) = 48837
TPG(1988, 95) = 44602
TPG(1988, 96) = 40313
TPG(1988, 97) = 36014
TPG(1988, 98) = 31754
TPG(1988, 99) = 27586
TPG(1988, 100) = 23566
TPG(1988, 101) = 19754
TPG(1988, 102) = 16205
TPG(1988, 103) = 12971
TPG(1988, 104) = 10094
TPG(1988, 105) = 7606
TPG(1988, 106) = 5522
TPG(1988, 107) = 3839
TPG(1988, 108) = 2537
TPG(1988, 109) = 1580
TPG(1988, 110) = 917
TPG(1988, 111) = 489
TPG(1988, 112) = 235
TPG(1988, 113) = 99
TPG(1988, 114) = 35
TPG(1988, 115) = 10
TPG(1988, 116) = 2
TPG(1988, 117) = 0
TPG(1941, 0) = 100000
TPG(1941, 1) = 95800
TPG(1941, 2) = 94321
TPG(1941, 3) = 94025
TPG(1941, 4) = 93829
TPG(1941, 5) = 93698
TPG(1941, 6) = 93649
TPG(1941, 7) = 93604
TPG(1941, 8) = 93562
TPG(1941, 9) = 93524
TPG(1941, 10) = 93489
TPG(1941, 11) = 93464
TPG(1941, 12) = 93439
TPG(1941, 13) = 93410
TPG(1941, 14) = 93380
TPG(1941, 15) = 93347
TPG(1941, 16) = 93311
TPG(1941, 17) = 93272
TPG(1941, 18) = 93230
TPG(1941, 19) = 93184
TPG(1941, 20) = 93136
TPG(1941, 21) = 93084
TPG(1941, 22) = 93030
TPG(1941, 23) = 92973
TPG(1941, 24) = 92913
TPG(1941, 25) = 92852
TPG(1941, 26) = 92788
TPG(1941, 27) = 92723
TPG(1941, 28) = 92655
TPG(1941, 29) = 92585
TPG(1941, 30) = 92513
TPG(1941, 31) = 92437
TPG(1941, 32) = 92359
TPG(1941, 33) = 92277
TPG(1941, 34) = 92192
TPG(1941, 35) = 92102
TPG(1941, 36) = 92008
TPG(1941, 37) = 91908
TPG(1941, 38) = 91804
TPG(1941, 39) = 91692
TPG(1941, 40) = 91574
TPG(1941, 41) = 91448
TPG(1941, 42) = 91314
TPG(1941, 43) = 91172
TPG(1941, 44) = 91020
TPG(1941, 45) = 90858
TPG(1941, 46) = 90685
TPG(1941, 47) = 90501
TPG(1941, 48) = 90305
TPG(1941, 49) = 90097
TPG(1941, 50) = 89876
TPG(1941, 51) = 89641
TPG(1941, 52) = 89391
TPG(1941, 53) = 89125
TPG(1941, 54) = 88845
TPG(1941, 55) = 88550
TPG(1941, 56) = 88240
TPG(1941, 57) = 87914
TPG(1941, 58) = 87572
TPG(1941, 59) = 87216
TPG(1941, 60) = 86844
TPG(1941, 61) = 86459
TPG(1941, 62) = 86058
TPG(1941, 63) = 85644
TPG(1941, 64) = 85206
TPG(1941, 65) = 84743
TPG(1941, 66) = 84254
TPG(1941, 67) = 83737
TPG(1941, 68) = 83193
TPG(1941, 69) = 82592
TPG(1941, 70) = 81929
TPG(1941, 71) = 81197
TPG(1941, 72) = 80388
TPG(1941, 73) = 79495
TPG(1941, 74) = 78490
TPG(1941, 75) = 77361
TPG(1941, 76) = 76093
TPG(1941, 77) = 74669
TPG(1941, 78) = 73074
TPG(1941, 79) = 71303
TPG(1941, 80) = 69341
TPG(1941, 81) = 67172
TPG(1941, 82) = 64783
TPG(1941, 83) = 62161
TPG(1941, 84) = 59339
TPG(1941, 85) = 56316
TPG(1941, 86) = 53094
TPG(1941, 87) = 49680
TPG(1941, 88) = 46087
TPG(1941, 89) = 42388
TPG(1941, 90) = 38611
TPG(1941, 91) = 34788
TPG(1941, 92) = 30958
TPG(1941, 93) = 27165
TPG(1941, 94) = 23510
TPG(1941, 95) = 20032
TPG(1941, 96) = 16774
TPG(1941, 97) = 13772
TPG(1941, 98) = 11060
TPG(1941, 99) = 8662
TPG(1941, 100) = 6593
TPG(1941, 101) = 4858
TPG(1941, 102) = 3448
TPG(1941, 103) = 2345
TPG(1941, 104) = 1517
TPG(1941, 105) = 926
TPG(1941, 106) = 527
TPG(1941, 107) = 277
TPG(1941, 108) = 131
TPG(1941, 109) = 55
TPG(1941, 110) = 20
TPG(1941, 111) = 6
TPG(1941, 112) = 1
TPG(1941, 113) = 0
TPG(1941, 114) = 0
TPG(1941, 115) = 0
TPG(1941, 116) = 0
TPG(1941, 117) = 0
TPG(1942, 0) = 100000
TPG(1942, 1) = 95960
TPG(1942, 2) = 94536
TPG(1942, 3) = 94252
TPG(1942, 4) = 94063
TPG(1942, 5) = 93937
TPG(1942, 6) = 93888
TPG(1942, 7) = 93844
TPG(1942, 8) = 93803
TPG(1942, 9) = 93765
TPG(1942, 10) = 93731
TPG(1942, 11) = 93707
TPG(1942, 12) = 93681
TPG(1942, 13) = 93654
TPG(1942, 14) = 93624
TPG(1942, 15) = 93591
TPG(1942, 16) = 93556
TPG(1942, 17) = 93517
TPG(1942, 18) = 93474
TPG(1942, 19) = 93429
TPG(1942, 20) = 93381
TPG(1942, 21) = 93330
TPG(1942, 22) = 93276
TPG(1942, 23) = 93219
TPG(1942, 24) = 93160
TPG(1942, 25) = 93100
TPG(1942, 26) = 93037
TPG(1942, 27) = 92972
TPG(1942, 28) = 92905
TPG(1942, 29) = 92836
TPG(1942, 30) = 92764
TPG(1942, 31) = 92690
TPG(1942, 32) = 92613
TPG(1942, 33) = 92533
TPG(1942, 34) = 92449
TPG(1942, 35) = 92360
TPG(1942, 36) = 92267
TPG(1942, 37) = 92169
TPG(1942, 38) = 92066
TPG(1942, 39) = 91956
TPG(1942, 40) = 91839
TPG(1942, 41) = 91715
TPG(1942, 42) = 91583
TPG(1942, 43) = 91443
TPG(1942, 44) = 91293
TPG(1942, 45) = 91134
TPG(1942, 46) = 90964
TPG(1942, 47) = 90782
TPG(1942, 48) = 90589
TPG(1942, 49) = 90384
TPG(1942, 50) = 90166
TPG(1942, 51) = 89934
TPG(1942, 52) = 89687
TPG(1942, 53) = 89424
TPG(1942, 54) = 89148
TPG(1942, 55) = 88857
TPG(1942, 56) = 88552
TPG(1942, 57) = 88231
TPG(1942, 58) = 87893
TPG(1942, 59) = 87542
TPG(1942, 60) = 87176
TPG(1942, 61) = 86797
TPG(1942, 62) = 86404
TPG(1942, 63) = 85997
TPG(1942, 64) = 85566
TPG(1942, 65) = 85111
TPG(1942, 66) = 84631
TPG(1942, 67) = 84124
TPG(1942, 68) = 83589
TPG(1942, 69) = 82999
TPG(1942, 70) = 82347
TPG(1942, 71) = 81626
TPG(1942, 72) = 80829
TPG(1942, 73) = 79948
TPG(1942, 74) = 78956
TPG(1942, 75) = 77841
TPG(1942, 76) = 76588
TPG(1942, 77) = 75180
TPG(1942, 78) = 73600
TPG(1942, 79) = 71845
TPG(1942, 80) = 69899
TPG(1942, 81) = 67746
TPG(1942, 82) = 65373
TPG(1942, 83) = 62765
TPG(1942, 84) = 59956
TPG(1942, 85) = 56944
TPG(1942, 86) = 53730
TPG(1942, 87) = 50321
TPG(1942, 88) = 46729
TPG(1942, 89) = 43026
TPG(1942, 90) = 39238
TPG(1942, 91) = 35399
TPG(1942, 92) = 31547
TPG(1942, 93) = 27726
TPG(1942, 94) = 24036
TPG(1942, 95) = 20519
TPG(1942, 96) = 17217
TPG(1942, 97) = 14169
TPG(1942, 98) = 11407
TPG(1942, 99) = 8958
TPG(1942, 100) = 6840
TPG(1942, 101) = 5057
TPG(1942, 102) = 3604
TPG(1942, 103) = 2461
TPG(1942, 104) = 1600
TPG(1942, 105) = 982
TPG(1942, 106) = 563
TPG(1942, 107) = 298
TPG(1942, 108) = 143
TPG(1942, 109) = 60
TPG(1942, 110) = 22
TPG(1942, 111) = 6
TPG(1942, 112) = 1
TPG(1942, 113) = 0
TPG(1942, 114) = 0
TPG(1942, 115) = 0
TPG(1942, 116) = 0
TPG(1942, 117) = 0
TPG(1967, 0) = 100000
TPG(1967, 1) = 98497
TPG(1967, 2) = 97953
TPG(1967, 3) = 97855
TPG(1967, 4) = 97782
TPG(1967, 5) = 97727
TPG(1967, 6) = 97699
TPG(1967, 7) = 97673
TPG(1967, 8) = 97648
TPG(1967, 9) = 97625
TPG(1967, 10) = 97602
TPG(1967, 11) = 97587
TPG(1967, 12) = 97570
TPG(1967, 13) = 97551
TPG(1967, 14) = 97529
TPG(1967, 15) = 97504
TPG(1967, 16) = 97477
TPG(1967, 17) = 97445
TPG(1967, 18) = 97409
TPG(1967, 19) = 97371
TPG(1967, 20) = 97331
TPG(1967, 21) = 97290
TPG(1967, 22) = 97246
TPG(1967, 23) = 97201
TPG(1967, 24) = 97155
TPG(1967, 25) = 97109
TPG(1967, 26) = 97062
TPG(1967, 27) = 97014
TPG(1967, 28) = 96967
TPG(1967, 29) = 96918
TPG(1967, 30) = 96868
TPG(1967, 31) = 96817
TPG(1967, 32) = 96765
TPG(1967, 33) = 96711
TPG(1967, 34) = 96655
TPG(1967, 35) = 96595
TPG(1967, 36) = 96532
TPG(1967, 37) = 96465
TPG(1967, 38) = 96395
TPG(1967, 39) = 96320
TPG(1967, 40) = 96241
TPG(1967, 41) = 96156
TPG(1967, 42) = 96067
TPG(1967, 43) = 95971
TPG(1967, 44) = 95869
TPG(1967, 45) = 95761
TPG(1967, 46) = 95646
TPG(1967, 47) = 95523
TPG(1967, 48) = 95392
TPG(1967, 49) = 95252
TPG(1967, 50) = 95103
TPG(1967, 51) = 94943
TPG(1967, 52) = 94771
TPG(1967, 53) = 94588
TPG(1967, 54) = 94396
TPG(1967, 55) = 94195
TPG(1967, 56) = 93984
TPG(1967, 57) = 93765
TPG(1967, 58) = 93535
TPG(1967, 59) = 93300
TPG(1967, 60) = 93060
TPG(1967, 61) = 92815
TPG(1967, 62) = 92566
TPG(1967, 63) = 92313
TPG(1967, 64) = 92046
TPG(1967, 65) = 91765
TPG(1967, 66) = 91469
TPG(1967, 67) = 91157
TPG(1967, 68) = 90830
TPG(1967, 69) = 90461
TPG(1967, 70) = 90046
TPG(1967, 71) = 89578
TPG(1967, 72) = 89051
TPG(1967, 73) = 88456
TPG(1967, 74) = 87774
TPG(1967, 75) = 86992
TPG(1967, 76) = 86095
TPG(1967, 77) = 85068
TPG(1967, 78) = 83890
TPG(1967, 79) = 82559
TPG(1967, 80) = 81057
TPG(1967, 81) = 79365
TPG(1967, 82) = 77461
TPG(1967, 83) = 75325
TPG(1967, 84) = 72976
TPG(1967, 85) = 70399
TPG(1967, 86) = 67582
TPG(1967, 87) = 64517
TPG(1967, 88) = 61198
TPG(1967, 89) = 57676
TPG(1967, 90) = 53961
TPG(1967, 91) = 50067
TPG(1967, 92) = 46019
TPG(1967, 93) = 41846
TPG(1967, 94) = 37656
TPG(1967, 95) = 33491
TPG(1967, 96) = 29397
TPG(1967, 97) = 25425
TPG(1967, 98) = 21626
TPG(1967, 99) = 18052
TPG(1967, 100) = 14750
TPG(1967, 101) = 11764
TPG(1967, 102) = 9126
TPG(1967, 103) = 6860
TPG(1967, 104) = 4972
TPG(1967, 105) = 3455
TPG(1967, 106) = 2287
TPG(1967, 107) = 1429
TPG(1967, 108) = 834
TPG(1967, 109) = 449
TPG(1967, 110) = 219
TPG(1967, 111) = 94
TPG(1967, 112) = 35
TPG(1967, 113) = 10
TPG(1967, 114) = 2
TPG(1967, 115) = 0
TPG(1967, 116) = 0
TPG(1967, 117) = 0
TPG(1981, 0) = 100000
TPG(1981, 1) = 99143
TPG(1981, 2) = 98830
TPG(1981, 3) = 98777
TPG(1981, 4) = 98734
TPG(1981, 5) = 98700
TPG(1981, 6) = 98680
TPG(1981, 7) = 98661
TPG(1981, 8) = 98642
TPG(1981, 9) = 98624
TPG(1981, 10) = 98607
TPG(1981, 11) = 98595
TPG(1981, 12) = 98581
TPG(1981, 13) = 98566
TPG(1981, 14) = 98548
TPG(1981, 15) = 98527
TPG(1981, 16) = 98503
TPG(1981, 17) = 98476
TPG(1981, 18) = 98443
TPG(1981, 19) = 98409
TPG(1981, 20) = 98374
TPG(1981, 21) = 98337
TPG(1981, 22) = 98299
TPG(1981, 23) = 98260
TPG(1981, 24) = 98221
TPG(1981, 25) = 98181
TPG(1981, 26) = 98142
TPG(1981, 27) = 98103
TPG(1981, 28) = 98064
TPG(1981, 29) = 98024
TPG(1981, 30) = 97984
TPG(1981, 31) = 97943
TPG(1981, 32) = 97901
TPG(1981, 33) = 97859
TPG(1981, 34) = 97814
TPG(1981, 35) = 97767
TPG(1981, 36) = 97717
TPG(1981, 37) = 97664
TPG(1981, 38) = 97609
TPG(1981, 39) = 97549
TPG(1981, 40) = 97486
TPG(1981, 41) = 97419
TPG(1981, 42) = 97347
TPG(1981, 43) = 97271
TPG(1981, 44) = 97191
TPG(1981, 45) = 97105
TPG(1981, 46) = 97013
TPG(1981, 47) = 96916
TPG(1981, 48) = 96812
TPG(1981, 49) = 96701
TPG(1981, 50) = 96582
TPG(1981, 51) = 96454
TPG(1981, 52) = 96316
TPG(1981, 53) = 96168
TPG(1981, 54) = 96013
TPG(1981, 55) = 95852
TPG(1981, 56) = 95684
TPG(1981, 57) = 95509
TPG(1981, 58) = 95327
TPG(1981, 59) = 95143
TPG(1981, 60) = 94956
TPG(1981, 61) = 94768
TPG(1981, 62) = 94578
TPG(1981, 63) = 94388
TPG(1981, 64) = 94187
TPG(1981, 65) = 93976
TPG(1981, 66) = 93754
TPG(1981, 67) = 93522
TPG(1981, 68) = 93278
TPG(1981, 69) = 93000
TPG(1981, 70) = 92685
TPG(1981, 71) = 92326
TPG(1981, 72) = 91916
TPG(1981, 73) = 91450
TPG(1981, 74) = 90910
TPG(1981, 75) = 90285
TPG(1981, 76) = 89561
TPG(1981, 77) = 88722
TPG(1981, 78) = 87751
TPG(1981, 79) = 86645
TPG(1981, 80) = 85385
TPG(1981, 81) = 83953
TPG(1981, 82) = 82327
TPG(1981, 83) = 80485
TPG(1981, 84) = 78438
TPG(1981, 85) = 76169
TPG(1981, 86) = 73662
TPG(1981, 87) = 70901
TPG(1981, 88) = 67873
TPG(1981, 89) = 64617
TPG(1981, 90) = 61133
TPG(1981, 91) = 57427
TPG(1981, 92) = 53509
TPG(1981, 93) = 49399
TPG(1981, 94) = 45200
TPG(1981, 95) = 40946
TPG(1981, 96) = 36677
TPG(1981, 97) = 32441
TPG(1981, 98) = 28289
TPG(1981, 99) = 24275
TPG(1981, 100) = 20456
TPG(1981, 101) = 16886
TPG(1981, 102) = 13616
TPG(1981, 103) = 10689
TPG(1981, 104) = 8139
TPG(1981, 105) = 5982
TPG(1981, 106) = 4221
TPG(1981, 107) = 2840
TPG(1981, 108) = 1808
TPG(1981, 109) = 1077
TPG(1981, 110) = 593
TPG(1981, 111) = 297
TPG(1981, 112) = 132
TPG(1981, 113) = 50
TPG(1981, 114) = 16
TPG(1981, 115) = 4
TPG(1981, 116) = 1
TPG(1981, 117) = 0
End Function

Function IniTables()
PF4649(0) = 1000000
PF4649(1) = 947079.9999815
PF4649(2) = 941947.00002381
PF4649(3) = 940572.000035223
PF4649(4) = 939988.99999661
PF4649(5) = 939584.999967169
PF4649(6) = 939247.000012302
PF4649(7) = 938965.00004381
PF4649(8) = 938721.000037923
PF4649(9) = 938504.999942536
PF4649(10) = 938308.000046207
PF4649(11) = 938119.999953373
PF4649(12) = 937931.999997825
PF4649(13) = 937735.000014578
PF4649(14) = 937510.000074353
PF4649(15) = 937256.99999313
PF4649(16) = 936957.0000535
PF4649(17) = 936601.000033102
PF4649(18) = 936188.999976681
PF4649(19) = 935702.000042115
PF4649(20) = 935065.999918422
PF4649(21) = 934270.999892977
PF4649(22) = 933326.999923737
PF4649(23) = 932366.000121625
PF4649(24) = 931378.00009212
PF4649(25) = 930372.000022721
PF4649(26) = 929339.000073417
PF4649(27) = 928280.000018348
PF4649(28) = 927184.999997057
PF4649(29) = 926053.999940732
PF4649(30) = 924886.999841852
PF4649(31) = 923675.000174416
PF4649(32) = 922410.000114093
PF4649(33) = 921090.999964184
PF4649(34) = 919709.000004343
PF4649(35) = 918265.000215052
PF4649(36) = 916741.0000652
PF4649(37) = 915137.000141487
PF4649(38) = 913435.000089156
PF4649(39) = 911635.999749392
PF4649(40) = 909721.999938109
PF4649(41) = 907675.000220935
PF4649(42) = 905487.999939746
PF4649(43) = 903143.000134696
PF4649(44) = 900631.99990678
PF4649(45) = 897921.000124373
PF4649(46) = 895003.000354955
PF4649(47) = 891852.999942801
PF4649(48) = 888437.000127154
PF4649(49) = 884732.000130391
PF4649(50) = 880706.00015672
PF4649(51) = 876328.999780959
PF4649(52) = 871571.000386498
PF4649(53) = 866385.000211933
PF4649(54) = 860735.999595637
PF4649(55) = 854573.000120148
PF4649(56) = 847848.000568471
PF4649(57) = 840505.999538696
PF4649(58) = 832487.999385076
PF4649(59) = 823738.99959977
PF4649(60) = 814191.999577605
PF4649(61) = 803769.99960288
PF4649(62) = 792397.00048523
PF4649(63) = 780011.999730801
PF4649(64) = 766533.000323328
PF4649(65) = 751885.000529052
PF4649(66) = 735983.000882699
PF4649(67) = 718754.000112461
PF4649(68) = 700124.000409235
PF4649(69) = 680030.000870031
PF4649(70) = 658412.000447258
PF4649(71) = 635274.998999057
PF4649(72) = 610492.999314365
PF4649(73) = 584114.000790225
PF4649(74) = 556151.999942594
PF4649(75) = 526665.000131562
PF4649(76) = 495738.99990134
PF4649(77) = 463506.000688414
PF4649(78) = 430147.000329907
PF4649(79) = 395880.999234599
PF4649(80) = 360992.000840036
PF4649(81) = 325809.999911705
PF4649(82) = 290709.99948644
PF4649(83) = 256109.998381353
PF4649(84) = 222456.999735194
PF4649(85) = 190203.000982183
PF4649(86) = 159801.001767516
PF4649(87) = 131665.00165193
PF4649(88) = 106155.997953675
PF4649(89) = 83547.9989372482
PF4649(90) = 64013.0006086926
PF4649(91) = 47600.9975922933
PF4649(92) = 34239.9972437835
PF4649(93) = 23736.0000348723
PF4649(94) = 15790.9973544174
PF4649(95) = 10035.0028589313
PF4649(96) = 6060.99844396694
PF4649(97) = 3460.00065143909
PF4649(98) = 1854.99801035161
PF4649(99) = 927.001715117407
PF4649(100) = 429.000586664124
PF4649(101) = 181.995998867735
PF4649(102) = 70.0032782930508
PF4649(103) = 24.0027404549143
PF4649(104) = 7.99771684381956
PF4649(105) = 2.00298050858019
PF4649(106) = 0
PF4649(107) = 0
PF4649(108) = 0
PF4649(109) = 0
PF4649(110) = 0
PF4649(111) = 0
PF4649(112) = 0
PF4649(113) = 0
PF4649(114) = 0
PF4649(115) = 0
PF4649(116) = 0
PF4649(117) = 0

PM4649(0) = 1000000
PM4649(1) = 931380.00003
PM4649(2) = 924674.000052915
PM4649(3) = 922001.99998744
PM4649(4) = 920268.999951876
PM4649(5) = 918851.99998303
PM4649(6) = 917638.999948467
PM4649(7) = 916575.000014286
PM4649(8) = 915630.999960704
PM4649(9) = 914788.99997497
PM4649(10) = 914010.999946845
PM4649(11) = 913261.999982771
PM4649(12) = 912503.999966721
PM4649(13) = 911700.999943339
PM4649(14) = 910817.000041392
PM4649(15) = 909815.000026593
PM4649(16) = 908669.000013934
PM4649(17) = 907351.000047122
PM4649(18) = 905863.00008086
PM4649(19) = 904195.999952007
PM4649(20) = 902360.000048228
PM4649(21) = 900384.000049495
PM4649(22) = 898295.000095868
PM4649(23) = 896165.999992233
PM4649(24) = 893996.999930984
PM4649(25) = 891771.000074945
PM4649(26) = 889487.999956791
PM4649(27) = 887139.999888354
PM4649(28) = 884726.999955939
PM4649(29) = 882241.000022041
PM4649(30) = 879674.000089341
PM4649(31) = 877008.999921649
PM4649(32) = 874246.000028123
PM4649(33) = 871377.999946293
PM4649(34) = 868389.000126908
PM4649(35) = 865262.999836957
PM4649(36) = 862000.99992106
PM4649(37) = 858579.000102646
PM4649(38) = 854981.999993594
PM4649(39) = 851202.999857698
PM4649(40) = 847218.999875877
PM4649(41) = 843008.00016319
PM4649(42) = 838557.000146478
PM4649(43) = 833844.000024358
PM4649(44) = 828840.99991413
PM4649(45) = 823527.999785017
PM4649(46) = 817869.999771156
PM4649(47) = 811841.999753641
PM4649(48) = 805411.99991275
PM4649(49) = 798550.000228941
PM4649(50) = 791283.000241034
PM4649(51) = 783449.000057035
PM4649(52) = 775074.000057198
PM4649(53) = 766113.999981739
PM4649(54) = 756521.999936518
PM4649(55) = 746255.999820503
PM4649(56) = 735271.00003687
PM4649(57) = 723521.000226658
PM4649(58) = 710960.999674347
PM4649(59) = 697537.999951687
PM4649(60) = 683210.999670644
PM4649(61) = 667933.999986895
PM4649(62) = 651662.9999552
PM4649(63) = 634361.000325697
PM4649(64) = 615995.999752579
PM4649(65) = 596548.999963498
PM4649(66) = 575978.999735095
PM4649(67) = 554321.99989857
PM4649(68) = 531573.000321618
PM4649(69) = 507753.000278643
PM4649(70) = 482904.000001816
PM4649(71) = 457097.999862751
PM4649(72) = 430416.999999495
PM4649(73) = 402982.000341587
PM4649(74) = 374925.999860434
PM4649(75) = 346424.000300352
PM4649(76) = 317670.999987006
PM4649(77) = 288887.000423429
PM4649(78) = 260321.999771621
PM4649(79) = 232236.000155486
PM4649(80) = 204906.000495795
PM4649(81) = 178616.999235088
PM4649(82) = 153645.00045976
PM4649(83) = 138247.999642415
PM4649(84) = 108657.000724955
PM4649(85) = 89061.9998330759
PM4649(86) = 71601.9990516954
PM4649(87) = 56355.9995365868
PM4649(88) = 43334.0004740282
PM4649(89) = 32478.0008333306
PM4649(90) = 23667.0002305716
PM4649(91) = 16722.0005578612
PM4649(92) = 11421.0010132405
PM4649(93) = 7514.99881217186
PM4649(94) = 4747.00089058756
PM4649(95) = 2867.00063158841
PM4649(96) = 1647.99864590177
PM4649(97) = 896.999454163805
PM4649(98) = 460.001383890369
PM4649(99) = 221.000919963803
PM4649(100) = 99.0015289383892
PM4649(101) = 40.9995462233981
PM4649(102) = 14.9991028898995
PM4649(103) = 5.00062539007629
PM4649(104) = 2.00082076681154
PM4649(105) = 0
PM4649(106) = 0
PM4649(107) = 0
PM4649(108) = 0
PM4649(109) = 0
PM4649(110) = 0
PM4649(111) = 0
PM4649(112) = 0
PM4649(113) = 0
PM4649(114) = 0
PM4649(115) = 0
PM4649(116) = 0
PM4649(117) = 0

PF6064(0) = 1000000
PF6064(1) = 981510
PF6064(2) = 979520
PF6064(3) = 978611
PF6064(4) = 978001
PF6064(5) = 977521
PF6064(6) = 977121
PF6064(7) = 976781
PF6064(8) = 976481
PF6064(9) = 976210
PF6064(10) = 975961
PF6064(11) = 975720
PF6064(12) = 975480
PF6064(13) = 975231
PF6064(14) = 974961
PF6064(15) = 974651
PF6064(16) = 974291
PF6064(17) = 973881
PF6064(18) = 973410
PF6064(19) = 972890
PF6064(20) = 972320
PF6064(21) = 971720
PF6064(22) = 971101
PF6064(23) = 970451
PF6064(24) = 969770
PF6064(25) = 969052
PF6064(26) = 968295
PF6064(27) = 967496
PF6064(28) = 966653
PF6064(29) = 965761
PF6064(30) = 964820
PF6064(31) = 963825
PF6064(32) = 962786
PF6064(33) = 961698
PF6064(34) = 960555
PF6064(35) = 959350
PF6064(36) = 958079
PF6064(37) = 956733
PF6064(38) = 955303
PF6064(39) = 953783
PF6064(40) = 952159
PF6064(41) = 950424
PF6064(42) = 948563
PF6064(43) = 946564
PF6064(44) = 944412
PF6064(45) = 942091
PF6064(46) = 939582
PF6064(47) = 936867
PF6064(48) = 933923
PF6064(49) = 930727
PF6064(50) = 927253
PF6064(51) = 923472
PF6064(52) = 919352
PF6064(53) = 914859
PF6064(54) = 909956
PF6064(55) = 904603
PF6064(56) = 898756
PF6064(57) = 892367
PF6064(58) = 885384
PF6064(59) = 877752
PF6064(60) = 869412
PF6064(61) = 860302
PF6064(62) = 850353
PF6064(63) = 839497
PF6064(64) = 827659
PF6064(65) = 814763
PF6064(66) = 800732
PF6064(67) = 785487
PF6064(68) = 768949
PF6064(69) = 751043
PF6064(70) = 731696
PF6064(71) = 710843
PF6064(72) = 688429
PF6064(73) = 664411
PF6064(74) = 638764
PF6064(75) = 611483
PF6064(76) = 582592
PF6064(77) = 552143
PF6064(78) = 520228
PF6064(79) = 486977
PF6064(80) = 452570
PF6064(81) = 417231
PF6064(82) = 381239
PF6064(83) = 344921
PF6064(84) = 308653
PF6064(85) = 272848
PF6064(86) = 237951
PF6064(87) = 204418
PF6064(88) = 172701
PF6064(89) = 143223
PF6064(90) = 116354
PF6064(91) = 92389
PF6064(92) = 71519
PF6064(93) = 53824
PF6064(94) = 39258
PF6064(95) = 27654
PF6064(96) = 18743
PF6064(97) = 12170
PF6064(98) = 7534
PF6064(99) = 4424
PF6064(100) = 2450
PF6064(101) = 1271
PF6064(102) = 613
PF6064(103) = 273
PF6064(104) = 111
PF6064(105) = 41
PF6064(106) = 13
PF6064(107) = 0
PF6064(108) = 0
PF6064(109) = 0
PF6064(110) = 0
PF6064(111) = 0
PF6064(112) = 0
PF6064(113) = 0
PF6064(114) = 0
PF6064(115) = 0
PF6064(116) = 0
PF6064(117) = 0

PM6064(0) = 1000000
PM6064(1) = 975720
PM6064(2) = 973500
PM6064(3) = 972400
PM6064(4) = 971650
PM6064(5) = 971040
PM6064(6) = 970510
PM6064(7) = 970040
PM6064(8) = 969600
PM6064(9) = 969190
PM6064(10) = 968800
PM6064(11) = 968420
PM6064(12) = 968041
PM6064(13) = 967651
PM6064(14) = 967221
PM6064(15) = 966711
PM6064(16) = 966062
PM6064(17) = 965262
PM6064(18) = 964292
PM6064(19) = 963182
PM6064(20) = 961961
PM6064(21) = 960662
PM6064(22) = 959292
PM6064(23) = 957872
PM6064(24) = 956402
PM6064(25) = 954912
PM6064(26) = 953382
PM6064(27) = 951822
PM6064(28) = 950242
PM6064(29) = 948636
PM6064(30) = 946990
PM6064(31) = 945261
PM6064(32) = 943408
PM6064(33) = 941419
PM6064(34) = 939283
PM6064(35) = 936986
PM6064(36) = 934515
PM6064(37) = 931853
PM6064(38) = 928985
PM6064(39) = 925892
PM6064(40) = 922556
PM6064(41) = 918955
PM6064(42) = 915067
PM6064(43) = 910868
PM6064(44) = 906332
PM6064(45) = 901431
PM6064(46) = 896136
PM6064(47) = 890416
PM6064(48) = 884234
PM6064(49) = 877557
PM6064(50) = 870347
PM6064(51) = 862564
PM6064(52) = 854166
PM6064(53) = 845109
PM6064(54) = 835348
PM6064(55) = 824836
PM6064(56) = 813526
PM6064(57) = 801368
PM6064(58) = 788314
PM6064(59) = 774314
PM6064(60) = 759322
PM6064(61) = 743293
PM6064(62) = 726183
PM6064(63) = 707956
PM6064(64) = 688579
PM6064(65) = 668027
PM6064(66) = 646286
PM6064(67) = 623352
PM6064(68) = 599233
PM6064(69) = 573955
PM6064(70) = 547562
PM6064(71) = 520116
PM6064(72) = 491704
PM6064(73) = 462435
PM6064(74) = 432446
PM6064(75) = 401899
PM6064(76) = 370985
PM6064(77) = 339918
PM6064(78) = 308938
PM6064(79) = 278305
PM6064(80) = 248292
PM6064(81) = 219182
PM6064(82) = 191259
PM6064(83) = 164795
PM6064(84) = 140043
PM6064(85) = 117223
PM6064(86) = 96513
PM6064(87) = 78040
PM6064(88) = 61869
PM6064(89) = 48002
PM6064(90) = 36374
PM6064(91) = 26861
PM6064(92) = 19285
PM6064(93) = 13426
PM6064(94) = 9037
PM6064(95) = 5863
PM6064(96) = 3654
PM6064(97) = 2179
PM6064(98) = 1238
PM6064(99) = 668
PM6064(100) = 340
PM6064(101) = 163
PM6064(102) = 73
PM6064(103) = 30
PM6064(104) = 11
PM6064(105) = 4
PM6064(106) = 1
PM6064(107) = 0
PM6064(108) = 0
PM6064(109) = 0
PM6064(110) = 0
PM6064(111) = 0
PM6064(112) = 0
PM6064(113) = 0
PM6064(114) = 0
PM6064(115) = 0
PM6064(116) = 0
PM6064(117) = 0

TV7377(0) = 100000
TV7377(1) = 98832
TV7377(2) = 98736
TV7377(3) = 98677
TV7377(4) = 98631
TV7377(5) = 98593
TV7377(6) = 98559
TV7377(7) = 98528
TV7377(8) = 98499
TV7377(9) = 98472
TV7377(10) = 98447
TV7377(11) = 98424
TV7377(12) = 98401
TV7377(13) = 98379
TV7377(14) = 98354
TV7377(15) = 98324
TV7377(16) = 98286
TV7377(17) = 98239
TV7377(18) = 98182
TV7377(19) = 98119
TV7377(20) = 98055
TV7377(21) = 97993
TV7377(22) = 97932
TV7377(23) = 97873
TV7377(24) = 97815
TV7377(25) = 97755
TV7377(26) = 97696
TV7377(27) = 97636
TV7377(28) = 97575
TV7377(29) = 97509
TV7377(30) = 97439
TV7377(31) = 97367
TV7377(32) = 97290
TV7377(33) = 97208
TV7377(34) = 97120
TV7377(35) = 97025
TV7377(36) = 96922
TV7377(37) = 96812
TV7377(38) = 96691
TV7377(39) = 96561
TV7377(40) = 96419
TV7377(41) = 96263
TV7377(42) = 96094
TV7377(43) = 95910
TV7377(44) = 95707
TV7377(45) = 95485
TV7377(46) = 95245
TV7377(47) = 94983
TV7377(48) = 94698
TV7377(49) = 94388
TV7377(50) = 94056
TV7377(51) = 93702
TV7377(52) = 93322
TV7377(53) = 92910
TV7377(54) = 92465
TV7377(55) = 91987
TV7377(56) = 91478
TV7377(57) = 90938
TV7377(58) = 90364
TV7377(59) = 89754
TV7377(60) = 89106
TV7377(61) = 88417
TV7377(62) = 87674
TV7377(63) = 86862
TV7377(64) = 85977
TV7377(65) = 85015
TV7377(66) = 83966
TV7377(67) = 82818
TV7377(68) = 81561
TV7377(69) = 80181
TV7377(70) = 78659
TV7377(71) = 76982
TV7377(72) = 75139
TV7377(73) = 73120
TV7377(74) = 70914
TV7377(75) = 68502
TV7377(76) = 65860
TV7377(77) = 62981
TV7377(78) = 59867
TV7377(79) = 56524
TV7377(80) = 52974
TV7377(81) = 49246
TV7377(82) = 45363
TV7377(83) = 41351
TV7377(84) = 37256
TV7377(85) = 33160
TV7377(86) = 29136
TV7377(87) = 25229
TV7377(88) = 21491
TV7377(89) = 17979
TV7377(90) = 14743
TV7377(91) = 11852
TV7377(92) = 9362
TV7377(93) = 7280
TV7377(94) = 5571
TV7377(95) = 4190
TV7377(96) = 3092
TV7377(97) = 2238
TV7377(98) = 1585
TV7377(99) = 1098
TV7377(100) = 531
TV7377(101) = 237
TV7377(102) = 97
TV7377(103) = 36
TV7377(104) = 12
TV7377(105) = 4
TV7377(106) = 1
TV7377(107) = 0
TV7377(108) = 0
TV7377(109) = 0
TV7377(110) = 0
TV7377(111) = 0
TV7377(112) = 0
TV7377(113) = 0
TV7377(114) = 0
TV7377(115) = 0
TV7377(116) = 0
TV7377(117) = 0

TD7377(0) = 100000
TD7377(1) = 98471
TD7377(2) = 98360
TD7377(3) = 98281
TD7377(4) = 98220
TD7377(5) = 98167
TD7377(6) = 98120
TD7377(7) = 98076
TD7377(8) = 98035
TD7377(9) = 97997
TD7377(10) = 97961
TD7377(11) = 97927
TD7377(12) = 97892
TD7377(13) = 97855
TD7377(14) = 97814
TD7377(15) = 97761
TD7377(16) = 97691
TD7377(17) = 97594
TD7377(18) = 97460
TD7377(19) = 97290
TD7377(20) = 97105
TD7377(21) = 96921
TD7377(22) = 96745
TD7377(23) = 96576
TD7377(24) = 96419
TD7377(25) = 96270
TD7377(26) = 96127
TD7377(27) = 95988
TD7377(28) = 95849
TD7377(29) = 95707
TD7377(30) = 95559
TD7377(31) = 95406
TD7377(32) = 95251
TD7377(33) = 95092
TD7377(34) = 94921
TD7377(35) = 94734
TD7377(36) = 94533
TD7377(37) = 94316
TD7377(38) = 94076
TD7377(39) = 93810
TD7377(40) = 93516
TD7377(41) = 93192
TD7377(42) = 92836
TD7377(43) = 92440
TD7377(44) = 91996
TD7377(45) = 91503
TD7377(46) = 90966
TD7377(47) = 90391
TD7377(48) = 89772
TD7377(49) = 89103
TD7377(50) = 88380
TD7377(51) = 87605
TD7377(52) = 86778
TD7377(53) = 85893
TD7377(54) = 84938
TD7377(55) = 83909
TD7377(56) = 82812
TD7377(57) = 81654
TD7377(58) = 80435
TD7377(59) = 79146
TD7377(60) = 77772
TD7377(61) = 76296
TD7377(62) = 74706
TD7377(63) = 73007
TD7377(64) = 71208
TD7377(65) = 69302
TD7377(66) = 67276
TD7377(67) = 65127
TD7377(68) = 62855
TD7377(69) = 60473
TD7377(70) = 57981
TD7377(71) = 55369
TD7377(72) = 52642
TD7377(73) = 49815
TD7377(74) = 46887
TD7377(75) = 43872
TD7377(76) = 40798
TD7377(77) = 37688
TD7377(78) = 34560
TD7377(79) = 31441
TD7377(80) = 28364
TD7377(81) = 25351
TD7377(82) = 22424
TD7377(83) = 19602
TD7377(84) = 16916
TD7377(85) = 14398
TD7377(86) = 12063
TD7377(87) = 9938
TD7377(88) = 8054
TD7377(89) = 6407
TD7377(90) = 4986
TD7377(91) = 3790
TD7377(92) = 2819
TD7377(93) = 2059
TD7377(94) = 1481
TD7377(95) = 1048
TD7377(96) = 728
TD7377(97) = 497
TD7377(98) = 333
TD7377(99) = 218
TD7377(100) = 103
TD7377(101) = 46
TD7377(102) = 19
TD7377(103) = 7
TD7377(104) = 3
TD7377(105) = 1
TD7377(106) = 0
TD7377(107) = 0
TD7377(108) = 0
TD7377(109) = 0
TD7377(110) = 0
TD7377(111) = 0
TD7377(112) = 0
TD7377(113) = 0
TD7377(114) = 0
TD7377(115) = 0
TD7377(116) = 0
TD7377(117) = 0

TV8890(0) = 100000
TV8890(1) = 99352
TV8890(2) = 99294
TV8890(3) = 99261
TV8890(4) = 99236
TV8890(5) = 99214
TV8890(6) = 99194
TV8890(7) = 99177
TV8890(8) = 99161
TV8890(9) = 99145
TV8890(10) = 99129
TV8890(11) = 99112
TV8890(12) = 99096
TV8890(13) = 99081
TV8890(14) = 99062
TV8890(15) = 99041
TV8890(16) = 99018
TV8890(17) = 98989
TV8890(18) = 98955
TV8890(19) = 98913
TV8890(20) = 98869
TV8890(21) = 98823
TV8890(22) = 98778
TV8890(23) = 98734
TV8890(24) = 98689
TV8890(25) = 98640
TV8890(26) = 98590
TV8890(27) = 98537
TV8890(28) = 98482
TV8890(29) = 98428
TV8890(30) = 98371
TV8890(31) = 98310
TV8890(32) = 98247
TV8890(33) = 98182
TV8890(34) = 98111
TV8890(35) = 98031
TV8890(36) = 97942
TV8890(37) = 97851
TV8890(38) = 97753
TV8890(39) = 97648
TV8890(40) = 97534
TV8890(41) = 97413
TV8890(42) = 97282
TV8890(43) = 97138
TV8890(44) = 96981
TV8890(45) = 96810
TV8890(46) = 96622
TV8890(47) = 96424
TV8890(48) = 96218
TV8890(49) = 95995
TV8890(50) = 95752
TV8890(51) = 95488
TV8890(52) = 95202
TV8890(53) = 94892
TV8890(54) = 94560
TV8890(55) = 94215
TV8890(56) = 93848
TV8890(57) = 93447
TV8890(58) = 93014
TV8890(59) = 92545
TV8890(60) = 92050
TV8890(61) = 91523
TV8890(62) = 90954
TV8890(63) = 90343
TV8890(64) = 89687
TV8890(65) = 88978
TV8890(66) = 88226
TV8890(67) = 87409
TV8890(68) = 86513
TV8890(69) = 85522
TV8890(70) = 84440
TV8890(71) = 83251
TV8890(72) = 81936
TV8890(73) = 80484
TV8890(74) = 78880
TV8890(75) = 77104
TV8890(76) = 75136
TV8890(77) = 72981
TV8890(78) = 70597
TV8890(79) = 67962
TV8890(80) = 65043
TV8890(81) = 61852
TV8890(82) = 58379
TV8890(83) = 54614
TV8890(84) = 50625
TV8890(85) = 46455
TV8890(86) = 42130
TV8890(87) = 37738
TV8890(88) = 33340
TV8890(89) = 28980
TV8890(90) = 24739
TV8890(91) = 20704
TV8890(92) = 16959
TV8890(93) = 13580
TV8890(94) = 10636
TV8890(95) = 8118
TV8890(96) = 6057
TV8890(97) = 4378
TV8890(98) = 3096
TV8890(99) = 2184
TV8890(100) = 1479
TV8890(101) = 961
TV8890(102) = 599
TV8890(103) = 358
TV8890(104) = 205
TV8890(105) = 113
TV8890(106) = 59
TV8890(107) = 30
TV8890(108) = 14
TV8890(109) = 6
TV8890(110) = 2
TV8890(111) = 0
TV8890(112) = 0
TV8890(113) = 0
TV8890(114) = 0
TV8890(115) = 0
TV8890(116) = 0
TV8890(117) = 0

TD8890(0) = 100000
TD8890(1) = 99129
TD8890(2) = 99057
TD8890(3) = 99010
TD8890(4) = 98977
TD8890(5) = 98948
TD8890(6) = 98921
TD8890(7) = 98897
TD8890(8) = 98876
TD8890(9) = 98855
TD8890(10) = 98835
TD8890(11) = 98814
TD8890(12) = 98793
TD8890(13) = 98771
TD8890(14) = 98745
TD8890(15) = 98712
TD8890(16) = 98667
TD8890(17) = 98606
TD8890(18) = 98520
TD8890(19) = 98406
TD8890(20) = 98277
TD8890(21) = 98137
TD8890(22) = 97987
TD8890(23) = 97830
TD8890(24) = 97677
TD8890(25) = 97524
TD8890(26) = 97373
TD8890(27) = 97222
TD8890(28) = 97070
TD8890(29) = 96916
TD8890(30) = 96759
TD8890(31) = 96597
TD8890(32) = 96429
TD8890(33) = 96255
TD8890(34) = 96071
TD8890(35) = 95878
TD8890(36) = 95676
TD8890(37) = 95463
TD8890(38) = 95237
TD8890(39) = 94997
TD8890(40) = 94746
TD8890(41) = 94476
TD8890(42) = 94182
TD8890(43) = 93868
TD8890(44) = 93515
TD8890(45) = 93133
TD8890(46) = 92727
TD8890(47) = 92295
TD8890(48) = 91833
TD8890(49) = 91332
TD8890(50) = 90778
TD8890(51) = 90171
TD8890(52) = 89511
TD8890(53) = 88791
TD8890(54) = 88011
TD8890(55) = 87165
TD8890(56) = 86241
TD8890(57) = 85256
TD8890(58) = 84211
TD8890(59) = 83083
TD8890(60) = 81884
TD8890(61) = 80602
TD8890(62) = 79243
TD8890(63) = 77807
TD8890(64) = 76295
TD8890(65) = 74720
TD8890(66) = 73075
TD8890(67) = 71366
TD8890(68) = 69559
TD8890(69) = 67655
TD8890(70) = 65649
TD8890(71) = 63543
TD8890(72) = 61285
TD8890(73) = 58911
TD8890(74) = 56416
TD8890(75) = 53818
TD8890(76) = 51086
TD8890(77) = 48251
TD8890(78) = 45284
TD8890(79) = 42203
TD8890(80) = 39041
TD8890(81) = 35824
TD8890(82) = 32518
TD8890(83) = 29220
TD8890(84) = 25962
TD8890(85) = 22780
TD8890(86) = 19725
TD8890(87) = 16843
TD8890(88) = 14133
TD8890(89) = 11625
TD8890(90) = 9389
TD8890(91) = 7438
TD8890(92) = 5763
TD8890(93) = 4350
TD8890(94) = 3211
TD8890(95) = 2315
TD8890(96) = 1635
TD8890(97) = 1115
TD8890(98) = 740
TD8890(99) = 453
TD8890(100) = 263
TD8890(101) = 145
TD8890(102) = 76
TD8890(103) = 37
TD8890(104) = 17
TD8890(105) = 7
TD8890(106) = 2
TD8890(107) = 0
TD8890(108) = 0
TD8890(109) = 0
TD8890(110) = 0
TD8890(111) = 0
TD8890(112) = 0
TD8890(113) = 0
TD8890(114) = 0
TD8890(115) = 0
TD8890(116) = 0
TD8890(117) = 0

TPRV93(0) = 100000
TPRV93(1) = 97047
TPRV93(2) = 95995
TPRV93(3) = 95793
TPRV93(4) = 95653
TPRV93(5) = 95556
TPRV93(6) = 95515
TPRV93(7) = 95477
TPRV93(8) = 95442
TPRV93(9) = 95410
TPRV93(10) = 95379
TPRV93(11) = 95359
TPRV93(12) = 95336
TPRV93(13) = 95311
TPRV93(14) = 95284
TPRV93(15) = 95254
TPRV93(16) = 95221
TPRV93(17) = 95185
TPRV93(18) = 95144
TPRV93(19) = 95101
TPRV93(20) = 95056
TPRV93(21) = 95008
TPRV93(22) = 94957
TPRV93(23) = 94904
TPRV93(24) = 94850
TPRV93(25) = 94794
TPRV93(26) = 94736
TPRV93(27) = 94677
TPRV93(28) = 94617
TPRV93(29) = 94555
TPRV93(30) = 94491
TPRV93(31) = 94424
TPRV93(32) = 94356
TPRV93(33) = 94285
TPRV93(34) = 94211
TPRV93(35) = 94133
TPRV93(36) = 94050
TPRV93(37) = 93963
TPRV93(38) = 93871
TPRV93(39) = 93774
TPRV93(40) = 93670
TPRV93(41) = 93560
TPRV93(42) = 93442
TPRV93(43) = 93318
TPRV93(44) = 93185
TPRV93(45) = 93043
TPRV93(46) = 92892
TPRV93(47) = 92732
TPRV93(48) = 92560
TPRV93(49) = 92378
TPRV93(50) = 92183
TPRV93(51) = 91976
TPRV93(52) = 91756
TPRV93(53) = 91520
TPRV93(54) = 91273
TPRV93(55) = 91013
TPRV93(56) = 90741
TPRV93(57) = 90455
TPRV93(58) = 90155
TPRV93(59) = 89844
TPRV93(60) = 89523
TPRV93(61) = 89191
TPRV93(62) = 88849
TPRV93(63) = 88498
TPRV93(64) = 88126
TPRV93(65) = 87733
TPRV93(66) = 87319
TPRV93(67) = 86882
TPRV93(68) = 86422
TPRV93(69) = 85911
TPRV93(70) = 85343
TPRV93(71) = 84711
TPRV93(72) = 84007
TPRV93(73) = 83224
TPRV93(74) = 82337
TPRV93(75) = 81333
TPRV93(76) = 80198
TPRV93(77) = 78913
TPRV93(78) = 77462
TPRV93(79) = 75840
TPRV93(80) = 74030
TPRV93(81) = 72016
TPRV93(82) = 69780
TPRV93(83) = 67306
TPRV93(84) = 64621
TPRV93(85) = 61719
TPRV93(86) = 58596
TPRV93(87) = 55255
TPRV93(88) = 51700
TPRV93(89) = 47999
TPRV93(90) = 44172
TPRV93(91) = 40248
TPRV93(92) = 36261
TPRV93(93) = 32253
TPRV93(94) = 28330
TPRV93(95) = 24535
TPRV93(96) = 20914
TPRV93(97) = 17513
TPRV93(98) = 14373
TPRV93(99) = 11530
TPRV93(100) = 9014
TPRV93(101) = 6843
TPRV93(102) = 5023
TPRV93(103) = 3547
TPRV93(104) = 2395
TPRV93(105) = 1535
TPRV93(106) = 926
TPRV93(107) = 519
TPRV93(108) = 267
TPRV93(109) = 123
TPRV93(110) = 50
TPRV93(111) = 17
TPRV93(112) = 5
TPRV93(113) = 1
TPRV93(114) = 0
TPRV93(115) = 0
TPRV93(116) = 0
TPRV93(117) = 0

TV2000(0) = 100000
TV2000(1) = 99576
TV2000(2) = 99511
TV2000(3) = 99476
TV2000(4) = 99455
TV2000(5) = 99431
TV2000(6) = 99408
TV2000(7) = 99389
TV2000(8) = 99373
TV2000(9) = 99356
TV2000(10) = 99342
TV2000(11) = 99323
TV2000(12) = 99304
TV2000(13) = 99288
TV2000(14) = 99268
TV2000(15) = 99244
TV2000(16) = 99212
TV2000(17) = 99178
TV2000(18) = 99144
TV2000(19) = 99101
TV2000(20) = 99054
TV2000(21) = 99006
TV2000(22) = 98955
TV2000(23) = 98905
TV2000(24) = 98858
TV2000(25) = 98804
TV2000(26) = 98744
TV2000(27) = 98689
TV2000(28) = 98634
TV2000(29) = 98583
TV2000(30) = 98532
TV2000(31) = 98471
TV2000(32) = 98407
TV2000(33) = 98348
TV2000(34) = 98277
TV2000(35) = 98201
TV2000(36) = 98118
TV2000(37) = 98020
TV2000(38) = 97922
TV2000(39) = 97821
TV2000(40) = 97721
TV2000(41) = 97620
TV2000(42) = 97503
TV2000(43) = 97372
TV2000(44) = 97249
TV2000(45) = 97124
TV2000(46) = 96986
TV2000(47) = 96820
TV2000(48) = 96647
TV2000(49) = 96466
TV2000(50) = 96263
TV2000(51) = 96044
TV2000(52) = 95781
TV2000(53) = 95481
TV2000(54) = 95176
TV2000(55) = 94863
TV2000(56) = 94536
TV2000(57) = 94192
TV2000(58) = 93835
TV2000(59) = 93460
TV2000(60) = 93023
TV2000(61) = 92519
TV2000(62) = 91981
TV2000(63) = 91395
TV2000(64) = 90783
TV2000(65) = 90166
TV2000(66) = 89530
TV2000(67) = 88801
TV2000(68) = 88017
TV2000(69) = 87220
TV2000(70) = 86324
TV2000(71) = 85315
TV2000(72) = 84201
TV2000(73) = 82941
TV2000(74) = 81507
TV2000(75) = 79874
TV2000(76) = 78059
TV2000(77) = 76030
TV2000(78) = 73747
TV2000(79) = 71238
TV2000(80) = 68400
TV2000(81) = 65147
TV2000(82) = 61583
TV2000(83) = 57708
TV2000(84) = 53511
TV2000(85) = 49086
TV2000(86) = 44435
TV2000(87) = 39554
TV2000(88) = 34726
TV2000(89) = 30188
TV2000(90) = 25833
TV2000(91) = 21479
TV2000(92) = 17332
TV2000(93) = 13527
TV2000(94) = 10083
TV2000(95) = 7275
TV2000(96) = 5052
TV2000(97) = 3470
TV2000(98) = 2503
TV2000(99) = 1931
TV2000(100) = 1426
TV2000(101) = 1000
TV2000(102) = 658
TV2000(103) = 401
TV2000(104) = 222
TV2000(105) = 108
TV2000(106) = 45
TV2000(107) = 15
TV2000(108) = 3
TV2000(109) = 2
TV2000(110) = 1
TV2000(111) = 0
TV2000(112) = 0
TV2000(113) = 0
TV2000(114) = 0
TV2000(115) = 0
TV2000(116) = 0
TV2000(117) = 0

MR93(0) = 1000000.0000424
MR93(1) = 999414.772590575
MR93(2) = 998827.167113925
MR93(3) = 998236.913390383
MR93(4) = 997643.714105673
MR93(5) = 997047.242139483
MR93(6) = 996447.137580662
MR93(7) = 995843.004444596
MR93(8) = 995234.407063257
MR93(9) = 994620.86611558
MR93(10) = 994001.854262645
MR93(11) = 993376.791348737
MR93(12) = 992745.039125599
MR93(13) = 992105.895453084
MR93(14) = 991458.587924977
MR93(15) = 990802.266863864
MR93(16) = 990135.997623668
MR93(17) = 989458.752132693
MR93(18) = 988769.399603799
MR93(19) = 988066.696331574
MR93(20) = 987349.274489039
MR93(21) = 986615.629828567
MR93(22) = 985864.108183192
MR93(23) = 985092.890655364
MR93(24) = 984299.977370464
MR93(25) = 983483.169661995
MR93(26) = 982640.050544309
MR93(27) = 981767.963317061
MR93(28) = 980863.98813335
MR93(29) = 979924.916350697
MR93(30) = 978947.222470813
MR93(31) = 977927.033460597
MR93(32) = 976860.095233154
MR93(33) = 975741.73605412
MR93(34) = 974566.826625463
MR93(35) = 973329.73658669
MR93(36) = 972024.287162456
MR93(37) = 970643.699676644
MR93(38) = 969180.539646883
MR93(39) = 967626.656171136
MR93(40) = 965973.116320759
MR93(41) = 964210.134263749
MR93(42) = 962326.994859701
MR93(43) = 960311.971496462
MR93(44) = 958152.237980446
MR93(45) = 955833.774351198
MR93(46) = 953341.266570169
MR93(47) = 950658.000138272
MR93(48) = 947765.747832267
MR93(49) = 944644.65192281
MR93(50) = 941273.10145458
MR93(51) = 937627.605440106
MR93(52) = 933682.663153601
MR93(53) = 929410.63312078
MR93(54) = 924781.602897797
MR93(55) = 919763.262331216
MR93(56) = 914320.783706357
MR93(57) = 908416.713039358
MR93(58) = 902010.877764999
MR93(59) = 895060.317233291
MR93(60) = 887519.243766699
MR93(61) = 879339.043556663
MR93(62) = 870468.328396753
MR93(63) = 860853.051154836
MR93(64) = 850436.699958893
MR93(65) = 839160.588272085
MR93(66) = 826964.260297548
MR93(67) = 813786.033382475
MR93(68) = 799563.701139517
MR93(69) = 784235.422669531
MR93(70) = 767740.824281494
MR93(71) = 750022.340107884
MR93(72) = 731026.816555975
MR93(73) = 710707.402061624
MR93(74) = 689025.737458722
MR93(75) = 665954.452682674
MR93(76) = 641479.961656181
MR93(77) = 615605.528207515
MR93(78) = 588354.550963245
MR93(79) = 559773.983763308
MR93(80) = 529937.770091839
MR93(81) = 498950.125787166
MR93(82) = 466948.455357223
MR93(83) = 434105.636408112
MR93(84) = 400631.358565108
MR93(85) = 366772.164478639
MR93(86) = 332809.819964543
MR93(87) = 299057.649030207
MR93(88) = 265854.51991837
MR93(89) = 233556.272809991
MR93(90) = 202524.548597172
MR93(91) = 173113.215630614
MR93(92) = 145652.89218267
MR93(93) = 120434.406874084
MR93(94) = 97692.3899051736
MR93(95) = 77590.4879843703
MR93(96) = 60209.8731155434
MR93(97) = 45542.6919620125
MR93(98) = 33491.8121061141
MR93(99) = 23877.6330948571
MR93(100) = 16451.8726585179
MR93(101) = 10917.2185829955
MR93(102) = 6950.73835439728
MR93(103) = 4228.19491305504
MR93(104) = 2446.15157464244
MR93(105) = 1339.09990968423
MR93(106) = 689.791937801965
MR93(107) = 332.298088261793
MR93(108) = 148.696681011531
MR93(109) = 61.3479790726372
MR93(110) = 23.1451151633347
MR93(111) = 7.91320996788048
MR93(112) = 2.42749103641795
MR93(113) = 0.660867817632431
MR93(114) = 0.157754926006786
MR93(115) = 0.157754926006786
MR93(116) = 0.157754926006786
MR93(117) = 0.157754926006786
End Function

Function TableMortalit|fffd|(ByVal age As Integer, Table As String, ByVal AnNaiss As Integer) As Double
TableMortalit|fffd| = 0
Select Case Table
Case "TGH05", "TGF05"
  If age > 120 Then
    TableMortalit|fffd| = 0
    Exit Function
  End If
Case Else
  If age > 117 Then
    TableMortalit|fffd| = 0
    Exit Function
  End If
End Select
Select Case UCase(Table)
Case "PF4649": TableMortalit|fffd| = PF4649(age)
Case "PM4649": TableMortalit|fffd| = PM4649(age)
Case "PM6064": TableMortalit|fffd| = PM6064(age)
Case "PF6064": TableMortalit|fffd| = PF6064(age)
Case "TV7377": TableMortalit|fffd| = TV7377(age)
Case "TD7377": TableMortalit|fffd| = TD7377(age)
Case "TV8890": TableMortalit|fffd| = TV8890(age)
Case "TD8890": TableMortalit|fffd| = TD8890(age)
Case "TPRV93": TableMortalit|fffd| = TPRV93(age)
Case "TV2000": TableMortalit|fffd| = TV2000(age)
Case "MR93": TableMortalit|fffd| = MR93(age)
Case "TPG": TableMortalit|fffd| = TPG(Maxi(Mini(AnNaiss, 1993), 1887), age)
Case "TGH05": TableMortalit|fffd| = wTGH05.Cells(age + 2, AnNaiss - 1900 + 2).Value
Case "TGF05": TableMortalit|fffd| = wTGF05.Cells(age + 2, AnNaiss - 1900 + 2).Value
Case "SANSTABLE": If age < 117 Then TableMortalit|fffd| = 1
End Select
End Function

Function CoefTPG(ByVal AnNaiss As Integer, ByVal age As Integer) As Double
On Error GoTo ErreurTPG
CoefTPG = wTPG.Cells(age + 2, Mini(AnNaiss, 1993) - 1887 + 2).Value
Exit Function
ErreurTPG: MsgBox "L'onglet TPG doit |fffd|tre rajout|fffd| dans le fichier"
End Function

Function PremEch|fffd|ance(ByVal d As Date, ByVal dmin As Date, ByVal Frac As Integer) As Date
'Calcul de la premi|fffd|re |fffd|chance post|fffd|rieure |fffd| la date dMin d'une
'rente de 1er versement en d et de fractionnement Frac
Dim di As Date
di = d
If dmin <= d Then
  PremEch|fffd|ance = d
Else
  While di < dmin
    di = MoisPlus(di, 12 / Frac)
  Wend
End If
PremEch|fffd|ance = di
End Function

Function Lx(ByVal DateNaiss As Date, ByVal DateCalcul As Date, Table As String) As Double
Dim age As Double, AnNaiss As Integer, tabl As String, k As Integer
If TV8890(0) = 0 Then
  IniTables
  IniTPG1
  IniTPG2
  IniTPG3
  IniTPG4
  IniTPG5
  IniTPG6
End If
AnNaiss = Year(DateNaiss)
age = nbann|fffd|es2(DateNaiss, DateCalcul)
'If UCase(Table) = "TH0002" Or UCase(Table) = "TF0002" Then Age = DecalAge(Age, Table)
'XXX Chercher si le d|fffd|calage d'|fffd|ge s'applique au taux d'actualisation et/ou |fffd| la revalorisation de la rente
If UCase(Table) <> "SANSTABLE" Then
  Select Case Left(Table, 4)
  Case "amTG"
    tabl = Right(Left(Table, 7), 5)
    k = 10000
    Select Case Right(Table, 2)
    Case "00": k = 0
    Case "01": k = 1
    Case "02": k = 2
    Case "03": k = 3
    Case "04": k = 4
    Case "05": k = 5
    Case "06": k = 6
    Case "07": k = 7
    Case "08": k = 8
    Case "09": k = 9
    Case "10": k = 10
    Case "11": k = 11
    Case "12": k = 12
    Case "13": k = 13
    Case "14": k = 14
    Case "15": k = 15
    End Select
    Lx = (1 - k / 15) * TableMortalit|fffd|(Int(age), "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age), tabl, AnNaiss)
    If age <> Int(age) Then
      Lx = Lx + (age - Int(age)) * ((1 - k / 15) * TableMortalit|fffd|(Int(age) + 1, "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age) + 1, tabl, AnNaiss) - ((1 - k / 15) * TableMortalit|fffd|(Int(age), "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age), tabl, AnNaiss)))
    End If
  Case "amTV"
    'Tabl = Right(Left(Table, 7), 5)
    k = 10000
    Select Case Right(Table, 2)
    Case "00": k = 0
    Case "01": k = 1
    Case "02": k = 2
    Case "03": k = 3
    Case "04": k = 4
    Case "05": k = 5
    Case "06": k = 6
    Case "07": k = 7
    Case Else
      Lx = 0
      Exit Function
    End Select
    Lx = (1 - k / 7) * TableMortalit|fffd|(Int(age), "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age), "TPG", AnNaiss)
    If age <> Int(age) Then
      Lx = Lx + (age - Int(age)) * ((1 - k / 7) * TableMortalit|fffd|(Int(age) + 1, "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age) + 1, "TPG", AnNaiss) - ((1 - k / 7) * TableMortalit|fffd|(Int(age), "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age), "TPG", AnNaiss)))
    End If
  Case Else
    Lx = TableMortalit|fffd|(Int(age), UCase(Table), AnNaiss)
    If age <> Int(age) Then
      Lx = Lx + (age - Int(age)) * (TableMortalit|fffd|(Int(age) + 1, Table, AnNaiss) - TableMortalit|fffd|(Int(age), Table, AnNaiss))
    End If
  End Select
Else
  Lx = 1
  If age >= 100 Then
    Lx = 0
  End If
End If
End Function

Function Qx(ByVal DateNaiss As Date, ByVal DateCalcul As Date, Table As String) As Double
Qx = 0
If Lx(DateNaiss, DateCalcul, Table) <> 0 Then
  Qx = 1 - px(DateNaiss, DateCalcul, Table)
End If
End Function

Function px(ByVal DateNaiss As Date, ByVal DateCalcul As Date, Table As String) As Double
px = 0
If Lx(DateNaiss, DateCalcul, Table) <> 0 Then
  px = Lx(DateNaiss, AnPlus(DateCalcul, 1), Table) / Lx(DateNaiss, DateCalcul, Table)
End If
End Function

Function Dx(ByVal DateNaiss As Date, ByVal DateCalcul As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim age As Double
If DurCrt < 0 Then DurCrt = 0
age = nbann|fffd|es2(DateNaiss, DateCalcul)
Dx = Lx(DateNaiss, DateCalcul, Table) * ((1 + TxReval) / (1 + TxTechCrt)) ^ Mini(age, DurCrt) * ((1 + TxReval) / (1 + TxTechLg)) ^ (age - Mini(age, DurCrt))
End Function

Function DivDx(ByVal DateNaiss As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim age As Double, Dur As Double, L1 As Double
If DurCrt < 0 Then DurCrt = 0
Dur = nbann|fffd|es2(DateCalcul1, DateCalcul2)
L1 = Lx(DateNaiss, DateCalcul1, Table)
DivDx = 0
If L1 > 0 Then DivDx = Lx(DateNaiss, DateCalcul2, Table) / L1 * (1 + TxReval) ^ Dur / ((1 + TxTechCrt) ^ Mini(Dur, DurCrt) * (1 + TxTechLg) ^ (Dur - Mini(Dur, DurCrt)))
End Function

Function DivNx(ByVal DateNaiss As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
DivNx = 0
T = 1
i = 0
Do Until T = 0
  T = DivDx(DateNaiss, AnPlus(DateCalcul2, i), DateCalcul1, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)
  DivNx = DivNx + T
  i = i + 1
Loop
End Function

Function DivCx(ByVal DateNaiss As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
DivCx = Qx(DateNaiss, DateCalcul2, Table) * DivDx(DateNaiss, DateCalcul2, DateCalcul1, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - 0.5) * ((1 + TxReval) / (1 + TxTechCrt)) ^ (1 / 2)
End Function

Function DivMx(ByVal DateNaiss As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, DurCrt As Double) As Double
Dim i As Integer, T As Double
DivMx = 0
T = 1
i = 0
Do Until T = 0
  T = DivCx(DateNaiss, AnPlus(DateCalcul2, i), DateCalcul1, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)
  DivMx = DivMx + T
  i = i + 1
Loop
End Function

Function Lxy(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul As Date, TableX As String, TableY As String) As Double
Dim AgeX As Double, AgeY As Double
AgeX = nbann|fffd|es2(DateNaissX, DateCalcul)
AgeY = nbann|fffd|es2(DateNaissY, DateCalcul)
Lxy = Lx(DateNaissX, DateCalcul, TableX) * Lx(DateNaissY, DateCalcul, TableY)
End Function

Function DivDxy(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim age As Double, Dur As Double, L2 As Double
If DurCrt < 0 Then DurCrt = 0
Dur = nbann|fffd|es2(DateCalcul1, DateCalcul2)
L2 = Lx(DateNaissX, DateCalcul1, TableX) * Lx(DateNaissY, DateCalcul1, TableY)
DivDxy = 0
If L2 > 0 Then DivDxy = Lx(DateNaissX, DateCalcul2, TableX) * Lx(DateNaissY, DateCalcul2, TableY) / L2 * (1 + TxReval) ^ Dur / ((1 + TxTechCrt) ^ Mini(Dur, DurCrt) * (1 + TxTechLg) ^ (Dur - Mini(Dur, DurCrt)))
End Function

Function DivNxy(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
DivNxy = 0
T = 1
i = 0
Do Until T = 0
  T = DivDxy(DateNaissX, DateNaissY, AnPlus(DateCalcul2, i), DateCalcul1, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)
  DivNxy = DivNxy + T
  i = i + 1
Loop
End Function

Function DivCxy(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
DivCxy = Lx(DateNaissX, DateCalcul2, TableX) / Lx(DateNaissX, DateCalcul1, TableX) * Qx(DateNaissY, DateCalcul2, TableY) * DivDx(DateNaissY, DateCalcul2, DateCalcul1, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - 0.5) * ((1 + TxReval) / (1 + TxTechCrt)) ^ (1 / 2)
End Function

Function DivMxy(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul2 As Date, ByVal DateCalcul1 As Date, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
DivMxy = 0
T = 1
i = 0
Do Until T = 0
  T = DivCxy(DateNaissX, DateNaissY, AnPlus(DateCalcul2, i), DateCalcul1, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)
  DivMxy = DivMxy + T
  i = i + 1
Loop
End Function


Function EVie(ByVal DateNaiss As Date, ByVal DateCalcul As Date, Table As String) As Double
Dim i As Integer, age As Double, T As Double, s As Double, c As Double
s = 0
T = 1
i = 0
c = 1
Do Until T = 0
  T = Lx(DateNaiss, AnPlus(DateCalcul, i), Table)
  s = s + c * T
  i = i + 1
  c = 2
Loop
EVie = s / Lx(DateNaiss, DateCalcul, Table) / 2
End Function

Function EVieXY(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateCalcul As Date, TableX As String, TableY As String) As Double
Dim i As Integer, age As Double, T As Double, s As Double
s = 0
T = 1
i = 0
Do Until T = 0
  T = Lx(DateNaissX, AnPlus(DateCalcul, i), TableX) * Lx(DateNaissY, AnPlus(DateCalcul, i), TableY)
  s = s + T
  i = i + 1
Loop
EVieXY = s / Lx(DateNaissX, DateCalcul, TableX) / Lx(DateNaissY, DateCalcul, TableY)
End Function

'---------------------------- ANNUITES

Function annuit|fffd|1(ByVal DateNaiss As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer) As Double
Dim AgeEval As Double, AgeDebRente As Double, AgeTerme As Double, AgeFinGar As Double, AgeFinDiff As Double
AgeEval = nbann|fffd|es(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateCalcul)
AgeDebRente = nbann|fffd|es(ApproximAge(DateNaiss, DateDebRente, FracApproximAge), DateDebRente)
AgeTerme = nbann|fffd|es(ApproximAge(DateNaiss, DateTerme, FracApproximAge), DateTerme)
AgeFinGar = nbann|fffd|es(ApproximAge(DateNaiss, DateFinGar, FracApproximAge), DateFinGar)
AgeFinDiff = nbann|fffd|es(ApproximAge(DateNaiss, DateFinDiff, FracApproximAge), DateFinDiff)
annuit|fffd|1 = sannuit|fffd|1(AgeEval, AgeDebRente, Year(DateNaiss), Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
End Function

Function annuit|fffd|2(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, TableX As String, TableY As String, ByVal Txrev As Double, ByVal DateMinRev As Date, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer) As Double
Dim AgeX As Double, AgeY As Double, AgeDebRente As Double, AgeMinRev As Double, AgeTerme As Double, AgeFinGar As Double, AgeFinDiff As Double
AgeX = nbann|fffd|es(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateCalcul)
AgeY = nbann|fffd|es(ApproximAge(DateNaissY, DateCalcul, FracApproximAge), DateCalcul)
AgeDebRente = nbann|fffd|es(ApproximAge(DateNaissX, DateDebRente, FracApproximAge), DateDebRente)
AgeMinRev = nbann|fffd|es(ApproximAge(DateNaissY, DateDebRente, FracApproximAge), DateDebRente)
AgeTerme = nbann|fffd|es(ApproximAge(DateNaissX, DateTerme, FracApproximAge), DateTerme)
AgeFinGar = nbann|fffd|es(ApproximAge(DateNaissX, DateFinGar, FracApproximAge), DateFinGar)
AgeFinDiff = nbann|fffd|es(ApproximAge(DateNaissX, DateFinDiff, FracApproximAge), DateFinDiff)
If DateDebRente <= DateCalcul + 1 Then
  annuit|fffd|2 = nbann|fffd|es(DateDebRente, DateCalcul + 1) * (1 + TxFraisRente) + sannuit|fffd|X2(AgeX, Year(DateNaissX), AgeY, Year(DateNaissY), AgeX, TableX, TableY, Txrev, AgeMinRev, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
Else
  annuit|fffd|2 = sannuit|fffd|2(AgeX, Year(DateNaissX), AgeY, Year(DateNaissY), AgeDebRente, TableX, TableY, Txrev, AgeMinRev, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
End If
End Function

Function annuit|fffd|X1RVD(ByVal DateNaiss As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer) As Double
Dim AgeEval As Double, AgeDebRente As Double, AgeTerme As Double, AgeFinGar As Double, AgeFinDiff As Double
AgeEval = nbann|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateCalcul)
AgeDebRente = nbann|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateDebRente)
AgeTerme = nbann|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateTerme)
AgeFinGar = nbann|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateFinGar)
AgeFinDiff = nbann|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateFinDiff)
annuit|fffd|X1RVD = sannuit|fffd|X1(AgeEval, AgeDebRente, Year(DateNaiss), Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
End Function

Function annuit|fffd|X2RVD(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, TableX As String, TableY As String, ByVal Txrev As Double, ByVal DateMinRev As Date, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer) As Double
Dim AgeX As Double, AgeY As Double, AgeDebRente As Double, AgeMinRev As Double, AgeTerme As Double, AgeFinGar As Double, AgeFinDiff As Double
AgeX = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateCalcul)
AgeY = nbann|fffd|es2(ApproximAge(DateNaissY, DateCalcul, FracApproximAge), DateCalcul)
AgeDebRente = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateDebRente)
AgeMinRev = nbann|fffd|es2(ApproximAge(DateNaissY, DateCalcul, FracApproximAge), DateMinRev)
AgeTerme = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateTerme)
AgeFinGar = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateFinGar)
AgeFinDiff = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateFinDiff)
If DateDebRente <= DateCalcul + 1 Then
  annuit|fffd|X2RVD = nbann|fffd|es2(DateDebRente, DateCalcul + 1) * (1 + TxFraisRente) + sannuit|fffd|X2(AgeX, Year(DateNaissX), AgeY, Year(DateNaissY), AgeX, TableX, TableY, Txrev, AgeMinRev, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
Else
  annuit|fffd|X2RVD = sannuit|fffd|X2(AgeX, Year(DateNaissX), AgeY, Year(DateNaissY), AgeDebRente, TableX, TableY, Txrev, AgeMinRev, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
End If
End Function

Function Annuit|fffd|3(ByVal DateNaissX As Date, ByVal DateNaissY1 As Date, ByVal DateNaissY2 As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, TableX As String, TableY As String, ByVal Txrev As Double, ByVal DateMinRev1 As Date, ByVal DateMinRev2 As Date, ByVal DurMariagY1 As Double, ByVal DurMariagY2 As Double, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer) As Double
Dim AgeX As Double, AgeY1 As Double, AgeY2 As Double, AgeDebRente As Double, AgeMinRev As Double, AgeTerme As Double, AgeFinGar As Double, AgeFinDiff As Double
AgeX = nbann|fffd|es2(ApproximAge(DateNaissX, DateCalcul, FracApproximAge), DateCalcul)
AgeY1 = nbann|fffd|es2(ApproximAge(DateNaissY1, DateCalcul, FracApproximAge), DateCalcul)
AgeY2 = nbann|fffd|es2(ApproximAge(DateNaissY2, DateCalcul, FracApproximAge), DateCalcul)
AgeDebRente = nbann|fffd|es2(ApproximAge(DateNaissX, DateDebRente, FracApproximAge), DateDebRente)
AgeMinRev = nbann|fffd|es2(ApproximAge(DateNaissY1, DateDebRente, FracApproximAge), DateDebRente)
AgeTerme = nbann|fffd|es2(ApproximAge(DateNaissX, DateTerme, FracApproximAge), DateTerme)
AgeFinGar = nbann|fffd|es2(ApproximAge(DateNaissX, DateFinGar, FracApproximAge), DateFinGar)
AgeFinDiff = nbann|fffd|es2(ApproximAge(DateNaissX, DateFinDiff, FracApproximAge), DateFinDiff)
Annuit|fffd|3 = sAnnuit|fffd|3(AgeX, Year(DateNaissX), AgeY1, Year(DateNaissY1), AgeY2, Year(DateNaissY2), AgeDebRente, TableX, TableY, Txrev, AgeMinRev, DurMariagY1, DurMariagY2, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
End Function
Attribute VB_Name = "FctSAnnuit|fffd|s"

Option Explicit

Function sLx(ByVal age As Double, ByVal AnNaiss As Integer, Table As String) As Double
Dim tabl As String, k As Integer
If TV8890(0) = 0 Then
  IniTables
  IniTPG1
  IniTPG2
  IniTPG3
  IniTPG4
  IniTPG5
  IniTPG6
End If
'XXX V|fffd|rifier que le d|fffd|calage d'|fffd|ge s'applique au taux d'actualisation et/ou |fffd| la revalorisation de la rente
If UCase(Table) <> "SANSTABLE" Then
  Select Case Left(Table, 4)
  Case "amTG"
    tabl = Right(Left(Table, 7), 5)
    k = 10000
    Select Case Right(Table, 2)
    Case "00": k = 0
    Case "01": k = 1
    Case "02": k = 2
    Case "03": k = 3
    Case "04": k = 4
    Case "05": k = 5
    Case "06": k = 6
    Case "07": k = 7
    Case "08": k = 8
    Case "09": k = 9
    Case "10": k = 10
    Case "11": k = 11
    Case "12": k = 12
    Case "13": k = 13
    Case "14": k = 14
    Case "15": k = 15
    End Select
    sLx = (1 - k / 15) * TableMortalit|fffd|(Int(age), "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age), tabl, AnNaiss)
    If age <> Int(age) Then
      sLx = sLx + (age - Int(age)) * ((1 - k / 15) * TableMortalit|fffd|(Int(age) + 1, "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age) + 1, tabl, AnNaiss) - ((1 - k / 15) * TableMortalit|fffd|(Int(age), "TPG", AnNaiss) * TableMortalit|fffd|(0, tabl, AnNaiss) / TableMortalit|fffd|(0, "TPG", AnNaiss) + k / 15 * TableMortalit|fffd|(Int(age), tabl, AnNaiss)))
    End If
  Case "amTV"
    'Tabl = Right(Left(Table, 7), 5)
    k = 10000
    Select Case Right(Table, 2)
    Case "00": k = 0
    Case "01": k = 1
    Case "02": k = 2
    Case "03": k = 3
    Case "04": k = 4
    Case "05": k = 5
    Case "06": k = 6
    Case "07": k = 7
    Case Else
      sLx = 0
      Exit Function
    End Select
    sLx = (1 - k / 7) * TableMortalit|fffd|(Int(age), "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age), "TPG", AnNaiss)
    If age <> Int(age) Then
      sLx = sLx + (age - Int(age)) * ((1 - k / 7) * TableMortalit|fffd|(Int(age) + 1, "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age) + 1, "TPG", AnNaiss) - ((1 - k / 7) * TableMortalit|fffd|(Int(age), "TV8890", AnNaiss) + k / 7 * TableMortalit|fffd|(Int(age), "TPG", AnNaiss)))
    End If
  Case Else
    sLx = TableMortalit|fffd|(Int(age), UCase(Table), AnNaiss)
    If age <> Int(age) Then
      sLx = sLx + (age - Int(age)) * (TableMortalit|fffd|(Int(age) + 1, Table, AnNaiss) - TableMortalit|fffd|(Int(age), Table, AnNaiss))
    End If
  End Select
Else
  sLx = 1
  If age >= 100 Then
    sLx = 0
  End If
End If
End Function

Function sQx(ByVal age As Double, ByVal AnNaiss As Integer, Table As String) As Double
sQx = 0
If sLx(age, AnNaiss, Table) <> 0 Then
  sQx = 1 - sPx(age, AnNaiss, Table)
End If
End Function

Function sPx(ByVal age As Double, ByVal AnNaiss As Integer, Table As String) As Double
sPx = 0
If sLx(age, AnNaiss, Table) <> 0 Then
  sPx = sLx(age + 1, AnNaiss, Table) / sLx(age, AnNaiss, Table)
End If
End Function

Function sDx(ByVal age As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
If DurCrt < 0 Then DurCrt = 0
sDx = sLx(age, AnNaiss, Table) * ((1 + TxReval) / (1 + TxTechCrt)) ^ Mini(age, DurCrt) * ((1 + TxReval) / (1 + TxTechLg)) ^ (age - Mini(age, DurCrt))
End Function

Function sDivDx(ByVal AgeInf As Double, ByVal AgeSup As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim Dur As Double, LInf As Double
If DurCrt < 0 Then DurCrt = 0
Dur = AgeSup - AgeInf
LInf = sLx(AgeInf, AnNaiss, Table)
sDivDx = 0
If LInf > 0 Then sDivDx = sLx(AgeSup, AnNaiss, Table) / LInf * (1 + TxReval) ^ Dur / ((1 + TxTechCrt) ^ Mini(Dur, DurCrt) * (1 + TxTechLg) ^ (Dur - Mini(Dur, DurCrt)))
End Function

Function sDivNx(ByVal AgeInf As Double, ByVal AgeSup As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
sDivNx = 0
T = 1
i = 0
Do Until T = 0
  T = sDivDx(AgeInf, AgeSup + i, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)
  sDivNx = sDivNx + T
  i = i + 1
Loop
End Function

Function sDivCx(ByVal AgeInf As Double, ByVal AgeSup As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
sDivCx = sQx(AgeSup, AnNaiss, Table) * sDivDx(AgeInf, AgeSup, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - 0.5) * ((1 + TxReval) / (1 + TxTechCrt)) ^ (1 / 2)
End Function

Function sDivMx(ByVal AgeInf As Double, ByVal AgeSup As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
sDivMx = 0
T = 1
i = 0
Do Until T = 0
  T = sDivCx(AgeInf, AgeSup + i, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)
  sDivMx = sDivMx + T
  i = i + 1
Loop
End Function

Function sLxy(ByVal AgeX As Double, ByVal AnNaissX As Integer, ByVal AgeY As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String) As Double
sLxy = sLx(AgeX, AnNaissX, TableX) * sLx(AgeY, AnNaissY, TableY)
End Function

Function sDivDxy(ByVal AgeXInf As Double, ByVal AgeXSup As Double, ByVal AnNaissX As Integer, ByVal AgeYInf As Double, ByVal AgeYSup As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim Dur As Double, LInf As Double
If DurCrt < 0 Then DurCrt = 0
Dur = AgeXSup - AgeXInf
LInf = sLx(AgeXInf, AnNaissX, TableX) * sLx(AgeYInf, AnNaissY, TableY)
sDivDxy = 0
If LInf > 0 Then sDivDxy = sLx(AgeXSup, AnNaissX, TableX) * sLx(AgeYSup, AnNaissY, TableY) / LInf * (1 + TxReval) ^ Dur / ((1 + TxTechCrt) ^ Mini(Dur, DurCrt) * (1 + TxTechLg) ^ (Dur - Mini(Dur, DurCrt)))
End Function

Function sDivNxy(ByVal AgeXInf As Double, ByVal AgeXSup As Double, ByVal AnNaissX As Integer, ByVal AgeYInf As Double, ByVal AgeYSup As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
sDivNxy = 0
T = 1
i = 0
Do Until T = 0
  T = sDivDxy(AgeXInf, AgeXSup + i, AnNaissX, AgeYInf, AgeYSup + i, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)
  sDivNxy = sDivNxy + T
  i = i + 1
Loop
End Function

Function sDivCxy(ByVal AgeInfX As Double, ByVal AgeSupX As Double, ByVal AnNaissX As Integer, ByVal AgeInfY As Double, ByVal AgeSupY As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
sDivCxy = sLx(AgeSupX, AnNaissX, TableX) / sLx(AgeInfX, AnNaissX, TableX) * sQx(AgeSupY, AnNaissY, TableY) * sDivDx(AgeInfY, AgeSupY, AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - 0.5) * ((1 + TxReval) / (1 + TxTechCrt)) ^ (1 / 2)
End Function

Function sDivMxy(ByVal AgeInfX As Double, ByVal AgeSupX As Double, ByVal AnNaissX As Integer, ByVal AgeInfY As Double, ByVal AgeSupY As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double) As Double
Dim i As Integer, T As Double
sDivMxy = 0
T = 1
i = 0
Do Until T = 0
  T = sDivCxy(AgeInfX, AgeSupX + i, AnNaissX, AgeInfY, AgeSupY + i, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)
  sDivMxy = sDivMxy + T
  i = i + 1
Loop
End Function

Function sEVie(ByVal age As Double, ByVal AnNaiss As Integer, Table As String) As Double
Dim i As Integer, T As Double, s As Double, c As Double
s = 0
T = 1
i = 0
c = 1
Do Until T = 0
  T = sLx(age + i, AnNaiss, Table)
  s = s + c * T
  i = i + 1
  c = 2
Loop
sEVie = s / sLx(age, AnNaiss, Table) / 2
End Function

Function sEVieXY(ByVal AgeX As Double, ByVal AnNaissX As Integer, ByVal AgeY As Double, ByVal AnNaissY As Integer, TableX As String, TableY As String) As Double
Dim i As Integer, age As Double, T As Double, s As Double
s = 0
T = 1
i = 0
Do Until T = 0
  T = sLx(AgeX + i, AnNaissX, TableX) * sLx(AgeY + i, AnNaissY, TableY)
  s = s + T
  i = i + 1
Loop
sEVieXY = s / sLx(AgeX, AnNaissX, TableX) / sLx(AgeY, AnNaissY, TableY)
End Function

'---------------------------- ANNUITES

Function sannuit|fffd|1(ByVal AgeEval As Double, ByVal AgeDebRente As Double, ByVal AnNaiss As Integer, Table As String, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal AgeTerme As Double = 0, Optional ByVal AgeFinGar As Double = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
'Annuit|fffd|s garanties d|fffd|compt|fffd|es depuis date de d|fffd|but de rente
'Annuit|fffd|s croissantes : TxAppliqu|fffd| |fffd| l'|fffd|ch|fffd|ance imm|fffd|diatement sup|fffd|rieure |fffd| 70 et 75 ans
Dim An As Double, d As Date
An = 0
DurCrt = Maxi(DurCrt, 0)
If AgeDebRente <= AgeEval Then
  AgeFinDiff = 0
  TxFraisDiff = 0
End If
If AgeDebRente > AgeEval Then AgeFinDiff = Mini(AgeFinDiff, AgeDebRente)

If AgeDebRente > 110 Then GoTo fin

If AgeTerme <> 0 And AgeFinGar <> 0 Then
  If AgeFinGar > AgeTerme Then
    MsgBox "Incoh|fffd|rence entre la date de fin de service de la rente et la p|fffd|riode de garantie"
    GoTo fin
  End If
End If

If AgeDebRente < AgeEval Then
  An = An + (AgeEval - AgeDebRente) * (1 + TxFraisRente)
  An = An + sannuit|fffd|1(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
  GoTo fin
End If

If TxCroissRte70_75 <> 0 Then
  'Annuit|fffd| sans revalorisation
  An = An + sannuit|fffd|1(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  'Compl|fffd|ment suite |fffd| 1|fffd|re revalorisation (toutes variables conserv|fffd|es)
  If 70 > AgeDebRente Then An = An + ((1 + TxReval) ^ (70 - Maxi(AgeDebRente, AgeEval))) * TxCroissRte70_75 * sannuit|fffd|1(AgeEval, 70, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  'Compl|fffd|ment suite |fffd| 2nde revalorisation (toutes variables conserv|fffd|es)
  If 75 > AgeDebRente Then An = An + ((1 + TxReval) ^ (75 - Maxi(AgeDebRente, AgeEval))) * ((1 + TxCroissRte70_75) ^ 2 - 1 - TxCroissRte70_75) * sannuit|fffd|1(AgeEval, 75, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  If TxFraisDiff <> 0 And AgeFinDiff > AgeEval Then
    An = An + TxFraisDiff * sannuit|fffd|1(AgeEval, AgeEval, AnNaiss, Table, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiff, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
  If ContrAssurance = "Avec" And AgeDebRente > AgeEval Then
    An = An / (1 - (sDivMx(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  GoTo fin
End If

'A partir de ce point pas de croissance par palier

If AgeFinGar <> 0 And AgeFinGar >= AgeDebRente Then
  'Annuit|fffd| certaine temporaire (jusque AgeFinGar)
  'sans ProrataD|fffd|c|fffd|s ni ContrAssurance(inutile car pas de table appliqu|fffd|e)
  An = An + sannuit|fffd|1(AgeEval, AgeDebRente, AnNaiss, "SansTable", TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeFinGar, 0, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, "Sans", "Sans")
  '+ Relai |fffd| partir de DateFinGar+1
  'sans TxFraisDiff (pris en charge ci-apr|fffd|s) mais avec ProrataD|fffd|c|fffd|s
  An = An + (1 + TxReval) ^ (AgeFinGar - AgeDebRente) * sannuit|fffd|1(AgeEval, AgeFinGar, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, 0, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, "Sans")
  If ContrAssurance = "Avec" And AgeDebRente > AgeEval Then
    An = An / (1 - (sDivMx(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  GoTo fin
End If

'A partir de ce point ni rente garantie ni croissance par palier

If AgeTerme <> 0 Then '=> sAnnuit|fffd| temporaire jusque AgeTerme
  
  If AgeDebRente < AgeEval And AgeEval <= AgeTerme Then
    'Annuit|fffd| relative |fffd| une p|fffd|riode pass|fffd|e
    An = An + (AgeEval - AgeDebRente) * (1 + TxFraisRente)
    '+ sAnnuit|fffd| imm|fffd|diate
    An = An + sannuit|fffd|1(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance)
  End If
  
  If AgeDebRente <= AgeTerme And AgeTerme < AgeEval Then
    'Annuit|fffd| relative |fffd| une p|fffd|riode pass|fffd|e. Aucun compl|fffd|ment car rente termin|fffd|e
    An = An + (AgeTerme - AgeDebRente) * (1 + TxFraisRente)
  End If
  
  If AgeEval <= AgeDebRente And AgeDebRente <= AgeTerme Then
    'Annuit|fffd| imm|fffd|diate ou diff|fffd|r|fffd|e, temporaire
    Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
      An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivDx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRente - AgeEval)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
    Case "ECHU", "|fffd|CHU"
      An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivDx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRente - AgeEval)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      Select Case ProrataD|fffd|c|fffd|s
      Case "PROP": An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
      Case "COMP": An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
      End Select
    End Select
    '... diminu|fffd|e de la m|fffd|me sAnnuit|fffd| diff|fffd|r|fffd|e |fffd| DateTerme+1 mais viag|fffd|re
    '    en gardant TxFraisDiff (lin|fffd|raire)
    '    ni ContrAssurance car calcul|fffd|e ci-apr|fffd|s pour toute l'annuit|fffd| diff|fffd|r|fffd|e
    An = An - (1 + TxReval) ^ (AgeTerme - AgeDebRente) * sannuit|fffd|1(AgeEval, AgeTerme, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, 0, AgeFinGar, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
    'Calcul de la ContrAssurance pour l'annuit|fffd| diff|fffd|r|fffd|e
    If ContrAssurance = "Avec" And AgeDebRente > AgeEval Then
      An = An / (1 - (sDivMx(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)))
    End If
    'XXXXXXXXXXXX Modifier DurCrt avec Contrassurance par MMx ??? ....
    'Calcul des frais de diff|fffd|r|fffd|, |fffd| partir de DateCalcul+1
    If TxFraisDiff <> 0 And AgeFinDiff > AgeEval Then
      An = An + TxFraisDiff * sannuit|fffd|1(AgeEval, AgeEval, AnNaiss, Table, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiff, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
    End If
  End If
  
  'Annuit|fffd| sans p|fffd|riode de r|fffd|glement
  If AgeTerme < AgeDebRente Then
    An = 0
  End If

Else '=> AgeTerme =0 : sAnnuit|fffd| viag|fffd|re (pass|fffd|e, imm|fffd|diate ou diff|fffd|r|fffd|e)
  
  Select Case UCase(Terme)
  Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
    An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivDx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRente - AgeEval)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
  Case "ECHU", "|fffd|CHU"
    If sDx(AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) > 0 And sDx(AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) > 0 Then
      An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivDx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRente - AgeEval)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
    Else
      An = 0
    End If
    Select Case ProrataD|fffd|c|fffd|s
    Case "PROP": An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
    Case "COMP": An = An + 1 / (1 + TxReval) ^ (AgeDebRente - AgeEval) * sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
    End Select
  End Select
  'Calcul de la ContrAssurance
  If ContrAssurance = "Avec" And AgeDebRente > AgeEval Then
    An = An / (1 - (sDivMx(AgeEval, AgeEval, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeEval, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  'Calcul des frais de diff|fffd|r|fffd|, |fffd| partir de DateCalcul+1
  If TxFraisDiff <> 0 And AgeFinDiff > AgeEval Then
    An = An + TxFraisDiff * sannuit|fffd|1(AgeEval, AgeEval, AnNaiss, Table, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiff, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|1(AgeDebRente, AgeDebRente, AnNaiss, Table, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
End If
fin:
sannuit|fffd|1 = An
End Function

Function sannuit|fffd|2(ByVal AgeX As Double, ByVal AnNaissX As Integer, ByVal AgeY As Double, ByVal AnNaissY As Integer, ByVal AgeDebRenteX As Double, TableX As String, TableY As String, ByVal Txrev As Double, ByVal AgeMinRevY As Double, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal AgeTermeX As Double = 0, Optional ByVal AgeFinGarX As Double = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiffX As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
'Annuit|fffd|s garanties d|fffd|compt|fffd|es depuis date de d|fffd|but de rente
'Annuit|fffd|s croissantes : TxAppliqu|fffd| |fffd| l'|fffd|ch|fffd|ance imm|fffd|diatement sup|fffd|rieure |fffd| 70 et 75 ans
Dim An As Double, d As Date, AgeDebRenteY As Double, AgeMinRevX As Double
An = 0
DurCrt = Maxi(DurCrt, 0)
If AgeDebRenteX <= AgeX Then
  AgeFinDiffX = 0
  TxFraisDiff = 0
End If
If AgeDebRenteX > AgeX Then AgeFinDiffX = Mini(AgeFinDiffX, AgeDebRenteX)

AgeMinRevY = Maxi(AgeMinRevY, AgeY)
If AgeDebRenteX + AgeY - AgeX > 110 Then Txrev = 0

If AgeDebRenteX > 110 Then GoTo fin
AgeDebRenteY = AgeDebRenteX + AgeY - AgeX
AgeMinRevX = AgeMinRevY + AgeX - AgeY

If Txrev <> 0 Then
  If sLx(AgeMinRevY, AnNaissY, TableY) = 0 Or AnNaissY = 1899 Then
    Txrev = 0
  End If
End If

If AgeTermeX <> 0 And AgeFinGarX <> 0 Then
  If AgeFinGarX > AgeTermeX Then
    MsgBox "Incoh|fffd|rence entre la date de fin de service de la rente et la p|fffd|riode de garantie"
    GoTo fin
  End If
End If

If AgeDebRenteX < AgeX Then
  An = An + (AgeX - AgeDebRenteX) * (1 + TxFraisRente)
  An = An + sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, AgeX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, TxFraisDiff, AgeFinDiffX, ProrataD|fffd|c|fffd|s, ContrAssurance)
  GoTo fin
End If

If TxCroissRte70_75 <> 0 Then
  'Annuit|fffd| sans revalorisation
  An = An + sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  'Compl|fffd|ment suite |fffd| 1|fffd|re revalorisation (toutes variables conserv|fffd|es)
  If 70 > AgeDebRenteX Then An = An + ((1 + TxReval) ^ (70 - Maxi(AgeDebRenteX, AgeX))) * TxCroissRte70_75 * sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, 70, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  'Compl|fffd|ment suite |fffd| 2nde revalorisation (toutes variables conserv|fffd|es)
  If 75 > AgeDebRenteX Then An = An + ((1 + TxReval) ^ (75 - Maxi(AgeDebRenteX, AgeX))) * ((1 + TxCroissRte70_75) ^ 2 - 1 - TxCroissRte70_75) * sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, 75, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, 0, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  If ContrAssurance = "Avec" And AgeDebRenteX > AgeX Then
    An = An / (1 - (sDivMxy(AgeX, AgeX, AnNaissX, AgeY, AgeY, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMxy(AgeX, AgeDebRenteX, AnNaissX, AgeY, AgeDebRenteY, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  If TxFraisDiff <> 0 And AgeFinDiffX > AgeX Then
    An = An + TxFraisDiff * sannuit|fffd|1(AgeX, AgeX, AnNaissX, TableX, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiffX, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|2(AgeDebRenteX, AnNaissX, AgeDebRenteY, AnNaissY, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
  GoTo fin
End If

'A partir de ce point pas de croissance par palier

If AgeFinGarX <> 0 And AgeFinGarX >= AgeDebRenteX Then
  'Annuit|fffd| certaine temporaire (jusque AgeFinGar)
  'sans ProrataD|fffd|c|fffd|s ni ContrAssurance(inutile car pas de table appliqu|fffd|e)
  An = An + sannuit|fffd|1(AgeX, AgeDebRenteX, AnNaissX, "SansTable", TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeFinGarX, 0, TxCroissRte70_75, 0, 0, "Sans", "Sans")
  '+ Relai |fffd| partir de DateFinGar+1
  'sans TxFraisDiff (pris en charge ci-apr|fffd|s) mais avec ProrataD|fffd|c|fffd|s
  An = An + (1 + TxReval) ^ (AgeFinGarX - AgeDebRenteX) * sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, AgeFinGarX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, 0, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  If TxFraisDiff <> 0 And AgeFinDiffX > AgeX Then
    An = An + TxFraisDiff * sannuit|fffd|1(AgeX, AgeX, AnNaissX, TableX, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiffX, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|2(AgeDebRenteX, AnNaissX, AgeDebRenteY, AnNaissY, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
  If ContrAssurance = "Avec" And AgeDebRenteX > AgeX Then
    An = An / (1 - (sDivMxy(AgeX, AgeX, AnNaissX, AgeY, AgeY, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMxy(AgeX, AgeDebRenteX, AnNaissX, AgeY, AgeDebRenteY, AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  GoTo fin
End If

'A partir de ce point ni rente garantie ni croissance par palier

If AgeTermeX <> 0 Then '=> sAnnuit|fffd| temporaire jusque AgeTerme

  If AgeDebRenteX < AgeX And AgeX <= AgeTermeX Then
    'Annuit|fffd| relative |fffd| une p|fffd|riode pass|fffd|e
    An = An + (AgeX - AgeDebRenteX) * (1 + TxFraisRente)
    '+ sAnnuit|fffd| imm|fffd|diate
    An = An + sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, AgeX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, TxFraisDiff, AgeFinDiffX, ProrataD|fffd|c|fffd|s, ContrAssurance)
  End If
  
  If AgeDebRenteX <= AgeTermeX And AgeTermeX < AgeX Then
    'Annuit|fffd| relative |fffd| une p|fffd|riode pass|fffd|e. Aucun compl|fffd|ment car rente termin|fffd|e
    An = An + (AgeTermeX - AgeDebRenteX) * (1 + TxFraisRente)
  End If
  
  If AgeX <= AgeDebRenteX And AgeDebRenteX <= AgeTermeX Then
    'Annuit|fffd| imm|fffd|diate ou diff|fffd|r|fffd|e, temporaire
    Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
      An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivDx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRenteX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRenteX - AgeX)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      If Txrev <> 0 Then
        An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivDx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
        An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivDxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNxy(Maxi(AgeDebRenteX, AgeMinRevX), Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      End If
    Case "ECHU", "|fffd|CHU"
      An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivDx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRenteX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRenteX - AgeX)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      Select Case ProrataD|fffd|c|fffd|s
      Case "PROP": An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
      Case "COMP": An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
      End Select
      If Txrev <> 0 Then
        An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivDx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
        An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivDxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNxy(Maxi(AgeDebRenteX, AgeMinRevX), Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
        Select Case ProrataD|fffd|c|fffd|s
        Case "PROP": An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivMx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
                     An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivMxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
        Case "COMP": An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivMx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
                     An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivMxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
        End Select
      End If
    End Select
    '... diminu|fffd|e de la m|fffd|me sAnnuit|fffd| diff|fffd|r|fffd|e |fffd| DateTerme+1 mais viag|fffd|re
    '    en gardant TxFraisDiff (lin|fffd|raire)
    '    ni ContrAssurance car calcul|fffd|e ci-apr|fffd|s pour toute l'annuit|fffd| diff|fffd|r|fffd|e
    An = An - (1 + TxReval) ^ (AgeTermeX - AgeDebRenteX) * sannuit|fffd|2(AgeX, AnNaissX, AgeY, AnNaissY, AgeTermeX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, 0, AgeFinGarX, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
    'Calcul de la ContrAssurance pour l'annuit|fffd| diff|fffd|r|fffd|e
    If ContrAssurance = "Avec" And AgeDebRenteX > AgeX Then
      An = An / (1 - (sDivMx(AgeX, AgeX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt)))
    End If
    'Calcul des frais de diff|fffd|r|fffd|, |fffd| partir de DateCalcul+1
    If TxFraisDiff <> 0 And AgeFinDiffX > AgeX Then
      An = An + TxFraisDiff * sannuit|fffd|1(AgeX, AgeX, AnNaissX, TableX, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiffX, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|2(AgeDebRenteX, AnNaissX, AgeDebRenteY, AnNaissY, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
    End If
  End If
  
  If AgeTermeX < AgeDebRenteX Then
    An = 0
  End If

Else '=> AgeTerme =0 : sAnnuit|fffd| viag|fffd|re (pass|fffd|e, imm|fffd|diate ou diff|fffd|r|fffd|e)
  
  Select Case UCase(Terme)
  Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
    An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivDx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRenteX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRenteX - AgeX)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
    If Txrev <> 0 Then
      An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivDx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivDxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNxy(Maxi(AgeDebRenteX, AgeMinRevX), Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX)) + (Frac + 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
    End If
  Case "ECHU", "|fffd|CHU"
    An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivDx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(AgeDebRenteX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt - (AgeDebRenteX - AgeX)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
    Select Case ProrataD|fffd|c|fffd|s
    Case "PROP": An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
    Case "COMP": An = An + 1 / (1 + TxReval) ^ (AgeDebRenteX - AgeX) * sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
    End Select
    If Txrev <> 0 Then
      An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivDx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNx(Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivDxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) * (sDivNxy(Maxi(AgeDebRenteX, AgeMinRevX), Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, Maxi(AgeDebRenteY, AgeMinRevY), Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt - (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX)) + (Frac - 1) / (2 * Frac) - 1) * (1 + TxFraisRente)
      Select Case ProrataD|fffd|c|fffd|s
      Case "PROP": An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivMx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
                   An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivMxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / (2 * Frac) * (1 + TxFraisRente)
      Case "COMP": An = An + Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteY, AgeMinRevY) - AgeY) * sDivMx(AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
                   An = An - Txrev / (1 + TxReval) ^ (Maxi(AgeDebRenteX, AgeMinRevX) - AgeX) * sDivMxy(AgeX, Maxi(AgeDebRenteX, AgeMinRevX), AnNaissX, AgeY, Maxi(AgeDebRenteY, AgeMinRevY), AnNaissY, TableX, TableY, TxReval, TxTechCrt, TxTechLg, DurCrt) / Frac * (1 + TxFraisRente)
      End Select
    End If
  End Select
  'Calcul de la ContrAssurance
  If ContrAssurance = "Avec" And AgeDebRenteX > AgeX Then
    An = An / (1 - (sDivMx(AgeX, AgeX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt) - sDivMx(AgeX, AgeDebRenteX, AnNaissX, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt)))
  End If
  'Calcul des frais de diff|fffd|r|fffd|, |fffd| partir de DateCalcul+1
  If TxFraisDiff <> 0 And AgeFinDiffX > AgeX Then
    An = An + TxFraisDiff * sannuit|fffd|1(AgeX, AgeX, AnNaissX, TableX, 0, TxTechCrt, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiffX, 0, 0, 0, 0, "Sans", "Sans") * sannuit|fffd|2(AgeDebRenteX, AnNaissX, AgeDebRenteY, AnNaissY, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
End If
fin:
sannuit|fffd|2 = An
End Function

Function sAnnuit|fffd|3(ByVal AgeX As Double, ByVal AnNaissX As Integer, ByVal AgeY1 As Double, ByVal AnNaissY1 As Integer, ByVal AgeY2 As Double, ByVal AnNaissY2 As Integer, ByVal AgeDebRenteX As Double, TableX As String, TableY As String, ByVal Txrev As Double, ByVal AgeMinRevY As Double, ByVal DurMariagY1 As Double, ByVal DurMariagY2 As Double, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, Optional ByVal AgeTermeX As Double = 0, Optional ByVal AgeFinGarX As Double = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiffX As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
Dim An As Double, sEVieY1 As Double, ProrataY1 As Double
An = 0
sEVieY1 = sEVieXY(AgeX, AnNaissX, AgeY1, AnNaissY1, TableX, TableY)
If StatutCjts = "Assur|fffd| : divorc|fffd| deux fois" Then sEVieY1 = 0
ProrataY1 = (DurMariagY1 + sEVieY1) / (DurMariagY1 + DurMariagY2 + sEVieY1)
An = An + ProrataY1 * sannuit|fffd|X2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, TxFraisDiff, AgeFinDiffX, ProrataD|fffd|c|fffd|s, ContrAssurance)
An = An + (1 - ProrataY1) * sannuit|fffd|X2(AgeX, AnNaissX, AgeY2, AnNaissY2, AgeDebRenteX, TableX, TableY, Txrev, AgeMinRevY, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, AgeTermeX, AgeFinGarX, TxCroissRte70_75, TxFraisDiff, AgeFinDiffX, ProrataD|fffd|c|fffd|s, ContrAssurance)
sAnnuit|fffd|3 = An
End Function
Attribute VB_Name = "Feuille_Synth|fffd|se"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "FonctionArr|fffd|rages"
Function ArrMaj(DNaiss As Date, DCal As Date, Table As String, TxArr As Double, TxTech As Double, TxRente As Double, Optional Frac1 As String = "Annuel", Optional DEff As Date = 1) As Double
Dim age As Double
Dim i As Integer
Dim iPx As Double
Dim Qx As Double
Dim AgeEffet As Double
Dim diff As Double
Dim TxTechMensuel As Double

TxTechMensuel = (1 + TxTech) ^ (1 / 12) - 1
Select Case Frac1
Case "Annuel": Frac = 1
Case "Semestriel": Frac = 2
Case "Trimestriel": Frac = 4
Case "Mensuel": Frac = 12
End Select


If DEff = 1 Then DEff = DCal
AgeEffet = nbann|fffd|es2(DNaiss, DEff)
age = nbann|fffd|es2(DNaiss, DCal)
diff = Int(Frac * (AgeEffet - age))
If diff < 0 Then diff = 0

ArrMaj = 0
If age >= 100 Or AgeEffet >= 100 Then Exit Function
Application.ScreenUpdating = False

For i = diff To Frac * Int(100 - age) - 1
iPx = Lx(DNaiss, MoisPlus(DCal, i * 12 / Frac), Table) / Lx(DNaiss, DCal, Table) 'proba d'|fffd|tre en vie jusqu'|fffd| "Age+i" sachant vie |fffd| l'|fffd|ge "Age"
Qx = (Lx(DNaiss, MoisPlus(DCal, i * 12 / Frac), Table) - Lx(DNaiss, MoisPlus(DCal, (i + 1) * 12 / Frac), Table)) / Lx(DNaiss, MoisPlus(DCal, i * 12 / Frac), Table) 'proba de mourir entre "Age+i" et "Age+i+1"


ArrMaj = ArrMaj + (1 / (1 + TxTechMensuel) ^ ((i + 1) * 12 / Frac)) * iPx * Qx
Next i

ArrMaj = ArrMaj * TxArr * (1 + TxRente)
Application.ScreenUpdating = True

End Function

Function Arreragesmajdc(TxArr As Double, Terme As String, Frac As Integer)
ReDim VDC(UBound(VectAge))
Dim i As Integer
Dim Dep As Integer
i = 1

Dep = 0
If UCase(Terme) = "AVANCE" Then Dep = 1
While i + 1 < UBound(VectAge)
i = i + 1
VDC(i) = (VectProba(i - 1) - VectProba(i))

Arreragesmajdc = Arreragesmajdc + VDC(i) * VectFlux(i) * VectActu(i) * TxArr * Frac

Wend

End Function



'Sub modif()
'Dim ArrMaj As Double
'Dim Age As Double
'Dim i As Integer
'Dim Px As Double
'Dim Qx As Double
'Dim TxArr As Double
'TxArr = 3
'Dim DNaiss As Date
'DNaiss = wArt83.Range("E93").Value
'Dim DCal As Date
'DCal = wArt83.Range("F77").Value
'Dim TxTech As Double
'TxTech = 0
'Dim TxRente As Double
'TxRente = 0.03
'
'Age = nbann|fffd|es2(DNaiss, DCal)
'ArrMaj = 0
'If Age >= 100 Then Exit Sub
'Application.ScreenUpdating = False
'
'For i = 0 To Int(100 - Age)
'Px = Lx(DNaiss, AnPlus(DCal, i), "TPG") / Lx(DNaiss, DCal, "TPG")
'Qx = (Lx(DNaiss, AnPlus(DCal, i), "TPG") - Lx(DNaiss, AnPlus(DCal, i + 1), "TPG")) / Lx(DNaiss, AnPlus(DCal, i), "TPG")
'
'wFeuil1.Cells(i + 2, 6).Value = Px
'wFeuil1.Cells(i + 2, 2).Value = Px * Qx
'ArrMaj = ArrMaj + (1 / (1 + TxTech) ^ (i + 1)) * Px * Qx
'Next i
'
'ArrMaj = ArrMaj * TxArr * (1 + TxRente)
'Application.ScreenUpdating = True
'End Sub
Attribute VB_Name = "FonctionAx"
Global TauxTech(1 To 4, 1 To 2) As Double
Global TablRev(1 To 4, 1 To 2) As Variant
Global CroissPalier(1 To 4, 1 To 2) As Variant
Global AgesR|fffd|v(1 To 4, 1 To 2) As Double
Global Tablesr|fffd|v(1 To 4, 1 To 2) As Variant


Function axe(AgeCalcul As Double, AgeEffet As Double, AnNaiss As Integer, Table As String, TxReval As Double, TxTech As Variant, TxTechLg As Double, DurCrt As Double, Frac As Integer, Terme As String, Frais As Double, Optional AgeFin As Double = 0, Optional AG As Double = 0, Optional TabTauxCroiss As Variant = 0, Optional TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Nul", Optional ContrAssurance As String = "Non", Optional Approx As String = "Age exact", Optional AgeMinRev As Double = 0, Optional TauxR|fffd|v As Variant = 0, Optional AgeR|fffd|v As Variant = 0, Optional TableR|fffd|v As Variant = 0, Optional AnNaissR|fffd|v As Variant = 0, Optional TxArr As Double = 0, Optional TxRegr As Double = 0)
'Function axe(AgeCalcul As Double, AnNaiss As Integer,Optional AgeR|fffd|v As Variant = 0,Optional AnNaissR|fffd|v As Double = 0, AgeEffet As Double,  table As String,Optional TableR|fffd|v As Variant = 0, Optional TauxR|fffd|v As Double = 0, ByVal AgeMinRever As Double,ByVal TxReval As Double,  TxTech As Variant, TxTechLg As Double, DurCrt As Double, Frac As Integer, terme As String, Frais As Double,  Optional AG As Double = 0, Optional Approx As String = "Age exact",  Optional TxRegr As Double = 0,  Optional TxArr As Double = 0,Optional AgeFin As Double = 0, Optional TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0,Optional ByVal AgeFinDiffX As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Nul",Optional ContrAssurance As String = "Sans")
'Function sannuit|fffd|X2(ByVal AgeX As Double, ByVal AnNaissX As Integer, ByVal AgeY As Double, ByVal AnNaissY As Integer, ByVal AgeDebRenteX As Double, TableX As String, TableY As String, ByVal TxRev As Double, ByVal AgeMinRevY As Double, ByVal TxReval As Double, ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, terme As String, ByVal TxFraisRente As Double, Optional ByVal AgeTermeX As Double = 0, Optional ByVal AgeFinGarX As Double = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiffX As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
'Function axeT(ByVal AgeCalcul As Double, ByVal AnNaiss As Integer, ByVal AgeR|fffd|v1 As Double, _
    ByVal AgeR|fffd|v2 As Double, ByVal AgeR|fffd|v3 As Double, ByVal AgeR|fffd|v4 As Double, _
    ByVal AnNaissR|fffd|v1 As Integer, ByVal AnNaissR|fffd|v2 As Integer, ByVal AnNaissR|fffd|v3 As Integer, _
    ByVal AnNaissR|fffd|v4 As Integer, ByVal AgeEffet As Double, table As String, _
    TableR|fffd|v1 As String, TableR|fffd|v2 As String, TableR|fffd|v3 As String, _
    TableR|fffd|v4 As String, ByVal TauxR|fffd|v1 As String, ByVal TauxR|fffd|v2 As String, _
    ByVal TauxR|fffd|v3 As String, ByVal TauxR|fffd|v4 As String, ByVal AgeMinRev As Double, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0)

'Fonction qui calcul l'ax.
' ~|fffd|quivalent |fffd| sannuit|fffd|X1
'-> Choix de plusieurs taux techniques, ac les dates associ|fffd|es.
'-> Choix de plusieurs taux de croissance, ac les |fffd|ges associ|fffd|s.
'-> Choix de plusieurs r|fffd|versataires, ac les tables associ|fffd|es. Hypoth|fffd|se chaque r|fffd|versataire touche une part de la rente proportionnelle |fffd| la dur|fffd|e de mariage
If AgeCalcul = 0 Or AgeEffet = 0 Or AnNaiss = 0 Then
axe = 0
Exit Function
End If

Dim VprR As Variant
Dim i As Integer
Dim j As Integer
Dim EcartsAges As Double
Dim VAgeAss As Variant
Dim tabl As String
Dim VprR1() As Double
Dim VprR2() As Double
Dim VprR3() As Double
Dim VprR4() As Double
Dim R|fffd|ver As Double
Dim DMT As Double
Dim VProbaAss As Variant
Dim AnNaissR As Integer
'Optional AgeR|fffd|v As Variant = 0, Optional TableR|fffd|v As Variant = 0, Optional AnNaissR|fffd|v As Variant = 0
'
'If TauxR|fffd|v = "Plus" And AgeR|fffd|v = "Plus" And TableR|fffd|v = "Plus" And AnNaissR|fffd|v = "Plus" Then
'    UserForm1.Show
'    If UserForm1.Validation.Locked = False Then
'        Unload (UserForm1)
'    End If
'End If

'--------Deux formats possibles pour certaines variables: tableau 4x2 ou variable unique
If AnNaissR|fffd|v <> 0.1 Then  ' Si AnNaiss=0.1 c'est que les tableaux ont d|fffd|j|fffd| |fffd|t|fffd| modifi|fffd|s par axed

    If taille(TabTauxCroiss) = 0 Or (taille(TabTauxCroiss) <> 1 And taille(TabTauxCroiss) <> 4) Then
    MsgBox "le format des donn|fffd|es pour la croissance par palier n'est pas compatible"
    Exit Function
    End If
    
    If taille(TabTauxCroiss) = 1 Then
        CroissPalier(1, 1) = 70
        CroissPalier(1, 2) = TabTauxCroiss
        CroissPalier(2, 1) = 75
        CroissPalier(2, 2) = TabTauxCroiss
        CroissPalier(3, 1) = 0
        CroissPalier(3, 2) = 0
        CroissPalier(4, 1) = 0
        CroissPalier(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    CroissPalier(i, j) = TabTauxCroiss(i, j)
    Next j
    Next i
    End If
    
    If taille(TxTech) = 0 Or (taille(TxTech) <> 1 And taille(TxTech) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le taux technique n'est pas compatible"
    Exit Function
    End If
    
    If taille(TxTech) > 1 Then
    For i = 1 To 4
    For j = 1 To 2
    TauxTech(i, j) = TxTech(i, j)
    Next j
    Next i
    Else
        TauxTech(1, 1) = 0
        TauxTech(1, 2) = TxTech
        TauxTech(2, 1) = DurCrt
        TauxTech(2, 2) = TxTechLg
        TauxTech(3, 1) = 0
        TauxTech(3, 2) = TxTechLg
        TauxTech(4, 1) = 0
        TauxTech(4, 2) = TxTechLg
    End If
    
    If taille(AgeR|fffd|v) = 0 Or (taille(AgeR|fffd|v) <> 1 And taille(AgeR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
    End If
    If taille(AgeR|fffd|v) = 1 Then
    AgesR|fffd|v(1, 1) = AgeR|fffd|v
    AgesR|fffd|v(1, 2) = 1
    AgesR|fffd|v(2, 1) = 0
    AgesR|fffd|v(2, 2) = 0
    AgesR|fffd|v(3, 1) = 0
    AgesR|fffd|v(3, 2) = 0
    AgesR|fffd|v(4, 1) = 0
    AgesR|fffd|v(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    AgesR|fffd|v(i, j) = AgeR|fffd|v(i, j)
    Next j
    Next i
    End If


    If taille(TableR|fffd|v) = 0 Or (taille(TableR|fffd|v) <> 1 And taille(TableR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
    End If
    If taille(TableR|fffd|v) = 1 Then
    Tablesr|fffd|v(1, 1) = AnNaissR|fffd|v
    Tablesr|fffd|v(1, 2) = TableR|fffd|v
    Tablesr|fffd|v(2, 1) = 0
    Tablesr|fffd|v(2, 2) = 0
    Tablesr|fffd|v(3, 1) = 0
    Tablesr|fffd|v(3, 2) = 0
    Tablesr|fffd|v(4, 1) = 0
    Tablesr|fffd|v(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    Tablesr|fffd|v(i, j) = TableR|fffd|v(i, j)
    Next j
    Next i
    End If
Else
    For i = 1 To 4
    For j = 1 To 2
    Tablesr|fffd|v(i, j) = TableR|fffd|v(i, j)
    Next j
    Next i
End If




'----------------------Fin des modifications de format

'------Approximation de l'|fffd|ge
Dim age As Double
age = AgeCalcul
AgeCalcul = Approximage3(age, Approx)
AgeEffet = AgeEffet + AgeCalcul - age

If TauxR|fffd|v <> 0 Then R|fffd|ver = 0 Else R|fffd|ver = 1

Dim Pro As Double

Pro = 0

If (ProrataD|fffd|c|fffd|s = "Complet" Or ProrataD|fffd|c|fffd|s = "COMP") And UCase(Terme) <> "AVANCE" Then Pro = 1
If (ProrataD|fffd|c|fffd|s = "Prorata" Or ProrataD|fffd|c|fffd|s = "PROP") And UCase(Terme) <> "AVANCE" Then Pro = 0.5 'Hyp d|fffd|c|fffd|s en milieu d'ann|fffd|e.

axe = 0

'------Vecteurs g|fffd|n|fffd|raux & concernant l'assur|fffd|
VectAge = VAge(AgeCalcul, AgeEffet, Frac, AgeFin, AgesR|fffd|v)

VectActu = VActu(TauxTech, AgeCalcul, AgeEffet)
VectProba = VProba(Terme, AnNaiss, Table, AgeCalcul, AgeEffet, AG)
VectFlux = VFlux(Terme, AgeCalcul, AgeEffet, Frac, CroissPalier, TxFraisDiff, AgeFinDiff)

'VectAge = VAge(AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FracAgeDet").Value, wD|fffd|tailAge.Range("AgeFinDet").Value, AgesR|fffd|v)
'VectActu = VActu(TauxTech, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FraisDiffere").Value, wD|fffd|tailAge.Range("AgeFinDiffere").Value)
'VectProba = VProba(wD|fffd|tailAge.Range("TermeAgeDet").Value, Int(wD|fffd|tailAge.Range("AnNaissDet").Value), wD|fffd|tailAge.Range("Table2AgeDet").Value, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("AGAgeDet").Value)
'VectFlux = VFlux(wD|fffd|tailAge.Range("TermeAgeDet").Value, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FracAgeDet").Value, CroissPalier)

'------Option Croissance annuelle
If TxRegr <> 0 Then
    Dim T As Double
    Dim k As Integer
    Dim Dep As Integer
    T = VectAge(0)
    k = -1
    Dep = 0
    If UCase(Terme) = "AVANCE" Then Dep = -1
    
    For i = 1 To UBound(VectAge)
    If VectAge(i + Dep) - T >= 1 Then
        T = VectAge(i + Dep)
        k = k + 1
    End If
    VectFlux(i) = VectFlux(i) * (1 + TxRegr) ^ k
    Next i
End If

'------Calcul des arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s
axe = axe + Arreragesmajdc(TxArr, Terme, Frac)

'------Annuit|fffd| sans r|fffd|version
axe = axe + VectActu(1) * VectProba(1) * VectFlux(1) + (1 - VectProba(1)) * VectFlux(1) * VectActu(1) * R|fffd|ver * Pro  ' *R|fffd|ver car s'il existe un r|fffd|versataire, la rente lui sera vers|fffd|e donc on ne tient pas compte du prorata

For i = 2 To UBound(VectAge)
    axe = axe + VectActu(i) * VectProba(i) * VectFlux(i) + (VectProba(i - 1) - VectProba(i)) * VectFlux(i) * VectActu(i) * R|fffd|ver * Pro
 
Next i



'------Ajout de la r|fffd|version, possibilit|fffd| d'avoir jusqu'|fffd| 4 r|fffd|versataires

ReDim VProbaAss(UBound(VectAge))
VProbaAss = VectProba
VAgeAss = VectAge
Dim MiniRev As Integer


If TauxR|fffd|v <> 0 Then
DMT = AgesR|fffd|v(1, 2) + AgesR|fffd|v(2, 2) + AgesR|fffd|v(3, 2) + AgesR|fffd|v(4, 2)
ReDim VprR1(UBound(VectAge))

If AgesR|fffd|v(1, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(1, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    tabl = Tablesr|fffd|v(1, 2)
    AnNaissR = Tablesr|fffd|v(1, 1)
    VprR1 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
   
   
   If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
   axe = axe + (1 - VProbaAss(1)) * VprR1(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(1, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR1(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(1, 2) / DMT * Pro
   For i = 2 To UBound(VectAge)
    If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axe = axe + (1 - VProbaAss(i)) * VprR1(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(1, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR1(i - 1) - VprR1(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(1, 2) / DMT * Pro
   Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR1(j) = 0
    Next j
End If

ReDim VprR2(UBound(VectAge))

If AgesR|fffd|v(2, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(2, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    AnNaissR = Tablesr|fffd|v(2, 1)
    tabl = Tablesr|fffd|v(2, 2)
    VprR2 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
       
    
       
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axe = axe + (1 - VProbaAss(1)) * VprR2(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(2, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR2(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(2, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axe = axe + (1 - VProbaAss(i)) * VprR2(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(2, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR2(i - 1) - VprR2(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(2, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VAgeAss)
        VprR2(j) = 0
    Next j
End If

ReDim VprR3(UBound(VectAge))

If AgesR|fffd|v(3, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(3, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    AnNaissR = Tablesr|fffd|v(3, 1)
    tabl = Tablesr|fffd|v(3, 2)
    VprR3 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    
    
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axe = axe + (1 - VProbaAss(1)) * VprR3(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(3, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR3(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(3, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axe = axe + (1 - VProbaAss(i)) * VprR3(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(3, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR3(i - 1) - VprR3(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(3, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR3(j) = 0
    Next j
End If

ReDim VprR4(UBound(VectAge))

If AgesR|fffd|v(4, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(4, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = Round(VAgeAss(j) - EcartsAges, 3)
    Next j
    AnNaissR = Tablesr|fffd|v(4, 1)
    tabl = Tablesr|fffd|v(4, 2)
    VprR4 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    
    'a = 1
    '    If AgesR|fffd|v(4, 1) <= AgeMinRev|fffd| Then
    '        While VectAge(a) < AgeMinRev2 And a <= UBound(VectAge)
    '            VprR4(a) = 0
    '            a = a + 1
    '        Wend
    '    End If
        
   ' axe = axe + (1 - VProbaAss(1)) * VprR4(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT '+ (1 - VProbaAss(1)) * (1 - VprR4(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * Pro
   ' For i = 2 To UBound(VectAge)
   '     axe = axe + (1 - VProbaAss(i)) * VprR4(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT + (1 - VProbaAss(i - 1)) * (VprR4(i - 1) - VprR4(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * Pro
   ' Next i
    
Else
    For j = 1 To UBound(VectAge)
        VprR4(j) = 0
    Next j
End If


ReDim VPr(UBound(VectAge))
For i = 1 To UBound(VectAge)
VPr(i) = 1 - (1 - VprR1(i)) * (1 - VprR2(i)) * (1 - VprR3(i)) * (1 - VprR4(i))
Next i
For i = 2 To UBound(VectAge)
    axe = axe + (1 - VPr(i)) * (VProbaAss(i - 1) - VProbaAss(i)) * VectFlux(i) * VectActu(i) * Pro * (1 - R|fffd|ver)
Next i

End If
axe = axe * (1 + Frais)

End Function

Function axed(DateNaiss As Date, DateEffet As Date, DateCalcul As Date, Table As String, TxReval As Double, TxTech As Variant, TxTechLg As Double, DurCrt As Double, Frac As Integer, Terme As String, Frais As Double, Optional DateFin As Date = 0, Optional AG As Double = 0, Optional TabTauxCroiss As Variant = 0, Optional TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Nul", Optional ContrAssurance As String = "Non", Optional Approx As String = "Age exact", Optional TauxR|fffd|v As Double = 0, Optional TableR|fffd|v As Variant = 0, Optional DNaissR|fffd|v As Variant = 0, Optional TxArr As Double = 0, Optional TxRegr As Double = 0)
' ~|fffd|quivalent |fffd| annuit|fffd|X1

If DateNaiss = 0 Or DateEffet = 0 Or DateCalcul = 0 Then
axed = 0
Exit Function
End If

Dim AgeCalcul As Double
Dim AgeEffet As Double

Dim AnNaiss As Integer
Dim TableR|fffd|v2 As Variant
Dim AgeFin As Double


If taille(TabTauxCroiss) = 0 Or (taille(TabTauxCroiss) <> 1 And taille(TabTauxCroiss) <> 4) Then
    MsgBox "le format des donn|fffd|es pour la croissance par palier n'est pas compatible"
    Exit Function
End If
    
If taille(TabTauxCroiss) = 1 Then
    CroissPalier(1, 1) = 70
    CroissPalier(1, 2) = TabTauxCroiss
    CroissPalier(2, 1) = 75
    CroissPalier(2, 2) = TabTauxCroiss
    CroissPalier(3, 1) = 0
    CroissPalier(3, 2) = 0
    CroissPalier(4, 1) = 0
    CroissPalier(4, 2) = 0
Else
    For i = 1 To 4
    For j = 1 To 2
    CroissPalier(i, j) = TabTauxCroiss(i, j)
    Next j
    Next i
End If
    
If taille(TxTech) = 0 Or (taille(TxTech) <> 1 And taille(TxTech) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le taux technique n'est pas compatible"
    Exit Function
End If
    
If taille(TxTech) > 1 Then
    For i = 1 To 4
    For j = 1 To 2
    TauxTech(i, j) = TxTech(i, j)
    Next j
    Next i
Else
    TauxTech(1, 1) = 0
    TauxTech(1, 2) = TxTech
    TauxTech(2, 1) = DurCrt
    TauxTech(2, 2) = TxTechLg
    TauxTech(3, 1) = 0
    TauxTech(3, 2) = TxTechLg
    TauxTech(4, 1) = 0
    TauxTech(4, 2) = TxTechLg
End If
    
If taille(DNaissR|fffd|v) = 0 Or (taille(DNaissR|fffd|v) <> 1 And taille(DNaissR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
End If

Dim DNaiss2 As Date
If taille(DNaissR|fffd|v) = 1 Then
    DNaiss2 = DNaissR|fffd|v
    AgesR|fffd|v(1, 1) = nbann|fffd|es2(DNaiss2, DateCalcul) 'ApAge(DNaiss2, DateCalcul, Precision)
    AgesR|fffd|v(1, 2) = 1
    AgesR|fffd|v(2, 1) = 0
    AgesR|fffd|v(2, 2) = 0
    AgesR|fffd|v(3, 1) = 0
    AgesR|fffd|v(3, 2) = 0
    AgesR|fffd|v(4, 1) = 0
    AgesR|fffd|v(4, 2) = 0
Else
    For i = 1 To 4
    DNaiss2 = DNaissR|fffd|v(i, 1)
    AgesR|fffd|v(i, 1) = nbann|fffd|es2(DNaiss2, DateCalcul)
    AgesR|fffd|v(i, 2) = DNaissR|fffd|v(i, 2)
    Next i
End If

If taille(TableR|fffd|v) = 0 Or (taille(TableR|fffd|v) <> 1 And taille(TableR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
End If
If taille(TableR|fffd|v) = 1 Then
    TablRev(1, 1) = Year(DNaissR|fffd|v)
    TablRev(1, 2) = TableR|fffd|v
    TablRev(2, 1) = 0
    TablRev(2, 2) = 0
    TablRev(3, 1) = 0
    TablRev(3, 2) = 0
    TablRev(4, 1) = 0
    TablRev(4, 2) = 0
Else
    For i = 1 To 4
    If TableR|fffd|v(i, 1) <> 0 Then
    TablRev(i, 1) = Year(TableR|fffd|v(i, 1))
    TablRev(i, 2) = TableR|fffd|v(i, 2)
    End If
    Next i
End If

DateNaiss = Approximage2(DateNaiss, DateCalcul, Approx)



AgeCalcul = nbann|fffd|es2(DateNaiss, DateCalcul)
AgeEffet = nbann|fffd|es2(DateNaiss, DateEffet)
AnNaiss = Year(DateNaiss)

If DateFin = 0 Then
AgeFin = 0
Else
AgeFin = nbann|fffd|es2(DateNaiss, DateFin)
End If

axed = axe(AgeCalcul, AgeEffet, AnNaiss, Table, TxReval, TxTech, TxTechLg, DurCrt, Frac, Terme, Frais, AgeFin, AG, CroissPalier, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance, Approx, TauxR|fffd|v, AgesR|fffd|v, TablRev, 0.1, TxArr, TxRegr)
'  R|fffd|gle:AnNaiss=0.1 car les tableaux ont d|fffd|j|fffd| |fffd|t|fffd| modifi|fffd|s par axed

End Function




Function axe2(AgeCalcul As Double, AnNaiss As Integer, AgeR|fffd|v As Variant, AnNaissR|fffd|v As Double, AgeEffet As Double, Table As String, TableR|fffd|v As Variant, TauxR|fffd|v As Double, AgeMinRev As Double, TxReval As Double, TxTech As Variant, TxTechLg As Double, DurCrt As Double, Frac As Integer, Terme As String, Frais As Double, Optional AgeFin As Double = 0, Optional AG As Double = 0, Optional TabTauxCroiss As Variant = 0, Optional TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, Optional ProrataD|fffd|c|fffd|s As String = "Nul", Optional ContrAssurance As String = "Non", Optional Approx As String = "Age exact", Optional TxArr As Double = 0, Optional TxRegr As Double = 0)
'Fonction qui calcul l'ax.
' ~|fffd|quivalent |fffd| sannuit|fffd|X2
'-> Choix de plusieurs taux techniques, ac les dates associ|fffd|es.
'-> Choix de plusieurs taux de croissance, ac les |fffd|ges associ|fffd|s.
'-> Choix de plusieurs r|fffd|versataires, ac les tables associ|fffd|es. Hypoth|fffd|se chaque r|fffd|versataire touche une part de la rente proportionnelle |fffd| la dur|fffd|e de mariage
If AgeCalcul = 0 Or AgeEffet = 0 Or AnNaiss = 0 Then
axe2 = 0
Exit Function
End If

Dim VprR As Variant
Dim i As Integer
Dim j As Integer
Dim EcartsAges As Double
Dim VAgeAss As Variant
Dim tabl As String
Dim VprR1() As Double
Dim VprR2() As Double
Dim VprR3() As Double
Dim VprR4() As Double
Dim R|fffd|ver As Double
Dim DMT As Double
Dim VProbaAss As Variant
Dim AnNaissR As Integer

'--------Deux formats possibles pour certaines variables: tableau 4x2 ou variable unique
If AnNaissR|fffd|v <> 0.1 Then  ' Si AnNaiss=0.1 c'est que les tableaux ont d|fffd|j|fffd| |fffd|t|fffd| modifi|fffd|s par axe2d

    If taille(TabTauxCroiss) = 0 Or (taille(TabTauxCroiss) <> 1 And taille(TabTauxCroiss) <> 4) Then
    MsgBox "le format des donn|fffd|es pour la croissance par palier n'est pas compatible"
    Exit Function
    End If
    
    If taille(TabTauxCroiss) = 1 Then
        CroissPalier(1, 1) = 70
        CroissPalier(1, 2) = TabTauxCroiss
        CroissPalier(2, 1) = 75
        CroissPalier(2, 2) = TabTauxCroiss
        CroissPalier(3, 1) = 0
        CroissPalier(3, 2) = 0
        CroissPalier(4, 1) = 0
        CroissPalier(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    CroissPalier(i, j) = TabTauxCroiss(i, j)
    Next j
    Next i
    End If
    
    If taille(TxTech) = 0 Or (taille(TxTech) <> 1 And taille(TxTech) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le taux technique n'est pas compatible"
    Exit Function
    End If
    
    If taille(TxTech) > 1 Then
    For i = 1 To 4
    For j = 1 To 2
    TauxTech(i, j) = TxTech(i, j)
    Next j
    Next i
    Else
        TauxTech(1, 1) = 0
        TauxTech(1, 2) = TxTech
        TauxTech(2, 1) = DurCrt
        TauxTech(2, 2) = TxTechLg
        TauxTech(3, 1) = 0
        TauxTech(3, 2) = TxTechLg
        TauxTech(4, 1) = 0
        TauxTech(4, 2) = TxTechLg
    End If
    
    If taille(AgeR|fffd|v) = 0 Or (taille(AgeR|fffd|v) <> 1 And taille(AgeR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
    End If
    If taille(AgeR|fffd|v) = 1 Then
    AgesR|fffd|v(1, 1) = AgeR|fffd|v
    AgesR|fffd|v(1, 2) = 1
    AgesR|fffd|v(2, 1) = 0
    AgesR|fffd|v(2, 2) = 0
    AgesR|fffd|v(3, 1) = 0
    AgesR|fffd|v(3, 2) = 0
    AgesR|fffd|v(4, 1) = 0
    AgesR|fffd|v(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    AgesR|fffd|v(i, j) = AgeR|fffd|v(i, j)
    Next j
    Next i
    End If


    If taille(TableR|fffd|v) = 0 Or (taille(TableR|fffd|v) <> 1 And taille(TableR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
    End If
    If taille(TableR|fffd|v) = 1 Then
    Tablesr|fffd|v(1, 1) = AnNaissR|fffd|v
    Tablesr|fffd|v(1, 2) = TableR|fffd|v
    Tablesr|fffd|v(2, 1) = 0
    Tablesr|fffd|v(2, 2) = 0
    Tablesr|fffd|v(3, 1) = 0
    Tablesr|fffd|v(3, 2) = 0
    Tablesr|fffd|v(4, 1) = 0
    Tablesr|fffd|v(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    Tablesr|fffd|v(i, j) = TableR|fffd|v(i, j)
    Next j
    Next i
    End If
Else
    For i = 1 To 4
    For j = 1 To 2
    Tablesr|fffd|v(i, j) = TableR|fffd|v(i, j)
    Next j
    Next i
End If

'----------------------Fin des modifications de format

'------Approximation de l'|fffd|ge
Dim age As Double
age = AgeCalcul
AgeCalcul = Approximage3(AgeCalcul, Approx)
AgeEffet = AgeEffet + AgeCalcul - age

If TauxR|fffd|v <> 0 Then R|fffd|ver = 0 Else R|fffd|ver = 1

Dim Pro As Double

Pro = 0

If ProrataD|fffd|c|fffd|s = "Complet" And UCase(Terme) = "ECHU" Then Pro = 1
If ProrataD|fffd|c|fffd|s = "Prorata" And UCase(Terme) = "ECHU" Then Pro = 0.5 'Hyp d|fffd|c|fffd|s en milieu d'ann|fffd|e.

axe2 = 0

'------Vecteurs g|fffd|n|fffd|raux & concernant l'assur|fffd|
VectAge = VAge(AgeCalcul, AgeEffet, Frac, AgeFin, AgesR|fffd|v)
VectActu = VActu(TauxTech, AgeCalcul, AgeEffet)
VectProba = VProba(Terme, AnNaiss, Table, AgeCalcul, AgeEffet, AG)
VectFlux = VFlux(Terme, AgeCalcul, AgeEffet, Frac, CroissPalier, TxFraisDiff, AgeFinDiff)


'------Option Croissance annuelle
If TxRegr <> 0 Then
    Dim T As Double
    Dim k As Integer
    Dim Dep As Integer
    T = VectAge(0)
    k = -1
    Dep = 0
    If Terme = "Echu" Then Dep = -1
    
    For i = 1 To UBound(VectAge)
    If VectAge(i + Dep) - T >= 1 Then
        T = VectAge(i + Dep)
        k = k + 1
    End If
    VectFlux(i) = VectFlux(i) * (1 + TxRegr) ^ k
    Next i
End If

'------Calcul des arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s
axe2 = axe2 + Arreragesmajdc(TxArr, Terme, Frac)

'------Annuit|fffd| sans r|fffd|version
axe2 = axe2 + VectActu(1) * VectProba(1) * VectFlux(1) + (1 - VectProba(1)) * VectFlux(1) * VectActu(1) * R|fffd|ver * Pro  ' *R|fffd|ver car s'il existe un r|fffd|versataire, la rente lui sera vers|fffd|e donc on ne tient pas compte du prorata

For i = 2 To UBound(VectAge)
    axe2 = axe2 + VectActu(i) * VectProba(i) * VectFlux(i) + (VectProba(i - 1) - VectProba(i)) * VectFlux(i) * VectActu(i) * R|fffd|ver * Pro
 
Next i



'------Ajout de la r|fffd|version, possibilit|fffd| d'avoir jusqu'|fffd| 4 r|fffd|versataires

ReDim VProbaAss(UBound(VectAge))
VProbaAss = VectProba
VAgeAss = VectAge
Dim MiniRev As Integer

If TauxR|fffd|v <> 0 Then
DMT = AgesR|fffd|v(1, 2) + AgesR|fffd|v(2, 2) + AgesR|fffd|v(3, 2) + AgesR|fffd|v(4, 2)
ReDim VprR1(UBound(VectAge))

If AgesR|fffd|v(1, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(1, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    tabl = Tablesr|fffd|v(1, 2)
    AnNaissR = Tablesr|fffd|v(1, 1)
    VprR1 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    
   If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
   axe2 = axe2 + (1 - VProbaAss(1)) * VprR1(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(1, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR1(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(1, 2) / DMT * Pro
   For i = 2 To UBound(VectAge)
   If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axe2 = axe2 + (1 - VProbaAss(i)) * VprR1(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(1, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR1(i - 1) - VprR1(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(1, 2) / DMT * Pro
   Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR1(j) = 0
    Next j
End If

ReDim VprR2(UBound(VectAge))

If AgesR|fffd|v(2, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(2, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    AnNaissR = Tablesr|fffd|v(2, 1)
    tabl = Tablesr|fffd|v(2, 2)
    VprR2 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1

       
    axe2 = axe2 + (1 - VProbaAss(1)) * VprR2(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(2, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR2(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(2, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axe2 = axe2 + (1 - VProbaAss(i)) * VprR2(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(2, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR2(i - 1) - VprR2(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(2, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VAgeAss)
        VprR2(j) = 0
    Next j
End If

ReDim VprR3(UBound(VectAge))

If AgesR|fffd|v(3, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(3, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    AnNaissR = Tablesr|fffd|v(3, 1)
    tabl = Tablesr|fffd|v(3, 2)
    VprR3 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    
    axe2 = axe2 + (1 - VProbaAss(1)) * VprR3(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(3, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR3(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(3, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axe2 = axe2 + (1 - VProbaAss(i)) * VprR3(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(3, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR3(i - 1) - VprR3(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(3, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR3(j) = 0
    Next j
End If

ReDim VprR4(UBound(VectAge))

If AgesR|fffd|v(4, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(4, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    AnNaissR = Tablesr|fffd|v(4, 1)
    tabl = Tablesr|fffd|v(4, 2)
    VprR4 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    
    axe2 = axe2 + (1 - VProbaAss(1)) * VprR4(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * MiniRev '+ (1 - VProbaAss(1)) * (1 - VprR4(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axe2 = axe2 + (1 - VProbaAss(i)) * VprR4(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * MiniRev + MiniRev * (1 - VProbaAss(i - 1)) * (VprR4(i - 1) - VprR4(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * Pro
    Next i
    
Else
    For j = 1 To UBound(VectAge)
        VprR4(j) = 0
    Next j
End If


ReDim VPr(UBound(VectAge))
For i = 1 To UBound(VectAge)
VPr(i) = 1 - (1 - VprR1(i)) * (1 - VprR2(i)) * (1 - VprR3(i)) * (1 - VprR4(i))
Next i
For i = 2 To UBound(VectAge)
    axe2 = axe2 + (1 - VPr(i)) * (VProbaAss(i - 1) - VProbaAss(i)) * VectFlux(i) * VectActu(i) * Pro * (1 - R|fffd|ver)
Next i

End If
axe2 = axe2 * (1 + Frais)

End Function

Function annuit|fffd|X2(ByVal DateNaissX As Date, ByVal DateNaissY As Date, ByVal DateDebRente As Date, ByVal DateCalcul As Date, _
TableX As String, TableY As String, ByVal Txrev As Double, ByVal DateMinRev As Date, ByVal TxReval As Double, _
ByVal TxTechCrt As Double, ByVal TxTechLg As Double, ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, ByVal TxFraisRente As Double, _
Optional ByVal DateTerme As Date = 0, Optional ByVal DateFinGar As Date = 0, Optional ByVal TxCroissRte70_75 As Double = 0, Optional ByVal TxFraisDiff As Double = 0, _
Optional ByVal DateFinDiff As Date = 0, Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional ByVal FracApproximAge As Integer, _
Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional OptionPM_CC As String = "PM") As Double
Dim AG As Double, AgeFinDiff As Double, DateminRevDouble As Double
AG = nbann|fffd|es2(DateDebRente, DateFinGar)
AgeFinDiff = nbann|fffd|es2(DateNaissX, DateFinDiff)
DateminRevDouble = CDbl(DateMinRev)
annuit|fffd|X2 = annuit|fffd|X1(DateNaissX, DateDebRente, DateCalcul, TableX, TxReval, TxTechCrt, TxTechLg, DurCrt, Frac, Terme, TxFraisRente, DateTerme, _
AG, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, ProrataD|fffd|c|fffd|s, ContrAssurance, , DateminRevDouble, Txrev, TableY, DateNaissY, TxArr, TxRegr, OptionPM_CC)
End Function

Function annuit|fffd|X1(DateNaiss As Date, DateEffet As Date, DateCalcul As Date, _
    Table As String, TxReval As Double, TxTech As Variant, TxTechLg As Double, _
    DurCrt As Double, Frac As Integer, Terme As String, Frais As Double, _
    Optional DateFin As Date = 0, Optional AG As Double = 0, Optional TabTauxCroiss As Variant = 0, _
    Optional TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Nul", Optional ContrAssurance As String = "Non", _
    Optional Approx As String = "Age exact", Optional DateMinRev As Double = 0, Optional TauxR|fffd|v As Double = 0, Optional TableR|fffd|v As Variant = 0, _
    Optional DNaissR|fffd|v As Variant = 0, Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional ByVal OptionPM_CC As String = "PM") As Double
'Ajout|fffd| AgeMinR|fffd|v
' ~|fffd|quivalent |fffd| axed mais calcul par ann|fffd|e civile et pas de passage par un calcul par |fffd|ge. Fractionnement + prorata d|fffd|but et fin.

If DateNaiss = 0 Or DateEffet = 0 Or DateCalcul = 0 Then
annuit|fffd|X1 = 0
Exit Function
End If

Dim AgeCalcul As Double
Dim AgeEffet As Double
Dim a As Boolean
a = True
Dim AnNaiss As Integer
Dim TableR|fffd|v2 As Variant
Dim AgeFin As Double
Dim veille As Integer

'Ajout 20/12/12
Dim AgeFinReel As Double
'-Fin

Select Case UCase(Terme)
Case "ECHU LA VEILLE": veille = 2
Case "ECHU": veille = 1
Case Else: veille = 0
End Select

If taille(TabTauxCroiss) = 0 Or (taille(TabTauxCroiss) <> 1 And taille(TabTauxCroiss) <> 4) Then
    MsgBox "le format des donn|fffd|es pour la croissance par palier n'est pas compatible"
    Exit Function
End If

If taille(TabTauxCroiss) = 1 Then
    CroissPalier(1, 1) = 70
    CroissPalier(1, 2) = TabTauxCroiss
    CroissPalier(2, 1) = 75
    CroissPalier(2, 2) = TabTauxCroiss
    CroissPalier(3, 1) = 0
    CroissPalier(3, 2) = 0
    CroissPalier(4, 1) = 0
    CroissPalier(4, 2) = 0
Else
    For i = 1 To 4
    For j = 1 To 2
    CroissPalier(i, j) = TabTauxCroiss(i, j)
    Next j
    Next i
End If

If taille(TxTech) = 0 Or (taille(TxTech) <> 1 And taille(TxTech) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le taux technique n'est pas compatible"
    Exit Function
End If

If taille(TxTech) > 1 Then
    For i = 1 To 4
    For j = 1 To 2
    TauxTech(i, j) = TxTech(i, j)
    Next j
    Next i
Else
    TauxTech(1, 1) = 0
    TauxTech(1, 2) = TxTech
    TauxTech(2, 1) = DurCrt
    TauxTech(2, 2) = TxTechLg
    TauxTech(3, 1) = 0
    TauxTech(3, 2) = TxTechLg
    TauxTech(4, 1) = 0
    TauxTech(4, 2) = TxTechLg
End If

If taille(DNaissR|fffd|v) = 0 Or (taille(DNaissR|fffd|v) <> 1 And taille(DNaissR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
End If

Dim DNaiss2 As Date
If taille(DNaissR|fffd|v) = 1 Then
    DNaiss2 = DNaissR|fffd|v
    AgesR|fffd|v(1, 1) = nbann|fffd|es2(DNaiss2, DateCalcul)
    AgesR|fffd|v(1, 2) = 1
    AgesR|fffd|v(2, 1) = 0
    AgesR|fffd|v(2, 2) = 0
    AgesR|fffd|v(3, 1) = 0
    AgesR|fffd|v(3, 2) = 0
    AgesR|fffd|v(4, 1) = 0
    AgesR|fffd|v(4, 2) = 0
Else
    For i = 1 To 4
    DNaiss2 = DNaissR|fffd|v(i, 1)
    AgesR|fffd|v(i, 1) = nbann|fffd|es2(DNaiss2, DateCalcul)
    AgesR|fffd|v(i, 2) = DNaissR|fffd|v(i, 2)
    Next i
End If

If taille(TableR|fffd|v) = 0 Or (taille(TableR|fffd|v) <> 1 And taille(TableR|fffd|v) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    Exit Function
End If
If taille(TableR|fffd|v) = 1 Then
    TablRev(1, 1) = Year(DNaissR|fffd|v)
    TablRev(1, 2) = TableR|fffd|v
    TablRev(2, 1) = 0
    TablRev(2, 2) = 0
    TablRev(3, 1) = 0
    TablRev(3, 2) = 0
    TablRev(4, 1) = 0
    TablRev(4, 2) = 0
Else
    For i = 1 To 4
    If TableR|fffd|v(i, 1) <> 0 Then
    TablRev(i, 1) = Year(TableR|fffd|v(i, 1))
    TablRev(i, 2) = TableR|fffd|v(i, 2)
    End If
    Next i
End If

DateNaiss = Approximage2(DateNaiss, DateCalcul, Approx)

'Prise en compte option PM/CC
If OptionPM_CC = "CC" Then DateCalcul = DateCalcul + 1


AgeCalcul = nbann|fffd|es2(DateNaiss, DateCalcul)
AgeEffet = nbann|fffd|es2(DateNaiss, DateEffet)
AnNaiss = Year(DateNaiss)

'Ajout 20/12/12
'En Age (nb r|fffd|el) pas en date
If DateFin <> 0 Then
  AgeFinReel = nbann|fffd|es2(DateNaiss, DateFin)
Else
  AgeFinReel = 121 + nbann|fffd|es2(DateNaiss, DNaissR|fffd|v)
End If
'-Fin



If DateFin = 0 Then
AgeFin = 121
DateFin = AnPlus(DateNaiss, 121)
Else
AgeFin = nbann|fffd|es2(DateNaiss, DateFin)
End If



'Fonction qui calcule l'ax.

Dim axe As Double
If AgeCalcul = 0 Or AgeEffet = 0 Or AnNaiss = 0 Then
annuit|fffd|X1 = 0
Exit Function
End If

Dim VPr As Variant

Dim EcartsAges As Double
Dim VAgeAss As Variant
Dim tabl As String
Dim VProbaAss As Variant
Dim AnNaissR As Integer



axe = 0

'------Vecteurs g|fffd|n|fffd|raux & concernant l'assur|fffd|
'VectDate
ReDim VectDate(1)
VectDate(1) = DateEffet

If nbann|fffd|es2(DateNaiss, VectDate(1)) < AgeFin Then 'Ajout le 20/12/12
    ReDim Preserve VectDate(2)
    VectDate(2) = FinFrac(DateEffet, Frac)
    If VectDate(2) = VectDate(1) Then
        VectDate(2) = FracPlus(VectDate(2), 1, Frac)
        If UCase(Terme) = "AVANCE" Then VectDate(2) = VectDate(2) + 1
        If UCase(Terme) <> "AVANCE" Then VectDate(2) = VectDate(2) - veille + 1
    Else
        If UCase(Terme) = "AVANCE" Then VectDate(2) = VectDate(2) + 1
        If UCase(Terme) <> "AVANCE" Then VectDate(2) = VectDate(2) - veille + 1
    End If

    i = 2
    While nbann|fffd|es2(DateNaiss, VectDate(i) + veille) < AgeFinReel 'DateFin
    i = i + 1
    ReDim Preserve VectDate(i)
    VectDate(i) = FracPlus(VectDate(i - 1), 1, Frac)
    Wend
End If
If AgeFin <> 121 Then
  If UCase(Terme) = "AVANCE" And DateFin = FinFrac(DateFin, Frac) Then DateFin = DateFin + 1
    VectDate(i) = DateFin
  If AgeFin < AgeEffet Then GoTo fin
End If

'fin VectDate

'VectAge modif 30/11/11
ReDim VectAge(UBound(VectDate))
'For i = 1 To UBound(VectAge)
'VectAge(i) = Round(NbAnn|fffd|es2(DateNaiss, VectDate(i)), 3)
'If VectAge(i) > AgeCalcul And Not a Then VectAge(i) = VectAge(i - 1) + Round(NbAnn|fffd|es2(VectDate(i - 1), VectDate(i)), 3)
'If VectAge(i) > AgeCalcul And a Then
'  VectAge(i) = AgeCalcul + Round(NbAnn|fffd|es2(DateCalcul, VectDate(i)), 3)
'  a = False
'End If
'Next i

For i = 1 To UBound(VectAge)
VectAge(i) = Round(nbann|fffd|es2(DateNaiss, VectDate(i)), 3)
Next i

'fin VectAge

VectActu = VActu(TauxTech, AgeCalcul, AgeEffet)

'AG = nbann|fffd|es2(DateEffet, AG)
VectProba = VProba(Terme, AnNaiss, Table, AgeCalcul, AgeEffet, AG)

'VectFlux
ReDim VectFlux(UBound(VectDate))
Dim FracAtteint As String
Select Case Frac
Case 1: FracAtteint = "Ann|fffd|e atteinte"
Case 2: FracAtteint = "Semestre atteint"
Case 4: FracAtteint = "Trimestre atteint"
Case 12: FracAtteint = "Mois atteint"
End Select

Select Case UCase(Terme)
Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
        If VectDate(1) <> FinFrac(VectDate(1), Frac) And VectDate(1) - 1 <> FinFrac(VectDate(1) - 1, Frac) Then
        VectFlux(1) = nbann|fffd|es2(DateEffet, FinFrac(DateEffet, Frac), 6)
        Else
        VectFlux(1) = 1 / Frac
        End If
        If UBound(VectDate) > 1 Then VectFlux(2) = 1 / Frac
Case Else
        VectFlux(1) = 0
        If UBound(VectDate) > 1 Then
        If VectDate(1) <> FinFrac(VectDate(1), Frac) And VectDate(1) - 1 <> FinFrac(VectDate(1) - 1, Frac) Then
        VectFlux(2) = nbann|fffd|es2(DateEffet, FinFrac(DateEffet, Frac) + 1, 6)
        Else
        VectFlux(2) = 1 / Frac
        End If
        End If
End Select

If UBound(VectDate) > 2 Then
For i = 3 To UBound(VectDate)
If nbann|fffd|es2(DateNaiss, VectDate(i) + veille) <= AgeFinReel Then 'Ajout  le 20/12/12 DateFin Then '
    VectFlux(i) = 1 / Frac
Else
VectFlux(i) = 0
End If
Next i
End If

If AgeFin <> 121 Then
Select Case UCase(Terme)
Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"

        VectFlux(UBound(VectDate)) = 0
        VectFlux(UBound(VectDate) - 1) = nbann|fffd|es2(VectDate(UBound(VectDate) - 1), VectDate(UBound(VectDate)))
Case Else
        VectFlux(UBound(VectDate)) = nbann|fffd|es2(VectDate(UBound(VectDate) - 1), VectDate(UBound(VectDate)))
End Select
End If

'Ajout le 15/12/2011
'Tenir compte le taux frais diff
Dim X As Integer
X = 2
'TxFraisDiff = wD|fffd|tailDate.Range("FraisDiff").Value
AgeFinDiff = nbann|fffd|es2(DateNaiss, AgeFinDiff)
If TxFraisDiff <> 0 And AgeFinDiff >= AgeCalcul Then
        VectFlux(1) = VectFlux(1) * (1 + TxFraisDiff) ^ (AgeFinDiff - AgeCalcul)
        While VectDate(X) <= AgeFinDiff And X <= UBound(VectFlux)
            VectFlux(X) = VectFlux(X) * (1 + TxFraisDiff) ^ (AgeFinDiff - VectDate(X))
            X = X + 1
        Wend
End If
'-Fin

'Application des croissances par palier:
VectAge(0) = 0
For i = 1 To UBound(VectAge)
    Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
        For j = 1 To 4 'UBound(Croiss_palier, 1)
            If VectAge(i) >= CroissPalier(j, 1) Then VectFlux(i) = VectFlux(i) * (1 + CroissPalier(j, 2))
            If i = UBound(VectAge) Then VectFlux(i) = 0
        Next j
    Case Else
        For j = 1 To 4 'UBound(Croiss_palier, 1)
            If nbann|fffd|es2(DateNaiss, VectDate(i - 1) + veille) >= CroissPalier(j, 1) Then VectFlux(i) = VectFlux(i) * (1 + CroissPalier(j, 2))
        Next j
    End Select
Next i

'Tenir compte le taux frais diff
'Dim x As Integer
'x = 2
'If TxFraisDiff <> 0 And AgeFinDiff >= AgeCalcul Then
'        VectFlux(1) = VectFlux(1) * (1 + TxFraisDiff) ^ NbAnn|fffd|es2(AgeFinDiff, AgeCalcul)
'        While VectAge(x) <= AgeFinDiff
'            VectFlux(x) = VectFlux(x) * (1 + TxFraisDiff) ^ NbAnn|fffd|es2(AgeFinDiff, VectAge(x))
'            x = x + 1
'        Wend
'End If

'fin VectFlux

'------Option Croissance annuelle
If TxRegr <> 0 Then
    Dim k As Integer
    Dim Dep As Integer
    VectAge(0) = Round(AgeEffet, 6)
    Dep = 0
    If UCase(Terme) <> "AVANCE" Then Dep = -1

    For i = 1 To UBound(VectAge)
    k = Int(nbann|fffd|es2(VectDate(1), VectDate(i + det) + veille))
    VectFlux(i) = VectFlux(i) * (1 + TxRegr) ^ k
    Next i
End If

'------Calcul des arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s
axe = axe + Arreragesmajdc(TxArr, Terme, Frac)



'------Ajout de la r|fffd|version,

ReDim VProbaAss(UBound(VectAge))
VProbaAss = VectProba
VAgeAss = VectAge


ReDim VPr(UBound(VectAge))
Dim MiniRev As Integer

If AgesR|fffd|v(1, 1) <> 0 And TauxR|fffd|v <> 0 Then

    EcartsAges = AgeCalcul - AgesR|fffd|v(1, 1)

    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j

    tabl = TablRev(1, 2)
    AnNaissR = TablRev(1, 1)
    VPr = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)

    'Ajout 20/12/12
    i = 1
    While VectDate(i) < CDate(DateMinRev)
        VPr(i) = 0
        i = i + 1
    Wend
    '-fin
    'wD|fffd|tailDate.Range("T" & i + 6).Value = VPr(i)
Else
    For j = 1 To UBound(VectAge)
        VPr(j) = 0
    Next j
End If
i = UBound(VPr)

'Dim Pro As Double
Pro = 0
If (ProrataD|fffd|c|fffd|s = "Complet" Or ProrataD|fffd|c|fffd|s = "COMP") And UCase(Terme) <> "AVANCE" Then Pro = 1
If (ProrataD|fffd|c|fffd|s = "Prorata" Or ProrataD|fffd|c|fffd|s = "PROP") And UCase(Terme) <> "AVANCE" Then Pro = 0.5 * VectActu(1) ^ (1 / 2) 'Hyp d|fffd|c|fffd|s en milieu de p|fffd|riode.

'------Annuit|fffd|
'If CDate(VectDate(1)) < DateMinRev Then MiniRev = 0 Else MiniRev = 1
'* MiniRev
axe = axe + VectActu(1) * VProbaAss(1) * VectFlux(1) + (1 - VProbaAss(1)) * VectFlux(1) * VectActu(1) * VPr(1) * TauxR|fffd|v _
    + (1 - VProbaAss(1)) * VectFlux(1) * VectActu(1) * (1 - VPr(1)) * Pro

For i = 2 To UBound(VectAge)
If (ProrataD|fffd|c|fffd|s = "Prorata" Or ProrataD|fffd|c|fffd|s = "PROP") And UCase(Terme) <> "AVANCE" Then Pro = 0.5 * (VectActu(i - 1) / VectActu(i)) ^ (1 / 2) 'Hyp d|fffd|c|fffd|s en milieu de p|fffd|riode.
'If VectDate(i) < CDate(DateMinRev) Then MiniRev = 0 Else MiniRev = 1
'* MiniRev
'If VProbaAss(i) <> 0 Then
'axe = axe + VectActu(i) * VProbaAss(i) * VectFlux(i) + (1 - VProbaAss(i)) * VectFlux(i) * VectActu(i) * VPr(i) * TauxR|fffd|v _
'    + (VProbaAss(i - 1) - VProbaAss(i)) / VProbaAss(i) * VectFlux(i) * VectActu(i) * (1 - VPr(i)) * Pro + _
'    (VPr(i - 1) - VPr(i)) * VectFlux(i) * VectActu(i) * (1 - VProbaAss(i - 1)) / VProbaAss(i) * TauxR|fffd|v * Pro
'End If

axe = axe + VectActu(i) * VProbaAss(i) * VectFlux(i) + (1 - VProbaAss(i)) * VectFlux(i) * VectActu(i) * VPr(i) * TauxR|fffd|v _
    + (VProbaAss(i - 1) - VProbaAss(i)) * VectFlux(i) * VectActu(i) * (1 - VPr(i) * TauxR|fffd|v) * Pro + _
    (VPr(i - 1) - VPr(i)) * VectFlux(i) * VectActu(i) * (1 - VProbaAss(i - 1)) * TauxR|fffd|v * Pro
Next i



axe = axe * (1 + Frais)

annuit|fffd|X1 = axe
Exit Function
fin:
annuit|fffd|X1 = 0

End Function


Attribute VB_Name = "FonctionsDiverses"
Option Explicit

Function nbann|fffd|es2(ByVal DateDeb As Date, ByVal DateFin As Date, Optional Precision = 3) As Double
'-- Calcul du nombre d'ann|fffd|es entre deux dates (nombre r|fffd|el)
Dim d3, d4 As Date, temp As Double

'If Day(DateDeb) = 1 Then DateDeb = DateDeb - 1
d3 = FinMois(DateDeb)
d4 = DebMois(DateFin)

temp = Round((Day(d3) - Day(DateDeb) + 1) / Day(d3), Precision)
temp = temp + Round((Year(d4 - 1) - Year(d3)) * 12 + (Month(d4 - 1) - Month(d3)), Precision)
nbann|fffd|es2 = temp + Round((Day(DateFin) - Day(d4)) / Day(FinMois(DateFin)), Precision)
nbann|fffd|es2 = Maxi(Round(nbann|fffd|es2 / 12, Precision), 0)
'NbAnn|fffd|es2 = Year(d3) - 1900 + (Month(d3) - 1) / 12 + Day(d3) / Day(FinMois(DateFin)) / 12
'NbAnn|fffd|es2 = Maxi(Year(d4) - Year(d3) + (Month(d4) - Month(d3) - 1) / 12 + (Day(d3) - Day(DateDeb)) / 12 / Day(d3) + (Day(DateFin) - Day(d4) + 1) / 12 / Day(FinMois(DateFin)), 0)
'NbAnn|fffd|es2 = Round(NbAnn|fffd|es2, 3)
End Function

Function nbann|fffd|es(ByVal DateDeb As Date, ByVal DateFin As Date) As Double
'-- Calcul du nombre d'ann|fffd|es entre deux dates (nombre r|fffd|el)
'-- Rmq : les + 1 ci-dessous permettent d'obtenir 1 pour un
'--       calcul entre le 01/01 et le 31/12 comme entre le 01/01/nn et le 01/01/nn+1
If FinMois(DateDeb) = DateDeb Then DateDeb = DateDeb + 1
If FinMois(DateFin) = DateFin Then DateFin = DateFin + 1
nbann|fffd|es = Year(DateFin) - Year(DateDeb) + (Month(DateFin) - Month(DateDeb)) / 12 + (Day(DateFin) - Day(DateDeb)) / 365
nbann|fffd|es = Maxi(nbann|fffd|es, 0)
End Function


Function Maxi(X, Y) As Double
'-- Renvoi le maximum de 2 valeurs (variant)
If X >= Y Then
  Maxi = X
Else
  Maxi = Y
End If
End Function

Function Mini(X, Y) As Double
'-- Renvoi le minimum de 2 valeurs (variant)
If Y <= X Then
  Mini = Y
Else
  Mini = X
End If
End Function
Function FinFrac(d As Date, Frac As Integer) As Date
Select Case Frac
Case 1: FinFrac = FinAn(d)
Case 2: FinFrac = FinSem(d)
Case 4: FinFrac = FinTrim(d)
Case 12: FinFrac = FinMois(d)
End Select
End Function
Function FracPlus(d As Date, dur|fffd|e As Integer, Frac As Integer) As Date
Select Case Frac
Case 1: FracPlus = AnPlus(d, dur|fffd|e)
Case 2: FracPlus = MoisPlus(d, 6 * dur|fffd|e)
Case 4: FracPlus = MoisPlus(d, 3 * dur|fffd|e)
Case 12: FracPlus = MoisPlus(d, dur|fffd|e)
End Select
End Function

Function MoisPlus(ByVal d As Date, ByVal NbMois As Integer) As Date
'-- Incr|fffd|mente une date d'un nombre de mois donn|fffd|
'-- Rmq : le +1 puis -1 |fffd|vite permet de palier aux |fffd|carts de jour pour les fins de mois
MoisPlus = DateSerial(Year(d + 1), Month(d + 1) + NbMois, Day(d + 1)) - 1
End Function

Function AnPlus(ByVal d As Date, ByVal nbann|fffd|es As Integer) As Date
'-- Incr|fffd|mente une date d'un nombre d'ann|fffd|es donn|fffd|
AnPlus = DateSerial(Year(d + 1) + nbann|fffd|es, Month(d + 1), Day(d + 1)) - 1
End Function

Function AnProche(ByVal d As Date) As Date
Select Case Month(d)
Case Is <= 6: AnProche = DateSerial(Year(d) - 1, 12, 31)
Case Else:    AnProche = DateSerial(Year(d), 12, 31)
End Select
End Function

Function SemProche(ByVal d As Date) As Date
Select Case d
Case Is <= DateSerial(Year(d), 3, 31):  SemProche = DateSerial(Year(d) - 1, 12, 31)
Case Is <= DateSerial(Year(d), 9, 30):  SemProche = DateSerial(Year(d), 6, 30)
Case Else:                              SemProche = DateSerial(Year(d), 12, 31)
End Select
End Function

Function TrimProche(ByVal d As Date) As Date
Select Case d
Case Is <= DateSerial(Year(d), 2, 14):  TrimProche = DateSerial(Year(d) - 1, 12, 31)
Case Is <= DateSerial(Year(d), 5, 14):  TrimProche = DateSerial(Year(d), 3, 31)
Case Is <= DateSerial(Year(d), 8, 14):  TrimProche = DateSerial(Year(d), 6, 30)
Case Is <= DateSerial(Year(d), 11, 14): TrimProche = DateSerial(Year(d), 9, 30)
Case Else:                              TrimProche = DateSerial(Year(d), 12, 31)
End Select
End Function

Function MoisProche(ByVal d As Date) As Date
Select Case d
Case Is <= DateSerial(Year(d), 1, 14):  MoisProche = DateSerial(Year(d), 1, 1) - 1
Case Is <= DateSerial(Year(d), 2, 14):  MoisProche = DateSerial(Year(d), 2, 1) - 1
Case Is <= DateSerial(Year(d), 3, 14):  MoisProche = DateSerial(Year(d), 3, 1) - 1
Case Is <= DateSerial(Year(d), 4, 14):  MoisProche = DateSerial(Year(d), 4, 1) - 1
Case Is <= DateSerial(Year(d), 5, 14):  MoisProche = DateSerial(Year(d), 5, 1) - 1
Case Is <= DateSerial(Year(d), 6, 14):  MoisProche = DateSerial(Year(d), 6, 1) - 1
Case Is <= DateSerial(Year(d), 7, 14):  MoisProche = DateSerial(Year(d), 7, 1) - 1
Case Is <= DateSerial(Year(d), 8, 14):  MoisProche = DateSerial(Year(d), 8, 1) - 1
Case Is <= DateSerial(Year(d), 9, 14):  MoisProche = DateSerial(Year(d), 9, 1) - 1
Case Is <= DateSerial(Year(d), 10, 14): MoisProche = DateSerial(Year(d), 10, 1) - 1
Case Is <= DateSerial(Year(d), 11, 14): MoisProche = DateSerial(Year(d), 11, 1) - 1
Case Is <= DateSerial(Year(d), 12, 14): MoisProche = DateSerial(Year(d), 12, 1) - 1
Case Else:                              MoisProche = DateSerial(Year(d) + 1, 1, 1) - 1
End Select
End Function

Function FinMois(ByVal d As Date, Optional ByVal n As Date = 0) As Date
'-- Incr|fffd|mente une date d'un nombre de mois donn|fffd| et se place en fin de mois
FinMois = DateSerial(Year(d), Month(d) + n + 1, 1) - 1
End Function

Function DebMois(ByVal d As Date) As Date
'-- Donne la date de d|fffd|but de mois de la date demand|fffd|e
DebMois = DateSerial(Year(d), Month(d), 1)
End Function

Function FinTrim(ByVal d As Date) As Date
'-- Donne la date de trimestre correspodant |fffd| la date demand|fffd|e
FinTrim = DateSerial(Year(d), 3 * (Int((Month(d) - 1) / 3) + 1) + 1, 1) - 1
End Function

Function DebTrim(ByVal d As Date) As Date
'-- Donne la date de d|fffd|but de trimestre correspodant |fffd| la date demand|fffd|e
DebTrim = DateSerial(Year(d), 3 * (Int((Month(d) - 1) / 3)) + 1, 1)
End Function

Function FinSem(ByVal d As Date) As Date
'-- Donne la date de fin de semestre correspodant |fffd| la date demand|fffd|e
FinSem = DateSerial(Year(d), 6 * (Int((Month(d) - 1) / 6) + 1) + 1, 1) - 1
End Function

Function Fract(ByVal X As Double) As Double
'-- Enl|fffd|ve la partie enti|fffd|re d'un nombre r|fffd|el
Fract = X - Int(X)
End Function

Function FinAn(ByVal d As Date, Optional ByVal nbann|fffd|es As Integer) As Date
'-- Donne la date de fin d'ann|fffd|e correspondant |fffd| la date demand|fffd|e
FinAn = DateSerial(Year(d) + nbann|fffd|es, 12, 31)
End Function

Function AnDeb(ByVal d As Date) As Date
'-- Donne la date de d|fffd|but d'ann|fffd|e correspondant |fffd| la date demand|fffd|e
AnDeb = DateSerial(Year(d), 1, 1)
End Function

Function NbTrimPlein(ByVal d1 As Date, ByVal d2 As Date) As Integer
'-- Donne le nombre de trimestres entre deux dates
'-- Rmq : entre le 01/02 et le 31/10, le calcul retravaille les dates pour un calcul
'--       entre le 01/04 et le 30/09, ce qui donne 2 trimestres au lieu de 3 par un
'--       simple calcul de diff|fffd|rence de nombre de mois
Dim dd1 As Date, dd2 As Date
dd1 = FinTrim(d1 - 1)
dd2 = FinTrim(d2 + 1)
dd2 = DateSerial(Year(dd2 + 1), Month(dd2 + 1) - 3, 1) - 1
NbTrimPlein = (Month(dd2) - Month(dd1)) / 3 + (Year(dd2) - Year(dd1)) * 4
NbTrimPlein = Maxi(NbTrimPlein, 0)
End Function

Function NbMoisPlein(ByVal d1 As Date, ByVal d2 As Date) As Integer
'-- Donne le nombre de mois entre deux dates
'-- Rmq : entre le 10/02 et le 17/04, le calcul retravaille les dates pour un calcul
'--       entre le 01/03 et le 01/04, ce qui donne 1 mois au lieu de 2 par un
'--       simple calcul de diff|fffd|rence de nombre de jours
Dim dd1 As Date, dd2 As Date
dd1 = FinMois(d1 - 1, 0)
dd2 = FinMois(d2 + 1, -1)
NbMoisPlein = (Month(dd2) - Month(dd1)) + (Year(dd2) - Year(dd1)) * 12
NbMoisPlein = Maxi(NbMoisPlein, 0)
End Function

Function Si(ByVal Cond As Boolean, ByVal ValTrue As Variant, ByVal ValFalse As Variant)
'-- Fonction analogue |fffd| celle d'Excel, mais qui permet une utilisation
'-- de la condition sur une seule ligne
Select Case Cond
Case True:  Si = ValTrue
Case False: Si = ValFalse
End Select
End Function

Function V|fffd|rifFinTrim(ByVal d As Date) As Boolean
'-- Indique si la date correspond |fffd| la fin d'un trimestre civil
If Day(d + 1) <> 1 Or (Month(d + 1) - 1) Mod 3 <> 0 Then
  V|fffd|rifFinTrim = False
Else
  V|fffd|rifFinTrim = True
End If
End Function

Function V|fffd|rifFinMois(ByVal d As Date) As Boolean
'-- Indique si la date est une fin de mois
V|fffd|rifFinMois = (Day(d + 1) = 1)
End Function

Function V|fffd|rifFinAn(ByVal d As Date) As Boolean
'-- Indique si la date est une fin de mois
V|fffd|rifFinAn = (Day(d + 1) = 1) And (Month(d + 1) = 1)
End Function

Function ArrondiEntSup(ByVal r As Double) As Integer
'Arrondi un r|fffd|el |fffd| sa valeur sup|fffd|rieur (2=>2 ; 2.1 => 3;  -2 => -2 ; -2.9 => -2)
Select Case Fract(r)
Case 0: ArrondiEntSup = Int(r)
Case Else
  Select Case r
  Case Is < 0: ArrondiEntSup = -Int(-r)
  Case Is > 0: ArrondiEntSup = Int(r) + 1
  End Select
End Select
End Function

Function ArrondiEntProche(ByVal r As Double, ByVal n As Integer) As Double
'Arrondi un r|fffd|el |fffd| la n i|fffd|me d|fffd|cimale pr|fffd|s
ArrondiEntProche = Int(r * 10 ^ n + 0.499999999999999) / 10 ^ n
End Function

Function getEnviron(sText As String) As String
getEnviron = Environ(sText)
End Function

Function ArrSup(ByVal X As Double, ByVal Arrondi As Double) As Double
ArrSup = ArrondiEntSup(X / Arrondi) * Arrondi
End Function

Function AffQuotient(r As Double) As String
Dim n As Integer
Select Case Int(1000 * r) / 1000 = r
Case True
  AffQuotient = r
Case False
  AffQuotient = r
  For n = 2 To 100
    If Abs(Int(r * n) / n - r) < 0.000000001 Then
      AffQuotient = ArrSup(r * n - 0.00001, 1) & "/" & n
      Exit For
    End If
  Next n
End Select
End Function

Function Attendre()
Application.Wait TimeSerial(Hour(Now()), Minute(Now()), Second(Now()) + 1)
End Function
Function ConvertiDateTxt(d As Date) As String
Dim Txt As String
Select Case Day(d)
Case 1:  Txt = "premier"
Case 2:  Txt = "deux"
Case 3:  Txt = "trois"
Case 4:  Txt = "quatre"
Case 5:  Txt = "cinq"
Case 6:  Txt = "six"
Case 7:  Txt = "sept"
Case 8:  Txt = "huit"
Case 9:  Txt = "neuf"
Case 10: Txt = "dix"
Case 11: Txt = "onze"
Case 12: Txt = "douze"
Case 13: Txt = "treize"
Case 14: Txt = "quatorze"
Case 15: Txt = "quinze"
Case 16: Txt = "seize"
Case 17: Txt = "dix-sept"
Case 18: Txt = "dix-huit"
Case 19: Txt = "dix-neuf"
Case 20: Txt = "vingt"
Case 21: Txt = "vingt-et-un"
Case 22: Txt = "vingt-deux"
Case 23: Txt = "vingt-trois"
Case 24: Txt = "vingt-quatre"
Case 25: Txt = "vingt-cinq"
Case 26: Txt = "vingt-six"
Case 27: Txt = "vingt-sept"
Case 28: Txt = "vingt-huit"
Case 29: Txt = "vingt-neuf"
Case 30: Txt = "trente"
Case 31: Txt = "trente-et-un"
End Select
Txt = Txt & " "
Select Case Month(d)
Case 1: Txt = Txt & "janvier"
Case 2: Txt = Txt & "f|fffd|vrier"
Case 3: Txt = Txt & "mars"
Case 4: Txt = Txt & "avril"
Case 5: Txt = Txt & "mai"
Case 6: Txt = Txt & "juin"
Case 7: Txt = Txt & "juillet"
Case 8: Txt = Txt & "ao|fffd|t"
Case 9: Txt = Txt & "septembre"
Case 10: Txt = Txt & "octobre"
Case 11: Txt = Txt & "novembre"
Case 12: Txt = Txt & "d|fffd|cembre"
End Select
Txt = Txt & " "
Select Case Year(d)
Case 2005: Txt = Txt & "deux mille cinq"
Case 2006: Txt = Txt & "deux mille six"
Case 2007: Txt = Txt & "deux mille sept"
Case 2008: Txt = Txt & "deux mille huit"
Case 2009: Txt = Txt & "deux mille neuf"
Case Else: MsgBox "Ann|fffd|e d'effet non pr|fffd|vue (" & Year(d) & ") : revoir la saisie sur ce point"
End Select
ConvertiDateTxt = Txt
End Function

Function ConvertiDateSemiTxt(d As Date)
Dim Txt As String
Select Case Day(d)
Case 1: Txt = "1er "
Case Else: Txt = Day(d) & " "
End Select
Select Case Month(d)
Case 1: Txt = Txt & "janvier"
Case 2: Txt = Txt & "f|fffd|vrier"
Case 3: Txt = Txt & "mars"
Case 4: Txt = Txt & "avril"
Case 5: Txt = Txt & "mai"
Case 6: Txt = Txt & "juin"
Case 7: Txt = Txt & "juillet"
Case 8: Txt = Txt & "ao|fffd|t"
Case 9: Txt = Txt & "septembre"
Case 10: Txt = Txt & "octobre"
Case 11: Txt = Txt & "novembre"
Case 12: Txt = Txt & "d|fffd|cembre"
End Select
Txt = Txt & " " & Year(d)
ConvertiDateSemiTxt = Txt
End Function

Function FormatDate(d As Date) As String
Dim Txt As String
Select Case Day(d)
Case Is < 10: Txt = "0" & Day(d)
Case Else:    Txt = Day(d)
End Select
Select Case Month(d)
Case Is < 10: Txt = Txt & "/0" & Month(d)
Case Else:    Txt = Txt & "/" & Month(d)
End Select
Select Case Year(d)
Case Is < 2000: Txt = Txt & "/" & Year(d) - 1999
Case Is < 2009: Txt = Txt & "/0" & Year(d) - 2000
Case Else:      Txt = Txt & "/" & Year(d) - 2000
End Select
FormatDate = Txt
End Function

Function TextErreur(NomFunction As String)
MsgBox "Ce programme a rencontr|fffd| un probl|fffd|me dans l'|fffd|x|fffd|cution de la proc|fffd|dure " & NomFunction & Chr(13) & Chr(13) & " => Fermer compl|fffd|tement LE FICHIER et EXCEL puis relancer le calcul." & Chr(13) & Chr(13) & "Si (et seulement si !) le probl|fffd|me persite, merci de v|fffd|rifier les hypoth|fffd|ses et donn|fffd|es impl|fffd|ment|fffd|es, puis si n|fffd|cessaire de contacter votre correspondant outil en lui envoyant le fichier pour examen approfondi." & Chr(13) & Chr(13) & "Merci !", , "Avertissement"
End Function




Function PremEch|fffd|ance(ByVal d As Date, ByVal dmin As Date, ByVal Frac As Integer) As Date
'Calcul de la premi|fffd|re |fffd|chance post|fffd|rieure |fffd| la date dMin d'une
'rente de 1er versement en d et de fractionnement Frac
Dim di As Date
di = d
If dmin <= d Then
  PremEch|fffd|ance = d
Else
  While di < dmin
    di = MoisPlus(di, 12 / Frac)
  Wend
End If
PremEch|fffd|ance = di
End Function


Function ApproximAge(ByVal dateini As Date, ByVal DateCalcul As Date, ByVal Frac As Variant) As Date
Dim d1 As Date, d2 As Date
Dim Frac1 As Integer
d1 = dateini
d2 = DateCalcul
If Day(d2) = 1 Then d2 = d2 - 1
d1 = d1 - Day(d2 + 1) + 1
d2 = d2 - Day(d2 + 1) + 1
d1 = MoisPlus(d1, -Month(d2 + 1) + 1)
d2 = MoisPlus(d2, -Month(d2 + 1) + 1)

If Not IsNumeric(Frac) Then
    Select Case Frac
    Case "Ann|fffd|e la plus proche"
        Frac1 = 1
    Case "Age exact"
        Frac1 = 0
    Case "Ann|fffd|e atteinte"
        Frac1 = 10
    Case "Semestre le plus proche"
        Frac1 = 2
    Case "Semestre atteinte"
        Frac1 = 20
    Case "Trimestre le plus proche"
        Frac1 = 4
    Case "Trimestre atteint"
        Frac1 = 40
    Case "Mois le plus proche"
        Frac1 = 12
    Case "Mois atteint"
        Frac1 = 120
    End Select
Else: Frac1 = Frac
End If


Select Case Frac1
Case 0:
  ApproximAge = dateini
  Exit Function
Case 1:
  Select Case Month(d1)
  Case Is <= 6: d1 = DateSerial(Year(d1), 1, 1)
  Case Else: d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 10:
  d1 = DateSerial(Year(d1) + 1, 1, 1)
Case 2:
  Select Case Month(d1)
  Case Is <= 3: d1 = DateSerial(Year(d1), 1, 1)
  Case Is <= 9: d1 = DateSerial(Year(d1), 7, 1)
  Case Else:    d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 20:
  Select Case Month(d1)
  Case Is <= 6: d1 = DateSerial(Year(d1), 7, 1)
  Case Else:    d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 4:
  Select Case Month(d1) * 100 + Day(d1)
  Case Is <= 215:  d1 = DateSerial(Year(d1), 1, 1)
  Case Is <= 515:  d1 = DateSerial(Year(d1), 4, 1)
  Case Is <= 815:  d1 = DateSerial(Year(d1), 7, 1)
  Case Is <= 1115: d1 = DateSerial(Year(d1), 10, 1)
  Case Else:       d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 40:
  Select Case Month(d1)
  Case Is <= 3: d1 = DateSerial(Year(d1), 4, 1)
  Case Is <= 6: d1 = DateSerial(Year(d1), 7, 1)
  Case Is <= 9: d1 = DateSerial(Year(d1), 10, 1)
  Case Else:    d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 12:
  Select Case Month(d1) * 100 + Day(d1)
  Case Is <= 115: d1 = DateSerial(Year(d1), 1, 1)
  Case Is <= 215: d1 = DateSerial(Year(d1), 2, 1)
  Case Is <= 315: d1 = DateSerial(Year(d1), 3, 1)
  Case Is <= 415: d1 = DateSerial(Year(d1), 4, 1)
  Case Is <= 515: d1 = DateSerial(Year(d1), 5, 1)
  Case Is <= 615: d1 = DateSerial(Year(d1), 6, 1)
  Case Is <= 715: d1 = DateSerial(Year(d1), 7, 1)
  Case Is <= 815: d1 = DateSerial(Year(d1), 8, 1)
  Case Is <= 915: d1 = DateSerial(Year(d1), 9, 1)
  Case Is <= 1015: d1 = DateSerial(Year(d1), 10, 1)
  Case Is <= 1115: d1 = DateSerial(Year(d1), 11, 1)
  Case Is <= 1215: d1 = DateSerial(Year(d1), 12, 1)
  Case Else: d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
Case 120:
  Select Case Month(d1)
  Case Is <= 1:  d1 = DateSerial(Year(d1), 2, 1)
  Case Is <= 2:  d1 = DateSerial(Year(d1), 3, 1)
  Case Is <= 3:  d1 = DateSerial(Year(d1), 4, 1)
  Case Is <= 4:  d1 = DateSerial(Year(d1), 5, 1)
  Case Is <= 5:  d1 = DateSerial(Year(d1), 6, 1)
  Case Is <= 6:  d1 = DateSerial(Year(d1), 7, 1)
  Case Is <= 7:  d1 = DateSerial(Year(d1), 8, 1)
  Case Is <= 8:  d1 = DateSerial(Year(d1), 9, 1)
  Case Is <= 9:  d1 = DateSerial(Year(d1), 10, 1)
  Case Is <= 10: d1 = DateSerial(Year(d1), 11, 1)
  Case Is <= 11: d1 = DateSerial(Year(d1), 12, 1)
  Case Else:     d1 = DateSerial(Year(d1) + 1, 1, 1)
  End Select
End Select
d2 = DateCalcul
If Day(d2) = 1 Then d2 = d2 - 1
d1 = d1 + Day(d2 + 1) - 1
d2 = d2 + Day(d2 + 1) - 1
d1 = MoisPlus(d1, Month(d2 + 1) - 1)
d2 = MoisPlus(d2, Month(d2 + 1) - 1)
If Day(d1) <> 1 Then d1 = d1 - 1
'If V|fffd|rifFinAn(d1 - 1) And Year(DateIni) + 1 = Year(d1) Then d1 = d1 - 1
ApproximAge = d1
End Function


Function ApAge(DateNaiss As Date, DateCalcul As Date, Pr|fffd|cision As Integer)
'Fonction qui calcule l'age avec une certaine pr|fffd|cision

ApAge = (DateCalcul - DateNaiss) / 365.25
ApAge = Round(ApAge, Pr|fffd|cision)

End Function


Function Approximage2(dateini As Date, DateEffet As Date, Frac As String)

Dim m As Integer
Dim d1 As Date
Dim d2 As Date
Dim k As Integer
k = 1







d1 = dateini
d2 = DateSerial(Year(d1) + 1, Month(DateEffet), Day(DateEffet))

'Select Case Frac
'age exact
'Case "Age exact", "0", "":
    Approximage2 = d1
    Exit Function
''ann|fffd|e la plus proche
'Case "Ann|fffd|e la plus proche", "1":
'    While Maxi(Maxi(d1 - d2, 0), Maxi(d2 - d1, 0)) > 183
'    d2 = AnPlus(d2, -1)
'    k = k + 1
'    Wend
''ann|fffd|e atteinte
'Case "Ann|fffd|e atteinte", "10":
'    If Month(d1) < Month(d2) Then d2 = AnPlus(d2, -1)
'    If Month(d1) = Month(d2) And Day(d1) < Day(d2) Then d2 = AnPlus(d2, -1)
''semestre le plus proche
'Case "Semestre le plus proche", "2":
'    While Maxi(Maxi(d1 - MoisPlus(d2, -6 * k), 0), Maxi(MoisPlus(d2, -6 * k) - d1, 0)) > 92
'        k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -6 * k)
''semestre atteint
'Case "Semestre atteint", "20":
'    While MoisPlus(d2, -6 * k) - d1 > 0
'    k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -6 * (k - 1))
''trimestre le plus proche
'Case "Trimestre le plus proche", "4":
'    While Maxi(Maxi(d1 - MoisPlus(d2, -3 * k), 0), Maxi(MoisPlus(d2, -3 * k) - d1, 0)) > 46
'    k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -3 * k)
''trimestre atteint
'Case "Trimestre atteint", "40":
'    While MoisPlus(d2, -3 * k) - d1 > 0
'    k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -3 * (k - 1))
''mois le plus proche
'Case "Mois le plus proche", "12":
'    While Maxi(Maxi(d1 - MoisPlus(d2, -k), 0), Maxi(MoisPlus(d2, -k) - d1, 0)) > 16
'    k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -k)
''mois atteint
'Case "Mois atteint", "120":
'    While MoisPlus(d2, -k) - d1 > 0
'        k = k + 1
'    Wend
'    d2 = MoisPlus(d2, -k + 1)
'End Select

Approximage2 = d2
End Function


Function Approximage3(AgeCal As Double, Frac As String)

Select Case Frac
Case "Age exact", "0":
Approximage3 = AgeCal
Case "Ann|fffd|e la plus proche", "1":
Approximage3 = Round(AgeCal)
Case "Ann|fffd|e atteinte", "10":
Approximage3 = Int(AgeCal)
Case "Semestre le plus proche", "2":
Approximage3 = Round(2 * AgeCal) / 2
Case "Semestre atteint", "20":
Approximage3 = Int(2 * AgeCal) / 2
Case "Trimestre le plus proche", "4":
Approximage3 = Round(AgeCal * 4) / 4
Case "Trimestre atteint", "40":
Approximage3 = Int(AgeCal * 4) / 4
Case "Mois le plus proche", "12":
Approximage3 = Round(AgeCal * 12) / 12
Case "Mois atteint", "120":
Approximage3 = Int(AgeCal * 12) / 12
End Select
End Function

Function Nbjour(date1 As Date, date2 As Date) As Integer
If date1 >= date2 Then
    Nbjour = CDate(date1) - CDate(date2)
Else: Nbjour = Nbjour(date2, date1)
End If
End Function

Function Nbann|fffd|es3(date1 As Date, date2 As Date, Optional Precision = 3) As Double
Dim dateannif As Date

If date1 < date2 Then
    'Date anniversaire a l'ann|fffd|e de date2
    dateannif = DateSerial(Year(date2), Month(date1), Day(date1))
    Nbann|fffd|es3 = nbann|fffd|es2(date1, dateannif)
    
    If dateannif < date2 Then
        If Year(date2) Mod 4 = 0 Then
            Nbann|fffd|es3 = Nbann|fffd|es3 + Nbjour(dateannif, date2) / 366
        Else: Nbann|fffd|es3 = Nbann|fffd|es3 + Nbjour(dateannif, date2) / 365
        End If
    Else
        If Year(date2) Mod 4 = 0 Then
            Nbann|fffd|es3 = Nbann|fffd|es3 - Nbjour(dateannif, date2) / 366
        Else: Nbann|fffd|es3 = Nbann|fffd|es3 - Nbjour(dateannif, date2) / 365
        End If
    End If
Else
    Nbann|fffd|es3 = Nbann|fffd|es3(date2, date1)
End If
End Function

Function Arrondi(ByVal r As Double, ByVal n As Integer) As Double
'Arrondi un r|fffd|el |fffd| la n i|fffd|me d|fffd|cimale pr|fffd|s
Arrondi = Int(r * 10 ^ n + 0.499999999999999) / 10 ^ n
End Function
'
'Function Ouvrefichier(NomChemin As String, NomFichier As String)
'On Error Resume Next
'Workbooks.Open Filename:=NomChemin & NomFichier
'Workbooks.Open Filename:="B:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="E:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="F:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="G:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="H:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="I:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="J:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="K:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="L:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="M:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="N:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="O:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="P:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="Q:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="R:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="S:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="T:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="U:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="V:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="W:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="X:\" & NomChemin & NomFichier
'Workbooks.Open Filename:="Y:\" & NomChemin & NomFichier
'End Function

'Function OuvreWord(NomChemin As String, NomFichier As String, appword As Word.Application) As Word.Document
'On Error Resume Next
'Set OuvreWord = appword.Documents.Open(NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("B:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("E:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("F:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("G:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("H:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("I:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("J:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("K:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("L:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("M:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("N:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("O:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("P:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("Q:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("R:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("S:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("T:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("U:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("V:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("W:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("X:\" & NomChemin & NomFichier, , True)
'Set OuvreWord = appword.Documents.Open("Y:\" & NomChemin & NomFichier, , True)
'End Function

Function CopierFichier(NomChemSourceBis As String, NomChemRep As String) As Boolean
CopierFichier = False
On Error Resume Next
FileCopy "B:\" & NomChemSourceBis, NomChemRep
FileCopy "E:\" & NomChemSourceBis, NomChemRep
FileCopy "F:\" & NomChemSourceBis, NomChemRep
FileCopy "G:\" & NomChemSourceBis, NomChemRep
FileCopy "H:\" & NomChemSourceBis, NomChemRep
FileCopy "I:\" & NomChemSourceBis, NomChemRep
FileCopy "J:\" & NomChemSourceBis, NomChemRep
FileCopy "K:\" & NomChemSourceBis, NomChemRep
FileCopy "L:\" & NomChemSourceBis, NomChemRep
FileCopy "M:\" & NomChemSourceBis, NomChemRep
FileCopy "N:\" & NomChemSourceBis, NomChemRep
FileCopy "O:\" & NomChemSourceBis, NomChemRep
FileCopy "P:\" & NomChemSourceBis, NomChemRep
FileCopy "Q:\" & NomChemSourceBis, NomChemRep
FileCopy "R:\" & NomChemSourceBis, NomChemRep
FileCopy "S:\" & NomChemSourceBis, NomChemRep
FileCopy "T:\" & NomChemSourceBis, NomChemRep
FileCopy "U:\" & NomChemSourceBis, NomChemRep
FileCopy "V:\" & NomChemSourceBis, NomChemRep
FileCopy "W:\" & NomChemSourceBis, NomChemRep
FileCopy "X:\" & NomChemSourceBis, NomChemRep
FileCopy "Y:\" & NomChemSourceBis, NomChemRep
FileCopy NomChemSourceBis, NomChemRep
If Dir(NomChemRep) <> "" Then
CopierFichier = True
End If
End Function

Function pass(ByVal Ann|fffd|e As Integer, Optional ByVal TxRevalPass As Double = 0, Optional ByVal AnRef As Integer = 0) As Double
'-- Source : http://www.legislation.cnav.fr/web/bareme/ba_frame.htm
'-- rubrique Salaire Plafond - montant
pass = 0
If AnRef = 0 Then AnRef = 2011
Select Case Ann|fffd|e
Case Is < 1930: pass = 0
Case 1930: pass = 10800 / 100 / 6.55957
Case 1931: pass = 10800 / 100 / 6.55957
Case 1932: pass = 10800 / 100 / 6.55957
Case 1933: pass = 10800 / 100 / 6.55957
Case 1934: pass = 10800 / 100 / 6.55957
Case 1935: pass = 10800 / 100 / 6.55957
Case 1936: pass = 12000 / 100 / 6.55957
Case 1937: pass = 15000 / 100 / 6.55957
Case 1938: pass = (15000 / 2 + 18000 / 2) / 100 / 6.55957
Case 1939: pass = 18000 / 100 / 6.55957
Case 1940: pass = 18000 / 100 / 6.55957
Case 1941: pass = (18000 / 4 + 30000 / 4 * 3) / 100 / 6.55957
Case 1942: pass = 42000 / 100 / 6.55957
Case 1943: pass = 42000 / 100 / 6.55957
Case 1944: pass = (48000 * 2 / 3 + 60000 / 3) / 100 / 6.55957
Case 1945: pass = (60000 / 4 + 120000 * 3 / 4) / 100 / 6.55957
Case 1946: pass = (120000 / 2 + 150000 / 2) / 100 / 6.55957
Case 1947: pass = 204000 / 100 / 6.55957
Case 1948: pass = (204000 / 6 + 228000 * 5 / 6) / 100 / 6.55957
Case 1949: pass = (228000 / 6 + 264000 * 5 / 6) / 100 / 6.55957
Case 1950: pass = 264000 / 100 / 6.55957
Case 1951: pass = (324000 * 3 / 4 + 408000 / 4) / 100 / 6.55957
Case 1952: pass = (408000 / 4 + 456000 * 3 / 4) / 100 / 6.55957
Case 1953: pass = 456000 / 100 / 6.55957
Case 1954: pass = 456000 / 100 / 6.55957
Case 1955: pass = (456000 * 3 / 4 + 528000 / 4) / 100 / 6.55957
Case 1956: pass = 528000 / 100 / 6.55957
Case 1957: pass = 528000 / 100 / 6.55957
Case 1958: pass = 600000 / 100 / 6.55957
Case 1959: pass = 660000 / 100 / 6.55957
Case 1960: pass = (6600 / 2 + 7080 / 2) / 6.55957
Case 1961: pass = (7200 / 4 + 8400 * 3 / 4) / 6.55957
Case 1962: pass = 9600 / 6.55957
Case 1963: pass = 10440 / 6.55957
Case 1964: pass = 11400 / 6.55957
Case 1965: pass = 12240 / 6.55957
Case 1966: pass = 12960 / 6.55957
Case 1967: pass = 13680 / 6.55957
Case 1968: pass = 14400 / 6.55957
Case 1969: pass = 16320 / 6.55957
Case 1970: pass = 18000 / 6.55957
Case 1971: pass = 19800 / 6.55957
Case 1972: pass = 21960 / 6.55957
Case 1973: pass = 24480 / 6.55957
Case 1974: pass = 27840 / 6.55957
Case 1975: pass = 33000 / 6.55957
Case 1976: pass = 37920 / 6.55957
Case 1977: pass = 43320 / 6.55957
Case 1978: pass = 48000 / 6.55957
Case 1979: pass = 53640 / 6.55957
Case 1980: pass = 60120 / 6.55957
Case 1981: pass = 68760 / 6.55957
Case 1982: pass = (79080 + 84960) / 2 / 6.55957
Case 1983: pass = (88920 + 94440) / 2 / 6.55957
Case 1984: pass = (97320 + 101880) / 2 / 6.55957
Case 1985: pass = (104760 + 108720) / 2 / 6.55957
Case 1986: pass = (110640 + 113760) / 2 / 6.55957
Case 1987: pass = (115560 + 118080) / 2 / 6.55957
Case 1988: pass = (119400 + 121320) / 2 / 6.55957
Case 1989: pass = (124080 + 126480) / 2 / 6.55957
Case 1990: pass = (129600 + 132480) / 2 / 6.55957
Case 1991: pass = (136080 + 139440) / 2 / 6.55957
Case 1992: pass = (142440 + 145800) / 2 / 6.55957
Case 1993: pass = (148320 + 151320) / 2 / 6.55957
Case 1994: pass = (152160 + 154080) / 2 / 6.55957
Case 1995: pass = (155160 + 156720) / 2 / 6.55957
Case 1996: pass = (159960 + 162480) / 2 / 6.55957
Case 1997: pass = 164640 / 6.55957
Case 1998: pass = 169080 / 6.55957
Case 1999: pass = 173640 / 6.55957
Case 2000: pass = 176400 / 6.55957
Case 2001: pass = 179400 / 6.55957
Case 2002: pass = 28224
Case 2003: pass = 29184
Case 2004: pass = 29712
Case 2005: pass = 30192
Case 2006: pass = 31068
Case 2007: pass = 32184
Case 2008: pass = 33276
Case 2009: pass = 34308
Case 2010: pass = 34620
Case 2011: pass = 35352
'Case 2012: pass = 36372
'Case 2013: pass = 37032
'Case 2014: pass = 37548
'Case 2015: pass = 38040
'Case 2016: pass = 38616
'Case 2017: pass = 39228
Case Is > 2012
  pass = 36372 * (1 + TxRevalPass) ^ (Ann|fffd|e - 2012)
End Select
If Ann|fffd|e > AnRef Then
  pass = pass(AnRef, TxRevalPass, AnRef) * (1 + TxRevalPass) ^ (Ann|fffd|e - AnRef)
End If
End Function

Function passAnnuel(ByVal Ann|fffd|e As Integer, Optional ByVal TxRevalPass As Double = 0, Optional ByVal AnRef As Integer = 0) As Double
'-- Retourne le pass en fonction de l'ann|fffd|e
'-- rubrique Salaire Plafond - montant
passAnnuel = 0
If AnRef = 0 Then AnRef = 2011
Select Case Ann|fffd|e
Case Is < 1930: passAnnuel = 0
Case 1930: passAnnuel = 10800 / 100 / 6.55957
Case 1931: passAnnuel = 10800 / 100 / 6.55957
Case 1932: passAnnuel = 10800 / 100 / 6.55957
Case 1933: passAnnuel = 10800 / 100 / 6.55957
Case 1934: passAnnuel = 10800 / 100 / 6.55957
Case 1935: passAnnuel = 10800 / 100 / 6.55957
Case 1936: passAnnuel = 12000 / 100 / 6.55957
Case 1937: passAnnuel = 15000 / 100 / 6.55957
Case 1938: passAnnuel = (15000 / 2 + 18000 / 2) / 100 / 6.55957
Case 1939: passAnnuel = 18000 / 100 / 6.55957
Case 1940: passAnnuel = 18000 / 100 / 6.55957
Case 1941: passAnnuel = (18000 / 4 + 30000 / 4 * 3) / 100 / 6.55957
Case 1942: passAnnuel = 42000 / 100 / 6.55957
Case 1943: passAnnuel = 42000 / 100 / 6.55957
Case 1944: passAnnuel = (48000 * 2 / 3 + 60000 / 3) / 100 / 6.55957
Case 1945: passAnnuel = (60000 / 4 + 120000 * 3 / 4) / 100 / 6.55957
Case 1946: passAnnuel = (120000 / 2 + 150000 / 2) / 100 / 6.55957
Case 1947: passAnnuel = 204000 / 100 / 6.55957
Case 1948: passAnnuel = (204000 / 6 + 228000 * 5 / 6) / 100 / 6.55957
Case 1949: passAnnuel = (228000 / 6 + 264000 * 5 / 6) / 100 / 6.55957
Case 1950: passAnnuel = 264000 / 100 / 6.55957
Case 1951: passAnnuel = (324000 * 3 / 4 + 408000 / 4) / 100 / 6.55957
Case 1952: passAnnuel = (408000 / 4 + 456000 * 3 / 4) / 100 / 6.55957
Case 1953: passAnnuel = 456000 / 100 / 6.55957
Case 1954: passAnnuel = 456000 / 100 / 6.55957
Case 1955: passAnnuel = (456000 * 3 / 4 + 528000 / 4) / 100 / 6.55957
Case 1956: passAnnuel = 528000 / 100 / 6.55957
Case 1957: passAnnuel = 528000 / 100 / 6.55957
Case 1958: passAnnuel = 600000 / 100 / 6.55957
Case 1959: passAnnuel = 660000 / 100 / 6.55957
Case 1960: passAnnuel = (6600 / 2 + 7080 / 2) / 6.55957
Case 1961: passAnnuel = (7200 / 4 + 8400 * 3 / 4) / 6.55957
Case 1962: passAnnuel = 9600 / 6.55957
Case 1963: passAnnuel = 10440 / 6.55957
Case 1964: passAnnuel = 11400 / 6.55957
Case 1965: passAnnuel = 12240 / 6.55957
Case 1966: passAnnuel = 12960 / 6.55957
Case 1967: passAnnuel = 13680 / 6.55957
Case 1968: passAnnuel = 14400 / 6.55957
Case 1969: passAnnuel = 16320 / 6.55957
Case 1970: passAnnuel = 18000 / 6.55957
Case 1971: passAnnuel = 19800 / 6.55957
Case 1972: passAnnuel = 21960 / 6.55957
Case 1973: passAnnuel = 24480 / 6.55957
Case 1974: passAnnuel = 27840 / 6.55957
Case 1975: passAnnuel = 33000 / 6.55957
Case 1976: passAnnuel = 37920 / 6.55957
Case 1977: passAnnuel = 43320 / 6.55957
Case 1978: passAnnuel = 48000 / 6.55957
Case 1979: passAnnuel = 53640 / 6.55957
Case 1980: passAnnuel = 60120 / 6.55957
Case 1981: passAnnuel = 68760 / 6.55957
Case 1982: passAnnuel = (79080 + 84960) / 2 / 6.55957
Case 1983: passAnnuel = (88920 + 94440) / 2 / 6.55957
Case 1984: passAnnuel = (97320 + 101880) / 2 / 6.55957
Case 1985: passAnnuel = (104760 + 108720) / 2 / 6.55957
Case 1986: passAnnuel = (110640 + 113760) / 2 / 6.55957
Case 1987: passAnnuel = (115560 + 118080) / 2 / 6.55957
Case 1988: passAnnuel = (119400 + 121320) / 2 / 6.55957
Case 1989: passAnnuel = (124080 + 126480) / 2 / 6.55957
Case 1990: passAnnuel = (129600 + 132480) / 2 / 6.55957
Case 1991: passAnnuel = (136080 + 139440) / 2 / 6.55957
Case 1992: passAnnuel = (142440 + 145800) / 2 / 6.55957
Case 1993: passAnnuel = (148320 + 151320) / 2 / 6.55957
Case 1994: passAnnuel = (152160 + 154080) / 2 / 6.55957
Case 1995: passAnnuel = (155160 + 156720) / 2 / 6.55957
Case 1996: passAnnuel = (159960 + 162480) / 2 / 6.55957
Case 1997: passAnnuel = 164640 / 6.55957
Case 1998: passAnnuel = 169080 / 6.55957
Case 1999: passAnnuel = 173640 / 6.55957
Case 2000: passAnnuel = 176400 / 6.55957
Case 2001: passAnnuel = 179400 / 6.55957
Case 2002: passAnnuel = 28224
Case 2003: passAnnuel = 29184
Case 2004: passAnnuel = 29712
Case 2005: passAnnuel = 30192
Case 2006: passAnnuel = 31068
Case 2007: passAnnuel = 32184
Case 2008: passAnnuel = 33276
Case 2009: passAnnuel = 34308
Case 2010: passAnnuel = 34620
Case 2011: passAnnuel = 35352
Case 2012: passAnnuel = 36372
Case 2013: passAnnuel = 37032
Case 2014: passAnnuel = 37548
Case 2015: passAnnuel = 38040
Case 2016: passAnnuel = 38616
Case 2017: passAnnuel = 39228
Case 2018: passAnnuel = 39732
Case 2019: passAnnuel = 40524 ' maj 2019
End Select
End Function
Attribute VB_Name = "Formulaire"
Attribute VB_Base = "0{336E4939-7393-44E8-9FE9-4151FF7F3034}{196C52B4-9A28-4E26-AD09-C28C84A312E5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Ouverture_userform()

Load Formulaire
Formulaire.Show
End Sub

Private Sub Adhesion_Change()
'
'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
Range("Adhesion_bar83") = Adhesion.Value 'On copie le num|fffd|ro d'adh|fffd|sion
End Sub

Function Fermeture_formulaire()
'R|fffd|cup|fffd|ration des informations pour les ranger dans la feuille Excel synth|fffd|se
    ' 'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
  'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
 
    'Remplissage coordonn|fffd|es assur|fffd|
    Range("Adresse_assur|fffd|") = Adresse.Value
    Range("Comp_adresse_assur|fffd|") = Complement_adresse.Value
    Range("Code_postal_assur|fffd|") = Code_postal.Value
    Range("Commune_asssur|fffd|") = Commune.Value
    Range("Pays_assur|fffd|") = Pays.Value
    Range("Net_480") = Net_480.Value
    MsgBox ("Merci d'avoir rempli notre formulaire. L'|fffd|dition de votre titre de rente est en cours...")
    Formulaire.Hide
    Unload Formulaire
End Function

Private Sub Aucun_benef_Click()
If Aucun_benef.Value = True Then
    
    Range("Nb_benef") = 0
    Choix_1beneficiaire.Value = False
    Choix_2beneficiaires.Value = False
    Choix_3beneficiaires.Value = False
    Choix_4beneficiaires.Value = False
    Pourcentage_de_repartition.Visible = False
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 1
     Case_nom_beneficiaire1.Visible = False
     Nom_beneficiaire1.Visible = False
     Case_nom_naissance_beneficiaire1.Visible = False
     Nom_naissance_beneficiaire1.Visible = False
     Case_prenom_beneficiaire1.Visible = False
     Prenom_beneficiaire1.Visible = False
     Case_lien_parente_beneficiaire1.Visible = False
     Lien_parente_beneficiaire1.Visible = False
     Case_commune_naissance_beneficiaire1.Visible = False
     Commune_naissance_beneficiaire1.Visible = False
     Pourcentage_beneficiaire_1.Visible = False
     Case_date_nais_beneficiaire1.Visible = False
     Date_nais_beneficiaire1.Visible = False

    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = False
    Nom_beneficiaire2.Visible = False
    Case_nom_naissance_beneficiaire2.Visible = False
    Nom_naissance_beneficiaire2.Visible = False
    Case_prenom_beneficiaire2.Visible = False
    Prenom_beneficiaire2.Visible = False
    Case_lien_parente_beneficiaire2.Visible = False
    Lien_parente_beneficiaire2.Visible = False
    Case_commune_naissance_beneficiaire2.Visible = False
    Commune_naissance_beneficiaire2.Visible = False
    Pourcentage_beneficiaire_2.Visible = False
    Case_date_nais_beneficiaire2.Visible = False
    Date_nais_beneficiaire2.Visible = False
       
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = False
    Nom_beneficiaire3.Visible = False
    Case_nom_naissance_beneficiaire3.Visible = False
    Nom_naissance_beneficiaire3.Visible = False
    Case_prenom_beneficiaire3.Visible = False
    Prenom_beneficiaire3.Visible = False
    Case_lien_parente_beneficiaire3.Visible = False
    Lien_parente_beneficiaire3.Visible = False
    Case_commune_naissance_beneficiaire3.Visible = False
    Commune_naissance_beneficiaire3.Visible = False
    Pourcentage_beneficiaire_3.Visible = False
    Case_date_nais_beneficiaire3.Visible = False
    Date_nais_beneficiaire3.Visible = False
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False
End If

End Sub

Private Sub Bouton_Ok_Click()
'Bouton qui sert |fffd| la fermeture du Userform
'
If Verification_formulaire Then
    
    Fermeture_formulaire
    
    If Range("Test_bar83").Value = 83 Or Range("Test_bar83").Value = 82 Then 'Quand on clique sur le bouton "Edition du titre de rente" pour un titre de rente 83 ou 82 depuis bar|fffd|me
        
        If Regularisation_rente.Value = True Then Regularisation_bar83
        If Mise_en_service_rente.Value = True Then Edition_courrier_bar83
        If Rachat_rente.Value = True Then Edition_courrier_rachat
       
    End If
    
    If Range("Test_art83").Value = 83 Or Range("Test_art83").Value = 82 Then 'Quand on clique sur le bouton "Edition du titre de rente" pour un titre de rente 83 depuis article 83 ou 82
        
        If Regularisation_rente.Value = True Then Regularisation_art83
        If Mise_en_service_rente.Value = True Then Edition_courrier_art83
        If Rachat_rente.Value = True Then Edition_courrier_rachat
            
    End If
    
    If Range("Test_bar39").Value = 1 Then 'Quand on clique sur le bouton "Edition du titre de rente" pour un titre de rente 39 depuis bar|fffd|me, Test_bar39 = 1
         If Mise_en_service_rente.Value = True Then Edition_courrier_bar39
          If Rachat_rente.Value = True Then Edition_courrier_rachat
    End If
    
    If Range("Test_art39").Value = 1 Then 'Quand on clique sur le bouton "Edition du titre de rente" pour un titre de rente 39 depuis article 39, Test_art39 = 1
        If Mise_en_service_rente.Value = True Then Edition_courrier_art39
        If Rachat_rente.Value = True Then Edition_courrier_rachat
    End If
    
Else: Exit Sub

End If

Initialisation_Feuille_Synthese

End Sub


Private Sub Choix_1beneficiaire_Click()

If Choix_1beneficiaire.Value = True Then 'Si on a choisi 1 b|fffd|n|fffd|ficiaire
    
    '
     'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
    Range("Nb_benef").Value = 1

    Pourcentage_beneficiaire_1.Value = 100 'Le b|fffd|n|fffd|ficiaire 1 obtient la totalit|fffd| du montant de la rente
    Pourcentage_beneficiaire_1.Enabled = False
    
    'On ne peut plus choisir 2,3 ou 4 b|fffd|n|fffd|ficiaires
    Choix_2beneficiaires.Value = False
    Choix_3beneficiaires.Value = False
    Choix_4beneficiaires.Value = False
    Aucun_benef.Value = False
    Pourcentage_de_repartition.Visible = True
    
    
    
    'On affiche tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 1
     Case_nom_beneficiaire1.Visible = True
     Nom_beneficiaire1.Visible = True
     Case_nom_naissance_beneficiaire1.Visible = True
     Nom_naissance_beneficiaire1.Visible = True
     Case_prenom_beneficiaire1.Visible = True
     Prenom_beneficiaire1.Visible = True
     Case_lien_parente_beneficiaire1.Visible = True
     Lien_parente_beneficiaire1.Visible = True
     Case_commune_naissance_beneficiaire1.Visible = True
     Commune_naissance_beneficiaire1.Visible = True
     Pourcentage_beneficiaire_1.Visible = True
     Case_date_nais_beneficiaire1.Visible = True
     Date_nais_beneficiaire1.Visible = True

    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = False
    Nom_beneficiaire2.Visible = False
    Case_nom_naissance_beneficiaire2.Visible = False
    Nom_naissance_beneficiaire2.Visible = False
    Case_prenom_beneficiaire2.Visible = False
    Prenom_beneficiaire2.Visible = False
    Case_lien_parente_beneficiaire2.Visible = False
    Lien_parente_beneficiaire2.Visible = False
    Case_commune_naissance_beneficiaire2.Visible = False
    Commune_naissance_beneficiaire2.Visible = False
    Pourcentage_beneficiaire_2.Visible = False
    Case_date_nais_beneficiaire2.Visible = False
    Date_nais_beneficiaire2.Visible = False
    
    
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = False
    Nom_beneficiaire3.Visible = False
    Case_nom_naissance_beneficiaire3.Visible = False
    Nom_naissance_beneficiaire3.Visible = False
    Case_prenom_beneficiaire3.Visible = False
    Prenom_beneficiaire3.Visible = False
    Case_lien_parente_beneficiaire3.Visible = False
    Lien_parente_beneficiaire3.Visible = False
    Case_commune_naissance_beneficiaire3.Visible = False
    Commune_naissance_beneficiaire3.Visible = False
    Pourcentage_beneficiaire_3.Visible = False
    Case_date_nais_beneficiaire3.Visible = False
    Date_nais_beneficiaire3.Visible = False
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False
    
    'On supprime les cases r|fffd|serv|fffd|es aux b|fffd|n|fffd|ficiaires 2,3 et 4 dans la feuille Synth|fffd|se
    
    Range("Case_nom_benef2") = ""
    Range("Nom_benef2") = ""
    Range("Case_nom_naissance_benef2") = ""
    Range("Nom_naissance_benef2") = ""
    Range("Case_prenom_benef2") = ""
    Range("Prenom_benef2") = ""
    Range("Case_lien_parente_benef2") = ""
    Range("Lien_parent|fffd|_benef2") = ""
    Range("Case_commune_naissance_benef2") = ""
    Range("Commune_naissance_benef2") = ""
    Range("Pourcentage_rep_benef2") = ""
    Range("Case_pourcentage_rep_benef2") = ""
    Range("Case_date_naissance_benef2") = ""
    Range("Date_naissance_benef2") = ""
    
    Range("Case_nom_benef3") = ""
    Range("Nom_benef3") = ""
    Range("Case_nom_naissance_benef3") = ""
    Range("Nom_naissance_benef3") = ""
    Range("Case_prenom_benef3") = ""
    Range("Prenom_benef3") = ""
    Range("Case_lien_parente_benef3") = ""
    Range("Lien_parent|fffd|_benef3") = ""
    Range("Case_commune_naissance_benef3") = ""
    Range("Commune_naissance_benef3") = ""
    Range("Pourcentage_rep_benef3") = ""
    Range("Case_pourcentage_rep_benef3") = ""
    Range("Case_date_naissance_benef3") = ""
    Range("Date_naissance_benef3") = ""
    
    Range("Case_nom_benef4") = ""
    Range("Nom_benef4") = ""
    Range("Case_nom_naissance_benef4") = ""
    Range("Nom_naissance_benef4") = ""
    Range("Case_prenom_benef4") = ""
    Range("Prenom_benef4") = ""
    Range("Case_lien_parente_benef4") = ""
    Range("Lien_parent|fffd|_benef4") = ""
    Range("Case_commune_naissance_benef4") = ""
    Range("Commune_naissance_benef4") = ""
    Range("Pourcentage_rep_benef4") = ""
    Range("Case_pourcentage_rep_benef4") = ""
    Range("Case_date_naissance_benef4") = ""
    
    
    
    
    
Else: 'Si la case 1 b|fffd|n|fffd|ficiaire n'est pas coch|fffd|e
    
    Pourcentage_beneficiaire_1.Value = ""
    Pourcentage_beneficiaire_1.Enabled = True


'    'On affiche le bloc b|fffd|n|fffd|ficiaire 2
'    Case_nom_beneficiaire2.Visible = True
'    Nom_beneficiaire2.Visible = True
'    Case_nom_naissance_beneficiaire2.Visible = True
'    Nom_naissance_beneficiaire2.Visible = True
'    Case_prenom_beneficiaire2.Visible = True
'    Prenom_beneficiaire2.Visible = True
'    Case_lien_parente_beneficiaire2.Visible = True
'    Lien_parente_beneficiaire2.Visible = True
'    Case_commune_naissance_beneficiaire2.Visible = True
'    Commune_naissance_beneficiaire2.Visible = True
'    Pourcentage_beneficiaire_2.Visible = True
'    Case_date_nais_beneficiaire2.Visible = True
'    Date_nais_beneficiaire2.Visible = True
'
'    'On affiche le bloc b|fffd|n|fffd|ficiaire 3
'    Case_nom_beneficiaire3.Visible = True
'    Nom_beneficiaire3.Visible = True
'    Case_nom_naissance_beneficiaire3.Visible = True
'    Nom_naissance_beneficiaire3.Visible = True
'    Case_prenom_beneficiaire3.Visible = True
'    Prenom_beneficiaire3.Visible = True
'    Case_lien_parente_beneficiaire3.Visible = True
'    Lien_parente_beneficiaire3.Visible = True
'    Case_commune_naissance_beneficiaire3.Visible = True
'    Commune_naissance_beneficiaire3.Visible = True
'    Pourcentage_beneficiaire_3.Visible = True
'    Case_date_nais_beneficiaire3.Visible = True
'    Date_nais_beneficiaire3.Visible = True
'
'    'On affiche le bloc b|fffd|n|fffd|ficiaire 4
'    Case_nom_beneficiaire4.Visible = True
'    Nom_beneficiaire4.Visible = True
'    Case_nom_naissance_beneficiaire4.Visible = True
'    Nom_naissance_beneficiaire4.Visible = True
'    Case_prenom_beneficiaire4.Visible = True
'    Prenom_beneficiaire4.Visible = True
'    Case_lien_parente_beneficiaire4.Visible = True
'    Lien_parente_beneficiaire4.Visible = True
'    Case_commune_naissance_beneficiaire4.Visible = True
'    Commune_naissance_beneficiaire4.Visible = True
'    Pourcentage_beneficiaire_4.Visible = True
'    Case_date_nais_beneficiaire4.Visible = True
'    Date_nais_beneficiaire4.Visible = True
    
End If
End Sub



Private Sub Choix_2beneficiaires_Click()

If Choix_2beneficiaires.Value = True Then 'Si on a choisi 2 b|fffd|n|fffd|ficiaires
    '
     'ThisWorkbook.Sheets("SyntheseGenerale").Activate.Activate
    Range("Nb_benef").Value = 2
    'On ne peut plus choisir 1,3 ou 4 b|fffd|n|fffd|ficiaires
    Choix_1beneficiaire.Value = False
    Choix_3beneficiaires.Value = False
    Choix_4beneficiaires.Value = False
    Aucun_benef.Value = False
    Pourcentage_de_repartition.Visible = True
    
    'On affiche le bloc b|fffd|n|fffd|ficiaire 1
    Case_nom_beneficiaire1.Visible = True
    Nom_beneficiaire1.Visible = True
    Case_nom_naissance_beneficiaire1.Visible = True
    Nom_naissance_beneficiaire1.Visible = True
    Case_prenom_beneficiaire1.Visible = True
    Prenom_beneficiaire1.Visible = True
    Case_lien_parente_beneficiaire1.Visible = True
    Lien_parente_beneficiaire1.Visible = True
    Case_commune_naissance_beneficiaire1.Visible = True
    Commune_naissance_beneficiaire1.Visible = True
    Pourcentage_beneficiaire_1.Visible = True
    Case_date_nais_beneficiaire1.Visible = True
    Date_nais_beneficiaire1.Visible = True
    
    
    'On affiche le bloc b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = True
    Nom_beneficiaire2.Visible = True
    Case_nom_naissance_beneficiaire2.Visible = True
    Nom_naissance_beneficiaire2.Visible = True
    Case_prenom_beneficiaire2.Visible = True
    Prenom_beneficiaire2.Visible = True
    Case_lien_parente_beneficiaire2.Visible = True
    Lien_parente_beneficiaire2.Visible = True
    Case_commune_naissance_beneficiaire2.Visible = True
    Commune_naissance_beneficiaire2.Visible = True
    Pourcentage_beneficiaire_2.Visible = True
    Case_date_nais_beneficiaire2.Visible = True
    Date_nais_beneficiaire2.Visible = True
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = False
    Nom_beneficiaire3.Visible = False
    Case_nom_naissance_beneficiaire3.Visible = False
    Nom_naissance_beneficiaire3.Visible = False
    Case_prenom_beneficiaire3.Visible = False
    Prenom_beneficiaire3.Visible = False
    Case_lien_parente_beneficiaire3.Visible = False
    Lien_parente_beneficiaire3.Visible = False
    Case_commune_naissance_beneficiaire3.Visible = False
    Commune_naissance_beneficiaire3.Visible = False
    Pourcentage_beneficiaire_3.Visible = False
    Case_date_nais_beneficiaire3.Visible = False
    Date_nais_beneficiaire3.Visible = False
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False
    
    
    
    'On supprime les cases r|fffd|serv|fffd|es aux b|fffd|n|fffd|ficiaires 3 et 4 dans la feuille Synth|fffd|se
    
    Range("Case_nom_benef3") = ""
    Range("Nom_benef3") = ""
    Range("Case_nom_naissance_benef3") = ""
    Range("Nom_naissance_benef3") = ""
    Range("Case_prenom_benef3") = ""
    Range("Prenom_benef3") = ""
    Range("Case_lien_parente_benef3") = ""
    Range("Lien_parent|fffd|_benef3") = ""
    Range("Case_commune_naissance_benef3") = ""
    Range("Commune_naissance_benef3") = ""
    Range("Pourcentage_rep_benef3") = ""
    Range("Case_pourcentage_rep_benef3") = ""
    Range("Case_date_naissance_benef3") = ""
    Range("Date_naissance_benef3") = ""
    
    Range("Case_nom_benef4") = ""
    Range("Nom_benef4") = ""
    Range("Case_nom_naissance_benef4") = ""
    Range("Nom_naissance_benef4") = ""
    Range("Case_prenom_benef4") = ""
    Range("Prenom_benef4") = ""
    Range("Case_lien_parente_benef4") = ""
    Range("Lien_parent|fffd|_benef4") = ""
    Range("Case_commune_naissance_benef4") = ""
    Range("Commune_naissance_benef4") = ""
    Range("Pourcentage_rep_benef4") = ""
    Range("Case_pourcentage_rep_benef4") = ""
    Range("Case_date_naissance_benef4") = ""
    
'Else:
'    'On affiche le bloc b|fffd|n|fffd|ficiaire 3
'    Case_nom_beneficiaire3.Visible = True
'    Nom_beneficiaire3.Visible = True
'    Case_nom_naissance_beneficiaire3.Visible = True
'    Nom_naissance_beneficiaire3.Visible = True
'    Case_prenom_beneficiaire3.Visible = True
'    Prenom_beneficiaire3.Visible = True
'    Case_lien_parente_beneficiaire3.Visible = True
'    Lien_parente_beneficiaire3.Visible = True
'    Case_commune_naissance_beneficiaire3.Visible = True
'    Commune_naissance_beneficiaire3.Visible = True
'    Pourcentage_beneficiaire_3.Visible = True
'    Case_date_nais_beneficiaire3.Visible = True
'    Date_nais_beneficiaire3.Visible = True
'
'    'On affiche le bloc b|fffd|n|fffd|ficiaire 4
'    Case_nom_beneficiaire4.Visible = True
'    Nom_beneficiaire4.Visible = True
'    Case_nom_naissance_beneficiaire4.Visible = True
'    Nom_naissance_beneficiaire4.Visible = True
'    Case_prenom_beneficiaire4.Visible = True
'    Prenom_beneficiaire4.Visible = True
'    Case_lien_parente_beneficiaire4.Visible = True
'    Lien_parente_beneficiaire4.Visible = True
'    Case_commune_naissance_beneficiaire4.Visible = True
'    Commune_naissance_beneficiaire4.Visible = True
'    Pourcentage_beneficiaire_4.Visible = True
'    Case_date_nais_beneficiaire4.Visible = True
'    Date_nais_beneficiaire4.Visible = True
End If
End Sub

Private Sub Choix_3beneficiaires_Click()

If Choix_3beneficiaires.Value = True Then 'Si on a choisi 3 b|fffd|n|fffd|ficiaires
    Range("Nb_benef").Value = 3
    'On ne peut plus choisir 2,1 ou 4 b|fffd|n|fffd|ficiaires
    Choix_1beneficiaire.Value = False
    Choix_2beneficiaires.Value = False
    Choix_4beneficiaires.Value = False
    Aucun_benef.Value = False
    Pourcentage_de_repartition.Visible = True
    
    'On affiche le bloc b|fffd|n|fffd|ficiaire 1
    Case_nom_beneficiaire1.Visible = True
    Nom_beneficiaire1.Visible = True
    Case_nom_naissance_beneficiaire1.Visible = True
    Nom_naissance_beneficiaire1.Visible = True
    Case_prenom_beneficiaire1.Visible = True
    Prenom_beneficiaire1.Visible = True
    Case_lien_parente_beneficiaire1.Visible = True
    Lien_parente_beneficiaire1.Visible = True
    Case_commune_naissance_beneficiaire1.Visible = True
    Commune_naissance_beneficiaire1.Visible = True
    Pourcentage_beneficiaire_1.Visible = True
    Case_date_nais_beneficiaire1.Visible = True
    Date_nais_beneficiaire1.Visible = True
    
    'On affiche le bloc b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = True
    Nom_beneficiaire2.Visible = True
    Case_nom_naissance_beneficiaire2.Visible = True
    Nom_naissance_beneficiaire2.Visible = True
    Case_prenom_beneficiaire2.Visible = True
    Prenom_beneficiaire2.Visible = True
    Case_lien_parente_beneficiaire2.Visible = True
    Lien_parente_beneficiaire2.Visible = True
    Case_commune_naissance_beneficiaire2.Visible = True
    Commune_naissance_beneficiaire2.Visible = True
    Pourcentage_beneficiaire_2.Visible = True
    Case_date_nais_beneficiaire2.Visible = True
    Date_nais_beneficiaire2.Visible = True
    
    'On affiche le bloc b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = True
    Nom_beneficiaire3.Visible = True
    Case_nom_naissance_beneficiaire3.Visible = True
    Nom_naissance_beneficiaire3.Visible = True
    Case_prenom_beneficiaire3.Visible = True
    Prenom_beneficiaire3.Visible = True
    Case_lien_parente_beneficiaire3.Visible = True
    Lien_parente_beneficiaire3.Visible = True
    Case_commune_naissance_beneficiaire3.Visible = True
    Commune_naissance_beneficiaire3.Visible = True
    Pourcentage_beneficiaire_3.Visible = True
    Case_date_nais_beneficiaire3.Visible = True
    Date_nais_beneficiaire3.Visible = True
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False
    
    'On supprime les cases r|fffd|serv|fffd|es au b|fffd|n|fffd|ficiaire 4 dans la feuille Synth|fffd|se
    
    Range("Case_nom_benef4") = ""
    Range("Nom_benef4") = ""
    Range("Case_nom_naissance_benef4") = ""
    Range("Nom_naissance_benef4") = ""
    Range("Case_prenom_benef4") = ""
    Range("Prenom_benef4") = ""
    Range("Case_lien_parente_benef4") = ""
    Range("Lien_parent|fffd|_benef4") = ""
    Range("Case_commune_naissance_benef4") = ""
    Range("Commune_naissance_benef4") = ""
    Range("Pourcentage_rep_benef4") = ""
    Range("Case_pourcentage_rep_benef4") = ""
    Range("Case_date_naissance_benef4") = ""
    
'Else:
'    'On affiche le bloc b|fffd|n|fffd|ficiaire 4
'    Case_nom_beneficiaire4.Visible = True
'    Nom_beneficiaire4.Visible = True
'    Case_nom_naissance_beneficiaire4.Visible = True
'    Nom_naissance_beneficiaire4.Visible = True
'    Case_prenom_beneficiaire4.Visible = True
'    Prenom_beneficiaire4.Visible = True
'    Case_lien_parente_beneficiaire4.Visible = True
'    Lien_parente_beneficiaire4.Visible = True
'    Case_commune_naissance_beneficiaire4.Visible = True
'    Commune_naissance_beneficiaire4.Visible = True
'    Pourcentage_beneficiaire_4.Visible = True
'    Case_date_nais_beneficiaire4.Visible = True
'    Date_nais_beneficiaire4.Visible = True
    
End If
End Sub
Private Sub Choix_4beneficiaires_Click()


If Choix_4beneficiaires.Value = True Then 'Si on a choisi 4 b|fffd|n|fffd|ficiaires
    Range("Nb_benef").Value = 4
    'On ne peut plus choisir 1,2 ou 3 b|fffd|n|fffd|ficiaires
    Choix_1beneficiaire.Value = False
    Choix_2beneficiaires.Value = False
    Choix_3beneficiaires.Value = False
    Aucun_benef.Value = False
    Pourcentage_de_repartition.Visible = True
    'On affiche le bloc b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = True
    Nom_beneficiaire4.Visible = True
    Case_nom_naissance_beneficiaire4.Visible = True
    Nom_naissance_beneficiaire4.Visible = True
    Case_prenom_beneficiaire4.Visible = True
    Prenom_beneficiaire4.Visible = True
    Case_lien_parente_beneficiaire4.Visible = True
    Lien_parente_beneficiaire4.Visible = True
    Case_commune_naissance_beneficiaire4.Visible = True
    Commune_naissance_beneficiaire4.Visible = True
    Pourcentage_beneficiaire_4.Visible = True
    Case_date_nais_beneficiaire4.Visible = True
    Date_nais_beneficiaire4.Visible = True
    
    
        'On affiche le bloc b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = True
    Nom_beneficiaire3.Visible = True
    Case_nom_naissance_beneficiaire3.Visible = True
    Nom_naissance_beneficiaire3.Visible = True
    Case_prenom_beneficiaire3.Visible = True
    Prenom_beneficiaire3.Visible = True
    Case_lien_parente_beneficiaire3.Visible = True
    Lien_parente_beneficiaire3.Visible = True
    Case_commune_naissance_beneficiaire3.Visible = True
    Commune_naissance_beneficiaire3.Visible = True
    Pourcentage_beneficiaire_3.Visible = True
    Case_date_nais_beneficiaire3.Visible = True
    Date_nais_beneficiaire3.Visible = True
    
    
    
        'On affiche le bloc b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = True
    Nom_beneficiaire2.Visible = True
    Case_nom_naissance_beneficiaire2.Visible = True
    Nom_naissance_beneficiaire2.Visible = True
    Case_prenom_beneficiaire2.Visible = True
    Prenom_beneficiaire2.Visible = True
    Case_lien_parente_beneficiaire2.Visible = True
    Lien_parente_beneficiaire2.Visible = True
    Case_commune_naissance_beneficiaire2.Visible = True
    Commune_naissance_beneficiaire2.Visible = True
    Pourcentage_beneficiaire_2.Visible = True
    Case_date_nais_beneficiaire2.Visible = True
    Date_nais_beneficiaire2.Visible = True
    
        'On affiche le bloc b|fffd|n|fffd|ficiaire 1
    Case_nom_beneficiaire1.Visible = True
    Nom_beneficiaire1.Visible = True
    Case_nom_naissance_beneficiaire1.Visible = True
    Nom_naissance_beneficiaire1.Visible = True
    Case_prenom_beneficiaire1.Visible = True
    Prenom_beneficiaire1.Visible = True
    Case_lien_parente_beneficiaire1.Visible = True
    Lien_parente_beneficiaire1.Visible = True
    Case_commune_naissance_beneficiaire1.Visible = True
    Commune_naissance_beneficiaire1.Visible = True
    Pourcentage_beneficiaire_1.Visible = True
    Case_date_nais_beneficiaire1.Visible = True
    Date_nais_beneficiaire1.Visible = True
    
End If

End Sub

Private Sub Code_postal_Change()
Code_postal.MaxLength = 5 'Nombre de caract|fffd|res maxi autoris|fffd| pour le code postal
End Sub

Private Sub Commune_naissance_beneficiaire1_Change()

Range("Case_commune_naissance_benef1") = "Commmune de naissance b|fffd|n|fffd|ficiaire 1"
Range("Commune_naissance_benef1") = Commune_naissance_beneficiaire1.Value 'On copie la commune de naissance du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Commune_naissance_beneficiaire2_Change()

Range("Case_commune_naissance_benef2") = "Commmune de naissance b|fffd|n|fffd|ficiaire 2"
Range("Commune_naissance_benef2") = Commune_naissance_beneficiaire2.Value 'On copie la commune de naissance du b|fffd|n|fffd|ficiaire 2
End Sub

Private Sub Commune_naissance_beneficiaire3_Change()

Range("Case_commune_naissance_benef3") = "Commmune de naissance b|fffd|n|fffd|ficiaire 3"
Range("Commune_naissance_benef3") = Commune_naissance_beneficiaire3.Value 'On copie la commune de naissance du b|fffd|n|fffd|ficiaire 3
End Sub

Private Sub Commune_naissance_beneficiaire4_Change()

Range("Case_commune_naissance_benef4") = "Commmune de naissance b|fffd|n|fffd|ficiaire 4"
Range("Commune_naissance_benef4") = Commune_naissance_beneficiaire4.Value 'On copie la commune de naissance du b|fffd|n|fffd|ficiaire 4
End Sub










Private Sub Date_debut_Change()
Dim Valeur As Byte
Date_debut.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_debut)
If Valeur = 2 Or Valeur = 5 Then Date_debut = Date_debut & "/"

Range("Date_deb") = Format(Date_debut.Value, "dd/MM/yyyy")
End Sub

Private Sub Date_debut_AfterUpdate()
    
    If IsDate(Date_debut) Then
        Date_debut = Format(Date_debut, "dd/mm/yyyy")
    Else
        Date_debut = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub
    

Private Sub Date_fin_Change()

Dim Valeur As Byte
Date_fin.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_fin)
If Valeur = 2 Or Valeur = 5 Then Date_fin = Date_fin & "/"

Range("Date_f") = Format(Date_fin.Value, "dd/mm/yyyy")
End Sub

Private Sub Date_fin_AfterUpdate()
    
    If IsDate(Date_fin) Then
        Date_fin = Format(Date_fin, "dd/mm/yyyy")
    Else
        Date_fin = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub

Private Sub Date_nais_beneficiaire1_Change()

Dim Valeur As Byte
Date_nais_beneficiaire1.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_nais_beneficiaire1)
If Valeur = 2 Or Valeur = 5 Then Date_nais_beneficiaire1 = Date_nais_beneficiaire1 & "/"


Range("Case_date_naissance_benef1") = "Date de naissance du b|fffd|n|fffd|ficiaire 1"
Range("Date_naissance_benef1") = Date_nais_beneficiaire1.Value
End Sub


Private Sub Date_nais_beneficiaire1_AfterUpdate()
    
    If IsDate(Date_nais_beneficiaire1) Then
        Date_nais_beneficiaire1 = Format(Date_nais_beneficiaire1, "dd/mm/yyyy")
    Else
        Date_nais_beneficiaire1 = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub

Private Sub Date_nais_beneficiaire2_Change()

Dim Valeur As Byte
Date_nais_beneficiaire2.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_nais_beneficiaire2)
If Valeur = 2 Or Valeur = 5 Then Date_nais_beneficiaire2 = Date_nais_beneficiaire2 & "/"


Range("Case_date_naissance_benef2") = "Date de naissance du b|fffd|n|fffd|ficiaire 2"
Range("Date_naissance_benef2") = Date_nais_beneficiaire2.Value
End Sub

Private Sub Date_nais_beneficiaire2_AfterUpdate()
    
    If IsDate(Date_nais_beneficiaire2) Then
        Date_nais_beneficiaire2 = Format(Date_nais_beneficiaire1, "dd/mm/yyyy")
    Else
        Date_nais_beneficiaire2 = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub

Private Sub Date_nais_beneficiaire3_Change()

Dim Valeur As Byte
Date_nais_beneficiaire1.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_nais_beneficiaire3)
If Valeur = 2 Or Valeur = 5 Then Date_nais_beneficiaire3 = Date_nais_beneficiaire3 & "/"


Range("Case_date_naissance_benef3") = "Date de naissance du b|fffd|n|fffd|ficiaire 3"
Range("Date_naissance_benef3") = Date_nais_beneficiaire3.Value
End Sub

Private Sub Date_nais_beneficiaire3_AfterUpdate()
    
    If IsDate(Date_nais_beneficiaire3) Then
        Date_nais_beneficiaire3 = Format(Date_nais_beneficiaire3, "dd/mm/yyyy")
    Else
        Date_nais_beneficiaire3 = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub
Private Sub Date_nais_beneficiaire4_Change()
Dim Valeur As Byte
Date_nais_beneficiaire4.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
Valeur = Len(Date_nais_beneficiaire4)
If Valeur = 2 Or Valeur = 5 Then Date_nais_beneficiaire4 = Date_nais_beneficiaire4 & "/"

Range("Case_date_naissance_benef4") = "Date de naissance du b|fffd|n|fffd|ficiaire 4"
Range("Date_naissance_benef4") = Date_nais_beneficiaire4.Value
End Sub

Private Sub Date_nais_beneficiaire4_AfterUpdate()
    
    If IsDate(Date_nais_beneficiaire4) Then
        Date_nais_beneficiaire4 = Format(Date_nais_beneficiaire4, "dd/mm/yyyy")
    Else
        Date_nais_beneficiaire4 = Null
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub

End Sub

Private Sub Demande_Change()

Range("Demande_bar83") = Demande.Value 'On copie le num|fffd|ro de demande
End Sub

Private Sub Etranger_Click()
'Pr|fffd|levements sociaux : R|fffd|gime |fffd|tranger
  If Etranger.Value = True Then
        
        Pas_dexoneration.Value = False
        Range("PS_sans_exo") = ""
        Exoneration_partielle.Value = False
        Range("PS_exo_partielle") = ""
        Exoneration_totale.Value = False
        
        Range("PS_etranger") = 1
        
        'Calcul du montant net de la rente
        If Range("Test_bar83").Value = 83 Or Range("Test_bar83").Value = 82 Then
            Range("Montant_net_bar83") = Range("Montant_brut_bar83") * (1 - Range("Tx_PS_etranger"))
        End If
        
        If Range("Test_bar39").Value = 1 Then
            Range("Montant_net_bar39") = Range("Montant_brut_bar39") * (1 - Range("Tx_PS_etranger")) - Range("Mt_contribution_specifique_art39")
        End If
        
        If Range("Test_art83").Value = 83 Or Range("Test_art83").Value = 82 Then
            Range("Montant_net_art83") = Range("Montant_brut_art83") * (1 - Range("Tx_PS_etranger"))
        End If
        
        If Range("Test_art39").Value = 1 Then
            Range("Montant_net_art39") = Range("Montant_brut_art39") * (1 - Range("Tx_PS_etranger")) - Range("Mt_contribution_specifique_art39")
        End If
        
    Else: Range("PS_etranger").Value = ""
    End If
 
End Sub

Private Sub Exoneration_partielle_Click()
'Pr|fffd|levements sociaux : R|fffd|gime exon|fffd|ration partielle
  If Exoneration_partielle.Value = True Then
        
        Pas_dexoneration.Value = False
        Range("PS_sans_exo").Value = ""
        Etranger.Value = False
        Range("PS_etranger").Value = ""
        
        Exoneration_totale.Value = False
        
        Range("PS_exo_partielle") = 1
        
        'Calcul du montant net de la rente
        If Range("Test_bar83").Value = 83 Then
            Range("Montant_net_bar83") = Range("Montant_brut_bar83") * (1 - Range("Tx_PS_exo_partielle"))
        End If
        
        If Range("Test_bar39").Value = 1 Then
            Range("Montant_net_bar39") = Range("Montant_brut_bar39") * (1 - Range("Tx_PS_exo_partielle")) - Range("Mt_contribution_specifique_art39")
        End If
        
        If Range("Test_art83").Value = 83 Then
            Range("Montant_net_art83") = Range("Montant_brut_art83") * (1 - Range("Tx_PS_exo_partielle"))
        End If
        
        If Range("Test_art39").Value = 1 Then
            Range("Montant_net_art39") = Range("Montant_brut_art39") * (1 - Range("Tx_PS_exo_partielle")) - Range("Mt_contribution_specifique_art39")
        End If
      
        
    Else: Range("PS_exo_partielle").Value = ""
    End If
 
End Sub

Private Sub Exoneration_totale_Click()
'Pr|fffd|levements sociaux : R|fffd|gime exon|fffd|ration totale
  If Exoneration_totale.Value = True Then
        
        Exoneration_partielle.Value = False
        Range("PS_exo_partielle").Value = ""
        
        Etranger.Value = False
        Range("PS_etranger").Value = ""
        
        Pas_dexoneration.Value = False
        Range("PS_sans_exo").Value = ""
        
        'Les montants net et brut sont les m|fffd|mes en cas d'exon|fffd|ration totale
        If Range("Test_bar83").Value = 83 Or Range("Test_bar83").Value = 82 Then
            Range("Montant_net_bar83") = Range("Montant_brut_bar83")
        End If
        
        If Range("Test_bar39").Value = 1 Then
            Range("Montant_net_bar39") = Range("Montant_brut_bar39") - Range("Mt_contribution_specifique_art39")
        End If
        
        If Range("Test_art83").Value = 83 Or Range("Test_art83").Value = 82 Then
            Range("Montant_net_art83") = Range("Montant_brut_art83")
        End If
        
        If Range("Test_art39").Value = 1 Then
            Range("Montant_net_art39") = Range("Montant_brut_art39") - Range("Mt_contribution_specifique_art39")
        End If
               
    End If
 
End Sub

Private Sub Lien_parente_beneficiaire1_Change()
Range("Case_lien_parente_benef1") = "Lien de parent|fffd| |fffd|ventuel"
Range("Lien_parent|fffd|_benef1") = Lien_parente_beneficiaire1.Value 'On copie le lien de parent|fffd| du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Lien_parente_beneficiaire2_Change()
Range("Case_lien_parente_benef2") = "Lien de parent|fffd| |fffd|ventuel"
Range("Lien_parent|fffd|_benef2") = Lien_parente_beneficiaire2.Value 'On copie le lien de parent|fffd| du b|fffd|n|fffd|ficiaire 2
End Sub

Private Sub Lien_parente_beneficiaire3_Change()
Range("Case_lien_parente_benef3") = "Lien de parent|fffd| |fffd|ventuel"
Range("Lien_parent|fffd|_benef3") = Lien_parente_beneficiaire3.Value 'On copie le lien de parent|fffd| du b|fffd|n|fffd|ficiaire 3
End Sub

Private Sub Lien_parente_beneficiaire4_Change()
Range("Case_lien_parente_benef4") = "Lien de parent|fffd| |fffd|ventuel"
Range("Lien_parent|fffd|_benef4") = Lien_parente_beneficiaire4.Value 'On copie le lien de parent|fffd| du b|fffd|n|fffd|ficiaire 4
End Sub
Private Sub Liste_garantie_dep_Change()
Range("Garantie_dep") = Liste_garantie_dep.Value
End Sub

Private Sub Liste_premier_paiement_Change()
If Liste_premier_paiement.Value = "Non" Then
    P|fffd|riode.Visible = False
    Date_debut.Visible = False
    Au.Visible = False
    Date_fin.Visible = False
    Date_PP.Visible = False
    Case_date_PP.Caption = ""

Else
    P|fffd|riode.Visible = True
    Date_debut.Visible = True
    Au.Visible = True
    Date_fin.Visible = True
    Date_PP.Visible = True
    Case_date_PP.Caption = "Date du premier paiement :"
End If

Range("Premier_paiement") = Liste_premier_paiement.Value

End Sub

Private Sub Liste_qualite_reversataire_Change()
Range("Qualite_reversataire") = Liste_qualite_reversataire.Value 'On copie le lien avec le reversataire
End Sub

Private Sub Liste_sexe_assur|fffd|_Change()
Range("Sexe_assur|fffd|") = Liste_sexe_assur|fffd|.Value
End Sub

Private Sub Liste_tarif_Change()
Range("Tarif") = Liste_tarif.Value
End Sub


Private Sub Mise_en_service_rente_Click()
   

If Mise_en_service_rente.Value = True Then
   Regularisation_rente.Value = False
   Rachat_rente.Value = False
   Date_PP.MaxLength = 10 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date

   'On affiche tout le bloc "Coordonn|fffd|es et r|fffd|f|fffd|rences assur|fffd|"
    
    '-- ajout net 480
    Net_480.Visible = False
    Txt_Net_480.Visible = False
    Net_480.Enabled = False
    Txt_Net_480.Enabled = False
    
    '-------
    
    Coordonn|fffd|es_assur|fffd|.Visible = True
    Case_adresse.Visible = True
    Adresse.Visible = True
    Case_compl|fffd|ment_adresse.Visible = True
    Complement_adresse.Visible = True
    Case_code_postal.Visible = True
    Code_postal.Visible = True
    Case_commune.Visible = True
    Commune.Visible = True
    Case_pays.Visible = True
    Pays.Visible = True
    Case_reference_entreprise.Visible = True
    Reference_entreprise.Visible = True
    Case_adhesion.Visible = True
    Adhesion.Visible = True
    Case_numero_rente.Visible = True
    Numero_rente.Visible = True
    Case_demande.Visible = True
    Demande.Visible = True
    PS.Visible = True
    Pas_dexoneration.Visible = True
    Exoneration_partielle.Visible = True
    Etranger.Visible = True
    Exoneration_totale.Visible = True
    Rappel_sexe_assur|fffd|.Visible = True
    Liste_sexe_assur|fffd|.Visible = True
    Tarif.Visible = True
    Liste_tarif.Visible = True
    Garantie_dep.Visible = True
    Liste_garantie_dep.Visible = True
    
    If Range("Test_bar83").Value = 1 Or Range("Test_art83").Value = 1 Then
        Date_PP.Visible = False
        Case_date_PP.Visible = False
    End If
    
    
    If Range("Test_bar39").Value = 1 Or Range("Test_art39").Value = 1 Then
        Tarif.Visible = False
        Liste_tarif.Visible = False
        
    'Ajout on cache la gar d|fffd|pendance
    Garantie_dep.Visible = False
    Liste_garantie_dep.Visible = False
    
        
    End If
    
    
    'Initialisation du bloc concernant le premier paiement

    Concernant_PP.Visible = True
    Concernant_PP.Caption = "Concernant le premier paiement"
    Premier_paiement.Visible = True
    Liste_premier_paiement.Visible = True
    Case_date_PP.Visible = True
    Case_date_PP.Caption = "Date du premier paiement :"
    Range("Case_date_PP").Value = "Date du premier paiement"
    Range("Case_sup_net").Value = ""
    
    Date_PP.Visible = False 'modification
    Case_date_PP.Caption = ""
    
    P|fffd|riode.Visible = False
    P|fffd|riode.Caption = "Pour la p|fffd|riode du"
    Date_debut.Visible = False
    Au.Visible = False
    Date_fin.Visible = False

    If Coordonnees_beneficiaire.Visible = True Then 'Si l'option de rente n|fffd|cessite des b|fffd|n|fffd|ficiaires
    'On initialise le nombre de b|fffd|n|fffd|ficiaires par d|fffd|faut |fffd| 0
    
        Aucun_benef.Value = True
        Range("Nb_benef") = 0
        Choix_1beneficiaire.Value = False
        Choix_2beneficiaires.Value = False
        Choix_3beneficiaires.Value = False
        Choix_4beneficiaires.Value = False
    
    End If

    'G|fffd|re l'affichage ou la suppression des blocs r|fffd|serv|fffd|s au r|fffd|versataire et aux b|fffd|n|fffd|ficiaires en fonction de l'option de rente choisie d|fffd|s l'ouverture du userform
 
    If Range("Test_bar83") = 83 Or Range("Test_bar83").Value = 82 Then 'Si on cherche |fffd| |fffd|diter un titre de rente 83, 39 ou 82 |fffd| partir de bar|fffd|me
    
        If Range("option_rente_bar83") <> "R|fffd|versible" Then 'Si l'option de rente choisie n'est pas r|fffd|versible
            Cacher_bloc_reversataire
    
    
        Else: 'Sinon la rente est r|fffd|versible
            Afficher_bloc_reversataire
    
        End If
    
        If Range("option_rente_bar83") = "R|fffd|versible" Or Range("option_rente_bar83") = "Non r|fffd|versible" Or Range("option_rente_bar83") = "Croissante par palier" Then 'Si la rente ne n|fffd|cessite pas de b|fffd|n|fffd|ficiaire
            Cacher_bloc_beneficiaires
        Else: 'Sinon on a besoin de b|fffd|n|fffd|ficiaires
    
            Afficher_bloc_beneficiaires
    
        End If
    
    End If

    If Range("Test_art39") = 1 Or Range("Test_bar39") = 1 Then 'Si on cherche |fffd| |fffd|diter un titre de rente 39 |fffd| partir de Article 39
        Cacher_bloc_beneficiaires 'On n'a que 3 choix d'option avec article 39 (reversible ou pas et temporaire) donc pas besoin de b|fffd|n|fffd|ficiaires
        Cacher_bloc_reversataire
    End If
    
    If Range("Test_art83") = 83 Or Range("Test_art83") = 82 Then 'Si on cherche |fffd| |fffd|diter un titre de rente 83 ou 82 |fffd| partir de Article 83
        If Range("option_rente_art83") = "Avec r|fffd|version" Or Range("option_rente_art83") = "Annuit|fffd|s garanties avec r|fffd|version" Then 'Si l'option choisie est sans r|fffd|version
            Afficher_bloc_reversataire
        Else:
            Cacher_bloc_reversataire
        End If
    
        If Range("option_rente_art83") = "Sans r|fffd|version" Or Range("option_rente_art83") = "Avec r|fffd|version" Or Range("option_rente_art83") = "Paliers 70 et 75 ans" Then
            Cacher_bloc_beneficiaires
        Else:
            Afficher_bloc_beneficiaires
        End If
    End If


    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 1
     Case_nom_beneficiaire1.Visible = False
     Nom_beneficiaire1.Visible = False
     Case_nom_naissance_beneficiaire1.Visible = False
     Nom_naissance_beneficiaire1.Visible = False
     Case_prenom_beneficiaire1.Visible = False
     Prenom_beneficiaire1.Visible = False
     Case_lien_parente_beneficiaire1.Visible = False
     Lien_parente_beneficiaire1.Visible = False
     Case_commune_naissance_beneficiaire1.Visible = False
     Commune_naissance_beneficiaire1.Visible = False
     Pourcentage_beneficiaire_1.Visible = False
     Case_date_nais_beneficiaire1.Visible = False
     Date_nais_beneficiaire1.Visible = False


    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = False
    Nom_beneficiaire2.Visible = False
    Case_nom_naissance_beneficiaire2.Visible = False
    Nom_naissance_beneficiaire2.Visible = False
    Case_prenom_beneficiaire2.Visible = False
    Prenom_beneficiaire2.Visible = False
    Case_lien_parente_beneficiaire2.Visible = False
    Lien_parente_beneficiaire2.Visible = False
    Case_commune_naissance_beneficiaire2.Visible = False
    Commune_naissance_beneficiaire2.Visible = False
    Pourcentage_beneficiaire_2.Visible = False
    Case_date_nais_beneficiaire2.Visible = False
    Date_nais_beneficiaire2.Visible = False


    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = False
    Nom_beneficiaire3.Visible = False
    Case_nom_naissance_beneficiaire3.Visible = False
    Nom_naissance_beneficiaire3.Visible = False
    Case_prenom_beneficiaire3.Visible = False
    Prenom_beneficiaire3.Visible = False
    Case_lien_parente_beneficiaire3.Visible = False
    Lien_parente_beneficiaire3.Visible = False
    Case_commune_naissance_beneficiaire3.Visible = False
    Commune_naissance_beneficiaire3.Visible = False
    Pourcentage_beneficiaire_3.Visible = False
    Case_date_nais_beneficiaire3.Visible = False
    Date_nais_beneficiaire3.Visible = False

    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False

    Pourcentage_de_repartition.Visible = False
    
    'On affiche le bouton Ok
    Bouton_Ok.Visible = True
    
Else: UserForm_Initialize
End If
End Sub

Private Sub Nom_beneficiaire1_Change()
Range("Case_nom_benef1") = "Nom b|fffd|n|fffd|ficiaire 1"
Range("Nom_benef1") = Nom_beneficiaire1.Value 'On copie le nom du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Nom_beneficiaire2_Change()
Range("Case_nom_benef2") = "Nom b|fffd|n|fffd|ficiaire 2"
Range("Nom_benef2") = Nom_beneficiaire2.Value 'On copie le nom du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Nom_beneficiaire3_Change()
Range("Case_nom_benef3") = "Nom b|fffd|n|fffd|ficiaire 3"
Range("Nom_benef3") = Nom_beneficiaire3.Value 'On copie le nom du b|fffd|n|fffd|ficiaire 3
End Sub

Private Sub Nom_beneficiaire4_Change()
Range("Case_nom_benef4") = "Nom b|fffd|n|fffd|ficiaire 4"
Range("Nom_benef4") = Nom_beneficiaire4.Value 'On copie le nom du b|fffd|n|fffd|ficiaire 4
End Sub

Private Sub Nom_naissance_beneficiaire1_Change()
Range("Case_nom_naissance_benef1") = "Nom de naissance du b|fffd|n|fffd|ficiaire 1"
Range("Nom_naissance_benef1") = Nom_naissance_beneficiaire1.Value 'On copie le nom de naissance du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Nom_naissance_beneficiaire2_Change()
Range("Case_nom_naissance_benef2") = "Nom de naissance du b|fffd|n|fffd|ficiaire 2"
Range("Nom_naissance_benef2") = Nom_naissance_beneficiaire2.Value 'On copie le nom de naissance du b|fffd|n|fffd|ficiaire 2
End Sub

Private Sub Nom_naissance_beneficiaire3_Change()
Range("Case_nom_naissance_benef3") = "Nom de naissance du b|fffd|n|fffd|ficiaire 3"
Range("Nom_naissance_benef3") = Nom_naissance_beneficiaire3.Value 'On copie le nom de naissance du b|fffd|n|fffd|ficiaire 3
End Sub

Private Sub Nom_naissance_beneficiaire4_Change()
Range("Case_nom_naissance_benef4") = "Nom de naissance du b|fffd|n|fffd|ficiaire 4"
Range("Nom_naissance_benef4") = Nom_naissance_beneficiaire4.Value 'On copie le nom de naissance du b|fffd|n|fffd|ficiaire 4
End Sub

Private Sub Numero_rente_Change()
Range("Num_rente_bar83") = Numero_rente.Value 'On copie le num|fffd|ro de rente
End Sub

Private Sub Pas_dexoneration_Click()
'Pr|fffd|levements sociaux : R|fffd|gime sans exon|fffd|ration
  If Pas_dexoneration.Value = True Then
        
        Exoneration_partielle.Value = False
        Range("PS_exo_partielle").Value = ""
        Etranger.Value = False
        Range("PS_etranger").Value = ""
        Exoneration_totale.Value = False
        
        Range("PS_sans_exo").Value = 1
        
        'Calcul du montant net de la rente
        
        If Range("Test_bar83").Value = 83 Then
            Range("Montant_net_bar83") = Range("Montant_brut_bar83") * (1 - Range("Tx_PS_sans_exo"))
        End If
        
        If Range("Test_bar83").Value = 82 Then
            Range("Montant_net_bar83") = Range("Montant_brut_bar83") * 0.99 ' on prend juste l'assurance maladie |fffd| 1%
        End If
        
        
        If Range("Test_bar39").Value = 1 Then
            Range("Montant_net_bar39") = Range("Montant_brut_bar39") * (1 - Range("Tx_PS_sans_exo")) - Range("Mt_contribution_specifique_art39")
        End If
        
        If Range("Test_art83").Value = 83 Then
            Range("Montant_net_art83") = Range("Montant_brut_art83") * (1 - Range("Tx_PS_sans_exo"))
        End If
        
        If Range("Test_art83").Value = 82 Then
            Range("Montant_net_art83") = Range("Montant_brut_art83") * 0.99 ' on prend juste l'assurance maladie |fffd| 1%
        End If
        
        If Range("Test_art39").Value = 1 Then
            Range("Montant_net_art39") = Range("Montant_brut_art39") * (1 - Range("Tx_PS_sans_exo")) - Range("Mt_contribution_specifique_art39")
        End If
        
    Else: Range("PS_sans_exo").Value = ""
    End If
 
End Sub

Private Sub Pourcentage_beneficiaire_1_Change()
Range("Case_pourcentage_rep_benef1") = "Pourcentage de r|fffd|partition"
Range("Pourcentage_rep_benef1") = Pourcentage_beneficiaire_1.Value 'On copie le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Pourcentage_beneficiaire_1_AfterUpdate()
If Not IsNumeric(Pourcentage_beneficiaire_1.Value) Then
    MsgBox ("Le format saisi pour le pourcentage n'est pas valide")
    Formulaire.Pourcentage_beneficiaire_1 = Null
    Formulaire.Pourcentage_beneficiaire_1.SetFocus
End If
End Sub


Private Sub Pourcentage_beneficiaire_2_Change()
Range("Case_pourcentage_rep_benef2") = "Pourcentage de r|fffd|partition"
Range("Pourcentage_rep_benef2") = Pourcentage_beneficiaire_2.Value 'On copie le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Pourcentage_beneficiaire_2_AfterUpdate()
If Not IsNumeric(Pourcentage_beneficiaire_2.Value) Then
    MsgBox ("Le format saisi pour le pourcentage n'est pas valide")
    Formulaire.Pourcentage_beneficiaire_2 = Null
    Formulaire.Pourcentage_beneficiaire_2.SetFocus
End If
End Sub

Private Sub Pourcentage_beneficiaire_3_Change()
Range("Case_pourcentage_rep_benef3") = "Pourcentage de r|fffd|partition"
Range("Pourcentage_rep_benef3") = Pourcentage_beneficiaire_3.Value 'On copie le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Pourcentage_beneficiaire_3_AfterUpdate()
If Not IsNumeric(Pourcentage_beneficiaire_3.Value) Then
    MsgBox ("Le format saisi pour le pourcentage n'est pas valide")
    Formulaire.Pourcentage_beneficiaire_3 = Null
    Formulaire.Pourcentage_beneficiaire_3.SetFocus
End If
End Sub

Private Sub Pourcentage_beneficiaire_4_Change()
Range("Case_pourcentage_rep_benef4") = "Pourcentage de r|fffd|partition"
Range("Pourcentage_rep_benef4") = Pourcentage_beneficiaire_4.Value 'On copie le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Pourcentage_beneficiaire_4_AfterUpdate()
If Not IsNumeric(Pourcentage_beneficiaire_4.Value) Then
    MsgBox ("Le format saisi pour le pourcentage n'est pas valide")
    Formulaire.Pourcentage_beneficiaire_4 = Null
    Formulaire.Pourcentage_beneficiaire_4.SetFocus
End If
End Sub
Private Sub Prenom_beneficiaire1_Change()
Range("Case_prenom_benef1") = "Pr|fffd|nom b|fffd|n|fffd|ficiaire 1"
Range("Prenom_benef1") = Prenom_beneficiaire1.Value 'On copie le prenom du b|fffd|n|fffd|ficiaire 1
End Sub

Private Sub Prenom_beneficiaire2_Change()
Range("Case_prenom_benef2") = "Pr|fffd|nom b|fffd|n|fffd|ficiaire 2"
Range("Prenom_benef2") = Prenom_beneficiaire2.Value 'On copie le pr|fffd|nom du b|fffd|n|fffd|ficiaire 2
End Sub

Private Sub Prenom_beneficiaire3_Change()
Range("Case_prenom_benef3") = "Pr|fffd|nom b|fffd|n|fffd|ficiaire 3"
Range("Prenom_benef3") = Prenom_beneficiaire3.Value 'On copie le pr|fffd|nom du b|fffd|n|fffd|ficiaire 3
End Sub

Private Sub Prenom_beneficiaire4_Change()
Range("Case_prenom_benef4") = "Pr|fffd|nom b|fffd|n|fffd|ficiaire 4"
Range("Prenom_benef4") = Prenom_beneficiaire4.Value 'On copie le pr|fffd|nom du b|fffd|n|fffd|ficiaire 4
End Sub

Private Sub Rachat_rente_Click()

If Rachat_rente.Value = True Then

    Mise_en_service_rente.Value = False
    Regularisation_rente.Value = False
    
    
    'On affiche tout le bloc "Coordonn|fffd|es et r|fffd|f|fffd|rences assur|fffd|"
        '-- ajout net 480
    Net_480.Visible = True
    Txt_Net_480.Visible = True
    Net_480.Enabled = True
    Txt_Net_480.Enabled = True
    
    '-------
    Coordonn|fffd|es_assur|fffd|.Visible = True
    Case_adresse.Visible = True
    Adresse.Visible = True
    Case_compl|fffd|ment_adresse.Visible = True
    Complement_adresse.Visible = True
    Case_code_postal.Visible = True
    Code_postal.Visible = True
    Case_commune.Visible = True
    Commune.Visible = True
    Case_pays.Visible = True
    Pays.Visible = True
    Case_reference_entreprise.Visible = True
    Reference_entreprise.Visible = True
    Case_adhesion.Visible = True
    Adhesion.Visible = True
    Case_numero_rente.Visible = True
    Numero_rente.Visible = True
    Case_demande.Visible = True
    Demande.Visible = True
    PS.Visible = True
    Pas_dexoneration.Visible = True
    Exoneration_partielle.Visible = True
    Etranger.Visible = True
    Exoneration_totale.Visible = True
    Rappel_sexe_assur|fffd|.Visible = True
    Liste_sexe_assur|fffd|.Visible = True
    Tarif.Visible = False
    Liste_tarif.Visible = False
    Garantie_dep.Visible = False
    Liste_garantie_dep.Visible = False
   
    'On affiche le bouton Ok
    Bouton_Ok.Visible = True
   
Else: UserForm_Initialize
End If

End Sub

Private Sub Reference_entreprise_Change()
Range("Ref_entreprise_bar83") = Reference_entreprise.Value 'On copie la r|fffd|f|fffd|rence de l'entreprise
End Sub

Function Cacher_bloc_beneficiaires()

Coordonnees_beneficiaire.Visible = False
Nombre_beneficiaires.Visible = False
Choix_1beneficiaire.Visible = False
Choix_2beneficiaires.Visible = False
Choix_3beneficiaires.Visible = False
Choix_4beneficiaires.Visible = False
Pourcentage_de_repartition.Visible = False
Aucun_benef.Visible = False

    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 1
    Case_nom_beneficiaire1.Visible = False
    Nom_beneficiaire1.Visible = False
    Case_nom_naissance_beneficiaire1.Visible = False
    Nom_naissance_beneficiaire1.Visible = False
    Case_prenom_beneficiaire1.Visible = False
    Prenom_beneficiaire1.Visible = False
    Case_lien_parente_beneficiaire1.Visible = False
    Lien_parente_beneficiaire1.Visible = False
    Case_commune_naissance_beneficiaire1.Visible = False
    Commune_naissance_beneficiaire1.Visible = False
    Pourcentage_beneficiaire_1.Visible = False
    Case_date_nais_beneficiaire1.Visible = False
    Date_nais_beneficiaire1.Visible = False
    
        

    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 2
    Case_nom_beneficiaire2.Visible = False
    Nom_beneficiaire2.Visible = False
    Case_nom_naissance_beneficiaire2.Visible = False
    Nom_naissance_beneficiaire2.Visible = False
    Case_prenom_beneficiaire2.Visible = False
    Prenom_beneficiaire2.Visible = False
    Case_lien_parente_beneficiaire2.Visible = False
    Lien_parente_beneficiaire2.Visible = False
    Case_commune_naissance_beneficiaire2.Visible = False
    Commune_naissance_beneficiaire2.Visible = False
    Pourcentage_beneficiaire_2.Visible = False
    Case_date_nais_beneficiaire2.Visible = False
    Date_nais_beneficiaire2.Visible = False
    
    
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 3
    Case_nom_beneficiaire3.Visible = False
    Nom_beneficiaire3.Visible = False
    Case_nom_naissance_beneficiaire3.Visible = False
    Nom_naissance_beneficiaire3.Visible = False
    Case_prenom_beneficiaire3.Visible = False
    Prenom_beneficiaire3.Visible = False
    Case_lien_parente_beneficiaire3.Visible = False
    Lien_parente_beneficiaire3.Visible = False
    Case_commune_naissance_beneficiaire3.Visible = False
    Commune_naissance_beneficiaire3.Visible = False
    Pourcentage_beneficiaire_3.Visible = False
    Case_date_nais_beneficiaire3.Visible = False
    Date_nais_beneficiaire3.Visible = False
    
    'On cache tout le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire 4
    Case_nom_beneficiaire4.Visible = False
    Nom_beneficiaire4.Visible = False
    Case_nom_naissance_beneficiaire4.Visible = False
    Nom_naissance_beneficiaire4.Visible = False
    Case_prenom_beneficiaire4.Visible = False
    Prenom_beneficiaire4.Visible = False
    Case_lien_parente_beneficiaire4.Visible = False
    Lien_parente_beneficiaire4.Visible = False
    Case_commune_naissance_beneficiaire4.Visible = False
    Commune_naissance_beneficiaire4.Visible = False
    Pourcentage_beneficiaire_4.Visible = False
    Case_date_nais_beneficiaire4.Visible = False
    Date_nais_beneficiaire4.Visible = False

    'On supprime le bloc r|fffd|serv|fffd| aux b|fffd|n|fffd|ficiaires dans la feuille de synth|fffd|se
     
    Range("Case_nom_benef1") = ""
    Range("Nom_benef1") = ""
    Range("Case_nom_naissance_benef1") = ""
    Range("Nom_naissance_benef1") = ""
    Range("Case_prenom_benef1") = ""
    Range("Prenom_benef1") = ""
    Range("Case_lien_parente_benef1") = ""
    Range("Lien_parent|fffd|_benef1") = ""
    Range("Case_commune_naissance_benef1") = ""
    Range("Commune_naissance_benef1") = ""
    Range("Case_pourcentage_rep_benef1") = ""
    Range("Pourcentage_rep_benef1") = ""
    Range("Case_date_naissance_benef1") = ""
    Range("Date_naissance_benef1") = ""


End Function

Function Afficher_bloc_beneficiaires()

Coordonnees_beneficiaire.Visible = True
Nombre_beneficiaires.Visible = True
Choix_1beneficiaire.Visible = True
Choix_2beneficiaires.Visible = True
Choix_3beneficiaires.Visible = True
Choix_4beneficiaires.Visible = True
Pourcentage_de_repartition.Visible = True
Aucun_benef.Visible = True

'On affiche le bloc r|fffd|serv|fffd| au b|fffd|n|fffd|ficiaire dans la feuille de synth|fffd|se
 
 Range("Case_nom_benef1") = "Nom b|fffd|n|fffd|ficiaire 1"
 Range("Case_nom_naissance_benef1") = "Nom de naissance b|fffd|n|fffd|ficiaire 1  "
 Range("Case_prenom_benef1") = "Pr|fffd|nom b|fffd|n|fffd|ficiaire 1 "
 Range("Case_commune_naissance_benef1") = "Commune de naissance b|fffd|n|fffd|ficiaire 1 "
 Range("Case_lien_parente_benef1") = "Lien de parent|fffd| |fffd|ventuel"
 Range("Case_date_naissance_benef1") = "Date de naissance du b|fffd|n|fffd|ficiaire 1"
 Range("Case_pourcentage_rep_benef1") = "Pourcentage de r|fffd|partition"

End Function

Function Cacher_bloc_reversataire()

'On cache le bloc r|fffd|serv|fffd| aux coordonn|fffd|es du reversataire
Coordonnees_reversataire.Visible = False
Qualite_reversataire.Visible = False
Liste_qualite_reversataire.Visible = False

     
'On supprime le bloc r|fffd|serv|fffd| au r|fffd|versataire dans la feuille de synth|fffd|se - ne sert |fffd| rien, |fffd| supprimer !!!
Range("Case_qualite_reversataire") = "" 'ok aussi pour le 39 car toujours conjoint/ex-conjoint
    
End Function
Function Afficher_bloc_reversataire()

'On affiche le bloc r|fffd|serv|fffd| aux coordonn|fffd|es du reversataire
Coordonnees_reversataire.Visible = True
Qualite_reversataire.Visible = True
Liste_qualite_reversataire.Visible = True
   
'On affiche le bloc r|fffd|serv|fffd| au r|fffd|versataire dans la feuille de synth|fffd|se - ne sert |fffd| rien, |fffd| supprimer !!!
Range("Case_qualite_reversataire") = "Qualit|fffd| du r|fffd|versataire"
     
End Function


Private Sub Date_PP_Change()

If Date_PP.MaxLength = 10 Then 'Nombre de caract|fffd|res maxi autoris|fffd| pour la date
    
    Dim Valeur As Byte

    Valeur = Len(Date_PP)
    If Valeur = 2 Or Valeur = 5 Then Date_PP = Date_PP & "/"
    
End If

Date_PP.Value = Replace(Date_PP.Value, ".", ",")
Range("Date_PP") = Date_PP.Value

If Regularisation_rente.Value = True Then
    'Calcul du montant net du suppl|fffd|ment
    
    If Range("Test_bar83").Value = 83 Or Range("Test_art83").Value = 83 Then 'Si on fait une r|fffd|gularisation pour un 83
    
      If Etranger.Value = True Then
          Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value) * (1 - Range("Tx_PS_etranger"))
      End If
      
      If Exoneration_totale.Value = True Then Range("Sup_net") = CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value
      
      If Exoneration_partielle.Value = True Then
          Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value) * (1 - Range("Tx_PS_exo_partielle"))
      End If
    
      If Pas_dexoneration.Value = True Then
          Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value) * (1 - Range("Tx_PS_sans_exo"))
      End If
    
    End If

    If Range("Test_bar83").Value = 82 Or Range("Test_art83").Value = 82 Then 'Si on fait une r|fffd|gularisation pour un 82
        If Exoneration_totale.Value = True Then Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value)
        
        If Pas_dexoneration.Value = True Then
          Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value) * (1 - Range("AM"))
          
        End If
        
        If Etranger.Value = True Then
          Range("Sup_net") = (CDbl(Range("Date_PP").Value) / Range("Annuite_reg").Value) * (1 - Range("Tx_PS_etranger"))
        End If
        
        
    End If


End If


End Sub

Private Sub Date_PP_AfterUpdate()
    
Select Case Case_date_PP.Caption
Case "Date du premier paiement :"
       
    If IsDate(Date_PP) Then
        Date_PP = Format(Date_PP, "dd/mm/yyyy")
    Else
        MsgBox "LEA ne reconna|fffd|t pas la date que vous tentez d'entrer"
    End If
    Exit Sub
    
Case Else
    
    If Not IsNumeric(Date_PP) Then
        MsgBox "Veuillez saisir une donn|fffd|e num|fffd|rique"
    End If
    Exit Sub
    
End Select

End Sub

Private Sub Regularisation_rente_Click()

If Regularisation_rente.Value = True Then
    Mise_en_service_rente.Value = False
    Rachat_rente.Value = False
    Date_PP.MaxLength = 1000
    
    'On affiche tout le bloc "Coordonn|fffd|es et r|fffd|f|fffd|rences assur|fffd|"
        '-- ajout net 480
    Net_480.Visible = False
    Txt_Net_480.Visible = False
    Net_480.Enabled = False
    Txt_Net_480.Enabled = False
    
    '-------
    Coordonn|fffd|es_assur|fffd|.Visible = True
    Case_adresse.Visible = True
    Adresse.Visible = True
    Case_compl|fffd|ment_adresse.Visible = True
    Complement_adresse.Visible = True
    Case_code_postal.Visible = True
    Code_postal.Visible = True
    Case_commune.Visible = True
    Commune.Visible = True
    Case_pays.Visible = True
    Pays.Visible = True
    Case_reference_entreprise.Visible = True
    Reference_entreprise.Visible = True
    Case_adhesion.Visible = True
    Adhesion.Visible = True
    Case_numero_rente.Visible = True
    Numero_rente.Visible = True
    Case_demande.Visible = True
    Demande.Visible = True
    PS.Visible = True
    Pas_dexoneration.Visible = True
    Exoneration_partielle.Visible = True
    Etranger.Visible = True
    Exoneration_totale.Visible = True
    Rappel_sexe_assur|fffd|.Visible = True
    Liste_sexe_assur|fffd|.Visible = True
    Tarif.Visible = False
    Liste_tarif.Visible = False
    Garantie_dep.Visible = False
    Liste_garantie_dep.Visible = False
   
    'On affiche le bouton Ok
    Bouton_Ok.Visible = True
   
    'Initialisation du bloc concernant la r|fffd|gularisation

    Concernant_PP.Visible = True
    Concernant_PP.Caption = "Concernant la r|fffd|gularisation"
    Range("Case_date_PP").Value = "Montant suppl|fffd|mentaire apr|fffd|s la r|fffd|gularisation"
    Range("Case_sup_net").Value = "Montant suppl|fffd|mentaire net"
    Premier_paiement.Visible = False
    Liste_premier_paiement.Visible = False
    Case_date_PP.Visible = True
    Case_date_PP.Caption = "Montant de la cotisation suppl|fffd|mentaire :"
    Date_PP.Visible = True
    P|fffd|riode.Visible = True
    P|fffd|riode.Caption = "Pour la p|fffd|riode du :"
    Date_debut.Visible = True
    Au.Visible = True
    Date_fin.Visible = True
    
Else: UserForm_Initialize

End If


End Sub

Private Sub UserForm_Initialize()

If Range("Test_bar83").Value = 82 Or Range("Test_art83").Value = 82 Then
    Exoneration_partielle.Enabled = False
    Exoneration_partielle.Value = False
End If

If Range("Test_bar39").Value = 1 Or Range("Test_art39").Value = 1 Then
    Regularisation_rente.Enabled = False
    
End If

'Code pour bloquer le choix *Rachat de rente* pour les rentes annuelles > 480 euros brut
If Range("Test_bar83") = 82 Or Range("Test_bar83") = 83 Then
    If Range("Montant_brut_bar83") > 480 Then
        Rachat_rente.Enabled = False
        Rachat_rente.Value = False
    Else: Rachat_rente.Enabled = True
    End If
End If

If Range("Test_art83") = 82 Or Range("Test_art83") = 83 Then
    If Range("Montant_brut_art83") > 480 Then
        Rachat_rente.Enabled = False
        Rachat_rente.Value = False
    Else: Rachat_rente.Enabled = True
    End If
End If

If Range("Test_bar39") = 1 Then
    If Range("Montant_brut_bar39") > 480 Then
        Rachat_rente.Enabled = False
        Rachat_rente.Value = False
    Else: Rachat_rente.Enabled = True
    End If
End If

If Range("Test_art39") = 1 Then
    If Range("Montant_brut_art39") > 480 Then
        Rachat_rente.Enabled = False
        Rachat_rente.Value = False
    Else: Rachat_rente.Enabled = True
    End If
End If


If Liste_sexe_assur|fffd|.ListCount < 2 Then
'D|fffd|finition de la liste d|fffd|roulante pour le sexe de l'assur|fffd|
Liste_sexe_assur|fffd|.AddItem "H"
Liste_sexe_assur|fffd|.AddItem "F"
End If


If Range("Test_art39").Value = "" And Range("Test_bar39").Value = "" Then
    If Liste_qualite_reversataire.ListCount < 2 Then
    'D|fffd|finition de la liste d|fffd|roulante pour la qualit|fffd| du conjoint 83
    Liste_qualite_reversataire.AddItem "Conjoint/Ex-conjoint"
    'Liste_qualite_reversataire.AddItem "Ex-conjoint"
    Liste_qualite_reversataire.AddItem "Ajout PACS"
    End If
End If


' A reprendre, il faut masquer cela pour le 39
If Range("Test_bar39").Value = 1 Or Range("Test_art39").Value = 1 Then
    
    Date_PP.Visible = False
    Case_date_PP.Caption = ""
    
'    ' On cache la r|fffd|version car pas utile pour un 39
'Coordonnees_reversataire.Visible = False
'Qualite_reversataire.Visible = False
'Liste_qualite_reversataire.Visible = False

End If

If Liste_tarif.ListCount < 2 Then
'D|fffd|finition de la liste d|fffd|roulante pour le tarif du contrat
Liste_tarif.AddItem "r|fffd|glementaire en vigueur"
Liste_tarif.AddItem "contractuel"
End If

If Liste_premier_paiement.ListCount < 2 Then
'D|fffd|finition de la liste d|fffd|roulante pour savoir si le premier paiement a |fffd|t|fffd| effectu|fffd| avant l'envoi du courrier
Liste_premier_paiement.AddItem "Oui"
Liste_premier_paiement.AddItem "Non"
End If

If Liste_garantie_dep.ListCount < 2 Then
'D|fffd|finition de la liste d|fffd|roulante pour savoir si la garantie d|fffd|pendance a |fffd|t|fffd| choisie
Liste_garantie_dep.AddItem "Oui"
Liste_garantie_dep.AddItem "Non"
End If
'On cache tout le bloc "Coordonn|fffd|es et r|fffd|f|fffd|rences assur|fffd|"

'Initialisation Valeur
Coordonn|fffd|es_assur|fffd|.Visible = False
Case_adresse.Visible = False
Adresse.Visible = False
Case_compl|fffd|ment_adresse.Visible = False
Complement_adresse.Visible = False
Case_code_postal.Visible = False
Code_postal.Visible = False
Case_commune.Visible = False
Commune.Visible = False
Case_pays.Visible = False
Pays.Visible = False
Case_reference_entreprise.Visible = False
Reference_entreprise.Visible = False
Case_adhesion.Visible = False
Adhesion.Visible = False
Case_numero_rente.Visible = False
Numero_rente.Visible = False
Case_demande.Visible = False
Demande.Visible = False
PS.Visible = False
Pas_dexoneration.Visible = False
Exoneration_partielle.Visible = False
Etranger.Visible = False
Exoneration_totale.Visible = False
Rappel_sexe_assur|fffd|.Visible = False
Liste_sexe_assur|fffd|.Visible = False
Tarif.Visible = False
Liste_tarif.Visible = False
Garantie_dep.Visible = False
Liste_garantie_dep.Visible = False
    
Net_480.Visible = False
Txt_Net_480.Visible = False
Net_480.Enabled = False
Txt_Net_480.Enabled = False

'On cache tout le bloc "Concernant le premier paiement
Concernant_PP.Visible = False
Premier_paiement.Visible = False
Liste_premier_paiement.Visible = False
P|fffd|riode.Visible = False
Date_debut.Visible = False
Au.Visible = False
Date_fin.Visible = False
Case_date_PP.Visible = False
Date_PP.Visible = False


'On cache tout le bloc "Coordon|fffd|es r|fffd|versataire"
Coordonnees_reversataire.Visible = False
Qualite_reversataire.Visible = False
Liste_qualite_reversataire.Visible = False

'On cache le bouton Ok
Bouton_Ok.Visible = False

Cacher_bloc_beneficiaires

End Sub



Attribute VB_Name = "H|fffd|pBis"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub H|fffd|pBisQuit_Click()
Bar|fffd|me.Visible = True
Worksheets("MajoLeg").Visible = True
Bar|fffd|me.Select
Worksheets("H|fffd|p").Visible = False
Worksheets("H|fffd|pBis").Visible = False
End Sub

Private Sub Worksheet_Activate()
Call CalculerHopitaux2
End Sub


Function CalculerHopitaux2()
Dim Tx As Double
ActiveSheet.Unprotect
Tx = Bar|fffd|me.Range("TxTech").Value

If Bar|fffd|me.Fractionnement.Value <> "Trimestriel" Then
  Bar|fffd|me.Fractionnement.Value = "Trimestriel"
  MsgBox "Le fractionnement a |fffd|t|fffd| modifi|fffd| en trimestriel", , "Information"
End If
If Bar|fffd|me.Terme.Value <> "Avance" Then
  Bar|fffd|me.Terme.Value = "Avance"
  MsgBox "Le terme a |fffd|t|fffd| modifi|fffd| en avance", , "Information"
End If
If Bar|fffd|me.Range("TxTech").Value <> 1.75 Then
  Bar|fffd|me.Range("TxTech").Value = 1.75
  'MsgBox "Le taux technique a |fffd|t|fffd| ramen|fffd| |fffd| 1.75", , "Information"
End If

Select Case Bar|fffd|me.ModificationAge
Case True:  Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
            Worksheets("H|fffd|pBis").Range("HopBisCoefProrog").Value = Bar|fffd|me.Range("CoefA").Value
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP1.75").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.75").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.5").Value = Bar|fffd|me.Range("CoefA").Value '
            Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 ' m|fffd|j 2018
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.25").Value = Bar|fffd|me.Range("CoefA").Value ' m|fffd|j 2018
Case False: Worksheets("H|fffd|pBis").Range("HopBisCoefProrog").Value = 1
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP1.75").Value = 1
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.75").Value = 1
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.5").Value = 1 '
            Worksheets("H|fffd|pBis").Range("HopBisCoefAP0.25").Value = 1 ' m|fffd|j 2018
End Select

Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 0: Worksheets("H|fffd|pBis").Range("HopBisCoefRev1.75").Value = 1
        Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.75").Value = 1
        Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.5").Value = 1
        Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.25").Value = 1 ' m|fffd|j 2018
        Worksheets("H|fffd|pBis").Range("HopBisCoefRev").Value = 1
        Select Case Bar|fffd|me.ModificationAge
        Case True
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 'm|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value ' m|fffd|j 2018
        Case False
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|").Value '
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 ' m|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|").Value ' m|fffd|j 2018
        End Select
Case 1: Select Case Bar|fffd|me.ModificationAge
        Case True
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev1.75").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.75").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.5").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 ' m|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value ' m|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.25").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value ' m|fffd|j 2018
        Case False
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev1.75").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.75").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.5").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 ' m|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value ' m|fffd|j 2018
          Worksheets("H|fffd|pBis").Range("HopBisCoefRev0.25").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value ' m|fffd|j 2018
        End Select
End Select

Bar|fffd|me.Range("TxTech").Value = Tx
ActiveSheet.Protect
End Function





Attribute VB_Name = "Init_Synth|fffd|se"
Sub Initialisation_Feuille_Synthese()


Range("Test_bar83") = ""
Range("Test_bar39") = ""
Range("Test_art83") = ""
Range("Test_art39") = ""

Range("PS_sans_exo") = ""
Range("PS_exo_partielle") = ""
Range("Nb_benef") = ""
Range("PS_etranger") = ""
Range("Sup_net").Value = ""
Range("Date_PP").Value = ""
Range("Date_deb") = ""
Range("Date_f") = ""
Range("Premier_paiement") = ""
Range("Garantie_dep") = ""
Range("Tarif") = ""
Range("Tx_arr") = ""
Range("Sup_net") = ""


Range("Sexe_assur|fffd|") = ""
Range("Adresse_assur|fffd|") = ""
Range("Comp_adresse_assur|fffd|") = ""
Range("Code_postal_assur|fffd|") = ""
Range("Commune_assur|fffd|") = ""
Range("Pays_assur|fffd|") = ""

Range("Qualite_reversataire") = ""

End Sub
Attribute VB_Name = "MdP"
Attribute VB_Base = "0{5E9F1151-CEDD-4184-9BC4-34AB1A8905D4}{598A8695-19AD-4C16-82E5-DEF3086D5B34}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub AnnuleMdP_Click()
ActiveWorkbook.Close SaveChanges:=False
End Sub

Private Sub UserForm_Terminate()
MsgBox ("Fermeture de cette fen|fffd|tre non autoris|fffd|e")
ActiveWorkbook.Close SaveChanges:=False
End Sub

Private Sub ValidMdP_Click()
If Utilisateur = "Gestion" Then
  If MdP.TxtMdP.Value <> "baremancien" Then
    Call MsgBox("Mot de passe erron|fffd|", vbOKOnly)
    'ActiveWorkbook.Close SaveChanges:=False
  Else
    MdP.Hide
  End If
Else
  MdP.Hide
End If
End Sub
Attribute VB_Name = "Module11"
Option Explicit

Global TablesTxR|fffd|v(4) As Double

Function taille(Optional Range As Variant = 0) As Long
Dim a As Variant
taille = 1
On Error GoTo fin


If Range.Rows.Count > 1 And Range.Columns.Count > 1 Then
taille = Range.Rows.Count
Else
If Range.Rows.Count > 1 Or Range.Columns.Count > 1 Then taille = 0
End If
fin:

End Function

Function hauteur(cell As Range) As Double
hauteur = cell.Top
End Function




Attribute VB_Name = "Module2"
Global AgeVersement As Double

Function axeT(ByVal AgeCalcul As Double, ByVal AnNaiss As Integer, ByVal AgeR|fffd|v1 As Double, _
    ByVal AgeR|fffd|v2 As Double, ByVal AgeR|fffd|v3 As Double, ByVal AgeR|fffd|v4 As Double, _
    ByVal AnNaissR|fffd|v1 As Integer, ByVal AnNaissR|fffd|v2 As Integer, ByVal AnNaissR|fffd|v3 As Integer, _
    ByVal AnNaissR|fffd|v4 As Integer, ByVal AgeEffet As Double, Table As String, _
    TableR|fffd|v1 As String, TableR|fffd|v2 As String, TableR|fffd|v3 As String, _
    TableR|fffd|v4 As String, ByVal TauxR|fffd|v1 As Double, ByVal TauxR|fffd|v2 As Double, _
    ByVal TauxR|fffd|v3 As Double, ByVal TauxR|fffd|v4 As Double, ByVal AgeMinRev As Double, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional ByVal DureeDMarriageR|fffd|v1 As Double = 1, _
    Optional ByVal DureeDMarriageR|fffd|v2 As Double = 1, Optional ByVal DureeDMarriageR|fffd|v3 As Double = 1, _
    Optional ByVal DureeDMarriageR|fffd|v4 As Double = 1)

'Tenir compte dans les calculs de r|fffd|version des ann|fffd|es de marriage

If AgeCalcul = 0 Or AgeEffet = 0 Or AnNaiss = 0 Then
axeT = 0
Exit Function
End If

Dim VprR As Variant
Dim i As Integer
Dim j As Integer
Dim EcartsAges As Double
Dim VAgeAss As Variant
Dim tabl As String
Dim VprR1() As Double
Dim VprR2() As Double
Dim VprR3() As Double
Dim VprR4() As Double
Dim R|fffd|ver As Double
Dim DMT As Double
Dim VProbaAss As Variant
Dim AnNaissR As Integer


'--------Deux formats possibles pour certaines variables: tableau 4x2 ou variable unique
'If AnNaissR|fffd|v1 <> 0.1 Then  ' Si AnNaiss=0.1 c'est que les tableaux ont d|fffd|j|fffd| |fffd|t|fffd| modifi|fffd|s par axeTd

    If taille(TabTauxCroiss) = 0 Or (taille(TabTauxCroiss) <> 1 And taille(TabTauxCroiss) <> 4) Then
    MsgBox "le format des donn|fffd|es pour la croissance par palier n'est pas compatible"
    Exit Function
    End If
    
    If taille(TabTauxCroiss) = 1 Then
        CroissPalier(1, 1) = 70
        CroissPalier(1, 2) = TabTauxCroiss
        CroissPalier(2, 1) = 75
        CroissPalier(2, 2) = TabTauxCroiss
        CroissPalier(3, 1) = 0
        CroissPalier(3, 2) = 0
        CroissPalier(4, 1) = 0
        CroissPalier(4, 2) = 0
    Else
    For i = 1 To 4
    For j = 1 To 2
    CroissPalier(i, j) = TabTauxCroiss(i, j)
    Next j
    Next i
    End If
    
    If taille(TxTech) = 0 Or (taille(TxTech) <> 1 And taille(TxTech) <> 4) Then
    MsgBox "le format des donn|fffd|es pour le taux technique n'est pas compatible"
    Exit Function
    End If
    
    If taille(TxTech) > 1 Then
    For i = 1 To 4
    For j = 1 To 2
    TauxTech(i, j) = TxTech(i, j)
    Next j
    Next i
    Else
        TauxTech(1, 1) = 0
        TauxTech(1, 2) = TxTech
        TauxTech(2, 1) = DurCrt
        TauxTech(2, 2) = TxTechLg
        TauxTech(3, 1) = 0
        TauxTech(3, 2) = TxTechLg
        TauxTech(4, 1) = 0
        TauxTech(4, 2) = TxTechLg
    End If
    
    'If taille(AgeR|fffd|v) = 0 Or (taille(AgeR|fffd|v) <> 1 And taille(AgeR|fffd|v) <> 4) Then
    'MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    'Exit Function
    'End If
    
    AgesR|fffd|v(1, 1) = AgeR|fffd|v1
    AgesR|fffd|v(1, 2) = DureeDMarriageR|fffd|v1
    AgesR|fffd|v(2, 1) = AgeR|fffd|v2
    AgesR|fffd|v(2, 2) = DureeDMarriageR|fffd|v2
    AgesR|fffd|v(3, 1) = AgeR|fffd|v3
    AgesR|fffd|v(3, 2) = DureeDMarriageR|fffd|v3
    AgesR|fffd|v(4, 1) = AgeR|fffd|v4
    AgesR|fffd|v(4, 2) = DureeDMarriageR|fffd|v4
    


    'If taille(TableR|fffd|v) = 0 Or (taille(TableR|fffd|v) <> 1 And taille(TableR|fffd|v) <> 4) Then
    'MsgBox "le format des donn|fffd|es pour le r|fffd|versataire n'est pas compatible"
    'Exit Function
    'End If
    
    Tablesr|fffd|v(1, 1) = AnNaissR|fffd|v1
    Tablesr|fffd|v(1, 2) = TableR|fffd|v1
    Tablesr|fffd|v(2, 1) = AnNaissR|fffd|v2
    Tablesr|fffd|v(2, 2) = TableR|fffd|v2
    Tablesr|fffd|v(3, 1) = AnNaissR|fffd|v3
    Tablesr|fffd|v(3, 2) = TableR|fffd|v3
    Tablesr|fffd|v(4, 1) = AnNaissR|fffd|v4
    Tablesr|fffd|v(4, 2) = TableR|fffd|v4
    
'Else
'    For i = 1 To 4
'    For j = 1 To 2
'    TablesR|fffd|v(i, j) = TableR|fffd|v(i, j)
'    Next j
'    Next i
'End If




'----------------------Fin des modifications de format

'------Approximation de l'|fffd|ge
Dim age As Double
age = AgeCalcul
AgeCalcul = Approximage3(age, Approx)
AgeEffet = AgeEffet + AgeCalcul - age

If TauxR|fffd|v <> 0 Then R|fffd|ver = 0 Else R|fffd|ver = 1

Dim Pro As Double

Pro = 0

If (ProrataD|fffd|c|fffd|s = "Complet" Or ProrataD|fffd|c|fffd|s = "COMP") And UCase(Terme) <> "AVANCE" Then Pro = 1
If (ProrataD|fffd|c|fffd|s = "Prorata" Or ProrataD|fffd|c|fffd|s = "PROP") And UCase(Terme) <> "AVANCE" Then Pro = 0.5 'Hyp d|fffd|c|fffd|s en milieu d'ann|fffd|e.

axeT = 0

'------Vecteurs g|fffd|n|fffd|raux & concernant l'assur|fffd|
VectAge = VAge(AgeCalcul, AgeEffet, Frac, AgeFin, AgesR|fffd|v)

If UCase(Terme) = "ECHU" Then
  If Round(AgeVersement, 3) = Round(AgeCalcul + 0.002, 3) Then
    For i = 2 To UBound(VectAge)
      VectAge(i) = VectAge(i) - 0.002
    Next i
  Else
    For i = 2 To UBound(VectAge)
      VectAge(i) = VectAge(i) - 0.003
    Next i
  End If
End If
VectActu = VActu(TauxTech, AgeCalcul, AgeEffet)
VectProba = VProba(Terme, AnNaiss, Table, AgeCalcul, AgeEffet, AG)
VectFlux = VFlux(Terme, AgeCalcul, AgeEffet, Frac, CroissPalier, TxFraisDiff, AgeFinDiff)

'VectAge = VAge(AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FracAgeDet").Value, wD|fffd|tailAge.Range("AgeFinDet").Value, AgesR|fffd|v)
'VectActu = VActu(TauxTech, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FraisDiffere").Value, wD|fffd|tailAge.Range("AgeFinDiffere").Value)
'VectProba = VProba(wD|fffd|tailAge.Range("TermeAgeDet").Value, Int(wD|fffd|tailAge.Range("AnNaissDet").Value), wD|fffd|tailAge.Range("Table2AgeDet").Value, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("AGAgeDet").Value)
'VectFlux = VFlux(wD|fffd|tailAge.Range("TermeAgeDet").Value, AgeCalcul, AgeEffet, wD|fffd|tailAge.Range("FracAgeDet").Value, CroissPalier)

'------Option Croissance annuelle
If TxRegr <> 0 Then
    Dim T As Double
    Dim k As Integer
    Dim Dep As Integer
    T = VectAge(0)
    k = -1
    Dep = 0
    If UCase(Terme) = "AVANCE" Then Dep = -1
    
    For i = 1 To UBound(VectAge)
    If VectAge(i + Dep) - T >= 1 Then
        T = VectAge(i + Dep)
        k = k + 1
    End If
    VectFlux(i) = VectFlux(i) * (1 + TxRegr) ^ k
    Next i
End If

'------Calcul des arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s
axeT = axeT + Arreragesmajdc(TxArr, Terme, Frac)

'------Annuit|fffd| sans r|fffd|version
axeT = axeT + VectActu(1) * VectProba(1) * VectFlux(1) + (1 - VectProba(1)) * VectFlux(1) * VectActu(1) * R|fffd|ver * Pro  ' *R|fffd|ver car s'il existe un r|fffd|versataire, la rente lui sera vers|fffd|e donc on ne tient pas compte du prorata

For i = 2 To UBound(VectAge)
    axeT = axeT + VectActu(i) * VectProba(i) * VectFlux(i) + (VectProba(i - 1) - VectProba(i)) * VectFlux(i) * VectActu(i) * R|fffd|ver * Pro
 
Next i



'------Ajout de la r|fffd|version, possibilit|fffd| d'avoir jusqu'|fffd| 4 r|fffd|versataires

ReDim VProbaAss(UBound(VectAge))
VProbaAss = VectProba
VAgeAss = VectAge
Dim MiniRev As Integer


If TauxR|fffd|v1 <> 0 Then
DMT = AgesR|fffd|v(1, 2) + AgesR|fffd|v(2, 2) + AgesR|fffd|v(3, 2) + AgesR|fffd|v(4, 2)
ReDim VprR1(UBound(VectAge))

If AgesR|fffd|v(1, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(1, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    tabl = Tablesr|fffd|v(1, 2)
    AnNaissR = Tablesr|fffd|v(1, 1)
    VprR1 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
   
   
   If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
   axeT = axeT + (1 - VProbaAss(1)) * VprR1(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v1 * AgesR|fffd|v(1, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR1(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(1, 2) / DMT * Pro
   For i = 2 To UBound(VectAge)
    If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axeT = axeT + (1 - VProbaAss(i)) * VprR1(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v1 * AgesR|fffd|v(1, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR1(i - 1) - VprR1(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v1 * AgesR|fffd|v(1, 2) / DMT * Pro
   Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR1(j) = 0
    Next j
End If

ReDim VprR2(UBound(VectAge))

If AgesR|fffd|v(2, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(2, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    
    AnNaissR = Tablesr|fffd|v(2, 1)
    tabl = Tablesr|fffd|v(2, 2)
    VprR2 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
       
    
       
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axeT = axeT + (1 - VProbaAss(1)) * VprR2(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v2 * AgesR|fffd|v(2, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR2(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(2, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axeT = axeT + (1 - VProbaAss(i)) * VprR2(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v2 * AgesR|fffd|v(2, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR2(i - 1) - VprR2(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v2 * AgesR|fffd|v(2, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VAgeAss)
        VprR2(j) = 0
    Next j
End If

ReDim VprR3(UBound(VectAge))

If AgesR|fffd|v(3, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(3, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = VAgeAss(j) - EcartsAges
    Next j
    AnNaissR = Tablesr|fffd|v(3, 1)
    tabl = Tablesr|fffd|v(3, 2)
    VprR3 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    
    
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axeT = axeT + (1 - VProbaAss(1)) * VprR3(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v3 * AgesR|fffd|v(3, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR3(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(3, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axeT = axeT + (1 - VProbaAss(i)) * VprR3(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v3 * AgesR|fffd|v(3, 2) * MiniRev / DMT + MiniRev * (1 - VProbaAss(i - 1)) * (VprR3(i - 1) - VprR3(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v3 * AgesR|fffd|v(3, 2) / DMT * Pro
    Next i
   
Else
    For j = 1 To UBound(VectAge)
        VprR3(j) = 0
    Next j
End If

ReDim VprR4(UBound(VectAge))

If AgesR|fffd|v(4, 1) <> 0 Then
     
    EcartsAges = AgeCalcul - AgesR|fffd|v(4, 1)
        
    'On ajuste le vecteur |fffd|ge |fffd| l'|fffd|ge du r|fffd|versataire:
    For j = 1 To UBound(VectAge)
        VectAge(j) = Round(VAgeAss(j) - EcartsAges, 3)
    Next j
    AnNaissR = Tablesr|fffd|v(4, 1)
    tabl = Tablesr|fffd|v(4, 2)
    VprR4 = VProba(Terme, AnNaissR, tabl, AgeCalcul - EcartsAges, AgeEffet - EcartsAges, AG)
    
    
    If VectAge(1) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
    axeT = axeT + (1 - VProbaAss(1)) * VprR4(1) * VectFlux(1) * VectActu(1) * TauxR|fffd|v4 * AgesR|fffd|v(4, 2) * MiniRev / DMT '+ (1 - VProbaAss(1)) * (1 - VprR4(1)) * VectFlux(1) * VectActu(1) * TauxR|fffd|v * AgesR|fffd|v(4, 2) / DMT * Pro
    For i = 2 To UBound(VectAge)
        If VectAge(i) < AgeMinRev Then MiniRev = 0 Else MiniRev = 1
        axeT = axeT + (1 - VProbaAss(i)) * VprR4(i) * VectFlux(i) * VectActu(i) * TauxR|fffd|v4 * AgesR|fffd|v(4, 2) * MiniRev / DMT + (1 - VProbaAss(i - 1)) * (VprR4(i - 1) - VprR4(i)) * VectFlux(i) * VectActu(i) * TauxR|fffd|v4 * AgesR|fffd|v(4, 2) / DMT * Pro
    Next i
    
Else
    For j = 1 To UBound(VectAge)
        VprR4(j) = 0
    Next j
End If


ReDim VPr(UBound(VectAge))
For i = 1 To UBound(VectAge)
VPr(i) = 1 - (1 - VprR1(i)) * (1 - VprR2(i)) * (1 - VprR3(i)) * (1 - VprR4(i))
Next i
For i = 2 To UBound(VectAge)
    axeT = axeT + (1 - VPr(i)) * (VProbaAss(i - 1) - VProbaAss(i)) * VectFlux(i) * VectActu(i) * Pro * (1 - R|fffd|ver)
Next i





End If
axeT = axeT * (1 + Frais)

End Function

Function sannuit|fffd|X1(ByVal AgeCalcul As Double, ByVal AgeEffet As Double, ByVal AnNaiss As Integer, _
     Table As String, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
    
', Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0) As Double

Dim Approx As String
Dim TxArr As Double
Dim TxRegr As Double
Dim AnGar As Double
Approx = "Age exact"
TxArr = 0
TxRegr = 0
AnGar = AG - AgeEffet

Dim res As Double


res = axeT(AgeCalcul, AnNaiss, 0, 0, 0, 0, 0, 0, 0, 0, AgeEffet, Table, _
    0, 0, 0, 0, 0, 0, 0, 0, 0, TxReval, TxTech, TxTechLg, _
    DurCrt, Frac, Terme, Frais, AgeFin, AnGar, TabTauxCroiss, 0, 0, _
    ProrataD|fffd|c|fffd|s, ContrAssurance, Approx, _
    TxArr, TxRegr, 0, 0, 0, 0)
    
  If TxFraisDiff <> 0 And AgeFinDiff > AgeCalcul Then
    res = res + TxFraisDiff * sannuit|fffd|X1(AgeCalcul, AgeCalcul, AnNaiss, Table, 0, TxTech, TxTechLg, DurCrt, 1, "Echoir", 0, AgeFinDiff, 0, 0, 0, 0, "Sans", "Sans") _
    * sannuit|fffd|X1(AgeEffet, AgeEffet, AnNaiss, Table, TxReval, TxTech, TxTechLg, DurCrt, Frac, Terme, Frais, AgeFin, AG, TabTauxCroiss, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
  End If
sannuit|fffd|X1 = res
End Function


Function sannuit|fffd|X2(ByVal AgeCalcul As Double, ByVal AnNaiss As Integer, ByVal AgeR|fffd|v1 As Double, _
    ByVal AnNaissR|fffd|v1 As Integer, ByVal AgeEffet As Double, Table As String, _
    TableR|fffd|v1 As String, ByVal TauxR|fffd|v1 As Double, ByVal AgeMinRev As Double, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans") As Double
    
', Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional ByVal DureeDMarriageR|fffd|v1 As Double = 1)
    
    
Dim Approx As String
Dim TxArr As Double
Dim TxRegr As Double
Dim DureeDMarriageR|fffd|v1 As Double
Dim AnGar As Double
Dim AgeMinR|fffd|v1 As Double
Approx = "Age exact"
TxArr = 0
TxRegr = 0
DureeDMarriageR|fffd|v1 = 3
AnGar = AG - AgeEffet


Dim res As Double



If AgeEffet + AgeR|fffd|v1 - AgeCalcul > 110 Then TauxR|fffd|v1 = 0




res = axeT(AgeCalcul, AnNaiss, AgeR|fffd|v1, 0, 0, 0, AnNaissR|fffd|v1, 0, 0, 0, AgeEffet, Table, _
    TableR|fffd|v1, 0, 0, 0, TauxR|fffd|v1, 0, 0, 0, AgeMinRev, TxReval, TxTech, TxTechLg, _
    DurCrt, Frac, Terme, Frais, AgeFin, AnGar, TabTauxCroiss, 0, 0, _
    ProrataD|fffd|c|fffd|s, ContrAssurance, Approx, _
    TxArr, TxRegr, DureeDMarriageR|fffd|v1, 0, 0, 0)



If TxFraisDiff <> 0 And AgeFinDiff > AgeCalcul Then
    res = res + TxFraisDiff * sannuit|fffd|X1(AgeCalcul, AgeCalcul, AnNaiss, Table, 0, TxTech, TxTechLg, DurCrt, 1, "Avance", 0, AgeFinDiff, 0, 0, 0, 0, "Sans", "Sans") _
    * sannuit|fffd|X2(AgeEffet, AnNaiss, AgeR|fffd|v1 + AgeEffet - AgeCalcul, AnNaissR|fffd|v1, AgeEffet, Table, TableR|fffd|v1, TauxR|fffd|v1, AgeMinRev, TxReval, TxTech, TxTechLg, DurCrt, Frac, Terme, Frais, _
    AgeFin, AG, TabTauxCroiss, 0, 0, ProrataD|fffd|c|fffd|s, "Sans")
End If

sannuit|fffd|X2 = res
End Function
Function axe2R(ByVal AgeCalcul As Double, ByVal AnNaiss As Integer, ByVal AgeR|fffd|v1 As Double, ByVal AgeR|fffd|v2 As Double, _
    ByVal AnNaissR|fffd|v1 As Integer, ByVal AnNaissR|fffd|v2 As Integer, ByVal AgeEffet As Double, Table As String, _
    TableR|fffd|v1 As String, TableR|fffd|v2 As String, ByVal TauxR|fffd|v1 As Double, ByVal TauxR|fffd|v2 As Double, ByVal AgeMinRev As Double, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional ByVal DureeDMarriageR|fffd|v1 As Double = 1, Optional ByVal DureeDMarriageR|fffd|v2 As Double = 1) As Double
    
axe2R = axeT(AgeCalcul, AnNaiss, AgeR|fffd|v1, AgeR|fffd|v2, 0, 0, AnNaissR|fffd|v1, AnNaissR|fffd|v2, 0, 0, AgeEffet, Table, _
    TableR|fffd|v1, TableR|fffd|v2, 0, 0, TauxR|fffd|v1, TauxR|fffd|v2, 0, 0, AgeMinRev, TxReval, TxTech, TxTechLg, _
    DurCrt, Frac, Terme, Frais, AgeFin, AG, TabTauxCroiss, TxFraisDiff, AgeFinDiff, _
    ProrataD|fffd|c|fffd|s, ContrAssurance, Approx, _
    TxArr, TxRegr, DureeDMarriageR|fffd|v1, DureeDMarriageR|fffd|v2, 0, 0)

End Function

Function axe3R(ByVal AgeCalcul As Double, ByVal AnNaiss As Integer, ByVal AgeR|fffd|v1 As Double, ByVal AgeR|fffd|v2 As Double, ByVal AgeR|fffd|v3 As Double, _
    ByVal AnNaissR|fffd|v1 As Integer, ByVal AnNaissR|fffd|v2 As Integer, ByVal AnNaissR|fffd|v3 As Integer, ByVal AgeEffet As Double, Table As String, _
    TableR|fffd|v1 As String, TableR|fffd|v2 As String, TableR|fffd|v3 As String, ByVal TauxR|fffd|v1 As Double, ByVal TauxR|fffd|v2 As Double, ByVal TauxR|fffd|v3 As Double, ByVal AgeMinRev As Double, _
    ByVal TxReval As Double, ByVal TxTech As Variant, ByVal TxTechLg As Double, _
    ByVal DurCrt As Double, ByVal Frac As Integer, Terme As String, _
    ByVal Frais As Double, Optional ByVal AgeFin As Double = 0, Optional ByVal AG As Double = 0, _
    Optional ByVal TabTauxCroiss As Variant = 0, Optional ByVal TxFraisDiff As Double = 0, Optional ByVal AgeFinDiff As Double = 0, _
    Optional ProrataD|fffd|c|fffd|s As String = "Sans", Optional ContrAssurance As String = "Sans", Optional Approx As String = "Age exact", _
    Optional TxArr As Double = 0, Optional TxRegr As Double = 0, Optional ByVal DureeDMarriageR|fffd|v1 As Double = 1, Optional ByVal DureeDMarriageR|fffd|v2 As Double = 1, _
    Optional ByVal DureeDMarriageR|fffd|v3 As Double = 1)
    
axe3R = axeT(AgeCalcul, AnNaiss, AgeR|fffd|v1, AgeR|fffd|v2, AgeR|fffd|v3, 0, AnNaissR|fffd|v1, AnNaissR|fffd|v2, AnNaissR|fffd|v3, 0, AgeEffet, Table, _
    TableR|fffd|v1, TableR|fffd|v2, TableR|fffd|v3, 0, TauxR|fffd|v1, TauxR|fffd|v2, TauxR|fffd|v3, 0, AgeMinRev, TxReval, TxTech, TxTechLg, _
    DurCrt, Frac, Terme, Frais, AgeFin, AG, TabTauxCroiss, TxFraisDiff, AgeFinDiff, _
    ProrataD|fffd|c|fffd|s, ContrAssurance, Approx, _
    TxArr, TxRegr, DureeDMarriageR|fffd|v1, DureeDMarriageR|fffd|v2, DureeDMarriageR|fffd|v3, 0)

End Function

Attribute VB_Name = "Module3"
Sub Macro3()
Attribute Macro3.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro3 Macro
'

'
    ActiveSheet.Shapes.Range(Array("ListBox1")).Select
    ActiveSheet.Shapes("ListBox1").IncrementLeft 121.578976378
    ActiveSheet.Shapes("ListBox1").IncrementTop 28.421023622
End Sub
Attribute VB_Name = "TPGF05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "TPGH05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Option Explicit

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Bar|fffd|me.Visible = True
Bar|fffd|me.Select
wTarif.Visible = 2
wArt39.Visible = 2
wArt83.Visible = 2
wC3RPR84.Visible = 2
wCalcIBM.Visible = 2
wLiquidIBM.Visible = 2
wResumIBM.Visible = 2
wCapDiff.Visible = 2
wHop.Visible = 2
wMajoLeg.Visible = 2
wPr86.Visible = 2
wCCR.Visible = 2
End Sub

Private Sub Workbook_Open()
Dim v As Integer, Txt As String, Matricule As String
Application.ScreenUpdating = False
Bar|fffd|me.Visible = True
Bar|fffd|me.Select

On Error Resume Next
Utilisateur = ""
Application.ScreenUpdating = False
If Not V|fffd|rifNumTech Then
  If Not V|fffd|rifNumGestion Then
    MsgBox "Probl|fffd|me d'acc|fffd|s au suivi des versions et au type de droits" & Chr(13) & "Il n'a pas |fffd|t|fffd| possible de s'assurer que ce fichier constitue la version |fffd| jour", vbInformation + vbOKOnly
    Select Case MsgBox("Un probl|fffd|me r|fffd|seau emp|fffd|che de savoir si vous devez b|fffd|n|fffd|ficier des options d|fffd|velopp|fffd|es pour le service Client (Gestion) ou pour le service Offre / Technique / Suivi" & Chr(13) & Chr(13) & "Faites-vous partie de la gestion ?", vbYesNo) = 6
    Case True:  Utilisateur = "Gestion"
    Case False: Utilisateur = "Tech"
    End Select
  End If
End If
v = Application.Workbooks(NomFichSuivi).Worksheets("Suivi Versions").Range("vAnnuit|fffd|").Value
Utilisateur = Application.Workbooks(NomFichSuivi).Worksheets("Suivi Versions").Range("Utilisateur").Value
Workbooks(NomFichSuivi).Close SaveChanges:=False
If Utilisateur = "" Then Utilisateur = "Gestion"
Application.ScreenUpdating = True
If v > 0 And v <> Version Then
  Txt = "ATTENTION : la version ici ouverte (n|fffd|" & Version & ") n'est pas la derni|fffd|re version mise en ligne" & Chr(13)
  Txt = Txt & "Une nouvelle version a |fffd|t|fffd| impl|fffd|ment|fffd|e (n|fffd|" & v & ") afin d'am|fffd|liorer la fiabilit|fffd| / l'ergonomie du logiciel" & Chr(13)
  Txt = Txt & "Il est fortement recommand|fffd| de prendre cette nouvelle version disponible sur le r|fffd|seau (Intranet : M|fffd|tier collectives / Biblioth|fffd|que / Retraite / Evaluation Liquidation / Outils de calcul    ou   PrintSiegData5v\llg2_gr\LOGICIEL CALCUL D'ANNUITE" & Chr(13) & Chr(13)
  Txt = Txt & "Malgr|fffd| ces recommandations, voulez-vous cependant utiliser cette pr|fffd|sente version ?"
  If MsgBox(Txt, vbExclamation + vbYesNo, "Avertissement") = vbNo Then
    ActiveWorkbook.Close SaveChanges:=False
    Exit Sub
  Else
    MdP.Show
  End If
End If
Util:
UtilisateurIni = Utilisateur
Call AfficheFenetres

Utilisateur = "Gestion" 'xxxxxxxxxxxxxx

With Application
  .Calculation = xlAutomatic
  .MaxChange = 0.001
End With
ActiveWorkbook.PrecisionAsDisplayed = False

Ouverture = True

Bar|fffd|me.ApproxAge.Clear
Bar|fffd|me.ApproxAge.AddItem "Age entier le + proche"
Bar|fffd|me.ApproxAge.AddItem "Semest. + proche"
Bar|fffd|me.ApproxAge.AddItem "Trim + proche"
Bar|fffd|me.ApproxAge.AddItem "Mois + proche"
Bar|fffd|me.ApproxAge.AddItem "Age exact"
Bar|fffd|me.ApproxAge.AddItem "Age entier atteint"
Bar|fffd|me.ApproxAge.AddItem "Semest. atteint"
Bar|fffd|me.ApproxAge.AddItem "Trim atteint"
Bar|fffd|me.ApproxAge.AddItem "Mois atteint"
Bar|fffd|me.ApproxAge.Value = Range("ApproxAge").Value

Bar|fffd|me.Terme.Clear
Bar|fffd|me.Terme.AddItem "Echu"
Bar|fffd|me.Terme.AddItem "Avance"
Bar|fffd|me.Terme.Value = Range("Terme").Value

Bar|fffd|me.ProrataD|fffd|c|fffd|s.Clear
Bar|fffd|me.ProrataD|fffd|c|fffd|s.AddItem "Sans"
Bar|fffd|me.ProrataD|fffd|c|fffd|s.AddItem "Proportionnel"
Bar|fffd|me.ProrataD|fffd|c|fffd|s.AddItem "Complet"
Bar|fffd|me.ProrataD|fffd|c|fffd|s.Value = Range("ProrataD|fffd|c|fffd|s").Value

Bar|fffd|me.CbBox_ProrogAnticip.Clear
Bar|fffd|me.CbBox_ProrogAnticip.AddItem "Prorogation"
Bar|fffd|me.CbBox_ProrogAnticip.AddItem "Anticipation"
Bar|fffd|me.CbBox_ProrogAnticip.Value = Range("ProrogAnticip").Value

Bar|fffd|me.ContrAssurance.Clear
Bar|fffd|me.ContrAssurance.AddItem "Avec"
Bar|fffd|me.ContrAssurance.AddItem "Sans"
Bar|fffd|me.ContrAssurance.Value = Range("ContrAss").Value

Bar|fffd|me.Fractionnement.Clear
Bar|fffd|me.Fractionnement.AddItem "Mensuel"
Bar|fffd|me.Fractionnement.AddItem "Trimestriel"
Bar|fffd|me.Fractionnement.AddItem "Semestriel"
Bar|fffd|me.Fractionnement.AddItem "Annuel"
Bar|fffd|me.Fractionnement.Value = Range("Fractionnement").Value

Bar|fffd|me.Table.Clear
Bar|fffd|me.Table.AddItem "TPG"
Bar|fffd|me.Table.AddItem "TGHF05"
Bar|fffd|me.Table.AddItem "TPG+x/15.TGHF05"
Bar|fffd|me.Table.AddItem "TV+x/7.TPG"
'Bar|fffd|me.Table.AddItem "TPRV93"
'Bar|fffd|me.Table.AddItem "MR93"
'Bar|fffd|me.Table.AddItem "TV2000"
Bar|fffd|me.Table.AddItem "TV8890"
'Bar|fffd|me.Table.AddItem "TD8890"
Bar|fffd|me.Table.AddItem "TV7377"
'Bar|fffd|me.Table.AddItem "TD7377"
Bar|fffd|me.Table.AddItem "PF6064"
'Bar|fffd|me.Table.AddItem "PM6061"
'Bar|fffd|me.Table.AddItem "PM4649"
'Bar|fffd|me.Table.AddItem "PF4649"
'Bar|fffd|me.Table.AddItem "SansTable"
Bar|fffd|me.Table.Value = Range("Table").Value

Bar|fffd|me.TypeRente.Visible = True
Bar|fffd|me.TypeRente.Clear
Bar|fffd|me.TypeRente.AddItem "RVI (rente viag|fffd|re imm|fffd|diate)"
Bar|fffd|me.TypeRente.AddItem "RVD (rente viag|fffd|re diff|fffd|r|fffd|e)"
Bar|fffd|me.TypeRente.AddItem "Capi Fi Transfo Imm|fffd|diate"
'If Utilisateur <> "Gestion" Then
'  Bar|fffd|me.TypeRente.AddItem "RTI (rente temporaire imm|fffd|diate)"
'End If
Bar|fffd|me.TypeRente.Value = "RVI (rente viag|fffd|re imm|fffd|diate)"

Bar|fffd|me.TypeRente.Left = 736
Bar|fffd|me.TypeRente.Top = 119
Bar|fffd|me.TypeRente.Width = 150
Bar|fffd|me.TypeRente.Height = 42
Bar|fffd|me.TypeRente.FontSize = 10

Bar|fffd|me.Sexe.Clear
Bar|fffd|me.Sexe.AddItem "H/F"
Bar|fffd|me.Sexe.AddItem "F/H"
Bar|fffd|me.Sexe.AddItem "H/H"
Bar|fffd|me.Sexe.AddItem "F/F"
Bar|fffd|me.Sexe.Value = Range("Sexe").Value

Bar|fffd|me.NbAnAmmort.Clear
Bar|fffd|me.NbAnAmmort.AddItem "00"
Bar|fffd|me.NbAnAmmort.AddItem "01"
Bar|fffd|me.NbAnAmmort.AddItem "02"
Bar|fffd|me.NbAnAmmort.AddItem "03"
Bar|fffd|me.NbAnAmmort.AddItem "04"
Bar|fffd|me.NbAnAmmort.AddItem "05"
Bar|fffd|me.NbAnAmmort.AddItem "06"
Bar|fffd|me.NbAnAmmort.AddItem "07"
Bar|fffd|me.NbAnAmmort.AddItem "08"
Bar|fffd|me.NbAnAmmort.AddItem "09"
Bar|fffd|me.NbAnAmmort.AddItem "10"
Bar|fffd|me.NbAnAmmort.AddItem "11"
Bar|fffd|me.NbAnAmmort.AddItem "12"
Bar|fffd|me.NbAnAmmort.AddItem "13"
Bar|fffd|me.NbAnAmmort.AddItem "14"
Bar|fffd|me.NbAnAmmort.AddItem "15"
Select Case Range("Terme").Value
Case "Echu"
  Bar|fffd|me.Shapes("CacheProrataD|fffd|c|fffd|s").Visible = False
  Bar|fffd|me.Shapes("ProrataD|fffd|c|fffd|s").Visible = True
Case Else
  Bar|fffd|me.Shapes("CacheProrataD|fffd|c|fffd|s").Visible = True
  Bar|fffd|me.Shapes("ProrataD|fffd|c|fffd|s").Visible = False
End Select
If Utilisateur = "Gestion" Then
  wMenu.Visible = True
  wMenu.Select
  Bar|fffd|me.Visible = False
End If
Ouverture = False
DjCjt2 = False
Exit Sub
End Sub

Function V|fffd|rifNumTech() As Boolean
Application.ScreenUpdating = False
V|fffd|rifNumTech = False
On Error GoTo fin
'Call Ouvrefichier(NomCheminSuiviTechBis, NomFichSuivi)
Workbooks.Open Filename:=NomCheminSuiviTech & NomFichSuivi
V|fffd|rifNumTech = True
Exit Function
fin:
End Function

Function V|fffd|rifNumGestion() As Boolean
Application.ScreenUpdating = False
V|fffd|rifNumGestion = False
On Error GoTo fin
'Call Ouvrefichier(NomCheminSuiviGestionBis, NomFichSuivi)
Workbooks.Open Filename:=NomCheminSuiviGestion & NomFichSuivi
V|fffd|rifNumGestion = True
fin:
End Function
Attribute VB_Name = "Userform_ouverture"
Sub Liquidation()
    Load Choix_rente_bareme
    Choix_rente_bareme.Show
End Sub
Sub Liquidation_article_83()
    Load Article_83
    Article_83.Show
End Sub
Sub Liquidation_article_39()
    Load Article_39
    Article_39.Show
End Sub
Attribute VB_Name = "Vecteurs"
Option Explicit
Option Base 0
Global VectAge() As Double
Global VectActu() As Double
Global VectProba() As Double
Global VectFlux() As Double
Global VectDate() As Date
Global VectTaux() As Double


Function VAge(AgeCalcul As Double, AgeEffet As Double, Frac As Integer, Optional AgeFin As Double = 0, Optional AgeR|fffd|v As Variant) As Variant
'Vecteur des ages de versements:
'-> AgeVersement = Age lors du d|fffd|but de la p|fffd|riode du permier versement effectu|fffd|:

Dim i As Integer
Dim AMin As Single
ReDim VectAge(3)

AgeVersement = AgeEffet

'Age maximum de versement:
AMin = 121

For i = 1 To 4 'UBound(AgeR|fffd|v, 1)
    If AMin > AgeR|fffd|v(i, 1) And AgeR|fffd|v(i, 1) <> 0 Then AMin = AgeR|fffd|v(i, 1)
Next i

'Cas triviaux:
If AgeFin = 0 Then
    If AMin < AgeCalcul Then
        AgeFin = 121 + AgeCalcul - AMin
    Else
        AgeFin = 121
    End If
End If

'If AgeFin < AgeVersement Or AgeFin < AgeCalcul Then
'    MsgBox "Probl|fffd|me dans les |fffd|ges!"
'    Exit Function
'End If

'Cas normaux:


If AgeCalcul < AgeVersement Then

    VectAge(1) = AgeVersement
    
Else 'AgeCalcul > AgeVersement
    VectAge(1) = AgeCalcul
    
    
        AgeVersement = AgeVersement + Int(AgeCalcul - AgeVersement)
        While Round(AgeVersement, 6) < AgeCalcul
            AgeVersement = AgeVersement + 1 / Frac
        Wend
        VectAge(2) = AgeVersement
   
        
End If

'Boucle pour tous les autres versements:
If VectAge(1) = VectAge(2) Or VectAge(2) = 0 Then
    i = 2
Else
    i = 3
End If
Do
    ReDim Preserve VectAge(i)
    VectAge(i) = VectAge(i - 1) + 1 / Frac
    i = i + 1
Loop While Round(VectAge(i - 1) + 1 / Frac, 3) <= AgeFin

If VectAge(i - 1) > AgeFin Then VectAge(i - 1) = AgeFin
If VectAge(i - 1) < AgeFin Then
    ReDim Preserve VectAge(i)
    VectAge(i) = AgeFin
End If

For i = 1 To UBound(VectAge)
    VectAge(i) = Round(VectAge(i), 3)
Next i

'R|fffd|sultat:
VAge = VectAge

End Function


Function VActu(ByVal TauxTech As Variant, AgeCalcul As Double, AgeEffet As Double)
'Vecteur des actualisations:

Dim i, a As Integer
Dim j, k As Integer
Dim TxTech, PortionAge As Double
AgeEffet = Round(AgeEffet, 6)
ReDim VectActu(UBound(VectAge))

For i = 2 To 4 'UBound(TauxTech(, 1))
    If TauxTech(i, 1) = 0 Then TauxTech(i, 1) = 121
Next i

'Actualisation du 1er flux:
If UBound(VectAge) >= 3 And AgeEffet > AgeCalcul Then
    Dim Frac As Double
    Frac = Round(1 / (VectAge(3) - VectAge(2)))
    k = 0
    VectActu(1) = 1
    'TauxTech(1, 2) = VectTaux(1)
    TxTech = TauxTech(1, 2)
    While AgeCalcul + (k + 1) / Frac < AgeEffet
    For i = 2 To 4 'UBound(TauxTech(, 1))
        If TauxTech(i, 1) + AgeCalcul <= AgeEffet + k / Frac Then TxTech = TauxTech(i, 2)
    Next i
    VectActu(1) = VectActu(1) / (1 + TxTech) ^ (1 / Frac)
    k = k + 1
    Wend
    VectActu(1) = VectActu(1) / (1 + TxTech) ^ Maxi((AgeEffet - (AgeCalcul + (k) / Frac)), 0)
Else
    VectActu(1) = 1 / (1 + TauxTech(1, 2)) ^ (Maxi(VectAge(1) - Round(AgeCalcul, 6), 0))
End If

'Actualisation des autres flux:
'PortionAge = 0

'Ajout 15/12/12
'PortionAge = VectAge(i) - AgeCalcul
'-Fin

'Ajout 19/12/12
'Remplir automatique la dur|fffd|e des taux
If TauxTech(2, 1) > TauxTech(3, 1) Then
    TauxTech(3, 1) = 121
    TauxTech(4, 1) = 121
End If
If TauxTech(3, 1) > TauxTech(4, 1) Then TauxTech(4, 1) = 121
'-Fin
    


For i = 2 To UBound(VectAge)
    
    If VectAge(i) <= Round(AgeCalcul, 6) Then
        VectActu(i) = 1
        
    Else
        'j = 1

        'Choix du taux technique:
        'While VectAge(i) - AgeEffet >= TauxTech(j, 1)
        '    If j = 4 Then GoTo BorneAtteinte
        '    j = j + 1
        'Wend

'BorneAtteinte:
        
        'If VectAge(i) > AgeCalcul Then
        
            'Ajout 15/12/12
            
            'PortionAge = VectAge(i) - VectAge(i - 1) + PortionAge
            '-Fin
        
            'PortionAge = Mini(VectAge(i) - VectAge(i - 1), VectAge(i) - AgeCalcul) + PortionAge 'Car la dur|fffd|e s'ajoute
           ' Range("TxTechAgeDet").Value = Cells(i + 6, 15).Value
           ' VectActu(i) = VectActu(i - 1) / (1 + TauxTech(j - 1, 2)) ^ (Mini(VectAge(i) - VectAge(i - 1), VectAge(i) - AgeCalcul))
            'Modif Son
        '    VectActu(i) = 1 / (1 + TauxTech(j - 1, 2)) ^ (VectAge(i) - AgeCalcul) 'PortionAge '(VectAge(i) - AgeCalcul) 'PortionAge
        'End If
        
        'Ajout le 19/12/12
        'comme si on actualise par rapport au flux avt mais le calcul de flux est ind|fffd|pendant les uns et les autres
        Select Case VectAge(i) - AgeCalcul
        Case Is <= TauxTech(2, 1)
                VectActu(i) = 1 / (1 + TauxTech(1, 2)) ^ (VectAge(i) - AgeCalcul)
        Case Is <= TauxTech(3, 1)
                VectActu(i) = 1 / (1 + TauxTech(1, 2)) ^ TauxTech(2, 1) / (1 + TauxTech(2, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(2, 1))
        Case Is <= TauxTech(4, 1)
                VectActu(i) = 1 / (1 + TauxTech(1, 2)) ^ TauxTech(2, 1) / (1 + TauxTech(2, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(2, 1)) / (1 + TauxTech(3, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(3, 1))
        Case Else
                VectActu(i) = 1 / (1 + TauxTech(1, 2)) ^ TauxTech(2, 1) / (1 + TauxTech(2, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(2, 1)) / (1 + TauxTech(3, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(3, 1)) / (1 + TauxTech(4, 2)) ^ (VectAge(i) - AgeCalcul - TauxTech(4, 1))
        End Select
        '-Fin
    End If
Next i




'R|fffd|sultat:
VActu = VectActu

End Function

Function VProba(Terme As String, AnNaiss As Integer, Table As String, AgeCalcul As Double, AgeEffet As Double, Optional AnGar As Double = 0) As Variant
'Vecteur des probas de vie;

Dim i, j As Integer
Dim T As Double
j = 1
T = 0

'On ajuste la dimension du vecteur des probas de vie |fffd| celle du vecteur age:

ReDim VectProba(UBound(VectAge))

'Historique des versements:
For i = 1 To UBound(VectAge)
    If VectAge(i) <= Round(AgeCalcul, 6) Then
        VectProba(i) = 1
        j = i + 1
    End If
Next i

'Probas de vie (cas d'un "mort-vivant"):
If sLx(AgeCalcul, AnNaiss, Table) = 0 Then
    For i = j To UBound(VectAge)
        VectProba(i) = 0
    Next i
    VProba = VectProba
    Exit Function
    
End If

'Probas de vie (cas d'un vivant):
If UCase(Terme) = "ECHU" And UBound(VectAge) > 2 Then T = VectAge(3) - VectAge(2)

For i = j To UBound(VectAge)
    If AnGar <> 0 And AnGar + AgeEffet > VectAge(i) - T Then
        VectProba(i) = 1
    Else
        VectProba(i) = sLx(VectAge(i), AnNaiss, Table) / sLx(AgeCalcul, AnNaiss, Table)
       ' wD|fffd|tailDate.Range("W" & i).Value = sLx(VectAge(i), AnNaiss, table)
       ' wD|fffd|tailDate.Range("X" & i).Value = sLx(AgeCalcul, AnNaiss, table)
    End If
Next i
'R|fffd|sultat:
Dim a As Integer
a = UBound(VectProba)
VProba = VectProba

End Function


Function VFlux(Terme As String, AgeCalcul As Double, AgeEffet As Double, Frac As Integer, Optional Croiss_palier As Variant = 0, Optional FraisDiffere As Double, Optional AgeFinDiffere As Double)
'Vecteur des flux:

Dim i As Integer
Dim j As Integer
AgeEffet = Round(AgeEffet, 6)
'On ajuste la dimension du vecteur flux |fffd| celle du vecteur age:
ReDim VectFlux(UBound(VectAge))

'1er flux:
VectFlux(1) = 1 / Frac

'If Round(VectAge(2) - AgeEffet, 6) <> Round(VectAge(3) - VectAge(2), 6) Then
    Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
    
        VectFlux(1) = Round((Round(VectAge(2) - AgeEffet, 6) * Frac), 0) / Frac
    Case Else
        VectFlux(1) = Round((Round(VectAge(2) - AgeEffet, 6) * Frac), 0) / Frac - 1 / Frac
    End Select
'End If
If VectAge(1) = AgeEffet And UCase(Terme) = "ECHU" Then VectFlux(1) = 0

'2i|fffd|me Flux
VectFlux(2) = 1 / Frac


'Boucle pour les autres flux:
For i = 3 To UBound(VectAge) - 1
    Select Case UCase(Terme)
        Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
          VectFlux(i) = VectAge(i + 1) - VectAge(i)
        Case Else
          VectFlux(i) = VectAge(i) - VectAge(i - 1)
    End Select
Next i

'Dernier Flux:
Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
        VectFlux(UBound(VectAge)) = VectFlux(UBound(VectAge) - 1)
    Case Else
        VectFlux(UBound(VectAge)) = Maxi(VectAge(UBound(VectAge)) - VectAge(UBound(VectAge) - 1), 0)
End Select

'Application des croissances par palier:
VectAge(0) = 0
For i = 1 To UBound(VectAge)
    Select Case UCase(Terme)
    Case "A ECHOIR", "|fffd| ECHOIR", "A |fffd|CHOIR", "|fffd| |fffd|CHOIR", "ECHOIR", "|fffd|CHOIR", "AVANCE"
        For j = 1 To 4 'UBound(Croiss_palier, 1)
            If VectAge(i) >= Croiss_palier(j, 1) Then VectFlux(i) = VectFlux(i) * (1 + Croiss_palier(j, 2))
            If i = UBound(VectAge) Then VectFlux(i) = 0
        Next j
    Case Else
        For j = 1 To 4 'UBound(Croiss_palier, 1)
            If VectAge(i - 1) >= Croiss_palier(j, 1) Then VectFlux(i) = VectFlux(i) * (1 + Croiss_palier(j, 2))
        Next j
    End Select
Next i

Dim a As Integer

'Tenir en compte le frais diff|fffd|r|fffd| et l'age de fin diff|fffd|r|fffd|
'a = 2

'If AgeCalcul <= AgeFinDiffere Then 'And AgeEffet <= AgeFinDiffere
'    VectFlux(1) = VectFlux(1) * (1 + FraisDiffere) ^ (AgeFinDiffere - AgeCalcul)
'    While VectAge(a) <= AgeFinDiffere
'        VectFlux(a) = VectFlux(a) * (1 + FraisDiffere) ^ (AgeFinDiffere - VectAge(a))
'        a = a + 1
'    Wend
'End If

'If AgeFinDiffere <> 0 And FraisDiffere <> 0 Then
'  For i = 1 To UBound(VectAge)
'    VectFlux(i) = VectFlux(i) * 1 / (1 - FraisDiffere) ^ Maxi(Mini(VectAge(i), AgeFinDiffere) - AgeCalcul, 0)
'  Next i
'End If
'R|fffd|sultat:
VFlux = VectFlux

End Function

Function VDate(DateVersement As Double, DateCalcul As Double, Frac As Integer) As Variant

Dim i As Integer
ReDim VectDate(UBound(VectAge))

If DateCalcul < DateVersement Then
    VectDate(1) = DateVersement
    VectDate(2) = MoisPlus(VectDate(1), 12 / Frac)
Else
    VectDate(1) = DateCalcul
    VectDate(2) = DateVersement
    While VectDate(2) <= DateCalcul
        VectDate(2) = MoisPlus(VectDate(2), 12 / Frac)
    Wend
End If


For i = 3 To UBound(VectAge)
    VectDate(i) = MoisPlus(VectDate(i - 1), 12 / Frac)
Next i

VDate = VectDate

End Function




'
'Function axd(DateCalcul As Date, DateDebRente As Date, DateNaiss As Date, DateVersement As Date, Table As String, TauxTech1 As Double, TauxTech2 As Double, DureeCrt As Double, Frac As Integer, Terme As String, TxFraisRente As Double, TauxR|fffd|v As Double, TabAgeR|fffd|v As Variant, Optional DateTerme As Double, Optional DateFinGar As Date, Optional DateFinDiff As Date, Optional TauxCroiss As Double, Optional FracApproximAge As Integer, Optional Prorata As String) As Double
'Dim AgeCalcul As Double, AgeEffet As Double, AgeVersement As Double, AgeTerme As Double, AnGar As Double, AgeFinDiff As Double
'AgeCalcul = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateCalcul, FracApproximAge), DateCalcul)
'AgeEffet = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateDebRente, FracApproximAge), DateDebRente)
'If DateVersement <> 0 Then
'  AgeVersement = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateVersement, FracApproximAge), DateDebRente)
'Else
'  AgeVersement = 0
'End If
'AgeTerme = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateTerme, FracApproximAge), DateTerme)
'AnGar = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateFinGar, FracApproximAge), DateFinGar) - AgeEffet
'AgeFinDiff = NbAnn|fffd|es2(ApproximAge(DateNaiss, DateFinDiff, FracApproximAge), DateFinDiff)
'
'axd = axs(AgeCalcul, AgeEffet, AgeVersement, Year(DateNaiss), Table, TauxTech1, TauxTech2, DureeCrt, Frac, Terme, TxFraisRente, AgeTerme, AnGar, TauxCroiss, TauxR|fffd|v, TabAgeR|fffd|v, Prorata)
'
'End Function

'Function VTaux(TxInf As Double, TxSup As Double, AgeCalcul As Double) As Variant

'Dim i As Integer
'ReDim VectTaux(UBound(VectAge))

'Randomize

'For i = 1 To UBound(VectAge)
    'If VectAge(i) <= Round(AgeCalcul, 6) Then
    '    VectTaux(i) = TxInf + (TxSup - TxInf) * Rnd(1)
    'End If
'Next i

'VTaux = VectTaux

'End Function
Attribute VB_Name = "V|fffd|rification_formulaire"
Function Verification_formulaire() As Boolean

Verification_formulaire = False


'On v|fffd|rifie que tout le bloc sur les coordonn|fffd|es et r|fffd|f|fffd|rences de l'assur|fffd| est bien renseign|fffd|

If Formulaire.Adresse.Value = "" Then
  MsgBox "Veuillez renseigner l'adresse de l'assur|fffd|"
  Formulaire.Adresse.SetFocus
  Exit Function
End If

If Formulaire.Code_postal.Value = "" Then
  MsgBox "Veuillez renseigner le code postal de l'assur|fffd|"
  Formulaire.Code_postal.SetFocus
  Exit Function
End If

If Not IsNumeric(Formulaire.Code_postal.Value) Or Len(Formulaire.Code_postal.Value) <> 5 Then
    MsgBox ("Le format saisi pour le code postal n'est pas valide")
    Formulaire.Code_postal.SetFocus
    Exit Function
End If

If Formulaire.Commune.Value = "" Then
  MsgBox "Veuillez renseigner la commune de l'assur|fffd|"
  Formulaire.Commune.SetFocus
  Exit Function
End If

If Formulaire.Pays.Value = "" Then
  MsgBox "Veuillez renseigner le pays de l'assur|fffd|"
  Formulaire.Pays.SetFocus
  Exit Function
End If

If Formulaire.Reference_entreprise.Value = "" Then
  MsgBox "Veuillez renseigner la r|fffd|f|fffd|rence de l'entreprise"
  Formulaire.Reference_entreprise.SetFocus
  Exit Function
End If

If Formulaire.Adhesion.Value = "" Then
  MsgBox "Veuillez renseigner le num|fffd|ro d'adh|fffd|sion de l'assur|fffd|"
  Formulaire.Adhesion.SetFocus
  Exit Function
End If

If Formulaire.Numero_rente.Value = "" Then
  MsgBox "Veuillez renseigner le num|fffd|ro de rente de l'assur|fffd|"
  Formulaire.Numero_rente.SetFocus
  Exit Function
End If

If Formulaire.Demande.Value = "" Then
  MsgBox "Veuillez renseigner le num|fffd|ro de demande de l'assur|fffd|"
  Formulaire.Demande.SetFocus
  Exit Function
End If

If Formulaire.Liste_sexe_assur|fffd|.Value = "" Then
  MsgBox "Veuillez renseigner le sexe de l'assur|fffd|"
  Formulaire.Liste_sexe_assur|fffd|.SetFocus
  Exit Function
End If

If Formulaire.Liste_tarif.Visible = True And Formulaire.Liste_tarif.Value = "" Then
  MsgBox "Veuillez renseigner le tarif choisi pour la rente"
  Formulaire.Liste_tarif.SetFocus
  Exit Function
End If

If Formulaire.Liste_garantie_dep.Visible = True And Formulaire.Liste_garantie_dep.Value = "" Then
  MsgBox "Veuillez renseigner la garantie d|fffd|pendance"
  Formulaire.Liste_garantie_dep.SetFocus
  Exit Function
End If

If Formulaire.Pas_dexoneration.Value = False And Formulaire.Exoneration_partielle.Value = False And Formulaire.Etranger.Value = False And Formulaire.Exoneration_totale.Value = False Then
    MsgBox "Veuillez renseigner les pr|fffd|l|fffd|vements sociaux"
    Exit Function
End If


If Formulaire.Coordonnees_reversataire.Visible = True Then ' Si l'option de rente chosie n|fffd|cessite un r|fffd|versataire
    'On v|fffd|rifie que tout le bloc sur le r|fffd|versataire est bien renseign|fffd|
    If Formulaire.Liste_qualite_reversataire.Value = "" Then
      MsgBox "Veuillez renseigner la qualit|fffd| du r|fffd|versataire"
      Formulaire.Liste_qualite_reversataire.SetFocus
      Exit Function
    End If
End If

'On v|fffd|rifie le bloc concernant le PP ou Concernant la r|fffd|gularisation

If (Formulaire.Concernant_PP.Caption = "Concernant le premier paiement" And Formulaire.Concernant_PP.Visible = True) Then
    If Formulaire.Liste_premier_paiement.Value = "" Then
        MsgBox "Veuillez renseigner si le premier paiement a |fffd|t|fffd| r|fffd|alis|fffd|"
        Formulaire.Liste_premier_paiement.SetFocus
        Exit Function
    End If
End If

If Formulaire.Regularisation_rente.Value = True Then
        If Formulaire.Date_PP.Value = "" Then
            MsgBox "Veuillez renseigner la valeur du montant suppl|fffd|mentaire"
            Formulaire.Date_PP.SetFocus
            Exit Function
        End If
        
        If Formulaire.Date_debut.Value = "" Then
            MsgBox "Veuillez renseigner la date de d|fffd|but de la p|fffd|riode"
            'Formulaire.Date_debut.Value.SetFocus
            Formulaire.Date_debut.SetFocus
            Exit Function
        End If
        
        If Formulaire.Date_fin.Value = "" Then
            MsgBox "Veuillez renseigner la date de fin de la p|fffd|riode"
            'Formulaire.Date_fin.Value.SetFocus
            Formulaire.Date_fin.SetFocus
            Exit Function
        End If
End If


If Formulaire.Liste_premier_paiement.Visible = True And Formulaire.Liste_premier_paiement.Value = "Oui" Then
    If Formulaire.Date_debut.Value = "" Then
      MsgBox "Veuillez renseigner la date de d|fffd|but"
      Formulaire.Date_debut.SetFocus
      Exit Function
    End If

    If Formulaire.Date_fin.Value = "" Then
      MsgBox "Veuillez renseigner la date de fin"
      Formulaire.Date_fin.SetFocus
      Exit Function
    End If

    If Formulaire.Date_PP.Value = "" Then
      MsgBox "Veuillez renseigner la date du premier paiement"
      Formulaire.Date_PP.SetFocus
      Exit Function
    End If
End If


If Formulaire.Coordonnees_beneficiaire.Visible = True Then ' Si l'option de rente chosie n|fffd|cessite des b|fffd|n|fffd|ficiaires

'On v|fffd|rifie que le bloc sur les b|fffd|n|fffd|ficiaires est bien renseign|fffd|
    If Formulaire.Aucun_benef.Value = False And Formulaire.Choix_1beneficiaire.Value = False And Formulaire.Choix_2beneficiaires.Value = False And Formulaire.Choix_3beneficiaires.Value = False And Formulaire.Choix_4beneficiaires.Value = False Then
      MsgBox "Veuillez renseigner le nombre de b|fffd|n|fffd|ficiaires"
      Exit Function
    End If
    
    If Formulaire.Choix_1beneficiaire.Value = True Then
        'On v|fffd|rifie que le bloc sur le premier b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        'If Formulaire.Nom_naissance_beneficiaire1.Value = "" Then
         ' MsgBox "Veuillez renseigner le nom de naissance du premier b|fffd|n|fffd|ficiaire"
          'Formulaire.Nom_naissance_beneficiaire1.SetFocus
          'Exit Function
        'End If
        
        If Formulaire.Prenom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le premier b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire1.SetFocus
          Exit Function
        End If
    End If
    


    If Formulaire.Choix_2beneficiaires.Value = True Then
        'On v|fffd|rifie que le bloc sur le premier b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        'If Formulaire.Nom_naissance_beneficiaire1.Value = "" Then
        '  MsgBox "Veuillez renseigner le nom de naissance du premier b|fffd|n|fffd|ficiaire"
        '  Formulaire.Nom_naissance_beneficiaire1.SetFocus
        '  Exit Function
        'End If
        
        '''' blocage si non rempli
        
        
        If Formulaire.Pourcentage_beneficiaire_1.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le premier b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire1.SetFocus
          Exit Function
        End If
        
        'On v|fffd|rifie que le bloc sur le deuxi|fffd|me b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire2.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_2.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 2")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire2.SetFocus
          Exit Function
        End If
    End If
    
    If Formulaire.Choix_3beneficiaires.Value = True Then
        'On v|fffd|rifie que le bloc sur le premier b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Lien_parente_beneficiaire1.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le premier b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire1.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_2.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 2")
            Exit Function
        End If
        '---------------
        
'        If Formulaire.Nom_naissance_beneficiaire2.Value = "" Then
'          MsgBox "Veuillez renseigner le nom de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiare"
'          Formulaire.Nom_naissance_beneficiaire2.SetFocus
'          Exit Function
'        End If
        
        If Formulaire.Prenom_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire2.SetFocus
          Exit Function
        End If
        
        'On v|fffd|rifie que le bloc sur le troisi|fffd|me b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le nom du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire3.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_3.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 3")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire3.SetFocus
          Exit Function
        End If
        
    End If
    
    If Formulaire.Choix_4beneficiaires.Value = True Then
        
        'On v|fffd|rifie que le bloc sur le premier b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_1.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 1")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le premier b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire1.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire1.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du premier b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire1.SetFocus
          Exit Function
        End If
        
        'On v|fffd|rifie que le bloc sur le deuxi|fffd|me b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le nom du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire2.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_2.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 2")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire2.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire2.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du deuxi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire2.SetFocus
          Exit Function
        End If
        
        'On v|fffd|rifie que le bloc sur le troisi|fffd|me b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le nom du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire3.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_3.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 3")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire3.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire3.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du troisi|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire3.SetFocus
          Exit Function
        End If
        
        'On v|fffd|rifie que le bloc sur le quatri|fffd|me b|fffd|n|fffd|ficiaire est bien renseign|fffd|
        If Formulaire.Nom_beneficiaire4.Value = "" Then
          MsgBox "Veuillez renseigner le nom du quatri|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Nom_beneficiaire4.SetFocus
          Exit Function
        End If
        
        '''' blocage si non rempli
        If Formulaire.Pourcentage_beneficiaire_4.Value = "" Then
            MsgBox ("Merci de remplir le pourcentage de r|fffd|partition du b|fffd|n|fffd|ficiaire 4")
            Exit Function
        End If
        '---------------
        
        If Formulaire.Prenom_beneficiaire4.Value = "" Then
          MsgBox "Veuillez renseigner le pr|fffd|nom du quatri|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Prenom_beneficiaire4.SetFocus
          Exit Function
        End If
        
        If Formulaire.Lien_parente_beneficiaire4.Value = "" Then
          MsgBox "Veuillez renseigner le lien de parent|fffd| |fffd|ventuel avec le quatri|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Lien_parente_beneficiaire4.SetFocus
          Exit Function
        End If
        
        If Formulaire.Commune_naissance_beneficiaire4.Value = "" Then
          MsgBox "Veuillez renseigner la commune de naissance du quatri|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Commune_naissance_beneficiaire4.SetFocus
          Exit Function
        End If
        
        If Formulaire.Date_nais_beneficiaire4.Value = "" Then
          MsgBox "Veuillez renseigner la date de naissance du quatri|fffd|me b|fffd|n|fffd|ficiaire"
          Formulaire.Date_nais_beneficiaire4.SetFocus
          Exit Function
        End If
        
    End If

End If

If Formulaire.Coordonnees_beneficiaire.Visible = True Then
    'V|fffd|rification bonne attribution de pourcentage si on a deux b|fffd|n|fffd|ficiaires
    If Formulaire.Choix_2beneficiaires.Value = True Then
       If CDbl(Formulaire.Pourcentage_beneficiaire_1.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_2.Value) <> 100 Then
           MsgBox ("Veuillez revoir la r|fffd|partition entre les 2 b|fffd|n|fffd|ficiares ! La somme des pourcentages de r|fffd|partition doit faire 100 ")
       Exit Function
       End If
    End If
    
    
    'V|fffd|rification bonne attribution de pourcentage si on a trois b|fffd|n|fffd|ficiaires
    If Formulaire.Choix_3beneficiaires.Value = True Then
       If CDbl(Formulaire.Pourcentage_beneficiaire_1.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_2.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_3.Value) <> 100 Then
           MsgBox ("Veuillez revoir la r|fffd|partition entre les 3 b|fffd|n|fffd|ficiares ! La somme des pourcentages de r|fffd|partition doit faire 100 ")
       Exit Function
       End If
    End If
    
    'V|fffd|rification bonne attribution de pourcentage si on a quatre b|fffd|n|fffd|ficiaires
    If Formulaire.Choix_4beneficiaires.Value = True Then
       If CDbl(Formulaire.Pourcentage_beneficiaire_1.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_2.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_3.Value) + CDbl(Formulaire.Pourcentage_beneficiaire_4.Value) <> 100 Then
           MsgBox ("Veuillez revoir la r|fffd|partition entre les 4 b|fffd|n|fffd|ficiares ! La somme des pourcentages de r|fffd|partition doit faire 100 ")
       Exit Function
       End If
    End If
End If


Verification_formulaire = True

End Function
Attribute VB_Name = "ibm"

Option Explicit

Global calc As Boolean

Function IbmImprimEvaluation()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
With AppWord
 ' Set docword = OuvreWord(NomCheminDocIBMBis, NomLettreEstimIBM, appword)
  Set DocWord = AppWord.Documents.Open(NomCheminDocIBM & NomLettreEstimIBM, ReadOnly:=True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
  With .Selection
    '---- Nom et pr|fffd|nom
    DocWord.bookmarks("NomPr|fffd|nom").Select
    .TypeText Text:="" & wCalcIBM.Range("F6").Value & " " & wCalcIBM.Range("F7").Value & " " & wCalcIBM.Range("F8").Value
    DocWord.bookmarks("Adresse").Select
    .TypeText Text:="" & wCalcIBM.Range("B7").Value
    DocWord.bookmarks("CodePostalVille").Select
    .TypeText Text:="" & wCalcIBM.Range("B8").Value
    DocWord.bookmarks("Pays").Select
    .TypeText Text:="" & wCalcIBM.Range("B9").Value
    DocWord.bookmarks("NomGestionnaire").Select
    .TypeText Text:="" & wCalcIBM.Range("D5").Value
    DocWord.bookmarks("NumCertificat").Select
    .TypeText Text:="" & wCalcIBM.Range("F10").Value
    If Not Bar|fffd|me.ExistR|fffd|version1 Then
      DocWord.Range(DocWord.bookmarks("SupprRev").start, DocWord.bookmarks("NaissY").End).Select
      .Delete
    Else
      DocWord.bookmarks("NaissY").Select
      .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("DateNaissY1").Value)
    End If
    DocWord.bookmarks("DateLettre").Select
    .TypeText Text:="" & ConvertiDateSemiTxt(Date)
    DocWord.bookmarks("Titre").Select
    .TypeText Text:="" & wCalcIBM.Range("F6").Value
    DocWord.bookmarks("Titre").Select
    wResumIBM.Select
    wResumIBM.Range("B22:G" & 22 + NbEvalIbm).Select
    Selection.Copy
    DocWord.bookmarks("TabSimulations").Select
    .PasteSpecial , , 0, DataType:=3
    DocWord.bookmarks("Rte65AvecTx").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRenteIni").Value, "##,##0.00")
    DocWord.bookmarks("Rte65SansTx").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRenteZ|fffd|roEval").Value, "##,##0.00")
    DocWord.bookmarks("NomGestionnaire2").Select
    .TypeText Text:="" & wCalcIBM.Range("D5").Value
  End With
End With
End Function


Function LibMois(m As Integer)
Select Case m
Case 1: LibMois = "janvier"
Case 2: LibMois = "f|fffd|vrier"
Case 3: LibMois = "mars"
Case 4: LibMois = "avril"
Case 5: LibMois = "mai"
Case 6: LibMois = "juin"
Case 7: LibMois = "juillet"
Case 8: LibMois = "ao|fffd|t"
Case 9: LibMois = "septembre"
Case 10: LibMois = "octobre"
Case 11: LibMois = "novembre"
Case 12: LibMois = "d|fffd|cembre"
End Select
End Function

Function FormatPourcent(r As Double)
Dim k As Integer
For k = 0 To 5
  If Abs(r - Int(r * 100 * 10 ^ k) / (100 * 10 ^ k)) < 10 ^ (-7) Then Exit For
Next k
FormatPourcent = Int(r * 100 * 10 ^ k + 0.001) / (10 ^ k)
End Function

Attribute VB_Name = "wAncertaines"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Boubar|fffd|meMenu2, 2, 0, MSForms, CommandButton"
Option Explicit

Private Sub Boubar|fffd|meMenu2_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
Bar|fffd|me.Visible = False
wMajoLeg.Visible = 2
wAncertaines.Visible = 2
End Sub
Attribute VB_Name = "wArt39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Bouton_39, 979, 0, MSForms, CommandButton"
Attribute VB_Control = "Art39CPDependance, 975, 1, MSForms, CommandButton"
Attribute VB_Control = "BouArt39Menu, 145, 2, MSForms, CommandButton"
Attribute VB_Control = "BouArt39Bar|fffd|me, 90, 3, MSForms, CommandButton"
Attribute VB_Control = "BouNoteParam|fffd|trage, 42, 4, MSForms, CommandButton"
Attribute VB_Control = "Art39BouIni, 14, 5, MSForms, CommandButton"
Attribute VB_Control = "Art39CbTxFraisVigueur, 8, 6, MSForms, CheckBox"
Attribute VB_Control = "Art39CbDateEval, 7, 7, MSForms, CheckBox"
Attribute VB_Control = "Art39CbProrataStd, 6, 8, MSForms, CheckBox"
Attribute VB_Control = "Art39CbTermeStd, 5, 9, MSForms, CheckBox"
Attribute VB_Control = "Art39CbFracStd, 4, 10, MSForms, CheckBox"
Attribute VB_Control = "Art39CbTxTechVigueur, 3, 11, MSForms, CheckBox"
Attribute VB_Control = "Art39CbTableVigueur, 2, 12, MSForms, CheckBox"

Option Explicit

Private Sub Art39BouIni_Click()
Range("Art39Gest").Value = ""
Range("Art39rente").Value = ""
Range("Art39Valideur1").Value = ""
Range("RPP_art_39").Value = ""
Range("Art39NomX").Value = ""
Range("Art39Pr|fffd|nomX").Value = ""
Range("Art39NomY").Value = ""
Range("Art39Pr|fffd|nomY").Value = ""
Range("Art39DateNaissX").Value = ""
Range("Art39SexeX").Value = ""
Range("Art39TxRev").Value = ""
Range("Art39NomY").Value = ""
Range("Art39DateNaissY").Value = ""
Range("Art39SexeY").Value = ""
Range("Art39Approx").Value = "Age exact"
Range("Art39DateEffet").Value = ""
Range("Art39ChoixOpt").Value = ""
Range("SystGestion").Value = ""
Range("DateRevalo").Value = ""
Range("Art39DateEval").Value = ""
Range("Art39Table").Value = "TGHF05"
Range("Art39TxTech").Value = ""
Range("Art39TxFraisRente").Value = "3%"
Range("Art39FracLib").Value = "Trimestriel"
Range("Art39Terme").Value = "Echu"
Range("Art39Prorata").Value = "Sans"
Range("Art39ValideurTxTech").Value = ""
Range("Art39SupportCo|fffd|tRev").Value = ""
Range("Art39Valideur2").Value = ""
Range("Art39Dependance").Value = ""
End Sub

Private Sub Art39CbDateEval_Click()
If Art39CbDateEval Then Range("Art39DateEval").Value = Date
End Sub

Private Sub Art39CbTableVigueur_Click()
Select Case Art39CbTableVigueur
Case True:  Range("Art39Table").Value = TableVigueur(Range("Art39DateEffet").Value)
Case False: Range("Art39Table").Value = ""
End Select
End Sub

Private Sub Art39CbTxTechVigueur_Click()
If Art39CbTxTechVigueur Then
  Select Case Range("Art39DateEffet").Value
  Case "": Art39CbTxTechVigueur.Value = False
           wArt39.Range("Art39DateEffet").Select
  Case Else
    Range("Art39TxTech").Value = TxTechMaxVigueur(Range("Art39DateEffet").Value)
  End Select
End If
End Sub

Private Sub Art39CbTxFraisVigueur_Click()
Select Case Art39CbTxFraisVigueur
Case True:  Range("Art39TxFraisRente").Value = 0.03
Case False: Range("Art39TxFraisRente").Value = ""
End Select
End Sub

Private Sub Art39CbFracStd_Click()
Select Case Art39CbFracStd
Case True:  Range("Art39FracLib").Value = "Trimestriel"
Case False: Range("Art39FracLib").Value = ""
End Select
End Sub

Private Sub Art39CbTermeStd_Click()
Select Case Art39CbTermeStd
Case True:  Range("Art39Terme").Value = "Echu"
Case False: Range("Art39Terme").Value = "Avance"
End Select
End Sub

Private Sub Art39CbProrataStd_Click()
Select Case Art39CbProrataStd
Case True:  Range("Art39Prorata").Value = "COMP"
Case False: Range("Art39Prorata").Value = ""
End Select
End Sub

Private Sub Art39CPDependance_Click()
If wArt39.Range("Art39Rente").Value < 480 Then
  MsgBox "Cette option n'est pas disponible car la rente annuelle est inf|fffd|rieure |fffd| 480|fffd|"
Else
  DependanceRef.Show
  Call ImprimArt39CPDependance
End If
End Sub

Private Sub BouArt39Bar|fffd|me_Click()
If wArt39.Range("Art39PrimeInv1").Value = "" Then
  MsgBox "Fonction activ|fffd|e apr|fffd|s saisie de l'ensemble des informations dans cet onglet", , "Avertissement"
  Exit Sub
End If
Bar|fffd|me.Select
Bar|fffd|me.Range("Bar|fffd|meNom").Value = wArt39.Range("Art39NomX").Value
Bar|fffd|me.Range("DateNaissX").Value = wArt39.Range("Art39DateNaissX").Value
Select Case wArt39.Range("Art39SexeY").Value
Case "": Select Case wArt39.Range("Art39SexeX").Value
         Case "H": Bar|fffd|me.Sexe.Value = wArt39.Range("Art39SexeX").Value & "/F"
         Case "F": Bar|fffd|me.Sexe.Value = wArt39.Range("Art39SexeX").Value & "/H"
         End Select
Case Else: Bar|fffd|me.Sexe.Value = wArt39.Range("Art39SexeX").Value & "/" & wArt39.Range("Art39SexeY").Value
End Select
Bar|fffd|me.ExistR|fffd|version1.Value = False
Bar|fffd|me.Particularit|fffd|s.Value = False
Bar|fffd|me.Range("NbAnGar").Value = 0
Bar|fffd|me.Range("TxCroissRte70_75").Value = 0
Select Case wArt39.Range("Art39ChoixOpt").Value
Case "Sans r|fffd|version":              Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = False
Case "Avec r|fffd|version":              Bar|fffd|me.ExistR|fffd|version1.Value = True
                                    Bar|fffd|me.Particularit|fffd|s.Value = False
                                    Bar|fffd|me.Range("TxRev").Value = wArt39.Range("Art39TxRev").Value
                                    Bar|fffd|me.Range("DateNaissY1").Value = wArt39.Range("Art39DateNaissY").Value
Case "5 ans d'annuit|fffd|s garanties":  Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = True
                                    Bar|fffd|me.Range("NbAnGar").Value = 5
Case "10 ans d'annuit|fffd|s garanties": Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = True
                                    Bar|fffd|me.Range("NbAnGar").Value = 10
Case "15 ans d'annuit|fffd|s garanties": Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = True
                                    Bar|fffd|me.Range("NbAnGar").Value = 15
Case "20 ans d'annuit|fffd|s garanties": Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = True
                                    Bar|fffd|me.Range("NbAnGar").Value = 20
Case "Rente croissante par palier": Bar|fffd|me.ExistR|fffd|version1.Value = False
                                    Bar|fffd|me.Particularit|fffd|s.Value = True
                                    Bar|fffd|me.Range("TxCroissRte70_75").Value = 0.2
End Select
Select Case wArt39.Range("Art39Approx").Value
Case "Entier le plus proche": Bar|fffd|me.ApproxAge.Value = "Age entier le + proche"
Case "Trimestre atteint": Bar|fffd|me.ApproxAge.Value = "Trim atteint"
End Select
Bar|fffd|me.TypeRente.Value = "RVI (rente viag|fffd|re imm|fffd|diate)"
Bar|fffd|me.Range("DateDebRente").Value = wArt39.Range("Art39DateEffet").Value
Bar|fffd|me.Range("DateCalcul").Value = wArt39.Range("Art39DateCalcul").Value
Bar|fffd|me.Range("TxTech").Value = wArt39.Range("Art39TxTech").Value
Bar|fffd|me.Range("TxFraisRente").Value = wArt39.Range("Art39TxFraisRente").Value
Bar|fffd|me.Table.Value = wArt39.Range("Art39Table").Value
Bar|fffd|me.Fractionnement.Value = wArt39.Range("Art39FracLib").Value
Bar|fffd|me.Terme.Value = wArt39.Range("Art39Terme").Value
Select Case Bar|fffd|me.ProrataD|fffd|c|fffd|s.Value
Case "":   Bar|fffd|me.ProrataD|fffd|c|fffd|s.Value = "Sans"
Case Else: Bar|fffd|me.ProrataD|fffd|c|fffd|s.Value = wArt39.Range("Art39Prorata").Value
End Select
Select Case wArt39.Range("Art39SupportCo|fffd|tRev").Value
Case "Le salari|fffd|":   Bar|fffd|me.Range("Rente39").Formula = "=" & wArt39.Range("Art39Rente").Value & "*" & FormatPourcent(Bar|fffd|me.Range("CoefR|fffd|duc").Value) & "%"
Case "L'entreprise": Bar|fffd|me.Range("Rente39").Value = wArt39.Range("Art39Rente").Value
End Select
Bar|fffd|me.Range("Capital83").Value = ""
Bar|fffd|me.Range("Capital39").Select
End Sub

Private Sub BouArt39Menu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wArt39.Visible = 2
End Sub

Private Sub BouNoteParam|fffd|trage_Click()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
With AppWord
    Set DocWord = AppWord.Documents.Open(NomCheminDoc & ChoixOptionRente, ReadOnly:=True)
  'Set docword = OuvreWord(NomCheminDocBis, ChoixOptionRente, appword)
  'Set docword = appword.Documents.Open(NomCheminDoc & ChoixOptionRente, , True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
End With
End Sub


Private Sub CommandButton1_Click()

End Sub

Sub Bouton_39_Click()

Call Initialisation_Feuille_Synthese

 Load Article_39
 Article_39.Show

End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
Application.ScreenUpdating = False
Select Case (Range("Art39TxTech").Value <= TxTechMaxVigueur(Range("Art39DateEffet").Value) And Range("Art39Table").Value = TableVigueur(Range("Art39DateEffet").Value))
Case True: wArt39.Shapes("CacheValidD|fffd|rog").Visible = True
Case False: wArt39.Shapes("CacheValidD|fffd|rog").Visible = False
End Select

'Select Case Range("Art39ChoixOpt").Value <> "Avec r|fffd|version"
'Case True:  wArt39.Shapes("CacheRev1").Visible = True
'Case False: wArt39.Shapes("CacheRev1").Visible = False
'End Select

Select Case Range("Art39ChoixOpt").Value
Case "Sans r|fffd|version":
    wArt39.Shapes("CacheRev1").Visible = True
    wArt39.Shapes("Cache_temp").Visible = True
Case "Avec r|fffd|version":
    wArt39.Shapes("CacheRev1").Visible = False
    wArt39.Shapes("Cache_temp").Visible = True
Case "Temporaire":
    wArt39.Shapes("CacheRev1").Visible = True
    wArt39.Shapes("Cache_temp").Visible = False
Case "Temporaire avec r|fffd|version":
    wArt39.Shapes("CacheRev1").Visible = False
    wArt39.Shapes("Cache_temp").Visible = False
End Select

Select Case Range("Art39ChoixOpt").Value = "Sans r|fffd|version"
Case True:  wArt39.Shapes("CacheRev2").Visible = True
            wArt39.Shapes("CacheRev3").Visible = True
            wArt39.Shapes("CacheRev4").Visible = True
Case False: wArt39.Shapes("CacheRev2").Visible = False
            wArt39.Shapes("CacheRev3").Visible = False
            wArt39.Shapes("CacheRev4").Visible = False
End Select



wArt39.Art39CbDateEval = (Range("Art39DateEval").Value = Date)
wArt39.Art39CbTableVigueur = (Range("Art39Table").Value = TableVigueur(Range("Art39DateEffet").Value))
wArt39.Art39CbTxTechVigueur = (Range("Art39TxTech").Value = TxTechMaxVigueur(Range("Art39DateEffet").Value))
wArt39.Art39CbTxFraisVigueur = (Range("Art39TxFraisRente").Value = 0.03)
wArt39.Art39CbFracStd = (Range("Art39FracLib").Value = "Trimestriel")
wArt39.Art39CbTermeStd = (Range("Art39Terme").Value = "Echu")
Select Case Range("Art39Terme").Value = "Echu"
Case True:  wArt39.Shapes("CacheProrata").Visible = False
Case False: wArt39.Shapes("CacheProrata").Visible = True
End Select
wArt39.Art39CbProrataStd = (Range("Art39Prorata").Value = "COMP")
If wArt39.Range("Art39DateEffet").Value > 0 And Not V|fffd|rifFinMois(Range("Art39DateEffet").Value - 1) Then
  wArt39.Range("Art39DateEffet").Value = DebMois(wArt39.Range("Art39DateEffet").Value + 1)
End If
Select Case Range("Art39Rente").Value >= 30000
Case True:  wArt39.Shapes("CacheValid2").Visible = False
Case False: wArt39.Shapes("CacheValid2").Visible = True
End Select

If wArt39.Range("Art39Dependance").Value = "oui" And IsNumeric(wArt39.Range("Art39TarifDependance").Value) And wArt39.Range("Art39TarifDependance").Value <> 0 Then
wArt39.Unprotect
wArt39.Range("A17").EntireRow.Hidden = False 'modifi|fffd| en false le 09/2018 car toujours cach|fffd| sinon
'wArt39.Range("C49").EntireRow.Hidden = False
        If Not IsError(wArt39.Range("Art39CotisDependance").Value) Then
            If wArt39.Range("G37").Value = "Offre UGIPS" Then
                wArt39.Range("C38").EntireRow.Hidden = True
                wArt39.Range("C39").EntireRow.Hidden = True
                wArt39.Range("C40").EntireRow.Hidden = True
                wArt39.Art39CPDependance.Visible = False
            End If
        'Else
          wArt39.Range("C37").EntireRow.Hidden = False
          wArt39.Range("C38").EntireRow.Hidden = False
          wArt39.Range("C39").EntireRow.Hidden = False
          wArt39.Range("C40").EntireRow.Hidden = False
          wArt39.Art39CPDependance.Visible = True
        End If
wArt39.Protect
Else 'pas d|fffd|pendance
wArt39.Unprotect
wArt39.Range("C37").EntireRow.Hidden = False 'modifi|fffd| en false le 09/2018 car doit s'afficher
wArt39.Range("C38").EntireRow.Hidden = True
wArt39.Range("C39").EntireRow.Hidden = True
wArt39.Range("C40").EntireRow.Hidden = True
wArt39.Range("C41").EntireRow.Hidden = True 'ajout|fffd| le 09/2018 pour cacher le montant concern|fffd|
wArt39.Art39CPDependance.Visible = False
wArt39.Protect
End If

End Sub


Attribute VB_Name = "wArt83"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CPDependance, 2130, 0, MSForms, CommandButton"
Attribute VB_Control = "BouArt83TxAgr, 246, 1, MSForms, CommandButton"
Attribute VB_Control = "Art83CbDateRevalo, 40, 2, MSForms, CheckBox"
Attribute VB_Control = "BouArt83Ini, 37, 3, MSForms, CommandButton"
Attribute VB_Control = "BouArt83Menu, 36, 4, MSForms, CommandButton"
Attribute VB_Control = "Art83CbSystGestion, 34, 5, MSForms, CheckBox"
Attribute VB_Control = "Art83CbChoixOpt, 33, 6, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTxRev, 32, 7, MSForms, CheckBox"
Attribute VB_Control = "Art83CbJourEffet, 31, 8, MSForms, CheckBox"
Attribute VB_Control = "Art83CbApproxAge, 30, 9, MSForms, CheckBox"
Attribute VB_Control = "Art83CbAttendre, 26, 10, MSForms, CheckBox"
Attribute VB_Control = "Art83CbAutresCot, 24, 11, MSForms, CheckBox"
Attribute VB_Control = "Art83CbCotisMois, 23, 12, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTtCotisAffect, 20, 13, MSForms, CheckBox"
Attribute VB_Control = "Art83CbSystGest, 17, 14, MSForms, CheckBox"
Attribute VB_Control = "Art83CbDateEffet, 16, 15, MSForms, CheckBox"
Attribute VB_Control = "CommandButton2, 15, 16, MSForms, CommandButton"
Attribute VB_Control = "Art83CbProrataStd, 10, 17, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTermeStd, 9, 18, MSForms, CheckBox"
Attribute VB_Control = "Art83CbFracStd, 8, 19, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTxFraisVigueur, 7, 20, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTxTechVigueur, 6, 21, MSForms, CheckBox"
Attribute VB_Control = "Art83CbTableVigueur, 5, 22, MSForms, CheckBox"
Attribute VB_Control = "Art83CbDateEval, 4, 23, MSForms, CheckBox"
Attribute VB_Control = "Bouton_83, 36207, 24, MSForms, CommandButton"

Option Explicit

Dim Art83Change As Boolean
Dim Table As Boolean

Private Sub BouArt83Ini_Click()
wArt83.Range("ART83RPP").Value = ""
wArt83.Range("Art83Gest").Value = ""
wArt83.Range("Art83Gestion").Value = ""
wArt83.Range("Art83COEuro").Value = ""
wArt83.Range("Art83COUC").Value = ""
wArt83.Range("Art83VVEuro").Value = ""
wArt83.Range("Art83VVUC").Value = ""
wArt83.Range("Art83NbUc").Value = ""
wArt83.Range("Art83VpUc").Value = ""
wArt83.Range("Art83TxPB").Value = ""
wArt83.Range("TtesCotisAffect|fffd|es").Value = ""
wArt83.Range("Art83Cot1").Value = ""
wArt83.Range("Art83Cot2").Value = ""
wArt83.Range("Art83Cot3").Value = ""
wArt83.Range("Art83DateInvCot1").Value = ""
wArt83.Range("Art83DateInvCot2").Value = ""
wArt83.Range("Art83DateInvCot3").Value = ""
wArt83.Range("Art83TxFraisCotis").Value = ""
wArt83.Range("Art83CotisMois").Value = ""
wArt83.Range("Art83AutresCot").Value = ""
wArt83.Range("Art83Attendre").Value = ""
wArt83.Range("TxFraisEncEuro").Value = ""
wArt83.Range("TxFraisEncUc").Value = ""
wArt83.Range("Art83PrenomX").Value = ""
wArt83.Range("Art83NomX").Value = ""
wArt83.Range("Art83DateNaissX").Value = ""
wArt83.Range("Art83SexeX").Value = ""
wArt83.Range("Art83ChoixOpt").Value = ""
wArt83.Range("Art83TxRev").Value = ""
wArt83.Range("Art83Pr|fffd|nomY").Value = ""
wArt83.Range("Art83NomY").Value = ""
wArt83.Range("Art83DateNaissY").Value = ""
wArt83.Range("Art83SexeY").Value = ""
wArt83.Range("Art83Approx").Value = ""
wArt83.Range("Art83JourEffet").Value = ""
wArt83.Range("Art83DateEval").Value = ""
wArt83.Range("Art83DateEffet").Value = ""
wArt83.Range("Art83TxTech").Value = ""
wArt83.Range("Art83Table").Value = ""
wArt83.Range("Art83TxFraisRente").Value = ""
wArt83.Range("Art83FracLib").Value = ""
wArt83.Range("Art83Terme").Value = ""
wArt83.Range("Art83Prorata").Value = ""
wArt83.Range("Art83SystGestion").Value = ""
wArt83.Range("Art83DateRevalo").Value = ""
wArt83.Range("Dependance").Value = ""
wArt83.Range("ART83GAR").Value = ""
wArt83.Range("Art83TableGar").Value = ""
wArt83.Range("K26").Value = ""
wArt83.Range("K27").Value = ""
wArt83.Range("K28").Value = ""
wArt83.Range("K29").Value = ""
wArt83.Range("K30").Value = ""
wArt83.Range("K31").Value = ""
wArt83.Range("K32").Value = ""
wArt83.Range("K33").Value = ""
wArt83.Range("K34").Value = ""
wArt83.Range("K35").Value = ""
wArt83.Range("K36").Value = ""
wArt83.Range("K37").Value = ""
wArt83.Range("K38").Value = ""
wArt83.Range("K39").Value = ""
wArt83.Range("K40").Value = ""
wArt83.Range("K41").Value = ""
wArt83.Range("K42").Value = ""
wArt83.Range("K43").Value = ""
wArt83.Range("K44").Value = ""
wArt83.Range("K45").Value = ""
wArt83.Range("K46").Value = ""
wArt83.Range("K47").Value = ""
wArt83.Range("l26").Value = ""
wArt83.Range("l27").Value = ""
wArt83.Range("l28").Value = ""
wArt83.Range("l29").Value = ""
wArt83.Range("l30").Value = ""
wArt83.Range("l31").Value = ""
wArt83.Range("l32").Value = ""
wArt83.Range("l33").Value = ""
wArt83.Range("l34").Value = ""
wArt83.Range("l35").Value = ""
wArt83.Range("l36").Value = ""
wArt83.Range("l37").Value = ""
wArt83.Range("l38").Value = ""
wArt83.Range("l39").Value = ""
wArt83.Range("l40").Value = ""
wArt83.Range("l41").Value = ""
wArt83.Range("l42").Value = ""
wArt83.Range("l43").Value = ""
wArt83.Range("l44").Value = ""
wArt83.Range("l45").Value = ""
wArt83.Range("l46").Value = ""
wArt83.Range("l47").Value = ""
wArt83.Shapes("CachePIAnnuitesGaranties").Visible = True
wArt83.Shapes("CacheVVPIAnnuitesGaranties").Visible = True
End Sub

Private Sub BouArt83TxAGR_Click()
Application.ScreenUpdating = False
wTxAgr.Visible = True
wTxAgr.Select
wArt83.Visible = 2
End Sub

Private Sub Art83CbDateRevalo_Click()
Select Case wArt83.Range("Art83DateRevalo").Value
Case "":              wArt83.Range("Art83DateRevalo").Value = "1er janvier"
Case "1er janvier":   wArt83.Range("Art83DateRevalo").Value = "1er f|fffd|vrier"
Case "1er f|fffd|vrier":   wArt83.Range("Art83DateRevalo").Value = "1er mars"
Case "1er mars":      wArt83.Range("Art83DateRevalo").Value = "1er avril"
Case "1er avril":     wArt83.Range("Art83DateRevalo").Value = "1er mai"
Case "1er mai":       wArt83.Range("Art83DateRevalo").Value = "1er juin"
Case "1er juin":      wArt83.Range("Art83DateRevalo").Value = "1er juillet"
Case "1er juillet":   wArt83.Range("Art83DateRevalo").Value = "1er ao|fffd|t"
Case "1er ao|fffd|t":      wArt83.Range("Art83DateRevalo").Value = "1er septembre"
Case "1er septembre": wArt83.Range("Art83DateRevalo").Value = "1er octobre"
Case "1er octobre":   wArt83.Range("Art83DateRevalo").Value = "1er novembre"
Case "1er novembre":  wArt83.Range("Art83DateRevalo").Value = "1er d|fffd|cembre"
Case "1er d|fffd|cembre":  wArt83.Range("Art83DateRevalo").Value = "1er janvier"
End Select
End Sub

Private Sub Art83CbSystGestion_Click()
If wArt83.Range("Art83SystGestion").Value = "" Then wArt83.Art83CbSystGestion = True
Select Case wArt83.Art83CbSystGestion
Case True:  wArt83.Range("Art83SystGestion").Value = "Syst|fffd|me mixte"
Case False: wArt83.Range("Art83SystGestion").Value = "Macao pur"
End Select
End Sub

Private Sub Art83CbApproxAge_Click()
If wArt83.Range("Art83Approx").Value = "" Then wArt83.Art83CbApproxAge = True
Select Case wArt83.Art83CbApproxAge
Case True:  wArt83.Range("Art83Approx").Value = "Entier le plus proche"
Case False: wArt83.Range("Art83Approx").Value = "Trimestre atteint"
End Select
End Sub

Private Sub Art83CbAttendre_Click()
If wArt83.Range("Art83Attendre").Value = "" Then wArt83.Art83CbAttendre = True
Select Case wArt83.Art83CbAttendre
Case True:  wArt83.Range("Art83Attendre").Value = "non"
Case False: wArt83.Range("Art83Attendre").Value = "oui"
End Select
End Sub

Private Sub Art83CbAutresCot_Click()
If wArt83.Range("Art83AutresCot").Value = "" Then wArt83.Art83CbAutresCot = True
Select Case wArt83.Art83CbAutresCot
Case True:  wArt83.Range("Art83AutresCot").Value = "non"
            wArt83.Range("Art83Attendre").Value = ""
Case False: wArt83.Range("Art83AutresCot").Value = "oui"
End Select
End Sub

Private Sub Art83CbChoixOpt_Click()
wArt83.Art83CbChoixOpt.Visible = True
Select Case wArt83.Range("Art83ChoixOpt").Value
Case "": wArt83.Range("Art83ChoixOpt").Value = "Sans r|fffd|version"
Case "Sans r|fffd|version": wArt83.Range("Art83ChoixOpt").Value = "Sans r|fffd|version"
Case "Avec r|fffd|version": wArt83.Range("Art83ChoixOpt").Value = "Avec r|fffd|version"
Case "Paliers 70 et 75 ans": wArt83.Range("Art83ChoixOpt").Value = "Paliers 70 et 75 ans"
Case "5 annuit|fffd|s garanties": wArt83.Range("Art83ChoixOpt").Value = "5 annuit|fffd|s garanties"
Case "10 annuit|fffd|s garanties": wArt83.Range("Art83ChoixOpt").Value = "10 annuit|fffd|s garanties"
Case "15 annuit|fffd|s garanties": wArt83.Range("Art83ChoixOpt").Value = "15 annuit|fffd|s garanties"
Case "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 100%": wArt83.Range("Art83ChoixOpt").Value = "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 100%"
Case "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 200%": wArt83.Range("Art83ChoixOpt").Value = "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 200%"
Case "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 300%": wArt83.Range("Art83ChoixOpt").Value = "Arr|fffd|rages major|fffd|s au d|fffd|c|fffd|s 300%"
Case "10 annuit|fffd|s garanties avec r|fffd|version": wArt83.Range("Art83ChoixOpt").Value = "10 annuit|fffd|s garanties avec r|fffd|version"
Case "15 annuit|fffd|s garanties avec": wArt83.Range("Art83ChoixOpt").Value = "15 annuit|fffd|s garanties avec r|fffd|version"
End Select
End Sub

Private Sub Art83CbCotisMois_Click()
If wArt83.Range("Art83CotisMois").Value = "" Then wArt83.Art83CbCotisMois = True
Select Case wArt83.Art83CbCotisMois
Case True:  wArt83.Range("Art83CotisMois").Value = "non"
Case False: wArt83.Range("Art83CotisMois").Value = "oui"
End Select
End Sub

Private Sub Art83CbDateEffet_Click()
Select Case Art83CbDateEffet
Case True:  Art83CbDateEffet.Caption = "Proc. standard"
Case False: Art83CbDateEffet.Caption = "Retard opposable"
End Select
If Not Art83CbDateEffet Or wArt83.Range("Art83DateEval").Value = "" Or wArt83.Range("Art83Gestion").Value = "" Or (wArt83.Range("Art83JourEffet").Value = "" And wArt83.Range("Art83Gestion").Value = "Macao") Then
  If Not Art83Change Then wArt83.Range("Art83DateEffet").Value = ""
Else
  wArt83.Range("Art83DateEffet").Value = CalcDateEffet(wArt83.Range("Art83Gestion").Value, wArt83.Range("Art83DateEval").Value, wArt83.Range("Art83CotisMois").Value = "oui", wArt83.Range("Art83JourEffet").Value)
End If
wArt83.Range("Art83Type").Value = Art83CbDateEffet.Caption
End Sub

Private Sub Art83CbDateEval_Click()
Select Case wArt83.Art83CbDateEval
Case True:  wArt83.Range("Art83DateEval").Value = Date
Case False: If Not Art83Change Then wArt83.Range("Art83DateEval").Value = ""
End Select
End Sub

Private Sub Art83CbJourEffet_Click()
If wArt83.Range("Art83JourEffet").Value = "" Then wArt83.Art83CbJourEffet = True
Select Case wArt83.Art83CbJourEffet
Case True:  wArt83.Range("Art83JourEffet").Value = "Mois"
Case False: wArt83.Range("Art83JourEffet").Value = "Trimestre"
End Select
End Sub

Private Sub Art83CbSystGest_Click()
If wArt83.Range("Art83Gestion").Value = "" Then wArt83.Art83CbSystGest = True
Select Case wArt83.Art83CbSystGest
Case True:  wArt83.Range("Art83Gestion").Value = "Axiome"
            wArt83.Range("Art83NbUc").Value = ""
            wArt83.Range("Art83VpUc").Value = ""
            wArt83.Range("Art83TxPB").Value = ""
            wArt83.Range("Art83JourEffet").Value = ""
Case False: wArt83.Range("Art83Gestion").Value = "Macao"
            wArt83.Range("Art83CotisMois").Value = ""
            wArt83.Range("Art83DateEffet").Value = ""
            wArt83.Range("Art83AutresCot").Value = ""
            wArt83.Range("Art83EpUC").Value = ""
End Select
End Sub

Private Sub Art83CbTableVigueur_Click()
Select Case Art83CbTableVigueur
Case True:  wArt83.Range("Art83Table").Value = TableVigueur(Range("Art83DateEffet").Value)
Case False: If Not Art83Change Then wArt83.Range("Art83Table").Value = ""
End Select
End Sub


Private Sub Art83CbTtCotisAffect_Click()
If wArt83.Range("TtesCotisAffect|fffd|es").Value = "" Then wArt83.Art83CbTtCotisAffect = True
Select Case wArt83.Art83CbTtCotisAffect
Case True:  wArt83.Range("TtesCotisAffect|fffd|es").Value = "oui"
            wArt83.Range("Art83Cot1").Value = ""
            wArt83.Range("Art83DateInvCot1").Value = ""
            wArt83.Range("Art83Cot2").Value = ""
            wArt83.Range("Art83DateInvCot2").Value = ""
            wArt83.Range("Art83Cot3").Value = ""
            wArt83.Range("Art83DateInvCot3").Value = ""
            wArt83.Range("Art83TxFraisCotis").Value = ""
Case False: wArt83.Range("TtesCotisAffect|fffd|es").Value = "1 manquante"
End Select
End Sub

Private Sub Art83CbTxRev_Click()
Select Case wArt83.Art83CbTxRev
Case True:  wArt83.Range("Art83TxRev").Value = 60 / 100
Case False: If Not Art83Change Then wArt83.Range("Art83TxRev").Value = ""
End Select
End Sub

Private Sub Art83CbTxTechVigueur_Click()
Select Case wArt83.Art83CbTxTechVigueur
Case True:  Select Case Range("Art83DateEffet").Value
            Case "":   wArt83.Art83CbTxTechVigueur.Value = False
                       wArt83.Range("Art83DateEffet").Select
            Case Else: Range("Art83TxTech").Value = TxTechMaxVigueur(Range("Art83DateEffet").Value)
            End Select
Case False: If Not Art83Change Then wArt83.Range("Art83TxTech").Value = ""
End Select
End Sub

Private Sub Art83CbTxFraisVigueur_Click()
Application.ScreenUpdating = False
Select Case wArt83.Art83CbTxFraisVigueur
Case True:  wArt83.Range("Art83TxFraisRente").Value = 0.03
Case False: If Not Art83Change Then wArt83.Range("Art83TxFraisRente").Value = ""
End Select
End Sub

Private Sub Art83CbFracStd_Click()
Select Case wArt83.Art83CbFracStd
Case True:  wArt83.Range("Art83FracLib").Value = "Mensuel"
Case False: If Not Art83Change Then wArt83.Range("Art83FracLib").Value = ""
End Select
End Sub

Private Sub Art83CbTermeStd_Click()
Select Case wArt83.Art83CbTermeStd
Case True:  wArt83.Range("Art83Terme").Value = "Echu"
Case False: wArt83.Range("Art83Terme").Value = "Avance"
End Select
End Sub

Private Sub Art83CbProrataStd_Click()
Select Case wArt83.Art83CbProrataStd
Case True:  wArt83.Range("Art83Prorata").Value = "COMP"
Case False: If Not Art83Change Then wArt83.Range("Art83Prorata").Value = ""
End Select
End Sub

Private Sub BouArt83Menu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wArt83.Visible = 2
End Sub

Private Sub BouNoteParam|fffd|trage_Click()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")

With AppWord
    Set DocWord = AppWord.Documents.Open(NomCheminDoc & ChoixOptionRente, ReadOnly:=True)
  'Set docword = OuvreWord(NomCheminDocBis, ChoixOptionRente, appword)
  'Set docword = appword.Documents.Open(NomCheminDoc & ChoixOptionRente, , True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
End With
End Sub

Sub Bouton_83_Click()

If Range("Art83ChoixOpt").Value = "Paliers 70 et 75 ans" Then MsgBox "Attention |fffd| bien saisir le montant MACAO dans le titre de rente LEA en cas d'|fffd|cart"
Call Initialisation_Feuille_Synthese

 Load Article_83
 Article_83.Show

End Sub

Private Sub CPDependance_Click()
If wArt83.Range("RenteRetr").Value < 480 Then
  MsgBox "Cette option n'est pas disponible car la rente annuelle est inf|fffd|rieure |fffd| 480|fffd|"
Else
  DependanceRef.Show
  Call ImprimCPDependance
End If
End Sub

Private Sub Worksheet_Calculate()
If wArt83.Range("Art83Produit").Value = "PCSR" Then
  wArt83.Shapes("Cache83TxPB").Visible = True
  If wArt83.Range("Art83TxPB").Value <> 1 Then wArt83.Range("Art83TxPB").Value = 1
Else
  wArt83.Shapes("Cache83TxPB").Visible = False
End If
End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
Application.ScreenUpdating = False
Art83Change = True
wArt83.Unprotect

'wArt83.Unprotect

'If (Mid(wArt83.Range(ART83GAR), 1, 4) = 2790 And Mid(wArt83.Range(J39), 7, 1) = 1 or Mid(wArt83.Range("ART83RPP"), 7, 1) = 3) and (Mid(wArt83.Range("ART83RPP"), 12, 2) =  And Mid(wArt83.Range("ART83RPP"), 12, 2) = 0) or (Mid(wArt83.Range("ART83RPP"), 1,5) = 27225) and Mid(wArt83.Range("ART83RPP"), 7, 1) = 1  and Mid(wArt83.Range("ART83RPP"), 12, 2) = 00) Then
'wArt83.Range("ART83GAR").Value = "oui"

'wArt83.Range("ART83GAR").Value = "non"
'If Mid(wArt83.Range("ART83RPP"), 12, 2) = 0 And Mid(wArt83.Range("ART83RPP"), 1, 4) = 2790 And (Mid(wArt83.Range("ART83RPP"), 7, 1) = 3 Or Mid(wArt83.Range("ART83RPP"), 7, 1) = 1) Then wArt83.Range("ART83GAR").Value = "oui"
'wArt83.Protect
'wArt83.Range("ART83GAR").Value = "non"
'Select Case Mid(wArt83.Range("ART83RPP"), 1, 4)
'Case Is = 2790: If Mid(wArt83.Range("ART83RPP"), 7, 1) = 3 Or Mid(wArt83.Range("ART83RPP"), 7, 1) = 1 Then wArt83.Range("ART83GAR").Value = "oui"
'Case Is = 2400: If Mid(wArt83.Range("ART83RPP"), 5, 3) = 111 Or Mid(wArt83.Range("ART83RPP"), 5, 3) = 113 Then wArt83.Range("ART83GAR").Value = "oui"
'Case Is = 2722: If Mid(wArt83.Range("ART83RPP"), 5, 1) = 5 And (Mid(wArt83.Range("ART83RPP"), 7, 1) = 1 Or Mid(wArt83.Range("ART83RPP"), 7, 1) = 3) Then wArt83.Range("ART83GAR").Value = "oui"
'End Select


wArt83.Range("A34").EntireRow.Hidden = False
'wArt83.Shapes("Cache83TxFraisEuro").Visible = (wArt83.Range("Art83EpEuro").Value = 0)
'wArt83.Shapes("Cache83TxFraisUc").Visible = (wArt83.Range("Art83EpUc").Value = 0 And wArt83.Range("Art83NbUc").Value = 0 And wArt83.Range("Art83VpUc").Value = 0)
'wArt83.Shapes("Cache83CotisPlus").Visible = (wArt83.Range("TtesCotisAffect|fffd|es").Value = "oui")
 If wArt83.Range("TtesCotisAffect|fffd|es").Value <> "oui" And wArt83.Range("TtesCotisAffect|fffd|es").Value <> "" Then
  If wArt83.Range("TtesCotisAffect|fffd|es").Value = "1 manquante" Then
  wArt83.Shapes("Cache83CotisPlus3").Visible = True
  wArt83.Shapes("Cache83CotisPlus2").Visible = True
  wArt83.Shapes("Cache83CotisPlus").Visible = False
  wArt83.Range("MontantCotis").EntireRow.Hidden = False
  wArt83.Range("DateValo").EntireRow.Hidden = False
  wArt83.Range("MontantCotis2").EntireRow.Hidden = True
  wArt83.Range("DateValo2").EntireRow.Hidden = True
  wArt83.Range("MontantCotis3").EntireRow.Hidden = True
  wArt83.Range("DateValo3").EntireRow.Hidden = True
    End If
  If wArt83.Range("TtesCotisAffect|fffd|es").Value = "2 manquantes" Then
    wArt83.Shapes("Cache83CotisPlus3").Visible = True
    wArt83.Shapes("Cache83CotisPlus2").Visible = False
    wArt83.Shapes("Cache83CotisPlus").Visible = False
    wArt83.Range("MontantCotis").EntireRow.Hidden = False
  wArt83.Range("DateValo").EntireRow.Hidden = False
  wArt83.Range("MontantCotis2").EntireRow.Hidden = False
  wArt83.Range("DateValo2").EntireRow.Hidden = False
  wArt83.Range("MontantCotis3").EntireRow.Hidden = True
  wArt83.Range("DateValo3").EntireRow.Hidden = True
  End If
  If wArt83.Range("TtesCotisAffect|fffd|es").Value = "3 manquantes" Then
    wArt83.Shapes("Cache83CotisPlus3").Visible = False
    wArt83.Shapes("Cache83CotisPlus2").Visible = False
    wArt83.Shapes("Cache83CotisPlus").Visible = False
    wArt83.Range("MontantCotis").EntireRow.Hidden = False
    wArt83.Range("DateValo").EntireRow.Hidden = False
    wArt83.Range("MontantCotis2").EntireRow.Hidden = False
    wArt83.Range("DateValo2").EntireRow.Hidden = False
    wArt83.Range("MontantCotis3").EntireRow.Hidden = False
    wArt83.Range("DateValo3").EntireRow.Hidden = False
  End If
Else
  If wArt83.Shapes("Cache83CotisPlus3").Visible <> True Then wArt83.Shapes("Cache83CotisPlus3").Visible = True
  If wArt83.Shapes("Cache83CotisPlus2").Visible <> True Then wArt83.Shapes("Cache83CotisPlus2").Visible = True
  If wArt83.Shapes("Cache83CotisPlus").Visible <> True Then wArt83.Shapes("Cache83CotisPlus").Visible = True
  If wArt83.Range("MontantCotis").EntireRow.Hidden <> True Then wArt83.Range("MontantCotis").EntireRow.Hidden = True
  If wArt83.Range("DateValo").EntireRow.Hidden <> True Then wArt83.Range("DateValo").EntireRow.Hidden = True
  If wArt83.Range("MontantCotis2").EntireRow.Hidden <> True Then wArt83.Range("MontantCotis2").EntireRow.Hidden = True
  If wArt83.Range("DateValo2").EntireRow.Hidden <> True Then wArt83.Range("DateValo2").EntireRow.Hidden = True
  If wArt83.Range("MontantCotis3").EntireRow.Hidden <> True Then wArt83.Range("MontantCotis3").EntireRow.Hidden = True
  If wArt83.Range("DateValo3").EntireRow.Hidden <> True Then wArt83.Range("DateValo3").EntireRow.Hidden = True
End If


wArt83.Protect
wArt83.Protect
If wArt83.Shapes("Cache83CotisMois").Visible <> (wArt83.Range("Art83Gestion").Value = "Macao") Then wArt83.Shapes("Cache83CotisMois").Visible = (wArt83.Range("Art83Gestion").Value = "Macao")
If wArt83.Shapes("Cache83Attendre").Visible <> (wArt83.Range("Art83AutresCot").Value <> "oui") Then wArt83.Shapes("Cache83Attendre").Visible = (wArt83.Range("Art83AutresCot").Value <> "oui")
'wArt83.Art83CbAttendre.Visible = (wArt83.Range("Art83AutresCot").Value <> "non")
If wArt83.Shapes("Cache83EpUc").Visible <> (wArt83.Range("Art83Gestion").Value = "Macao") Then wArt83.Shapes("Cache83EpUc").Visible = (wArt83.Range("Art83Gestion").Value = "Macao")
If wArt83.Shapes("Cache83NbVpUc").Visible <> (wArt83.Range("Art83Gestion").Value = "Axiome") Then wArt83.Shapes("Cache83NbVpUc").Visible = (wArt83.Range("Art83Gestion").Value = "Axiome")
wArt83.Art83CbDateEffet.Value = (wArt83.Range("Art83DateEffet").Value = CalcDateEffet(wArt83.Range("Art83Gestion").Value, _
wArt83.Range("Art83DateEval").Value, wArt83.Range("Art83CotisMois").Value = "oui", wArt83.Range("Art83JourEffet").Value))

If wArt83.Shapes("Cache83JourEffet").Visible <> (wArt83.Range("Art83Gestion").Value = "Axiome") Then wArt83.Shapes("Cache83JourEffet").Visible = (wArt83.Range("Art83Gestion").Value = "Axiome")
Select Case wArt83.Range("Art83ChoixOpt").Value <> "Avec r|fffd|version" _
And wArt83.Range("Art83ChoixOpt").Value <> "10 annuit|fffd|s garanties avec r|fffd|version" _
And wArt83.Range("Art83ChoixOpt").Value <> "15 annuit|fffd|s garanties avec r|fffd|version" 'pas r|fffd|version
Case True:  If wArt83.Shapes("Cache83Rev1").Visible <> True Then wArt83.Shapes("Cache83Rev1").Visible = True
            wArt83.Art83CbTxRev.Visible = False
            If wArt83.Range("Art83TxRev").Value <> "" Then wArt83.Range("Art83TxRev").Value = ""
Case False: If wArt83.Shapes("Cache83Rev1").Visible <> False Then wArt83.Shapes("Cache83Rev1").Visible = False
            wArt83.Art83CbTxRev.Visible = True
End Select

'Select Case Right(wArt83.Range("Art83ChoixOpt").Value, 21) = "10 annuit|fffd|s garanties" Or Right(wArt83.Range("Art83ChoixOpt").Value, 21) = "15 annuit|fffd|s garanties" 'wArt83.Range("Art83ChoixOpt").Value <> "10 annuit|fffd|s garanties" Or wArt83.Range("Art83ChoixOpt").Value <> "15 annuit|fffd|s garanties" 'choix annuit|fffd| garanti avec rev
'Case True:  wArt83.Shapes("Rectangle 1").Visible = False
'Case False: wArt83.Shapes("Rectangle 1").Visible = True
'End Select


Select Case wArt83.Range("Art83ChoixOpt").Value = "Sans r|fffd|version"
Case True:  If wArt83.Shapes("Cache83Rev2").Visible <> True Then wArt83.Shapes("Cache83Rev2").Visible = True
            If wArt83.Shapes("Cache83Rev3").Visible <> True Then wArt83.Shapes("Cache83Rev3").Visible = True
            If wArt83.Shapes("Cache83Rev4").Visible <> True Then wArt83.Shapes("Cache83Rev4").Visible = True
Case False: If wArt83.Shapes("Cache83Rev2").Visible <> False Then wArt83.Shapes("Cache83Rev2").Visible = False
            If wArt83.Shapes("Cache83Rev3").Visible <> False Then wArt83.Shapes("Cache83Rev3").Visible = False
            If wArt83.Shapes("Cache83Rev4").Visible <> False Then wArt83.Shapes("Cache83Rev4").Visible = False
End Select
If wArt83.Art83CbDateEval <> (wArt83.Range("Art83DateEval").Value = Date) Then wArt83.Art83CbDateEval = (wArt83.Range("Art83DateEval").Value = Date)
If wArt83.Art83CbTableVigueur = (wArt83.Range("Art83Table").Value <> TableVigueur(Range("Art83DateEffet").Value)) Then wArt83.Art83CbTableVigueur = (wArt83.Range("Art83Table").Value = TableVigueur(Range("Art83DateEffet").Value))
If wArt83.Art83CbTxTechVigueur = (wArt83.Range("Art83TxTech").Value <> TxTechMaxVigueur(Range("Art83DateEffet").Value)) Then wArt83.Art83CbTxTechVigueur = (wArt83.Range("Art83TxTech").Value = TxTechMaxVigueur(Range("Art83DateEffet").Value))
If wArt83.Art83CbTxFraisVigueur <> (wArt83.Range("Art83TxFraisRente").Value = 0.03) Then wArt83.Art83CbTxFraisVigueur = (wArt83.Range("Art83TxFraisRente").Value = 0.03)
If wArt83.Art83CbFracStd <> (wArt83.Range("Art83FracLib").Value = "Mensuel") Then wArt83.Art83CbFracStd = (wArt83.Range("Art83FracLib").Value = "Mensuel") 'Modification trimestriel |fffd| mensuel
If wArt83.Art83CbTermeStd <> (wArt83.Range("Art83Terme").Value = "Echu") Then wArt83.Art83CbTermeStd = (wArt83.Range("Art83Terme").Value = "Echu")
Select Case wArt83.Range("Art83Terme").Value = "Echu"
Case True:  If wArt83.Shapes("Cache83Prorata").Visible <> False Then wArt83.Shapes("Cache83Prorata").Visible = False
Case False: If wArt83.Shapes("Cache83Prorata").Visible <> True Then wArt83.Shapes("Cache83Prorata").Visible = True
End Select
wArt83.Art83CbProrataStd = (wArt83.Range("Art83Prorata").Value = "COMP")
If wArt83.Range("Art83DateEffet").Value > 0 And Not V|fffd|rifFinMois(wArt83.Range("Art83DateEffet").Value - 1) Then
  If wArt83.Range("Art83DateEffet").Value <> DebMois(wArt83.Range("Art83DateEffet").Value + 1) Then wArt83.Range("Art83DateEffet").Value = DebMois(wArt83.Range("Art83DateEffet").Value + 1)
End If
Select Case wArt83.Range("Art83Gestion").Value = "Axiome"
Case True:  If wArt83.Shapes("CacheAxiom").Visible <> True Then wArt83.Shapes("CacheAxiom").Visible = True
Case False: If wArt83.Shapes("CacheAxiom").Visible = False Then wArt83.Shapes("CacheAxiom").Visible = False
End Select

'If Right(wArt83.Range("Art83ChoixOpt").Value, 18) = "annuit|fffd|s garanties" Then
'wArt83.Unprotect
''wArt83.Shapes("Rectangle 1").Visible = False
'wArt83.Range("A47").EntireRow.Hidden = False
'wArt83.Protect
'Else
'wArt83.Unprotect
''wArt83.Shapes("Rectangle 1").Visible = True
'wArt83.Range("A47").EntireRow.Hidden = True
'wArt83.Protect
'End If
wArt83.Unprotect
If wArt83.Range("H6").Value = "Garantie de table SOLERE V1" And wArt83.Range("ART83GAR").Value <> "" And wArt83.Range("ART83GAR").Value <> "SOLERE V1" Then MsgBox ("Veuillez saisir la garantie de table SOLERE V1")
If wArt83.Range("H6").Value = "Garantie de table RSE 0.25%" And wArt83.Range("ART83GAR").Value <> "" And wArt83.Range("ART83GAR").Value <> "RSE 0.25%" Then MsgBox ("Veuillez saisir la garantie de table RSE 0.25%")
If wArt83.Range("H6").Value = "Garantie de table Gras Savoye-conviction retraite 2013" And wArt83.Range("ART83GAR").Value <> "" And wArt83.Range("ART83GAR").Value <> "Gras Savoye-Conviction Retraite 2013" Then MsgBox ("Veuillez saisir la garantie de table Gras Savoye-Conviction Retraite 2013")
If wArt83.Range("H6").Value = "Garantie de table BEARING" And wArt83.Range("ART83GAR").Value <> "" And wArt83.Range("ART83GAR").Value <> "BEARING" Then MsgBox ("Veuillez saisir la garantie de table BEARING") 'Ajout BEARING
If wArt83.Range("H6").Value = "Merci de v|fffd|rifier dans la fiche technique que ce contrat n'a pas de garantie de table" And wArt83.Range("ART83GAR").Value <> "" And wArt83.Range("ART83GAR").Value <> "non" And wArt83.Range("ART83GAR").Value <> "RSE 0.25%" Then MsgBox ("Veuillez s|fffd|lectionner la garantie de table RSE 0.25% ou aucune garantie -non- en fonction des donn|fffd|es de la fiche technique")  'Ajout BEARING
If wArt83.Range("H33").Value = "Ce contrat poss|fffd|de une garantie d|fffd|pendance" And wArt83.Range("Dependance").Value <> "" And wArt83.Range("Dependance").Value <> "oui" Then MsgBox ("Veuillez s|fffd|lectionner la pr|fffd|sence d'une garantie d|fffd|pendance")


wArt83.Protect

wArt83.Unprotect
 wArt83.Shapes("CacheRB2").Visible = False
 wArt83.Shapes("CacheHistoriqueVV").Visible = True
Select Case wArt83.Range("ART83GAR").Value
Case "non", "": wArt83.Shapes("CacheTable").Visible = True
            wArt83.Shapes("CacheRB2").Visible = True
            wArt83.Range("Art83_PAV").EntireRow.Hidden = True
             wArt83.Shapes("CacheHistoriqueVV").Visible = True
             wArt83.Range("Q25").EntireColumn.Hidden = False
             
Case "SOLERE V1": wArt83.Shapes("CacheTable").Visible = False
                         wArt83.Shapes("CacheRB2").Visible = False
                         wArt83.Range("Art83_PAV").EntireRow.Hidden = False
                         wArt83.Shapes("CacheHistoriqueVV").Visible = True
                         wArt83.Range("Q25").EntireColumn.Hidden = False
                         
Case "BEARING", "Gras Savoye-Conviction Retraite 2013": wArt83.Shapes("CacheTable").Visible = False 'Ajout BEARING
                    wArt83.Shapes("CacheRB2").Visible = False
                    wArt83.Range("Art83_PAV").EntireRow.Hidden = True
                    wArt83.Shapes("CacheHistoriqueVV").Visible = False
                    wArt83.Range("Q25").EntireColumn.Hidden = True
                    If (Range("Art83VVEuro").Value + Range("Art83VVUC").Value) < WorksheetFunction.Max(Range("VV5derannee")) Then MsgBox "Le montant des VV renseign|fffd| dans le tableau de droite est sup|fffd|rieur aux VV totaux", 16, "Attention"
                    If wArt83.Range("G131").Value > 0 Then MsgBox "Les VV du tableau de droite doivent |fffd|tre renseign|fffd|s du plus ancien au plus r|fffd|cent", 16, "Attention"
                    
Case "RSE 0.25%":   wArt83.Shapes("CacheTable").Visible = False
                    wArt83.Shapes("CacheRB2").Visible = False
                    wArt83.Range("Art83_PAV").EntireRow.Hidden = True
                    wArt83.Shapes("CacheHistoriqueVV").Visible = False
                    wArt83.Range("Q25").EntireColumn.Hidden = False
                    If (Range("Art83VVEuro").Value + Range("Art83VVUC").Value) < WorksheetFunction.Max(Range("VV5derannee")) Then MsgBox "Le montant des VV renseign|fffd| dans le tableau de droite est sup|fffd|rieur aux VV totaux", 16, "Attention"
                    If wArt83.Range("G131").Value > 0 Then MsgBox "Les VV du tableau de droite doivent |fffd|tre renseign|fffd|s du plus ancien au plus r|fffd|cent", 16, "Attention"
                    
End Select

If wArt83.Range("ART83GAR").Value = "BEARING" And wArt83.Range("Art83TableGar").Value <> "" And wArt83.Range("Art83TableGar").Value <> "TGHF05" Then MsgBox ("Veuillez saisir la table garantie TGHF05 pour le contrat BEARING") 'Ajout BEARING
wArt83.Protect

If wArt83.Range("Dependance").Value = "oui" And IsNumeric(wArt83.Range("TarifDependance").Value) And wArt83.Range("TarifDependance").Value <> 0 Then
wArt83.Unprotect

        If Not IsError(wArt83.Range("CotisDependance").Value) Then
            If wArt83.Range("CotisDependance").Value = "Offre UGIPS" Then
                wArt83.Range("MontantREf").EntireRow.Hidden = True
                wArt83.Range("TxPrelev").EntireRow.Hidden = True
                wArt83.Range("RenteBrute").EntireRow.Hidden = False
                wArt83.CPDependance.Visible = False
            Else
                wArt83.Range("MontantREf").EntireRow.Hidden = False
                wArt83.Range("TxPrelev").EntireRow.Hidden = False
                wArt83.Range("RenteBrute").EntireRow.Hidden = False
                wArt83.CPDependance.Visible = True
            End If
        Else
          wArt83.Range("MontantREf").EntireRow.Hidden = False
          wArt83.Range("TxPrelev").EntireRow.Hidden = False
          wArt83.Range("RenteBrute").EntireRow.Hidden = False
          wArt83.CPDependance.Visible = True
        End If
wArt83.Protect
Else
wArt83.Unprotect
If wArt83.Range("CotisDEp").EntireRow.Hidden <> True Then wArt83.Range("CotisDEp").EntireRow.Hidden = True
If wArt83.Range("MontantREf").EntireRow.Hidden <> True Then wArt83.Range("MontantREf").EntireRow.Hidden = True
If wArt83.Range("TxPrelev").EntireRow.Hidden <> True Then wArt83.Range("TxPrelev").EntireRow.Hidden = True
If wArt83.Range("RenteBrute").EntireRow.Hidden <> True Then wArt83.Range("RenteBrute").EntireRow.Hidden = True
wArt83.CPDependance.Visible = False
wArt83.Protect
End If


                       

Art83Change = False
End Sub




Attribute VB_Name = "wAxe3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "AxeImprimer, 33, 0, MSForms, CommandButton"
Attribute VB_Control = "AxeCalculer, 12, 1, MSForms, CommandButton"
Attribute VB_Control = "ButAxeInitialiser, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "GoBar|fffd|me, 1, 3, MSForms, CommandButton"

Option Explicit

Private Sub AxeCalculer_Click()
If V|fffd|rifieAxe = True Then
  If Bar|fffd|me.Range("ProrogAnticip") = "Prorogation" Then
    wAxe3.Range("AxeCoef") = "Coef Prorogation"
  Else
    wAxe3.Range("AxeCoef") = "Coef Anticipation"
  End If
  Call CoeffReducRev
  Call CoeffAnticipation
End If
End Sub

Private Sub AxeImprimer_Click()
ActiveSheet.PageSetup.PrintArea = "$A$1:$Q$43"
ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True
End Sub

Private Sub ButAxeInitialiser_Click()
wAxe3.Range("AxeTable").Value = ""
wAxe3.Range("AxeCotis").Value = ""
wAxe3.Range("AxeTxTech").Value = ""
wAxe3.Range("AxeDerniereRenteFinal") = ""
wAxe3.Range("AxeReducRev") = ""
wAxe3.Range("C13:F77").ClearContents
wAxe3.Range("F12") = ""
End Sub

Private Sub GoBar|fffd|me_Click()
Application.ScreenUpdating = False
Bar|fffd|me.Visible = True
Worksheets("MajoLeg").Visible = True
Bar|fffd|me.Select
wAxe3.Visible = False
Application.ScreenUpdating = True
End Sub

Function CoeffReducRev()
Bar|fffd|me.TypeRente.Value = "RVD (rente viag|fffd|re diff|fffd|r|fffd|e)"
If wArt83.Range("Art83Approx").Value <> "Trimestre atteint" Then
  wArt83.Range("Art83Approx").Value = "Trimestre atteint"
  MsgBox "Le mode d'approximation de l'|fffd|ge est modifi|fffd| (trimestre atteint impos|fffd| sur ce produit)", , "Information"
End If
Bar|fffd|me.Range("TxTech") = wAxe3.Range("AxeTxTech").Value
Bar|fffd|me.Range("Table") = wAxe3.Range("AxeTable").Value
Bar|fffd|me.Range("Capital83") = wAxe3.Range("AxeCotis").Value
wAxe3.Range("AxeReducRev").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
wAxe3.Range("AxeDerniereRenteFinal").Value = Bar|fffd|me.Range("Rente83").Value
End Function

Function V|fffd|rifieAxe() As Boolean
V|fffd|rifieAxe = False
If wAxe3.Range("AxeTable").Value = "" Then
  MsgBox "Veuillez indiquer la table en vigueur", , "Avertissement"
  wAxe3.Range("AxeTable").Select
Exit Function
End If
If wAxe3.Range("AxeTxTech").Value = "" Then
  MsgBox "Veuillez indiquer le taux technique en vigueur", , "Avertissement"
  wAxe3.Range("AxeTxTech").Select
Exit Function
End If
If wAxe3.Range("AxeCotis").Value = "" Then
  MsgBox "Veuillez indiquer le montant de la cotisation pour 2008", , "Avertissement"
  wAxe3.Range("AxeCotis").Select
Exit Function
End If
V|fffd|rifieAxe = True
End Function

Function CoeffAnticipation()
Dim i As Integer
Bar|fffd|me.TypeRente.Value = "Capi Fi Transfo Imm|fffd|diate"
i = 12
While wAxe3.Cells(i, 5).Value <> ""
  Bar|fffd|me.Range("Table").Value = wAxe3.Cells(i, 4).Value
 ' Bar|fffd|me.Range("Table").Value = wAxe3.Range("AxeTable").Value
  Bar|fffd|me.Range("Txtech").Value = wAxe3.Cells(i, 5).Value
  wAxe3.Cells(i, 6).Value = Bar|fffd|me.Range("CoefA").Value
  Select Case Bar|fffd|me.ExistR|fffd|version1
  Case True:  Select Case Bar|fffd|me.ModificationAge
              Case True:  wAxe3.Cells(i, 9).Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
              Case False: wAxe3.Cells(i, 9).Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
              End Select
  Case False: Select Case Bar|fffd|me.ModificationAge
              Case True:  wAxe3.Cells(i, 9).Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
              Case False: wAxe3.Cells(i, 9).Value = Bar|fffd|me.Range("Annuit|fffd|").Value
              End Select
  End Select
  i = i + 1
Wend
End Function

Private Sub Worksheet_Activate()
wAxe3.Range("F12:F77").ClearContents
wAxe3.Range("I12:I77").ClearContents
End Sub
Attribute VB_Name = "wC3RPR84"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouC3rpr84Menu, 18, 0, MSForms, CommandButton"
Private Sub BouC3rpr84Menu_Click()
wMenu.Visible = True
wMenu.Select
wC3RPR84.Visible = 2
End Sub
Attribute VB_Name = "wCA86"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouCA86Menu, 2, 0, MSForms, CommandButton"

Private Sub BouCA86Menu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wCA86.Visible = 2
End Sub
Attribute VB_Name = "wCCR"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "RetourBareme, 1, 0, MSForms, CommandButton"
Private Sub RetourBareme_Click()
Bar|fffd|me.Activate
End Sub
Attribute VB_Name = "wCERCA84"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouCERCA84Menu, 2, 0, MSForms, CommandButton"

Private Sub BouCERCA84Menu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wCERCA84.Visible = 2
End Sub
Attribute VB_Name = "wCERP"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouCERPMenu, 2, 0, MSForms, CommandButton"

Private Sub BouCERPMenu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wCERP.Visible = 2
End Sub
Attribute VB_Name = "wCalcIBM"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouM|fffd|thodo, 128, 2, MSForms, CommandButton"
Attribute VB_Control = "IbmIniEval, 67, 3, MSForms, CommandButton"
Attribute VB_Control = "IbmEvaluation, 64, 4, MSForms, CommandButton"
Attribute VB_Control = "IbmLiquidation, 63, 5, MSForms, CommandButton"
Attribute VB_Control = "IbmQuitter, 62, 6, MSForms, CommandButton"

Option Explicit

Private Sub CalcIbmQuit_Click()
Application.ScreenUpdating = False
Bar|fffd|me.Visible = True
Worksheets("MajoLeg").Visible = True
Bar|fffd|me.Select
Worksheets("CalcIBM").Visible = False
Application.ScreenUpdating = True
End Sub
Function MinPos(ByVal a, ByVal b, ByVal c, ByVal d) As Double
Dim e As Double
e = 0
If a > 0 Then e = a
If b > 0 And b < e Then e = b
If c > 0 And c < e Then e = c
If d > 0 And d < e Then e = d
MinPos = e
End Function


Private Sub IbmEvaluation_Click()
Dim R|fffd|ponse As Variant, i As Integer, a, b, c, d, T1, T2, T3, T4, DateNaissBis, diff, DateNaiss, DateDebRente As Double
Application.ScreenUpdating = False
i = 23
NbEvalIbm = 1
wResumIBM.Visible = True
wResumIBM.Select
Do Until i = 80
  If (wResumIBM.Range("c" & i) = "") And (wResumIBM.Range("d" & i) = "") Then
    If Bar|fffd|me.ModificationAge Then
      wResumIBM.Range("b" & i) = Bar|fffd|me.Range("Th|fffd|orie").Value
    Else
      wResumIBM.Range("b" & i) = Bar|fffd|me.Range("DateDebRente").Value
    End If
   
            DateNaiss = Bar|fffd|me.Range("DateNaissX").Value
            DateDebRente = Bar|fffd|me.Range("DateDebRente").Value

            a = nbann|fffd|es(FinTrim(DateNaiss - 1), DateDebRente)
            If a > 65 Then
            
            b = a - 65
            c = Int(b)
            d = Int((b - c) * 12)
            
            If c = 0 And d = 0 Then
            wResumIBM.Range("c" & i) = "Aucune"
            ElseIf d > 0 And c > 1 Then
            wResumIBM.Range("c" & i) = c & " ans et " & d & "mois"
            ElseIf d = 0 And c > 1 Then
             wResumIBM.Range("c" & i) = c & " ans"
            ElseIf d > 0 And c = 1 Then
            wResumIBM.Range("c" & i) = c & " an et " & d & "mois"
            ElseIf d = 0 And c = 1 Then
             wResumIBM.Range("c" & i) = c & " an"
            ElseIf d > 0 And c = 0 Then
            wResumIBM.Range("c" & i) = d & " mois"
            End If

    
           ElseIf a < 65 Then
        
            b = 65 - a
            c = Int(b)
            d = Int(Abs(c - b) * 12)
            
            If c = 0 And d = 0 Then
            wResumIBM.Range("c" & i) = "Aucune"
            ElseIf d > 0 And c > 1 Then
            wResumIBM.Range("c" & i) = "-" & c & " ans et -" & d & "mois"
            ElseIf d = 0 And c > 1 Then
             wResumIBM.Range("c" & i) = "-" & c & " ans"
            ElseIf d > 0 And c = 1 Then
            wResumIBM.Range("c" & i) = "-" & c & " an et -" & d & "mois"
            ElseIf d = 0 And c = 1 Then
             wResumIBM.Range("c" & i) = "-" & c & " an"
            ElseIf d > 0 And c = 0 Then
            wResumIBM.Range("c" & i) = "-" & d & " mois"
            End If
    
        
    Else
      wResumIBM.Range("c" & i) = "Aucune"
    End If

        
        '    If Bar|fffd|me.ModificationAge Then
        '      Select Case Bar|fffd|me.Range("NbAnn|fffd|esModif").Value
        '      Case Is > 1
        '        Select Case Bar|fffd|me.Range("NbMoisModif").Value
        '        Case Is > 0: wResumIBM.Range("c" & i) = Bar|fffd|me.Range("NbAnn|fffd|esModif").Value & " ans et " & Bar|fffd|me.Range("NbMoisModif").Value & " mois"
        '        Case Else:   wResumIBM.Range("c" & i) = Bar|fffd|me.Range("NbAnn|fffd|esModif").Value & " ans"
        '        End Select
        '      Case 1
        '        Select Case Bar|fffd|me.Range("NbMoisModif").Value
        '        Case Is > 0: wResumIBM.Range("c" & i) = Bar|fffd|me.Range("NbAnn|fffd|esModif").Value & " an et " & Bar|fffd|me.Range("NbMoisModif").Value & " mois"
        '        Case Else:   wResumIBM.Range("c" & i) = Bar|fffd|me.Range("NbAnn|fffd|esModif").Value & " an"
        '        End Select
        '      Case Else
        '        Select Case Bar|fffd|me.Range("NbMoisModif").Value
        '        Case Is > 0: wResumIBM.Range("c" & i) = Bar|fffd|me.Range("NbMoisModif").Value & " mois"
        '        Case Else:   wResumIBM.Range("c" & i) = "Aucune"
        '        End Select
        '      End Select

    If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
      wResumIBM.Range("d" & i) = Format(Bar|fffd|me.Range("TxRev").Value, "0%")
    Else
      wResumIBM.Range("d" & i) = "Sans r|fffd|version"
    End If
    wResumIBM.Range("e" & i) = Format(Worksheets("CalcIBM").Range("IbmRente").Value, "##,##0.00") & " |fffd|"
    If Range("IbmInclureMajoLegEval").Value = "Oui" Then
      wResumIBM.Range("f" & i) = Format(Range("IbmMajoLeg").Value, "##,##0.00") & " " & " |fffd|"
      wResumIBM.Range("g" & i) = Format((Range("IbmRente").Value + Range("IbmMajoLeg").Value), "##,##0.00") & " |fffd|"
    Else
      wResumIBM.Range("f" & i) = "---"
      wResumIBM.Range("g" & i) = Format(Range("IbmRente").Value, "##,##0.00") & " |fffd|"
    End If
    wResumIBM.Range("a20") = "Pour faire suite |fffd| votre demande, vous trouverez ci-dessous les |fffd|valuations demand|fffd|es,"
    wResumIBM.Rows(i).RowHeight = 15
    wResumIBM.Range("B" & i & ":" & "D" & i).Select
    With Selection
      .HorizontalAlignment = xlCenter
    End With
    wResumIBM.Range("E" & i & ":" & "G" & i).Select
    With Selection
      .HorizontalAlignment = xlRight
      .Style = "Currency"
    End With
    wResumIBM.Range("B" & i & ":" & "G" & i).Select
    With Selection.Font
      .Name = "Source Sans Pro"
    End With
    wResumIBM.Range("G" & i).Select
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    End With
    wResumIBM.Rows((i + 1) & ":" & (i + 25)).Select
    Selection.ClearContents
    wResumIBM.Range("a" & (i + 6)) = "Si vous souhaitez formuler une demande de r|fffd|version, vous devez imp|fffd|rativement nous retourner"
    wResumIBM.Range("a" & (i + 7)) = "2 ans avant la date de liquidation pr|fffd|vue, l'imprim|fffd| joint, |fffd| d|fffd|faut l'examen d'un questionnaire "
    wResumIBM.Range("a" & (i + 8)) = "m|fffd|dical sera n|fffd|cessaire."
    wResumIBM.Range("a" & (i + 10)) = "Pour la mise en place de votre rente, vous devez nous adresser trois mois avant la date de d|fffd|part, une"
    wResumIBM.Range("a" & (i + 11)) = "demande de liquidation par courrier, |fffd| laquelle vous joindrez votre extrait d'acte de naissance ainsi "
    wResumIBM.Range("a" & (i + 12)) = "que celui de votre |fffd|pouse en cas de r|fffd|version accompagn|fffd| d'un relev|fffd| d'identit|fffd| bancaire ou postal."
    wResumIBM.Range("a" & (i + 14)) = "Nous vous remercions de bien vouloir nous confirmer votre date de d|fffd|part en retraite."
    wResumIBM.Range("a" & (i + 17)) = "Nous vous prions d'agr|fffd|er, " & wResumIBM.Range("a18") & " l'expression de notre consid|fffd|ration distingu|fffd|e."
    wResumIBM.Range("f" & (i + 25)) = "La Direction Retraite"
    If Range("IbmInclureMajoLegEval").Value = "Oui" Then
      wResumIBM.Range("a" & (i + 3)) = "Dans l'|fffd|tat actuel de la loi des finances pour l'ann|fffd|e " & Year(Date) & ", si votre rente |fffd|tait en cours de paiement, elle"
      wResumIBM.Range("a" & (i + 4)) = "b|fffd|n|fffd|ficierait des majorations l|fffd|gales que nous avons indiqu|fffd|es."
    Else
      wResumIBM.Range("a" & (i + 3)) = ""
      wResumIBM.Range("a" & (i + 4)) = ""
    End If
    R|fffd|ponse = MsgBox("Voulez-vous imprimer l'|fffd|valuation compl|fffd|te.(Vous pouvez faire une autre |fffd|valuation, les informations sont stock|fffd|es dans la feuille RESUME)", vbYesNo, "AXA")
    If R|fffd|ponse <> 7 Then
    calc = False
      Call CalculerIBM
      Call IbmImprimEvaluation
    End If
    Sheets("CalcIBM").Select
    Exit Sub
  Else
    NbEvalIbm = NbEvalIbm + 1
  End If
  i = i + 1
Loop
Application.ScreenUpdating = True
End Sub

Private Sub IbmIniEval_Click()
Application.ScreenUpdating = False
Worksheets("ResumIbm").Visible = True
Worksheets("ResumIbm").Select
Worksheets("ResumIbm").Rows("23:90").Value = ""
Worksheets("CalcIbm").Select
Worksheets("ResumIbm").Visible = False
Application.ScreenUpdating = True
End Sub

Private Sub IbmQuitter_Click()
Bar|fffd|me.Visible = True
wMajoLeg.Visible = True
Bar|fffd|me.Select
wCalcIBM.Visible = False
wLiquidIBM.Visible = False
wResumIBM.Visible = False
calc = False
End Sub

Private Sub Worksheet_Activate()

'-- test 2019 on fixe les boutons pour |fffd|viter le d|fffd|placement

wCalcIBM.IbmQuitter.Left = 547
wCalcIBM.IbmQuitter.Top = 22
wCalcIBM.IbmQuitter.Width = 50
wCalcIBM.IbmQuitter.Height = 20
wCalcIBM.IbmQuitter.Font = "Source Sans Pro"
wCalcIBM.IbmQuitter.FontSize = 8

wCalcIBM.BouM|fffd|thodo.Left = 482
wCalcIBM.BouM|fffd|thodo.Top = 22
wCalcIBM.BouM|fffd|thodo.Width = 51
wCalcIBM.BouM|fffd|thodo.Height = 20
wCalcIBM.BouM|fffd|thodo.Font = "Source Sans Pro"
wCalcIBM.BouM|fffd|thodo.FontSize = 8

wCalcIBM.IbmEvaluation.Left = 106
wCalcIBM.IbmEvaluation.Top = 22
wCalcIBM.IbmEvaluation.Width = 75
wCalcIBM.IbmEvaluation.Height = 20
wCalcIBM.IbmEvaluation.Font = "Source Sans Pro"
wCalcIBM.IbmEvaluation.FontSize = 8

wCalcIBM.IbmLiquidation.Left = 106
wCalcIBM.IbmLiquidation.Top = 48
wCalcIBM.IbmLiquidation.Width = 75
wCalcIBM.IbmLiquidation.Height = 20
wCalcIBM.IbmLiquidation.Font = "Source Sans Pro"
wCalcIBM.IbmLiquidation.FontSize = 8

Call CalculerIBM
End Sub

Function CalculerIBM()
Dim Tx, Txrev As Double
Dim DateNaissX, DateNaissXBis As Date, DateCalcul As Date, Table1 As String, Table2 As String
Dim TxTech As Double, Fractionnement As String, Frac As Integer
Dim DateNaissY1, DateNaissY1Trim, DateNaissY1Bis As Date
Dim DateDebRente As Date, DateDebRenteBis As Double, DateTerme As Date
Dim TxCroissRte70_75 As Double, Terme As String, TxFraisRente As Double
Dim Approx As Integer, ApproxAge As String, AgeTerme As Double
Dim ProrataD|fffd|c|fffd|s As String, IdContrAssurance As String, DateFinGar As Date
Dim TxFraisDiff As Double, DateFinDiff As Date, AgeMinRev As Double
Dim AgeDebRente As Double
Dim ContrAssurance As String, Prorata As String, TxReval As Double, Sexe As String
Dim AgeX As Double, AgeY1 As Double, AgeY2 As Double, AgeFinGar As Double, AgeFinDiff As Double
Dim AnNaissX As Integer, AnNaissY1 As Integer
Dim a, b, c, d, e As Double


If Bar|fffd|me.Range("TxFraisRente").Value <> 1.35 / 100 Then
  Bar|fffd|me.Range("TxFraisRente").Value = 1.35 / 100
  MsgBox "Le taux de frais sur rente a |fffd|t|fffd| modifi|fffd| |fffd| 1,35 %", , "Information"
End If
If Bar|fffd|me.Range("TxFraisDiff").Value <> 0.05 / 100 Then
  Bar|fffd|me.Range("TxFraisDiff").Value = 0.05 / 100
  MsgBox "Le taux de frais pendant diff|fffd|r|fffd| a |fffd|t|fffd| modifi|fffd| |fffd| 0,05 %", , "Information"
End If
If Bar|fffd|me.Fractionnement.Value <> "Trimestriel" Then
  Bar|fffd|me.Fractionnement.Value = "Trimestriel"
  MsgBox "Le fractionnement a |fffd|t|fffd| modifi|fffd| en trimestriel", , "Information"
End If
If Bar|fffd|me.Terme.Value <> "Echu" Then
  Bar|fffd|me.Terme.Value = "Echu"
  MsgBox "Le terme a |fffd|t|fffd| modifi|fffd| en |fffd|chu", , "Information"
End If

        If nbann|fffd|es(FinTrim(Bar|fffd|me.Range("DateNaissX").Value - 1), Bar|fffd|me.Range("DateDebRente").Value) >= 65 Then
        
        Worksheets("CalcIBM").Range("IbmCoef0.5").Value = CoefMajo(0.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef4.5").Value = CoefMajo(4.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef3.5").Value = CoefMajo(3.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.5").Value = CoefMajo(2.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.25").Value = CoefMajo(2.25 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.0").Value = CoefMajo(2 / 100)
        Worksheets("CalcIBM").Range("IbmCoef1.25").Value = CoefMajo(1.25 / 100)
        Worksheets("CalcIBM").Range("IbmCoef0.0").Value = CoefMajo(0)
        
        Else
        
        Worksheets("CalcIBM").Range("IbmCoef0.5").Value = CoefMino(0.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef4.5").Value = CoefMino(4.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef3.5").Value = CoefMino(3.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.5").Value = CoefMino(2.5 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.25").Value = CoefMino(2.25 / 100)
        Worksheets("CalcIBM").Range("IbmCoef2.0").Value = CoefMino(2 / 100)
        Worksheets("CalcIBM").Range("IbmCoef1.25").Value = CoefMino(1.25 / 100)
        Worksheets("CalcIBM").Range("IbmCoef0.0").Value = CoefMino(0)
        
        
        End If

' Modifi|fffd| le 28/04/2014

        ApproxAge = Bar|fffd|me.Range("ApproxAge").Value
        Select Case ApproxAge
        Case "Age entier le + proche": Approx = 1
        Case "Semest. + proche": Approx = 2
        Case "Trim + proche": Approx = 4
        Case "Mois + proche": Approx = 12
        Case "Date exacte": Approx = 0
        Case "Age entier atteint": Approx = 10
        Case "Semest. atteint": Approx = 20
        Case "Trim atteint": Approx = 40
        Case "Mois atteint": Approx = 120
        End Select

        DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
        DateNaissY1 = Bar|fffd|me.Range("DateNaissY1").Value
        DateDebRente = Bar|fffd|me.Range("DateDebRente").Value
        AgeFinDiff = 65
        TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
        Txrev = Bar|fffd|me.Range("TxRev").Value
        Terme = Bar|fffd|me.Range("Terme").Value
        TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
        AgeDebRente = Bar|fffd|me.Range("AgeDebRente").Value
        AnNaissX = Year(DateNaissX)
        AnNaissY1 = Year(DateNaissY1)
        DateNaissXBis = ApproximAge(DateNaissX - 1, DateDebRente, Approx)
        DateNaissY1Bis = ApproximAge(DateNaissY1 - 1, DateDebRente, Approx)
        AgeX = nbann|fffd|es(DateNaissXBis, DateDebRente)
        AgeY1 = nbann|fffd|es(DateNaissY1Bis, DateDebRente)
        Table1 = Bar|fffd|me.Range("Table").Value
        Table2 = Table1
        Sexe = Bar|fffd|me.Range("Sexe").Value
                
        Select Case Table1
        Case "TGHF05"
        Select Case Sexe
        Case "H/F": Table1 = "TGH05"
                  Table2 = "TGF05"
        Case "F/H": Table1 = "TGF05"
                  Table2 = "TGH05"
        Case "H/H": Table1 = "TGH05"
                  Table2 = "TGH05"
        Case "F/F": Table1 = "TGF05"
                  Table2 = "TGF05"
        Case Else: MsgBox "Bug table"
        End Select
        Case "TPG+x/15.TGHF05"
        If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
        Select Case Sexe
        Case "H/F": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/H": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "H/H": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/F": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
        Case Else:  MsgBox "Bug table"
        End Select
        Else
        Select Case Sexe
        Case "H/F": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/H": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "H/H": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/F": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
        Case Else:  MsgBox "Bug table"
        End Select
        End If
        
        Case "TV+x/7.TPG"
        If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
        Table1 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
        Table2 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
        Else
        Table1 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
        Table2 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
        End If
        End Select
        
        Select Case Terme
        Case "Echu":   ProrataD|fffd|c|fffd|s = Bar|fffd|me.Range("ProrataD|fffd|c|fffd|s").Value
                   Select Case ProrataD|fffd|c|fffd|s
                   Case "Sans": Prorata = "Sans"
                   Case "Proportionnel": Prorata = "Prop"
                   Case "Complet": Prorata = "COMP"
                   End Select
        Case "Avance": Prorata = "Sans"
        Case Else:     MsgBox "Terme inconnu : " & Terme
        End Select
        Fractionnement = Bar|fffd|me.Range("Fractionnement").Value
        Select Case Bar|fffd|me.Range("Fractionnement").Value
        Case "Mensuel": Frac = 12
        Case "Trimestriel": Frac = 4
        Case "Semestriel": Frac = 2
        Case "Annuel": Frac = 1
        Case Else
        MsgBox "Fractionnement inconnu : " & Fractionnement
        End Select
    

    
  Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
  
  Case 1
    
    TxTech = 4.5 / 100
    Worksheets("CalcIBM").Range("IbmAn4.5").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 3.5 / 100
    Worksheets("CalcIBM").Range("IbmAn3.5").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2.5 / 100
    Worksheets("CalcIBM").Range("IbmAn2.5").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2.25 / 100
    Worksheets("CalcIBM").Range("IbmAn2.25").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2 / 100
    Worksheets("CalcIBM").Range("IbmAn2.0").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 1.25 / 100
    Worksheets("CalcIBM").Range("IbmAn1.25").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 0.5 / 100
    Worksheets("CalcIBM").Range("IbmAn0.5").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 0 / 100
    Worksheets("CalcIBM").Range("IbmAn0.0").Value = sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    Worksheets("CalcIBM").Range("IbmRenteIniZ|fffd|ro").Value = Worksheets("CalcIBM").Range("IbmRenteZ|fffd|ro").Value
  
  Case 0
  
    TxTech = 4.5 / 100
    Worksheets("CalcIBM").Range("IbmAn4.5").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 3.5 / 100
    Worksheets("CalcIBM").Range("IbmAn3.5").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2.5 / 100
    Worksheets("CalcIBM").Range("IbmAn2.5").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2.25 / 100
    Worksheets("CalcIBM").Range("IbmAn2.25").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 2 / 100
    Worksheets("CalcIBM").Range("IbmAn2.0").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 1.25 / 100
    Worksheets("CalcIBM").Range("IbmAn1.25").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 0.5 / 100
    Worksheets("CalcIBM").Range("IbmAn0.5").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    TxTech = 0 / 100
    Worksheets("CalcIBM").Range("IbmAn0.0").Value = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)
    Worksheets("CalcIBM").Range("IbmRenteIniZ|fffd|ro").Value = Worksheets("CalcIBM").Range("IbmRenteZ|fffd|ro").Value
  
  End Select

End Function

' Ajout le 28/04/2014

Function CoefR|fffd|duc(TxTech As Double)
Dim Tx, Txrev As Double
Dim DateNaissX, DateNaissXBis As Date, DateCalcul As Date, Table1 As String, Table2 As String
Dim Fractionnement As String, Frac As Integer
Dim DateNaissY1, DateNaissY1Trim, DateNaissY1Bis As Date
Dim DateDebRente As Date, DateDebRenteBis As Double, DateTerme As Date
Dim TxCroissRte70_75 As Double, Terme As String, TxFraisRente As Double
Dim Approx As Integer, ApproxAge As String, AgeTerme As Double
Dim ProrataD|fffd|c|fffd|s As String, IdContrAssurance As String, DateFinGar As Date
Dim TxFraisDiff As Double, DateFinDiff As Date, AgeMinRev As Double
Dim AgeDebRente As Double
Dim ContrAssurance As String, Prorata As String, TxReval As Double, Sexe As String
Dim AgeX As Double, AgeY1 As Double, AgeY2 As Double, AgeFinGar As Double, AgeFinDiff As Double
Dim AnNaissX As Integer, AnNaissY1 As Integer
Dim a, b, c, d, e As Double


If Bar|fffd|me.Range("TxFraisRente").Value <> 1.35 / 100 Then
  Bar|fffd|me.Range("TxFraisRente").Value = 1.35 / 100
  MsgBox "Le taux de frais sur rente a |fffd|t|fffd| modifi|fffd| |fffd| 1,35 %", , "Information"
End If
If Bar|fffd|me.Range("TxFraisDiff").Value <> 0.05 / 100 Then
  Bar|fffd|me.Range("TxFraisDiff").Value = 0.05 / 100
  MsgBox "Le taux de frais pendant diff|fffd|r|fffd| a |fffd|t|fffd| modifi|fffd| |fffd| 0,05 %", , "Information"
End If
If Bar|fffd|me.Fractionnement.Value <> "Trimestriel" Then
  Bar|fffd|me.Fractionnement.Value = "Trimestriel"
  MsgBox "Le fractionnement a |fffd|t|fffd| modifi|fffd| en trimestriel", , "Information"
End If
If Bar|fffd|me.Terme.Value <> "Echu" Then
  Bar|fffd|me.Terme.Value = "Echu"
  MsgBox "Le terme a |fffd|t|fffd| modifi|fffd| en |fffd|chu", , "Information"
End If

        ApproxAge = Bar|fffd|me.Range("ApproxAge").Value
        Select Case ApproxAge
        Case "Age entier le + proche": Approx = 1
        Case "Semest. + proche": Approx = 2
        Case "Trim + proche": Approx = 4
        Case "Mois + proche": Approx = 12
        Case "Date exacte": Approx = 0
        Case "Age entier atteint": Approx = 10
        Case "Semest. atteint": Approx = 20
        Case "Trim atteint": Approx = 40
        Case "Mois atteint": Approx = 120
        End Select


        DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
        DateNaissY1 = Bar|fffd|me.Range("DateNaissY1").Value
        DateDebRente = Bar|fffd|me.Range("DateDebRente").Value
        AgeFinDiff = 65
        TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
        Txrev = Bar|fffd|me.Range("TxRev").Value
        Terme = Bar|fffd|me.Range("Terme").Value
        TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
        Tx = Bar|fffd|me.Range("TxTech").Value
        AgeDebRente = Bar|fffd|me.Range("AgeDebRente").Value
        AnNaissX = Year(DateNaissX)
        AnNaissY1 = Year(DateNaissY1)
        DateNaissXBis = ApproximAge(DateNaissX - 1, DateDebRente, Approx)
        DateNaissY1Bis = ApproximAge(DateNaissY1 - 1, DateDebRente, Approx)
        AgeX = nbann|fffd|es(DateNaissXBis, DateDebRente)
        AgeY1 = nbann|fffd|es(DateNaissY1Bis, DateDebRente)
        Table1 = Bar|fffd|me.Range("Table").Value
        Table2 = Table1
        Sexe = Bar|fffd|me.Range("Sexe").Value
        
        
        Select Case Table1
        Case "TGHF05"
        Select Case Sexe
        Case "H/F": Table1 = "TGH05"
                  Table2 = "TGF05"
        Case "F/H": Table1 = "TGF05"
                  Table2 = "TGH05"
        Case "H/H": Table1 = "TGH05"
                  Table2 = "TGH05"
        Case "F/F": Table1 = "TGF05"
                  Table2 = "TGF05"
        Case Else: MsgBox "Bug table"
        End Select
        Case "TPG+x/15.TGHF05"
        If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
        Select Case Sexe
        Case "H/F": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/H": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "H/H": Table1 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH050" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/F": Table1 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF050" & Bar|fffd|me.Range("NbAmmort").Value
        Case Else:  MsgBox "Bug table"
        End Select
        Else
        Select Case Sexe
        Case "H/F": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/H": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "H/H": Table1 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGH05" & Bar|fffd|me.Range("NbAmmort").Value
        Case "F/F": Table1 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
                    Table2 = "amTGF05" & Bar|fffd|me.Range("NbAmmort").Value
        Case Else:  MsgBox "Bug table"
        End Select
        End If
        
        Case "TV+x/7.TPG"
        If Bar|fffd|me.Range("NbAmmort").Value < 10 Then
        Table1 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
        Table2 = "amTV0" & Bar|fffd|me.Range("NbAmmort").Value
        Else
        Table1 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
        Table2 = "amTV" & Bar|fffd|me.Range("NbAmmort").Value
        End If
        End Select
        
        Select Case Terme
        Case "Echu":   ProrataD|fffd|c|fffd|s = Bar|fffd|me.Range("ProrataD|fffd|c|fffd|s").Value
                   Select Case ProrataD|fffd|c|fffd|s
                   Case "Sans": Prorata = "Sans"
                   Case "Proportionnel": Prorata = "Prop"
                   Case "Complet": Prorata = "COMP"
                   End Select
        Case "Avance": Prorata = "Sans"
        Case Else:     MsgBox "Terme inconnu : " & Terme
        End Select
        Fractionnement = Bar|fffd|me.Range("Fractionnement").Value
        Select Case Bar|fffd|me.Range("Fractionnement").Value
        Case "Mensuel": Frac = 12
        Case "Trimestriel": Frac = 4
        Case "Semestriel": Frac = 2
        Case "Annuel": Frac = 1
        Case Else
        MsgBox "Fractionnement inconnu : " & Fractionnement
        End Select
    
CoefR|fffd|duc = sannuit|fffd|1(AgeX, AgeDebRente, AnNaissX, Table1, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance) / sannuit|fffd|2(AgeX, AnNaissX, AgeY1, AnNaissY1, AgeDebRente, Table1, Table2, Txrev, AgeMinRev, TxReval, TxTech, TxTech, 8, Frac, Terme, TxFraisRente, AgeTerme, AgeFinGar, TxCroissRte70_75, TxFraisDiff, AgeFinDiff, Prorata, IdContrAssurance)

End Function
Function CoefMajo(TxTech As Double)

Dim Ax65, Ax70, Ax, dAx65 As Double
Dim AnneeNaissX, Sexe, TxFraisRente, AgeX, AnneeLiquid, TxFraisDiff, DateNaissX, DateDebRente As Double
Dim Table As String
Dim CoefMajo1, CoefMajo2 As Double
                               
DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
DateDebRente = Bar|fffd|me.Range("DateDebRente").Value
AgeX = nbann|fffd|es(FinTrim(DateNaissX - 1), DateDebRente)
AnneeNaissX = Bar|fffd|me.Range("Ann|fffd|eNaissX").Value
AnneeLiquid = Maxi(Bar|fffd|me.Range("AnneeLiquidProro").Value, Bar|fffd|me.Range("AnneeLiquidRente").Value)
Sexe = Bar|fffd|me.Range("SexeBis").Value
TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Table = "TPG05"

Ax65 = res(Table, 65, AnneeNaissX, Sexe, TxTech, 4) * (1 + TxFraisRente)
Ax70 = res(Table, 70, AnneeNaissX, Sexe, TxTech, 4) * (1 + TxFraisRente)
Ax = res(Table, AgeX, AnneeNaissX, Sexe, TxTech, 4) * (1 + TxFraisRente)
dAx65 = (1 + TxFraisRente) * res(Table, Mini(AgeX, 70), AnneeNaissX, Sexe, TxTech, 4) / (1 + TxTech) ^ (Mini(AgeX, 70) - 65) * P(Table, Mini(AgeX, 70) - 65, 65, AnneeNaissX, Sexe)

CoefMajo1 = Ax65 / (dAx65 + TxFraisDiff * (Ax65 - dAx65) * Maxi(Ax70, Ax))
CoefMajo2 = Maxi(1, Ax70 / Ax)

CoefMajo = CoefR|fffd|duc(TxTech) * CoefMajo1 * CoefMajo2

End Function
                                
Function CoefMino(TxTech As Double)

Dim CoefA As Double
Dim RVI, RVD_N As Double
Dim AnneeNaissX, Sexe, TxFraisRente, AgeX, TxFraisDiff, FracBis, AnneeLiquid As Double
Dim DateNaissX, DateDebRente As Date
Dim Table As String
Dim Terme As String
Dim Frac As String
Dim ApproxAge As String

DateNaissX = Bar|fffd|me.Range("DateNaissX").Value
DateDebRente = Bar|fffd|me.Range("DateDebRente").Value
AgeX = nbann|fffd|es(FinTrim(DateNaissX - 1), DateDebRente)
AnneeNaissX = Bar|fffd|me.Range("Ann|fffd|eNaissX").Value
AnneeLiquid = Maxi(Bar|fffd|me.Range("AnneeLiquidProro").Value, Bar|fffd|me.Range("AnneeLiquidRente").Value)
Sexe = Bar|fffd|me.Range("SexeBis").Value
TxFraisRente = Bar|fffd|me.Range("TxFraisRente").Value
TxFraisDiff = Bar|fffd|me.Range("TxFraisDiff").Value
Terme = Bar|fffd|me.Range("Terme").Value


Frac = Bar|fffd|me.Range("Fractionnement").Value
If Frac = "Trimestriel" Then
FracBis = 4
ElseIf Frac = "Mensuel" Then
FracBis = 12
ElseIf Frac = "Semestriel" Then
FracBis = 2
ElseIf Frac = "Annuel" Then
FracBis = 1
End If

If Sexe = 1 Then
Table = "TGH05"
ElseIf Sexe = 2 Then
Table = "TGF05"
End If

RVI = sannuit|fffd|1(AgeX, AgeX, AnneeNaissX, Table, 0, TxTech, TxTech, 8, FracBis, Terme, TxFraisRente, 0, 0, 0, 0, 65, 0, "Sans")
RVD_N = sannuit|fffd|1(AgeX, 65, AnneeNaissX, Table, 0, TxTech, TxTech, 8, FracBis, Terme, TxFraisRente, 0, 0, 0, TxFraisDiff, 65, 0, "Sans")
CoefA = RVD_N / RVI

CoefMino = CoefR|fffd|duc(TxTech) * CoefA


End Function

Private Sub IbmLiquidation_Click()
Dim D|fffd|finitive As Boolean
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
D|fffd|finitive = MsgBox("La liquiquidation est-elle faite |fffd| titre d|fffd|finitive ?", vbYesNo, "Question") = 6
With AppWord
  'Set docword = OuvreWord(NomCheminDocIBMBis, NomLettreLiquidIBM, appword)
  Set DocWord = AppWord.Documents.Open(NomCheminDocIBM & NomLettreLiquidIBM, ReadOnly:=True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
  With .Selection
    DocWord.bookmarks("DefProv").Select
    Select Case D|fffd|finitive
    Case True:  .TypeText Text:="" & "DEFINITIVE"
    Case False: .TypeText Text:="" & "PROVISOIRE"
    End Select
    DocWord.bookmarks("NomPr|fffd|nom").Select
    .TypeText Text:="" & Range("F6").Value & " " & Range("F7").Value & " " & Range("F8").Value
    DocWord.bookmarks("Adresse").Select
    .TypeText Text:="" & Range("B7").Value
    DocWord.bookmarks("CodePostal").Select
    .TypeText Text:="" & Range("B8").Value
    DocWord.bookmarks("Pays").Select
    .TypeText Text:="" & Range("B9").Value
    DocWord.bookmarks("DateLettre1").Select
    .TypeText Text:="" & ConvertiDateSemiTxt(Date)
    DocWord.bookmarks("NomGestionnaire").Select
    .TypeText Text:="" & Range("D5").Value
    DocWord.bookmarks("NumRente2").Select
    .TypeText Text:="" & Range("B10").Value
    DocWord.bookmarks("Titre").Select
    .TypeText Text:="" & Range("F6").Value
    DocWord.bookmarks("DateEffet").Select
    Select Case Bar|fffd|me.ModificationAge
    Case True: .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("Th|fffd|orie").Value)
    Case Else: .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("DateDebRente").Value)
    End Select
    DocWord.bookmarks("MoisPremierVersement").Select
    Select Case Bar|fffd|me.ModificationAge
    Case True: .TypeText Text:="" & LibMois(Month(FinTrim(Bar|fffd|me.Range("Th|fffd|orie").Value))) & " " & Year(Bar|fffd|me.Range("Th|fffd|orie").Value)
    Case Else: .TypeText Text:="" & LibMois(Month(FinTrim(Bar|fffd|me.Range("DateDebRente").Value))) & " " & Year(Bar|fffd|me.Range("DateDebRente").Value)
    End Select
    DocWord.bookmarks("RteSansTx").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRenteZ|fffd|ro").Value, "##,##0.00")
    DocWord.bookmarks("RteAvecTx").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRente").Value, "##,##0.00")
    DocWord.bookmarks("Titre3").Select
    .TypeText Text:="" & Range("F6").Value
    DocWord.bookmarks("NumRente").Select
    .TypeText Text:="" & Range("B10").Value
    DocWord.bookmarks("Titre2").Select
    .TypeText Text:="" & Range("F6").Value
    DocWord.bookmarks("Nom2").Select
    .TypeText Text:="" & Range("F7").Value
    DocWord.bookmarks("Pr|fffd|nom2").Select
    .TypeText Text:="" & Range("F8").Value
    DocWord.bookmarks("DateEffet2").Select
    Select Case Bar|fffd|me.ModificationAge
    Case True: .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("Th|fffd|orie").Value)
    Case Else: .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("DateDebRente").Value)
    End Select
    
    '-- Ajout IBM 2018
    Select Case Range("IbmLiquidML").Value
    Case "Sans", "Mention":
    DocWord.bookmarks("RteBrute").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRente").Value, "##,##0.00")
    DocWord.bookmarks("RenteAnPcp").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRente").Value, "##,##0.00")
    DocWord.bookmarks("RteAnML").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmMajoLeg").Value, "##,##0.00")
    DocWord.bookmarks("RteTrimBrute").Select
    .TypeText Text:="" & Format((wCalcIBM.Range("IbmRente").Value) / 4, "##,##0.00")
    
    'Supression PASRAU
    'DocWord.bookmarks("RteTrimNette").Select
    '.TypeText Text:="" & Format((wCalcIBM.Range("IbmRente").Value) / 4 * 0.899, "##,##0.00") 'a modifier si changement des PS

    
    Case "Ajout":
    DocWord.bookmarks("RteBrute").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRente").Value + wCalcIBM.Range("IbmMajoLeg").Value, "##,##0.00")
    DocWord.bookmarks("RenteAnPcp").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmRente").Value, "##,##0.00")
    DocWord.bookmarks("RteAnML").Select
    .TypeText Text:="" & Format(wCalcIBM.Range("IbmMajoLeg").Value, "##,##0.00")
    DocWord.bookmarks("RteTrimBrute").Select
    .TypeText Text:="" & Format((wCalcIBM.Range("IbmRente").Value + wCalcIBM.Range("IbmMajoLeg").Value) / 4, "##,##0.00")
    DocWord.bookmarks("RteTrimNette").Select
    .TypeText Text:="" & Format((wCalcIBM.Range("IbmRente").Value + wCalcIBM.Range("IbmMajoLeg").Value) / 4 * 0.899, "##,##0.00") 'a modifier si changement des PS
       End Select
    '----------
    
    DocWord.bookmarks("DatePremierPaiement").Select
    Select Case Bar|fffd|me.ModificationAge
    Case True:  .TypeText Text:="" & ConvertiDateSemiTxt(FinTrim(Bar|fffd|me.Range("Th|fffd|orie").Value))
    Case False: .TypeText Text:="" & ConvertiDateSemiTxt(FinTrim(Bar|fffd|me.Range("DateDebRente").Value))
    End Select
    DocWord.bookmarks("TxRev").Select
    .TypeText Text:="" & FormatPourcent(Bar|fffd|me.Range("TxRev").Value)
    DocWord.bookmarks("TitreR|fffd|v").Select
    .TypeText Text:="" & Range("G6").Value
    DocWord.bookmarks("NomR|fffd|v").Select
    .TypeText Text:="" & Range("G7").Value
    DocWord.bookmarks("Pr|fffd|nomR|fffd|v").Select
    .TypeText Text:="" & Range("G8").Value
    DocWord.bookmarks("n|fffd|").Select
    If Range("G6").Value <> "Monsieur" Then .TypeText Text:="" & "e"
    DocWord.bookmarks("DateNaissR|fffd|v").Select
    .TypeText Text:="" & ConvertiDateSemiTxt(Bar|fffd|me.Range("DateNaissY1").Value)
    DocWord.bookmarks("DateLettre2").Select
    .TypeText Text:="" & ConvertiDateSemiTxt(Date)
    If Not Bar|fffd|me.ExistR|fffd|version1 Then
      DocWord.bookmarks("R|fffd|v1").Select
      .TypeText Text:="" & "non "
      DocWord.Range(DocWord.bookmarks("R|fffd|v2").start, DocWord.bookmarks("R|fffd|v3").End).Select
      .Delete
      .TypeText Text:="" & "La rente n'est pas r|fffd|versible." & Chr(13) & Chr(13) & Chr(13) & Chr(13)
      DocWord.Range(DocWord.bookmarks("R|fffd|v4").start, DocWord.bookmarks("R|fffd|v5").End).Select
      .Delete
    End If
    DocWord.bookmarks("AnticipProrog").Select
    If Bar|fffd|me.ModificationAge Then
      If Bar|fffd|me.ExistR|fffd|version1 Then
        .TypeText Text:="" & ", r|fffd|versible et"
      Else
        .TypeText Text:="" & ","
      End If
      Select Case Bar|fffd|me.Range("ProrogAnticip")
      Case "Anticipation": .TypeText Text:="" & " avec anticipation,"
      Case "Prorogation":  .TypeText Text:="" & " avec prorogation,"
      Case Else: MsgBox "Cas non pr|fffd|vu", , "Avertissement"
      End Select
    Else
      If Bar|fffd|me.ExistR|fffd|version1 Then .TypeText Text:="" & ", r|fffd|versible"
    End If
    Select Case Range("IbmLiquidML").Value
    Case "Sans":    DocWord.Range(DocWord.bookmarks("ML1").start, DocWord.bookmarks("ML2").End).Select
                    .Delete
    Case "Mention": DocWord.Range(DocWord.bookmarks("ML1").start, DocWord.bookmarks("ML2").End).Select
                    .Delete
                    DocWord.bookmarks("MentionML").Select
                    .TypeText Text:="" & Chr(13) & "Votre rente peut b|fffd|n|fffd|ficier, sous certaines conditions, de majorations l|fffd|gales dont le versement est subordonn|fffd| |fffd| un plafond de ressources (voir annexe)."
    Case "Ajout":
    End Select
    DocWord.bookmarks("NomPr|fffd|nom").Select 'xxxx
  End With
End With
End Sub

Private Sub BouM|fffd|thodo_Click()
Dim DocWord As Object
Dim AppWord As Object
Set DocWord = CreateObject("Word.Document")
Set AppWord = CreateObject("Word.Application")
With AppWord
 ' Set docword = OuvreWord(NomCheminDocIBMBis, NomLettreM|fffd|thodo, appword)
  Set DocWord = AppWord.Documents.Open(NomCheminDocIBM & NomLettreM|fffd|thodo, ReadOnly:=True)
  AppWord.ShowMe
  AppWord.Visible = True
  AppWord.Application.WindowState = 1
End With
End Sub




 
Attribute VB_Name = "wCapDiff"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wD|fffd|tail"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
If MsgBox("Voulez-vous mettre |fffd| jour les donn|fffd|es en fonction de l'onglet Annuit|fffd| ?", vbYesNo, "Invitation") = vbYes Then
  Worksheets("D|fffd|tail").Cells(13, 2).Value = ""
  'AnNaissX
  Worksheets("D|fffd|tail").Cells(5, 2).Value = Year(Bar|fffd|me.Cells(6, 5).Value)
  'AnNaissY
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
    Worksheets("D|fffd|tail").Cells(6, 2).Value = Year(Bar|fffd|me.Cells(10, 5).Value)
  Else
    Worksheets("D|fffd|tail").Cells(6, 2).Value = ""
  End If
  'Sexe de l'assur|fffd|
  Worksheets("D|fffd|tail").Cells(7, 2).Value = Bar|fffd|me.Cells(5, 15).Value
  'AgeX |fffd| l'|fffd|valuation
  Worksheets("D|fffd|tail").Cells(8, 2).Value = nbann|fffd|es2(ApproximAge(Bar|fffd|me.Range("DateNaissX").Value, Bar|fffd|me.Range("DateCalcul").Value, 1), Bar|fffd|me.Range("DateCalcul").Value)
  'AgeY |fffd| l'|fffd|valuation
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
    Worksheets("D|fffd|tail").Cells(9, 2).Value = nbann|fffd|es2(ApproximAge(Bar|fffd|me.Range("DateNaissY1").Value, Bar|fffd|me.Range("DateCalcul").Value, 1), Bar|fffd|me.Range("DateCalcul").Value)
  Else
    Worksheets("D|fffd|tail").Cells(9, 2).Value = ""
  End If
  'AgeDebRente
  Worksheets("D|fffd|tail").Cells(10, 2).Value = nbann|fffd|es2(ApproximAge(Bar|fffd|me.Range("DateNaissX").Value, Bar|fffd|me.Range("DateDebRente").Value, 1), Bar|fffd|me.Range("DateDebRente").Value)
  'Table
  Select Case Bar|fffd|me.Range("Table").Value
  Case "TPG", "TV8890", "TV7377", "TGHF05": Worksheets("D|fffd|tail").Cells(11, 2).Value = Bar|fffd|me.Range("Table").Value
  Case "TPG+x/15.TGHF05": Worksheets("D|fffd|tail").Cells(11, 2).Value = "amTGHF05" & Si(Bar|fffd|me.Range("NbAmmort").Value < 10, "0", "") & Bar|fffd|me.Range("NbAmmort").Value
  Case "TV+x/15.TPG": Worksheets("D|fffd|tail").Cells(11, 2).Value = "amTV" & Si(Bar|fffd|me.Range("NbAmmort").Value < 10, "0", "") & Bar|fffd|me.Range("NbAmmort").Value
  End Select
  'TxTech
  Worksheets("D|fffd|tail").Cells(12, 2).Value = Bar|fffd|me.Range("TxTech").Value
  'TxRev
  If Bar|fffd|me.Range("ExistR|fffd|version1").Value = 1 Then
    Worksheets("D|fffd|tail").Cells(13, 2).Value = Bar|fffd|me.Cells(9, 5).Value
  Else
    Worksheets("D|fffd|tail").Cells(13, 2).Value = ""
  End If
  'TxTech
  Worksheets("D|fffd|tail").Cells(14, 2).Value = Bar|fffd|me.Cells(12, 11).Value
  'TxFraisRente
  Worksheets("D|fffd|tail").Cells(14, 2).Value = Bar|fffd|me.Cells(12, 11).Value
  'Fractionnement
  Select Case Bar|fffd|me.Cells(14, 11).Value
  Case "Annuel":      Worksheets("D|fffd|tail").Cells(15, 2).Value = 1
  Case "Semestriel":  Worksheets("D|fffd|tail").Cells(15, 2).Value = 2
  Case "Trimestriel": Worksheets("D|fffd|tail").Cells(15, 2).Value = 4
  Case "Mensuel":     Worksheets("D|fffd|tail").Cells(15, 2).Value = 12
  End Select
  'Terme
  Worksheets("D|fffd|tail").Cells(16, 2).Value = Bar|fffd|me.Cells(15, 11).Value
  'ProrataD|fffd|c|fffd|s
  Select Case Bar|fffd|me.Cells(16, 11).Value
  Case "Sans":          Worksheets("D|fffd|tail").Cells(17, 2).Value = "Sans"
  Case "Proportionnel": Worksheets("D|fffd|tail").Cells(17, 2).Value = "PROP"
  Case "Complet":       Worksheets("D|fffd|tail").Cells(17, 2).Value = "COMP"
  End Select
  'AgeTerme
  If ChoixRente = 3 Then
    Worksheets("D|fffd|tail").Cells(20, 2).Value = Bar|fffd|me.Range("AgeTerme").Value
  Else
    Worksheets("D|fffd|tail").Cells(20, 2).Value = ""
  End If
  'AgeFinGar
  If Bar|fffd|me.Range("ChkParticularit|fffd|").Value = 1 Then
    Worksheets("D|fffd|tail").Cells(23, 2).Value = Worksheets("D|fffd|tail").Cells(10, 2).Value + Bar|fffd|me.Range("NbAnGar").Value
  Else
    Worksheets("D|fffd|tail").Cells(23, 2).Value = ""
  End If
  'R|fffd|version avant liquidation
  Worksheets("D|fffd|tail").Cells(21, 2).Value = "Oui"
  'AgeMinRev1
  Worksheets("D|fffd|tail").Cells(22, 2).Value = ""
  'TxFraisDiff
  If ChoixRente = 2 Then
    Worksheets("D|fffd|tail").Cells(24, 2).Value = Bar|fffd|me.Cells(13, 11).Value
  Else
    Worksheets("D|fffd|tail").Cells(24, 2).Value = ""
  End If
  'TxCroiss7075
  If Bar|fffd|me.Range("ChkParticularit|fffd|").Value = 1 Then
    Worksheets("D|fffd|tail").Cells(25, 2).Value = Bar|fffd|me.Cells(21, 5).Value
  Else
    Worksheets("D|fffd|tail").Cells(25, 2).Value = ""
  End If
  'TxReval
  Worksheets("D|fffd|tail").Cells(26, 2).Value = 0
  'ContrAssurance
  Worksheets("D|fffd|tail").Cells(27, 2).Value = Bar|fffd|me.Cells(17, 11).Value
End If
End Sub
Attribute VB_Name = "wEntier"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouHelp2, 21, 0, MSForms, CommandButton"

Private Sub BouHelp2_Click()
Call BouHelpCalcul
End Sub
Attribute VB_Name = "wExact"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouHelp, 28, 0, MSForms, CommandButton"

Private Sub BouHelp_Click()
Call BouHelpCalcul
End Sub
Attribute VB_Name = "wFeuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wHop"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "HopQuit, 5, 0, MSForms, CommandButton"

Option Explicit

Private Sub HopQuit_Click()
Bar|fffd|me.Visible = True
Worksheets("MajoLeg").Visible = True
Bar|fffd|me.Select
Worksheets("H|fffd|p").Visible = False
Worksheets("H|fffd|pBis").Visible = False
End Sub

Private Sub Worksheet_Activate()
Call CalculerHopitaux
End Sub

Function CalculerHopitaux()
Dim Tx As Double
ActiveSheet.Unprotect
Tx = Bar|fffd|me.Range("TxTech").Value
'If Bar|fffd|me.Range("TxFraisRente").Value <> 2.4 / 100 Then
'  Bar|fffd|me.Range("TxFraisRente").Value = 2.4 / 100
'  MsgBox "Le taux de frais sur rente a |fffd|t|fffd| modifi|fffd| |fffd| 2,4 %", , "Information"
'End If
If Bar|fffd|me.Fractionnement.Value <> "Trimestriel" Then
  Bar|fffd|me.Fractionnement.Value = "Trimestriel"
  MsgBox "Le fractionnement a |fffd|t|fffd| modifi|fffd| en trimestriel", , "Information"
End If
If Bar|fffd|me.Terme.Value <> "Avance" Then
  Bar|fffd|me.Terme.Value = "Avance"
  MsgBox "Le terme a |fffd|t|fffd| modifi|fffd| en avance", , "Information"
End If
Select Case Bar|fffd|me.ModificationAge
Case True:  Bar|fffd|me.Range("TxTech").Value = 3.5 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP3.5").Value = Bar|fffd|me.Range("CoefA").Value
            Worksheets("H|fffd|p").Range("HopCoefProrog").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP1.75").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 2 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP2.0").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 2.25 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP2.25").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 2.5 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP2.5").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 3 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP3.0").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 1.25 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP1.25").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP0.75").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
            Worksheets("H|fffd|p").Range("HopCoefAP0.5").Value = Bar|fffd|me.Range("CoefA").Value
            Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 'maj 2018
            Worksheets("H|fffd|p").Range("HopCoefAP0.25").Value = Bar|fffd|me.Range("CoefA").Value 'maj 2018
Case False: Worksheets("H|fffd|p").Range("HopCoefAP3.5").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP1.75").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP2.0").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP2.25").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP2.5").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP3.0").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP1.25").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP0.75").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP0.5").Value = 1
            Worksheets("H|fffd|p").Range("HopCoefAP0.25").Value = 1 'maj 2018
            Worksheets("H|fffd|p").Range("HopCoefProrog").Value = 1
End Select
Select Case Bar|fffd|me.Range("ExistR|fffd|version1").Value
Case 0: Worksheets("H|fffd|p").Range("HopCoefRev0.25").Value = 1 'maj 2018
        Worksheets("H|fffd|p").Range("HopCoefRev0.5").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev0.75").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev1.25").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev3.5").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev1.75").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev2.0").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev2.25").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev2.5").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev3.0").Value = 1
        Worksheets("H|fffd|p").Range("HopCoefRev").Value = 1
        Select Case Bar|fffd|me.ModificationAge
        Case True
          Bar|fffd|me.Range("TxTech").Value = 2.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.25").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 2 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.0").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 2.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.5").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 3 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.0").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 3.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.5").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 1.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.25").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 'maj 2018
          Worksheets("H|fffd|p").Range("HopCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|Bis").Value 'maj 2018
        Case False
          Bar|fffd|me.Range("TxTech").Value = 2.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.25").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 2 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.0").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 2.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.5").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 3 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.0").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 3.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.5").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 1.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.25").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 'maj 2018
          Worksheets("H|fffd|p").Range("HopCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|").Value 'maj 2018
        End Select
Case 1: Select Case Bar|fffd|me.ModificationAge
        Case True
          Bar|fffd|me.Range("TxTech").Value = 2.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.25").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.25").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev1.75").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 2 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.0").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.0").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 2.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.5").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.5").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 3 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.0").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev3.0").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 3.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.5").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev3.5").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Worksheets("H|fffd|p").Range("HopCoefRev").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 1.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.25").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev1.25").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev0.75").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev0.5").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 'maj 2018
          Worksheets("H|fffd|p").Range("HopCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|BisRev").Value 'maj 2018
          Worksheets("H|fffd|p").Range("HopCoefRev0.25").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value 'maj 2018
        Case False
          Bar|fffd|me.Range("TxTech").Value = 2.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.25").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.25").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 1.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.75").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev1.75").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 2 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.0").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.0").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 2.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn2.5").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev2.5").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 3 / 100
          Worksheets("H|fffd|p").Range("HopCoefRev3.0").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Worksheets("H|fffd|p").Range("HopCoefAn3.0").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Bar|fffd|me.Range("TxTech").Value = 3.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn3.5").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev3.5").Value = Bar|fffd|me.Range("CoefR|fffd|ducBis").Value
          Worksheets("H|fffd|p").Range("HopCoefRev").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 1.25 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn1.25").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev1.25").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.75 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.75").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev0.75").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.5 / 100
          Worksheets("H|fffd|p").Range("HopCoefAn0.5").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value
          Worksheets("H|fffd|p").Range("HopCoefRev0.5").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value
          Bar|fffd|me.Range("TxTech").Value = 0.25 / 100 ' maj 2018
          Worksheets("H|fffd|p").Range("HopCoefAn0.25").Value = Bar|fffd|me.Range("Annuit|fffd|Rev").Value 'maj 2018
          Worksheets("H|fffd|p").Range("HopCoefRev0.25").Value = Bar|fffd|me.Range("CoefR|fffd|duc").Value 'maj 2018
          End Select
End Select
Bar|fffd|me.Range("TxTech").Value = Tx
ActiveSheet.Protect
End Function
Attribute VB_Name = "wLiquidIBM"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "IbmBar|fffd|me, 4, 0, MSForms, CommandButton"
Attribute VB_Control = "IbmCalculs, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "IbmInitialiser, 2, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 1, 3, MSForms, CommandButton"

Private Sub CommandButton1_Click()
ActiveSheet.PrintOut
End Sub

Private Sub IbmBar|fffd|me_Click()
Application.ScreenUpdating = False
Bar|fffd|me.Visible = True
Worksheets("MajoLeg").Visible = True
Bar|fffd|me.Select
Worksheets("CalcIBM").Visible = False
Worksheets("LiquidIBM").Visible = False
Application.ScreenUpdating = True
End Sub

Private Sub IbmCalculs_Click()
Application.ScreenUpdating = False
Worksheets("CalcIBM").Visible = True
Worksheets("CalcIBM").Select
Worksheets("LiquidIBM").Visible = False
Application.ScreenUpdating = True
End Sub

Private Sub IbmInitialiser_Click()
Rows("19:55").Select
Selection.Clear
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "wMajoLeg"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "wMenu"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouMenuBareme, 29, 1, MSForms, CommandButton"
Attribute VB_Control = "BouAncertaines, 28, 2, MSForms, CommandButton"
Attribute VB_Control = "BouMenuRetrS|fffd|lection, 25, 3, MSForms, CommandButton"
Attribute VB_Control = "BouTarif_C3R_PR84_PR86, 18, 4, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 17, 5, MSForms, CommandButton"
Attribute VB_Control = "BouMenuTempo, 15, 6, MSForms, CommandButton"
Attribute VB_Control = "BouMenuRSS, 13, 7, MSForms, CommandButton"
Attribute VB_Control = "BouMenuPR86, 12, 8, MSForms, CommandButton"
Attribute VB_Control = "BouMenuCERP, 11, 9, MSForms, CommandButton"
Attribute VB_Control = "BouMenuCERCA84, 10, 10, MSForms, CommandButton"
Attribute VB_Control = "BouMenuCA86, 9, 11, MSForms, CommandButton"
Attribute VB_Control = "BouMenuC3RPR84, 8, 12, MSForms, CommandButton"
Attribute VB_Control = "BouMenuArt83, 5, 13, MSForms, CommandButton"
Attribute VB_Control = "BouMenuArt39, 3, 14, MSForms, CommandButton"

Option Explicit

Private Sub BouAncertaines_Click()
wAncertaines.Visible = True
wAncertaines.Select
End Sub

Private Sub BouMenuArt39_Click()
Application.ScreenUpdating = False
wArt39.Visible = True
wArt39.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuArt83_Click()
Application.ScreenUpdating = False
wArt83.Visible = True
wArt83.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuBareme_Click()
Application.ScreenUpdating = False
wMajoLeg.Visible = True
Application.ScreenUpdating = True
Bar|fffd|me.Visible = True
Bar|fffd|me.Activate
Bar|fffd|me.TypeRente.Visible = True
Bar|fffd|me.TypeRente.Value = "RVI (rente viag|fffd|re imm|fffd|diate)"

Bar|fffd|me.TypeRente.Left = 736
Bar|fffd|me.TypeRente.Top = 119
Bar|fffd|me.TypeRente.Width = 150
Bar|fffd|me.TypeRente.Height = 42
Bar|fffd|me.TypeRente.FontSize = 10

wMenu.Visible = 2
End Sub

Private Sub BouMenuC3RPR84_Click()
Application.ScreenUpdating = False
wC3RPR84.Visible = True
wC3RPR84.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuCA86_Click()
Application.ScreenUpdating = False
wCA86.Visible = True
wCA86.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuCERCA84_Click()
Application.ScreenUpdating = False
wCERCA84.Visible = True
wCERCA84.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuCERP_Click()
Application.ScreenUpdating = False
wCERP.Visible = True
wCERP.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuPR86_Click()
Application.ScreenUpdating = False
wPr86.Visible = True
wPr86.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuRetrS|fffd|lection_Click()
Application.ScreenUpdating = False
wRetrSel.Visible = True
wRetrSel.Select
wMenu.Visible = 2
End Sub

Private Sub BouMenuRSS_Click()
Application.ScreenUpdating = False
wRSS.Visible = True
wRSS.Select
wMenu.Visible = 2
End Sub

Private Sub BouTarif_C3R_PR84_PR86_Click()
Dim a As Integer
MsgBox "Veillez au pr|fffd|alable |fffd| bien avoir s|fffd|lectionn|fffd| les bonnes hypoth|fffd|ses dans les masques de calcul des r|fffd|gimes concern|fffd|s : ann|fffd|e de liquidation, table de mortalit|fffd|, frais, ... ", , "WARNING"
wTarif.Visible = True
wPr86.Visible = True
wC3RPR84.Visible = True
wTarif.Select
wPr86.Range("Pr86AnEval").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value
wC3RPR84.Range("CRPRAnEval").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value
For a = 70 To 16 Step -1
  wTarif.Cells(74 - a, 1).Value = a
  wTarif.Cells(74 - a, 2).Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
Next a
'-- Calcul pour un |fffd|ge terme de 60 ans
wPr86.Range("Pr86AgeTerme").Value = 60
wC3RPR84.Range("CRPRAgeTerme").Value = 60
For a = 70 To 16 Step -1
  wC3RPR84.Range("CRPRAnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 3).Value = wC3RPR84.Range("CRPRRte").Value
  wC3RPR84.Range("CRPRAnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 7).Value = wC3RPR84.Range("CRPRCapDc").Value
  wPr86.Range("Pr86AnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 5).Value = wPr86.Range("Pr86Rte").Value
Next a
'-- Calcul pour un |fffd|ge terme de 65 ans
wPr86.Range("Pr86AgeTerme").Value = 65
wC3RPR84.Range("CRPRAgeTerme").Value = 65
For a = 70 To 16 Step -1
  wC3RPR84.Range("CRPRAnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 4).Value = wC3RPR84.Range("CRPRRte").Value
  wC3RPR84.Range("CRPRAnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 8).Value = wC3RPR84.Range("CRPRCapDc").Value
  wPr86.Range("Pr86AnNaissX").Value = wMenu.Range("AnTarifC3rPr84Pr86").Value - a
  wTarif.Cells(74 - a, 6).Value = wPr86.Range("Pr86Rte").Value
Next a
wPr86.Visible = False
wC3RPR84.Visible = False
End Sub
Attribute VB_Name = "wPr86"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouPr86Menu, 4, 0, MSForms, CommandButton"

Private Sub BouPr86Menu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wPr86.Visible = 2
End Sub
Attribute VB_Name = "wRSS"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouRSSMenu, 2, 0, MSForms, CommandButton"

Private Sub BouRSSMenu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wRSS.Visible = 2
End Sub
Attribute VB_Name = "wResumIBM"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "IbmInitialiser, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "IbmImprimEval, 1, 1, MSForms, CommandButton"

Option Explicit

Private Sub IbmImprimEval_Click()
Call IbmImprimEvaluation
End Sub

Private Sub IbmInitialiser_Click()
Rows("23:90").Select
Selection.Clear
End Sub
Attribute VB_Name = "wRetrSel"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouRetrSelMenu, 5, 0, MSForms, CommandButton"

Option Explicit

Private Sub BouRetrSelMenu_Click()
Application.ScreenUpdating = False
wMenu.Visible = True
wMenu.Select
wRetrSel.Visible = 2
End Sub
Attribute VB_Name = "wTGF05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "wTGH05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "wTPG"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "wTarif"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wTarif1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wTarif2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "wTxAgr"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "BouTxAgrMenu, 1, 0, MSForms, CommandButton"

Option Explicit

Private Sub BouTxAgrMenu_Click()
Application.ScreenUpdating = False
wArt83.Visible = True
wArt83.Select
wTxAgr.Visible = 2
End Sub

' InQuest injected base64 decoded content
' !yUO 	
' j{bz

INQUEST-PP=macro
