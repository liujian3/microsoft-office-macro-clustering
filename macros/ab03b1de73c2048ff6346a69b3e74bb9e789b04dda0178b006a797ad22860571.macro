Attribute VB_Name = "TProgressPercent"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private FnMax As Long
Private FnMin As Long
Private FnCur As Long
Private FsMess As String
Private FnPerc As Single
Private FnLen As Long
Property Get Current() As Long: Current = FnCur: End Property
Property Let Message(sStr As String):  FsMess = sStr: End Property
Property Let Min(nLng As Long)
  FnMin = nLng
  FnLen = FnMax - FnMax
  If (FnLen <= 0) Then FnLen = 1
End Property
Property Let Max(nLng As Long)
  FnMax = nLng
  FnLen = FnMax - FnMin
  If (FnLen <= 0) Then FnLen = 1
End Property
Private Sub Class_Initialize()
  FnMax = 0: FnMin = 0: FnCur = 0: FsMess = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|": FnPers = 0
End Sub
Private Sub Class_Terminate()
  Application.StatusBar = False
End Sub
Public Sub Show(nCurr As Long)
  FnPerc = nCurr / FnLen * 100
  Application.StatusBar = FsMess + "..." + Format$(FnPerc, "0") + "%" + " (|fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + Str(nCurr + 109) + ")"
  DoEvents
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "adm_RegODBC"
Private Function CreateSQLDSN(ByRef sDSNName As String, ByRef sDatabase As String, ByRef sServer As String, ByRef sDriver As String, ByRef sDescr As String) As Boolean
  CreateSQLDSN = False
  On Error GoTo Err_C
  Dim sTmp As String
  '// |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ...
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, "SoftWare\ODBC\ODBC.INI\ODBC Data Sources", sDSNName, "SQL Server", 1)
  '// |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ...
  sTmp = "SoftWare\ODBC\ODBC.INI\" + sDSNName
  Call RegistryCreateNewKey(rrkHKeyCurrentUser, sTmp)
  '// |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ...
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, sTmp, "Database", sDatabase, 1)
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, sTmp, "Description", sDescr, 1)
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, sTmp, "Driver", sDriver, 1)
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, sTmp, "LastUser", "", 1)
  Call RegistrySetKeyValue(rrkHKeyCurrentUser, sTmp, "Server", sServer, 1)
  CreateSQLDSN = True
Exi_C: Exit Function
Err_C:
  Call RegistryDeleteValue(rrkHKeyCurrentUser, "SoftWare\ODBC\ODBC.INI\ODBC Data sources", sDSNName)
  Call RegistryDeleteKey(rrkHKeyCurrentUser, "SoftWare\ODBC\ODBC.INI\" + sDSNName)
  Resume Exi_C
End Function
Public Function InitDSN() As Boolean
  InitDSN = False
  On Error GoTo Err_I
  Dim sDriver As String
  Dim sDatabase As String
  Dim sServer As String
  sDatabase = RegistryGetKeyValue(rrkHKeyCurrentUser, "SoftWare\ODBC\ODBC.INI\Svod2", "Database")
  sDriver = RegistryGetKeyValue(rrkHKeyLocalMachine, "SoftWare\ODBC\ODBCINST.INI\SQL Server", "Driver")
  If (Len(sDriver) <> 0) Then
    If (UCase$(Trim$(sDatabase)) <> "SVOD") Then
      If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| SQL |fffd||fffd||fffd||fffd||fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'! |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes Then
        sServer = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'", "|fffd||fffd||fffd| SQL |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        If Len(sServer) <> 0 Then
          '// |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ODBC-Source
          If CreateSQLDSN("ODBS_KredBase", "KredBase", sServer, sDriver, "KredRep") Then
            InitDSN = True
          Else
            MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ODBC-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 'KredBase' |fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|'", vbCritical
          End If
        End If
      End If
    Else
      InitDSN = True
    End If
  Else
    MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ODBC-|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| Microsoft SQL Server! |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| SQL!", vbCritical
  End If
Exi_I: Exit Function
Err_I: Resume Exi_I
End Function
Attribute VB_Name = "adm_Registry"

'Public Enum EnumRegistryRootKeys
Public Const rrkHKeyClassesRoot = &H80000000
Public Const rrkHKeyCurrentUser = &H80000001
Public Const rrkHKeyLocalMachine = &H80000002
Public Const rrkHKeyUsers = &H80000003
'End Enum

'Public Enum EnumRegistryValueType
Public Const rrkRegSZ = 1
Public Const rrkregbinary = 3
Public Const rrkRegDWord = 4
'End Enum


' Module      : modRegistry
' Description : This module Implements routines for manipulating the registry.
' Source      : Total VB SourceBook 6
'

Private Type FILETIME
  dwLowDateTime As Long
  dwHighDateTime As Long
End Type

Private Declare Function RegCloseKey _
  Lib "advapi32.dll" _
  (ByVal lngHKey As Long) _
  As Long

Private Declare Function RegCreateKeyEx _
  Lib "advapi32.dll" _
  Alias "RegCreateKeyExA" _
  (ByVal lngHKey As Long, _
    ByVal lpSubKey As String, _
    ByVal Reserved As Long, _
    ByVal lpClass As String, _
    ByVal dwOptions As Long, _
    ByVal samDesired As Long, _
    ByVal lpSecurityAttributes As Long, _
    phkResult As Long, _
    lpdwDisposition As Long) _
  As Long

Private Declare Function RegOpenKeyEx _
  Lib "advapi32.dll" _
  Alias "RegOpenKeyExA" _
  (ByVal lngHKey As Long, _
    ByVal lpSubKey As String, _
    ByVal ulOptions As Long, _
    ByVal samDesired As Long, _
    phkResult As Long) _
  As Long

Private Declare Function RegQueryValueExString _
  Lib "advapi32.dll" _
  Alias "RegQueryValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal lpReserved As Long, _
    lpType As Long, _
    ByVal lpData As String, _
    lpcbData As Long) _
  As Long

Private Declare Function RegQueryValueExLong _
  Lib "advapi32.dll" _
  Alias "RegQueryValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal lpReserved As Long, _
    lpType As Long, _
    lpData As Long, _
    lpcbData As Long) _
  As Long

Private Declare Function RegQueryValueExBinary _
  Lib "advapi32.dll" _
  Alias "RegQueryValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal lpReserved As Long, _
    lpType As Long, _
    ByVal lpData As Long, _
    lpcbData As Long) _
  As Long
  
Private Declare Function RegQueryValueExNULL _
  Lib "advapi32.dll" _
  Alias "RegQueryValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal lpReserved As Long, _
    lpType As Long, _
    ByVal lpData As Long, _
    lpcbData As Long) _
  As Long

Private Declare Function RegSetValueExString _
  Lib "advapi32.dll" _
  Alias "RegSetValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal Reserved As Long, _
    ByVal dwType As Long, _
    ByVal lpValue As String, _
    ByVal cbData As Long) _
  As Long

Private Declare Function RegSetValueExLong _
  Lib "advapi32.dll" _
  Alias "RegSetValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal Reserved As Long, _
    ByVal dwType As Long, _
    lpValue As Long, _
    ByVal cbData As Long) _
  As Long

Private Declare Function RegSetValueExBinary _
  Lib "advapi32.dll" _
  Alias "RegSetValueExA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String, _
    ByVal Reserved As Long, _
    ByVal dwType As Long, _
    ByVal lpValue As Long, _
    ByVal cbData As Long) _
  As Long
  
Private Declare Function RegEnumKey _
  Lib "advapi32.dll" _
  Alias "RegEnumKeyA" _
  (ByVal lngHKey As Long, _
    ByVal dwIndex As Long, _
    ByVal lpName As String, _
    ByVal cbName As Long) _
  As Long

Private Declare Function RegQueryInfoKey _
  Lib "advapi32.dll" _
  Alias "RegQueryInfoKeyA" _
  (ByVal lngHKey As Long, _
    ByVal lpClass As String, _
    ByVal lpcbClass As Long, _
    ByVal lpReserved As Long, _
    lpcSubKeys As Long, _
    lpcbMaxSubKeyLen As Long, _
    ByVal lpcbMaxClassLen As Long, _
    lpcValues As Long, _
    lpcbMaxValueNameLen As Long, _
    ByVal lpcbMaxValueLen As Long, _
    ByVal lpcbSecurityDescriptor As Long, _
    lpftLastWriteTime As FILETIME) _
  As Long

Private Declare Function RegEnumValue _
  Lib "advapi32.dll" _
  Alias "RegEnumValueA" _
  (ByVal lngHKey As Long, _
    ByVal dwIndex As Long, _
    ByVal lpValueName As String, _
    lpcbValueName As Long, _
    ByVal lpReserved As Long, _
    ByVal lpType As Long, _
    ByVal lpData As Byte, _
    ByVal lpcbData As Long) _
  As Long

Private Declare Function RegDeleteKey _
  Lib "advapi32.dll" _
  Alias "RegDeleteKeyA" _
  (ByVal lngHKey As Long, _
    ByVal lpSubKey As String) _
  As Long

Private Declare Function RegDeleteValue _
  Lib "advapi32.dll" _
  Alias "RegDeleteValueA" _
  (ByVal lngHKey As Long, _
    ByVal lpValueName As String) _
  As Long
 
 

Private Const mcregOptionNonVolatile = 0

Private Const mcregErrorNone = 0
Private Const mcregErrorBadDB = 1
Private Const mcregErrorBadKey = 2
Private Const mcregErrorCantOpen = 3
Private Const mcregErrorCantRead = 4
Private Const mcregErrorCantWrite = 5
Private Const mcregErrorOutOfMemory = 6
Private Const mcregErrorInvalidParameter = 7
Private Const mcregErrorAccessDenied = 8
Private Const mcregErrorInvalidParameterS = 87
Private Const mcregErrorNoMoreItems = 259

Private Const mcregKeyAllAccess = &H3F
Private Const mcregKeyQueryValue = &H1

Public Sub RegistryCreateNewKey( _
  eRootKey As Long, _
  strKeyName As String)
  ' Comments  : Creates a new key in the system registry
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key to create
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long
    
  On Error GoTo PROC_ERR
    
  ' Create the key
  lngRetVal = RegCreateKeyEx(eRootKey, strKeyName, 0&, vbNullString, _
    mcregOptionNonVolatile, mcregKeyAllAccess, 0&, lngHKey, 0&)
    
  ' if the key was created, then close it
  If lngRetVal = mcregErrorNone Then
    RegCloseKey (lngHKey)
  End If
    
PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryCreateNewKey"
  Resume PROC_EXIT
    
End Sub

Public Sub RegistryDeleteKey( _
  eRootKey As Long, _
  strKeyName As String)
  ' Comments  : Deletes a key from the system registry
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key to delete
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  
  On Error GoTo PROC_ERR
      
  ' Delete the key
  lngRetVal = RegDeleteKey(eRootKey, strKeyName)
    
PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryDeleteKey"
  Resume PROC_EXIT
    
End Sub

Public Sub RegistryDeleteValue( _
  eRootKey As Long, _
  strKeyName As String, _
  strValueName As String)
  ' Comments  : Deletes a value from the system registry
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key to delete
  '             strValueName - The name of the value to delete
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long

  On Error GoTo PROC_ERR

  ' Open the key
  lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyAllAccess, _
    lngHKey)

  ' If the key was opened successfully, then delete it
  If lngRetVal = mcregErrorNone Then
    lngRetVal = RegDeleteValue(lngHKey, strValueName)
  End If

PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryDeleteValue"
  Resume PROC_EXIT

End Sub

Public Sub RegistryEnumerateSubKeys( _
  eRootKey As Long, _
  strKeyName As String, _
  astrKeys() As String, _
  lngKeyCount As Long)
  ' Comments  : Enumerates the sub keys of the specified key
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key to enumerate
  '             astrKeys - An array of strings to fill with sub key names
  '             lngKeyCount - The number of sub keys returned in the parameter
  '             astrKeys
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long
  Dim lngKeyIndex As Long
  Dim strSubKeyName As String
  Dim lngSubkeyCount As Long
  Dim lngMaxKeyLen As Long
  Dim typFT As FILETIME
  
  On Error GoTo PROC_ERR
  
  ' Open the key
  lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyAllAccess, _
    lngHKey)
  
  If lngRetVal = mcregErrorNone Then
    'find the number of subkeys, and redim the return string array
    lngRetVal = RegQueryInfoKey(lngHKey, vbNullString, 0, 0, lngSubkeyCount, _
      lngMaxKeyLen, 0, 0, 0, 0, 0, typFT)
    If mcregErrorNone = lngRetVal Then
      If lngSubkeyCount > 0 Then
        ReDim astrKeys(lngSubkeyCount - 1) As String
        
        'set up the while loop
        lngKeyIndex = 0
        ' Pad the string to the maximum length of a sub key, plus 1 for null
        ' termination
        lngMaxKeyLen = lngMaxKeyLen + 1
        strSubKeyName = Space$(lngMaxKeyLen)
        
        Do While RegEnumKey(lngHKey, lngKeyIndex, strSubKeyName, lngMaxKeyLen + 1) = 0
        
          ' Set the string array to the key name, removing null termination
          If InStr(1, strSubKeyName, vbNullChar) > 0 Then
            astrKeys(lngKeyIndex) = Left$(strSubKeyName, InStr(1, strSubKeyName, _
              vbNullChar) - 1)
          End If
          ' Increment the key index for the return string array
          lngKeyIndex = lngKeyIndex + 1
        
        Loop
      End If
      ' return the new dimension of the return string array
      lngKeyCount = lngSubkeyCount
    End If
    
    ' Close the key
    RegCloseKey (lngHKey)
  End If
  
PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryEnumerateSubKeys"
  Resume PROC_EXIT

End Sub

Public Sub RegistryEnumerateValues( _
  eRootKey As Long, _
  strKeyName As String, _
  astrValues() As String, _
  lngValueCount As Long)
  ' Comments  : Enumerates the values of the specified key
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key to enumerate
  '             astrValues - An array of strings to fill with value names
  '             lngValueCount - The number of values returned in the parameter
  '             astrValues
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long
  Dim lngKeyIndex As Long
  Dim strValueName As String
  Dim lngTempValueCount As Long
  Dim lngMaxValueLen As Long
  Dim typFT As FILETIME
  
  On Error GoTo PROC_ERR
  
  ' Open the key
  lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0, mcregKeyAllAccess, _
    lngHKey)
  
  If lngRetVal = mcregErrorNone Then
    'find the number of subkeys, and redim the return string array
    lngRetVal = RegQueryInfoKey(lngHKey, vbNullString, 0, 0, 0, _
      0, 0, lngTempValueCount, lngMaxValueLen, 0, 0, typFT)
    If mcregErrorNone = lngRetVal Then
      If lngTempValueCount > 0 Then
        ReDim astrValues(lngTempValueCount - 1) As String
        
        'set up the while loop
        lngKeyIndex = 0
        ' Pad the string to the maximum length of a sub key, plus 1 for null
        ' termination
        lngMaxValueLen = lngMaxValueLen + 1
        strValueName = Space$(lngMaxValueLen)
        
        Do While RegEnumValue(lngHKey, lngKeyIndex, strValueName, _
          lngMaxValueLen + 1, 0, 0, 0, 0) = 0
        
          ' Set the string array to the key name, removing null termination
          If InStr(1, strValueName, vbNullChar) > 0 Then
            astrValues(lngKeyIndex) = Left$(strValueName, InStr(1, strValueName, _
              vbNullChar) - 1)
          End If
          ' Increment the key index for the return string array
          lngKeyIndex = lngKeyIndex + 1
        
        Loop
      End If
      ' return the new dimension of the return string array
      lngValueCount = lngTempValueCount
    End If
    
    ' Close the key
    RegCloseKey (lngHKey)
  End If
  
PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryEnumerateValues"
  Resume PROC_EXIT

End Sub

Public Function RegistryGetKeyValue( _
  eRootKey As Long, _
  strKeyName As String, _
  strValueName As String) _
  As Variant
  ' Comments  : Returns a value from the system registry
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key
  '             strValueName - The name of the value
  ' Returns   : The data in the registry value
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long
  Dim varValue As Variant
  Dim strValueData As String
  Dim abytValueData() As Byte
  Dim lngValueData As Long
  Dim lngValueType As Long
  Dim lngDataSize As Long
  
  On Error GoTo PROC_ERR
  
  varValue = Empty
  
  lngRetVal = RegOpenKeyEx(eRootKey, strKeyName, 0&, mcregKeyQueryValue, _
    lngHKey)
  
  If mcregErrorNone = lngRetVal Then
    
    lngRetVal = RegQueryValueExNULL(lngHKey, strValueName, 0&, lngValueType, _
      0&, lngDataSize)
    
    If lngRetVal = mcregErrorNone Then
      
      Select Case lngValueType
      
      ' String type

        Case rrkRegSZ:
          If lngDataSize > 0 Then
            strValueData = String(lngDataSize, 0)
            lngRetVal = RegQueryValueExString(lngHKey, strValueName, 0&, _
              lngValueType, strValueData, lngDataSize)
            If InStr(strValueData, vbNullChar) > 0 Then
              strValueData = Mid$(strValueData, 1, InStr(strValueData, _
                vbNullChar) - 1)
            End If
          End If
          If mcregErrorNone = lngRetVal Then
            varValue = Left$(strValueData, lngDataSize)
          Else
            varValue = Empty
          End If
        
        ' Long type
        Case rrkRegDWord:
          lngRetVal = RegQueryValueExLong(lngHKey, strValueName, 0&, _
            lngValueType, lngValueData, lngDataSize)
          If mcregErrorNone = lngRetVal Then
            varValue = lngValueData
          End If
                
        ' Binary type
        Case rrkregbinary
          If lngDataSize > 0 Then
            ReDim abytValueData(lngDataSize) As Byte
            lngRetVal = RegQueryValueExBinary(lngHKey, strValueName, 0&, _
              lngValueType, VarPtr(abytValueData(0)), lngDataSize)
          End If
          If mcregErrorNone = lngRetVal Then
            varValue = abytValueData
          Else
            varValue = Empty
          End If
                
        Case Else
          'No other data types supported
          lngRetVal = -1
        
      End Select
      
    End If
    
    RegCloseKey (lngHKey)
  End If
  
  'Return varValue
  RegistryGetKeyValue = varValue
PROC_EXIT:
  Exit Function

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistryGetKeyValue"
  Resume PROC_EXIT
End Function

Public Sub RegistrySetKeyValue( _
  eRootKey As Long, _
  strKeyName As String, _
  strValueName As String, _
  varData As Variant, _
  eDataType As Long)
  ' Comments  : This procedure sets a key value
  ' Parameters: eRootKey - The root key
  '             strKeyName - The name of the key
  '             strValueName - The name of the value
  '             varData - The data to store in the value
  '             eDataType - The type of data to store in the value
  ' Returns   : Nothing
  ' Source    : Total VB SourceBook 6
  '
  Dim lngRetVal As Long
  Dim lngHKey As Long
  Dim strData As String
  Dim lngData As Long
  Dim abytData() As Byte
    
  On Error GoTo PROC_ERR
  
  ' Open the specified key, if it does not exist then create it
  lngRetVal = RegCreateKeyEx(eRootKey, strKeyName, 0&, vbNullString, _
    mcregOptionNonVolatile, mcregKeyAllAccess, 0&, lngHKey, 0&)
  
  ' Determine the data type of the key
  Select Case eDataType
  
  Case rrkRegSZ
    strData = varData & vbNullChar
    lngRetVal = RegSetValueExString(lngHKey, strValueName, 0&, eDataType, _
      strData, Len(strData))
    
  Case rrkRegDWord
    lngData = varData
    lngRetVal = RegSetValueExLong(lngHKey, strValueName, 0&, eDataType, _
      lngData, Len(lngData))
  
  ' Binary type
  Case rrkregbinary
    abytData = varData
    lngRetVal = RegSetValueExBinary(lngHKey, strValueName, 0&, eDataType, _
      VarPtr(abytData(0)), UBound(abytData) + 1)
  
  End Select
  
  RegCloseKey (lngHKey)
    
PROC_EXIT:
  Exit Sub

PROC_ERR:
  MsgBox "Error: " & Err.Number & ". " & Err.Description, , _
    "RegistrySetKeyValue"
  Resume PROC_EXIT
    
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd|"
Sub ForSO()
Const LastColumn  As Long = 40
Const FirstRowData As Long = 110
Const LastVisibleString As Long = 15000

Dim LastRowData As Long
Dim AlSz, AlSzSr, AlSzProsr As Double
Dim AlSzRUR, AlSzSrRUR, AlSzProsrRUR As Double
Dim KursUSD, KursEUR As Double
Dim AlSzUSD, AlSzSrUSD, AlSzProsrUSD As Double
Dim AlSzEUR, AlSzSrEUR, AlSzProsrEUR As Double
Dim AlSzVAL, AlSzSrVAL, AlSzProsrVAL As Double
Dim I_katOstSz, I_katFactRez, I_katRascRez As Double
Dim II_katOstSz, II_katFactRez, II_katRascRez As Double
Dim III_katOstSz, III_katFactRez, III_katRascRez As Double
Dim IV_katOstSz, IV_katFactRez, IV_katRascRez As Double
Dim V_katOstSz, V_katFactRez, V_katRascRez As Double
Dim MB_OstSz, MB_FactRez As Double
Dim MB1_OstSz, MB1_FactRez As Double
Dim MB2_OstSz, MB2_FactRez As Double
Dim MB3_OstSz, MB3_FactRez As Double
Dim MB4_OstSz, MB4_FactRez As Double
Dim MB5_OstSz, MB5_FactRez As Double
Dim MB6_OstSz, MB6_FactRez As Double
Dim OV_OstSz, OV_FactRez As Double
Dim OV1_OstSz, OV1_FactRez As Double
Dim OV2_OstSz, OV2_FactRez As Double
Dim OV3_OstSz, OV3_FactRez As Double
Dim ZMB_OstSz, ZMB_FactRez As Double
Dim ZOV_OstSz, ZOV_FactRez As Double
Dim ProlongOstSz As Double
Dim ProsrProc, ProsrProcRUR, ProsrProcUSD, ProsrProcEUR, ProsrProcVAL As Double
Dim PBOUL_OstSzRUR, PBOUL1221_OstSzRUR, PBOUL_OstProsrRUR, PBOUL1221_OstProsrRUR As Double
Dim SMP_OstSzRUR, SMP1221_OstSzRUR, SMP_OstProsrRUR, SMP1221_OstProsrRUR As Double
Dim OKOS_OstSzRUR, OKOS_OstProsrRUR As Double
Dim OKOS_OstSzUSD, OKOS_OstProsrUSD As Double
Dim OKOS_OstSzEUR, OKOS_OstProsrEUR As Double
Dim OKOS_OstSzVAL, OKOS_OstProsrVAL As Double
Dim VTS_OstSzRUR As Double
Dim VTS_OstSzUSD As Double
Dim VTS_OstSzEUR As Double
Dim VTS_OstSzVAL As Double
Dim INVEST_OstSzRUR As Double
Dim INVEST_OstSzUSD As Double
Dim INVEST_OstSzEUR As Double
Dim INVEST_OstSzVAL As Double
Dim STROIKA_OstSzRUR As Double
Dim STROIKA_OstSzUSD As Double
Dim STROIKA_OstSzEUR As Double
Dim STROIKA_OstSzVAL As Double
Dim OPK_OstSzRUR, OPK_OstProsrRUR As Double
Dim OPK_OstSzUSD, OPK_OstProsrUSD As Double
Dim OPK_OstSzEUR, OPK_OstProsrEUR As Double
Dim OPK_OstSzVAL, OPK_OstProsrVAL As Double
Dim EIO_OstSzRUR, EIO_OstProsrRUR As Double
Dim EIO_OstSzUSD, EIO_OstProsrUSD As Double
Dim EIO_OstSzEUR, EIO_OstProsrEUR As Double
Dim EIO_OstSzVAL, EIO_OstProsrVAL As Double
Dim j, i As Long

On Error GoTo Err_F
 
With ThisWorkbook

 With .Sheets("Svod2")
  .Activate
  For j = 4 To 83
   Cells(j, 2).ClearContents
  Next
 End With

 With .Sheets("|fffd||fffd||fffd||fffd||fffd|")
  .Activate
    If (IsError(Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(.Cells(1, 1), .Cells(LastVisibleString, 1)), 0))) Then Err.Raise vbError + 1, , "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)"
     LastRowData = Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), .Cells(LastVisibleString, 1)), 0) - 1
 End With
 
 KursUSD = .Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("h105")
 KursEUR = .Sheets("|fffd||fffd||fffd||fffd||fffd|").Range("h106")
 
 For i = FirstRowData To LastRowData
  
   Select Case Cells(i, 15)
    Case "810"
     AlSzRUR = AlSzRUR + Cells(i, 23)
     AlSzSrRUR = AlSzSrRUR + (Cells(i, 23) - Cells(i, 24))
     AlSzProsrRUR = AlSzProsrRUR + Cells(i, 24)
    Case "840"
     AlSzUSD = AlSzUSD + (Cells(i, 23) * KursUSD)
     AlSzSrUSD = AlSzSrUSD + ((Cells(i, 23) - Cells(i, 24)) * KursUSD)
     AlSzProsrUSD = AlSzProsrUSD + (Cells(i, 24) * KursUSD)
    Case "978"
     AlSzEUR = AlSzEUR + (Cells(i, 23) * KursEUR)
     AlSzSrEUR = AlSzSrEUR + ((Cells(i, 23) - Cells(i, 24)) * KursEUR)
     AlSzProsrEUR = AlSzProsrEUR + (Cells(i, 24) * KursEUR)
    Case Else
     MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & i & ", |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|!"
   End Select
  
  AlSz = AlSzRUR + AlSzUSD + AlSzEUR
  AlSzSr = AlSzSrRUR + AlSzSrUSD + AlSzSrEUR
  AlSzProsr = AlSzProsrRUR + AlSzProsrUSD + AlSzProsrEUR
  AlSzVAL = AlSzUSD + AlSzEUR
  AlSzSrVAL = AlSzSrUSD + AlSzSrEUR
  AlSzProsrVAL = AlSzProsrUSD + AlSzProsrEUR
   
   Select Case Cells(i, 30)
    Case "1"
     If Cells(i, 15) = "810" Then
      I_katOstSzRUR = I_katOstSzRUR + Cells(i, 23)
      I_katFactRezRUR = I_katFactRezRUR + Cells(i, 35)
      I_katRascRezRUR = I_katRascRezRUR + (Cells(i, 23) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "840" Then
      I_katOstSzUSD = I_katOstSzUSD + (Cells(i, 23) * KursUSD)
      I_katFactRezUSD = I_katFactRezUSD + Cells(i, 35)
      I_katRascRezUSD = I_katRascRezUSD + ((Cells(i, 23) * KursUSD) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "978" Then
      I_katOstSzEUR = I_katOstSzEUR + (Cells(i, 23) * KursEUR)
      I_katFactRezEUR = I_katFactRezEUR + Cells(i, 35)
      I_katRascRezEUR = I_katRascRezEUR + ((Cells(i, 23) * KursEUR) * (Cells(i, 34) / 100))
     End If
    Case "2"
     If Cells(i, 15) = "810" Then
      II_katOstSzRUR = II_katOstSzRUR + Cells(i, 23)
      II_katFactRezRUR = II_katFactRezRUR + Cells(i, 35)
      II_katRascRezRUR = II_katRascRezRUR + (Cells(i, 23) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "840" Then
      II_katOstSzUSD = II_katOstSzUSD + (Cells(i, 23) * KursUSD)
      II_katFactRezUSD = II_katFactRezUSD + Cells(i, 35)
      II_katRascRezUSD = II_katRascRezUSD + ((Cells(i, 23) * KursUSD) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "978" Then
      II_katOstSzEUR = II_katOstSzEUR + (Cells(i, 23) * KursEUR)
      II_katFactRezEUR = II_katFactRezEUR + Cells(i, 35)
      II_katRascRezEUR = II_katRascRezEUR + ((Cells(i, 23) * KursEUR) * (Cells(i, 34) / 100))
     End If
    Case "3"
     If Cells(i, 15) = "810" Then
      III_katOstSzRUR = III_katOstSzRUR + Cells(i, 23)
      III_katFactRezRUR = III_katFactRezRUR + Cells(i, 35)
      III_katRascRezRUR = III_katRascRezRUR + (Cells(i, 23) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "840" Then
      III_katOstSzUSD = III_katOstSzUSD + (Cells(i, 23) * KursUSD)
      III_katFactRezUSD = III_katFactRezUSD + Cells(i, 35)
      III_katRascRezUSD = III_katRascRezUSD + ((Cells(i, 23) * KursUSD) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "978" Then
      III_katOstSzEUR = III_katOstSzEUR + (Cells(i, 23) * KursEUR)
      III_katFactRezEUR = III_katFactRezEUR + Cells(i, 35)
      III_katRascRezEUR = III_katRascRezEUR + ((Cells(i, 23) * KursEUR) * (Cells(i, 34) / 100))
     End If
    Case "4"
     If Cells(i, 15) = "810" Then
      IV_katOstSzRUR = IV_katOstSzRUR + Cells(i, 23)
      IV_katFactRezRUR = IV_katFactRezRUR + Cells(i, 35)
      IV_katRascRezRUR = IV_katRascRezRUR + (Cells(i, 23) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "840" Then
      IV_katOstSzUSD = IV_katOstSzUSD + (Cells(i, 23) * KursUSD)
      IV_katFactRezUSD = IV_katFactRezUSD + Cells(i, 35)
      IV_katRascRezUSD = IV_katRascRezUSD + ((Cells(i, 23) * KursUSD) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "978" Then
      IV_katOstSzEUR = IV_katOstSzEUR + (Cells(i, 23) * KursEUR)
      IV_katFactRezEUR = IV_katFactRezEUR + Cells(i, 35)
      IV_katRascRezEUR = IV_katRascRezEUR + ((Cells(i, 23) * KursEUR) * (Cells(i, 34) / 100))
     End If
    Case "5"
     If Cells(i, 15) = "810" Then
      V_katOstSzRUR = V_katOstSzRUR + Cells(i, 23)
      V_katFactRezRUR = V_katFactRezRUR + Cells(i, 35)
      V_katRascRezRUR = V_katRascRezRUR + (Cells(i, 23) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "840" Then
      V_katOstSzUSD = V_katOstSzUSD + (Cells(i, 23) * KursUSD)
      V_katFactRezUSD = V_katFactRezUSD + Cells(i, 35)
      V_katRascRezUSD = V_katRascRezUSD + ((Cells(i, 23) * KursUSD) * (Cells(i, 34) / 100))
     ElseIf Cells(i, 15) = "978" Then
      V_katOstSzEUR = V_katOstSzEUR + (Cells(i, 23) * KursEUR)
      V_katFactRezEUR = V_katFactRezEUR + Cells(i, 35)
      V_katRascRezEUR = V_katRascRezEUR + ((Cells(i, 23) * KursEUR) * (Cells(i, 34) / 100))
     End If
   End Select
   
      I_katOstSz = I_katOstSzRUR + I_katOstSzUSD + I_katOstSzEUR
      I_katFactRez = I_katFactRezRUR + I_katFactRezUSD + I_katFactRezEUR
      I_katRascRez = I_katRascRezRUR + I_katRascRezUSD + I_katRascRezEUR
      
      II_katOstSz = II_katOstSzRUR + II_katOstSzUSD + II_katOstSzEUR
      II_katFactRez = II_katFactRezRUR + II_katFactRezUSD + II_katFactRezEUR
      II_katRascRez = II_katRascRezRUR + II_katRascRezUSD + II_katRascRezEUR
      
      III_katOstSz = III_katOstSzRUR + III_katOstSzUSD + III_katOstSzEUR
      III_katFactRez = III_katFactRezRUR + III_katFactRezUSD + III_katFactRezEUR
      III_katRascRez = III_katRascRezRUR + III_katRascRezUSD + III_katRascRezEUR
      
      IV_katOstSz = IV_katOstSzRUR + IV_katOstSzUSD + IV_katOstSzEUR
      IV_katFactRez = IV_katFactRezRUR + IV_katFactRezUSD + IV_katFactRezEUR
      IV_katRascRez = IV_katRascRezRUR + IV_katRascRezUSD + IV_katRascRezEUR
      
      V_katOstSz = V_katOstSzRUR + V_katOstSzUSD + V_katOstSzEUR
      V_katFactRez = V_katFactRezRUR + V_katFactRezUSD + V_katFactRezEUR
      V_katRascRez = V_katRascRezRUR + V_katRascRezUSD + V_katRascRezEUR
      
   Select Case Cells(i, 33)
    Case "MB"
     If Cells(i, 15) = "810" Then
      MB_OstSzRUR = MB_OstSzRUR + Cells(i, 23)
      MB_FactRezRUR = MB_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB_OstSzUSD = MB_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB_FactRezUSD = MB_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB_OstSzEUR = MB_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB_FactRezEUR = MB_FactRezEUR + Cells(i, 35)
     End If
    Case "MB1"
     If Cells(i, 15) = "810" Then
      MB1_OstSzRUR = MB1_OstSzRUR + Cells(i, 23)
      MB1_FactRezRUR = MB1_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB1_OstSzUSD = MB1_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB1_FactRezUSD = MB1_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB1_OstSzEUR = MB1_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB1_FactRezEUR = MB1_FactRezEUR + Cells(i, 35)
     End If
    Case "MB2"
     If Cells(i, 15) = "810" Then
      MB2_OstSzRUR = MB2_OstSzRUR + Cells(i, 23)
      MB2_FactRezRUR = MB2_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB2_OstSzUSD = MB2_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB2_FactRezUSD = MB2_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB2_OstSzEUR = MB2_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB2_FactRezEUR = MB2_FactRezEUR + Cells(i, 35)
     End If
    Case "MB3"
     If Cells(i, 15) = "810" Then
      MB3_OstSzRUR = MB3_OstSzRUR + Cells(i, 23)
      MB3_FactRezRUR = MB3_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB3_OstSzUSD = MB3_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB3_FactRezUSD = MB3_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB3_OstSzEUR = MB3_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB3_FactRezEUR = MB3_FactRezEUR + Cells(i, 35)
     End If
    Case "MB4"
     If Cells(i, 15) = "810" Then
      MB4_OstSzRUR = MB4_OstSzRUR + Cells(i, 23)
      MB4_FactRezRUR = MB4_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB4_OstSzUSD = MB4_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB4_FactRezUSD = MB4_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB4_OstSzEUR = MB4_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB4_FactRezEUR = MB4_FactRezEUR + Cells(i, 35)
     End If
    Case "MB5"
     If Cells(i, 15) = "810" Then
      MB5_OstSzRUR = MB5_OstSzRUR + Cells(i, 23)
      MB5_FactRezRUR = MB5_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB5_OstSzUSD = MB5_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB5_FactRezUSD = MB5_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB5_OstSzEUR = MB5_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB5_FactRezEUR = MB5_FactRezEUR + Cells(i, 35)
     End If
    Case "MB6"
     If Cells(i, 15) = "810" Then
      MB6_OstSzRUR = MB6_OstSzRUR + Cells(i, 23)
      MB6_FactRezRUR = MB6_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      MB6_OstSzUSD = MB6_OstSzUSD + (Cells(i, 23) * KursUSD)
      MB6_FactRezUSD = MB6_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      MB6_OstSzEUR = MB6_OstSzEUR + (Cells(i, 23) * KursEUR)
      MB6_FactRezEUR = MB6_FactRezEUR + Cells(i, 35)
     End If
    Case "OV"
     If Cells(i, 15) = "810" Then
      OV_OstSzRUR = OV_OstSzRUR + Cells(i, 23)
      OV_FactRezRUR = OV_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      OV_OstSzUSD = OV_OstSzUSD + (Cells(i, 23) * KursUSD)
      OV_FactRezUSD = OV_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      OV_OstSzEUR = OV_OstSzEUR + (Cells(i, 23) * KursEUR)
      OV_FactRezEUR = OV_FactRezEUR + Cells(i, 35)
     End If
    Case "OV1"
     If Cells(i, 15) = "810" Then
      OV1_OstSzRUR = OV1_OstSzRUR + Cells(i, 23)
      OV1_FactRezRUR = OV1_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      OV1_OstSzUSD = OV1_OstSzUSD + (Cells(i, 23) * KursUSD)
      OV1_FactRezUSD = OV1_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      OV1_OstSzEUR = OV1_OstSzEUR + (Cells(i, 23) * KursEUR)
      OV1_FactRezEUR = OV1_FactRezEUR + Cells(i, 35)
     End If
    Case "OV2"
     If Cells(i, 15) = "810" Then
      OV2_OstSzRUR = OV2_OstSzRUR + Cells(i, 23)
      OV2_FactRezRUR = OV2_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      OV2_OstSzUSD = OV2_OstSzUSD + (Cells(i, 23) * KursUSD)
      OV2_FactRezUSD = OV2_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      OV2_OstSzEUR = OV2_OstSzEUR + (Cells(i, 23) * KursEUR)
      OV2_FactRezEUR = OV2_FactRezEUR + Cells(i, 35)
     End If
    Case "OV3"
     If Cells(i, 15) = "810" Then
      OV3_OstSzRUR = OV3_OstSzRUR + Cells(i, 23)
      OV3_FactRezRUR = OV3_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      OV3_OstSzUSD = OV3_OstSzUSD + (Cells(i, 23) * KursUSD)
      OV3_FactRezUSD = OV3_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      OV3_OstSzEUR = OV3_OstSzEUR + (Cells(i, 23) * KursEUR)
      OV3_FactRezEUR = OV3_FactRezEUR + Cells(i, 35)
     End If
    Case "ZMB"
     If Cells(i, 15) = "810" Then
      ZMB_OstSzRUR = ZMB_OstSzRUR + Cells(i, 23)
      ZMB_FactRezRUR = ZMB_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      ZMB_OstSzUSD = ZMB_OstSzUSD + (Cells(i, 23) * KursUSD)
      ZMB_FactRezUSD = ZMB_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      ZMB_OstSzEUR = ZMB_OstSzEUR + (Cells(i, 23) * KursEUR)
      ZMB_FactRezEUR = ZMB_FactRezEUR + Cells(i, 35)
     End If
    Case "ZOV"
     If Cells(i, 15) = "810" Then
      ZOV_OstSzRUR = ZOV_OstSzRUR + Cells(i, 23)
      ZOV_FactRezRUR = ZOV_FactRezRUR + Cells(i, 35)
     ElseIf Cells(i, 15) = "840" Then
      ZOV_OstSzUSD = ZOV_OstSzUSD + (Cells(i, 23) * KursUSD)
      ZOV_FactRezUSD = ZOV_FactRezUSD + Cells(i, 35)
     ElseIf Cells(i, 15) = "978" Then
      ZOV_OstSzEUR = ZOV_OstSzEUR + (Cells(i, 23) * KursEUR)
      ZOV_FactRezEUR = ZOV_FactRezEUR + Cells(i, 35)
     End If
   End Select
   
      MB_OstSz = MB_OstSzRUR + MB_OstSzUSD + MB_OstSzEUR
      MB_FactRez = MB_FactRezRUR + MB_FactRezUSD + MB_FactRezEUR
   
      MB1_OstSz = MB1_OstSzRUR + MB1_OstSzUSD + MB1_OstSzEUR
      MB1_FactRez = MB1_FactRezRUR + MB1_FactRezUSD + MB1_FactRezEUR
   
      MB2_OstSz = MB2_OstSzRUR + MB2_OstSzUSD + MB2_OstSzEUR
      MB2_FactRez = MB2_FactRezRUR + MB2_FactRezUSD + MB2_FactRezEUR
   
      MB3_OstSz = MB3_OstSzRUR + MB3_OstSzUSD + MB3_OstSzEUR
      MB3_FactRez = MB3_FactRezRUR + MB3_FactRezUSD + MB3_FactRezEUR
   
      MB4_OstSz = MB4_OstSzRUR + MB4_OstSzUSD + MB4_OstSzEUR
      MB4_FactRez = MB4_FactRezRUR + MB4_FactRezUSD + MB4_FactRezEUR
   
      MB5_OstSz = MB5_OstSzRUR + MB5_OstSzUSD + MB5_OstSzEUR
      MB5_FactRez = MB5_FactRezRUR + MB5_FactRezUSD + MB5_FactRezEUR
   
      MB6_OstSz = MB6_OstSzRUR + MB6_OstSzUSD + MB6_OstSzEUR
      MB6_FactRez = MB6_FactRezRUR + MB6_FactRezUSD + MB6_FactRezEUR
   
      OV_OstSz = OV_OstSzRUR + OV_OstSzUSD + OV_OstSzEUR
      OV_FactRez = OV_FactRezRUR + OV_FactRezUSD + OV_FactRezEUR
   
      OV1_OstSz = OV1_OstSzRUR + OV1_OstSzUSD + OV1_OstSzEUR
      OV1_FactRez = OV1_FactRezRUR + OV1_FactRezUSD + OV1_FactRezEUR
   
      OV2_OstSz = OV2_OstSzRUR + OV2_OstSzUSD + OV2_OstSzEUR
      OV2_FactRez = OV2_FactRezRUR + OV2_FactRezUSD + OV2_FactRezEUR
   
      OV3_OstSz = OV3_OstSzRUR + OV3_OstSzUSD + OV3_OstSzEUR
      OV3_FactRez = OV3_FactRezRUR + OV3_FactRezUSD + OV3_FactRezEUR
      
      ZMB_OstSz = ZMB_OstSzRUR + ZMB_OstSzUSD + ZMB_OstSzEUR
      ZMB_FactRez = ZMB_FactRezRUR + ZMB_FactRezUSD + ZMB_FactRezEUR
      
      ZOV_OstSz = ZOV_OstSzRUR + ZOV_OstSzUSD + ZOV_OstSzEUR
      ZOV_FactRez = ZOV_FactRezRUR + ZOV_FactRezUSD + ZOV_FactRezEUR
   
   If Cells(i, 13) > 0 Then
    If Cells(i, 15) = "810" Then
     ProlongOstSzRUR = ProlongOstSzRUR + Cells(i, 23)
    ElseIf Cells(i, 15) = "840" Then
     ProlongOstSzUSD = ProlongOstSzUSD + (Cells(i, 23) * KursUSD)
    ElseIf Cells(i, 15) = "978" Then
     ProlongOstSzEUR = ProlongOstSzEUR + (Cells(i, 23) * KursEUR)
    End If
   End If
   
   ProlongOstSz = ProlongOstSzRUR + ProlongOstSzUSD + ProlongOstSzEUR
   
   If (Cells(i, 33) <> "MB") And (Cells(i, 33) <> "MB1") And (Cells(i, 33) <> "MB2") And _
    (Cells(i, 33) <> "MB3") And (Cells(i, 33) <> "MB4") And (Cells(i, 33) <> "MB5") And _
    (Cells(i, 33) <> "MB6") And (Cells(i, 33) <> "ZMB") And (Cells(i, 33) <> "OV") And _
    (Cells(i, 33) <> "OV1") And (Cells(i, 33) <> "OV2") And (Cells(i, 33) <> "OV3") And _
    (Cells(i, 33) <> "ZOV") Then
    Select Case Cells(i, 15)
     Case "810"
      ProsrProcRUR = ProsrProcRUR + Cells(i, 27)
     Case "840"
      ProsrProcUSD = ProsrProcUSD + (Cells(i, 27) * KursUSD)
     Case "978"
      ProsrProcEUR = ProsrProcEUR + (Cells(i, 27) * KursEUR)
    End Select
   End If
      
      ProsrProc = ProsrProcRUR + ProsrProcUSD + ProsrProcEUR
      ProsrProcVAL = ProsrProcUSD + ProsrProcEUR
   
   Select Case Cells(i, 15)
    Case "810"
     Select Case Cells(i, 40)
      Case "|fffd||fffd||fffd||fffd||fffd|"
       PBOUL_OstSzRUR = PBOUL_OstSzRUR + Cells(i, 23)
       PBOUL_OstProsrRUR = PBOUL_OstProsrRUR + Cells(i, 24)
      Case "|fffd||fffd||fffd||fffd||fffd|1221"
       PBOUL1221_OstSzRUR = PBOUL1221_OstSzRUR + Cells(i, 23)
       PBOUL1221_OstProsrRUR = PBOUL1221_OstProsrRUR + Cells(i, 24)
      Case "|fffd||fffd||fffd|"
       SMP_OstSzRUR = SMP_OstSzRUR + Cells(i, 23)
       SMP_OstProsrRUR = SMP_OstProsrRUR + Cells(i, 24)
      Case "|fffd||fffd||fffd|1221"
       SMP1221_OstSzRUR = SMP1221_OstSzRUR + Cells(i, 23)
       SMP1221_OstProsrRUR = SMP1221_OstProsrRUR + Cells(i, 24)
    End Select
   End Select
    
   If (Cells(i, 21) = "|fffd||fffd|") Or (Cells(i, 21) = "|fffd||fffd|") Then
    Select Case Cells(i, 15)
     Case "810"
      OKOS_OstSzRUR = OKOS_OstSzRUR + Cells(i, 23)
      OKOS_OstProsrRUR = OKOS_OstProsrRUR + Cells(i, 24)
     Case "840"
      OKOS_OstSzUSD = OKOS_OstSzUSD + (Cells(i, 23) * KursUSD)
      OKOS_OstProsrUSD = OKOS_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      OKOS_OstSzEUR = OKOS_OstSzEUR + (Cells(i, 23) * KursEUR)
      OKOS_OstProsrEUR = OKOS_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      OKOS_OstSzVAL = OKOS_OstSzUSD + OKOS_OstSzEUR
      OKOS_OstProsrVAL = OKOS_OstProsrUSD + OKOS_OstProsrEUR
   End If
    
   If (Cells(i, 21) = "|fffd||fffd||fffd|") Then
    Select Case Cells(i, 15)
     Case "810"
      VTS_OstSzRUR = VTS_OstSzRUR + Cells(i, 23)
      VTS_OstProsrRUR = VTS_OstProsrRUR + Cells(i, 24)
     Case "840"
      VTS_OstSzUSD = VTS_OstSzUSD + (Cells(i, 23) * KursUSD)
      VTS_OstProsrUSD = VTS_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      VTS_OstSzEUR = VTS_OstSzEUR + (Cells(i, 23) * KursEUR)
      VTS_OstProsrEUR = VTS_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      VTS_OstSzVAL = VTS_OstSzUSD + VTS_OstSzEUR
      VTS_OstProsrVAL = VTS_OstProsrUSD + VTS_OstProsrEUR
   End If
    
   If (Cells(i, 20) = "2") Then
    Select Case Cells(i, 15)
     Case "810"
      INVEST_OstSzRUR = INVEST_OstSzRUR + Cells(i, 23)
      INVEST_OstProsrRUR = INVEST_OstProsrRUR + Cells(i, 24)
     Case "840"
      INVEST_OstSzUSD = INVEST_OstSzUSD + (Cells(i, 23) * KursUSD)
      INVEST_OstProsrUSD = INVEST_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      INVEST_OstSzEUR = INVEST_OstSzEUR + (Cells(i, 23) * KursEUR)
      INVEST_OstProsrEUR = INVEST_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      INVEST_OstSzVAL = INVEST_OstSzUSD + INVEST_OstSzEUR
      INVEST_OstProsrVAL = INVEST_OstProsrUSD + INVEST_OstProsrEUR
   End If
    
   If (Cells(i, 20) = "3") Then
    Select Case Cells(i, 15)
     Case "810"
      STROIKA_OstSzRUR = STROIKA_OstSzRUR + Cells(i, 23)
      STROIKA_OstProsrRUR = STROIKA_OstProsrRUR + Cells(i, 24)
     Case "840"
      STROIKA_OstSzUSD = STROIKA_OstSzUSD + (Cells(i, 23) * KursUSD)
      STROIKA_OstProsrUSD = STROIKA_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      STROIKA_OstSzEUR = STROIKA_OstSzEUR + (Cells(i, 23) * KursEUR)
      STROIKA_OstProsrEUR = STROIKA_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      STROIKA_OstSzVAL = STROIKA_OstSzUSD + STROIKA_OstSzEUR
      STROIKA_OstProsrVAL = STROIKA_OstProsrUSD + STROIKA_OstProsrEUR
   End If
    
   If (Cells(i, 20) = "4") Then
    Select Case Cells(i, 15)
     Case "810"
      OPK_OstSzRUR = OPK_OstSzRUR + Cells(i, 23)
      OPK_OstProsrRUR = OPK_OstProsrRUR + Cells(i, 24)
     Case "840"
      OPK_OstSzUSD = OPK_OstSzUSD + (Cells(i, 23) * KursUSD)
      OPK_OstProsrUSD = OPK_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      OPK_OstSzEUR = OPK_OstSzEUR + (Cells(i, 23) * KursEUR)
      OPK_OstProsrEUR = OPK_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      OPK_OstSzVAL = OPK_OstSzUSD + OPK_OstSzEUR
      OPK_OstProsrVAL = OPK_OstProsrUSD + OPK_OstProsrEUR
   End If
    
   If (Cells(i, 7) = "357") Then
    Select Case Cells(i, 15)
     Case "810"
      EIO_OstSzRUR = EIO_OstSzRUR + Cells(i, 23)
      EIO_OstProsrRUR = EIO_OstProsrRUR + Cells(i, 24)
     Case "840"
      EIO_OstSzUSD = EIO_OstSzUSD + (Cells(i, 23) * KursUSD)
      EIO_OstProsrUSD = EIO_OstProsrUSD + (Cells(i, 24) * KursUSD)
     Case "978"
      EIO_OstSzEUR = EIO_OstSzEUR + (Cells(i, 23) * KursEUR)
      EIO_OstProsrEUR = EIO_OstProsrEUR + (Cells(i, 24) * KursEUR)
    End Select
      EIO_OstSzVAL = EIO_OstSzUSD + EIO_OstSzEUR
      EIO_OstProsrVAL = EIO_OstProsrUSD + EIO_OstProsrEUR
   End If
    
 Next
  
 With .Sheets("Svod2")
  .Activate
  .Cells(4, 2) = Application.WorksheetFunction.Round(AlSz, 2) + 0
  .Cells(5, 2) = Application.WorksheetFunction.Round(AlSzSr, 2) + 0
  .Cells(6, 2) = Application.WorksheetFunction.Round(AlSzProsr, 2) + 0
  .Cells(7, 2) = Application.WorksheetFunction.Round(AlSzRUR, 2) + 0
  .Cells(8, 2) = Application.WorksheetFunction.Round(AlSzSrRUR, 2) + 0
  .Cells(9, 2) = Application.WorksheetFunction.Round(AlSzProsrRUR, 2) + 0
  .Cells(10, 2) = Application.WorksheetFunction.Round(AlSzVAL, 2) + 0
  .Cells(11, 2) = Application.WorksheetFunction.Round(AlSzSrVAL, 2) + 0
  .Cells(12, 2) = Application.WorksheetFunction.Round(AlSzProsrVAL, 2) + 0
  .Cells(13, 2) = Application.WorksheetFunction.Round(I_katOstSz, 2) + 0
  .Cells(14, 2) = Application.WorksheetFunction.Round(I_katFactRez, 2) + 0
  .Cells(15, 2) = Application.WorksheetFunction.Round(I_katRascRez, 2) + 0
  .Cells(16, 2) = Application.WorksheetFunction.Round(II_katOstSz, 2) + 0
  .Cells(17, 2) = Application.WorksheetFunction.Round(II_katFactRez, 2) + 0
  .Cells(18, 2) = Application.WorksheetFunction.Round(II_katRascRez, 2) + 0
  .Cells(19, 2) = Application.WorksheetFunction.Round(III_katOstSz, 2) + 0
  .Cells(20, 2) = Application.WorksheetFunction.Round(III_katFactRez, 2) + 0
  .Cells(21, 2) = Application.WorksheetFunction.Round(III_katRascRez, 2) + 0
  .Cells(22, 2) = Application.WorksheetFunction.Round(IV_katOstSz, 2) + 0
  .Cells(23, 2) = Application.WorksheetFunction.Round(IV_katFactRez, 2) + 0
  .Cells(24, 2) = Application.WorksheetFunction.Round(IV_katRascRez, 2) + 0
  .Cells(25, 2) = Application.WorksheetFunction.Round(V_katOstSz, 2) + 0
  .Cells(26, 2) = Application.WorksheetFunction.Round(V_katFactRez, 2) + 0
  .Cells(27, 2) = Application.WorksheetFunction.Round(V_katRascRez, 2) + 0
  .Cells(28, 2) = Application.WorksheetFunction.Round(MB_OstSz, 2) + 0
  .Cells(29, 2) = Application.WorksheetFunction.Round(MB_FactRez, 2) + 0
  .Cells(30, 2) = Application.WorksheetFunction.Round(MB1_OstSz, 2) + 0
  .Cells(31, 2) = Application.WorksheetFunction.Round(MB1_FactRez, 2) + 0
  .Cells(32, 2) = Application.WorksheetFunction.Round(MB2_OstSz, 2) + 0
  .Cells(33, 2) = Application.WorksheetFunction.Round(MB2_FactRez, 2) + 0
  .Cells(34, 2) = Application.WorksheetFunction.Round(MB3_OstSz, 2) + 0
  .Cells(35, 2) = Application.WorksheetFunction.Round(MB3_FactRez, 2) + 0
  .Cells(36, 2) = Application.WorksheetFunction.Round(MB4_OstSz, 2) + 0
  .Cells(37, 2) = Application.WorksheetFunction.Round(MB4_FactRez, 2) + 0
  .Cells(38, 2) = Application.WorksheetFunction.Round(MB5_OstSz, 2) + 0
  .Cells(39, 2) = Application.WorksheetFunction.Round(MB5_FactRez, 2) + 0
  .Cells(40, 2) = Application.WorksheetFunction.Round(MB6_OstSz, 2) + 0
  .Cells(41, 2) = Application.WorksheetFunction.Round(MB6_FactRez, 2) + 0
  .Cells(42, 2) = Application.WorksheetFunction.Round(OV_OstSz, 2) + 0
  .Cells(43, 2) = Application.WorksheetFunction.Round(OV_FactRez, 2) + 0
  .Cells(44, 2) = Application.WorksheetFunction.Round(OV1_OstSz, 2) + 0
  .Cells(45, 2) = Application.WorksheetFunction.Round(OV1_FactRez, 2) + 0
  .Cells(46, 2) = Application.WorksheetFunction.Round(OV2_OstSz, 2) + 0
  .Cells(47, 2) = Application.WorksheetFunction.Round(OV2_FactRez, 2) + 0
  .Cells(48, 2) = Application.WorksheetFunction.Round(OV3_OstSz, 2) + 0
  .Cells(49, 2) = Application.WorksheetFunction.Round(OV3_FactRez, 2) + 0
  .Cells(50, 2) = Application.WorksheetFunction.Round(ZMB_OstSz, 2) + 0
  .Cells(51, 2) = Application.WorksheetFunction.Round(ZMB_FactRez, 2) + 0
  .Cells(52, 2) = Application.WorksheetFunction.Round(ZOV_OstSz, 2) + 0
  .Cells(53, 2) = Application.WorksheetFunction.Round(ZOV_FactRez, 2) + 0
  .Cells(54, 2) = Application.WorksheetFunction.Round(ProlongOstSz, 2) + 0
  .Cells(55, 2) = Application.WorksheetFunction.Round(ProsrProc, 2) + 0
  .Cells(56, 2) = Application.WorksheetFunction.Round(ProsrProcRUR, 2) + 0
  .Cells(57, 2) = Application.WorksheetFunction.Round(ProsrProcVAL, 2) + 0
  .Cells(58, 2) = Application.WorksheetFunction.Round((PBOUL_OstSzRUR + PBOUL1221_OstSzRUR), 2) + 0
  .Cells(59, 2) = Application.WorksheetFunction.Round(PBOUL1221_OstSzRUR, 2) + 0
  .Cells(60, 2) = Application.WorksheetFunction.Round((PBOUL_OstProsrRUR + PBOUL1221_OstProsrRUR), 2) + 0
  .Cells(61, 2) = Application.WorksheetFunction.Round(PBOUL1221_OstProsrRUR, 2) + 0
  .Cells(62, 2) = Application.WorksheetFunction.Round((SMP_OstSzRUR + SMP1221_OstSzRUR), 2) + 0
  .Cells(63, 2) = Application.WorksheetFunction.Round(SMP1221_OstSzRUR, 2) + 0
  .Cells(64, 2) = Application.WorksheetFunction.Round((SMP_OstProsrRUR + SMP1221_OstProsrRUR), 2) + 0
  .Cells(65, 2) = Application.WorksheetFunction.Round(SMP1221_OstProsrRUR, 2) + 0
  .Cells(66, 2) = Application.WorksheetFunction.Round(OKOS_OstSzRUR, 2) + 0
  .Cells(67, 2) = Application.WorksheetFunction.Round(OKOS_OstProsrRUR, 2) + 0
  .Cells(68, 2) = Application.WorksheetFunction.Round(OKOS_OstSzVAL, 2) + 0
  .Cells(69, 2) = Application.WorksheetFunction.Round(OKOS_OstProsrVAL, 2) + 0
  .Cells(70, 2) = Application.WorksheetFunction.Round(VTS_OstSzRUR, 2) + 0
  .Cells(71, 2) = Application.WorksheetFunction.Round(VTS_OstSzVAL, 2) + 0
  .Cells(72, 2) = Application.WorksheetFunction.Round(INVEST_OstSzRUR, 2) + 0
  .Cells(73, 2) = Application.WorksheetFunction.Round(INVEST_OstSzVAL, 2) + 0
  .Cells(74, 2) = Application.WorksheetFunction.Round(STROIKA_OstSzRUR, 2) + 0
  .Cells(75, 2) = Application.WorksheetFunction.Round(STROIKA_OstSzVAL, 2) + 0
  .Cells(76, 2) = Application.WorksheetFunction.Round(OPK_OstSzRUR, 2) + 0
  .Cells(77, 2) = Application.WorksheetFunction.Round(OPK_OstProsrRUR, 2) + 0
  .Cells(78, 2) = Application.WorksheetFunction.Round(OPK_OstSzVAL, 2) + 0
  .Cells(79, 2) = Application.WorksheetFunction.Round(OPK_OstProsrVAL, 2) + 0
  .Cells(80, 2) = Application.WorksheetFunction.Round(EIO_OstSzRUR, 2) + 0
  .Cells(81, 2) = Application.WorksheetFunction.Round(EIO_OstProsrRUR, 2) + 0
  .Cells(82, 2) = Application.WorksheetFunction.Round(EIO_OstSzVAL, 2) + 0
  .Cells(83, 2) = Application.WorksheetFunction.Round(EIO_OstProsrVAL, 2) + 0

 End With
 
End With

Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Exi_F:
  Exit Sub
Err_F:
   MsgBox Err.Description, vbCritical
   Resume Exi_F
End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|() '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    Application.DisplayAlerts = False
    Application.ScreenUpdating = False

On Error GoTo err_msg:

Const |fffd||fffd||fffd||fffd| = "kp"
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String, |fffd||fffd||fffd||fffd||fffd||fffd| As Date
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Variant
    
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value
    |fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd|").Value
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Format(|fffd||fffd||fffd||fffd||fffd||fffd|, "MM") + |fffd||fffd||fffd||fffd| + |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.GetSaveAsFilename(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, filefilter:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| (*.txt),*.txt")
    If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = False Then Exit Sub
    
MakeSvod2File (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
Exit Sub
err_msg:
 MsgBox Err.Description, vbCritical
End Sub

Function MakeSvod2File(cOutFile As String)
  Dim rG As Range, rRow As Range, rCell As Range
  Dim cString As String, nf As Integer, list_sv As String
  list_sv = "svod2"
  If IsWorkSheetExist(list_sv) = False Then
  MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", 16
  Else
  
  Set rG = Worksheets(list_sv).UsedRange
  nf = FreeFile()
  Open cOutFile For Output As #nf
  For Each rRow In rG.Rows
    cString = ""
    For Each rCell In rRow.Cells
    cString = cString & rCell.Value & " "
       '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    If InStr(cString, ",") Then Mid(cString, InStr(cString, ","), 1) = "."
    Next
        
  Print #nf, cString '& vbCrLf
  Next
  Close #nf
    MsgBox cOutFile, 64, "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
  
 End If
End Function

Function IsWorkSheetExist(sSName As String) As Boolean
 On Error GoTo err|fffd|andle:
If Worksheets(sSName).Cells(1, 1) = Worksheets(sSName).Cells(1, 1) Then
   IsWorkSheetExist = True
End If
 Exit Function
err|fffd|andle:
   IsWorkSheetExist = False
 End Function

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd|_|fffd||fffd||fffd|"
Option Explicit
Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_88_temp()
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Variant, i, n, j As Long, ShortNameOfFile As String
Dim nFrstRowIASK, nLastRowIASK As Long
Dim nFrstRowOtch, nLastRowOtch As Long
Dim rng1 As Range
Dim k As Range
Dim znachenie As String
Dim a As Long
Dim b As String

'On Error GoTo Err_F

'Application.ScreenUpdating = False
'Application.DisplayAlerts = False
'Application.EnableEvents = False

With ThisWorkbook
 |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.GetOpenFilename("|fffd||fffd||fffd||fffd||fffd| Microsoft Excel (*.xls) (*.xls), *.xls", , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , True)
 If IsArray(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then
  For i = LBound(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) To UBound(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
   
   ShortNameOfFile = NameOfFile(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(i))
   Workbooks.Open FileName:=|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(i)
   Worksheets("|fffd||fffd||fffd||fffd|1").Activate
   
   If (IsError(Application.Match("|fffd||fffd||fffd||fffd||fffd|", ActiveSheet.Range("a:a"), 0))) Then
    MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd| " & ShortNameOfFile & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd|1"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd|""..." + vbLf + "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|...", vbCritical
    Workbooks(ShortNameOfFile).Close savechanges:=False
    GoTo Next_File
   End If
 
    nFrstRowIASK = Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|", Range("a:a"), 0) + 2
    nLastRowIASK = Application.WorksheetFunction.Match("|fffd||fffd||fffd||fffd||fffd|", Range("a:a"), 0) - 1
    
    'Range(Cells(nFrstRowIASK, 35), Cells(nLastRowIASK, 35)).NumberFormat = "0.00"
    
    Set rng1 = Range(Cells(nFrstRowIASK, 1), Cells(nLastRowIASK, 54))
    
    n = rng1.Rows.Count
    
    ThisWorkbook.Activate
    Worksheets("|fffd||fffd||fffd||fffd||fffd|").Activate
    ActiveSheet.Unprotect
    ActiveSheet.Range(Cells(110, 1), Cells(15110, 44)).ClearContents
    ActiveSheet.Range(Cells(110, 1), Cells(15110, 44)).Interior.ColorIndex = xlNone
    ActiveSheet.Range(Cells(110, 1), Cells(15110, 44)).ClearComments
    ActiveSheet.Protect
    
    For j = 1 To n
     Cells(j + 109, 1) = rng1.Cells(j, 2) ' |fffd| |fffd|/|fffd|
     Cells(j + 109, 2) = Cells(105, 3) & "/0000" ' |fffd| |fffd||fffd||fffd|
     Cells(j + 109, 3) = ZAEMSCHIK(rng1.Cells(j, 4)) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 4) = rng1.Cells(j, 5) ' |fffd||fffd||fffd|
     Cells(j + 109, 5) = Left(Trim(rng1.Cells(j, 28)), 5) ' |fffd|/|fffd|
     Cells(j + 109, 6) = rng1.Cells(j, 16) ' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 7) = rng1.Cells(j, 13) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 8) = IIf(Len(Trim(CStr(rng1.Cells(j, 16)))) = 0, rng1.Cells(j, 17), CDate(rng1.Cells(j, 17))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 9) = IIf(Len(Trim(CStr(rng1.Cells(j, 17)))) = 0, rng1.Cells(j, 18), CDate(rng1.Cells(j, 18))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 10) = IIf(Len(Trim(CStr(rng1.Cells(j, 18)))) = 0, rng1.Cells(j, 19), CDate(rng1.Cells(j, 19))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 11) = IIf(Len(Trim(CStr(rng1.Cells(j, 21)))) = 0, rng1.Cells(j, 22), CDate(rng1.Cells(j, 22))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
     Cells(j + 109, 12) = rng1.Cells(j, 20) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 13) = rng1.Cells(j, 27) ' % |fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 14) = rng1.Cells(j, 15) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 15) = IIf(rng1.Cells(j, 23) = "RUR", "810", IIf(rng1.Cells(j, 23) = "USD", "840", IIf(rng1.Cells(j, 23) = "EUR", "978", "000"))) ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
     Cells(j + 109, 16) = rng1.Cells(j, 24) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 17) = rng1.Cells(j, 25) ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 18) = rng1.Cells(j, 12) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 19) = rng1.Cells(j, 14) ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     'Cells(j + 109, 20) = rng1.Cells(j, ??) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 21) = IIf(rng1.Cells(j, 29) = "RUR", "810", IIf(rng1.Cells(j, 29) = "USD", "840", IIf(rng1.Cells(j, 29) = "EUR", "978", "000"))) ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 22) = rng1.Cells(j, 30) + rng1.Cells(j, 32) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 23) = rng1.Cells(j, 32) ' |fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 24) = rng1.Cells(j, 35) + rng1.Cells(j, 36) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 25) = IIf(Len(Trim(CStr(rng1.Cells(j, 37)))) = 0, rng1.Cells(j, 37), CDate(rng1.Cells(j, 37))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 26) = IIf(Len(Trim(CStr(rng1.Cells(j, 39)))) = 0, rng1.Cells(j, 39), CDate(rng1.Cells(j, 39))) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 27) = rng1.Cells(j, 41) ' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 28) = VID_OBESP_dop_88(Trim(rng1.Cells(j, 43))) ' |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 29) = RASC_VID_OBESP_dop_88(Trim(rng1.Cells(j, 43)), Trim(rng1.Cells(j, 44))) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     'Cells(j + 109, 30) = rng1.Cells(j, ??) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     'Cells(j + 109, 31) = rng1.Cells(j, ??) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     'Cells(j + 109, 32) = rng1.Cells(j, ??) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 33) = rng1.Cells(j, 48) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 34) = rng1.Cells(j, 49) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 35) = rng1.Cells(j, 50) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 36) = IIf(Trim(CStr(rng1.Cells(j, 51))) = "1", "1 |fffd||fffd||fffd||fffd||fffd|", IIf(Trim(CStr(rng1.Cells(j, 51))) = "2", "2 |fffd||fffd||fffd||fffd||fffd|", IIf(Trim(CStr(rng1.Cells(j, 51))) = "3", "3 |fffd||fffd||fffd||fffd||fffd|", Trim(CStr(rng1.Cells(j, 51)))))) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 37) = rng1.Cells(j, 52) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 38) = rng1.Cells(j, 53) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 39) = rng1.Cells(j, 54) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 40) = rng1.Cells(j, 34) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 41) = Trim(CStr(rng1.Cells(j, 7))) ' |fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 42) = OPF_NAIM(rng1.Cells(j, 3)) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
     'Cells(j + 109, 43) = IIf(CStr(Trim(rng1.Cells(j, 9))) = "1", "1", "") ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 43) = CStr(Trim(rng1.Cells(j, 10))) ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
     Cells(j + 109, 44) = 0 ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Next j

   Cells(j + 109, 1) = "|fffd||fffd||fffd||fffd||fffd|"
   
    Workbooks(ShortNameOfFile).Activate
    Workbooks(ShortNameOfFile).Close savechanges:=False
    
    MsgBox "      |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
    
Next_File:
   Next
 Else
  Exit Sub
 End If
 
End With

Exi_F:
  Set rng1 = Nothing
  'Application.EnableEvents = True
  Exit Sub
Err_F:
  MsgBox Err.Description, vbCritical
  Workbooks(ShortNameOfFile).Activate
  Workbooks(ShortNameOfFile).Close savechanges:=False
  Resume Exi_F

End Sub
Function NameOfFile(nm As Variant) As String
Dim a As Long, b As String
a = InStr(1, nm, "\")
Do While a <> 0
 b = Mid(nm, a + 1, Len(nm))
 a = InStr(1, b, "\")
 nm = b
Loop
NameOfFile = b
End Function
Function ZAEMSCHIK(naim As String) As String
Dim q1 As String
Dim q2 As Long
Dim q4 As String
Dim q5 As String
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 As Long

q1 = CStr(Trim(naim))

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, """")
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 = InStr(1, q1, "'")
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 = InStr(1, q1, "`")

Do While (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0) Or (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 <> 0) Or (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 <> 0)
 If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0 Then
    q2 = Len(q1)
    q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
    q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, q2)
    q1 = q4 & q5
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, """")
 ElseIf |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 <> 0 Then
        q2 = Len(q1)
        q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 - 1)
        q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 + 1, q2)
        q1 = q4 & q5
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 = InStr(1, q1, "'")
 ElseIf |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 <> 0 Then
        q2 = Len(q1)
        q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 - 1)
        q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 + 1, q2)
        q1 = q4 & q5
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 = InStr(1, q1, "`")
 End If
Loop
ZAEMSCHIK = q1
End Function
Function CRED_TYPE_CODE(naim As String) As String
Dim i As Range
For Each i In Range("CRED_TYPE_NAIM")
 If UCase(Trim(i.Value)) = UCase(Trim(naim)) Then
  CRED_TYPE_CODE = i.Offset(0, -1)
  Exit For
 End If
Next
End Function
Function OPF_NAIM(code As String) As String
Dim i As Range
For Each i In Range("OPF_CODE")
 If UCase(Trim(i.Value)) = UCase(Trim(code)) Then
  OPF_NAIM = i.Offset(0, 1)
  Exit For
 End If
Next
End Function
Function VID_OBESP_dop_88(obesp As String) As String
Dim a As Long

a = InStr(1, obesp, "(", 1)

If a > 0 Then
 VID_OBESP_dop_88 = Mid(obesp, 1, a - 2)
Else
 VID_OBESP_dop_88 = obesp
End If

End Function
Function RASC_VID_OBESP_dop_88(obesp, rasc As String) As String
Dim a, b As Long

a = InStr(1, obesp, "(", 1)
b = InStr(1, rasc, ",", 1)

If a > 0 Then
 If b > 0 Then
  RASC_VID_OBESP_dop_88 = Mid(obesp, a + 1, (Len(obesp) - a) - 1) & "," & rasc
 Else
  RASC_VID_OBESP_dop_88 = Mid(obesp, a + 1, (Len(obesp) - a) - 1)
 End If
Else
  RASC_VID_OBESP_dop_88 = rasc
End If

End Function
Function RASC_VID_OBESP(rasc As String) As String
Dim Whole, Part_1, Part_2 As String
Dim LenghWhole As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long

'//|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Whole = CStr(Trim(rasc))

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, ",,", 1)

If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0 Then
 Do While (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0)
  LenghWhole = Len(Whole)
  Part_1 = Mid(Whole, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
  Part_2 = Mid(Whole, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 2, LenghWhole)
  Whole = Part_1 & "," & Part_2
  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, ",,")
 Loop
End If

'//|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Whole = Mid(Trim(Whole), 1, Len(Trim(Whole)) - 1)

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, ",", 1)

If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0 Then
 Do While (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0)
  LenghWhole = Len(Whole)
  Part_1 = Mid(Whole, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
  Part_2 = Mid(Whole, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, LenghWhole)
  Whole = Part_1 & "!" & Part_2
  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, ",")
 Loop
End If

'//|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, "!", 1)

If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0 Then
 Do While (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0)
  LenghWhole = Len(Whole)
  Part_1 = Mid(Whole, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
  Part_2 = Mid(Whole, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, LenghWhole)
  Whole = Part_1 & ", " & Part_2
  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, Whole, "!")
 Loop
End If

RASC_VID_OBESP = Trim(Whole)

End Function


Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
ActiveCell.Select
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|_88
End Sub
Private Sub CommandButton2_Click()
'On Error GoTo Err_F
'On Error Resume Next
ActiveCell.Select
Unprotect
  Check
Protect
Exi_F:
  Exit Sub
Err_F:
  MsgBox Err.Description, vbCritical
  Resume Exi_F
End Sub

Private Sub CommandButton3_Click()
ActiveCell.Select
Call |fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|
End Sub

Private Sub CommandButton4_Click()
ActiveCell.Select
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Sub

Private Sub CommandButton5_Click()
ActiveCell.Select
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2
End Sub

Private Sub CommandButton6_Click()
ActiveCell.Select
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Sub

Private Sub CommandButton7_Click()
ActiveCell.Select
Call ForSO
End Sub

'Private Sub Worksheet_SelectionChange(ByVal Target As Excel.Range)
'If Target.Column > |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1 Then
'    If Target.Count = 1 Then Cells(Target.Row + 1, 1).Select
'End If
'End Sub
'Private Sub Worksheet_Change(ByVal Target As Excel.Range)
'On Error Resume Next

'If Target.Count = 1 Then

'    If Target.Column = 2 And Target.Row >= 110 And Target.Row <= 2500 And UCase(Target.Value) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
    
'    Cells(Target.Row, 30).Value = _
'    CVDate(InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", , _
'     IIf(IsEmpty(Cells(Target.Row, 36).Value), Cells(Target.Row, 12).Value, Cells(Target.Row, 36).Value)))

'    End If

'End If

'End Sub



Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|"
'Option Explicit
Sub |fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
'
theFilter = "|fffd||fffd||fffd||fffd||fffd|   (*.*),*.*"
'myfile = Application.GetOpenFilename(theFilter, 1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|")
'If myfile Like "|fffd||fffd||fffd||fffd|" Then Exit Sub


'Workbooks.Open FileName:=myfile

new_book = "all.xls"
Workbooks.Open new_book

For Each buk In Workbooks
'If buk.Name = new_book Then Exit For
Exit For
Workbooks.Open new_book
Next
ThisWorkbook.Activate
With Worksheets("|fffd||fffd||fffd||fffd||fffd|")
.Select


Who = .Range("|fffd||fffd||fffd||fffd|")
When = .Range("|fffd||fffd||fffd||fffd|")
N_Who = |fffd||fffd||fffd||fffd|(.Range("|fffd||fffd||fffd||fffd|"))

    '  .Unprotect
      
nLastRow = Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), .Cells(5000, 1)), 0) - 1

    .Range(.Cells(109, 1), .Cells(nLastRow, 27)).Select
    
    Selection.Copy

End With
With Workbooks(new_book)
    .Activate
'    Workbooks.Add
    .Worksheets.Add
    .ActiveSheet.Name = Who
    With Worksheets(Who)
    .Cells(1, 3).Select
    Selection.PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
    Selection.PasteSpecial Paste:=xlFormats, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=False
        
    .Range("A1").Formula = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    .Range("B1").Formula = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    .Range(Cells(2, 1), Cells(nLastRow - 108, 1)).Formula = When
    .Range(Cells(2, 2), Cells(nLastRow - 108, 2)).Formula = "'" & N_Who
    
    .Columns("a:ac").Select
    Selection.Columns.AutoFit
    
    For Each i In .Range("a2:ac2")
    Select Case i.NumberFormat
    Case "0", "#,##0.00"
    If IsEmpty(i.Value) Then i.Value = 0
    Case "@"
    i.Value = "'" & i.Value
    Case "dd/mm/yyyy"
    If IsEmpty(i.Value) Then i.Value = 0
    End Select
    Next i
    
    Cells(1).Select
    End With
End With

    Application.CutCopyMode = False
    
End Sub

Public Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

Application.ScreenUpdating = False

Dim Db As Object, Tabl As Object, i As Range, strSQL As String
Dim L_XLS As Worksheet, DATA_XLS As Range, NPP As Double

Set Db = OpenDatabase("D:\|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd|\OTCHET\|fffd||fffd||fffd||fffd||fffd| 2.6 (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Set L_XLS = Worksheets("|fffd||fffd||fffd||fffd||fffd|")



'Set Tabs = Db.QueryDefs("select N,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, N_|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")
Set Tabl = Db.OpenRecordset("select * from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")
'Set Tabl = Db.OpenRecordset("select N ,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")

'Set DATA_XLS = L_XLS.Range("a110:ab12500")
Set DATA_XLS = L_XLS.Range("a110:ag12500")
DATA_XLS.ClearContents

NPP = 1
Do While Not Tabl.EOF

 'For Each i In L_XLS.Range("a109:ab109")
 For Each i In L_XLS.Range("a109:ag109")
 '   For Each tFiel In Tabl.fields
 '   If tFiel.Name = i.Value Then Exit For
 '   Next tFiel
  DATA_XLS.Cells(NPP, i.Column).Value = Tabl.Fields(Cells(109, i.Column).Value)
  
Next i


Tabl.MoveNext
NPP = NPP + 1
Loop


L_XLS.Cells(110 + NPP - 1, 1) = "|fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd|").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = "0054"
Tabl.MoveLast
Range("|fffd||fffd||fffd||fffd|") = Tabl.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|"

Set Db = Nothing
Set Tabl = Nothing
End Sub

Public Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_ODBC()

Application.ScreenUpdating = False

Dim Tabl As Object, i As Range, strSQL As String
Dim L_XLS As Worksheet, DATA_XLS As Range, NPP As Double
Dim wrkODBC, oConn
    Set wrkODBC = CreateWorkspace("NewODBCWorkspace", _
        "admin", "", dbUseODBC)
    Set oConn = wrkODBC.OpenConnection("Connection1", , , _
        "ODBC;DATABASE=KredBase; UID=Onlyview;PWD=054;DSN=ODBC_KredBase")
    
   
    
     Dim oQ As QueryDef, oRec As Recordset
  'Set oQ = oConn.CreateQueryDef("myq", "{?=call dbo.up_CheckUser(?,?)}")
  Set oQ = oConn.CreateQueryDef("", "? = call dbo.ZRep_German(?,?,?)")
      
  With oQ
    .Prepare = dbQUnprepare: .ODBCTimeout = 0
    .Parameters(0).Direction = dbParamReturnValue
    
    With .Parameters(1)
      .Direction = dbParamInput
      .Value = Range("|fffd||fffd||fffd||fffd|").Value + 1
    End With

    With .Parameters(2)
      .Direction = dbParamInput
      .Value = 0
    End With

    With .Parameters(3)
      .Direction = dbParamInput
      .Value = "05"
    End With

    Set oRec = oConn.OpenRecordset("view_opers")
    Do While Not oRec.EOF
      Debug.Print oRec.Fields(0).Value & " " & oRec.Fields(1).Value
      oRec.MoveNext
    Loop
    oRec.Close
    
    Set oRec = oQ.OpenRecordset(dbOpenForwardOnly)
    Do While Not oRec.EOF
      Debug.Print oRec.Fields(0).Value
      oRec.MoveNext
    Loop
    oRec.Close
    Set oRec = Nothing
  End With

    
     'Db.Execute Db.ZRep_German
    
'Set Db = OpenDatabase("C:\|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Set L_XLS = Worksheets("|fffd||fffd||fffd||fffd||fffd|")



'Set Tabs = Db.QueryDefs("select N,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, N_|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")
'Set Tabl = Db.OpenRecordset("select * from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")
'Set Tabl = Db.OpenRecordset("select N ,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| from |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|;")

Set DATA_XLS = L_XLS.Range("a110:ab12500")
DATA_XLS.ClearContents

NPP = 1
Do While Not Tabl.EOF

 For Each i In L_XLS.Range("a109:ab109")
 '   For Each tFiel In Tabl.fields
 '   If tFiel.Name = i.Value Then Exit For
 '   Next tFiel
  DATA_XLS.Cells(NPP, i.Column).Value = Tabl.Fields(Cells(109, i.Column).Value)
  
Next i


Tabl.MoveNext
NPP = NPP + 1
Loop


L_XLS.Cells(110 + NPP - 1, 1) = "|fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd|").Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = "0054"
Tabl.MoveLast
Range("|fffd||fffd||fffd||fffd|") = Tabl.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|"

'Set Db = Nothing
Set Tabl = Nothing
End Sub
Public Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|()
Dim AccApp As Object, Db As Object, Tabl As Object, i As Integer, strSQL As String

Set Db = OpenDatabase("D:\|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|\portf.mdb")
Set Tabl = Db.OpenRecordset("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Set in_xls = Worksheets("|fffd||fffd||fffd||fffd||fffd|")

'strSQLIns = "INSERT INTO |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)  VALUES ('999.999.999','mmmmmmmmmmmmm');"

'strSQLIns = "INSERT INTO |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)  VALUES ('" & in_xls.Cells(2, 1).Value & "','" & in_xls.Cells(2, 2).Value & "');"

'Db.Execute strSQLIns, dbFailOnError

strSQL = "DELETE * FROM |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Db.Execute strSQL, dbFailOnError

With in_xls
nLastRow = Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), .Cells(12500, 1)), 0) - 1
End With

For i = 110 To nLastRow

If in_xls.Cells(i, 19) > 0 Then
AddName Tabl, Range(in_xls.Cells(i, 1), in_xls.Cells(i, 37))
End If

Next i


strSQL = "UPDATE |fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ON |fffd||fffd||fffd||fffd||fffd||fffd|.N_FIL = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd| SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd| = [|fffd||fffd||fffd||fffd||fffd||fffd|]![Region];"
Db.Execute strSQL, dbFailOnError
strSQL = "UPDATE |fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ON |fffd||fffd||fffd||fffd||fffd||fffd|.N_FIL = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd| SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd| = [|fffd||fffd||fffd||fffd||fffd||fffd|]![Naim];"
Db.Execute strSQL, dbFailOnError


MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Function AddName(rstTemp As Recordset, stroka As Variant)

    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Recordset, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|,
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
    With rstTemp
        .AddNew
        
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd|"
!|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd| = "54"
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(4)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(7)), " ", stroka(7))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(10)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(11)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(12))
!|fffd||fffd||fffd||fffd||fffd||fffd| = stroka(13)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(26)
!ISO_DIG = stroka(14)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(19)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(19)) - Val(stroka(20))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(20))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(21)
!|fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(22))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(23)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(24) & " "
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(25)
!|fffd||fffd||fffd| = IIf(IsEmpty(stroka(5)), " ", stroka(5))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(15)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(16)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = UCase(stroka(17))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(18)
!|fffd||fffd||fffd| = stroka(3)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(9)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(8)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = UCase(stroka(29))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = CVDate(stroka(31))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = UCase(stroka(28))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(36)) + Val(stroka(37))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(36))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(37))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(32))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(12)) - Val(stroka(35))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(35))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(21)), 0, Range("|fffd||fffd||fffd||fffd|") - stroka(21))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(33)
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(33)), 0, Range("|fffd||fffd||fffd||fffd|") - stroka(33))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = UCase(stroka(34))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Val(stroka(30))
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Format(stroka(19) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Val(stroka(25))), "0.00")
!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Format(stroka(19) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Val(stroka(25))), "0.00")

        .Update
        .Bookmark = .LastModified
    End With

End Function


Public Function |fffd||fffd||fffd||fffd|(tb As String)

If tb Like "*|fffd||fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "05"
ElseIf tb Like "*|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "11"
ElseIf tb Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "46"
ElseIf tb Like "*|fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "48"
ElseIf tb Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "56"
ElseIf tb Like "*|fffd||fffd||fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "69"
ElseIf tb Like "*|fffd||fffd||fffd||fffd|*" Then
   |fffd||fffd||fffd||fffd| = "54"

ElseIf tb Like "05" Or tb Like "0005" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "11" Or tb Like "0011" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "46" Or tb Like "0046" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "48" Or tb Like "0048" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "56" Or tb Like "0056" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "69" Or tb Like "0069" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "54" Or tb Like "9997" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ElseIf tb Like "9985" Then
   |fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Else
   |fffd||fffd||fffd||fffd| = ""
End If
End Function

Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd| As Integer) As Double
        Select Case |fffd||fffd||fffd||fffd||fffd||fffd|
        Case 1
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.01
        Case 2
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.2
        Case 3
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.5
        Case 4
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 1
        End Select
End Function


Public Sub |fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()

theFilter = "|fffd||fffd||fffd||fffd||fffd| Excel (*.xls),*.xls,|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (*.*),*.*"
file_old = Application.GetOpenFilename(theFilter, 1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|")

If file_old = False Then Exit Sub
         Workbooks.Open FileName:=file_old, updatelinks:=False, ReadOnly:=True
    
Set file_old = ActiveWorkbook

file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Select

Set old_xls = file_old.Sheets("|fffd||fffd||fffd||fffd||fffd|").Range(Cells(110, 1), Cells(Application.Match("|fffd||fffd||fffd||fffd||fffd|", Range("a1:a12500"), 0), 29))

ThisWorkbook.Activate
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Select
'Set NEW_xls = ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range(Cells(110, 1), Cells(12500, 29))
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range(Cells(110, 1), Cells(12500, 29)).ClearContents

With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|")
.Unprotect
.Cells(110, 1).Activate
      If (.Comments.Count > 0) Then .Range(.Cells(110, 1), .Cells(12500, 30)).ClearComments
      Range(.Cells(110, 1), .Cells(12500, 30)).Interior.ColorIndex = xlNone
.Protect
End With

np_news = 1

  Dim oInd As TProgressPercent, nInd As Long

  Set oInd = New TProgressPercent
  With oInd
    .Message = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    .Max = old_xls.Rows.Count
  End With
  


For i = 1 To old_xls.Rows.Count

   nInd = nInd + 1
   oInd.Show nInd
 
If UCase(old_xls.Cells(i, 1)) = "|fffd||fffd||fffd||fffd||fffd|" Then
Exit For
End If


If Trim(UCase(old_xls.Cells(i, 2).Value)) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
AddNew np_news + 109, Range(old_xls.Cells(i, 1), old_xls.Cells(i, 26))
np_news = np_news + 1
End If


Next i




Cells(np_news + 109, 1) = "|fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd|").Value = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd|") = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|"

file_old.Close savechanges:=False


End Sub

Function AddNew(np_new, stroka As Variant)

 
Cells(np_new, Application.Match("N", Range("a109:ac109"), 0)).Value = np_new - 109
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Cells(np_new, Application.Match("|fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = UCase(stroka(3))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(4)
Cells(np_new, Application.Match("|fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(5)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(6)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(7)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = (stroka(8))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = (stroka(9))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(10)
'
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = IIf(stroka(12) = 0, stroka(11), "")
'
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(11)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(12)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(13)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(14)

Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = |fffd||fffd||fffd||fffd||fffd||fffd||fffd|(stroka)

Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(15)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(16)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = UCase(stroka(17))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = Trim(stroka(18))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(19)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(20)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(21)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(22)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(23)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = Trim(stroka(24))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(25)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ac109"), 0)).Value = stroka(26)





End Function


Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd|(stroka)

If UCase(stroka(17)) = "|fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd|"
   stroka(17) = "|fffd||fffd|"
ElseIf UCase(stroka(17)) = "|fffd||fffd|" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "|fffd||fffd||fffd|"


End If
   
End Function
Public Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2()

Dim fileAc As Variant, Db As Object, Tabl As Object, i As Range, strSQL As String
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Date, |fffd||fffd||fffd||fffd||fffd||fffd| As String, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String, RecSetValue As Variant
Dim L_XLS As Worksheet, DATA_XLS As Range, tabs As QueryDef, NPP As Long, nLastRow As Long
Dim oInd As TProgressPercent, nInd As Long
Dim qqq As Long

On Error GoTo Err_F

fileAc = ActiveSheet.Range("j105").Value '|fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| Access
If IsEmpty(fileAc) Then
fileAc = Application.GetOpenFilename("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Access (*.mdb; *.mde), *.md*")
End If
If fileAc = False Then GoTo Exi_F
ActiveSheet.Range("j105").Value = fileAc

Set Db = OpenDatabase(fileAc)

Set L_XLS = ActiveWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|")
L_XLS.Unprotect
Set DATA_XLS = L_XLS.Range(Cells(110, 1), Cells(12500, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))

|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.Text(Range("|fffd||fffd||fffd||fffd|"), "dd/mm/yyyy")
        
        Select Case Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Case "|fffd||fffd||fffd||fffd|"
        |fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        Case "0005", "0011", "0046", "0048", "0054", "0056", "0069" ',|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd|(Range("|fffd||fffd||fffd||fffd|"))
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        Case Else
        |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd|(Range("|fffd||fffd||fffd||fffd|"))
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        End Select
  
If Range("|fffd||fffd||fffd||fffd|") <= CDate("31.10.2007") Then
 Set Tabl = Db.OpenRecordset("SELECT CURRLIST.ISO_DIG AS |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.* FROM |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN CURRLIST ON |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST.ISO_LAT3 WHERE (|fffd||fffd||fffd||fffd||fffd||fffd|='" & |fffd||fffd||fffd||fffd||fffd||fffd| & "') And (|fffd||fffd||fffd|='" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "') And (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "mm-dd-yyyy") & "#) ORDER BY N, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|;")
ElseIf Range("|fffd||fffd||fffd||fffd|") >= CDate("30.11.2007") Then
 Set Tabl = Db.OpenRecordset("SELECT CURRLIST_a.ISO_DIG AS |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, CURRLIST.ISO_DIG AS |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.* FROM (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN CURRLIST ON |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST.ISO_LAT3) INNER JOIN CURRLIST_a ON |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST_a.ISO_LAT3 WHERE (|fffd||fffd||fffd||fffd||fffd||fffd| Like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "') And (|fffd||fffd||fffd| Like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "') And (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "mm-dd-yyyy") & "#) ORDER BY N, |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd|;")
End If
'//|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| Recordset |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| MS Excel
'----------------------------------------------
'Dim NewBook As Workbook
'Dim j As Integer
'Set NewBook = Workbooks.Add

'For j = 0 To Tabl.Fields.Count - 1
'   NewBook.Sheets(1).Range("A1").Offset(0, j).Value = Tabl.Fields(j).Name
'Next

'NewBook.Sheets(1).Range("A2").CopyFromRecordset Tabl
'----------------------------------------------
  With Tabl
    Do While Not .EOF
    NPP = NPP + 1
    .MoveNext
    Loop
  End With

If MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?" & Chr(10) _
& "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & NPP & " |fffd||fffd||fffd||fffd||fffd|(|fffd|,|fffd||fffd|) |fffd||fffd| " & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Trim(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) & " |fffd||fffd| |fffd||fffd||fffd||fffd| " & Range("|fffd||fffd||fffd||fffd|"), vbOKCancel + vbExclamation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!") = vbCancel Then GoTo Exi_F
DATA_XLS.ClearContents
  
  Set oInd = New TProgressPercent
  With oInd
    .Message = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|"
    .Max = NPP
  End With
 
NPP = 1

If Tabl.RecordCount > 0 Then Tabl.MoveFirst
'Worksheets("|fffd||fffd||fffd||fffd|1").Range("A1").CopyFromRecordset Tabl
Do While Not Tabl.EOF
    
    nInd = nInd + 1
    oInd.Show nInd

 'For Each i In L_XLS.Range("a109:av109") '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
 ' RecSetValue = Tabl.Fields(Cells(109, i.Column).Value)
 ' DATA_XLS.Cells(NPP, i.Column).Value = RecSetValue
 'Next i

 For Each i In L_XLS.Range("a109:ar109") '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  If Cells(109, i.Column).Value = "|fffd||fffd||fffd|" Then
   RecSetValue = Tabl.Fields("|fffd||fffd||fffd|") & "/" & Tabl.Fields("|fffd||fffd||fffd||fffd||fffd||fffd|")
  Else
   RecSetValue = Tabl.Fields(Cells(109, i.Column).Value)
  End If
  DATA_XLS.Cells(NPP, i.Column).Value = RecSetValue
 Next i



Tabl.MoveNext
NPP = NPP + 1
Loop

L_XLS.Cells(109 + NPP, 1) = "|fffd||fffd||fffd||fffd||fffd|"

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd||fffd|"
Exit Sub

Exi_F:
  Set Db = Nothing
  Set Tabl = Nothing
  Set L_XLS = Nothing
  Set oInd = Nothing
  Exit Sub
Err_F:
 If Err.Number = 3265 Then
    RecSetValue = ""
    Resume Next
 Else
  MsgBox Err.Description, vbCritical
  Resume Exi_F
 End If
End Sub

Public Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Dim AccApp As Object, Db As Object, Tabl, Tabl_Temp As Object, i As Long, strSQL As String
Dim fileAc, in_xls As Worksheet, nLastRow As Long, NPP As Long, what_to_do As Integer
Dim oInd As TProgressPercent, nInd As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Date, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As String, |fffd||fffd||fffd||fffd||fffd||fffd| As String
Dim qwr, isp As Object, n_fields As Integer

fileAc = ActiveSheet.Range("j105").Value

 Dim stDocName As String

    'stDocName = "|fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|"
    stDocName = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    stDocName_Temp = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Temp"
    
If IsEmpty(fileAc) Then
fileAc = Application.GetOpenFilename("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Access (*.mdb; *.mde), *.md*")
End If

If fileAc = False Then GoTo Exi_F

ActiveSheet.Range("j105").Value = fileAc

Set Db = OpenDatabase(fileAc)
Set Tabl = Db.OpenRecordset(stDocName)
Set Tabl_Temp = Db.OpenRecordset(stDocName_Temp)
Set in_xls = Worksheets("|fffd||fffd||fffd||fffd||fffd|")
With in_xls
nLastRow = Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), .Cells(12500, 1)), 0) - 1
End With
    
    NPP = 0
    
  
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.Text(Range("|fffd||fffd||fffd||fffd|"), "dd/mm/yyyy")
        Select Case Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        Case "|fffd||fffd||fffd||fffd|"
        |fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        Case "0005", "0011", "0046", "0048", "0054", "0056", "0069" ',|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd|(Range("|fffd||fffd||fffd||fffd|"))
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "*"
        Case Else
        |fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd|(Range("|fffd||fffd||fffd||fffd|"))
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        End Select
        
  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...|fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...
  '//------------------------------------------------------------------------
     strSQL = "DELETE * FROM " & stDocName_Temp & ";"
     Db.Execute (strSQL)
  '//------------------------------------------------------------------------
  
  With Tabl
    
strSQL = "select * from " & stDocName & " where |fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Set isp = Db.OpenRecordset(strSQL)
If isp.RecordCount > 0 Then isp.MoveLast
NPP = isp.RecordCount
    
    'Do While Not .EOF
    'If .Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = |fffd||fffd||fffd||fffd||fffd||fffd||fffd| And Trim(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd|")) Like |fffd||fffd||fffd||fffd||fffd||fffd| And Trim(.Fields("|fffd||fffd||fffd|")) Like |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Then
    'NPP = NPP + 1
    'End If
    '.MoveNext
    'Loop
    
        If NPP <> 0 Then
        what_to_do = MsgBox("|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & NPP & " |fffd||fffd||fffd||fffd||fffd|(|fffd|,|fffd||fffd|) |fffd||fffd| " & Chr(10) _
        & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Trim(Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value) & " |fffd||fffd| |fffd||fffd||fffd||fffd| " & Range("|fffd||fffd||fffd||fffd|") & Chr(10) _
        & "|fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| " & nLastRow - 109 & " |fffd||fffd||fffd||fffd||fffd|(|fffd|,|fffd|,|fffd||fffd|)." & Chr(10) _
        & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| " & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd|", vbYesNoCancel + vbExclamation, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!")
        Else
        what_to_do = 7
        End If

        If what_to_do = 6 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        If .RecordCount > 0 Then
        Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|"
        strSQL = "DELETE * FROM " & stDocName & " WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
        Db.Execute strSQL, dbFailOnError
        End If
'            If .RecordCount > 0 Then .MoveFirst
            
'            Do While Not .EOF
'            If .Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = |fffd||fffd||fffd||fffd||fffd||fffd||fffd| And Trim(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd|")) Like |fffd||fffd||fffd||fffd||fffd||fffd| And Trim(.Fields("|fffd||fffd||fffd|")) Like |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| _
'             Then
'            .Delete
'            End If
'            .MoveNext
'            Loop
        
        ElseIf what_to_do = 7 Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        Else '|fffd||fffd||fffd||fffd||fffd||fffd|
        GoTo Exi_F
        End If

  End With

  
  Set oInd = New TProgressPercent
  With oInd
    .Message = "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|"
    .Min = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    .Max = nLastRow
  End With
  

For i = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| To nLastRow

    nInd = nInd + 1
    oInd.Show nInd
  
'If AddRowInAccess(Tabl, Range(in_xls.Cells(i, 1), in_xls.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)), i) = False Then  'Cells(i, 1).Interior.ColorIndex = 26
If AddRowInAccess(Tabl_Temp, Range(in_xls.Cells(i, 1), in_xls.Cells(i, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)), i) = False Then  'Cells(i, 1).Interior.ColorIndex = 26
End If

Next i

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...1%"

'strSQL = "UPDATE |fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN " & stDocName & " ON |fffd||fffd||fffd||fffd||fffd||fffd|.N_FIL = " & stDocName & ".|fffd||fffd||fffd| SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd| = [|fffd||fffd||fffd||fffd||fffd||fffd|]![Region] where isnull(|fffd||fffd||fffd||fffd||fffd||fffd|) "
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE |fffd||fffd||fffd||fffd||fffd||fffd| INNER JOIN " & stDocName_Temp & " ON |fffd||fffd||fffd||fffd||fffd||fffd|.N_FIL = " & stDocName_Temp & ".|fffd||fffd||fffd| SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd| = [|fffd||fffd||fffd||fffd||fffd||fffd|]![Region] where isnull(|fffd||fffd||fffd||fffd||fffd||fffd|) "
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...13%"

'strSQL = "UPDATE " & stDocName & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...17%"

'strSQL = "UPDATE " & stDocName & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...20%"

'strSQL = "UPDATE " & stDocName & " SET [|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|] = 0 WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET [|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|] = 0 WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and IsNull([|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...23%"

'strSQL = "SELECT * FROM " & stDocName & " WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
strSQL = "SELECT * FROM " & stDocName_Temp & " WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Set qwr = Db.OpenRecordset(strSQL)
If qwr.RecordCount > 0 Then
 With qwr
  .MoveFirst
  Do While Not .EOF()
  .Edit
  .Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = IIf((IsNull(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)) Or (IsEmpty(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)), Null, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(CStr(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)))
  .Update
  .MoveNext
  Loop
 End With
 With qwr
  .MoveFirst
  Do While Not .EOF()
  .Edit
  .Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = IIf((IsNull(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)) Or (IsEmpty(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)), Null, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(CStr(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)))
  .Update
  .Edit
  .Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = IIf((IsNull(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)) Or (IsEmpty(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)), Null, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2(CStr(.Fields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value)))
  .Update
  .MoveNext
  Loop
 End With
End If

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...25%"

'strSQL = "UPDATE " & stDocName & " SET |fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and IsNull([|fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET |fffd||fffd||fffd||fffd||fffd||fffd| = 0 WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and IsNull([|fffd||fffd||fffd||fffd||fffd||fffd|])<>False  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError


Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...30%"

'strSQL = "UPDATE " & stDocName & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|= '|fffd||fffd|' WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ='|fffd||fffd|'  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

'strSQL = "UPDATE " & stDocName_Temp & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|= '|fffd||fffd|' WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ='|fffd||fffd|'  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError


Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...35%"

'strSQL = "UPDATE " & stDocName & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd|= '|fffd|' WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and len(trim(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|))=0  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

'strSQL = "UPDATE " & stDocName_Temp & " SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd|= '|fffd|' WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and len(trim(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|))=0  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...40%"

'strSQL = "UPDATE " & stDocName & " INNER JOIN CURRLIST ON " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST.ISO_DIG SET |fffd||fffd||fffd||fffd||fffd||fffd| = [currlist].[ISO_LAT3] where  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "#  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " INNER JOIN CURRLIST ON " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST.ISO_DIG SET |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = [currlist].[ISO_LAT3] where  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "#  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " INNER JOIN CURRLIST ON " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd| = CURRLIST.ISO_DIG SET |fffd||fffd||fffd||fffd||fffd||fffd| = [currlist].[ISO_LAT3] where  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "#  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

'strSQL = "UPDATE " & stDocName & " SET  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Null WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Is Not Null AND |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=0  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Null WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| Is Not Null AND |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=0  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...45%"

'strSQL = "UPDATE " & stDocName & " SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd| =" & "'RUR'" & _
'" WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and (((" & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd|) Like 'RUS'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd| =" & "'RUR'" & _
" WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and (((" & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd|) Like 'RUS')) and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

'strSQL = "UPDATE " & stDocName & " SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| =" & "1" & _
'" WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and (((" & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd|) Like 'RUR'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL, dbFailOnError

strSQL = "UPDATE " & stDocName_Temp & " SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| =" & "1" & _
" WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and (((" & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd|) Like 'RUR'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL, dbFailOnError

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...50%"

'strSQL = "select * from KursCB where KursCB.dat=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "#"
'Set isp = Db.OpenRecordset(strSQL)

'For n_fields = 1 To isp.Fields.Count - 1
'strSQL = "UPDATE " & stDocName & " SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.Fields(n_fields).Value & _
'"' WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd| Like '" & isp.Fields(n_fields).Name & "'  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL
'Next n_fields

strSQL = "select * from KursCB where KursCB.dat=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "#"
Set isp = Db.OpenRecordset(strSQL)

For n_fields = 1 To isp.Fields.Count - 1
strSQL = "UPDATE " & stDocName_Temp & " SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.Fields(n_fields).Value & _
"' WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd| Like '" & isp.Fields(n_fields).Name & "'  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL
Next n_fields

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...75%"

'Set isp = Db.OpenRecordset("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2_6")
'isp.MoveFirst
'Do While Not isp.EOF()
'strSQL = "UPDATE " & stDocName & " SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd| & _
'"'where  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  ((lcase(" & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)  Like '" & LCase(isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) & "'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL
'isp.MoveNext
'Loop

'Set isp = Db.OpenRecordset("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2_6")
'isp.MoveFirst
'Do While Not isp.EOF()
'strSQL = "UPDATE " & stDocName_Temp & " SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd| & _
'"'where  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and  ((lcase(" & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)  Like '" & LCase(isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) & "'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL
'isp.MoveNext
'Loop

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|...85%"

'Set isp = Db.OpenRecordset("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2_6")
'isp.MoveFirst
'Do While Not isp.EOF()
'strSQL = "UPDATE " & stDocName & " SET " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & _
'"' WHERE  " & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and ((lcase(" & stDocName & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Like '" & LCase(isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) & "'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
'Db.Execute strSQL
'isp.MoveNext
'Loop

Set isp = Db.OpenRecordset("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2_6")
isp.MoveFirst
Do While Not isp.EOF()
strSQL = "UPDATE " & stDocName_Temp & " SET " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = '" & isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & _
"' WHERE  " & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd|=#" & Format(|fffd||fffd||fffd||fffd||fffd||fffd||fffd|, "MM-DD-YYYY") & "# and ((lcase(" & stDocName_Temp & ".|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Like '" & LCase(isp.|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) & "'))  and [|fffd||fffd||fffd||fffd||fffd||fffd|] like '" & |fffd||fffd||fffd||fffd||fffd||fffd| & "' and |fffd||fffd||fffd| like '" & |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| & "';"
Db.Execute strSQL
isp.MoveNext
Loop

strSQL = "INSERT INTO " & stDocName & " SELECT * FROM " & stDocName_Temp & ";"
Db.Execute (strSQL)

strSQL = "DELETE * FROM " & stDocName_Temp & ";"
Db.Execute (strSQL)

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..100%"

MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd||fffd|"
Exit Sub
Exi_F:
  Set Db = Nothing
  Set Tabl = Nothing
  Set Tabl_Temp = Nothing
  Set in_xls = Nothing
  Set oInd = Nothing
  Set isp = Nothing
  Exit Sub
Err_F:
  
  MsgBox Err.Description, vbCritical
  Resume Exi_F
End Sub

Function AddRowInAccess(rstTemp As Recordset, stroka As Variant, NPP As Long) As Boolean
'On Error GoTo stroka
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Recordset, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|,
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
    
 With rstTemp
  .AddNew
        
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Range("|fffd||fffd||fffd||fffd|").Value
   !n = NPP - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1
   !|fffd||fffd||fffd| = UCase(Mid(stroka(2), 1, InStr(1, stroka(2), "/") - 1))
   !|fffd||fffd||fffd||fffd||fffd||fffd| = UCase(Mid(stroka(2), InStr(1, stroka(2), "/") + 1, 4))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(3)
   !|fffd||fffd||fffd| = stroka(4)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(5)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(Len(stroka(6)) = 0, " ", stroka(6))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(7)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(8)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(9)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(10)), stroka(11), stroka(10))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(11)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(12)
   !|fffd||fffd||fffd||fffd||fffd||fffd| = stroka(13)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(14)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(15)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(16)), 0, stroka(16))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(17)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(18)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = UCase(stroka(19))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Trim(stroka(20)) & " "
   !|fffd||fffd||fffd||fffd||fffd||fffd| = stroka(21)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(22)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(23)
   !|fffd||fffd||fffd||fffd||fffd||fffd| = stroka(24)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(25)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(26)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(27)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(28)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Trim(stroka(29)) & " "
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(30)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(31)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(Len(Trim(CStr(stroka(32)))) = 0, 0, stroka(32))
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(33)
   !|fffd||fffd||fffd||fffd||fffd||fffd| = stroka(34)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(35)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(36)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(37)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(38)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(39)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(40)
   !|fffd||fffd||fffd||fffd||fffd| = stroka(41)
   !|fffd||fffd||fffd| = stroka(42)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = stroka(43)
   !|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = IIf(IsEmpty(stroka(44)), 0, stroka(44))
  
  .Update
 .Bookmark = .LastModified
 End With

AddRowInAccess = True
Exit Function
stroka:
MsgBox Err.Description & " C|fffd||fffd||fffd||fffd||fffd| |fffd|" & NPP & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
AddRowInAccess = False
End Function
Public Sub |fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd|()
Dim theFilter As String, file_old As Variant, old_xls As Object, np_news As Double, i As Integer

theFilter = "|fffd||fffd||fffd||fffd||fffd| Excel (*.xls),*.xls,|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (*.*),*.*"
file_old = Application.GetOpenFilename(theFilter, 1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| ")

If file_old = False Then Exit Sub
         Workbooks.Open FileName:=file_old, updatelinks:=False, ReadOnly:=True
    
Set file_old = ActiveWorkbook

file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Select

With file_old
 With .Worksheets("|fffd||fffd||fffd||fffd||fffd|")
  If (IsError(Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), Cells(12500, 1)), 0))) Then
   MsgBox "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)"
   file_old.Close savechanges:=False
   Exit Sub
  End If
 End With
End With

Set old_xls = file_old.Sheets("|fffd||fffd||fffd||fffd||fffd|").Range(Cells(110, 1), Cells(Application.Match("|fffd||fffd||fffd||fffd||fffd|", Range("a1:a12500"), 0) - 1, 44))

ThisWorkbook.Activate
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Select
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range(Cells(110, 1), Cells(12500, 44)).ClearContents

With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|")
.Unprotect
.Cells(110, 1).Activate
  If (.Comments.Count > 0) Then .Range(.Cells(110, 1), .Cells(12500, 44)).ClearComments
  Range(.Cells(110, 1), .Cells(12500, 44)).Interior.ColorIndex = xlNone
.Protect
End With

np_news = 1

  Dim oInd As TProgressPercent, nInd As Long

  Set oInd = New TProgressPercent
  With oInd
    .Message = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    .Max = old_xls.Rows.Count
  End With

For i = 1 To old_xls.Rows.Count
 nInd = nInd + 1
 oInd.Show nInd
  
  If UCase(old_xls.Cells(i, 1)) = "|fffd||fffd||fffd||fffd||fffd|" Then
   Exit For
  End If
   
   If AddRowInExcel(np_news + 109, Range(old_xls.Cells(i, 1), old_xls.Cells(i, 44))) Then
    np_news = np_news + 1
   End If

Next i

Cells(np_news + 109, 1) = "|fffd||fffd||fffd||fffd||fffd|"
Range("|fffd||fffd||fffd||fffd|").Value = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Value = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd|") = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd|")
Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = file_old.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

MsgBox "       |fffd||fffd||fffd||fffd||fffd||fffd|..."

file_old.Close savechanges:=False


End Sub

Function AddRowInExcel(np_new, stroka As Variant)

On Error GoTo stroka

Cells(np_new, Application.Match("N", Range("a109:ar109"), 0)).Value = stroka(1)
Cells(np_new, Application.Match("|fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = UCase(stroka(2))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(3)
Cells(np_new, Application.Match("|fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(4)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(5)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(6)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(7)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(8)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(9)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(10)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(11)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(12)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(13)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(14)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(15)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(16)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(17)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(18)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = UCase(stroka(19))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(20))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(21)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(22)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(23)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(24)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(25)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(26)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(27)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(28)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(29))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(30))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(31))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(32))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(33)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(34)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(35)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(36)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = Trim(stroka(37))
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(38)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(39)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(40)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(41)
Cells(np_new, Application.Match("|fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(42)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(43)
Cells(np_new, Application.Match("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", Range("a109:ar109"), 0)).Value = stroka(44)

AddRowInExcel = True
Exit Function
stroka:
MsgBox Err.Description & " C|fffd||fffd||fffd||fffd||fffd| |fffd|" & np_new & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", vbCritical
AddRowInExcel = False

End Function

Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Ndog As String) As String
Dim q1 As String
Dim q2 As Long
Dim q4 As String
Dim q5 As String
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long

q1 = CStr(Trim(Ndog))
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, " ")
Do While |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0
q2 = Len(q1)
q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, q2)
q1 = q4 & q5
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, " ")
Loop
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = q1
End Function
Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(naim As String) As String
Dim q1 As String
Dim q2 As Long
Dim q4 As String
Dim q5 As String
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 As Long
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 As Long


q1 = CStr(Trim(naim))

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, """")
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 = InStr(1, q1, "'")
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 = InStr(1, q1, "`")

Do While (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0) Or (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 <> 0) Or (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 <> 0)
 If |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> 0 Then
    q2 = Len(q1)
    q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1)
    q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, q2)
    q1 = q4 & q5
    |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InStr(1, q1, """")
 ElseIf |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 <> 0 Then
        q2 = Len(q1)
        q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 - 1)
        q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 + 1, q2)
        q1 = q4 & q5
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_1 = InStr(1, q1, "'")
 ElseIf |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 <> 0 Then
        q2 = Len(q1)
        q4 = Mid(q1, 1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 - 1)
        q5 = Mid(q1, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 + 1, q2)
        q1 = q4 & q5
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_2 = InStr(1, q1, "`")
 End If
Loop
|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = q1
End Function
Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2(naim As String) As String
Dim q, q1, q2 As String
'Dim q2 As Long
'Dim q4 As String
'Dim q5 As String
Dim p_OAO, p_ZAO, p_OOO, p_OOO_2, p_SPK, p_PSK, p_PK, p_KFX, p_KX, p_FX As Long
Dim p_GUP, p_MUP, p_MP, p_FGUP, p_FGUSP As Long

q1 = UCase(CStr(Trim(naim)))
q2 = CStr(Trim(naim))

p_OAO = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_OAO_2 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '29
p_OAO_3 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '28
p_OAO_4 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '29

p_ZAO = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_ZAO_2 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '29
p_ZAO_3 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '29

p_OOO = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_OOO_2 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_OOO_3 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_4 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_5 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_6 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_7 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_8 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '37
p_OOO_9 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_10 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_11 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '43
p_OOO_12 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_13 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_14 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_15 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_16 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_17 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_18 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_19 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_20 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_21 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_22 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_23 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_24 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_25 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_26 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_27 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '54
p_OOO_28 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_29 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_30 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_31 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_32 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_33 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_34 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_35 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_36 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_37 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_38 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_39 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_40 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '38
p_OOO_41 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_42 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_43 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '40
p_OOO_44 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '41
p_OOO_45 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_46 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_47 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39
p_OOO_48 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '39


p_SPK = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_SPK_2 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '47
p_SPK_3 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '48
p_SPK_4 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '47
p_SPK_5 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '47
p_SPK_6 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '47
p_SPK_7 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '47
p_SPK_8 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '50

p_PSK = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_PK = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

p_KFX = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '35
p_KFX_2 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '32
p_KFX_3 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '33
p_KFX_4 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '34
p_KFX_5 = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") '33

p_KX = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_FX = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_GUP = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_MUP = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_MP = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_FGUP = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_FGUSP = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
p_PBOUL = InStr(1, q1, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|")

 If p_OAO = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
 ElseIf p_OAO_2 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
 ElseIf p_OAO_3 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 29, Len(q2) - 28)
 ElseIf p_OAO_4 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
    
 
 ElseIf p_ZAO = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
 ElseIf p_ZAO_2 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
 ElseIf p_ZAO_3 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
 ElseIf p_ZAO_4 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 30, Len(q2) - 29)
    
    
 ElseIf p_OOO = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_2 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_3 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_4 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_5 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_6 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_7 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_8 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 38, Len(q2) - 37)
 ElseIf p_OOO_9 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_10 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_11 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 44, Len(q2) - 43)
 ElseIf p_OOO_12 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_13 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_14 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_15 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_16 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_17 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_18 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_19 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_20 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_21 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_22 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_23 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_24 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_25 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_26 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_27 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 55, Len(q2) - 54)
 ElseIf p_OOO_28 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_29 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_30 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_31 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_32 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_33 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_34 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_35 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_36 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_37 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_38 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_39 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_40 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 39, Len(q2) - 38)
 ElseIf p_OOO_41 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_42 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_43 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 41, Len(q2) - 40)
 ElseIf p_OOO_44 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 42, Len(q2) - 41)
 ElseIf p_OOO_45 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_46 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_47 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
 ElseIf p_OOO_48 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 40, Len(q2) - 39)
        
    
 ElseIf p_SPK = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_SPK_2 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 48, Len(q2) - 47)
 ElseIf p_SPK_3 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_SPK_4 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 48, Len(q2) - 47)
 ElseIf p_SPK_5 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_SPK_6 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_SPK_7 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_SPK_8 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 51, Len(q2) - 50)
    
 
 ElseIf p_PSK = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 49, Len(q2) - 48)
 ElseIf p_PK = 1 Then
    q = "|fffd||fffd|" & Mid(q2, 28, Len(q2) - 27)
    
    
 ElseIf p_KFX = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 36, Len(q2) - 35)
 ElseIf p_KFX_2 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 33, Len(q2) - 32)
 ElseIf p_KFX_3 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 34, Len(q2) - 33)
 ElseIf p_KFX_4 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 35, Len(q2) - 34)
 ElseIf p_KFX_5 = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 34, Len(q2) - 33)
    
    
 ElseIf p_KX = 1 Then
    q = "|fffd||fffd|" & Mid(q2, 23, Len(q2) - 22)
    
    
    
 ElseIf p_FX = 1 Then
    q = "|fffd||fffd|" & Mid(q2, 21, Len(q2) - 20)
 ElseIf p_GUP = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 38, Len(q2) - 37)
 ElseIf p_MUP = 1 Then
    q = "|fffd||fffd||fffd|" & Mid(q2, 36, Len(q2) - 35)
 ElseIf p_MP = 1 Then
    q = "|fffd||fffd|" & Mid(q2, 26, Len(q2) - 25)
 ElseIf p_FGUP = 1 Then
    q = "|fffd||fffd||fffd||fffd|" & Mid(q2, 50, Len(q2) - 49)
 ElseIf p_FGUSP = 1 Then
    q = "|fffd||fffd||fffd||fffd||fffd|" & Mid(q2, 71, Len(q2) - 70)
 ElseIf p_PBOUL = 1 Then
    q = "|fffd||fffd||fffd||fffd||fffd|" & Mid(q2, 50, Len(q2) - 49)
 Else
    q = q2
 End If
 
 If Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 2) = "|fffd||fffd|" Then
  If Right(Mid(q, 1, 3), 1) <> " " Then
   q = "|fffd||fffd| " & Mid(q, 3, Len(q) - 2)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 2) = "|fffd||fffd|" Then
  If Right(Mid(q, 1, 3), 1) <> " " Then
   q = "|fffd||fffd| " & Mid(q, 3, Len(q) - 2)
  End If
 ElseIf Mid(q, 1, 2) = "|fffd||fffd|" Then
  If Right(Mid(q, 1, 3), 1) <> " " Then
   q = "|fffd||fffd| " & Mid(q, 3, Len(q) - 2)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 3) = "|fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 4), 1) <> " " Then
   q = "|fffd||fffd||fffd| " & Mid(q, 4, Len(q) - 3)
  End If
 ElseIf Mid(q, 1, 2) = "|fffd||fffd|" Then
  If Right(Mid(q, 1, 3), 1) <> " " Then
   q = "|fffd||fffd| " & Mid(q, 3, Len(q) - 2)
  End If
 ElseIf Mid(q, 1, 4) = "|fffd||fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 5), 1) <> " " Then
   q = "|fffd||fffd||fffd||fffd| " & Mid(q, 5, Len(q) - 4)
  End If
 ElseIf Mid(q, 1, 5) = "|fffd||fffd||fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 6), 1) <> " " Then
   q = "|fffd||fffd||fffd||fffd||fffd| " & Mid(q, 6, Len(q) - 5)
  End If
 ElseIf Mid(q, 1, 5) = "|fffd||fffd||fffd||fffd||fffd|" Then
  If Right(Mid(q, 1, 6), 1) <> " " Then
   q = "|fffd||fffd||fffd||fffd||fffd| " & Mid(q, 6, Len(q) - 5)
  End If
 End If

|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2 = q

'If IsNull(q) Or IsEmpty(q) Then Stop

End Function

Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Option Explicit
Public USD As Range, EUR As Range, DEM As Double
Public DiapName As Range
Public Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  As Long = 44
Public Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 109
Public Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 15000
Public Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 110
Public Const ErrColor = 3
Public oRow As Range, oCell As Range
Public nErr As Long
Public oRowOtr As Range, vOtr As Variant
Sub StartCheck()
'On Error GoTo Err_F
'On Error Resume Next |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Unprotect
  Check
ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd|").Protect
Exi_F:
  Exit Sub
Err_F:
  MsgBox Err.Description, vbCritical
  Resume Exi_F
End Sub
Public Function Check() As Boolean
Application.ScreenUpdating = False

Check = False: 'On Error GoTo Err_F
  'Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  As Long = 28
  'Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 2500
  'Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 109
  'Const |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Long = 110
  'Const ErrColor = 3
  Const ErrSameDog = 6
  Const ErrINN = 7
  
  Dim dDat As Date, oWrk As Range, nLastRow As Long, i As Long, j As Long, q, p, z As Long
  Dim aFormat() As String
  Dim oInd As TProgressPercent, nInd As Long
  Dim sTmp, qsTmp, psTmp, zsTmp As String, bFound, qbFound, pbFound, zbFound As Boolean
  Dim aRow() As Long, aDog() As String, Ndog As String
  Dim aRowINN(), cRowINN(), bRowINN(), zRowINN() As Long, aOKVED() As String, aGRPCLNT() As String
  Dim aZNam() As String, cQuality() As String, cFinPol() As String
  Dim bCRSP() As String, zSegment_1(), zSegment_2(), zGrpZaem() As String
  Dim aINN(), cINN(), bINN(), dINN() As String, nINN, qINN, pINN, zINN As Long
  Dim rCommentZaemshik, rCommentOtrasl, rCommentKatKredRiska, rCommentRiskGrp, rCommentFinPol As Comment
  'Dim oRowOtr As Range, vOtr As Variant

  
  Dim Sum_pr As Double, Sum_sr As Double, Sum_rrez, Sum_rez As Double, Sum_prolong As Double
  Dim n_DayEnd As Integer, n_DayPr_o As Integer
  'Dim pr_1_1 As Double, pr_1_2 As Double, pr_1_3 As Double, pr_1_4 As Double
  'Dim pr_2_1 As Double, pr_2_2 As Double, pr_2_3 As Double, pr_2_4 As Double
  'Dim pr_3_1 As Double, pr_3_2 As Double, pr_3_3 As Double, pr_3_4 As Double
  'Dim pr_4_1 As Double, pr_4_2 As Double, pr_4_3 As Double, pr_4_4 As Double
  'Dim pr_5_1 As Double, pr_5_2 As Double, pr_5_3 As Double, pr_5_4 As Double
  'Dim sr_1_1 As Double, sr_1_2 As Double, sr_1_3 As Double, sr_1_4 As Double, sr_1_5 As Double, sr_1_6 As Double, sr_1_7 As Double, sr_1_8 As Double
  'Dim sr_2_1 As Double, sr_2_2 As Double, sr_2_3 As Double, sr_2_4 As Double, sr_2_5 As Double, sr_2_6 As Double, sr_2_7 As Double, sr_2_8 As Double
  'Dim sr_3_1 As Double, sr_3_2 As Double, sr_3_3 As Double, sr_3_4 As Double, sr_3_5 As Double, sr_3_6 As Double, sr_3_7 As Double, sr_3_8 As Double
  'Dim sr_4_1 As Double, sr_4_2 As Double, sr_4_3 As Double, sr_4_4 As Double, sr_4_5 As Double, sr_4_6 As Double, sr_4_7 As Double, sr_4_8 As Double
  'Dim sr_5_1 As Double, sr_5_2 As Double, sr_5_3 As Double, sr_5_4 As Double, sr_5_5 As Double, sr_5_6 As Double, sr_5_7 As Double, sr_5_8 As Double
  'Dim rz_1_1 As Double, rz_1_2 As Double, rz_1_3 As Double, rz_1_4 As Double, rz_1_5 As Double, rz_1_6 As Double, rz_1_7 As Double, rz_1_8 As Double
  'Dim rz_2_1 As Double, rz_2_2 As Double, rz_2_3 As Double, rz_2_4 As Double, rz_2_5 As Double, rz_2_6 As Double, rz_2_7 As Double, rz_2_8 As Double
  'Dim rz_3_1 As Double, rz_3_2 As Double, rz_3_3 As Double, rz_3_4 As Double, rz_3_5 As Double, rz_3_6 As Double, rz_3_7 As Double, rz_3_8 As Double
  'Dim rz_4_1 As Double, rz_4_2 As Double, rz_4_3 As Double, rz_4_4 As Double, rz_4_5 As Double, rz_4_6 As Double, rz_4_7 As Double, rz_4_8 As Double
  'Dim rz_5_1 As Double, rz_5_2 As Double, rz_5_3 As Double, rz_5_4 As Double, rz_5_5 As Double, rz_5_6 As Double, rz_5_7 As Double, rz_5_8 As Double
  Dim pr_1 As Double, pr_2 As Double, pr_3 As Double, pr_4 As Double, pr_5 As Double
  Dim sr_1 As Double, sr_2 As Double, sr_3 As Double, sr_4 As Double, sr_5 As Double
  Dim rrez_1 As Double, rrez_2 As Double, rrez_3 As Double, rrez_4 As Double, rrez_5 As Double
  Dim rez_1 As Double, rez_2 As Double, rez_3 As Double, rez_4 As Double, rez_5 As Double
  Dim prolong_1 As Double, prolong_2 As Double, prolong_3 As Double, prolong_4 As Double, prolong_5 As Double
  Dim col_dog As Integer, col_pr As Integer
  
  nErr = 0
  col_dog = 0
  col_pr = 0
     

     
ActiveSheet.Unprotect
  '//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
  With ThisWorkbook
  
  Dim Bal_sh(10) As Double
  Dim str_sch As Long, sch As Long
  
  With .Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
  
  .Select
  .Cells.Delete
  str_sch = 2
  .Cells(1, 20).Value = "|fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  .Cells(1, 21).Value = "|fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  .Cells(1, 22).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  .Cells(1, 23).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  .Cells(1, 24).Value = "|fffd||fffd||fffd|"
  .Cells(1, 25).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
  .Cells(1, 26).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
  
  End With

  
    With .Sheets("|fffd||fffd||fffd||fffd||fffd|")
      .Activate
      If (IsError(Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(.Cells(1, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1)), 0))) Then Err.Raise vbError + 1, , "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)"
      nLastRow = Application.Match("|fffd||fffd||fffd||fffd||fffd|", .Range(Cells(1, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1)), 0) - 1
      
      If (nLastRow = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - 1) Then '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
      .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1).Activate
      If (.Comments.Count > 0) Then .Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).ClearComments
      Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Interior.ColorIndex = xlNone
  
      End If
      If (nLastRow < |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) Then GoTo Exi_F
  
      .PageSetup.PrintArea = Range(Cells(102, 1), Cells(nLastRow, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Address '$A$102:$Z$297"
      
  Set USD = .Range("h105"):  Set EUR = .Range("h106")
      
      Set DiapName = .Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(nLastRow, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))
      ReDim aFormat(1 To |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
      For i = 1 To |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: aFormat(i) = Trim$(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, i)): Next
      Set oWrk = .Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(nLastRow, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|))
      '//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
      If (IsDate(.Range("|fffd||fffd||fffd||fffd|"))) Then
      dDat = Range("|fffd||fffd||fffd||fffd|")
      If (dDat < CVDate("31.07.2001")) Then Err.Raise vbError + 1, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|! |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 31.07.2001"
'        If (Day(dDat) <> (DateAdd("m", 1, dDat) + 1 - dDat)) Then err.Raise vbError + 1, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!" + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
        If Format(dDat, "DDMM") <> "3101" And _
           Format(dDat, "DDMM") <> "2802" And _
           Format(dDat, "DDMM") <> "2902" And _
           Format(dDat, "DDMM") <> "3103" And _
           Format(dDat, "DDMM") <> "3004" And _
           Format(dDat, "DDMM") <> "3105" And _
           Format(dDat, "DDMM") <> "3006" And _
           Format(dDat, "DDMM") <> "3107" And _
           Format(dDat, "DDMM") <> "3108" And _
           Format(dDat, "DDMM") <> "3009" And _
           Format(dDat, "DDMM") <> "3110" And _
           Format(dDat, "DDMM") <> "3011" And _
           Format(dDat, "DDMM") <> "3112" _
        Then Err.Raise vbError + 1, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!" + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
      Else
        Err.Raise vbError + 1, , "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
      End If

Application.StatusBar = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."

      '//|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
       .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1).Activate
      If (.Comments.Count > 0) Then .Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).ClearComments
      Range(.Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 1), .Cells(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Interior.ColorIndex = xlNone
      
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Columns(1).ClearContents
  
    End With
  
  Set oInd = New TProgressPercent
  With oInd
    .Message = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    .Max = oWrk.Rows.Count
  End With
  
  Ndog = -1: nINN = -1: qINN = -1: pINN = -1: zINN = -1

  For Each oRow In oWrk.Rows
    nInd = nInd + 1
    oInd.Show nInd
    
    '//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    With oRow
      sTmp = CStr(Trim$(UCase$(.Cells(1, 2).Value))) + "|" + _
             CStr(Trim$(UCase$(.Cells(1, 4).Value))) + "|" + _
             CStr(Trim$(UCase$(.Cells(1, 6).Value)))
    End With
    bFound = False
    For j = 0 To Ndog
      If (aDog(j) = sTmp) Then
        bFound = True
        With oRow
         .Interior.ColorIndex = ErrSameDog
         .Cells(1, 1).AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd| " + CStr(aRow(j)) + " |fffd||fffd||fffd||fffd||fffd||fffd|!"
        End With
        Range(Cells(aRow(j), 1), Cells(aRow(j), |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)).Interior.ColorIndex = ErrSameDog
        nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(oRow.Row) & " |fffd| " + CStr(aRow(j)) + " |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & " |fffd||fffd||fffd| |fffd| " & Cells(aRow(j), 2).Value
      End If
    Next
    If (Not bFound) Then
      Ndog = Ndog + 1
      ReDim Preserve aDog(0 To Ndog), aRow(0 To Ndog)
      aDog(Ndog) = sTmp
      aRow(Ndog) = oRow.Row
    End If
    
    '//|fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd|
    sTmp = oRow.Cells(1, 4)
    bFound = False
    For j = 0 To nINN
      If (aINN(j) = sTmp) Then
        bFound = True
        If (Trim$(oRow.Cells(1, 3)) <> aZNam(j)) Then
          With oRow.Cells(1, 3)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ": '" + aZNam(j) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = aZNam(j)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Cells(aRowINN(j), 3)
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(aRowINN(j), 3).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ": '" + aZNam(j) + "' " + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value & " |fffd||fffd||fffd| |fffd| " & Cells(oRow.Row, 2).Value ' Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Cells(aRowINN(j), 4)
            End If
          End With
        End If
        If (Trim$(oRow.Cells(1, 41)) <> aOKVED(j)) Then
          With oRow.Cells(1, 41)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ": '" + aZNam(j) + ": '" + aOKVED(j) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = aOKVED(j)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) & " |fffd||fffd||fffd| |fffd| " & Cells(aRowINN(j), 2).Value
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(aRowINN(j), 41).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Cells(aRowINN(j), 3) & " |fffd||fffd||fffd| |fffd| " & Cells(aRowINN(j), 2).Value
            End If
          End With
        End If
        If (Trim$(oRow.Cells(1, 43)) <> aGRPCLNT(j)) Then
          With oRow.Cells(1, 43)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ": '" + aZNam(j) + ": '" + aGRPCLNT(j) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = aOKVED(j)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) & " |fffd||fffd||fffd| |fffd| " & Cells(aRowINN(j), 2).Value
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(aRowINN(j), 43).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + aINN(j) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(aRowINN(j)) + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Cells(aRowINN(j), 3) & " |fffd||fffd||fffd| |fffd| " & Cells(aRowINN(j), 2).Value
            End If
          End With
        End If
      End If
    Next
    If (Not bFound) Then
      nINN = nINN + 1
      ReDim Preserve aINN(0 To nINN), aRowINN(0 To nINN), aZNam(0 To nINN), aOKVED(0 To nINN), aGRPCLNT(0 To nINN)
      aINN(nINN) = sTmp
      aRowINN(nINN) = oRow.Row
      aZNam(nINN) = Trim$(oRow.Cells(1, 3))
      aOKVED(nINN) = Trim$(oRow.Cells(1, 41))
      aGRPCLNT(nINN) = Trim$(oRow.Cells(1, 43))
    End If
    
'//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  If (Left(Trim$(oRow.Cells(1, 37)), 3) <> "|fffd||fffd||fffd|") And _
     (Left(Trim$(oRow.Cells(1, 37)), 4) <> "Z|fffd||fffd||fffd|") Then
  'If (Trim$(oRow.Cells(1, 37)) <> "MB") And (Trim$(oRow.Cells(1, 37)) <> "OV") Then

    qsTmp = oRow.Cells(1, 4)
    qbFound = False
    For q = 0 To qINN
      If (cINN(q) = qsTmp) Then
        qbFound = True
        If (CStr(Trim$(oRow.Cells(1, 33))) <> cQuality(q)) Then
          With oRow.Cells(1, 33)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|: " + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " + CStr(cRowINN(q)) + ": '" + cQuality(q) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " + CStr(oRow.Row) + ": '" + CStr(.Value) + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = cQuality(q)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + _
                          "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + cINN(q) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(cRowINN(q)) + "."
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(cRowINN(q), 33).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(cRowINN(q)) + ": '" + cQuality(q) + "' " + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + CStr(.Value) & "'" + " |fffd||fffd||fffd| |fffd| " & Cells(oRow.Row, 2).Value
            End If
          End With
        End If
        If (CStr(Trim$(oRow.Cells(1, 34))) <> cFinPol(q)) Then
          With oRow.Cells(1, 34)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(cRowINN(q)) + ": '" + cFinPol(q) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + CStr(.Value) + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = cFinPol(q)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + _
                          "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + cINN(q) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(cRowINN(q)) + "."
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(cRowINN(q), 34).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(cRowINN(q)) + ": '" + cFinPol(q) + "' " + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + CStr(.Value) & "'" + " |fffd||fffd||fffd| |fffd| " & Cells(oRow.Row, 2).Value
            End If
          End With
        End If
      End If
    Next
    If (Not qbFound) Then
      qINN = qINN + 1
      ReDim Preserve cINN(0 To qINN), cRowINN(0 To qINN), cQuality(0 To qINN), cFinPol(0 To qINN)
      cINN(qINN) = qsTmp
      cRowINN(qINN) = oRow.Row
      cQuality(qINN) = Trim$(oRow.Cells(1, 33))
      cFinPol(qINN) = Trim$(oRow.Cells(1, 34))
    End If
  End If

'//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  'If (Trim$(oRow.Cells(1, 40)) <> "MB") And (Trim$(oRow.Cells(1, 40)) <> "OV") And _
   (Trim$(oRow.Cells(1, 40)) <> "XMB") And (Trim$(oRow.Cells(1, 40)) <> "XOV") Then
  
   'If (Trim$(oRow.Cells(1, 39)) <> "d") Then
     psTmp = oRow.Cells(1, 4)
     pbFound = False
    For p = 0 To pINN
      If (bINN(p) = psTmp) Then
        pbFound = True
        If (Trim$(oRow.Cells(1, 36)) <> bCRSP(p)) Then
          With oRow.Cells(1, 36)
            If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(bRowINN(p)) + ": '" + bCRSP(p) + "'" + vbCrLf + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value + "'" + vbCrLf + _
                       "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbExclamation + vbYesNo) = vbYes) Then
              .Value = bCRSP(p)
            Else
              .Interior.ColorIndex = ErrINN
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/" + vbCrLf + _
                          "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + bINN(p) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(bRowINN(p)) + "."
              .Comment.Shape.Width = 200
              .Comment.Shape.Height = 60
              With Range(Cells(bRowINN(p), 36).Address)
                .Interior.ColorIndex = ErrINN
              End With
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|:" + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(bRowINN(p)) + ": '" + bCRSP(p) + "' " + _
                       "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(oRow.Row) + ": '" + .Value & "'" + " |fffd||fffd||fffd| |fffd| " & Cells(oRow.Row, 2).Value  ' Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| (" + bINN(p) + ") |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" + CStr(bRowINN(p)) + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " + Cells(bRowINN(p), 4)
            End If
          End With
        End If
      End If
    Next
    If (Not pbFound) Then
      pINN = pINN + 1
      ReDim Preserve bINN(0 To pINN), bRowINN(0 To pINN), bCRSP(0 To pINN)
      bINN(pINN) = psTmp
      bRowINN(pINN) = oRow.Row
      bCRSP(pINN) = Trim$(oRow.Cells(1, 36))
    End If
   'End If
  'End If

'//=====================================================================================================================================
    For Each oCell In oRow.Cells
'      oCell.Select
      
      With oCell
        Select Case aFormat(.Column)
          
          Case "|fffd||fffd||fffd|"
           Call OSB(oCell)
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
          Set rCommentZaemshik = oCell.Comment
          If rCommentZaemshik Is Nothing Then
           Call Zaemshik(oCell)
          End If
          
          Case "|fffd||fffd||fffd||fffd||fffd|"
           'Call okonh(oCell)
          
          Case "|fffd||fffd||fffd||fffd||fffd|"
           Call okved(oCell)

          Case "|fffd||fffd||fffd|"
           Call INN(oCell)
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|":
          .Value = CStr(.Value)
            If (Len(Trim(.Value)) <> 5) Then
             .Interior.ColorIndex = ErrColor
             .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & _
              "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
              ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
              " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            Else
             If (IsError(Application.VLookup(.Value, Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("BALACC"), 1, 0))) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
               nErr = nErr + 1
               Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & _
               "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " " & .Value & _
               ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
               " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
             Else '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
              
             '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| Bal_sh |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               sch = sch + 1
               Bal_sh(1) = .Value                    '|fffd||fffd||fffd||fffd|
               Bal_sh(2) = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               Bal_sh(3) = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               Bal_sh(4) = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)  '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
               Bal_sh(5) = Left(Application.HLookup("|fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 4) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
               Bal_sh(6) = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)  '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

               With Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
                If Not IsEmpty(Bal_sh(1)) Then
                 .Cells(str_sch, 20) = Str(Left(Bal_sh(1), 3))  '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
                 .Cells(str_sch, 21) = Str(Bal_sh(1))  '|fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 22) = Application.Round((Bal_sh(2) - Bal_sh(3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(6)), 2)   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 24) = Bal_sh(5)  'N_|fffd||fffd||fffd|
                 .Cells(str_sch, 25) = Bal_sh(6)  '|fffd||fffd||fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 26) = Bal_sh(4)  '|fffd||fffd||fffd||fffd|
                  str_sch = str_sch + 1
    
                 .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1)), 3))  '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
                 .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1)))  '|fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 22) = Application.Round(((Bal_sh(2) - Bal_sh(3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(4))) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(6)), 2)     ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 24) = Bal_sh(5)  'N_|fffd||fffd||fffd|
                 .Cells(str_sch, 25) = Bal_sh(6)  '|fffd||fffd||fffd||fffd||fffd||fffd|
                 .Cells(str_sch, 26) = Bal_sh(4)  '|fffd||fffd||fffd||fffd|
                  str_sch = str_sch + 1
    
                  If Bal_sh(3) > 0 Then
                   .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1)), 3))  '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
                   .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1)))  '|fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 22) = Application.Round((Bal_sh(3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(6)), 2)   ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 24) = Bal_sh(5)  'N_|fffd||fffd||fffd|
                   .Cells(str_sch, 25) = Bal_sh(6)  '|fffd||fffd||fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 26) = Bal_sh(4)  '|fffd||fffd||fffd||fffd|
                    str_sch = str_sch + 1
        
                   .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1))), 3))  '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|. "458" '
                   .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(1))))  '|fffd||fffd||fffd||fffd| "45818" '
                   .Cells(str_sch, 22) = Application.Round(((Bal_sh(3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(4))) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(6)), 2)    ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 24) = Bal_sh(5)  'N_|fffd||fffd||fffd|
                   .Cells(str_sch, 25) = Bal_sh(6)  '|fffd||fffd||fffd||fffd||fffd||fffd|
                   .Cells(str_sch, 26) = Bal_sh(4)  '|fffd||fffd||fffd||fffd|
                    str_sch = str_sch + 1
                  End If
                 End If
                End With
                
                If (((UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") And _
                     (UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|")) And _
                     (Mid(.Value, 4, 2) = "01")) Or _
                   (((UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = "|fffd||fffd|") Or _
                     (UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = "|fffd||fffd|")) And _
                     (Mid(.Value, 4, 2) <> "01")) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "(1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|! "
                  .Comment.Shape.Width = 200
                  .Comment.Shape.Height = 50
                   nErr = nErr + 1
                   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                ElseIf (Left(.Value, 3) = "458") And _
                       (Val(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) - Val(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) > 0 Then
                      .Interior.ColorIndex = ErrColor
                      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|! "
                      .Comment.Shape.Width = 200
                      .Comment.Shape.Height = 50
                       nErr = nErr + 1
                       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                ElseIf (UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = "|fffd||fffd|" And Left(.Value, 3) <> "320") Or _
                       (UCase(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|" And Left(.Value, 3) = "320") Then
                      .Interior.ColorIndex = ErrColor
                      .AddComment "(2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|! "
                      .Comment.Shape.Width = 200
                      .Comment.Shape.Height = 50
                       nErr = nErr + 1
                       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                End If
             End If
            End If
       
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":
          .Value = CStr(.Value)
            If (Len(Trim(.Value)) = 0) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call Reglament(oCell)
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|":
            If (IsDate(.Value)) Then
             .Value = CDate(.Value)
              If (.Value > Range("|fffd||fffd||fffd||fffd|")) Then
                 .Interior.ColorIndex = ErrColor
                 .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
                  nErr = nErr + 1
                  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (.Value < CVDate("01.01.1992")) Then
                      .Interior.ColorIndex = ErrColor
                      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                      nErr = nErr + 1
                      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If

          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call DataVid(oCell)
           
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|":
            
          If Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0 Then
            .Value = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)
          End If

            If (IsDate(.Value)) Then
             .Value = CDate(.Value)
              If (.Value > Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                   nErr = nErr + 1
                   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
              ElseIf (.Value <> Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = 0 Then
                      .Interior.ColorIndex = ErrColor
                      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd|. |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                      nErr = nErr + 1
                      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (.Value = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 0 Then
                      .Interior.ColorIndex = ErrColor
                      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd|. |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                      nErr = nErr + 1
                      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If


          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
          n_DayEnd = 0
            If (IsDate(.Value)) Then
             .Value = CDate(.Value)
               If (.Value < Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                   .Interior.ColorIndex = ErrColor
                   .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                    nErr = nErr + 1
                    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
               ElseIf (.Value < Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                       .Interior.ColorIndex = ErrColor
                       .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                       nErr = nErr + 1
                       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
               ElseIf ((.Value <= Range("|fffd||fffd||fffd||fffd|")) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0)) Then
                        .Interior.ColorIndex = ErrColor
                        .AddComment "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|)!"
                        .Comment.Shape.Width = 150
                        nErr = nErr + 1
                        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
               'ElseIf ((.Value > Range("|fffd||fffd||fffd||fffd|")) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 0 And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) Then
               '         .Interior.ColorIndex = ErrColor
               '         .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
               '         nErr = nErr + 1
               '         Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
               Else
               '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                n_DayEnd = .Value - dDat
               End If
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call Prolong(oCell)
           
          Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
            If (IsNumeric(.Value)) Then
              If (.Value < 0) Then
               .Interior.ColorIndex = ErrColor
               .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (((.Value < 0.9) And (.Value <> 0)) Or _
                  ((.Value > 46) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0))) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (" & .Value & "%) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                   nErr = nErr + 1
                   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call RegimCred(oCell)
 
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
          .Value = CStr(.Value)
            If (Len(Trim$(.Value)) <> 3) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. 3-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            Else
              If (IsError(Application.VLookup(.Value, Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("VALUTA"), 1, 0))) Then
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            End If
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
          .Value = CStr(.Value)
            If (Len(Trim$(.Value)) <> 3) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. 3-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            Else
              If (IsError(Application.VLookup(.Value, Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("VALUTA"), 1, 0))) Then
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            End If
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call SummaCrd(oCell)
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call SummaVid(oCell)
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call BusinessPlan(oCell)
        
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            Call TrgLoan(oCell)
      
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           If (Len(Trim(.Value)) > 0) Then
            If (UCase(Trim(.Value)) <> "|fffd||fffd||fffd||fffd|") And (UCase(Trim(.Value)) <> "|fffd||fffd||fffd||fffd||fffd|") Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
               nErr = nErr + 1
               Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
            End If
           End If
        
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           If Len(Trim(.Value)) = 0 Then .Value = 0
            If (IsNumeric(.Value)) Then
             If (.Value < 0) Then
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                .Comment.Shape.Width = 200
                .Comment.Shape.Height = 60
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
             ElseIf (.Value = 0) And _
                 (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
                 (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
                 (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) < ActiveSheet.Range("|fffd||fffd||fffd||fffd|")) Then
               .Interior.ColorIndex = ErrColor
               .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
               .Comment.Shape.Width = 200
               .Comment.Shape.Height = 60
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
             End If
              If .Value > 0 Then col_dog = col_dog + 1
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
            End If
        
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           If Len(Trim(.Value)) = 0 Then .Value = 0
            If (IsNumeric(.Value)) Then
             If (.Value < 0) Then
               .Interior.ColorIndex = ErrColor
               .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
             Else
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) And _
                 (.Value > Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then '
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
                 nErr = nErr + 1
                 Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (.Value > 0 And Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) And _
                     (.Value = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) And _
                     (Left(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)), 3) <> "458") Then
                    .Interior.ColorIndex = ErrColor
                    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""458""!"
                    .Comment.Shape.Width = 200
                    .Comment.Shape.Height = 40
                     nErr = nErr + 1
                     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (.Value > 0) And _
                     (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 0) Then
                    .Interior.ColorIndex = ErrColor
                    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
                    .Comment.Shape.Width = 200
                    .Comment.Shape.Height = 40
                     nErr = nErr + 1
                     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
             End If
              
              If .Value > 0 Then col_pr = col_pr + 1
            
            Else
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If
        
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
          n_DayPr_o = 0
            If (Len(.Value) = 0 And (Not IsDate(.Value))) Then .Formula = ""
            If CVar(.Value) = "01.01.1900" Then .Value = ""
            If (Not IsEmpty(.Value)) Then
              If (IsDate(.Value)) Then
               .Value = CDate(.Value)
                If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) Then '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                  .Comment.Shape.Width = 200
                  .Comment.Shape.Height = 40
                  nErr = nErr + 1
                  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                ElseIf (.Value > Range("|fffd||fffd||fffd||fffd|")) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
                  nErr = nErr + 1
                  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                ElseIf (.Value <= Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                  nErr = nErr + 1
                  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                'ElseIf (.Value > Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                '  .Interior.ColorIndex = ErrColor
                '  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                '  .Comment.Shape.Width = 200
                '  .Comment.Shape.Height = 40
                '   nErr = nErr + 1
                '   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                ElseIf (.Value <= Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| <= |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                  .Comment.Shape.Width = 200
                  .Comment.Shape.Height = 40
                   nErr = nErr + 1
                   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
                Else
                '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                n_DayPr_o = dDat - .Value
                End If
              Else
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            End If
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call DateProsrProc(oCell)
           'If (Len(.Value) = 0 And (Not IsDate(.Value))) Then .Formula = ""
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call SrokProsr(oCell)
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
           Call ProsrProc(oCell)
     
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            If (IsError(Application.VLookup(.Value, Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("CRED_OBESP"), 1, 0))) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            Else
              If CStr(Trim(.Value)) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
               If Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) > 0 Then
                  .Interior.ColorIndex = ErrColor
                  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                  nErr = nErr + 1
                  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value & " " & Cells(.Row, 3).Value & " |fffd|" & Cells(.Row, 6).Value
               End If
              End If
            End If
                 
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
            '  If (Len(Trim(.Value)) < 5) Then
            '    .Interior.ColorIndex = ErrColor
            '    .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
            '    nErr = nErr + 1
            '    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value & " " & Cells(.Row, 3).Value & " |fffd|" & Cells(.Row, 6).Value
            '  End If
            'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
            If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Then
              If (Len(Trim(.Value)) > 0) Then
                .Interior.ColorIndex = ErrColor
                .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value & " " & Cells(.Row, 3).Value & " |fffd|" & Cells(.Row, 6).Value
              End If
            End If
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
            If Len(Trim(CStr(.Value))) = 0 Then .Value = 0
             If (Format(Range("|fffd||fffd||fffd||fffd|"), "ddmm") = "3103") Or _
                (Format(Range("|fffd||fffd||fffd||fffd|"), "ddmm") = "3006") Or _
                (Format(Range("|fffd||fffd||fffd||fffd|"), "ddmm") = "3009") Or _
                (Format(Range("|fffd||fffd||fffd||fffd|"), "ddmm") = "3112") Then
              If (.Value = 0) And _
               ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") And _
                 (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|") And _
                 (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"))) Then
               .Interior.ColorIndex = ErrColor
               .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| > 0 |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <> ""|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
               .Comment.Shape.Width = 300
               .Comment.Shape.Height = 50
                nErr = nErr + 1
                Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
             End If
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Value = CStr(.Value)
            If Len(Trim(CStr(.Value))) = 0 Then .Value = 0
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           .Value = CStr(.Value)
            If Len(Trim(.Value)) = 0 Then .Value = "0"
     
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           If (IsNumeric(.Value)) Then
            .Value = CInt(.Value)
             Set rCommentRiskGrp = oCell.Comment
              If rCommentRiskGrp Is Nothing Then Call RiskGrp(oCell)
             
            '|fffd||fffd||fffd||fffd|
             Sum_pr = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
             Sum_sr = (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) - Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
             Sum_rrez = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) * (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) / 100) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
             Sum_rez = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)
             If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
             'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
                (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
              Sum_prolong = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
             End If
             
                
             If .Value = 1 Then
              pr_1 = pr_1 + Sum_pr
              sr_1 = sr_1 + Sum_sr
              rrez_1 = rrez_1 + Sum_rrez
              rez_1 = rez_1 + Sum_rez
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                 (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
              'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
                (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
                 prolong_1 = prolong_1 + Sum_prolong
              End If
             ElseIf .Value = 2 Then
              pr_2 = pr_2 + Sum_pr
              sr_2 = sr_2 + Sum_sr
              rrez_2 = rrez_2 + Sum_rrez
              rez_2 = rez_2 + Sum_rez
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                 (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
              'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
                (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
                 prolong_2 = prolong_2 + Sum_prolong
              End If
             ElseIf .Value = 3 Then
              pr_3 = pr_3 + Sum_pr
              sr_3 = sr_3 + Sum_sr
              rrez_3 = rrez_3 + Sum_rrez
              rez_3 = rez_3 + Sum_rez
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                 (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
               'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
               ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
               (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
                 prolong_3 = prolong_3 + Sum_prolong
              End If
             ElseIf .Value = 4 Then
              pr_4 = pr_4 + Sum_pr
              sr_4 = sr_4 + Sum_sr
              rrez_4 = rrez_4 + Sum_rrez
              rez_4 = rez_4 + Sum_rez
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                 (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
              'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
                (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
                 prolong_4 = prolong_4 + Sum_prolong
              End If
             ElseIf .Value = 5 Then
              pr_5 = pr_5 + Sum_pr
              sr_5 = sr_5 + Sum_sr
              rrez_5 = rrez_5 + Sum_rrez
              rez_5 = rez_5 + Sum_rez
              If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                 (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
               'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 1) And _
                ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
                (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV")) Then
                 prolong_5 = prolong_5 + Sum_prolong
              End If
             End If
           Else
            .Interior.ColorIndex = ErrColor
            .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
             nErr = nErr + 1
             Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
           End If
             
          Case "|fffd||fffd||fffd||fffd||fffd||fffd|"
          If IsNumeric(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
           Set rCommentFinPol = oCell.Comment
            If rCommentFinPol Is Nothing Then Call FinPol(oCell)
          Else
           .Interior.ColorIndex = ErrColor
           .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
            nErr = nErr + 1
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
          End If
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call ObslDolg(oCell)
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Set rCommentKatKredRiska = oCell.Comment
           If rCommentKatKredRiska Is Nothing Then
            Call KatKredRisk(oCell)
           End If
          
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call PrtfOdnrTreb(oCell)
           
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           If IsNumeric(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then Call OtchRezerv(oCell)
            
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call F_Rezerv(oCell)
           
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call UplataProc(oCell)
       
          Case "|fffd||fffd||fffd||fffd||fffd|"
          
          Case "|fffd||fffd||fffd||fffd||fffd|"
          
          Case "|fffd||fffd||fffd|"
           Call ProverkaOPF(oCell)
           
          Case "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           Call GrpClnt(oCell)
        
        Case Else
        End Select
      End With
    Next
  Next
 
  
  Erase aFormat, aRow, aDog, aRowINN, aZNam, aOKVED
  Set oInd = Nothing
  
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|
  Worksheets("|fffd||fffd||fffd||fffd|").Select
  Range("a2") = "|fffd||fffd| " & dDat & " |fffd|. "
  Range("a21") = "|fffd||fffd| " & dDat & " |fffd|. "
  
  Cells(23, 2).Value = pr_1
  Cells(24, 2).Value = pr_2
  Cells(25, 2).Value = pr_3
  Cells(26, 2).Value = pr_4
  Cells(27, 2).Value = pr_5
  
  Cells(23, 3).Value = sr_1
  Cells(24, 3).Value = sr_2
  Cells(25, 3).Value = sr_3
  Cells(26, 3).Value = sr_4
  Cells(27, 3).Value = sr_5
  
  Cells(23, 5).Value = rez_1
  Cells(24, 5).Value = rez_2
  Cells(25, 5).Value = rez_3
  Cells(26, 5).Value = rez_4
  Cells(27, 5).Value = rez_5
  
  Cells(23, 6).Value = rrez_1
  Cells(24, 6).Value = rrez_2
  Cells(25, 6).Value = rrez_3
  Cells(26, 6).Value = rrez_4
  Cells(27, 6).Value = rrez_5
  
  Cells(23, 7).Value = prolong_1
  Cells(24, 7).Value = prolong_2
  Cells(25, 7).Value = prolong_3
  Cells(26, 7).Value = prolong_4
  Cells(27, 7).Value = prolong_5
  

     With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
         .Select
         .PivotTableWizard SourceType:=xlDatabase, SourceData:= _
           .Range(Cells(1, 20), Cells(str_sch - 1, 26)), TableDestination:=Cells(1), TableName:= _
           "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", SaveData:=False
         
        With .PivotTables("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
          .SaveData = False
          .AddFields RowFields:=Array("|fffd||fffd||fffd||fffd|1|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd|2|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"), ColumnFields:="|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", PageFields:=Array("|fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        
          .NullString = "0"
          .RowGrand = False
            
            With .PivotFields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            .Orientation = xlDataField
            .Function = xlSum
            .NumberFormat = "# ### ### ### ### ##0.00"
            End With
        End With
      
      .Cells(1).Select
      .PageSetup.PrintArea = .Range(.Cells(1, 1), .Cells(Application.Match("|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", Range("A:A")), 6)).Address
      
      End With
  
     End With
     
     With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
      .Activate
      .Columns("A:A").WrapText = False
     End With

 
  If (nErr > 5000) Then
    MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " + vbCrLf + "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|: " + CStr(nErr) + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" + vbCrLf + "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|." + vbCrLf + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. " & vbCrLf & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical
  Else
        
        If (nErr > 0) Then
        MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & nErr & " |fffd||fffd||fffd||fffd||fffd||fffd|.", vbExclamation
        Else
        MsgBox "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbInformation
        End If
        
    If (MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbQuestion + vbYesNo) = vbYes) Then
  
  With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
        .Select
        .Cells.Delete
        .PivotTableWizard SourceType:=xlDatabase, SourceData:= _
           DiapName, TableDestination:=Cells(1), TableName:= _
           "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", SaveData:=False
        With .PivotTables("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
          .SaveData = False
          .PivotFields("|fffd||fffd||fffd|").Subtotals = _
              Array(False, False, False, False, False, False, False, False, False, False, False, False)
          .PivotFields("|fffd||fffd||fffd||fffd||fffd||fffd|").Subtotals = _
              Array(False, False, False, False, False, False, False, False, False, False, False, False)
          .AddFields RowFields:="|fffd||fffd||fffd|", _
            ColumnFields:="|fffd||fffd||fffd||fffd||fffd||fffd|", PageFields:=Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            
          .NullString = "0"
          .RowGrand = False
            
            With .PivotFields("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
            .Orientation = xlDataField
            .Function = xlSum
            .NumberFormat = "# ### ### ### ### ##0.00"
            End With
        
        End With
      End With

    End If
    Check = True
  End If
  
Exi_F:
  Set DiapName = Nothing
  Set oWrk = Nothing
  Set oRow = Nothing
  Set oCell = Nothing
  Set USD = Nothing
  Set EUR = Nothing
  Erase aFormat, aRow, aDog, aRowINN, bRowINN, aZNam, aOKVED, bCRSP, Bal_sh
  Set oInd = Nothing
  Set rCommentZaemshik = Nothing
  Set rCommentKatKredRiska = Nothing
  Set rCommentRiskGrp = Nothing
  Set rCommentFinPol = Nothing
  Exit Function
Err_F:
  'MsgBox err.Description + ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " + ActiveCell.Address, vbCritical
   MsgBox Err.Description, vbCritical
   Resume Exi_F
 
End Function
Private Sub OSB(oCell As Excel.Range)
Dim OnlyNumOSB As String

With oCell
 .Value = CStr(.Value)
 OnlyNumOSB = Left(.Value, 4)
   If (Len(Trim(.Value)) <> 9) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| c|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 9-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf InStr(1, .Value, "/") = 0 Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""/"", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    .Comment.Shape.Width = 120
    .Comment.Shape.Height = 60
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   Else
    If (IsError(Application.VLookup(OnlyNumOSB, Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("NumOSB"), 1, 0))) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "4-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!"
     .Comment.Shape.Width = 120
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
   End If
End With
End Sub
Private Sub Zaemshik(oCell As Excel.Range)
Dim bs As String
With oCell
 .Value = CStr(.Value)
  bs = CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
  If (UCase$(Left(Trim(.Value), 5)) <> "|fffd||fffd||fffd||fffd||fffd|") And _
     (Left(Trim(bs), 3) = "454" Or Trim(bs) = "45814") Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd| |fffd|/|fffd| 454 |fffd||fffd||fffd| 45814, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
   .Comment.Shape.Width = 120
   .Comment.Shape.Height = 60
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  ElseIf (InStr(1, .Value, """") <> 0) Or (InStr(1, .Value, "'") <> 0) Or (InStr(1, .Value, "`") <> 0) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   .Comment.Shape.Width = 120
   .Comment.Shape.Height = 60
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
End With
End Sub
Private Sub Reglament(oCell As Excel.Range)
With oCell
  .Value = CStr(.Value)
   If (IsError(Application.VLookup(Trim(.Value), Range("REGLAMENT"), 1, 0))) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   Else
    If (.Value = "285") And _
     (CDate(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > Range("CRED_DATEREGL931")) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 285 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 931!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    ElseIf .Value = "279" Then
     If (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") And _
        (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 279, |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd|"" |fffd||fffd||fffd| ""|fffd||fffd|""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 40
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
     End If
    'ElseIf .Value = "1221" Then
    ' If (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd||fffd||fffd||fffd|1221") And _
    '    (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd||fffd|1221") Then
    '  .Interior.ColorIndex = ErrColor
    '  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 1221, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd|1221"" |fffd||fffd||fffd| ""|fffd||fffd||fffd|1221""!"
    '  .Comment.Shape.Width = 200
    '  .Comment.Shape.Height = 40
    '   nErr = nErr + 1
    '   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    ' End If
    ElseIf .Value = "1177" Then
     If (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd||fffd|") Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 1177, |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 40
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
     End If
    ElseIf .Value = "479" Then
     If (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "2") And _
        (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "3.1") And _
        (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "3.2") And _
        (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "4") Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 479, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 2, 3.1 |fffd||fffd||fffd| 3.2!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 40
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
     End If
    End If
   End If
End With
End Sub
Private Sub Prolong(oCell As Excel.Range)
With oCell
 If (IsNumeric(.Value)) Then
  .Value = CInt(.Value)
    If ((.Value < 0) Or (.Value > 7)) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    ElseIf ((.Value > 0) And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|"))) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    ElseIf ((.Value > 0) And _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "1")) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!!"
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
 Else
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
 End If
End With
End Sub
Private Sub okved(oCell As Excel.Range)
 With oCell
  .Value = CStr(.Value)
   If Len(Trim(.Value)) = 0 Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
          
   If Len(Trim(.Value)) > 0 Then
    If (IsError(Application.VLookup((.Value), Range("OKVED"), 1, 0))) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    Else
    '//|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ...
     'If (Not IsError(Application.VLookup((oRow.Cells(1, 8).Value), Range("OTRASL"), 1, 0))) Then
     ' vOtr = Null
     '  For Each oRowOtr In Range("OTRASL").Rows
     '   If (UCase(oRowOtr.Cells(, 1).Value) = UCase(oRow.Cells(, 8).Value)) Then
     '    vOtr = oRowOtr.Cells(, 0).Value
     '    Exit For
     '   End If
     '  Next
     '   If (Not IsNull(vOtr)) Then
     '    For Each oRowOtr In Range("OKVED_OTR").Rows
     '     If (oRowOtr.Cells(, 2) = .Value) Then
     '      If (Not IsNull(oRowOtr.Cells(, 1))) Then
     '       If (Not IsEmpty(oRowOtr.Cells(, 1))) Then
     '        If (vOtr <> oRowOtr.Cells(, 1).Value) Then
     '         .Interior.ColorIndex = ErrColor
     '         .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     '          nErr = nErr + 1
     '          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
     '        End If
     '       End If
     '      End If
     '     Exit For
     '     End If
     '    Next
     '   End If
     ' 'End If
     'End If
    End If
   End If
 End With
End Sub
Private Sub INN(oCell As Excel.Range)
Dim o10, o11, o12, sa, ca, sb, cb, a As Double
Dim va, vb As String

 With oCell
  If IsNumeric(.Value) Then
   .Value = CStr(.Value)
    If ((Len(Trim(.Value)) < 10) Or (Len(Trim(.Value)) > 12) Or (Len(Trim(.Value)) = 11)) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|! |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| " & Str(Len(Trim(.Value))) & " |fffd||fffd||fffd||fffd||fffd||fffd|(|fffd|,|fffd||fffd|)"
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
       ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
       ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    ElseIf (Len(Trim(.Value)) = 12) Then
      If ((Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "454") And _
         (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "45814")) Then
         .Interior.ColorIndex = ErrColor
         .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 454 |fffd||fffd||fffd| 45814"
          nErr = nErr + 1
          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
          ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
          ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
      Else
       sa = Mid(Trim(.Value), 1, 1) * 7 + _
            Mid(Trim(.Value), 2, 1) * 2 + _
            Mid(Trim(.Value), 3, 1) * 4 + _
            Mid(Trim(.Value), 4, 1) * 10 + _
            Mid(Trim(.Value), 5, 1) * 3 + _
            Mid(Trim(.Value), 6, 1) * 5 + _
            Mid(Trim(.Value), 7, 1) * 9 + _
            Mid(Trim(.Value), 8, 1) * 4 + _
            Mid(Trim(.Value), 9, 1) * 6 + _
            Mid(Trim(.Value), 10, 1) * 8
       ca = sa / 11
        If InStr(1, CStr(ca), ",") > 0 Then
         va = Mid(CStr(ca), 1, InStr(1, CStr(ca) - 1, ",")) & "." & Mid(CStr(ca), InStr(1, CStr(ca), ",") + 1, Len(CStr(ca)) - InStr(1, CStr(ca), ","))
        Else
         va = CStr(ca)
        End If
        
        If InStr(1, CStr(va), ".") > 0 Then
         o11 = sa - CDbl(Mid(va, 1, InStr(1, va, ".") - 1)) * 11
        Else
         o11 = sa - CDbl(va) * 11
        End If
       
       If o11 = 10 Then o11 = 0
       
       sb = Mid(Trim(.Value), 1, 1) * 3 + _
            Mid(Trim(.Value), 2, 1) * 7 + _
            Mid(Trim(.Value), 3, 1) * 2 + _
            Mid(Trim(.Value), 4, 1) * 4 + _
            Mid(Trim(.Value), 5, 1) * 10 + _
            Mid(Trim(.Value), 6, 1) * 3 + _
            Mid(Trim(.Value), 7, 1) * 5 + _
            Mid(Trim(.Value), 8, 1) * 9 + _
            Mid(Trim(.Value), 9, 1) * 4 + _
            Mid(Trim(.Value), 10, 1) * 6 + _
            Mid(Trim(.Value), 11, 1) * 8
       cb = sb / 11
        If InStr(1, CStr(cb), ",") > 0 Then
         vb = Mid(CStr(cb), 1, InStr(1, CStr(cb) - 1, ",")) & "." & Mid(CStr(cb), InStr(1, CStr(cb), ",") + 1, Len(CStr(cb)) - InStr(1, CStr(cb), ","))
        Else
         vb = CStr(cb)
        End If
       
        If InStr(1, CStr(vb), ".") > 0 Then
         o12 = sb - CDbl(Mid(vb, 1, InStr(1, vb, ".") - 1)) * 11
        Else
         o12 = sb - CDbl(vb) * 11
        End If
       
       If o12 = 10 Then o12 = 0
       
       If (CStr(o11) <> Mid(Trim(.Value), 11, 1)) Then
         .Interior.ColorIndex = ErrColor
         .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 11-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|!"
          nErr = nErr + 1
          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
          ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
          ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
       ElseIf (CStr(o12) <> Mid(Trim(.Value), 12, 1)) Then
         .Interior.ColorIndex = ErrColor
         .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 12-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|!"
          nErr = nErr + 1
          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
          ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
          ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
       End If
      End If
    ElseIf (Len(Trim(.Value)) = 10) Then
      If ((Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) = "454") Or _
          (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "45814")) Then
          .Interior.ColorIndex = ErrColor
          .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 454 |fffd||fffd||fffd| 45814 |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
           nErr = nErr + 1
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
           ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
           ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
      Else
       sa = Mid(Trim(.Value), 1, 1) * 31 + _
            Mid(Trim(.Value), 2, 1) * 29 + _
            Mid(Trim(.Value), 3, 1) * 23 + _
            Mid(Trim(.Value), 4, 1) * 19 + _
            Mid(Trim(.Value), 5, 1) * 17 + _
            Mid(Trim(.Value), 6, 1) * 13 + _
            Mid(Trim(.Value), 7, 1) * 7 + _
            Mid(Trim(.Value), 8, 1) * 5 + _
            Mid(Trim(.Value), 9, 1) * 3
       ca = sa / 11
        If InStr(1, CStr(ca), ",") > 0 Then
         va = Mid(CStr(ca), 1, InStr(1, CStr(ca) - 1, ",")) & "." & Mid(CStr(ca), InStr(1, CStr(ca), ",") + 1, Len(CStr(ca)) - InStr(1, CStr(ca), ","))
        Else
         va = CStr(ca)
        End If
        
       If InStr(1, CStr(va), ".") > 0 Then
         o10 = 11 - (sa - CDbl(Mid(va, 1, InStr(1, va, ".") - 1)) * 11)
       Else
         o10 = 11 - (sa - CDbl(va) * 11)
       End If
       
       If (o10 = 10) Or (o10 = 11) Then o10 = 0

       If (CStr(o10) <> Mid(Trim(.Value), 10, 1)) Then
         .Interior.ColorIndex = ErrColor
         .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 10-|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|!"
          nErr = nErr + 1
          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
          ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
          ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
       End If
      End If
    ElseIf Trim(.Value) = "7707083893" Then
          .Interior.ColorIndex = ErrColor
          .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
           nErr = nErr + 1
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
           ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
           ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
  Else
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & _
    ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
    ". |fffd||fffd||fffd| " & .Value & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
 End With
End Sub
Private Sub DataVid(oCell As Excel.Range)
With oCell
 If (Len(Trim(CStr(.Value))) = 0) Then
  If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 0) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
 Else
  If (IsDate(.Value)) Then
   .Value = CDate(.Value)
    If (.Value < Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    ElseIf .Value > Range("|fffd||fffd||fffd||fffd|") Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    ElseIf (.Value >= Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
  Else
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
 End If
End With
End Sub
Private Sub BusinessPlan(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (.Value <> "1") And (.Value <> "2") And (.Value <> "3.1") And (.Value <> "3.2") And (.Value <> "4") And (.Value <> "5") Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  Else
   If ((.Value = "3.1") Or (.Value = "3.2")) And _
     ((UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") And _
      (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") And _
      (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") And _
      (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|")) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| ""3.1"" |fffd||fffd||fffd| ""3.2"", |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", ""|fffd||fffd|"", ""|fffd||fffd|"", ""|fffd||fffd|""!"
     .Comment.Shape.Width = 200
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   'ElseIf ((.Value = "2") Or (.Value = "4")) And _
   '  (UCase$(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "|fffd||fffd|") Then
   '  .Interior.ColorIndex = ErrColor
   '  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""2"" |fffd||fffd||fffd| ""4""!"
   '   nErr = nErr + 1
   '   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  End If
 End If
End With
End Sub
Private Sub TrgLoan(oCell As Excel.Range)
 With oCell
  If (IsError(Application.VLookup(.Value, Range("CRED_TYPE"), 1, 0))) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf .Value = "|fffd||fffd|" Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf .Value = "|fffd||fffd|" Then
   If Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) > 0 Then
    If ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) - _
     Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 30) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! (1)"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
   ElseIf Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 0 Then
    If ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) - _
     Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 30) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! (2)"
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
    End If
     ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 1) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd|)!"
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
     'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 0) And _
     ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 2) Then
     ' .Interior.ColorIndex = ErrColor
     ' .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""2"" (|fffd||fffd|)!"
     ' .Comment.Shape.Width = 200
     ' .Comment.Shape.Height = 50
     '  nErr = nErr + 1
     ' Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
     ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "279") Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 279!"
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
     ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "4") Then
      .Interior.ColorIndex = ErrColor
      .AddComment "(1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 50
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
     End If
  ElseIf .Value = "|fffd||fffd|" Then
   If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
    (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 1) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd|C)!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 0) And _
   ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 2) Then
   ' .Interior.ColorIndex = ErrColor
   ' .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""2"" (|fffd||fffd|)!"
   ' .Comment.Shape.Width = 200
   ' .Comment.Shape.Height = 50
   '  nErr = nErr + 1
   '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "279") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 279!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "4") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "(2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 50
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
  ElseIf .Value = "|fffd||fffd||fffd|" Then
   If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "1177") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""1177""!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
  ElseIf .Value = "|fffd||fffd||fffd|" Then
   If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "0000") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""0000""!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "5") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""5""!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
  End If
 End With
End Sub
Private Sub RegimCred(oCell As Excel.Range)
 With oCell
  .Value = CStr(.Value)
   If (IsError(Application.VLookup(Trim(.Value), Range("CRED_REGIM"), 1, 0))) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 50
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   Else
    If (.Value = "4") And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|" And _
      Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") Then
     .Interior.ColorIndex = ErrColor
     .AddComment "(3) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    End If
   End If
 End With
End Sub
Public Sub SummaCrd(oCell As Excel.Range)
Dim Kurs As Double
With oCell
Kurs = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
 If Len(Trim(.Value)) = 0 Then .Value = 0
  If (IsNumeric(.Value)) Then
   If (.Value < 0) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value = 0) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value <> Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) And _
        (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value < Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) And _
          (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "810") And _
        ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "2") Or _
         (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "5.2")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""2"" |fffd||fffd||fffd| ""5.2"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. >= |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value > 30000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "810") And _
      (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") > 0) Then
   'ElseIf (.Value > 30000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "810") And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "MB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XMB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "OV") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XOV")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 30 |fffd||fffd||fffd|. |fffd||fffd||fffd|.!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value > 1000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "840") And _
      (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") > 0) Then
   'ElseIf (.Value > 1000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "840") And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "MB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XMB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "OV") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XOV")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|. |fffd||fffd||fffd|!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value > 1000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "978") And _
      (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") > 0) Then
   'ElseIf (.Value > 1000000) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "978") And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "MB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XMB") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "OV") Or _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XOV")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
  Else
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
End With
End Sub
Public Sub SummaVid(oCell As Excel.Range)
Dim Kurs As Double, Ost As Double, SumVid As Double
With oCell
Kurs = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
Ost = Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)
SumVid = Application.WorksheetFunction.Round(.Value * Kurs, 2)
 If Len(Trim(.Value)) = 0 Then .Value = 0
  If (IsNumeric(.Value)) Then
   If (.Value < 0) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf Ost > SumVid Then
         .Interior.ColorIndex = ErrColor
         .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
         .Comment.Shape.Width = 200
         .Comment.Shape.Height = 40
          nErr = nErr + 1
          Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   ElseIf (.Value = 0) And (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 0) Then
          .Interior.ColorIndex = ErrColor
          .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 0, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 0!"
          .Comment.Shape.Width = 200
          .Comment.Shape.Height = 40
           nErr = nErr + 1
           Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
   End If
  Else
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
  End If
End With
End Sub
Public Sub ProverkaOPF(oCell As Excel.Range)
   With oCell
            .Value = CStr(.Value)
          If Len(Trim(.Value)) = 0 Then
            .Interior.ColorIndex = ErrColor
            .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
            nErr = nErr + 1
            Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
          End If
          
           If Len(Trim(.Value)) > 0 Then
            If (IsError(Application.VLookup(Trim(.Value), Range("OPF"), 1, 0))) Then
              .Interior.ColorIndex = ErrColor
              .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|!"
              nErr = nErr + 1
              Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
            Else
              If (Len(Trim(Application.HLookup("|fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 12) And _
                 ((UCase$(Trim(.Value)) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") And _
                 (UCase$(Trim(.Value)) <> "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")) Then
                 .Interior.ColorIndex = ErrColor
                 .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| 12 |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"", |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|""!"
                 .Comment.Shape.Width = 250
                 .Comment.Shape.Height = 50
                 nErr = nErr + 1
                 Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              ElseIf (Len(Trim(Application.HLookup("|fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 10) And _
                     ((UCase$(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") Or _
                     (UCase$(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")) Then
                     .Interior.ColorIndex = ErrColor
                     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| 10 |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|""!"
                     .Comment.Shape.Width = 250
                     .Comment.Shape.Height = 50
                     nErr = nErr + 1
                     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text & " |fffd||fffd||fffd| |fffd|" & Cells(.Row, 2).Value
              End If
            End If
           End If
   End With
End Sub
Private Sub F_Rezerv(oCell As Excel.Range)
Dim |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| As Double
With oCell
 If Len(Trim(.Value)) = 0 Then .Value = 0
  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.WorksheetFunction.Round((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) * (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) / 100), 0)
  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = Application.WorksheetFunction.Round(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 0)
  If Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|" Then
  'If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "MB") And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "OV") Then
   If ((|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "(1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  ElseIf Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) = "|fffd||fffd||fffd|" Then
  'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "MB") Or _
         (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "OV") Then
   If ((|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1) Or ((|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) > 1) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "(2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  End If
End With
End Sub
Private Sub RiskGrp(oCell As Excel.Range)
With oCell
  If ((.Value <> 1) And (.Value <> 2) And (.Value <> 3) And (.Value <> 4) And (.Value <> 5)) Then
  '//|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1 2 3 4 5
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1 2 3 4 5!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (.Value <> 2) And _
         (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) = "|fffd||fffd||fffd|") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| 2!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 80
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf .Value < ((CInt(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + _
           CInt(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) - 1) Then
   If (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2, 5 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 455-5-|fffd|!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 80
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  'ElseIf .Value > ((CInt(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + _
           CInt(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) - 1) Then
  ' If (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
  '  .Interior.ColorIndex = ErrColor
  '  .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| ""MB"" |fffd||fffd||fffd| ""OV"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 4.8-4.10 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| 455-5-|fffd|!"
  '  .Comment.Shape.Width = 200
  '  .Comment.Shape.Height = 80
  '   nErr = nErr + 1
  '   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ' End If
  End If
End With
End Sub
Private Sub SrokProsr(oCell As Excel.Range)
Dim cmb As String
With oCell
 cmb = CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) & _
            Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))
 If Len(Trim(.Value)) = 0 Then .Value = 0
  If (.Value = 0) And _
   (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) + _
    Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 0 Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
  .Comment.Shape.Width = 200
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (.Value <> 0) And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0)) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
      .Comment.Shape.Width = 200
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) > 0) And _
       (((ActiveSheet.Range("|fffd||fffd||fffd||fffd|") - Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + 1) > .Value) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "(1)|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| (" & CLng(((ActiveSheet.Range("|fffd||fffd||fffd||fffd|") - Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + 1)) & ") |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (" & .Value & ")!"
      .Comment.Shape.Width = 200
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) > 0) And _
       (((ActiveSheet.Range("|fffd||fffd||fffd||fffd|") - Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + 1) > .Value) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "(2)|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (" & CLng(((ActiveSheet.Range("|fffd||fffd||fffd||fffd|") - Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) + 1)) & ") |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (" & .Value & ")!"
      .Comment.Shape.Width = 200
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (.Value > 30) And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "d") And _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "RD")) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 30 |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| ""d"", ""RD""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 80
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  End If
End With
End Sub
Private Sub DateProsrProc(oCell As Excel.Range)
With oCell
 If (Len(.Value) = 0 And (Not IsDate(.Value))) Then .Formula = ""
  If Len(Trim(CStr(.Value))) > 0 And (.Value > ActiveSheet.Range("|fffd||fffd||fffd||fffd|")) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|!"
   .Comment.Shape.Width = 200
   .Comment.Shape.Height = 60
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf Len(Trim(CStr(.Value))) > 0 And _
   (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   .Comment.Shape.Width = 200
   .Comment.Shape.Height = 60
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  End If
End With
End Sub
Private Sub ProsrProc(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then .Value = 0
  If (.Value > 0) And _
   (Len(Trim(CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)))) = 0) Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
  .Comment.Shape.Width = 200
  .Comment.Shape.Height = 60
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (.Value = 0) And _
   (Len(Trim(CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)))) <> 0) Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
  .Comment.Shape.Width = 200
  .Comment.Shape.Height = 60
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  'ElseIf (.Value = 0) And _
  ' (CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = "2") Then
  '.Interior.ColorIndex = ErrColor
  '.AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|.|fffd|. = ""2""!"
  '.Comment.Shape.Width = 200
  '.Comment.Shape.Height = 60
  ' nErr = nErr + 1
  ' Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  'ElseIf (.Value > 0) And _
  ' (CStr(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "2") Then
  '.Interior.ColorIndex = ErrColor
  '.AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. = ""2""!"
  '.Comment.Shape.Width = 200
  '.Comment.Shape.Height = 60
  ' nErr = nErr + 1
  ' Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  End If
End With
End Sub
Private Sub FinPol(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (.Value <> 0) And (.Value <> 1) And (.Value <> 2) And (.Value <> 3) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  Else
   If (.Value = 0) And _
      (Left(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), 3) <> "|fffd||fffd||fffd|") Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""0""!"
     .Comment.Shape.Width = 300
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") And _
    ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 6) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 30)) And _
     ((CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "31") And _
      (CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "32") And _
      (CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "33")) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 6 |fffd||fffd| 30 (|fffd||fffd||fffd|.) |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: ""3/1"", ""3/2"", ""3/3""!"
     .Comment.Shape.Width = 300
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") And _
    ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 31) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 60)) And _
     ((CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "32") And _
      (CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "33")) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 31 |fffd||fffd| 60 (|fffd||fffd||fffd|.) |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: ""3/2"", ""3/3""!"
     .Comment.Shape.Width = 300
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 61) And _
     (CStr(Trim(.Value) + Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) <> "33") Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"", |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 31 |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|: ""3/3""!"
     .Comment.Shape.Width = 300
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  End If
 End If
End With
End Sub
Private Sub ObslDolg(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (.Value <> 0) And (.Value <> 1) And (.Value <> 2) And (.Value <> 3) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  Else
   If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "1") And _
    (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) < CVDate("01.10.2008")) And _
    ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 2) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 3)) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| < 01.10.2008|fffd|., |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""2"" (""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"") |fffd||fffd||fffd| ""3"" (""|fffd||fffd||fffd||fffd||fffd||fffd|"")!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 60
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XMB") And _
   ' ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 6) And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 30)) And _
   ' ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 2) And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 3)) Then
   ' .Interior.ColorIndex = ErrColor
   ' .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""XMB"" |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 6 |fffd||fffd| 30 |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""2"" (""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"") |fffd||fffd||fffd| ""3"" (""|fffd||fffd||fffd||fffd||fffd||fffd|"")!"
   ' .Comment.Shape.Width = 200
   ' .Comment.Shape.Height = 60
   '  nErr = nErr + 1
   '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "XMB") And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 31) And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 3) Then
   ' .Interior.ColorIndex = ErrColor
   ' .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""XMB"" |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 31 |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""3"" (""|fffd||fffd||fffd||fffd||fffd||fffd|"")!"
   ' .Comment.Shape.Width = 200
   ' .Comment.Shape.Height = 60
   '  nErr = nErr + 1
   '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   'ElseIf (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 0) And _
   ' ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 31) And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 60)) And _
   ' ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 2) And _
   '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 3)) Then
   ' .Interior.ColorIndex = ErrColor
   ' .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 31 |fffd||fffd| 60 (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""2"" (""|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"") |fffd||fffd||fffd| ""3"" (""|fffd||fffd||fffd||fffd||fffd||fffd|"")!"
   ' .Comment.Shape.Width = 200
   ' .Comment.Shape.Height = 60
   '  nErr = nErr + 1
   '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 0) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= 61) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 3) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 61 |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""3"" (""|fffd||fffd||fffd||fffd||fffd||fffd|"")!"
    .Comment.Shape.Width = 200
    .Comment.Shape.Height = 60
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  End If
 End If
End With
End Sub
Private Sub OtchRezerv(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then
   .Interior.ColorIndex = ErrColor
   .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (.Value = 0) And _
   (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 1) Then
   .Interior.ColorIndex = ErrColor
   .AddComment "(1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|""!"
   .Comment.Shape.Width = 200
   .Comment.Shape.Height = 60
    nErr = nErr + 1
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  ElseIf (.Value <> 0) And _
         (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 1) Then
        .Interior.ColorIndex = ErrColor
        .AddComment "(2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"" |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|""!"
        .Comment.Shape.Width = 200
        .Comment.Shape.Height = 60
         nErr = nErr + 1
         Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "MB") And _
         (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 1.03) Then
  '      .Interior.ColorIndex = ErrColor
  '      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (""MB""), |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1.03%!"
  '      .Comment.Shape.Width = 200
  '      .Comment.Shape.Height = 60
  '       nErr = nErr + 1
  '       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  'ElseIf (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "OV") And _
  '       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> 1) Then
  '      .Interior.ColorIndex = ErrColor
  '      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| (""OV""), |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| 1%!"
   '     .Comment.Shape.Width = 200
  '      .Comment.Shape.Height = 60
  '       nErr = nErr + 1
  '       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  End If
 End If
End With
End Sub
Private Sub PrtfOdnrTreb(oCell As Excel.Range)
 With oCell
  .Value = CStr(.Value)
   If (Len(Trim(.Value)) = 0) Then
    If (Len(Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0))) = 0) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "(2) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    End If
   Else
    If IsError(Application.VLookup(Trim(.Value), Range("POT"), 1, 0)) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 50
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    Else
     If (Left(Trim(.Value), 3) = "|fffd||fffd||fffd|") And _
      (CLng(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> 0) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""0""!"
      .Comment.Shape.Width = 300
      .Comment.Shape.Height = 50
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
     ElseIf (Left(Trim(.Value), 3) = "|fffd||fffd||fffd|") And _
      (CLng(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> 0) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""0""!"
      .Comment.Shape.Width = 300
      .Comment.Shape.Height = 50
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
     'ElseIf (InStr(1, UCase(Trim(.Value)), "|fffd||fffd||fffd|") > 0) And _
      ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "1") And _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "2") And _
       (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "3")) Then
      '.Interior.ColorIndex = ErrColor
      '.AddComment "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd|!"
      '.Comment.Shape.Width = 300
      '.Comment.Shape.Height = 50
      ' nErr = nErr + 1
      ' Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    'ElseIf (UCase(Trim(.Value)) = "OV") And _
     ((Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "|fffd||fffd|") And _
      (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "|fffd||fffd|")) Then
     '.Interior.ColorIndex = ErrColor
     '.AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     '.Comment.Shape.Width = 200
     '.Comment.Shape.Height = 50
     ' nErr = nErr + 1
     ' Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    'ElseIf (UCase(Trim(.Value)) = "XMB") And _
    ' ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd|") And _
    '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd|1221") And _
    '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd||fffd||fffd|") And _
    '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd||fffd||fffd|1221")) Then
    ' .Interior.ColorIndex = ErrColor
    ' .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| ""XMB"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""|fffd||fffd||fffd|"", ""|fffd||fffd||fffd|1221"", ""|fffd||fffd||fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd|1221""!"
    ' .Comment.Shape.Width = 300
    ' .Comment.Shape.Height = 50
    '  nErr = nErr + 1
    '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    'ElseIf ((Trim(.Value) = "OV") Or (Trim(.Value) = "XOV")) And _
    ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "4") Then
    ' .Interior.ColorIndex = ErrColor
    ' .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
    ' .Comment.Shape.Width = 200
    ' .Comment.Shape.Height = 50
    '  nErr = nErr + 1
    '  Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    End If
   End If
  End If
 End With
End Sub
Private Sub KatKredRisk(oCell As Excel.Range)
With oCell
 If (Len(Trim(.Value)) = 0) Then
  .Interior.ColorIndex = ErrColor
  .AddComment "(1) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
  .Comment.Shape.Width = 200
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (IsError(Application.VLookup(.Value, Range("CRED_QUALITY"), 1, 0))) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  Else
   If ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) > 90) And _
      (UCase(Mid(Trim(.Value), 1, 2)) = "RE") Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|/|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 90 |fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| RE!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") And _
           (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "1683") And _
           (UCase(Trim(.Value)) <> "|fffd||fffd|")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""1683"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=""|fffd||fffd|""!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd|") And _
           (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "1294") And _
           (UCase(Trim(.Value)) <> "|fffd||fffd|")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""1294"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=""|fffd||fffd|""!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd||fffd|") And _
           (UCase(Trim(.Value)) <> "|fffd||fffd|")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|=""|fffd||fffd|""!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   'ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") And _
   '        (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "1683") And _
   '        (UCase(Trim(.Value)) = "|fffd||fffd|")) Then
   '    .Interior.ColorIndex = ErrColor
   '    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| <>""|fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <>""1683"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|<>""|fffd||fffd|""!"
   '    .Comment.Shape.Width = 200
   '    .Comment.Shape.Height = 60
   '     nErr = nErr + 1
   '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") And _
           (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "1294") And _
           (UCase(Trim(.Value)) = "|fffd||fffd|")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| <>""|fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| <>""1294"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|<>""|fffd||fffd|""!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ElseIf ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd|") And _
           (UCase(Trim(.Value)) = "|fffd||fffd|")) Then
       .Interior.ColorIndex = ErrColor
       .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|! |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| <>""|fffd||fffd||fffd|"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|<>""|fffd||fffd|""!"
       .Comment.Shape.Width = 200
       .Comment.Shape.Height = 60
        nErr = nErr + 1
        Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   End If
  End If
 End If
End With
End Sub
Private Sub UplataProc(oCell As Excel.Range)
With oCell
 If (IsNumeric(.Value)) Then
  .Value = CInt(.Value)
   If ((.Value <> 1) And (.Value <> 2) And (.Value <> 9) And (.Value <> 30) And (.Value <> 90) And (.Value <> 180) And (.Value <> 365)) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   Else
    If (.Value = 1) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
     ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|")) Then
     .Interior.ColorIndex = ErrColor
     .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| % ""1"" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     .Comment.Shape.Width = 200
     .Comment.Shape.Height = 60
      nErr = nErr + 1
      Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    ElseIf (.Value <> 2) And _
           (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|.|fffd|. ""2""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 60
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    ElseIf (.Value = 2) And _
           (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd|.|fffd|. ""2""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 60
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    'ElseIf (.Value <> 30) And _
    '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) > 0) And _
    '  (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
    '  (((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd||fffd||fffd||fffd|") Or _
    '    (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = "|fffd||fffd||fffd||fffd||fffd|1221")) And _
    '   ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") And _
    '    (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|"))) Then
    '    .Interior.ColorIndex = ErrColor
    '    .AddComment "|fffd||fffd||fffd| |fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| ""|fffd||fffd|"" (""|fffd||fffd|""), |fffd| |fffd||fffd||fffd||fffd|. |fffd||fffd|. > 0 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| % |fffd|.|fffd|. ""30""!"
    '    .Comment.Shape.Width = 200
    '    .Comment.Shape.Height = 60
    '     nErr = nErr + 1
    '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    ElseIf (.Value <> 30) And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) = 0) And _
     ((Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd||fffd|") And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|") And _
      (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> "|fffd||fffd|")) And _
     (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <> _
      Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) Then
      .Interior.ColorIndex = ErrColor
      .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 0 |fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| ""|fffd||fffd|"", ""|fffd||fffd|"", ""|fffd||fffd||fffd|"" |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| % |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| ""30""!"
      .Comment.Shape.Width = 200
      .Comment.Shape.Height = 60
       nErr = nErr + 1
       Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
    End If
   End If
 Else
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 End If
End With
End Sub
Private Sub GrpClnt(oCell As Excel.Range)
With oCell
 If Len(Trim(.Value)) = 0 Then
  .Interior.ColorIndex = ErrColor
  .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
  .Comment.Shape.Width = 200
   nErr = nErr + 1
   Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
 Else
  If (IsError(Application.VLookup(.Value, Range("GRPCLNT"), 1, 0))) Then
    .Interior.ColorIndex = ErrColor
    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
     nErr = nErr + 1
     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
  Else
   'If ((UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|1221") Or _
   ' (UCase(Trim(.Value)) = "|fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd|1221")) And _
   ' (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = "810") And _
   ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= CVDate("01.01.2008")) Then
   ' If (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") = 0) Then
   '  If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 30000000) Then
   '    .Interior.ColorIndex = ErrColor
   '    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd|1221"", ""C|fffd||fffd|"", ""C|fffd||fffd|1221"" |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| <= 30 |fffd||fffd||fffd|. |fffd||fffd||fffd|.!"
   '    .Comment.Shape.Width = 600
   '    .Comment.Shape.Height = 50
   '     nErr = nErr + 1
   '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   '   End If
   ' End If
   'ElseIf ((UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|1221") Or _
   ' (UCase(Trim(.Value)) = "|fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd|1221")) And _
   ' (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = "840") And _
   ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= CVDate("01.01.2008")) Then
   ' If (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") = 0) Then
   '    .Comment.Shape.Width = 600
   '    .Comment.Shape.Height = 50
   '     nErr = nErr + 1
   '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   '  If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 1000000) Then
   '    .Interior.ColorIndex = ErrColor
   '    .AddComment "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd|1221"", ""C|fffd||fffd|"", ""C|fffd||fffd|1221"" |fffd| C|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| <= 1 |fffd||fffd||fffd|. USD!"
   '    .Comment.Shape.Width = 600
   '    .Comment.Shape.Height = 50
   '     nErr = nErr + 1
   '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   '  End If
   ' End If
   'ElseIf ((UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd||fffd||fffd|1221") Or _
   ' (UCase(Trim(.Value)) = "|fffd||fffd||fffd|") Or (UCase(Trim(.Value)) = "|fffd||fffd||fffd|1221")) And _
   ' (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) = "978") And _
   ' (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) >= CVDate("01.01.2008")) Then
   ' If (InStr(1, Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0), "|fffd||fffd||fffd|") = 0) Then
   '  If (Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0) <= 1000000) Then
   '    .Interior.ColorIndex = ErrColor
   '    .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""|fffd||fffd||fffd||fffd||fffd|"", ""|fffd||fffd||fffd||fffd||fffd|1221"", ""C|fffd||fffd|"", ""C|fffd||fffd|1221"" |fffd| C|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| <= 1 |fffd||fffd||fffd|. EUR, |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""MB"", ""XMB"", ""OV"", ""XOV""!"
   '    .Comment.Shape.Width = 600
   '    .Comment.Shape.Height = 50
   '     nErr = nErr + 1
   '     Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   '  End If
   ' End If
   'ElseIf (UCase(Trim(.Value)) = "RS") Then
   ' If (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS1") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS2") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS3") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS4") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS5") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS6") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS7") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RS8") And _
   '    (Trim(Application.HLookup("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", DiapName, .Row - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| + 1, 0)) <> "RSD") Then
   '   .Interior.ColorIndex = ErrColor
   '   .AddComment "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ""RS"", |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| ""RS1"", ""RS2"", ""RS3"", ""RS4"", ""RS5"", ""RS6"", ""RS7"", ""RS8"", ""RSD""!"
   '   .Comment.Shape.Width = 300
   '   .Comment.Shape.Height = 50
   '    nErr = nErr + 1
   '    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(nErr + 1, 1).Value = Str(nErr) & ". " & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Str(.Row) & ". " & .Comment.Text
   ' End If
   'End If
  End If
 End If
End With
End Sub
Public Sub Wash_all()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("a110:aa580").ClearContents
ThisWorkbook.Save
Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("a581:aa1000").ClearContents
ThisWorkbook.Save
Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("a1001:aa1500").ClearContents
ThisWorkbook.Save
Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("a1501:aa2000").ClearContents
ThisWorkbook.Save

Worksheets("|fffd||fffd||fffd||fffd||fffd|").Range("a110").Formula = "|fffd||fffd||fffd||fffd||fffd|"
End Sub

Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(kod)
If kod = "810" Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 1
ElseIf kod = "840" Then
   If Val(USD.Value) = 0 Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InputBox("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| USD. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", , CDbl("31.6358"))
   USD.Value = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Else
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = USD.Value
   End If
ElseIf kod = "276" Then
   If DEM = 0 Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InputBox("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| DEM. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", , CDbl("15.8031"))
   DEM = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
   Else
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = DEM
   End If
ElseIf kod = "978" Then
   If Val(EUR.Value) = 0 Then
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InputBox("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| EUR. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| EURO |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", , CDbl("30.9082"))
   EUR.Value = |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

   Else
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = EUR.Value
   End If
Else
   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = InputBox("|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| " & kod & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", , 1)
End If
End Function

Public Function srok_bal(srok As Variant) As String
Select Case srok
Case 1 To 30
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 30 |fffd||fffd||fffd||fffd|"
Case 31 To 90
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 31 |fffd||fffd| 90 |fffd||fffd||fffd||fffd|"
Case 91 To 180
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 91 |fffd||fffd| 180 |fffd||fffd||fffd||fffd|"
Case 181 To 365
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 181 |fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd||fffd||fffd|"
Case 366 To 1096
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd||fffd||fffd||fffd| |fffd||fffd| 3 |fffd||fffd||fffd|"
Case Is > 1096
srok_bal = "|fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 3 |fffd||fffd||fffd|"
End Select
End Function



Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(sh) As String

Select Case Mid(sh, 1, 3)
       Case "442"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45802"
       Case "443"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45803"
       Case "444"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45804"
       Case "445"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45805"
       Case "446"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45806"
       Case "447"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45807"
       Case "448"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45808"
       Case "449"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45809"
       Case "450"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45810"
       Case "451"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45811"
       Case "452"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45812"
       Case "453"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45813"
       Case "454"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45814"
       Case "455"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45815"
       Case "456"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45816"
       Case "457"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45817"

       Case Else
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = sh
End Select

End Function
Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(sh) As String

Select Case Mid(sh, 1, 3)
       Case "320"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "32015"
       
       Case "442"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44215"
       Case "443"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44315"
       Case "444"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44415"
       Case "445"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44515"
       Case "446"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44615"
       Case "447"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44715"
       Case "448"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44815"
       Case "449"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "44915"
       Case "450"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45015"
       Case "451"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45115"
       Case "452"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45215"
       Case "453"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45315"
       Case "454"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45415"
       Case "455"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45515"
       Case "456"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45615"
       Case "457"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45715"
       Case "458"
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = "45818"

       Case Else
       |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| = sh
End Select

End Function



Public Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd|) As Double
        Select Case |fffd||fffd||fffd||fffd||fffd||fffd|
        Case 1
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.01
        Case 2
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.2
        Case 3
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 0.5
        Case 4
        |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd| = 1
        End Select
End Function
Sub ved()
Dim sch As Long

  For sch = 0 To UBound(Bal_sh, 1)
  
    nInd = nInd + 1
    oInd.Show nInd
  
   If Not IsEmpty(Bal_sh(sch, 1)) Then
    .Cells(str_sch, 20) = Str(Left(Bal_sh(sch, 1), 3)) '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
    .Cells(str_sch, 21) = Str(Bal_sh(sch, 1)) '|fffd||fffd||fffd||fffd|
    .Cells(str_sch, 22) = (Bal_sh(sch, 2) - Bal_sh(sch, 3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 6)) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
    .Cells(str_sch, 24) = Bal_sh(sch, 5) 'N_|fffd||fffd||fffd|
    .Cells(str_sch, 25) = Bal_sh(sch, 6) '|fffd||fffd||fffd||fffd||fffd||fffd|
    .Cells(str_sch, 26) = Bal_sh(sch, 4) '|fffd||fffd||fffd||fffd|
    str_sch = str_sch + 1
    
    .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1)), 3)) '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
    .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1))) '|fffd||fffd||fffd||fffd|
    .Cells(str_sch, 22) = ((Bal_sh(sch, 2) - Bal_sh(sch, 3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 4))) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 6))  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
    .Cells(str_sch, 24) = Bal_sh(sch, 5) 'N_|fffd||fffd||fffd|
    .Cells(str_sch, 25) = Bal_sh(sch, 6) '|fffd||fffd||fffd||fffd||fffd||fffd|
    .Cells(str_sch, 26) = Bal_sh(sch, 4) '|fffd||fffd||fffd||fffd|
    str_sch = str_sch + 1
    
        If Bal_sh(sch, 3) > 0 Then
        .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1)), 3)) '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|.
        .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1))) '|fffd||fffd||fffd||fffd|
        .Cells(str_sch, 22) = (Bal_sh(sch, 3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 6))  ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
        .Cells(str_sch, 24) = Bal_sh(sch, 5) 'N_|fffd||fffd||fffd|
        .Cells(str_sch, 25) = Bal_sh(sch, 6) '|fffd||fffd||fffd||fffd||fffd||fffd|
        .Cells(str_sch, 26) = Bal_sh(sch, 4) '|fffd||fffd||fffd||fffd|
        str_sch = str_sch + 1
        
        .Cells(str_sch, 20) = Str(Left(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1))), 3)) '|fffd||fffd||fffd||fffd| 1|fffd||fffd||fffd|. "458" '
        .Cells(str_sch, 21) = Str(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 1)))) '|fffd||fffd||fffd||fffd| "45818" '
        .Cells(str_sch, 22) = ((Bal_sh(sch, 3)) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 4))) * |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(Bal_sh(sch, 6))  ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        .Cells(str_sch, 23) = "|fffd|" '|fffd||fffd||fffd||fffd|
        .Cells(str_sch, 24) = Bal_sh(sch, 5) 'N_|fffd||fffd||fffd|
        .Cells(str_sch, 25) = Bal_sh(sch, 6) '|fffd||fffd||fffd||fffd||fffd||fffd|
        .Cells(str_sch, 26) = Bal_sh(sch, 4) '|fffd||fffd||fffd||fffd|
        str_sch = str_sch + 1
        
        End If
        
         
        
   End If
  Next sch
End Sub


INQUEST-PP=macro
