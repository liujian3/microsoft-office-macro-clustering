Attribute VB_Name = "Sheet01"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Sub SummaryRefreshSummaryOnly()
    Run "AbleBudgetLOMAddin.xlam!SummaryRefreshSummaryOnly"
End Sub

Sub SummaryRefresh()
    Run "AbleBudgetLOMAddin.xlam!SummaryRefresh"
End Sub

Sub SummaryModifyFiles()
    Run "AbleBudgetLOMAddin.xlam!SummaryModifyFiles"
End Sub

Sub SummaryCreateNewFiles()
    Run "AbleBudgetLOMAddin.xlam!SummaryCreateNewFiles"
End Sub

Sub SummaryClearFiles()
    Run "AbleBudgetLOMAddin.xlam!SummaryClearFiles"
End Sub

Sub SummarySetLiveBudget()
    Run "AbleBudgetLOMAddin.xlam!SummarySetLiveBudget"
End Sub

Sub DepartmentRefresh()
    Run "AbleBudgetLOMAddin.xlam!DepartmentRefresh"
End Sub

Sub DepartmentUpload()
    Run "AbleBudgetLOMAddin.xlam!DepartmentUpload"
End Sub

Sub DepartmentFormatOperatingCosts()
    Run "AbleBudgetLOMAddin.xlam!DepartmentFormatOperatingCosts"
End Sub

Sub DepartmentClearFile()
    Run "AbleBudgetLOMAddin.xlam!DepartmentClearFile"
End Sub

Sub ManningUpload()
    Run "AbleBudgetLOMAddin.xlam!ManningUpload"
End Sub

Sub ComparisonRefresh()
    Run "AbleBudgetLOMAddin.xlam!ComparisonRefresh"
End Sub


Attribute VB_Name = "Sheet02"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet04"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet05"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet06"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet07"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet08"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet09"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
    On Error Resume Next
    Dim wb As Workbook, sAbleAddIn, sAbleAddInLocal, FSO As Object, AI As Excel.AddIn, shp As Shape
    Set wb = ThisWorkbook
    sAbleAddIn = [AbleAddIn]
    sAbleAddInLocal = Environ("AppData") & "\Microsoft\AddIns\AbleBudgetLOMAddIn.xlam"
    
    If Application.Workbooks.Count > 1 Then GoTo EarlyExit
    
    If Dir(sAbleAddIn) = "" Then sAbleAddIn = CStr(ThisWorkbook.Path) & Right([AbleAddIn], Len([AbleAddIn]) - InStrRev([AbleAddIn], "\") + 1)
    If Dir(sAbleAddIn) = "" Then GoTo SkipCopy
    
    If Dir(sAbleAddInLocal) <> "" Then
        Set AI = Application.AddIns.Add(Filename:=sAbleAddInLocal)
        AI.Installed = False
    End If
    
    Set FSO = CreateObject("Scripting.FileSystemObject")
    FSO.copyfile sAbleAddIn, sAbleAddInLocal, True
    
SkipCopy:
    If Dir(sAbleAddInLocal) <> "" Then
        Set AI = Application.AddIns.Add(Filename:=sAbleAddInLocal)
        AI.Installed = True
        
        wb.Activate
        Sheets("Home").Select
        For Each shp In ActiveSheet.Shapes
            If Left(shp.Name, 3) = "btn" Then shp.Visible = msoTrue
        Next

    Else
        Sheets("Home").Select
        For Each shp In ActiveSheet.Shapes
            If Left(shp.Name, 3) = "btn" Then shp.Visible = msoFalse
        Next
            
        GoTo ErrHandler
    End If
    
EarlyExit:
    Run "AbleBudgetLOMAddin.xlam!Workbook_Open"
    
    Exit Sub
    
ErrHandler:
    On Error Resume Next
    MsgBox "Can't find AddIn in - " & vbCrLf & [AbleAddIn] & vbCrLf & CStr(ThisWorkbook.Path) & Right([AbleAddIn], Len([AbleAddIn]) - InStrRev([AbleAddIn], "\") + 1), , "Error"
    
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
    On Error Resume Next
    Run "AbleBudgetLOMAddin.xlam!spDeleteMenu"
End Sub



INQUEST-PP=macro
