Attribute VB_Name = "Arkusz1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CheckBox1_Click()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect Password:=haslo
If Cells(156, 1).Value <> 0 Then
    arkDan.OLEObjects("ComboBox1").Visible = True
    For i = 157 To 173
    arkDan.Rows(i).Hidden = False
Next i
End If

If Cells(156, 1).Value = 0 Then
arkDan.OLEObjects("ComboBox1").Visible = False
For i = 157 To 173
        arkDan.Rows(i).Hidden = True
Next i
End If

Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox1_Change()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect Password:=haslo
If Cells(158, 1).Value <> 2 Then
    For i = 159 To 161
    arkDan.Rows(i).Hidden = False
Next i
End If

If Cells(150, 1).Value = 2 Then
For i = 159 To 161
        arkDan.Rows(i).Hidden = True
Next i
End If

Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Attribute VB_Name = "Arkusz10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 4, 0, MSForms, ComboBox"
Attribute VB_Control = "ComboBox2, 5, 1, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 6, 2, MSForms, ComboBox"
Attribute VB_Control = "ComboBox4, 7, 3, MSForms, ComboBox"
Attribute VB_Control = "typ_kredyt, 8, 4, MSForms, ComboBox"
Attribute VB_Control = "Ilegosp, 9, 5, MSForms, ComboBox"
Private Sub ComboBox1_Change()
Dim arkDan As Worksheet
  Application.ScreenUpdating = False
  Set arkDan = ThisWorkbook.Worksheets("Dochody")
 arkDan.Unprotect Password:=haslo
 tworz_tab_zrodel
 Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox2_Change()
Dim arkDan As Worksheet
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("Dochody")
arkDan.Unprotect Password:=haslo
tworz_tab_zrodel
Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub

Private Sub ComboBox3_Change()
Dim arkDan As Worksheet
  Application.ScreenUpdating = False
  Set arkDan = ThisWorkbook.Worksheets("Dochody")
  arkDan.Unprotect Password:=haslo
  tworz_tab_zrodel
  Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox4_Change()
Dim arkDan As Worksheet
  Application.ScreenUpdating = False
  Set arkDan = ThisWorkbook.Worksheets("Dochody")
  arkDan.Unprotect Password:=haslo
  tworz_tab_zrodel
  Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub Ilegosp_Change()
Dim i As Byte
Dim rng As Range
Dim arkDan As Worksheet
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("Dochody")
arkDan.Unprotect Password:=haslo

' czyszczenie dochodow nieuzywanych kredytobiorcow
If ComboBox1.Value <= 3 Then
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 2, 17), arkDan.Cells(poz_tab_zrodel + 2, 20)).ClearContents
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 4, 17), arkDan.Cells(poz_tab_zrodel + 18, 20)).ClearContents
End If
If ComboBox1.Value <= 2 Then
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 2, 13), arkDan.Cells(poz_tab_zrodel + 2, 16)).ClearContents
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 4, 13), arkDan.Cells(poz_tab_zrodel + 18, 16)).ClearContents
End If
If ComboBox1.Value <= 1 Then
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 2, 9), arkDan.Cells(poz_tab_zrodel + 2, 12)).ClearContents
    arkDan.Range(arkDan.Cells(poz_tab_zrodel + 4, 9), arkDan.Cells(poz_tab_zrodel + 18, 12)).ClearContents
End If
 
' Pokazywanie list kredytobiorcow dla gospodarstw
For i = 1 To Ilegosp.Value
  arkDan.OLEObjects("ComboBox" & i).Visible = True
  arkDan.OLEObjects("ComboBox" & i).Enabled = True
Next
For i = Ilegosp.Value + 1 To 4
  arkDan.OLEObjects("ComboBox" & i).Visible = False
Next

'usuwanie nazw nieuzywanych gospodarstw
Set rng = arkDan.Range(arkDan.Cells(poz_okr_gosp + 3, 1), arkDan.Cells(poz_okr_gosp + 5, 4))
rng.Clear
Set rng = arkDan.Range(arkDan.Cells(poz_okr_gosp + 3, 1), arkDan.Cells(poz_okr_gosp + 5, 4))
rng.Interior.Color = RGB(255, 255, 255)


' dopisywanie nazw gospodarstw przy listach wyboru

For i = 1 To Ilegosp.Value

  'arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 2), arkDan.Cells(poz_okr_gosp + 1 + i, 3)).Select
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 2), arkDan.Cells(poz_okr_gosp + 1 + i, 3)).Merge
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 2), arkDan.Cells(poz_okr_gosp + 1 + i, 3)).Value = "Gospodarstwo " & i
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 2), arkDan.Cells(poz_okr_gosp + 1 + i, 3)).BorderAround ColorIndex:=xlAutomatic, Weight:=xlThin
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 2), arkDan.Cells(poz_okr_gosp + 1 + i, 3)).Interior.Color = 5296274
  
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 4), arkDan.Cells(poz_okr_gosp + 1 + i, 4)).BorderAround ColorIndex:=xlAutomatic, Weight:=xlThin
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 4), arkDan.Cells(poz_okr_gosp + 1 + i, 4)).Interior.ColorIndex = 0
  arkDan.Range(arkDan.Cells(poz_okr_gosp + 1 + i, 4), arkDan.Cells(poz_okr_gosp + 1 + i, 4)).HorizontalAlignment = xlCenter
Next
tworz_tab_zrodel

'arkDan.Protect Password:=haslo
Application.ScreenUpdating = True
End Sub
Private Sub tworz_tab_zrodel()
Dim arkDan As Worksheet
Dim i As Integer
Dim ilKlWGosp As Integer
Set arkDan = ThisWorkbook.Worksheets("Dochody")
arkDan.Unprotect Password:=haslo
For i = 5 To 20
  If Range(arkDan.Cells(12, i), arkDan.Cells(12, i)).Value > 0 Then
    arkDan.Columns(i).Hidden = False
  Else
    arkDan.Columns(i).Hidden = True
  End If
Next
'arkDan.Protect Password:=haslo
End Sub

Private Sub typ_kredyt_Change()

End Sub
Attribute VB_Name = "Arkusz4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Ile_por, 33, 0, MSForms, ComboBox"
Attribute VB_Control = "ComboBox1, 34, 1, MSForms, ComboBox"
Attribute VB_Control = "ComboBox2, 35, 2, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 36, 3, MSForms, ComboBox"
Attribute VB_Control = "ComboBox4, 37, 4, MSForms, ComboBox"
Private Sub ComboBox1_Change()
Dim arkDan As Worksheet
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
Application.ScreenUpdating = False
arkDan.Unprotect Password:=haslo
For i = 3 To 18
  If arkDan.Cells(2, i).Value > 0 Then
  arkDan.Columns(i).Hidden = False
  Else
  arkDan.Columns(i).Hidden = True
  End If
Next
Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox2_Change()
Dim arkDan As Worksheet
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
arkDan.Unprotect Password:=haslo
Application.ScreenUpdating = False
For i = 4 To 18
  If arkDan.Cells(2, i).Value > 0 Then
  arkDan.Columns(i).Hidden = False
  Else
  arkDan.Columns(i).Hidden = True
  End If
Next
Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox3_Change()
Dim arkDan As Worksheet
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
Application.ScreenUpdating = False
arkDan.Unprotect Password:=haslo
For i = 4 To 18
  If arkDan.Cells(2, i).Value > 0 Then
  arkDan.Columns(i).Hidden = False
  Else
  arkDan.Columns(i).Hidden = True
  End If
Next
Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox4_Change()
Dim arkDan As Worksheet
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
Application.ScreenUpdating = False
arkDan.Unprotect Password:=haslo
For i = 4 To 18
  If arkDan.Cells(2, i).Value > 0 Then
  arkDan.Columns(i).Hidden = False
  Else
  arkDan.Columns(i).Hidden = True
  End If
Next
Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub Ile_por_Change()
Dim i As Byte
Dim rng As Range
Dim arkDan As Worksheet
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
arkDan.Unprotect Password:=haslo

' Pokazywanie list kredytobiorcow dla gospodarstw
For i = 1 To Ile_por.Value
  arkDan.OLEObjects("ComboBox" & i).Visible = True
  arkDan.OLEObjects("ComboBox" & i).Enabled = True
  arkDan.Rows(4 + i).Hidden = False

Next
For i = Ile_por.Value + 1 To 4
  arkDan.OLEObjects("ComboBox" & i).Visible = False
  arkDan.Rows(4 + i).Hidden = True
  arkDan.Cells(4 + i, 4).Value = Null
Next
'arkDan.Protect Password:=haslo
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Arkusz6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Image2, 1, 0, MSForms, Image"
Attribute VB_Control = "Image5, 15876, 1, MSForms, Image"
Attribute VB_Control = "Image4, 15875, 2, MSForms, Image"
Attribute VB_Control = "Image3, 15874, 3, MSForms, Image"
Attribute VB_Control = "Image1, 15873, 4, MSForms, Image"
Attribute VB_Control = "Image6, 15877, 7, MSForms, Image"
Attribute VB_Name = "Arkusz7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CheckBox1_Click()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect Password:=haslo
If Cells(147, 1).Value <> 0 Then
    arkDan.OLEObjects("ComboBox1").Visible = True
    For i = 149 To 165
    arkDan.Rows(i).Hidden = False
Next i
End If

If Cells(147, 1).Value = 0 Then
arkDan.OLEObjects("ComboBox1").Visible = False
For i = 149 To 165
arkDan.Rows(i).Hidden = True
Next i
End If

Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Private Sub ComboBox1_Change()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect Password:=haslo
If Cells(150, 1).Value <> 2 Then
    For i = 151 To 153
    arkDan.Rows(i).Hidden = False
Next i
End If

If Cells(150, 1).Value = 2 Then
For i = 151 To 153
        arkDan.Rows(i).Hidden = True
Next i
End If

Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub
Attribute VB_Name = "Arkusz8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Option Explicit
Public Const poz_tab_zrodel = 12
Public Const poz_okr_gosp = 2
Public Const karta = 7
'Zmienna opisujaca numer porzadkowy karty kredytowej
Global Const haslo = "hipoteki2011"
Global Const pass = "admin"
Attribute VB_Name = "Module10"
Sub Przycisk2170_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("Dochody")
arkDan.Unprotect haslo

If Cells(19, 1).Value < 5 Then
   Cells(19, 1).Value = Cells(19, 1).Value + 1
For i = 21 To 32
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub

Sub Przycisk2171_Klikniecie()

Dim i, n As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("Dochody")
arkDan.Unprotect haslo

For n = 5 To 20
Cells(16 + 3 * (Cells(19, 1).Value), n).Value = Null
Cells(15 + 3 * (Cells(19, 1).Value), n).Value = Null
Next n

If Cells(19, 1).Value <= 5 And Cells(19, 1).Value > 1 Then
   Cells(19, 1).Value = Cells(19, 1).Value - 1
For i = 21 To 32
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Sub Przycisk2191_Klikniecie()
Application.ScreenUpdating = False
Sheets("Dochody").Activate

ActiveSheet.PageSetup.PrintArea = Null
ActiveSheet.PageSetup.PrintArea = "B1:T41"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveWindow.SelectedSheets.PrintOut

Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module11"
Sub Rozwin3015_Zmienianie()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect Password:=haslo
If Cells(150, 1).Value <> 2 Then
    For i = 151 To 153
    arkDan.Rows(i).Hidden = False
Next i
End If

If Cells(150, 1).Value = 2 Then
For i = 151 To 153
arkDan.Rows(i).Hidden = True
Next i
End If

Application.ScreenUpdating = True
'arkDan.Protect Password:=haslo
End Sub

Attribute VB_Name = "Module12"
Sub Przycisk7_Klikniecie()

'przenoszenie danych z kompasu do oceny zdolno|fffd|ci - Joanna Brzezi|fffd|ska

Sheets("Dochody").Cells(16, 5) = ActiveSheet.Cells(3, 10).Value

If ActiveSheet.Shapes("option button 5").ControlFormat.Value = 1 _
Or ActiveSheet.Shapes("option button 6").ControlFormat.Value = 1 Then
Sheets("dane").Cells(1, 4).Value = "hipoteczny"
Sheets("hipoteczny").Cells(136, 3).Value = "M"
Sheets("hipoteczny").Cells(14, 3).Value = ActiveSheet.Cells(5, 10).Value
Sheets("hipoteczny").Cells(118, 3).Value = ActiveSheet.Cells(4, 10).Value
Sheets("hipoteczny").Cells(119, 3).Value = ActiveSheet.Cells(6, 10).Value
Sheets("hipoteczny").Cells(122, 3).Value = ActiveSheet.Cells(7, 10).Value
Sheets("hipoteczny").Cells(134, 3).Value = ActiveSheet.Cells(43, 3).Value
Sheets("hipoteczny").Shapes("drop down 5422").ControlFormat.ListIndex = 1
Sheets("hipoteczny").Cells(225, 2).Value = Format(Now(), "Short Date")
Sheets("hipoteczny").Cells(248, 3).Value = 1
Sheets("hipoteczny").Cells(249, 3).Value = Format(Now(), "Short Date")
    If ActiveSheet.Shapes("option button 5").ControlFormat.Value = 1 Then
    Sheets("hipoteczny").Cells(135, 3).Value = ActiveSheet.Cells(44, 2).Value * 12
    Sheets("hipoteczny").Cells(130, 3).Value = ActiveSheet.Cells(44, 4).Value
    Sheets("hipoteczny").Cells(174, 3).Value = ActiveSheet.Cells(44, 4).Value * 1.25
    Else
    Sheets("hipoteczny").Cells(135, 3).Value = ActiveSheet.Cells(45, 2).Value * 12
    Sheets("hipoteczny").Cells(130, 3).Value = ActiveSheet.Cells(45, 4).Value
    Sheets("hipoteczny").Cells(174, 3).Value = ActiveSheet.Cells(45, 4).Value * 1.25
    End If
Sheets("hipoteczny").Cells(225, 3).Value = Sheets("hipoteczny").Cells(130, 3).Value
    If ActiveSheet.Cells(10, 9).Value = "malej|fffd|ce" Then
    Sheets("hipoteczny").Cells(136, 3).Value = "M"
    Else
    Sheets("hipoteczny").Cells(136, 3).Value = "R"
    End If

Else
Sheets("dane").Cells(1, 4).Value = "konsumencki"
Sheets("konsumenckie").Cells(134, 3).Value = "M"
Sheets("konsumenckie").Cells(12, 3).Value = ActiveSheet.Cells(5, 10).Value
Sheets("konsumenckie").Cells(116, 3).Value = ActiveSheet.Cells(4, 10).Value
Sheets("konsumenckie").Cells(117, 3).Value = ActiveSheet.Cells(6, 10).Value
Sheets("konsumenckie").Cells(120, 3).Value = ActiveSheet.Cells(7, 10).Value
Sheets("konsumenckie").Cells(160, 2).Value = Format(Now(), "Short Date")
Sheets("konsumenckie").Cells(183, 3).Value = 1
Sheets("konsumenckie").Cells(184, 3).Value = Format(Now(), "Short Date")
    If ActiveSheet.Shapes("option button 1").ControlFormat.Value = 1 _
    Or ActiveSheet.Shapes("option button 2").ControlFormat.Value = 1 Then
    Sheets("konsumenckie").Cells(132, 3).Value = ActiveSheet.Cells(15, 3).Value
        If ActiveSheet.Shapes("option button 1").ControlFormat.Value = 1 Then
        Sheets("konsumenckie").Cells(129, 3).Value = ActiveSheet.Cells(16, 4).Value
        Sheets("konsumenckie").Cells(133, 3).Value = ActiveSheet.Cells(16, 2).Value * 12
        Else
        Sheets("konsumenckie").Cells(129, 3).Value = ActiveSheet.Cells(17, 4).Value
        Sheets("konsumenckie").Cells(133, 3).Value = ActiveSheet.Cells(17, 2).Value * 12
        End If
    Else
        If ActiveSheet.Shapes("option button 3").ControlFormat.Value = 1 Then
        Sheets("konsumenckie").Cells(132, 3).Value = ActiveSheet.Cells(25, 3).Value
        Sheets("konsumenckie").Cells(129, 3).Value = ActiveSheet.Cells(26, 4).Value
        Sheets("konsumenckie").Cells(133, 3).Value = ActiveSheet.Cells(26, 2).Value * 12
        Sheets("konsumenckie").Cells(183, 3).Value = 31
        Else
        Sheets("konsumenckie").Cells(132, 3).Value = ActiveSheet.Cells(33, 3).Value
        Sheets("konsumenckie").Cells(129, 3).Value = ActiveSheet.Cells(34, 4).Value
        Sheets("konsumenckie").Cells(133, 3).Value = 48
        End If
    End If
Sheets("konsumenckie").Cells(160, 3).Value = Sheets("konsumenckie").Cells(129, 3).Value
If ActiveSheet.Cells(10, 9).Value = "malej|fffd|ce" Then
Sheets("konsumenckie").Cells(134, 3).Value = "M"
Else
Sheets("konsumenckie").Cells(134, 3).Value = "R"
End If

End If

Przycisk98_Klikniecie
a = MsgBox("Przed wygenerowaniem formularza informacyjnego nale|fffd|y uzupe|fffd|ni|fffd| nazw|fffd| banku oraz koszty kredytu", vbOKOnly, "Uwaga!")

End Sub


Attribute VB_Name = "Module13"
Sub Przycisk2475_Klikniecie()

Dim i As Integer
Application.ScreenUpdating = False
'drukowanie dochodow
Sheets("Dochody").Activate

ActiveSheet.PageSetup.PrintArea = Null
ActiveSheet.PageSetup.PrintArea = "B1:T41"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveWindow.SelectedSheets.PrintOut

'drukowanie oceny
Sheets("hipoteczny").Activate

ActiveSheet.PageSetup.PrintArea = Null
ActiveSheet.PageSetup.PrintArea = "B2:R134"
ActiveSheet.PageSetup.PrintTitleRows = "$7:$7"
ActiveSheet.PageSetup.PrintTitleColumns = "$B:$B"
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveSheet.PageSetup.Order = xlOverThenDown
ActiveSheet.PageSetup.FitToPagesWide = 2
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveWindow.SelectedSheets.PrintOut

ActiveSheet.PageSetup.PrintArea = "B135:C343"
ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.FitToPagesTall = 2
ActiveWindow.SelectedSheets.PrintOut

ActiveSheet.PageSetup.PrintArea = "B345:R403"
ActiveSheet.PageSetup.PrintTitleRows = "$383:$383"
ActiveSheet.PageSetup.PrintTitleColumns = "$B:$B"
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveSheet.PageSetup.Order = xlOverThenDown
ActiveSheet.PageSetup.FitToPagesWide = 2
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveWindow.SelectedSheets.PrintOut

Sheets("hipoteczny").Activate
Application.ScreenUpdating = True

End Sub

Sub Przycisk6136_Klikniecie()

Dim okres As Integer

ActiveSheet.Unprotect haslo
If Sheets("hipoteczny").Cells(144, 3).Value > 300 Then
'Jesli okres kredytownia jest powyzej 300 rat to wykonuja sie ponizsze instrukcje

okres = Sheets("hipoteczny").Cells(144, 3).Value
'Wczytuje oryginalny okres splaty kredytu

Application.ScreenUpdating = False
Sheets("hipoteczny").Activate
Rows("454:473").Hidden = False
'Odkrywane sa komorki do ktorych kopiowane beda informacje

'-------Wnioskowany okres splaty---------------------

'Kopiuje pole "Nadwyzka wolnych srodkow" dla wnioskowanego okresu splaty
Range("C385:R385").Select
Selection.Copy
Range("C458").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Kopiuje pole "Czy wnioskodawca ma zdolnosc kredytowa" dla wnioskowanego okresu splaty
Range("C391:R391").Select
Selection.Copy
Range("C461").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'Kopiuje pole "Wysoko|fffd||fffd| raty" dla wnioskowanego okresu splaty
Range("C154").Select
Selection.Copy
Range("C465").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Kopiuje pole "Ca|fffd|kowity koszt kredytu" dla wnioskowanego okresu splaty
Range("C354").Select
Selection.Copy
Range("C469").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'Kopiuje pole "Odsetki" dla wnioskowanego okresu splaty
Range("C340").Select
Selection.Copy
Range("C472").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'-------25letni okres splaty---------------------

'Wpisuje 25 letni okres kredytowania w komorce z okresem kredytowania
Range("C144").Select
ActiveCell.FormulaR1C1 = "300"
        
'Kopiuje pole "Nadwyzka wolnych srodkow" dla 25-letniego okresu splaty
Range("C385:R385").Select
Selection.Copy
Range("C459").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Kopiuje pole "Czy wnioskodawca ma zdolnosc kredytowa" dla 25-letniego okresu splaty
Range("C391:R391").Select
Selection.Copy
Range("C462").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'Kopiuje pole "Wysoko|fffd||fffd| raty" dla 25-letniego okresu splaty
Range("C154").Select
Selection.Copy
Range("C466").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Kopiuje pole "Ca|fffd|kowity koszt kredytu" dla 25-letniego okresu splaty
Range("C354").Select
Selection.Copy
Range("C470").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'Kopiuje pole "Odsetki" dla 25-letniego okresu splaty
Range("C340").Select
Selection.Copy
Range("C473").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
        
'--------------Zakonczenie--------------

'Przywracam poczatkowy okres splaty
Range("C144").Select
ActiveCell.FormulaR1C1 = okres

'Drukowanie

ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.PrintTitleRows = False
Range("b454:c474").PrintOut
Range("b454:c474").Select

'Zakrycie pol
With Selection
    .Rows.Hidden = True
Application.ScreenUpdating = True
End With

Else
a = MsgBox("Okres kredytowania nie przekracza 25 lat", vbOKOnly, "Nie dotyczy")
End If

'ActiveSheet.Protect haslo
End Sub

Sub druk_podsum()

Application.ScreenUpdating = False
Rows("417:440").Hidden = False

Range("b141:c145").Copy
Range("b418:c422").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With
Range("b345:c351").Copy
Range("b424:c430").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With
Range("b354:c363").Copy
Range("b431:c440").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With

ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.PrintTitleRows = False
Range("b417:c440").Select
With Selection
    .PrintOut
    .Clear
    .Rows.Hidden = True
End With
Application.ScreenUpdating = True

'ActiveSheet.Protect haslo

End Sub

Sub druk_podsum_kons()

ActiveSheet.Unprotect haslo
Application.ScreenUpdating = False

Range("b126:c127").Copy
Range("b300:c301").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With

Range("b129:c134").Copy
Range("b302:c307").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With

Range("b232:c245").Copy
Range("b309:c322").Select
With Selection
    .PasteSpecial Paste:=xlPasteValuesAndNumberFormats
    .PasteSpecial Paste:=xlPasteFormats
End With

ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.PrintTitleRows = False
Range("b300:c322").Select
With Selection
    .PrintOut
    .Clear
End With
Application.ScreenUpdating = True

End Sub



Attribute VB_Name = "Module14"
Option Base 1
Sub Przycisk213_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
arkDan.Unprotect haslo
i = 21

If Cells(19, 1).Value < 10 Then
   Cells(19, 1).Value = Cells(19, 1).Value + 1
For i = 29 To 112
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo

End Sub
Sub Przycisk217_Klikniecie()
Dim i, n As Integer
Application.ScreenUpdating = False

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
arkDan.Unprotect haslo
i = 18
n = 3

For n = 3 To 18
Cells(23 + 9 * (Cells(19, 1).Value - 1), n).Value = Null
Next n

If Cells(19, 1).Value <= 10 And Cells(19, 1).Value > 1 Then
   Cells(19, 1).Value = Cells(19, 1).Value - 1
For i = 30 To 112
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Sub Polewyboru223_Klikniecie()
Dim il_tr, i
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
Application.ScreenUpdating = False
arkDan.Unprotect haslo
i = 154
If Cells(157, 3) = PRAWDA Then 'polecenia jak dla jednorazowej wyplaty
arkDan.Rows(158).Hidden = True
Cells(158, 3).Value = 1
For i = 161 To 179
arkDan.Rows(i).Hidden = True
Cells(i, 3).Value = Null
Cells(i, 2).Value = Null
Next i

Else
arkDan.Rows(158).Hidden = False 'polecenia jak dla transz
Cells(158, 3).Value = InputBox("Podaj ilo|fffd||fffd| transz kredytu. Maksymalnie 20.", "Transze")
il_tr = Cells(158, 3).Value

For i = 161 To 161 + il_tr - 2
arkDan.Rows(i).Hidden = False
Next i
End If
Application.ScreenUpdating = True
'arkDan.Protect haslo

End Sub

Sub Rozwin2294_Zmienianie()

If Sheets("konsumenckie").Shapes("drop down 2294").ControlFormat.ListIndex = 1 Then
Sheets("konsumenckie").Shapes("drop down 2298").ControlFormat.List = Array("got|fffd|wk|fffd| w kasie", "z kwoty kredytu")
Else
Sheets("konsumenckie").Shapes("drop down 2298").ControlFormat.List = "got|fffd|wk|fffd| w kasie"
End If

End Sub


Attribute VB_Name = "Module15"
Sub Przycisk367_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False

'drukowanie dochodow
Sheets("Dochody").Activate

ActiveSheet.PageSetup.PrintArea = Null
ActiveSheet.PageSetup.PrintArea = "B1:T41"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveSheet.PageSetup.TopMargin = 20
ActiveSheet.PageSetup.BottomMargin = 20
ActiveSheet.PageSetup.RightMargin = 20
ActiveSheet.PageSetup.LeftMargin = 20
ActiveWindow.SelectedSheets.PrintOut

'drukowanie oceny
Sheets("konsumenckie").Activate

ActiveSheet.PageSetup.PrintArea = Null
ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.Order = xlOverThenDown
ActiveSheet.PageSetup.TopMargin = 20
ActiveSheet.PageSetup.BottomMargin = 20
ActiveSheet.PageSetup.RightMargin = 20
ActiveSheet.PageSetup.LeftMargin = 20
ActiveSheet.PageSetup.PrintArea = "B2:R124"
ActiveSheet.PageSetup.PrintTitleRows = "$7:$7"
ActiveSheet.PageSetup.PrintTitleColumns = "$B:$B"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveSheet.PageSetup.FitToPagesTall = 1
ActiveWindow.SelectedSheets.PrintOut

ActiveSheet.PageSetup.PrintArea = "B125:C245"
ActiveSheet.PageSetup.Orientation = xlPortrait
ActiveSheet.PageSetup.FitToPagesTall = 2
ActiveWindow.SelectedSheets.PrintOut

ActiveSheet.PageSetup.PrintArea = "B271:R284"
ActiveSheet.PageSetup.PrintTitleRows = "$270:$270"
ActiveSheet.PageSetup.PrintTitleColumns = "$B:$B"
ActiveSheet.PageSetup.Orientation = xlLandscape
ActiveSheet.PageSetup.FitToPagesTall = 2
ActiveWindow.SelectedSheets.PrintOut

Sheets("konsumenckie").Activate
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module16"
Sub Przycisk809_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
Application.ScreenUpdating = False
arkDan.Unprotect haslo

Cells(131, 3).Value = "Zmienne"
If Cells(127, 1).Value = 1 Or Cells(127, 1).Value = 2 Then
Worksheets("FI_kons").Unprotect haslo
Cells(134, 3).Value = "M"
Cells(129, 3).Value = Worksheets("dane").Cells(205, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(205, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(205, 4)
Else
If Cells(127, 1).Value = 4 Then
Cells(129, 3).Value = Worksheets("dane").Cells(208, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(208, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(208, 4)
Else
If Cells(127, 1).Value = 5 Then
Cells(129, 3).Value = Worksheets("dane").Cells(209, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(209, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(209, 4)
Else
If Cells(127, 1).Value = 6 Then
Cells(129, 3).Value = Worksheets("dane").Cells(210, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(210, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(210, 4)
Else
If Cells(127, 1).Value = 7 Then
Worksheets("FI_kons").Unprotect haslo
Cells(129, 3).Value = Worksheets("dane").Cells(211, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(211, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(211, 4)
Else
If Cells(127, 1).Value = 8 Then
Worksheets("FI_kons").Unprotect haslo
Cells(129, 3).Value = Worksheets("dane").Cells(212, 3)
Cells(132, 3).Value = Worksheets("dane").Cells(212, 5)
Cells(133, 3).Value = Worksheets("dane").Cells(212, 4)
End If
End If
End If
End If
End If
End If
Cells(160, 3).Value = Cells(129, 3)
Cells(160, 2).Value = Format(Now(), "Short Date")
Cells(184, 3).Value = 31

a = MsgBox("Pami|fffd|taj o podaniu wysoko|fffd|ci prowizji oraz innych koszt|fffd|w.", vbOKOnly, "Uzupe|fffd|nij dane")

Worksheets("FI_kons").Unprotect haslo
Worksheets("FI_kons").Cells(1, 6).Value = 1

Application.ScreenUpdating = True
'Worksheets("FI_kons").Protect haslo
'arkDan.Protect haslo
End Sub
Sub Przycisk3224_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect haslo
ActiveWorkbook.Unprotect pass
Application.ScreenUpdating = False
Sheets("FI_hipo").Visible = True
Sheets("FI_hipo").Activate
Application.ScreenUpdating = True
arkDan.Protect haslo
'ActiveWorkbook.Protect pass
End Sub
Sub Przycisk11_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("FI_hipo")
Sheets("Tabela splatH").Unprotect haslo
Sheets("FI_hipoSTAND").Unprotect haslo
ActiveWorkbook.Unprotect pass
Application.ScreenUpdating = False
arkDan.Unprotect haslo
Sheets("FI_hipo").Activate
ActiveSheet.PageSetup.PrintArea = "A1:E241"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveWindow.SelectedSheets.PrintOut

If Sheets("hipoteczny").Range("A134").Value = 1 Then



'-------------Generuje harmonogram dla oferty standardowej--------------------------
    
        'Odkkrywa harmonogram splat dla oferty standardowej
    Sheets("Tabela splatH").Columns("eu:ey").Hidden = False
    Sheets("Tabela splatH").Columns("gp:gt").Hidden = False
    
    'Ustawiam WIBOR 3M w harmonogramie dla oferty podstawowej na 5%
    Sheets("Tabela splatH").Select
    Range("GP19").Select
    ActiveCell.FormulaR1C1 = "5%"
    

    'Kopiuje wygenerowany harmonogram do harmonogramu obok
    Range("EU21").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Range("GP21").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.SmallScroll Down:=3
    
    'Ustawiam WIBOR 3M w harmonogramie dla oferty podstawowej na aktualny
    Range("GP19").Select
    ActiveCell.FormulaR1C1 = "=dane!R[11]C[-192]"
    Range("GP20").Select
    
        'Zakrywa harmonogram splat dla oferty standardowej
    Sheets("Tabela splatH").Columns("eu:ey").Hidden = True
    Sheets("Tabela splatH").Columns("gp:gt").Hidden = True
    
    Sheets("FI_hipoSTAND").Visible = True
    Sheets("FI_hipoSTAND").Activate

MsgBox ("Pamietaj o wypelnieniu i wydrukowaniu formularza dla oferty standardowej")

End If




Application.ScreenUpdating = True
'Worksheets("Tabela splatH").Protect haslo
'Worksheets("FI_hipoSTAND").Protect haslo
'arkDan.Protect haslo
'ActiveWorkbook.Protect pass
End Sub
Sub FIHipoSTANDDruk()
'Drukuje formularz dla oferty standardowej
Application.ScreenUpdating = False
ActiveWorkbook.Unprotect pass
Sheets("FI_hipoSTAND").Unprotect haslo
Sheets("Tabela splatH").Unprotect haslo

'-------------Generuje harmonogram dla oferty standardowej--------------------------
    
        'Odkkrywa harmonogram splat dla oferty standardowej
    Sheets("Tabela splatH").Columns("eu:ey").Hidden = False
    Sheets("Tabela splatH").Columns("gp:gt").Hidden = False
    
    'Ustawiam WIBOR 3M w harmonogramie dla oferty podstawowej na 5%
    Sheets("Tabela splatH").Select
    Range("GP19").Select
    ActiveCell.FormulaR1C1 = "5%"
    

    'Kopiuje wygenerowany harmonogram do harmonogramu obok
    Range("EU21").Select
    Range(Selection, Selection.End(xlToRight)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Range("GP21").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWindow.SmallScroll Down:=3
    
    'Ustawiam WIBOR 3M w harmonogramie dla oferty podstawowej na aktualny
    Range("GP19").Select
    ActiveCell.FormulaR1C1 = "=dane!R[11]C[-192]"
    Range("GP20").Select
    
 Sheets("Tabela splatH").Activate


If Sheets("hipoteczny").Range("C145").Value = "M" Then

    Dim Miesiace As Integer
    Miesiace = Range("E17").Value + 20

    Range(Cells(3, 157), Cells(Miesiace, 161)).Select

    Worksheets("Tabela splatH").PageSetup.CenterHorizontally = True
    ActiveSheet.PageSetup.FitToPagesWide = 1
    'Ustawia orientacje strony i szerokosc do wydruku
    
    With Selection
    .PrintOut
    End With
    
    Sheets("Tabela splatH").Activate

    Range(Cells(3, 198), Cells(Miesiace, 202)).Select

    Worksheets("Tabela splatH").PageSetup.CenterHorizontally = True
    ActiveSheet.PageSetup.FitToPagesWide = 1
    'Ustawia orientacje strony i szerokosc do wydruku
    
    With Selection

    .PrintOut
    End With


End If



    'Zakrywa harmonogram splat dla oferty standardowej
    Sheets("Tabela splatH").Columns("eu:ey").Hidden = True
    Sheets("Tabela splatH").Columns("gp:gt").Hidden = True



'Drukuje formularz
Sheets("FI_hipoSTAND").Activate
ActiveSheet.PageSetup.PrintArea = "A1:E241"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveWindow.SelectedSheets.PrintOut

'Sheets("FI_hipoSTAND").Protect haslo
'Sheets("Tabela splatH").Protect haslo
'ActiveWorkbook.Protect pass

End Sub


Sub Hipoteczny_PrzykladReprezentatywny()
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
Application.ScreenUpdating = False
arkDan.Unprotect haslo


If Cells(138, 1).Value = 1 Then
Cells(139, 3).Value = Worksheets("dane").Cells(271, 3)
Cells(144, 3).Value = Worksheets("dane").Cells(271, 4)
Cells(146, 3).Value = Worksheets("dane").Cells(271, 5)
Else
If Cells(138, 1).Value = 2 Then
Cells(139, 3).Value = Worksheets("dane").Cells(272, 3)
Cells(144, 3).Value = Worksheets("dane").Cells(272, 4)
Cells(146, 3).Value = Worksheets("dane").Cells(272, 5)
Else
If Cells(138, 1).Value = 3 Then
Cells(139, 3).Value = Worksheets("dane").Cells(273, 3)
Cells(144, 3).Value = Worksheets("dane").Cells(273, 4)
Cells(146, 3).Value = Worksheets("dane").Cells(273, 5)
Else
If Cells(138, 1).Value = 5 Then
Cells(139, 3).Value = Worksheets("dane").Cells(275, 3)
Cells(144, 3).Value = Worksheets("dane").Cells(275, 4)
Cells(146, 3).Value = Worksheets("dane").Cells(275, 5)

End If
End If
End If
End If


a = MsgBox("Pami|fffd|taj o podaniu wysoko|fffd|ci prowizji oraz innych koszt|fffd|w.", vbOKOnly, "Uzupe|fffd|nij dane")

Application.ScreenUpdating = True

'arkDan.Protect haslo
End Sub



Attribute VB_Name = "Module17"
Sub Przycisk947_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
arkDan.Unprotect haslo
ActiveWorkbook.Unprotect pass
Application.ScreenUpdating = False

If Cells(127, 1).Value = 0 Then
a = MsgBox("Wybierz typ kredytu w polu 127!", vbOKOnly, "Pole wymagane")
Else


Sheets("FI_kons").Visible = True
Sheets("FI_kons").Activate

End If
Application.ScreenUpdating = True
'arkDan.Protect haslo
'ActiveWorkbook.Protect pass
End Sub
Attribute VB_Name = "Module18"
Sub Przycisk12_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("FI_kons")
Application.ScreenUpdating = False
arkDan.Unprotect haslo
Sheets("FI_kons").Activate
ActiveSheet.PageSetup.PrintArea = "A1:E132"
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveWindow.SelectedSheets.PrintOut
Application.ScreenUpdating = True
'arkDan.Protect haslo
End Sub
Attribute VB_Name = "Module19"
Sub Przycisk1295_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
Application.ScreenUpdating = False
arkDan.Unprotect haslo

Union(Range("c129"), Range("C131:c134"), Range("b160:c160"), Range("c184:c185")).Select
With Selection
    .Value = Null
End With

If Cells(127, 1).Value = 1 Or Cells(127, 1).Value = 2 Or Cells(127, 1).Value = 7 Or Cells(127, 1).Value = 8 Then
Worksheets("FI_kons").Unprotect haslo
Worksheets("FI_kons").Cells(1, 6).Value = 0

End If

Application.ScreenUpdating = True

'Worksheets("FI_kons").Protect haslo
'arkDan.Protect haslo

End Sub

Sub Hipoteczny_PrzykladReprCzyszczenie()
'Wstawia dane z przykladu reprezentatywnego do arkusza

Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
Application.ScreenUpdating = False


Union(Range("C139:c140"), Range("c144"), Range("c146"), Range("c156")).Select
With Selection
    .Value = Null
End With


Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module2"
Sub Polewyboru19_Klikniecie()
Dim il_tr, i
Application.ScreenUpdating = False
ActiveSheet.Unprotect haslo
i = 229
If Cells(235, 3) = False Then
ActiveSheet.Rows(228).Hidden = True
Cells(236, 3).Value = 1
ActiveSheet.Range("B239:C257").Value = Null
ActiveSheet.Rows("239:257").Hidden = True
Else
ActiveSheet.Rows(236).Hidden = False
Cells(236, 3).Value = InputBox("Podaj ilo|fffd||fffd| transz kredytu. Maksymalnie 20.", "Transze")
il_tr = Cells(236, 3).Value
    For i = 239 To 239 + il_tr - 2
    ActiveSheet.Rows(i).Hidden = False
    Next i
End If
Application.ScreenUpdating = True
'ActiveSheet.Protect haslo
End Sub
Sub CommandButton1_Click()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect haslo


If Cells(23, 1).Value < 10 Then
   Cells(23, 1).Value = Cells(23, 1).Value + 1
For i = 28 To 123
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Attribute VB_Name = "Module20"

Sub mdm_klik()
ActiveSheet.Unprotect haslo

If ActiveSheet.Cells(159, 1) = True Then
ActiveSheet.Rows("158:172").Hidden = False
Else
ActiveSheet.Rows("158:172").Hidden = True
End If

'ActiveSheet.Protect haslo
End Sub
Sub Rozwin5422_Zmienianie()

If ActiveSheet.Shapes("drop down 5422").ControlFormat.ListIndex = 1 Then
ActiveSheet.Shapes.Range(Array("check box 5411", "mdm")).Visible = True
Else
With ActiveSheet.Shapes.Range(Array("check box 5411", "mdm"))
    .Visible = False
    .Item(1).ControlFormat.Value = False
    .Item(2).ControlFormat.Value = False
End With
mdm_klik
End If

End Sub
Attribute VB_Name = "Module21"
Sub PozaodsetkoweKoszty()
'Dostosowuje komorki sekcji Warunek MPKK do tego czy bank udzielil wnioskodawcy kredytu gotowkowego w ciagu ostatnich 120 dni

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")

Dim i, liczba, wiersze As Integer

If Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.ListIndex = 1 Then
'Usuniecie pol do wpisania kredytow z ostatnich 120 dni, jesli bank nie udzielil ich wnioskodawcy


    Call PozaodsetkoweKosztyNIE
    'Wywolanie procedury PozaodsetkoweKosztyNIE

End If





If Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.ListIndex = 2 Then
'Ustawienie pol do wpisania kredytow z ostatnich 120 dni, jesli bank udzielil ich wnioskodawcy



    Set arkDan = ThisWorkbook.Worksheets("konsumenckie")

    Application.ScreenUpdating = False
    'Przyspieszenie makra
    arkDan.Unprotect haslo
    'Odblkowanie arkusza

    liczba = -1

    Do Until (liczba > 0 And liczba <= 10)

        liczba = InputBox("Podaj ilo|fffd||fffd| kredyt|fffd|w udzielonych w ci|fffd|gu ostatnich 120 dni. Maksymalnie 10.", "Umowy kredytowe")
        'Pobranie liczby wzietych kredytow od uzytkownika

    Loop


    wiersze = 250 + liczba
    'ustalenie do ktorego wiersza nalezy odkryc pola do wpisania kredytow


    For i = 250 To wiersze

        arkDan.Rows(i).Hidden = False
        'Odkrycie wierszy do wpisania kredytow z ostatnich 120 dni

    Next i

    Worksheets("konsumenckie").Columns(4).Hidden = False
    Worksheets("konsumenckie").Columns(5).Hidden = False
    Worksheets("konsumenckie").Columns(6).Hidden = False
    'Odkrycie kolumn tabeli z udzielonymi kredytami

    Range("C263").Select
    ActiveCell.FormulaR1C1 = "=SUM(R[-12]C[3]:R[-3]C[3])+R[-22]C"
    'Ustawienie pozaodsetkowych kosztow w sekcji MPKK jako sumy pozaodsetkowych kosztow kredytow z ostatnich 120 dni i nowego kredytu
    Range("C266").Select
    ActiveCell.FormulaR1C1 = "=R[-15]C"
    'Ustawienie calkowitych kosztow kredytu do liczenia MPKK jako odwolanie do CKK najstarszego kredytu z ostatnich 120 dni
    Range("C268").Select

    End If

Application.ScreenUpdating = True
'Wy|fffd|aczenie przyspieszenia makra

'arkDan.Protect haslo


End Sub

Sub PozaodsetkoweKosztyNIE()
'Usuniecie pol do wpisania kredytow z ostatnich 120 dni, jesli bank nie udzielil ich wnioskodawcy

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
Application.ScreenUpdating = False
'Przyspieszenie makra
arkDan.Unprotect haslo
'Odblkowanie arkusza

arkDan.Rows(250).Hidden = True
'Schowanie wiersza z naglowkami tabeli z udzielonymi kredytami

For i = 251 To 260

    arkDan.Rows(i).Hidden = True
    'Ukrycie pol do wpisania informacji o udzielonych kredytach


    Cells(i, 2).Value = Null
    Cells(i, 3).Value = Null
    Cells(i, 4).Value = Null
    'Wyczyszczenie pol do wpisania informacji o udzielonych kredytach

    Next i

Range("C263").Select
ActiveCell.FormulaR1C1 = "=R[-22]C"
'Ustawienie pozaodsetkowych kosztow w sekcji MPKK jako odwolania do identycznego pola w sekcji Podsumowanie kosztow
Range("C266").Select
ActiveCell.FormulaR1C1 = "=R[-4]C"
'Ustawienie calkowitych kosztow kredytu do liczenia MPKK jako odwolanie do pierwszego CKK w sekcji MPKK

Range("C270").Select


Application.ScreenUpdating = True
'Wy|fffd|aczenie przyspieszenia makra

'arkDan.Protect haslo


End Sub

Attribute VB_Name = "Module22"
Sub PozaodsetkoweGotowka()
'Ustawienie pol w przypadku wybrania kredytu gotowkowego dotyczacych pozaodestkowych kosztow

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")


Range("A127").Value = 1
'Ustawienie pola opisujacego typ kredytu, zgodnie z numeracja w arkuszu dane

Range("A128").Value = "Kredyt got|fffd|wkowy"
'Ustawienie pola opisujacego nazwe typu kredytu

arkDan.Rows(225).Hidden = False
'Odkrycie pola dotyczacego pozaodsetkowych kosztow w podsumowaniu kosztow kredytu

For i = 247 To 249

    arkDan.Rows(i).Hidden = False
    'Odkrycie wierszy do wyboru warunku MPKK

Next i

For i = 261 To 269

    arkDan.Rows(i).Hidden = False
    'Odkrycie wierszy do wyboru warunku MPKK

Next i

'arkDan.Protect haslo

End Sub

Sub PozaodsetkoweNieGotowka()
'Ukrycie pol dotyczacych pozaodsetkowych kosztow

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")

arkDan.Rows(241).Hidden = True
'Ukrycie pola dotyczacego pozaodsetkowych kosztow w podsumowaniu kosztow kredytu

For i = 250 To 269

    arkDan.Rows(i).Hidden = True
    'Ukrycie wierszy do wyboru warunku MPKK

Next i

'arkDan.Protect haslo

End Sub

Sub TypKredytuKons()
'Ustawienie pol zwiazanych z wyborem typu kredytu konsumenckiego

Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
Application.ScreenUpdating = False
'Przyspieszenie makra
arkDan.Unprotect haslo
'Odblkowanie arkusza


Select Case Sheets("konsumenckie").Shapes("drop down 4391").ControlFormat.ListIndex
'W zaleznosci od wybranego typu kredytu wykonywane sa odpowiednie instukcje

    Case 1
    'Jesli wybrano kredyt konsumencki to wykonuja sie ponizsze instrukcje
    
        Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.List = Array("NIE", "TAK")
        'Ustawia pole uruchamiajace pola do wpisania kredytow do waruku MPKK
        
        Call PozaodsetkoweGotowka
        'Ustawia pozostale pola do warunku MPKK
        
        Call NieKarta
        'Chowa pola dla karty kredytowej
    
    Case 2
    'Jesli wybrano kredyt odnawialny to wykonuja sie ponizsze instrukcje
    
        Range("A127").Value = 4
        'Ustawienie pola opisujacego typ kredytu, zgodnie z numeracja w arkuszu dane

        Range("A128").Value = "Kredyt odnawialny w ROR"
        'Ustawienie pola opisujacego nazwe typu kredytu
        
        Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.List = Array("NIE DOTYCZY")
        'Niweluje pole uruchomiajace pola do wpisania kredytow do waruku MPKK
        
        Call PozaodsetkoweNieGotowka
        'Wywolanie procedury ukrywajace pola do warunku MPKK
        
        Call NieKartaROR
        'Chowa pola dla karty kredytowej i dzien splaty
        
        
    Case 3
    'Jesli wybrano karte kredytowa to wykonuja sie ponizsze instrukcje
    
        Range("A127").Value = 7
        'Ustawienie pola opisujacego typ kredytu, zgodnie z numeracja w arkuszu dane

        Range("A128").Value = "Karta kredytowa"
        'Ustawienie pola opisujacego nazwe typu kredytu
        
        Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.List = Array("NIE DOTYCZY")
        'Niweluje pole uruchomiajace pola do wpisania kredytow do waruku MPKK
        
        arkDan.Rows(128).Hidden = False
        'Odkrywa pole do wyboru rodzaju karty
        
        Range("C133").Select
        ActiveCell.FormulaR1C1 = "48"
        Range("C133").Select
        With Selection.Interior
         .Pattern = xlSolid
         .PatternColorIndex = xlAutomatic
         .ThemeColor = xlThemeColorDark1
         .TintAndShade = -0.149998474074526
         .PatternTintAndShade = 0
        End With
        'Wpisanie liczby rat dla karty i zmiana koloru komorki na zablokowana
        
        arkDan.Rows(183).Hidden = False
        'Odkrywa pole do ustalania dnia generowania transakcji dla karty
        
        arkDan.Rows(184).Hidden = True
        'Zakrywa pole do wpisania dnia splaty raty
        
        Range("C184").Select
        Selection.ClearContents
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorDark1
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        'Czysci pole do wpisania dnia splaty raty kredytu
        
        arkDan.Rows(190).Hidden = True
        'Zakrywa kontrolke przypominajaca o wypelnieniu dnia splaty raty
        
        Call PozaodsetkoweNieGotowka
        'Wywolanie procedury ukrywajace pola do warunku MPKK
        
        Range("Y127").Select
        
    Case 4
    'Jesli wybrano karte kredytowa to wykonuja sie ponizsze instrukcje
    
        Range("A127").Value = 8
        'Ustawienie pola opisujacego typ kredytu, zgodnie z numeracja w arkuszu dane

        Range("A128").Value = "Karta charge"
        'Ustawienie pola opisujacego nazwe typu kredytu
        
        Sheets("konsumenckie").Shapes("drop down 4289").ControlFormat.List = Array("NIE DOTYCZY")
        'Niweluje pole uruchomiajace pola do wpisania kredytow do waruku MPKK
        
        Call PozaodsetkoweNieGotowka
        'Wywolanie procedury ukrywajace pola do warunku MPKK
        
        Call NieKarta
        'Chowa pola dla karty kredytowej
        
End Select
    
Application.ScreenUpdating = True
'Wy|fffd|aczenie przyspieszenia makra

'arkDan.Protect haslo



End Sub

Sub NieKarta()
'Instrukcje wykonywane jesli klient nie wybral karty kredytowej


Set arkDan = ThisWorkbook.Worksheets("konsumenckie")

arkDan.Unprotect haslo

Range("C133").Select
Selection.ClearContents
'Czyszczenie liczby rat kredytu

arkDan.Rows(128).Hidden = True
'Zakrywa pole do wyboru rodzaju karty
        

        Range("C133").Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorDark1
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        'Zmiana koloru komorki na odblokowana
        
        arkDan.Rows(183).Hidden = True
        'Zakrywa pole do ustalania dnia generowania transakcji dla karty
        
        arkDan.Rows(184).Hidden = False
        'Odkrywa pole do wpisania dnia splaty raty
        
        Range("C184").Select
        Selection.ClearContents
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorDark1
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        'Czysci pole do wpisania dnia splaty raty kredytu
        
        
        arkDan.Rows(190).Hidden = False
        'Odkrywa kontrolke przypominajaca o wypelnieniu dnia splaty raty
        
        Range("Y127").Select


'arkDan.Protect haslo

End Sub

Sub NieKartaROR()
'Instrukcje wykonywane jesli klient wybral kredyt w ROR


Set arkDan = ThisWorkbook.Worksheets("konsumenckie")

arkDan.Unprotect haslo

Range("C133").Select
Selection.ClearContents
'Czyszczenie liczby rat kredytu

arkDan.Rows(128).Hidden = True
        'Zakrywa pole do wyboru rodzaju karty
        

        Range("C133").Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorDark1
            .TintAndShade = 0
            .PatternTintAndShade = 0
        End With
        'Zmiana koloru komorki na odblokowana
        
        arkDan.Rows(183).Hidden = True
        'Zakrywa pole do ustalania dnia generowania transakcji dla karty
        
        arkDan.Rows(184).Hidden = False
        'Odkrywa pole do wpisania dnia splaty raty
        
        Range("C184").Select
        ActiveCell.FormulaR1C1 = "31"
        Range("C184").Select
        With Selection.Interior
            .Pattern = xlSolid
            .PatternColorIndex = xlAutomatic
            .ThemeColor = xlThemeColorDark1
            .TintAndShade = -0.249977111117893
            .PatternTintAndShade = 0
        End With
        'Ustala dzien splaty na 31
        
        arkDan.Rows(190).Hidden = True
        'Zakrywa kontrolke przypominajaca o wypelnieniu dnia splaty raty
        
        Range("Y127").Select


'arkDan.Protect haslo

End Sub




Attribute VB_Name = "Module23"
Sub DTIMetodologia()
'Dopasowanie metodologii wyznaczania maksymlanego poziomu DTI do opcji wybranej przez uzytkownika

Select Case Sheets("dane").Shapes("drop down 1732").ControlFormat.ListIndex
'W zaleznosci od wybranej opcji zmienia sie metodologia wyznaczania maksymalnego poziomu DTi

    Case 1
    'Jesli wybrano metodologie SGB Banku to wykonuja sie ponizsze instrukcje

    Call DTIStandard
    
    Case 2
    'Jesli wybrano metodologie strategii zarzadzania ryzykiem dla BS to wykonuja sie ponizsze instrukcje

    Call DTIInne
    
End Select



End Sub

Sub DTIInne()

' Ustawia metodologie liczenia maksymalnego DTI zgodnie ze strategia zarz|fffd|dzania ryyzkiem dla BS

Dim PWNSektorPrzedsiebiorstw As Double

PWNSektorPrzedsiebiorstw = 3447.22
'Przecietne wynagrodzenie w sektorze przedsiebiorstw


Range("D224").Select
ActiveCell.FormulaR1C1 = "=3*RC[-1]"
'Zmiana progu kwotowego dla DTI
    
Range("C225").Select
ActiveCell.FormulaR1C1 = "55%"
Range("C226").Select
ActiveCell.FormulaR1C1 = "50%"
Range("C227").Select
ActiveCell.FormulaR1C1 = "45%"
Range("C228").Select
ActiveCell.FormulaR1C1 = "45%"
Range("C229").Select
ActiveCell.FormulaR1C1 = "45%"
Range("C230").Select
ActiveCell.FormulaR1C1 = "45%"
Range("D226").Select
ActiveCell.FormulaR1C1 = "65%"
Range("E225").Select
ActiveCell.FormulaR1C1 = "70%"
Range("E226").Select
ActiveCell.FormulaR1C1 = "65%"
Range("E227").Select
ActiveCell.FormulaR1C1 = "60%"
Range("E228").Select
ActiveCell.FormulaR1C1 = "60%"
Range("E229").Select
ActiveCell.FormulaR1C1 = "60%"
Range("E230").Select
ActiveCell.FormulaR1C1 = "60%"
'Zmiana maksymalnych wartosci DTI

Range("G227").Select
ActiveCell.FormulaR1C1 = "0%"
Range("G228").Select
ActiveCell.FormulaR1C1 = "0%"
Range("G229").Select
ActiveCell.FormulaR1C1 = "-5%"
Range("G230").Select
ActiveCell.FormulaR1C1 = "-5%"
Range("G231").Select
ActiveCell.FormulaR1C1 = "-5%"
Range("G232").Select
ActiveCell.FormulaR1C1 = "5%"
'Zmiana czastkowych DTI ze wzgledu na miejsce zamieszkania

Range("F235").Select
Selection.ClearContents
'Wyczyszczenie pola: Wybor koncowego DTi

Range("F242").Select
ActiveCell.FormulaR1C1 = "TAK"
'Zmiana pola: uwzgl|fffd|dnia|fffd| do ko|fffd|cowego DTI?

Range("B244").Select
ActiveCell.FormulaR1C1 = "=SUM(R[-6]C[7]:R[-2]C[7])"
'Zmiana finalnego pola DTI dla Wnioskodawcow
Range("C244").Select
ActiveCell.FormulaR1C1 = "=SUM(R[-5]C[6]:R[-2]C[6],R[-6]C[7])"
'Zmiana finalnego pola DTI w tym: analiza emerytalna
Range("D244").Select
ActiveCell.FormulaR1C1 = "=SUM(R[-6]C[7]:R[-2]C[7])"
'Zmiana finalnego pola DTI Poreczyciele
Range("E244").Select
ActiveCell.FormulaR1C1 = "=SUM(R[-6]C[7]:R[-2]C[7])"
'Zmiana finalnego pola DTI Wstepna analiza

Range("C223").Select
ActiveCell.FormulaR1C1 = "Przeci|fffd|tne miesi|fffd|czne wynagrodzenie netto w sektorze przedsi|fffd|biorstw (PWN)"
'Opisanie typu dochodu uwzglednianego w analizie

Range("D223").Select
ActiveCell.FormulaR1C1 = "3*PWN"
'Podanie progu do analizy DTI

Range("C224").Select
ActiveCell.FormulaR1C1 = PWNSektorPrzedsiebiorstw
'Wpisanie przecietnego wynagrodzenia




End Sub

Sub DTIStandard()

' Ustawia metodologie liczenia maksymalnego DTI zgodnie z polityka kredytowa SGB Banku

Dim PWN As Double

PWN = 3437.96
'Przecietne wynagrodzenie w gospodarce

Range("D224").Select
ActiveCell.FormulaR1C1 = "=2*RC[-1]"
'Zmiana progu kwotowego dla DTI

Range("C225").Select
ActiveCell.FormulaR1C1 = "60%"
Range("C226").Select
ActiveCell.FormulaR1C1 = "60%"
Range("C227").Select
ActiveCell.FormulaR1C1 = "50%"
Range("C228").Select
ActiveCell.FormulaR1C1 = "50%"
Range("C229").Select
ActiveCell.FormulaR1C1 = "50%"
Range("C230").Select
ActiveCell.FormulaR1C1 = "50%"
Range("D226").Select
ActiveCell.FormulaR1C1 = "70%"
Range("E225").Select
ActiveCell.FormulaR1C1 = "80%"
Range("E226").Select
ActiveCell.FormulaR1C1 = "80%"
Range("E227").Select
ActiveCell.FormulaR1C1 = "65%"
Range("E228").Select
ActiveCell.FormulaR1C1 = "65%"
Range("E229").Select
ActiveCell.FormulaR1C1 = "65%"
Range("E230").Select
ActiveCell.FormulaR1C1 = "65%"
'Zmiana maksymalnych wartosci DTI
    
Range("G227").Select
ActiveCell.FormulaR1C1 = "55%"
Range("G228").Select
ActiveCell.FormulaR1C1 = "60%"
Range("G229").Select
ActiveCell.FormulaR1C1 = "60%"
Range("G230").Select
ActiveCell.FormulaR1C1 = "60%"
Range("G231").Select
ActiveCell.FormulaR1C1 = "75%"
Range("G232").Select
ActiveCell.FormulaR1C1 = "50%"
'Zmiana czastkowych DTI ze wzgledu na miejsce zamieszkania
    

Range("F235").Select
ActiveCell.FormulaR1C1 = "maksymalny"
'Zmiana pola: Wybor koncowego DTi

Range("F242").Select
ActiveCell.FormulaR1C1 = "NIE"
'Zmiana pola: uwzgl|fffd|dnia|fffd| do ko|fffd|cowego DTI?

Range("B244").Select
ActiveCell.FormulaR1C1 = _
    "=IF(R235C6=""minimalny"",MIN(R[-6]C[7]:R[-2]C[7]),IF(R235C6=""|fffd|redni"",AVERAGE(R[-6]C[7]:R[-2]C[7]),MAX(R[-6]C[7]:R[-2]C[7])))"
'Zmiana finalnego pola DTI dla Wnioskodawcow

Range("C244").Select
ActiveCell.FormulaR1C1 = _
    "=IF(R235C6=""minimalny"",MIN(R[-5]C[6]:R[-2]C[6],R[-6]C[7]),IF(R235C6=""|fffd|redni"",AVERAGE(R[-5]C[6]:R[-2]C[6],R[-6]C[7]),MAX(R[-5]C[6]:R[-2]C[6],R[-6]C[7])))"
'Zmiana finalnego pola DTI w tym: analiza emerytalna
    
Range("D244").Select
ActiveCell.FormulaR1C1 = _
    "=IF(R235C6=""minimalny"",MIN(R[-6]C[7]:R[-2]C[7]),IF(R235C6=""|fffd|redni"",AVERAGE(R[-6]C[7]:R[-2]C[7]),MAX(R[-6]C[7]:R[-2]C[7])))"
'Zmiana finalnego pola DTI Poreczyciele
    
Range("E244").Select
ActiveCell.FormulaR1C1 = _
    "=IF(R235C6=""minimalny"",MIN(R[-6]C[7]:R[-2]C[7]),IF(R235C6=""|fffd|redni"",AVERAGE(R[-6]C[7]:R[-2]C[7]),MAX(R[-6]C[7]:R[-2]C[7])))"
'Zmiana finalnego pola DTI Wstepna analiza

Range("C223").Select
ActiveCell.FormulaR1C1 = "Przeci|fffd|tne miesi|fffd|czne wynagrodzenie netto (PWN)"
'Opisanie typu dochodu uwzglednianego w analizie

Range("D223").Select
ActiveCell.FormulaR1C1 = "2*PWN"
'Podanie progu do analizy DTI

Range("C224").Select
ActiveCell.FormulaR1C1 = PWN
'Wpisanie przecietnego wynagrodzenia
   

End Sub


Attribute VB_Name = "Module24"
Sub ArchiwizacjaHipoteczny()

'Archiwizacja danych z arkusza hipoteczny

Application.ScreenUpdating = False
'Wlaczenie przyspieszenia makra

kalkulator = ActiveWorkbook.Name
'Zapisanie nazwy aktualnego kalkulatora

ActiveWorkbook.Unprotect pass
'Odblokowanie skoroszytu

Worksheets("Dochody").Unprotect haslo
Worksheets("hipoteczny").Unprotect haslo
'Odblokowanie arkuszy

Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Export"
Range("A1").Select
'Tworzenie nowego arkusza

'Imie, nazwisko i dochod calkowity
Sheets("Dochody").Select
Range("E14").Select
Sheets("Export").Select
Range("B1").Select

For i = 1 To 16

    Sheets("Dochody").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    Sheets("Dochody").Select
    ActiveCell.Offset(20, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    ActiveCell.Offset(0, 4).Range("A1").Select
    Sheets("Dochody").Select
    ActiveCell.Offset(-20, 1).Range("A1").Select
    
Next i

'Zobowiazania kredytowe oraz finansowe - trwale i inne
'Wiersze 121(odwolanie bezposrednie), 127, 130
Sheets("hipoteczny").Select
Range("C121").Select
Sheets("Export").Select
Range("D1").Select

For i = 1 To 16

    Sheets("hipoteczny").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    Sheets("hipoteczny").Select
    ActiveCell.Offset(6, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
     Sheets("hipoteczny").Select
    ActiveCell.Offset(3, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    ActiveCell.Offset(0, 3).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(-9, 1).Range("A1").Select
    
Next i


'Miejsce zamieszkania, status mieszkaniowy, suma dochodow gospodarstwa, liczba osob w gospodarstwie, oplaty na mieszkanie,
'oplaty na zycie, suma obciazen
'wiersze 15(odwolanie bezposrednie), 16 - 19, 126, 128, 129, 131
Sheets("Export").Select
Range("CD1").Select
Sheets("hipoteczny").Select
Range("C15").Select


For i = 1 To 4

    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(1, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(3, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(107, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(2, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(1, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("hipoteczny").Select
    ActiveCell.Offset(2, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(-116, 4).Range("A1:D1").Select
Next i

'Dochody dla wniosku
'Wiersz 20
ActiveCell.Offset(5, -19).Range("A1:P1").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select

'Typ kredytu
'Wiersz 135
Sheets("hipoteczny").Select
ActiveCell.Offset(115, -2).Range("A1").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select

'Sekcja: Dane dotycz|fffd|ce wnioskowanego kredytu
'Wiersze 138-150
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 2).Range("A1:A13").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
ActiveCell.Offset(0, 3).Range("A1").Select

'Zmiana formatu danych procentowych
ActiveCell.Offset(0, 1).Range("A1").Select
Application.CutCopyMode = False
Selection.Style = "Percent"
Selection.NumberFormat = "0.0%"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 3).Range("A1:C1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.0%"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.0%"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 1).Range("A1").Select

'Rata do zdolnosci, maksymalna rata kredytu, CKI

Sheets("hipoteczny").Select
ActiveCell.Offset(14, 0).Range("A1:A2").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("hipoteczny").Select
ActiveCell.Offset(3, 0).Range("A1").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select



'Nieruchomosci zabezpieczajace
'Wiersze 182-196
Sheets("hipoteczny").Select
ActiveCell.Offset(27, 0).Range("A1:A4").Select

For i = 1 To 3

    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=True
    ActiveCell.Offset(0, 4).Range("A1").Select
    Sheets("hipoteczny").Select
    ActiveCell.Offset(6, 0).Range("A1:A4").Select

Next i



'Suma wartosci nieruchomosci
'Wiersze 200-201
ActiveCell.Range("A1:A2").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True


'Srodki wlasne
'Wiersze 204-215
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1:A10").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("hipoteczny").Select
ActiveCell.Offset(11, 0).Range("A1").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 10).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False



'LTV
'Wiersz 224
Sheets("hipoteczny").Select
ActiveCell.Offset(9, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
'Wiersz 219
Sheets("hipoteczny").Select
ActiveCell.Offset(-5, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True


'Wiersze 225-226
Sheets("hipoteczny").Select
ActiveCell.Offset(6, 0).Range("A1:A2").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True


'DTI
'Wiersze 229-231
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
    

'Kalkulacja kosztow kredytu
'Wiersze 251-256
Sheets("hipoteczny").Select
ActiveCell.Offset(30, 0).Range("A1").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(2, 0).Range("A1:A4").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True


'Przewidywany termin ubowi|fffd|zywania ubezpieczenia pomostowego
'Wiersz 258
Sheets("hipoteczny").Select
ActiveCell.Offset(5, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 4).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Koszt ustanowienia hipoteki, Koszt op|fffd|at s|fffd|dowych za wniosek o wpis, Podatek od czynno|fffd|ci cywilno - prawnych
'Wiersz 270-272
Sheets("hipoteczny").Select
ActiveCell.Offset(3, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True

'Inne koszty ustanowienia hipoteki
'Wiersz 273
Sheets("hipoteczny").Select
ActiveCell.Offset(3, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Koszt wystawienia weksla in blanco, Razem koszty zwi|fffd|zane z ustanowieniem zabezpieczenia sp|fffd|aty kredytu
'Wiersz 275, 276
Sheets("hipoteczny").Select
ActiveCell.Offset(2, 0).Range("A1:A2").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
    
'Koszty ubezpieczenia
'Wiersz 311,314,317
Sheets("hipoteczny").Select
    ActiveCell.Offset(36, 0).Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 3).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("hipoteczny").Select
    ActiveCell.Offset(3, 0).Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("hipoteczny").Select
    ActiveCell.Offset(3, 0).Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
'Koszty zmiany zabezpieczenia
'Wiersze 286-288
Sheets("hipoteczny").Select
ActiveCell.Offset(-31, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
    
'Koszty zwolnienia zabezpieczenia
'Wiersz 292-294
Sheets("hipoteczny").Select
ActiveCell.Offset(6, 0).Range("A1:A3").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True


'Oplata za odpis z ksiegi, operat szacunkowy
'Wiersza 298, 299
Sheets("hipoteczny").Select
ActiveCell.Offset(6, 0).Range("A1:A2").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
'Oplata za inspekcje
'Wiersz 302
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Inne koszty - zabezpieczenia
'Wiersz 304
Sheets("hipoteczny").Select
ActiveCell.Offset(2, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Pozostale koszty niezwiazane z zabezpieczeniem splaty wchodzace do CKK
'Wiersz 337
Sheets("hipoteczny").Select
ActiveCell.Offset(33, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Pozosta|fffd|e koszty kredytu niezwi|fffd|zane z zabezpieczeniem sp|fffd|aty kredytu, niewchodz|fffd|ce w sk|fffd|ad Ca|fffd|kowitego Kosztu Kredytu
'Wiersz 341
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    

'Koszt ustanowienia i zwolnienia prawnego zabezpieczenia sp|fffd|aty kredytu z wyj|fffd|tkiem op|fffd|at notarialnych ponoszonych przez kredytobiorc|fffd|
'Wiersz 350
Sheets("hipoteczny").Select
ActiveCell.Offset(9, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
    
'Calkowity koszt kredytu, Calkowita kwota do zaplaty, RRSO
'Wiersze 361-363
Sheets("hipoteczny").Select
ActiveCell.Offset(11, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
        
'Wolne |fffd|rodki do obs|fffd|ugi wnioskowanego kredytu (Podsumowanie aktualnie)
'Wiersz 340
Sheets("hipoteczny").Select
ActiveCell.Offset(10, 0).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


'Nadwyzka wolnych srodkow (Podsumowanie aktualnie)
'Wiersz 341
Sheets("hipoteczny").Select
ActiveCell.Offset(1, -12).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False



'Czy spe|fffd|niono warunek wystarczaj|fffd|cego dochodu? (Podsumowanie aktualnie)
'Wiersz 342
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


'Czy gospodarstwo mo|fffd|e uzyska|fffd| kredyt? (Podsumowanie aktualnie)
'Wiersz 346
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


'Czy wnioskodawcy mog|fffd| uzyska|fffd| kredyt? (Podsumowanie (emerytura))
'Wiersz 347
Sheets("hipoteczny").Select
ActiveCell.Offset(1, -12).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


'Czy wnioskodawcy mog|fffd| uzyska|fffd| kredyt? (Podsumowanie (emerytura))
'Wiersz 350
ActiveCell.Offset(0, 1).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(3, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Podsumowanie (emerytura)
'Wiersze 351-357
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 16).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

'Podsumowanie zdolno|fffd|ci kredytowej
'Wiersze 361-367
ActiveCell.Offset(0, 1).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("hipoteczny").Select
ActiveCell.Offset(4, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Data sporzadzenia wniosku
'Wiersze 371
ActiveCell.Offset(0, -229).Range("A1").Select
Sheets("hipoteczny").Select
ActiveCell.Offset(4, -1).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

        



'Zmiana formatow skopiowanych danych
Call ZmianaFormatowHipo

'Kopiuje dane, ktore zostana przeniesione do osobnego pliku
Range("A1:HV1").Select
Selection.Copy

Call MsgBox("Kliknij przycisk OK i wybierz plik, do ktorego zapiszesz dane", , "Uwaga!")

fileToOpen = Application.GetOpenFilename
Workbooks.Open fileToOpen
'Wybranie pliku do archiwizacji danych przez uzytkownika
    
Sheets("hipoteczny").Select
Range("A1").Select
ActiveCell.SpecialCells(xlLastCell).Select
ActiveCell.Offset(0, -229).Range("A1").Select
'Przejscie na pierwsza pusta komorke w kolejnym pustym wierszu w pliku do archiwizacji danych

ActiveSheet.Paste
'Wklejenie kopiowanych komorek

'Ustawienie formatu skopiowanych danych
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    

Windows(kalkulator).Activate
'Powrot do kalkulatora

Sheets("Export").Select
Application.DisplayAlerts = False
ActiveWindow.SelectedSheets.Delete
Application.DisplayAlerts = True
'Usuniecie roboczego arkusza
    




Worksheets("Dochody").Protect haslo
Worksheets("hipoteczny").Protect haslo
'Zablokowanie arkuszy

ActiveWorkbook.Protect pass
'Zablokowanie skoroszytu

Sheets("hipoteczny").Select

Application.ScreenUpdating = True
'Wylaczenie przyspieszenia makra


End Sub

Sub ZmianaFormatowHipo()
'Ustawia formaty kopiowanych danych

'Data sporzadzenia wniosku
Range("A1").Select
Application.CutCopyMode = False
Selection.NumberFormat = "m/d/yyyy"

'Dochody i zobowi|fffd|zania wnioskodawcow
Range("C1").Select

For i = 1 To 16

    ActiveCell.Range("A1:D1").Select
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 5).Range("A1").Select

Next i

'Dochody i zobowi|fffd|zania gospodarstw
ActiveCell.Offset(0, 1).Range("A1").Select

For i = 1 To 4

    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 2).Range("A1").Select
    ActiveCell.Range("A1:C1").Select
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 5).Range("A1").Select
    

Next i

'Suma dochodow dla wniosku
ActiveCell.Offset(0, -2).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Wnioskowane kwoty kredytow
ActiveCell.Offset(0, 2).Range("A1:C1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    
'Prowizja w PLN
ActiveCell.Offset(0, 10).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
   
'Rata kredytu do oszacowania zdolno|fffd|ci, Wysoko|fffd||fffd| maksymalnej raty, CKI
ActiveCell.Offset(0, 3).Range("A1:C1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    
'Poszczegolne nieruchomosci zabezpieczajace
ActiveCell.Offset(0, 3).Range("A1").Select

For i = 1 To 3
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 2).Range("A1:B1").Select
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 2).Range("A1").Select

Next i

'Zsumowane nieruchomosci zabezpieczajace
ActiveCell.Range("A1:B1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Wymagane |fffd|rodki w|fffd|asne (procentowo)
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Wymagane |fffd|rodki w|fffd|asne (kwotowo)
ActiveCell.Offset(0, 1).Range("A1:H1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
ActiveCell.Offset(0, 9).Range("A1").Select

'LtV i DTI
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 2).Range("A1:B1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 3).Range("A1").Select

'Daty zwiazane z transzami
ActiveCell.Range("A1:C1").Select
Selection.NumberFormat = "m/d/yyyy"
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.NumberFormat = "m/d/yyyy"

'Koszty dodatkowe
ActiveCell.Offset(0, 1).Range("A1:R1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Koszty dodatkowe c.d.
ActiveCell.Offset(0, 19).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Podsumowanie kosztow
ActiveCell.Offset(0, 5).Range("A1:B1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'RRSO
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Wolne srodki i nadwyzka wolnych srodkow
ActiveCell.Offset(0, 1).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    
'Doch|fffd|d do oceny, suma dochodow, rata kredytu do oceny zdolnosci (Podsumowanie (emerytura))
ActiveCell.Offset(0, 11).Range("A1:R1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'DTI (Podsumowanie (emerytura))
ActiveCell.Offset(0, 18).Range("A1:B1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.0%"
Selection.NumberFormat = "0.00%"

'Nadwy|fffd|ka / niedob|fffd|r (Podsumowanie (emerytura))
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Nadwy|fffd|ka / niedob|fffd|r (Podsumowanie zdolno|fffd|ci kredytowej)
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


End Sub


Attribute VB_Name = "Module25"
Sub ArchiwizacjaKonsumenckie()

'Archiwizacja danych z arkusza konsumenckie

Dim typ As Integer

Application.ScreenUpdating = False
'Wlaczenie przyspieszenia makra

ActiveWorkbook.Unprotect pass
'Odblokowanie skoroszytu

Worksheets("Dochody").Unprotect haslo
Worksheets("konsumenckie").Unprotect haslo
'Odblokowanie arkuszy

kalkulator = ActiveWorkbook.Name
'Zapisanie nazwy aktualnego kalkulatora

Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Export"
Range("A1").Select
'Tworzenie nowego arkusza

'Imie, nazwisko i dochod calkowity
Sheets("Dochody").Select
Range("E14").Select
Sheets("Export").Select
Range("B1").Select

For i = 1 To 16

    Sheets("Dochody").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    Sheets("Dochody").Select
    ActiveCell.Offset(20, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    ActiveCell.Offset(0, 4).Range("A1").Select
    Sheets("Dochody").Select
    ActiveCell.Offset(-20, 1).Range("A1").Select
    
Next i


'Zobowiazania kredytowe oraz finansowe - trwale i inne
'Wiersze 111(odwolanie bezposrednie), 117, 120
Sheets("konsumenckie").Select
Range("C111").Select
Sheets("Export").Select
Range("D1").Select

For i = 1 To 16

    Sheets("konsumenckie").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    Sheets("konsumenckie").Select
    ActiveCell.Offset(6, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
     Sheets("konsumenckie").Select
    ActiveCell.Offset(3, 0).Range("A1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    ActiveCell.Offset(0, 3).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(-9, 1).Range("A1").Select
    
Next i


'Miejsce zamieszkania, status mieszkaniowy, suma dochodow gospodarstwa, liczba osob w gospodarstwie, oplaty na mieszkanie,
'oplaty na zycie, suma obciazen
'wiersze 12(odwolanie bezposrednie), 13, 16, 116, 118, 119, 121
Sheets("Export").Select
Range("CD1").Select
Sheets("konsumenckie").Select
Range("C12").Select


For i = 1 To 4

    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(1, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(3, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(100, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(2, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(1, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("konsumenckie").Select
    ActiveCell.Offset(3, 0).Range("A1:D1").Select
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Sheets("konsumenckie").Select
    ActiveCell.Offset(-110, 4).Range("A1:D1").Select
Next i

'Dochody dla wniosku
'Wiersz 17
ActiveCell.Offset(5, -19).Range("A1:P1").Select
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
ActiveCell.Offset(0, 1).Range("A1").Select

'Typ kredytu
'Wiersz 128
Sheets("konsumenckie").Select
ActiveCell.Offset(111, -2).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
      
'Dane dotycz|fffd|ce wnioskowanego kredytu
'Wiersz 128 - 148
Sheets("konsumenckie").Select

'Wiersz 127
typ = Range("A127").Value
'okreslam wartosc liczbowa opisujaca typ kredytu

ActiveCell.Offset(0, 2).Range("A1").Select

If typ = karta Then

    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
Else

    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    
End If
'Jesli wybrano karte to kopiuje rodzaj karty

Sheets("konsumenckie").Select
ActiveCell.Offset(1, 0).Range("A1:A6").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("konsumenckie").Select
ActiveCell.Offset(8, 0).Range("A1:A8").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 6).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("konsumenckie").Select
ActiveCell.Offset(9, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 8).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
    
    
'DTI
'Wiersze 152-154
ActiveCell.Offset(0, 3).Range("A1").Select
Sheets("konsumenckie").Select
ActiveCell.Offset(6, 0).Range("A1:A3").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True

        
'Kalkulacja koszt|fffd|w kredytu
'Wiersze 182-188
Sheets("konsumenckie").Select
ActiveCell.Offset(30, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
        
        
If typ = karta Then

    ActiveCell.Offset(1, 0).Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    ActiveCell.Offset(1, 0).Range("A1").Select
    Sheets("Export").Select
    ActiveCell.Offset(0, 1).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False
    ActiveCell.Offset(0, 2).Range("A1").Select
    
Else

    ActiveCell.Offset(2, 0).Range("A1").Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Export").Select
    ActiveCell.Offset(0, 2).Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False
    ActiveCell.Offset(0, 1).Range("A1").Select

End If
    
Sheets("konsumenckie").Select
ActiveCell.Offset(1, 0).Range("A1:A4").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
        
        
'Koszty zwi|fffd|zane z zabezpieczeniem sp|fffd|aty kredytu
'Ubezpieczenie
'Wiersze 193-197
Sheets("konsumenckie").Select
ActiveCell.Offset(8, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 4).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(-1, -2).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(4, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 2).Range("A1:A2").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
        
'Pozostale koszty zwi|fffd|zane z zabezpieczeniem sp|fffd|aty kredyt
'Wiersze 201-209
Sheets("konsumenckie").Select
ActiveCell.Offset(5, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(4, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(4, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
        
'Koszty zwi|fffd|zane z kartami kredytowymi i charge
'Wiersze 214-215
Sheets("konsumenckie").Select
ActiveCell.Offset(5, 0).Range("A1:A2").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
        
'Podsumowanie koszt|fffd|w
'Wiersze 221-229
Sheets("konsumenckie").Select
ActiveCell.Offset(7, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(2, 0).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(2, 0).Range("A1:A5").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("konsumenckie").Select

'Podsumowanie zdolnosci
'Wiersze 256-261
ActiveCell.Offset(31, 0).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(1, -12).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(1, 0).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(2, 0).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(0, 4).Range("A1:D1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
Sheets("konsumenckie").Select
ActiveCell.Offset(1, -12).Range("A1:P1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False
    
'Data sporzadzenia wniosku
'Wiersz 265
Sheets("konsumenckie").Select
ActiveCell.Offset(4, -1).Range("A1").Select
Application.CutCopyMode = False
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, -166).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False


Call ZmianaFormatowKons

'Kopiuje dane, ktore zostana przeniesione do osobnego pliku
Range("A1:FK1").Select
Selection.Copy
    
Call MsgBox("Kliknij przycisk OK i wybierz plik, do ktorego zapiszesz dane", , "Uwaga!")

fileToOpen = Application.GetOpenFilename
Workbooks.Open fileToOpen
'Wybranie pliku do archiwizacji danych przez uzytkownika
    
Sheets("konsumenckie").Select
Range("A1").Select
ActiveCell.SpecialCells(xlLastCell).Select
ActiveCell.Offset(0, -166).Range("A1").Select
'Przejscie na pierwsza pusta komorke w kolejnym pustym wierszu w pliku do archiwizacji danych

ActiveSheet.Paste
'Wklejenie kopiowanych komorek

'Ustawienie formatu skopiowanych danych
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
Windows(kalkulator).Activate
'Powrot do kalkulatora

Sheets("Export").Select
Application.DisplayAlerts = False
ActiveWindow.SelectedSheets.Delete
Application.DisplayAlerts = True
'Usuniecie roboczego arkusza



Worksheets("Dochody").Protect haslo
Worksheets("konsumenckie").Protect haslo
'Zablokowanie arkuszy

ActiveWorkbook.Protect pass
'Zablokowanie skoroszytu

Sheets("konsumenckie").Select
        
        
Application.ScreenUpdating = True
'Wylaczenie przyspieszenia makra

End Sub



Sub ZmianaFormatowKons()
'Ustawia formaty kopiowanych danych


'Data sporzadzenia wniosku
Range("A1").Select
Application.CutCopyMode = False
Selection.NumberFormat = "m/d/yyyy"

'Dochody i zobowi|fffd|zania wnioskodawcow
Range("C1").Select

For i = 1 To 16

    ActiveCell.Range("A1:D1").Select
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 5).Range("A1").Select

Next i

'Dochody i zobowi|fffd|zania gospodarstw
ActiveCell.Offset(0, 1).Range("A1").Select

For i = 1 To 4

    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 2).Range("A1").Select
    ActiveCell.Range("A1:C1").Select
    Selection.NumberFormat = _
        "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    ActiveCell.Offset(0, 5).Range("A1").Select
    

Next i

'Suma dochodow dla wniosku
ActiveCell.Offset(0, -2).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Wnioskowana kwota kredytu
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Oprocentowanie kredytu
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"


'Prowizje w procentach
ActiveCell.Offset(0, 3).Range("A1:C1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Prowizje w PLN
ActiveCell.Offset(0, 3).Range("A1:B1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Bufor bezpieczenstwa
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Rata do zdolnosci, maksymalna rata, dzienne odsettki
 ActiveCell.Offset(0, 1).Range("A1:C1").Select
 Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
    
'DTI
ActiveCell.Offset(0, 3).Range("A1:B1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Daty do harmonogramu splaty
ActiveCell.Offset(0, 3).Range("A1").Select
Selection.NumberFormat = "m/d/yyyy"
ActiveCell.Offset(0, 3).Range("A1:B1").Select
Selection.NumberFormat = "m/d/yyyy"

'Koszty zwi|fffd|zane z zabezpieczeniem sp|fffd|aty kredytu
ActiveCell.Offset(0, 4).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
ActiveCell.Offset(0, 3).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Koszty zwi|fffd|zane z kartami kredytowymi i charge
ActiveCell.Offset(0, 5).Range("A1:B1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Podsumowanie koszt|fffd|w
ActiveCell.Offset(0, 2).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.0%"
Selection.NumberFormat = "0.00%"
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Podsumowanie zdolno|fffd|ci
ActiveCell.Offset(0, 7).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"




End Sub








Attribute VB_Name = "Module26"
Sub ArchiwizacjaWstepnaAnaliza()

'Archiwizacja danych z arkusza wstepna analiza

Application.ScreenUpdating = False
'Wlaczenie przyspieszenia makra

ActiveWorkbook.Unprotect pass
'Odblokowanie skoroszytu

Worksheets("wst|fffd|pna analiza").Unprotect haslo
'Odblokowanie arkusza

kalkulator = ActiveWorkbook.Name
'Zapisanie nazwy aktualnego kalkulatora

Sheets.Add After:=Sheets(Sheets.Count)
ActiveSheet.Name = "Export"
Range("A1").Select
'Tworzenie nowego arkusza

Sheets("wst|fffd|pna analiza").Select

'Dochod i ilosc osob w gospodarstwie
Range("B11:B12").Select
Selection.Copy

Sheets("Export").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=True
Sheets("wst|fffd|pna analiza").Select

'Miejsce zamieszkania
Range("B14").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Sheets("wst|fffd|pna analiza").Select

'Zobowiazania kredytowe, finansowe, inne obciazenia finansowe, koszty mieszkania i utrzymania
Range("B20:B24").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("wst|fffd|pna analiza").Select

'Wnioskowana kwota kredytu, oprocentowanie, liczba rat, system splaty, wysokosc raty
Range("B29:B33").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("wst|fffd|pna analiza").Select

'Wolne srodki, nadwyzka do dyspozycji
Range("B36:B37").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("wst|fffd|pna analiza").Select

'Czy spelniono warunek DTI, czy wnioskodawcy moga ubiegac sie o kredyt
Range("B39:B40").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=True
Sheets("wst|fffd|pna analiza").Select

'Maksymalna kwota kredytu
Range("B42").Select
Selection.Copy
Sheets("Export").Select
ActiveCell.Offset(0, 2).Range("A1").Select
Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
    :=False, Transpose:=False

Call ZmianaFormatowWstepnaAnaliza

'Kopiuje dane, ktore zostana przeniesione do osobnego pliku
Range("A1:R1").Select
Selection.Copy
    
Call MsgBox("Kliknij przycisk OK i wybierz plik, do ktorego zapiszesz dane", , "Uwaga!")

fileToOpen = Application.GetOpenFilename
Workbooks.Open fileToOpen
'Wybranie pliku do archiwizacji danych przez uzytkownika
    
Sheets("wst|fffd|pna analiza").Select
Range("A1").Select
ActiveCell.SpecialCells(xlLastCell).Select
ActiveCell.Offset(0, -17).Range("A1").Select
'Przejscie na pierwsza pusta komorke w kolejnym pustym wierszu w pliku do archiwizacji danych

ActiveSheet.Paste
'Wklejenie kopiowanych komorek

'Ustawienie formatu skopiowanych danych
With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With


Windows(kalkulator).Activate
'Powrot do kalkulatora

Sheets("Export").Select
Application.DisplayAlerts = False
ActiveWindow.SelectedSheets.Delete
Application.DisplayAlerts = True
'Usuniecie roboczego arkusza

'Worksheets("wst|fffd|pna analiza").Protect haslo
'Zablokowanie arkusza

Sheets("wst|fffd|pna analiza").Select

ActiveWorkbook.Protect pass
'Zablokowanie skoroszytu

Application.ScreenUpdating = True
'Wylaczenie przyspieszenia makra


End Sub


Sub ZmianaFormatowWstepnaAnaliza()
'Ustawia formaty kopiowanych danych

'Deklarowany doch|fffd|d wnioskodawcw
Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"


'Obciazenia i zobowiazania wnioskodawcy
ActiveCell.Offset(0, 3).Range("A1:E1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Wnioskowana kwota kredytu
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Oprocentowanie kredytu
ActiveCell.Offset(0, 1).Range("A1").Select
Selection.Style = "Percent"
Selection.NumberFormat = "0.00%"

'Prognozowana wysokosc raty, Wolne srodki, Nadwyzka/niedobor srodkow
ActiveCell.Offset(0, 3).Range("A1:C1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"

'Maksymalna dostepna wysokosc kredytu
ActiveCell.Offset(0, 5).Range("A1").Select
Selection.NumberFormat = _
    "_-* #,##0.00 [$z|fffd|-415]_-;-* #,##0.00 [$z|fffd|-415]_-;_-* ""-""?? [$z|fffd|-415]_-;_-@_-"









End Sub




Attribute VB_Name = "Module27"
Sub TypOferty()
Attribute TypOferty.VB_ProcData.VB_Invoke_Func = " \n14"
'Wykonuja sie instrukcje w zaleznosci od wybranej oferty

Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
Application.ScreenUpdating = False
'Przyspieszenie makra
arkDan.Unprotect haslo
'Odblkowanie arkusza


Select Case Sheets("hipoteczny").Shapes("drop down 9516").ControlFormat.ListIndex
'W zaleznosci od wybranego typu oferty wykonywane sa odpowiednie instukcje

    Case 1
    'Jesli wybrano oferte standardow to wykonuja sie ponizsze instrukcje
    
    'Wpisuje oznaczenie ze wybrano oferte standardowa
    Range("A134").Select
    ActiveCell.FormulaR1C1 = "0"
    Range("C136").Select
    
    'Czyszczenie pol z miejscem na wpisanie wysokosci ubezpieczenia w ofercie standardowej
        Union(Range("c312"), Range("c315")).Select
        
With Selection
    .Value = Null
End With

    'Chowam wiersze na wpisanie wartosci ubezpieczenia w ofercie standardowej
    arkDan.Rows(312).Hidden = True
    arkDan.Rows(315).Hidden = True
    

    
    Case 2
    'Jesli wybrano oferte laczona to wykonuja sie ponizsze instrukcje
    
    'Wpisuje oznaczenie ze wybrano oferte laczona
    Range("A134").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("C136").Select
    


    'Chowam wiersze na wpisanie wartosci ubezpieczenia w ofercie standardowej
    arkDan.Rows(312).Hidden = False
    arkDan.Rows(315).Hidden = False
    

    
    
    
    
    End Select
    
'arkDan.Protect haslo
End Sub
Attribute VB_Name = "Module3"
Sub Przycisk73_Klikniecie()
Dim i, n As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("hipoteczny")
arkDan.Unprotect haslo
i = 18
n = 3

For n = 3 To 18
Cells(33 + 9 * (Cells(23, 1).Value - 1), n).Value = Null
Next n

If Cells(23, 1).Value <= 10 And Cells(23, 1).Value > 1 Then
   Cells(23, 1).Value = Cells(23, 1).Value - 1
For i = 31 To 123
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Attribute VB_Name = "Module4"
Sub Przycisk42_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False
ActiveSheet.Unprotect haslo
i = 171
If Cells(180, 1).Value < 3 Then
   Cells(180, 1).Value = Cells(180, 1).Value + 1
For i = 182 To 203
        If Cells(i, 1).Value <> 0 Then
        ActiveSheet.Rows(i).Hidden = False
        Else
        ActiveSheet.Rows(i).Hidden = True
End If
Next i
End If
Application.ScreenUpdating = True
'ActiveSheet.Protect haslo
End Sub
Sub Przycisk43_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False
ActiveSheet.Unprotect haslo

If Cells(180, 1).Value <= 10 And Cells(180, 1).Value > 1 Then
   Cells(180, 1).Value = Cells(180, 1).Value - 1
For i = 187 To 202
        If Cells(i, 1).Value <> 0 Then
        ActiveSheet.Rows(i).Hidden = False
        Else
        ActiveSheet.Rows(i).Hidden = True
End If
Next i
End If
Application.ScreenUpdating = True
'ActiveSheet.Protect haslo
End Sub
Attribute VB_Name = "Module5"
Sub Przycisk98_Klikniecie()
Dim arkDan As Worksheet
Dim i As Integer
Dim ilKlWGosp As Integer
Worksheets("hipoteczny").Unprotect (haslo)
ActiveWorkbook.Unprotect pass
Application.ScreenUpdating = False
If Worksheets("dane").Cells(1, 4).Value = "hipoteczny" Then

    Sheets("hipoteczny").Visible = True
    Sheets("konsumenckie").Visible = False
    Sheets("poreczyciele").Visible = False
    Sheets("FI_kons").Visible = False
    Sheets("FI_hipo").Visible = False
    Sheets("Tabela splatH").Columns("AE:AI").Hidden = False
    Sheets("Tabela splatH").Columns("AL").Hidden = False
    Sheets("Tabela splatH").Columns("am:cx").Hidden = True
    Sheets("Tabela splatH").Columns("cy:dc").Hidden = False
    Sheets("Tabela splatH").Columns("df").Hidden = False
    Sheets("Tabela splatH").Columns("dw:ea").Hidden = False
    Sheets("Tabela splatH").Columns("ed").Hidden = False
    Sheets("Tabela splatH").Columns("eu:ey").Hidden = True
    Sheets("Tabela splatH").Columns("fb").Hidden = True
    Sheets("Tabela splatH").Columns("fc:go").Hidden = True
    Sheets("Tabela splatH").Columns("gp:gt").Hidden = True
    Sheets("hipoteczny").Select
    Sheets("hipoteczny").Unprotect (haslo)
    For i = 3 To 19
        If Worksheets("hipoteczny").Cells(1, i).Value > 0 Then
        Worksheets("hipoteczny").Columns(i).Hidden = False
        Else
        Worksheets("hipoteczny").Columns(i).Hidden = True
        End If
    Next
    Sheets("hipoteczny").Shapes("check box 5411").ControlFormat.Value = False
    Sheets("hipoteczny").Shapes("mdm").ControlFormat.Value = False
End If

Set arkDan = ThisWorkbook.Worksheets("dane")
If Worksheets("dane").Cells(1, 4).Value = "konsumencki" Then

    Sheets("konsumenckie").Visible = True
    Sheets("hipoteczny").Visible = False
    Sheets("poreczyciele").Visible = False
    Sheets("FI_kons").Visible = False
    Sheets("FI_hipo").Visible = False
    Sheets("Tabela splatH").Columns("AD:AI").Hidden = True
    Sheets("Tabela splatH").Columns("AK:AL").Hidden = True
    Sheets("Tabela splatH").Columns("Bc:BG").Hidden = False
    Sheets("Tabela splatH").Columns("Bi").Hidden = True
    Sheets("Tabela splatH").Columns("Bj").Hidden = False
    Sheets("Tabela splatH").Columns("ch:gn").Hidden = True
    'If Sheets("dane").Range("d79") <> Empty Then
    'Sheets("Tabela splatH").Columns("ca:ce").Hidden = False
    'Sheets("Tabela splatH").Columns("ch").Hidden = False
    'Else
    Sheets("Tabela splatH").Columns("ca:ce").Hidden = True
    Sheets("Tabela splatH").Columns("ch").Hidden = True
    'End If
    Sheets("konsumenckie").Select
    Sheets("konsumenckie").Unprotect (haslo)
    For i = 3 To 19
        If Worksheets("konsumenckie").Cells(1, i).Value > 0 Then
        Worksheets("konsumenckie").Columns(i).Hidden = False
        Else
        Worksheets("konsumenckie").Columns(i).Hidden = True
        End If
    Next
    
    
End If
Application.ScreenUpdating = True
'Worksheets("hipoteczny").Protect Password:=haslo
'Worksheets("konsumenckie").Protect Password:=haslo
'ActiveWorkbook.Protect pass
End Sub


Attribute VB_Name = "Module6"
Sub Przycisk423_Klikniecie()
Sheets("tabela splatH").Activate
Sheets("hipoteczny").Unprotect haslo
If Cells(17, 5).Value > 300 Then
Columns("fs:fw").Hidden = False
Columns("fz").Hidden = False
Sheets("hipoteczny").Rows("330:334").Hidden = False
Sheets("hipoteczny").Rows("411:413").Hidden = False
Else
Columns("fs:fw").Hidden = True
Columns("fz").Hidden = True
Sheets("hipoteczny").Rows("330:334").Hidden = True
Sheets("hipoteczny").Rows("411:413").Hidden = True
End If
'Sheets("hipoteczny").Protect haslo
End Sub
Sub Przycisk5_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
arkDan.Unprotect haslo

If Cells(23, 1).Value < 10 Then
   Cells(23, 1).Value = Cells(23, 1).Value + 1
For i = 28 To 120
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Sub Przycisk6_Klikniecie()
Dim i As Integer
Application.ScreenUpdating = False

Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
arkDan.Unprotect haslo

If Cells(23, 1).Value <= 10 And Cells(23, 1).Value > 1 Then
   Cells(23, 1).Value = Cells(23, 1).Value - 1
For i = 28 To 120
        If Cells(i, 1).Value <> 0 Then
        arkDan.Rows(i).Hidden = False
        Else
        arkDan.Rows(i).Hidden = True
End If
Next i
Application.ScreenUpdating = True
End If
'arkDan.Protect haslo
End Sub
Attribute VB_Name = "Module7"
Sub Przycisk534_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("konsumenckie")
arkDan.Unprotect Password:=haslo
    Sheets("dochody").Activate
'arkDan.Protect Password:=haslo
End Sub
Sub Przycisk535_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("poreczyciele")
arkDan.Unprotect Password:=haslo
ActiveWorkbook.Unprotect pass
    Sheets("poreczyciele").Visible = True
    Sheets("poreczyciele").Activate
'arkDan.Protect Password:=haslo
'ActiveWorkbook.Protect pass
End Sub
Sub Przycisk112_Klikniecie()
Set arkDan = ThisWorkbook.Worksheets("dane")
arkDan.Unprotect Password:=haslo
If arkDan.Cells(1, 4).Value = "hipoteczny" Then
    Sheets("hipoteczny").Activate
Else
Set arkDan = ThisWorkbook.Worksheets("dane")
If arkDan.Cells(1, 4).Value = "konsumencki" Then
    Sheets("konsumenckie").Activate
End If
End If
'arkDan.Protect Password:=haslo
End Sub
Attribute VB_Name = "Module8"
Sub Przycisk532_Klikniecie()
Dim i, j As Long
Application.ScreenUpdating = False
Sheets("Tabela splatH").Activate
i = Sheets("Tabela splatH").Cells(2, 14).Value
If ActiveSheet.Cells(7, 5).Value <> 0 And Sheets("konsumenckie").Cells(131, 3).Value = "Sta|fffd|e" Then
j = ActiveSheet.Columns("N").Column
Else
    For j = ActiveSheet.Columns("fz").Column To 1 Step -24
    If ActiveSheet.Columns(j).Hidden = False Then Exit For
    Next
End If
ActiveSheet.PageSetup.PrintArea = Range(Cells(1, 6), Cells(i, j)).Address
ActiveSheet.PageSetup.PrintTitleRows = ActiveSheet.Range("A20:N20").Address
ActiveSheet.PageSetup.FitToPagesWide = 1
ActiveWindow.SelectedSheets.PrintOut

Sheets("Tabela splatH").Activate
Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Module9"
Sub Rozwin2298_Zmienianie()

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' =cRzKh

INQUEST-PP=macro
