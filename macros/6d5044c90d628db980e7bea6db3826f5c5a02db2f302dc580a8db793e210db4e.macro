Attribute VB_Name = "CtrlBar"
Attribute VB_Base = "0{09812E8D-9E4D-4000-9685-A6D2B8F65A49}{2C237F33-0936-473D-832D-3F46A2AEC9E5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Articul_Change()
poArtikulu
End Sub

Private Sub Articul_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.Articul.Value = Me.Articul.Value & " " & Me.NlineEnter.Value
End Sub
Private Sub Articul_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
If Me.ComboBox2.Text = "" And Me.Articul.Value = "" Then Exit Sub
If Me.ComboBox2.ListIndex <> -1 Then Me.Articul.Value = Me.ComboBox2.Column(0, Me.ComboBox2.ListIndex): Exit Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.Articul.Value = Application.Trim(Me.Articul.Value)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.Articul.Value = UCase(Me.Articul.Value)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) X.Value = LCase(X.Value)
If Me.REDO_flag = True Then Exit Sub
poArtikulu
End Sub
Private Sub Articul_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'    On Error Resume Next
'    Select Case KeyAscii
'        Case 32        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            KeyAscii = 0        ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'    End Select
End Sub

Private Sub back1_Click()
Me.MP1.Value = 4
Sheets("cards").Select
End Sub

Private Sub back1_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.back1.Font.Size = 20
Me.back1.Font.Bold = False
End Sub

Private Sub back1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.back1.SetFocus
Me.back1.Font.Size = 22
Me.back1.Font.Bold = True
End Sub

Private Sub back2_Click()
Me.MP1.Value = 4
End Sub

Private Sub back2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.back2.Font.Size = 20
Me.back2.Font.Bold = False
End Sub

Private Sub back2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.back2.Font.Size = 22
Me.back2.Font.Bold = True
End Sub

Private Sub BOXArtikulFind_Change()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.BOXArtikulFind.Value = Application.Trim(Me.BOXArtikulFind.Value)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'- |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.BOXArtikulFind.Value = UCase(Me.BOXArtikulFind.Value)
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) X.Value = LCase(X.Value)
End Sub
Private Sub BoxDATA_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Dim a As Date
a = Now
BoxDATA.Value = Left(a, 10) & ""
End Sub


Private Sub BoxDATA_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
    On Error Resume Next
    Select Case KeyAscii
        Case 32        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            KeyAscii = 0        ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            Case 44, 46         ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (44 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 46 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
            KeyAscii = 46       ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            'If InStr(1, Me.BoxDATA.Text, ".") Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    End Select
End Sub
Private Sub BOXNzapDEL_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| BOXNzapDEL
    On Error Resume Next
    Select Case KeyAscii
        Case 48 To 57, 8        ' |fffd||fffd||fffd||fffd||fffd| 0 - 9 |fffd| <Backspace> (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        Case 44, 46        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (44 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 46 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
            KeyAscii = 46        ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
            If InStr(1, Me.BOXNzapDEL.Text, ".") Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Case 45        ' |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
            If InStr(1, Me.BOXNzapDEL.Text, "-") Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            If Me.BOXNzapDEL.SelStart Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Case Else
            KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End Select
End Sub

Private Sub ButAF_Click()
cardFINDart
End Sub

Private Sub ButAF_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.ButAF.Font.Size = 22
Me.ButAF.Font.Bold = True
End Sub



Private Sub BUTBACKZAP_Click()
zapisRESTORE
End Sub

Private Sub BUTBACKZAP_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.BUTBACKZAP.Font.Bold = False
End Sub

Private Sub BUTBACKZAP_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.BUTBACKZAP.SetFocus
Me.BUTBACKZAP.Font.Bold = True
End Sub

Private Sub BUTcardSHOW2_Click()
Application.ScreenUpdating = False
cardFINDart
Application.ScreenUpdating = True
End Sub

Private Sub BUTcardSHOW2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.BUTcardSHOW2.Font.Size = 16
'Me.BUTcardSHOW2.Font.Bold = False
End Sub

Private Sub BUTcardSHOW2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.BUTcardSHOW2.SetFocus
'Me.BUTcardSHOW2.Font.Size = 16
'Me.BUTcardSHOW2.Font.Bold = True
End Sub

Private Sub BUTDELZAP_Click()
zapisDEL
End Sub

Private Sub BUTDELZAP_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.BUTDELZAP.Font.Size = 16
Me.BUTDELZAP.Font.Bold = False
End Sub

Private Sub BUTDELZAP_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.BUTDELZAP.SetFocus
'Me.BUTDELZAP.Font.Size = 16
Me.BUTDELZAP.Font.Bold = True
End Sub

Private Sub ButNNF_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.ButNNF.Font.Size = 22
Me.ButNNF.Font.Bold = True
End Sub

Private Sub ButFNAME_Click()
'FNAME
Me.ButAF = True
End Sub

Private Sub ButOF_Click()
cardFINDOBG
End Sub

Private Sub ButPRINT_Click()
    ActiveWindow.SelectedSheets.PrintOut Copies:=1, Collate:=True, _
        IgnorePrintAreas:=False
End Sub

Private Sub ButPRINT_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.ButPRINT.Font.Size = 22
Me.ButPRINT.Font.Bold = True
End Sub

Private Sub CardFind_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.MP1.Value = 2
InitBoxSort ComboBox1
End Sub

Private Sub CardFind_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.CardFind.Font.Size = 20
Me.CardFind.Font.Bold = False
Me.CardFind.BackColor = &HC0FFC0
End Sub

Private Sub CardFind_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.CardFind.SetFocus
'Me.CardFind.Font.Size = 22
Me.CardFind.Font.Bold = True
Me.CardFind.BackColor = &H80FF80
End Sub


Private Sub CardFind2_Click()
Me.MP1.Value = 2
InitBoxSort ComboBox1
End Sub

Private Sub CardFind2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.CardFind2.Font.Size = 20
Me.CardFind2.Font.Bold = False
End Sub

Private Sub CardFind2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.CardFind2.SetFocus
Me.CardFind2.Font.Size = 20
Me.CardFind2.Font.Bold = True
End Sub

Private Sub CardSaveBUT_Click()
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False
Me.NlineEnter.Value = NLastFreeLine
NEWLINE = True
Me.Articul.Value = Sheets("ONE").Cells(1, 1).Value
poArtikulu
crtl_window_start_size
Me.MP1.Value = 0
Workbooks(Book.Name).Sheets("CARDS").Select
Application.ScreenUpdating = True
End Sub

Private Sub CardSaveBUT_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.CardSaveBUT.Font.Size = 12
Me.CardSaveBUT.Font.Bold = False
End Sub

Private Sub CardSaveBUT_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.CardSaveBUT.Font.Size = 16
Me.CardSaveBUT.Font.Bold = True
End Sub

Private Sub ComboBox2_Change()
If Me.ComboBox2.ListIndex = -1 Then Me.Articul.Value = "" Else Me.Articul.Value = Me.ComboBox2.Column(0, Me.ComboBox2.ListIndex)
End Sub

Private Sub ComboBox2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)

'sort_names_art ComboBox2
'ThisWorkbook.Sheets("CARDS").Select

End Sub
Private Sub ComboBox2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.ComboBox2.Text = Application.Trim(Me.ComboBox2.Text)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim a
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = Left(Me.ComboBox2.Text, 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = UCase(a)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = a & Mid(Me.ComboBox2.Text, 2)
Me.ComboBox2.Text = a
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Me.REDO_flag = True And Me.Articul.Value = "" Then Me.Articul.Value = NLastFreeLine & Me.NlineEnter.Value: Exit Sub
If Me.REDO_flag = True And Me.Articul.Value <> "" Then Me.Articul.Value = Me.Articul.Value & Me.NlineEnter.Value: Exit Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd|
Select Case Me.ComboBox2.ListIndex
Case Is <> -1
    Me.Articul.Value = Me.ComboBox2.Column(0, Me.ComboBox2.ListIndex)
Case -1
    If Me.ComboBox2.Text <> "" Then Me.Articul.Value = Me.Articul.Value & NLastFreeLine Else Me.Articul.Value = ""
End Select
End Sub

Private Sub CommandButton1_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False
NEWLINEpress
If NLastFreeLine = 3 Then Exit Sub
InitBoxSort ComboBox2
InitBoxSort ListOBG
InitBoxSort ListOBG2
InitBoxSort SEKCIYA
Application.ScreenUpdating = True
End Sub





Private Sub Kol_vo_Change()
If Me.Kol_vo.Value = "" Then Exit Sub
Dim a
a = Me.Kol_vo.Value
On Error GoTo 1
a = a * 1
GoTo 2
1:
Me.Kol_vo.Value = ""
2:
End Sub

Private Sub Kol_vo_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Stop
If Me.Kol_vo.Value = "" Then Exit Sub
Dim a
a = Me.Kol_vo.Value
On Error GoTo 1
a = a * 1
GoTo 2
1:
Me.Kol_vo.Value = ""
2:
End Sub
Private Sub kol_vo_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'Stop
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'    On Error Resume Next
    Select Case KeyAscii
        Case 48 To 57, 8        ' |fffd||fffd||fffd||fffd||fffd| 0 - 9 |fffd| <Backspace> (|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
        Case 44, 46        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (44 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, 46 - |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|)
            KeyAscii = 44        ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If InStr(1, Me.Kol_vo.Value, ",") Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Case 45        ' |fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|)
            If InStr(1, Me.Kol_vo.Value, "-") Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
            If Me.Kol_vo.SelStart Then KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
        Case Else
            KeyAscii = 0        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    End Select
End Sub
Private Sub Label23_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Application.ScreenUpdating = False
If Me.BoxDATA.Value = "" Then cardFINDEMPTYdata Else cardFINDdata
Application.ScreenUpdating = True
End Sub

Private Sub Label27_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Me.ListOBG2.Value = ""
End Sub

Private Sub Label7_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
Me.ListOBG.Value = ""
End Sub

Private Sub ListOBG_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.ListOBG.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(1, 8).Value
End Sub

Private Sub ListOBG_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.ListOBG.Text = Application.Trim(Me.ListOBG.Text)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim a
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = Left(Me.ListOBG.Text, 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = UCase(a)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = a & Mid(Me.ListOBG.Text, 2)
Me.ListOBG.Text = a
End Sub



Private Sub ListOBG2_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.ListOBG2.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(1, 17).Value
End Sub

Private Sub ListOBG2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.ListOBG2.Text = Application.Trim(Me.ListOBG2.Text)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim a
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = Left(Me.ListOBG2.Text, 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = UCase(a)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = a & Mid(Me.ListOBG2.Text, 2)
Me.ListOBG2.Text = a
End Sub

Private Sub MP1_MouseMove(ByVal Index As Long, ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)



'Me.ButAF.Font.Size = 20
'Me.ButAF.Font.Bold = False

'Me.back2.Font.Size = 20
'Me.back2.Font.Bold = False


'If Me.MP1.Value = 4 Then
'                    Me.NEWLINE.Font.Bold = False
'                    Me.NEWLINE.BackColor = &HC0FFC0
'                    Me.CardFind.Font.Bold = False
'                    Me.CardFind.BackColor = &HC0FFC0
'End If

'Me.NEWLINE2.Font.Size = 20
'Me.NEWLINE2.Font.Bold = False

'Me.ButPRINT.Font.Size = 20
Me.ButPRINT.Font.Bold = False



Me.NEWLINE4.Font.Bold = False

Me.BUTDELZAP.Font.Bold = False
Me.BUTBACKZAP.Font.Bold = False
Me.BUTcardSHOW2.Font.Bold = False
'Me.back1.Font.Bold = False
'Me.CardFind2.Font.Bold = False
Me.povtorzap.Font.Bold = False
Me.SaveNewLine.Font.Bold = False
Me.OBGSUMSCH.Font.Bold = False
Me.OUTLOAD.Font.Bold = False

Me.CardSaveBUT.Font.Bold = False
If Me.BoxDATA.BackColor <> &H80000005 Then Me.BoxDATA.BackColor = &H80000005
If Me.ListOBG.BackColor <> &H80000005 Then Me.ListOBG.BackColor = &H80000005
If Me.ListOBG2.BackColor <> &H80000005 Then Me.ListOBG2.BackColor = &H80000005
If Me.SEKCIYA.BackColor <> &H80000005 Then Me.SEKCIYA.BackColor = &H80000005

End Sub
Private Sub Ncode_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    On Error Resume Next
    Select Case KeyAscii
        Case 32        ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            KeyAscii = 0        ' |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    End Select
End Sub



Private Sub NEWLINE_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.NEWLINE.Font.Size = 20
Me.NEWLINE.Font.Bold = False
Me.NEWLINE.BackColor = &HC0FFC0
End Sub
Private Sub NEWLINE_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Me.NEWLINE.SetFocus
'Me.NEWLINE.Font.Size = 22
Me.NEWLINE.Font.Bold = True
Me.NEWLINE.BackColor = &H80FF80
End Sub



Private Sub NEWLINE2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.NEWLINE2.Font.Size = 22
Me.NEWLINE2.Font.Bold = True
End Sub

Private Sub NEWLINE4_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Application.ScreenUpdating = False
Me.MP1.Value = 0
NEWLINEpress
crtl_window_start_size
If NLastFreeLine = 3 Then GoTo 10
InitBoxSort ComboBox2
InitBoxSort ListOBG
InitBoxSort ListOBG2
InitBoxSort SEKCIYA
10:
Application.ScreenUpdating = True
End Sub

Private Sub NEWLINE4_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.NEWLINE4.Font.Bold = False
End Sub

Private Sub NEWLINE4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.NEWLINE4.Font.Bold = True
End Sub



Private Sub NlineEnterShow_Click()
If NlineEnter < 3 Then NlineEnter = 3
NLineShow = Me.NlineEnter.Value
lineSHOW
End Sub

Private Sub OBGSUMSCH_Click()
If ActiveSheet.Name <> "ONE" Then Exit Sub
SUMMApoOBG
End Sub

Private Sub OBGSUMSCH_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.OBGSUMSCH.Font.Bold = True
End Sub

Private Sub OUTLOAD_Click()
    OtchSH.Select
    Application.CutCopyMode = False
    OtchSH.Copy
    Workbooks(Book.Name).Activate
End Sub

Private Sub OUTLOAD_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Me.OUTLOAD.Font.Bold = True
End Sub

Private Sub POISK1_Click()
Application.ScreenUpdating = False
SKLAD = 8
cardFINDOBG
Application.ScreenUpdating = True
End Sub

Private Sub POISK2_Click()
Application.ScreenUpdating = False
SKLAD = 17
otchet_sklad_TMC
Application.ScreenUpdating = True
End Sub
Private Sub povtorzap_Click()
Me.NlineEnter.Value = NLastFreeLine
NLineShow = NLastFreeLine
End Sub



Private Sub REDO_flag_Change()
If Me.REDO_flag = True Then Me.SaveNewLine.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Else Me.SaveNewLine.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Private Sub SaveNewLine_Click()
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Dim a As Date
a = Now

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Me.ComboBox2.Value = "" Then Exit Sub
If Me.Articul.Value = "" Then Exit Sub
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
If Me.BoxDATA.Value = "" Then BoxDATA.Value = Left(a, 10) & ""
If Me.ListOBG.Value <> "" And Me.ListOBG2.Value = "" Then Me.ListOBG2.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(1, 17).Value
If Me.ListOBG.Value = "" And Me.ListOBG2.Value <> "" Then Me.ListOBG.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(1, 8).Value
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If Me.ListOBG.Value = "" And Me.ListOBG2.Value = "" Then Exit Sub
If Me.Kol_vo.Value = "" Then Exit Sub

Application.ScreenUpdating = False
If Me.REDO_flag.Value = True Then
                                SaveREDOLine
                                Workbooks(Book.Name).Save
                                InitBoxSort ComboBox2
                                InitBoxSort ListOBG
                                InitBoxSort ListOBG2
                                InitBoxSort SEKCIYA
                                lineSHOW
                                Me.REDO_flag.Value = False
                                Exit Sub
End If
If NLineShow <> NLastFreeLine Then Exit Sub
SaveNLine
Workbooks(Book.Name).Save
NEWLINEpress
InitBoxSort ComboBox2
InitBoxSort ListOBG
InitBoxSort ListOBG2
InitBoxSort SEKCIYA
Application.ScreenUpdating = True
End Sub

Private Sub SaveNewLine_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'Me.SaveNewLine.Font.Size = 20
Me.SaveNewLine.Font.Bold = False
End Sub

Private Sub SaveNewLine_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
'Me.SaveNewLine.SetFocus
'Me.SaveNewLine.Font.Size = 22
Me.SaveNewLine.Font.Bold = True
End Sub

Private Sub SEKCIYA_Change()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Me.SEKCIYA.Text = Application.Trim(Me.SEKCIYA.Text)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim a
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = Left(Me.SEKCIYA.Text, 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = UCase(a)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
a = a & Mid(Me.SEKCIYA.Text, 2)
Me.SEKCIYA.Text = a
End Sub
Private Sub SpinButton1_SpinDown()
        NLineShow = NLineShow + 1
        If NLineShow <= NLastFreeLine Then lineSHOW Else NLineShow = NLineShow - 1
End Sub

Private Sub SpinButton1_SpinUp()
        NLineShow = NLineShow - 1
        If NLineShow > 2 Then lineSHOW Else NLineShow = NLineShow + 1
End Sub
Private Sub SpinButton2_SpinDown()
    ActiveWindow.SmallScroll Down:=3
End Sub

Private Sub SpinButton2_SpinUp()
    ActiveWindow.SmallScroll Down:=-3
End Sub
Private Sub SpinButton3_SpinDown()
Dim a As Double
If Me.Kol_vo.Value = "" Then a = 0 Else a = CDbl(Me.Kol_vo.Value)

Select Case a
        Case Is >= 1
                a = a - 1
        Case Is < 1
                a = 0
End Select

Me.Kol_vo.Value = CStr(a)

End Sub

Private Sub SpinButton3_SpinUp()
Dim a As Double
If Me.Kol_vo.Value = "" Then a = 0 Else a = CDbl(Me.Kol_vo.Value)
a = a + 1
Me.Kol_vo.Value = CStr(a)
End Sub

Private Sub UserForm_Initialize()
'Application.ScreenUpdating = False
Me.MP1.Value = 0
lastFREEline
Me.NlineEnter.Value = NLastFreeLine
Workbooks(Book.Name).Sheets("CARDS").Select
If NLastFreeLine = 3 Then GoTo 10
InitBoxSort ComboBox2
InitBoxSort ListOBG
InitBoxSort ListOBG2
InitBoxSort SEKCIYA
10:
Me.Kol_vo.Value = ""
'Application.ScreenUpdating = True
End Sub


Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)


Dim nbook
Dim WBooks As Workbook
Me.MP1.Value = 0
'Me.NEWLINE.SetFocus
Workbooks(Book.Name).Activate
Workbooks(Book.Name).Sheets("START").Select
Workbooks(Book.Name).Sheets("CARDS").Visible = 0

nbook = 0
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
   For Each WBooks In Workbooks
      nbook = nbook + 1
   Next WBooks

Workbooks.Application.DisplayAlerts = False

If nbook > 1 Then

                Workbooks(Book.Name).Close savechanges:=True
             Else

                Workbooks(Book.Name).Save
                Application.Quit
End If

End Sub

Private Sub ZP_Click()
'NLastFreeLine

Me.Ndoc.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(NLastFreeLine - 1, 6).Value
Me.BoxDATA.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(NLastFreeLine - 1, 7).Value
Me.ListOBG.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(NLastFreeLine - 1, 8).Value
Me.ListOBG2.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(NLastFreeLine - 1, 17).Value
Me.SEKCIYA.Value = Workbooks(Book.Name).Sheets("CARDS").Cells(NLastFreeLine - 1, 12).Value



End Sub

Attribute VB_Name = "WM"
Public NLastFreeLine As Long
Public NLineShow As Long
Public SKLAD As Integer
Public Book As Workbook
Public BaseSH As Worksheet
Public OtchSH As Worksheet
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Sub lastFREEline()
Attribute lastFREEline.VB_ProcData.VB_Invoke_Func = " \n14"
'
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
NLastFreeLine = BaseSH.Cells(Rows.Count, 1).End(xlUp).Row + 1
NLineShow = NLastFreeLine
End Sub
Sub UFS()

CtrlBar.Show

End Sub
Sub SaveNLine()
'
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| CARDS
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'

BaseSH.Cells(NLastFreeLine, 1).Value = NLastFreeLine
BaseSH.Cells(NLastFreeLine, 2).Value = CtrlBar.Ncode.Value & "": CtrlBar.Ncode.Value = ""
BaseSH.Cells(NLastFreeLine, 3).Value = CStr(CtrlBar.Articul.Text): CtrlBar.Articul.Text = ""
BaseSH.Cells(NLastFreeLine, 4).Value = CtrlBar.ComboBox2.Text: CtrlBar.ComboBox2.Text = ""
BaseSH.Cells(NLastFreeLine, 5).Value = CtrlBar.TTX.Value: CtrlBar.TTX.Value = ""
BaseSH.Cells(NLastFreeLine, 6).Value = CtrlBar.Ndoc.Value & "": CtrlBar.Ndoc.Value = ""
BaseSH.Cells(NLastFreeLine, 7).Value = CtrlBar.BoxDATA.Value & "": CtrlBar.BoxDATA.Value = ""
BaseSH.Cells(NLastFreeLine, 8).Value = CtrlBar.ListOBG.Value: CtrlBar.ListOBG.Value = ""
BaseSH.Cells(NLastFreeLine, 10).Value = CtrlBar.Kol_vo.Value: CtrlBar.Kol_vo.Value = ""
BaseSH.Cells(NLastFreeLine, 11).Value = CStr(CtrlBar.INKol_vo.Value): CtrlBar.INKol_vo.Value = ""
BaseSH.Cells(NLastFreeLine, 12).Value = CtrlBar.SEKCIYA.Value: CtrlBar.SEKCIYA.Value = ""
BaseSH.Cells(NLastFreeLine, 16).Value = CtrlBar.Primechanie.Value: CtrlBar.Primechanie.Value = ""
BaseSH.Cells(NLastFreeLine, 17).Value = CtrlBar.ListOBG2.Value: CtrlBar.ListOBG2.Value = ""
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| 1 |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
NLastFreeLine = NLastFreeLine + 1
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
CtrlBar.NlineEnter.Value = NLastFreeLine
End Sub
Sub lineSHOW()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
CtrlBar.Ncode.Value = BaseSH.Cells(NLineShow, 2).Value
CtrlBar.Articul.Text = CStr(BaseSH.Cells(NLineShow, 3).Value)
CtrlBar.ComboBox2.Text = CStr(BaseSH.Cells(NLineShow, 4).Value)
CtrlBar.TTX.Value = BaseSH.Cells(NLineShow, 5).Value
CtrlBar.Ndoc.Value = BaseSH.Cells(NLineShow, 6).Value
CtrlBar.BoxDATA.Value = CStr(BaseSH.Cells(NLineShow, 7).Value)
CtrlBar.ListOBG.Text = BaseSH.Cells(NLineShow, 8).Value
CtrlBar.Kol_vo.Value = BaseSH.Cells(NLineShow, 10).Value
CtrlBar.INKol_vo.Value = BaseSH.Cells(NLineShow, 11).Value
CtrlBar.SEKCIYA.Value = BaseSH.Cells(NLineShow, 12).Value
CtrlBar.Primechanie.Value = BaseSH.Cells(NLineShow, 16).Value
CtrlBar.ListOBG2.Text = BaseSH.Cells(NLineShow, 17).Value
CtrlBar.NlineEnter.Value = NLineShow

End Sub
Sub SaveREDOLine()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| CARDS
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| CStr

BaseSH.Cells(NLineShow, 1).Value = NLineShow
BaseSH.Cells(NLineShow, 2).Value = CtrlBar.Ncode.Value & "" ': CtrlBar.Ncode.Value = ""
BaseSH.Cells(NLineShow, 3).Value = CStr(CtrlBar.Articul.Text) ': CtrlBar.Articul.Text = ""
BaseSH.Cells(NLineShow, 4).Value = CtrlBar.ComboBox2.Text
BaseSH.Cells(NLineShow, 5).Value = CtrlBar.TTX.Value ': CtrlBar.TTX.Value = ""
BaseSH.Cells(NLineShow, 6).Value = CtrlBar.Ndoc.Value & "" ': CtrlBar.Ndoc.Value = ""
BaseSH.Cells(NLineShow, 7).Value = CtrlBar.BoxDATA.Value & "" ': CtrlBar.BoxDATA.Value = ""
BaseSH.Cells(NLineShow, 8).Value = CtrlBar.ListOBG.Value ': CtrlBar.ListOBG.Value = ""
BaseSH.Cells(NLineShow, 10).Value = CtrlBar.Kol_vo.Value ': CtrlBar.kol_vo.Value = ""
BaseSH.Cells(NLineShow, 11).Value = CStr(CtrlBar.INKol_vo.Value) ': CtrlBar.INkol_vo.Value = ""
BaseSH.Cells(NLineShow, 12).Value = CtrlBar.SEKCIYA.Value ': CtrlBar.SEKCIYA.Value = ""
BaseSH.Cells(NLineShow, 16).Value = CtrlBar.Primechanie.Value ': CtrlBar.Primechanie.Value = ""
BaseSH.Cells(NLineShow, 17).Value = CtrlBar.ListOBG2.Value ': CtrlBar.ListOBG2.Value = ""
CtrlBar.NlineEnter.Value = NLineShow
End Sub

Sub cardFINDart()
' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'
'Application.ScreenUpdating = False
Dim a, base(), schet, schetFOR, i, Rash, Kol_vo, RashOS, kol_voOS, b, c, harakt

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = CStr(CtrlBar.Articul.Text)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BaseSH.Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 3)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
OtchSH.Select
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveWindow.FreezePanes = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells.Select: Selection.Delete Shift:=xlUp
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns(1).Select: Selection.ColumnWidth = 8
    Columns(2).Select: Selection.ColumnWidth = 10
    Columns(3).Select: Selection.ColumnWidth = 10
    Columns(4).Select: Selection.ColumnWidth = 13
    Columns(5).Select: Selection.ColumnWidth = 9
    Columns(6).Select: Selection.ColumnWidth = 10
    Columns(7).Select: Selection.ColumnWidth = 12
    Columns(8).Select: Selection.ColumnWidth = 28
    Columns(9).Select: Selection.ColumnWidth = 28
    Columns(10).Select: Selection.ColumnWidth = 8
    Columns(11).Select: Selection.ColumnWidth = 15
    Columns(12).Select: Selection.ColumnWidth = 0
    Columns(13).Select: Selection.ColumnWidth = 8
    Columns(14).Select: Selection.ColumnWidth = 15
    Columns(15).Select: Selection.ColumnWidth = 0
    Columns(16).Select: Selection.ColumnWidth = 35
'|fffd||fffd||fffd||fffd||fffd|
    Cells(1, 1).Value = "|fffd|"
    Cells(1, 3).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 4).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|."
    Cells(1, 6).Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 7).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 8).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 9).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 10).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 11).Value = "|fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 12).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 13).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 14).Value = "|fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 15).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 16).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("A1:P1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|


Cells(1, 1).Select

schet = 1
i = 1
Rash = 0
Kol_vo = 0
RashOS = 0
kol_voOS = 0
c = BaseSH.Cells(1, 8).Value
While schet <= UBound(base)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If a = CStr(base(schet, 3)) Then
                                If BaseSH.Cells(base(schet, 1), 5).Value <> "" Then harakt = haract & " " & BaseSH.Cells(base(schet, 1), 5).Value
                                OtchSH.Cells(i + 1, 1).Value = BaseSH.Cells(base(schet, 1), 1).Value
                                OtchSH.Cells(i + 1, 6).Value = BaseSH.Cells(base(schet, 1), 6).Value
                                OtchSH.Cells(i + 1, 7).Value = BaseSH.Cells(base(schet, 1), 7).Value
                                OtchSH.Cells(i + 1, 8).Value = BaseSH.Cells(base(schet, 1), 8).Value
                                b = OtchSH.Cells(i + 1, 8).Value
                                If b = c Then
                                            OtchSH.Cells(i + 1, 13).Value = BaseSH.Cells(base(schet, 1), 10).Value
                                            OtchSH.Cells(i + 1, 14).Value = BaseSH.Cells(base(schet, 1), 11).Value
                                End If
                                OtchSH.Cells(i + 1, 9).Value = BaseSH.Cells(base(schet, 1), 17).Value
                                b = OtchSH.Cells(i + 1, 9).Value
                                If b = c Then
                                            OtchSH.Cells(i + 1, 10).Value = BaseSH.Cells(base(schet, 1), 10).Value
                                            OtchSH.Cells(i + 1, 11).Value = BaseSH.Cells(base(schet, 1), 11).Value
                                End If
                                OtchSH.Cells(i + 1, 16).Value = BaseSH.Cells(base(schet, 1), 16).Value
                                
                                For schetFOR = 1 To 16
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                If BaseSH.Cells(base(schet, 1), schetFOR).Font.Strikethrough = True Then OtchSH.Cells(i + 1, schetFOR).Font.Strikethrough = True
                                Next
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
If BaseSH.Cells(base(schet, 1), 1).Font.Strikethrough = False Then
                                                                    Kol_vo = Kol_vo + CDbl(OtchSH.Cells(i + 1, 10))
                                                                    Rash = Rash + CDbl(OtchSH.Cells(i + 1, 13))
End If

                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                i = i + 1
                               
End If
schet = schet + 1
Wend

Cells(i + 3, 15).Select
    With Selection
        .HorizontalAlignment = xlRight
        .VerticalAlignment = xlTop
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
Cells(i + 3, 10).Value = Kol_vo
Cells(i + 3, 13).Value = Rash



'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
crtl_window_long_size
CtrlBar.MP1.Value = 1
'CtrlBar.Hide
'CtrlBar.Show vbModeless

If OtchSH.Cells(3, 1).Value = "" Then
                                        Range(Cells(2, 1), Cells(4, 17)).Select
                                        Else
                                        Range(Cells(2, 1), Cells(Selection.End(xlDown) + 2, 17)).Select
End If

With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
Cells(2, 1).Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Rows(1).Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Selection.RowHeight = 20
    OtchSH.Cells(3, 1).Select
    ActiveWindow.FreezePanes = True
    Rows(2).Select: Selection.RowHeight = 30
    
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Rows(1).Select: Selection.NumberFormat = "@"
Cells(1, 1).Value = CtrlBar.Articul.Text
Cells(1, 8).Value = CtrlBar.ComboBox2.Value
Cells(1, 13).Value = harakt

    Rows(1).Select
    With Selection.Font
        .Name = "Arial"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns("B:E").Select
    Selection.Delete Shift:=xlToLeft
    Columns("B:B").Select
    Selection.FormatConditions.AddUniqueValues
    Selection.FormatConditions(Selection.FormatConditions.Count).SetFirstPriority
    Selection.FormatConditions(1).DupeUnique = xlDuplicate
    With Selection.FormatConditions(1).Font
        .Color = -16383844
        .TintAndShade = 0
    End With
    With Selection.FormatConditions(1).Interior
        .PatternColorIndex = xlAutomatic
        .Color = 13551615
        .TintAndShade = 0
    End With
    Selection.FormatConditions(1).StopIfTrue = False
    Columns(3).Select: Selection.HorizontalAlignment = xlCenter
    Columns(2).Select: Selection.HorizontalAlignment = xlCenter
    Columns(6).Select: Selection.HorizontalAlignment = xlRight
    Columns(5).Select: Selection.HorizontalAlignment = xlLeft
    Columns(9).Select: Selection.HorizontalAlignment = xlRight
    Rows(1).Select

'Application.ScreenUpdating = True
End Sub
Sub cardFINDOBG()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
'

'Application.ScreenUpdating = False
Dim a, base(), schet, schetFOR, i, Rash, Kol_vo, toSklad
toSklad = 17: a = CtrlBar.ListOBG.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BaseSH.Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 17)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
OtchSH.Select
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveWindow.FreezePanes = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells.Select: Selection.Delete Shift:=xlUp
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns(1).Select: Selection.ColumnWidth = 8 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(2).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(3).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd|
    Columns(4).Select: Selection.ColumnWidth = 25 '|fffd||fffd||fffd||fffd||fffd|
    Columns(5).Select: Selection.ColumnWidth = 25 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(6).Select: Selection.ColumnWidth = 60 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(7).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(8).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(9).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(10).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(11).Select: Selection.ColumnWidth = 30 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(12).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(13).Select: Selection.ColumnWidth = 31 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 209

'|fffd||fffd||fffd||fffd||fffd|
    Cells(2, 1).Value = "|fffd|"
    Cells(2, 2).Value = "|fffd| |fffd||fffd||fffd|"
    Cells(2, 3).Value = "|fffd||fffd||fffd||fffd|"
    Cells(2, 4).Value = "|fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 6).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 7).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 8).Value = "|fffd||fffd||fffd| |fffd|"
    Cells(2, 9).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 10).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 11).Value = "|fffd||fffd||fffd| |fffd|"
    Cells(2, 12).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 13).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("A2:M2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|


    

schet = 3
i = 3
'Rash = 0
'kol_vo = 0
While schet <= UBound(base)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
If a = base(schet, toSklad) Then
                           'Rows(I).Select
                           ' With Selection.Font
                           '     .Color = -4165632
                           ' End With
                            OtchSH.Cells(i, 1).Value = base(schet, 1) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 2).Value = base(schet, 6) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.
                            OtchSH.Cells(i, 3).Value = base(schet, 7) '|fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 4).Value = base(schet, 8) '|fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 5).Value = base(schet, 3) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 6).Value = base(schet, 4) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 7).Value = base(schet, 13) '|fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 8).Value = base(schet, 14) '|fffd||fffd||fffd| |fffd|
                            OtchSH.Cells(i, 9).Value = base(schet, 15) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 10).Value = base(schet, 10) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 11).Value = base(schet, 11) '|fffd||fffd||fffd| |fffd|
                            OtchSH.Cells(i, 12).Value = base(schet, 12) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 13).Value = base(schet, 16) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            i = i + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End If
schet = schet + 1
Wend

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
crtl_window_long_size
CtrlBar.MP1.Value = 1
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, 5).Value = a
Cells(1, 5).Font.Size = 14
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    
    Columns(5).Select: Selection.HorizontalAlignment = xlLeft
    Columns(6).Select: Selection.HorizontalAlignment = xlLeft
    Columns(10).Select: Selection.HorizontalAlignment = xlRight
    Columns(11).Select: Selection.HorizontalAlignment = xlRight
    
    Cells(3, 1).Select
    ActiveWindow.FreezePanes = True
    Rows(1).Select
'    Application.ScreenUpdating = True
End Sub

Sub poArtikulu()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'
Dim Ki, i, a, b
Ki = CtrlBar.ComboBox2.ListCount - 1
a = CtrlBar.Articul.Text
For i = 0 To Ki
b = CtrlBar.ComboBox2.Column(0, i)
If a = b Then CtrlBar.ComboBox2.Value = CtrlBar.ComboBox2.Column(1, i)
Next i
End Sub
Sub zapisDEL()
Application.ScreenUpdating = False

'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
Dim a, b(), i, k, c(), fnc
a = CtrlBar.BOXNzapREDO.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, 1).Select
On Error GoTo 1
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
c = Selection.Value
fnc = False
For i = 1 To UBound(c)
If a = "" & c(i, 1) Then fnc = True
Next
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If fnc = False Then GoTo 1

Sheets("cards").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
b = Selection.Value

For i = 1 To UBound(b)
If b(i, 1) & "" = a Then
                For k = 1 To 17
                Sheets("cards").Cells(i, k).Font.Strikethrough = True
                Next

End If
Next
Sheets("one").Select
cardFINDart
1:
Application.ScreenUpdating = True
End Sub

Sub zapisRESTORE()
Application.ScreenUpdating = False
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
Dim a, b(), i, k, c(), fnc
a = CtrlBar.BOXNzapREDO.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, 1).Select
On Error GoTo 1
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
c = Selection.Value
fnc = False
For i = 1 To UBound(c)
If a = "" & c(i, 1) Then fnc = True
Next
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If fnc = False Then GoTo 1

Sheets("cards").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
b = Selection.Value

For i = 1 To UBound(b)
If b(i, 1) & "" = a Then
                For k = 1 To 17
                Sheets("cards").Cells(i, k).Font.Strikethrough = False
                Next

End If
Next
Sheets("one").Select
cardFINDart
1:
Application.ScreenUpdating = True
End Sub

Sub SPISOK_FILL()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'
'Application.ScreenUpdating = False
Dim a, b, base(), schet, i
Dim slovar As Object

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("cards").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 12)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Set slovar = CreateObject("Scripting.Dictionary")
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| base. |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
CtrlBar.SEKCIYA.ColumnCount = 1
CtrlBar.SEKCIYA.Clear

i = 0
For schet = 1 To UBound(base)
If slovar.exists(base(schet, 12)) Then Else i = i + 1: slovar.Add base(schet, 12), schet: CtrlBar.SEKCIYA.AddItem base(schet, 12) ', i  '|fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next
slovar.RemoveAll
'Application.ScreenUpdating = True
End Sub
Sub List_OBG2_FILL()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'
Application.ScreenUpdating = False
Dim a, b, base(), baseOBG(), schet, i, razmer
Dim slovar As Object

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("cards").Select
Cells(3, 1).Select
Range(Cells(3, 1), Cells(Selection.End(xlDown), 1)).Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value
razmer = UBound(base)
Erase base

OBGnaINDEX
baseOBG = Range(Worksheets("Index").Cells(1, 1), Worksheets("index").Cells(razmer * 2, 1)).Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Set slovar = CreateObject("Scripting.Dictionary")
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| base. |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'CtrlBar.ListMOL.ColumnCount = 1
CtrlBar.ListOBG2.Clear
'CtrlBar.ListOBG.Clear
i = 0
For schet = 1 To razmer * 2
If slovar.exists(baseOBG(schet, 1)) Then Else i = i + 1: slovar.Add baseOBG(schet, 1), schet: CtrlBar.ListOBG.AddItem baseOBG(schet, 1): CtrlBar.ListOBG2.AddItem baseOBG(schet, 1)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ListOBG2.
Next

slovar.RemoveAll
Application.ScreenUpdating = True
End Sub
Sub List_OBG_FILL()
' |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'
Application.ScreenUpdating = False
Dim a, b, base(), baseOBG(), schet, i
Dim slovar As Object

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("cards").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 2)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value

Cells(1, 8).Select
Range(Cells(1, 8), Cells(UBound(base), 8)).Select
baseOBG = Selection.Value

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Set slovar = CreateObject("Scripting.Dictionary")
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| base. |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
'CtrlBar.ListMOL.ColumnCount = 1
CtrlBar.ListOBG.Clear

i = 0
For schet = 1 To UBound(base)
If slovar.exists(baseOBG(schet, 1)) Then Else i = i + 1: slovar.Add baseOBG(schet, 1), schet: CtrlBar.ListOBG.AddItem baseOBG(schet, 1) ', i  '|fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

Next
slovar.RemoveAll
Application.ScreenUpdating = True
End Sub

Sub InitBoxSort(b As MSForms.ComboBox)
'Application.ScreenUpdating = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim i As Long, c As Long, S$, SS$, L As Long, R As Long, base(), Data(), data2(), Ki, st, tab1, tab2
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If b.Name = "ComboBox2" Then tab1 = 3: tab2 = 4
If b.Name = "ListOBG" Then tab1 = 1: tab2 = 8
If b.Name = "ListOBG2" Then tab1 = 1: tab2 = 17
If b.Name = "SEKCIYA" Then tab1 = 1: tab2 = 12
b.Clear

Dim slovar As Object
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| Ki
Sheets("CARDS").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
base = Selection.Value
Ki = UBound(base)
Erase base

'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If tab1 = 3 Then Cells(1, tab1).Select: Range(Cells(1, tab1), Cells(Ki, tab1)).Select: Data = Selection.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, tab2).Select
Range(Cells(1, tab2), Cells(Ki, tab2)).Select
data2 = Selection.Value

Set slovar = CreateObject("Scripting.Dictionary")


'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
ReDim base(Ki, 1 To 2)
st = 0
For i = 3 To Ki '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|

    If slovar.exists(data2(i, 1)) Then
                                  Else
                                    st = st + 1
                                    If tab1 = 3 Then
                                                    slovar.Add data2(i, 1), Data(i, 1)
                                                    base(st, 1) = Data(i, 1)
                                                    base(st, 2) = data2(i, 1)
                                                Else
                                                    slovar.Add data2(i, 1), st
                                                    base(st, 1) = st
                                                    base(st, 2) = data2(i, 1)
                                    End If
    End If
    
Next i
st = st - 1
ReDim Data(st, 1 To 2)

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
For i = 0 To st
Data(i, 1) = base(i + 1, 1)
Data(i, 2) = base(i + 1, 2)
Next i

Erase base
    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Dim Check As Boolean, iCount As Integer, jCount As Integer, nCount As Integer
    ReDim base(st, 1 To 2)
    Do Until Check
        Check = True
        For iCount = 0 To st - 1
            If Data(iCount, 2) > Data(iCount + 1, 2) Then
'                Stop
                For jCount = 1 To 2
                    base(iCount, jCount) = Data(iCount, jCount)
                    Data(iCount, jCount) = Data(iCount + 1, jCount)
                    Data(iCount + 1, jCount) = base(iCount, jCount)
                    Check = False
                Next
            End If
        Next
    Loop

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

b.List = Data
'Application.ScreenUpdating = True
End Sub
 
Sub FNAME()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|
'
'
'Application.ScreenUpdating = False
Dim a, b, c, i, st, Ni, Ki, Data, base
Dim slovar As Object

Sheets("cards").Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
base = Selection.Value
Ki = UBound(base)
Erase base
Cells(1, 3).Select
Range(Cells(1, 3), Cells(Ki, 4)).Select
Data = Selection.Value

a = CtrlBar.ComboBox1.Value
'Stop
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Set slovar = CreateObject("Scripting.Dictionary")
'
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| data. |fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
i = 0
For st = 3 To Ki
If slovar.exists(Data(st, 2)) Then Else i = i + 1: slovar.Add Data(st, 2), Data(st, 1) ', i  '|fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Next

Erase Data
'slovar.RemoveAll
'Stop
If slovar.exists(a) Then CtrlBar.BOXArtikulFind.Value = slovar.Item(a)


End Sub
Sub crtl_window_start_size()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
CtrlBar.Height = 525.75
CtrlBar.Width = 600
CtrlBar.MP1.Height = 474
CtrlBar.MP1.Width = 582
CtrlBar.Left = (Application.Width + Application.Left) / 2 - CtrlBar.Width / 2
CtrlBar.Top = (Application.Height + Application.Top) / 2 - CtrlBar.Height / 2
End Sub

Sub crtl_window_long_size()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
CtrlBar.Height = 120
CtrlBar.Width = 760
CtrlBar.MP1.Height = 100
CtrlBar.MP1.Width = 745
CtrlBar.Top = 1
CtrlBar.Left = (Application.Width + Application.Left) / 2 - CtrlBar.Width / 2 - 4
End Sub
Sub Uppercase()
   ' |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
   Dim a, i, X
  ' For Each x In Range("C3:C4000")
  '    If x.Value = "" Then GoTo 2
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
  '    x.Value = UCase(x.Value)
  ' Next
'2:
   For i = 3 To 4000
   X = Worksheets("CARDS").Cells(i, 8).Value
      'If x = "" Then Exit Sub
      ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
      X = Application.Trim(X)
      a = Left(X, 1)
      a = UCase(a)
      a = a & Mid(X, 2)
      X = a
   Worksheets("CARDS").Cells(i, 8).Value = X

   Next
End Sub
Sub OBGnaINDEX()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim a, b, base(), baseOBG(), schet, i, razmer
Dim slovar As Object

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sheets("cards").Select
Cells(3, 1).Select
Range(Cells(3, 1), Cells(Selection.End(xlDown), 1)).Select

'|fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value
razmer = UBound(base)
Erase base
Cells(3, 17).Select
Range(Cells(3, 17), Cells(razmer + 2, 17)).Select '|fffd||fffd||fffd||fffd||fffd||fffd| +2 |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| 2 |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
baseOBG = Selection.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Worksheets("Index").Cells.Clear
Range(Worksheets("Index").Cells(1, 1), Worksheets("index").Cells(razmer, 1)).Value = baseOBG

'|fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value
razmer = UBound(base)
Erase base
Cells(3, 8).Select
Range(Cells(3, 8), Cells(razmer + 2, 8)).Select '|fffd||fffd||fffd||fffd||fffd||fffd| +2 |fffd|.|fffd|. |fffd||fffd||fffd||fffd||fffd||fffd| 1 |fffd| 2 |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd|-|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
baseOBG = Selection.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Range(Worksheets("Index").Cells(razmer + 1, 1), Worksheets("index").Cells(razmer * 2, 1)).Value = baseOBG


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("Index").Sort.SortFields.Clear
    Worksheets("Index").Sort.SortFields.Add Key:=Range("A1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With Worksheets("Index").Sort
        .SetRange Range(Worksheets("Index").Cells(1, 1), Worksheets("index").Cells(razmer * 2, 1))
        .Header = xlNo
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub

Sub SUMMApoOBG()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'
Application.ScreenUpdating = False
Worksheets("Index").Cells.Clear
Dim i, k, st, Data, pdata, summa, pval, dminus, minus, inv, invdata, invback, invbackdata
Dim kstr As Range
Dim kstr2 As Range
Dim slovar As Object
Set slovar = CreateObject("Scripting.Dictionary")
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
i = 3
st = 1
While Cells(i, 1).Value <> ""
Data = Cells(i, 5).Value
If slovar.exists(Data) Then Else slovar.Add Data, st: st = st + 1
i = i + 1
Wend
st = st - 1 + 2
'For i = 1 To st
'Sheets("ONE").Cells(i + 2, 2).Value = slovar.keys()(i - 1)
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| item |fffd| key. |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.
''Sheets("ONE").Cells(i + 2, 2).Value = slovar.Items()(i - 1)
''Sheets("ONE").Cells(i + 2, 2).Value = slovar.Keys()(i - 1)
'Next
'Stop

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
For i = 3 To st
k = 3
Data = slovar.keys()(i - 3)
summa = 0
inv = ""
invback = ""
While Cells(k, 1).Value <> ""
pdata = Cells(k, 5).Value
dminus = Cells(k, 4).Value
pval = Cells(k, 9).Value
minus = Cells(k, 6).Value
invdata = Cells(k, 10).Value
invbackdata = Cells(k, 7).Value
If Data = pdata Then summa = summa + pval: inv = inv & " " & invdata ': Set kstr = Rows(k)
If Data = dminus Then summa = summa - minus: invback = invback & " " & invbackdata
'If kstr Is Nothing Then GoTo 1
'If kstr2 Is Nothing Then Set kstr2 = kstr Else Set kstr2 = Union(kstr2, kstr): kstr2.Select
'1:
k = k + 1
Wend
Worksheets("Index").Cells(i, 4).Value = invback
Worksheets("Index").Cells(i, 3).Value = inv
Worksheets("Index").Cells(i, 2).Value = summa
Worksheets("Index").Cells(i, 1).Value = slovar.keys()(i - 3)
Next


While Cells(3, 1) <> ""
Rows(3).Delete Shift:=xlUp
Wend
Rows(4).Delete Shift:=xlUp
Rows(5).Delete Shift:=xlUp
Rows(6).Delete Shift:=xlUp

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Worksheets("Index").Activate
    Columns("A:D").Select
    ActiveWorkbook.Worksheets("Index").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Index").Sort.SortFields.Add Key:=Range("A1"), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Index").Sort
        .SetRange Range("A:D")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
Worksheets("ONE").Activate
For i = 3 To st
Cells(i, 7) = Worksheets("Index").Cells(i - 2, 4).Value
Cells(i, 10) = Worksheets("Index").Cells(i - 2, 3).Value
Cells(i, 9) = Worksheets("Index").Cells(i - 2, 2).Value
Cells(i, 5) = Worksheets("Index").Cells(i - 2, 1).Value
Next
    
    summa = 0
    For i = 3 To st
    summa = summa + Cells(i, 9).Value
    Next
    
    Cells(i + 2, 9).Value = summa
    
    Application.ScreenUpdating = True
End Sub
Sub NEWLINEpress()
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'Application.ScreenUpdating = False
lastFREEline
CtrlBar.NlineEnter.Value = NLastFreeLine
CtrlBar.ComboBox2.Value = ""
CtrlBar.Ncode.Value = ""
CtrlBar.Articul.Text = ""
CtrlBar.TTX.Value = ""
CtrlBar.Ndoc.Value = ""
CtrlBar.BoxDATA.Value = ""
CtrlBar.ListOBG.Value = ""
CtrlBar.SEKCIYA.Value = ""
CtrlBar.Kol_vo.Value = ""
CtrlBar.INKol_vo.Value = ""
CtrlBar.Primechanie.Value = ""
CtrlBar.ListOBG2.Value = ""

'Application.ScreenUpdating = True
End Sub

Sub sort_names_art(b As MSForms.ComboBox)
'
' |fffd||fffd||fffd||fffd||fffd||fffd|3 |fffd||fffd||fffd||fffd||fffd||fffd|
'
'
Application.ScreenUpdating = False
    Sheets("Index").Select
    Cells.Select
    Selection.Delete Shift:=xlUp
    Sheets("CARDS").Select
    Range("C3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Sheets("Index").Select
    Range("A1").Select
    ActiveSheet.Paste
    Sheets("CARDS").Select
    Range("D3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Application.CutCopyMode = False
    Selection.Copy
    Sheets("Index").Select
    Range("B1").Select
    ActiveSheet.Paste

    ActiveSheet.UsedRange.Select
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("Index").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Index").Sort.SortFields.Add Key:=Columns("B:B"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("Index").Sort
        .SetRange Range("A:B")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.UsedRange.RemoveDuplicates Columns:=2, Header:=xlNo
    ActiveSheet.UsedRange.Select
    b.Clear
    Dim Data(), step
    Data = Selection.Value
    b.List = Data
'    CtrlBar.Show
'    CtrlBar.ComboBox2.Value = Selection.Value

Application.ScreenUpdating = True
End Sub

Sub cardFINDdata()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'
'

'Application.ScreenUpdating = False
Dim a, base(), tmp(), schet, schetFOR, i, Rash, Kol_vo, RashOS, kol_voOS

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = CtrlBar.BoxDATA.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BaseSH.Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 7)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
tmp = Selection.Value
ReDim base(UBound(tmp), 1)
For i = 1 To UBound(tmp)
base(i, 0) = tmp(i, 1)
base(i, 1) = tmp(i, 7)
Next
Erase tmp

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
OtchSH.Select
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveWindow.FreezePanes = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells.Select: Selection.Delete Shift:=xlUp
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns(1).Select: Selection.ColumnWidth = 8
    Columns(2).Select: Selection.ColumnWidth = 0
    Columns(3).Select: Selection.ColumnWidth = 20
    Columns(4).Select: Selection.ColumnWidth = 40
    Columns(5).Select: Selection.ColumnWidth = 9
    Columns(6).Select: Selection.ColumnWidth = 10
    Columns(7).Select: Selection.ColumnWidth = 12
    Columns(8).Select: Selection.ColumnWidth = 28
    Columns(9).Select: Selection.ColumnWidth = 28
    Columns(10).Select: Selection.ColumnWidth = 11
    Columns(11).Select: Selection.ColumnWidth = 15
    Columns(12).Select: Selection.ColumnWidth = 0
    Columns(13).Select: Selection.ColumnWidth = 0
    Columns(14).Select: Selection.ColumnWidth = 0
    Columns(15).Select: Selection.ColumnWidth = 0
    Columns(16).Select: Selection.ColumnWidth = 35
'|fffd||fffd||fffd||fffd||fffd|
    Cells(1, 1).Value = "|fffd|"
    Cells(1, 3).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 4).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|."
    Cells(1, 6).Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 7).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 8).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 9).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 10).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 11).Value = "|fffd||fffd||fffd|. |fffd|"
    Cells(1, 12).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 13).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 14).Value = "|fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 15).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 16).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("A1:P1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|


Cells(1, 1).Select

schet = 1
i = 1
Rash = 0
Kol_vo = 0
RashOS = 0
kol_voOS = 0
While schet <= UBound(base)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If a = "" & base(schet, 1) Then
                                For schetFOR = 1 To 16
                                OtchSH.Cells(i + 1, schetFOR).Value = BaseSH.Cells(base(schet, 0), schetFOR).Value
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                If BaseSH.Cells(base(schet, 0), schetFOR).Font.Strikethrough = True Then OtchSH.Cells(i + 1, schetFOR).Font.Strikethrough = True
                                Next
                                OtchSH.Cells(i + 1, 11).Value = CStr(BaseSH.Cells(base(schet, 0), 11).Value)
                                OtchSH.Cells(i + 1, 14).Value = CStr(BaseSH.Cells(base(schet, 0), 14).Value)

                                OtchSH.Cells(i + 1, 9).Value = BaseSH.Cells(base(schet, 0), 17).Value

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
i = i + 1

End If
schet = schet + 1
Wend

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
crtl_window_long_size
CtrlBar.MP1.Value = 1

If OtchSH.Cells(3, 1).Value = "" Then
                                        Range(Cells(2, 1), Cells(4, 17)).Select
                                        Else
                                        Range(Cells(2, 1), Cells(Selection.End(xlDown) + 2, 17)).Select
End If

With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
Cells(2, 1).Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Selection.RowHeight = 20
    Range("A3").Select
    ActiveWindow.FreezePanes = True
    Rows("2:2").Select: Selection.RowHeight = 30

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, 8).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|"
    
    Rows(1).Select
    With Selection.Font
        .Name = "Arial"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(3).Select: Selection.HorizontalAlignment = xlLeft
    Columns(10).Select: Selection.HorizontalAlignment = xlRight

    Rows("3:3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.AutoFit


    Rows(1).Select

'Application.ScreenUpdating = True

End Sub
Sub cardFINDEMPTYdata()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
'
'

Application.ScreenUpdating = False
Dim a, base(), tmp(), schet, schetFOR, i, Rash, Kol_vo, RashOS, kol_voOS

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = CtrlBar.BoxDATA.Value
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BaseSH.Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

base = Selection.Value

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
OtchSH.Select
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveWindow.FreezePanes = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells.Select: Selection.Delete Shift:=xlUp
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns(1).Select: Selection.ColumnWidth = 8
    Columns(2).Select: Selection.ColumnWidth = 10
    Columns(3).Select: Selection.ColumnWidth = 20
    Columns(4).Select: Selection.ColumnWidth = 40
    Columns(5).Select: Selection.ColumnWidth = 9
    Columns(6).Select: Selection.ColumnWidth = 10
    Columns(7).Select: Selection.ColumnWidth = 12
    Columns(8).Select: Selection.ColumnWidth = 28
    Columns(9).Select: Selection.ColumnWidth = 28
    Columns(10).Select: Selection.ColumnWidth = 8
    Columns(11).Select: Selection.ColumnWidth = 15
    Columns(12).Select: Selection.ColumnWidth = 0
    Columns(13).Select: Selection.ColumnWidth = 8
    Columns(14).Select: Selection.ColumnWidth = 15
    Columns(15).Select: Selection.ColumnWidth = 0
    Columns(16).Select: Selection.ColumnWidth = 35
'|fffd||fffd||fffd||fffd||fffd|
    Cells(1, 1).Value = "|fffd|"
    Cells(1, 3).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 4).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|."
    Cells(1, 6).Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 7).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 8).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 9).Value = "|fffd||fffd||fffd||fffd|"
    Cells(1, 10).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 11).Value = "|fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 12).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 13).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 14).Value = "|fffd||fffd||fffd|. |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 15).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(1, 16).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("A1:P1").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|


Cells(1, 1).Select

schet = 3
i = 1
'Rash = 0
'kol_vo = 0
'RashOS = 0
'kol_voOS = 0
While schet <= UBound(base)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

                                For schetFOR = 1 To 16
                                OtchSH.Cells(i + 1, schetFOR).Value = BaseSH.Cells(base(schet, 1), schetFOR).Value
                                '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                                If BaseSH.Cells(base(schet, 1), schetFOR).Font.Strikethrough = True Then OtchSH.Cells(i + 1, schetFOR).Font.Strikethrough = True
                                Next
                                OtchSH.Cells(i + 1, 11).Value = CStr(BaseSH.Cells(base(schet, 1), 11).Value)
                                OtchSH.Cells(i + 1, 14).Value = CStr(BaseSH.Cells(base(schet, 1), 14).Value)
                                OtchSH.Cells(i + 1, 9).Value = BaseSH.Cells(base(schet, 1), 17).Value

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
i = i + 1
schet = schet + 1
Wend

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
crtl_window_long_size
CtrlBar.MP1.Value = 1

If OtchSH.Cells(3, 1).Value = "" Then
                                        Range(Cells(2, 1), Cells(4, 17)).Select
                                        Else
                                        Range(Cells(2, 1), Cells(Selection.End(xlDown) + 2, 17)).Select
End If

With Selection
        .HorizontalAlignment = xlGeneral
        .VerticalAlignment = xlTop
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
End With
Cells(2, 1).Select

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Rows("1:1").Select
    Selection.Insert Shift:=xlDown, CopyOrigin:=xlFormatFromLeftOrAbove
    Selection.RowHeight = 20
    Range("A3").Select
    ActiveWindow.FreezePanes = True
    Rows("2:2").Select: Selection.RowHeight = 30

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
Cells(1, 8).Value = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    
    Rows(1).Select
    With Selection.Font
        .Name = "Arial"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection.Font
        .Name = "Arial"
        .Size = 16
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
    With Selection
        .HorizontalAlignment = xlLeft
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns("C:C").Select
    Selection.HorizontalAlignment = xlLeft
    Rows("3:3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.AutoFit


    Rows(1).Select

Application.ScreenUpdating = True

End Sub

Sub |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|()
 
ThisWorkbook.Sheets("ONE").Select
ActiveWindow.FreezePanes = False
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 1)).Select
Dim base(), Ki, i
base = Selection
Ki = UBound(base)
Erase base
ReDim base(Ki, 4)

Range(Cells(1, 10), Cells(Ki, 14)).Select
base = Selection

For i = 1 To Ki
If base(i, 1) = "" Then base(i, 1) = base(i, 4): base(i, 2) = base(i, 5): base(i, 4) = Empty: base(i, 5) = Empty
Next i

Selection = base

End Sub
Sub otchet_sklad_TMC()
'
' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
'
'

'Application.ScreenUpdating = False
Dim a, b, base(), schet, schetFOR, i, Rash, Kol_vo, toSklad
toSklad = 8
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
a = CtrlBar.ListOBG2.Value: b = CtrlBar.Articul.Text

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
BaseSH.Select
Cells(1, 1).Select
Range(Cells(1, 1), Cells(Selection.End(xlDown), 17)).Select
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
base = Selection.Value

'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|
OtchSH.Select

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ActiveWindow.FreezePanes = False
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Cells.Select: Selection.Delete Shift:=xlUp
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|

    Columns(1).Select: Selection.ColumnWidth = 8 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(2).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(3).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd|
    Columns(4).Select: Selection.ColumnWidth = 25 '|fffd||fffd||fffd||fffd||fffd|
    Columns(5).Select: Selection.ColumnWidth = 25 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(6).Select: Selection.ColumnWidth = 50 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(7).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(8).Select: Selection.ColumnWidth = 15 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(9).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(10).Select: Selection.ColumnWidth = 10 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(11).Select: Selection.ColumnWidth = 15 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(12).Select: Selection.ColumnWidth = 0 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Columns(13).Select: Selection.ColumnWidth = 31 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 209

'|fffd||fffd||fffd||fffd||fffd|
    Cells(2, 1).Value = "|fffd|"
    Cells(2, 2).Value = "|fffd| |fffd||fffd||fffd|"
    Cells(2, 3).Value = "|fffd||fffd||fffd||fffd|"
    Cells(2, 4).Value = "|fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 5).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 6).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 7).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 8).Value = "|fffd||fffd||fffd| |fffd|"
    Cells(2, 9).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 10).Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 11).Value = "|fffd||fffd||fffd| |fffd|"
    Cells(2, 12).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Cells(2, 13).Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
    Range("A2:M2").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    With Selection.Font
        .Name = "Arial"
        .FontStyle = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        .Size = 10
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontNone
    End With
'|fffd||fffd||fffd||fffd||fffd| |fffd||fffd|

schet = 3
i = 3
Rash = 0
Kol_vo = 0
While schet <= UBound(base)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd|

Select Case b
        Case Is = "" '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If a = base(schet, SKLAD) Or a = base(schet, toSklad) Then

                            OtchSH.Cells(i, 1).Value = base(schet, 1) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 2).Value = base(schet, 6) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.
                            OtchSH.Cells(i, 3).Value = base(schet, 7) '|fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, SKLAD) Then OtchSH.Cells(i, 4).Value = base(schet, 8) '|fffd||fffd||fffd||fffd||fffd|
                            If a = base(schet, toSklad) Then OtchSH.Cells(i, 4).Value = base(schet, 17) '|fffd||fffd||fffd||fffd||fffd|
                            
                                                        OtchSH.Cells(i, 5).Value = base(schet, 3) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 6).Value = base(schet, 4) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, SKLAD) Then
                                                        OtchSH.Cells(i, 7).Value = base(schet, 10) '|fffd||fffd||fffd||fffd||fffd||fffd|
                                                        OtchSH.Cells(i, 8).Value = base(schet, 11) '|fffd||fffd||fffd| |fffd|
                            End If
                            
                            Sheets("Names").Cells(i, 9).Value = base(schet, 15) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, toSklad) Then
                                                        OtchSH.Cells(i, 10).Value = base(schet, 10) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                        OtchSH.Cells(i, 11).Value = base(schet, 11) '|fffd||fffd||fffd| |fffd|
                            End If
                            
                            OtchSH.Cells(i, 12).Value = base(schet, 12) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 13).Value = base(schet, 16) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            i = i + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                End If
        Case Is <> "" '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                If b = base(schet, 3) Then
                    If a = base(schet, SKLAD) Or a = base(schet, toSklad) Then

                            OtchSH.Cells(i, 1).Value = base(schet, 1) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 2).Value = base(schet, 6) '|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|.
                            OtchSH.Cells(i, 3).Value = base(schet, 7) '|fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, SKLAD) Then OtchSH.Cells(i, 4).Value = base(schet, 8) '|fffd||fffd||fffd||fffd||fffd|
                            If a = base(schet, toSklad) Then OtchSH.Cells(i, 4).Value = base(schet, 17) '|fffd||fffd||fffd||fffd||fffd|
                            
                            OtchSH.Cells(i, 5).Value = base(schet, 3) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 6).Value = base(schet, 4) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, SKLAD) Then
                                                        OtchSH.Cells(i, 7).Value = base(schet, 10) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                                                        OtchSH.Cells(i, 8).Value = base(schet, 11) '|fffd||fffd||fffd| |fffd|
                                                        Kol_vo = Kol_vo + CDbl(base(schet, 10))
                            End If
                            
                            Sheets("Names").Cells(i, 9).Value = base(schet, 15) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            
                            If a = base(schet, toSklad) Then
                                                        OtchSH.Cells(i, 10).Value = base(schet, 10) '|fffd||fffd||fffd||fffd||fffd||fffd|
                                                        OtchSH.Cells(i, 11).Value = base(schet, 11) '|fffd||fffd||fffd| |fffd|
                                                        Rash = Rash + CDbl(base(schet, 10))
                            End If
                            
                            OtchSH.Cells(i, 12).Value = base(schet, 12) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            OtchSH.Cells(i, 13).Value = base(schet, 16) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                            i = i + 1 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    End If
                End If
End Select
schet = schet + 1
Wend



'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|
crtl_window_long_size
CtrlBar.MP1.Value = 1
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

Cells(i + 2, 7).Value = Kol_vo
Cells(i + 2, 10).Value = Rash

Cells(1, 1).Value = a
Cells(1, 1).Font.Size = 14

Cells(1, 6).Value = CtrlBar.ComboBox2.Value
Cells(1, 6).Font.Size = 14

    Columns(6).Select: Selection.HorizontalAlignment = xlLeft
    Columns(7).Select: Selection.HorizontalAlignment = xlRight
    Columns(10).Select: Selection.HorizontalAlignment = xlRight
    
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Range("A3").Select
    ActiveWindow.FreezePanes = True
    Rows(1).Select
    Selection.WrapText = False
'    Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Activate()


End Sub

Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_Open()
Application.ScreenUpdating = False
'Application.EnableCancelKey = xlEnabled
'Application.EnableCancelKey = xlDisabled
Application.WindowState = xlMaximized
Set Book = ActiveWorkbook
Set BaseSH = ThisWorkbook.Worksheets("CARDS")
Set OtchSH = ThisWorkbook.Worksheets("ONE")
BaseSH.Visible = -1
CtrlBar.Caption = "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" & " " & Book.Name & " " & Date
Workbooks(Book.Name).Activate
crtl_window_start_size
Application.ScreenUpdating = True
'Stop
CtrlBar.Show
End Sub


INQUEST-PP=macro
