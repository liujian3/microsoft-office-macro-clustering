Attribute VB_Name = "Hoja1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_Activate()
    numanys = Range("J9").Value
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim KeyCells As Range
    Dim mostrarTabs As Boolean
    'Idioma
    If Not Application.Intersect(Range("c5:c5"), Range(Target.Address)) Is Nothing Then
        RenombrarMenus Target.Value
        BtnUpdateCommentsClick
    End If

    'NomProjecte
    If Not Application.Intersect(Range("e9"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Promotor
    If Not Application.Intersect(Range("e11"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Email
    If Not Application.Intersect(Range("e13"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Telefon
    If Not Application.Intersect(Range("e15"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    'Num Socis
    If Not Application.Intersect(Range("e17"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
        'resize rang NumSocis
        If Target.Value <> "" Then
            ResizeRangNumSocis Target.Value
        End If
    End If
    'Num Anys
    If Not Application.Intersect(Range("J9:J9"), Range(Target.Address)) Is Nothing Then
        Dim txtSeleccionat As String
      
        txtSeleccionat = Target.Value
        If txtSeleccionat <> "" Then
            numanys = CInt(Left(txtSeleccionat, 1))
        End If
        CanviAnysPlaFinancer (numanys)
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Data inici
    If Not Application.Intersect(Range("J11"), Range(Target.Address)) Is Nothing Then
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Forma Juridica
    If Not Application.Intersect(Range("J13:J13"), Range(Target.Address)) Is Nothing Then
        BorrarContingut "Inici", Range("J15:J15")
        BorrarContingut "Inici", Range("J17:J17")
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Tributacio
    If Not Application.Intersect(Range("J15:J15"), Range(Target.Address)) Is Nothing Then
        BorrarContingut "Inici", Range("J17:J17")
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    'Tipus IVA
    If Not Application.Intersect(Range("J17:J17"), Range(Target.Address)) Is Nothing Then
        If Target.Value <> "" Then ActualitzarIves
        mostrarTabs = CalMostrarTabs
        MostrarTabsTreball mostrarTabs
    End If
    
    
    
    Dim strValidationList As String
Dim strVal As String
Dim lngNum As Long
Dim rang As Range
On Error GoTo Nevermind
strValidationList = Mid(Target.Validation.Formula1, 2)
strVal = Target.Value
Set rang = Worksheets("NT").Range(strValidationList)
lngNum = Application.WorksheetFunction.Match(strVal, rang, 0)

If strVal <> "" And lngNum > 0 Then
    Application.EnableEvents = False
    Target.Formula = "=INDEX(" & strValidationList & ", " & lngNum & ")"
End If
Nevermind:
Application.EnableEvents = True
End Sub


Private Sub ResizeRangNumSocis(ByVal sNumSocis As String)
Dim rang As String
Dim numSocis As Integer
numSocis = CInt(sNumSocis)
numSocis = numSocis + 1
rang = "=NT!$P$2:$P$" & numSocis
ActiveWorkbook.Names("Socisunic").RefersTo = rang
End Sub
Attribute VB_Name = "Hoja10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Amagar0T_Click()
    Amagar0
End Sub

Public Sub Amagar0()
 Dim mostrar As Boolean
    
    If Buttons("btnAmagar0_T").Caption = "Amagar 0" Then
        mostrar = False
        Buttons("btnAmagar0_T").Caption = "Mostrar"
    Else
        mostrar = True
        Buttons("btnAmagar0_T").Caption = "Amagar 0"
    End If
    
    If TotZero("D7:BK7") Then Visibilitat "", "7", mostrar
    If TotZero("D8:BK8") Then Visibilitat "", "8", mostrar
    If TotZero("D9:BK9") Then Visibilitat "", "9", mostrar
    If TotZero("D10:BK10") Then Visibilitat "", "10", mostrar
    
    
    If TotZero("D12:BK12") Then Visibilitat "", "12", mostrar
    If TotZero("D13:BK13") Then Visibilitat "", "13", mostrar
    
    If TotZero("D16:BK16") Then Visibilitat "", "16", mostrar
    
    If TotZero("D23:BK23") Then Visibilitat "", "23", mostrar
    If TotZero("D24:BK24") Then Visibilitat "", "24", mostrar
    If TotZero("D25:BK25") Then Visibilitat "", "25", mostrar
    If TotZero("D26:BK26") Then Visibilitat "", "26", mostrar
    If TotZero("D27:BK27") Then Visibilitat "", "27", mostrar
    
     
    If TotZero("D29:BK29") Then Visibilitat "", "29", mostrar
    If TotZero("D30:BK30") Then Visibilitat "", "30", mostrar
       
    If TotZero("D35:BK35") Then Visibilitat "", "35", mostrar
    If TotZero("D36:BK36") Then Visibilitat "", "36", mostrar
    If TotZero("D37:BK37") Then Visibilitat "", "37", mostrar
    If TotZero("D38:BK38") Then Visibilitat "", "38", mostrar
    If TotZero("D39:BK39") Then Visibilitat "", "39", mostrar
    If TotZero("D40:BK40") Then Visibilitat "", "40", mostrar
    If TotZero("D41:BK41") Then Visibilitat "", "41", mostrar
    If TotZero("D42:BK42") Then Visibilitat "", "42", mostrar
    If TotZero("D43:BK43") Then Visibilitat "", "43", mostrar
    If TotZero("D44:BK44") Then Visibilitat "", "44", mostrar
    If TotZero("D45:BK45") Then Visibilitat "", "45", mostrar
    If TotZero("D46:BK46") Then Visibilitat "", "46", mostrar
    If TotZero("D47:BK47") Then Visibilitat "", "47", mostrar
    If TotZero("D48:BK48") Then Visibilitat "", "48", mostrar
    If TotZero("D49:BK49") Then Visibilitat "", "49", mostrar
     
    
    
    
    
End Sub
Attribute VB_Name = "Hoja11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub amagarefe_Click()
    Amagar0
End Sub

Public Sub Amagar0()
    Dim mostrar As Boolean
    
    If Buttons("btnAmagar0_EFE").Caption = "Amagar 0" Then
        mostrar = False
        Buttons("btnAmagar0_EFE").Caption = "Mostrar"
    Else
        mostrar = True
        Buttons("btnAmagar0_EFE").Caption = "Amagar 0"
    End If
    
    If TotZero("c10:g10") Then Visibilitat "", "10", mostrar
    If TotZero("c11:g11") Then Visibilitat "", "11", mostrar
    If TotZero("c12:g12") Then Visibilitat "", "12", mostrar
    If TotZero("c13:g13") Then Visibilitat "", "13", mostrar
    
    If TotZero("c15:g15") Then Visibilitat "", "15", mostrar
    If TotZero("c16:g16") Then Visibilitat "", "16", mostrar
    If TotZero("c17:g17") Then Visibilitat "", "17", mostrar
    If TotZero("c18:g18") Then Visibilitat "", "18", mostrar
    If TotZero("c19:g19") Then Visibilitat "", "19", mostrar
    If TotZero("c20:g20") Then Visibilitat "", "20", mostrar
    
    If TotZero("c22:g22") Then Visibilitat "", "22", mostrar
    If TotZero("c23:g23") Then Visibilitat "", "23", mostrar
    If TotZero("c24:g24") Then Visibilitat "", "24", mostrar
    
    
    If TotZero("c29:g29") Then Visibilitat "", "29", mostrar
    If TotZero("c30:g30") Then Visibilitat "", "30", mostrar
    If TotZero("c31:g31") Then Visibilitat "", "31", mostrar
    If TotZero("c32:g32") Then Visibilitat "", "32", mostrar
    
    
    If TotZero("c38:g38") Then Visibilitat "", "38", mostrar
    If TotZero("c39:g39") Then Visibilitat "", "39", mostrar
    
    If TotZero("c41:g41") Then Visibilitat "", "41", mostrar
    If TotZero("c42:g42") Then Visibilitat "", "42", mostrar
    If TotZero("c43:g43") Then Visibilitat "", "43", mostrar
    If TotZero("c44:g44") Then Visibilitat "", "44", mostrar
    If TotZero("c45:g45") Then Visibilitat "", "45", mostrar
    If TotZero("c46:g46") Then Visibilitat "", "46", mostrar
End Sub
Attribute VB_Name = "Hoja12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
    Dim KeyCells As Range

    'Num Productes
    If Not Application.Intersect(Range("c7:c7"), Range(Target.Address)) Is Nothing Then
        Dim numProds As Integer
        Dim txtSeleccionat As String
        txtSeleccionat = Target.Value
        numProds = CInt(txtSeleccionat)
        CanvivisibilitatProductes (numProds)
        MostrarOAmagarSupplies Range("b7").Value
        
    End If
    'Tipo compras
    If Not Application.Intersect(Range("b7"), Range(Target.Address)) Is Nothing Then
       MostrarOAmagarSupplies Target.Value
    End If
  
'*********************************************************************************
Dim strValidationList As String
Dim strVal As String
Dim lngNum As Long
Dim rang As Range
On Error GoTo Nevermind
strValidationList = Mid(Target.Validation.Formula1, 2)
strVal = Target.Value
Set rang = Worksheets("NT").Range(strValidationList)
lngNum = Application.WorksheetFunction.Match(strVal, rang, 0)

If strVal <> "" And lngNum > 0 Then
    Application.EnableEvents = False
    Target.Formula = "=INDEX(" & strValidationList & ", " & lngNum & ")"
End If
Nevermind:
Application.EnableEvents = True
'********************************************************************************
End Sub
Attribute VB_Name = "Hoja16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Amagarstock_Click()
    Amagar0
End Sub

Public Sub Amagar0()
 Dim mostrar As Boolean
    
    If Buttons("btnAmagar0_Stock").Caption = "Amagar 0" Then
        mostrar = False
        Buttons("btnAmagar0_Stock").Caption = "Mostrar"
    Else
        mostrar = True
        Buttons("btnAmagar0_Stock").Caption = "Amagar 0"
    End If
    
    
     If TotZero("d9:t9") Then Visibilitat "", "9", mostrar
    If TotZero("d10:t10") Then Visibilitat "", "10", mostrar
    If TotZero("d11:t11") Then Visibilitat "", "11", mostrar
    If TotZero("d12:t12") Then Visibilitat "", "12", mostrar
    If TotZero("d13:t13") Then Visibilitat "", "13", mostrar
    If TotZero("d14:t14") Then Visibilitat "", "14", mostrar
    If TotZero("d15:t15") Then Visibilitat "", "15", mostrar
    If TotZero("d16:t16") Then Visibilitat "", "16", mostrar
    If TotZero("d17:t17") Then Visibilitat "", "17", mostrar
    If TotZero("d18:t18") Then Visibilitat "", "18", mostrar
    If TotZero("d19:t19") Then Visibilitat "", "19", mostrar
    If TotZero("d20:t20") Then Visibilitat "", "20", mostrar
    If TotZero("d21:t21") Then Visibilitat "", "21", mostrar
    If TotZero("d22:t22") Then Visibilitat "", "22", mostrar
    If TotZero("d23:t23") Then Visibilitat "", "23", mostrar
     
    If TotZero("d28:n28") Then Visibilitat "", "28", mostrar
    If TotZero("d29:n29") Then Visibilitat "", "29", mostrar
    If TotZero("d30:n30") Then Visibilitat "", "30", mostrar
    If TotZero("d31:n31") Then Visibilitat "", "31", mostrar
    If TotZero("d32:n32") Then Visibilitat "", "32", mostrar
    If TotZero("d33:n33") Then Visibilitat "", "33", mostrar
    If TotZero("d34:n34") Then Visibilitat "", "34", mostrar
    If TotZero("d35:n35") Then Visibilitat "", "35", mostrar
    If TotZero("d36:n36") Then Visibilitat "", "36", mostrar
    If TotZero("d37:n37") Then Visibilitat "", "37", mostrar
    If TotZero("d38:n38") Then Visibilitat "", "38", mostrar
    If TotZero("d39:n39") Then Visibilitat "", "39", mostrar
    If TotZero("d40:n40") Then Visibilitat "", "40", mostrar
    If TotZero("d41:n41") Then Visibilitat "", "41", mostrar
    If TotZero("d42:n42") Then Visibilitat "", "42", mostrar
    
    If TotZero("d47:t47") Then Visibilitat "", "47", mostrar
    If TotZero("d48:t48") Then Visibilitat "", "48", mostrar
    If TotZero("d49:t49") Then Visibilitat "", "49", mostrar
    If TotZero("d50:t50") Then Visibilitat "", "50", mostrar
    If TotZero("d51:t51") Then Visibilitat "", "51", mostrar
    If TotZero("d52:t52") Then Visibilitat "", "52", mostrar
    If TotZero("d53:t53") Then Visibilitat "", "53", mostrar
    If TotZero("d54:t54") Then Visibilitat "", "54", mostrar
    If TotZero("d55:t55") Then Visibilitat "", "55", mostrar
    If TotZero("d56:t56") Then Visibilitat "", "56", mostrar
    If TotZero("d57:t57") Then Visibilitat "", "57", mostrar
    If TotZero("d58:t58") Then Visibilitat "", "58", mostrar
    If TotZero("d59:t59") Then Visibilitat "", "59", mostrar
    If TotZero("d60:t60") Then Visibilitat "", "60", mostrar
    If TotZero("d61:t61") Then Visibilitat "", "61", mostrar
    
    If TotZero("d66:n66") Then Visibilitat "", "66", mostrar
    If TotZero("d67:n67") Then Visibilitat "", "67", mostrar
    If TotZero("d68:n68") Then Visibilitat "", "68", mostrar
    If TotZero("d69:n69") Then Visibilitat "", "69", mostrar
    If TotZero("d70:n70") Then Visibilitat "", "70", mostrar
    If TotZero("d71:n71") Then Visibilitat "", "71", mostrar
    If TotZero("d72:n72") Then Visibilitat "", "72", mostrar
    If TotZero("d73:n73") Then Visibilitat "", "73", mostrar
    If TotZero("d74:n74") Then Visibilitat "", "74", mostrar
    If TotZero("d75:n75") Then Visibilitat "", "75", mostrar
    If TotZero("d76:n76") Then Visibilitat "", "76", mostrar
    If TotZero("d77:n77") Then Visibilitat "", "77", mostrar
    If TotZero("d78:n78") Then Visibilitat "", "78", mostrar
    If TotZero("d79:n79") Then Visibilitat "", "79", mostrar
    If TotZero("d80:n80") Then Visibilitat "", "80", mostrar
    
    If TotZero("d85:t85") Then Visibilitat "", "85", mostrar
    If TotZero("d86:t86") Then Visibilitat "", "86", mostrar
    If TotZero("d87:t87") Then Visibilitat "", "87", mostrar
    If TotZero("d88:t88") Then Visibilitat "", "88", mostrar
    If TotZero("d89:t89") Then Visibilitat "", "89", mostrar
    If TotZero("d90:t90") Then Visibilitat "", "90", mostrar
    If TotZero("d91:t91") Then Visibilitat "", "91", mostrar
    If TotZero("d92:t92") Then Visibilitat "", "92", mostrar
    If TotZero("d93:t93") Then Visibilitat "", "93", mostrar
    If TotZero("d94:t94") Then Visibilitat "", "94", mostrar
    If TotZero("d95:t95") Then Visibilitat "", "95", mostrar
    If TotZero("d96:t96") Then Visibilitat "", "96", mostrar
    If TotZero("d97:t97") Then Visibilitat "", "97", mostrar
    If TotZero("d98:t98") Then Visibilitat "", "98", mostrar
    If TotZero("d99:t99") Then Visibilitat "", "99", mostrar
End Sub
Attribute VB_Name = "Hoja17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
Dim strValidationList As String
Dim strVal As String
Dim lngNum As Long
Dim rang As Range
On Error GoTo Nevermind
strValidationList = Mid(Target.Validation.Formula1, 2)
strVal = Target.Value
Set rang = Worksheets("NT").Range(strValidationList)
lngNum = Application.WorksheetFunction.Match(strVal, rang, 0)

If strVal <> "" And lngNum > 0 Then
    Application.EnableEvents = False
    Target.Formula = "=INDEX(" & strValidationList & ", " & lngNum & ")"
End If
Nevermind:
Application.EnableEvents = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    'Cap|fffd|alera Gran
        
    If ClickOnRange(Target, "A11") Then
        If Range("A11").FormulaR1C1 = "+" Then
            Visibilitat "", "12:12", True
            Range("A11").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "12:12", False
            Range("A11").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B11").Select
    Else
        ControlRangeVisibility Target, "A11", "12:12"
        
    End If
    
        If ClickOnRange(Target, "A12") Then
        If Range("A12").FormulaR1C1 = "+" Then
            Visibilitat "", "13:13", True
            Range("A12").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "13:13", False
            Range("A12").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B12").Select
    Else
        ControlRangeVisibility Target, "A12", "13:13"
        
    End If
    
    If ClickOnRange(Target, "A13") Then
        If Range("A13").FormulaR1C1 = "+" Then
            Visibilitat "", "14:14", True
            Range("A13").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "14:14", False
            Range("A13").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B13").Select
    Else
        ControlRangeVisibility Target, "A13", "14:14"
        
    End If
    
    If ClickOnRange(Target, "A14") Then
        If Range("A14").FormulaR1C1 = "+" Then
            Visibilitat "", "15:15", True
            Range("A14").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "15:15", False
            Range("A14").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B14").Select
    Else
        ControlRangeVisibility Target, "A14", "15:15"
        
    End If
    
    If ClickOnRange(Target, "A15") Then
        If Range("A15").FormulaR1C1 = "+" Then
            Visibilitat "", "16:16", True
            Range("A15").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "16:16", False
            Range("A15").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B15").Select
    Else
        ControlRangeVisibility Target, "A15", "16:16"
        
    End If
    If ClickOnRange(Target, "A16") Then
        If Range("A16").FormulaR1C1 = "+" Then
            Visibilitat "", "17:17", True
            Range("A16").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "17:17", False
            Range("A16").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B16").Select
    Else
        ControlRangeVisibility Target, "A16", "17:17"
        
    End If
    If ClickOnRange(Target, "A17") Then
        If Range("A17").FormulaR1C1 = "+" Then
            Visibilitat "", "18:18", True
            Range("A17").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "18:18", False
            Range("A17").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B17").Select
    Else
        ControlRangeVisibility Target, "A17", "18:18"
        
    End If
    
    
    
    
     
    
    
    
    If ClickOnRange(Target, "A29") Then
        If Range("A29").FormulaR1C1 = "+" Then
            Visibilitat "", "30:30", True
            Range("A29").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "30:30", False
            Range("A29").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B29").Select
    Else
        ControlRangeVisibility Target, "A29", "30:30"
        
    End If
    
     If ClickOnRange(Target, "A30") Then
        If Range("A30").FormulaR1C1 = "+" Then
            Visibilitat "", "31:31", True
            Range("A30").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "31:31", False
            Range("A30").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B30").Select
    Else
        ControlRangeVisibility Target, "A30", "31:31"
        
    End If
      

End Sub
Attribute VB_Name = "Hoja19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    'ANY 1
    If ClickOnRange(Target, "A11") Then
        If Range("A11").FormulaR1C1 = "+" Then
            Visibilitat "", "13:33", True
            Range("A11").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "13:18", False
            Visibilitat "", "20:29", False
            Visibilitat "", "31:32", False
            Range("A11").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B11").Select
    End If
    'ANY 2
    If ClickOnRange(Target, "A35") Then
        If Range("A35").FormulaR1C1 = "+" Then
            Visibilitat "", "37:57", True
            Range("A35").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "37:42", False
            Visibilitat "", "44:53", False
            Visibilitat "", "55:56", False
            Range("A35").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B35").Select
    End If
    'ANY 3
    If ClickOnRange(Target, "A59") Then
        If Range("A59").FormulaR1C1 = "+" Then
            Visibilitat "", "61:81", True
            Range("A59").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "61:66", False
            Visibilitat "", "68:77", False
            Visibilitat "", "79:80", False
            Range("A59").Cells().FormulaR1C1 = "+"
            
        End If
        Range("B59").Select
    End If
    'ANY 4
    If ClickOnRange(Target, "A83") Then
        If Range("A83").FormulaR1C1 = "+" Then
            Visibilitat "", "85:105", True
            Range("A83").Cells().FormulaR1C1 = "-"
            
        Else
            Visibilitat "", "85:90", False
            Visibilitat "", "92:101", False
            Visibilitat "", "103:104", False
            Range("A83").Cells().FormulaR1C1 = "+"
        End If
        Range("B83").Select
    End If
    'ANY 5
    If ClickOnRange(Target, "A107") Then
        If Range("A107").FormulaR1C1 = "+" Then
            Visibilitat "", "109:129", True
            Range("A107").Cells().FormulaR1C1 = "-"
        Else
            Visibilitat "", "109:114", False
            Visibilitat "", "116:125", False
            Visibilitat "", "127:128", False
            Range("A107").Cells().FormulaR1C1 = "+"
        End If
        Range("B107").Select
    End If
    
End Sub
Attribute VB_Name = "Hoja20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
Dim strValidationList As String
Dim strVal As String
Dim lngNum As Long
Dim rang As Range
On Error GoTo Nevermind
strValidationList = Mid(Target.Validation.Formula1, 2)
strVal = Target.Value
Set rang = Worksheets("NT").Range(strValidationList)
lngNum = Application.WorksheetFunction.Match(strVal, rang, 0)

If strVal <> "" And lngNum > 0 Then
    Application.EnableEvents = False
    Target.Formula = "=INDEX(" & strValidationList & ", " & lngNum & ")"
End If
Nevermind:
Application.EnableEvents = True

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    If numanys = 3 Then
        ControlRangeVisibility Target, "A5", "6:51"
        ControlRangeVisibility Target, "A117", "118:141"
       
    End If
    
    If numanys = 4 Then
        ControlRangeVisibility Target, "A5", "6:66"
        ControlRangeVisibility Target, "A117", "118:149"
   
    End If
        
    If numanys = 5 Then
        ControlRangeVisibility Target, "A5", "6:81"
        ControlRangeVisibility Target, "A117", "118:157"
    
    End If
    
    ControlRangeVisibility Target, "A83", "84:114"
    ControlRangeVisibility Target, "A160", "161:178"

End Sub
Attribute VB_Name = "Hoja6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub btnAmagarSiZero_Click()
    Amagar0
End Sub

Public Sub Amagar0()
 Dim mostrar As Boolean
    
    If Buttons("btnAmagar0_Inv").Caption = "Amagar 0" Then
        mostrar = False
        Buttons("btnAmagar0_Inv").Caption = "Mostrar"
    Else
        mostrar = True
        Buttons("btnAmagar0_Inv").Caption = "Amagar 0"
    End If
    
    
    
    If TotZero("c9:g9") Then Visibilitat "", "9", mostrar
    If TotZero("c10:g10") Then Visibilitat "", "10", mostrar
    If TotZero("c11:g11") Then Visibilitat "", "11", mostrar
    If TotZero("c12:g12") Then Visibilitat "", "12", mostrar
    If TotZero("c13:g13") Then Visibilitat "", "13", mostrar
    If TotZero("c14:g14") Then Visibilitat "", "14", mostrar
    
   
    If TotZero("c19:g19") Then Visibilitat "", "19", mostrar
    If TotZero("c20:g20") Then Visibilitat "", "20", mostrar
    If TotZero("c21:g21") Then Visibilitat "", "21", mostrar
    If TotZero("c22:g22") Then Visibilitat "", "22", mostrar
    If TotZero("c23:g23") Then Visibilitat "", "23", mostrar
    If TotZero("c24:g24") Then Visibilitat "", "24", mostrar
    If TotZero("c25:g25") Then Visibilitat "", "25", mostrar
    If TotZero("c26:g26") Then Visibilitat "", "26", mostrar
    If TotZero("c27:g27") Then Visibilitat "", "27", mostrar
    If TotZero("c28:g28") Then Visibilitat "", "28", mostrar
    
    If TotZero("c32:g32") Then Visibilitat "", "32", mostrar
    If TotZero("c33:g33") Then Visibilitat "", "33", mostrar
    
    If TotZero("c37:g37") Then Visibilitat "", "37", mostrar
    If TotZero("c38:g38") Then Visibilitat "", "38", mostrar
   
    If TotZero("c42:g42") Then Visibilitat "", "42", mostrar
    If TotZero("c43:g43") Then Visibilitat "", "43", mostrar
    If TotZero("c44:g44") Then Visibilitat "", "44", mostrar
    
    
    
    If TotZero("c52:g52") Then Visibilitat "", "52", mostrar
    If TotZero("c53:g53") Then Visibilitat "", "53", mostrar
    If TotZero("c54:g54") Then Visibilitat "", "54", mostrar
    If TotZero("c55:g55") Then Visibilitat "", "55", mostrar
    If TotZero("c56:g56") Then Visibilitat "", "56", mostrar
   
    If TotZero("c58:g58") Then Visibilitat "", "58", mostrar
    If TotZero("c59:g59") Then Visibilitat "", "59", mostrar
    If TotZero("c60:g60") Then Visibilitat "", "60", mostrar
    If TotZero("c61:g61") Then Visibilitat "", "61", mostrar
    If TotZero("c62:g62") Then Visibilitat "", "62", mostrar
        
    If TotZero("c64:g64") Then Visibilitat "", "64", mostrar
    If TotZero("c65:g65") Then Visibilitat "", "65", mostrar
    If TotZero("c66:g66") Then Visibilitat "", "66", mostrar
    If TotZero("c67:g67") Then Visibilitat "", "67", mostrar
    If TotZero("c68:g68") Then Visibilitat "", "68", mostrar
    
    If TotZero("c70:g70") Then Visibilitat "", "70", mostrar
    If TotZero("c71:g71") Then Visibilitat "", "71", mostrar
    If TotZero("c72:g72") Then Visibilitat "", "72", mostrar
    If TotZero("c73:g73") Then Visibilitat "", "73", mostrar
    If TotZero("c74:g74") Then Visibilitat "", "74", mostrar
   
    
    
   
End Sub

Attribute VB_Name = "Hoja7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Hoja9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub amagarbs_Click()
    Call Amagar0
End Sub

Public Sub Amagar0()
    Dim mostrar As Boolean
    
    If Buttons("btnAmagar0_B").Caption = "Amagar 0" Then
        mostrar = False
        Buttons("btnAmagar0_B").Caption = "Mostrar"
    Else
        mostrar = True
        Buttons("btnAmagar0_B").Caption = "Amagar 0"
    End If
    
    
    
    If TotZero("c9:g9") Then Visibilitat "", "9", mostrar
    If TotZero("c10:g10") Then Visibilitat "", "10", mostrar
    If TotZero("c11:g11") Then Visibilitat "", "11", mostrar
    If TotZero("c12:g12") Then Visibilitat "", "12", mostrar
 
    If TotZero("c14:g14") Then Visibilitat "", "14", mostrar
    If TotZero("c15:g15") Then Visibilitat "", "15", mostrar
    If TotZero("c16:g16") Then Visibilitat "", "16", mostrar
    If TotZero("c17:g17") Then Visibilitat "", "17", mostrar
    If TotZero("c18:g18") Then Visibilitat "", "18", mostrar
    
    If TotZero("c24:g24") Then Visibilitat "", "24", mostrar
    If TotZero("c25:g25") Then Visibilitat "", "25", mostrar
    If TotZero("c26:g26") Then Visibilitat "", "26", mostrar
    If TotZero("c27:g27") Then Visibilitat "", "27", mostrar
    If TotZero("c28:g28") Then Visibilitat "", "28", mostrar
    If TotZero("c29:g29") Then Visibilitat "", "29", mostrar
    If TotZero("c30:g30") Then Visibilitat "", "30", mostrar
    If TotZero("c31:g31") Then Visibilitat "", "31", mostrar
    
    If TotZero("c33:g33") Then Visibilitat "", "33", mostrar
    If TotZero("c34:g34") Then Visibilitat "", "34", mostrar
    If TotZero("c35:g35") Then Visibilitat "", "35", mostrar
    If TotZero("c36:g36") Then Visibilitat "", "36", mostrar
    
    If TotZero("c38:g38") Then Visibilitat "", "38", mostrar
    If TotZero("c39:g39") Then Visibilitat "", "39", mostrar
    If TotZero("c40:g40") Then Visibilitat "", "40", mostrar
    If TotZero("c41:g41") Then Visibilitat "", "41", mostrar
    If TotZero("c42:g42") Then Visibilitat "", "42", mostrar
    If TotZero("c43:g43") Then Visibilitat "", "43", mostrar
    If TotZero("c44:g44") Then Visibilitat "", "44", mostrar
    If TotZero("c45:g45") Then Visibilitat "", "45", mostrar
    If TotZero("c46:g46") Then Visibilitat "", "46", mostrar
    If TotZero("c47:g47") Then Visibilitat "", "47", mostrar
End Sub

Attribute VB_Name = "M|fffd|dulo1"

Sub OPModCom()
Attribute OPModCom.VB_ProcData.VB_Invoke_Func = " \n14"
'
' OPModCom Macro
'

'
    Range("F12:G26,I12:J26").Select
    Range("I12").Activate
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 10001138
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
End Sub


Public Function esImportActivacioValid(fila As Integer, headerRow As Integer, import As Double, dataInici As Date) As Integer

Application.Volatile

If numanys = 0 Then
 numanys = Hoja1.Range("J9").Value
End If

startColumn = 5 'E
Dim dataLimit As Date
Dim headerLimit As Integer
headerLimit = headerRow + (8 * (numanys - 1))
dataLimit = Hoja5.Cells(headerLimit, 16).Value
If dataInici > Hoja5.Cells(headerLimit, 16).Value Then
    esImportActivacioValid = CVErr(xlErrValue)
End If

Dim total As Double
total = 0
Dim row As Integer
Dim col As Integer
For i = 0 To numanys - 1
    row = fila + 8 * i
    For j = 0 To 11
        col = startColumn + j
        If dataInici > Hoja5.Cells(headerRow + 8 * i, col) Then
            total = total + Hoja5.Cells(row, col)
        End If
    Next j
Next i

If total >= import Then
    esImportActivacioValid = 1
Else
    esImportActivacioValid = 0
End If




End Function
Attribute VB_Name = "M|fffd|dulo2"
Sub Amagar0_B()
    Hoja9.Amagar0
End Sub
Sub Amagar0_Stock()
    Hoja16.Amagar0
End Sub
Sub Amagar0_T()
    Hoja10.Amagar0
End Sub
Sub Amagar0_Inv()
    Hoja6.Amagar0
End Sub
Sub Amagar0_EFE()
    Hoja11.Amagar0
End Sub
Attribute VB_Name = "M|fffd|dulo5"
Public numanys As Integer

Sub ActualitzarPeus()
Dim lblPromotor, valPromotor, lblProjecte, valProjecte, lblMail, valMail, lblTelf, valTelf As String
lblPromotor = Worksheets("Home").Range("C11").Value
valPromotor = Worksheets("Home").Range("E11").Value
lblProjecte = Worksheets("Home").Range("C9").Value
valProjecte = Worksheets("Home").Range("E9").Value
lblMail = Worksheets("Home").Range("C13").Value
valMail = Worksheets("Home").Range("E13").Value
lblTelf = Worksheets("Home").Range("C15").Value
valTelf = Worksheets("Home").Range("E15").Value

Dim ws As Worksheet
For Each ws In Worksheets
    With ws.PageSetup
        .LeftHeader = ""
        .LeftFooter = "&""-,Negrita""&9" & lblPromotor & " &""-,Normal""" & valPromotor & " &""-,Negrita""" & lblProjecte & " &""-,Normal""" & valProjecte & " &""-,Negrita""" & lblMail & " &""-,Normal""" & valMail & " &""-,Negrita""" & lblTelf & " &""-,Normal""" & valTelf
    End With
Next ws

End Sub

Sub MostrarCVSeleccionado()
Attribute MostrarCVSeleccionado.VB_ProcData.VB_Invoke_Func = " \n14"
    If Range("ValorModelCostos").Value = 1 Then
        Sheets("CV").Visible = True
        Sheets("CV Auto").Visible = False
    ElseIf Range("ValorModelCostos").Value = 2 Then
        Sheets("CV").Visible = False
        Sheets("CV Auto").Visible = True
    End If
End Sub

Sub Visibilitat(ByVal SheetName As String, ByVal rang As String, ByVal hide As Boolean)
    If SheetName = "" Then
        Rows(rang).EntireRow.Hidden = Not hide
    Else
        Worksheets(SheetName).Rows(rang).EntireRow.Hidden = Not hide
    End If
End Sub

Function ClickOnRange(ByVal Target As Range, ByVal rang As String) As Boolean
    ClickOnRange = Not Intersect(Target, Range(rang)) Is Nothing
End Function

Sub ControlRangeVisibility(ByVal Target As Range, ByVal RangTrigger As String, ByVal RangFiles As String)
    If ClickOnRange(Target, RangTrigger) Then
        If Range(RangTrigger).FormulaR1C1 = "+" Then
            Visibilitat "", RangFiles, True
            Range(RangTrigger).Cells().FormulaR1C1 = "-"
        Else
            Visibilitat "", RangFiles, False
            Range(RangTrigger).Cells().FormulaR1C1 = "+"
        End If
        Range(RangTrigger).Offset(0, 1).Select
    End If
    
End Sub



Sub CanviAnysPlaFinancer(ByVal numanys As Integer)

CanviAnysPlaINV numanys
CanviAnysPlaC numanys

End Sub

Private Sub CanviAnysPlaINV(ByVal numanys As Integer)
 Visibilitat "INV", "11:129", True
 'Visibilitat "C", "6:80", True
 'Visibilitat "C", "106:130", True

If numanys = 1 Then
    Visibilitat "INV", "31:125", False
    'Visibilitat "C", "22:80", False
    'Visibilitat "C", "112:130", False
End If


If numanys = 2 Then
    Visibilitat "INV", "55:135", False
    'Visibilitat "C", "37:80", False
    'Visibilitat "C", "117:130", False
End If

If numanys = 3 Then
    Visibilitat "INV", "83:129", False
    'Visibilitat "C", "52:80", False
    'Visibilitat "C", "122:130", False
End If

If numanys = 4 Then
    Visibilitat "INV", "107:129", False
    'Visibilitat "C", "67:80", False
    'Visibilitat "C", "127:130", False
End If

'if numAnys = 5 no amago res

'Signes dels -/+ han d'estar a - ja que tot es visible de nou
SetValue "INV", "A11", "-"
SetValue "INV", "A35", "-"
SetValue "INV", "A59", "-"
SetValue "INV", "A83", "-"
SetValue "INV", "A107", "-"

'SetValue "C", "A5", "-"
'SetValue "C", "A117", "-"
End Sub

Private Sub CanviAnysPlaC(ByVal numanys As Integer)
 Visibilitat "C", "6:80", True
 Visibilitat "C", "84:114", True
 Visibilitat "C", "119:157", True
 Visibilitat "C", "161:178", True

If numanys = 1 Then
    Visibilitat "C", "22:80", False
    Visibilitat "C", "115:145", False
End If


If numanys = 2 Then
    Visibilitat "C", "37:80", False
    Visibilitat "C", "123:145", False
End If

If numanys = 3 Then
    Visibilitat "C", "52:80", False
    Visibilitat "C", "142:157", False
End If

If numanys = 4 Then
    Visibilitat "C", "67:80", False
    Visibilitat "C", "150:157", False
End If

'if numAnys = 5 no amago res

'Signes dels -/+ han d'estar a - ja que tot es visible de nou
SetValue "C", "A5", "-"
SetValue "C", "A83", "-"
SetValue "C", "A117", "-"
SetValue "C", "A160", "-"


End Sub

Sub SetValue(ByVal sheet As String, ByVal Range As String, ByVal valor As String)
ThisWorkbook.Worksheets(sheet).Range(Range).Value = valor
End Sub


Function TotZero(ByVal rang As String) As Boolean
    Dim ok As Boolean
    ok = True
    For Each cell In Range(rang)
        If cell.Value <> 0 Then
            ok = False
            Exit For
        End If
    Next
    TotZero = ok
End Function


Sub BorrarContingut(ByVal SheetName As String, ByVal Target As Range)
    Target.Value = ""
End Sub


Sub CanvivisibilitatProductes(ByVal numProds As Integer)

'Files de la pestanya OP
MostrarNFilesDeRang "", numProds, 10, 24
MostrarNFilesDeRang "", numProds, 29, 43
MostrarNFilesDeRang "", numProds, 47, 61
MostrarNFilesDeRang "", numProds, 65, 79

End Sub


Sub MostrarNFilesDeRang(ByVal SheetName As String, ByVal numProds As Integer, ByVal filaInicial As Integer, ByVal filaFinal As Integer)
    Dim rang, rangOcult As String
    
    rang = filaInicial & ":" & filaFinal
    rangOcult = (filaInicial + numProds) & ":" & filaFinal
    
    Visibilitat SheetName, rang, True
    If (filaInicial + numProds - 1) < filaFinal Then
        Visibilitat SheetName, rangOcult, False
    End If
End Sub

Public Sub MostrarOAmagarSupplies(ByVal txt As String)
    If Not InStr(txt, "manual") > 0 Then
      Visibilitat "OP", "28:44", False
    Else
      Visibilitat "OP", "28:44", True
      Dim numProds As Integer
      numProds = CInt(ThisWorkbook.Sheets("OP").Range("c7").Value)
      MostrarNFilesDeRang "", numProds, 29, 43
    End If
End Sub


Public Sub RenombrarMenus(ByVal idioma As String)
Dim col As String
If idioma = ThisWorkbook.Sheets("NT").Range("a2") Then col = "B"
If idioma = ThisWorkbook.Sheets("NT").Range("a3") Then col = "C"
If idioma = ThisWorkbook.Sheets("NT").Range("a4") Then col = "D"

RenombrarMenusDe "Home", col
RenombrarMenusDe "INV", col
RenombrarMenusDe "FIN", col
RenombrarMenusDe "C", col
RenombrarMenusDe "OP", col
RenombrarMenusDe "B", col
RenombrarMenusDe "R", col
RenombrarMenusDe "T", col
RenombrarMenusDe "Stock", col
RenombrarMenusDe "Inv-Fin", col
RenombrarMenusDe "A", col
RenombrarMenusDe "EFE", col

End Sub

Sub RenombrarMenusDe(ByVal sheet As String, ByVal col As String)
    ThisWorkbook.Sheets(sheet).Shapes("Inversions").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "48").Value
    ThisWorkbook.Sheets(sheet).Shapes("Financament").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "49").Value
    ThisWorkbook.Sheets(sheet).Shapes("Despeses").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "50").Value
    ThisWorkbook.Sheets(sheet).Shapes("Operacions").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "51").Value
    ThisWorkbook.Sheets(sheet).Shapes("Balanc").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "52").Value
    ThisWorkbook.Sheets(sheet).Shapes("Resultats").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "53").Value
    ThisWorkbook.Sheets(sheet).Shapes("Tresoreria").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "54").Value
    ThisWorkbook.Sheets(sheet).Shapes("Stock").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "55").Value
    ThisWorkbook.Sheets(sheet).Shapes("InvFin").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "56").Value
    ThisWorkbook.Sheets(sheet).Shapes("Analisis").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "57").Value
    'ThisWorkbook.Sheets(sheet).Shapes("EFE").TextFrame2.TextRange.Characters.Text = ThisWorkbook.Worksheets("MI2").Range(col & "58").Value
End Sub

Public Sub ActualitzarIves()

Dim iva, iva2 As String
Dim valOk As String
For i = 10 To 23
    iva = ThisWorkbook.Worksheets("OP").Range("i" & i).Value
    For j = 2 To 6
        valOk = "M" & j
        If iva = ThisWorkbook.Worksheets("NT").Range("k" & j).Value Then
            ThisWorkbook.Worksheets("OP").Range("i" & i).Value = ThisWorkbook.Worksheets("NT").Range(valOk).Value
        End If
        If iva = ThisWorkbook.Worksheets("NT").Range("l" & j).Value Then
            ThisWorkbook.Worksheets("OP").Range("i" & i).Value = ThisWorkbook.Worksheets("NT").Range(valOk).Value
        End If
        
         
    Next
Next




End Sub
Public Function CalMostrarTabs() As Boolean
    If Sheets("Home").Range("e9").Value <> "" And _
        Sheets("Home").Range("e11").Value <> "" And _
        Sheets("Home").Range("e13").Value <> "" And _
        Sheets("Home").Range("e15").Value <> "" And _
        Sheets("Home").Range("e17").Value <> "" And _
        Sheets("Home").Range("j9").Value <> "" And _
        Sheets("Home").Range("j11").Value <> "" And _
        Sheets("Home").Range("j13").Value <> "" And _
        Sheets("Home").Range("j15").Value <> "" And _
        Sheets("Home").Range("j17").Value <> "" Then
        
        CalMostrarTabs = True
    Else
        CalMostrarTabs = False
    End If
  
End Function

Public Sub MostrarTabsTreball(ByVal b As Boolean)
    
    Worksheets("INV").Visible = b
    Worksheets("FIN").Visible = b
    Worksheets("C").Visible = b
    Worksheets("OP").Visible = b
    Worksheets("B").Visible = b
    Worksheets("R").Visible = b
    Worksheets("T").Visible = b
    Worksheets("Stock").Visible = b
    Worksheets("Inv-Fin").Visible = b
    Worksheets("A").Visible = b
    Worksheets("EFE").Visible = b
End Sub

Sub BtnUpdateCommentsClick()

Dim lo As Excel.ListObject
Dim ws As Excel.Worksheet
Dim lr As Excel.ListRow

Set ws = ThisWorkbook.Worksheets("Comentaris")
Set lo = ws.ListObjects("TblComentaris")


Dim comTxt As String
Dim sheet As String
Dim cell As String
Dim cmt As Comment
Dim idioma As String
idioma = Worksheets("Home").Range("c5").Value
For Each lr In lo.ListRows
    comTxt = Intersect(lr.Range, lo.ListColumns(idioma).Range).Value
    sheet = Intersect(lr.Range, lo.ListColumns("Sheet").Range).Value
    cell = Intersect(lr.Range, lo.ListColumns("Cell").Range).Value
    
    Set cmt = ThisWorkbook.Sheets(sheet).Range(cell).Comment
    If cmt Is Nothing Then
        Set cmt = ThisWorkbook.Sheets(sheet).Range(cell).AddComment
    End If
    cmt.Text comTxt
Next lr

End Sub

Sub BtnDeleteCommentsClick()

Dim lo As Excel.ListObject
Dim ws As Excel.Worksheet
Dim lr As Excel.ListRow

Set ws = ThisWorkbook.Worksheets("Comentaris")
Set lo = ws.ListObjects("TblComentaris")


Dim comTxt As String
Dim sheet As String
Dim cell As String
Dim cmt As Comment
For Each lr In lo.ListRows
    
    sheet = Intersect(lr.Range, lo.ListColumns("Sheet").Range).Value
    cell = Intersect(lr.Range, lo.ListColumns("Cell").Range).Value
    
    Set cmt = ThisWorkbook.Sheets(sheet).Range(cell).Comment
    If Not cmt Is Nothing Then
        cmt.Delete
    End If
Next lr

End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforePrint(Cancel As Boolean)
ActualitzarPeus

End Sub

Private Sub Workbook_Open()
    MsgBox "DEBERAS RELLENAR PAGINA DE INICIO PARA CONTINUAR. SI HAS CAMBIADO EL IDIOMA ANTES DE HABILITAR LAS MACROS VUELVE A SELECCIONAR EL IDIOMA", vbExclamation, "IMPORTANT INFORMATION"
End Sub

' InQuest injected base64 decoded content
' V+"n)b

INQUEST-PP=macro
