Attribute VB_Name = "CClipMeta"
Attribute VB_Base = "0{FCFB3D2A-A0FA-1068-A738-08002B3371B5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
#If VBA7 Then 'VBA7|fffd||20d|~|fffd|iExcel2010|fffd||20d|~|fffd||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|j
Public Function GetClipEnhMeta() As Variant
    End Function
#Else 'VBA7|fffd||211|O|fffd|iExcel2007|fffd||702||142||303|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd|j
    Private Type GUID
    Data1 As Long
    Data2 As Integer
    Data3 As Integer
    Data4(0 To 7) As Byte
    End Type
    Private Type PicDescEMF
    Size As Long
    Type As Long
    hMetaFile As Long
    xExt As Long
    yExt As Long
End Type
Private Const CF_ENHMETAFILE As Long = 14
Private Const PICTYPE_ENHMETAFILE As Long = 4
Private Declare Function IsClipboardFormatAvailable Lib "User32" ( _
ByVal wFormat As Long) As Long
Private Declare Function OpenClipboard Lib "User32" ( _
ByVal hWnd As Long) As Long
Private Declare Function CloseClipboard Lib "User32" () As Long
Private Declare Function GetClipboardData Lib "User32" ( _
ByVal wFormat As Long) As Long
Private Declare Function CopyEnhMetaFile Lib "gdi32" Alias "CopyEnhMetaFileA" ( _
ByVal hmf As Long, ByVal lpFileName As Long) As Long
Private Declare Function DeleteEnhMetaFile Lib "gdi32" ( _
ByVal hmf As Long) As Long
Private Declare Function OleCreatePictureIndirect Lib "olepro32.dll" ( _
ByRef picdesc As PicDescEMF, ByRef iid As GUID, _
ByVal bPictureOwnsHandle As Integer, _
ByRef IPic As IPictureDisp) As Long
Private hmf As Long
Private iError As Long

Private Function GetClipboardEnhMetaFile() As Long
    Dim hmf As Long, hmf2 As Long, iRet As Long
On Error GoTo ErrorHandler
    GetClipboardEnhMetaFile = 0
    If IsClipboardFormatAvailable(CF_ENHMETAFILE) = 0 Then Exit Function
    If OpenClipboard(0) = 0 Then Exit Function
    hmf = GetClipboardData(CF_ENHMETAFILE)
    If hmf = 0 Then
        iRet = CloseClipboard()
        Exit Function
    End If
    hmf2 = CopyEnhMetaFile(hmf, 0&)
    If hmf2 = 0 Then
        iRet = CloseClipboard()
        Exit Function
    End If
    iRet = CloseClipboard()
    GetClipboardEnhMetaFile = hmf2
    Exit Function
ErrorHandler:
    iRet = CloseClipboard()
End Function

Private Function CreateOlePictureEMF(hmf As Long) As IPictureDisp
    Dim pic As IPictureDisp
    Dim picdesc As PicDescEMF
    Dim iid As GUID
    Dim iRet As Long
On Error GoTo ErrorHandler
    With iid
        .Data1 = &H20400
        .Data4(0) = &HC0
        .Data4(7) = &H46
    End With
    With picdesc
        .Size = Len(picdesc)
        .Type = PICTYPE_ENHMETAFILE
        .hMetaFile = hmf
    End With
    iRet = OleCreatePictureIndirect(picdesc, iid, 1, pic)
    If iRet <> 0 Then Exit Function
    Set CreateOlePictureEMF = pic
    Exit Function
ErrorHandler:
End Function

Public Function GetClipEnhMeta() As IPictureDisp
    Dim pic As IPictureDisp
On Error GoTo ErrorHandler
    iError = -1
    hmf = 0
    hmf = GetClipboardEnhMetaFile()
    If hmf = 0 Then
        iError = 1
    Else
        Set pic = CreateOlePictureEMF(hmf)
        If pic Is Nothing Then
            DeleteEnhMetaFile hmf
            hmf = 0
            iError = 2
        Else
            Set GetClipEnhMeta = pic
            Set pic = Nothing
            iError = 0
        End If
    End If
    Exit Function
ErrorHandler:
    If hmf <> 0 Then
        DeleteEnhMetaFile hmf
        hmf = 0
    End If
    Set pic = Nothing
End Function

Public Property Get ErrorCode() As Long
    ErrorCode = iError
End Property
#End If
Attribute VB_Name = "Inkan1"
Option Explicit
Option Private Module
Public NM As String, FO1 As String, FO2 As String, FO3 As String, FO4 As String
Public SY1 As String, SY2 As String, WA As Byte, WA2 As String, TB As Byte, SK1 As Byte, SK2 As Byte, SK3 As Byte, SK4 As Byte
Public IR1 As Byte, IR2 As Byte, IR3 As Byte, KOB As Byte, SIZ1 As Byte, SIZ2 As Byte, HOZ As Byte, SPA As String
Public KT1 As Byte, KT2 As Byte, KT3 As Byte, KT4 As Byte, GZ2 As Byte, GZ3 As Byte, GZ4 As Byte, NCH As Byte, FPA As String, HIP As String
Public UXW As Single, UYH As Single, UMT As Byte, HYJ As Byte, BSW As String, BSH As String, DSH As Single
Public FTN As Byte
Public KAK As String, KAA As Byte, KAB As Byte, KAC As String
#If VBA7 Then
    Private Declare PtrSafe Function HtmlHelp Lib "HHCtrl.ocx" Alias "HtmlHelpA" _
        (ByVal hwndCaller As Long, ByVal pszFile As String, ByVal uCommand As Long, dwData As Any) As Long
#Else
    Private Declare Function HtmlHelp Lib "HHCtrl.ocx" Alias "HtmlHelpA" _
        (ByVal hwndCaller As Long, ByVal pszFile As String, ByVal uCommand As Long, dwData As Any) As Long
#End If

Sub mitome_in(Optional ByRef A As Boolean, Optional ByRef S As Shape)
    Dim R As Range, K As Shape, AW As Worksheet, AB As Object
    Dim W As Worksheet, F As Boolean, IR As Double, HO As Byte
    Dim IRR As Variant, SI1 As Single, SI2 As Single, ZZ As Variant
    If HOZ = 0 Then Call Inkan1.Yomi
    If A = False Then Call Inkan1.settei
On Error GoTo ERR1
    Set W = ThisWorkbook.Worksheets(1)
    If W.Range("A1").Value = "" Then Call Inkan1.settei(True)
    If Len(W.Range("A1").Value) = 1 Then F = True
    IRR = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, _
        128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, _
        13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, _
        6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    IR = IRR(IR1) ' + 7
    W.Range("A1:B1").Font.Color = IRR(IR1)
    Set AW = W
    Set R = W.Range("D1")
    Set AB = Selection
    If A = False Then
        Application.ScreenUpdating = False
    End If
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If A = False And ActiveWindow.Zoom <> 100 And BuildIDE = False Then
        ZZ = ActiveWindow.Zoom
        ActiveWindow.Zoom = 100
    End If
    SI1 = Application.CentimetersToPoints((SIZ1 * 1.5 + 4.5) / 10)
    '|fffd||fffd||fffd||fffd||fffd|^|fffd||30f||a347||fffd||fffd||fffd||fffd|
    If KOB = 1 Then HO = SI1 * 0.17
    Set S = AW.Shapes.AddShape(msoShapeOval, R.Left + 1, R.Top, SI1 - HO, SI1)
    With S
        If A = False And Application.version <= 11 Then .visible = False
        If SK1 = 0 Then
            .Fill.visible = msoTrue
            .Fill.Solid
            .Fill.ForeColor.SchemeColor = 65
            .Fill.Transparency = 0
        Else
            .Fill.visible = msoFalse
        End If
        .Line.Weight = IIf(SIZ1 <= 1, 1, 1.5)
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.RGB = IR
    End With
    W.Range("A1:B1").Interior.ColorIndex = xlColorIndexNone
    If W.Range("B1").Value <> "" Then  '|fffd||fffd|i|fffd||30f||a347|
        W.Range("A1:B1").CopyPicture
    Else
        W.Range("A1").CopyPicture
    End If
    W.Paste 'Destination:=W.Range("D1")
    With W.Shapes(2)
        If W.Range("B1").Value <> "" Then '|fffd||fffd|i|fffd||30f||a347|
            .Width = .Width * 0.75
        End If
        If KOB = 1 Then
            .PictureFormat.CropLeft = SI1 * 0.08
            .PictureFormat.CropRight = SI1 * 0.08
        End If
        If TB <> 0 And W.Range("B1").Value = "" Then '|fffd||fffd||fffd||252||5c2||fffd||fffd|@ '|fffd||fffd|i|fffd||30f||a347||fffd||356||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            .LockAspectRatio = msoFalse  '|fffd|c|fffd||fffd||fffd||fffd||fffd||fffd||152||fffd||242||fffd||fffd||202||fffd|
            Dim DW1 As Single, DW2 As Single
            DW1 = .Width
            .ScaleWidth 1.4, msoFalse, msoScaleFromTopLeft
            DW2 = (.Width - DW1) / 2
            .PictureFormat.CropLeft = DW2 - 1
            .PictureFormat.CropRight = DW2 - 1
            .Width = S.Width - 2 + 0.25
        End If
        If F = False Then
            .Height = SI1  '|fffd||fffd||fffd||fffd||fffd||fffd|W,H|fffd||fffd||fffd||243|T|fffd|C|fffd|Y|fffd||fffd||fffd||fffd|
        Else
            .Top = .Top + (SI1 - .Height) / 2
        End If
        .Left = S.Left + (S.Width - .Width) / 2 - IIf(Application.version >= 12, -0.25, 0.25)
    End With
    Set K = W.Shapes(2)
    Set S = AW.Shapes.Range(Array(K.Name, S.Name)).Group
    S.Left = S.Left - (S.Width - R.Width) / 2
    S.Top = S.Top - (S.Height - R.Height) / 2
    If Application.version >= 10 Then S.Rotation = KT1 * 5
    S.visible = True
    S.CopyPicture
    If A = False Then
        ActiveSheet.Paste
        With Selection
            .ShapeRange.PictureFormat.CropTop = IIf(Application.version >= 12, -0.25, -1)
            .ShapeRange.PictureFormat.CropLeft = IIf(Application.version >= 12, -0.25, -1)
            .Left = .Left - (.Width - AB.Width) / 2
            .Top = .Top - (.Height - AB.Height) / 2
        End With
        W.DrawingObjects.Delete
        W.Range("A1").Copy Destination:=W.Range("A1")
        Application.CutCopyMode = False
        If TypeName(AB) = "Range" Then
            AB.Activate
        Else
            Selection.Left = AB.Left - (Selection.Width - AB.Width) / 2
            Selection.Top = AB.Top - (Selection.Height - AB.Height) / 2
        End If
    End If
On Error GoTo 0
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If A = False And ZZ <> 0 And BuildIDE = False Then
        ActiveWindow.Zoom = ZZ
    End If
ERR1:
    If A = False Then
        Application.ScreenUpdating = True
    End If
End Sub
Sub date_in(Optional ByRef A As Boolean, Optional ByRef S As Shape)
    Dim S1 As Shape, S2 As Shape, S3 As Shape, R As Object
    Dim T1 As Shape, T2 As Shape, T3 As Shape, IR As Double, IO As Double
    Dim W As Worksheet, IRR As Variant, ZZ As Variant, K As Shape
    If HOZ = 0 Then Call Inkan1.Yomi: Call Inkan1.settei
On Error GoTo ERR1
    Set R = Selection
    ' Application.ScreenUpdating = False
    If A = False And GZ2 = 0 Then Set W = ActiveSheet Else Set W = ThisWorkbook.Worksheets(1)
    IRR = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, _
        128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, _
        13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, _
        6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    IR = IRR(IR2) '+ 7
    IO = IRR(IR2)
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If BuildIDE = False And A = False Then
        Application.ScreenUpdating = False
        If ActiveWindow.Zoom <> 100 Then
            ZZ = ActiveWindow.Zoom
            ActiveWindow.Zoom = 100
        End If
    End If
    Set S1 = W.Shapes _
        .AddShape(msoShapeOval, R.Left + 1, R.Top - 1, 51.75, 51.75)
    With S1
        .visible = False
        If SK2 = 0 Then
            .Fill.visible = msoTrue
            .Fill.Solid
            .Fill.ForeColor.SchemeColor = 65
            .Fill.Transparency = 0
        Else
            .Fill.visible = msoFalse
        End If
        .Line.Weight = 1.5
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.RGB = IR
        If Application.version >= 12 Then .visible = True
    End With
    Set S2 = W.Shapes _
        .AddLine(S1.Left + 2, S1.Top + S1.Height / 3, S1.Left + 49.75, S1.Top + S1.Height / 3)
    With S2
        .visible = False
        .Line.Weight = 0.75
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.RGB = IR
        If Application.version >= 12 Then .visible = True
    End With
    Set S3 = W.Shapes _
        .AddLine(S1.Left + 2, S1.Top + S1.Height * 2 / 3, S1.Left + 49.75, S1.Top + S1.Height * 2 / 3)
    With S3
        .visible = False
        .Line.Weight = 0.75
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.RGB = IR
        If Application.version >= 12 Then .visible = True
    End With
    Set T1 = W.Shapes.AddTextbox( _
        msoTextOrientationHorizontal, S1.Left + 1, S1.Top + S1.Height / 3 - 13.5, 50, 12)
    T1.visible = False
    With T1.TextFrame.Characters
        If Application.version <= 11 Then
            .Font.Name = FO2
            .Font.FontStyle = "|fffd|W|fffd||fffd|"
        Else
            'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
            T1.TextFrame2.TextRange.Font.NameFarEast = FO2
        End If
        If Len(SY1) <= 4 Then
            .Font.Size = 9
        ElseIf Len(SY1) = 5 Then
            .Font.Size = 7
        ElseIf Len(SY1) = 6 Then
            .Font.Size = 6
        End If
        .Text = SY1
        .Font.Color = IO
    End With
    With T1.TextFrame
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
    End With
    T1.Fill.visible = msoFalse
    T1.Line.visible = msoFalse
    If Application.version >= 12 Then T1.visible = True
    Set T2 = W.Shapes.AddTextbox( _
        msoTextOrientationHorizontal, S1.Left, S1.Top + S1.Height / 2 - 6.5, 52, 12)
    T2.visible = False
    With T2.TextFrame.Characters
        If Application.version <= 11 Then
            .Font.Name = FO2
            .Font.FontStyle = "|fffd|W|fffd||fffd|"
        Else
            'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
            T2.TextFrame2.TextRange.Font.NameFarEast = FO2
        End If
        If Len(WA2) <= 8 Then
            .Font.Size = 9
        Else
            .Font.Size = 8.25
        End If
        .Text = WA2
        .Font.Color = IO
    End With
    With T2.TextFrame
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
    End With
    T2.Fill.visible = msoFalse
    T2.Line.visible = msoFalse
    If Application.version >= 12 Then T2.visible = True
    Set T3 = W.Shapes.AddTextbox( _
        msoTextOrientationHorizontal, S1.Left + 1, S1.Top + S1.Height - 16.5, 50, 12)
    T3.visible = False
    With T3.TextFrame.Characters
        If Application.version <= 11 Then
            .Font.Name = FO2
            .Font.FontStyle = "|fffd|W|fffd||fffd|"
        Else
            'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
            T3.TextFrame2.TextRange.Font.NameFarEast = FO2
        End If
        If Len(SY2) <= 4 Then
            .Font.Size = 9
        ElseIf Len(SY2) = 5 Then
            .Font.Size = 7
        ElseIf Len(SY2) = 6 Then
            .Font.Size = 6
        End If
        .Text = SY2
        .Font.Color = IO
    End With
    With T3.TextFrame
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
    End With
    T3.Fill.visible = msoFalse
    T3.Line.visible = msoFalse
    If Application.version >= 12 Then T3.visible = True
    Set S = W.Shapes.Range(Array( _
        S1.Name, S2.Name, S3.Name, T1.Name, T2.Name, T3.Name)).Group
    S.visible = True
    If A = True Then
        S.CopyPicture
        If GZ2 <> 0 Then
            W.Paste
            Set S = W.Shapes(W.Shapes.Count)
            If Application.version >= 10 Then S.Rotation = KT2 * 5
            S.CopyPicture
        End If
        Exit Sub
    ElseIf GZ2 <> 0 Then
        S.CopyPicture
        S.Delete
        Application.ScreenUpdating = False
        ActiveSheet.Paste
        If Application.version <= 11 Then
            Set S = ActiveSheet.Shapes(ActiveSheet.Shapes.Count)
        Else
            For Each K In ActiveSheet.Shapes
                If K.Name = Selection.Name And K.Type = msoPicture Then
                    Set S = K
                    Exit For
                End If
            Next K
        End If
        If Application.version >= 10 Then S.Rotation = KT2 * 5
        W.Range("A1").Copy Destination:=W.Range("A1")
        Application.CutCopyMode = False
        S.Height = Application.CentimetersToPoints(DSH)
    End If
    S.Left = S.Left - (S.Width - R.Width) / 2
    S.Top = S.Top - (S.Height - R.Height) / 2
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If A = False And ZZ <> 0 And BuildIDE = False Then
        ActiveWindow.Zoom = ZZ
    End If
ERR1:
    If GZ2 <> 0 Then R.Activate
    Application.ScreenUpdating = True
End Sub
Sub user_in(Optional ByRef A As Boolean, Optional ByRef S As Shape)
    Dim ZZ As Variant, W As Worksheet, P As Picture
    Dim X1 As Single, Y1 As Single, X As Single, Y As Single
    If HOZ = 0 Then Call Inkan1.Yomi: Call Inkan1.settei
    If Dir(FPA) = "" Or FPA = "" Then Exit Sub
    If A = False Then Set W = ActiveSheet Else Set W = ThisWorkbook.Worksheets(1)
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If BuildIDE = False And A = False Then
        Application.ScreenUpdating = False
        If ActiveWindow.Zoom <> 100 Then
            ZZ = ActiveWindow.Zoom
            ActiveWindow.Zoom = 100
        End If
    End If
    If A = True Then
        Set P = W.Pictures.Insert(FPA)
        P.CopyPicture
        Set S = W.Shapes(P.Name)
        Exit Sub
    Else
        Set P = ThisWorkbook.Worksheets(1).Pictures.Insert(FPA)
        If UMT = 1 Or UMT > 200 Then
            X = Application.CentimetersToPoints(UXW)
            Y = Application.CentimetersToPoints(UYH)
        ElseIf UMT = 0 Then
            X = P.Width
            Y = P.Height
        ElseIf UMT = 2 Then
            X = P.Width * Val(HIP) / 100
            Y = P.Height * Val(HIP) / 100
        End If
        X1 = WorksheetFunction.Max(ActiveCell.Left + ActiveCell.Width * 1 / 2 - X * 1 / 2, 0)
        Y1 = WorksheetFunction.Max(ActiveCell.Top + ActiveCell.Height * 1 / 2 - Y * 1 / 2, 0)
                ThisWorkbook.Worksheets(1).DrawingObjects.Delete
        Set S = W.Shapes.AddPicture(FPA, msoFalse, msoTrue, X1, Y1, X, Y)
        
        If UMT = 2 Then
        S.ScaleHeight Val(HIP) / 100, msoTrue
        S.ScaleWidth Val(HIP) / 100, msoTrue
        X = S.Width
        Y = S.Height
        X1 = WorksheetFunction.Max(ActiveCell.Left + ActiveCell.Width * 1 / 2 - X * 1 / 2, 0)
        Y1 = WorksheetFunction.Max(ActiveCell.Top + ActiveCell.Height * 1 / 2 - Y * 1 / 2, 0)
        End If
        
        S.Top = Y1
        S.Left = X1
        
    End If
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If A = False And ZZ <> 0 And BuildIDE = False Then
        ActiveWindow.Zoom = ZZ
    End If
End Sub

Sub kaku_in(Optional ByRef A As Boolean, Optional ByRef S As Shape)
    Dim ZZ As Variant, W As Worksheet, WW As Worksheet
    Dim X1 As Single, Y1 As Single, F As Variant ', X As Single, Y As Single
    Dim C As Shape, I As Byte, AB As Range, IRR As Variant, IR As Double ', I1 As Byte, KAC As Single, KAA As Byte, KAK As String
    If HOZ = 0 Then Call Inkan1.Yomi: Call Inkan1.settei
    Set AB = Selection
    Set WW = ThisWorkbook.Worksheets(1)
    If A = False Then
        Set W = ActiveSheet
    Else
        Set W = WW
    End If
    IRR = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, _
        128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, _
        13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, _
        6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    F = Array(22, 20, 14)
    IR = IRR(KAB) ' + 7
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If BuildIDE = False And A = False Then
        Application.ScreenUpdating = False
        If ActiveWindow.Zoom <> 100 Then
            ZZ = ActiveWindow.Zoom
            ActiveWindow.Zoom = 100
        End If
    End If
    I = KAA + 2
    Set C = WW.Shapes.AddShape(msoShapeRoundedRectangle, 100, 100, 70 * I / 3, 70 * I / 3)
    C.Adjustments.Item(1) = 0.08
    If SK4 = 0 Then
        C.Fill.visible = msoTrue
        C.Fill.ForeColor.RGB = RGB(256, 256, 256)
    Else
        C.Fill.visible = msoFalse
    End If
    C.Line.visible = msoTrue
    C.Line.ForeColor.RGB = IR
    C.Line.Transparency = 0
    C.Line.Weight = 1.5
    Set S = WW.Shapes.AddTextbox(msoTextOrientationHorizontalRotatedFarEast, 100, 100, 70 * I / 3, 70 * I / 3)
    With S.TextFrame
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
        .AutoSize = 1
        .Orientation = msoTextOrientationHorizontalRotatedFarEast
    End With
    If Application.version >= 12 Then
        S.TextFrame2.TextRange.ParagraphFormat.SpaceWithin = IIf(KAA = 2, 0.9, 0.7)
    End If
    S.Line.visible = msoFalse
    S.Fill.visible = msoFalse
    With S.TextFrame.Characters
        If Application.version <= 11 Then
            .Font.Name = FO4
            .Font.FontStyle = "|fffd|W|fffd||fffd|"
        Else
            'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
            S.TextFrame2.TextRange.Font.NameFarEast = FO4
        End If
        .Font.Size = F(KAA) * KAC / 2.5
        .Font.Color = IR
    End With
    KAK = Replace(KAK, vbCrLf, "")
    S.TextFrame.Characters.Text = Left(KAK, I) + vbCrLf + Mid(KAK, I + 1, I) + vbCrLf + Mid(KAK, I * 2 + 1, I)
    If Application.version >= 12 And GZ4 = 0 Then
        S.LockAspectRatio = msoFalse
        S.Width = 70 * I / 3
        S.Height = 70 * I / 3
        S.Top = C.Top + (C.Height - S.Height) / 2 - 1
        S.Left = C.Left + (C.Width - S.Width) / 2 - 1
        Set S = WW.Shapes.Range(Array(C.Name, S.Name)).Group
        If A = False Then
            S.Cut
            WW.Paste
            Set S = WW.Shapes(WW.Shapes.Count)
        End If
    Else
        S.Copy
        WW.Pictures.Paste
        S.Delete
        Set S = WW.Shapes(WW.Shapes.Count)
        S.LockAspectRatio = msoFalse
        S.Width = 70 * I / 3
        S.Height = 70 * I / 3
        S.Top = C.Top + (C.Height - S.Height) / 2 - 1
        S.Left = C.Left + (C.Width - S.Width) / 2 - 1
        Set S = WW.Shapes.Range(Array(C.Name, S.Name)).Group
    End If
    S.Width = Application.CentimetersToPoints(KAC)
    S.Height = Application.CentimetersToPoints(KAC)
    If A = True Then
        Exit Sub
    Else
        Application.ScreenUpdating = False
        S.Cut
        W.Paste
        AB.Select
        Set S = W.Shapes(W.Shapes.Count)
        X1 = WorksheetFunction.Max(ActiveCell.Left + ActiveCell.Width * 1 / 2 - S.Width * 1 / 2, 0)
        Y1 = WorksheetFunction.Max(ActiveCell.Top + ActiveCell.Height * 1 / 2 - S.Height * 1 / 2, 0)
        S.Top = Y1
        S.Left = X1
        Application.ScreenUpdating = True
    End If
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If A = False And ZZ <> 0 And BuildIDE = False Then
        ActiveWindow.Zoom = ZZ
    End If
End Sub

Sub tool_del()
    Dim C As CommandBar, D As CommandBarControl
    For Each C In Application.CommandBars
        If C.Name = "Cell" Then
            For Each D In C.Controls
                If D.Caption = "Excel|fffd|d|fffd|q|fffd||fffd||fffd|(&E)" Then D.Delete
            Next D
        End If
    Next C
End Sub
Sub tool_on()
    Dim C As CommandBar, D As CommandBarControl, W As Worksheet
    Dim T As Integer, SA As Shape, SB As Shape, SC As Shape, SD As Shape
    Call Inkan1.tool_del
    Call Inkan1.icon_s(SA, SB, SC, SD, 0)
    For Each C In Application.CommandBars
        If C.Name = "Cell" Then
            T = 11
            For Each D In C.Controls
                If D.Caption Like "*|fffd||fffd||fffd||fffd||fffd||752||fffd|*" Then T = D.Index
            Next D
            Set D = C.Controls.Add(Type:=msoControlPopup, Before:=T)
                D.Caption = "Excel|fffd|d|fffd|q|fffd||fffd||fffd|(&E)"
                Call tool_n(D, SA, SB, SC, SD)
        End If
    Next C
On Error Resume Next
    ThisWorkbook.Worksheets(1).DrawingObjects.Delete
On Error GoTo 0
End Sub
Sub tool_del2()
    Dim C As CommandBar, D As CommandBarControl
    For Each C In Application.CommandBars
        If C.Name = "Excel|fffd|d|fffd|q|fffd||fffd||fffd|" Then
            C.Delete
        End If
    Next C
End Sub
Sub tool_on2()
        Dim SA As Shape, SB As Shape, SC As Shape, SD As Shape, D As CommandBar
        Call Inkan1.tool_del2
        Call Inkan1.icon_s(SA, SB, SC, SD, 0)
        Set D = Application.CommandBars.Add
        D.Name = "Excel|fffd|d|fffd|q|fffd||fffd||fffd|"
        Call tool_n(D, SA, SB, SC, SD)
        D.visible = True
On Error Resume Next
    ThisWorkbook.Worksheets(1).DrawingObjects.Delete
On Error GoTo 0
End Sub
Sub tool_n(C As Object, SA As Shape, SB As Shape, SC As Shape, SD As Shape)
On Error Resume Next
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.mitome_in"
        .Caption = "|fffd|F|fffd||c97c8||fffd|(&M)"
         SA.Copy
        .PasteFace
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.date_in"
        .Caption = "|fffd|f|fffd|[|fffd|^|fffd|l|fffd|[|fffd||fffd||fffd||c97c8||fffd|(&D)"
        SB.Copy
        .PasteFace
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.kaku_in"
        .Caption = "|fffd|p|fffd||c97c8||fffd|(&K)"
        SD.Copy
        .PasteFace
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.kairan"
        .Caption = "|fffd|r|fffd|W|fffd|l|fffd|X|fffd||c97c8||fffd|(&B)"
        SC.Copy
        .PasteFace
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.user_in"
        .Caption = "|fffd||fffd||fffd|[|fffd|U|fffd|[|fffd||c97c8||fffd|(&U)"
        .FaceId = 59
    End With
    ThisWorkbook.Worksheets(1).Range("A1").Copy Destination:=ThisWorkbook.Worksheets(1).Range("A1")
    With C.Controls.Add(Type:=msoControlButton)
        .OnAction = "Inkan1.sheet_settei"
        .Caption = "|fffd||fffd||4d0||752||fffd|(&S)"
        .FaceId = 329
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .Caption = "|fffd|w|fffd||fffd||fffd|v(&Q)"
        .OnAction = "inkan1.help"
        .FaceId = 983
        .BeginGroup = True
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .Caption = "|fffd||fffd||483|z|fffd|[|fffd||fffd||fffd|y|fffd|[|fffd|W(&H)"
        .OnAction = "inkan1.nombo"
        .FaceId = 1016
    End With
    With C.Controls.Add(Type:=msoControlButton)
        .Caption = "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|(&V)"
        .OnAction = "inkan1.ver"
        .FaceId = 65
    End With
End Sub

Sub visgh()
    Call Inkan2.visgh
End Sub
Sub icon_f()
    Dim SA As Shape, SB As Shape, SC As Shape, SD As Shape
    Call icon_s(SA, SB, SC, SD, 1)
End Sub
Sub icon_s(SA As Shape, SB As Shape, SC As Shape, SD As Shape, I As Integer)
    Dim W As Worksheet
    Dim S1 As Shape, S2 As Shape, S3 As Shape, S4 As Shape, S5 As Shape
On Error GoTo ERR1
    Set W = ThisWorkbook.Worksheets(I + 1)
    '|fffd|F|fffd||fffd|A|fffd|C|fffd|R|fffd||fffd||fffd||c42c|
    Set SA = W.Shapes.AddShape(msoShapeOval, 1, 1, 28.5, 28.5)
    SA.Line.ForeColor.SchemeColor = 10
    SA.Line.Weight = 1
    With SA.TextFrame
        .Characters.Text = "|fffd||fffd|"
        .Characters.Font.ColorIndex = 3
        .Characters.Font.Size = 18
        If Application.version <= 11 Then .AutoMargins = False
        .MarginLeft = 2
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    SA.Fill.visible = msoFalse
    SA.Name = "MITOME"
    '|fffd|f|fffd|[|fffd|^|fffd|[|fffd|l|fffd|[|fffd||fffd||fffd||fffd|A|fffd|C|fffd|R|fffd||fffd||fffd||c42c|
    Set S1 = W.Shapes.AddShape(msoShapeOval, 1, 1, 28.5, 28.5)
    S1.Line.ForeColor.SchemeColor = 10
    S1.Line.Weight = 1
    S1.Fill.visible = msoFalse
    Set S2 = W.Shapes.AddLine(S1.Left + 2, S1.Top + S1.Height / 3, S1.Left + 28.5, S1.Top + S1.Height / 3)
    With S2
        .Line.Weight = 0.25
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.SchemeColor = 10
    End With
    Set S3 = W.Shapes.AddLine(S1.Left + 2, S1.Top + S1.Height * 2 / 3, S1.Left + 28.5, S1.Top + S1.Height * 2 / 3)
    With S3
        .Line.Weight = 0.25
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.SchemeColor = 10
    End With
    Set S4 = W.Shapes.AddLine(S1.Left + 12, S1.Top + S1.Height / 3 - 5, S1.Left + 18.5, S1.Top + S1.Height / 3 - 5)
    With S4
        .Line.Weight = 0.25
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.SchemeColor = 10
    End With
    Set S5 = W.Shapes.AddLine(S1.Left + 12, S1.Top + S1.Height * 2 / 3 + 5, S1.Left + 18.5, S1.Top + S1.Height * 2 / 3 + 5)
    With S5
        .Line.Weight = 0.25
        .Line.DashStyle = msoLineSolid
        .Line.Style = msoLineSingle
        .Line.Transparency = 0
        .Line.visible = msoTrue
        .Line.ForeColor.SchemeColor = 10
    End With
    Set SB = W.Shapes.Range(Array(S1.Name, S2.Name, S3.Name, S4.Name, S5.Name)).Group
    '    With SB.TextFrame
    '        .HorizontalAlignment = xlCenter
    '        .VerticalAlignment = xlCenter
    '    End With
    SB.Name = "DATEIN"
    '|fffd|r|fffd|W|fffd|l|fffd|X|fffd||fffd|A|fffd|C|fffd|R|fffd||fffd||fffd||c42c|
    Set SC = W.Shapes.AddShape(msoShapeRoundedRectangle, 1, 1, 60, 27)
    SC.Line.ForeColor.SchemeColor = 10
    SC.Line.Weight = 1
    SC.Fill.visible = msoFalse
    With SC.TextFrame
        .Characters.Text = "|fffd||fffd|"
        .Characters.Font.ColorIndex = 3
        .Characters.Font.Size = 20
        If Application.version <= 11 Then .AutoMargins = False
        .MarginLeft = 0
        .MarginRight = 0
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    SC.Name = "KAIRANIN"
    
    '|fffd|p|fffd||fffd|A|fffd|C|fffd|R|fffd||fffd||fffd||c42c|
    Set SD = W.Shapes.AddShape(msoShapeFlowchartAlternateProcess, 1, 1, 50, 50)
    SD.Line.ForeColor.SchemeColor = 10
    SD.Line.Weight = 1
    SD.Fill.visible = msoFalse
    With SD.TextFrame
        .Characters.Text = "|fffd|p"
        .Characters.Font.ColorIndex = 3
        .Characters.Font.Size = 36
        If Application.version <= 11 Then .AutoMargins = False
        .MarginLeft = 0
        .MarginRight = 0
        .MarginLeft = 0
        .MarginRight = 0
        .MarginTop = 0
        .MarginBottom = 0
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
    End With
    SD.Name = "KAKUIN"
    
    Exit Sub
ERR1:
    Set W = ThisWorkbook.Worksheets(2)
    Set SA = W.Shapes("MITOME")
    Set SB = W.Shapes("DATEIN")
    Set SC = W.Shapes("KAIRANIN")
    Set SD = W.Shapes("KAKUIN")
End Sub
Sub sheet_settei()
    If HOZ = 0 Then Call Inkan1.Yomi
    UserForm1.Show
    If UserForm1.CommandButton2.Cancel = True Then Unload UserForm1: Exit Sub Else Unload UserForm1
End Sub
Sub Yomi()
On Error Resume Next
    Dim FileNo As Integer, ST0 As String, ST1 As String, ST2 As String, ST3 As String, TB1 As String
    Dim ST4 As String, ST5 As String, ST6 As String, SKO As String, KFTN As String
    Dim KSIZ1 As String, KSIZ2 As String, KKT1 As String, KKT2 As String, KKT3 As String, KKT4 As String, A As Variant
    Dim KGZ2 As String, KGZ3 As String, KGZ4 As String, KUXW As String, KUYH As String, KUMT As String, KNCH As String, KHYJ As String, KDSH As String
    Dim KKAA As String, KKAB As String, KKAC As String, KKAD As String
    TB1 = TB: KSIZ1 = 5
    FileNo = FreeFile
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        SPA = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelData"
    Else 'WindowsXP|fffd||702||fffd|
        SPA = Application.Path
    End If
    If Dir(SPA & "\inkan.ini") = "" Then
    Else
        Open SPA & "\inkan.ini" For Input As FileNo
        Line Input #FileNo, NM
        Line Input #FileNo, FO1
        Line Input #FileNo, SY1
        Line Input #FileNo, FO2
        Line Input #FileNo, SY2
        Line Input #FileNo, ST0
        Line Input #FileNo, ST1
        Line Input #FileNo, ST2
        Line Input #FileNo, FO3
        Line Input #FileNo, ST3
        Line Input #FileNo, TB1
        Line Input #FileNo, ST4
        Line Input #FileNo, ST5
        Line Input #FileNo, WA2
        Line Input #FileNo, SKO
        Line Input #FileNo, ST6
        Line Input #FileNo, KSIZ1
        Line Input #FileNo, KSIZ2
        Line Input #FileNo, KKT1
        Line Input #FileNo, KKT2
        Line Input #FileNo, KKT3
        Line Input #FileNo, KGZ2
        Line Input #FileNo, KGZ3
        Line Input #FileNo, KKT4
        Line Input #FileNo, FPA
        Line Input #FileNo, KUXW
        Line Input #FileNo, KUYH
        Line Input #FileNo, KUMT
        Line Input #FileNo, KNCH
        Line Input #FileNo, KHYJ
        Line Input #FileNo, BSW
        Line Input #FileNo, BSH
        Line Input #FileNo, KDSH
        Line Input #FileNo, KFTN
        Line Input #FileNo, HIP
        Line Input #FileNo, KAK
        Line Input #FileNo, FO4
        Line Input #FileNo, KKAA
        Line Input #FileNo, KKAB
        Line Input #FileNo, KKAC
        Line Input #FileNo, KKAD
        Line Input #FileNo, KGZ4
        Close #FileNo
    End If
    WA = Val(ST0): IR1 = Val(ST1): IR2 = Val(ST2): IR3 = Val(ST3)
    TB = Val(TB1): SK1 = Val(ST4): SK2 = Val(ST5): SK3 = Val(ST6): SK4 = Val(KKAD): NCH = Val(KNCH)
    UXW = Val(KUXW): UYH = Val(KUYH): UMT = Val(KUMT): HYJ = Val(KHYJ): DSH = Val(KDSH)
    SIZ1 = Val(KSIZ1): SIZ2 = Val(KSIZ2): KOB = Val(SKO): FTN = Val(KFTN): HOZ = 1
    KT1 = Val(KKT1): KT2 = Val(KKT2): KT3 = Val(KKT3): KT4 = Val(KKT4): GZ2 = Val(KGZ2): GZ3 = Val(KGZ3)
    KAA = Val(KKAA): KAB = Val(KKAB): KAC = Val(KKAC): GZ4 = Val(KGZ4)
    If KAK = "" Then
    KAK = "|fffd||fffd||fffd||fffd||fffd||fffd||401|Z|fffd|Z|fffd|Z|fffd|Z|fffd||fffd|"
    KAA = 1
    KAB = 0
    KAC = 2.5
    End If
    A = Array(Format(Date, "ee/mm/dd"), Format(Date, "yy/mm/dd"), Format(Date, "ge/mm/dd"), _
        Format(Date, "yyyy/mm/dd"), Format(Date, "yyyy/m/d"), Format(Date, "ee/m/d") _
        , Format(Date, "yy/m/d"), Format(Date, "ge/m/d"), Format(Date, "m|fffd||fffd|d|fffd||fffd|"))
    If WA <> 255 Then WA2 = A(WA)
    If UXW = 0 Then UXW = 4.5
    If UYH = 0 Then UYH = 4.5
    If DSH = 0 Then DSH = 1.9
    Call Inkan1.settei(True)
End Sub
Sub settei(Optional ByRef A As Boolean)
    Dim W As Worksheet
    If NM = "" And A = False Then
        MsgBox "|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||342||fffd||fffd||102||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|B", , "Excel|fffd|d|fffd|q|fffd||fffd||fffd|"
        Call Inkan1.sheet_settei
    End If
    If FO1 = "" Then FO1 = "|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|"
    If FO2 = "" Then FO2 = "|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|"
    If FO3 = "" Then FO3 = "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N"
    If FO4 = "" Then FO4 = "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N"
    Set W = ThisWorkbook.Worksheets(1)
    If InStr(1, NM, vbLf) = 0 Then
        With W.Range("A1")
            .Value = NM
            .Offset(, 1).ClearContents
        End With
    Else
        With W.Range("A1")
            .Value = Split(NM, vbLf)(1)
            .Offset(, 1).Value = Split(NM, vbLf)(0)
        End With
    End If
    With W.Range("A1:B1").Font
        .Name = FO1
    End With
    W.Rows(1).EntireRow.AutoFit
    If W.Range("B1").Value = "" Then
        W.Columns(1).EntireColumn.AutoFit
    Else
        W.Columns("A:B").ColumnWidth = 2.25
    End If
End Sub
Sub kairan()
    If HOZ = 0 Then Call Inkan1.Yomi
    UserForm2.Show
End Sub
Sub kairan_in(T As String, X As Single, Y As Single, P As Integer _
    , Optional ByRef A As Boolean, Optional ByRef B As Boolean, Optional ByRef J As Integer, Optional ByRef S As Shape)
    Dim R As Object, IR As Double, IO As Double, W As Worksheet, K As Shape
    Dim IRR As Variant, TA As Variant, T2 As Integer, AA As Variant, I As Integer, ZZ As Variant, TT As String
    ' Application.ScreenUpdating = False
On Error GoTo ERR1
    Dim SI1 As Single
    If A = True Then
        Select Case SIZ2
        Case 1
            SI1 = 12 / 20
        Case 2
            SI1 = 10 / 20
        Case Else
            SI1 = 11 / 20
        End Select
    Else
        Select Case SIZ2
        Case 1
            SI1 = 3 / 2
        Case 2
            SI1 = 2 / 3
        Case Else
            SI1 = 1
        End Select
    End If
    T = Replace(T, vbCr, "")
    If A = False Then
        If UserForm2.OptionButton8.Value = True Or UserForm2.OptionButton11.Value = True Then
            AA = Split(T, vbLf)
            For I = 0 To UBound(AA)
                T2 = WorksheetFunction.Max(T2, LenB2(AA(I)))
            Next I
            If UserForm2.OptionButton8.Value = True Then
                If T2 >= 5 Then
                    X = 22.5 * T2
                ElseIf T2 >= 3 Then
                    X = 102
                Else
                    X = 55.5
                End If
            Else
                If T2 >= 5 Then
                    X = 30 * T2
                ElseIf T2 >= 3 Then
                    X = 140
                Else
                    X = 70
                End If
            End If
        End If
    End If
    If KT4 = 0 Then
        TA = Array(xlHAlignCenter, xlHAlignLeft, xlHAlignRight)
    Else
        TA = Array(xlVAlignCenter, xlVAlignTop, xlVAlignBottom)
    End If
    Set R = Selection
    IRR = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, _
        128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, _
        13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, _
        6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    IR = IRR(IR3) '+ 7
    IO = IRR(IR3)
    If A = True Or GZ3 <> 0 Then
        Set W = ThisWorkbook.Worksheets(1)
    Else
        Set W = ActiveSheet
    End If
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||fffd||a39e||fffd|I|fffd||fffd|100%|fffd||255||3cd|X
    If A = False And ActiveWindow.Zoom <> 100 And BuildIDE = False Then
        ZZ = ActiveWindow.Zoom
        Application.ScreenUpdating = False
        ActiveWindow.Zoom = 100
    End If
    Set S = W.Shapes.AddShape(P, R.Left, R.Top, X * SI1, Y * SI1)
    With S
        .visible = False
        If SK3 = 0 Then
            .Fill.visible = msoTrue
            .Fill.Solid
        Else
            .Fill.visible = msoFalse
        End If
        If SK3 = 0 Then
            .Fill.visible = msoTrue
            .Fill.Solid
            .Fill.ForeColor.SchemeColor = 65
            .Fill.Transparency = 0
        Else
            .Fill.visible = msoFalse
        End If
        If B = True Or FTN <> 0 Then
            .Line.visible = msoFalse
        Else
            .Line.Weight = IIf(J = 0, 3, (J \ 8) + 1)
            .Line.visible = msoTrue
            .Line.ForeColor.RGB = IR
        End If
        .TextFrame.Orientation = IIf(KT4 = 0, msoTextOrientationHorizontal, msoTextOrientationVertical)
        If Application.version >= 12 And KT4 <> 0 Then
            .TextFrame2.Orientation = msoTextOrientationVerticalFarEast
            .TextFrame2.HorizontalAnchor = msoAnchorCenter
            .TextFrame2.VerticalAnchor = msoAnchorMiddle
        End If
        .TextFrame.Characters.Text = T
        With S.TextFrame.Characters.Font
            If Application.version <= 11 Then
                .Name = FO3
                .FontStyle = "|fffd|W|fffd||fffd|"
            Else
                'Excel2007|fffd||303|o|fffd|O|fffd|@Font|fffd||fffd||fffd|}|fffd|N|fffd||fffd||fffd||155||3cd|X|fffd|o|fffd||fffd||fffd||202||fffd||fffd|iFont |fffd|}|fffd|N|fffd||fffd||fffd|@2007|fffd|j
                S.TextFrame2.TextRange.Font.NameFarEast = FO3
            End If
            If J = 0 Then
                .Size = Int(38 * SI1 * IIf(A, 19 / 20, 1))
            Else
                .Size = Array(6, 8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72)(J - 1)
            End If
            .Color = IO
        End With
        With .TextFrame
            If KT4 = 0 Then
                If A Then
                    .HorizontalAlignment = TA(0)
                    .VerticalAlignment = xlTop
                Else
                    .HorizontalAlignment = TA(UserForm2.ComboBox1.ListIndex)
                    .VerticalAlignment = xlCenter
                End If
            Else
                If A Then
                    .VerticalAlignment = TA(0)
                Else
                    .VerticalAlignment = TA(UserForm2.ComboBox1.ListIndex)
                End If
            End If
            If (P = msoShapeOval And Len(T) >= 2) Or (P = msoShapeRoundedRectangle And Len(T) >= 2) Then .AutoSize = True
            If Application.version <= 11 Then
                .AutoMargins = False
                .MarginLeft = 0
                .MarginRight = 0
                .MarginTop = 0
                .MarginBottom = 0
            Else
                .MarginLeft = Application.CentimetersToPoints(0.1)
                .MarginRight = Application.CentimetersToPoints(0.1)
                .MarginTop = Application.CentimetersToPoints(0.1)
                .MarginBottom = Application.CentimetersToPoints(0.1)
                If Application.version >= 14 Then
                    .VerticalOverflow = 0
                End If
            End If
        End With
        .visible = True
        If A = True Then
            S.CopyPicture 'Picture
            If GZ3 <> 0 Then
                W.Paste
                Set S = W.Shapes(W.Shapes.Count)
                If Application.version >= 10 Then S.Rotation = KT3 * 5
                S.LockAspectRatio = msoFalse
                S.Width = Application.CentimetersToPoints(Val(BSW))
                S.Height = Application.CentimetersToPoints(Val(BSH))
                S.CopyPicture
            End If
            Exit Sub
        ElseIf GZ3 <> 0 Then
            S.CopyPicture
            S.Delete
            Application.ScreenUpdating = False
            ActiveSheet.Paste
            If Application.version <= 11 Then
                Set S = ActiveSheet.Shapes(ActiveSheet.Shapes.Count)
            Else
                Set S = ActiveSheet.Shapes(ActiveSheet.Shapes.Count)
                For Each K In ActiveSheet.Shapes
                    On Error Resume Next
                    TT = Selection.Name
                    On Error GoTo 0
                    If K.Name = TT And K.Type = msoPicture Then
                        Set S = K
                        Exit For
                    End If
                Next K
            End If
            If Application.version >= 10 Then S.Rotation = KT3 * 5
            S.LockAspectRatio = msoFalse
            S.Width = Application.CentimetersToPoints(Val(BSW))
            S.Height = Application.CentimetersToPoints(Val(BSH))
            W.Range("A1").Copy Destination:=W.Range("A1")
            Application.CutCopyMode = False
            If TypeName(R) = "Range" Then
                R.Activate
            Else
                Selection.Left = R.Left - (Selection.Width - R.Width) / 2
                Selection.Top = R.Top - (Selection.Height - R.Height) / 2
            End If
        End If
        S.Left = R.Left + (R.Width - S.Width) / 2
        S.Top = R.Top + (R.Height - S.Height) / 2
    End With
    'Excel2007|fffd||303|o|fffd|O|fffd|@|fffd|Y|fffd|[|fffd||fffd||fffd||fffd||7c2||fffd|
    If A = False And ZZ <> 0 And BuildIDE = False Then
        ActiveWindow.Zoom = ZZ
    End If
ERR1:
    Application.ScreenUpdating = True
End Sub
Private Function LenB2(S As Variant) As Long
    Dim I As Long
    For I = 1 To Len(S)
        If Mid(S, I, 1) = StrConv(Mid(S, I, 1), vbWide) Then
            LenB2 = LenB2 + 2
        Else
            LenB2 = LenB2 + 1
        End If
    Next I
End Function
Sub help()
    Dim P As String
    Const HH_HELP_CONTEXT = &HF
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        P = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelHelp"
    Else 'WindowsXP|fffd||702||fffd|
        P = Application.Path & "\ExcelHelp"
    End If
    Call HtmlHelp(0, P & "\|fffd|d|fffd|q|fffd||fffd||fffd|.chm", 0, ByVal 0&)
End Sub
Sub nombo()
    Dim O As Object
    Set O = CreateObject("Wscript.Shell")
    O.Run "http://www.officelabo.net/"
    Set O = Nothing
End Sub

Sub Piload()
    If Application.version >= 12 Then
        Dim S As ChartObject, C As Shape
        Call mitome_in(True, C)
        If C Is Nothing Then Exit Sub
        Set S = ThisWorkbook.Worksheets(2).ChartObjects(1)
        S.Width = C.Width
        S.Height = C.Height
        C.CopyPicture
        S.Chart.Paste
        S.Chart.Export Environ("temp") & "\inkan.gif"
        If S.Chart.Shapes.Count > 0 Then
            S.Chart.DrawingObjects.Delete
        End If
        UserForm1.Frame1.Picture = LoadPicture(Environ("temp") & "\inkan.gif")
On Error Resume Next
        Kill Environ("temp") & "\inkan.gif"
On Error GoTo 0
    Else
        Dim oClipMeta As New CClipMeta
        Dim oPic As IPictureDisp
        Call mitome_in(True)
        Set oPic = oClipMeta.GetClipEnhMeta()
        If Not oPic Is Nothing Then
            Set UserForm1.Frame1.Picture = oPic
            Set oPic = Nothing
        End If
    End If
    With ThisWorkbook.Worksheets(1)
        .Range("A1").Copy Destination:=.Range("A1")
        Application.CutCopyMode = False
        .DrawingObjects.Delete
    End With
End Sub
Sub Piload2()
    If Application.version >= 12 Then
        Dim S As ChartObject, C As Shape
        Call date_in(True, C)
        If C Is Nothing Then Exit Sub
        Set S = ThisWorkbook.Worksheets(2).ChartObjects(1)
        S.Width = C.Width
        S.Height = C.Height
        C.CopyPicture
        S.Chart.Paste
        S.Chart.Export Environ("temp") & "\inkan.gif"
        S.Chart.DrawingObjects.Delete
        UserForm1.Frame2.Picture = LoadPicture(Environ("temp") & "\inkan.gif")
On Error Resume Next
        Kill Environ("temp") & "\inkan.gif"
On Error GoTo 0
    Else
        Dim oClipMeta As New CClipMeta
        Dim oPic As IPictureDisp
        Call date_in(True)
        Set oPic = oClipMeta.GetClipEnhMeta()
        If Not oPic Is Nothing Then
            Set UserForm1.Frame2.Picture = oPic
            Set oPic = Nothing
        End If
    End If
    With ThisWorkbook.Worksheets(1)
        .Range("A1").Copy Destination:=.Range("A1")
        Application.CutCopyMode = False
        .DrawingObjects.Delete
    End With
End Sub
Sub Piload3()
    If Application.version >= 12 Then
        Dim S As ChartObject, C As Shape
        Call kairan_in("|fffd||fffd|", 95, 52, msoShapeRoundedRectangle, True, , , C)
        If C Is Nothing Then Exit Sub
        Set S = ThisWorkbook.Worksheets(2).ChartObjects(1)
        S.Width = C.Width
        S.Height = C.Height
        C.CopyPicture
        S.Chart.Paste
        S.Chart.Export Environ("temp") & "\inkan.gif"
        S.Chart.DrawingObjects.Delete
        UserForm1.Frame3.Picture = LoadPicture(Environ("temp") & "\inkan.gif")
On Error Resume Next
        Kill Environ("temp") & "\inkan.gif"
On Error GoTo 0
    Else
        Dim oClipMeta As New CClipMeta
        Dim oPic As IPictureDisp
        Call kairan_in("|fffd||fffd|", 95, 52, msoShapeRoundedRectangle, True)
        Set oPic = oClipMeta.GetClipEnhMeta()
        If Not oPic Is Nothing Then
            Set UserForm1.Frame3.Picture = oPic
            Set oPic = Nothing
        End If
    End If
    With ThisWorkbook.Worksheets(1)
        .Range("A1").Copy Destination:=.Range("A1")
        Application.CutCopyMode = False
        .DrawingObjects.Delete
    End With
End Sub
Sub Piload4()
    If Application.version >= 12 Then
        Dim S As ChartObject, C As Shape
        Call user_in(True, C)
        If C Is Nothing Then Exit Sub
        Set S = ThisWorkbook.Worksheets(2).ChartObjects(1)
        S.Width = C.Width
        S.Height = C.Height
        C.CopyPicture
        S.Chart.Paste
        S.Chart.Export Environ("temp") & "\inkan.gif"
        S.Chart.DrawingObjects.Delete
        UserForm1.Frame4.Picture = LoadPicture(Environ("temp") & "\inkan.gif")
On Error Resume Next
        Kill Environ("temp") & "\inkan.gif"
On Error GoTo 0
    Else
        Dim oClipMeta As New CClipMeta
        Dim oPic As IPictureDisp
        Call user_in(True)
        Set oPic = oClipMeta.GetClipEnhMeta()
        If Not oPic Is Nothing Then
            Set UserForm1.Frame4.Picture = oPic
            Set oPic = Nothing
        End If
    End If
    With ThisWorkbook.Worksheets(1)
        .Range("A1").Copy Destination:=.Range("A1")
        Application.CutCopyMode = False
        .DrawingObjects.Delete
    End With
End Sub
Sub Piload5()
    If Application.version >= 12 Then
        Dim S As ChartObject, C As Shape
        Call kaku_in(True, C)
        If C Is Nothing Then Exit Sub
        Set S = ThisWorkbook.Worksheets(2).ChartObjects(1)
        S.Width = C.Width
        S.Height = C.Height
        C.CopyPicture
        S.Chart.Paste
        S.Chart.Export Environ("temp") & "\inkan.gif"
        S.Chart.DrawingObjects.Delete
        UserForm1.Frame5.Picture = LoadPicture(Environ("temp") & "\inkan.gif")
On Error Resume Next
        Kill Environ("temp") & "\inkan.gif"
On Error GoTo 0
    Else
        Dim oClipMeta As New CClipMeta
        Dim oPic As IPictureDisp
        Call kaku_in(True)
        Set oPic = oClipMeta.GetClipEnhMeta()
        If Not oPic Is Nothing Then
            Set UserForm1.Frame5.Picture = oPic
            Set oPic = Nothing
        End If
    End If
    With ThisWorkbook.Worksheets(1)
        .Range("A1").Copy Destination:=.Range("A1")
        Application.CutCopyMode = False
        .DrawingObjects.Delete
    End With
End Sub

Sub syoki()
    Dim W As Shape
    For Each W In ThisWorkbook.Worksheets(1).Shapes
        W.Delete
    Next W
    ThisWorkbook.Worksheets(1).Range("A1:B1").ClearContents
End Sub
Function op_version() As Double
    Dim S As String
    S = Application.OperatingSystem
    If InStr(1, S, "NT") >= 1 Then
        op_version = Val(Right(S, Len(S) - InStr(1, S, "NT") - 1))
        If op_version < 4 Then
          op_version = op_version2
        End If
    End If
End Function
Private Function op_version2()
    Dim L As Object, S As Object, O As Object, W As Variant, M As String
    Set L = CreateObject("WbemScripting.SWbemLocator")
    Set S = L.ConnectServer
    Set O = S.ExecQuery("Select * From Win32_OperatingSystem")
    For Each W In O
        M = W.version
    Next W
    op_version2 = Val(Split(M, ".")(0))
End Function
Function BuildIDE() As Boolean
    Dim W As Object, A As Variant
    If Application.version = 12 Then
On Error GoTo ERR1
        Set W = CreateObject("Wscript.Shell")
        A = Split(W.RegRead("HKLM\SOFTWARE\Microsoft\Office\12.0\Common\ProductVersion\LastProduct"), ".")
        If Val(A(2)) >= 6425 Then
            BuildIDE = True
        End If
    Else
        BuildIDE = True
    End If
ERR1:
    Exit Function
End Function

Private Sub ver()
    MsgBox "Excel|fffd|d|fffd|q|fffd||fffd||fffd|.ver2.42", vbInformation, "|fffd|o|fffd|[|fffd|W|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Dim B As Boolean
Private Sub Workbook_AddinInstall()
    Call Inkan1.tool_on
    If Application.version <= 11 Then
        If HOZ = 0 Then Call Inkan1.Yomi
        If HYJ <> 0 Then
            Call Inkan1.tool_on2
        End If
    End If
     'Excel2013|fffd||315|s|fffd||f347|AddinInstall|fffd||fffd||fffd||fffd|CommandBar|fffd|o|fffd|^|fffd||fffd||fffd||fffd||195||6ce||fffd||fffd||fffd||fffd||fffd||202||fffd|
    If Application.version >= 15 Then
      B = True
    End If
End Sub

Private Sub Workbook_AddinUninstall()
    Call Inkan1.tool_del
    If Application.version <= 11 Then
        Call Inkan1.tool_del2
    End If
End Sub
Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    Static B As Boolean
    If InStr(Application.UserName, "|fffd|X|fffd|{") = 0 _
        Or InStr(Application.UserName, "|fffd|T|fffd|j") = 0 Then
        Cancel = True
    Else
        If B = False Then
            Call Inkan1.syoki
            B = True
            ThisWorkbook.Save
        Else
            MsgBox "|fffd||6d1||fffd||fffd||fffd||fffd||702||fffd|"
        End If
    End If
End Sub

Private Sub Workbook_Open()
'Excel2013|fffd||315|s|fffd||f347|AddinInstall|fffd||fffd||fffd||fffd|CommandBar|fffd|o|fffd|^|fffd||fffd||fffd||fffd||195||6ce||fffd||fffd||fffd||fffd||fffd||202||fffd|
If B = True Then
    Call Inkan1.tool_on
End If
End Sub


Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{779038CD-5ED7-4491-8BB9-5B017B6BE8DE}{754462C7-3160-4DB6-B88F-F6C53A388A2F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False









Option Explicit
Private F As Boolean, G1 As Boolean, G2 As Boolean, G3 As Boolean, G4 As Boolean
Private KFO1 As String, KNM As String, KIR1 As Byte, KTB As Byte
Private KFO2 As String, KSY1 As String, KSY2 As String, KIR2 As String
Private KFO3 As String, KIR3 As String, KKOB As Byte
Private KSIZ1 As Byte, KSIZ2 As Byte, KSK1 As Byte, KSK2 As Byte, KSK3 As Byte, KSK4 As Byte
Private KKT1 As Byte, KKT2 As Byte, KKT3 As Byte, KKT4 As Byte, KGZ2 As Byte, KGZ3 As Byte, KGZ4 As Byte, KDSH As Single
Private KFO4 As String, KKAK As String, KKAA As Byte, KKAB As Byte, KKAC As String
Private Sub CheckBox1_Click()
    Dim KTB As Byte
    If F = False Then Exit Sub
    KTB = TB
    TB = CheckBox1.Value
    Call Inkan1.Piload
End Sub


Private Sub CheckBox2_Click()
    If F = False Then Exit Sub
    SK1 = CheckBox2.Value
    Call Inkan1.Piload
End Sub

Private Sub CheckBox3_Click()
    If F = False Then Exit Sub
    SK2 = CheckBox3.Value
    Call Inkan1.Piload2
End Sub

Private Sub CheckBox4_Click()
    If F = False Then Exit Sub
    SK3 = CheckBox4.Value
    Call Inkan1.Piload3
End Sub

Private Sub CheckBox5_Click()
    ComboBox13.Enabled = CheckBox5.Value
    TextBox10.Enabled = CheckBox5.Value
    If F = False Then Exit Sub
    GZ2 = CheckBox5.Value
    Call Inkan1.Piload2
End Sub

Private Sub CheckBox6_Click()
    ComboBox14.Enabled = CheckBox6.Value
    If F = False Then Exit Sub
    If BSW = "" Then BSW = 3.2: TextBox8.Value = BSW
    If BSH = "" Then BSH = 2.4: TextBox9.Value = BSH
    GZ3 = CheckBox6.Value
    Label24.visible = GZ3
    Label25.visible = GZ3
    TextBox8.visible = GZ3
    TextBox9.visible = GZ3
    ComboBox11.visible = Not GZ3
    Call Inkan1.Piload3
    If CheckBox6.Value = True Then
        Frame3.PictureSizeMode = fmPictureSizeModeZoom
    Else
        Frame3.PictureSizeMode = fmPictureSizeModeClip
    End If
End Sub

Private Sub CheckBox7_Click()
    If F = False Then Exit Sub
    If CheckBox7.Value = True Then
        TextBox1.Top = 6.75
        TextBox1.Height = 28.5
        TextBox1.EnterKeyBehavior = True
    Else
        TextBox1.Top = 12
        TextBox1.Height = 17.25
        TextBox1.EnterKeyBehavior = False
    End If
End Sub

Private Sub CheckBox8_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
    HYJ = CheckBox8.Value
    If Application.version >= 12 Then
        Call Inkan1.visgh
    Else
        If CheckBox8.Value = True Then
            Call Inkan1.tool_on2
        Else
            Call Inkan1.tool_del2
        End If
    End If
End Sub

Private Sub CheckBox9_Click()
    If F = False Then Exit Sub
    FTN = CheckBox9.Value
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox1_Change()
    If F = False Then Exit Sub
    Dim W As Worksheet
    KFO1 = FO1
    Set W = ThisWorkbook.Worksheets(1)
    W.Range("A1:B1").Font.Name = ComboBox1.Value
    If W.Range("B1").Value = "" Then
        W.Columns(1).EntireColumn.AutoFit
    Else
        W.Columns("A:B").ColumnWidth = 2.25
    End If
    '    W.Columns(1).EntireColumn.AutoFit
    FO1 = ComboBox1.Value
    Call Inkan1.Piload
End Sub

Private Sub ComboBox10_Change()
    If F = False Then Exit Sub
    SIZ1 = ComboBox10.ListIndex
    Call Inkan1.Piload
End Sub

Private Sub ComboBox11_Change()
    If F = False Then Exit Sub
    SIZ2 = ComboBox11.ListIndex
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox12_Change()
    If F = False Then Exit Sub
    KT1 = ComboBox12.ListIndex
    Call Inkan1.Piload
End Sub

Private Sub ComboBox13_Change()
    If F = False Then Exit Sub
    KT2 = ComboBox13.ListIndex
    Call Inkan1.Piload2
End Sub

Private Sub ComboBox14_Change()
    If F = False Then Exit Sub
    KT3 = ComboBox14.ListIndex
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox15_Change()
    If F = False Then Exit Sub
    KT4 = ComboBox15.ListIndex
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox16_Change()
    Dim B As Variant
    B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    TextBox5.BackColor = B(ComboBox16.ListIndex)
    IR1 = ComboBox16.ListIndex
    Call Inkan1.Piload
End Sub

Private Sub ComboBox17_Change()
    Dim B As Variant
    B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    TextBox6.BackColor = B(ComboBox17.ListIndex)
    If F = False Then Exit Sub
    IR2 = ComboBox17.ListIndex
    Call Inkan1.Piload2
End Sub

Private Sub ComboBox18_Change()
    Dim B As Variant
    B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    TextBox7.BackColor = B(ComboBox18.ListIndex)
    If F = False Then Exit Sub
    IR3 = ComboBox18.ListIndex
    Call Inkan1.Piload3
End Sub


Private Sub ComboBox2_Change()
    If F = False Then Exit Sub
    FO2 = ComboBox2.Value
    Call Inkan1.Piload2
End Sub
Private Sub ComboBox19_Change() '|fffd|p|fffd||fffd|
    If F = False Then Exit Sub
    KAA = ComboBox19.ListIndex
    Dim S As String
    S = Replace(TextBox12.Value, vbCrLf, "")
    Select Case KAA
    Case 0
    TextBox12.Font.Size = 19
    S = Left(S, 6)
    Case 1
    TextBox12.Font.Size = 16.5
    S = Left(S, 9)
    Case 2
    TextBox12.Font.Size = 11.5
    S = Left(S, 12)
    End Select
    TextBox12.Value = Left(S, (KAA + 2)) + vbCrLf + Mid(S, (KAA + 2) + 1, (KAA + 2)) + vbCrLf + Mid(S, (KAA + 2) * 2 + 1, (KAA + 2))
    TextBox12.MaxLength = ComboBox19.Value + 2
    Call Inkan1.Piload5
End Sub
Private Sub ComboBox20_Change()
    Dim B As Variant
    B = Array(255, 0, 16711680, 65535, 32768, 13209, 8388736, 16777215, 65280, 16711935, 16776960, 128, 8388608, 32896, 8421376, 12632256, 8421504, 16763904, 16777164, 13434828, 10092543, 16764057, 13408767, 16751052, 10079487, 16737843, 13421619, 52377, 52479, 39423, 26367, 10053222, 9868950, 6697728, 6723891, 13056, 13107, 6697881, 10040115, 3355443)
    TextBox13.BackColor = B(ComboBox20.ListIndex)
    KAB = ComboBox20.ListIndex
    Call Inkan1.Piload5
End Sub
Private Sub CheckBox11_Click()
    If F = False Then Exit Sub
    GZ4 = CheckBox11.Value
    Call Inkan1.Piload5
End Sub

Private Sub ComboBox21_Change()
    If F = False Then Exit Sub
    FO4 = ComboBox21.Value
    Call Inkan1.Piload5
End Sub

Private Sub TextBox12_Change()
    Dim S As String
    If F = False Then Exit Sub
    S = Replace(TextBox12.Value, vbCrLf, "")
    KAK = Left(S, (KAA + 2)) + vbCrLf + Mid(S, (KAA + 2) + 1, (KAA + 2)) + vbCrLf + Mid(S, (KAA + 2) * 2 + 1, (KAA + 2))
    Call Inkan1.Piload5
End Sub

Private Sub TextBox14_Change()
    If F = False Then Exit Sub
    KAC = Val(TextBox14.Value)
    Call Inkan1.Piload5
End Sub

Private Sub CheckBox10_Click()
    If F = False Then Exit Sub
    SK4 = CheckBox10.Value
    Call Inkan1.Piload5
End Sub

Private Sub ComboBox3_Change()
    If F = False Then Exit Sub
    SY1 = Left(ComboBox3.Value, 6)
    Call Inkan1.Piload2
End Sub

Private Sub ComboBox4_Change()
    If F = False Then Exit Sub
    SY2 = Left(ComboBox4.Value, 6)
    Call Inkan1.Piload2
End Sub

Private Sub ComboBox5_Change()
    If F = False Then Exit Sub
    IR1 = ComboBox5.ListIndex
    Call Inkan1.Piload
End Sub

Private Sub ComboBox6_Change()
    Dim KIR2 As Byte
    If F = False Then Exit Sub
    IR2 = ComboBox6.ListIndex
    Call Inkan1.Piload2
End Sub

Private Sub ComboBox7_Change()
    If F = False Then Exit Sub
    FO3 = ComboBox7.Value
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox8_Change()
    If F = False Then Exit Sub
    IR3 = ComboBox8.ListIndex
    Call Inkan1.Piload3
End Sub

Private Sub ComboBox9_Change()
    If F = False Then Exit Sub
    WA2 = Left(ComboBox9.Value, 10)
    Call Inkan1.Piload2
End Sub

Private Sub CommandButton1_Click()
    Dim FileNo  As Integer
On Error Resume Next
    NM = Replace(TextBox1.Value, vbCr, "")
    If Len(NM) - Len(Replace(NM, vbLf, "")) >= 2 Then '|fffd||702||fffd||502||fffd||fffd||fffd|2|fffd||88||20f||30a0||fffd||fffd||a347|
        '2|fffd||96||688||20d|~|fffd||fffd|LF|fffd||16cce||fffd|
        NM = Split(NM, vbLf)(0) & vbLf & Replace(NM, vbLf, "", InStr(1, NM, vbLf) + 1)
    End If
    FO1 = ComboBox1.Value
    FO2 = ComboBox2.Value
    FO3 = ComboBox7.Value
    FO4 = ComboBox21.Value
    SY1 = Left(ComboBox3.Value, 6)
    SY2 = Left(ComboBox4.Value, 6)
    NCH = CheckBox7.Value
    '  IR1 = ComboBox5.ListIndex
    '  IR2 = ComboBox6.ListIndex
    '  IR3 = ComboBox8.ListIndex
    If ComboBox9.ListIndex = -1 Then
        WA = 255
    Else
        WA = ComboBox9.ListIndex
    End If
    WA2 = Left(ComboBox9.Value, 10)
    SK1 = CheckBox2.Value
    SK2 = CheckBox3.Value
    SK3 = CheckBox4.Value
    SK4 = CheckBox10.Value
    FTN = CheckBox9.Value
    SIZ1 = ComboBox10.ListIndex
    SIZ2 = ComboBox11.ListIndex
    FPA = TextBox2.Value
    UXW = TextBox3.Value
    UYH = TextBox4.Value
    If OptionButton3.Value = True Then
    UMT = 0
    ElseIf OptionButton4.Value = True Then
    UMT = 1
    ElseIf OptionButton5.Value = True Then
    UMT = 2
    End If
    BSW = TextBox8.Value
    BSH = TextBox9.Value
    DSH = TextBox10.Value
    HIP = TextBox11.Value
    '|fffd|p|fffd||fffd|
    KAK = Replace(TextBox12.Value, vbCrLf, "")
    KAA = ComboBox19.ListIndex
    KAB = ComboBox20.ListIndex
    KAC = TextBox14.Value
'    KAD = ComboBox21.ListIndex '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|p
    FileNo = FreeFile
    If Dir(SPA, vbDirectory) = "" And op_version >= 6 Then
        MkDir SPA
    End If
    Open SPA & "\inkan.ini" For Output As FileNo
    Print #FileNo, NM
    Print #FileNo, FO1
    Print #FileNo, SY1
    Print #FileNo, FO2
    Print #FileNo, SY2
    Print #FileNo, WA
    Print #FileNo, IR1
    Print #FileNo, IR2
    Print #FileNo, FO3
    Print #FileNo, IR3
    Print #FileNo, TB
    Print #FileNo, SK1
    Print #FileNo, SK2
    Print #FileNo, WA2
    Print #FileNo, KOB
    Print #FileNo, SK3
    Print #FileNo, SIZ1
    Print #FileNo, SIZ2
    Print #FileNo, KT1
    Print #FileNo, KT2
    Print #FileNo, KT3
    Print #FileNo, GZ2
    Print #FileNo, GZ3
    Print #FileNo, KT4
    Print #FileNo, FPA
    Print #FileNo, UXW
    Print #FileNo, UYH
    Print #FileNo, UMT
    Print #FileNo, NCH
    Print #FileNo, HYJ
    Print #FileNo, BSW
    Print #FileNo, BSH
    Print #FileNo, DSH
    Print #FileNo, FTN
    Print #FileNo, HIP
    Print #FileNo, KAK
    Print #FileNo, FO4
    Print #FileNo, KAA
    Print #FileNo, KAB
    Print #FileNo, KAC
    Print #FileNo, SK4
    Print #FileNo, GZ4
    Close #FileNo
    UserForm1.Hide
End Sub

Private Sub CommandButton2_Click()
    Dim W As Worksheet
    Set W = ThisWorkbook.Worksheets(1)
    FO1 = KFO1
    IR1 = KIR1
    TB = KTB
    W.Range("A1").Font.Name = FO1
    If InStr(1, KNM, vbLf) = 0 Then
        With W.Range("A1")
            .Value = Replace(KNM, vbCr, "")
            .Offset(, 1).ClearContents
        End With
    Else
        With W.Range("A1")
            .Value = Split(Replace(KNM, vbCr, ""), vbLf)(1)
            .Offset(, 1).Value = Split(Replace(KNM, vbCr, ""), vbLf)(0)
        End With
    End If
    '    W.Range("A1").Value = KNM
    If F = True Then W.Rows(1).EntireRow.AutoFit
    UserForm1.Hide
    CommandButton2.Cancel = True
    FO2 = KFO2: SY1 = KSY1: SY2 = KSY2: IR2 = KIR2
    FO3 = KFO3: IR3 = KIR3: KOB = KKOB
    SK1 = KSK1: SK2 = KSK2: SK3 = KSK3
    SIZ1 = KSIZ1: SIZ2 = KSIZ2
    KT1 = KKT1: KT2 = KKT2: KT3 = KKT3: KT4 = KKT4: GZ2 = KGZ2: GZ3 = KGZ3: DSH = KDSH
    FO4 = KFO4: KAK = KKAK: KAA = KKAA: KAB = KKAB: KAC = KKAC: KSK4 = SK4
End Sub
Private Sub CommandButton3_Click()
    Dim F As Variant, KFPA As String
    F = Application.GetOpenFilename("|fffd||645c| |fffd|t|fffd|@|fffd|C|fffd||fffd| (*.jpg; *.bmp;*.tif;*.tiff;*.png;*.gif),*.jpg;*.bmp;*.tif;*.tiff;*.png;*.gif", , "|fffd|o|fffd|^|fffd||645c||fffd|I|fffd||fffd|")
    If F = False Then Exit Sub
    TextBox2.Value = F
    KFPA = FPA
    FPA = F
    Call Inkan1.Piload4
    FPA = KFPA
    G3 = True
End Sub

Private Sub CommandButton4_Click()
    Call Inkan1.help
End Sub

'Private Sub ImageCombo1_Click()
'    If F = False Then Exit Sub
'    If MultiPage1.Value = 1 Then
'        IR2 = ImageCombo1.SelectedItem.Index - 1
'        Call Inkan1.Piload2
'    ElseIf MultiPage1.Value = 2 Then
'        IR3 = ImageCombo1.SelectedItem.Index - 1
'        Call Inkan1.Piload3
'    Else
'        IR1 = ImageCombo1.SelectedItem.Index - 1
'        Call Inkan1.Piload
'    End If
'End Sub
Private Sub MultiPage1_Change()
'    If MultiPage1.Value = 1 Then
'        ImageCombo1.Top = 136
'        ImageCombo1.ComboItems(IR2 + 1).Selected = True
'    ElseIf MultiPage1.Value = 2 Then
'        ImageCombo1.Top = 70
'        ImageCombo1.ComboItems(IR3 + 1).Selected = True
'    ElseIf MultiPage1.Value = 0 Then
'        ImageCombo1.Top = 88
'        ImageCombo1.ComboItems(IR1 + 1).Selected = True
'    Else
'        ImageCombo1.Top = 300
'    End If
    If G1 = True And G2 = True And G3 = True And G4 = True Then Exit Sub
    If G1 = False And MultiPage1.Value = 1 Then
        Call Inkan1.Piload2
        G1 = True
    ElseIf G2 = False And MultiPage1.Value = 2 Then
        Call Inkan1.Piload5
        G2 = True
    ElseIf G3 = False And MultiPage1.Value = 3 Then
        Call Inkan1.Piload3
        G3 = True
    ElseIf G4 = False And MultiPage1.Value = 4 Then
        Call Inkan1.Piload4
        G4 = True
    End If
End Sub

Private Sub OptionButton1_Click()
    If F = False Then Exit Sub
    KOB = 0
    Call Inkan1.Piload
End Sub

Private Sub OptionButton2_Click()
    If F = False Then Exit Sub
    KOB = 1
    Call Inkan1.Piload
End Sub

Private Sub OptionButton3_Click()
    TextBox3.Enabled = False
    TextBox4.Enabled = False
    TextBox11.Enabled = False
    Label20.Enabled = False
    Label21.Enabled = False
    Label22.Enabled = False
    Label27.Enabled = False
End Sub

Private Sub OptionButton4_Click()
    TextBox3.Enabled = True
    TextBox4.Enabled = True
    TextBox11.Enabled = False
    Label20.Enabled = True
    Label21.Enabled = True
    Label22.Enabled = True
    Label27.Enabled = False
End Sub

Private Sub OptionButton5_Click()
    TextBox3.Enabled = False
    TextBox4.Enabled = False
    TextBox11.Enabled = True
    Label20.Enabled = False
    Label21.Enabled = False
    Label22.Enabled = False
    Label27.Enabled = True
    If TextBox11.Value = "" Then
      TextBox11.Value = 100
    End If
End Sub

Private Sub TextBox1_Change()
    Dim W As Worksheet
    If F = False Then Exit Sub
    Set W = ThisWorkbook.Worksheets(1)
    KNM = NM
    NM = Replace(TextBox1.Value, vbCr, "")
    If NM <> "" Then
        If InStr(1, NM, vbLf) = 0 Then
            With W.Range("A1")
                .Value = NM
                .Offset(, 1).ClearContents
            End With
        Else
            With W.Range("A1")
                .Value = Split(NM, vbLf)(1)
                .Offset(, 1).Value = Split(NM, vbLf)(0)
            End With
        End If
        '  W.Range("A1").Value = TextBox1.Value
        If F = True Then W.Rows(1).EntireRow.AutoFit
        Call Inkan1.Piload
    End If
    NM = KNM
End Sub

Private Sub TextBox10_Change()
    If F = False Then Exit Sub
    DSH = Val(TextBox10.Value)
    Call Inkan1.Piload2
End Sub


Private Sub TextBox8_Change()
    If F = False Then Exit Sub
    BSW = TextBox8.Value
    Call Inkan1.Piload3
End Sub

Private Sub TextBox9_Change()
    If F = False Then Exit Sub
    BSH = TextBox9.Value
    Call Inkan1.Piload3
End Sub

Private Sub UserForm_Initialize()
    Dim D As CommandBarControl, C As CommandBarControl, I As Double
    Application.ScreenUpdating = False
On Error Resume Next
    F = False
    For Each D In Application.CommandBars("Formatting").Controls
        If (Application.version <= 11 And D.Caption = "|fffd|t|fffd|H|fffd||fffd||fffd|g(&F):") _
            Or (Application.version >= 12 And D.Caption Like "|fffd|t|fffd|H|fffd||fffd||fffd|g*(&F):" And Len(D.Caption) <= 11) Then
            Set C = D
            Exit For
        End If
    Next D
    If Not C Is Nothing Then
        For I = 1 To C.ListCount
            ComboBox1.AddItem C.List(I)
            ComboBox2.AddItem C.List(I)
            ComboBox7.AddItem C.List(I)
            ComboBox21.AddItem C.List(I)
        Next I
    Else
        ComboBox1.List = Array("|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|", "HGS|fffd|s|fffd||fffd||fffd||fffd|", "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N", "HG|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-PRO")
        ComboBox2.List = Array("|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|", "HGS|fffd|s|fffd||fffd||fffd||fffd|", "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N", "HG|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-PRO")
        ComboBox7.List = Array("|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|", "HGS|fffd|s|fffd||fffd||fffd||fffd|", "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N", "HG|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-PRO")
        ComboBox21.List = Array("|fffd|l|fffd|r |fffd|o|fffd||fffd||fffd||fffd|", "HGS|fffd|s|fffd||fffd||fffd||fffd|", "|fffd|l|fffd|r |fffd|o|fffd|S|fffd|V|fffd|b|fffd|N", "HG|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-PRO")
    End If
    '    ImageCombo1.Top = 88
    Dim A As Variant, B As Variant
    ComboBox16.List = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd||fffd||90a2||fffd||fffd|", "|fffd|s|fffd||fffd||fffd|N", "|fffd||fffd||fffd|F", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd||97||fffd|", "25|fffd||fffd||fffd|D|fffd|F", "50|fffd||fffd||fffd|D|fffd|F", "|fffd|X|fffd|J|fffd|C|fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd|y|fffd|[|fffd||fffd||fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd|[|fffd|Y", "|fffd||fffd||fffd|x|fffd||fffd||fffd|_|fffd|[", "|fffd|x|fffd|[|fffd|W|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|A|fffd|N|fffd|A", "|fffd||fffd||fffd|C|fffd||fffd|", "|fffd|S|fffd|[|fffd||fffd||fffd|h", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|u|fffd||fffd||fffd|[|fffd|O|fffd||fffd||fffd|[", "40|fffd||fffd||fffd|D|fffd|F", "|fffd|Z|fffd||fffd||fffd||97||fffd|", "|fffd|V|fffd|[|fffd|O|fffd||fffd||fffd|[|fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|I|fffd||fffd||fffd|[|fffd|u", "|fffd|v|fffd||fffd||fffd||fffd|", "|fffd|C|fffd||fffd||fffd|f|fffd|B|fffd|S", "80|fffd||fffd||fffd|D|fffd|F")
    ComboBox17.List = ComboBox16.List
    ComboBox18.List = ComboBox16.List
    ComboBox20.List = ComboBox16.List
    '    ImageCombo1.ImageList = ImageList1
    '    A = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd||fffd||90a2||fffd||fffd|", "|fffd|s|fffd||fffd||fffd|N", "|fffd||fffd||fffd|F", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd||97||fffd|", "25|fffd||fffd||fffd|D|fffd|F", "50|fffd||fffd||fffd|D|fffd|F", "|fffd|X|fffd|J|fffd|C|fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd|y|fffd|[|fffd||fffd||fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd|[|fffd|Y", "|fffd||fffd||fffd|x|fffd||fffd||fffd|_|fffd|[", "|fffd|x|fffd|[|fffd|W|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|A|fffd|N|fffd|A", "|fffd||fffd||fffd|C|fffd||fffd|", "|fffd|S|fffd|[|fffd||fffd||fffd|h", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|u|fffd||fffd||fffd|[|fffd|O|fffd||fffd||fffd|[", "40|fffd||fffd||fffd|D|fffd|F", "|fffd|Z|fffd||fffd||fffd||97||fffd|", "|fffd|V|fffd|[|fffd|O|fffd||fffd||fffd|[|fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|I|fffd||fffd||fffd|[|fffd|u", "|fffd|v|fffd||fffd||fffd||fffd|", "|fffd|C|fffd||fffd||fffd|f|fffd|B|fffd|S", "80|fffd||fffd||fffd|D|fffd|F")
    '    B = Array(3, 1, 27, 14, 17, 6, 33, 40, 19, 4, 24, 2, 26, 12, 22, 39, 37, 29, 25, 20, 15, 30, 5, 35, 10, 28, 23, 13, 9, 8, 7, 32, 38, 21, 18, 16, 11, 34, 31, 36)
    '    For I = 1 To 40
    '        ImageCombo1.ComboItems.Add , , A(I - 1), "a" & B(I - 1)
    '    Next I
    '    ImageCombo1.ComboItems(IR1 + 1).Selected = True
    ComboBox16.ListIndex = IR1
    ComboBox17.ListIndex = IR2
    ComboBox18.ListIndex = IR3
    ComboBox3.List = Array("|fffd||fffd||fffd|z|fffd||fffd|", "|fffd|y|fffd||615||fffd|", "|fffd|c|fffd||195||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd|@|fffd|t", "|fffd|m|fffd|@|fffd|F", "|fffd|s|fffd|d|fffd|k", "|fffd|e|fffd|`|fffd|w" _
        , "|fffd||fffd||fffd|@|fffd||fffd|", "|fffd||fffd||fffd|@|fffd||fffd|", "|fffd||fffd||fffd|@|fffd||fffd|", "|fffd||fffd||fffd|@|fffd|i", "|fffd||fffd|@|fffd||fffd|", "|fffd|x|fffd|@|fffd||fffd|", "|fffd||301|@|fffd||fffd|", "|fffd||fffd||fffd|@|fffd|F")
    ComboBox4.List = Array(Left(NM, 6), "|fffd||fffd|")
    '  ComboBox5.List = Array("|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd|", "|fffd||fffd||fffd||90a2||fffd||fffd|", "|fffd|s|fffd||fffd||fffd|N", "|fffd||fffd||fffd|F", "|fffd|Z|fffd||fffd||fffd||fffd|" _
    , "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd||97||fffd|", "25|fffd||fffd||fffd|D|fffd|F", "50|fffd||fffd||fffd|D|fffd|F", "|fffd|X|fffd|J|fffd|C|fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|F", "|fffd|y|fffd|[|fffd||fffd||fffd|u|fffd||fffd||fffd|[", "|fffd||fffd||fffd|[|fffd|Y", "|fffd||fffd||fffd|x|fffd||fffd||fffd|_|fffd|[" _
        , "|fffd|x|fffd|[|fffd|W|fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|A|fffd|N|fffd|A", "|fffd||fffd||fffd|C|fffd||fffd|", "|fffd|S|fffd|[|fffd||fffd||fffd|h", "|fffd||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|I|fffd||fffd||fffd||fffd||fffd|W", "|fffd|u|fffd||fffd||fffd|[|fffd|O|fffd||fffd||fffd|[", "40|fffd||fffd||fffd|D|fffd|F", "|fffd|Z|fffd||fffd||fffd||97||fffd|" _
        , "|fffd|V|fffd|[|fffd|O|fffd||fffd||fffd|[|fffd||fffd|", "|fffd|Z|fffd||fffd||fffd||fffd|", "|fffd|I|fffd||fffd||fffd|[|fffd|u", "|fffd|v|fffd||fffd||fffd||fffd|", "|fffd|C|fffd||fffd||fffd|f|fffd|B|fffd|S", "80|fffd||fffd||fffd|D|fffd|F")
    '   ComboBox6.List = ComboBox5.List
    ' ComboBox8.List = ComboBox5.List
    ComboBox9.List = Array(Format(Date, "ee/mm/dd"), Format(Date, "yy/mm/dd"), Format(Date, "ge/mm/dd"), _
        Format(Date, "yyyy/mm/dd"), Format(Date, "yyyy/m/d") _
        , Format(Date, "ee/m/d"), Format(Date, "yy/m/d"), Format(Date, "ge/m/d"), Format(Date, "m|fffd||fffd|d|fffd||fffd|"))
    For I = 4.5 To 18 Step 1.5
        ComboBox10.AddItem I & "mm"
    Next I
    'ComboBox10.List = Array("0.5|fffd|{", "0.6|fffd|{", "0.7|fffd|{", "0.8|fffd|{", "0.9|fffd|{", "1.0|fffd|{", "1.1|fffd|{", "1.2|fffd|{", "1.3|fffd|{", "1.4|fffd|{", "1.5|fffd|{")
    ComboBox10.ListIndex = SIZ1
    ComboBox11.List = Array("|fffd|W|fffd||fffd|", "|fffd||50ab||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd|")
    ComboBox11.ListIndex = SIZ2
    If Application.version >= 10 Then
        For I = 0 To 359 Step 5
            ComboBox12.AddItem I & "|fffd||fffd|"
            ComboBox13.AddItem I & "|fffd||fffd|"
            ComboBox14.AddItem I & "|fffd||fffd|"
        Next I
        ComboBox12.ListIndex = KT1
        ComboBox13.ListIndex = KT2
        ComboBox14.ListIndex = KT3
    Else
        ComboBox12.visible = False
        ComboBox13.visible = False
        ComboBox14.visible = False
        Label16.visible = False
        Label17.visible = False
        Label18.visible = False
    End If
    ComboBox15.List = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|c|fffd||fffd||fffd||fffd|")
    ComboBox15.ListIndex = KT4
    ComboBox9.Value = WA2
    '   ComboBox5.ListIndex = IR1
    ' ComboBox6.ListIndex = IR2
    ' ComboBox8.ListIndex = IR3
    KFO1 = FO1: KIR1 = IR1: KTB = TB: KNM = NM
    KFO2 = FO2: KSY1 = SY1: KSY2 = SY2: KIR2 = IR2
    KFO3 = FO3: KIR3 = IR3: KKOB = KOB
    KSK1 = SK1: KSK2 = SK2: KSK3 = SK3
    KSIZ1 = SIZ1: KSIZ2 = SIZ2
    KKT1 = KT1: KKT2 = KT2: KKT3 = KT3: KGZ2 = GZ2: KGZ3 = GZ3: KGZ4 = GZ4
    KDSH = DSH: KFO4 = FO4: KKAK = KAK: KKAA = KAA: KKAB = KAB: KKAC = KAC
    CheckBox2.Value = SK1
    CheckBox3.Value = SK2
    CheckBox4.Value = SK3
    CheckBox10.Value = SK4
    CheckBox5.Value = GZ2
    CheckBox6.Value = GZ3
    CheckBox7.Value = NCH
    If FO1 = "" Then
        ComboBox1.ListIndex = 0
    Else
        ComboBox1.Value = FO1
    End If
    If FO2 = "" Then
        ComboBox2.ListIndex = 0
    Else
        ComboBox2.Value = FO2
    End If
    If FO3 = "" Then
        ComboBox7.ListIndex = 0
    Else
        ComboBox7.Value = FO3
    End If
    If FO4 = "" Then
        ComboBox21.ListIndex = 0
    Else
        ComboBox21.Value = FO4
    End If
    Select Case KAA
    Case 0
    TextBox12.Font.Size = 19
    Case 1
    TextBox12.Font.Size = 16.5
    Case 2
    TextBox12.Font.Size = 11.5
    End Select
    If KOB = 0 Then
        OptionButton1.Value = True
    Else
        OptionButton2.Value = True
    End If
    If Application.version <= 11 Then
    CheckBox11.visible = False
    Else
    CheckBox11.Value = GZ4
    End If
    TextBox1.Value = NM
    ComboBox3.Value = SY1
    ComboBox4.Value = SY2
    CheckBox1.Value = TB
    CheckBox9.Value = FTN
    TextBox2.Value = FPA
    TextBox3.Value = UXW
    TextBox4.Value = UYH
    CheckBox8.Value = HYJ
    '|fffd|r|fffd|W|fffd|l|fffd|X|fffd||fffd||fffd|W|fffd|AH|fffd||fffd||fffd|@
    Label24.visible = GZ3
    Label25.visible = GZ3
    TextBox8.visible = GZ3
    TextBox9.visible = GZ3
    TextBox8.Value = BSW
    TextBox9.Value = BSH
    TextBox10.Value = DSH
    TextBox11.Value = HIP
    If InStr(1, KAK, vbCrLf) = 0 Then
    KAK = Left(KAK, (KAA + 2)) + vbCrLf + Mid(KAK, (KAA + 2) + 1, (KAA + 2)) + vbCrLf + Mid(KAK, (KAA + 2) * 2 + 1, (KAA + 2))
    End If
    TextBox12.Value = KAK
    ComboBox11.visible = Not GZ3
    ComboBox19.List = Array("6", "9", "12")
    ComboBox19.ListIndex = KAA
    ComboBox20.ListIndex = KAB
    TextBox14.Value = KAC
  '  ComboBox21.List = Array("|fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd|c|fffd||fffd||fffd||fffd|")
    If Application.version <= 11 Then
        CheckBox8.Caption = "|fffd|c|fffd|[|fffd||fffd||fffd|o|fffd|[|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd|A|fffd|{|fffd|^|fffd||fffd||fffd||fffd||fffd||fffd||94|\|fffd||242||fffd||fffd||fffd|"
    End If
    If UMT = 0 Then
        OptionButton3.Value = True
    ElseIf UMT = 2 Then
        OptionButton5.Value = True
    Else
        OptionButton4.Value = True
    End If
    G1 = False: G2 = False
    TextBox10.Enabled = CheckBox5.Value
    If CheckBox7.Value = True Then
        TextBox1.Top = 6.75
        TextBox1.Height = 28.5
        TextBox1.EnterKeyBehavior = True
    Else
        TextBox1.Top = 12
        TextBox1.Height = 17.25
        TextBox1.EnterKeyBehavior = False
    End If
    Call Inkan1.Piload
    Application.ScreenUpdating = True
    F = True
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = 0 Then Call CommandButton2_Click
End Sub

Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{572F25A6-8731-47E3-A08F-873CD61CF5BE}{32D9F484-E3DC-4D12-9B48-5FB4822A126C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
















Option Explicit
Dim VT() As String



Private Sub CommandButton1_Click()
    If OptionButton1.Value = True Then
        Call kairan_in("|fffd||40a|O|fffd||fffd|", 141.75, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton2.Value = True Then
        Call Inkan1.kairan_in("|fffd||595||fffd||fffd||fffd|", 141.75, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton3.Value = True Then
        Call kairan_in("|fffd||fffd|", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton4.Value = True Then
        Call kairan_in("|fffd||fffd||fffd|}", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton5.Value = True Then
        Call kairan_in("|fffd|d|fffd|v", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton6.Value = True Then
        Call kairan_in("|fffd|e|fffd|W", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton7.Value = True Then
        Call kairan_in("|fffd||fffd|", 70, 70, msoShapeOval, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton8.Value = True Then
        Call kairan_in(TextBox1.Value, 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton9.Value = True Then
        Call kairan_in("|fffd||fffd||fffd|{", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton10.Value = True Then
        Call kairan_in("|fffd||254||fffd|", 102, 55.5, msoShapeRoundedRectangle, , CheckBox1.Value, ComboBox3.ListIndex)
    ElseIf OptionButton11.Value = True Then
        Call kairan_in(TextBox1.Value, 70, 70, msoShapeOval, , CheckBox1.Value, ComboBox3.ListIndex)
    End If
    Unload UserForm2
End Sub
Private Sub ComboBox2_Change()
    OptionButton8.Value = True
    TextBox1.Value = ComboBox2.Value
End Sub

Private Sub CommandButton2_Click()
    Unload UserForm2
End Sub

Private Sub CommandButton3_Click()
    Dim FileNo As Integer, I As Integer
    If TextBox1.Value = "" Then Exit Sub
    ComboBox2.AddItem TextBox1.Value
    ReDim Preserve VT(ComboBox2.ListCount - 1) As String
    VT(ComboBox2.ListCount - 1) = Replace(TextBox1.Value, vbCr, "")
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        SPA = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelData"
    Else 'WindowsXP|fffd||702||fffd|
        SPA = Application.Path
    End If
    FileNo = FreeFile
    Open SPA & "\inkand.ini" For Output As FileNo
    For I = 0 To UBound(VT)
        Print #FileNo, VT(I)
    Next I
    Close #FileNo
End Sub

Private Sub CommandButton4_Click()
    Dim FileNo As Integer, I As Integer, K() As String, J As Integer
    If ComboBox2.ListIndex < 0 Then Exit Sub
    For I = 0 To UBound(VT)
        If VT(I) <> Replace(ComboBox2.Value, vbCr, "") Then
            ReDim Preserve K(J) As String
            K(J) = VT(I)
            J = J + 1
        End If
    Next I
    ComboBox2.RemoveItem ComboBox2.ListIndex
    TextBox1.Value = ""
    Erase VT
    If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
        SPA = Left(Application.UserLibraryPath, _
            InStrRev(Left(Application.UserLibraryPath, _
            Len(Application.UserLibraryPath) - 1), "\")) & "ExcelData"
    Else 'WindowsXP|fffd||702||fffd|
        SPA = Application.Path
    End If
    If Sgn(K) = 0 Then
        Kill SPA & "\inkand.ini"
    Else
        FileNo = FreeFile
        Open SPA & "\inkand.ini" For Output As FileNo
        For I = 0 To UBound(K)
            Print #FileNo, K(I)
            ReDim Preserve VT(I) As String
            VT(I) = K(I)
        Next I
        Close #FileNo
    End If
End Sub

Private Sub OptionButton11_Click()
    TextBox1.SetFocus
End Sub

Private Sub OptionButton8_Click()
    TextBox1.SetFocus
End Sub

Private Sub TextBox1_Enter()
    If OptionButton8.Value = False And OptionButton11.Value = False Then
        OptionButton8.Value = True
    End If
End Sub

Private Sub UserForm_Initialize()
    Dim FileNo As Integer, I As Integer
    OptionButton1.Value = True
    If KT4 = 0 Then
        ComboBox1.List = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd|l|fffd||fffd|", "|fffd|E|fffd|l|fffd||fffd|")
    Else
        ComboBox1.List = Array("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd|l|fffd||fffd|", "|fffd||fffd||fffd|l|fffd||fffd|")
    End If
    ComboBox1.ListIndex = 0
    ComboBox3.List = Array("|fffd||fffd||fffd||fffd|", 6, 8, 9, 10, 11, 12, 14, 16, 18, 20, 22, 24, 26, 28, 36, 48, 72)
    ComboBox3.ListIndex = 0
    CheckBox1.Value = FTN
    If Dir(SPA & "\inkand.ini") <> "" Then
        If op_version >= 6 Then 'WindowsVista|fffd||20f||fffd|
            SPA = Left(Application.UserLibraryPath, _
                InStrRev(Left(Application.UserLibraryPath, _
                Len(Application.UserLibraryPath) - 1), "\")) & "ExcelData"
        Else 'WindowsXP|fffd||702||fffd|
            SPA = Application.Path
        End If
        FileNo = FreeFile
        Open SPA & "\inkand.ini" For Input As FileNo
        Do While Not EOF(FileNo)
            ReDim Preserve VT(I) As String
            Line Input #FileNo, VT(I)
            ComboBox2.AddItem VT(I)
            I = I + 1
        Loop
        Close #FileNo
    End If
End Sub


INQUEST-PP=macro
