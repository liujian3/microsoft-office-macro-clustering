Attribute VB_Name = "FormInst"
Attribute VB_Base = "0{3E4FA556-D07C-4FC5-8D72-C4CB90FCDF20}{A21DB5E1-07B2-4296-8A56-38844D07B1A0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub UserForm_Initialize()
    If Not IsPortg Then
        Caption = "OrlandoWordTools - Installation"
        Caption_Lb.Caption = "My tools that I use with more frequency in Word will be installed or uninstalled if they had be installed before. Click on each icon to more details and selection."
        Tool1_Lb.Caption = " Spell number (write out)"
        Tool2_Lb.Caption = " Mark positions (2) on document"
        Tool3_Lb.Caption = " Selected text, find next"
        Tool4_Lb.Caption = " Insert Date and Hour of the system"
        Tool5_Lb.Caption = " Paste only text or only format"
        Tool6_Lb.Caption = " Activate folder of active document"
        Tool7_Lb.Caption = " Print book, handbook..."
        Tool8_Lb.Caption = " Online Dictionary"
        Instal_Bt.Caption = "Install"
        UnInstal_Bt.Caption = "Uninstall"
        Cancel_Bt.Caption = "Cancel"
        Email_Lb.Caption = "Email"
        Email_Lb.ControlTipText = "orlando@cpap.com.br"
        HomePage_Lb.Caption = "Help"
        HomePage_Lb.ControlTipText = "http://cpap.com.br/orlando/"
    Else
        Email_Lb.Caption = "E-mail"
        Email_Lb.ControlTipText = "orlando@cpap.com.br"
        HomePage_Lb.Caption = "Ajuda"
        HomePage_Lb.ControlTipText = "http://cpap.com.br/orlando/"
    End If
    Email_Lb.Left = Width - Email_Lb.Width - (Width - InsideWidth) - 4      'Email_Lb.Left = Width - Email_Lb.Width - 8

    Image1.MouseIcon = HomePage_Lb.MouseIcon
    Image2.MouseIcon = HomePage_Lb.MouseIcon
    Image3.MouseIcon = HomePage_Lb.MouseIcon
    Image4.MouseIcon = HomePage_Lb.MouseIcon
    Image5.MouseIcon = HomePage_Lb.MouseIcon
    Image6.MouseIcon = HomePage_Lb.MouseIcon
    Image7.MouseIcon = HomePage_Lb.MouseIcon
    Image8.MouseIcon = HomePage_Lb.MouseIcon

    Tool1_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool2_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool3_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool4_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool5_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool6_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool7_Lb.MouseIcon = HomePage_Lb.MouseIcon
    Tool8_Lb.MouseIcon = HomePage_Lb.MouseIcon
End Sub

Private Sub Image1_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para escrever por extenso o n|fffd|mero selecionado ou captado entre o cursor e o espa|fffd|o imediatamente anterior. " & Chr(10) & _
                "O n|fffd|mero captado |fffd| automaticamente formatado e descrito por extenso entre par|fffd|nteses logo em seguida em portugu|fffd|s, se o par|fffd|grafo tiver formato portugu|fffd|s, ou em ingl|fffd|s, se outros formatos." & Chr(10) & _
                "Por padr|fffd|o o extenso tem como unidade e formato: o da moeda corrente no Brasil (Real), se o par|fffd|grafo tiver formato portugu|fffd|s do Brasil; o da moeda corrente em Portugal (Euro), se o par|fffd|grafo tiver formato portugu|fffd|s de Portugal; ou o da moeda corrente nos EUA (Dollar), se outros formatos. No entanto voc|fffd|, ao digitar diretamente no documento, pode interpor entre o n|fffd|mero e o cursor os seguintes modificadores e/ou o nome de uma outra unidade no singular/plural: " & Chr(10) & _
                "  $ - descreve fra|fffd||fffd|o com centavos (Ideal para moeda);" & Chr(10) & _
                "  % - descreve fra|fffd||fffd|o com v|fffd|rgula, zeros e extenso do inteiro restante (Ideal para percentagem);" & Chr(10) & _
                "  # - descreve fra|fffd||fffd|o com d|fffd|cimos at|fffd| trilion|fffd|simos (Ideal para n|fffd|mero puro);" & Chr(10) & _
                "  |fffd| - descreve fra|fffd||fffd|o com c|fffd|ntimos (Ideal para moeda Euro, mas centavos tamb|fffd|m pode ser usado);" & Chr(10) & _
                "  @ - Indica unidade feminina (sempre na |fffd|ltima posi|fffd||fffd|o); " & Chr(10) & _
                "  & - P|fffd|e v|fffd|rgula entre posi|fffd||fffd|o de milhar em vez da conjun|fffd||fffd|o e; " & Chr(10) & _
                "  ! - Oculta 'um' ao escrever 'um mil'." & Chr(10) & _
                "Exemplos: (Veja atr|fffd|s do cursor (|) e o resultado) " & Chr(10) & _
                "  5,20| - 5,20 (cinco reais (euros em Portugal) e vinte centavos);" & Chr(10) & _
                "  5,20$| - 5,20 (cinco reais (euros em Portugal) e vinte centavos); " & Chr(10) & _
                "  5,20$iene| - 5,20 (cinco ienes e vinte centavos); " & Chr(10) & _
                "  5,20|fffd|| - 5,20 (cinco euros e vinte c|fffd|ntimos); " & Chr(10) & _
                "  5,20%| - 5,2 % (cinco v|fffd|rgula dois por cento);" & Chr(10) & _
                "  5,20#| - 5,2 (cinco, e dois d|fffd|cimos);" & Chr(10) & _
                "  5,201#real| - 5,201 (cinco reais e duzentos e um mil|fffd|simos de real);" & Chr(10) & _
                "  5,201%real| - 5,201 (cinco v|fffd|rgula duzentos e um reais);" & Chr(10) & _
                "  222,2#saca@| - 222,2 (duzentAS e vinte e duAS sacas e dois d|fffd|cimos de saca) etc."
    Else
        sMsg1 = "This is a tool to spell (written out) the selected or captured numbers between the cursor and the before immediately space." & Chr(10) & _
                "The captured number is automatically formatted and written out between parenthesis afterwards immediately in English or in Portuguese, if the paragraph has Portuguese format." & Chr(10) & _
                "By default the written out has as unity and format: the USA currency (Dollar), or the Brazil currency (Real), if the paragraph has Brazil Portuguese format; or the Portugal currency (Euro), if the paragraph has Portugal Portuguese format. But you, when typing directly in the document, can interpose between the number and the cursor the following modifiers (flags) and/or the name of the other unity in singular/plural: " & Chr(10) & _
                "  $ - spell fraction with cents (Ideal for coin);" & Chr(10) & _
                "  % - spell fraction with point, zeros and written out of the remainder integer (Ideal for percentage);" & Chr(10) & _
                "  # - spell fraction with tenths until trillionths (Ideal for pure number);" & Chr(10) & _
                "  * - spell fraction with pennies (Ideal for coin);" & Chr(10) & _
                "  & - Put comma between thousand position in place of and conjunction; " & Chr(10) & _
                "  ! - Omit 'one' when write 'one thousand'." & Chr(10) & _
                "  |fffd| - instead $ indicates too Euro coin;" & Chr(10) & _
                "Samples: (See behind of the cursor (|) and the result) " & Chr(10) & _
                "  5.20| - 5.20 (five dollars and twenty cents);" & Chr(10) & _
                "  5.20$| - 5.20 (five dollars and twenty cents); " & Chr(10) & _
                "  5.20$yen| - 5.20 (five yens and twenty cents); " & Chr(10) & _
                "  5.20|fffd|| - 5.20 (five euros and twenty cents); " & Chr(10) & _
                "  5.20%| - 5.2 % (five point two percent);" & Chr(10) & _
                "  5.20#| - 5.2 (five, and two tenths);" & Chr(10) & _
                "  5.20*| - 5.20 (five dollars and twenty pennies); " & Chr(10) & _
                "  5.201#dollar| - 5.201 (five dollars and two hundred one thousandths of dollar);" & Chr(10) & _
                "  5.201%dollar| - 5.201 (five point two hundred one dollars)."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool1_Lb.Caption
    If T1_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool1_Lb.Caption) = 1 Then T1_ChB = True
End Sub

Private Sub Image2_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para marcar ou ir para uma posi|fffd||fffd|o marcada anteriormente no documento ativo." & Chr(10) & Chr(10) & _
                "Para marcar uma posi|fffd||fffd|o, voc|fffd| deve estar pressionando a tecla Shift em seu teclado enquanto clica na ferramenta com o mouse." & Chr(10) & Chr(10) & _
                "Para ir ou voltar para uma marca|fffd||fffd|o anterior, basta clicar na ferramenta." & Chr(10) & Chr(10) & _
                "S|fffd|o duas ferramentas semelhantes para marcar at|fffd| duas posi|fffd||fffd|es diferentes. Elas s|fffd|o bastante |fffd|teis na edi|fffd||fffd|o de grandes documentos."
    Else
        sMsg1 = "This is a tool to mark or to go to a formerly marked position on the active document." & Chr(10) & Chr(10) & _
                "To mark a position, you must be pressing the Shift key on your keyboard while click on this tool with the mouse." & Chr(10) & Chr(10) & _
                "To go or return to former marking, it's sufficient to click on this tool." & Chr(10) & Chr(10) & _
                "It's two similar tools to mark until two different positions. They are very useful on the edition of large documents."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool2_Lb.Caption
    If T2_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool2_Lb.Caption) = 1 Then T2_ChB = True
End Sub

Private Sub Image3_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para localizar outras ocorr|fffd|ncias do texto ora selecionado no documento ativo." & Chr(10) & Chr(10) & _
                "Caso n|fffd|o haja sele|fffd||fffd|o, ser|fffd| repetida a |fffd|ltima procura. Se ainda n|fffd|o tiver havido procura, ser|fffd| captada a palavra pr|fffd|xima ao cursor e exibido o formul|fffd|rio padr|fffd|o de localiza|fffd||fffd|o do Word para confirmar ou alterar o texto captado." & Chr(10) & Chr(10) & _
                "Para for|fffd|ar a exibi|fffd||fffd|o do formul|fffd|rio padr|fffd|o do Word, voc|fffd| deve estar pressionando a tecla Shift em seu teclado enquanto clica na ferramenta com o mouse." & Chr(10) & Chr(10) & _
                "Com esta ferramenta, a localiza|fffd||fffd|o de uma outra ocorr|fffd|ncia de texto n|fffd|o formatado |fffd| feita de forma praticamente imediata, sem exibi|fffd||fffd|o de formul|fffd|rio ou digita|fffd||fffd|o. Isto |fffd| bastante |fffd|til na edi|fffd||fffd|o de textos com v|fffd|rias ocorr|fffd|ncias em grandes e pequenos documentos."
    Else
        sMsg1 = "This is a tool to find others occurrences of the currently selected text." & Chr(10) & Chr(10) & _
                "If there isn't selected text, it will be repeated the last search. If it hadn't had search yet, it will be captured the word close of the cursor and showed on the built-in Word find form to confirm or edit the captured text." & Chr(10) & Chr(10) & _
                "To force the show of the built-in Word find form, you must be pressing the Shift key on your keyboard while click on this tool with the mouse." & Chr(10) & Chr(10) & _
                "With this tool, the localization of other occurrence of unformatted text is done almost immediately, without show of forms or typing. It is very useful on the edition of text with several occurrences in large or small documents."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool3_Lb.Caption
    If T3_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool3_Lb.Caption) = 1 Then T3_ChB = True
End Sub

Private Sub Image4_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para, com um simples clique, inserir no documento ativo a data e a hora do sistema em formato completo com ''o dia da semana'', ''o dia do m|fffd|s'',  ''o m|fffd|s'', ''o ano'',  ''a hora'', ''os minutos'' e ''os segundos'' -  n|fffd|o dispon|fffd|vel de imediato no Word. |fffd| melhor editar excluindo e movendo dados a inserindo com v|fffd|rios comandos." & Chr(10) & _
                "Por exemplo: " & Chr(10) & _
                "Sexta-feira, 23 de agosto de 2002 - 17:49:12 - "
    Else
        sMsg1 = "This is a tool to insert in the active document, with only one click, the date and hour of the system in complete format with ''the day of the week'', ''the day of the month'', ''the month'', ''the year'', ''the hour'', ''the minutes'' and ''the seconds'' -  not immediately available on the Word. It's better edit deleting and moving data than inserting with several commands." & Chr(10) & _
                "For sample: " & Chr(10) & _
                "Friday, August 23, 2002 - 17:49:12 -"
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool4_Lb.Caption
    If T4_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool4_Lb.Caption) = 1 Then T4_ChB = True
End Sub

Private Sub Image5_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para, com um simples clique, inserir no documento ativo o conte|fffd|do ora na ''|fffd|rea de Transfer|fffd|ncia'' do Windows em texto puro, n|fffd|o formatado. Assim, pode-se copiar a partir do Word ou de qualquer outro aplicativo e colar S|fffd| O TEXTO. Isto n|fffd|o |fffd| poss|fffd|vel no Word de forma imediata com um simples clique. Apenas na vers|fffd|o 2002(XP), as ferramentas inteligentes vieram facilitar essa a|fffd||fffd|o." & Chr(10) & Chr(10) & _
                "Al|fffd|m disso, se a tecla Ctrl (ou Shift) estiver pressionada, S|fffd| A FORMATA|fffd||fffd|O ser|fffd| aplicada na sele|fffd||fffd|o. O Word n|fffd|o vem com uma ferramenta pronta para esta funcionalidade interna e externamente a partir da ''|fffd|rea de Transfer|fffd|ncia'' do Windows, apenas internamente algo semelhante pode ser feito usando a ferramenta Pincel de Formata|fffd||fffd|o."
    Else
        sMsg1 = "This is a tool to insert in the active document, with only one click, the contents now on the Windows clipboard as pure text, not formatted. Thus, you can copy from Word or other application and paste ONLY THE TEXT. This is not possible on the Word of immediate way with a simple click. Only on the 2002(XP) version, smart tags came to facilitate this action." & Chr(10) & Chr(10) & _
                "In addition, if the Ctrl (or Shift) key is pressed, ONLY THE FORMAT will be applied in the selection. The Word hasn't a built-in tool for this functionality internally and externally from Windows clipboard, only internally something like this can be done using the Format Painter tool."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool5_Lb.Caption
    If T5_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool5_Lb.Caption) = 1 Then T5_ChB = True
End Sub

Private Sub Image6_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para ativar a pasta onde o documento ativo est|fffd| salvo. A pasta ativa |fffd| aquela que o Word sugere inicialmente para abrir ou salvar documentos ao clicar nos comando Abrir ou Salvar Como respectivamente." & Chr(10) & _
                "Isto |fffd| |fffd|til porque, ao se abrir um documento a partir do Explorer ou da Lista de Arquivos Usados Recentemente (Menu Arquivo), o Word n|fffd|o ativa a pasta onde o documento est|fffd| salvo. E muitas vezes se necessita abrir outros documentos ou lincar o documento aberto com outros na mesma pasta."
    Else
        sMsg1 = "This is a tool to activate the folder where the active document is saved. The active folder is that where the Word suggests originally to open or save documents when click on the Open or Save As commands." & Chr(10) & _
                "This is useful because, when you open a document from Explore or from Recently Used File List (File menu), the Word doesn't active the folder where the document is saved. And many times it is necessary to open other documents or link the active document with other on the same folder."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool6_Lb.Caption
    If T6_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool6_Lb.Caption) = 1 Then T6_ChB = True
End Sub

Private Sub Image7_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para imprimir uma ou mais folhas selecionadas a partir de uma caixa de listagem da seguinte maneira:" & Chr(10) & Chr(10) & _
                "1 - Cada folha (matriz, clich|fffd|, molde para c|fffd|pia) ser|fffd| impressa em frente e verso com 4 p|fffd|ginas do livro conforme os n|fffd|meros indicados em cada folha;" & Chr(10) & Chr(10) & _
                "2 - Ao cortar as folhas ao meio, cada metade forma uma folha do livro, podendo ser encadernadas em uma sequ|fffd|ncia correta de 1 at|fffd| 804 p|fffd|ginas;" & Chr(10) & Chr(10) & _
                "3 - O tamanho da folha deve ser o A4, assim o livro, quando pronto e encapado, fica com 15 cm de largura por 21,5 cm de altura. O manual de 250 p|fffd|ginas do CPAP|fffd| foi impresso neste formato. Veja foto em htpp://cpap.com.br;" & Chr(10) & Chr(10) & _
                "4 - Voc|fffd| ser|fffd| alertado para repor as folhas na impressora conforme a quantidade indicada de cada vez;" & Chr(10) & Chr(10) & _
                "5 - Podem ser impressas v|fffd|rias folhas de uma vez, mas o ideal |fffd| imprimir em torno de cinco de cada vez, ou seja, 20 p|fffd|ginas do livro de cada vez, pois, se houver falha na impress|fffd|o, fica f|fffd|cil retomar a sequ|fffd|ncia de impress|fffd|o;" & Chr(10) & Chr(10) & _
                "6 - Se houver falha e quiser reimprimir uma p|fffd|gina espec|fffd|fica do livro, assinale a op|fffd||fffd|o ''Parar antes de cada p|fffd|gina (Op|fffd||fffd|o para saltar)'';" & Chr(10) & Chr(10) & _
                "7 - Para configurar margens e tamanho do papel das p|fffd|ginas antes de imprimir, selecione a op|fffd||fffd|o ''Configurar P|fffd|gina (Papel, Margens...)''. Em meu site h|fffd| um modelo de livro pronto, LIVRO.DOT, usado para impress|fffd|o do manual do CPAP."
    Else
        sMsg1 = "This is a tool to print one or more selected folios from of a list box in this following way:" & Chr(10) & Chr(10) & _
                "1 - Each folio (clich|fffd|, shape, mould for copy) will be print in front and verse with 4 pages of the book as the indicated numbers in each folio;" & Chr(10) & Chr(10) & _
                "2 - When you cut the folio in the middle, each half forms a page of the book that can be to bind in a correct sequence from 1 up to 804 pages;" & Chr(10) & Chr(10) & _
                "3 - The paper size must be the A4, as the book, when ready and cloaked, be with 15.0 cm of width by 21.5 cm of height. The CPAP|fffd| handbook of 250 pages was printed in this format. See its photo at http://cpap.com.br;" & Chr(10) & Chr(10) & _
                "4 - You will be to alert to replace the folio in the printer as each time indicated quantity;" & Chr(10) & Chr(10) & _
                "5 - Can be printed several folios for time, but the better is print about five at each time, or be, 20 book pages at each time, because, if there will be fail in the print, be easy to resume the print sequence;" & Chr(10) & Chr(10) & _
                "6 - If there will be fail and you want to reprint a specific page of the book, select ''Stop before of each page (Option to skip)'' option;" & Chr(10) & Chr(10) & _
                "7 - To setup margins and paper size of the pages before print, select ''Page Setup (Paper, Margins...)'' option. On my site there is a template of a ready book, LIVRO.DOT, used to print CPAP|fffd| handbook."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool7_Lb.Caption
    If T7_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool7_Lb.Caption) = 1 Then T7_ChB = True
End Sub

Private Sub Image8_Click()
    If IsPortg Then
        sMsg1 = "Esta |fffd| uma ferramenta para definir em um dicion|fffd|rio na Web a palavra selecionada no documento ou pr|fffd|xima ao cursor." & Chr(10) & _
                "Se a palavra estiver formatada no documento como um texto em portugu|fffd|s, a defini|fffd||fffd|o ser|fffd| feita no iDicion|fffd|rio Aulete. Se formatada como um texto em ingl|fffd|s, a defini|fffd||fffd|o ser|fffd| feita no Dictionary.com. Como o c|fffd|digo |fffd| aberto, voc|fffd| poder|fffd| ainda inserir ou sugerir outras l|fffd|nguas ou outros dicion|fffd|rios on-line."
    Else
        sMsg1 = "This is a tool to define in a Web dictionary the word selected in the document or next to the cursor. " & Chr(10) & _
                "If the word in the document is formatted as a text in English, the definition will be in Dictionary.com. If it is formatted as a text in Portuguese, the definition will be in iDicion|fffd|rio Aulete. As the code is open, you can also insert or suggest other languages or other online dictionaries."
    End If
    MyMsgBox sMsg1, 1, "OrlandoTools - " & Tool8_Lb.Caption
    If T8_ChB = False Then If MyMsgBox(IIf(IsPortg, "Seleciona para instalar?", "Select to install?"), 2, "OrlandoTools - " & Tool8_Lb.Caption) = 1 Then T8_ChB = True
End Sub


Private Sub Tool1_Lb_Click(): Image1_Click: End Sub
Private Sub Tool2_Lb_Click(): Image2_Click: End Sub
Private Sub Tool3_Lb_Click(): Image3_Click: End Sub
Private Sub Tool4_Lb_Click(): Image4_Click: End Sub
Private Sub Tool5_Lb_Click(): Image5_Click: End Sub
Private Sub Tool6_Lb_Click(): Image6_Click: End Sub
Private Sub Tool7_Lb_Click(): Image7_Click: End Sub
Private Sub Tool8_Lb_Click(): Image8_Click: End Sub

Private Sub Instal_Bt_Click()
    If Not (T1_ChB.Value Or T2_ChB.Value Or T3_ChB.Value Or T4_ChB.Value Or T5_ChB.Value Or T6_ChB.Value Or T7_ChB.Value) Then
        UnInstal_Bt_Click
        Exit Sub
    End If

    If IsPortg Then
        sMsg1 = "CONTRATO DE LICEN|fffd|A DE USO:" & vbCrLf & _
                "Antes de acionar o bot|fffd|o OK para efetivar a instala|fffd||fffd|o, voc|fffd| deve ler e concordar com alguns termos e condi|fffd||fffd|es abaixo relacionados. Caso n|fffd|o concorde ou n|fffd|o se enquadre com algum destes termos e condi|fffd||fffd|es, acione o bot|fffd|o Cancelar para suspender a instala|fffd||fffd|o." & vbCrLf & _
                "1 - Voc|fffd| se compromete a N|fffd|O distribuir este utilit|fffd|rio, mas agrade|fffd|o recomenda|fffd||fffd|es a amigos para uma visita ao meu site em http://cpap.com.br/orlando/ (veja link no canto esquerdo inferior deste alerta) onde eles mesmos podem baixar este e outros;" & vbCrLf & _
                "2 - Embora n|fffd|o preste suporte, |fffd| bem vindo qualquer email com sugest|fffd|es para melhoramentos, mas n|fffd|o espere resposta, pelo menos de imediato. Email de agradecimento para alimenta|fffd||fffd|o do ego tamb|fffd|m |fffd| bem vindo, afinal est|fffd| |fffd| a |fffd|nica recompensa pelas horas, neur|fffd|nios e vista despendidos frente ao computador;" & vbCrLf & _
                "3 - Voc|fffd| deve ter baixado (download) o arquivo diretamente de meu site em http://cpap.com.br/orlando/ (veja link no canto esquerdo inferior deste alerta)  e que o tamanho do arquivo em bytes em seu computador corresponde ao descrito no site. Isto |fffd| um importante ind|fffd|cio de que o arquivo n|fffd|o foi alterado por v|fffd|rus, mas s|fffd| um ind|fffd|cio, pois o seu sistema eventualmente j|fffd| pode conter v|fffd|rus ou o v|fffd|rus pode inteligentemente ter conservado o tamanho original do arquivo;" & vbCrLf & _
                "4 - Este utilit|fffd|rio |fffd| oferecido gratuitamente para pessoas f|fffd|sicas em meu site tal como est|fffd| sem nenhum tipo de garantia, n|fffd|o cabendo nenhuma reclama|fffd||fffd|o de sua parte sobre suporte e preju|fffd|zos de qualquer natureza no uso ou abuso do mesmo;" & vbCrLf & _
                "5 - Voc|fffd| assume todos os riscos resultantes do uso ou do desempenho deste utilit|fffd|rio e de qualquer servi|fffd|o de suporte;" & vbCrLf & _
                "6 - Na extens|fffd|o m|fffd|xima permitida pela legisla|fffd||fffd|o aplic|fffd|vel, me isento de todas as condi|fffd||fffd|es e garantias relacionadas a:  comercializa|fffd||fffd|o, adequa|fffd||fffd|o a uma finalidade espec|fffd|fica, aus|fffd|ncia de v|fffd|rus, respostas e resultados completos e corretos e aus|fffd|ncia de esfor|fffd|o de aprimoramento;" & vbCrLf & _
                "7 - Na extens|fffd|o m|fffd|xima permitida pela legisla|fffd||fffd|o aplic|fffd|vel, em nenhuma hip|fffd|tese eu serei respons|fffd|vel por quaisquer danos especiais, incidentais, indiretos, punitivos ou consequenciais (incluindo, sem limita|fffd||fffd|es, danos por: lucros cessantes, perda de informa|fffd||fffd|es confidenciais ou outras, interrup|fffd||fffd|o nos neg|fffd|cios, danos pessoais, perda de privacidade, falha no cumprimento de qualquer obriga|fffd||fffd|o (inclusive de boa f|fffd| e com cuidados razo|fffd|veis), neglig|fffd|ncia e qualquer outra perda financeira ou de qualquer natureza) resultantes do ou de qualquer forma relacionados com o uso ou inabilidade no uso deste utilit|fffd|rio;" & vbCrLf & _
                "8 - Caso a legisla|fffd||fffd|o vigente n|fffd|o permita a total isen|fffd||fffd|o acima descrita, fica ent|fffd|o minha responsabilidade limitada ao valor efetivamente pago por voc|fffd| a mim por este utilit|fffd|rio ou R10,00 (dez reais) em moeda brasileira o que for maior;" & vbCrLf & _
                "9 - Como j|fffd| frisei acima, a gratuidade deste utilit|fffd|rio se destina exclusivamente para pessoas f|fffd|sicas. Pessoas jur|fffd|dicas, sejam p|fffd|blicas ou privadas, devem adquirir uma licen|fffd|a de uso. Favor entrar em contato clicando no email orlando@cpap.com.br no canto direito inferior deste alerta;" & vbCrLf & _
                "10 - Fora das condi|fffd||fffd|es acima descritas, n|fffd|o |fffd| permitida a utiliza|fffd||fffd|o, a reprodu|fffd||fffd|o, a modifica|fffd||fffd|o ou a distribui|fffd||fffd|o n|fffd|o autorizada no todo e de partes  deste utilit|fffd|rio, estando sujeito |fffd|s penalidades da lei em vigor sobre direitos autorais. Copyright by Francisco Orlando Magalh|fffd|es Filho. Todos os direitos reservados."
        sMsg2 = "OrlandoWordTools     (Contrato de Licen|fffd|a de Uso)"
    Else
        sMsg1 = "USE LICENSE AGREEMENT:" & vbCrLf & _
                "Before to action the OK button to effective the installation, you have to read and concord with some terms and conditions that will be listed below. If you do not concord or do not fit with some of this terms and conditions, action the Cancel button to suspend the installation." & vbCrLf & _
                "1 - You commit yourself with not deliver this utility, but I thank recommendations to your friends to visit my site at http://cpap.com.br/orlando/ (see link at left down corner of this alert) where they same can download this and others ones;" & vbCrLf & _
                "2 - Although I don't offer support, it is welcome any email with suggestions to improvements, but don't wait reply, at least of immediate. Email with thanks to feed the ego is welcome too, after all this is the unique reward by hours, neurons and eyes wasted in front of the computer;" & vbCrLf & _
                "3 - You have to have downloaded the file directly from my site at http://cpap.com.br/orlando/ (see link at left down corner of this alert) and that file size in bytes on your computer correspond with described on site. This is a important indication that the file wasn't changed by virus, but only an indication, since your system eventually already can contain virus or the virus can have preserved the original file size;" & vbCrLf & _
                "4 - This utility is offered freely for home user at my site AS IS without any warranty, do not fit any claim from you about support and loss of any kind in use or abuse of the same;" & vbCrLf & _
                "5 - You assume all consequent risks of the use or of the performance of this utility and of the any support service;" & vbCrLf & _
                "6 - In maximum extension allowed by applicable legislation, I absolve myself of all the conditions and warranties related with: commercialization, adequacy to a specific purpose, virus absence, complete and correct replies, complete and correct results and effort improvement absence;" & vbCrLf & _
                "7 - In maximum extension allowed by applicable legislation, in any hypothesis I will be responsible by any special, incidental, indirect, punitive or consequential harms (including, without limitations, harms by: ceasing profits, loss of confidential data or others, interruption in businesses, personal harms, loss of privacy, fault in the fulfillment of any obligation (inclusively of good faith and with reasonable attendances), negligence and any other financial loss or of any kind) resulting of or any form related with the use or  inabilities of the use this utility;" & vbCrLf & _
                "8 - Case the current legislation do not allow the total immunity above written, it stays then my responsibility limited to the value effectively paid by you to me for this utility or R$ 10,00 (ten reais) in Brazilian currency what will be the larger;" & vbCrLf & _
                "9 - How I already emphasize above, the free of charge of this utility is exclusively to home users. Public or private companies have to acquire a use license. Please contact clicking orlando@cpap.com.br email in the right down corner of this alert;" & vbCrLf & _
                "10 - Outside above written conditions, it is not allowed the unauthorized utilization, reproduction, modification or distribution of the whole and parts of this utility, being subject to current law penalty about international author rights. Copyright by Francisco Orlando Magalh|fffd|es Filho. All rights reserved."
        sMsg2 = "OrlandoWordTools     (Use License Agreement)"
    End If
    MyMsgBox sMsg1, 2, sMsg2
    If lButtonPress = 2 Then Exit Sub
    lButtonPress = 1
    Hide
End Sub

Sub UnInstal_Bt_Click()
    If IsPortg Then
        sMsg1 = "O programa verificar|fffd| uma instala|fffd||fffd|o anterior, e ela ser|fffd| devidamente removida. OK?"
    Else
        sMsg1 = "The program will verify a previous installation, and it will be duly removed. OK?"
    End If
    MyMsgBox sMsg1, 2, "OrlandoTools - Desinstala|fffd||fffd|o"
    If lButtonPress = 2 Then
        lButtonPress = 3
    Else
        lButtonPress = 2
        Hide
    End If
End Sub

Private Sub Cancel_Bt_Click()
    lButtonPress = 3
    Hide
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = 0 Then lButtonPress = 3
End Sub

Private Sub Email_Lb_Click()
    If Email_Lb.MousePointer = fmMousePointerHourGlass Then Exit Sub
    Email_Lb.MousePointer = fmMousePointerHourGlass
    Email_Lb.ForeColor = &H80FF&
    SendEMailByURL "orlando@cpap.com.br", IIf(IsPortg, "Informa|fffd||fffd|es sobre OrlandoWordTools", "Information about OrlandoWordTools"), EmlMsg
    Email_Lb.MousePointer = fmMousePointerCustom
End Sub

Private Sub HomePage_Lb_Click()
    If HomePage_Lb.MousePointer = fmMousePointerHourGlass Then Exit Sub
    HomePage_Lb.MousePointer = fmMousePointerHourGlass
    HomePage_Lb.ForeColor = &H80FF&

    'A vantagem do Shell |fffd| poder acionar Start(Dos) oculto (Falha no Win2000)
    'Shell "Start http://cpap.com.br/orlando/", vbHide
    'MyWait 10

    On Error Resume Next
    ThisDocument.FollowHyperlink "http://cpap.com.br/orlando/" & IIf(IsPortg, "WordToolsMais.asp?IdC=Ajuda", "WordToolsMore.asp?IdC=Help"), , True
    If Err.Number <> 0 Then MsgBox Err.Description

    HomePage_Lb.MousePointer = fmMousePointerCustom
End Sub

Attribute VB_Name = "FormOrlandoTool0"
Attribute VB_Base = "0{5D82CBC1-C2B8-4F5E-8B48-8AACC569FD88}{220BAA5C-640D-45BF-8C29-A49D623E516D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Public EmailSubj As String
Public HomePageUrl As String
Public lBut As Long
Public Xpos As Long
Public Ypos As Long

Private Sub HomePage_Lb_Click()
    If HomePage_Lb.MousePointer = fmMousePointerHourGlass Then Exit Sub
    HomePage_Lb.MousePointer = fmMousePointerHourGlass
    HomePage_Lb.ForeColor = &H80FF&
    On Error Resume Next
    ThisDocument.FollowHyperlink HomePageUrl, , True
    If Err.Number <> 0 Then MsgBox Err.Description
    HomePage_Lb.MousePointer = fmMousePointerCustom
End Sub

Private Sub Email_Lb_Click()
    If Email_Lb.MousePointer = fmMousePointerHourGlass Then Exit Sub
    Email_Lb.MousePointer = fmMousePointerHourGlass
    Email_Lb.ForeColor = &H80FF&
    SendEMailByURL Email_Lb.ControlTipText, EmailSubj, EmlMsg
    Email_Lb.MousePointer = fmMousePointerCustom
End Sub

Private Sub OK_Bt_Click()
    lButtonPress = 1
    Hide
End Sub

Private Sub Cancel_Bt_Click()
    lButtonPress = 2
    Hide
End Sub

Private Sub Ignore_Bt_Click()
    lButtonPress = 3
    Hide
End Sub

Private Sub UserForm_Activate()
    Dim CountLines As Long
    Dim Lins
    Dim l As Long

    With Alert_Tb
        .Width = 284
        'Lins = Split(.Text, vbCrLf)
        Lins = MySplit(.Text, vbCrLf)
        For l = 0 To UBound(Lins)
            CountLines = CountLines + 1 + Int(Len(Lins(l)) / 75)
        Next
        .Height = (1 + CountLines) * 12
        If .Height > 16 * 12 Then
            .Height = 15 * 12
            .SpecialEffect = fmSpecialEffectSunken
            .SetFocus
            .SelStart = 0
        End If
    End With

    Icon_Lb.Caption = IIf(lBut <> 1, "?", "i")
    Cancel_Bt.Visible = lBut <> 1
    Ignore_Bt.Visible = lBut = 3

    OK_Bt.Caption = IIf(lBut = 3, IIf(IsPortg, "Sim", "Yes"), "OK")
    Cancel_Bt.Caption = IIf(lBut = 3, IIf(IsPortg, "N|fffd|o", "No"), IIf(IsPortg, "Cancelar", "Cancel"))
    Ignore_Bt.Caption = IIf(IsPortg, "Ignorar", "Ignore")

    OK_Bt.Top = Alert_Tb.Top + Alert_Tb.Height + 5
    Cancel_Bt.Top = OK_Bt.Top
    Ignore_Bt.Top = OK_Bt.Top
    HomePage_Lb.Top = OK_Bt.Top + 7.5
    Email_Lb.Top = HomePage_Lb.Top
    Email_Lb.Left = Width - Email_Lb.Width - (Width - InsideWidth) - 4      'Email_Lb.Left = Width - Email_Lb.Width - 8    'Em COM add-in |fffd| preciso transformar width e height em Twips
    Height = (HomePage_Lb.Top + OK_Bt.Height) + (Height - InsideHeight) - 1     'Height = HomePage_Lb.Top + OK_Bt.Height + (Height - InsideHeight - (Width - InsideWidth) / 2) + 2    'Entre parentese: altura da barra de t|fffd|tulo(caption)

    If lBut = 1 Then OK_Bt.Left = 135
    If lBut = 2 Then OK_Bt.Left = 90: Cancel_Bt.Left = 180
    If Xpos <> 0 Then Left = Xpos
    If Ypos <> 0 Then Top = Ypos
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    If CloseMode = 0 Then lButtonPress = IIf(Cancel_Bt.Visible, 2, 1)
End Sub
Attribute VB_Name = "FormOrlandoTool7"
Attribute VB_Base = "0{73850FF9-F04D-4B44-9555-FFD042250EBB}{9F14949E-1577-4187-9DC5-B7D022907F4A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub PageSetup_ChB_Click()
    If vEnableEvents = False Then Exit Sub
    vEnableEvents = False
    PageSetup_ChB.Value = False
    vEnableEvents = True

    If IsPortg Then
        sMsg1 = "A p|fffd|gina do documento ativo ser|fffd| devidamente configurada para a impress|fffd|o de manual ou livro. Depois o documento ser|fffd| exibido em modo de Visualizar Impress|fffd|o para voc|fffd| verificar e editar. OK?"
        sMsg2 = "OrlandoTools - Imprimir Livro - Configura P|fffd|gina"
    Else
        sMsg1 = "The active document page will be duly set up for manual or book print. After the document will be exhibited in Print Preview mode for you verify and edit. OK?"
        sMsg2 = "OrlandoTools - Print Book - Page Setup"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    Hide
    lButtonPress = 0

    Application.DisplayAlerts = False
    WordBasic.FilePageSetup PaperSize:="9", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="1,74 cm", RightMargin:="16,85 cm", Gutter:="0 cm", PageWidth:="29,70 cm", PageHeight:="21 cm", Orientation:=1, ApplyPropsTo:=4
    'WordBasic.FilePageSetup PaperSize:="5", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="1,74 cm", RightMargin:="22,15 cm", Gutter:="0 cm", PageWidth:="35,56 cm", PageHeight:="21,59 cm", Orientation:=1, ApplyPropsTo:=4 'A9 mas usando papel legal
    Application.DisplayAlerts = True
    ActiveDocument.PrintPreview
End Sub

Private Sub OK_Bt_Click()
    Hide
    lButtonPress = 1
End Sub

Private Sub Cancel_Bt_Click()
    Hide
    lButtonPress = 0
End Sub

Private Sub Help_Bt_Click()
    If IsPortg Then
        sMsg1 = "Ao acionar OK, a folha selecionada na caixa de listagem e as seguintes, de acordo com a quantidade indicada logo abaixo, ser|fffd|o impressas assim:" & Chr(10) & Chr(10) & _
                "1 - Cada folha (matriz, clich|fffd|, molde para c|fffd|pia) ser|fffd| impressa em frente e verso com 4 p|fffd|ginas do livro conforme os n|fffd|meros indicados em cada folha;" & Chr(10) & Chr(10) & _
                "2 - Ao cortar as folhas ao meio, cada metade forma uma folha do livro, podendo ser encadernadas em uma sequ|fffd|ncia correta de 1 at|fffd| 804 p|fffd|ginas;" & Chr(10) & Chr(10) & _
                "3 - O tamanho da folha deve ser o A4, assim o livro, quando pronto e encapado, fica com 15 cm de largura por 21,5 cm de altura. O manual de 250 p|fffd|ginas do CPAP|fffd| foi impresso neste formato;" & Chr(10) & Chr(10) & _
                "4 - Voc|fffd| ser|fffd| alertado para repor as folhas na impressora conforme a quantidade indicada de cada vez;" & Chr(10) & Chr(10) & _
                "5 - Podem ser impressas v|fffd|rias folhas de uma vez, mas o ideal |fffd| imprimir em torno de cinco de cada vez, ou seja, 20 p|fffd|ginas do livro de cada vez, pois, se houver falha na impress|fffd|o, fica f|fffd|cil retomar a sequ|fffd|ncia de impress|fffd|o;" & Chr(10) & Chr(10) & _
                "6 - Se houver falha e quiser reimprimir uma p|fffd|gina espec|fffd|fica do livro, assinale a op|fffd||fffd|o ''Parar antes de cada p|fffd|gina (Op|fffd||fffd|o para saltar)'';" & Chr(10) & Chr(10) & _
                "7 - Para configurar margens e tamanho do papel das p|fffd|ginas antes de imprimir, selecione a op|fffd||fffd|o ''Configurar P|fffd|gina (Papel, Margens...)''. Em meu site h|fffd| um modelo de livro pronto, LIVRO.DOT, usado para impress|fffd|o do manual do CPAP."
        sMsg2 = "OrlandoTools - Imprimir Livro - Ajuda"
    Else
        sMsg1 = "When act OK button, the selected folio on the list box and the followings, according with the quantity indicated soon below of the list box, will be print like this:" & Chr(10) & Chr(10) & _
                "1 - Each folio (clich|fffd|, shape, mould for copy) will be print in front and verse with 4 pages of the book as the indicated numbers in each folio;" & Chr(10) & Chr(10) & _
                "2 - When you cut the folio in the middle, each half forms a page of the book that can be to bind in a correct sequence from 1 up to 804 pages;" & Chr(10) & Chr(10) & _
                "3 - The paper size must be the A4, as the book, when ready and cloaked, be with 15.0 cm of width by 21.5 cm of height. The CPAP|fffd| handbook of 250 pages was printed in this format;" & Chr(10) & Chr(10) & _
                "4 - You will be to alert to replace the folio in the printer as each time indicated quantity;" & Chr(10) & Chr(10) & _
                "5 - Can be printed several folios for time, but the better is print about five at each time, or be, 20 book pages at each time, because, if there will be fail in the print, be easy to resume the print sequence;" & Chr(10) & Chr(10) & _
                "6 - If there will be fail and you want to reprint a specific page of the book, select ''Stop before of each page (Option to skip)'' option;" & Chr(10) & Chr(10) & _
                "7 - To setup margins and paper size of the pages before print, select ''Page Setup (Paper, Margins...)'' option. On my site there is a template of a ready book, LIVRO.DOT, used to print CPAP|fffd| handbook."
        sMsg2 = "OrlandoTools - Print Book - Help"
    End If
    MyMsgBox sMsg1, 1, sMsg2
End Sub

Private Sub UserForm_Initialize()
    If Not IsPortg Then
        Caption = "Print Folios with 4 Pages to Bind"
        PageSetup_ChB.Caption = "Page Setup (Paper, margins...)"
        PageList_Lb.Caption = "First folio to print:"
        Quant_Lb.Caption = "Folios to print (Selected and following):"
        Skip_ChB.Caption = "Pause before each page (Option to skip)"
        Cancel_Bt.Caption = "Cancel"
        Help_Bt.Caption = "Help"
        Alert_Lb.Caption = "Attention! The printer already must be with the folios and setup to A4 (210x297mm) and in the LANDSCAPE mode."
    End If
    vEnableEvents = True
End Sub
Attribute VB_Name = "ModInst"
'Passos pra criar novos comandos:
'- Criar m|fffd|dulo e o c|fffd|digo do comando em OrlandoWordTools.doc
'- Inserir o bot|fffd|o na barra de OrlandoWordTools.doc acionando
' o comando em OrlandoWordTools.doc
'- Ajustar c|fffd|digo na instala|fffd||fffd|o e desinstala|fffd||fffd|o
Option Explicit
Dim RestCfg As Boolean
Public appHostApp     'As PowerPoint.Application  'As Word.Application  'As Application falha no word

Public Sub InstalarMenu(bDirctUnInst As Boolean)
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    If Val(Application.Version) > 11 + 1 + 2 + 1 + 1 Then
        sMsg1 = IIf(IsPortg, "Esta vers|fffd|o do Word |fffd| incompat|fffd|vel com esta vers|fffd|o do OrlandoWordTools! Clique no link Ajuda, logo abaixo, para baixar uma nova vers|fffd|o compat|fffd|vel.", _
                "This version of Word is incompatible with this OrlandoWordTools version! Click the Help link below to download a new compatible version")
        sMsg2 = "OrlandoWordTools" & IIf(IsPortg, " - Falha!", " - Fail!")
        MyMsgBox sMsg1, 1, sMsg2
        Exit Sub
    End If

    If bDirctUnInst Then FormInst.UnInstal_Bt_Click Else FormInst.Show
    If lButtonPress = 2 Then DesInstalar
    If lButtonPress = 1 Then Instalar
    Unload FormInst

    If RestCfg Then
        If Val(Application.Version) < 11 + 1 Then SendKeys "{Left}+{TAB 3}{-}~" Else SendKeys "{TAB 2}{-}~"
        CommandBars.FindControl(ID:=3627).Execute
        If Val(Application.Version) < 11 + 1 Then SendKeys "{Left}+{TAB 3}{-}~" Else SendKeys "{TAB 2}{-}~"
        CommandBars.FindControl(ID:=3627).Execute
    End If
    If lButtonPress = 1 Or lButtonPress = 2 Then If InStr(1, ThisDocument.Path, "DOCtoEXE", vbTextCompare) > 0 Then ThisDocument.Close Else Application.Quit wdPromptToSaveChanges
End Sub

Public Sub Instalar()
    Dim vS As String
    Dim vD As String
    Dim cbc As CommandBar
    Dim c
    Dim cc
    Dim d As Document

    DesInstalar   'Desinstala vers|fffd|es anteriores
    If lButtonPress = 3 Then Exit Sub

    vS = ThisDocument.FullName
    vD = NormalTemplate.FullName

    'Copiando userform
    Application.OrganizerCopy vS, vD, "FormOrlandoTool0", wdOrganizerObjectProjectItems
    If FormInst.T7_ChB.Value Then Application.OrganizerCopy vS, vD, "FormOrlandoTool7", wdOrganizerObjectProjectItems

    'Copiando m|fffd|dulos
    Application.OrganizerCopy vS, vD, "OrlandoTool0", wdOrganizerObjectProjectItems
    If FormInst.T1_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool1", wdOrganizerObjectProjectItems
    If FormInst.T2_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool2", wdOrganizerObjectProjectItems
    If FormInst.T3_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool3", wdOrganizerObjectProjectItems
    If FormInst.T4_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool4", wdOrganizerObjectProjectItems
    If FormInst.T5_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool5", wdOrganizerObjectProjectItems
    If FormInst.T6_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool6", wdOrganizerObjectProjectItems
    If FormInst.T7_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool7", wdOrganizerObjectProjectItems
    If FormInst.T8_ChB.Value Then Application.OrganizerCopy vS, vD, "OrlandoTool8", wdOrganizerObjectProjectItems

    'Copiando ferramentas
    ThisDocument.Activate
    If IsPortg Then
        sMsg1 = "Posicionando os bot|fffd|es de comando:" & Chr(10) & Chr(10) & "OK  -  P|fffd|r em uma barra de ferramenta nova e exclusiva;" & Chr(10) & Chr(10) & "Cancelar - P|fffd|r os bot|fffd|es de comando diretamente na barra de menu para aproveitar o espa|fffd|o vazio |fffd| direita do menu Ajuda."
        sMsg2 = "OrlandoTools - Instala|fffd||fffd|o - Barra de Ferramentas"
    Else
        sMsg1 = "Placing the command buttons:" & Chr(10) & Chr(10) & "OK  -  Put in a new and exclusive Toolbar" & Chr(10) & Chr(10) & "Cancel - Place command buttons directly in the menu bar to use the empty space to the right of the Help menu"
        sMsg2 = "OrlandoTools - Installation - Toolbar"
    End If
    If Val(Application.Version) < 11 + 1 Then MyMsgBox sMsg1, 2, sMsg2 Else lButtonPress = 1
    If lButtonPress = 1 Then
        Set cbc = CommandBars.Add("OrlandoTools ", msoBarTop)
        cbc.Visible = True
    Else
        Set cbc = CommandBars("Menu Bar")
    End If

    If FormInst.T1_ChB.Value Then
        Set c = ThisDocument.CommandBars("OrlandoTools").Controls("Extenso")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Escrever n|fffd|mero por extenso", "Spell number (write out)")
        cc.OnAction = "OrlandoTool1.Extenso"
    End If
    If FormInst.T2_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("Marca1")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Marca 1", "Mark 1")

        Set c = CommandBars("OrlandoTools").Controls("Marca2")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Marca 2", "Mark 2")
    End If
    If FormInst.T3_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("LocalizarSel")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Texto selecionado, procurar pr|fffd|ximo", "Selected text, find next")
    End If
    If FormInst.T4_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("InserirData")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Inserir data e hora", "Insert Date and Hour")
    End If
    If FormInst.T5_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("ColarTexto")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Colar Especial: S|fffd| TEXTO ou S|fffd| FORMATA|fffd||fffd|O pressionando a tecla Shift", "Paste Special: ONLY TEXT or ONLY FORMAT pressing Shift key")
    End If
    If FormInst.T6_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("AtivarPasta")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Ativar pasta do documento ativo", "Activate folder of the active document")
    End If
    If FormInst.T7_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("ImprimirLivro")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Imprimir livro, manual...", "Print book, handbook...")
    End If
    If FormInst.T8_ChB.Value Then
        Set c = CommandBars("OrlandoTools").Controls("OnlineDic")
        Set cc = c.Copy(Bar:=cbc)
        cc.BeginGroup = c.BeginGroup
        cc.TooltipText = IIf(IsPortg, "Dicion|fffd|rio On-line", "Online Dictionary")
    End If

    cbc.Controls.Add Type:=msoControlButton, ID:=288   'Comando do Word para visualizar c|fffd|digo campos

    If lButtonPress = 1 Then
        For Each d In Documents
            d.Activate
            d.CommandBars("OrlandoTools ").Visible = True
        Next
    End If

    If Val(Application.Version) >= 11 Then NormalTemplate.Save: ThisDocument.Saved = True: Set appHostApp = Application: appHostApp.ActiveWindow.View.ReadingLayout = True   'In 2013 quit slowly in not ReadingLayout.
    If IsPortg Then
        sMsg1 = IIf(Err.Number <> 0, "Falha!", "Sucesso!" & IIf(Val(Application.Version) < 11 + 1, "", " Ver os bot|fffd|es de comando na Guia Suplementos da Ribbon."))
        sMsg2 = "OrlandoWordTools - Instalar"
    Else
        sMsg1 = IIf(Err.Number <> 0, "Fail!", "Success!" & IIf(Val(Application.Version) < 11 + 1, "", " See command buttons in the Ribbon Add-Ins Tab."))
        sMsg2 = "OrlandoWordTools - Install"
    End If
    MyMsgBox sMsg1, 1, sMsg2
End Sub

Sub DesInstalar()
    Dim c
    Dim d
    Dim vbc

    'Verificar se h|fffd| acesso a projetos de VBA
    On Error Resume Next: If Val(Application.Version) >= 11 Then Set appHostApp = Application: appHostApp.ActiveWindow.View.ReadingLayout = False    'In 2013 Organizer* methods isn't available in ReadingLayout.
    c = ThisDocument.VBProject.VBComponents.Count
    If Err.Number <> 0 Then
        If IsPortg Then
            sMsg1 = "Apenas para instalar ou desinstalar OrlandoWordTools, |fffd| necess|fffd|rio permitir o acesso ao projeto de Visual Basic. Depois a configura|fffd||fffd|o original ser|fffd| restaurada." & Chr(10) & Chr(10)
            If Val(Application.Version) < 11 + 1 Then
                sMsg1 = sMsg1 & "Indo ao Menu Ferramentas > Submenu Macros > Comando Seguran|fffd|a > Ficha Fontes confi|fffd|veis e assinalando a op|fffd||fffd|o ''Confiar no acesso ao projeto de Visual Basic''."
            Else
                sMsg1 = sMsg1 & "Indo ao Bot|fffd|o do Office > Bot|fffd|o Op|fffd||fffd|es do Word > Guia Centro de Seguran|fffd|a > Bot|fffd|o Configura|fffd||fffd|o de Seguran|fffd|a... > Guia Configura|fffd||fffd|o de Macro e assinalando a op|fffd||fffd|o ''Confiar no acesso ao modelo de objeto do projeto VBA''."
            End If
            sMsg2 = "Acesso ao Projeto de Visual Basic"
        Else
            sMsg1 = "Only to install or uninstall OrlandoWordTools, it's necessary to allow the access to Visual Basic project. After, the original setting will be restored." & Chr(10) & Chr(10)
            If Val(Application.Version) < 11 + 1 Then
                sMsg1 = sMsg1 & "Going to Tools Menu > Macro Submenu > Security Command > Trusted Publishers Tab and selecting the option ''Trust access to Visual Basic Project''."
            Else
                sMsg1 = sMsg1 & "Going to Office Button > Word Options Button > Trust Center Tab > Trust Center Settings... Button > Macro Settings Tab and selecting the option ''Trust access to the VBA project object model''."
            End If
            sMsg2 = "Access to Visual Basic Project"
        End If
        c = lButtonPress
        MyMsgBox sMsg1, 2, sMsg2
        If lButtonPress = 2 Then
            lButtonPress = 3
            Exit Sub
        Else
            lButtonPress = c
            If Val(Application.Version) < 11 + 1 Then SendKeys "{Left}+{TAB 3}{+}~" Else SendKeys "{TAB 2}{+}~"
            CommandBars.FindControl(ID:=3627).Execute
            If Val(Application.Version) < 11 + 1 Then SendKeys "{Left}+{TAB 3}{+}~" Else SendKeys "{TAB 2}{+}~"
            CommandBars.FindControl(ID:=3627).Execute
            MyWait 0.1
            Err.Clear
            c = ThisDocument.VBProject.VBComponents.Count
            If Err.Number = 0 Then
                RestCfg = True
            Else
                Documents.Add DocumentType:=wdNewBlankDocument
                If ActiveWindow.View.SplitSpecial = wdPaneNone Then
                    ActiveWindow.ActivePane.View.Type = wdNormalView
                Else
                    ActiveWindow.View.Type = wdNormalView
                End If
                Selection.ParagraphFormat.RightIndent = CentimetersToPoints(10)
                Selection.TypeText Text:=IIf(IsPortg, "Falha! Ao tentar resolver isto:", "Fail! When trying to resolve this:")
                Selection.TypeParagraph
                Selection.TypeParagraph
                Selection.TypeText Text:=sMsg1
                Selection.TypeParagraph
                ActiveDocument.Saved = True
                If IsPortg Then
                    sMsg1 = "Veja a descri|fffd||fffd|o no documento abaixo e tente resolver antes de uma nova tentativa."
                    sMsg2 = "Falha!"
                Else
                    sMsg1 = "See the description in the below document and try to resolve before a new try."
                    sMsg2 = "Falha!"
                End If
                MyMsgBox sMsg1, 1, sMsg2
                lButtonPress = 3
                Exit Sub
            End If
        End If
    End If

    'Excluir ferramentas anteriores da barra de menu
    ThisDocument.CommandBars("OrlandoTools").Visible = True
    For Each d In Documents
        d.Activate
        d.CommandBars("OrlandoTools ").Visible = False
    Next
    Application.OrganizerDelete Source:=NormalTemplate.Name, Name:="OrlandoTools ", Object:=wdOrganizerObjectCommandBars
    On Error GoTo 0

    For Each c In CommandBars("Menu Bar").Controls
        If c.BuiltIn Then
            If c.ID = 288 Then c.Delete
        Else
            If InStr(1, c.OnAction, "OrlandoTool") > 0 Then c.Delete
        End If
    Next
    'Removendo vb m|fffd|dulos
    For Each vbc In NormalTemplate.VBProject.VBComponents
        If vbc.Name = "FormOrlandoTool0" _
                Or vbc.Name = "FormOrlandoTool7" _
                Or vbc.Name = "OrlandoTool0" _
                Or vbc.Name = "OrlandoTool1" _
                Or vbc.Name = "OrlandoTool2" _
                Or vbc.Name = "OrlandoTool3" _
                Or vbc.Name = "OrlandoTool4" _
                Or vbc.Name = "OrlandoTool5" _
                Or vbc.Name = "OrlandoTool6" _
                Or vbc.Name = "OrlandoTool7" _
                Or vbc.Name = "OrlandoTool8" Then
            If vbc.Type = 1 Or vbc.Type = 3 Then NormalTemplate.VBProject.VBComponents.Remove (vbc)
        End If
    Next

    If lButtonPress = 2 Then
        If Val(Application.Version) >= 11 Then NormalTemplate.Save: ThisDocument.Saved = True: Set appHostApp = Application: appHostApp.ActiveWindow.View.ReadingLayout = True   'In 2013 quit slowly in not ReadingLayout.
        If IsPortg Then
            sMsg1 = IIf(Err.Number <> 0, "Falha!", "Sucesso!")
            sMsg2 = "OrlandoWordTools - Desinstalar"
        Else
            sMsg1 = IIf(Err.Number <> 0, "Fail!", "Success!")
            sMsg2 = "OrlandoWordTools - Uninstall"
        End If
        MyMsgBox sMsg1, 1, sMsg2
        lButtonPress = 2
    End If
End Sub

Sub Sair()
    If ShiftDown Or CtrlDown Then
        ButtonLanguage False
        If MsgBox("OK  - Save edited and exit" & vbCrLf & vbCrLf & "Cancel - Edit now, unhiding all text", vbOKCancel, "Edit?") = vbOK Then
            ThisDocument.Save
        Else
            'EditarDOC
            ButtonLanguage False
            If Not ThisDocument.ProtectionType = wdNoProtection Then ThisDocument.Unprotect
            VBA.SendKeys "%{F11}"
            Exit Sub
        End If
    Else
        ThisDocument.Saved = True
    End If
    If InStr(1, ThisDocument.Path, "DOCtoEXE", vbTextCompare) = 0 Then Application.Quit wdPromptToSaveChanges Else On Error Resume Next: ThisDocument.Close
End Sub

Sub ButtonLanguage(Optional bLight As Boolean = False)
'Agora com uma p|fffd|gina para cada l|fffd|ngua n|fffd|o precisa mais ajustar bot|fffd|es, basta ativar a p|fffd|gina referente.
'bLight agora indica que deve ser ativada a p|fffd|gina da lingua detectada, se false usa a primeira
    On Error Resume Next: If Application.Visible = False Then Application.Visible = True    'Need in Office 365 because SplashScreen of expired and buy can hide.
    ThisDocument.Activate: Selection.HomeKey Unit:=wdStory    '    ThisDocument.Sheets(1).Range("A1").Select
    ThisDocument.Windows(1).WindowState = wdWindowStateMaximize
    If ActiveWindow.View.SplitSpecial = wdPaneNone Then
        ActiveWindow.ActivePane.View.Type = wdWebView
    Else
        ActiveWindow.View.Type = wdWebView
    End If
    ActiveWindow.ActivePane.View.Zoom.PageFit = wdPageFitTextFit

    If Not ThisDocument.ProtectionType = wdNoProtection Then ThisDocument.Unprotect
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070    'Application.LanguageSettings.LanguageID(msoLanguageIDUI) = 1046 Or Application.LanguageSettings.LanguageID(msoLanguageIDUI) = 2070    'Application.International(xlCountryCode) = 55
    Application.ScreenUpdating = False
    Selection.WholeStory
    If bLight Then
        Selection.Font.Hidden = True
        If IsPortg Then
            ThisDocument.Tables(3).Select
        Else
            ThisDocument.Tables(2).Select
        End If
    End If
    Selection.Font.Hidden = False
    ThisDocument.Activate: Selection.HomeKey Unit:=wdStory
    Selection.MoveDown Unit:=wdParagraph, Count:=IIf(IsPortg, 7, 4)
    'ThisDocument.Protect wdAllowOnlyFormFields    ' wdAllowOnlyReading 'Suspendi prote|fffd||fffd|o, porque links n|fffd|o estava funcionando
    If Val(Application.Version) >= 11 Then Set appHostApp = Application: appHostApp.ActiveWindow.View.ReadingLayout = True: appHostApp.ActiveWindow.View.ReadingLayoutAllowMultiplePages = False: appHostApp.ActiveWindow.View.ReadingLayoutActualView = False  'No 2013 wdWebView fica tela branca. Talvez este modo seja melhor para todos desde que passou a existir no 2003.
    Application.ScreenUpdating = True
End Sub

Sub Document_OpenCont()    'YourMacro
    Static bAvoidTwoFire As Boolean    'Avoid two fire from DOCtoEXE trying AutoMacro
    If Not bAvoidTwoFire Then bAvoidTwoFire = True Else Exit Sub

    ButtonLanguage True
    ThisDocument.Saved = True
    ThisDocument.UndoClear
End Sub


















Attribute VB_Name = "OrlandoTool0"
Option Explicit
#If VBA7 Then
    Public Declare PtrSafe Function GetKeyState32 Lib "user32" Alias "GetKeyState" (ByVal nKey As Long) As Integer
#Else
    Public Declare Function GetKeyState32 Lib "user32" Alias "GetKeyState" (ByVal vKey As Integer) As Integer
#End If

Public sMsg1 As String
Public sMsg2 As String

Public lButtonPress As Long
Public IsPortg As Boolean
Public vEnableEvents As Boolean

Public Function ShiftDown()
'Verif. se shift est|fffd| pressionada
    ShiftDown = (GetKeyState32(16) < 0)
End Function

Public Function CtrlDown()
'Verif se Ctrl est|fffd| pressionada
    CtrlDown = (GetKeyState32(17) < 0)
End Function

Public Sub DescarregaCampo()
    WordBasic.StartOfDocument
    WordBasic.ViewFieldCodes 1
Inicio:
    WordBasic.WW2_EditFind Find:="^19", WholeWord:=0, MatchCase:=0, _
            Direction:=1, Format:=0
    WordBasic.CharLeft 1
    WordBasic.CharRight 2
    WordBasic.WW2_Insert " "
    WordBasic.UpdateFields
    WordBasic.WW6_EditClear -1
    GoTo Inicio
End Sub

Public Sub ExcluirRodapes()
    Dim a$
Inicio:
    WordBasic.WW7_EditGoTo Destination:="r"
    WordBasic.CharRight 2, 1
    a$ = WordBasic.[Selection$]()
    If a$ = "1 " Then Exit Sub
    WordBasic.WW6_EditClear
    GoTo Inicio
End Sub

Public Function MyMsgBox(sPrompt As String, lBut As Long, sTitle As String, Optional Xpos As Long, Optional Ypos As Long)
    With FormOrlandoTool0
        .Caption = sTitle
        .Alert_Tb = sPrompt
        .lBut = lBut
        .Email_Lb.Caption = IIf(IsPortg, "E-mail", "Email")
        .Email_Lb.ControlTipText = "orlando@cpap.com.br"
        .EmailSubj = IIf(IsPortg, "Informa|fffd||fffd|es sobre OrlandoWordTools", "Information about OrlandoWordTools")
        .HomePage_Lb.Caption = IIf(IsPortg, "Ajuda", "Help")
        .HomePage_Lb.ControlTipText = "http://cpap.com.br/orlando/"
        .HomePageUrl = "http://cpap.com.br/orlando/" & IIf(IsPortg, "WordToolsMais.asp?IdC=Ajuda", "WordToolsMore.asp?IdC=Help")
        .Xpos = Xpos    '* Twips 'Twips usa em COM Add-in
        .Ypos = Ypos    '* Twips
        .Show  '1   '|fffd| preciso usar em COM add-in
    End With
    Unload FormOrlandoTool0
    MyMsgBox = lButtonPress
End Function

Sub MyWait(PauseSeg As Double)
    Dim Start
    Start = Timer
    Do While Timer < Start + PauseSeg
        DoEvents
    Loop
End Sub

Function ApplicationLanguage() As Long
    If Val(Application.Version) > 8 Then
        #If VBA6 Then
            ApplicationLanguage = Application.Language
        #End If
    Else
        ApplicationLanguage = NormalTemplate.LanguageID
    End If
End Function

Sub SendEMailByURL(Email As String, Subj As String, Msg As String)
    Dim sURL As String
    Dim Ret As Long
    Application.StatusBar = IIf(IsPortg, "Preparando Email. Aguarde...", "Preparing Email. Wait...")

    '& in Hex
    Subj = MyReplace(Subj, "&", "%26")
    Msg = MyReplace(Msg, "&", "%26")

    'Spaces in Hex
    Subj = MyReplace(Subj, " ", "%20")
    Msg = MyReplace(Msg, " ", "%20")

    'CRLF in Hex
    Msg = MyReplace(Msg, vbCrLf, "%0D%0A")

    sURL = "mailto:" & Email & "?subject=" & Subj & "&body=" & Msg

    'Launch Start command with sURL (Falha no Win2000)
    'Ret = Shell(Left("Start " & sURL, 460), vbHide)

    ThisDocument.FollowHyperlink Left(sURL, 457), , True
    MyWait 10
    Application.StatusBar = False
End Sub

Function MyReplace(vText As String, vTxtFind As String, vTxtRep As String)
'Word 6.0 VBA doesn't have Replace function
    Dim lPos As Long
    lPos = 1 - Len(vTxtRep)
vStart:
    lPos = InStr(lPos + Len(vTxtRep), vText, vTxtFind)
    If lPos = 0 Or vTxtFind = "" Then
        MyReplace = vText
        Exit Function
    End If
    vText = Left(vText, lPos - 1) & vTxtRep & Right(vText, Len(vText) - lPos - Len(vTxtFind) + 1)
    GoTo vStart
End Function

Function MySplit(ByVal sString As String, Optional sDelim As String, Optional lLimit As Long = -1, Optional bCompare As Long = 0) As Variant
'Excel 97 and Word6 haven't Split function
    Dim sSplitArr() As String
    Dim lPos As Long
    Dim i As Long
    Dim r As Long

    If sString = "" Or lLimit = 0 Then
        MySplit = Array()
        Exit Function
    End If

    If sDelim = "" Then
        ReDim Preserve sSplitArr(i)
        sSplitArr(i) = sString
    Else
        lPos = InStr(1, sString, sDelim, bCompare)
        If lPos = 0 Then
            ReDim Preserve sSplitArr(i)
            sSplitArr(i) = sString
        Else
            r = 2
            Do
                ReDim Preserve sSplitArr(i)
                If r > 1 Then
                    sSplitArr(i) = Left(sString, lPos - 1)
                    sString = Mid(sString, lPos + Len(sDelim))
                Else
                    sSplitArr(i) = sString
                    sString = ""
                End If
                lPos = InStr(1, sString, sDelim, bCompare)
                r = r - 1 - 1 * (lPos > 0)
                If lLimit <> -1 And i = lLimit - 1 Then
                    sSplitArr(i) = sSplitArr(i) & IIf(r > 0, sDelim & sString, "")
                    Exit Do
                End If
                i = i + 1
            Loop While r > 0
        End If
    End If
    MySplit = sSplitArr
End Function

Function EmlMsg() As String
    EmlMsg = ""
    EmlMsg = EmlMsg & IIf(IsPortg, "Prezado", "Dear") & " Orlando,"
    EmlMsg = EmlMsg & vbCrLf & vbCrLf
    EmlMsg = EmlMsg & IIf(IsPortg, "Gostaria...", "I would like...")
    EmlMsg = EmlMsg & vbCrLf & vbCrLf & vbCrLf & vbCrLf
    EmlMsg = EmlMsg & IIf(IsPortg, "Atenciosamente,", "Regards,") & vbCrLf & vbCrLf & vbCrLf

    EmlMsg = EmlMsg & "___" & vbCrLf
    EmlMsg = EmlMsg & Application.UserName & vbCrLf

    Dim WinVer As String
    Dim AppVer As String
    WinVer = Application.System.OperatingSystem & " " & Application.System.LanguageDesignation
    AppVer = ApplicationLanguage
    AppVer = IIf(AppVer = "1033", "English", IIf(AppVer = "1046" Or AppVer = "2070", "Portugu|fffd|s", "Language " & AppVer))
    AppVer = Application.Name & " " & Application.Version & " (" & AppVer & ")"
    EmlMsg = EmlMsg & WinVer & vbCrLf
    EmlMsg = EmlMsg & AppVer & vbCrLf
End Function

Attribute VB_Name = "OrlandoTool1"
Option Explicit

Public Sub Extenso()
    Dim sTextCapt As String
    Dim NumCapt As Variant
    Dim sd As String   'Separador de decimal
    Dim Fra|fffd|Tipo As Integer
    Dim UndNomeSing As String
    Dim UndNomePlur As String
    Dim UndMasc As Boolean
    Dim UmMil As Boolean
    Dim VirgEntrMilh As Boolean
    Dim bCont As Boolean
    Dim lLenSel As Long
    Dim UnidNomeMarc As Integer
    Dim i As Integer
    Dim sdPos As Integer
    Dim NumCaptExt As String
    Dim LangIDIsPort As Boolean
    Dim LangIDIsPortPt As Boolean
    Const UndCorrBrSing As String = "real"
    Const UndCorrBrPlur As String = "reais"
    Const UndCorrUSSing As String = "dollar"
    Const UndCorrUSPlur As String = "dollars"
    Const UndCorrPtSing As String = "euro"
    Const UndCorrPtPlur As String = "euros"

    On Error Resume Next
    If Selection Is Nothing Then Exit Sub
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    LangIDIsPort = Selection.LanguageID = 1046 Or Selection.LanguageID = 2070
    LangIDIsPortPt = Selection.LanguageID = 2070

    If Len(Selection.Text) < 2 Then
        'Ignora Espa|fffd|os
        Selection.Collapse wdCollapseEnd    'Eventualmente um espa|fffd|o ou at|fffd| o primeiro n|fffd|mero pode ter sido selecionado
        Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        Do While Selection.Text = " "
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        Loop
        bCont = True
        lLenSel = 1
        Do
            Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            If Left(Selection.Text, 1) = " " Then bCont = False
            If Left(Selection.Text, 2) = " $" Then bCont = True
            If Left(Selection.Text, 2) = " %" Then bCont = True
            If Left(Selection.Text, 2) = " #" Then bCont = True
            If Left(Selection.Text, 2) = " *" Then bCont = True
            If Left(Selection.Text, 2) = " |fffd|" Then bCont = True
            If Left(Selection.Text, 2) = " !" Then bCont = True
            If Left(Selection.Text, 2) = " &" Then bCont = True
            If Left(Selection.Text, 3) = "  $" Then bCont = True
            If Left(Selection.Text, 3) = "  %" Then bCont = True
            If Left(Selection.Text, 3) = "  #" Then bCont = True
            If Left(Selection.Text, 3) = "  *" Then bCont = True
            If Left(Selection.Text, 3) = "  |fffd|" Then bCont = True
            If Left(Selection.Text, 3) = "  !" Then bCont = True
            If Left(Selection.Text, 3) = "  &" Then bCont = True
            If Left(Selection.Text, 1) = Chr(13) Then bCont = False
            If Left(Selection.Text, 1) = Chr(9) Then bCont = False
            If Len(Selection.Text) = lLenSel Then Exit Do   'Indica in|fffd|cio do doc
            If Len(Selection.Text) > lLenSel + 1 Then   'Indica um salto em uma tabela
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                Exit Do
            End If
            lLenSel = Len(Selection.Text)
        Loop While bCont
        If bCont = False Then Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    End If
    sTextCapt = Selection.Text
    sTextCapt = MyReplace(sTextCapt, " ", "")
    sTextCapt = MyReplace(sTextCapt, Chr(160), "")

    'Extraindo nome da unidade, tipo de fra|fffd||fffd|o etc.
    'Os marcadores $, %, # e * sugerem o tipo de fra|fffd||fffd|o (1,2,3 e 5). 1 se ausente
    '|fffd| como $ tamb|fffd|m indica fra|fffd||fffd|o 1 de moeda, mas, se n|fffd|o houver unid sing, indica euro. E em
    'portg indic tamb|fffd|m a fra|fffd||fffd|o 5 tornando * desnecess|fffd|rio
    'Texto ap|fffd|s marcadores indica NomeUnidSing. Se %, NomeUnidSing=por cento
    'Texto ap|fffd|s marcadores e ap|fffd|s / indica NomeUnidPlur.
    'Um F no final do texto ref. nome da unidade indica Unid feminina
    'Uma , no final do texto indica para por v|fffd|rgula entre casas de milhar
    UnidNomeMarc = 0
    Fra|fffd|Tipo = 1
    UndNomeSing = ""
    UndNomePlur = ""
    UndMasc = True
    UmMil = IIf(LangIDIsPortPt, False, True)
    VirgEntrMilh = False

    If InStr(1, sTextCapt, "!") > 0 Then
        UmMil = False
        sTextCapt = Left(sTextCapt, InStr(1, sTextCapt, "!") - 1) & Right(sTextCapt, Len(sTextCapt) - InStr(1, sTextCapt, "!"))
    End If

    If InStr(1, sTextCapt, "&") > 0 Then
        VirgEntrMilh = True
        sTextCapt = Left(sTextCapt, InStr(1, sTextCapt, "&") - 1) & Right(sTextCapt, Len(sTextCapt) - InStr(1, sTextCapt, "&"))
    End If

    If InStr(1, sTextCapt, "$") > 0 Then
        UnidNomeMarc = InStr(1, sTextCapt, "$")
        Fra|fffd|Tipo = 1
    End If
    If UnidNomeMarc = 0 And InStr(1, sTextCapt, "|fffd|") > 0 Then
        UnidNomeMarc = InStr(1, sTextCapt, "|fffd|")
        Fra|fffd|Tipo = 1
    End If

    If UnidNomeMarc = 0 And InStr(1, sTextCapt, "%") > 0 Then
        UnidNomeMarc = InStr(1, sTextCapt, "%")
        Fra|fffd|Tipo = 2
    End If
    If UnidNomeMarc = 0 And InStr(1, sTextCapt, "#") > 0 Then
        UnidNomeMarc = InStr(1, sTextCapt, "#")
        Fra|fffd|Tipo = 3
    End If

    If InStr(1, sTextCapt, "*") > 0 Then
        UnidNomeMarc = InStr(1, sTextCapt, "*")
        Fra|fffd|Tipo = 5
    End If

    If UnidNomeMarc = 0 Then
        NumCapt = sTextCapt
        Fra|fffd|Tipo = 1
    Else
        NumCapt = Left(sTextCapt, UnidNomeMarc - 1)
        UndNomeSing = Right(sTextCapt, Len(sTextCapt) - UnidNomeMarc)

        If InStr(1, Right(UndNomeSing, 1), "@") > 0 Then
            UndMasc = False
            UndNomeSing = Left(UndNomeSing, Len(UndNomeSing) - 1)
        End If

        i = InStr(1, sTextCapt, "/") > 0
        If i > 0 Then
            UndNomePlur = Right(UndNomeSing, Len(UndNomeSing) - i)
            UndNomeSing = Left(UndNomeSing, i - 1)
        End If
    End If

    If Fra|fffd|Tipo = 2 And UndNomeSing = "" Then UndNomeSing = "%"
    If Fra|fffd|Tipo = 2 And UndNomeSing = "#" Then UndNomeSing = ""
    If UndNomeSing = "%" Then
        UndNomeSing = IIf(LangIDIsPort, "por cento", "percent")
        UndNomePlur = UndNomeSing
    End If
    If UndNomeSing = "" And InStr(1, sTextCapt, "|fffd|") > 0 Then
        UndNomeSing = "euro"
        UndNomePlur = "euros"
        If LangIDIsPort Then Fra|fffd|Tipo = 5
    End If

    If Fra|fffd|Tipo = 1 Or Fra|fffd|Tipo = 5 And UndNomeSing = "" Then
        'Depois de tudo, ainda n|fffd|o havendo unid e sendo fra|fffd||fffd|o de moeda, usar a corrente
        UndNomeSing = IIf(LangIDIsPort, IIf(LangIDIsPortPt, UndCorrPtSing, UndCorrBrSing), UndCorrUSSing)
        UndNomePlur = IIf(LangIDIsPort, IIf(LangIDIsPortPt, UndCorrPtPlur, UndCorrBrPlur), UndCorrUSPlur)
    End If

    If Not IsNumeric(NumCapt) Then
        If IsPortg Then
            sMsg1 = "A sele|fffd||fffd|o encontrada entre o cursor o primeiro espa|fffd|o antes n|fffd|o parece ser um n|fffd|mero v|fffd|lido!" & Chr(10) & Chr(10) & "Tentar assim mesmo?"
            sMsg1 = sMsg1 & Chr(10) & Chr(10) & "Ajuda: " & Chr(10)
            sMsg1 = sMsg1 & "Esta |fffd| uma ferramenta para escrever por extenso o n|fffd|mero selecionado ou captado entre o cursor e o espa|fffd|o imediatamente anterior. " & Chr(10) & _
                    "O n|fffd|mero captado |fffd| automaticamente formatado e descrito por extenso entre par|fffd|nteses logo em seguida em portugu|fffd|s, se o par|fffd|grafo tiver formato portugu|fffd|s, ou em ingl|fffd|s, se outros formatos." & Chr(10) & _
                    "Por padr|fffd|o o extenso tem como unidade e formato: o da moeda corrente no Brasil (Real), se o par|fffd|grafo tiver formato portugu|fffd|s do Brasil; o da moeda corrente em Portugal (Euro), se o par|fffd|grafo tiver formato portugu|fffd|s de Portugal; ou o da moeda corrente nos EUA (Dollar), se outros formatos. No entanto voc|fffd|, ao digitar diretamente no documento, pode interpor entre o n|fffd|mero e o cursor os seguintes modificadores e/ou o nome de uma outra unidade no singular/plural: " & Chr(10) & _
                    "  $ - descreve fra|fffd||fffd|o com centavos (Ideal para moeda);" & Chr(10) & _
                    "  % - descreve fra|fffd||fffd|o com v|fffd|rgula, zeros e extenso do inteiro restante (Ideal para percentagem);" & Chr(10) & _
                    "  # - descreve fra|fffd||fffd|o com d|fffd|cimos at|fffd| trilion|fffd|simos (Ideal para n|fffd|mero puro);" & Chr(10) & _
                    "  |fffd| - descreve fra|fffd||fffd|o com c|fffd|ntimos (Ideal para moeda Euro, mas centavos tamb|fffd|m pode ser usado);" & Chr(10) & _
                    "  @ - Indica unidade feminina (sempre na |fffd|ltima posi|fffd||fffd|o); " & Chr(10) & _
                    "  & - P|fffd|e v|fffd|rgula entre posi|fffd||fffd|o de milhar em vez da conjun|fffd||fffd|o e; " & Chr(10) & _
                    "  ! - Oculta 'um' ao escrever 'um mil'." & Chr(10) & _
                    "Exemplos: (Veja atr|fffd|s do cursor (|) e o resultado) " & Chr(10) & _
                    "  5,20| - 5,20 (cinco reais (euros em Portugal) e vinte centavos);" & Chr(10) & _
                    "  5,20$| - 5,20 (cinco reais (euros em Portugal) e vinte centavos); " & Chr(10) & _
                    "  5,20$iene| - 5,20 (cinco ienes e vinte centavos); " & Chr(10) & _
                    "  5,20|fffd|| - 5,20 (cinco euros e vinte c|fffd|ntimos); " & Chr(10) & _
                    "  5,20%| - 5,2 % (cinco v|fffd|rgula dois por cento);" & Chr(10) & _
                    "  5,20#| - 5,2 (cinco, e dois d|fffd|cimos);" & Chr(10) & _
                    "  5,201#real| - 5,201 (cinco reais e duzentos e um mil|fffd|simos de real);" & Chr(10) & _
                    "  5,201%real| - 5,201 (cinco v|fffd|rgula duzentos e um reais);" & Chr(10) & _
                    "  222,2#saca@| - 222,2 (duzentAS e vinte e duAS sacas e dois d|fffd|cimos de saca) etc."
            sMsg2 = "OrlandoTools - N|fffd|mero Inv|fffd|lido!"
        Else
            sMsg1 = "The find selection between the cursor and the first space before doesn't seem to be a valid number!" & Chr(10) & Chr(10) & "Try anyway?"
            sMsg1 = sMsg1 & Chr(10) & Chr(10) & "Help: " & Chr(10)
            sMsg1 = sMsg1 & "This is a tool to spell (written out) the selected or captured numbers between the cursor and the before immediately space." & Chr(10) & _
                    "The captured number is automatically formatted and written out between parenthesis afterwards immediately in English or in Portuguese, if the paragraph has Portuguese format." & Chr(10) & _
                    "By default the written out has as unity and format: the USA currency (Dollar), or the Brazil currency (Real), if the paragraph has Brazil Portuguese format; or the Portugal currency (Euro), if the paragraph has Portugal Portuguese format. But you, when typing directly in the document, can interpose between the number and the cursor the following modifiers (flags) and/or the name of the other unity in singular/plural: " & Chr(10) & _
                    "  $ - spell fraction with cents (Ideal for coin);" & Chr(10) & _
                    "  % - spell fraction with point, zeros and written out of the remainder integer (Ideal for percentage);" & Chr(10) & _
                    "  # - spell fraction with tenths until trillionths (Ideal for pure number);" & Chr(10) & _
                    "  * - spell fraction with pennies (Ideal for coin);" & Chr(10) & _
                    "  & - Put comma between thousand position in place of and conjunction; " & Chr(10) & _
                    "  ! - Omit 'one' when write 'one thousand'." & Chr(10) & _
                    "  |fffd| - instead $ indicates too Euro coin;" & Chr(10) & _
                    "Samples: (See behind of the cursor (|) and the result) " & Chr(10) & _
                    "  5.20| - 5.20 (five dollars and twenty cents);" & Chr(10) & _
                    "  5.20$| - 5.20 (five dollars and twenty cents); " & Chr(10) & _
                    "  5.20$yen| - 5.20 (five yens and twenty cents); " & Chr(10) & _
                    "  5.20|fffd|| - 5.20 (five euros and twenty cents); " & Chr(10) & _
                    "  5.20%| - 5.2 % (five point two percent);" & Chr(10) & _
                    "  5.20#| - 5.2 (five, and two tenths);" & Chr(10) & _
                    "  5.20*| - 5.20 (five dollars and twenty pennies); " & Chr(10) & _
                    "  5.201#dollar| - 5.201 (five dollars and two hundred one thousandths of dollar);" & Chr(10) & _
                    "  5.201%dollar| - 5.201 (five point two hundred one dollars)."
            sMsg2 = "OrlandoTools - Invalid Number!"
        End If
        MyMsgBox sMsg1, 2, sMsg2
        Exit Sub
    End If

    sd = Application.International(wdDecimalSeparator)
    sdPos = InStr(1, NumCapt, sd)
    If Fra|fffd|Tipo = 1 And Len(NumCapt) > 1 And sdPos = 0 Then
        If IsPortg Then
            sMsg1 = "N|fffd|o h|fffd| separador de centavos (''" & sd & "'') nesta sele|fffd||fffd|o!" & Chr(10) & Chr(10) & "Tentar assim mesmo?"
            sMsg2 = "OrlandoTools - Separador de Decimal?"
        Else
            sMsg1 = "There isn't cents separator (''" & sd & "'') in this selection!" & Chr(10) & Chr(10) & "Try anyway?"
            sMsg2 = "OrlandoTools - Decimal Separator?"
        End If
        If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    End If

    If LangIDIsPort Then
        NumCaptExt = fExtenso(NumCapt * 1, Fra|fffd|Tipo, UndNomeSing, UndNomePlur, UndMasc, UmMil, VirgEntrMilh)
    Else
        NumCaptExt = fSpellNumber(NumCapt * 1, Fra|fffd|Tipo, UndNomeSing, UndNomePlur, UndMasc, UmMil, VirgEntrMilh)
    End If

    If NumCaptExt <> "" Then
        Selection.Delete Unit:=wdCharacter, Count:=1
        NumCapt = NumCapt * 1
        If Fra|fffd|Tipo = 1 Or Fra|fffd|Tipo = 5 Then NumCapt = Format(NumCapt, "#,##0.00")
        If Fra|fffd|Tipo = 2 Then NumCapt = Format(NumCapt, "#,##0.0##############")
        If Fra|fffd|Tipo = 3 Then NumCapt = Format(NumCapt, IIf(NumCapt - Int(CDec(NumCapt)) = 0, "#,##0", "#,##0.0##############"))
        If LangIDIsPort Then
            If UndNomeSing = "por cento" And UndNomePlur = UndNomeSing Then NumCapt = NumCapt & " %"
        Else
            If UndNomeSing = "percent" And UndNomePlur = UndNomeSing Then NumCapt = NumCapt & " %"
        End If
        Selection.InsertAfter NumCapt & " (" & NumCaptExt & ") "
    End If
    Selection.Collapse Direction:=wdCollapseEnd
End Sub

'In|fffd|cio Mod1Extenso tal como desenvolvido no Excel
'"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
'" FUN|fffd||fffd|O:        fExtenso    (Spell number in Portuguese)
'"
'" AUTOR & DATA:  FCO ORLANDO MAGALH|fffd|ES FILHO  07 Nov 2002
'"                Microsoft MVP - Excel
'"                Santa Quit|fffd|ria-Ce - Brazil
'"
'" CONTATO:       orlando@cpap.com.br
'" WEB SITE:      http://cpap.com.br/orlando/
'"
'" DESCRI|fffd||fffd|O:     Escreve por extenso em portugu|fffd|s qualquer n|fffd|mero cardinal com
'"                ou sem fra|fffd||fffd|o com ou sem unidade masculina ou feminina. A par-
'"                te fracion|fffd|ria, se houver, pode ser descrita de tr|fffd|s maneiras.
'"
'" ARGUMENTOS:    Num - O n|fffd|mero cardinal com ou sem fra|fffd||fffd|o a descrever;
'"                  Maior n|fffd|mero permitido: 1 trilh|fffd|o menos 0.01 (999.999.999.999,99);
'"                  Menor fra|fffd||fffd|o sens|fffd|vel: 1 trilion|fffd|simo (0,000.000.000.001).
'"                Fra|fffd|Tipo - 1, 2, 3, 4 ou 5 para as maneiras de ler(descrever) a fra|fffd||fffd|o
'"                  (Opcional - 3 padr|fffd|o ou 1 se houver UndNomeSing)
'"                  1 - L|fffd| a fra|fffd||fffd|o em centavos. Ideal para Moeda;
'"                  2 - L|fffd| a v|fffd|rgula decimal, cada zero e o n|fffd|mero restante como
'"                    inteiro. Ideal para percentual;
'"                  3 - L|fffd| a fra|fffd||fffd|o em d|fffd|cimos at|fffd| bilion|fffd|simos. Ideal para n|fffd|mero puro;
'"                  4 - N|fffd|o l|fffd| a fra|fffd||fffd|o por extenso, mas a escreve como uma fra|fffd||fffd|o  com
'"                    denominador de 100, 1000, 1000000... Ideal para  moeda  quando em
'"                    fra|fffd||fffd|es menores do que um centavo;
'"                  5 - L|fffd| a fra|fffd||fffd|o em c|fffd|ntimos. Ideal para moeda Euro, mas centavos
'"                    tamb|fffd|m pode ser usado;
'"                UndNomeSing - Nome da unidade no singular (Opcional - A aus|fffd|ncia
'"                  indica n|fffd|mero puro);
'"                UndNomePlur - Nome da unidade no plural (Opcional - Na aus|fffd|ncia a
'"                  pluraliza|fffd||fffd|o ser|fffd| feita automaticamente a partir de UndNomeSing);
'"                UndMasc - Indica o g|fffd|nero da unidade: Verdadeiro (masculino) ou Falso
'"                  (feminino) (Opcional - Padr|fffd|o Verdadeiro (masculino));
'"                UmMil - Escreve 1.000 completo sem omitir 'um': Verdadeiro (Sim, 'um mil')
'"                  ou Falso (N|fffd|o, 'mil') (Opcional - Padr|fffd|o Verdadeiro (Completo));
'"                VirgEntrMilh - Indica intercala|fffd||fffd|o de v|fffd|rgula entre milhares: Verdadeiro (Sim)
'"                  ou Falso (N|fffd|o) (Opcional - Padr|fffd|o Falso (N|fffd|o intercala));
'"                CaixaAlta - Formata letras em mai|fffd|scalas/min|fffd|sculas (Opcional - Padr|fffd|o 1):
'"                  1 - todas min|fffd|scalas; 2 - Senten|fffd|a inteira (S|fffd| a 1|fffd| mai|fffd|scula);
'"                  3 - Mai|fffd|scala/min|fffd|sculas (1|fffd| Mai|fffd|scula em Cada Palavra); 4 - TODAS MAI|fffd|SCULAS.
'"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
'Option Explicit

Function fExtenso(Num As Double, Optional Fra|fffd|Tipo As Integer, Optional UndNomeSing As String, _
        Optional UndNomePlur As String, Optional UndMasc As Boolean = True, _
        Optional UmMil As Boolean = True, Optional VirgEntrMilh As Boolean = False, _
        Optional CaixaAlta As Long = 1) As String
    Dim ExtensInt As String
    Dim ExtensFrac As String
    Dim UndNome As String
    Dim FracNome As String
    Dim Signif As Long
    Dim NumText As String

    If Num > 999999999999.99 Or Num < 0 Then
        fExtenso = "Erro! (Valores v|fffd|lidos: >=0 e < 1 trilh|fffd|o)"
        Exit Function
    End If

    'Preparando nome da unidade, singular e plural
    If UndNomePlur = "" Then UndNomePlur = IIf(UndNomeSing = "", "", Pluralizar(UndNomeSing))
    'Se a fun|fffd||fffd|o Pluralizar falhar palavras estrangeiras ou em exce|fffd||fffd|es portuguesas, o argumento UndNomePlur pode ser usado.

    'Extenso parte inteira
    ExtensInt = fExtensoInt(Int(CDec(Num)), UndMasc, UmMil, VirgEntrMilh)

    'Extenso parte fracion|fffd|ria
    If Fra|fffd|Tipo = 0 And UndNomeSing = "" Then Fra|fffd|Tipo = 3
    If Fra|fffd|Tipo = 0 And UndNomeSing <> "" Then Fra|fffd|Tipo = 1
    Select Case Fra|fffd|Tipo
    Case 1, 5   'L|fffd| fra|fffd||fffd|o em centavos ou c|fffd|ntimos. Ideal para Moeda
        Num = Format(Num, "0.00") * 1   'Round(Num,2)
        ExtensFrac = fExtensoInt((Num - Int(CDec(Num))) * 100, True, UmMil, VirgEntrMilh)
        If ExtensInt = "" And ExtensFrac = "" Then ExtensInt = "zero"

        'Nome da unidade no singular ou plural
        UndNome = IIf(Num < 1, IIf(Num = 0, " " & UndNomePlur, ""), IIf(UndNomeSing = "" Or Right(ExtensInt, 1) = " ", "", " ") & IIf(Int(CDec(Num)) = 1, UndNomeSing, UndNomePlur) & IIf(Num = Int(CDec(Num)), "", " e "))
        'Nome da fra|fffd||fffd|o no singular ou plural
        FracNome = IIf(Num = Int(CDec(Num)), "", IIf(Int(CDec(Num * 100)) - Int(CDec(Num)) * 100 = 1, IIf(Fra|fffd|Tipo = 5, " c|fffd|ntimo", " centavo"), IIf(Fra|fffd|Tipo = 5, " c|fffd|ntimos", " centavos")))

        fExtenso = ExtensInt & UndNome & ExtensFrac & FracNome

    Case 2    'L|fffd| a v|fffd|rgula decimal, cada zero e o n|fffd|mero restante como inteiro. Ideal para percentual.
        ExtensFrac = Num - Int(CDec(Num))
        If ExtensFrac = 0 Then
            fExtenso = ExtensInt
        Else
            ExtensFrac = Format(ExtensFrac, "0.############")
            ExtensFrac = Mid(ExtensFrac, 3, 15)
            fExtenso = IIf(ExtensInt = "", "zero", ExtensInt) & " v|fffd|rgula"
            Do While Left(ExtensFrac, 1) = "0"
                fExtenso = fExtenso & " zero"
                ExtensFrac = Mid(ExtensFrac, 2, 15)
            Loop
            fExtenso = fExtenso & " " & fExtensoInt(ExtensFrac * 1, UndMasc, UmMil, VirgEntrMilh)
        End If

        If fExtenso = "" Then fExtenso = "zero"

        fExtenso = fExtenso & IIf(UndNomeSing <> "", " ", "") & IIf(Num = 1, UndNomeSing, UndNomePlur)

    Case 3    'L|fffd| a fra|fffd||fffd|o de d|fffd|cimo a bilion|fffd|simo. Ideal para n|fffd|mero puro.
        ExtensFrac = Num - Int(CDec(Num))
        If ExtensFrac = 0 Then
            ExtensFrac = ""
        Else
            ExtensFrac = Format(ExtensFrac, "0.############")
            Signif = Len(ExtensFrac) - 2
            If Signif > 3 And Signif <> 6 And Signif <> 9 And Signif <> 12 Then Signif = Int(CDec(Signif / 3)) * 3 + 3
            If Signif > 0 Then
                ExtensFrac = Format(ExtensFrac, "0.000000000000")
                ExtensFrac = fExtensoInt(Mid(ExtensFrac, 3, Signif) * 1, True, UmMil, VirgEntrMilh)
                FracNome = Choose(Signif, "d|fffd|cimo", "cent|fffd|simo", "mil|fffd|simo", , , "milion|fffd|simo", , , "bilion|fffd|simo", , , "trilion|fffd|simo")
                FracNome = " " & FracNome & IIf(ExtensFrac = "um", "", "s")
            Else
                ExtensFrac = ""
            End If
        End If

        If ExtensInt = "" And ExtensFrac = "" Then ExtensInt = "zero"

        If UndNomeSing = "" Then
            fExtenso = ExtensInt & IIf(ExtensInt <> "" And ExtensFrac <> "", ", e ", "") & ExtensFrac & FracNome
        Else
            'Nome da unidade no singular ou plural
            UndNome = IIf(Num < 1, IIf(Num = 0, " " & UndNomePlur, ""), IIf(UndNomeSing = "" Or Right(ExtensInt, 1) = " ", "", " ") & IIf(Int(CDec(Num)) = 1, UndNomeSing, UndNomePlur) & IIf(Num = Int(CDec(Num)), "", " e "))
            'Nome da fra|fffd||fffd|o no singular ou plural
            FracNome = IIf(Num = Int(CDec(Num)), "", FracNome & " de " & UndNomeSing)

            fExtenso = ExtensInt & UndNome & ExtensFrac & FracNome
        End If

    Case 4    'N|fffd|o l|fffd| a fra|fffd||fffd|o mas escreve como fra|fffd||fffd|o com um denominador de 100, 1000, 1000000... Ideal para moeda com fra|fffd||fffd|o de mil|fffd|simo
        ExtensFrac = Num - Int(CDec(Num))
        If ExtensFrac = 0 Then
            ExtensFrac = "nenhum/100"
        Else
            ExtensFrac = Format(ExtensFrac, "0.############")
            Signif = Len(ExtensFrac) - 2
            If Signif > 3 And Signif <> 6 And Signif <> 9 And Signif <> 12 Then Signif = Int(CDec(Signif / 3)) * 3 + 3
            If Signif > 1 Then
                ExtensFrac = (Num - Int(CDec(Num))) * 10 ^ Signif
                ExtensFrac = ExtensFrac & "/" & 10 ^ Signif
            Else
                ExtensFrac = (Num - Int(CDec(Num))) * 10 ^ 2
                ExtensFrac = ExtensFrac & "/100"
            End If
        End If

        If ExtensInt = "" Then ExtensInt = "zero"

        'Nome da unidade no singular ou plural
        UndNome = IIf(Int(CDec(Num)) = 1, UndNomeSing, UndNomePlur)

        fExtenso = ExtensInt & " " & UndNome & " e " & ExtensFrac
    End Select

    Select Case CaixaAlta
    Case 1
        fExtenso = LCase(fExtenso)
    Case 2
        fExtenso = UCase(Left(fExtenso, 1)) & Mid(fExtenso, 2)
    Case 3
        fExtenso = StrConv(fExtenso, vbProperCase)
        fExtenso = MyReplace(fExtenso, " E ", " e ")
    Case 4
        fExtenso = StrConv(fExtenso, vbUpperCase)
    End Select

    'Preservar caixa alta de letra antes de ponto em UndNome
    Dim lPos As Long
    Dim lPos1 As Long
    Do While InStr(lPos + 1, UndNome, ".") > 1
        lPos = InStr(lPos + 1, UndNome, ".")
        lPos1 = InStr(lPos1 + 1, fExtenso, ".")
        fExtenso = Left(fExtenso, lPos1 - 2) & Mid(UndNome, lPos - 1, 1) & Mid(fExtenso, lPos1)
    Loop
End Function

Private Function fExtensoInt(Num As Double, UndMasc As Boolean, UmMil As Boolean, VirgEntrMilh As Boolean) As String
'Gram|fffd|tica portuguesa:
'Regra Geral: N|fffd|o se intercala a conjun|fffd||fffd|o 'e' e nem v|fffd|rgula entre posi|fffd||fffd|es de milhar.
'Exce|fffd||fffd|o: Se a milhar posterior for menor que 100 ou for centena inteira (100,200,300...)
'Alguns gram|fffd|ticos n|fffd|o aceitam essa exce|fffd||fffd|o e outros j|fffd| aceitam a v|fffd|rgula.
'A vari|fffd|vel ConjExc ativa/desativa a exce|fffd||fffd|o
'A vari|fffd|vel VirgEntrMilh usa v|fffd|rgula entre milhares

    Dim NumText As String
    Dim Ce As String
    Dim Ma As String
    Dim M|fffd| As String
    Dim Bi As String
    Dim f As String
    Dim ConjExc As Boolean
    ConjExc = True
    If VirgEntrMilh Then ConjExc = False

    If Num = 0 Then
        fExtensoInt = ""
        Exit Function
    End If

    NumText = Format(Num, "000,000,000,000")

    '1|fffd| Posi|fffd||fffd|o de milhar, Centenas
    Ce = Mid(NumText, 13, 3)
    '2|fffd| Posi|fffd||fffd|o de milhar, Milhares
    Ma = Mid(NumText, 9, 3)
    '3|fffd| Posi|fffd||fffd|o de milhar, Milh|fffd|es
    M|fffd| = Mid(NumText, 5, 3)
    '4|fffd| Posi|fffd||fffd|o de milhar, Bilh|fffd|es
    Bi = Mid(NumText, 1, 3)

    f = fMilharText(Bi, UndMasc) & IIf(Bi > 0, IIf(Bi > 1, " bilh|fffd|es", " bilh|fffd|o"), "")

    f = f & IIf(VirgEntrMilh And Bi > 0 And M|fffd| > 0, ", ", IIf(Bi > 0 And M|fffd| > 0, " ", ""))
    f = f & IIf(ConjExc And Bi > 0 And M|fffd| > 0 And (M|fffd| < 100 Or Right(M|fffd|, 2) = "00"), "e ", "")

    f = f & fMilharText(M|fffd|, UndMasc) & IIf(M|fffd| > 0, IIf(M|fffd| > 1, " milh|fffd|es", " milh|fffd|o"), "")

    f = f & IIf(VirgEntrMilh And Bi + M|fffd| > 0 And Ma > 0, ", ", IIf(Bi + M|fffd| > 0 And Ma > 0, " ", ""))
    f = f & IIf(ConjExc And Bi + M|fffd| > 0 And Ma > 0 And (Ma < 100 Or Right(Ma, 2) = "00"), "e ", "")

    f = f & fMilharText(Ma, UndMasc) & IIf(Ma > 0, IIf(Ma > 1, " mil", " mil"), "")
    If Not UmMil Then If f = "um mil" Then f = "mil"  'Omitir 'um' em 'um mil'

    f = f & IIf(VirgEntrMilh And Bi + M|fffd| + Ma > 0 And Ce > 0, ", ", IIf(Bi + M|fffd| + Ma > 0 And Ce > 0, " ", ""))
    f = f & IIf(ConjExc And Bi + M|fffd| + Ma > 0 And Ce > 0 And (Ce < 100 Or Right(Ce, 2) = "00"), "e ", "")

    f = f & fMilharText(Ce, UndMasc) & IIf(Ce > 0, ",", "")

    f = IIf(Right(f, 1) = ",", Mid(f, 1, Len(f) - 1), f)
    f = IIf(Right(f, 2) = "|fffd|o", f & " de", f)
    f = IIf(Right(f, 3) = "|fffd|es", f & " de", f)
    fExtensoInt = f
End Function

Private Function fMilharText(NumText As String, UndMasc As Boolean)
'Gram|fffd|tica portuguesa:
'Regra Geral: Intercala-se a conjun|fffd||fffd|o 'e' entre centenas, dezenas e unidades

    Dim UndText As String
    Dim DezenaText As String
    Dim CentenaText As String
    Const ConjDez_Un = " e "   'Conjun|fffd||fffd|o entre Dezena e Unidade
    Const ConjCen_Dez = " e "   'Conjun|fffd||fffd|o entre Centena e Unidade

    '  Unidade texto
    If Mid(NumText, 2, 1) <> "1" Then
        UndText = Choose(Mid(NumText, 3, 1) + 1, "", IIf(UndMasc, "um", "uma"), _
                IIf(UndMasc, "dois", "duas"), "tr|fffd|s", "quatro", "cinco", "seis", _
                "sete", "oito", "nove")
    Else
        UndText = ""
    End If

    'Dezena texto
    If Mid(NumText, 2, 1) <> "1" Then
        DezenaText = Choose(Mid(NumText, 2, 1) + 1, "", "dez", "vinte", _
                "trinta", "quarenta", "cinquenta", "sessenta", "setenta", _
                "oitenta", "noventa")
    Else
        DezenaText = Choose(Mid(NumText, 3, 1) + 1, "dez", "onze", _
                "doze", "treze", "quatorze", "quinze", "dezesseis", _
                "dezessete", "dezoito", "dezenove")
    End If

    'Centena texto
    If UndMasc Then
        CentenaText = Choose(Mid(NumText, 1, 1) + 1, "", "cento", "duzentos", _
                "trezentos", "quatrocentos", "quinhentos", "seiscentos", _
                "setecentos", "oitocentos", "novecentos")
    Else
        CentenaText = Choose(Mid(NumText, 1, 1) + 1, "", "cento", "duzentas", _
                "trezentas", "quatrocentas", "quinhentas", "seiscentas", _
                "setecentas", "oitocentas", "novecentas")
    End If
    If Mid(NumText, 1, 1) = "1" And Mid(NumText, 2, 2) = "00" Then CentenaText = "cem"

    'Milhar texto
    fMilharText = CentenaText & IIf(Mid(NumText, 2, 2) * 1 > 0 And CentenaText <> "", ConjCen_Dez, "") _
            & DezenaText & IIf(Mid(NumText, 2, 2) * 1 <= 19 Or Right(NumText, 1) = "0", "", ConjDez_Un) _
            & UndText
End Function

Function Pluralizar(Sing As String) As String
    Dim e As String

    Dim IsLCase As Boolean

    IsLCase = Right(Sing, 1) = LCase(Right(Sing, 1))

    'Regra geral:
    Pluralizar = IIf(Sing = "", "", Sing & IIf(IsLCase, "s", "S"))

    'Exce|fffd||fffd|es: (Quase todas)
    ' Nomes terminados em al, el, ol, ul, il
    e = LCase(Right(Sing, 2))
    If e = "al" Or e = "el" Or e = "ol" Or e = "ul" Or e = "il" Then Pluralizar = Left(Sing, Len(Sing) - 1) & IIf(IsLCase, "is", "IS")
    'Nomes terminados em il
    If e = "il" Then Pluralizar = Left(Sing, Len(Sing) - 2) & IIf(IsLCase, "is", "IS")
    ' Nomes terminados em r, s, z
    e = LCase(Right(Sing, 1))
    If e = "r" Or e = "s" Or e = "z" Then Pluralizar = Sing & IIf(IsLCase, "es", "ES")
    ' Nomes terminados em m
    If e = "m" Then Pluralizar = Left(Sing, Len(Sing) - 1) & IIf(IsLCase, "ns", "NS")
    ' Nomes terminados em x
    If e = "x" Then Pluralizar = Sing
End Function
'========= Rotinas da Fun|fffd||fffd|o Extenso - FIM ===========


' In|fffd|cio Mod1SpellNumber tal como desenvolvido no Excel
'"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
'" FUNCTION:      fSpellNumber  (Escreve extenso de n|fffd|meros em ingl|fffd|s)
'"
'" AUTHOR & DATE: FCO ORLANDO MAGALH|fffd|ES FILHO  07 Nov 2002
'"                Microsoft MVP - Excel
'"                Santa Quit|fffd|ria-Ce - Brazil
'"
'" CONTACT:       orlando@cpap.com.br
'" WEB SITE:      http://cpap.com.br/orlando/
'"
'" DESCRIPTION:   Spell (written out) in English any cardinal number with
'"                or without fraction. The fraction part, if there be, can be written out
'"                in three ways. See FracType argument.
'"
'" ARGUMENTS:     Num - The cardinal number with or without fraction to spell:
'"                  The largest valid number: 1 trillion minus 0.01 (999,999,999,999.99)
'"                  The smallest sensitive fraction: 1 trillionth (0.000,000,000,001)
'"                FracType - 1, 2, 3, 4 or 5 for the way of spell (written out) the fraction
'"                  (Optional - Default 3 or 1 if there is UnitNameSing):
'"                  1 - Spells the fraction in cents. Ideal for coin
'"                  2 - Spells decimal point, each zero and the rest of the number as
'"                    integer. Ideal for percent
'"                  3 - Spells the fraction in tenths to trillionths. Ideal for pure number
'"                  4 - Doesn't spell the fraction but writes it as a fraction with denominator
'"                    of 100, 1000, 1000000... Ideal for coin when in fractions lesser than one
'"                    cent or even in cents although 1 option is about ten times more frequent
'"                  5 - Spells the fraction in pennies. Ideal for coin
'"                UnitNameSing - Unit name in the singular (Optional - The lack de-
'"                  note pure number)
'"                UnitNamePlur - Unit name in the plural (Optional - In the lack the
'"                  pluralization will be done automatically from UnitNameSing)
'"                UnitMasc - Denote unit gender: True (masculine) or False (femini-
'"                  ne) (Optional - Default True (masculine)) (Obs.: Although this isn't
'"                  need in English, it stays here. Maybe it was useful to translate this code
'"                  for another language. The same for the number noun flexibility.)
'"                OneThousand - Write 1.000 complete without omit 'one': True (Yes, 'one thousand')
'"                  or False (No, 'thousand') (Optional - Default True (Complete))
'"                ComBetTh - Denote comma intercalation between thousands: True (Yes)
'"                  or False (No) (Optional - Default False (Don't intercalate))
'"                LetterCase - Format letters in upper/lower case (Optional - Default 1):
'"                  1 - all lower case; 2 - Sentence case (Only the 1|fffd| is upper)
'"                  3 - Title Case (1|fffd| Upper in Each Word); 4 - ALL UPPER CASE.
'"""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""""
'Option Explicit

Function fSpellNumber(Num As Double, Optional FracType As Integer, Optional UnitNameSing As String, _
        Optional UnitNamePlur As String, Optional UnitMasc As Boolean = True, _
        Optional OneThousand As Boolean = True, Optional ComBetTh As Boolean = False, _
        Optional LetterCase As Long = 1) As String
    Dim SpellInt As String
    Dim SpellFrac As String
    Dim UnitName As String
    Dim FracName As String
    Dim Signif As Long
    Dim e As String
    Const NoUnitNoCent As Boolean = True

    If Num > 999999999999.99 Or Num < 0 Then
        fSpellNumber = "Error! (Valid values: >=0 e < 1 trillion)"
        Exit Function
    End If

    'Preparing unit name, singular and plural
    If UnitNamePlur = "" Then UnitNamePlur = IIf(UnitNameSing = "", "", Pluralize(UnitNameSing))
    'If Pluralize function fails on foreign or English word exception, UnitNamePlur argument can be used

    'Spell integer part
    SpellInt = fSpellNumberInt(Int(CDec(Num)), UnitMasc, OneThousand, ComBetTh)

    'Spell fraction part
    If FracType = 0 And UnitNameSing = "" Then FracType = 3
    If FracType = 0 And UnitNameSing <> "" Then FracType = 1
    Select Case FracType
    Case 1, 5   'Spell the fraction in cents or pennies. Ideal for coin
        Num = Format(Num, "0.00") * 1   'Round(Num,2)
        SpellFrac = fSpellNumberInt((Num - Int(CDec(Num))) * 100, True, OneThousand, ComBetTh)

        If SpellInt = "" And SpellFrac = "" And Not NoUnitNoCent Then SpellInt = "zero"

        'Unit Name in singular or plural
        UnitName = IIf(Num < 1, IIf(Num = 0, " " & UnitNamePlur, ""), IIf(UnitNameSing = "" Or Right(SpellInt, 1) = " ", "", " ") & IIf(Int(CDec(Num)) = 1, UnitNameSing, UnitNamePlur) & IIf(Num = Int(CDec(Num)), "", " and "))
        'Fraction name in singular or plural
        FracName = IIf(Num = Int(CDec(Num)), "", IIf(Int(CDec(Num * 100)) - Int(CDec(Num)) * 100 = 1, IIf(FracType = 5, " penny", " cent"), IIf(FracType = 5, " pennies", " cents")))

        If NoUnitNoCent And UnitNamePlur <> "" And (SpellInt = "" Or SpellFrac = "") Then
            If SpellFrac = "" Then
                SpellFrac = IIf(SpellInt = "", "", " and ") & "no"
                FracName = IIf(FracType = 5, " pennies", " cents")
            End If
            If SpellInt = "" Then
                SpellInt = "no"
                UnitName = " " & UnitNamePlur & " and "
            End If
        End If

        fSpellNumber = SpellInt & UnitName & SpellFrac & FracName

    Case 2    'Spell the decimal point, each zero and the rest of the number as integer. Ideal for percent.
        SpellFrac = Num - Int(CDec(Num))
        If SpellFrac = 0 Then
            fSpellNumber = SpellInt
        Else
            SpellFrac = Format(SpellFrac, "0.############")
            SpellFrac = Mid(SpellFrac, 3, 15)
            fSpellNumber = IIf(SpellInt = "", "zero", SpellInt) & " point"
            Do While Left(SpellFrac, 1) = "0"
                fSpellNumber = fSpellNumber & " zero"
                SpellFrac = Mid(SpellFrac, 2, 15)
            Loop
            fSpellNumber = fSpellNumber & " " & fSpellNumberInt(SpellFrac * 1, UnitMasc, OneThousand, ComBetTh)
        End If

        If fSpellNumber = "" Then fSpellNumber = "zero"
        UnitName = IIf(Num = 1, UnitNameSing, UnitNamePlur)
        fSpellNumber = fSpellNumber & IIf(UnitName <> "", " ", "") & UnitName

    Case 3    'Spell the fraction from tenth to billionth. Ideal for pure number.
        SpellFrac = Num - Int(CDec(Num))
        If SpellFrac = 0 Then
            SpellFrac = ""
        Else
            SpellFrac = Format(SpellFrac, "0.############")
            Signif = Len(SpellFrac) - 2
            If Signif > 3 And Signif <> 6 And Signif <> 9 And Signif <> 12 Then Signif = Int(CDec(Signif / 3)) * 3 + 3
            If Signif > 0 Then
                SpellFrac = Format(SpellFrac, "0.000000000000")
                SpellFrac = fSpellNumberInt(Mid(SpellFrac, 3, Signif) * 1, True, OneThousand, ComBetTh)
                FracName = Choose(Signif, "tenth", "hundredth", "thousandth", , , "millionth", , , "billionth", , , "trillionth")
                FracName = " " & FracName & IIf(SpellFrac = "one", "", "s")
            Else
                SpellFrac = ""
            End If
        End If

        If SpellInt = "" And SpellFrac = "" Then SpellInt = "zero"

        If UnitNameSing = "" Then
            fSpellNumber = SpellInt & IIf(SpellInt <> "" And SpellFrac <> "", ", and ", "") & SpellFrac & FracName
        Else
            'Unit name in singular or plural
            UnitName = IIf(Num < 1, IIf(Num = 0, " " & UnitNamePlur, ""), IIf(UnitNameSing = "" Or Right(SpellInt, 1) = " ", "", " ") & IIf(Int(CDec(Num)) = 1, UnitNameSing, UnitNamePlur) & IIf(Num = Int(CDec(Num)), "", " and "))
            'Fraction name in singular or plural
            FracName = IIf(Num = Int(CDec(Num)), "", FracName & " of " & UnitNameSing)

            fSpellNumber = SpellInt & UnitName & SpellFrac & FracName
        End If

    Case 4    'Not spell the fraction but write as a fraction with a denominator of 100, 1000, 1000000... Ideal for coin
        SpellFrac = Num - Int(CDec(Num))
        If SpellFrac = 0 Then
            SpellFrac = "no/100"
        Else
            SpellFrac = Format(SpellFrac, "0.############")
            Signif = Len(SpellFrac) - 2
            If Signif > 3 And Signif <> 6 And Signif <> 9 And Signif <> 12 Then Signif = Int(CDec(Signif / 3)) * 3 + 3
            If Signif > 1 Then
                SpellFrac = (Num - Int(CDec(Num))) * 10 ^ Signif
                SpellFrac = SpellFrac & "/" & 10 ^ Signif
            Else
                SpellFrac = (Num - Int(CDec(Num))) * 10 ^ 2
                SpellFrac = SpellFrac & "/100"
            End If
        End If

        If SpellInt = "" Then SpellInt = "zero"

        'Unit Name always in plural
        UnitName = UnitNamePlur

        fSpellNumber = SpellInt & " and " & SpellFrac & " " & UnitName
    End Select

    Select Case LetterCase
    Case 1
        fSpellNumber = LCase(fSpellNumber)
    Case 2
        fSpellNumber = UCase(Left(fSpellNumber, 1)) & Mid(fSpellNumber, 2, 5000)
    Case 3
        fSpellNumber = StrConv(fSpellNumber, vbProperCase)
        fSpellNumber = MyReplace(fSpellNumber, " And ", " and ")
    Case 4
        fSpellNumber = StrConv(fSpellNumber, vbUpperCase)
    End Select

    'Preserve letter case before a point in UnitName
    Dim lPos As Long
    Dim lPos1 As Long
    Do While InStr(lPos + 1, UnitName, ".") > 1
        lPos = InStr(lPos + 1, UnitName, ".")
        lPos1 = InStr(lPos1 + 1, fSpellNumber, ".")
        fSpellNumber = Left(fSpellNumber, lPos1 - 2) & Mid(UnitName, lPos - 1, 1) & Mid(fSpellNumber, lPos1)
    Loop
End Function

Private Function fSpellNumberInt(Num As Double, UnitMasc As Boolean, OneThousand, ComBetTh As Boolean) As String
'English grammar:
'General rule: Don't intercalate the 'and' conjunction and neither comma between thousand position.
'Exception: If posterior thousand were smaller then 100 or were integer hundred (100,200,300...)
'Many grammarians don't accept this exception while others accept comma.
'The ConjExc variable enables this exception.
'The ComBetTh argument puts comma between thousands.

    Dim NumText As String
    Dim Hu As String
    Dim Th As String
    Dim Mi As String
    Dim Bi As String
    Dim f As String
    Dim ConjExc As Boolean    'Put Conjunction Before of Thousand with only one word (alone or compound)
    ConjExc = False
    If ComBetTh Then ConjExc = False

    If Num = 0 Then
        fSpellNumberInt = ""
        Exit Function
    End If

    NumText = Format(Num, "000,000,000,000")

    '1|fffd| Position of thousand, hundreds
    Hu = Mid(NumText, 13, 3)
    '2|fffd| Position of thousand, thousands
    Th = Mid(NumText, 9, 3)
    '3|fffd| Position of thousand, Millions
    Mi = Mid(NumText, 5, 3)
    '4|fffd| Position of thousand, Billions
    Bi = Mid(NumText, 1, 3)

    f = fThousandText(Bi, UnitMasc) & IIf(Bi > 0, IIf(Bi > 1, " billion", " billion"), "")

    f = f & IIf(ComBetTh And Bi > 0 And Mi > 0, ", ", IIf(Bi > 0 And Mi > 0, " ", ""))
    f = f & IIf(ConjExc And Bi > 0 And Mi > 0 And (Mi < 100 Or Right(Mi, 2) = "00"), "and ", "")

    f = f & fThousandText(Mi, UnitMasc) & IIf(Mi > 0, IIf(Mi > 1, " million", " million"), "")

    f = f & IIf(ComBetTh And Bi + Mi > 0 And Th > 0, ", ", IIf(Bi + Mi > 0 And Th > 0, " ", ""))
    f = f & IIf(ConjExc And Bi + Mi > 0 And Th > 0 And (Th < 100 Or Right(Th, 2) = "00"), "and ", "")

    f = f & fThousandText(Th, UnitMasc) & IIf(Th > 0, IIf(Th > 1, " thousand", " thousand"), "")
    If Not OneThousand Then If f = "one thousand" Then f = "thousand"    'Omit 'one' of 'one thousand'

    f = f & IIf(ComBetTh And Bi + Mi + Th > 0 And Hu > 0, ", ", IIf(Bi + Mi + Th > 0 And Hu > 0, " ", ""))
    f = f & IIf(ConjExc And Bi + Mi + Th > 0 And Hu > 0 And (Hu < 100 Or Right(Hu, 2) = "00"), "and ", "")

    f = f & fThousandText(Hu, UnitMasc) & IIf(Hu > 0, ",", "")

    f = IIf(Right(f, 1) = ",", Mid(f, 1, Len(f) - 1), f)
    '   f = IIf(Right(f, 2) = "on", f & " of", f)
    '   f = IIf(Right(f, 3) = "ons", f & " of", f)
    fSpellNumberInt = f
End Function

Private Function fThousandText(NumText As String, UnitMasc As Boolean)
'English grammar:
'General rule: Don't intercalate the 'and' conjunction between hundreds,
'tenths and unities but it's recommend a hyphen between tenths and unities.

    Dim UnitText As String
    Dim TenthText As String
    Dim HundredText As String
    Const ConjTen_Un = "-"    'Conjunction between Tenth and Unit
    Const ConjHun_Ten = " "    'Conjunction between Hundred and Tenth

    '  Unit text
    If Mid(NumText, 2, 1) <> "1" Then
        UnitText = Choose(Mid(NumText, 3, 1) + 1, "", IIf(UnitMasc, "one", "one"), _
                IIf(UnitMasc, "two", "two"), "three", "four", "five", "six", _
                "seven", "eight", "nine")
    Else
        UnitText = ""
    End If

    'Tenth texto
    If Mid(NumText, 2, 1) <> "1" Then
        TenthText = Choose(Mid(NumText, 2, 1) + 1, "", "ten", "twenty", _
                "thirty", "forty", "fifty", "sixty", "seventy", _
                "eighty", "ninety")
    Else
        TenthText = Choose(Mid(NumText, 3, 1) + 1, "ten", "eleven", _
                "twelve", "thirteen", "fourteen", "fifteen", "sixteen", _
                "seventeen", "eighteen", "nineteen")
    End If

    'Hundred text
    If UnitMasc Then
        HundredText = Choose(Mid(NumText, 1, 1) + 1, "", "one hundred", "two hundred", _
                "three hundred", "four hundred", "five hundred", "six hundred", _
                "seven hundred", "eight hundred", "nine hundred")
    Else
        HundredText = Choose(Mid(NumText, 1, 1) + 1, "", "one hundred", "two hundred", _
                "three hundred", "four hundred", "five hundred", "six hundred", _
                "seven hundred", "eight hundred", "nine hundred")
    End If
    If Mid(NumText, 1, 1) = "1" And Mid(NumText, 2, 2) = "00" Then HundredText = "one hundred"

    'Thousand text
    fThousandText = HundredText & IIf(Mid(NumText, 2, 2) * 1 > 0 And HundredText <> "", ConjHun_Ten, "") _
            & TenthText & IIf(Mid(NumText, 2, 2) * 1 <= 19 Or Right(NumText, 1) = "0", "", ConjTen_Un) _
            & UnitText
End Function

Function Pluralize(Sing As String) As String
    Dim e As String
    Dim e3 As String
    Dim IsLCase As Boolean

    IsLCase = Right(Sing, 1) = LCase(Right(Sing, 1))

    'General rule:
    Pluralize = IIf(Sing = "", "", Sing & IIf(IsLCase, "s", "S"))

    'Exception: (Almost all)
    ' Noun end in s, z, x, ch and sh
    e = LCase(Right(Sing, 1))
    If e = "s" Or e = "z" Or e = "x" Then Pluralize = Sing & IIf(IsLCase, "es", "ES")
    e = LCase(Right(Sing, 2))
    If e = "ch" Or e = "sh" Then Pluralize = Sing & IIf(IsLCase, "es", "ES")
    ' Noun end in o preceded by a consonant
    If LCase(Right(Sing, 1)) = "o" And Len(Sing) > 2 Then
        e = LCase(Left(Right(Sing, 2), 1))
        If Not (e = "a" Or e = "e" Or e = "i" Or e = "o" Or e = "u") Then Pluralize = Sing & IIf(IsLCase, "es", "ES")
    End If
    ' Noun end in y preceded by a consonant or not proper
    If LCase(Right(Sing, 1)) = "y" And Len(Sing) > 2 Then
        e = LCase(Left(Right(Sing, 2), 1))
        If Not (e = "a" Or e = "e" Or e = "i" Or e = "o" Or e = "u" Or UCase(Left(Sing, 1)) = Left(Sing, 1)) Then Pluralize = Left(Sing, Len(Sing) - 1) & IIf(IsLCase, "ies", "IES")
    End If
    ' Noun end in f
    e = LCase(Right(Sing, 2))
    e3 = LCase(Right(Sing, 3))
    If LCase(Right(Sing, 1)) = "f" And Not (e3 = "oof" Or e3 = "ief" _
            Or e = "rf" Or e = "ff") Then Pluralize = Left(Sing, Len(Sing) - 1) & IIf(IsLCase, "ves", "VES")
    ' Noun end in fe
    If e = "fe" Then Pluralize = Left(Sing, Len(Sing) - 2) & IIf(IsLCase, "ves", "VES")
End Function
'========= Spell Number Function Code - END ===========

Attribute VB_Name = "OrlandoTool2"
Option Explicit

Public Sub Marca1()
    Application.DisplayAlerts = wdAlertsNone
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    On Error Resume Next
    If Not ShiftDown Then WordBasic.WW7_EditGoTo Destination:="Posi|fffd||fffd|o1" Else WordBasic.EditBookmark Name:="Posi|fffd||fffd|o1", SortBy:=0, Add:=1
    If Err.Number <> 0 Then
        If IsPortg Then
            sMsg1 = "Voc|fffd| ainda n|fffd|o destacou uma posi|fffd||fffd|o para este bot|fffd|o. Para marcar uma posi|fffd||fffd|o, posicione o cursor no texto, segure a tecla Shift e clique neste bot|fffd|o."
            sMsg2 = "OrlandoTools - Marca 1 n|fffd|o definida!"
        Else
            sMsg1 = "You did not highlight a position for this button yet. To mark a position, position the cursor in the text, press the Shift key, and click this button."
            sMsg2 = "OrlandoTools - Mark 1 Does Not Defined!"
        End If
        MyMsgBox sMsg1, 1, sMsg2
    End If
    Application.DisplayAlerts = wdAlertsAll
End Sub

Public Sub Marca2()
    Application.DisplayAlerts = wdAlertsNone
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    On Error Resume Next
    If Not ShiftDown Then WordBasic.WW7_EditGoTo Destination:="Posi|fffd||fffd|o2" Else WordBasic.EditBookmark Name:="Posi|fffd||fffd|o2", SortBy:=0, Add:=1
    If Err.Number <> 0 Then
        If IsPortg Then
            sMsg1 = "Voc|fffd| ainda n|fffd|o fez uma marca|fffd||fffd|o com este bot|fffd|o. Para marcar posi|fffd||fffd|o, se posicione no texto, segure a tecla Shift e clique neste bot|fffd|o."
            sMsg2 = "OrlandoTools - Marca 2 n|fffd|o definida!"
        Else
            sMsg1 = "You didn't do a marking with this button yet. To mark a position, position yourself in the text, press the Shift key and click in this button."
            sMsg2 = "OrlandoTools - Mark 2 Does Not Defined!"
        End If
        MyMsgBox sMsg1, 1, sMsg2
    End If
    Application.DisplayAlerts = wdAlertsAll
End Sub

Attribute VB_Name = "OrlandoTool3"
Option Explicit
Public fText As String

Sub LocalizarSelPr|fffd|x()
    Dim sText As String
    Dim rngPos As Range
    If Selection Is Nothing Then Exit Sub
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    sText = Selection.Text
    If fText = "" And Len(sText) < 2 Then
        With Selection
            Set rngPos = .Range
            .ExtendMode = False
            .Collapse wdCollapseEnd
            .Extend
            .Extend
            .ExtendMode = False
            sText = Trim(.Text)
        End With

        rngPos.Select
        With Selection.Find
            .Text = sText
            .Forward = True
            .Wrap = wdFindContinue
        End With
        On Error Resume Next
        Application.Dialogs(wdDialogEditFind).Show
        If Len(sText) > 1 Then fText = sText
    Else
        If Len(sText) > 1 Then fText = sText
        With Selection.Find
            .Text = fText
            '      .Replacement.Text = ""
            .Forward = True
            .Wrap = wdFindContinue
            '      .Format = False
            '      .MatchCase = False
            '      .MatchWholeWord = False
            '      .MatchWildcards = False
            '      .MatchSoundsLike = False
            '      .MatchAllWordForms = False
        End With
        If Not ShiftDown Then
            Selection.Find.Execute
        Else
            Application.Dialogs(wdDialogEditFind).Show
        End If
    End If
End Sub

Attribute VB_Name = "OrlandoTool4"
Option Explicit

Sub InserirDataHoraOWT()
    Dim rngPos1 As Range
    Dim rngPos2 As Range

    If Selection Is Nothing Then Exit Sub
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    Set rngPos1 = Selection.Range
    If Selection.LanguageID = 1046 Or Selection.LanguageID = wdPortuguese Then    'In 2007 and 2010 the 1046 constant change name from wdBrazilianPortuguese to wdPortugueseBrazil
        Selection.InsertDateTime DateTimeFormat:="dddd, d' de 'MMMM' de 'yyyy", _
                InsertAsField:=False, InsertAsFullWidth:=False   ', DateLanguage:=wdBrazilianPortuguese, CalendarType:=wdCalendarWestern
    Else
        Selection.InsertDateTime DateTimeFormat:="dddd, MMMM d', 'yyyy", _
                InsertAsField:=False, InsertAsFullWidth:=False   ', DateLanguage:=wdBrazilianPortuguese, CalendarType:=wdCalendarWestern
    End If

    Selection.TypeText Text:=" - "
    Selection.InsertDateTime DateTimeFormat:="HH:mm:ss", _
            InsertAsField:=False, InsertAsFullWidth:=False   ', DateLanguage:=wdBrazilianPortuguese, CalendarType:=wdCalendarWestern

    Selection.TypeText Text:=" - "
    Set rngPos2 = Selection.Range
    rngPos1.Select
    Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    Selection.Range.Case = wdUpperCase
    rngPos2.Select
End Sub






Attribute VB_Name = "OrlandoTool5"
Option Explicit

Sub ColarTextoSemFormato()
    If ShiftDown Or CtrlDown Then ColarFormatoSemTexto: Exit Sub
    Application.DisplayAlerts = 0
    On Error GoTo ErrorHandler
    If Selection Is Nothing Then Exit Sub
    Selection.PasteSpecial DataType:=wdPasteText
    Application.DisplayAlerts = -1
    Exit Sub

ErrorHandler:
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    If IsPortg Then
        sMsg1 = "N|fffd|o h|fffd| texto copiado na |fffd|rea de Transfer|fffd|ncia do Windows!"
        sMsg2 = "OrlandoTools - Colar Texto sem Formata|fffd||fffd|o"
    Else
        sMsg1 = "There is not copied text in the Windows Clipboard!"
        sMsg2 = "OrlandoTools - Paste Text without Format"
    End If
    MyMsgBox sMsg1, 1, sMsg2
    Application.DisplayAlerts = -1
End Sub

Sub ColarFormatoSemTexto()
    Application.DisplayAlerts = 0
    On Error GoTo ErrorHandler
    If Selection Is Nothing Then Exit Sub

    'Criticize clipboard text content
    Dim MyDataObject As DataObject
    Dim ClipCnt As String
    Set MyDataObject = New DataObject
    MyDataObject.GetFromClipboard
    ClipCnt = MyDataObject.GetText
    Set MyDataObject = Nothing
    If Len(ClipCnt) = 0 Or Len(ClipCnt) > 32000 Then GoTo ErrorHandler

    'Get 'Format Painter' from clipboard
    Dim TemplTmp As Document
    Dim ActWin As Window
    Set ActWin = ActiveWindow
    Set TemplTmp = Documents.Add(, True, , False)
    TemplTmp.Activate
    Selection.Paste    'AndFormat (wdPasteDefault)
    Selection.HomeKey Unit:=wdStory, Extend:=wdExtend
    Selection.CopyFormat
    TemplTmp.Close False
    Set TemplTmp = Nothing
    ActWin.Activate

    On Error Resume Next
    Selection.PasteFormat
    Application.DisplayAlerts = -1
    If Err.Number <> 0 Then GoTo ErrorHandler
    Exit Sub

ErrorHandler:
    If Not TemplTmp Is Nothing Then TemplTmp.Close False
    Set MyDataObject = Nothing
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    If IsPortg Then
        sMsg1 = "N|fffd|o h|fffd| texto com formata|fffd||fffd|o na |fffd|rea de Transfer|fffd|ncia do Windows!"
        sMsg2 = "OrlandoTools - Colar Formata|fffd||fffd|o sem Texto"
    Else
        sMsg1 = "There is not text with format in the Windows Clipboard!"
        sMsg2 = "OrlandoTools - Paste Format without Text"
    End If
    MyMsgBox sMsg1, 1, sMsg2
    Application.DisplayAlerts = -1
End Sub

Attribute VB_Name = "OrlandoTool6"
Option Explicit

Sub AtivarPastaDocAtivo()
    Dim vPath As String
    On Error Resume Next
    If Selection Is Nothing Then Exit Sub
    vPath = Application.ActiveDocument.Path
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    If IsPortg Then
        sMsg2 = "OrlandoTools - Ativar Pasta do Documento Ativo"
    Else
        sMsg2 = "OrlandoTools - Activate Folder of the Active Document"
    End If

    If vPath = "" Then
        If IsPortg Then
            sMsg1 = "O documento ainda n|fffd|o foi salvo!"
        Else
            sMsg1 = "The document was not saved yet!"
        End If
        MyMsgBox sMsg1, 1, sMsg2
        Exit Sub
    End If

    ChangeFileOpenDirectory vPath
    ActiveDocument.Fields.Update

    If IsPortg Then
        sMsg1 = "O documento ativo est|fffd| na pasta:  " & Chr(10) & Chr(10) & vPath & Chr(10) & Chr(10) & "Ela foi ativada e os campos do documento ativo devidamente atualizados." & Chr(10) & Chr(10) & "Deseja abrir arquivos na pasta ativada?"
    Else
        sMsg1 = "The active document is in the folder:  " & Chr(10) & Chr(10) & vPath & Chr(10) & Chr(10) & "It was activated and the active document fields were duly updated." & Chr(10) & Chr(10) & "Do you want to open files on active folder?"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 1 Then Application.Dialogs(80).Show
End Sub
Attribute VB_Name = "OrlandoTool7"
Option Explicit

Public Sub ImprimirLivro()
'Imprimir frente e verso de folhas com 4 p|fffd|ginas encarden|fffd|veis.
    Static Pi As Integer
    Static Pu As Integer
    Static Qpran As Integer
    Dim i
    Dim Npag
    Dim AppCapt As String
    Dim VerifSaltar As Boolean

    On Error Resume Next
    If Selection Is Nothing Then Exit Sub
    AppCapt = Application.ActiveWindow.Caption & " - " & Application.Caption
    AppActivate AppCapt
    If Err.Number <> 0 Then AppCapt = Application.Caption
    On Error GoTo 0

    Dim Lista(200) As String
    Dim ListaPg(200) As String
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070
    For i = 0 To 200
        Lista(i) = IIf(IsPortg, "P|fffd|g.: ", "Page: ") & Format(i * 4 + 3, "00") & "; " _
                & Format(i * 4 + 1, "00") & "; " & Format(i * 4 + 2, "00") & IIf(IsPortg, " e ", " and ") & _
                Format(i * 4 + 4, "00") & IIf(IsPortg, " - Folha ", " - Folio ") & i + 1
        ListaPg(i) = i + 1
    Next

Inicio:
    With FormOrlandoTool7
        .PageList_LstB.List = Lista
        .Quant_Cb.List = ListaPg
        If Pi < 1 Then Pi = 1
        .PageList_LstB.ListIndex = Pi - 1
        If Qpran < 1 Then Qpran = 1
        .Quant_Cb.Value = Qpran
        .PageList_LstB.SetFocus
        .Show
        If lButtonPress = 0 Then Exit Sub
        Pi = .PageList_LstB.ListIndex + 1
        If Pi < 1 Then GoTo Inicio
        Qpran = .Quant_Cb.Value
        If Qpran < 1 Then GoTo Inicio

        If Pu <= Pi Then Pu = Pi
        Pu = Pi + Qpran - 1
        VerifSaltar = .Skip_ChB.Value
    End With

    Application.DisplayAlerts = False
    WordBasic.FilePageSetup PaperSize:="9", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="16,85 cm", RightMargin:="1,74 cm", Gutter:="0 cm", PageWidth:="29,70 cm", PageHeight:="21 cm", Orientation:=1, ApplyPropsTo:=4
    'WordBasic.FilePageSetup PaperSize:="5", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="17,89 cm", RightMargin:="6,00 cm", Gutter:="0 cm", PageWidth:="35,56 cm", PageHeight:="21,59 cm", Orientation:=1, ApplyPropsTo:=4 'A9 mas usando papel legal
    Application.DisplayAlerts = True

    '1 Imprimindo Frente lado Direito
    AppActivate AppCapt
    If IsPortg Then
        sMsg1 = "1 - Ponha " + Str(Qpran) + " folha(s) em branco."
        sMsg2 = "Imprimindo Frente - Lado Direito"
    Else
        sMsg1 = "1 - Put " + Str(Qpran) + " blank folio(s)."
        sMsg2 = "Printing Front - Right Side"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    For i = Pi To Pu
        Npag = 4 * (i - 1) + 3
        If VerifSaltar Then
            If IsPortg Then
                sMsg1 = "IMPRIMIR A P|fffd|GINA " + Str(Npag) + " (Se 'Cancelar', salta para a pr|fffd|xima)."
            Else
                sMsg1 = "PRINT THE PAGE " + Str(Npag) + " (If 'Cancel', skip to next)."
            End If
            If MyMsgBox(sMsg1, 2, "OrlandoTools") = 2 Then GoTo Salta1
        End If
        AppActivate AppCapt
        WordBasic.FilePrint AppendPrFile:=0, Range:="4", PrToFileName:="", From:="", To:="", Type:=0, NumCopies:="1", Pages:=Str(Npag), Order:=0, PrintToFile:=0, Collate:=1, FileName:=""
        MyWait 5
        AppActivate AppCapt
Salta1:
    Next i


    '2 Imprimindo Verso lado Direito
    AppActivate AppCapt
    If IsPortg Then
        sMsg1 = "2 - Reponha a(s) " + Str(Qpran) + " folha(s) para serem impressa normalmente pelo averso."
        sMsg2 = "Imprimindo Verso - Lado Direito"
    Else
        sMsg1 = "2 - Reput the " + Str(Qpran) + " folio(s) to be print normally by the verse."
        sMsg2 = "Printing Verso - Right Side"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    For i = Pu To Pi Step -1
        Npag = 4 * (i - 1) + 1
        If VerifSaltar Then
            If IsPortg Then
                sMsg1 = "IMPRIMIR A P|fffd|GINA " + Str(Npag) + " (Se 'Cancelar', salta para a pr|fffd|xima)."
            Else
                sMsg1 = "PRINT THE PAGE " + Str(Npag) + " (If 'Cancel', skip to next)."
            End If
            If MyMsgBox(sMsg1, 2, "OrlandoTools") = 2 Then GoTo Salta2
        End If
        AppActivate AppCapt
        WordBasic.FilePrint AppendPrFile:=0, Range:="4", PrToFileName:="", From:="", To:="", Type:=0, NumCopies:="1", Pages:=Str(Npag), Order:=0, PrintToFile:=0, Collate:=1, FileName:=""
        MyWait 5
        AppActivate AppCapt
Salta2:
    Next i
    Application.DisplayAlerts = False
    AppActivate AppCapt
    WordBasic.FilePageSetup PaperSize:="9", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="1,74 cm", RightMargin:="16,85 cm", Gutter:="0 cm", PageWidth:="29,70 cm", PageHeight:="21 cm", Orientation:=1, ApplyPropsTo:=4
    'WordBasic.FilePageSetup PaperSize:="5", TopMargin:="2 cm", BottomMargin:="2 cm", LeftMargin:="1,74 cm", RightMargin:="22,15 cm", Gutter:="0 cm", PageWidth:="35,56 cm", PageHeight:="21,59 cm", Orientation:=1, ApplyPropsTo:=4 'A9 mas usando papel legal
    Application.DisplayAlerts = True



    '3 Imprimindo Frente lado Esquerdo
    AppActivate AppCapt
    If IsPortg Then
        sMsg1 = "3 - Reponha a(s) " + Str(Qpran) + " folha(s) para serem impressa normalmente pelo averso."
        sMsg2 = "Imprimindo Frente - Lado Esquerdo"
    Else
        sMsg1 = "3 - Reput the " + Str(Qpran) + " folio(s) to be print normally by the verse."
        sMsg2 = "Printing Front - Left Side"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    For i = Pi To Pu
        Npag = 4 * (i - 1) + 2
        If VerifSaltar Then
            If IsPortg Then
                sMsg1 = "IMPRIMIR A P|fffd|GINA " + Str(Npag) + " (Se 'Cancelar', salta para a pr|fffd|xima)."
            Else
                sMsg1 = "PRINT THE PAGE " + Str(Npag) + " (If 'Cancel', skip to next)."
            End If
            If MyMsgBox(sMsg1, 2, "OrlandoTools") = 2 Then GoTo Salta3
        End If
        AppActivate AppCapt
        WordBasic.FilePrint AppendPrFile:=0, Range:="4", PrToFileName:="", From:="", To:="", Type:=0, NumCopies:="1", Pages:=Str(Npag), Order:=0, PrintToFile:=0, Collate:=1, FileName:=""
        MyWait 5
        AppActivate AppCapt
Salta3:
    Next i



    '4 Imprimindo Averso lado Esquerdo
    AppActivate AppCapt
    If IsPortg Then
        sMsg1 = "4 - Reponha a(s) " + Str(Qpran) + " folha(s) para serem impressa normalmente pelo averso."
        sMsg2 = "Imprimindo Verso - Lado Esquerdo"
    Else
        sMsg1 = "4 - Reput the " + Str(Qpran) + " folio(s) to be print normally by the verse."
        sMsg2 = "Printing Verso - Left Side"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 2 Then Exit Sub
    For i = Pu To Pi Step -1
        Npag = 4 * (i - 1) + 4
        If VerifSaltar Then
            If IsPortg Then
                sMsg1 = "IMPRIMIR A P|fffd|GINA " + Str(Npag) + " (Se 'Cancelar', salta para a pr|fffd|xima)."
            Else
                sMsg1 = "PRINT THE PAGE " + Str(Npag) + " (If 'Cancel', skip to next)."
            End If
            If MyMsgBox(sMsg1, 2, "OrlandoTools") = 2 Then GoTo Salta4
        End If
        AppActivate AppCapt
        WordBasic.FilePrint AppendPrFile:=0, Range:="4", PrToFileName:="", From:="", To:="", Type:=0, NumCopies:="1", Pages:=Str(Npag), Order:=0, PrintToFile:=0, Collate:=1, FileName:=""
        MyWait 5
        AppActivate AppCapt
Salta4:
    Next i
    Pi = Pu + 1
    If IsPortg Then
        sMsg1 = "Impress|fffd|o da(s) " + Str(Qpran) + " folha(s) conclu|fffd|da. Continuar?"
        sMsg2 = "Conclu|fffd|do"
    Else
        sMsg1 = "Print of the " + Str(Qpran) + " folio(s) finished. Continue?"
        sMsg2 = "Finished"
    End If
    If MyMsgBox(sMsg1, 2, sMsg2) = 1 Then GoTo Inicio
End Sub


Attribute VB_Name = "OrlandoTool8"
Option Explicit
#If VBA7 Then
    Declare PtrSafe Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hwnd As LongPtr, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As LongPtr
#Else
    Declare Function ShellExecute Lib "shell32.dll" Alias "ShellExecuteA" (ByVal hWnd As Long, ByVal lpOperation As String, ByVal lpFile As String, ByVal lpParameters As String, ByVal lpDirectory As String, ByVal nShowCmd As Long) As Long
#End If

Public Sub OnlineDictionary()
    Dim sTextCapt As String
    Dim bCont As Boolean
    Dim lLenSel As Long
    Dim sURL As String

    On Error Resume Next
    If Selection Is Nothing Then Exit Sub
    IsPortg = ApplicationLanguage = 1046 Or ApplicationLanguage = 2070

    If Len(Selection.Text) < 2 Then
        With Selection
            .ExtendMode = False
            .Collapse wdCollapseEnd
            .Extend
            .Extend
            .ExtendMode = False
        End With
    End If

    If Len(Selection.Text) < 2 Then
        'Ignora Espa|fffd|os
        Selection.Collapse wdCollapseEnd    'Eventualmente um espa|fffd|o ou at|fffd| o primeiro n|fffd|mero pode ter sido selecionado
        Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        Do While Selection.Text = " "
            Selection.MoveLeft Unit:=wdCharacter, Count:=1
            Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
        Loop
        bCont = True
        lLenSel = 1
        Do
            Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
            If Left(Selection.Text, 1) = " " Then bCont = False
            If Left(Selection.Text, 2) = " -" Then bCont = True
            If Left(Selection.Text, 1) = Chr(13) Then bCont = False
            If Left(Selection.Text, 1) = Chr(9) Then bCont = False
            If Len(Selection.Text) = lLenSel Then Exit Do   'Indica in|fffd|cio do doc
            If Len(Selection.Text) > lLenSel + 1 Then   'Indica um salto em uma tabela
                Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                Selection.MoveLeft Unit:=wdCharacter, Count:=1, Extend:=wdExtend
                Exit Do
            End If
            lLenSel = Len(Selection.Text)
        Loop While bCont
        If bCont = False Then Selection.MoveRight Unit:=wdCharacter, Count:=1, Extend:=wdExtend
    End If
    sTextCapt = Selection.Text
    sTextCapt = MyReplace(sTextCapt, vbCrLf, "")
    sTextCapt = MyReplace(sTextCapt, vbCr, "")
    sTextCapt = MyReplace(sTextCapt, vbLf, "")
    sTextCapt = MyReplace(sTextCapt, vbFormFeed, "")
    sTextCapt = MyReplace(sTextCapt, Chr(11), "")
    sTextCapt = MyReplace(sTextCapt, vbTab, " ")
    sTextCapt = Trim(sTextCapt)

    If Len(sTextCapt) < 2 Then
        If IsPortg Then
            sMsg1 = "N|fffd|o h|fffd| texto selecionado!"
            sMsg2 = "OrlandoTools - Dicion|fffd|rio On-line"
        Else
            sMsg1 = "There is not selected text!"
            sMsg2 = "OrlandoTools - Online Dictionary"
        End If
        MyMsgBox sMsg1, 1, sMsg2
        Exit Sub
    End If

    sTextCapt = MyReplace(sTextCapt, " ", "%20")
    sTextCapt = MyReplace(sTextCapt, Chr(160), "%20")

    Select Case Selection.LanguageID
    Case 1033    'English
        sURL = "http://dictionary.reference.com/search?q=" & sTextCapt & "&r=5"

    Case 1046, 2070    'Portuguese
        sURL = "http://aulete.uol.com.br/" & sTextCapt

    Case Else    'Any other language
        sURL = "http://dictionary.reference.com/search?q=" & sTextCapt & "&r=5"

    End Select

    ShellExecute 0&, vbNullString, Left(sURL, 457), vbNullString, vbNullString, vbNormalFocus
End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "Sair_Bt, 5, 6, MSForms, CommandButton"
Attribute VB_Control = "Desinstalar_Bt, 4, 7, MSForms, CommandButton"
Attribute VB_Control = "Instalar_Bt, 3, 8, MSForms, CommandButton"
Attribute VB_Control = "Exit_Bt, 2, 9, MSForms, CommandButton"
Attribute VB_Control = "UnInstall_Bt, 1, 10, MSForms, CommandButton"
Attribute VB_Control = "Install_Bt, 0, 11, MSForms, CommandButton"
Option Explicit

Private Sub Document_Open()
    Application.OnTime Now, "Document_OpenCont"    'Although OnTime is needed only when loading form from OpenEvent, it is always a good practice to release soon DOCtoEXE of your opening job.
End Sub

Private Sub Instalar_Bt_Click()
    InstalarMenu False
End Sub
Private Sub Desinstalar_Bt_Click()
    InstalarMenu True
End Sub
Private Sub Sair_Bt_Click()
    Sair
End Sub

Private Sub Install_Bt_Click()
    InstalarMenu False
End Sub
Private Sub UnInstall_Bt_Click()
    InstalarMenu True
End Sub
Private Sub Exit_Bt_Click()
    Sair
End Sub



INQUEST-PP=macro
