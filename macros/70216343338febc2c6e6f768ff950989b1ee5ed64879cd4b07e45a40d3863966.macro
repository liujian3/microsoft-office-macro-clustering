Attribute VB_Name = "DateFact"
Attribute VB_Base = "0{1D8F950B-6B75-438C-B8EB-CAB493A83AC3}{F914B546-48F8-4285-90A7-A4B9840B2C21}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
Me.Hide
End Sub

Private Sub CommandButton2_Click()
ter = "2"
Me.Hide
End Sub

Private Sub UserForm_Terminate()
ter = "1"
End Sub

Attribute VB_Name = "Main_application"
Public ter As String
Public terd As String
Public find As String
Public lotf As String
Public lotostf As String
Public lotresf As String

Sub NoFixedUnit_Add()
Application.Calculation = xlCalculationManual
On Error GoTo Handler
find = ""
ter = ""
terd = ""
ActiveSheet.Unprotect Password:="12344321"

NoFixedUnit.ComboBox1.Clear
NoFixedUnit.ComboBox2.Clear
NoFixedUnit.ComboBox3.Clear
NoFixedUnit.Frame1.TextBox1.Text = CStr(Day(Date))
NoFixedUnit.Frame1.TextBox2.Text = CStr(Month(Date))
NoFixedUnit.Frame1.TextBox3.Text = CStr(Year(Date))
NoFixedUnit.Frame2.TextBox4.Text = ""
NoFixedUnit.Frame2.TextBox5.Text = ""
NoFixedUnit.Frame2.TextBox6.Text = ""
NoFixedUnit.Frame3.TextBox7.Text = ""
NoFixedUnit.TextBox8.Text = ""
Dim add As String

For i = 0 To 100
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value)
With NoFixedUnit.ComboBox1
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value)
With NoFixedUnit.ComboBox2
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 6).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 6).Value)
With NoFixedUnit.ComboBox3
        .AddItem add
End With
End If
Next i

NoFixedUnit.Show
If ter = "1" Then GoTo Block

d = NoFixedUnit.Frame1.TextBox1.Text
m = NoFixedUnit.Frame1.TextBox2.Text
y = NoFixedUnit.Frame1.TextBox3.Text
fio = NoFixedUnit.ComboBox1.Text
bu = NoFixedUnit.ComboBox2.Text
res = NoFixedUnit.ComboBox3.Text
lotn = "'" & lotf
lotost = lotostf
lotrez = lotresf
lotname = NoFixedUnit.TextBox8.Text
zap = NoFixedUnit.Frame3.TextBox7.Text

datez = CDate(d & "." & m & "." & y)
If Weekday(datez, vbMonday) < 5 Then
add = 1
Else
If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
End If

dateplan = DateAdd("d", add, datez)
UserName = Environ("USERNAME")
DateAd = Now()
UID = Year(DateAd) & Format(DateAd, "mm") & Format(DateAd, "dd") & Format(DateAd, "Hh") & Format(DateAd, "Nn") & Format(DateAd, "Ss")

n = 0

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
n = n + 1
Loop


ActiveSheet.Cells(3 + n, 1).Value = datez
ActiveSheet.Cells(3 + n, 2).Value = fio
ActiveSheet.Cells(3 + n, 3).Value = lotn
ActiveSheet.Cells(3 + n, 4).Value = lotname
ActiveSheet.Cells(3 + n, 5).Value = bu
ActiveSheet.Cells(3 + n, 6).Value = lotost
ActiveSheet.Cells(3 + n, 7).Value = lotrez
ActiveSheet.Cells(3 + n, 8).Value = res
ActiveSheet.Cells(3 + n, 9).Value = zap
ActiveSheet.Cells(3 + n, 10).Value = dateplan
ActiveSheet.Cells(3 + n, 12).FormulaR1C1 = "=IFERROR(IF(RC[-1]="""","""",RC[-1]-ROUNDDOWN(RC[7],0)),0)"
ActiveSheet.Cells(3 + n, 13).FormulaR1C1 = "=IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]>=TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]<TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]<RC[-2]),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"","""")))))"
ActiveSheet.Cells(3 + n, 15).Value = "|fffd||fffd||fffd|"
ActiveSheet.Cells(3 + n, 17).Value = DatePart("ww", datez, vbMonday, vbFirstFourDays)
ActiveSheet.Cells(3 + n, 18).Value = UserName
ActiveSheet.Cells(3 + n, 19).Value = DateAd
ActiveSheet.Cells(3 + n, 20).Value = UID

Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlDiagonalDown).LineStyle = xlNone
    Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlDiagonalUp).LineStyle = xlNone
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

ActiveSheet.Columns("N:P").Locked = False
ActiveSheet.Columns("N:P").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Unload NoFixedUnit
Application.Calculation = xlCalculationAutomatic
Exit Sub

Handler:
Z = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical)

Block:
On Error Resume Next
ActiveSheet.Columns("N:P").Locked = False
ActiveSheet.Columns("N:P").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Unload NoFixedUnit
Application.Calculation = xlCalculationAutomatic
End Sub

Sub NoFixedUnit_Find()
find = "1"
terd = ""
ter = ""
SimilarNFU.Show
End Sub

Sub NoSales_Add()
Application.Calculation = xlCalculationManual
On Error GoTo Handler
terd = ""
ter = ""
find = ""
lotf = ""
ActiveSheet.Unprotect Password:="12344321"

NoSales.ComboBox1.Clear
NoSales.ComboBox2.Clear
NoSales.ComboBox3.Clear
NoSales.Frame1.TextBox1.Text = CStr(Day(Date))
NoSales.Frame1.TextBox2.Text = CStr(Month(Date))
NoSales.Frame1.TextBox3.Text = CStr(Year(Date))
NoSales.Frame3.TextBox7.Text = ""
NoSales.TextBox4.Text = ""
NoSales.TextBox8.Text = ""

Dim add As String

For i = 0 To 100
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value)
With NoSales.ComboBox1
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value)
With NoSales.ComboBox2
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 3).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 3).Value)
With NoSales.ComboBox3
        .AddItem add
End With
End If
Next i

NoSales.Show
If ter = "1" Then GoTo Block

d = NoSales.Frame1.TextBox1.Text
m = NoSales.Frame1.TextBox2.Text
y = NoSales.Frame1.TextBox3.Text
fio = NoSales.ComboBox1.Text
bu = NoSales.ComboBox2.Text
re = NoSales.ComboBox3.Text
lotn = "'" & lotf
lotname = NoSales.TextBox8.Text
zap = NoSales.Frame3.TextBox7.Text

datez = CDate(d & "." & m & "." & y)
If Weekday(datez, vbMonday) < 5 Then
add = 1
Else
If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
End If
dateplan = DateAdd("d", add, datez)

UserName = Environ("USERNAME")
DateAd = Now()
UID = Year(DateAd) & Format(DateAd, "mm") & Format(DateAd, "dd") & Format(DateAd, "Hh") & Format(DateAd, "Nn") & Format(DateAd, "Ss")

n = 0

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
n = n + 1
Loop


ActiveSheet.Cells(3 + n, 1).Value = datez
ActiveSheet.Cells(3 + n, 2).Value = fio
ActiveSheet.Cells(3 + n, 3).Value = lotn
ActiveSheet.Cells(3 + n, 4).Value = lotname
ActiveSheet.Cells(3 + n, 5).Value = bu
ActiveSheet.Cells(3 + n, 6).Value = re
ActiveSheet.Cells(3 + n, 7).Value = zap
ActiveSheet.Cells(3 + n, 8).Value = dateplan
ActiveSheet.Cells(3 + n, 10).FormulaR1C1 = "=IFERROR(IF(RC[-1]="""","""",RC[-1]-ROUNDDOWN(RC[7],0)),0)"
ActiveSheet.Cells(3 + n, 11).FormulaR1C1 = "=IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]>=TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]<TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]<RC[-2]),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"","""")))))"
ActiveSheet.Cells(3 + n, 13).Value = "|fffd||fffd||fffd|"
ActiveSheet.Cells(3 + n, 15).Value = DatePart("ww", datez, vbMonday, vbFirstFourDays)
ActiveSheet.Cells(3 + n, 16).Value = UserName
ActiveSheet.Cells(3 + n, 17).Value = DateAd
ActiveSheet.Cells(3 + n, 18).Value = UID



Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlDiagonalDown).LineStyle = xlNone
    Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

ActiveSheet.Columns("L:N").Locked = False
ActiveSheet.Columns("L:N").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Unload NoSales
Application.Calculation = xlCalculationAutomatic
Exit Sub

Handler:
Z = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical)
Block:

ActiveSheet.Columns("L:N").Locked = False
ActiveSheet.Columns("L:N").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
On Error Resume Next
Unload NoSales
Application.Calculation = xlCalculationAutomatic
End Sub

Sub NoSales_Find()
find = "1"
terd = ""
ter = ""
SimilarNS.Show
End Sub

Sub NoDisc_Add()
Application.Calculation = xlCalculationManual
On Error GoTo Handler
terd = ""
ter = ""
find = ""
lotf = ""
ActiveSheet.Unprotect Password:="12344321"

NoDisc.ComboBox1.Clear
NoDisc.ComboBox2.Clear
NoDisc.ComboBox3.Clear
NoDisc.Frame1.TextBox1.Text = CStr(Day(Date))
NoDisc.Frame1.TextBox2.Text = CStr(Month(Date))
NoDisc.Frame1.TextBox3.Text = CStr(Year(Date))
NoDisc.Frame3.TextBox7.Text = ""
NoDisc.TextBox4.Text = ""
NoDisc.TextBox8.Text = ""
Dim add As String

For i = 0 To 100
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value)
With NoDisc.ComboBox1
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value)
With NoDisc.ComboBox2
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 4).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 4).Value)
With NoDisc.ComboBox3
        .AddItem add
End With
End If
Next i

NoDisc.Show
If ter = "1" Then GoTo Block

d = NoDisc.Frame1.TextBox1.Text
m = NoDisc.Frame1.TextBox2.Text
y = NoDisc.Frame1.TextBox3.Text
fio = NoDisc.ComboBox1.Text
bu = NoDisc.ComboBox2.Text
re = NoDisc.ComboBox3.Text
lotn = "'" & lotf
lotname = NoDisc.TextBox8.Text
zap = NoDisc.Frame3.TextBox7.Text

datez = CDate(d & "." & m & "." & y)
If Weekday(datez, vbMonday) < 5 Then
add = 1
Else
If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
End If
dateplan = DateAdd("d", add, datez)
UserName = Environ("USERNAME")
DateAd = Now()
UID = Year(DateAd) & Format(DateAd, "mm") & Format(DateAd, "dd") & Format(DateAd, "Hh") & Format(DateAd, "Nn") & Format(DateAd, "Ss")

n = 0

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
n = n + 1
Loop


ActiveSheet.Cells(3 + n, 1).Value = datez
ActiveSheet.Cells(3 + n, 2).Value = fio
ActiveSheet.Cells(3 + n, 3).Value = lotn
ActiveSheet.Cells(3 + n, 4).Value = lotname
ActiveSheet.Cells(3 + n, 5).Value = bu
ActiveSheet.Cells(3 + n, 6).Value = re
ActiveSheet.Cells(3 + n, 7).Value = zap
ActiveSheet.Cells(3 + n, 8).Value = dateplan
ActiveSheet.Cells(3 + n, 10).FormulaR1C1 = "=IFERROR(IF(RC[-1]="""","""",RC[-1]-ROUNDDOWN(RC[7],0)),0)"
ActiveSheet.Cells(3 + n, 11).FormulaR1C1 = "=IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]>=TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]<TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]<RC[-2]),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"","""")))))"
ActiveSheet.Cells(3 + n, 13).Value = "|fffd||fffd||fffd|"
ActiveSheet.Cells(3 + n, 15).Value = DatePart("ww", datez, vbMonday, vbFirstFourDays)
ActiveSheet.Cells(3 + n, 16).Value = UserName
ActiveSheet.Cells(3 + n, 17).Value = DateAd
ActiveSheet.Cells(3 + n, 18).Value = UID


Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlDiagonalDown).LineStyle = xlNone
   Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 18)).Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

ActiveSheet.Columns("L:N").Locked = False
ActiveSheet.Columns("L:N").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Application.Calculation = xlCalculationAutomatic
Unload NoDisc
Exit Sub

Handler:
Z = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical)
Block:
ActiveSheet.Columns("L:N").Locked = False
ActiveSheet.Columns("L:N").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
On Error Resume Next
Unload NoDisc
Application.Calculation = xlCalculationAutomatic
End Sub

Sub NoDisc_Find()
find = "1"
terd = ""
ter = ""
SimilarNDisc.Show
End Sub

Sub NoNegative_Add()
Application.Calculation = xlCalculationManual
On Error GoTo Handler
terd = ""
ter = ""
find = ""
ActiveSheet.Unprotect Password:="12344321"

NoNegative.ComboBox1.Clear
NoNegative.ComboBox2.Clear
NoNegative.Frame1.TextBox1.Text = CStr(Day(Date))
NoNegative.Frame1.TextBox2.Text = CStr(Month(Date))
NoNegative.Frame1.TextBox3.Text = CStr(Year(Date))
NoNegative.Frame3.TextBox7.Text = ""
NoNegative.TextBox4.Text = ""
NoNegative.TextBox5.Text = ""
NoNegative.TextBox6.Text = ""
NoNegative.TextBox8.Text = ""
NoNegative.TextBox9.Text = ""
NoNegative.TextBox10.Text = ""

Dim add As String

For i = 0 To 100
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value)
With NoNegative.ComboBox1
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value)
With NoNegative.ComboBox2
        .AddItem add
End With
End If
Next i

NoNegative.Show
If ter = "1" Then GoTo Block

d = NoNegative.Frame1.TextBox1.Text
m = NoNegative.Frame1.TextBox2.Text
y = NoNegative.Frame1.TextBox3.Text
fio = NoNegative.ComboBox1.Text
bu = NoNegative.ComboBox2.Text
sor = NoNegative.TextBox5.Text
dated = NoNegative.TextBox6.Text
datet = NoNegative.TextBox8.Text
tnum = NoNegative.TextBox9.Text
lotn = "'" & NoNegative.TextBox4.Text
lotname = NoNegative.TextBox10.Text
zap = NoNegative.Frame3.TextBox7.Text

datez = CDate(d & "." & m & "." & y)
datec = CDate(dated & " " & datet)

If Weekday(datez, vbMonday) < 5 Then
add = 1
Else
If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
End If
dateplan = DateAdd("d", add, datez)

UserName = Environ("USERNAME")
DateAd = Now()
UID = Year(DateAd) & Format(DateAd, "mm") & Format(DateAd, "dd") & Format(DateAd, "Hh") & Format(DateAd, "Nn") & Format(DateAd, "Ss")

n = 0

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
n = n + 1
Loop


ActiveSheet.Cells(3 + n, 1).Value = datez
ActiveSheet.Cells(3 + n, 2).Value = fio
ActiveSheet.Cells(3 + n, 3).Value = lotn
ActiveSheet.Cells(3 + n, 4).Value = lotname
ActiveSheet.Cells(3 + n, 5).Value = bu
ActiveSheet.Cells(3 + n, 6).Value = zap
ActiveSheet.Cells(3 + n, 7).Value = sor
ActiveSheet.Cells(3 + n, 8).Value = datec
ActiveSheet.Cells(3 + n, 9).Value = tnum
ActiveSheet.Cells(3 + n, 10).Value = dateplan
ActiveSheet.Cells(3 + n, 12).FormulaR1C1 = "=IFERROR(IF(RC[-1]="""","""",RC[-1]-ROUNDDOWN(RC[7],0)),0)"
ActiveSheet.Cells(3 + n, 13).FormulaR1C1 = "=IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]>=TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]<TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]<RC[-2]),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"","""")))))"
ActiveSheet.Cells(3 + n, 15).Value = "|fffd||fffd||fffd|"
ActiveSheet.Cells(3 + n, 17).Value = DatePart("ww", datez, vbMonday, vbFirstFourDays)
ActiveSheet.Cells(3 + n, 18).Value = UserName
ActiveSheet.Cells(3 + n, 19).Value = DateAd
ActiveSheet.Cells(3 + n, 20).Value = UID


Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlDiagonalDown).LineStyle = xlNone
    Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 20)).Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

ActiveSheet.Columns("N:P").Locked = False
ActiveSheet.Columns("N:P").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Application.Calculation = xlCalculationAutomatic
Unload NoNegative
Exit Sub

Handler:
Z = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical)
Block:
ActiveSheet.Columns("N:P").Locked = False
ActiveSheet.Columns("N:P").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
On Error Resume Next
Unload NoNegative
Application.Calculation = xlCalculationAutomatic
End Sub

Sub NoNegative_Find()
find = "1"
terd = ""
ter = ""
SimilarNN.Show
End Sub

Sub NoGrammar_Add()
Application.Calculation = xlCalculationManual
On Error GoTo Handler
terd = ""
ter = ""
find = ""
ActiveSheet.Unprotect Password:="12344321"

NoGrammar.ComboBox1.Clear
NoGrammar.ComboBox2.Clear
NoGrammar.Frame1.TextBox1.Text = CStr(Day(Date))
NoGrammar.Frame1.TextBox2.Text = CStr(Month(Date))
NoGrammar.Frame1.TextBox3.Text = CStr(Year(Date))
NoGrammar.Frame3.TextBox7.Text = ""
NoGrammar.TextBox4.Text = ""
NoGrammar.TextBox8.Text = ""

Dim add As String

For i = 0 To 100
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 1).Value)
With NoGrammar.ComboBox1
        .AddItem add
End With
End If
Next i

For i = 0 To 30
If Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value <> "" Then
add = CStr(Sheets("|fffd||fffd||fffd||fffd||fffd|").Cells(1 + i, 2).Value)
With NoGrammar.ComboBox2
        .AddItem add
End With
End If
Next i

NoGrammar.Show
If ter = "1" Then GoTo Block

d = NoGrammar.Frame1.TextBox1.Text
m = NoGrammar.Frame1.TextBox2.Text
y = NoGrammar.Frame1.TextBox3.Text
fio = NoGrammar.ComboBox1.Text
bu = NoGrammar.ComboBox2.Text
lotn = "'" & NoGrammar.TextBox4.Text
lotname = NoGrammar.TextBox8.Text
zap = NoGrammar.Frame3.TextBox7.Text

datez = CDate(d & "." & m & "." & y)
If Weekday(datez, vbMonday) < 5 Then
add = 1
Else
If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
End If
dateplan = DateAdd("d", add, datez)
UserName = Environ("USERNAME")
DateAd = Now()
UID = Year(DateAd) & Format(DateAd, "mm") & Format(DateAd, "dd") & Format(DateAd, "Hh") & Format(DateAd, "Nn") & Format(DateAd, "Ss")

n = 0

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
n = n + 1
Loop


ActiveSheet.Cells(3 + n, 1).Value = datez
ActiveSheet.Cells(3 + n, 2).Value = fio
ActiveSheet.Cells(3 + n, 3).Value = lotn
ActiveSheet.Cells(3 + n, 4).Value = lotname
ActiveSheet.Cells(3 + n, 5).Value = bu
ActiveSheet.Cells(3 + n, 6).Value = zap
ActiveSheet.Cells(3 + n, 7).Value = dateplan
ActiveSheet.Cells(3 + n, 9).FormulaR1C1 = "=IFERROR(IF(RC[-1]="""","""",RC[-1]-ROUNDDOWN(RC[7],0)),0)"
ActiveSheet.Cells(3 + n, 10).FormulaR1C1 = "=IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]>=TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]="""",RC[-3]<TODAY()),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]<RC[-2]),""|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"",IF(AND(RC[-3]>0,RC[-2]>0,RC[-3]>=RC[-2]),""|fffd| |fffd||fffd||fffd||fffd|"","""")))))"
ActiveSheet.Cells(3 + n, 12).Value = "|fffd||fffd||fffd|"
ActiveSheet.Cells(3 + n, 14).Value = DatePart("ww", datez, vbMonday, vbFirstFourDays)
ActiveSheet.Cells(3 + n, 15).Value = UserName
ActiveSheet.Cells(3 + n, 16).Value = DateAd
ActiveSheet.Cells(3 + n, 17).Value = UID



Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlDiagonalDown).LineStyle = xlNone
    Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlDiagonalUp).LineStyle = xlNone
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Range(ActiveSheet.Cells(3 + n, 1), ActiveSheet.Cells(3 + n, 17)).Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With

ActiveSheet.Columns("K:M").Locked = False
ActiveSheet.Columns("K:M").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
Application.Calculation = xlCalculationAutomatic
Unload NoGrammar
Exit Sub

Handler:
Z = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical)
Block:
ActiveSheet.Columns("K:M").Locked = False
ActiveSheet.Columns("K:M").FormulaHidden = False
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True
On Error Resume Next
Unload NoGrammar
Application.Calculation = xlCalculationAutomatic
End Sub

Sub NoGrammar_Find()
find = "1"
terd = ""
ter = ""
SimilarNG.Show
End Sub

Sub Hid()
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
ActiveSheet.Unprotect Password:="12344321"

    If ActiveSheet.Rows(5).EntireRow.Hidden = False Then x = 0 Else x = 1
    
    For i = 0 To 51
    If x = 0 Then
    ActiveSheet.Rows(5 + i * 5).EntireRow.Hidden = True
    ActiveSheet.Rows(6 + i * 5).EntireRow.Hidden = True
    ActiveSheet.Rows(7 + i * 5).EntireRow.Hidden = True
    ActiveSheet.Rows(8 + i * 5).EntireRow.Hidden = True
    Else
    ActiveSheet.Rows(5 + i * 5).EntireRow.Hidden = False
    ActiveSheet.Rows(6 + i * 5).EntireRow.Hidden = False
    ActiveSheet.Rows(7 + i * 5).EntireRow.Hidden = False
    ActiveSheet.Rows(8 + i * 5).EntireRow.Hidden = False
    End If
    Next i

ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True

Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic
End Sub

Sub Delele()

pas = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
If pas = "5259" Then
ActiveSheet.Unprotect Password:="12344321"
d = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
If IsNumeric(d) = True Then ActiveSheet.Rows(CInt(d)).Delete Else GoTo Block
Else
e = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbCritical + vbOKOnly)
End If

Block:
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True

End Sub

Sub DateF()
On Error GoTo Block
r = Selection.Rows.Count
c = Selection.Columns.Count
If r = 1 And c = 1 Then

DateFact.Frame1.TextBox1.Text = CStr(Day(Now()))
DateFact.Frame1.TextBox2.Text = CStr(Month(Now()))
DateFact.Frame1.TextBox3.Text = CStr(Year(Now()))
ter = ""
DateFact.Show

If ter = "1" Then GoTo Block
ActiveSheet.Unprotect Password:="12344321"
d = DateFact.Frame1.TextBox1.Text
m = DateFact.Frame1.TextBox2.Text
y = DateFact.Frame1.TextBox3.Text
datez = CDate(d & "." & m & "." & y)

If datez > 0 Then
ActiveCell.Value = datez
Else
End If
If ter = "2" Then ActiveCell.Value = ""
End If

Block:
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True

End Sub


Attribute VB_Name = "NoDisc"
Attribute VB_Base = "0{5B34ACD2-AB04-4780-A64F-85BEE9EE1C1B}{F051AF1A-4048-47A6-AC56-5ED0CF8AA18F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton4_Click()
i = 0
For i = 0 To NoDisc.ListBox1.ListCount - 1
    If NoDisc.ListBox1.Selected(i) = True Then
        NoDisc.ListBox1.RemoveItem i
    End If
Next i
End Sub

Private Sub UserForm_Initialize()
NoDisc.ListBox1.Clear
End Sub

Private Sub CommandButton3_Click()
If NoDisc.TextBox4.Text = "" Then
e = 1
Else
If IsNumeric(Left(NoDisc.TextBox4.Text, 5)) And Len(NoDisc.TextBox4.Text) > 4 And Len(NoDisc.TextBox4.Text) <> 7 And Len(NoDisc.TextBox4.Text) <> 6 Then

If Len(NoDisc.TextBox4.Text) < 6 Then
Else
If Mid(NoDisc.TextBox4.Text, 6, 1) = "-" Then
Else
e = 1
End If
End If

Else
e = 1
End If
End If

s = 0
If e = 1 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|")
Else
For i = 0 To NoDisc.ListBox1.ListCount - 1
If NoDisc.ListBox1.List(i, 0) = NoDisc.TextBox4.Text Then s = s + 1
Next i
If s > 0 Then
a = MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
NoDisc.ListBox1.AddItem NoDisc.TextBox4.Text, 0
NoDisc.ListBox1.List(0, 0) = NoDisc.TextBox4.Text
NoDisc.TextBox4.Text = ""
End If
End If
End Sub

Private Sub UserForm_Terminate()
ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
NoDisc.Hide
End Sub

Private Sub CommandButton2_Click()
e = 0
op = ""
emp = ""

If NoDisc.Frame1.TextBox1.Text = "" Then
emp = "|fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoDisc.Frame1.TextBox1.Text) Then
If CInt(NoDisc.Frame1.TextBox1.Text) > 31 Then
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
End If
End If

If NoDisc.Frame1.TextBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoDisc.Frame1.TextBox2.Text) Then
If CInt(NoDisc.Frame1.TextBox2.Text) > 12 Then
e = e + 1
op = "/|fffd||fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoDisc.Frame1.TextBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoDisc.Frame1.TextBox3.Text) Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd|"
End If
End If

If NoDisc.ComboBox1.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
End If

If NoDisc.ComboBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoDisc.ComboBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoDisc.ListBox1.ListCount = 0 Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoDisc.TextBox8.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoDisc.Frame3.TextBox7.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If emp = "" Then emp = "|fffd||fffd| |fffd||fffd|"
If op = "" Then op = "|fffd||fffd| |fffd||fffd|"

If e > 0 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & emp & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|: " & op)
Else

n = 0
Similar = 0
Dim rng As Range

For v = 0 To NoDisc.ListBox1.ListCount - 1
lotn = CStr(NoDisc.ListBox1.List(v, 0))
If NoDisc.ListBox1.ListCount = 1 Then lotf = lotn Else lotf = lotf & lotn & "/"
n = 0
Similar = 0

Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do
    Similar = Similar + 1
    Loop
  
  End If
End With
Next v

If Similar > 0 Then SimilarNDisc.Show




NoDisc.Hide
End If

End Sub

Attribute VB_Name = "NoFixedUnit"
Attribute VB_Base = "0{40021603-DEE2-4C52-BBC5-090C05E1EBE4}{4DB5210A-400B-4F02-A3D8-F919C411DB8E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CheckBox1_Click()
If NoFixedUnit.Frame2.CheckBox1.Value = True Then
NoFixedUnit.ListBox1.Clear
NoFixedUnit.CommandButton3.Enabled = False
NoFixedUnit.CommandButton4.Enabled = False
NoFixedUnit.Frame2.TextBox4.Enabled = False
NoFixedUnit.Frame2.TextBox5.Enabled = False
NoFixedUnit.Frame2.TextBox6.Enabled = False
NoFixedUnit.TextBox8.Enabled = False
NoFixedUnit.ListBox1.Enabled = False
Else
NoFixedUnit.CommandButton3.Enabled = True
NoFixedUnit.CommandButton4.Enabled = True
NoFixedUnit.Frame2.TextBox4.Enabled = True
NoFixedUnit.Frame2.TextBox5.Enabled = True
NoFixedUnit.Frame2.TextBox6.Enabled = True
NoFixedUnit.TextBox8.Enabled = True
NoFixedUnit.ListBox1.Enabled = True
End If

End Sub

Private Sub CommandButton4_Click()
i = 0
For i = 0 To NoFixedUnit.ListBox1.ListCount - 1
    If NoFixedUnit.ListBox1.Selected(i) = True Then
        NoFixedUnit.ListBox1.RemoveItem i
    End If
Next i
End Sub

Private Sub UserForm_Initialize()
NoFixedUnit.ListBox1.Clear
End Sub

Private Sub CommandButton3_Click()
If NoFixedUnit.Frame2.TextBox4.Text = "" Then
e = 1
Else
    If IsNumeric(Left(NoFixedUnit.Frame2.TextBox4.Text, 5)) And Len(NoFixedUnit.Frame2.TextBox4.Text) > 4 And Len(NoFixedUnit.Frame2.TextBox4.Text) <> 7 And Len(NoFixedUnit.Frame2.TextBox4.Text) <> 6 Then
        If Len(NoFixedUnit.Frame2.TextBox4.Text) < 6 Then
        Else
            If Mid(NoFixedUnit.Frame2.TextBox4.Text, 6, 1) = "-" Then
            Else
            e = 1
            End If
        End If

    Else
    e = 1
    End If
End If

If NoFixedUnit.Frame2.TextBox5.Text = "" Then
e = 1
Else
    If IsNumeric(NoFixedUnit.Frame2.TextBox5.Text) Then
    Else
    e = 1
    End If
End If

If NoFixedUnit.Frame2.TextBox6.Text = "" Then
e = 1
Else
    If IsNumeric(NoFixedUnit.Frame2.TextBox6.Text) Then
    Else
    e = 1
    End If
End If


s = 0
If e = 1 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| / |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
Else
    For i = 0 To NoFixedUnit.ListBox1.ListCount - 1
    If NoFixedUnit.ListBox1.List(i, 0) = NoFixedUnit.Frame2.TextBox4.Text Then s = s + 1
    Next i
    If s > 0 Then
    a = MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
    Else
    NoFixedUnit.ListBox1.AddItem NoFixedUnit.Frame2.TextBox4.Text, 0
    NoFixedUnit.ListBox1.List(0, 0) = NoFixedUnit.Frame2.TextBox4.Text
    NoFixedUnit.ListBox1.List(0, 1) = NoFixedUnit.Frame2.TextBox5.Text
    NoFixedUnit.ListBox1.List(0, 2) = NoFixedUnit.Frame2.TextBox6.Text
    NoFixedUnit.Frame2.TextBox4.Text = ""
    NoFixedUnit.Frame2.TextBox5.Text = ""
    NoFixedUnit.Frame2.TextBox6.Text = ""
    End If
End If

End Sub
Private Sub UserForm_Terminate()
ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
NoFixedUnit.Hide
End Sub

Private Sub CommandButton2_Click()
e = 0
op = ""
emp = ""

If NoFixedUnit.Frame1.TextBox1.Text = "" Then
emp = "|fffd||fffd||fffd||fffd|"
e = e + 1
Else
    If IsNumeric(NoFixedUnit.Frame1.TextBox1.Text) Then
        If CInt(NoFixedUnit.Frame1.TextBox1.Text) > 31 Then
        e = e + 1
        op = "|fffd||fffd||fffd||fffd|"
        Else
        End If
    Else
    e = e + 1
    op = "|fffd||fffd||fffd||fffd|"
    End If
End If

If NoFixedUnit.Frame1.TextBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
    If IsNumeric(NoFixedUnit.Frame1.TextBox2.Text) Then
        If CInt(NoFixedUnit.Frame1.TextBox2.Text) > 12 Then
        e = e + 1
        op = "/|fffd||fffd||fffd||fffd||fffd|"
        Else
        End If
    Else
    e = e + 1
    op = op & "/|fffd||fffd||fffd||fffd||fffd|"
    End If
End If

If NoFixedUnit.Frame1.TextBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
Else
    If IsNumeric(NoFixedUnit.Frame1.TextBox3.Text) Then
    Else
    e = e + 1
    op = op & "/|fffd||fffd||fffd|"
    End If
End If

If NoFixedUnit.ComboBox1.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
End If

If NoFixedUnit.ComboBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoFixedUnit.Frame2.CheckBox1.Value = True Then
Else

    If NoFixedUnit.ListBox1.ListCount = 0 Then
    emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
    e = e + 1
    End If
    If NoFixedUnit.TextBox8.Text = "" Then
    emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
    e = e + 1
    End If

End If

If NoFixedUnit.Frame3.TextBox7.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If emp = "" Then emp = "|fffd||fffd| |fffd||fffd|"
If op = "" Then op = "|fffd||fffd| |fffd||fffd|"

If e > 0 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & emp & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|: " & op)
Else

n = 0
Similar = 0
Dim rng As Range

If NoFixedUnit.CheckBox1.Value = True Then
lotn = "|fffd||fffd||fffd|"
lotf = "|fffd||fffd||fffd|"
lotostf = "|fffd||fffd||fffd|"
lotresf = "|fffd||fffd||fffd|"

n = 0
Similar = 0
Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do
    Similar = Similar + 1
    Loop
  
  End If
End With

Else

For v = 0 To NoFixedUnit.ListBox1.ListCount - 1
    lotn = CStr(NoFixedUnit.ListBox1.List(v, 0))
    lotost = CStr(NoFixedUnit.ListBox1.List(v, 1))
    lotres = CStr(NoFixedUnit.ListBox1.List(v, 2))

    If NoFixedUnit.ListBox1.ListCount = 1 Then
        lotf = lotn
        lotostf = lotost
        lotresf = lotres
        Else
        lotf = lotf & lotn & "/"
        lotostf = lotostf & lotost & "/"
        lotresf = lotresf & lotres & "/"
        End If
        n = 0
        Similar = 0

        Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
        With rng
        Set c = .find(lotn, LookIn:=xlValues)
        If Not c Is Nothing Then
        firstAddress = c.Address
        r = c.Row
        Similar = Similar + 1
        Do While Not c Is Nothing
         n = n + 1
        Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do
        Similar = Similar + 1
        Loop
  
        End If
        End With
Next v

End If

If Similar > 0 Then SimilarNFU.Show

NoFixedUnit.Hide
End If

End Sub

Attribute VB_Name = "NoGrammar"
Attribute VB_Base = "0{819F03E0-2076-4F49-B754-383EF92C2404}{3E891E65-EF4D-4D9B-8547-D9900F64918A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
NoGrammar.Hide
End Sub

Private Sub CommandButton2_Click()
e = 0
op = ""
emp = ""

If NoGrammar.Frame1.TextBox1.Text = "" Then
emp = "|fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoGrammar.Frame1.TextBox1.Text) Then
If CInt(NoGrammar.Frame1.TextBox1.Text) > 31 Then
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
End If
End If

If NoGrammar.Frame1.TextBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoGrammar.Frame1.TextBox2.Text) Then
If CInt(NoGrammar.Frame1.TextBox2.Text) > 12 Then
e = e + 1
op = "/|fffd||fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoGrammar.Frame1.TextBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoGrammar.Frame1.TextBox3.Text) Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd|"
End If
End If

If NoGrammar.ComboBox1.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
End If

If NoGrammar.ComboBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoGrammar.TextBox4.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(Left(NoGrammar.TextBox4.Text, 5)) And Len(NoGrammar.TextBox4.Text) > 4 And Len(NoGrammar.TextBox4.Text) <> 7 And Len(NoGrammar.TextBox4.Text) <> 6 Then

If Len(NoGrammar.TextBox4.Text) < 6 Then
Else
If Mid(NoGrammar.TextBox4.Text, 6, 1) = "-" Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoGrammar.TextBox8.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoGrammar.Frame3.TextBox7.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If e > 0 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & emp & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|: " & op)
Else

If emp = "" Then emp = "|fffd||fffd| |fffd||fffd|"
If op = "" Then op = "|fffd||fffd| |fffd||fffd|"

n = 0
Similar = 0
Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
If Left(CStr(ActiveSheet.Cells(3 + n, 3).Value), 5) = Left(CStr(NoGrammar.TextBox4.Text), 5) Then Similar = Similar + 1
n = n + 1
Loop

If Similar > 0 Then SimilarNG.Show

NoGrammar.Hide
End If

End Sub

Attribute VB_Name = "NoNegative"
Attribute VB_Base = "0{CD46DFA8-368D-4951-80E9-68AA75EFC84B}{0B2F2845-3AA8-444F-9BDA-4531FF0AFF96}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
NoNegative.Hide
End Sub

Private Sub CommandButton2_Click()
e = 0
op = ""
emp = ""

If NoNegative.Frame1.TextBox1.Text = "" Then
emp = "|fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoNegative.Frame1.TextBox1.Text) Then
If CInt(NoNegative.Frame1.TextBox1.Text) > 31 Then
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
End If
End If

If NoNegative.Frame1.TextBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoNegative.Frame1.TextBox2.Text) Then
If CInt(NoNegative.Frame1.TextBox2.Text) > 12 Then
e = e + 1
op = "/|fffd||fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoNegative.Frame1.TextBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoNegative.Frame1.TextBox3.Text) Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd|"
End If
End If

If NoNegative.ComboBox1.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
End If

If NoNegative.ComboBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoNegative.TextBox5.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoNegative.TextBox6.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(Left(NoNegative.TextBox6.Text, 2)) And IsNumeric(Mid(NoNegative.TextBox6.Text, 4, 2)) And IsNumeric(Mid(NoNegative.TextBox6.Text, 7, 4)) And Mid(NoNegative.TextBox6.Text, 3, 1) = "." And Mid(NoNegative.TextBox6.Text, 6, 1) = "." And Len(NoNegative.TextBox6.Text) = 10 Then
If CInt(Left(NoNegative.TextBox6.Text, 2)) < 32 And CInt(Mid(NoNegative.TextBox6.Text, 4, 2)) < 13 Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If

Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoNegative.TextBox8.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(Left(NoNegative.TextBox8.Text, 2)) And IsNumeric(Mid(NoNegative.TextBox8.Text, 4, 2)) And IsNumeric(Mid(NoNegative.TextBox8.Text, 7, 2)) And Mid(NoNegative.TextBox8.Text, 3, 1) = ":" And Mid(NoNegative.TextBox8.Text, 6, 1) = ":" And Len(NoNegative.TextBox8.Text) = 8 Then
If CInt(Left(NoNegative.TextBox8.Text, 2)) < 24 And CInt(Mid(NoNegative.TextBox8.Text, 4, 2)) < 60 And CInt(Mid(NoNegative.TextBox8.Text, 7, 2)) < 60 Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If

Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End If


If NoNegative.TextBox9.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoNegative.TextBox9.Text) And Len(NoNegative.TextBox9.Text) > 10 And Left(NoNegative.TextBox9.Text, 1) = "8" Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoNegative.TextBox4.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(Left(NoNegative.TextBox4.Text, 5)) And Len(NoNegative.TextBox4.Text) > 4 And Len(NoNegative.TextBox4.Text) <> 7 And Len(NoNegative.TextBox4.Text) <> 6 Then

If Len(NoNegative.TextBox4.Text) < 6 Then
Else
If Mid(NoNegative.TextBox4.Text, 6, 1) = "-" Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoNegative.TextBox10.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoNegative.Frame3.TextBox7.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If emp = "" Then emp = "|fffd||fffd| |fffd||fffd|"
If op = "" Then op = "|fffd||fffd| |fffd||fffd|"

If e > 0 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & emp & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|: " & op)
Else

n = 0
Similar = 0
Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
If Left(CStr(ActiveSheet.Cells(3 + n, 3).Value), 5) = Left(CStr(NoNegative.TextBox4.Text), 5) Or CStr(ActiveSheet.Cells(3 + n, 8).Value) = CStr(NoNegative.TextBox9.Text) Then Similar = Similar + 1
n = n + 1
Loop

If Similar > 0 Then SimilarNN.Show

NoNegative.Hide
End If

End Sub

Attribute VB_Name = "NoSales"
Attribute VB_Base = "0{B6680338-9AAD-44E8-9ED7-134D14E008A5}{941F11B8-D1C1-4BE7-9185-E786995EE8A3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CheckBox1_Click()
If NoSales.CheckBox1.Value = True Then
NoSales.ListBox1.Clear
NoSales.CommandButton3.Enabled = False
NoSales.CommandButton4.Enabled = False
NoSales.TextBox4.Enabled = False
NoSales.ListBox1.Enabled = False
NoSales.TextBox8.Enabled = False
Else
NoSales.CommandButton3.Enabled = True
NoSales.CommandButton4.Enabled = True
NoSales.TextBox4.Enabled = True
NoSales.ListBox1.Enabled = True
NoSales.TextBox8.Enabled = True
End If

End Sub

Private Sub CommandButton4_Click()
i = 0
For i = 0 To NoSales.ListBox1.ListCount - 1
    If NoSales.ListBox1.Selected(i) = True Then
        NoSales.ListBox1.RemoveItem i
    End If
Next i
End Sub

Private Sub UserForm_Initialize()
NoSales.ListBox1.Clear
End Sub

Private Sub CommandButton3_Click()
If NoSales.TextBox4.Text = "" Then
e = 1
Else
If IsNumeric(Left(NoSales.TextBox4.Text, 5)) And Len(NoSales.TextBox4.Text) > 4 And Len(NoSales.TextBox4.Text) <> 7 And Len(NoSales.TextBox4.Text) <> 6 Then

If Len(NoSales.TextBox4.Text) < 6 Then
Else
If Mid(NoSales.TextBox4.Text, 6, 1) = "-" Then
Else
e = 1
End If
End If

Else
e = 1
End If
End If

s = 0
If e = 1 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|")
Else
For i = 0 To NoSales.ListBox1.ListCount - 1
If NoSales.ListBox1.List(i, 0) = NoSales.TextBox4.Text Then s = s + 1
Next i
If s > 0 Then
a = MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
NoSales.ListBox1.AddItem NoSales.TextBox4.Text, 0
NoSales.ListBox1.List(0, 0) = NoSales.TextBox4.Text
NoSales.TextBox4.Text = ""
End If
End If

End Sub

Private Sub UserForm_Terminate()
ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
NoSales.Hide
End Sub

Private Sub CommandButton2_Click()
e = 0
op = ""
emp = ""

If NoSales.Frame1.TextBox1.Text = "" Then
emp = "|fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoSales.Frame1.TextBox1.Text) Then
If CInt(NoSales.Frame1.TextBox1.Text) > 31 Then
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = "|fffd||fffd||fffd||fffd|"
End If
End If

If NoSales.Frame1.TextBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoSales.Frame1.TextBox2.Text) Then
If CInt(NoSales.Frame1.TextBox2.Text) > 12 Then
e = e + 1
op = "/|fffd||fffd||fffd||fffd||fffd|"
Else
End If
Else
e = e + 1
op = op & "/|fffd||fffd||fffd||fffd||fffd|"
End If
End If

If NoSales.Frame1.TextBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
Else
If IsNumeric(NoSales.Frame1.TextBox3.Text) Then
Else
e = e + 1
op = op & "/|fffd||fffd||fffd|"
End If
End If

If NoSales.ComboBox1.Text = "" Then
emp = emp & "/|fffd||fffd||fffd|"
e = e + 1
End If

If NoSales.ComboBox2.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoSales.ComboBox3.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoSales.CheckBox1.Value = True Then
Else
If NoSales.ListBox1.ListCount = 0 Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If NoSales.TextBox8.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
e = e + 1
End If

End If



If NoSales.Frame3.TextBox7.Text = "" Then
emp = emp & "/|fffd||fffd||fffd||fffd||fffd||fffd|"
e = e + 1
End If

If emp = "" Then emp = "|fffd||fffd| |fffd||fffd|"
If op = "" Then op = "|fffd||fffd| |fffd||fffd|"

If e > 0 Then
a = MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|: " & emp & ". |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|: " & op)
Else

n = 0
Similar = 0
Dim rng As Range

If NoSales.CheckBox1.Value = True Then
lotn = "|fffd||fffd||fffd|"
lotf = "|fffd||fffd||fffd|"

n = 0
Similar = 0
Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do
    Similar = Similar + 1
    Loop
  
  End If
End With

Else

For v = 0 To NoSales.ListBox1.ListCount - 1
lotn = CStr(NoSales.ListBox1.List(v, 0))
If NoSales.ListBox1.ListCount = 1 Then lotf = lotn Else lotf = lotf & lotn & "/"
n = 0
Similar = 0

Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do
    Similar = Similar + 1
    Loop
  
  End If
End With
Next v

End If
If Similar > 0 Then SimilarNS.Show

NoSales.Hide
End If

End Sub


Attribute VB_Name = "SimilarNDisc"
Attribute VB_Base = "0{1D44D2E8-707A-4022-9E3D-297AD983A9DE}{19469630-4BA7-4726-9C49-B2973B86A0B1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
If terd = "1" Then ter = "" Else ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
Unload Me
End Sub

Private Sub CommandButton2_Click()
ter = ""
terd = "1"
Unload Me
End Sub

Private Sub UserForm_Initialize()
SimilarNDisc.ListBox1.Clear
Dim Sim(0 To 5, 0 To 100) As String
Dim rng As Range
Sim(0, 0) = "|fffd||fffd||fffd||fffd|"
Sim(1, 0) = "|fffd||fffd||fffd|"
Sim(2, 0) = "|fffd||fffd||fffd|"
Sim(3, 0) = "|fffd|-|fffd|"
Sim(4, 0) = "|fffd||fffd||fffd||fffd|"
Sim(5, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
SimilarNDisc.ListBox1.AddItem Sim(0, 0), 0
SimilarNDisc.ListBox1.List(i, 0) = Sim(0, 0)
SimilarNDisc.ListBox1.List(i, 1) = Sim(1, 0)
SimilarNDisc.ListBox1.List(i, 2) = Sim(2, 0)
SimilarNDisc.ListBox1.List(i, 3) = Sim(3, 0)
SimilarNDisc.ListBox1.List(i, 4) = Sim(4, 0)
SimilarNDisc.ListBox1.List(i, 5) = Sim(5, 0)

If find = "1" Then
SimilarNDisc.CommandButton2.Visible = False
lotn = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

n = 0
Similar = 0
Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNDisc.ListBox1.AddItem Sim(0, i), i
SimilarNDisc.ListBox1.List(i, 0) = Sim(0, i)
SimilarNDisc.ListBox1.List(i, 1) = Sim(1, i)
SimilarNDisc.ListBox1.List(i, 2) = Sim(2, i)
SimilarNDisc.ListBox1.List(i, 3) = Sim(3, i)
SimilarNDisc.ListBox1.List(i, 4) = Sim(4, i)
SimilarNDisc.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Else
SimilarNDisc.CommandButton2.Visible = True

For v = 0 To NoDisc.ListBox1.ListCount - 1
lotn = CStr(NoDisc.ListBox1.List(v, 0))
n = 0
Similar = 0

Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNDisc.ListBox1.AddItem Sim(0, i), i
SimilarNDisc.ListBox1.List(i, 0) = Sim(0, i)
SimilarNDisc.ListBox1.List(i, 1) = Sim(1, i)
SimilarNDisc.ListBox1.List(i, 2) = Sim(2, i)
SimilarNDisc.ListBox1.List(i, 3) = Sim(3, i)
SimilarNDisc.ListBox1.List(i, 4) = Sim(4, i)
SimilarNDisc.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Next v

End If

End Sub

Attribute VB_Name = "SimilarNFU"
Attribute VB_Base = "0{00F693F8-680B-4745-A89B-757455D0CFEF}{586C7AF7-D7B7-49B2-948C-D5822A3ADB4C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
If terd = "1" Then ter = "" Else ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
Unload Me
End Sub

Private Sub CommandButton2_Click()
ter = ""
terd = "1"
Unload Me
End Sub

Private Sub UserForm_Initialize()
SimilarNFU.ListBox1.Clear
Dim Sim(0 To 5, 0 To 100) As String
Dim rng As Range
Sim(0, 0) = "|fffd||fffd||fffd||fffd|"
Sim(1, 0) = "|fffd||fffd||fffd|"
Sim(2, 0) = "|fffd||fffd||fffd|"
Sim(3, 0) = "|fffd|-|fffd|"
Sim(4, 0) = "|fffd||fffd||fffd||fffd|"
Sim(5, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
SimilarNFU.ListBox1.AddItem Sim(0, 0), 0
SimilarNFU.ListBox1.List(i, 0) = Sim(0, 0)
SimilarNFU.ListBox1.List(i, 1) = Sim(1, 0)
SimilarNFU.ListBox1.List(i, 2) = Sim(2, 0)
SimilarNFU.ListBox1.List(i, 3) = Sim(3, 0)
SimilarNFU.ListBox1.List(i, 4) = Sim(4, 0)
SimilarNFU.ListBox1.List(i, 5) = Sim(5, 0)

If find = "1" Then
SimilarNFU.CommandButton2.Visible = False
lotn = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

n = 0
Similar = 0
Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 7).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 8).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 7).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 8).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNFU.ListBox1.AddItem Sim(0, i), i
SimilarNFU.ListBox1.List(i, 0) = Sim(0, i)
SimilarNFU.ListBox1.List(i, 1) = Sim(1, i)
SimilarNFU.ListBox1.List(i, 2) = Sim(2, i)
SimilarNFU.ListBox1.List(i, 3) = Sim(3, i)
SimilarNFU.ListBox1.List(i, 4) = Sim(4, i)
SimilarNFU.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Else
SimilarNFU.CommandButton2.Visible = True
m = 0
If NoFixedUnit.CheckBox1.Value = True Then m = 1 Else m = 0

For v = 0 To NoFixedUnit.ListBox1.ListCount - 1 + m
If NoFixedUnit.CheckBox1.Value = True Then lotn = "|fffd||fffd||fffd|" Else lotn = CStr(NoFixedUnit.ListBox1.List(v, 0))
n = 0
Similar = 0

Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 7).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 8).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 7).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 8).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNFU.ListBox1.AddItem Sim(0, i), i
SimilarNFU.ListBox1.List(i, 0) = Sim(0, i)
SimilarNFU.ListBox1.List(i, 1) = Sim(1, i)
SimilarNFU.ListBox1.List(i, 2) = Sim(2, i)
SimilarNFU.ListBox1.List(i, 3) = Sim(3, i)
SimilarNFU.ListBox1.List(i, 4) = Sim(4, i)
SimilarNFU.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Next v

End If
End Sub

Attribute VB_Name = "SimilarNG"
Attribute VB_Base = "0{F88A2A23-6258-4353-B8C4-71AFCE9230E3}{40843284-FD1C-43F2-87F4-15B4CB267636}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
If terd = "1" Then ter = "" Else ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
Unload Me
End Sub

Private Sub CommandButton2_Click()
ter = ""
terd = "1"
Unload Me
End Sub

Private Sub UserForm_Initialize()
SimilarNG.ListBox1.Clear

If find = "1" Then
SimilarNG.CommandButton2.Visible = False
lotn = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
SimilarNG.CommandButton2.Visible = True
lotn = NoGrammar.TextBox4.Text
End If

n = 0
Similar = 0
Dim Sim(0 To 4, 0 To 100) As String
Sim(0, 0) = "|fffd||fffd||fffd||fffd|"
Sim(1, 0) = "|fffd||fffd||fffd|"
Sim(2, 0) = "|fffd||fffd||fffd|"
Sim(3, 0) = "|fffd|-|fffd|"
Sim(4, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
If Left(CStr(ActiveSheet.Cells(3 + n, 3).Value), 5) = Left(CStr(lotn), 5) Then
Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 5).Value)
Similar = Similar + 1
End If
n = n + 1
Loop

i = 0
Do
SimilarNG.ListBox1.AddItem Sim(0, i), i
SimilarNG.ListBox1.List(i, 0) = Sim(0, i)
SimilarNG.ListBox1.List(i, 1) = Sim(1, i)
SimilarNG.ListBox1.List(i, 2) = Sim(2, i)
SimilarNG.ListBox1.List(i, 3) = Sim(3, i)
SimilarNG.ListBox1.List(i, 4) = Sim(4, i)
i = i + 1
Loop Until Sim(0, i) = blank

End Sub

Attribute VB_Name = "SimilarNN"
Attribute VB_Base = "0{D38D9C81-54E0-45E8-84E3-0CD5DD7C9CC4}{BD74B976-9DF2-447C-B2E9-FA8BBB9DD046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
If terd = "1" Then ter = "" Else ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
Unload Me
End Sub

Private Sub CommandButton2_Click()
ter = ""
terd = "1"
Unload Me
End Sub

Private Sub UserForm_Initialize()
SimilarNN.ListBox1.Clear

If find = "1" Then
SimilarNN.CommandButton2.Visible = False
lotn = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
tnum = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| (11 |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 8)", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
Else
SimilarNN.CommandButton2.Visible = True
lotn = NoNegative.TextBox4.Text
tnum = NoNegative.TextBox9.Text
End If

n = 0
Similar = 0
Dim Sim(0 To 7, 0 To 100) As String
Sim(0, 0) = "|fffd||fffd||fffd||fffd|"
Sim(1, 0) = "|fffd||fffd||fffd|"
Sim(2, 0) = "|fffd||fffd||fffd|"
Sim(3, 0) = "|fffd|-|fffd|"
Sim(4, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
Sim(5, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Sim(6, 0) = "|fffd||fffd||fffd||fffd|/|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Sim(7, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"

Do Until IsEmpty(ActiveSheet.Cells(3 + n, 1))
If Left(CStr(ActiveSheet.Cells(3 + n, 3).Value), 5) = Left(CStr(lotn), 5) Or CStr(ActiveSheet.Cells(3 + n, 8).Value) = CStr(tnum) Then
Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 5).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 6).Value)
Sim(6, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 7).Value)
Sim(7, Similar + 1) = CStr(ActiveSheet.Cells(3 + n, 8).Value)
Similar = Similar + 1
End If
n = n + 1
Loop

i = 0
Do
SimilarNN.ListBox1.AddItem Sim(0, i), i
SimilarNN.ListBox1.List(i, 0) = Sim(0, i)
SimilarNN.ListBox1.List(i, 1) = Sim(1, i)
SimilarNN.ListBox1.List(i, 2) = Sim(2, i)
SimilarNN.ListBox1.List(i, 3) = Sim(3, i)
SimilarNN.ListBox1.List(i, 4) = Sim(4, i)
SimilarNN.ListBox1.List(i, 5) = Sim(5, i)
SimilarNN.ListBox1.List(i, 6) = Sim(6, i)
SimilarNN.ListBox1.List(i, 7) = Sim(7, i)
i = i + 1
Loop Until Sim(0, i) = blank

End Sub

Attribute VB_Name = "SimilarNS"
Attribute VB_Base = "0{E72A10FB-ABCB-4C32-ADD9-BB1A1401820B}{3F45A657-BDF9-4F2D-A7A2-59780E6147CE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Terminate()
If terd = "1" Then ter = "" Else ter = "1"
End Sub
Private Sub CommandButton1_Click()
ter = "1"
Unload Me
End Sub

Private Sub CommandButton2_Click()
ter = ""
terd = "1"
Unload Me
End Sub

Private Sub UserForm_Initialize()
SimilarNS.ListBox1.Clear
Dim Sim(0 To 5, 0 To 100) As String
Dim rng As Range
Sim(0, 0) = "|fffd||fffd||fffd||fffd|"
Sim(1, 0) = "|fffd||fffd||fffd|"
Sim(2, 0) = "|fffd||fffd||fffd|"
Sim(3, 0) = "|fffd|-|fffd|"
Sim(4, 0) = "|fffd||fffd||fffd||fffd|"
Sim(5, 0) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
SimilarNS.ListBox1.AddItem Sim(0, 0), 0
SimilarNS.ListBox1.List(i, 0) = Sim(0, 0)
SimilarNS.ListBox1.List(i, 1) = Sim(1, 0)
SimilarNS.ListBox1.List(i, 2) = Sim(2, 0)
SimilarNS.ListBox1.List(i, 3) = Sim(3, 0)
SimilarNS.ListBox1.List(i, 4) = Sim(4, 0)
SimilarNS.ListBox1.List(i, 5) = Sim(5, 0)

If find = "1" Then
SimilarNS.CommandButton2.Visible = False
lotn = InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|", "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|")

n = 0
Similar = 0
Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNS.ListBox1.AddItem Sim(0, i), i
SimilarNS.ListBox1.List(i, 0) = Sim(0, i)
SimilarNS.ListBox1.List(i, 1) = Sim(1, i)
SimilarNS.ListBox1.List(i, 2) = Sim(2, i)
SimilarNS.ListBox1.List(i, 3) = Sim(3, i)
SimilarNS.ListBox1.List(i, 4) = Sim(4, i)
SimilarNS.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Else
SimilarNS.CommandButton2.Visible = True
m = 0
If NoSales.CheckBox1.Value = True Then m = 1 Else m = 0


For v = 0 To NoSales.ListBox1.ListCount - 1 + m
If NoSales.CheckBox1.Value = True Then lotn = "|fffd||fffd||fffd|" Else lotn = CStr(NoSales.ListBox1.List(v, 0))
n = 0
Similar = 0

Set rng = Range(ActiveSheet.Cells(3, 3), ActiveSheet.Cells(15000, 3))
With rng
  Set c = .find(lotn, LookIn:=xlValues)
  If Not c Is Nothing Then
    firstAddress = c.Address
    r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
Similar = Similar + 1
    Do While Not c Is Nothing
      n = n + 1
      Set c = .FindNext(c)
          If c.Address <> firstAddress Then Else Exit Do

       r = c.Row
    Sim(0, Similar + 1) = CStr(ActiveSheet.Cells(r, 1).Value)
    Sim(1, Similar + 1) = CStr(ActiveSheet.Cells(r, 2).Value)
    Sim(2, Similar + 1) = CStr(ActiveSheet.Cells(r, 3).Value)
    Sim(3, Similar + 1) = CStr(ActiveSheet.Cells(r, 4).Value)
    Sim(4, Similar + 1) = CStr(ActiveSheet.Cells(r, 5).Value)
    Sim(5, Similar + 1) = CStr(ActiveSheet.Cells(r, 6).Value)
    Similar = Similar + 1
    Loop
  
  End If
End With
 
i = 1
Do
SimilarNS.ListBox1.AddItem Sim(0, i), i
SimilarNS.ListBox1.List(i, 0) = Sim(0, i)
SimilarNS.ListBox1.List(i, 1) = Sim(1, i)
SimilarNS.ListBox1.List(i, 2) = Sim(2, i)
SimilarNS.ListBox1.List(i, 3) = Sim(3, i)
SimilarNS.ListBox1.List(i, 4) = Sim(4, i)
SimilarNS.ListBox1.List(i, 5) = Sim(5, i)
i = i + 1
Loop Until Sim(0, i) = blank

Next v

End If

End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim rng4 As Range: Set rng4 = [K2:K100000]
If Not Intersect(rng4, Target) Is Nothing Then
DateF
End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim rng4 As Range: Set rng4 = [I2:I100000]
If Not Intersect(rng4, Target) Is Nothing Then
DateF
End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim rng4 As Range: Set rng4 = [I2:I100000]
Dim rng3 As Range: Set rng3 = [H2:H100000]

If Not Intersect(rng4, Target) Is Nothing Then
DateF
End If

If Not Intersect(rng3, Target) Is Nothing Then
ZaprosPost
End If

End Sub


Sub ZaprosPost()
On Error GoTo Block
r = Selection.Rows.Count
c = Selection.Columns.Count
If r = 1 And c = 1 Then

r = Selection.Row
c = Selection.Column
datez = CDate(ActiveSheet.Cells(r, 1).Value)

a = MsgBox("|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbYesNoCancel, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|")
ActiveSheet.Unprotect Password:="12344321"
If a = 6 Then
        If Weekday(datez, vbMonday) < 3 Then
            If Weekday(DateAdd("d", 3, datez), vbMonday) < 6 Then add = 3
            If Weekday(DateAdd("d", 3, datez), vbMonday) > 5 Then add = 8 - Weekday(DateAdd("d", 3, datez), vbMonday) + 5
        End If
        If Weekday(datez, vbMonday) = 3 Then
            add = 5
        End If
        If Weekday(datez, vbMonday) = 4 Then
            add = 4
        End If
        If Weekday(datez, vbMonday) = 5 Then
            add = 5
        End If
        If Weekday(datez, vbMonday) > 5 Then
            add = 8 - Weekday(datez, vbMonday) + 2
        End If
        dateplan = DateAdd("d", add, datez)

Else
    If a = 7 Then
        If Weekday(datez, vbMonday) < 5 Then
        add = 1
        Else
        If Weekday(datez, vbMonday) = 5 Then add = 4 Else add = 9 - Weekday(datez, vbMonday)
        End If
        dateplan = DateAdd("d", add, datez)
    Else
        dateplan = ""
    End If
End If

ActiveCell.Value = dateplan

End If

Block:
ActiveSheet.Protect Password:="12344321", DrawingObjects:=True, Contents:=True, Scenarios:=True, AllowSorting:=True, AllowFiltering:=True

End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim rng4 As Range: Set rng4 = [K2:K100000]
If Not Intersect(rng4, Target) Is Nothing Then
DateF
End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim rng4 As Range: Set rng4 = [H2:H100000]
If Not Intersect(rng4, Target) Is Nothing Then
DateF
End If
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
