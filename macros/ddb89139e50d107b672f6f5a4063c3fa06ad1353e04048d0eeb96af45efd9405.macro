Attribute VB_Name = "AggiornaimpostaturnCamp"
Sub aggiornaimpostaturnoAUSTRIA()
Attribute aggiornaimpostaturnoAUSTRIA.VB_ProcData.VB_Invoke_Func = " \n14"
    
If Sheets("PANNELLO").Range("E14") = "X" Then
    Exit Sub
    End If

Range("A12").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("AUSTRIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "AUSTRIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "AUSTRIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoBELGIO()
    
If Sheets("PANNELLO").Range("E20") = "X" Then
    Exit Sub
    End If

Range("A18").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("BELGIO.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "BELGIO.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "BELGIO.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoBRASILE()
    
    If Sheets("PANNELLO").Range("E26") = "X" Then
    Exit Sub
    End If

Range("A24").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("BRASILE.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "BRASILE.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "BRASILE.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoDANIMARCA()
    
    If Sheets("PANNELLO").Range("E32") = "X" Then
    Exit Sub
    End If

Range("A30").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("DANIMARCA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "DANIMARCA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "DANIMARCA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoFINLANDIA()
    
    If Sheets("PANNELLO").Range("E38") = "X" Then
    Exit Sub
    End If

Range("A36").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("FINLANDIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "FINLANDIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "FINLANDIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoFRANCIA()
    
    If Sheets("PANNELLO").Range("E44") = "X" Then
    Exit Sub
    End If

Range("A42").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("FRANCIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "FRANCIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "FRANCIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoGERMANIA()
    
    If Sheets("PANNELLO").Range("E50") = "X" Then
    Exit Sub
    End If

Range("A48").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("GERMANIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "GERMANIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "GERMANIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoINGHILTERRA()
    
    If Sheets("PANNELLO").Range("E56") = "X" Then
    Exit Sub
    End If

Range("A54").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("INGHILTERRA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "INGHILTERRA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "INGHILTERRA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoITALIA()
    
    If Sheets("PANNELLO").Range("E62") = "X" Then
    Exit Sub
    End If

Range("A60").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("ITALIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "ITALIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "ITALIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoNORVEGIA()
    
    If Sheets("PANNELLO").Range("E68") = "X" Then
    Exit Sub
    End If

Range("A66").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("NORVEGIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "NORVEGIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "NORVEGIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoOLANDA()
    
    If Sheets("PANNELLO").Range("E74") = "X" Then
    Exit Sub
    End If

Range("A72").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("OLANDA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "OLANDA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "OLANDA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoPOLONIA()
    
    If Sheets("PANNELLO").Range("E80") = "X" Then
    Exit Sub
    End If

Range("A78").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("POLONIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "POLONIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "POLONIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoPORTOGALLO()
    
    If Sheets("PANNELLO").Range("E86") = "X" Then
    Exit Sub
    End If

Range("A84").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("PORTOGALLO.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "PORTOGALLO.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "PORTOGALLO.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoRCECA()
    
    If Sheets("PANNELLO").Range("E92") = "X" Then
    Exit Sub
    End If

Range("A90").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("RCECA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "RCECA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "RCECA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoROMANIA()
    
    If Sheets("PANNELLO").Range("E98") = "X" Then
    Exit Sub
    End If

Range("A96").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("ROMANIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "ROMANIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "ROMANIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoRUSSIA()
    
    If Sheets("PANNELLO").Range("E104") = "X" Then
    Exit Sub
    End If

Range("A102").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("RUSSIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "RUSSIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "RUSSIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoSCOZIA()
    
    If Sheets("PANNELLO").Range("E110") = "X" Then
    Exit Sub
    End If

Range("A108").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("SCOZIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SCOZIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SCOZIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoSPAGNA()
    
    If Sheets("PANNELLO").Range("E116") = "X" Then
    Exit Sub
    End If

Range("A114").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("SPAGNA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SPAGNA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SPAGNA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoSVEZIA()
    
    If Sheets("PANNELLO").Range("E122") = "X" Then
    Exit Sub
    End If

Range("A120").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("SVEZIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SVEZIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SVEZIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoSVIZZERA()
    
    If Sheets("PANNELLO").Range("E128") = "X" Then
    Exit Sub
    End If

Range("A126").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("SVIZZERA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SVIZZERA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SVIZZERA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoTURCHIA()
    
    If Sheets("PANNELLO").Range("E134") = "X" Then
    Exit Sub
    End If

Range("A132").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("TURCHIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "TURCHIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "TURCHIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoUCRAINA()
    
    If Sheets("PANNELLO").Range("E140") = "X" Then
    Exit Sub
    End If

Range("A138").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("UCRAINA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "UCRAINA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "UCRAINA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub
Sub aggiornaimpostaturnoUNGHERIA()
    
    If Sheets("PANNELLO").Range("E146") = "X" Then
    Exit Sub
    End If

Range("A144").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Call SERIEA
    Call SERIEB
     Windows("UNGHERIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "UNGHERIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "UNGHERIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("RISULTATI_V2.xlsm").Activate
    Range("A1").Select
End Sub


Attribute VB_Name = "Aggiornatutt"
Sub Aggiornatutto()


    Call aggiornaimpostaturnoAUSTRIA
    Call aggiornaimpostaturnoBELGIO
    Call aggiornaimpostaturnoBRASILE
    Call aggiornaimpostaturnoDANIMARCA
    Call aggiornaimpostaturnoFINLANDIA
    Call aggiornaimpostaturnoFRANCIA
    Call aggiornaimpostaturnoGERMANIA
    Call aggiornaimpostaturnoINGHILTERRA
    Call aggiornaimpostaturnoITALIA
    Call aggiornaimpostaturnoNORVEGIA
    Call aggiornaimpostaturnoOLANDA
    Call aggiornaimpostaturnoPOLONIA
    Call aggiornaimpostaturnoPORTOGALLO
    Call aggiornaimpostaturnoRCECA
    Call aggiornaimpostaturnoROMANIA
    Call aggiornaimpostaturnoRUSSIA
    Call aggiornaimpostaturnoSCOZIA
    Call aggiornaimpostaturnoSPAGNA
    Call aggiornaimpostaturnoSVEZIA
    Call aggiornaimpostaturnoSVIZZERA
    Call aggiornaimpostaturnoTURCHIA
    Call aggiornaimpostaturnoUCRAINA
    Call aggiornaimpostaturnoUNGHERIA
     
    Range("A1").Select
    
    
    MsgBox ("--  FINE --")
    
End Sub




Attribute VB_Name = "CopiapronosticAvantiunagiorn"
Sub COPIAPRONOSTICI()
Attribute COPIAPRONOSTICI.VB_ProcData.VB_Invoke_Func = " \n14"
    
    
    Range("F12:AE13").Select
    Selection.Copy
    Range("F15").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F18").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F21").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F24").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F27").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F30").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F33").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F36").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F39").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F42").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F45").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F48").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F51").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F54").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F57").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F60").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F63").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F66").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F69").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F72").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F75").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F78").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F81").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F84").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F87").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F90").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F93").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F96").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F99").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F102").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F105").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F108").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F111").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F114").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F117").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F120").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F123").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F126").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F105").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F129").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F105").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F132").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F135").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F138").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F141").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F144").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("F147").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

   Range("A1").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = ""
    Range("A11").Select
End Sub

Sub AVANTIUNAGIORNATA()
Attribute AVANTIUNAGIORNATA.VB_ProcData.VB_Invoke_Func = " \n14"
      
      
      TURNO = Range("B12").Value
      Range("B12").Value = TURNO + 1
      TURNO1 = Range("B15").Value
      Range("B15").Value = TURNO1 + 1
      TURNO2 = Range("B18").Value
      Range("B18").Value = TURNO2 + 1
      TURNO3 = Range("B21").Value
      Range("B21").Value = TURNO3 + 1
      TURNO4 = Range("B24").Value
      Range("B24").Value = TURNO4 + 1
      TURNO5 = Range("B27").Value
      Range("B27").Value = TURNO5 + 1
      TURNO6 = Range("B30").Value
      Range("B30").Value = TURNO6 + 1
      TURNO7 = Range("B33").Value
      Range("B33").Value = TURNO7 + 1
      TURNO8 = Range("B36").Value
      Range("B36").Value = TURNO8 + 1
      TURNO9 = Range("B39").Value
      Range("B39").Value = TURNO9 + 1
      TURNO10 = Range("B42").Value
      Range("B42").Value = TURNO10 + 1
      TURNO11 = Range("B45").Value
      Range("B45").Value = TURNO11 + 1
      TURNO12 = Range("B48").Value
      Range("B48").Value = TURNO12 + 1
      TURNO13 = Range("B51").Value
      Range("B51").Value = TURNO13 + 1
      TURNO14 = Range("B54").Value
      Range("B54").Value = TURNO14 + 1
      TURNO15 = Range("B57").Value
      Range("B57").Value = TURNO15 + 1
      TURNO16 = Range("B60").Value
      Range("B60").Value = TURNO16 + 1
      TURNO17 = Range("B63").Value
      Range("B63").Value = TURNO17 + 1
      TURNO18 = Range("B66").Value
      Range("B66").Value = TURNO18 + 1
      TURNO19 = Range("B69").Value
      Range("B69").Value = TURNO19 + 1
      TURNO20 = Range("B72").Value
      Range("B72").Value = TURNO20 + 1
      TURNO21 = Range("B75").Value
      Range("B75").Value = TURNO21 + 1
      TURNO22 = Range("B78").Value
      Range("B78").Value = TURNO22 + 1
      TURNO23 = Range("B81").Value
      Range("B81").Value = TURNO23 + 1
      TURNO24 = Range("B84").Value
      Range("B84").Value = TURNO24 + 1
      TURNO25 = Range("B87").Value
      Range("B87").Value = TURNO25 + 1
      TURNO26 = Range("B90").Value
      Range("B90").Value = TURNO26 + 1
      TURNO27 = Range("B93").Value
      Range("B93").Value = TURNO27 + 1
      TURNO28 = Range("B96").Value
      Range("B96").Value = TURNO28 + 1
      TURNO29 = Range("B99").Value
      Range("B99").Value = TURNO29 + 1
      TURNO30 = Range("B102").Value
      Range("B102").Value = TURNO30 + 1
      TURNO31 = Range("B105").Value
      Range("B105").Value = TURNO31 + 1
      TURNO32 = Range("B108").Value
      Range("B108").Value = TURNO32 + 1
      TURNO33 = Range("B111").Value
      Range("B111").Value = TURNO33 + 1
      TURNO34 = Range("B114").Value
      Range("B114").Value = TURNO34 + 1
      TURNO35 = Range("B117").Value
      Range("B117").Value = TURNO35 + 1
      TURNO36 = Range("B120").Value
      Range("B120").Value = TURNO36 + 1
      TURNO37 = Range("B123").Value
      Range("B123").Value = TURNO37 + 1
      TURNO38 = Range("B126").Value
      Range("B126").Value = TURNO38 + 1
      TURNO39 = Range("B129").Value
      Range("B129").Value = TURNO39 + 1
      TURNO40 = Range("B132").Value
      Range("B132").Value = TURNO40 + 1
      TURNO41 = Range("B135").Value
      Range("B135").Value = TURNO41 + 1
      TURNO42 = Range("B138").Value
      Range("B138").Value = TURNO42 + 1
      TURNO43 = Range("B141").Value
      Range("B141").Value = TURNO43 + 1
      TURNO44 = Range("B144").Value
      Range("B144").Value = TURNO44 + 1
      TURNO45 = Range("B147").Value
      Range("B147").Value = TURNO45 + 1

      
      Range("A11").Select

End Sub

Sub INDIETROUNAGIORNATA()
'
' INDIETROUNAGIORNATA Macro
'

'
      TURNO = Range("B12").Value
      Range("B12").Value = TURNO - 1
      TURNO1 = Range("B15").Value
      Range("B15").Value = TURNO1 - 1
      TURNO2 = Range("B18").Value
      Range("B18").Value = TURNO2 - 1
      TURNO3 = Range("B21").Value
      Range("B21").Value = TURNO3 - 1
      TURNO4 = Range("B24").Value
      Range("B24").Value = TURNO4 - 1
      TURNO5 = Range("B27").Value
      Range("B27").Value = TURNO5 - 1
      TURNO6 = Range("B30").Value
      Range("B30").Value = TURNO6 - 1
      TURNO7 = Range("B33").Value
      Range("B33").Value = TURNO7 - 1
      TURNO8 = Range("B36").Value
      Range("B36").Value = TURNO8 - 1
      TURNO9 = Range("B39").Value
      Range("B39").Value = TURNO9 - 1
      TURNO10 = Range("B42").Value
      Range("B42").Value = TURNO10 - 1
      TURNO11 = Range("B45").Value
      Range("B45").Value = TURNO11 - 1
      TURNO12 = Range("B48").Value
      Range("B48").Value = TURNO12 - 1
      TURNO13 = Range("B51").Value
      Range("B51").Value = TURNO13 - 1
      TURNO14 = Range("B54").Value
      Range("B54").Value = TURNO14 - 1
      TURNO15 = Range("B57").Value
      Range("B57").Value = TURNO15 - 1
      TURNO16 = Range("B60").Value
      Range("B60").Value = TURNO16 - 1
      TURNO17 = Range("B63").Value
      Range("B63").Value = TURNO17 - 1
      TURNO18 = Range("B66").Value
      Range("B66").Value = TURNO18 - 1
      TURNO19 = Range("B69").Value
      Range("B69").Value = TURNO19 - 1
      TURNO20 = Range("B72").Value
      Range("B72").Value = TURNO20 - 1
      TURNO21 = Range("B75").Value
      Range("B75").Value = TURNO21 - 1
      TURNO22 = Range("B78").Value
      Range("B78").Value = TURNO22 - 1
      TURNO23 = Range("B81").Value
      Range("B81").Value = TURNO23 - 1
      TURNO24 = Range("B84").Value
      Range("B84").Value = TURNO24 - 1
      TURNO25 = Range("B87").Value
      Range("B87").Value = TURNO25 - 1
      TURNO26 = Range("B90").Value
      Range("B90").Value = TURNO26 - 1
      TURNO27 = Range("B93").Value
      Range("B93").Value = TURNO27 - 1
      TURNO28 = Range("B96").Value
      Range("B96").Value = TURNO28 - 1
      TURNO29 = Range("B99").Value
      Range("B99").Value = TURNO29 - 1
      TURNO30 = Range("B102").Value
      Range("B102").Value = TURNO30 - 1
      TURNO31 = Range("B105").Value
      Range("B105").Value = TURNO31 - 1
      TURNO32 = Range("B108").Value
      Range("B108").Value = TURNO32 - 1
      TURNO33 = Range("B111").Value
      Range("B111").Value = TURNO33 - 1
      TURNO34 = Range("B114").Value
      Range("B114").Value = TURNO34 - 1
      TURNO35 = Range("B117").Value
      Range("B117").Value = TURNO35 - 1
      TURNO36 = Range("B120").Value
      Range("B120").Value = TURNO36 - 1
      TURNO37 = Range("B123").Value
      Range("B123").Value = TURNO37 - 1
      TURNO38 = Range("B126").Value
      Range("B126").Value = TURNO38 - 1
      TURNO39 = Range("B129").Value
      Range("B129").Value = TURNO39 - 1
      TURNO40 = Range("B132").Value
      Range("B132").Value = TURNO40 - 1
      TURNO41 = Range("B135").Value
      Range("B135").Value = TURNO41 - 1
      TURNO42 = Range("B138").Value
      Range("B138").Value = TURNO42 - 1
      TURNO43 = Range("B141").Value
      Range("B141").Value = TURNO43 - 1
      TURNO44 = Range("B144").Value
      Range("B144").Value = TURNO44 - 1
      TURNO45 = Range("B147").Value
      Range("B147").Value = TURNO45 - 1

Range("A11").Select

End Sub


Attribute VB_Name = "Foglio2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foglio6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Generafogl"
Sub GeneraFogli()
Dim URO As Integer    'dichiarazioni variabili
Dim Clic
Dim Campionato As String
Dim File As String
   'evitiamo il saltellamento a schermo

URO = Sheets("Pannello").[A65536].End(xlUp).Row  'con URO otteniamo il numero dell'ultima riga occupata, colonna A Foglio 1
For N = 11 To URO        'iniziamo un ciclo che scorre le celle dalla riga 2 fino all'ultima riga occupata
Clic = 0                      'impostamo il flag "Clic" a zero ad ogni ciclo
Campionato = Sheets("Pannello").Cells(N, 1)   'con "Campionato" prendiamo il nominativo ora letto nella cella riga N, colonna 15
File = Sheets("Pannello").Cells(N, 2)    'con "File" prendiamo il nominativo ora letto nella cella riga N, colonna 3 per la futura generazione della tabella riepilogativa.


'---------- ATTIVIAMO LA CASELLA STATINO IN ELABORAZIONE -------
Application.ScreenUpdating = True
'Calculate
Sheets("Pannello").Select
Range("C3").Select
Sheets("Pannello").Range("C3").Value = Campionato

Application.ScreenUpdating = False
'---------------------------------------------------------------


'Call LeggeFileInDir
'Call Genera

For Each ws In Worksheets  'quindi iniziamo un ciclo che scorra tutti i fogli presenti in cartella
If ws.Name = Campionato Then    'se un Nome del foglio letto |fffd| uguale al nominativo ora in "Campionato"
Clic = 1                              'impostiamo il flag a 1


'---------- COPIA DATI SU FOGLIO ESISTENTE ------------------------------------------
Sheets(Campionato).Select
Cells.Select
Selection.Clear

'--------- COLLEGA AREA DEL FOGLIO -----------------
Sheets("Dati").Select
Cells.Select
Selection.Clear
File = Sheets("Pannello").Cells(N, 2)
Directory = Sheets("Pannello").Range("D3").Value
Completo = Directory & "[" & File & "]"
Formula = "='" & Completo & "PRONO'!AN1"
Sheets("Dati").Select
Range("A1").Formula = Formula

Range("A1").AutoFill Destination:=Range("A1:A100"), Type:=xlFillDefault
Set X = Range("A1:A100")
X.AutoFill Destination:=Range("A1:AR100"), Type:=xlFillDefault



Sheets("Elaborato").Select
Cells.Select
Selection.Copy
Sheets(Campionato).Select
    Cells.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Cells.Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Range("A1").Select
'-------------------------------------------------------
End If
Next

If Clic = 0 Then    'se NON avremo trovato fogli corrispondenti a "Campionato" il flag |fffd| a zero e quindi
Set NuovoFoglio = Worksheets.Add    'aggiungiamo un nuovo foglio
NuovoFoglio.Name = Campionato               'assegniamo al nuovo foglio il Campionato presente nella variabile "Campionato"
Sheets(Campionato).Move After:=Sheets(Sheets.Count)   'e spostiamo il nuovo foglio alla fine dei fogli presenti

'---------- GENERAZIONE FOGLIO E COPIA DATI -------------
Sheets("Dati").Select
Cells.Select
Selection.Clear
File = Sheets("Pannello").Cells(N, 2)
Directory = Sheets("Pannello").Range("D3").Value
Completo = Directory & "[" & File & "]"
Formula = "='" & Completo & "PRONO'!AN1"
Sheets("Dati").Select
Range("A1").Formula = Formula

Range("A1").AutoFill Destination:=Range("A1:A100"), Type:=xlFillDefault
Set X = Range("A1:A100")
X.AutoFill Destination:=Range("A1:AR100"), Type:=xlFillDefault

Sheets("Elaborato").Select
Cells.Select
Selection.Copy
Sheets(Campionato).Select
    Cells.Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Cells.Select
    Selection.PasteSpecial Paste:=xlPasteFormats, Operation:=xlNone, _
        SkipBlanks:=False, Transpose:=False
    Range("A1").Select


Application.CutCopyMode = False   'eliminiamo il tratteggio intorno alle celle copiate, foglio1
Range("A1").Select
'----------------------------------------------
End If
'Application.ScreenUpdating = True
'Application.ScreenUpdating = False
Next

Sheets("Pannello").Select
'---------- CANCELLIAMO LA CASELLA STATINO IN ELABORAZIONE -------
Sheets("Pannello").Range("C3").Value = ""
'---------------------------------------------------------------

End Sub


Attribute VB_Name = "ImpostaturnoCamp"
Sub impostaturnoAUSTRIA()
    
If Sheets("PANNELLO").Range("E14") = "X" Then
    Exit Sub
    End If

Range("A12").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("AUSTRIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "AUSTRIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "AUSTRIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriAUSTRIA()
    
    Range("A12").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("AUSTRIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiAUSTRIA()
    
    Windows("AUSTRIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoBELGIO()
    
    If Sheets("PANNELLO").Range("E20") = "X" Then
    Exit Sub
    End If

Range("A18").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("BELGIO.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "BELGIO.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "BELGIO.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriBELGIO()
    
    Range("A18").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("BELGIO.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiBELGIO()
    
    Windows("BELGIO.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoBRASILE()
    
    If Sheets("PANNELLO").Range("E26") = "X" Then
    Exit Sub
    End If

Range("A24").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("BRASILE.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "BRASILE.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "BRASILE.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriBRASILE()
    
    Range("A24").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("BRASILE.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiBRASILE()
    
    Windows("BRASILE.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoDANIMARCA()
    
    If Sheets("PANNELLO").Range("E32") = "X" Then
    Exit Sub
    End If

Range("A30").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("DANIMARCA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "DANIMARCA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "DANIMARCA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriDANIMARCA()
    
    Range("A30").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("DANIMARCA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiDANIMARCA()
    
    Windows("DANIMARCA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoFINLANDIA()
    
    If Sheets("PANNELLO").Range("E38") = "X" Then
    Exit Sub
    End If

Range("A36").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("FINLANDIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "FINLANDIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "FINLANDIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriFINLANDIA()
    
    Range("A36").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("FINLANDIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiFINLANDIA()
    
    Windows("FINLANDIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoFRANCIA()
    
    If Sheets("PANNELLO").Range("E44") = "X" Then
    Exit Sub
    End If

Range("A42").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("FRANCIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "FRANCIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "FRANCIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriFRANCIA()
    
    Range("A42").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("FRANCIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiFRANCIA()
    
    Windows("FRANCIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoGERMANIA()
    
    If Sheets("PANNELLO").Range("E50") = "X" Then
    Exit Sub
    End If

Range("A48").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("GERMANIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "GERMANIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "GERMANIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriGERMANIA()
    
    Range("A48").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("GERMANIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiGERMANIA()
    
    Windows("GERMANIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoINGHILTERRA()
    
    If Sheets("PANNELLO").Range("E56") = "X" Then
    Exit Sub
    End If

Range("A54").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("INGHILTERRA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "INGHILTERRA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "INGHILTERRA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriINGHILTERRA()
    
    Range("A54").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("INGHILTERRA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiINGHILTERRA()
    
    Windows("INGHILTERRA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoITALIA()
    
    If Sheets("PANNELLO").Range("E62") = "X" Then
    Exit Sub
    End If

Range("A60").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("ITALIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "ITALIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "ITALIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriITALIA()
    
    Range("A60").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("ITALIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiITALIA()
    
    Windows("ITALIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoNORVEGIA()
    
    If Sheets("PANNELLO").Range("E68") = "X" Then
    Exit Sub
    End If

Range("A66").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("NORVEGIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "NORVEGIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "NORVEGIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriNORVEGIA()
    
    Range("A66").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("NORVEGIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiNORVEGIA()
    
    Windows("NORVEGIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoOLANDA()
    
    If Sheets("PANNELLO").Range("E74") = "X" Then
    Exit Sub
    End If

Range("A72").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("OLANDA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "OLANDA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "OLANDA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriOLANDA()
    
    Range("A72").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("OLANDA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiOLANDA()
    
    Windows("OLANDA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoPOLONIA()
    
    If Sheets("PANNELLO").Range("E80") = "X" Then
    Exit Sub
    End If

Range("A78").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("POLONIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "POLONIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "POLONIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriPOLONIA()
    
    Range("A78").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("POLONIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiPOLONIA()
    
    Windows("POLONIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoPORTOGALLO()
    
    If Sheets("PANNELLO").Range("E86") = "X" Then
    Exit Sub
    End If

Range("A84").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("PORTOGALLO.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "PORTOGALLO.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "PORTOGALLO.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriPORTOGALLO()
    
    Range("A84").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("PORTOGALLO.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiPORTOGALLO()
    
    Windows("PORTOGALLO.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoRCECA()
    
    If Sheets("PANNELLO").Range("E92") = "X" Then
    Exit Sub
    End If

Range("A90").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("RCECA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "RCECA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "RCECA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriRCECA()
    
    Range("A90").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("RCECA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiRCECA()
    
    Windows("RCECA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoROMANIA()
    
    If Sheets("PANNELLO").Range("E98") = "X" Then
    Exit Sub
    End If

Range("A96").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("ROMANIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "ROMANIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "ROMANIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriROMANIA()
    
    Range("A96").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("ROMANIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiROMANIA()
    
    Windows("ROMANIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoRUSSIA()
    
    If Sheets("PANNELLO").Range("E104") = "X" Then
    Exit Sub
    End If

Range("A102").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("RUSSIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "RUSSIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "RUSSIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriRUSSIA()
    
    Range("A102").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("RUSSIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiRUSSIA()
    
    Windows("RUSSIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoSCOZIA()
    
    If Sheets("PANNELLO").Range("E110") = "X" Then
    Exit Sub
    End If

Range("A108").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SCOZIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SCOZIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SCOZIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriSCOZIA()
    
    Range("A108").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SCOZIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiSCOZIA()
    
    Windows("SCOZIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoSPAGNA()
    
    If Sheets("PANNELLO").Range("E116") = "X" Then
    Exit Sub
    End If

Range("A114").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SPAGNA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SPAGNA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SPAGNA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriSPAGNA()
    
    Range("A114").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SPAGNA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiSPAGNA()
    
    Windows("SPAGNA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoSVEZIA()
    
    If Sheets("PANNELLO").Range("E122") = "X" Then
    Exit Sub
    End If

Range("A120").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SVEZIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SVEZIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SVEZIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriSVEZIA()
    
    Range("A120").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SVEZIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiSVEZIA()
    
    Windows("SVEZIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoSVIZZERA()
    
    If Sheets("PANNELLO").Range("E128") = "X" Then
    Exit Sub
    End If

Range("A126").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SVIZZERA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "SVIZZERA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "SVIZZERA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriSVIZZERA()
    
    Range("A126").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("SVIZZERA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiSVIZZERA()
    
    Windows("SVIZZERA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoTURCHIA()
    
    If Sheets("PANNELLO").Range("E134") = "X" Then
    Exit Sub
    End If

Range("A132").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("TURCHIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "TURCHIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "TURCHIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriTURCHIA()
    
    Range("A132").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("TURCHIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiTURCHIA()
    
    Windows("TURCHIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoUCRAINA()
    
    If Sheets("PANNELLO").Range("E140") = "X" Then
    Exit Sub
    End If

Range("A138").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("UCRAINA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "UCRAINA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "UCRAINA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriUCRAINA()
    
    Range("A138").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("UCRAINA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiUCRAINA()
    
    Windows("UCRAINA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub impostaturnoUNGHERIA()
    
    If Sheets("PANNELLO").Range("E146") = "X" Then
    Exit Sub
    End If

Range("A144").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("UNGHERIA.xlsm").Activate
    Sheets("SERIE.A").Select
    Application.Run "UNGHERIA.xlsm!Impostaturno"
    Sheets("SERIE.B").Select
    Application.Run "UNGHERIA.xlsm!Impostaturno"
    ActiveWorkbook.Save
ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub apriUNGHERIA()
    
    Range("A144").Select
    Selection.Hyperlinks(1).Follow NewWindow:=False, AddHistory:=True
    Windows("UNGHERIA.xlsm").Activate
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Sub chiudiUNGHERIA()
    
    Windows("UNGHERIA.xlsm").Activate
    ActiveWorkbook.Save
    ActiveWindow.Close
    Windows("PRONOGenerale-v2.xlsm").Activate
    End Sub
Attribute VB_Name = "Impostaturnotutto"
Sub Impostaturnotutt()
    
    

    Call impostaturnoAUSTRIA
    Call impostaturnoBELGIO
    Call impostaturnoBRASILE
    Call impostaturnoDANIMARCA
    Call impostaturnoFINLANDIA
    Call impostaturnoFRANCIA
    Call impostaturnoGERMANIA
    Call impostaturnoINGHILTERRA
    Call impostaturnoITALIA
    Call impostaturnoNORVEGIA
    Call impostaturnoOLANDA
    Call impostaturnoPOLONIA
    Call impostaturnoPORTOGALLO
    Call impostaturnoRCECA
    Call impostaturnoROMANIA
    Call impostaturnoRUSSIA
    Call impostaturnoSCOZIA
    Call impostaturnoSPAGNA
    Call impostaturnoSVEZIA
    Call impostaturnoSVIZZERA
    Call impostaturnoTURCHIA
    Call impostaturnoUCRAINA
    Call impostaturnoUNGHERIA
    Range("A1").Select

MsgBox ("-- FINE --")

End Sub
Attribute VB_Name = "ManualAutomatic"
Sub MANUALE()
Attribute MANUALE.VB_ProcData.VB_Invoke_Func = " \n14"
'
' MANUALE Macro
'

'
    Range("E13").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E16").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E19").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E22").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E25").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E28").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E31").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E34").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E37").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E40").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E43").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E46").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E49").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E52").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E55").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E58").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E61").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E64").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E67").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E70").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E73").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E76").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E79").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E82").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E85").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E88").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E91").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E94").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E97").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E100").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E103").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E106").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E109").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E112").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E115").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E118").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E121").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E124").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E127").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E130").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E133").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E136").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E139").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E142").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E145").Select
    ActiveCell.FormulaR1C1 = "3"
    Range("E148").Select
    ActiveCell.FormulaR1C1 = "3"
Range("C11").Select
End Sub
Sub AUTOMATICO()
Attribute AUTOMATICO.VB_ProcData.VB_Invoke_Func = " \n14"
'
' AUTOMATICO Macro
'

'
    Range("E13").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E16").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E19").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E22").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E25").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E28").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E31").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E34").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E37").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E40").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E43").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E46").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E49").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E52").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E55").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E58").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E61").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E64").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E67").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E70").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E73").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E76").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E79").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E82").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E85").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E88").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E91").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E94").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E97").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E100").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E103").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E106").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E109").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E112").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E115").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E118").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E121").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E124").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E127").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E130").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E133").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E136").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E139").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E142").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E145").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("E148").Select
    ActiveCell.FormulaR1C1 = "1"
Range("C11").Select
End Sub
Attribute VB_Name = "Mischia"
Sub Mischia2()

    Application.ScreenUpdating = False

    Sheets("Foglio2").Visible = True
    Sheets("Foglio2").Select
    Cells.Select
    Selection.ClearContents
Sheets("BOLLA_CASUALE").Select
    Range("AD2:AM31").Select
    Selection.ClearContents

    Columns("A:F").Select
    Selection.Copy
    Sheets("Foglio2").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "D1:D5012"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("A1:F5012")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Range("G1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-6]="""","""",IF(AND(RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>"""",RC[-3]<>"""",RC[-2]<>""""),RC[-6],""""))"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-7]="""","""",IF(AND(RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>"""",RC[-3]<>""""),RC[-3],""""))"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-8]="""","""",IF(AND(RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>""""),RC[-7],""""))"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]="""","""",IF(AND(RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>""""),RC[-7],""""))"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-10]="""","""",IF(AND(RC[-10]<>"""",RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>""""),RC[-7],""""))"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(AND(RC[-11]<>"""",RC[-10]<>"""",RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>""""),RC[-6],""""))"
    Range("G1:L1").Select
    Selection.AutoFill Destination:=Range("G1:L3000"), Type:=xlFillDefault
    Range("G1:L3000").Select
    Selection.Copy
    Range("G1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("A:F").Select
    Selection.Delete Shift:=xlToLeft
    
    Columns("B:B").Select
    Selection.NumberFormat = "dd-mm-yyyy hh:mm"
    Columns("D:D").Select
    Selection.NumberFormat = "0%"

    Range("G1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-5]="""","""",TEXT(RC[-5],""ggmmaaaa hhmm""))"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-1],2)"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-2],3,2)"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-3],5,4)"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(RC[-4],4)"
        Range("L1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-5]="""","""",TEXT(BOLLA_CASUALE!R9C23,""ggmmaaaa hhmm""))"
    
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-1],2)"
    Range("N1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-2],3,2)"
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-3],5,4)"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(RC[-4],4)"
    Range("Q1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-16]=BOLLA_CASUALE!R2C19,BOLLA_CASUALE!R2C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R3C19,BOLLA_CASUALE!R3C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R4C19,BOLLA_CASUALE!R4C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R5C19,BOLLA_CASUALE!R5C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R6C19,BOLLA_CASUALE!R6C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_C" & _
        "ASUALE!R7C19,BOLLA_CASUALE!R7C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R8C19,BOLLA_CASUALE!R8C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R9C19,BOLLA_CASUALE!R9C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R10C19,BOLLA_CASUALE!R10C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R11C19,BOLLA_CASUALE!R11C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R12C19,BOLLA" & _
        "_CASUALE!R12C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R13C19,BOLLA_CASUALE!R13C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R14C19,BOLLA_CASUALE!R14C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R15C19,BOLLA_CASUALE!R15C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R16C19,BOLLA_CASUALE!R16C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R17C19,BOLLA_CASUALE!R17C" & _
        "20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R18C19,BOLLA_CASUALE!R18C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R19C19,BOLLA_CASUALE!R19C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R20C19,BOLLA_CASUALE!R20C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R21C19,BOLLA_CASUALE!R21C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R22C19,BOLLA_CASUALE!R22C20=""X""),""O" & _
        "K"",IF(AND(RC[-16]=BOLLA_CASUALE!R23C19,BOLLA_CASUALE!R23C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R24C19,BOLLA_CASUALE!R24C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R25C19,BOLLA_CASUALE!R25C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R26C19,BOLLA_CASUALE!R26C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R27C19,BOLLA_CASUALE!R27C20=""X""),""OK"",IF(AND(RC" & _
        "[-16]=BOLLA_CASUALE!R28C19,BOLLA_CASUALE!R28C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R29C19,BOLLA_CASUALE!R29C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R30C19,BOLLA_CASUALE!R30C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R31C19,BOLLA_CASUALE!R31C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R32C19,BOLLA_CASUALE!R32C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_C" & _
        "ASUALE!R33C19,BOLLA_CASUALE!R33C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R34C19,BOLLA_CASUALE!R34C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R35C19,BOLLA_CASUALE!R35C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R36C19,BOLLA_CASUALE!R36C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R37C19,BOLLA_CASUALE!R37C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R38C19" & _
        ",BOLLA_CASUALE!R38C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R39C19,BOLLA_CASUALE!R39C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R40C19,BOLLA_CASUALE!R40C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R41C19,BOLLA_CASUALE!R41C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R42C19,BOLLA_CASUALE!R42C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R43C19,BOLLA_CASUAL" & _
        "E!R43C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R44C19,BOLLA_CASUALE!R44C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R45C19,BOLLA_CASUALE!R45C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R46C19,BOLLA_CASUALE!R46C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R47C19,BOLLA_CASUALE!R47C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R48C19,BOLLA_CASUALE!R48C20=""X" & _
        """),""OK"","""")))))))))))))))))))))))))))))))))))))))))))))))" & _
        ""
Range("G1:Q1").Select
    Selection.AutoFill Destination:=Range("G1:Q5000"), Type:=xlFillDefault
 
 Columns("Q:Q").Select
    Selection.AutoFilter
    ActiveSheet.Range("$Q$1:$Q$5000").AutoFilter Field:=1, Criteria1:="="
    Rows("1:5000").Select
    Selection.Delete Shift:=xlUp

    Columns("D:D").Select
    Selection.NumberFormat = "0%"
    Range("R1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(AND(RC[-10]=RC[-5],RC[-9]=RC[-4],RC[-7]>RC[-2]),RC[-11],""""))"
    Range("S1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-15]="""","""",IF(AND(RC[-15]>=BOLLA_CASUALE!R11C23,RC[-15]<=BOLLA_CASUALE!R12C23),RC[-15],""""))"
    Range("R1:S1").Select
    Selection.AutoFill Destination:=Range("R1:S5000"), Type:=xlFillDefault

    Columns("R:R").Select
    Selection.NumberFormat = "d/m/yy h.mm;@"
    Rows("1:1").Select
    Selection.Copy
    Selection.Insert Shift:=xlDown
    Columns("R:R").Select
    Selection.AutoFilter
    ActiveSheet.Range("$X$1:$X$5000").AutoFilter Field:=1, Criteria1:="="
    Rows("1:5000").Select
    Selection.Delete Shift:=xlUp
    
    Columns("A:A").Select
    Selection.Copy
    Range("AA1").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("AB1").Select
    ActiveSheet.Paste
    Columns("AA:AA").Select
    Application.CutCopyMode = False
    ActiveSheet.Range("$AA$1:$AA$5012").RemoveDuplicates Columns:=1, Header:= _
        xlNo
    Columns("AB:AB").Select
    ActiveSheet.Range("$AB$1:$AB$5012").RemoveDuplicates Columns:=1, Header:= _
        xlNo
        Columns("AA:AA").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AA1:AA5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AA1:AA5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Columns("AB:AB").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AB1:AB5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AB1:AB5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("AB1:AB100").Select
    Selection.Copy
    Sheets("BOLLA_CASUALE").Select
    Range("AD2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("AE2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-1]="""","""",COUNTIF(Foglio2!R1C5:R1000C5,RC[-1]))"
    Range("AE2").Select
    Selection.AutoFill Destination:=Range("AE2:AE100"), Type:=xlFillDefault

Sheets("Foglio2").Select
    ActiveWindow.SelectedSheets.Visible = False

Sheets("BOLLA_CASUALE").Select
Range("AD3").Select
MsgBox "Fine"
End Sub

Sub Mischia1()

Application.ScreenUpdating = False

Sheets("Foglio2").Visible = True
    Sheets("Foglio2").Select
    Cells.Select
    Selection.ClearContents
Sheets("BOLLA_CASUALE").Select
    Range("AD2:AM31").Select
    Selection.ClearContents

    Columns("A:F").Select
    Selection.Copy
    Sheets("Foglio2").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "D1:D5012"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("A1:G5012")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Range("G1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-6]="""","""",IF(AND(RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>"""",RC[-3]<>"""",RC[-2]<>""""),RC[-6],""""))"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-7]="""","""",IF(AND(RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>"""",RC[-3]<>""""),RC[-3],""""))"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-8]="""","""",IF(AND(RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>"""",RC[-4]<>""""),RC[-7],""""))"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]="""","""",IF(AND(RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>"""",RC[-5]<>""""),RC[-7],""""))"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-10]="""","""",IF(AND(RC[-10]<>"""",RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>"""",RC[-6]<>""""),RC[-7],""""))"
    Range("L1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(AND(RC[-11]<>"""",RC[-10]<>"""",RC[-9]<>"""",RC[-8]<>"""",RC[-7]<>""""),RC[-6],""""))"
    Range("G1:L1").Select
    Selection.AutoFill Destination:=Range("G1:L3000"), Type:=xlFillDefault
    Range("G1:L3000").Select
    Selection.Copy
    Range("G1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("A:F").Select
    Selection.Delete Shift:=xlToLeft
    
    Columns("B:B").Select
    Selection.NumberFormat = "dd-mm-yyyy hh:mm"
    Columns("D:D").Select
    Selection.NumberFormat = "0%"

    Range("G1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-5]="""","""",TEXT(RC[-5],""ggmmaaaa hhmm""))"
    Range("H1").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-1],2)"
    Range("I1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-2],3,2)"
    Range("J1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-3],5,4)"
    Range("K1").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(RC[-4],4)"
        Range("L1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-5]="""","""",TEXT(BOLLA_CASUALE!R9C23,""ggmmaaaa hhmm""))"
    
    Range("M1").Select
    ActiveCell.FormulaR1C1 = "=LEFT(RC[-1],2)"
    Range("N1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-2],3,2)"
    Range("O1").Select
    ActiveCell.FormulaR1C1 = "=MID(RC[-3],5,4)"
    Range("P1").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(RC[-4],4)"
    Range("Q1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-16]=BOLLA_CASUALE!R2C19,BOLLA_CASUALE!R2C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R3C19,BOLLA_CASUALE!R3C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R4C19,BOLLA_CASUALE!R4C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R5C19,BOLLA_CASUALE!R5C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R6C19,BOLLA_CASUALE!R6C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_C" & _
        "ASUALE!R7C19,BOLLA_CASUALE!R7C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R8C19,BOLLA_CASUALE!R8C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R9C19,BOLLA_CASUALE!R9C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R10C19,BOLLA_CASUALE!R10C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R11C19,BOLLA_CASUALE!R11C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R12C19,BOLLA" & _
        "_CASUALE!R12C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R13C19,BOLLA_CASUALE!R13C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R14C19,BOLLA_CASUALE!R14C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R15C19,BOLLA_CASUALE!R15C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R16C19,BOLLA_CASUALE!R16C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R17C19,BOLLA_CASUALE!R17C" & _
        "20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R18C19,BOLLA_CASUALE!R18C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R19C19,BOLLA_CASUALE!R19C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R20C19,BOLLA_CASUALE!R20C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R21C19,BOLLA_CASUALE!R21C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R22C19,BOLLA_CASUALE!R22C20=""X""),""O" & _
        "K"",IF(AND(RC[-16]=BOLLA_CASUALE!R23C19,BOLLA_CASUALE!R23C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R24C19,BOLLA_CASUALE!R24C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R25C19,BOLLA_CASUALE!R25C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R26C19,BOLLA_CASUALE!R26C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R27C19,BOLLA_CASUALE!R27C20=""X""),""OK"",IF(AND(RC" & _
        "[-16]=BOLLA_CASUALE!R28C19,BOLLA_CASUALE!R28C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R29C19,BOLLA_CASUALE!R29C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R30C19,BOLLA_CASUALE!R30C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R31C19,BOLLA_CASUALE!R31C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R32C19,BOLLA_CASUALE!R32C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_C" & _
        "ASUALE!R33C19,BOLLA_CASUALE!R33C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R34C19,BOLLA_CASUALE!R34C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R35C19,BOLLA_CASUALE!R35C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R36C19,BOLLA_CASUALE!R36C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R37C19,BOLLA_CASUALE!R37C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R38C19" & _
        ",BOLLA_CASUALE!R38C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R39C19,BOLLA_CASUALE!R39C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R40C19,BOLLA_CASUALE!R40C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R41C19,BOLLA_CASUALE!R41C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R42C19,BOLLA_CASUALE!R42C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R43C19,BOLLA_CASUAL" & _
        "E!R43C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R44C19,BOLLA_CASUALE!R44C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R45C19,BOLLA_CASUALE!R45C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R46C19,BOLLA_CASUALE!R46C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R47C19,BOLLA_CASUALE!R47C20=""X""),""OK"",IF(AND(RC[-16]=BOLLA_CASUALE!R48C19,BOLLA_CASUALE!R48C20=""X" & _
        """),""OK"","""")))))))))))))))))))))))))))))))))))))))))))))))" & _
        ""
Range("G1:Q1").Select
    Selection.AutoFill Destination:=Range("G1:Q5000"), Type:=xlFillDefault
 
 Columns("Q:Q").Select
    Selection.AutoFilter
    ActiveSheet.Range("$Q$1:$Q$5000").AutoFilter Field:=1, Criteria1:="="
    Rows("1:5000").Select
    Selection.Delete Shift:=xlUp

    Columns("D:D").Select
    Selection.NumberFormat = "0%"
    Range("R1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(RC[-8]>RC[-3],RC[-11],IF(AND(RC[-8]=RC[-3],RC[-9]>RC[-4]),RC[-11],IF(AND(RC[-10]>RC[-5],RC[-9]=RC[-4]),RC[-11],IF(AND(RC[-10]=RC[-5],RC[-9]=RC[-4],RC[-7]>RC[-2]),RC[-11],"""")))))"
    Range("S1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-15]="""","""",IF(AND(RC[-15]>=BOLLA_CASUALE!R11C23,RC[-15]<=BOLLA_CASUALE!R12C23),RC[-15],""""))"
    Range("R1:S1").Select
    Selection.AutoFill Destination:=Range("R1:S5000"), Type:=xlFillDefault

    Columns("R:R").Select
    Selection.NumberFormat = "d/m/yy h.mm;@"
    Rows("1:1").Select
    Selection.Copy
    Selection.Insert Shift:=xlDown
    Columns("R:R").Select
    Selection.AutoFilter
    ActiveSheet.Range("$X$1:$X$5000").AutoFilter Field:=1, Criteria1:="="
    Rows("1:5000").Select
    Selection.Delete Shift:=xlUp
    
    Columns("A:A").Select
    Selection.Copy
    Range("AA1").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("AB1").Select
    ActiveSheet.Paste
    Columns("AA:AA").Select
    Application.CutCopyMode = False
    ActiveSheet.Range("$AA$1:$AA$5012").RemoveDuplicates Columns:=1, Header:= _
        xlNo
    Columns("AB:AB").Select
    ActiveSheet.Range("$AB$1:$AB$5012").RemoveDuplicates Columns:=1, Header:= _
        xlNo
        Columns("AA:AA").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AA1:AA5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AA1:AA5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Columns("AB:AB").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AB1:AB5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AB1:AB5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    Range("AB1:AB100").Select
    Selection.Copy
    Sheets("BOLLA_CASUALE").Select
    Range("AD2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("AE2").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-1]="""","""",COUNTIF(Foglio2!R1C5:R1000C5,RC[-1]))"
    Range("AE2").Select
    Selection.AutoFill Destination:=Range("AE2:AE100"), Type:=xlFillDefault

Sheets("Foglio2").Select
    ActiveWindow.SelectedSheets.Visible = False

Sheets("BOLLA_CASUALE").Select
Range("AD3").Select
End Sub







Attribute VB_Name = "Modulo1"
Sub Riepilogo_Prono()


Range("Cp1").Select


End Sub

Attribute VB_Name = "Questa_cartella_di_lavoro"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

'Application.UseSystemSeparators = True

Sheets("Pannello").Select
Cells(3, 4).Value = Left(ThisWorkbook.FullName, (Len(ThisWorkbook.FullName) - Len(ThisWorkbook.Name)))

End Sub

Attribute VB_Name = "Scaricadat"
Sub ScaricaDati()

myURL = [A54].Value
Set ie = CreateObject("InternetExplorer.Application")
   
With ie
    .navigate myURL
    .Visible = True
    Do While .Busy: DoEvents: Loop    'Attesa not busy
    Do While .readyState <> 4: DoEvents: Loop 'Attesa documento
End With
'
myStart = Timer  'attesa addizionale
Do
    DoEvents
    If Timer > myStart + 2 Or Timer < myStart Then Exit Do
Loop

'Leggi le tabelle, su un nuovo foglio
I = 4 'Riga di inizio copia dati
Worksheets("Dati").Activate
Range("A:G").Clear 'Pulisce la Zona dove saranno incollati i dati
Set mycoll = ie.document.getElementsByTagName("TABLE")
For Each myItm In mycoll
    For Each trtr In myItm.Rows
        For Each tdtd In trtr.Cells
            Cells(I + 1, J + 1) = tdtd.innerText 'J + 1 E' LA COLONNA DI INIZIO COPIA
            J = J + 1
        Next tdtd
        I = I + 1: J = 0
    Next trtr
I = I + 1
Next myItm

'Stop     'Vedi testo

'Chiusura IE
ie.Quit
Set ie = Nothing

Calculate


End Sub
Sub SERIEA()

Sheets("SERIE.A").Select
Range("A1").Select

Application.CutCopyMode = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual


Call ScaricaDati


Sheets("SERIE.A").Select
Range("A1").Select

Range("A57:G1000").ClearContents 'Pulisce la Zona dove saranno incollati i dati

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("Dati")
Set Ws2 = Sheets("SERIE.A")

UR1 = Ws1.Range("I" & Rows.Count).End(xlUp).Row

On Error Resume Next

For RR1 = 4 To UR1 ' inizia a scorrere le righe libere partendo dalla n|fffd| 4
    If Ws1.Range("O" & RR1).Value <> "Rinviato" And Ws1.Range("I" & RR1).Value <> "" Then 'Controlla le condizioni per copiare
        UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1 'Trova l'ultima riga libera dove copiare i dati
        Ws1.Range("I" & RR1 & ": O" & RR1).Copy 'Copia i dati
        Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues 'Incolla i dati nella prima riga libera
        
    End If
    
    Next RR1
    
    
Sheets("SERIE.A").Select

Range("A1").Select

Application.CutCopyMode = True
Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

Calculate

End Sub
Sub SERIEB()

Sheets("SERIE.B").Select
Range("A1").Select

Application.CutCopyMode = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual


Call ScaricaDati


Sheets("SERIE.B").Select
Range("A1").Select

Range("A57:G1000").ClearContents 'Pulisce la Zona dove saranno incollati i dati

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("Dati")
Set Ws2 = Sheets("SERIE.B")

UR1 = Ws1.Range("I" & Rows.Count).End(xlUp).Row

On Error Resume Next

For RR1 = 4 To UR1 ' inizia a scorrere le righe libere partendo dalla n|fffd| 4
    If Ws1.Range("O" & RR1).Value <> "Rinviato" And Ws1.Range("I" & RR1).Value <> "" Then 'Controlla le condizioni per copiare
        UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1 'Trova l'ultima riga libera dove copiare i dati
        Ws1.Range("I" & RR1 & ": O" & RR1).Copy 'Copia i dati
        Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues 'Incolla i dati nella prima riga libera
        
    End If
    
    Next RR1
    
    
Sheets("SERIE.B").Select

Range("A1").Select

Application.CutCopyMode = True
Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

Calculate

    Range("D6").Select
End Sub
Sub SERIEC()

Sheets("SERIE.C").Select
Range("A1").Select

Application.CutCopyMode = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual


Call ScaricaDati


Sheets("SERIE.C").Select
Range("A1").Select

Range("A57:G1000").ClearContents 'Pulisce la Zona dove saranno incollati i dati

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("Dati")
Set Ws2 = Sheets("SERIE.C")

UR1 = Ws1.Range("I" & Rows.Count).End(xlUp).Row

On Error Resume Next

For RR1 = 4 To UR1 ' inizia a scorrere le righe libere partendo dalla n|fffd| 4
    If Ws1.Range("O" & RR1).Value <> "Rinviato" And Ws1.Range("I" & RR1).Value <> "" Then 'Controlla le condizioni per copiare
        UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1 'Trova l'ultima riga libera dove copiare i dati
        Ws1.Range("I" & RR1 & ": O" & RR1).Copy 'Copia i dati
        Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues 'Incolla i dati nella prima riga libera
        
    End If
    
    Next RR1
    
    
Sheets("SERIE.C").Select

Range("A1").Select

Application.CutCopyMode = True
Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

Calculate

End Sub
Sub SERIED()

Sheets("SERIE.D").Select
Range("A1").Select

Application.CutCopyMode = False
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual


Call ScaricaDati


Sheets("SERIE.D").Select
Range("A1").Select

Range("A57:G1000").ClearContents 'Pulisce la Zona dove saranno incollati i dati

Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("Dati")
Set Ws2 = Sheets("SERIE.D")

UR1 = Ws1.Range("I" & Rows.Count).End(xlUp).Row

On Error Resume Next

For RR1 = 4 To UR1 ' inizia a scorrere le righe libere partendo dalla n|fffd| 4
    If Ws1.Range("O" & RR1).Value <> "Rinviato" And Ws1.Range("I" & RR1).Value <> "" Then 'Controlla le condizioni per copiare
        UR2 = Ws2.Range("A" & Rows.Count).End(xlUp).Row + 1 'Trova l'ultima riga libera dove copiare i dati
        Ws1.Range("I" & RR1 & ": O" & RR1).Copy 'Copia i dati
        Ws2.Range("A" & UR2).PasteSpecial Paste:=xlPasteValues 'Incolla i dati nella prima riga libera
        
    End If
    
    Next RR1
    
    
Sheets("SERIE.D").Select

Range("A1").Select

Application.CutCopyMode = True
Application.ScreenUpdating = True
Application.Calculation = xlCalculationAutomatic

Calculate

End Sub

Attribute VB_Name = "SceltaPronostic"
Sub SceltaPronosticirandom()


    Application.ScreenUpdating = False
    Sheets("Foglio2").Visible = True
    Sheets("Foglio2").Select
    Columns("AC:AO").Select
    Selection.ClearContents
    Columns("AE:AI").Select
    Selection.NumberFormat = "General"
    Range("AD1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-2]="""","""",BOLLA_CASUALE!R[1]C[2])"
Range("AE1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-3]="""",RC[-1]=""""),1000,IF(OR(RC[-1]=1,RC[-1]=2,RC[-1]=3,RC[-1]=4,RC[-1]=5),1&RC[-3],1000))"
Range("AF1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-4]="""",RC[-2]=""""),1000,IF(OR(RC[-2]=2,RC[-2]=3,RC[-2]=4,RC[-2]=5),2&RC[-4],1000))"
Range("AG1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-5]="""",RC[-3]=""""),1000,IF(OR(RC[-3]=3,RC[-3]=4,RC[-3]=5),3&RC[-5],1000))"
Range("AH1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-6]="""",RC[-4]=""""),1000,IF(OR(RC[-4]=4,RC[-4]=5),4&RC[-6],1000))"
Range("AI1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-7]="""",RC[-5]=""""),1000,IF(RC[-5]=5,5&RC[-7],1000))"
Range("AD1:AI1").Select
    Selection.AutoFill Destination:=Range("AD1:AI25"), Type:=xlFillDefault
Range("AD1:AI25").Select
    Selection.Copy
Range("AD1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Range("AE1:AI1").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(0, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE2:AI2").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE3:AI3").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE4:AI4").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE5:AI5").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE6:AI6").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE7:AI7").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE8:AI8").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE9:AI9").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE10:AI10").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE11:AI11").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE12:AI12").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE13:AI13").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE14:AI14").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE15:AI15").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE16:AI16").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE17:AI17").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE18:AI18").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE19:AI19").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE20:AI20").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE21:AI21").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE22:AI22").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE23:AI23").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE24:AI24").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE25:AI25").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True

Columns("AC:AC").Select
    Selection.Replace What:="1000", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.SpecialCells(xlCellTypeBlanks).Select
    Selection.Delete Shift:=xlUp

    Columns("AD:AJ").Select
    Selection.ClearContents
Columns("E:E").Select
    Selection.Copy
    Range("AF1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("A:A").Select
    Selection.Copy
    Range("AG1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("B:B").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("AH1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("AH:AH").Select
    Application.CutCopyMode = False
    Selection.NumberFormat = "d/m/yy h.mm;@"
Columns("C:D").Select
    Selection.Copy
    Range("AI1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.AutoFilter
Columns("AD:AE").Select
    Selection.ClearContents
    
Columns("AJ:AJ").Select
    Selection.NumberFormat = "0%"
    
    
    Columns("W:W").Select
    Selection.NumberFormat = "General"
    Range("W1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-5]="""","""",RANDBETWEEN(1,10))"
    Range("W1").Select
    Selection.AutoFill Destination:=Range("W1:W1000"), Type:=xlFillDefault
    Columns("A:W").Select
    Range("W1").Activate
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "W1:W5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("A1:W5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
       
    Columns("A:D").Select
    Selection.Copy
    Range("AG1").Select
    ActiveSheet.Paste
    Columns("E:E").Select
    Selection.Copy
    Range("AF1").Select
    ActiveSheet.Paste
    Columns("F:F").Select
    Selection.Copy
    Range("AK1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
   Columns("AF:AK").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AF1:AF5014"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AF1:AK5014")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Range("AD1").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("AD2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[2]="""","""",IF(RC[2]=R[-1]C[2],R[-1]C+1,1))"
    Range("AE1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",CONCATENATE(RC[-1],RC[1]))"
    Range("AE2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",CONCATENATE(RC[-1],RC[1]))"
    Range("AD2:AE2").Select
    Selection.AutoFill Destination:=Range("AD2:AE1000"), Type:=xlFillDefault

    Columns("AD:AD").Select
    Selection.Copy
    Range("AD1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("AL1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-6]="""","""",IF(ISERROR(VLOOKUP(RC[-9],R1C31:R700C37,3,0)),"""",VLOOKUP(RC[-9],R1C31:R700C37,3,0)))"
    Range("AM1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-7]="""","""",IF(ISERROR(VLOOKUP(RC[-10],R1C31:R700C37,4,0)),"""",VLOOKUP(RC[-10],R1C31:R700C37,4,0)))"
    Range("AN1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-8]="""","""",IF(ISERROR(VLOOKUP(RC[-11],R1C31:R700C37,5,0)),"""",VLOOKUP(RC[-11],R1C31:R700C37,5,0)))"
    Range("AO1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]="""","""",IF(ISERROR(VLOOKUP(RC[-12],R1C31:R700C37,6,0)),"""",VLOOKUP(RC[-12],R1C31:R700C37,6,0)))"
    Range("AP1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-10]="""","""",IF(ISERROR(VLOOKUP(RC[-13],R1C31:R700C37,2,0)),"""",VLOOKUP(RC[-13],R1C31:R700C37,2,0)))"
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(ISERROR(VLOOKUP(RC[-14],R1C31:R700C37,7,0)),"""",VLOOKUP(RC[-14],R1C31:R700C37,7,0)))"
    Range("AL1:AQ1").Select
    Selection.AutoFill Destination:=Range("AL1:AQ500"), Type:=xlFillDefault

Sheets("Foglio2").Select
    ActiveWindow.SelectedSheets.Visible = False
    
Sheets("BOLLA_CASUALE").Select
    Range("AI2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AJ2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AK2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AL2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AM2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AN2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AI2:AN2").Select
    Selection.AutoFill Destination:=Range("AI2:AN31"), Type:=xlFillDefault
    
    Range("AH2").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("AH3").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",R[-1]C+1)"
    Range("AH3").Select
    Selection.AutoFill Destination:=Range("AH3:AH31"), Type:=xlFillDefault

Range("AH2:AN31").Select
    ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort.SortFields.Add Key:=Range("AJ2:AJ31") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort
        .SetRange Range("AI2:AN31")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Columns("AJ:AJ").Select
    Selection.NumberFormat = "dd-mm-yyyy hh:mm"

Range("AG2").Select


End Sub


Sub SceltaPronosticipercentuale()

    Application.ScreenUpdating = False
    Sheets("Foglio2").Visible = True
    Sheets("Foglio2").Select
    Columns("AC:AO").Select
    Selection.ClearContents
    Columns("AE:AI").Select
    Selection.NumberFormat = "General"
    Range("AD1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-2]="""","""",BOLLA_CASUALE!R[1]C[2])"
Range("AE1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-3]="""",RC[-1]=""""),1000,IF(OR(RC[-1]=1,RC[-1]=2,RC[-1]=3,RC[-1]=4,RC[-1]=5),1&RC[-3],1000))"
Range("AF1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-4]="""",RC[-2]=""""),1000,IF(OR(RC[-2]=2,RC[-2]=3,RC[-2]=4,RC[-2]=5),2&RC[-4],1000))"
Range("AG1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-5]="""",RC[-3]=""""),1000,IF(OR(RC[-3]=3,RC[-3]=4,RC[-3]=5),3&RC[-5],1000))"
Range("AH1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-6]="""",RC[-4]=""""),1000,IF(OR(RC[-4]=4,RC[-4]=5),4&RC[-6],1000))"
Range("AI1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(AND(RC[-7]="""",RC[-5]=""""),1000,IF(RC[-5]=5,5&RC[-7],1000))"
Range("AD1:AI1").Select
    Selection.AutoFill Destination:=Range("AD1:AI25"), Type:=xlFillDefault
Range("AD1:AI25").Select
    Selection.Copy
Range("AD1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Range("AE1:AI1").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(0, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE2:AI2").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE3:AI3").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE4:AI4").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE5:AI5").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE6:AI6").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE7:AI7").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE8:AI8").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE9:AI9").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE10:AI10").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE11:AI11").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE12:AI12").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE13:AI13").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE14:AI14").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE15:AI15").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE16:AI16").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE17:AI17").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE18:AI18").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE19:AI19").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE20:AI20").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE21:AI21").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE22:AI22").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE23:AI23").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE24:AI24").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True
Range("AE25:AI25").Select
Selection.Copy
Range("AC65000").End(xlUp).Offset(1, 0).Select
Selection.PasteSpecial Paste:=xlPasteAll, Operation:=xlNone, SkipBlanks:= _
        False, Transpose:=True

Columns("AC:AC").Select
    Selection.Replace What:="1000", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.SpecialCells(xlCellTypeBlanks).Select
    Selection.Delete Shift:=xlUp

    Columns("AD:AJ").Select
    Selection.ClearContents
Columns("E:E").Select
    Selection.Copy
    Range("AF1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Columns("F:F").Select
    Selection.Copy
    Range("AK1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("A:A").Select
    Selection.Copy
    Range("AG1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("B:B").Select
    Application.CutCopyMode = False
    Selection.Copy
    Range("AH1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Columns("AH:AH").Select
    Application.CutCopyMode = False
    Selection.NumberFormat = "d/m/yy h.mm;@"
Columns("C:D").Select
    Selection.Copy
    Range("AI1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.AutoFilter
Columns("AD:AE").Select
    Selection.ClearContents
    
Columns("AJ:AJ").Select
    Selection.NumberFormat = "0%"
    
 Columns("AF:AK").Select
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AF1:AF356"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortNormal
    ActiveWorkbook.Worksheets("Foglio2").Sort.SortFields.Add Key:=Range( _
        "AJ1:AJ356"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:= _
        xlSortNormal
    With ActiveWorkbook.Worksheets("Foglio2").Sort
        .SetRange Range("AF1:AK356")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Range("AD1").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("AD2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[2]="""","""",IF(RC[2]=R[-1]C[2],R[-1]C+1,1))"
    Range("AE1").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",CONCATENATE(RC[-1],RC[1]))"
    Range("AE2").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",CONCATENATE(RC[-1],RC[1]))"
    Range("AD2:AE2").Select
    Selection.AutoFill Destination:=Range("AD2:AE1000"), Type:=xlFillDefault

    Columns("AE:AE").Select
    Selection.Copy
    Range("AE1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("AL1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-6]="""","""",IF(ISERROR(VLOOKUP(RC[-9],R1C31:R700C37,3,0)),"""",VLOOKUP(RC[-9],R1C31:R700C37,3,0)))"
    Range("AM1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-7]="""","""",IF(ISERROR(VLOOKUP(RC[-10],R1C31:R700C37,4,0)),"""",VLOOKUP(RC[-10],R1C31:R700C37,4,0)))"
    Range("AN1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-8]="""","""",IF(ISERROR(VLOOKUP(RC[-11],R1C31:R700C37,5,0)),"""",VLOOKUP(RC[-11],R1C31:R700C37,5,0)))"
    Range("AO1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-9]="""","""",IF(ISERROR(VLOOKUP(RC[-12],R1C31:R700C37,6,0)),"""",VLOOKUP(RC[-12],R1C31:R700C37,6,0)))"
    Range("AP1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-10]="""","""",IF(ISERROR(VLOOKUP(RC[-13],R1C31:R700C37,2,0)),"""",VLOOKUP(RC[-13],R1C31:R700C37,2,0)))"
    Range("AQ1").Select
    ActiveCell.FormulaR1C1 = _
        "=IF(RC[-11]="""","""",IF(ISERROR(VLOOKUP(RC[-14],R1C31:R700C37,7,0)),"""",VLOOKUP(RC[-14],R1C31:R700C37,7,0)))"
    Range("AL1:AQ1").Select
    Selection.AutoFill Destination:=Range("AL1:AQ500"), Type:=xlFillDefault

Sheets("Foglio2").Select
    ActiveWindow.SelectedSheets.Visible = False
    
Sheets("BOLLA_CASUALE").Select
    Range("AI2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AJ2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AK2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AL2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AM2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AN2").Select
    ActiveCell.FormulaR1C1 = "=IF(Foglio2!R[-1]C[3]="""","""",Foglio2!R[-1]C[3])"
    Range("AI2:AN2").Select
    Selection.AutoFill Destination:=Range("AI2:AN31"), Type:=xlFillDefault
    
    Range("AH2").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("AH3").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[1]="""","""",R[-1]C+1)"
    Range("AH3").Select
    Selection.AutoFill Destination:=Range("AH3:AH31"), Type:=xlFillDefault

Range("AH2:AN31").Select
    ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort.SortFields.Add Key:=Range("AJ2:AJ31") _
        , SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("BOLLA_CASUALE").Sort
        .SetRange Range("AI2:AN31")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

    Columns("AJ:AJ").Select
    Selection.NumberFormat = "dd-mm-yyyy hh:mm"

Range("AG2").Select

End Sub







Attribute VB_Name = "Superboll"
Sub SUPERBOLLA()
Attribute SUPERBOLLA.VB_ProcData.VB_Invoke_Func = " \n14"



Application.ScreenUpdating = False

Range("R5:ab50000").Select
   
    Selection.ClearContents
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

    Range("a4:k2000").Select
    Selection.Copy
    Range("R5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("superbolla").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("superbolla").Sort.SortFields.Add Key:=Range("x5:x2000" _
        ), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("superbolla").Sort
        .SetRange Range("R5:ab2000")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    
    For ab = 15 To 20000
    If Range("R" & ab) <> "" Then
    inizio_copia = ab - 1
    Exit For
    End If
    Next ab
    

Range("R5:ab" & inizio_copia).Select
Selection.ClearContents
Selection.Delete Shift:=xlUp


For ab = 5 To 20000
    If Range("R" & ab) = "" Then
    inizio_copia_1 = ab - 1
    Exit For
    End If
    Next ab
    
Range("R5:ab" & inizio_copia_1).Select
  With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Add Key:= _
        Range("X4:X1872"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.Range("$R$4:$AB$1872").AutoFilter Field:=7, Criteria1:="<>"
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Add Key:= _
        Range("X4:X1872"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.Range("$R$4:$AB$1872").AutoFilter Field:=7, Criteria1:="<>"
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort.SortFields.Add Key:= _
        Range("X4:X1872"), SortOn:=xlSortOnValues, Order:=xlDescending, DataOption _
        :=xlSortNormal
    With ActiveWorkbook.Worksheets("SUPERBOLLA").AutoFilter.Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    ActiveSheet.Range("$R$4:$AB$1872").AutoFilter Field:=2, Criteria1:="<>"
    Range("R14:AB9014").Select
    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    With Selection.Font
        .ThemeColor = xlThemeColorDark1
        .TintAndShade = 0
    End With
    Range("T1").Select
End Sub

' InQuest injected base64 decoded content
' P$@ 
' /j{b
' z{njW

INQUEST-PP=macro
