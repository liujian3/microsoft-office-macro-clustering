Attribute VB_Name = "Module1"


Public Row As Double
Attribute VB_Name = "Module2"
Option Compare Text ' case insensitive
Public SC_Svc_List As String
Public Layout_Svc_List As String
Public FG_List As String

Public Item_ATP As String

Public Price_List As String
Public PL_Currency As String
Public SearchText As String
Public SearchText1 As String
Public SearchText2 As String
Public SearchText3 As String
Public SearchPattern As String
Public Item As String
Public Model As String

'Public DEL_Perc_Rep As Integer
'Public DEL_Perc_Invest As Integer
'Public DEL_Perc_CalNet As Integer
'Public DEL_Perc_Calintl As Integer
'Public DEL_Perc_Action As Integer
Public DEL_SvcGrp As String
Public DEL_SC_LineH As Integer
Public DEL_SC_Com As String
Public DEL_Publ As String
Public DEL_RMA_LineH As String
Public DEL_RMA_Com As String

'Public NLL_Perc_Rep As Integer
'Public NLL_Perc_Invest As Integer
'Public NLL_Perc_CalNet As Integer
'Public NLL_Perc_Calintl As Integer
'Public NLL_Perc_Action As Integer
Public NLL_SvcGrp As String
Public NLL_SC_LineH As Integer
Public NLL_SC_Com As String
Public NLL_Publ As String
Public NLL_RMA_LineH As String
Public NLL_RMA_Com As String

'Public UKL_Perc_Rep As Integer
'Public UKL_Perc_Invest As Integer
'Public UKL_Perc_CalNet As Integer
'Public UKL_Perc_Calintl As Integer
'Public UKL_Perc_Action As Integer
Public UKL_SvcGrp As String
Public UKL_SC_LineH As Integer
Public UKL_SC_Com As String
Public UKL_Publ As String
Public UKL_RMA_LineH As String
Public UKL_RMA_Com As String

Public FASC_Rep_Policy As String
Public FASC_Publ As String
Public FASC_LineH As Integer
Public FASC_Com As String

Public Svc_Price_Resp As String
' Public Perc_Rep As Integer
' Public Perc_Invest As Integer
' Public Perc_CalNet As Integer
' Public Perc_Calintl As Integer
' Public Perc_Action As Integer
Public SC_LineH As Integer
Public SC_Comment As String
Public RMA_LineH As Integer
Public RMA_Comment As String

Public WarrPeriod As String
Public FG_Warranty As String
Public MetCal_Proc As String
Public EoS As String
Public MfgSite As String
Public ProdFamily As String
Public ModelGroup As String
Public FG_Obs_Date As String
Public UGK As String
Public Division As String

Public RBR_Price As String
Public PL_LineH_Com As Integer ' The variable used to change columns
Public PL_Comment As Integer
Public PL_ColumnVar As Integer ' Used to select the service center / price list information
Public CurrentDate As Date

Public SC_UGK_Com As String
Public FASC_UGK_Com As String
Public RMA_UGK_Com As String
Public EURO_RMA_LineH As Integer
Public EURO_RMA_Com As String

Public IC_Item As String
Public IC_Model As String
Public OG_Item As String
Public OG_Model As String
'
Sub Auto_Open()
  Worksheets("Search").Activate ' select the Search worksheet
  Worksheets("Search").Range("A6").Select 'force scroll to top cell
End Sub
'
Sub Assign_Search_Pattern()
Attribute Assign_Search_Pattern.VB_ProcData.VB_Invoke_Func = "S\n14"
  SearchPattern = "*" + Worksheets("Search").Range("C3") + "*"
  '
  ' Other variables
  ' *** ALL RANGE CHANGED FROM 10000 TO 20000 ***
  CurrentDate = Now ' Assign current system date and time
  SC_Svc_List = Worksheets("Search").Range("G2").Value ' Service Center Price List selected for service price excluding the combined service prices
  Layout_Svc_List = Worksheets("Search").Range("H2").Value ' Price List Layout for service price excluding the combined service prices
  FG_List = Worksheets("Search").Range("I2").Value ' Service Center Price List selected for service price excluding the combined service prices
  '
  ' Filter for price list types; service, upgrade, part, and FG + OTC
  '
  Worksheets("Search").Range("A6:P20000").UnMerge ' unmerge search result area
  Worksheets("Search").Range("A6:P20000").Value = "" ' clear search result area (largest area)
  Worksheets("Search").Range("A6:P20000").Style = "Normal" ' return to defaults for search result area
  Worksheets("Search").Range("A6:P20000").Interior.ColorIndex = 2 ' paint the search result area white
  Worksheets("Search").Range("A6:P20000").Value = "" ' clear search result area
  If Layout_Svc_List = "Short List" Or Layout_Svc_List = "Extended" Then ' Execute Search for service prices
    If SC_Svc_List = "DEL" Or SC_Svc_List = "NLL" Or SC_Svc_List = "UKL-euro" Or SC_Svc_List = "UKL-gbp" Or SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
      Worksheets("Search").Range("G2:I2").Interior.ColorIndex = 6
      Worksheets("Search").Range("G2:I2").Font.ColorIndex = 3
      Call Svc_Search ' Execute Search for service prices
    Else
      Worksheets("Search").Range("B1").Value = "INCOMPLETE SELECTION"
      Worksheets("Search").Range("D2").Value = "0"
      Worksheets("Search").Range("E2").Value = "models found."
      Worksheets("Search").Range("G2").Interior.ColorIndex = 3
      Worksheets("Search").Range("G2").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Interior.ColorIndex = 3
      Worksheets("Search").Range("C7").Font.Size = 12
      Worksheets("Search").Range("C7").Font.Bold = True
      Worksheets("Search").Range("C7").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Value = "Please select calibration lab, eg. DEL, NLL, UKL, or EU"
      Worksheets("Search").Range("C7:I7").Merge
      MatchRow = MatchRow + 1 ' fouttest
      Worksheets("Search").Range("B7:I7").RowHeight = 16
      Worksheets("Search").Range("A200:J20000").Select
      Selection.Delete Shift:=xlUp
      Worksheets("Search").Range("C7").Select
      Worksheets("Search").Range("C3").Select
    End If
  End If
  If Layout_Svc_List = "Upgrade" Then
    If SC_Svc_List = "DEL" Or SC_Svc_List = "NLL" Or SC_Svc_List = "UKL-euro" Or SC_Svc_List = "UKL-gbp" Or SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
      Worksheets("Search").Range("G2:I2").Interior.ColorIndex = 6
      Worksheets("Search").Range("G2:I2").Font.ColorIndex = 3
      Call UGK_Search ' Execute Search for upgrade price
    Else
      Worksheets("Search").Range("B1").Value = "INCOMPLETE SELECTION"
      Worksheets("Search").Range("D2").Value = "0"
      Worksheets("Search").Range("E2").Value = "models found."
      Worksheets("Search").Range("G2").Interior.ColorIndex = 3
      Worksheets("Search").Range("G2").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Interior.ColorIndex = 3
      Worksheets("Search").Range("C7").Font.Size = 12
      Worksheets("Search").Range("C7").Font.Bold = True
      Worksheets("Search").Range("C7").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Value = "Please select calibration lab, eg. DEL, NLL, UKL, or EU"
      Worksheets("Search").Range("C7:I7").Merge
      MatchRow = MatchRow + 1 ' fouttest
      Worksheets("Search").Range("B7:I7").RowHeight = 16
      Worksheets("Search").Range("A200:J20000").Select
      Selection.Delete Shift:=xlUp
      Worksheets("Search").Range("C7").Select
      Worksheets("Search").Range("C3").Select
    End If
  End If
  If Layout_Svc_List = "Part" Then
    If FG_List = "Euro Country" Or FG_List = "Denmark" Or FG_List = "EEMEA in USD" Or FG_List = "Norway" Or FG_List = "Sweden" Or FG_List = "Switzerland" Or FG_List = "UK in GBP" Then
      Worksheets("Search").Range("G2:I2").Interior.ColorIndex = 6
      Worksheets("Search").Range("G2:I2").Font.ColorIndex = 3
      Call Part_Search ' Execute Search for part price
    Else
      Worksheets("Search").Range("B1").Value = "INCOMPLETE SELECTION"
      Worksheets("Search").Range("D2").Value = "0"
      Worksheets("Search").Range("E2").Value = "models found."
      Worksheets("Search").Range("I2").Interior.ColorIndex = 3
      Worksheets("Search").Range("I2").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Interior.ColorIndex = 3
      Worksheets("Search").Range("C7").Font.Size = 12
      Worksheets("Search").Range("C7").Font.Bold = True
      Worksheets("Search").Range("C7").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Value = "Please select country or area price list, eg. European, Denmark, Norway, Sweden, Switzerland, or EMEA"
      Worksheets("Search").Range("C7:I7").Merge
      MatchRow = MatchRow + 1 ' fouttest
      Worksheets("Search").Range("B7:I7").RowHeight = 16
      Worksheets("Search").Range("A200:J20000").Select
      Selection.Delete Shift:=xlUp
      Worksheets("Search").Range("C7").Select
      Worksheets("Search").Range("C3").Select
    End If
  End If
  If Layout_Svc_List = "FG + OTC" Then
    If FG_List = "Euro Country" Or FG_List = "Denmark" Or FG_List = "EEMEA in USD" Or FG_List = "Norway" Or FG_List = "Sweden" Or FG_List = "Switzerland" Or FG_List = "UK in GBP" Then
      Worksheets("Search").Range("G2:I2").Interior.ColorIndex = 6
      Worksheets("Search").Range("G2:I2").Font.ColorIndex = 3
      Call FG_Search ' Execute Search for FG and its OTC prices
    Else
      Worksheets("Search").Range("B1").Value = "INCOMPLETE SELECTION"
      Worksheets("Search").Range("D2").Value = "0"
      Worksheets("Search").Range("E2").Value = "models found."
      Worksheets("Search").Range("I2").Interior.ColorIndex = 3
      Worksheets("Search").Range("I2").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Interior.ColorIndex = 3
      Worksheets("Search").Range("C7").Font.Size = 12
      Worksheets("Search").Range("C7").Font.Bold = True
      Worksheets("Search").Range("C7").Font.ColorIndex = 2
      Worksheets("Search").Range("C7").Value = "Please select country or area price list, eg. European, Denmark, Norway, Sweden, Switzerland, or EMEA"
      Worksheets("Search").Range("C7:I7").Merge
      MatchRow = MatchRow + 1 ' fouttest
      Worksheets("Search").Range("B7:I7").RowHeight = 16
      Worksheets("Search").Range("A200:J20000").Select
      Selection.Delete Shift:=xlUp
      Worksheets("Search").Range("C7").Select
      Worksheets("Search").Range("C3").Select
    End If
  End If
End Sub
'
' Price List Model Search
'
' Initial Creation: June 26, 2006 as V07-1 version by Henry Boelaars
'
' Modifications: See "Macros to search for prices V0x-y - dd-mm-yy" macro information
' V09-2:   - One price list for DEL, NLL, UKL, and FASC / European price list
'
'
' Search by Model and display Price & EDR Info
' Macro runs automatically when workbook is opened
'
Sub Svc_Search()
'
' Main tabs for this sub
'
  ' Header Row
  ' Assign Cal Descriptions
  ' Assign Combined Service Descriptions
  ' Clear search results area (5000 rows)
  ' Rounding defaults / break points
  ' Assign variables - begin of match found
  ' Variables by service lab
  ' RBR Price List available are
  ' Output matches - Light green section - 35
  ' Output matches - Light blue section - 34
  ' Line FG - Optional used in case the search item has a price (lookup function only)
  ' Service Center comment
  ' RMA webpage / Local customer comment
  ' FASC comment
  ' Line 1  - For Standard repair and Investigation
  ' Line 2  - For Small repair and Material
  ' Line 3  - For CalNet (temporary for NLL only)
  ' Line 3b - Discounted price line due to Special Action Pricing for CalNet
  ' Line 4  - For CalNet+ and Perf
  ' Line 4b - Discounted price line due to Special Action Pricing of CalNet+ (CalNetpost)
  ' Line 5  - For CalIntl and CalIntl pre / post
  ' Line 5b - Discounted price line due to Special Action Pricing of Accredited Calibration
  ' Line 6  - Insurance / Extended Warranty & FG sales price
  ' White border as seperator for the combined prices
  ' Line 7  - Blank for begin of extended price list
  ' Line 8  - Define the Rep_CalNet value. will be CALIBRATION, TRACEABLE, W/DATA, OFFL.  (AAA)
  ' Line 9  - Define the Rep_CalNetpost and Rep_Perf value.  will be CALIBRATION, TRACEABLE, W/DATA, OFFL.  (AAA)
  ' Line 10 - Define the Rep_CalIntl and Rep_CalIntlpp value. will be CALIBRATION, ACCREDITED (NO ADJ), OFFL & CALIBRATION, ACCREDITED, OFFL. (AAA)
  ' Line 11 - Define the Warr_CalNet and Warr_Rep_CalNet value.
  ' Line 12 - Define the Warr_CalNetpost and Warr_Rep_CalNetpost value.
  ' Line 13 - Define the Warr_CalIntl and Warr_Rep_CalIntl value.
  ' Line 14 - Define the Warr_CalIntlpp and Warr_Rep_CalIntlpp value.
  ' White border between models
  ' Clear cells beyond end of matches
'
Worksheets("Search").Activate ' select the Search worksheet
Worksheets("Search").Range("A6").Select 'force scroll to top cell
'
ActiveWindow.DisplayHeadings = False ' hide row-column headings
DisplayAlerts = False ' turn off warnings when merging cell
'
' Header Row
'
' Price List Viewed
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Font.Size = 8  ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 3), Cells(5, 4)).Font.Size = 10 ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 5), Cells(5, 9)).Font.Size = 8  ' Font size of the Service Group
'
Price_Currency = 1
If SC_Svc_List = "DEL" Then
  Price_List = Worksheets("Workcodes").Cells(4, 12).Value
  PL_Currency = "EURO"
  PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "NLL" Then
  Price_List = Worksheets("Workcodes").Cells(5, 12).Value
  PL_Currency = "EURO"
  PL_ColumnVar = 15
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "UKL-gbp" Then
  Price_List = Worksheets("Workcodes").Cells(6, 12).Value
  PL_Currency = "GBP"
  Price_Currency = Worksheets("Workcodes").Cells(21, 8).Value
  PL_ColumnVar = 30
  Worksheets("Search").Range("I2").Value = "GBP" 'Blank the currency cell
End If
If SC_Svc_List = "UKL-euro" Then
  Price_List = Worksheets("Workcodes").Cells(7, 12).Value
  PL_Currency = "EURO"
  PL_ColumnVar = 30
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "EU-euro" Then
  Price_List = Worksheets("Workcodes").Cells(8, 12).Value
  PL_Currency = "EURO"
  PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "EU-usd" Then
  Price_List = Worksheets("Workcodes").Cells(9, 12).Value
  PL_Currency = "USD"
  Price_Currency = Worksheets("Workcodes").Cells(22, 8).Value
  PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "USD" 'Blank the currency cell
End If
Worksheets("Search").Cells(1, 2).Value = Price_List
'
If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
  Worksheets("Search").Cells(5, 2).Value = "TAT-GOAL"  'was ProdFam  AAA
Else
  Worksheets("Search").Cells(5, 2).Value = "TAT-GOAL"  'was SvcGrp  AAA
End If
'
Worksheets("Search").Cells(5, 3).Value = " Svc-able Model with full Description"
Worksheets("Search").Cells(5, 4).Value = "Item #"
Worksheets("Search").Cells(5, 5).Value = "WarrPeriod" '(*** gewijzigd ***)was first Upgrade(s)
Worksheets("Search").Cells(5, 6).Value = "Repair by Repl."
Worksheets("Search").Cells(5, 7).Value = "Repair LAB" '(*** gewijzigd ***)was first WarrPeriod.
Worksheets("Search").Cells(5, 8).Value = "CAL. LAB" '(*** gewijzigd ***)was first MetCal Proc.
Worksheets("Search").Cells(5, 9).Value = "E-o-S Date"
'
' Header Colors
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Interior.ColorIndex = 37 ' blue
Worksheets("Search").Range(Cells(5, 3), Cells(5, 4)).Interior.ColorIndex = 42 ' green
Worksheets("Search").Range(Cells(5, 5), Cells(5, 9)).Interior.ColorIndex = 37 ' blue
'
Dots$ = " ................................................................."
'
' Assign Cal Descriptions
'
CodeStdRep = Worksheets("Workcodes").Cells(2, 2).Value + Dots$ ' Standard repair
CodeInvest = Worksheets("Workcodes").Cells(3, 2).Value + Dots$ ' Invest / Unrepaired return
CodeSmallRep = Worksheets("Workcodes").Cells(4, 2).Value + Dots$ ' Small repair
CodeMaterial = Worksheets("Workcodes").Cells(5, 2).Value + Dots$ ' Small material
CodeCalNetpost = Worksheets("Workcodes").Cells(6, 2).Value + Dots$ ' Trac. cal. with data
CodePerf = Worksheets("Workcodes").Cells(7, 2).Value + Dots$ ' Perf test
CodeCalIntl = Worksheets("Workcodes").Cells(8, 2).Value + Dots$ ' Accr. cal.
CodeCalIntlpp = Worksheets("Workcodes").Cells(9, 2).Value + Dots$ ' Accr. cal. with pre/post data
CodeInsWarranty = Worksheets("Workcodes").Cells(10, 2).Value + Dots$ ' 12 month Insurance / Extended Warranty
CodeShipHandling = Worksheets("Workcodes").Cells(11, 2).Value + Dots$ ' Shipping & Handling
CodeCalNet = Worksheets("Workcodes").Cells(12, 2).Value + Dots$ ' Trac. cal. w/o data
CodeCalNetpostOffl = Worksheets("Workcodes").Cells(14, 2).Value + Dots$ '(AAA)
CodeCalIntlOffl = Worksheets("Workcodes").Cells(16, 2).Value + Dots$ ' (AAA)
CodeCalIntlppOffl = Worksheets("Workcodes").Cells(17, 2).Value + Dots$ ' (AAA)
'
' Assign Combined Service Descriptions
'
CallRep_CalNetpost = Worksheets("Workcodes").Cells(14, 2).Value + Dots$ ' Std repair & CalNet+
CallRep_Perf = Worksheets("Workcodes").Cells(15, 2).Value + Dots$ ' Std repair & Perf
CallRep_CalIntl = Worksheets("Workcodes").Cells(16, 2).Value + Dots$ ' Std repair & CalIntl
CallRep_CalIntlpp = Worksheets("Workcodes").Cells(17, 2).Value + Dots$ ' Std repair & CalIntl pre/post
CallWarr_CalNetpost = Worksheets("Workcodes").Cells(19, 2).Value + Dots$ ' Warranty & CalNet+
CallWarr_Rep_CalNetpost = Worksheets("Workcodes").Cells(20, 2).Value + Dots$ ' Std repair & Warranty & CalNet+
CallWarr_CalIntl = Worksheets("Workcodes").Cells(21, 2).Value + Dots$ ' Warranty & CalIntl
CallWarr_Rep_CalIntl = Worksheets("Workcodes").Cells(22, 2).Value + Dots$ ' Std repair & Warranty & CalIntl
CallWarr_CalIntlpp = Worksheets("Workcodes").Cells(23, 2).Value + Dots$ ' Warranty & CalIntl pre/post
CallWarr_Rep_CalIntlpp = Worksheets("Workcodes").Cells(24, 2).Value + Dots$ ' Std repair & Warranty & CalIntl pre/post
CallRep_CalNet = Worksheets("Workcodes").Cells(26, 2).Value + Dots$ ' Std repair & CalNet
CallWarr_CalNet = Worksheets("Workcodes").Cells(27, 2).Value + Dots$ ' Warranty & CalNet
CallWarr_Rep_CalNet = Worksheets("Workcodes").Cells(28, 2).Value + Dots$ ' Std repair & Warranty & CalNet
'
' Clear search results area (5000 rows)
'
Worksheets("Search").Range("A6:P5000").UnMerge ' UnMerge Cells
Worksheets("Search").Range("A6:P5000").Value = "" ' clear Search Results area
Worksheets("Search").Range("A6:P5000").Style = "Normal" ' set style
Worksheets("Search").Range("A6:P5000").Interior.ColorIndex = 2 ' paint area white
Worksheets("Search").Range("A6:P5000").RowHeight = 14 ' set row height
Worksheets("Search").Range("A6:P5000").Borders(xlEdgeLeft).LineStyle = xlDouble
Worksheets("Search").Range("A6:P5000").Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Worksheets("Search").Range("A6:P5000").WrapText = False ' do not wrap text
Worksheets("Search").Range("A6:P5000").Font.Bold = False ' unbold area
Worksheets("Search").Range("A6:P5000").Font.Size = 10 ' set font size
'
If Len(Worksheets("Search").Range("C3")) < 3 Then ' Must search on 3 or more characters.
  Response = MsgBox("Please enter 3 or more characters and search again. ( For 2 digit models, try preceding with a dash.If no match, enter digits followed by a space. )", 0, "Model Search Criteria")
  Exit Sub
End If
'
MatchRow = 6
Matches = 0 ' count number of matches
Worksheets("Search").Range("D2").Value = Matches ' Matches found
'
' Rounding defaults / break points
'
RounUp_Value_1 = 100000 ' Variable for rounding to 10 cent (*** gewijzigd ***)All prices will fall into first roundup.
RounUp_Value_2 = 200000 ' Variable for rounding to 20 cent (*** gewijzigd ***)
RounUp_Value_3 = 400000 ' Variable for rounding to 50 cent, or as above to 1 euro (*** gewijzigd ***)
'
For Row = 6 To 22000
  '
  Item = Worksheets("Services").Cells(Row, 1).Value
  If Len(Item) = 0 Then Exit For ' exit loop if SvcGrp cell empty
  ' SearchText1 = Worksheets("Services").Cells(Row, 1).Value ' Item
  SearchText2 = Worksheets("Services").Cells(Row, 2).Value ' Model Description
  ' SearchText3 = Worksheets("Services").Cells(Row, 2).Value ' Extra info search
  SearchText = SearchText1 + " " + SearchText2 ' + " " + SearchText3
  '
  If SearchText Like SearchPattern Then
    '
    Matches = Matches + 1 ' count number of matches
    '
    ' Assign variables - begin of match found
    '
'    Item = Worksheets("Services").Cells(Row, 1).Value
    Model = Worksheets("Services").Cells(Row, 2).Value
    '
    StdRep = Worksheets("Services").Cells(Row, 4).Value
    Invest = Worksheets("Services").Cells(Row, 5).Value
    SmallRep = Worksheets("Services").Cells(Row, 6).Value
    Material = Worksheets("Services").Cells(Row, 7).Value
    CalNetpost = Worksheets("Services").Cells(Row, 8).Value
    Perf = Worksheets("Services").Cells(Row, 9).Value
    Calintl = Worksheets("Services").Cells(Row, 10).Value
    Calintlpp = Worksheets("Services").Cells(Row, 11).Value
    InsWarranty = Worksheets("Services").Cells(Row, 12).Value
    ShipHandling = Worksheets("Services").Cells(Row, 13).Value
    Calnet = Worksheets("Services").Cells(Row, 14).Value
    CalnetpostOffl = Worksheets("Services").Cells(Row, 15).Value '(AAA)
    CalIntlOffl = Worksheets("Services").Cells(Row, 16).Value '(AAA)
    CalIntlppOffl = Worksheets("Services").Cells(Row, 17).Value '(AAA)
    '
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then SvcGrp = Worksheets("Services").Cells(Row, 74).Value ' Product Family
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Ras = Worksheets("Services").Cells(Row, 79).Value
    If SC_Svc_List = "DEL" Then SvcGrp = Worksheets("Services").Cells(Row, 31).Value ' DEL Service Group
    If SC_Svc_List = "DEL" Then Ras = Worksheets("Services").Cells(Row, 79).Value
    If SC_Svc_List = "NLL" Then SvcGrp = Worksheets("Services").Cells(Row, 46).Value ' NLL Service Group
    If SC_Svc_List = "NLL" Then Ras = Worksheets("Services").Cells(Row, 79).Value
    If SC_Svc_List = "UKL-euro" Or SC_Svc_List = "UKL-gbp" Then SvcGrp = Worksheets("Services").Cells(Row, 74).Value ' UKLService Group 'was ROW, 61, is now Product Family AAA
    If SC_Svc_List = "UKL-euro" Or SC_Svc_List = "UKL-gbp" Then Ras = Worksheets("Services").Cells(Row, 79).Value ' UKLService Group
    '
    ' DEL_Perc_Rep = Worksheets("Services").Cells(Row, 25).Value ' Discount percentage may come from different column
    ' DEL_Perc_Invest = Worksheets("Services").Cells(Row, 26).Value ' Discount percentage may come from different column
    ' DEL_Perc_CalNet = Worksheets("Services").Cells(Row, 27).Value ' Discount percentage may come from different column
    ' DEL_Perc_Calintl = Worksheets("Services").Cells(Row, 28).Value ' Discount percentage may come from different column
    ' DEL_Perc_Action = Worksheets("Services").Cells(Row, 29).Value ' Discount percentage may come from different column
    DEL_SvcGrp = Worksheets("Services").Cells(Row, 31).Value
    DEL_SC_LineH = Worksheets("Services").Cells(Row, 32).Value
    DEL_SC_Com = Worksheets("Services").Cells(Row, 33).Value
    DEL_Publ = Worksheets("Services").Cells(Row, 34).Value
    DEL_RMA_LineH = Worksheets("Services").Cells(Row, 35).Value
    DEL_RMA_Com = Worksheets("Services").Cells(Row, 36).Value
    '
    ' NLL_Perc_Rep = Worksheets("Services").Cells(Row, 40).Value ' Discount percentage may come from different column
    ' NLL_Perc_Invest = Worksheets("Services").Cells(Row, 41).Value ' Discount percentage may come from different column
    ' NLL_Perc_CalNet = Worksheets("Services").Cells(Row, 42).Value ' Discount percentage may come from different column
    ' NLL_Perc_Calintl = Worksheets("Services").Cells(Row, 43).Value ' Discount percentage may come from different column
    ' NLL_Perc_Action = Worksheets("Services").Cells(Row, 44).Value ' Discount percentage may come from different column
'    NLL_SvcGrp = Worksheets("Services").Cells(Row, 46).Value
'    NLL_SC_LineH = Worksheets("Services").Cells(Row, 47).Value
'    NLL_SC_Com = Worksheets("Services").Cells(Row, 48).Value
'    NLL_Publ = Worksheets("Services").Cells(Row, 49).Value
'    NLL_RMA_LineH = Worksheets("Services").Cells(Row, 50).Value
'    NLL_RMA_Com = Worksheets("Services").Cells(Row, 51).Value
    '
    ' UKL_Perc_Rep = Worksheets("Services").Cells(Row, 55).Value ' Discount percentage may come from different column
    ' UKL_Perc_Invest = Worksheets("Services").Cells(Row, 56).Value ' Discount percentage may come from different column
    ' UKL_Perc_CalNet = Worksheets("Services").Cells(Row, 57).Value ' Discount percentage may come from different column
    ' UKL_Perc_Calintl = Worksheets("Services").Cells(Row, 58).Value ' Discount percentage may come from different column
    ' UKL_Perc_Action = Worksheets("Services").Cells(Row, 59).Value ' Discount percentage may come from different column
'    UKL_SvcGrp = Worksheets("Services").Cells(Row, 61).Value
'    UKL_SC_LineH = Worksheets("Services").Cells(Row, 62).Value
'    UKL_SC_Com = Worksheets("Services").Cells(Row, 63).Value
'    UKL_Publ = Worksheets("Services").Cells(Row, 64).Value
'    UKL_RMA_LineH = Worksheets("Services").Cells(Row, 65).Value
'    UKL_RMA_Com = Worksheets("Services").Cells(Row, 66).Value
    '
    ' Variables by service lab
    '
    Perc_Rep = Worksheets("Services").Cells(Row, (25 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Or SC_Svc_List = "UKL-euro" Then Perc_Rep = 1
    If Perc_Rep = "" Then Perc_Rep = 1
    If Perc_Rep = "0" Then StdRep = ""
    If Perc_Rep = "q" Then
      StdRep = 1
      SmallRep = 1
      Material = 1
      Perc_Rep = 1
    End If
    Perc_Invest = Worksheets("Services").Cells(Row, (26 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Or SC_Svc_List = "UKL-euro" Then Perc_Invest = 1
    If Perc_Invest = "" Then Perc_Invest = 1
    If Perc_Invest = "0" Then Invest = ""
    If Perc_Invest = "q" Then
      Invest = 1
      Perc_Invest = 1
    End If
    Perc_CalNet = Worksheets("Services").Cells(Row, (27 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Or SC_Svc_List = "UKL-euro" Then Perc_CalNet = 1
    If Perc_CalNet = "" Then Perc_CalNet = 1
    If Perc_CalNet = "0" Then CalNetpost = ""
    If Perc_CalNet = "q" Then
      CalNetpost = 1
      Perc_CalNet = 1
    End If
    Perc_CalIntl = Worksheets("Services").Cells(Row, (28 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Or SC_Svc_List = "UKL-euro" Then Perc_CalIntl = 1
    If Perc_CalIntl = "" Then Perc_CalIntl = 1
    If Perc_CalIntl = "0" Then Calintl = ""
    If Perc_CalIntl = "q" Then
      Calintl = 1
      Perc_CalIntl = 1
    End If
    Perc_CalIntlpp = Worksheets("Services").Cells(Row, (29 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Or SC_Svc_List = "UKL-euro" Then Perc_CalIntlpp = 1
    If Perc_CalIntlpp = "" Then Perc_CalIntlpp = 1
    If Perc_CalIntlpp = "0" Then Calintlpp = ""
    If Perc_CalIntlpp = "q" Then
      Calintlpp = 1
      Perc_CalIntlpp = 1
    End If
    Perc_Action = Worksheets("Services").Cells(Row, (30 + PL_ColumnVar)).Value ' Discount percentage comes from different column
    ' If Perc_Action = "" Then Perc_Action = 1
    '
    WarrPeriod = Worksheets("Services").Cells(Row, 70).Value
      If Val(WarrPeriod) > 80 Then WarrPeriod = WarrPeriod + " days"
      If Val(WarrPeriod) > 10 And Val(WarrPeriod) <= 80 Then WarrPeriod = WarrPeriod + " months"
      If Val(WarrPeriod) > 1 And Val(WarrPeriod) <= 10 Then WarrPeriod = WarrPeriod + " years"
      If Val(WarrPeriod) = 1 Then WarrPeriod = WarrPeriod + " year"
    MetCal_Proc = Worksheets("Services").Cells(Row, 71).Value
    EoS = Worksheets("Services").Cells(Row, 72).Value
    MfgSite = Worksheets("Services").Cells(Row, 73).Value
    ProdFamily = Worksheets("Services").Cells(Row, 74).Value
    ModelGroup = Worksheets("Services").Cells(Row, 75).Value
    FG_Obs_Date = Worksheets("Services").Cells(Row, 76).Value
    UGK = Worksheets("Services").Cells(Row, 77).Value
    Svc_Price_Resp = Worksheets("Services").Cells(Row, 78).Value
    '
    FASC_Rep_Policy = Worksheets("Services").Cells(Row, 85).Value
    FASC_Publ = Worksheets("Services").Cells(Row, 86).Value
    FASC_LineH_sub = Worksheets("Services").Cells(Row, 87).Value
    If FASC_LineH_sub = "" Then
      FASC_LineH = 13
    Else
      FASC_LineH = 17 + ((FASC_LineH_sub - 1) * 13)
    End If
    FASC_Com = Worksheets("Services").Cells(Row, 88).Value
    EURO_RMA_LineH_sub = Worksheets("Services").Cells(Row, 89).Value
    If EURO_RMA_LineH_sub = "" Then
      EURO_RMA_LineH = 13
    Else
      EURO_RMA_LineH = 17 + ((EURO_RMA_LineH_sub - 1) * 13)
    End If
    EURO_RMA_Com = Worksheets("Services").Cells(Row, 90).Value
    '
    ' RBR Price List available are; E20 for gbp, E22 for euro, and E24 for usd
    ' Decided to copy from Standard Repair as this should be loaded as price for RMA online webpages
    '
    RBR_Price = "" ' Field content when it's a non RBR
    '
    ' Decided to calculate RBR price from the StdRep price from EU-euro, the price master
    '
    If StdRep <> "" Then
      StdRep_Disc = StdRep / Price_Currency
    End If
    '
    ' Roundup to 10 cent < 100 euro - RounUp_Value_1
    '
    If StdRep_Disc < RounUp_Value_1 Then
      Price_RBR_sub1 = Round(StdRep_Disc * 10, 0)
      Price_RBR_sub2 = StdRep_Disc * 10
      Price_RBR_sub3 = Price_RBR_sub2 - Price_RBR_sub1
    '
    If Price_RBR_sub3 > 0 Then
        Price_RBR = (Price_RBR_sub1 / 10) + 0.1
      Else
        Price_RBR = Price_RBR_sub1 / 10
      End If
    End If
    '
    ' Roundup to 20 cent Between 100 and 200 euro - RounUp_Value_2
    '
    If StdRep_Disc >= RounUp_Value_1 And StdRep_Disc < RounUp_Value_2 Then
      Price_RBR_sub1 = Round(StdRep_Disc * 5, 0)
      Price_RBR_sub2 = StdRep_Disc * 5
      Price_RBR_sub3 = Price_RBR_sub2 - Price_RBR_sub1
      '
      If Price_RBR_sub3 > 0 Then
        Price_RBR = (Price_RBR_sub1 / 5) + 0.2
      Else
        Price_RBR = Price_RBR_sub1 / 5
      End If
    End If
    '
    ' Roundup to 50 cent between 200 and 400 euro, and above 400 (RounUp_Value_3) to 1 euro
    '
    If StdRep_Disc >= RounUp_Value_2 And StdRep_Disc < RounUp_Value_3 Then
      Price_RBR_sub1 = Round(StdRep_Disc * 2, 0)
      Price_RBR_sub2 = StdRep_Disc * 2
      Price_RBR_sub3 = Price_RBR_sub2 - Price_RBR_sub1
      '
      If Price_RBR_sub3 > 0 Then
        Price_RBR = (Price_RBR_sub1 / 2) + 0.5
      Else
        Price_RBR = Price_RBR_sub1 / 2
      End If
    End If
    '
    ' Roundup to 1 euro above 400 - RounUp_Value_3
    '
    If StdRep_Disc >= RounUp_Value_3 Then
      Price_RBR_sub1 = Round(StdRep_Disc, 0)
      Price_RBR_sub2 = StdRep_Disc
      Price_RBR_sub3 = Price_RBR_sub2 - Price_RBR_sub1
      '
      If Price_RBR_sub3 > 0 Then
        Price_RBR = (Price_RBR_sub1) + 1
      Else
        Price_RBR = Price_RBR_sub1
      End If
    End If
    '
    ' RBR output  (*** gewijzigd ***)
    '
    PL_Comment = FASC_LineH - 13
    If FASC_Rep_Policy = "RBR" Then
      RBR_Price = StdRep
      If StdRep = 1 Then RBR_Price = "Quoted"
    End If
    '
    ' Output matches - Light green section - 35
    '
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 2)).Interior.ColorIndex = 37
    Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 35
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 3)).HorizontalAlignment = xlHAlignLeft ' left justify
    Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
    Worksheets("Search").Cells(MatchRow, 2).Font.Size = 10 ' Font size of the Service Group (was 8 AAA)
    Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
    Worksheets("Search").Cells(MatchRow, 2).Value = Left(SvcGrp, 15) 'Service group or Product Family (was 10 AAA)
    Worksheets("Search").Cells(MatchRow, 3).NumberFormat = Text ' Format String
'    Worksheets("Search").Cells(MatchRow, 3).Font.Bold = True ' Bold Model
'    Worksheets("Search").Cells(MatchRow, 3).Value = " " + Model
    Worksheets("Search").Cells(MatchRow, 3).Value = Model ' " " + Model
    If Len(Model) > 40 Then
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).VerticalAlignment = xlCenter
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 25.5
    End If
    '
    ' Output matches - Light blue section - 34
    '
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders.Color = RGB(255, 255, 255) ' white borders
    Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).UnMerge ' UnMerge Cells
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Font.Size = 8 ' Font size of the Service Group
    ' Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True ' Bold item
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter ' Center alignment
    Worksheets("Search").Cells(MatchRow, 4).Value = Item ' Don't add spaces, so copy to Oracle will work
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Interior.ColorIndex = 34
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).HorizontalAlignment = xlHAlignCenter ' mid justify
    Worksheets("Search").Cells(MatchRow, 5).Value = WarrPeriod  ' (*** gewijzigd ***)was first UGL
    '
    If PL_Currency = "EURO" Then
      Worksheets("Search").Cells(MatchRow, 6).NumberFormat = "___([$|fffd|-2]* #,##0.00 ___);___([$|fffd|-2]* (#,##0 ); ___([$|fffd|-2]* ""-"" ___);_(@ _)"
    End If
    If PL_Currency = "GBP" Then
      Worksheets("Search").Cells(MatchRow, 6).NumberFormat = "___([$|fffd|-809]* #,##0.00 ___);___([$|fffd|-809]* (#,##0 );___([$|fffd|-809]* ""-"" ___);_(@ _)"
    End If
    If PL_Currency = "USD" Then
      Worksheets("Search").Cells(MatchRow, 6).NumberFormat = "___([$$]* #,##0.00 ___);___([$$]* (#,##0 );___([$$]* ""-"" ___);_(@ _)"
    End If
    Worksheets("Search").Cells(MatchRow, 6).Font.Size = 10 ' Increase font size
    '
    If FASC_Rep_Policy = "RBR" Then
      Worksheets("Search").Cells(MatchRow, 6).Font.Bold = True ' Bold
      Worksheets("Search").Cells(MatchRow, 6).Value = RBR_Price
      Worksheets("Search").Cells(MatchRow, 6).Interior.ColorIndex = 40 ' orange
        If EoS <> "" Then
          If EoS = "EoS" Or EoS < CurrentDate Then
            Worksheets("Search").Cells(MatchRow, 6).Value = "Out of Service"
            Worksheets("Search").Cells(MatchRow, 6).Interior.ColorIndex = 3
            Worksheets("Search").Cells(MatchRow, 6).Font.Bold = True
            Worksheets("Search").Cells(MatchRow, 6).Font.ColorIndex = 2
          Else
            If PL_Comment > 0 Then
              Worksheets("Search").Cells(MatchRow, 6).Value = "Refer comments"
              Worksheets("Search").Cells(MatchRow, 6).Font.Size = 8 ' Decrease font size
              Worksheets("Search").Cells(MatchRow, 6).Interior.ColorIndex = 36
            End If
          End If
        End If
    End If
    '
    Worksheets("Search").Cells(MatchRow, 7).Value = UGK  ' (*** gewijzigd ***) was first WarrPeriod
    Worksheets("Search").Cells(MatchRow, 8).Value = MetCal_Proc
    Worksheets("Search").Cells(MatchRow, 9).Value = EoS
    Worksheets("Search").Cells(MatchRow, 9).NumberFormat = "d-mmm-yy"
    If EoS <> "" Then
      Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 38
      If EoS = "EoS" Then
        Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
        Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
        Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
      Else
        If EoS < CurrentDate Then
          Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
          Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
          Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
        End If
      End If
    End If
    '
    ' Line FG - Optional used in case the search item has a price (lookup function only)
    '
    MatchRow = MatchRow + 1 ' line increase will be undone when not required
    Worksheets("Search").Cells(MatchRow, 3).Select
    '
    FG_Price_Found = ""
    Worksheets("Search").Cells(MatchRow, 1).Value = Item
    Worksheets("Search").Cells(MatchRow, 2).Value = "=Trim(RC[-1])"
    If PL_Currency = "EURO" Then
      Worksheets("Search").Cells(MatchRow, 4).Value = "=IF(ISERROR(VLOOKUP(RC[-2],'FG + OTC'!C1:C4,4,FALSE)),"""",VLOOKUP(RC[-2],'FG + OTC'!C1:C4,4,FALSE))"
    End If
    If PL_Currency = "GBP" Then
      Worksheets("Search").Cells(MatchRow, 4).Value = "=IF(ISERROR(VLOOKUP(RC[-2],'FG + OTC'!C1:C19,19,FALSE)),"""",VLOOKUP(RC[-2],'FG + OTC'!C1:C19,19,FALSE))"
    End If
    If PL_Currency = "USD" Then
      Worksheets("Search").Cells(MatchRow, 4).Value = "=IF(ISERROR(VLOOKUP(RC[-2],'FG + OTC'!C1:C22,22,FALSE)),"""",VLOOKUP(RC[-2],'FG + OTC'!C1:C22,22,FALSE))"
    End If
    Worksheets("Search").Cells(MatchRow, 4).Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
      :=False, Transpose:=False
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 2)).Value = ""
    '
    If Worksheets("Search").Cells(MatchRow, 4).Value <> "" Then
      FG_Price_Found = Worksheets("Search").Cells(MatchRow, 4).Value
      Worksheets("Search").Cells(MatchRow, 4).Value = ""
    End If ' end of extra FG line
    MatchRow = MatchRow - 1 ' reset line counter
    '
    ' Output yellow comment row
    '
    ' Combine the two comments into one comment
    '
    FASC_PL = ""
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then FASC_PL = "EU_PL"
'    If FASC_PL <> "EU_PL" Then
    '
    ' Define comment variables by price list
    '
    PL_LineH_Com = (32 + PL_ColumnVar)
    PL_Comment = (33 + PL_ColumnVar)
    SC_LineH_sub = Worksheets("Services").Cells(Row, PL_LineH_Com).Value
    If SC_LineH_sub = "" Then
        SC_LineH = 13
      Else
        SC_LineH = 17 + ((SC_LineH_sub - 1) * 13)
    End If
    If FASC_PL = "EU_PL" Then
        SC_Comment = ""
        SC_LineH = 13
      Else
        SC_Comment = Worksheets("Services").Cells(Row, PL_Comment).Value
    End If
    '
    PL_LineH_Com = (35 + PL_ColumnVar)
    PL_Comment = (36 + PL_ColumnVar)
    RMA_LineH_sub = Worksheets("Services").Cells(Row, PL_LineH_Com).Value
    If RMA_LineH_sub = "" Then
        RMA_LineH = 13
      Else
        RMA_LineH = 17 + ((RMA_LineH_sub - 1) * 13)
    End If
    If FASC_PL = "EU_PL" Then
        RMA_Comment = EURO_RMA_Com
        RMA_LineH = EURO_RMA_LineH
      Else
        RMA_Comment = Worksheets("Services").Cells(Row, PL_Comment).Value
    End If
    '
    If SC_Comment <> "" Or RMA_Comment <> "" Or FASC_Com <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 3
    End If
    '
    ' Service Center comment
    '
    If Len(SC_Comment) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = SC_Comment
      ' Worksheets("Search").Cells(MatchRow, 3).Rows.AutoFit
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = SC_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
'      If FASC_PL <> "EU_PL" Then
        '
        ' Dotted line to seperate with the next comment to be published
        '
        If Len(RMA_Comment) > 0 Or Len(FASC_Com) > 0 Then
          With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
          End With
        End If
'      End If
    End If
    '
    ' RMA webpage / Local customer comment
    '
    If Len(RMA_Comment) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "W W W"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = RMA_Comment
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = RMA_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
'      If FASC_PL <> "EU_PL" Then
        '
        ' Dotted line to seperate with the next comment to be published
        '
        If Len(FASC_Com) > 0 Then
          With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
          End With
        End If
'      End If
    End If
    '
'    End If
    '
    ' FASC comment
    '
    If Len(FASC_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "F A S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = FASC_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = FASC_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
    End If
    '
    ' Output Prices
    '
    ' Line 1 - For Standard repair and Investigation
    '
    ' Left hand site of the price list
    '
    If StdRep <> "" Or Invest <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeStdRep
      If StdRep = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
        ' Worksheets("Search").Cells(MatchRow, 4).Value = "N/A"
      End If
      If StdRep <> "" Then
        If (StdRep * Perc_Rep) = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = (StdRep * Perc_Rep / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Left_Disc = StdRep / Price_Currency
          StdRep = Left_Disc
          '
          ' Standard repair output
          '
          If RBR_Price = "" Then
              Worksheets("Search").Cells(MatchRow, 4).Value = StdRep
            Else
              Worksheets("Search").Cells(MatchRow, 4).Value = "RBR price"
          End If
        End If
      End If
      '
      '  Right hand site of the price list
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeInvest
      If Invest = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Invest <> "" Then
        If (Invest * Perc_Invest) = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Right_Disc = (Invest * Perc_Invest / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Right_Disc = Invest / Price_Currency
          Invest = Right_Disc
          '
          ' Investigation price output (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 9).Value = Invest
        End If
      End If
    End If
    '
    ' Line 2 - For Small repair and Material
    '
    If SmallRep <> "" Or Material <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeSmallRep
      If SmallRep = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If SmallRep <> "" Then
        If SmallRep = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = (SmallRep * Perc_Rep / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Left_Disc = SmallRep / Price_Currency
          SmallRep = Left_Disc
          '
          ' Small repair price output  (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 4).Value = SmallRep
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeMaterial
      If Material = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Material <> "" Then
        If Material = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Right_Disc = (Material * Perc_Rep / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Right_Disc = Material / Price_Currency
          Material = Right_Disc
          '
          ' Material price output (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 9).Value = Material
        End If
      End If
    End If
    '
    ' Line 3 - For CalNet (temporary for NLL only)
    '
    'If SC_Svc_List = "NLL" Then ' Selection by price list selected. Skip line when not NLL-price list (Changed by AJ)
    If Calnet <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeCalNet
      If Calnet = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Calnet <> "" Then
        If Calnet = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = (Calnet * Perc_CalNet / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Left_Disc = Calnet / Price_Currency
          Calnet = Left_Disc
          '
          ' Standard CalNet output (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 4).Value = Calnet
        End If
      'End If (Changed by AJ)
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
    End If
    End If
    '
    ' Line 3b - Discounted price line due to Special Action Pricing for CalNet
    '
    If SC_Svc_List <> "EU-euro" And SC_Svc_List <> "EU-usd" Then
      '
      If Perc_Action <> "" Then
        If Calnet <> "" Then
        MatchRow = MatchRow + 1
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
        If PL_Currency = "EURO" Then
          Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
        End If
        If PL_Currency = "GBP" Then
          Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
        End If
        If PL_Currency = "USD" Then
          Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
        End If
        Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
        Worksheets("Search").Cells(MatchRow, 3).Value = " Discounted price for Traceable Calibration without Data"
        '
        If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
          Calnet = Price_Left
        Else
          CalNet_Disc = Price_Left * (1 - Perc_Action)
          Left_Disc_sub_1 = Round(CalNet_Disc * 100, 0)
          Left_Disc_sub_2 = CalNet_Disc * 100
          Left_Disc_sub_3 = Left_Disc_sub_2 - Left_Disc_sub_1
          If Left_Disc_sub_3 > 0 Then
            Calnet = (Left_Disc_sub_1 / 100) + 0.01
          Else
            Calnet = Left_Disc_sub_1 / 100
          End If
          '
          Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 4)).Interior.ColorIndex = 40
          Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 4)).Font.Bold = True ' Bold discount percentage
          Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output percentage
          Worksheets("Search").Cells(MatchRow, 2).NumberFormat = "0%"
          Worksheets("Search").Cells(MatchRow, 2).Value = Perc_Action
          Worksheets("Search").Cells(MatchRow, 4).Value = Calnet
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      End If
    End If
    '
    ' Line 4 - For CalNet+ and Perf
    '
    If CalNetpost <> "" Or Perf <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeCalNetpost
      If CalNetpost = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If CalNetpost <> "" Then
        If (CalNetpost * Perc_CalNet) = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = ((CalNetpost * Perc_CalNet) / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Left_Disc = CalNetpost / Price_Currency
          CalNetpost = Left_Disc
          ' Standard CalNet+ output (*** gewijzigd ***)
          '
          ' Accredited Calibration with Data Price output
          '
          Worksheets("Search").Cells(MatchRow, 4).Value = CalNetpost
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodePerf
      If Perf = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Perf <> "" Then
        If Perf = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 9).Value = Perf
        End If
      End If
    End If
    '
    ' Line 4b Discounted price line due to Special Action Pricing of CalNet+ (CalNetpost)
    '
    If SC_Svc_List <> "EU-euro" And SC_Svc_List <> "EU-usd" Then
      '
      If Perc_Action <> "" Then
        If CalNetpost <> "" Then
          MatchRow = MatchRow + 1
          Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
          If PL_Currency = "EURO" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
          End If
          If PL_Currency = "GBP" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
          End If
          If PL_Currency = "USD" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
          End If
          Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
          Worksheets("Search").Cells(MatchRow, 3).Value = " Discounted price for Traceable Calibration without Data"
          '
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
            CalNetpost = Price_Left
          Else
            CalNetpost_Disc = Price_Left * (1 - Perc_Action)
            Left_Disc_sub_1 = Round(CalNetpost_Disc * 100, 0)
            Left_Disc_sub_2 = CalNetpost_Disc * 100
            Left_Disc_sub_3 = Left_Disc_sub_2 - Left_Disc_sub_1
            If Left_Disc_sub_3 > 0 Then
              CalNetpost = (Left_Disc_sub_1 / 100) + 0.01
            Else
              CalNetpost = Left_Disc_sub_1 / 100
            End If
            '
            Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 4)).Interior.ColorIndex = 40
            Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 4)).Font.Bold = True ' Bold discount percentage
            Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output percentage
            Worksheets("Search").Cells(MatchRow, 2).NumberFormat = "0%"
            Worksheets("Search").Cells(MatchRow, 2).Value = Perc_Action
            Worksheets("Search").Cells(MatchRow, 4).Value = CalNetpost
          End If
        End If
        '
        Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      End If
    End If
    '
    ' Line 5 - For CalIntl and CalIntl pre / post
    '
    If Calintl <> "" Or Calintlpp <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeCalIntl
      If Calintl = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Calintl <> "" Then
        If (Calintl * Perc_CalIntl) = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = ((Calintl * Perc_CalIntl) / Price_Currency)
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then Left_Disc = Calintl / Price_Currency
          Calintl = Left_Disc
          '
          ' Accredited Calibration price output (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 4).Value = Calintl
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeCalIntlpp
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = Left(Ras, 10)
      If Calintlpp = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Calintlpp <> "" Then
        If (Calintlpp * Perc_CalIntlpp) = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Right_Disc = ((Calintlpp * Perc_CalIntlpp) / Price_Currency)
          Calintlpp = Right_Disc
          '
          ' Accredited Calibration with pre- and post data price output (*** gewijzigd ***)
          '
          Worksheets("Search").Cells(MatchRow, 9).Value = Calintlpp
        End If
      End If
    End If
    '
    ' Line 5b Discounted price line due to Special Action Pricing of Accredited Calibration
    '
    If SC_Svc_List <> "EU-euro" And SC_Svc_List <> "EU-usd" Then
      '
      If Perc_Action <> "" Then
        If Calintl <> "" Or Calintlpp <> "" Then
          MatchRow = MatchRow + 1
          Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
          If PL_Currency = "EURO" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
          End If
          If PL_Currency = "GBP" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
          End If
          If PL_Currency = "USD" Then
            Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
          End If
          Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
          Worksheets("Search").Cells(MatchRow, 3).Value = " Discounted price for Accredited Calibration"
          Worksheets("Search").Cells(MatchRow, 5).Value = " and for Accredited Calibration with pre & post Data"
          '
          If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then
            Calintl = Price_Left
          Else
            CalIntl_Disc = Price_Left * (1 - Perc_Action)
            Left_Disc_sub_1 = Round(CalIntl_Disc * 100, 0)
            Left_Disc_sub_2 = CalIntl_Disc * 100
            Left_Disc_sub_3 = Left_Disc_sub_2 - Left_Disc_sub_1
            If Left_Disc_sub_3 > 0 Then
              Calintl = (Left_Disc_sub_1 / 100) + 0.01
            Else
              Calintl = Left_Disc_sub_1 / 100
            End If
            '
            CalIntlpp_Disc = Price_Right * (1 - Perc_Action)
            Right_Disc_sub_1 = Round(CalIntlpp_Disc * 100, 0)
            Right_Disc_sub_2 = CalIntlpp_Disc * 100
            Right_Disc_sub_3 = Right_Discpp_sub_2 - Right_Disc_sub_1
            If Right_Disc_sub_3 > 0 Then
              Calintlpp = (Right_Disc_sub_1 / 100) + 0.01
            Else
              Calintlpp = Right_Disc_sub_1 / 100
            End If
            '
            Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Interior.ColorIndex = 40
            Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Font.Bold = True ' Bold discount percentage
            Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output percentage
            Worksheets("Search").Cells(MatchRow, 2).NumberFormat = "0%"
            Worksheets("Search").Cells(MatchRow, 2).Value = Perc_Action
            Worksheets("Search").Cells(MatchRow, 4).Value = Calintl
            Worksheets("Search").Cells(MatchRow, 9).Value = Calintlpp
          End If
        End If
        '
        Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      End If
    End If
    '
    ' Line 6 - Insurance / Extended Warranty & FG sales price
    '
    If InsWarranty <> "" Or FG_Price_Found <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 5 ' Blue
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Font.ColorIndex = 2     ' White
      Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeInsWarranty
      If InsWarranty = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 2 ' White
        Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).LineStyle = xlNone
      End If
      If InsWarranty <> "" Then
        If InsWarranty = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 4).Value = InsWarranty
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      If FG_Price_Found = 0 Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Interior.ColorIndex = 2 ' White
        Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlNone
      End If
      If FG_Price_Found <> 0 Then
        If ShipHandling = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 5).Value = "Sales Model price is ;"
          Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Interior.ColorIndex = 38 ' pink
          Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
          Worksheets("Search").Cells(MatchRow, 9).Value = FG_Price_Found
        End If
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Font.Bold = True
      End If
      If InsWarranty = "" And FG_Price_Found = 0 Then
        MatchRow = MatchRow - 1
      End If
      '
    End If
    '
    ' White border as seperator for the combined prices
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 8
    '
    ' Line 7 - Blank for begin of extended price list
    '
    If Layout_Svc_List = "Extended" Then
      If StdRep <> "" Then
        '
        ' Dotted line to seperate with the next comment to be published
        '
        Worksheets("Search").Cells(MatchRow, 3).RowHeight = 8
        With Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
        End With
      End If
    '
    ' Line 8 - Define the Rep_CalNet value. Repl. By CalNetpostOffl (AAA)
    ' Replaces StdRep and Rep_Calnet and CalNet with CalnetpostOffl
    ' It can be either "", or "Quoted", or sum value of StdRep + CalNet
    ' If applicable change the CalNet 1-price to "Quoted"
    ' Values found are used for whether the line will be displayed
    '
    If CalnetpostOffl = "" Then 'was StdRep(AAA)
      Rep_Calnet = ""
    Else
      If StdRep = "1" Then
        If Calnet = "1" Then
          Rep_Calnet = ""
        Else
          Rep_Calnet = "Quoted"
        End If
      End If
      '
      If CalnetpostOffl = "1" Then 'was StdRep <>(AAA)
        'If Calnet <> "1"
         Rep_Calnet = "     Quoted" 'was Calnet <> Then Rep_Calnet (AAA)
          Else
           If CalnetpostOffl = "0.01" Then 'was Calnet <>(AAA)
             Rep_Calnet = "  Not Possible"  'was Calnet (AAA)
              Else
                Rep_Calnet = "Quoted" 'was Rep_Calnet (AAA)
       If CalnetpostOffl = "" Then '(AAA)
            Rep_Calnet = ""  '(AAA)
           Else '(AAA)
            Rep_Calnet = CalnetpostOffl  'was Rep_Calnet  = StdRep + Calnet (AAA)
          End If
        End If
      End If
    End If
    '
    If Rep_Calnet <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallRep_CalNet
      If Rep_Calnet = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Rep_Calnet <> "" Then Worksheets("Search").Cells(MatchRow, 4).Value = Rep_Calnet
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
    End If
    '
    ' Line 9 - Define the Rep_CalNetpost and Rep_Perf value.
    ' CodeCalIntlOffl
    ' It can be either "", or "Quoted, or sum value of StdRep + CalNetpost / Perf
    ' Values found are used for whether the line will be displayed
    '
    If CalIntlOffl = "" Then
      Rep_CalNetpost = ""
      'Rep_Perf = ""
    Else
      If StdRep = "1" Then
        If CalNetpost = "1" Then
          Rep_CalNetpost = ""
        Else
          Rep_CalNetpost = "   Quoted"
        End If
        'If Perf = "" Then
          'Rep_Perf = ""
        'Else
          'Rep_Perf = "Quoted"
        'End If
      End If
      '
      If CalIntlOffl = "1" Then
        Rep_CalNetpost = "     Quoted"
        Else
        If CalIntlOffl = "0.01" Then
          'If CalNetpost = "1" Then
            Rep_CalNetpost = "  Not Possible"
          Else
            Rep_CalNetpost = CalIntlOffl
          If CalIntlOffl = "" Then
          Rep_CalNetpost = ""
          End If
         End If
        End If
        'If Perf = "" Then Rep_Perf = ""
        'If Perf <> "" Then
          'If Perf = "1" Then
            'Rep_Perf = "Quoted"
          'Else
            'Rep_Perf = StdRep + Perf
          'End If
        'End If
      'End If
    End If
    '
    If Rep_CalNetpost <> "" Or Rep_Perf <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallRep_CalNetpost
      If Rep_CalNetpost = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Rep_CalNetpost <> "" Then Worksheets("Search").Cells(MatchRow, 4).Value = Rep_CalNetpost
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallRep_Perf
      If Rep_Perf = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Rep_Perf <> "" Then Worksheets("Search").Cells(MatchRow, 9).Value = Rep_Perf
    End If
    '
    ' Line 10 - Define the Rep_CalIntl and Rep_CalIntlpp value.
    '
    ' It can be either "", or "Quoted, or sum value of StdRep + CalIntl / CalIntlpp
    ' Values found are used for whether the line will be displayed
    '
    If StdRep = "" Then
      Rep_CalIntl = ""
      Rep_CalIntlpp = ""
    Else
      If StdRep = "1" Then
        If Calintl = "" Then
          Rep_CalIntl = ""
        Else
          Rep_CalIntl = "Quoted"
        End If
        If Calintlpp = "" Then
          Rep_CalIntlpp = ""
        Else
          Rep_CalIntlpp = "Quoted"
        End If
      End If
      '
      If StdRep > "1" Then
        If Calintl = "" Then Rep_CalIntl = ""
        If Calintl <> "" Then
          If Calintl = "1" Then
            Rep_CalIntl = "Quoted"
          Else
            Rep_CalIntl = StdRep + Calintl
          End If
        End If
        If Calintlpp = "" Then Rep_CalIntlpp = ""
        If Calintlpp <> "" Then
          If Calintlpp = "1" Then
            Rep_CalIntlpp = "Quoted"
          Else
            Rep_CalIntlpp = StdRep + Calintlpp
          End If
        End If
      End If
    End If
    '
    If Rep_CalIntl <> "" Or Rep_CalIntlpp <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallRep_CalIntl
      If Rep_CalIntl = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Rep_CalIntl <> "" Then Worksheets("Search").Cells(MatchRow, 4).Value = Rep_CalIntl
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallRep_CalIntlpp
      If Rep_CalIntlpp = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Rep_CalIntlpp <> "" Then Worksheets("Search").Cells(MatchRow, 9).Value = Rep_CalIntlpp
      ' Worksheets("Search").Cells(MatchRow, 9).Value = StdRep + Calintlpp
    End If
    '
    ' Line 11 - Define the Warr_CalNet and Warr_Rep_CalNet value.
    '
    ' It can be either "", or sum value of InsWarranty + CalNet / + StdRep
    ' Values found are used for whether the line will be displayed
    '
    ' Warranty is only applicable if CalNetpost has a fixed price although price is reference to either CalNetpost or CalIntl
    '
    If CalNetpost = "" Then
      Warr_CalNet = ""
      Warr_Rep_CalNet = ""
    Else
      If CalNetpost <> "" Then
        If InsWarranty = "" Then Warr_CalNet = ""
        If InsWarranty <> "" Then
          If CalNetpost = "1" Then
            Warr_CalNet = ""
          Else
            If Calnet = "" Or Calnet = "1" Then
              Warr_CalNet = ""
            Else
              Warr_CalNet = InsWarranty + Calnet
            End If
          End If
        End If
      End If
    End If
    '
    If Warr_CalNet = "" Then
      Warr_Rep_CalNet = ""
    Else
      If Warr_CalNet <> "" Then
        If StdRep = "" Then Warr_Rep_CalNet = ""
        If StdRep <> "" Then
          If StdRep = "1" Then
            Warr_Rep_CalNet = "Quoted"
          Else
            Warr_Rep_CalNet = InsWarranty + StdRep + Calnet
          End If
        End If
      End If
    End If
    '
    If Warr_CalNet <> "" Or Warr_Rep_CalNet <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallWarr_CalNet
      If Warr_CalNet = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Warr_CalNet <> "" Then Worksheets("Search").Cells(MatchRow, 4).Value = Warr_CalNet
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallWarr_Rep_CalNet
      If Warr_Rep_CalNet = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Warr_Rep_CalNet <> "" Then Worksheets("Search").Cells(MatchRow, 9).Value = Warr_Rep_CalNet
    End If
    '
    ' Line 12 - Define the Warr_CalNetpost and Warr_Rep_CalNetpost value.
    '
    ' It can be either "", or sum value of InsWarranty + CalNetpost / + StdRep
    ' Values found are used for whether the line will be displayed
    '
    ' Warranty is only applicable if CalNetpost has a fixed price although price is reference to either CalNetpost or CalIntl
    '
    If CalNetpost = "" Then
      Warr_CalNetpost = ""
      Warr_Rep_CalNetpost = ""
    Else
      If CalNetpost <> "" Then
        If InsWarranty = "" Then Warr_CalNetpost = ""
        If InsWarranty <> "" Then
          If CalNetpost = "1" Then
            Warr_CalNetpost = ""
          Else
            If CalNetpost = "" Or CalNetpost = "1" Then
              Warr_CalNetpost = ""
            Else
              Warr_CalNetpost = InsWarranty + CalNetpost
            End If
          End If
        End If
      End If
    End If
    '
    If Warr_CalNetpost = "" Then
      Warr_Rep_CalNetpost = ""
    Else
      If Warr_CalNetpost <> "" Then
        If StdRep = "" Then Warr_Rep_CalNetpost = ""
        If StdRep <> "" Then
        End If
      End If
    End If
    '
    If Warr_CalNetpost <> "" Or Warr_Rep_CalNetpost <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallWarr_CalNetpost
      If Warr_CalNetpost = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Warr_CalNetpost <> "" Then
        If Warr_CalNetpost = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 4).Value = Warr_CalNetpost
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallWarr_Rep_CalNetpost
      If Warr_Rep_CalNetpost = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Warr_Rep_CalNetpost <> "" Then
        If Warr_Rep_CalNetpost = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 9).Value = Warr_Rep_CalNetpost
        End If
      End If
    End If
    '
    ' Line 13 - Define the Warr_CalIntl and Warr_Rep_CalIntl value.
    '
    ' It can be either "", or sum value of InsWarranty + CalIntl / + StdRep
    ' Values found are used for whether the line will be displayed
    '
    ' Warranty is only applicable if CalNetpost has a fixed price although price is reference to either CalNetpost or CalIntl
    '
    If CalNetpost = "" Then
      Warr_CalIntl = ""
      Warr_Rep_CalIntl = ""
    Else
      If CalNetpost <> "" Then
        If InsWarranty = "" Then Warr_CalIntl = ""
        If InsWarranty <> "" Then
          If Calintl = "1" Then
            Warr_CalIntl = ""
          Else
            If Calintl = "" Or Calintl = "1" Then
              Warr_CalIntl = ""
            Else
              Warr_CalIntl = InsWarranty + Calintl
            End If
          End If
        End If
      End If
    End If
    '
    If Warr_CalIntl = "" Then
      Warr_Rep_CalIntl = ""
    Else
      If Warr_CalIntl <> "" Then
        If StdRep = "" Then Warr_Rep_CalIntl = ""
        If StdRep <> "" Then
          If StdRep = "1" Then
            Warr_Rep_CalIntl = "Quoted"
          Else
            Warr_Rep_CalIntl = InsWarranty + StdRep + Calintl
          End If
        End If
      End If
    End If
    '
    If Warr_CalIntl <> "" Or Warr_Rep_CalIntl <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallWarr_CalIntl
      If Warr_CalIntl = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Warr_CalIntl <> "" Then
        If Warr_CalIntl = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 4).Value = Warr_CalIntl
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallWarr_Rep_CalIntl
      If Warr_Rep_CalIntl = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Warr_Rep_CalIntl <> "" Then
        If Warr_Rep_CalIntl = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 9).Value = Warr_Rep_CalIntl
        End If
      End If
    End If
    '
    ' Line 14 - Define the Warr_CalIntlpp and Warr_Rep_CalIntlpp value.
    '
    ' It can be either "", or sum value of InsWarranty + CalIntlpp / + StdRep
    ' Values found are used for whether the line will be displayed
    '
    ' Warranty is only applicable if CalNetpost has a fixed price although price is reference to either CalNetpost or CalIntl
    '
    If CalNetpost = "" Then
      Warr_CalIntlpp = ""
      Warr_Rep_CalIntlpp = ""
    Else
      If CalNetpost <> "" Then
        If InsWarranty = "" Then Warr_CalIntlpp = ""
        If InsWarranty <> "" Then
          If Calintlpp = "1" Then
            Warr_CalIntlpp = ""
          Else
            If Calintlpp = "" Or Calintlpp = "1" Then
              Warr_CalIntlpp = ""
            Else
              Warr_CalIntlpp = InsWarranty + Calintlpp
            End If
          End If
        End If
      End If
    End If
    '
    If Warr_CalIntlpp = "" Then
      Warr_Rep_CalIntlpp = ""
    Else
      If Warr_CalIntlpp <> "" Then
        If StdRep = "" Then Warr_Rep_CalIntlpp = ""
        If StdRep <> "" Then
          If StdRep = "1" Then
            Warr_Rep_CalIntlpp = "Quoted"
          Else
            Warr_Rep_CalIntlpp = InsWarranty + StdRep + Calintlpp
          End If
        End If
      End If
    End If
    '
    If Warr_CalIntlpp <> "" Or Warr_Rep_CalIntlpp <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CallWarr_CalIntlpp
      If Warr_CalIntlpp = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Value = ""
      End If
      If Warr_CalIntlpp <> "" Then
        If Warr_CalIntlpp = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 4).Value = Warr_CalIntlpp
        End If
      End If
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      Worksheets("Search").Cells(MatchRow, 5).Value = " " + CallWarr_Rep_CalIntlpp
      If Warr_Rep_CalIntlpp = "" Then
        Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Value = ""
      End If
      If Warr_Rep_CalIntlpp <> "" Then
        If Warr_Rep_CalIntlpp = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Worksheets("Search").Cells(MatchRow, 9).Value = Warr_Rep_CalIntlpp
        End If
      End If
      '
    End If
    '
    ' White border between models
    '
    If StdRep <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 8
    End If
    '
    End If  ' End of extended price list
    '
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 9)).Borders(xlEdgeLeft).Color = RGB(255, 255, 255)
    MatchRow = MatchRow + 1
    '
    Worksheets("Search").Range("D2").Value = Matches ' Matches found
    '
    If Matches = 1 Then
      Worksheets("Search").Range("E2").Value = "model found."
    Else
      Worksheets("Search").Range("E2").Value = "models found."
    End If
  End If
  '
Next Row
'
' Clear cells beyond end of matches
'
Worksheets("Search").Range(Cells(MatchRow, 1), Cells((MatchRow + 20000), 10)).Select
Selection.Delete Shift:=xlUp
For x = MatchRow To MatchRow + 10
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Value = "" ' clear Search Results area
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Interior.ColorIndex = 2 ' paint area white
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Next x
'
Worksheets("Search").Range("A6").Select 'return to Search cell
' Worksheets("Search").Range("C4").Value = "IMPORTANT:DO NOT CHANGE PRICELIST TO PREVEND WRONG PRICES"
Worksheets("Search").Range("C3").Select 'return to Search cell
DisplayAlerts = True ' turn on warnings
'
End Sub  ' End of search for matches for Services
'
Sub UGK_Search()
'
' Search section  for a upgarde price
'
Worksheets("Search").Activate ' select the Search worksheet
Worksheets("Search").Range("A6").Select 'force scroll to top cell
'
ActiveWindow.DisplayHeadings = False ' hide row-column headings
DisplayAlerts = False ' turn off warnings when merging cell
'
' Header Row
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Font.Size = 8  ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Font.Size = 10 ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Font.Size = 8  ' Font size of the Service Group
'
Worksheets("Search").Cells(5, 2).Value = "Division"
Worksheets("Search").Cells(5, 3).Value = " Upgrade Description & Additional Information"
Worksheets("Search").Cells(5, 4).Value = "Item #"
Worksheets("Search").Cells(5, 5).Value = "Price"
Worksheets("Search").Cells(5, 6).Value = "Lab Assigned"
Worksheets("Search").Cells(5, 7).Value = "Warranty Period"
Worksheets("Search").Cells(5, 8).Value = "ATP Rule"
Worksheets("Search").Cells(5, 9).Value = "OBS Date"
'
' Header Colors
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Font.Size = 8 ' set font size
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Interior.ColorIndex = 37 ' blue
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Font.Size = 10 ' set font size
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Interior.ColorIndex = 42 ' green
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Font.Size = 8 ' set font size
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Interior.ColorIndex = 37 ' blue
'
Dots$ = " ................................................................."
'
' Assign Cal Descriptions
'
CodeCalNetpost = Worksheets("Workcodes").Cells(6, 2).Value + Dots$ ' Trac. cal. with data
CodeCalIntl = Worksheets("Workcodes").Cells(8, 2).Value + Dots$ ' Accr. cal.
CodeCalIntlpp = Worksheets("Workcodes").Cells(9, 2).Value + Dots$ ' Accr. cal. with pre/post data
CodeInsWarranty = Worksheets("Workcodes").Cells(10, 2).Value + Dots$ ' 12 month Insurance / Extended Warranty
'
' Clear search results area (1000 rows)
'
Worksheets("Search").Range("A6:P20000").UnMerge ' UnMerge Cells
Worksheets("Search").Range("A6:P20000").Value = "" ' clear Search Results area
Worksheets("Search").Range("A6:P20000").Style = "Normal" ' set style
Worksheets("Search").Range("A6:P20000").Interior.ColorIndex = 2 ' paint area white
Worksheets("Search").Range("A6:P20000").RowHeight = 14 ' set row height
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).LineStyle = xlDouble
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Worksheets("Search").Range("A6:P20000").WrapText = False ' do not wrap text
Worksheets("Search").Range("A6:P20000").Font.Bold = False ' unbold area
Worksheets("Search").Range("A6:P20000").Font.Size = 10 ' set font size
'
' Price List Viewed
'
Price_Currency = 1
If SC_Svc_List = "DEL" Then
  Price_List = Worksheets("Workcodes").Cells(4, 13).Value
  PL_Currency = "EURO"
  ' PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "NLL" Then
  Price_List = Worksheets("Workcodes").Cells(5, 13).Value
  PL_Currency = "EURO"
  ' PL_ColumnVar = 15
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "UKL-gbp" Then
  Price_List = Worksheets("Workcodes").Cells(6, 13).Value
  PL_Currency = "GBP"
  Price_Currency = Worksheets("Workcodes").Cells(21, 8).Value
  ' PL_ColumnVar = 30
  Worksheets("Search").Range("I2").Value = "GBP" 'Blank the currency cell
End If
If SC_Svc_List = "UKL-euro" Then
  Price_List = Worksheets("Workcodes").Cells(7, 13).Value
  PL_Currency = "EURO"
  ' PL_ColumnVar = 30
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "EU-euro" Then
  Price_List = Worksheets("Workcodes").Cells(8, 13).Value
  PL_Currency = "EURO"
  ' PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "EUR" 'Blank the currency cell
End If
If SC_Svc_List = "EU-usd" Then
  Price_List = Worksheets("Workcodes").Cells(9, 13).Value
  PL_Currency = "USD"
  Price_Currency = Worksheets("Workcodes").Cells(22, 8).Value
  ' PL_ColumnVar = 0
  Worksheets("Search").Range("I2").Value = "USD" 'Blank the currency cell
End If
Worksheets("Search").Cells(1, 2).Value = Price_List
'
If Len(Worksheets("Search").Range("C3")) < 3 Then ' Must search on 3 or more characters.
  Response = MsgBox("Please enter 3 or more characters and search again. ( For 2 digit models, try preceding with a dash.If no match, enter digits followed by a space. )", 0, "Model Search Criteria")
  Exit Sub
End If
'
MatchRow = 6
Matches = 0 ' count number of matches
Worksheets("Search").Range("D2").Value = Matches ' Matches found
'
' Rounding defaults / break points
'
RounUp_Value_1 = 100 ' Variable for rounding to 10 cent
RounUp_Value_2 = 200 ' Variable for rounding to 20 cent
RounUp_Value_3 = 400 ' Variable for rounding to 50 cent, ro as above to 1 euro
'
For Row = 6 To 22000
  '
  Division = Worksheets("Upgrades").Cells(Row, 18).Value ' Product Family
  If Len(Division) = 0 Then Exit For ' exit loop if Product_Family cell empty
  SearchText1 = Worksheets("Upgrades").Cells(Row, 1).Value ' Item
  SearchText2 = Worksheets("Upgrades").Cells(Row, 2).Value ' Model Description
   SearchText3 = Worksheets("Upgrades").Cells(Row, 3).Value ' Extra Description
  SearchText = SearchText1 + " " + SearchText2 ' + " " + SearchText3
  '
  If SearchText Like SearchPattern Then
    '
    Matches = Matches + 1 ' count number of matches
    '
    ' Assign variables
    '
    UGK_Item = Worksheets("Upgrades").Cells(Row, 1).Value
    UGK_Model = Worksheets("Upgrades").Cells(Row, 2).Value
    '
    UGK_Price = Worksheets("Upgrades").Cells(Row, 4).Value
    Svc_Lab_Assigned = Worksheets("Upgrades").Cells(Row, 5).Value
    IC_Item_LineH_sub = Worksheets("Upgrades").Cells(Row, 6).Value
    If IC_Item_LineH_sub = "" Then
        IC_Item_LineH = 13
      Else
        IC_Item_LineH = 17 + ((IC_Item_LineH_sub - 1) * 13)
    End If
    IC_Item = Worksheets("Upgrades").Cells(Row, 7).Value
    IC_Model = Worksheets("Upgrades").Cells(Row, 8).Value
    OG_Item = Worksheets("Upgrades").Cells(Row, 9).Value
    OG_Model = Worksheets("Upgrades").Cells(Row, 10).Value
    CalNetpost = Worksheets("Upgrades").Cells(Row, 11).Value
    Calintl = Worksheets("Upgrades").Cells(Row, 12).Value
    Calintlpp = Worksheets("Upgrades").Cells(Row, 13).Value
    InsWarranty = Worksheets("Upgrades").Cells(Row, 14).Value
    WarrPeriod = Worksheets("Upgrades").Cells(Row, 15).Value
      If Val(WarrPeriod) > 25 Then WarrPeriod = WarrPeriod + " days"
      If Val(WarrPeriod) >= 3 And Val(WarrPeriod) < 25 Then WarrPeriod = WarrPeriod + " months"
      If Val(WarrPeriod) > 1 And Val(WarrPeriod) < 3 Then WarrPeriod = WarrPeriod + " years"
      If Val(WarrPeriod) = 1 Then WarrPeriod = WarrPeriod + " year"
    UGK_Obs_Date = Worksheets("Upgrades").Cells(Row, 16).Value
    UGK_ATP = Worksheets("Upgrades").Cells(Row, 17).Value
      Dim UpperCase, LowerCase
      UpperCase = UGK_ATP            ' String to convert.
      LowerCase = LCase(UpperCase)    ' Returns "ATP in lower case".
      UGK_ATP = LowerCase
    '
    SC_UGK_LineH_sub = Worksheets("Upgrades").Cells(Row, 21).Value
    If SC_UGK_LineH_sub = "" Then
        SC_UGK_LineH = 13
      Else
        SC_UGK_LineH = 17 + ((SC_UGK_LineH_sub - 1) * 13)
    End If
    SC_UGK_Com = Worksheets("Upgrades").Cells(Row, 22).Value
    '
    FASC_UGK_Publ = Worksheets("Upgrades").Cells(Row, 23).Value
    FASC_UGK_LineH_sub = Worksheets("Upgrades").Cells(Row, 24).Value
    If FASC_UGK_LineH_sub = "" Then
        FASC_UGK_LineH = 13
      Else
        FASC_UGK_LineH = 17 + ((FASC_UGK_LineH_sub - 1) * 13)
    End If
    FASC_UGK_Com = Worksheets("Upgrades").Cells(Row, 25).Value
    '
    RMA_UGK_Publ = Worksheets("Upgrades").Cells(Row, 26).Value
    RMA_UGK_LineH_sub = Worksheets("Upgrades").Cells(Row, 27).Value
    If RMA_UGK_LineH_sub = "" Then
        RMA_UGK_LineH = 13
      Else
        RMA_UGK_LineH = 17 + ((RMA_UGK_LineH_sub - 1) * 13)
    End If
    RMA_UGK_Com = Worksheets("Upgrades").Cells(Row, 28).Value
    ' ProdFamily = Worksheets("Services").Cells(Row, 74).Value
    ' ModelGroup = Worksheets("Services").Cells(Row, 75).Value
    ' FG_Obs_Date = Worksheets("Services").Cells(Row, 76).Value
    '
    ' Output matches - Light green section - 35
    '
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders.Color = RGB(255, 255, 255) ' white borders
    Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).UnMerge ' UnMerge Cells
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 2)).Interior.ColorIndex = 37
    Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 5)).Interior.ColorIndex = 35
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 3)).HorizontalAlignment = xlHAlignLeft ' left justify
    Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
    Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
    Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
    Worksheets("Search").Cells(MatchRow, 2).Value = Left(Division, 10) ' Division of the upgrade
    ' Worksheets("Search").Cells(MatchRow, 2).Value = ProdFamily ' Product Family
    '
    ' Output matches - Light blue section - 34
    '
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).Interior.ColorIndex = 34
    Worksheets("Search").Cells(MatchRow, 3).NumberFormat = Text ' Format String
    ' Worksheets("Search").Cells(MatchRow, 3).Font.Bold = True ' Bold Model
    ' Worksheets("Search").Cells(MatchRow, 3).Value = " " + UGK_Model
    Worksheets("Search").Cells(MatchRow, 3).Value = UGK_Model ' " " + Text
    If Len(UGK_Model) > 40 Then
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).VerticalAlignment = xlCenter
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 25.5
    End If
    Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True ' Bold item
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter ' Center alignment
    Worksheets("Search").Cells(MatchRow, 4).Value = UGK_Item ' Don't add spaces, so copy to Oracle will work
    '
    If PL_Currency = "EURO" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "GBP" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "USD" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
    End If
    '
    Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 5).Font.Bold = True ' Bold item
    If UGK_Price <> "" Then
      UGK_Price_sub = UGK_Price / Price_Currency
    End If
    '
    ' Roundup to 10 cent < 100 euro - RounUp_Value_1
    '
    If UGK_Price_sub < RounUp_Value_1 Then
      UGK_Price_sub1 = Round(UGK_Price_sub * 10, 0)
      UGK_Price_sub2 = UGK_Price_sub * 10
      UGK_Price_sub3 = UGK_Price_sub2 - UGK_Price_sub1
    '
    If UGK_Price_sub3 > 0 Then
        Price_UGK = (UGK_Price_sub1 / 10) + 0.1
      Else
        Price_UGK = UGK_Price_sub1 / 10
      End If
    End If
    '
    ' Roundup to 20 cent Between 100 and 200 euro - RounUp_Value_2
    '
    If UGK_Price_sub >= RounUp_Value_1 And UGK_Price_sub < RounUp_Value_2 Then
      UGK_Price_sub1 = Round(UGK_Price_sub * 5, 0)
      UGK_Price_sub2 = UGK_Price_sub * 5
      UGK_Price_sub3 = UGK_Price_sub2 - UGK_Price_sub1
      '
      If UGK_Price_sub3 > 0 Then
        Price_UGK = (UGK_Price_sub1 / 5) + 0.2
      Else
        Price_UGK = UGK_Price_sub1 / 5
      End If
    End If
    '
    ' Roundup to 50 cent between 200 and 400 euro, and above 400 (RounUp_Value_3) to 1 euro
    '
    If UGK_Price_sub >= RounUp_Value_2 And UGK_Price_sub < RounUp_Value_3 Then
      UGK_Price_sub1 = Round(UGK_Price_sub * 2, 0)
      UGK_Price_sub2 = UGK_Price_sub * 2
      UGK_Price_sub3 = UGK_Price_sub2 - UGK_Price_sub1
      '
      If Price_UGK_sub3 > 0 Then
        Price_UGK = (UGK_Price_sub1 / 2) + 0.5
      Else
        Price_UGK = UGK_Price_sub1 / 2
      End If
    End If
    '
    ' Roundup to 1 euro above 400 - RounUp_Value_3
    '
    If UGK_Price_sub >= RounUp_Value_3 Then
      UGK_Price_sub1 = Round(UGK_Price_sub, 0)
      UGK_Price_sub2 = UGK_Price_sub
      UGK_Price_sub3 = UGK_Price_sub2 - UGK_Price_sub1
      '
      If UGK_Price_sub3 > 0 Then
        Price_UGK = (UGK_Price_sub1) + 1
      Else
        Price_UGK = UGK_Price_sub1
      End If
    End If
    '
    ' UGK price output
    '
    Worksheets("Search").Cells(MatchRow, 5).Value = Price_UGK
    '
    ' Output matches - Light blue section - 34
    '
    ' Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).Interior.ColorIndex = 37
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 8)).Font.Size = 8
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).HorizontalAlignment = xlHAlignCenter ' mid justify
    Worksheets("Search").Cells(MatchRow, 6).Value = Svc_Lab_Assigned
    '
    Worksheets("Search").Cells(MatchRow, 7).Value = WarrPeriod
    Worksheets("Search").Cells(MatchRow, 8).Value = UGK_ATP
    Worksheets("Search").Cells(MatchRow, 9).NumberFormat = "d-mmm-yy"
    Worksheets("Search").Cells(MatchRow, 9).Value = UGK_Obs_Date
    If UGK_Obs_Date <> "" Then
      Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 38
      If UGK_Obs_Date = "Obsolete" Then
        Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
        Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
        Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
      Else
      If UGK_Obs_Date < CurrentDate Then
        Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
        Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
        Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
      End If
      End If
    End If
    '
    ' Output yellow comment row
    '
    ' Combine the multiple comments into one comment
    '
    If SC_UGK_Com <> "" Or RMA_UGK_Com <> "" Or FASC_UGK_Com <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 3
    End If
    '
    FASC_PL = ""
    If SC_Svc_List = "EU-euro" Or SC_Svc_List = "EU-usd" Then FASC_PL = "EU_PL"
    If FASC_PL = "" Then
    '
    ' Service Center comment
    '
    If Len(SC_UGK_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = SC_UGK_Com
      ' Worksheets("Search").Cells(MatchRow, 3).Rows.AutoFit
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = SC_UGK_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
'      If FASC_PL <> "EU_PL" Then
        '
        ' Dotted line to seperate with the next comment to be published
        '
        If Len(RMA_UGK_Com) > 0 Or Len(FASC_UGK_Com) > 0 Then
          With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
            .LineStyle = xlContinuous
            .Weight = xlHairline
            .ColorIndex = xlAutomatic
          End With
        End If
        '
'      End If
    End If
    '
    End If
    '
    ' RMA webpage / Local customer comment
    '
    If Len(RMA_UGK_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "W W W"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = RMA_UGK_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = RMA_UGK_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
'      If FASC_PL <> "EU_PL" Then
        '
        ' Dotted line to seperate with the next comment to be published
        '
        If Len(FASC_UGK_Com) > 0 Then
          With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
            .LineStyle = xlContinuous
            .Weight = xlHairline
            .ColorIndex = xlAutomatic
          End With
        End If
        '
'      End If
    End If
    '
    ' FASC comment
    '
    If Len(FASC_UGK_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "F A S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = FASC_UGK_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = FASC_UGK_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
    End If
    '
    ' Incoming & Outgoing model information
    '
    If IC_Item_LineH_sub <> "" Then
      MatchRow = MatchRow + 1
      '
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlLeft ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).Value = "Incoming Model"
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      Worksheets("Search").Cells(MatchRow, 4).Value = "Item#"
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlLeft ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 5).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 5).Value = "Outgoing Model"
      Worksheets("Search").Cells(MatchRow, 5).IndentLevel = 2
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 9).Value = "Item#"
      Worksheets("Search").Cells(MatchRow, 9).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      ' Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeBottom).Color = RGB(0, 0, 0)
      With Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlHairline
        .ColorIndex = xlAutomatic
      End With
      '
      MatchRow = MatchRow + 1
      '
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).RowHeight = IC_Item_LineH
      '
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlLeft ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).Value = IC_Model
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      Worksheets("Search").Cells(MatchRow, 4).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 4).Value = IC_Item
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlLeft ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 5).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 5).Value = OG_Model
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 5).IndentLevel = 2
      Worksheets("Search").Cells(MatchRow, 9).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 9).Value = OG_Item
      Worksheets("Search").Cells(MatchRow, 9).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      '
    End If
    '
    ' Blank line
    '
    ' End of found model
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 8
    '
    Worksheets("Search").Range("D2").Value = Matches ' Matches found
    '
    If Matches = 1 Then
      Worksheets("Search").Range("E2").Value = "model found."
    Else
      Worksheets("Search").Range("E2").Value = "models found."
    End If
    MatchRow = MatchRow + 1
  End If
  '
Next Row
'
' Clear cells beyond end of matches
'
Worksheets("Search").Range(Cells(MatchRow, 1), Cells((MatchRow + 20000), 10)).Select
Selection.Delete Shift:=xlUp
For x = MatchRow To MatchRow + 10
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Value = "" ' clear Search Results area
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Interior.ColorIndex = 2 ' paint area white
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Next x
'
Worksheets("Search").Range("A6").Select 'return to Search cell
Worksheets("Search").Range("C4").Value = "Made by Henry Boelaars"
Worksheets("Search").Range("C3").Select 'return to Search cell
DisplayAlerts = True ' turn on warnings
'
End Sub ' End of search for matches for Upgrades
'
Sub Part_Search()
'
' Search section  for a part price
'
Worksheets("Search").Activate           ' select the Search worksheet
Worksheets("Search").Range("A6").Select 'force scroll to top cell
'
ActiveWindow.DisplayHeadings = False    ' hide row-column headings
DisplayAlerts = False                   ' turn off warnings when merging cell
'
' Header Row
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Font.Size = 8  ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Font.Size = 10 ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Font.Size = 8  ' Font size of the Service Group
'
Worksheets("Search").Cells(5, 2).Value = "EDC Inv"
Worksheets("Search").Cells(5, 3).Value = " Part Description"
Worksheets("Search").Cells(5, 4).Value = "Item #"
Worksheets("Search").Cells(5, 5).Value = "Price"
Worksheets("Search").Cells(5, 6).Value = "X-ref / 12nc"
Worksheets("Search").Cells(5, 7).Value = "ATP Rule"
Worksheets("Search").Cells(5, 8).Value = "C-o-O"
Worksheets("Search").Cells(5, 9).Value = "OBS Date"
'
' Header Colors
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Interior.ColorIndex = 37 ' blue
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Interior.ColorIndex = 42 ' green
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Interior.ColorIndex = 37 ' blue
'
Dots$ = " ................................................................."
'
' Assign Cal Descriptions
'
' Clear search results area (20000 rows)
'
Worksheets("Search").Range("A6:P20000").UnMerge ' UnMerge Cells
Worksheets("Search").Range("A6:P20000").Value = "" ' clear Search Results area
Worksheets("Search").Range("A6:P20000").Style = "Normal" ' set style
Worksheets("Search").Range("A6:P20000").Interior.ColorIndex = 2 ' paint area white
Worksheets("Search").Range("A6:P20000").RowHeight = 14 ' set row height
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).LineStyle = xlDouble
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Worksheets("Search").Range("A6:P20000").WrapText = False ' do not wrap text
Worksheets("Search").Range("A6:P20000").Font.Bold = False ' unbold area
Worksheets("Search").Range("A6:P20000").Font.Size = 10 ' set font size
'
' Price List Viewed and its Currency & Exchange Rate
'
Price_Currency = 1
PL_ColumnVar = 0
If FG_List = "Euro Country" Then
  Price_List = Worksheets("Workcodes").Cells(32, 12).Value
  PL_Currency = "EURO"
  Worksheets("Search").Range("G2").Value = "EUR" ' Change the currency cell
End If
If FG_List = "Denmark" Then
  Price_List = Worksheets("Workcodes").Cells(34, 12).Value
  PL_Currency = "DKK"
  Price_Currency = Worksheets("Workcodes").Cells(18, 9).Value
  Worksheets("Search").Range("G2").Value = "DKK" ' Change the currency cell
End If
If FG_List = "EEMEA in USD" Then
  Price_List = Worksheets("Workcodes").Cells(38, 12).Value
  PL_Currency = "USD"
  Price_Currency = Worksheets("Workcodes").Cells(22, 9).Value
  PL_ColumnVar = 3
  Worksheets("Search").Range("G2").Value = "USD" ' Change the currency cell
End If
If FG_List = "Norway" Then
  Price_List = Worksheets("Workcodes").Cells(35, 12).Value
  PL_Currency = "NOK"
  Price_Currency = Worksheets("Workcodes").Cells(19, 9).Value
  Worksheets("Search").Range("G2").Value = "NOK" ' Change the currency cell
End If
If FG_List = "Sweden" Then
  Price_List = Worksheets("Workcodes").Cells(36, 12).Value
  PL_Currency = "SEK"
  Price_Currency = Worksheets("Workcodes").Cells(20, 9).Value
  Worksheets("Search").Range("G2").Value = "SEK" ' Change the currency cell
End If
If FG_List = "Switzerland" Then
  Price_List = Worksheets("Workcodes").Cells(33, 12).Value
  PL_Currency = "CHF"
  Price_Currency = Worksheets("Workcodes").Cells(17, 9).Value
  Worksheets("Search").Range("G2").Value = "CHF" ' Change the currency cell
End If
If FG_List = "UK in GBP" Then
  Price_List = Worksheets("Workcodes").Cells(37, 12).Value
  PL_Currency = "GBP"
  Price_Currency = Worksheets("Workcodes").Cells(21, 9).Value
  Worksheets("Search").Range("G2").Value = "EUR" ' Change the currency cell
End If
Worksheets("Search").Cells(1, 2).Value = Price_List
'
If Len(Worksheets("Search").Range("C3")) < 3 Then ' Must search on 3 or more characters.
  Response = MsgBox("Please enter 3 or more characters and search again. ( For 2 digit models, try preceding with a dash.If no match, enter digits followed by a space. )", 0, "Model Search Criteria")
  Exit Sub
End If
'
' Rounding defaults / break points
'
RounUp_Value_A1 = 0.05 ' Variable for rounding
RounUp_Value_A2 = 0.1  ' Variable for rounding
RounUp_Value_A3 = 0.2  ' Variable for rounding
RounUp_Value_A4 = 0.5  ' Variable for rounding
RounUp_Value_A5 = 1    ' Variable for rounding
RounUp_Value_A6 = 5    ' Variable for rounding
'
RounUp_Value_B1 = 15   ' price break at 15
RounUp_Value_B2 = 100  ' price break at 100
RounUp_Value_B3 = 250  ' price break at 250
RounUp_Value_B4 = 500  ' price break at 500
RounUp_Value_B5 = 1000 ' price break at 1000
'
MatchRow = 6
Matches = 0 ' count number of matches
Worksheets("Search").Range("D2").Value = Matches ' Matches found
'
For Row = 6 To 22000
  '
  Item_Nr = Worksheets("Parts").Cells(Row, 1).Value
  If Len(Item_Nr) = 0 Then Exit For ' exit loop if EDC stock policy cell is empty
  SearchText1 = Worksheets("Parts").Cells(Row, 1).Value ' Item number
  SearchText2 = Worksheets("Parts").Cells(Row, 2).Value ' Item Description
  SearchText3 = Worksheets("Parts").Cells(Row, 3).Value ' Extra info search
  SearchText = SearchText1 + " " + SearchText2 + " " + SearchText3
  '
  If SearchText Like SearchPattern Then
    '
    Matches = Matches + 1 ' count number of matches
    '
    ' Assign variables
    '
'    Item_Nr = Worksheets("Parts").Cells(Row, 1).Value
    Item_Description = Worksheets("Parts").Cells(Row, 2).Value
    Item_Xref = Worksheets("Parts").Cells(Row, 3).Value
    '
    Item_Price = Worksheets("Parts").Cells(Row, (4 + PL_ColumnVar)).Value ' Price
    Price_Start_Date = Worksheets("Parts").Cells(Row, (5 + PL_ColumnVar)).Value ' Start date of the price
    Price_End_date = Worksheets("Parts").Cells(Row, (6 + PL_ColumnVar)).Value ' End date of the price
    '
    Repl_by = Worksheets("Parts").Cells(Row, 10).Value
    EoS = Worksheets("Parts").Cells(Row, 11).Value
    '
    OD_Item_LineH_sub = Worksheets("Parts").Cells(Row, 21).Value
    If OD_Item_LineH_sub = "" Then
        OD_Item_LineH = 13
      Else
        OD_Item_LineH = 17 + ((OD_Item_LineH_sub - 1) * 13)
    End If
    OD_Item_Com = Worksheets("Parts").Cells(Row, 22).Value
    '
    FASC_Item_Publ = Worksheets("Parts").Cells(Row, 23).Value
    FASC_Item_LineH_sub = Worksheets("Parts").Cells(Row, 24).Value
    If FASC_Item_LineH_sub = "" Then
        FASC_Item_LineH = 13
      Else
        FASC_Item_LineH = 17 + ((FASC_Item_LineH_sub - 1) * 13)
    End If
    FASC_Item_Com = Worksheets("Parts").Cells(Row, 25).Value
    '
    SC_Item_LineH_sub = Worksheets("Parts").Cells(Row, 26).Value
    If SC_Item_LineH_sub = "" Then
        SC_Item_LineH = 13
      Else
        SC_Item_LineH = 17 + ((SC_Item_LineH_sub - 1) * 13)
    End If
    SC_Item_Com = Worksheets("Parts").Cells(Row, 27).Value
    '
    ' Item_Xref = Worksheets("Parts").Cells(Row, 31).Value ' X-reference, like 12nc
    EDC_Policy = Worksheets("Parts").Cells(Row, 31).Value ' EDC Item inventory policy - STK, CD, or LTB
    Item_ATP = Worksheets("Parts").Cells(Row, 32).Value
      Dim UpperCase, LowerCase
      UpperCase = Item_ATP            ' String to convert.
      LowerCase = LCase(UpperCase)    ' Returns "ATP in lower case".
      Item_ATP = LowerCase
    Item_UoM = Worksheets("Parts").Cells(Row, 33).Value
    Item_CoO = Worksheets("Parts").Cells(Row, 34).Value
    '
    ' Output matches - Light blue section
    '
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders.Color = RGB(255, 255, 255) ' white borders
    Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).UnMerge ' UnMerge Cells
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 2)).Interior.ColorIndex = 37
    ' Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 5)).Interior.ColorIndex = 34
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 3)).HorizontalAlignment = xlHAlignLeft ' left justify
    Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold EDC stock policy
    Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the  EDC stock policy
    Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
    Worksheets("Search").Cells(MatchRow, 2).Value = EDC_Policy ' STK = stock, CD = cross dock, LTB = lifetime-buy
    '
    ' Output matches - Light green section
    '
    Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 5)).Interior.ColorIndex = 35
    Worksheets("Search").Cells(MatchRow, 3).NumberFormat = Text ' Format String
    ' Worksheets("Search").Cells(MatchRow, 3).Font.Bold = True ' Bold Model
    ' Worksheets("Search").Cells(MatchRow, 3).Value = " " + Item_Description
    Worksheets("Search").Cells(MatchRow, 3).Value = Item_Description ' " " + Text
    If Len(Item_Description) > 40 Then
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).VerticalAlignment = xlCenter
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 25.5
    End If
    Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True ' Bold item
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter ' Center alignment
    Worksheets("Search").Cells(MatchRow, 4).Value = Item_Nr ' cross reference, like eg. 12nc or acquisition (LEM) item nr.
    '
    If PL_Currency = "EURO" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "CHF" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$SFr-807]* #,##0.00 _);_([$SFr-807]* (#,##0 );_([$SFr-807]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "DKK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$kr-406]* #,##0.00 _);_([$kr-406]* (#,##0 );_([$kr-406]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "NOK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$kr-414]* #,##0.00 _);_([$kr-414]* (#,##0 );_([$kr-414]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "SEK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_(#,##0.00* [$kr-41D] _);_(#,##0* ([$kr-41D] );_(""-""* [$kr-41D] _);_(@ _)" ' has different order compared to NOK or DKK
    End If
    If PL_Currency = "GBP" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "USD" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
    End If
    '
    ' Calculate the rounding for CHF, DKK, NOK, and SEK prices
    '
    If PL_Currency = "CHF" Or PL_Currency = "DKK" Or PL_Currency = "NOK" Or PL_Currency = "SEK" Then
      Item_Price_Sub = (Item_Price / Price_Currency)
      '
      ' Roundup to 0.05 ( RounUp_Value_A1 ) < 100 (( RounUp_Value_B2 )
      '
      If Item_Price_Sub < RounUp_Value_B2 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A1), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A1)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A1)) + RounUp_Value_A1
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A1)
        End If
      End If
      '
      ' Roundup to 0.10 ( RounUp_Value_A2 ) between 100 and 250 ( RounUp_Value_B3 )
      '
      If Item_Price_Sub >= RounUp_Value_B2 And Item_Price_Sub < RounUp_Value_B3 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A2), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A2)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A2)) + RounUp_Value_A2
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A2)
        End If
      End If
      '
      ' Roundup to 1.00 ( RounUp_Value_A5 )between 250 and 500 ( RounUp_Value_B4 )
      '
      If Item_Price_Sub >= RounUp_Value_B3 And Item_Price_Sub < RounUp_Value_B4 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A5), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A5)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A5)) + RounUp_Value_A5
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A5)
        End If
      End If
      '
      ' Roundup to 5.00 ( RounUp_Value_A6 )above 500 ( RounUp_Value_B4 )
      '
      If Item_Price_Sub >= RounUp_Value_B4 Then
        Item_Price_Sub1 = Round(Item_Price_Sub / RounUp_Value_A6, 0)
        Item_Price_Sub2 = Item_Price_Sub / RounUp_Value_A6
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 * RounUp_Value_A6) + RounUp_Value_A6
        Else
          Item_Price_Calculated = Item_Price_Sub1 * RounUp_Value_A6
        End If
      End If
    End If
    '
    ' Calculate the rounding for GBP prices
    '
    If PL_Currency = "GBP" Then
      Item_Price_Sub = (Item_Price / Price_Currency)
      '
      ' Roundup to 0.05 ( RounUp_Value_A1 ) < 15 ( RounUp_Value_B1 )
      '
      If Item_Price_Sub < RounUp_Value_B1 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A1), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A1)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A1)) + RounUp_Value_A1
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A1)
        End If
      End If
      '
      ' Roundup to 0.10 ( RounUp_Value_A2 )between 15 and 100 ( RounUp_Value_B2 )
      '
      If Item_Price_Sub >= RounUp_Value_B1 And Item_Price_Sub < RounUp_Value_B2 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A2), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A2)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A2)) + RounUp_Value_A2
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A2)
        End If
      End If
      '
      ' Roundup to 0.50 ( RounUp_Value_A4 )between 100 and 250 ( RounUp_Value_B3 )
      '
      If Item_Price_Sub >= RounUp_Value_B2 And Item_Price_Sub < RounUp_Value_B3 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A4), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A4)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A4)) + RounUp_Value_A4
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A4)
        End If
      End If
      '
      ' Roundup to 1.00 ( RounUp_Value_A5 )between 250 and 1000 ( RounUp_Value_B5 )
      '
      If Item_Price_Sub >= RounUp_Value_B3 And Item_Price_Sub < RounUp_Value_B5 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A5), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A5)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A5)) + RounUp_Value_A5
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A5)
        End If
      End If
      '
      ' Roundup to 5.00 ( RounUp_Value_A6 )above 1000 ( RounUp_Value_B5 )
      '
      If Item_Price_Sub >= RounUp_Value_B5 Then
        Item_Price_Sub1 = Round(Item_Price_Sub * (1 / RounUp_Value_A6), 0)
        Item_Price_Sub2 = Item_Price_Sub * (1 / RounUp_Value_A6)
        Item_Price_Sub3 = Item_Price_Sub2 - Item_Price_Sub1
        '
        If Item_Price_Sub3 > 0 Then
          Item_Price_Calculated = (Item_Price_Sub1 / (1 / RounUp_Value_A6)) + RounUp_Value_A6
        Else
          Item_Price_Calculated = Item_Price_Sub1 / (1 / RounUp_Value_A6)
        End If
      End If
      '
    End If
    '
    Worksheets("Search").Cells(MatchRow, 5).Value = Item_Price_Calculated
    '
    Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 5).Font.Bold = True ' Bold item
    If PL_Currency = "EURO" Or PL_Currency = "USD" Then
        Worksheets("Search").Cells(MatchRow, 5).Value = Item_Price
      Else
        Worksheets("Search").Cells(MatchRow, 5).Value = Item_Price_Calculated
    End If
    '
    ' Output matches - Light blue section
    '
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).Interior.ColorIndex = 34
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).HorizontalAlignment = xlHAlignCenter ' mid justify
    Worksheets("Search").Cells(MatchRow, 6).Value = Item_Xref
    Worksheets("Search").Cells(MatchRow, 6).NumberFormat = "#" ' Selection.NumberFormat = "#"
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 8)).Font.Size = 8
    '
    Worksheets("Search").Cells(MatchRow, 7).Value = Item_ATP
    Worksheets("Search").Cells(MatchRow, 8).Value = Item_CoO
    Worksheets("Search").Cells(MatchRow, 9).NumberFormat = "d-mmm-yy"
    Worksheets("Search").Cells(MatchRow, 9).Value = EoS
    If EoS <> "" Then
      Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 38
      If EoS = "Obsolete" Then
        Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
        Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
        Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
      Else
        If EoS < CurrentDate Then
          Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3
          Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
          Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
        End If
      End If
    End If
    '
    ' Line 1 - Optional in case the search item has a replacement
    '
    If Repl_by <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 38
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Font.Bold = True
      ' Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Font.ColorIndex = 2
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
      Worksheets("Search").Cells(MatchRow, 3).Value = "Replacement part is : "
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
      Worksheets("Search").Cells(MatchRow, 4).Value = Repl_by
    End If
    '
    ' Line 2 - Start Date and Unit of Measurement / order quanitity
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Cells(MatchRow, 3).RowHeight = 5
    '
    MatchRow = MatchRow + 1
    '
    Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 3).Value = "Start date of the price is : "
    Worksheets("Search").Cells(MatchRow, 4).NumberFormat = "d-mmm-yy"
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
    Worksheets("Search").Cells(MatchRow, 4).Value = Price_Start_Date
    '
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge
    Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 5).Value = "Unit of Measurement / Order quantity is : "
    Worksheets("Search").Cells(MatchRow, 9).Value = Item_UoM
    '
    ' Line 3 - Optional in case the price end date is set
    '
    If Price_End_date <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
      Worksheets("Search").Cells(MatchRow, 3).Value = "Price end date is : "
      Worksheets("Search").Cells(MatchRow, 4).NumberFormat = "d-mmm-yy"
      Worksheets("Search").Cells(MatchRow, 4).Interior.ColorIndex = 3
      Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True
      Worksheets("Search").Cells(MatchRow, 4).Font.ColorIndex = 2
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
      Worksheets("Search").Cells(MatchRow, 4).Value = Price_End_date
    End If
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Cells(MatchRow, 3).RowHeight = 3
    '
    ' Output yellow comment row(s)
    '
    ' Combine the multiple comments into one comment
    '
    ' Service Center comment
    '
    If Len(SC_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = SC_Item_Com
      ' Worksheets("Search").Cells(MatchRow, 3).Rows.AutoFit
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = SC_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      '
      ' Dotted line to seperate with the next comment to be published
      '
      If Len(OD_Item_Com) > 0 Or Len(FASC_Item_Com) > 0 Then
        With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
        End With
      End If
      '
    End If
    '
    ' RMA webpage / Local customer comment
    '
    If Len(OD_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "C I O"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = OD_Item_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = OD_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      '
      ' Dotted line to seperate with the next comment to be published
      '
      If Len(FASC_Item_Com) > 0 Then
        With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
        End With
      End If
      '
    End If
    '
    ' FASC comment
    '
    If Len(FASC_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "Customer"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = FASC_Item_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = FASC_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
    End If
    '
    ' Blank line
    '
    ' End of found part(s)
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 8
    '
    Worksheets("Search").Range("D2").Value = Matches ' Matches found
    '
    If Matches = 1 Then
      Worksheets("Search").Range("E2").Value = "model found."
    Else
      Worksheets("Search").Range("E2").Value = "models found."
    End If
    MatchRow = MatchRow + 1
  End If
  '
Next Row
'
' Clear cells beyond end of matches
'
Worksheets("Search").Range(Cells(MatchRow, 1), Cells((MatchRow + 20000), 10)).Select
Selection.Delete Shift:=xlUp
For x = MatchRow To MatchRow + 10
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Value = "" ' clear Search Results area
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Interior.ColorIndex = 2 ' paint area white
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Next x
'
Worksheets("Search").Range("A6").Select 'return to Search cell
Worksheets("Search").Range("C4").Value = "Made by Henry Boelaars"
Worksheets("Search").Range("C3").Select 'return to Search cell
DisplayAlerts = True ' turn on warnings
'
End Sub ' End of search for matches for Parts
'
Sub FG_Search()
'
' Search section  for a model and its pre-delivery calibration prices
'
Worksheets("Search").Activate ' select the Search worksheet
Worksheets("Search").Range("A6").Select 'force scroll to top cell
'
ActiveWindow.DisplayHeadings = False ' hide row-column headings
DisplayAlerts = False ' turn off warnings when merging cell
'
' Header Row
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Font.Size = 8  ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Font.Size = 10 ' Font size of the Service Group
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Font.Size = 8  ' Font size of the Service Group
'
Worksheets("Search").Cells(5, 2).Value = "ProdFam"
Worksheets("Search").Cells(5, 3).Value = " Model & Model Description"
Worksheets("Search").Cells(5, 4).Value = "Item #"
Worksheets("Search").Cells(5, 5).Value = "Price"
Worksheets("Search").Cells(5, 6).Value = "ATP Rule"
Worksheets("Search").Cells(5, 7).Value = "Warranty Period"
Worksheets("Search").Cells(5, 8).Value = "Std Pack Qty"
Worksheets("Search").Cells(5, 9).Value = "OBS Date"
'
' Header Colors
'
Worksheets("Search").Range(Cells(5, 2), Cells(5, 2)).Interior.ColorIndex = 37 ' blue
Worksheets("Search").Range(Cells(5, 3), Cells(5, 5)).Interior.ColorIndex = 42 ' green
Worksheets("Search").Range(Cells(5, 6), Cells(5, 9)).Interior.ColorIndex = 37 ' blue
'
Dots$ = " ................................................................."
'
' Assign Cal Descriptions
'
' Clear search results area (1000 rows)
'
Worksheets("Search").Range("A6:P20000").UnMerge ' UnMerge Cells
Worksheets("Search").Range("A6:P20000").Value = "" ' clear Search Results area
Worksheets("Search").Range("A6:P20000").Style = "Normal" ' set style
Worksheets("Search").Range("A6:P20000").Interior.ColorIndex = 2 ' paint area white
Worksheets("Search").Range("A6:P20000").RowHeight = 14 ' set row height
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).LineStyle = xlDouble
Worksheets("Search").Range("A6:P20000").Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Worksheets("Search").Range("A6:P20000").WrapText = False ' do not wrap text
Worksheets("Search").Range("A6:P20000").Font.Bold = False ' unbold area
Worksheets("Search").Range("A6:P20000").Font.Size = 10 ' set font size
'
' Price List Viewed and its Currency & Exchange Rate
'
Price_Currency = 1
PL_ColumnVar = 0
If FG_List = "Euro Country" Then
  Price_List = Worksheets("Workcodes").Cells(32, 13).Value
  PL_Currency = "EURO"
  Worksheets("Search").Range("G2").Value = "EUR" ' Change the currency cell
End If
If FG_List = "Denmark" Then
  Price_List = Worksheets("Workcodes").Cells(34, 13).Value
  PL_Currency = "DKK"
  Price_Currency = Worksheets("Workcodes").Cells(18, 8).Value
  PL_ColumnVar = 6
  Worksheets("Search").Range("G2").Value = "DKK" ' Change the currency cell
End If
If FG_List = "EEMEA in USD" Then
  Price_List = Worksheets("Workcodes").Cells(38, 13).Value
  PL_Currency = "USD"
  Price_Currency = Worksheets("Workcodes").Cells(22, 8).Value
  PL_ColumnVar = 18
  Worksheets("Search").Range("G2").Value = "USD" ' Change the currency cell
End If
If FG_List = "Norway" Then
  Price_List = Worksheets("Workcodes").Cells(35, 13).Value
  PL_Currency = "NOK"
  Price_Currency = Worksheets("Workcodes").Cells(19, 8).Value
  PL_ColumnVar = 9
  Worksheets("Search").Range("G2").Value = "NOK" ' Change the currency cell
End If
If FG_List = "Sweden" Then
  Price_List = Worksheets("Workcodes").Cells(36, 13).Value
  PL_Currency = "SEK"
  Price_Currency = Worksheets("Workcodes").Cells(20, 8).Value
  PL_ColumnVar = 12
  Worksheets("Search").Range("G2").Value = "SEK" ' Change the currency cell
End If
If FG_List = "Switzerland" Then
  Price_List = Worksheets("Workcodes").Cells(33, 13).Value
  PL_Currency = "CHF"
  Price_Currency = Worksheets("Workcodes").Cells(17, 8).Value
  PL_ColumnVar = 3
  Worksheets("Search").Range("G2").Value = "CHF" ' Change the currency cell
End If
If FG_List = "UK in GBP" Then
  Price_List = Worksheets("Workcodes").Cells(37, 13).Value
  PL_Currency = "GBP"
  Price_Currency = Worksheets("Workcodes").Cells(21, 8).Value
  PL_ColumnVar = 15
  Worksheets("Search").Range("G2").Value = "EUR" ' Change the currency cell
End If
Worksheets("Search").Cells(1, 2).Value = Price_List
'
If Len(Worksheets("Search").Range("C3")) < 3 Then ' Must search on 3 or more characters.
  Response = MsgBox("Please enter 3 or more characters and search again. ( For 2 digit models, try preceding with a dash.If no match, enter digits followed by a space. )", 0, "Model Search Criteria")
  Exit Sub
End If
'
' Rounding defaults / break points
'
RounUp_Value_A1 = 0.1 ' Variable for rounding
RounUp_Value_A2 = 0.2 ' Variable for rounding
RounUp_Value_A3 = 0.5 ' Variable for rounding
RounUp_Value_A4 = 1   ' Variable for rounding
'
RounUp_Value_B1 = 100 ' price break at 100
RounUp_Value_B2 = 200 ' price break at 200
RounUp_Value_B3 = 400 ' price break at 400
'
MatchRow = 6
Matches = 0 ' count number of matches
Worksheets("Search").Range("D2").Value = Matches ' Matches found
'
For Row = 6 To 22000
  '
  Item_Nr = Worksheets("FG + OTC").Cells(Row, 1).Value
  If Len(Item_Nr) = 0 Then Exit For ' exit loop if Product Family cell is empty
  SearchText1 = Worksheets("FG + OTC").Cells(Row, 1).Value ' Item number
  SearchText2 = Worksheets("FG + OTC").Cells(Row, 2).Value ' Item Description
  SearchText3 = Worksheets("FG + OTC").Cells(Row, 3).Value ' Extra info search
  SearchText = SearchText1 + " " + SearchText2 + " " + SearchText3
  '
  If SearchText Like SearchPattern Then
    '
    Matches = Matches + 1 ' count number of matches
    '
    ' Assign variables
    '
'    Item_Nr = Worksheets("FG + OTC").Cells(Row, 1).Value
    Item_Description = Worksheets("FG + OTC").Cells(Row, 2).Value
    Item_Xref = Worksheets("FG + OTC").Cells(Row, 3).Value
    '
    Item_Price = Worksheets("FG + OTC").Cells(Row, (4 + PL_ColumnVar)).Value ' Price
    Price_Start_Date = Worksheets("FG + OTC").Cells(Row, (5 + PL_ColumnVar)).Value ' Start date of the price
    Price_End_date = Worksheets("FG + OTC").Cells(Row, (6 + PL_ColumnVar)).Value ' End date of the price
    '
    Repl_by = Worksheets("FG + OTC").Cells(Row, 25).Value
    Item_OBS_Date = Worksheets("FG + OTC").Cells(Row, 56).Value
    '
    OTC_CalNet = Worksheets("FG + OTC").Cells(Row, 31).Value
    CodeOTC_CalNet = Worksheets("Workcodes").Cells(39, 2).Value + Dots$ ' description for OTC calibration
    CodeOTC_CalNetCR = Worksheets("Workcodes").Cells(40, 2).Value ' description for OTC calibration for credit
    OTC_CalIntl = Worksheets("FG + OTC").Cells(Row, 32).Value
    CodeOTC_CalIntl = Worksheets("Workcodes").Cells(41, 2).Value + Dots$ ' description for OTC calibration
    CodeOTC_CalIntlCR = Worksheets("Workcodes").Cells(42, 2).Value ' description for OTC calibration for credit
    OTC_USA = Worksheets("FG + OTC").Cells(Row, 33).Value
    CodeOTC_USA = Worksheets("Workcodes").Cells(43, 2).Value + Dots$ ' description for OTC calibration (2 liner)
    CodeOTC_USA_Note = Worksheets("Workcodes").Cells(44, 2).Value ' description for OTC calibration (2 liner)
    '
    SVC_Rep_Policy = Worksheets("FG + OTC").Cells(Row, 38).Value
    CodeRBR = Worksheets("Workcodes").Cells(45, 2).Value + Dots$ ' description for RBR pricing
    FG_Warranty = Worksheets("FG + OTC").Cells(Row, 39).Value
      If Val(FG_Warranty) > 80 Then FG_Warranty = FG_Warranty + " days"
      If Val(FG_Warranty) > 10 And Val(FG_Warranty) <= 80 Then FG_Warranty = FG_Warranty + " months"
      If Val(FG_Warranty) > 1 And Val(FG_Warranty) <= 10 Then FG_Warranty = FG_Warranty + " years"
      If Val(FG_Warranty) = 1 Then FG_Warranty = FG_Warranty + " year"
    '
    OD_Item_LineH_sub = Worksheets("FG + OTC").Cells(Row, 41).Value
    If OD_Item_LineH_sub = "" Then
        OD_Item_LineH = 13
      Else
        OD_Item_LineH = 17 + ((OD_Item_LineH_sub - 1) * 13)
    End If
    OD_Item_Com = Worksheets("FG + OTC").Cells(Row, 42).Value
    '
    FASC_Item_Publ = Worksheets("FG + OTC").Cells(Row, 43).Value
    FASC_Item_LineH_sub = Worksheets("FG + OTC").Cells(Row, 44).Value
    If FASC_Item_LineH_sub = "" Then
        FASC_Item_LineH = 13
      Else
        FASC_Item_LineH = 17 + ((FASC_Item_LineH_sub - 1) * 13)
    End If
    FASC_Item_Com = Worksheets("FG + OTC").Cells(Row, 45).Value
    '
    SC_Item_LineH_sub = Worksheets("FG + OTC").Cells(Row, 46).Value
    If SC_Item_LineH_sub = "" Then
        SC_Item_LineH = 13
      Else
        SC_Item_LineH = 17 + ((SC_Item_LineH_sub - 1) * 13)
    End If
    SC_Item_Com = Worksheets("FG + OTC").Cells(Row, 47).Value
    '
    ' Item_Xref = Worksheets("FG + OTC").Cells(Row, 31).Value ' X-reference, like 12nc
    ' EDC_Policy = Worksheets("FG + OTC").Cells(Row, 31).Value ' EDC Item inventory policy - STK, CD, or LTB
    ProdFamily = Worksheets("FG + OTC").Cells(Row, 51).Value ' Product Family
    ModelGroup = Worksheets("FG + OTC").Cells(Row, 52).Value
    Item_ATP = Worksheets("FG + OTC").Cells(Row, 53).Value
      Dim UpperCase, LowerCase
      UpperCase = Item_ATP            ' String to convert.
      LowerCase = LCase(UpperCase)    ' Returns "ATP in lower case".
      Item_ATP = LowerCase
    Item_UoM = Worksheets("FG + OTC").Cells(Row, 54).Value
    Std_Pack_Q = Worksheets("FG + OTC").Cells(Row, 55).Value
    If Std_Pack_Q = "" Then Std_Pack_Q = 1
    Item_OBS_Date = Worksheets("FG + OTC").Cells(Row, 56).Value
    Item_CoO = Worksheets("FG + OTC").Cells(Row, 57).Value
    '
    ' Output matches - Light blue section - 34
    '
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders.Color = RGB(255, 255, 255) ' white borders
    Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).UnMerge ' UnMerge Cells
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 2)).Interior.ColorIndex = 34 ' light blue
    ' Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 42
    Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 3)).HorizontalAlignment = xlHAlignLeft ' left justify
    Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' displayed in bold
    Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of product family
    Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output
    Worksheets("Search").Cells(MatchRow, 2).Value = ProdFamily ' Product Family
    '
    ' Output matches - Light green section - 35
    '
    Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 5)).Interior.ColorIndex = 35 ' light green
    Worksheets("Search").Cells(MatchRow, 3).NumberFormat = Text ' Format String
    ' Worksheets("Search").Cells(MatchRow, 3).Font.Bold = True ' Bold Model
    Worksheets("Search").Cells(MatchRow, 3).Value = Item_Description ' " " + Item_Description
    If Len(Item_Description) > 40 Then
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).VerticalAlignment = xlCenter
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 25.5
    End If
    Worksheets("Search").Cells(MatchRow, 1).Value = Len(Item_Description)
    Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True ' Bold item
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter ' Center alignment
    Worksheets("Search").Cells(MatchRow, 4).Value = Item_Nr ' cross reference, like eg. 12nc or acquisition (LEM) item nr.
    '
    If PL_Currency = "EURO" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "CHF" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$SFr-807]* #,##0.00 _);_([$SFr-807]* (#,##0 );_([$SFr-807]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "DKK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$kr-406]* #,##0.00 _);_([$kr-406]* (#,##0 );_([$kr-406]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "NOK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$kr-414]* #,##0.00 _);_([$kr-414]* (#,##0 );_([$kr-414]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "SEK" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_(#,##0.00* [$kr-41D] _);_(#,##0* ([$kr-41D] );_(""-""* [$kr-41D] _);_(@ _)" ' has different order compared to NOK or DKK
    End If
    If PL_Currency = "GBP" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
    End If
    If PL_Currency = "USD" Then
      Worksheets("Search").Cells(MatchRow, 5).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
    End If
    Worksheets("Search").Cells(MatchRow, 5).Font.Bold = True ' Bold Model
    '
    If Item_Price <> "" Then
      Worksheets("Search").Cells(MatchRow, 5).Value = Item_Price
    Else
      Worksheets("Search").Cells(MatchRow, 5).Value = "not available"
    End If
    '
    ' Output matches - Light blue section - 34
    '
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).Interior.ColorIndex = 34 ' light blue
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 9)).HorizontalAlignment = xlHAlignCenter ' mid justify
    Worksheets("Search").Cells(MatchRow, 6).Value = Item_ATP
    Worksheets("Search").Range(Cells(MatchRow, 6), Cells(MatchRow, 8)).Font.Size = 8
    '
    Worksheets("Search").Cells(MatchRow, 7).Value = FG_Warranty
    Worksheets("Search").Cells(MatchRow, 8).Value = Std_Pack_Q
    Worksheets("Search").Cells(MatchRow, 9).NumberFormat = "d-mmm-yy"
    Worksheets("Search").Cells(MatchRow, 9).Value = Item_OBS_Date
    If Item_OBS_Date <> "" Then
      Worksheets("Search").Cells(MatchRow, 9).Interior.ColorIndex = 3 ' 38 for pink
      Worksheets("Search").Cells(MatchRow, 9).Font.Bold = True
      Worksheets("Search").Cells(MatchRow, 9).Font.ColorIndex = 2
    End If
    '
    ' Line 1 - Optional in case the search item has a replacement
    '
    If Repl_by <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Interior.ColorIndex = 38
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Font.Bold = True
      ' Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Font.ColorIndex = 2
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
      Worksheets("Search").Cells(MatchRow, 3).Value = "Replacement part is : "
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
      Worksheets("Search").Cells(MatchRow, 4).Value = Repl_by
    End If
    '
    If Item_Price <> "" Then ' match found, but not available for the area - skip remainder line information
    '
    ' Line 2 - Start Date and Unit of Measurement / order quanitity
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Cells(MatchRow, 3).RowHeight = 3
    '
    MatchRow = MatchRow + 1
    '
    Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 3).Value = "Start date of the price is : "
    Worksheets("Search").Cells(MatchRow, 4).NumberFormat = "d-mmm-yy"
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
    Worksheets("Search").Cells(MatchRow, 4).Value = Price_Start_Date
    '
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge
    Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 5).Value = "Unit of Measurement / Order quantity is : "
    Worksheets("Search").Cells(MatchRow, 9).Value = Item_UoM
    '
    ' Line 3 - Optional in case the price end date is set
    '
    If Price_End_date <> "" Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
      Worksheets("Search").Cells(MatchRow, 3).Value = "End date of the price is : "
      Worksheets("Search").Cells(MatchRow, 4).NumberFormat = "d-mmm-yy"
      Worksheets("Search").Cells(MatchRow, 4).Interior.ColorIndex = 3
      Worksheets("Search").Cells(MatchRow, 4).Font.Bold = True
      Worksheets("Search").Cells(MatchRow, 4).Font.ColorIndex = 2
      Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
      Worksheets("Search").Cells(MatchRow, 4).Value = Price_End_date
    End If
    '
    ' Line 4 - Model group and Country of Origin
    '
    MatchRow = MatchRow + 1
    '
    Worksheets("Search").Cells(MatchRow, 3).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 3).Value = "Model Group is : "
    Worksheets("Search").Cells(MatchRow, 4).HorizontalAlignment = xlHAlignCenter
    Worksheets("Search").Cells(MatchRow, 4).Value = ModelGroup
    '
    Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge
    Worksheets("Search").Cells(MatchRow, 5).HorizontalAlignment = xlRight
    Worksheets("Search").Cells(MatchRow, 5).Value = "Country of Origin is : "
    Worksheets("Search").Cells(MatchRow, 9).Value = Item_CoO
    '
    MatchRow = MatchRow + 1
    Worksheets("Search").Cells(MatchRow, 3).RowHeight = 3
    '
    ' Output yellow comment row(s) - 36
    '
    ' Combine the multiple comments into one comment block
    '
    ' Service Center comment
    '
    If Len(SC_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "S C"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = SC_Item_Com
      ' Worksheets("Search").Cells(MatchRow, 3).Rows.AutoFit
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = SC_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      '
      ' Dotted line to seperate with the next comment to be published
      '
      If Len(OD_Item_Com) > 0 Or Len(FASC_Item_Com) > 0 Then
        With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
        End With
      End If
      '
    End If ' end of service center comment
    '
    ' C I O comment
    '
    If Len(OD_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "C I O"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = OD_Item_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = OD_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
      '
      ' Dotted line to seperate with the next comment to be published
      '
      If Len(FASC_Item_Com) > 0 Then
        With Worksheets("Search").Range(Cells(MatchRow, 2), Cells(MatchRow, 9)).Borders(xlEdgeBottom)
          .LineStyle = xlContinuous
          .Weight = xlHairline
          .ColorIndex = xlAutomatic
        End With
      End If
      '
    End If ' end CIO comment
    '
    ' Customer comment
    '
    If Len(FASC_Item_Com) > 0 Then
      MatchRow = MatchRow + 1
      Worksheets("Search").Cells(MatchRow, 2).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 2).Font.Bold = True ' Bold Service Group
      Worksheets("Search").Cells(MatchRow, 2).Font.Size = 8 ' Font size of the Service Group
      Worksheets("Search").Cells(MatchRow, 2).HorizontalAlignment = xlCenter ' Center the output; the Service Group
      Worksheets("Search").Cells(MatchRow, 2).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 2).Value = "Customer"
      Worksheets("Search").Cells(MatchRow, 3).Interior.ColorIndex = 36
      Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Font.Size = 10
      Worksheets("Search").Cells(MatchRow, 3).VerticalAlignment = xlVAlignCenter
      Worksheets("Search").Cells(MatchRow, 3).WrapText = True
      Worksheets("Search").Cells(MatchRow, 3).Value = FASC_Item_Com
      Worksheets("Search").Cells(MatchRow, 3).RowHeight = FASC_Item_LineH
      Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 9)).Merge ' Merge Cells
      Worksheets("Search").Cells(MatchRow, 3).IndentLevel = 2
    End If
    '
    ' Line 5 - OTC for traceable and accredited calibration calculated from European Master data file (EUR) for services
    '
    ' OTC for traceable calibration with the measurement results
    '
    If OTC_CalNet <> "" Or OTC_CalIntl <> "" Then
      '
      ' blank line with lfet border
      '
      If SC_Item_Com = "" And OD_Item_Com = "" And FASC_Item_Com = "" Then
        MatchRow = MatchRow + 1
        Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 3
      End If
      '
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "CHF" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$SFr-807]* #,##0.00 _);_([$SFr-807]* (#,##0 );_([$SFr-807]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "DKK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$kr-406]* #,##0.00 _);_([$kr-406]* (#,##0 );_([$kr-406]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "NOK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$kr-414]* #,##0.00 _);_([$kr-414]* (#,##0 );_([$kr-414]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "SEK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_(#,##0.00* [$kr-41D] _);_(#,##0* ([$kr-41D] );_(""-""* [$kr-41D] _);_(@ _)" ' has different order compared to NOK or DKK
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      ' Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeOTC_CalNet
      Worksheets("Search").Cells(MatchRow, 3).Select
      '
      If OTC_CalNet <> "" Then
        If OTC_CalNet = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = OTC_CalNet / Price_Currency
          '
          ' Roundup to 0.10 ( RounUp_Value_A1 ) < 100 ( RounUp_Value_B1 )
          '
          If Left_Disc < RounUp_Value_B1 Then ' 100
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A1), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A1)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A1)) + RounUp_Value_A1
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A1)
            End If
          End If
          '
          ' Roundup to 0.20 ( RounUp_Value_A2 ) between 100 and 200 ( RounUp_Value_B2 )
          '
          If Left_Disc >= RounUp_Value_B1 And Left_Disc < RounUp_Value_B2 Then ' between 100 and 200
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A2), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A2)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A2)) + RounUp_Value_A2
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A2)
            End If
          End If
          '
          ' Roundup to 0.50 ( RounUp_Value_A3 ) between 200 and 400 euro, and above 400 ( RounUp_Value_B3 )
          '
          If Left_Disc >= RounUp_Value_B2 And Left_Disc < RounUp_Value_B3 Then ' between 200 and 400
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A3), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A3)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A3)) + RounUp_Value_A3
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A3)
            End If
          End If
          '
          ' Roundup to 1.00 ( RounUp_Value_A4 ) above 400 ( RounUp_Value_B3 )
          '
          If Left_Disc >= RounUp_Value_B3 Then ' above 400
            Price_Left_sub1 = Round(Left_Disc, 0)
            Price_Left_sub2 = Left_Disc
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1) + RounUp_Value_B3
            Else
              Price_Left = Price_Left_sub1
            End If
          End If
          OTC_CalNet = Price_Left
          '
          ' OTC traceable calibration price output
          '
          If OTC_CalNet <> "" Then
            Worksheets("Search").Cells(MatchRow, 4).Value = OTC_CalNet
          Else
            Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Merge
          End If
        End If
      End If
      '
      ' OTC for accredited calibration with the measurement results
      '
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
      Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
      If OTC_CalIntl <> "" Then
        If OTC_CalIntl = "1" Then
          Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
        Else
          Right_Disc = OTC_CalIntl / Price_Currency
          '
          ' Roundup to 0.10 ( RounUp_Value_A1 ) < 100 ( RounUp_Value_B1 )
          '
          If Right_Disc < RounUp_Value_B1 Then ' below 100
            Price_Right_sub1 = Round(Right_Disc * (1 / RounUp_Value_A1), 0)
            Price_Right_sub2 = Right_Disc * (1 / RounUp_Value_A1)
            Price_Right_sub3 = Price_Right_sub2 - Price_Right_sub1
            '
            If Price_Right_sub3 > 0 Then
              Price_Right = (Price_Right_sub1 / (1 / RounUp_Value_A1)) + RounUp_Value_A1
            Else
              Price_Right = Price_Right_sub1 / (1 / RounUp_Value_A1)
            End If
          End If
          '
          ' Roundup to 0.20 ( RounUp_Value_A2 ) between 100 and 200 ( RounUp_Value_B2 )
          '
          If Right_Disc >= RounUp_Value_B1 And Right_Disc < RounUp_Value_B2 Then ' between 100 and 200
            Price_Right_sub1 = Round(Right_Disc * (1 / RounUp_Value_A2), 0)
            Price_Right_sub2 = Right_Disc * (1 / RounUp_Value_A2)
            Price_Right_sub3 = Price_Right_sub2 - Price_Right_sub1
            '
            If Price_Right_sub3 > 0 Then
              Price_Right = (Price_Right_sub1 / (1 / RounUp_Value_A2)) + RounUp_Value_A2
            Else
              Price_Right = Price_Right_sub1 / (1 / RounUp_Value_A2)
            End If
          End If
          '
          ' Roundup to 0.50 ( RounUp_Value_A3 ) between 200 and 400 ( RounUp_Value_B3 )
          '
          If Right_Disc >= RounUp_Value_B2 And Right_Disc < RounUp_Value_B3 Then ' between 200 and 400
            Price_Right_sub1 = Round(Right_Disc * (1 / RounUp_Value_A3), 0)
            Price_Right_sub2 = Right_Disc * (1 / RounUp_Value_A3)
            Price_Right_sub3 = Price_Right_sub2 - Price_Right_sub1
            '
            If Price_Right_sub3 > 0 Then
              Price_Right = (Price_Right_sub1 / (1 / RounUp_Value_A3)) + RounUp_Value_A3
            Else
              Price_Right = Price_Right_sub1 / (1 / RounUp_Value_A3)
            End If
          End If
          '
          ' Roundup to 1.00 ( RounUp_Value_A4 ) above 400 ( RounUp_Value_B3 )
          '
          If Right_Disc >= RounUp_Value_B3 Then ' above 400
            Price_Right_sub1 = Round(Right_Disc, 0)
            Price_Right_sub2 = Right_Disc
            Price_Right_sub3 = Price_Right_sub2 - Price_Right_sub1
            '
            If Price_Right_sub3 > 0 Then
              Price_Right = (Price_Right_sub1) + 1
            Else
              Price_Right = Price_Right_sub1
            End If
          End If
          OTC_CalIntl = Price_Right
          '
          ' OTC accredited calibration price output
          '
          If OTC_CalIntl <> "" Then
            Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_CalIntl
            Worksheets("Search").Cells(MatchRow, 9).Value = OTC_CalIntl
          Else
            Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_CalIntl
            Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 9)).Merge
          End If
          '
          ' Second line for credit information
          '
          MatchRow = MatchRow + 1
          If OTC_CalNet <> "" Then Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeOTC_CalNetCR
          If OTC_CalIntl <> "" Then
            Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
            Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
            Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_CalIntlCR
          End If ' end second line OTC of CalNet & CalIntl
        End If   ' end of calculation
      End If     ' end quotation or calculation
    End If       ' end of line 5
    '
    ' Line 6 - RBR policy and OTC accredited calibration in the USA
    '
    If SVC_Rep_Policy <> "" Or OTC_USA <> "" Then
      '
      ' blank line with left border
      '
      If SC_Item_Com = "" And OD_Item_Com = "" And FASC_Item_Com = "" And OTC_CalNet = "" And OTC_CalIntl = "" Then
        MatchRow = MatchRow + 1
        Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 3
      End If
      '
      MatchRow = MatchRow + 1
      Worksheets("Search").Range(Cells(MatchRow, 5), Cells(MatchRow, 8)).Merge ' Merge Cells
      If PL_Currency = "EURO" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-2]* #,##0.00 _);_([$|fffd|-2]* (#,##0 );_([$|fffd|-2]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "CHF" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$SFr-807]* #,##0.00 _);_([$SFr-807]* (#,##0 );_([$SFr-807]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "DKK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$kr-406]* #,##0.00 _);_([$kr-406]* (#,##0 );_([$kr-406]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "NOK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$kr-414]* #,##0.00 _);_([$kr-414]* (#,##0 );_([$kr-414]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "SEK" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_(#,##0.00* [$kr-41D] _);_(#,##0* ([$kr-41D] );_(""-""* [$kr-41D] _);_(@ _)" ' has different order compared to NOK or DKK
      End If
      If PL_Currency = "GBP" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$|fffd|-809]* #,##0.00 _);_([$|fffd|-809]* (#,##0 );_([$|fffd|-809]* ""-"" _);_(@ _)"
      End If
      If PL_Currency = "USD" Then
        Worksheets("Search").Range(Cells(MatchRow, 4), Cells(MatchRow, 9)).NumberFormat = "_([$$]* #,##0.00 _);_([$$]* (#,##0 );_([$$]* ""-"" _);_(@ _)"
      End If
      ' Worksheets("Search").Cells(MatchRow, 3).Borders(xlEdgeLeft).Color = RGB(0, 0, 0)
      Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeRBR
      Worksheets("Search").Cells(MatchRow, 3).Select
      '
      Worksheets("Search").Cells(MatchRow, 1).Value = SVC_Rep_Policy
      Worksheets("Search").Cells(MatchRow, 2).Value = "=Trim(RC[-1])"
      Worksheets("Search").Cells(MatchRow, 4).Value = "=IF(ISERROR(VLOOKUP(RC[-2],Services!C1:C4,4,FALSE)),""not avalailable"",VLOOKUP(RC[-2],Services!C1:C4,4,FALSE))"
      Worksheets("Search").Cells(MatchRow, 4).Select
      Selection.Copy
      Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
      Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 2)).Value = ""
      '
      ' Change RBR price with currency
      '
      RBR_Price_Sub = Worksheets("Search").Cells(MatchRow, 4).Value
      If RBR_Price_Sub <> "not avalailable" Then
      If RBR_Price_Sub <> "" Then
        If RBR_Price_Sub = "1" Then
          Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
        Else
          Left_Disc = RBR_Price_Sub / Price_Currency
          '
          ' Roundup to 0.10 ( RounUp_Value_A1 ) < 100 ( RounUp_Value_B1 )
          '
          If Left_Disc < RounUp_Value_B1 Then ' 100
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A1), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A1)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A1)) + RounUp_Value_A1
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A1)
            End If
          End If
          '
          ' Roundup to 0.20 ( RounUp_Value_A2 ) between 100 and 200 ( RounUp_Value_B2 )
          '
          If Left_Disc >= RounUp_Value_B1 And Left_Disc < RounUp_Value_B2 Then ' between 100 and 200
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A2), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A2)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A2)) + RounUp_Value_A2
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A2)
            End If
          End If
          '
          ' Roundup to 0.50 ( RounUp_Value_A3 ) between 200 and 400 euro, and above 400 ( RounUp_Value_B3 )
          '
          If Left_Disc >= RounUp_Value_B2 And Left_Disc < RounUp_Value_B3 Then ' between 200 and 400
            Price_Left_sub1 = Round(Left_Disc * (1 / RounUp_Value_A3), 0)
            Price_Left_sub2 = Left_Disc * (1 / RounUp_Value_A3)
            Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
            '
            If Price_Left_sub3 > 0 Then
              Price_Left = (Price_Left_sub1 / (1 / RounUp_Value_A3)) + RounUp_Value_A3
            Else
              Price_Left = Price_Left_sub1 / (1 / RounUp_Value_A3)
            End If
          End If
          '
          ' Roundup to 1.00 ( RounUp_Value_A4 ) above 400 ( RounUp_Value_B3 )
          '
            If Left_Disc >= RounUp_Value_B3 Then ' above 400
              Price_Left_sub1 = Round(Left_Disc, 0)
              Price_Left_sub2 = Left_Disc
              Price_Left_sub3 = Price_Left_sub2 - Price_Left_sub1
              '
              If Price_Left_sub3 > 0 Then
                Price_Left = (Price_Left_sub1) + RounUp_Value_A4
              Else
                Price_Left = Price_Left_sub1
              End If
            End If
            RBR_Price = Price_Left
          End If   ' end of end of calculation
        End If     ' end of RBR with quoted or price
        '
        ' If applicable RBR price filed will have changed
        '
        Worksheets("Search").Cells(MatchRow, 4).Value = RBR_Price
        '
        ' OTC for accredited calibration done in the USA
        '
        Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
        Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
        If OTC_USA <> "" Then
          If OTC_USA = "1" Then
            If SVC_Rep_Policy = "" Then
              Worksheets("Search").Cells(MatchRow, 3).Value = " " + CodeOTC_USA
              Worksheets("Search").Cells(MatchRow, 4).Value = "Quoted"
            Else
              Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_USA
              Worksheets("Search").Cells(MatchRow, 9).Value = "Quoted"
            End If
          Else
            If SVC_Rep_Policy = "" Then
              Worksheets("Search").Range(Cells(MatchRow, 3), Cells(MatchRow, 4)).Merge
            Else
              Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_USA
              Worksheets("Search").Cells(MatchRow, 9).Value = OTC_USA
            End If
          End If
          '
          ' Second line for credit information
          '
          MatchRow = MatchRow + 1
          If OTC_USA <> "" Then
            Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).LineStyle = xlDouble
            Worksheets("Search").Cells(MatchRow, 5).Borders(xlEdgeLeft).Color = RGB(0, 0, 0) 'black left border
            Worksheets("Search").Cells(MatchRow, 5).Value = " " + CodeOTC_USA_Note
          End If
        End If ' end of OTC accr. cal in the USA
      End If   ' end of match found, but not available for thre country / area
      End If   ' end for "not available" of RBR price
    End If     ' end of match found
    '
    ' Blank line
    '
    ' End of found part(s)
    MatchRow = MatchRow + 1
    Worksheets("Search").Range(Cells(MatchRow, 1), Cells(MatchRow, 10)).RowHeight = 8
    '
    Worksheets("Search").Range("D2").Value = Matches ' Matches found
    '
    If Matches = 1 Then
      Worksheets("Search").Range("E2").Value = "model found."
    Else
      Worksheets("Search").Range("E2").Value = "models found."
    End If
    MatchRow = MatchRow + 1
  End If
  '
Next Row
'
' Clear cells beyond end of matches
'
Worksheets("Search").Range(Cells(MatchRow, 1), Cells((MatchRow + 20000), 10)).Select
Selection.Delete Shift:=xlUp
For x = MatchRow To MatchRow + 10
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Value = "" ' clear Search Results area
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Interior.ColorIndex = 2 ' paint area white
  Worksheets("Search").Range(Cells(x, 1), Cells(x, 10)).Borders(xlEdgeLeft).Color = RGB(255, 255, 255) ' white borders
Next x
'
Worksheets("Search").Range("A6").Select 'return to Search cell
Worksheets("Search").Range("C4").Value = "Made by Henry Boelaars"
Worksheets("Search").Range("C3").Select 'return to Search cell
DisplayAlerts = True ' turn on warnings
'
End Sub ' End of search for matches for FG's

Attribute VB_Name = "Module3"
'
Sub Button1_Click()
Attribute Button1_Click.VB_ProcData.VB_Invoke_Func = " \n14"
' Search shortcut for Fluke-17x
  SearchPattern = "FLUKE-17*"
  Worksheets("Search").Range("C3").Value = "FLUKE-17"
  Call Search
End Sub
'
Sub Button2_Click()
Attribute Button2_Click.VB_ProcData.VB_Invoke_Func = " \n14"
' Search shortcut for Fluke-8xx
  SearchPattern = "FLUKE-8*"
  Worksheets("Search").Range("C3").Value = "FLUKE-8"
  Call Search
End Sub
'
Sub Button3_Click()
Attribute Button3_Click.VB_ProcData.VB_Invoke_Func = " \n14"
' Search shortcut for Fluke-18x
  SearchPattern = "FLUKE-18*"
  Worksheets("Search").Range("C3").Value = "FLUKE-18"
  Call Search
End Sub
'
Sub Button4_Click()
Attribute Button4_Click.VB_ProcData.VB_Invoke_Func = " \n14"
' Search shortcut for DSP
  SearchPattern = "DSP*"
  Worksheets("Search").Range("C3").Value = "DSP*"
  Call Search
End Sub

Attribute VB_Name = "Module4"
Attribute VB_Name = "Module5"
Sub Copy_Strategic_Info()
Attribute Copy_Strategic_Info.VB_Description = "Macro recorded 1/17/2008 by Fluke"
Attribute Copy_Strategic_Info.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Copy_Strategic_Info Macro
' Initial Creation; January 17, 2008 by Henry Boelaars
'
' Modifications;
' V09-1: January 15, 2009
'   Review V07-x and V08-x to previous archived files for changes made.
'   Added new column for "Line height of the comment field
'   Seperated the comments by price list
'   Changed T&M field to FASC Policy
'   Some more layout changes like to SvcGrp / PrdFam
'
    Sheets("Prices + EDR").Select
    Range("C4").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    '
    ' Adding character to last record
    '
    Range(['Column order'!G2]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G26]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G27]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G28]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G29]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G30]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G31]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G32]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G33]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G34]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G35]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G52]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G53]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G54]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G55]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G56]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G57]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G58]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G59]).Select
    ActiveCell.FormulaR1C1 = "z"
    Range(['Column order'!G60]).Select
    ActiveCell.FormulaR1C1 = "z"
    '
    ActiveWorkbook.Save
    '
    ' Copy formula's from column Y thru AA
    '
    Range("Y6:AA6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("Y:AA").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy formula's from column AB thru AD
    '
    Range("AB6:AD6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("AB:AD").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy formula's from column AE thru AH
    '
    Range("AE6:AH6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("AE:AH").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy CSS Strategic Info to column AY thru BA
    '
    Range("AY6:BA6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("AY:BA").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy CSS Strategic Info to column BB thru BD
    '
    Range("BB6:BD6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("BB:BD").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy CSS Strategic Info to column BE thru BG
    '
    Range("BE6:BG6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("BE:BG").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Copy product group (Labs) or product family (European price lists) to column A
    '
    Range("A6").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
    Range("B5").Select
    Calculate
    Columns("A").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    ActiveWorkbook.Save
    '
    ' Change the sorting order
    '
        Rows("5:5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Sort Key1:=Range("D6"), Order1:=xlAscending, Key2:=Range("A6") _
        , Order2:=xlAscending, Key3:=Range("B6"), Order3:=xlAscending, Header:= _
        xlYes, OrderCustom:=1, MatchCase:=False, Orientation:=xlTopToBottom, _
        DataOption1:=xlSortNormal, DataOption2:=xlSortNormal, DataOption3:= _
        xlSortNormal
    '
    Range("B5").Select
    '
    ' Delete worksheet "Column Order" & change to "Search" worksheet.
    '
    Sheets("Column order").Select
    ActiveWindow.SelectedSheets.Delete
    Sheets("Search").Select
    Range("C3").Select
'
End Sub

Attribute VB_Name = "Module6"
Attribute VB_Name = "Module7"
Attribute VB_Name = "Module8"
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True













Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True













Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True













Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True













Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Begin_Search, 17, 0, MSForms, CommandButton"













Private Sub Begin_Search_Click()
  Worksheets("Search").Range("A6").Select 'move out of Model cell
  Call Assign_Search_Pattern
End Sub
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True













Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{7B9900B8-75A9-4586-AB58-2C1DC758BBA5}{470FE12F-6EE1-4164-9DFD-84FB92453B48}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


INQUEST-PP=macro
