Attribute VB_Name = "Feuil1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Label1_Click()

End Sub
'Stoping user for Ctrl+ D


Private Sub Worksheet_Change(ByVal Target As Range)
On Error GoTo Errirfound
Application.EnableEvents = False

'Major NC
If Target.Address = "$G$19" Then
    If Range("G19").Value = "Open" Then
    Range("G20").Value = Range("AT9").Value
    Application.EnableEvents = True
    Exit Sub
    End If
End If
'Minor NC
If Target.Address = "$T$19" Then
    If Range("T19").Value = "Open" Then
    Range("T20").Value = Range("G11").Value + 364
    Application.EnableEvents = True
    Exit Sub
    End If
 End If
'check closed MC nc for message
If Target.Address = "$G$19" Then
    If Range("G19").Value = "Close" Then
    MsgBox " Kindly enter 'Final Report Received Date' in AE20 cell . ", vbOKOnly + vbInformation, "Message"
    Range("G20").Value = ""
    Application.EnableEvents = True
    Exit Sub
    End If
End If
'clean with close option
If Target.Address = "$G$19" Or Target.Address = "$T$19" Then
    If Range("G19").Value = "Close" Or Range("T19").Value = "Close" Then
        Range("T20").Value = ""
        Application.EnableEvents = True
        Exit Sub
    End If
End If

'
'
'Application.EnableEvents = True

If Target.Address = "$G$15" Or Target.Address = "$AE$18" Or Target.Address = "$AE$17" Or Target.Address = "$AE$19" Then
Call HideRelelatedData(Range("TR_Conditions"), Range("AP1").Value)


End If
' This code to stop user for updation non cell
''SSC Reviewer
'Or Mid(Target.Address, 2, 2) = "AG" Or Mid(Target.Address, 2, 2) = "AI" Or Mid(Target.Address, 2, 2) = "AK"
Application.EnableEvents = False

If Mid(Target.Address, 2, 2) = "AE" Then
   If Cells(Selection.Row, 47).Value = "No" Then
      MsgBox " Macro will not allow to change this cell.", vbOKOnly + vbInformation, "Message - Alert"
      Target.Value = ""
      Application.EnableEvents = True
      
      Exit Sub
   End If
End If
'2
If Mid(Target.Address, 2, 2) = "AG" Then
   If Cells(Selection.Row, 48).Value = "No" Then
      MsgBox " Macro will not allow to change this cell.", vbOKOnly + vbInformation, "Message - Alert"
      Target.Value = ""
      Application.EnableEvents = True
      
      Exit Sub
   End If
End If
'3
If Mid(Target.Address, 2, 2) = "AI" Then
   If Cells(Selection.Row, 49).Value = "No" Then
      MsgBox " Macro will not allow to change this cell.", vbOKOnly + vbInformation, "Message - Alert"
      Target.Value = ""
      Application.EnableEvents = True
      
      Exit Sub
   End If
End If
'4
If Mid(Target.Address, 2, 2) = "AK" Then
   If Cells(Selection.Row, 50).Value = "No" Then
      MsgBox " Macro will not allow to change this cell.", vbOKOnly + vbInformation, "Message - Alert"
      Target.Value = ""
      Application.EnableEvents = True
      
      Exit Sub
   End If
End If
Application.EnableEvents = True
Exit Sub
Errirfound:
Application.EnableEvents = True

End Sub


       

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "Feuil2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Feuil5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    Call Record_SSC_results_in_dtb
    
    
End Sub
Attribute VB_Name = "Feuil6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    Call Record_PoV_LoA_results_in_dtb
    
    
End Sub
Attribute VB_Name = "Feuil7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    Call Record_PoV_results_in_dtb
    
    
End Sub
Attribute VB_Name = "Feuil8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()

    Call Record_PoV_results_in_dtb
        
End Sub
Attribute VB_Name = "MGlobal"
Dim Role_Stirng As String
Dim Exit_AsTechADR As String


Public Function CheckRole() As String
CheckRole = Role_Stirng
End Function
Public Function SetRole(ByVal Role As String)
Role_Stirng = Role
End Function

Public Function CheckTechnical() As String
CheckTechnical = Exit_AsTechADR
End Function
Public Function SetCheckTechnical(ByVal Role As String)
Exit_AsTechADR = Role
End Function

Public Sub HideRelelatedData(ADR As Variant, Role As Variant)
'ComboBox1.AddItem "SSC Reviewer"
'ComboBox1.AddItem "ADR/Technical Reviewer"
'ComboBox1.AddItem "Final Reviewer"
'ComboBox1.AddItem "General Viewer"
'Range("AP1").Value = UserForm1.ComboBox1.Text
Application.ScreenUpdating = False
Application.DisplayAlerts = False
On Error GoTo ErrorFound
Sheets("Review Checklist").Select
If Role = "General Viewer" Then
         Rows("23:88").Select
        ' If Selection.EntireRow.Hidden = True Then
         Selection.EntireRow.Hidden = False
        ' End If
         Application.ScreenUpdating = True
         Application.DisplayAlerts = True
         Range("Type_of_audit").Select
         Exit Sub
End If

' This code has been added for Certificate Issuer
If Role = "Certificate Issuer" Then

  'AP column check
    Rows("23:88").Select
   ' If Selection.SpecialCells(xlCellTypehide).EntireRow.Hidden = True Then
       Selection.EntireRow.Hidden = False
    'End If
    For X = 1 To 66 Step 1
        If Range("AY" & X + 22).Value = "No" Then
        Rows(X + 22).EntireRow.Hidden = True
        End If
    Next X
   
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Range("Type_of_audit").Select
    Exit Sub
 End If
If ADR = "YES" And Role = "SSC Reviewer" Then

  'AP column check
    Rows("23:88").Select
   ' If Selection.SpecialCells(xlCellTypehide).EntireRow.Hidden = True Then
       Selection.EntireRow.Hidden = False
    'End If
    For X = 1 To 66 Step 1
        If Range("AP" & X + 22).Value = "No" Then
        Rows(X + 22).EntireRow.Hidden = True
        End If
    Next X
   
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Range("Type_of_audit").Select
    Exit Sub
ElseIf ADR = "YES" And Role = "ADR/Technical Reviewer" Then
  'AR column check
    Rows("23:88").Select
    'If Selection.EntireRow.Hidden = True Then
       Selection.EntireRow.Hidden = False
    'End If
    For X = 1 To 66 Step 1
        If Range("AR" & X + 22).Value = "No" Then
        Rows(X + 22).EntireRow.Hidden = True
        End If
    Next X
    'Exit Sub
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Range("Type_of_audit").Select
    Exit Sub
ElseIf ADR = "NO" And Role = "ADR/Technical Reviewer" Then
  'AR column check
    Rows("23:88").Select
   ' If Selection.EntireRow.Hidden = True Then
       Selection.EntireRow.Hidden = False
    'End If
    For X = 1 To 66 Step 1
        If Range("AQ" & X + 22).Value = "No" Then
        Rows(X + 22).EntireRow.Hidden = True
        End If
    Next X
    'Exit Sub
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Range("Type_of_audit").Select
    Exit Sub
ElseIf ADR = "YES" And Role = "Final Reviewer" Then
  'AR column check
    Rows("23:88").Select
    'If Selection.EntireRow.Hidden = True Then
       Selection.EntireRow.Hidden = False
    'End If
    For X = 1 To 66 Step 1
        If Range("AS" & X + 22).Value = "No" Then
        Rows(X + 22).EntireRow.Hidden = True
        End If
    Next X
    'Exit Sub
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Range("Type_of_audit").Select
    Exit Sub
End If
Exit Sub

ErrorFound:
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub
Attribute VB_Name = "Module1"
Sub PoV_results()
Dim CheckRole As String
Application.ScreenUpdating = False
Application.DisplayAlerts = False
CheckRole = MGlobal.CheckRole
If CheckRole <> "Final Reviewer" Then
    MsgBox " Invalid option ( Role ) selected .", vbInformation + vbOKOnly, "Message from Macro"
Exit Sub
End If
'General field
'General field
If Range("Contract_code") = "" Or Range("Client_name") = "" Or Range("Hub_name") = "" Or Range("Contracting_country") = "" Or _
Range("G7").Value = "" Or Range("Email_Received_Date") = "" Or Range("Audit_start_date") = "" Or _
Range("G11").Value = "" Or Range("U11").Value = "" Or Range("NCR") = "" Or Range("AAFData") = "" Or Range("TR_Conditions") = "" Or _
Range("Major_NC_Number") = "" Or Range("Minor_NC_Number") = "" Or Range("Type_of_audit") = "" Or _
Range("AE18").Value = "" Or Range("AE19").Value = "" Or Range("H120") = "" Or Range("T120") = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

Exit Sub
End If
'Special Case
If Range("U9").Value = "" And Range("AG9").Value = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
Exit Sub
End If
'General field - Universal check as per role
If Range("AP1").Value = "SSC Reviewer" Then
        If Range("Date_of_SSC_review") = "" Or Range("SSC_in_charge") = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
   ElseIf Range("AP1").Value = "ADR/Technical Reviewer" Then
           If Range("Date_of_TR_Review") = "" Or Range("T117").Value = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
    'ElseIf Range("AP1").Value = "Final Reviewer" Then
           'If Range("H120") = "" Or Range("T120").Value = "" Then
        
            'MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            'Application.DisplayAlerts = True
            'Application.ScreenUpdating = True
        
        'Exit Sub
        
 End If
 
'General field - Universal check as per type
If Range("Cert_Code") = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

Exit Sub
End If
'General field - Universal check as per type2
If Range("AP20") = "Surveillance audit" Or Range("AP20") = "SPECIAL AUDIT" Then

    If Range("Cert_Exp_Date") = "" Then
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
            Exit Sub
    End If
    
End If
'1st level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "MAIN AUDIT" Then
        If Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                            Application.DisplayAlerts = True
                            Application.ScreenUpdating = True
                           
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 35 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 33 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 40 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'2nd level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "RE-CERTIFICATION AUDIT" Then
        If Range("AE19").Value = "Renewal" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 32 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 46 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'3rd level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 1" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 2" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 3" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 4" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 32 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 46 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'4th level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "SPECIAL AUDIT" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 34 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                          
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case

'5th level test

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
    Password = "wood"
    
    I = Workbooks(PoV_review).Sheets("record_Final Review").Range("B1").Value
    Workbooks(PoV_review).Sheets("record_Final Review").Unprotect Password
    Workbooks(PoV_review).Sheets("Review Checklist").Range("AK23:AK88").Copy    'Select SSC review results
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AF" & I).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    'Ashish added code here
    Workbooks(PoV_review).Sheets("record_Final Review").Range("CT" & I).Value = Date
    Total = Application.CountIf(Workbooks(PoV_review).Sheets("record_Final Review").Range("AF" & I & ":CS" & I), "No") + Application.CountIf(Workbooks(PoV_review).Sheets("record_Final Review").Range("AF" & I & ":CS" & I), "Yes") + Application.CountIf(Workbooks(PoV_review).Sheets("record_Final Review").Range("AF" & I & ":CS" & I), "NA")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("A" & I).Value = Application.CountIf(Workbooks(PoV_review).Sheets("record_Final Review").Range("AF" & I & ":CS" & I), "No")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("B" & I).Value = (Total - Workbooks(PoV_review).Sheets("record_Final Review").Range("A" & I).Value) / Total
    Workbooks(PoV_review).Sheets("record_Final Review").Range("C" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contract_code")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("D" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Client_name")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("E" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("HUB_name")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("F" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contracting_country")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("G" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G7")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("H" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Email_Received_Date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("I" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Audit_start_date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("J" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G11")
    
    If Sheets("Review Checklist").Range("U9").Value = "" Then
            Workbooks(PoV_review).Sheets("record_Final Review").Range("K" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AG9").Value

    Else
            Workbooks(PoV_review).Sheets("record_Final Review").Range("K" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U9").Value

    End If
    
    Workbooks(PoV_review).Sheets("record_Final Review").Range("L" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U11").Value
    Workbooks(PoV_review).Sheets("record_Final Review").Range("M" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("NCR")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AAFData")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("O" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("TR_Conditions")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("P" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Number")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("Q" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Status")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("R" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("S" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Number")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("T" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Status")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("U" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("V" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Type_of_audit")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("W" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE18").Value
    Workbooks(PoV_review).Sheets("record_Final Review").Range("X" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE19")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("Y" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("FR_received_date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("Z" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("H120")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AA" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("T120").Value
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AB" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("D121").Value
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AC" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cer_No")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AD" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Exp_Date")
    Workbooks(PoV_review).Sheets("record_Final Review").Range("AE" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Code")
    
    Sheets("record_Final Review").Protect Password
    MsgBox "Data has saved. Thank you !", vbOKOnly + vbInformation, "Saving Confirmation Alert"
    Sheets("Review Checklist").Select
    
End Sub
Public Sub Save_Comments()
    ThisWorkbook.Activate
    Sheets("attachments_and_comments").Select
    Cells.Select
    Selection.EntireColumn.Hidden = False
    Range("B5", "I1000").Select
    Selection.Copy
    Workbooks.Open Filename:="U:\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Database_V3.xlsx"
    Sheets("attachments_and_comments").Select
    If Cells(Range("B50000").End(xlUp).Row, 2).Value = "Rejection " Then
        Range("B5").Select
        Else
        Cells(Range("B50000").End(xlUp).Row, 2).Select
        Selection.Offset(1, 0).Select
     End If
    Selection.PasteSpecial Paste:=xlPasteValues
    ActiveWorkbook.Save
    ActiveWorkbook.Close
    Sheets("attachments_and_comments").Select
    Range("H:I").Select
    Selection.EntireColumn.Hidden = True
End Sub
Sub Record_PoV_results_in_dtb()

Dim PoV_review As String
Dim Global_POV As String
Dim Global_Counter As Double

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    
    PoV_review = ActiveWorkbook.Name 'Get the name of the active PoV review
    I = Workbooks(PoV_review).Sheets(5).Range("A4").End(xlDown).Row + 1
    If I > 100 Then
        m = MsgBox("No LOA results have been entered", vbExclamation, "Complete PoV before validate")
    Else
        Workbooks.Open Filename:="\\10.137.54.3\ssc_dump\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Final Review_v2.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global Scorecard
        Global_Counter = Workbooks(Global_POV).Sheets(1).Range("A4").End(xlDown).Row
        If Global_Counter > 65000 Then
            Global_Counter = 4
        End If
        Workbooks(PoV_review).Sheets(5).Range("A5:CJ" & I).Copy
        Windows(Global_POV).Activate
        Range("A" & Global_Counter + 1).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True 'Fermeture fichier Extraction
    End If

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
End Sub

Sub PoV_LoA_results()

Dim CheckRole As String
Application.ScreenUpdating = False
Application.DisplayAlerts = False
CheckRole = MGlobal.CheckRole
If CheckRole <> "ADR/Technical Reviewer" Then
    MsgBox " Invalid role selected .", vbInformation + vbOKOnly, "Message from Macro"
Exit Sub
End If

'General field
'General field
If Range("Date_of_TR_Review") = "" Or Range("T117") = "" Or Range("K129") = "" Or Range("K129") = "No" And Range("W129") = "" Or Range("SSC_Auditor1") = "" Or Range("SSC_Auditor2") = "" Or Range("SSC_Auditor3") = "" Then

    MsgBox " Kindly fill all required field to move ahead . Please ensure you have entered your feedback as well.", vbInformation + vbOKOnly, "Message from Macro"
     
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True


Exit Sub

End If

'Special Case
If Range("U9").Value = "" And Range("AG9").Value = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
Exit Sub
End If
'General field - Universal check as per role
If Range("AP1").Value = "SSC Reviewer" Then
        If Range("Date_of_SSC_review") = "" Or Range("SSC_in_charge") = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
   ElseIf Range("AP1").Value = "ADR/Technical Reviewer" Then
           If Range("Date_of_TR_Review") = "" Or Range("T117").Value = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
    ElseIf Range("AP1").Value = "Final Reviewer" Then
           If Range("H120") = "" Or Range("T120").Value = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
 End If
 
'General field - Universal check as per type
If Range("Cert_Code") = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

Exit Sub
End If
'General field - Universal check as per type2
If Range("AP20") = "Surveillance audit" Or Range("AP20") = "SPECIAL AUDIT" Then

    If Range("Cert_Exp_Date") = "" Then
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
            Exit Sub
    End If
    
End If

If ThisWorkbook.Sheets("Review Checklist").Range("TR_Conditions") = "NO" Then
    Call SendDataIntoADR
    
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Sheets("Review Checklist").Select
    Exit Sub
End If

'1st level test
If Sheets("Review Checklist").Range("AP1").Value = "ADR/Technical Reviewer" Then
    If Range("Type_of_audit").Value = "MAIN AUDIT" Then
        If Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 20 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                            Application.DisplayAlerts = True
                            Application.ScreenUpdating = True
                           
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 19 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'2nd level test
If Sheets("Review Checklist").Range("AP1").Value = "ADR/Technical Reviewer" Then
    If Range("Type_of_audit").Value = "RE-CERTIFICATION AUDIT" Then
        If Range("AE19").Value = "Renewal" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 23 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 31 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 23 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 31 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'3rd level test
If Sheets("Review Checklist").Range("AP1").Value = "ADR/Technical Reviewer" Then
    If Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 1" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 2" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 3" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 4" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 22 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 31 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 23 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 31 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'4th level test
If Sheets("Review Checklist").Range("AP1").Value = "ADR/Technical Reviewer" Then
    If Range("Type_of_audit").Value = "SPECIAL AUDIT" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 18 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AI23:AI88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 26 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                          
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case

'5th level test

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
    Password = "wood"
    
    I = Workbooks(PoV_review).Sheets("record_Technical Review").Range("B1").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Unprotect Password
    Workbooks(PoV_review).Sheets("Review Checklist").Range("AI23:AI88").Copy    'Select SSC review results
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AI" & I).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    'Ashish added code here
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("CW" & I).Value = Date
    Total = Application.CountIf(Workbooks(PoV_review).Sheets("record_Technical Review").Range("AI" & I & ":CV" & I), "No") + Application.CountIf(Workbooks(PoV_review).Sheets("record_Technical Review").Range("AI" & I & ":CV" & I), "Yes") + Application.CountIf(Workbooks(PoV_review).Sheets("record_Technical Review").Range("AI" & I & ":CV" & I), "NA")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("A" & I).Value = Application.CountIf(Workbooks(PoV_review).Sheets("record_Technical Review").Range("AI" & I & ":CV" & I), "No")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("B" & I).Value = (Total - Workbooks(PoV_review).Sheets("record_Technical Review").Range("A" & I).Value) / Total
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("C" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contract_code")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("D" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Client_name")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("E" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("HUB_name")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("F" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contracting_country")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("G" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G7")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("H" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Email_Received_Date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("I" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Audit_start_date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("J" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G11")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("K" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor1")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("L" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor2")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("M" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor3")
    If Sheets("Review Checklist").Range("U9").Value = "" Then
        Workbooks(PoV_review).Sheets("record_Technical Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AG9").Value
    Else
        Workbooks(PoV_review).Sheets("record_Technical Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U9").Value
    End If
    
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("O" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U11").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("P" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("NCR")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("Q" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AAFData")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("R" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("TR_Conditions")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("S" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Number")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("T" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Status")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("U" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("V" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Number")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("W" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Status")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("X" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("Y" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Type_of_audit")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("Z" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE18").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AA" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE19")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AB" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("FR_received_date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AC" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Date_of_TR_review")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AD" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("T117").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AE" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("D118").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AF" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cer_No")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AG" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Exp_Date")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("AH" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Code")
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("CX" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("K129").Value
    Workbooks(PoV_review).Sheets("record_Technical Review").Range("CY" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("W129").Value
    MGlobal.SetCheckTechnical ("YES")
    Sheets(4).Protect Password
    MsgBox "Data has saved. Thank you !", vbOKOnly + vbInformation, "Saving Confirmation"
    Sheets("Review Checklist").Select
End Sub
Public Sub SendDataIntoADR()

Dim CheckRole As String
Application.ScreenUpdating = False
Application.DisplayAlerts = False
CheckRole = MGlobal.CheckRole
If CheckRole <> "ADR/Technical Reviewer" Then
    MsgBox " Invalid role selected .", vbInformation + vbOKOnly, "Message from Macro"
Exit Sub
End If
' check all field get fills
'Range("AG21:AG88").Select
'------------------------------------------------------------
If Range("G15").Value = "" Or Range("Type_of_audit").Value = "" Or Range("Date_of_TR_Review").Value = "" Or Range("T114").Value = "" Then
    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
End If

'Special Case
If Range("U9").Value = "" And Range("AG9").Value = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
Exit Sub
End If
'check fild fills
If Range("AE18").Value = "" Then
    MsgBox " Kindly fill all required field .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
End If
'1st level test
If Sheets("Review Checklist").Range("AP1").Value = "ADR/Technical Reviewer" Then
    If Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 1" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 2" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 3" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 4" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AG23:AG88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 14 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code

        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'5th level test

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
    Password = "wood"
    
    I = Workbooks(PoV_review).Sheets("record_ADR Review").Range("B1").Value
    Workbooks(PoV_review).Sheets("record_ADR Review").Unprotect Password
    Workbooks(PoV_review).Sheets("Review Checklist").Range("AG23:AG88").Copy    'Select SSC review results
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AI" & I).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    'Ashish added code here
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("CW" & I).Value = Date
    Total = Application.CountIf(Workbooks(PoV_review).Sheets("record_ADR Review").Range("AI" & I & ":CV" & I), "No") + Application.CountIf(Workbooks(PoV_review).Sheets("record_ADR Review").Range("AI" & I & ":CV" & I), "Yes") + Application.CountIf(Workbooks(PoV_review).Sheets("record_ADR Review").Range("AI" & I & ":CV" & I), "NA")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("A" & I).Value = Application.CountIf(Workbooks(PoV_review).Sheets("record_ADR Review").Range("AI" & I & ":CV" & I), "No")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("B" & I).Value = (Total - Workbooks(PoV_review).Sheets("record_ADR Review").Range("A" & I).Value) / Total
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("C" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contract_code")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("D" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Client_name")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("E" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("HUB_name")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("F" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contracting_country")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("G" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G7")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("H" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Email_Received_Date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("I" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Audit_start_date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("J" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G11")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("K" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor1")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("L" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor2")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("M" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor3")
    
    If Sheets("Review Checklist").Range("U9").Value = "" Then
        Workbooks(PoV_review).Sheets("record_ADR Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AG9").Value
    Else
        Workbooks(PoV_review).Sheets("record_ADR Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U9").Value
    End If
    
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("O" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U11").Value
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("P" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("NCR")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("Q" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AAFData")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("R" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("TR_Conditions")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("S" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Number")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("T" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Status")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("U" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("V" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Number")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("W" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Status")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("X" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("Y" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Type_of_audit")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("Z" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE18").Value
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AA" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE19")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AB" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("FR_received_date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AC" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Date_of_TR_review")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AD" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("T117").Value
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AE" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("D118").Value
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AF" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cer_No")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AG" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Exp_Date")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("AH" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Code")
    Workbooks(PoV_review).Sheets("record_ADR Review").Range("CX" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("W129")
    MGlobal.SetCheckTechnical ("YES")
    Sheets("record_ADR Review").Protect Password
    MsgBox "Data has saved. Thank you !", vbOKOnly + vbInformation, "Saving Confirmation Alert"
End Sub
Sub Record_PoV_LoA_results_in_dtb()

Dim PoV_review As String
Dim Global_POV As String
Dim Global_Counter As Double

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    PoV_review = ActiveWorkbook.Name 'Get the name of the active LOA review
    I = Workbooks(PoV_review).Sheets(4).Range("A4").End(xlDown).Row + 1
    If I > 100 Then
        m = MsgBox("No SSC results have been entered", vbExclamation, "Complete SSC before validate")
    Else
        Workbooks.Open Filename:="\\10.137.54.3\ssc_dump\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Technical Review_v2.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global LOA scorecard
        Global_Counter = Workbooks(Global_POV).Sheets(1).Range("A4").End(xlDown).Row
        If Global_Counter > 65000 Then
            Global_Counter = 4
        End If
        Workbooks(PoV_review).Sheets(4).Range("A5:CJ" & I).Copy
        Windows(Global_POV).Activate
        Range("A" & Global_Counter + 1).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True 'Fermeture fichier Extraction
    End If
    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
End Sub

Sub SSC_results()
Application.ScreenUpdating = False
Application.DisplayAlerts = False
Dim CheckRole As String
CheckRole = MGlobal.CheckRole
If CheckRole <> "SSC Reviewer" Then
    MsgBox " Invalid role selected .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
End If

'General field
If Range("Contract_code") = "" Or Range("Client_name") = "" Or Range("Hub_name") = "" Or Range("Contracting_country") = "" Or _
Range("G7").Value = "" Or Range("Email_Received_Date") = "" Or Range("Audit_start_date") = "" Or _
Range("G11").Value = "" Or Range("U11").Value = "" Or Range("NCR") = "" Or Range("AAFData") = "" Or Range("TR_Conditions") = "" Or _
Range("Major_NC_Number") = "" Or Range("Minor_NC_Number") = "" Or Range("Type_of_audit") = "" Or _
Range("AE18").Value = "" Or Range("AE19").Value = "" Or Range("SSC_Auditor1") = "" Or Range("SSC_Auditor2") = "" Or Range("SSC_Auditor3") = "" Or Range("Total_Auditor") = "" Or Range("SSC_Comments") = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

Exit Sub
End If

'Special Case
If Range("U9").Value = "" And Range("AG9").Value = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Exit Sub
Exit Sub
End If
'General field - Universal check as per role
If Range("AP1").Value = "SSC Reviewer" Then
        If Range("Date_of_SSC_review") = "" Or Range("SSC_in_charge") = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
   ElseIf Range("AP1").Value = "ADR/Technical Reviewer" Then
           If Range("Date_of_TR_Review") = "" Or Range("T117").Value = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        Exit Sub
        End If
               
    ElseIf Range("AP1").Value = "Final Reviewer" Then
           If Range("H120") = "" Or Range("T120").Value = "" Then
        
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
        
        Exit Sub
        End If
 End If
 
'General field - Universal check as per type
If Range("Cert_Code") = "" Then

    MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True

Exit Sub
End If
'General field - Universal check as per type2
If Range("AP20") = "Surveillance audit" Or Range("AP20") = "SPECIAL AUDIT" Then

    If Range("Cert_Exp_Date") = "" Then
            MsgBox " Kindly fill all required field to move ahead .", vbInformation + vbOKOnly, "Message from Macro"
            Application.DisplayAlerts = True
            Application.ScreenUpdating = True
            Exit Sub
    End If
    
End If
'1st level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "MAIN AUDIT" Then
        If Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                            Application.DisplayAlerts = True
                            Application.ScreenUpdating = True
                           
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 35 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 33 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True

                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 40 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'2nd level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "RE-CERTIFICATION AUDIT" Then
        If Range("AE19").Value = "Renewal" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 32 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 46 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'3rd level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 1" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 2" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 3" Or Range("Type_of_audit").Value = "SURVEILLANCE AUDIT 4" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 32 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                
          ElseIf Range("AE19").Value = "Transfer" Then
          
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 39 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 46 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case
'4th level test
If Sheets("Review Checklist").Range("AP1").Value = "SSC Reviewer" Then
    If Range("Type_of_audit").Value = "SPECIAL AUDIT" Then
        If Range("AE19").Value = "Renewal" Or Range("AE19").Value = "New" Then
        
                If Range("AE18").Value = "40-004" Then
            
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 27 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
                       
                 Else ' For Product
                       Range("AE23:AE88").Select
                       If Application.WorksheetFunction.CountA(Selection) <> 34 Then
                           MsgBox " Kindly fill all required field to save ahead .", vbInformation + vbOKOnly, "Message from Macro"
                               Application.DisplayAlerts = True
                               Application.ScreenUpdating = True
                           Exit Sub
                       End If
            
                End If ' Product Code
                          
        End If ' Contract Category
    End If ' Main Audit
End If ' This is for Access role case

'5th level test

Application.ScreenUpdating = False
Application.DisplayAlerts = False
    
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
    Password = "wood"
    
    I = Workbooks(PoV_review).Sheets("record_SSC_Review").Range("B1").Value
    Workbooks(PoV_review).Sheets("record_SSC_Review").Unprotect Password
    Workbooks(PoV_review).Sheets("Review Checklist").Range("AE23:AE88").Copy    'Select SSC review results
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AJ" & I).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
    'Ashish added code here
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("CX" & I).Value = Date
    Total = Application.CountIf(Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AJ" & I & ":CW" & I), "No") + Application.CountIf(Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AJ" & I & ":CW" & I), "Yes") + Application.CountIf(Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AJ" & I & ":CW" & I), "NA")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("A" & I).Value = Application.CountIf(Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AJ" & I & ":CW" & I), "No")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("B" & I).Value = (Total - Workbooks(PoV_review).Sheets("record_SSC_Review").Range("A" & I).Value) / Total
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("C" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contract_code")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("D" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Client_name")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("E" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("HUB_name")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("F" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Contracting_country")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("G" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G7")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("H" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Email_Received_Date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("I" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Audit_start_date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("J" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("G11")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("K" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor1")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("L" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor2")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("M" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Auditor3")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("N" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Total_Auditor")
    If Sheets("Review Checklist").Range("U9").Value = "" Then
        Workbooks(PoV_review).Sheets("record_SSC_Review").Range("O" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AG9").Value
    Else
        Workbooks(PoV_review).Sheets("record_SSC_Review").Range("O" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U9").Value
    End If
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("P" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("U11").Value
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("Q" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("NCR")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("R" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AAFData")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("S" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("TR_Conditions")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("T" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Number")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("U" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Status")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("V" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Major_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("W" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Number")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("X" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Status")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("Y" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Minor_NC_Closure_Date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("Z" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Type_of_audit")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AA" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE18").Value
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AB" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("AE19")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AC" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("FR_received_date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AD" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Date_of_SSC_review")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AE" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_in_charge")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AF" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("D115").Value
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AG" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cer_No").Value
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AH" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Exp_Date")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("AI" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("Cert_Code")
    Workbooks(PoV_review).Sheets("record_SSC_Review").Range("CY" & I).Value = Workbooks(PoV_review).Sheets("Review Checklist").Range("SSC_Comments")
    'Ashish Changes here
    Call Record_SSC_results_in_dtb
    
    Sheets("record_SSC_Review").Select
    Sheets("record_SSC_Review").Protect Password
    MsgBox "Database has updated . Thank you !", vbOKOnly + vbInformation, "Message"
    Application.DisplayAlerts = True
    Application.ScreenUpdating = True
    Sheets("Review Checklist").Select
    
    
    
End Sub

Sub Record_SSC_results_in_dtb()

Dim PoV_review As String
Dim Global_POV As String
Dim Global_Counter As Double
Dim I As Variant
    I = ThisWorkbook.Sheets("record_SSC_Review").Range("B1").Value
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review " U:\Wood\01 - CoC\08 SSC Production Data\03 - Projects\13 - Wood_Technical Review Checklist\New checklist_29.09.2017"
        Workbooks.Open Filename:="U:\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Database_V3.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global SSC scorecard
        Global_Counter = Workbooks(Global_POV).Sheets("record_SSC_Review").Range("B1").Value
        Workbooks(PoV_review).Sheets("record_SSC_Review").Range("A5:CY" & I).Copy
        Windows(Global_POV).Activate
        Sheets("record_SSC_Review").Select
        Range("A" & Global_Counter).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True
        'MsgBox "Data has saved .", vbExclamation, "Saving Confirmation"

End Sub
Attribute VB_Name = "Module2"
Sub Database()

Application.ScreenUpdating = False
Application.DisplayAlerts = False
Call Record_SSC_TAF
Call Save_Comments

Sheets("record_Technical Review").Select
MsgBox "Wood Database has been updated. Thank you!", vbOKOnly + vbInformation, "Data Saving Alert"
Application.ScreenUpdating = True
Application.DisplayAlerts = True
End Sub

Sub Record_SSC_TAF()

Dim PoV_review As String
Dim Global_POV As String
Dim Global_Counter As Double
Dim X, Y, z As Long
Dim I As Variant
    Application.ScreenUpdating = False
    Application.DisplayAlerts = False
    'For Tech
    I = ThisWorkbook.Sheets("record_Technical Review").Range("B1").Value
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
        Workbooks.Open Filename:="U:\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Database_V3.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global SSC scorecard
        X = Workbooks(Global_POV).Sheets("record_Technical Review").Range("B1").Value
        Workbooks(PoV_review).Sheets("record_Technical Review").Range("A5:CY" & I).Copy
        Windows(Global_POV).Activate
        Sheets("record_Technical Review").Select
        Range("A" & X).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True
'        Application.ScreenUpdating = True
 '       Application.DisplayAlerts = True
        
        'For ADR
    I = ThisWorkbook.Sheets("record_ADR Review").Range("B1").Value
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
        Workbooks.Open Filename:="U:\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Database_V3.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global SSC scorecard
        Y = Workbooks(Global_POV).Sheets("record_ADR Review").Range("B1").Value
        Workbooks(PoV_review).Sheets("record_ADR Review").Range("A5:CX" & I).Copy
        Windows(Global_POV).Activate
        Sheets("record_ADR Review").Select
        Range("A" & Y).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True
       ' Application.ScreenUpdating = True
        'Application.DisplayAlerts = True
        
        'For Final
    I = ThisWorkbook.Sheets("record_Final Review").Range("B1").Value
    PoV_review = ActiveWorkbook.Name 'Get the name of the active SSC review
        Workbooks.Open Filename:="U:\Wood\01 - CoC\08 SSC Production Data\01 - Process Manuals\01 - Checklist\Checklist Database\Revised Scorecard_Database_V3.xlsx"
        Global_POV = ActiveWorkbook.Name 'Get the name of the Global SSC scorecard
        z = Workbooks(Global_POV).Sheets("record_Final Review").Range("B1").Value
        Workbooks(PoV_review).Sheets("record_Final Review").Range("A5:CT" & I).Copy
        Windows(Global_POV).Activate
        Sheets("record_Final Review").Select
        Range("A" & z).Select
        ActiveSheet.Paste
        Workbooks(Global_POV).Close savechanges:=True
       ' Application.ScreenUpdating = True
        'Application.DisplayAlerts = True
End Sub
Attribute VB_Name = "Module3"
Option Explicit
Public Sub donothing()


            Application.OnKey "^d", "donothing"
            
            


End Sub


Attribute VB_Name = "Module4"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = "q\n14"
'
' Macro1 Macro
'
' Keyboard Shortcut: Ctrl+q
'
    
    Selection.EntireRow.Hidden = True
    ActiveWindow.SmallScroll Down:=3
    Rows("22:22").Select
    Selection.EntireRow.Hidden = False
    Rows("22:110").Select
    Range("AL22").Activate
    Selection.EntireRow.Hidden = False
    Range("D25:AD25").Select
    ActiveWindow.SmallScroll Down:=66
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Dim RoleString, ExitString As String
RoleString = MGlobal.CheckRole
ExitString = MGlobal.CheckTechnical
If RoleString = "ADR/Technical Reviewer" And ExitString <> "YES" Then
    MsgBox " Please ensure to select all valid option before exiting from file", vbOKOnly + vbInformation, "Macro Message"
    Cancel = True
    
End If
End Sub

Private Sub Workbook_Open()
Sheets("Review Checklist").Select
UserForm1.Show

End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{9E6C4D04-0C8F-4CCB-973F-F2C7228633AA}{24BEC38D-74CC-494B-A64E-75D79EE82E59}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
If Me.ComboBox1.Text = "" Then
    MsgBox " Please select valid option ", vbOKOnly + vbInformation, " Macro Message"
    Exit Sub
End If
Range("AP1").Value = UserForm1.ComboBox1.Text
MGlobal.SetRole (ComboBox1.Text)
Me.Hide
Call HideRelelatedData(Range("TR_Conditions"), Range("AP1").Value)
Call donothing
End Sub

Private Sub UserForm_Activate()
ComboBox1.AddItem "SSC Reviewer"
ComboBox1.AddItem "ADR/Technical Reviewer"
ComboBox1.AddItem "Final Reviewer"
ComboBox1.AddItem "Certificate Issuer"
ComboBox1.AddItem "General Viewer"


End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
Dim CheckRoleString As String
CheckRoleString = MGlobal.CheckRole
If CheckRoleString = "" Then
MsgBox " Please select valid role before commencing your activity ", vbOKOnly + vbInformation, "Macro Message"
Cancel = True
Exit Sub
End If
End Sub


INQUEST-PP=macro
