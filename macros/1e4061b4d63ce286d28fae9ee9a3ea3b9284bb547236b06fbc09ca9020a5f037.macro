Attribute VB_Name = "HST_vypocet_splatnosti"
Attribute VB_Base = "0{3953DF61-FBA1-4341-A3D7-4BEF67571D63}{16CEB89A-473C-4844-A3D3-9B075DACC28B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub TextBox3_Change()
 ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value = TextBox3.Value
 TextBox3.Value = Format(TextBox3.Value, "### ###")
''  If Len(TextBox3.Value) > 7 Then
''    TextBox3.Value = Left(TextBox3.Value, 7)
''  End If

 TextBox4.Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B8").Value
 TextBox5.Value = Format(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B14").Value, "d.m.yyyy")
End Sub

Sub UserForm_Initialize()
'Label1.Caption = "Zvolen|fffd| produkt: " & ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value
''TextBox1.Value = Format(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B3").Value, "### ### ###")
''TextBox2.Value = Format(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B7").Value, "#0.00")
'TextBox3.Value = Format(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value, "### ### ###")
TextBox4.Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B8").Value
TextBox5.Value = Format(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B14").Value, "d.m.yyyy")
End Sub


Private Sub UserForm_Terminate()
    If TextBox3.Value <> "" Then
        'ulo|fffd|en|fffd| hodnot do listu
        ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value = TextBox3.Value
        ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Value = TextBox4.Value
        'p|fffd|epo|fffd||fffd|st spl|fffd|tku
        Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
    End If
End Sub


Private Sub TextBox3_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        Unload Me
    End If
End Sub
Private Sub CommandButton1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        Unload Me
    End If
End Sub
Private Sub CommandButton1_Click()
        Unload Me
End Sub

Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Sub NabidkaPdf()
'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
On Error GoTo ErrHandler:

'potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
End If


'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
pocet_radku = 34

   Dim ScreenUpdatingStavPred As Boolean
   ScreenUpdatingStavPred = Application.ScreenUpdating
   Application.ScreenUpdating = False

'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
'''nebo-li pro lep|fffd||fffd| pochopen|fffd|
'''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
'''pole_popisky_pro_word(2) = 'klient_jm'
'''pole_popisky_pro_word(3) = ..
ReDim pole_popisky_pro_word(pocet_radku) As String

ThisWorkbook.Sheets("HU_nabidka").Visible = True
ThisWorkbook.Sheets("HU_nabidka").Select

'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
    ThisWorkbook.Sheets("HU_nabidka").Range("C8").Select
ActiveCell.Offset(0, 0).Range("A1").Select
For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
   pole_popisky_pro_word(radek) = ActiveCell.Value
   ActiveCell.Offset(1, 0).Range("A1").Select
   Next radek

'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
ReDim pole_radek(pocet_radku) As String

''sem d|fffd|t LOOP na nab|fffd|dku_RU

        ThisWorkbook.Sheets("HU_nabidka").Select
            If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
                ThisWorkbook.Sheets("HU_nabidka").Range("E8").Select
            Else
                ThisWorkbook.Sheets("HU_nabidka").Range("D8").Select
            End If

        'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
        ActiveCell.Offset(0, 0).Range("A1").Select
        For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
           pole_radek(radek) = ActiveCell.Value
           ActiveCell.Offset(1, 0).Range("A1").Select
           Next radek

        'n|fffd|zev souboru
        '''nazev_souboru = "nabidka-hypotecniho-uveru"
            If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
                nazev_souboru = ThisWorkbook.Sheets("HU_nabidka").Range("E7").Value
            Else
                nazev_souboru = ThisWorkbook.Sheets("HU_nabidka").Range("D7").Value
            End If
        
        'prom|fffd|nn|fffd| z Excelu
        Dim wd As Object
        'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
        'otev|fffd|en|fffd| objektu (jm|fffd|no)
          'kdy|fffd|
            If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
                ActiveSheet.Shapes.Range(Array("NabidkaRU")).Select
            Else
                ActiveSheet.Shapes.Range(Array("Nabidka")).Select
            End If
          Selection.Verb Verb:=xlOpen
          Application.ScreenUpdating = False
         
         'p|fffd|i|fffd|azen|fffd| instance wordu
        Set wd = GetObject(class:="Word.Application")
            'wd.WindowState = wdWindowStateMinimize
             wd.Visible = True
        
        
        'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
        'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
        rok_mesic = Range("A3")
        ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
        If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
        If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
        
        'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
        SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"
                'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
            With wd
                .documents(1).SaveAs FileName:=SaveAsName
                .documents(1).Saved = True
                '''.ActiveWindow.Close
                .documents(1).Close SaveChanges:=False
            End With
                 
                'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                 Set ulozeny_word = GetObject(SaveAsName)
                'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                 Set novy_dokument = ulozeny_word.Application
                     novy_dokument.Visible = True
                     
            With novy_dokument
            'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                For radek = 0 To pocet_radku - 1 'm|fffd|nus 1, proto|fffd|e v posledn|fffd|m sloupci m|fffd|m n|fffd|zev souboru
                .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                .Selection.TypeText Text:=pole_radek(radek)
                Next radek
    
            .documents(1).SaveAs FileName:=SaveAsName
            .documents(1).Saved = True

            SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
                '17 is the value of the symbolic constant wdFormatPDF.
            wd.ActiveDocument.SaveAs SaveAsName, 17
                'novy_dokument.SaveAs SaveAsName, 17
                
                ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                '.ActiveWindow.Close
             End With

''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku


konec:
'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
    
    If wd.documents.Count > 1 Then
        wd.documents(1).Close SaveChanges:=True
        Else
        wd.Quit SaveChanges:=True
    End If

Set wd = Nothing
Set ulozeny_word = Nothing
Set novy_dokument = Nothing

ThisWorkbook.Sheets("HU_nabidka").Visible = False
ThisWorkbook.Sheets("1_Kalkulace").Select
Application.ScreenUpdating = ScreenUpdatingStavPred

''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
'', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
''    Select Case YesNo
''    Case vbYes
    myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
''    Case vbNo
''    End Select

ErrHandler:
     ' error handling code
        Select Case Err.Number
        Case 0
        Case 20
        Case 4198
            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou nab|fffd|dku PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
        Case 5153
'            wd.ActiveWindow.Close
'            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
        Case Else
            MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
        End Select
     
     Resume EndTry1
    
    'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
    On Error GoTo konec
End Sub


Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Sub konsolidace_vymazat()
'
' konsolidace_vymazat makro vy|fffd|ist|fffd| v|fffd|echna pole, kter|fffd| se maj|fffd| vypl|fffd|ovat
' a dop|fffd|e do pole A2 = "nezobrazovat hl|fffd|ky", ve kter|fffd|m se p|fffd|ep|fffd|e na "zobrazovat hl|fffd|ky",
' a|fffd| po stisknut|fffd| 'ulo|fffd|it do PDF' nebo 'vytisknout'
    
    ' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = False
    'ThisWorkbook.Sheets("3_Konsolidace").Select
    ThisWorkbook.Sheets("3_Konsolidace").Range("A2").Value = "nezobrazovat hl|fffd|ky"

    ThisWorkbook.Sheets("3_Konsolidace").Range("C3:F12").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D17:H22").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D25:D28").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D31").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D39:D42").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D44").Value = ""
    
    ThisWorkbook.Sheets("3_Konsolidace").Range("D52:D55").Value = ""
    
    ThisWorkbook.Sheets("3_Konsolidace").Range("D57").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D65:D68").Value = ""
    
    ThisWorkbook.Sheets("3_Konsolidace").Range("D70").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D78:D81").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D83").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D91:D94").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D96").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D104:D107").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D109").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D117:D120").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D122").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D130:D133").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D135").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D143:D146").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D148").Value = ""
    ThisWorkbook.Sheets("3_Konsolidace").Range("D156:D159").Value = ""
    
    '''Call opravit_pro_verzi_2007
    
    ' zapne aktualizaci obrazovky (na za|fffd||fffd|tku vypnuto, aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = True
End Sub

Sub konsolidace_vyplnit_vzor()
'
' konsolidace_vyplnit_vzor Makro
'

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = False
    
    Range("C3").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C4").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C5").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C6").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C7").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C8").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C9").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C10").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C11").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"
    Range("C12").Select
    ActiveCell.FormulaR1C1 = "Spot|fffd|ebitelsk|fffd| |fffd|v|fffd|r"

' sloupec poskytovatel
    Range("D3").Select
    ActiveCell.FormulaR1C1 = "AGRO LEASING J.Hradec s.r.o."
    Range("D4").Select
    ActiveCell.FormulaR1C1 = "CASPER Consumer Finance a.s."
    Range("D5").Select
    ActiveCell.FormulaR1C1 = "|fffd|eskomoravsk|fffd| stavebn|fffd| spo|fffd|itelna, a.s. "
    Range("D6").Select
    ActiveCell.FormulaR1C1 = "Equa bank a.s. "
    Range("D7").Select
    ActiveCell.FormulaR1C1 = "Evropsko-rusk|fffd| banka a.s. "
    Range("D8").Select
    ActiveCell.FormulaR1C1 = "CONSUMER FINANCE HOLDING, a.s., organiza|fffd|n|fffd| slo|fffd|ka"
    Range("D9").Select
    ActiveCell.FormulaR1C1 = "Factoring |fffd|esk|fffd| spo|fffd|itelny, a.s. (Erste Factoring)"
    Range("D10").Select
    ActiveCell.FormulaR1C1 = "IMPULS-Leasing-AUSTRIA s.r.o."
    Range("D11").Select
    ActiveCell.FormulaR1C1 = "Oberbank AG - pobo|fffd|ka |fffd|esk|fffd| republika "
    Range("D12").Select
    ActiveCell.FormulaR1C1 = "SG Equipment Finance Czech Republic s.r.o."
    
' sloupec m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tka
    Range("E3").Select
    ActiveCell.FormulaR1C1 = "111"
    Range("E4").Select
    ActiveCell.FormulaR1C1 = "222"
    Range("E5").Select
    ActiveCell.FormulaR1C1 = "333"
    Range("E6").Select
    ActiveCell.FormulaR1C1 = "444"
    Range("E7").Select
    ActiveCell.FormulaR1C1 = "555"
    Range("E8").Select
    ActiveCell.FormulaR1C1 = "666"
    Range("E9").Select
    ActiveCell.FormulaR1C1 = "777"
    Range("E10").Select
    ActiveCell.FormulaR1C1 = "888"
    Range("E11").Select
    ActiveCell.FormulaR1C1 = "999"
    Range("E12").Select
    ActiveCell.FormulaR1C1 = "1010"
    Range("F3").Select
    
' sloupec zb|fffd|v|fffd| doplatit
    ActiveCell.FormulaR1C1 = "1111"
    Range("F4").Select
    ActiveCell.FormulaR1C1 = "2222"
    Range("F5").Select
    ActiveCell.FormulaR1C1 = "3333"
    Range("F6").Select
    ActiveCell.FormulaR1C1 = "4444"
    Range("F7").Select
    ActiveCell.FormulaR1C1 = "5555"
    Range("F8").Select
    ActiveCell.FormulaR1C1 = "6666"
    Range("F9").Select
    ActiveCell.FormulaR1C1 = "7777"
    Range("F10").Select
    ActiveCell.FormulaR1C1 = "8888"
    Range("F11").Select
    ActiveCell.FormulaR1C1 = "9999"
    Range("F12").Select
    ActiveCell.FormulaR1C1 = "101010"
    Range("D17").Select
    
' spole|fffd|n|fffd| |fffd|daje pro |fffd||fffd|dosti 1-10 (|fffd|adatel)
    ActiveCell.FormulaR1C1 = "Karel Nov|fffd|k"
    Range("D18").Select
    ActiveCell.FormulaR1C1 = "1/1/2000"
    Range("D19").Select
    ActiveCell.FormulaR1C1 = "Nov|fffd|kova 123"
    Range("D20").Select
    ActiveCell.FormulaR1C1 = "Praha"
    Range("D21").Select
    ActiveCell.FormulaR1C1 = "10000"
    Range("D22").Select
    ActiveCell.FormulaR1C1 = "|fffd|esk|fffd| republika"

' spole|fffd|n|fffd| |fffd|daje pro |fffd||fffd|dosti 1-10 (datum, m|fffd|sto, |fffd||fffd|slo |fffd||fffd|tu, po|fffd|adovan|fffd| |fffd||fffd|stka)
    Range("D25").Select
    ActiveCell.FormulaR1C1 = "=TODAY()"
    Range("D26").Select
    ActiveCell.FormulaR1C1 = "Brno - Her|fffd|pick|fffd|"
    Range("D27").Select
    Range("D27").Select
    ActiveCell.FormulaR1C1 = "12345/4000"
    Range("D28").Select
    ActiveCell.FormulaR1C1 = "160000"
    
' detaily konsolidace |fffd||fffd|dost 1
    Range("D31").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D39").Select
    ActiveCell.FormulaR1C1 = "1/1/2000"
    Range("D40").Select
    ActiveCell.FormulaR1C1 = "12345"
    Range("D41").Select
    ActiveCell.FormulaR1C1 = "11111111/0100"
    Range("D42").Select
    ActiveCell.FormulaR1C1 = "123456789"

' detaily konsolidace |fffd||fffd|dost 2
    Range("D44").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D52").Select
    ActiveWindow.SmallScroll Down:=9
    ActiveCell.FormulaR1C1 = "2/2/2000"
    Range("D53").Select
    ActiveCell.FormulaR1C1 = "22345"
    Range("D54").Select
    ActiveCell.FormulaR1C1 = "2222222/0200"
    Range("D55").Select
    ActiveCell.FormulaR1C1 = "223456789"
    
' detaily konsolidace |fffd||fffd|dost 3
    Range("D57").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D65").Select
    ActiveCell.FormulaR1C1 = "3/3/2000"
    Range("D66").Select
    ActiveCell.FormulaR1C1 = "32345"
    Range("D67").Select
    ActiveCell.FormulaR1C1 = "3333333/0300"
    Range("D68").Select
    ActiveCell.FormulaR1C1 = "323456789"
    
' detaily konsolidace |fffd||fffd|dost 4
    Range("D70").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D78").Select
    ActiveCell.FormulaR1C1 = "4/4/2000"
    Range("D79").Select
    ActiveCell.FormulaR1C1 = "42345"
    Range("D80").Select
    ActiveCell.FormulaR1C1 = "4444444/0400"
    Range("D81").Select
    ActiveCell.FormulaR1C1 = "423456789"
    
    
' detaily konsolidace |fffd||fffd|dost 5
    Range("D83").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D91").Select
    ActiveCell.FormulaR1C1 = "5/5/2000"
    Range("D92").Select
    ActiveCell.FormulaR1C1 = "52345"
    Range("D93").Select
    ActiveCell.FormulaR1C1 = "55555555/0500"
    Range("D94").Select
    ActiveCell.FormulaR1C1 = "523456789"
    
' detaily konsolidace |fffd||fffd|dost 6
    Range("D96").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D104").Select
    ActiveCell.FormulaR1C1 = "6/6/2000"
    Range("D105").Select
    ActiveCell.FormulaR1C1 = "62345"
    Range("D106").Select
    ActiveCell.FormulaR1C1 = "666666666/0600"
    Range("D107").Select
    ActiveCell.FormulaR1C1 = "623456789"
    
' detaily konsolidace |fffd||fffd|dost 7
    Range("D109").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D117").Select
    ActiveWindow.SmallScroll Down:=6
    ActiveCell.FormulaR1C1 = "7/7/2000"
    Range("D118").Select
    ActiveCell.FormulaR1C1 = "72345"
    Range("D119").Select
    ActiveCell.FormulaR1C1 = "777777777/0700"
    Range("D120").Select
    ActiveCell.FormulaR1C1 = "723456789"
    
' detaily konsolidace |fffd||fffd|dost 8
    Range("D122").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D130").Select
    ActiveWindow.SmallScroll Down:=6
    ActiveCell.FormulaR1C1 = "8/8/2000"
    Range("D131").Select
    ActiveCell.FormulaR1C1 = "82345"
    Range("D132").Select
    ActiveCell.FormulaR1C1 = "8888888888/0800"
    Range("D133").Select
    ActiveCell.FormulaR1C1 = "823456789"

' detaily konsolidace |fffd||fffd|dost 9
    Range("D135").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D143").Select
    ActiveWindow.SmallScroll Down:=9
    ActiveCell.FormulaR1C1 = "9/9/2000"
    Range("D144").Select
    ActiveCell.FormulaR1C1 = "92345"
    Range("D145").Select
    ActiveCell.FormulaR1C1 = "99999999999/0900"
    Range("D146").Select
    ActiveCell.FormulaR1C1 = "923456789"

' detaily konsolidace |fffd||fffd|dost 10
    Range("D148").Select
    ActiveCell.FormulaR1C1 = "|fffd|adatel"
    Range("D156").Select
    ActiveCell.FormulaR1C1 = "10/10/2000"
    Range("D157").Select
    ActiveCell.FormulaR1C1 = "102345"
    Range("D158").Select
    ActiveCell.FormulaR1C1 = "1010101010/1010"
    Range("D159").Select
    ActiveCell.FormulaR1C1 = "1023456789"
   
    
      ' zapne aktualizaci obrazovky (na za|fffd||fffd|tku vypnuto, aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = True
    Range("D17").Select
End Sub

Sub opravit_pro_verzi_2007()
'
' opravit_pro_verzi_2007 --> MAKRO na opravu listu konsolidace -- kdy|fffd| zmiz|fffd| vyb|fffd|rac|fffd| seznamy
' kdy|fffd| se ulo|fffd||fffd| v nov|fffd|j|fffd||fffd| verzi Office, zmiz|fffd| na listu konsolidace vyb|fffd|rac|fffd| seznamy. toto oprav|fffd|
'
ThisWorkbook.Sheets("3_Konsolidace").Unprotect ("mival")
    '|fffd||fffd|seln|fffd|k 'Typ produktu'
    ThisWorkbook.Sheets("3_Konsolidace").Select
    Range("C3:C12").Select
    With ThisWorkbook.Sheets("3_Konsolidace").Range("C3:C12").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='3_Konsolidace_pomocne vypocty'!$A$836:$A$841"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
   
   '|fffd||fffd|seln|fffd|k Poskytovatel|fffd|
'''        ThisWorkbook.Sheets("3_Konsolidace").Range("D3:D12").Select
    With ThisWorkbook.Sheets("3_Konsolidace").Range("D3:D12").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='3_Konsolidace_pomocne vypocty'!$P$861:$P$923"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    '|fffd||fffd|seln|fffd|k zem|fffd|
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D22:H22").Select
    With ThisWorkbook.Sheets("3_Konsolidace").Range("D22:H22").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='3_Konsolidace_pomocne vypocty'!$A$1001:$A$1249"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    'pobo|fffd|ky Sberbank v |fffd||fffd|seln|fffd|ku
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D26").Select
    With ThisWorkbook.Sheets("3_Konsolidace").Range("D26").Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='3_Konsolidace_pomocne vypocty'!$A$1266:$A$1294"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    
    '|fffd||fffd|seln|fffd|k 'kdo |fffd||fffd|d|fffd| o konsolidaci', mo|fffd|nosti --> '|fffd|adatel', 'spolu|fffd|adatel 1-3'
'''    Application.Union(ThisWorkbook.Sheets("3_Konsolidace").Range("D31"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D44"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D57"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D70"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D83"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D96"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D109"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D122"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D135"), _
'''    ThisWorkbook.Sheets("3_Konsolidace").Range("D148")).Select
    
    With Application.Union(ThisWorkbook.Sheets("3_Konsolidace").Range("D31"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D44"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D57"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D70"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D83"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D96"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D109"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D122"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D135"), _
    ThisWorkbook.Sheets("3_Konsolidace").Range("D148")).Validation
        .Delete
        .Add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="='3_Konsolidace_pomocne vypocty'!$A$1256:$A$1259"
        .IgnoreBlank = True
        .InCellDropdown = True
        .InputTitle = ""
        .ErrorTitle = ""
        .InputMessage = ""
        .ErrorMessage = ""
        .ShowInput = True
        .ShowError = True
    End With
    ThisWorkbook.Sheets("3_Konsolidace").Range("C3").Select
    ThisWorkbook.Sheets("3_Konsolidace").Protect ("mival")
End Sub

Attribute VB_Name = "List17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



            Sub ESIP()
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = Sheets("ESIP").Range("D1").Value - 1 'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("ESIP").Visible = True
            ThisWorkbook.Sheets("ESIP").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("ESIP").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("ESIP").Select
                    ThisWorkbook.Sheets("ESIP").Range("D8").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("ESIP").Range("D7").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("ESIP-Word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    On Error Resume Next
                    Set wd = GetObject(, "Word.Application")
                        If Err.Number <> 0 Then 'Word isn't running so start it
                            Set wd = CreateObject("Word.Application")
                        End If
                    On Error GoTo ErrHandler
                        
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            .documents(1).Saved = True
                    '''        .ActiveWindow.Close
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            Next radek
                            
                            '''.Documents(1).SaveAs Filename:=SaveAsName
                                '-----------------spl|fffd|tkov|fffd| kalend|fffd||fffd|----------------------
                                            posledni_radek_tisku = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H9").Value
                                            Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("1:462").Hidden = False
                                            skryt_oblast_prazdnych_radku = Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H7").Value
                                            Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("" & skryt_oblast_prazdnych_radku & "").Hidden = True
                                             
                                                'skryt_oblast_prazdnych_radku_kvartalu = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("I7").Value
                                                For i = 0 To 11
                                                    If Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("A" & 18 + i).Value = False Then
                                                        Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows(18 + i).Hidden = True
                                                    End If
                                                Next i
                                             
                                             skryt_oblast_prazdnych_radku_pojisteni = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("J7").Value
                                             Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("" & skryt_oblast_prazdnych_radku_pojisteni & "").Hidden = True
   
                                                            ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Visible = True
                                                            ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17:L462").Delete
                                                            'ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = True
                                                            'ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Select
                                                            ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("B17:L462").SpecialCells(xlCellTypeVisible).Copy
                                                            'ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Select
                                                            ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17").PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlPasteSpecialOperationNone
                                                            ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17").PasteSpecial Paste:=xlPasteFormats
                                                            Application.CutCopyMode = False
                                                            
                                                                Dim sht As Worksheet
                                                                Dim LastRow As Long
                                                            Set sht = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final")
                                                            sht.Visible = True
                                                            sht.Select
                                                            LastRow = sht.Cells(sht.Rows.Count, "B").End(xlUp).Row
                                                            
                                                            sht.Range("B17:L" & LastRow - 1).Sort key1:=sht.Range("C17"), order1:=xlAscending, Header:=xlNo
                                                            sht.PageSetup.PrintArea = "$B$1:$L$" & LastRow
                                                            
                                                
                                                sht.Range("B1:L" & LastRow).Copy
                                        
                                    'vlo|fffd||fffd| nov|fffd| odd|fffd|l, aby se str|fffd|nky spl|fffd|tkov|fffd|ho kalend|fffd||fffd|e za|fffd|aly |fffd||fffd|slovat od 1
                                                                                
                                        'vlo|fffd||fffd| hodnoty
                                        .documents(1).Bookmarks("semDoplnitSplatkovyKalendar").Range.PasteExcelTable _
                                        LinkedToExcel:=False, _
                                        WordFormatting:=False, _
                                        RTF:=False
                                            
                                            '|fffd||fffd|slovat znovu od 1
                                            With .documents(1).Range.Sections(2)
                                                'z|fffd|pat|fffd|
                                                    .Footers(1).PageNumbers.Add (1)
                                                    .Footers(1).Range.Text = "Tabulka umo|fffd|en|fffd|" & vbTab & "Datum a |fffd|as tisku: " & Format(Now(), "D.M.YYYY HH:MM:SS") & vbTab & "Strana "
                                                    '.Footers(1).PageNumbers.Alignment = 1
                                                    .Footers(1).PageNumbers.ShowFirstPageNumber = True
                                                    .Footers(1).PageNumbers.RestartNumberingAtSection = True
                                                    .Footers(1).PageNumbers.StartingNumber = 1
                                            End With
                                        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = False
                                    '-----------------konec spl|fffd|tkov|fffd| kalend|fffd||fffd|----------------------
                        .documents(1).SaveAs FileName:=SaveAsName
                        .documents(1).Saved = True
                        
                        SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
                        
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=False
                    wd.Visible = True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            'ThisWorkbook.Sheets("ESIP").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K p|fffd|edsmluvn|fffd|ch informac|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub



Attribute VB_Name = "List28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Sub prepnoutNaVystavbu()
ThisWorkbook.Sheets("2_V|fffd|stavba").Select
End Sub
Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub zobrazListy()
ActiveWindow.DisplayWorkbookTabs = True
Application.DisplayFormulaBar = True
End Sub
Private Sub schovatListy()
ActiveWindow.DisplayWorkbookTabs = False
Application.DisplayFormulaBar = False
End Sub
Private Sub HromadneVytvoreniVerzi()
Dim NazevSoubor As String
Dim FileName As String
Dim FileType As String
Dim cestaAdresare As String
Dim pomucka
'zjisteni cekty k pouzivanemu workbooku
cestaAdresare = ThisWorkbook.Path
'zjisteni nazvu workbooku
NazevSoubor = ThisWorkbook.Name
pomucka = Split(NazevSoubor, ".")
FileName = pomucka(0)
FileType = pomucka(1)

Call resetovat_kalkulator_bez_dotazu

Application.ScreenUpdating = False
Call predelatNaVerziPobocka
Application.ScreenUpdating = True
ActiveWorkbook.SaveAs _
FileName:=cestaAdresare & "\" & FileName & "_" & "pobocka.xlsm", _
FileFormat:=xlOpenXMLWorkbookMacroEnabled, _
Local:=True

Application.ScreenUpdating = False
Call predelatNaVerziZAM
Application.ScreenUpdating = True
ActiveWorkbook.SaveAs _
FileName:=cestaAdresare & "\" & FileName & "_" & "ZAM.xlsm", _
FileFormat:=xlOpenXMLWorkbookMacroEnabled, _
Local:=True

Application.ScreenUpdating = False
Call predelatNaVerziHST
Application.ScreenUpdating = True
ActiveWorkbook.SaveAs _
FileName:=cestaAdresare & "\" & FileName & "_" & "HST.xlsm", _
FileFormat:=xlOpenXMLWorkbookMacroEnabled, _
Local:=True

'workaround kv|fffd|li v|fffd|em variant|fffd|m poji|fffd|t|fffd|n|fffd| v HST verzi, ale HST nem|fffd| poplatek za ocen|fffd|n|fffd| (pokud robot, tak se poplatek zobraz|fffd| i v HST verzi)
Application.ScreenUpdating = False
Call predelatNaVerziHSTrobot
Application.ScreenUpdating = True
ActiveWorkbook.SaveAs _
FileName:=cestaAdresare & "\" & FileName & "_" & "HST-robot.xlsm", _
FileFormat:=xlOpenXMLWorkbookMacroEnabled, _
Local:=True

Application.ScreenUpdating = False
Call predelatNaVerziESC
Application.ScreenUpdating = True
ActiveWorkbook.SaveAs _
FileName:=cestaAdresare & "\" & FileName & "_" & "ESC.xlsm", _
FileFormat:=xlOpenXMLWorkbookMacroEnabled, _
Local:=True

MsgBox "Verze ulo|fffd|eny do " & cestaAdresare, , "Hotovo!"

End Sub
Private Sub predelatNaVerziESC()
    If worksheetexists("SeznamIDExternistu") Then
      Application.DisplayAlerts = False
      Worksheets("SeznamIDExternistu").Delete
      Application.DisplayAlerts = True
    End If
    
ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ESC"
    
    'individu|fffd|ln|fffd| sazba -- ESC skr|fffd|t
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Visible = False
    End If
    
    If worksheetexists("seznam_bankeru") Then
      Application.DisplayAlerts = False
      ThisWorkbook.Sheets("seznam_bankeru").Delete
      Application.DisplayAlerts = True
    End If

Call zobrazeniPoleZAM
Call vymazatUdajeBankereExternihoPartnera
Call resetovat_kalkulator_bez_dotazu
Call ThisWorkbook.Workbook_Open
End Sub
Private Sub predelatNaVerziPobocka()
ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "pobo|fffd|ka"
    'individu|fffd|ln|fffd| sazba -- zobrazit
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Visible = True
    End If
        
        'pokud ji|fffd| dnes aktualizov|fffd|no
    If datumAktualizaceExternistu >= Date Then
      'neaktualizovat
    Else
      Call AktualizovatSeznamExternistu
'      Call AktualizovatSeznamExternichSpolecnosti
    End If

Call zobrazeniPoleZAM
Call vymazatUdajeBankereExternihoPartnera
Call resetovat_kalkulator_bez_dotazu
End Sub

Private Sub predelatNaVerziZAM()
ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM"
    'individu|fffd|ln|fffd| sazba -- zobrazit
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Visible = True
    End If
Call zobrazeniPoleZAM
Call vymazatUdajeBankereExternihoPartnera
Call resetovat_kalkulator_bez_dotazu
End Sub
Private Sub predelatNaVerziHST()
    'individu|fffd|ln|fffd| sazba -- zobrazit
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Visible = True
    End If
ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Value = "Sberbank CZ, a.s."
ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "HST"
'workaround kv|fffd|li v|fffd|em variant|fffd|m poji|fffd|t|fffd|n|fffd| v HST verzi, ale HST nem|fffd| poplatek za ocen|fffd|n|fffd| (pokud robot, tak se poplatek zobraz|fffd| i v HST verzi)
ThisWorkbook.Sheets("Data ze vstupu").Range("F4").Value = ""
Call zobrazeniPoleZAM
Call vymazatUdajeBankereExternihoPartnera
Call resetovat_kalkulator_bez_dotazu
End Sub
Private Sub predelatNaVerziHSTrobot()
    'individu|fffd|ln|fffd| sazba -- zobrazit
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Visible = True
    End If
ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Value = "Sberbank CZ, a.s."
ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "HST"
'workaround kv|fffd|li v|fffd|em variant|fffd|m poji|fffd|t|fffd|n|fffd| v HST verzi, ale HST nem|fffd| poplatek za ocen|fffd|n|fffd| (pokud robot, tak se poplatek zobraz|fffd| i v HST verzi)
ThisWorkbook.Sheets("Data ze vstupu").Range("F4").Value = "robot"
Call zobrazeniPoleZAM
Call vymazatUdajeBankereExternihoPartnera
Call resetovat_kalkulator_bez_dotazu
End Sub
Private Sub vymazatUdajeBankereExternihoPartnera()
'bank|fffd||fffd|
ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Value = ""
ThisWorkbook.Sheets("1_Kalkulace").TextBox87.Value = "@"
ThisWorkbook.Sheets("1_Kalkulace").TextBox86.Value = ""

'extern|fffd| partner
ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Value = ""
ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Value = ""
ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Value = ""
ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Value = ""
ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Value = "@"
ThisWorkbook.Sheets("1_Kalkulace").TextBox6.Value = ""
End Sub

Private Sub zobrazeniPoleZAM()
        If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
            
            'p|fffd|ejmenov|fffd|n|fffd| popisku pro sumu p|fffd||fffd|jm|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Caption = "Ostatn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jmy klienta"
                'doprava suma ostatn|fffd|ch p|fffd||fffd|jm|fffd|
                    ThisWorkbook.Sheets("1_Kalkulace").Label41.Left = 383.25
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Left = 533
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
                    
                'doleva zam k|fffd|d
                    ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Left = 45.75
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Left = 176.25
            
            'zam k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True
            'p|fffd||fffd|jmy zvolen|fffd| dom|fffd|cnosti
            ThisWorkbook.Sheets("1_Kalkulace").TextBox13.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Label14.Visible = False
            'celkov|fffd| p|fffd||fffd|jmy v|fffd|ech dom|fffd|cnost|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").TextBox8.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Label10.Visible = False
            
            'Voln|fffd| m|fffd|s|fffd||fffd|n|fffd| cash flow V|fffd|ECH dom|fffd|cnost|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").Label7.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox5.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tlacitko_infoVolneCFlowPredOdect").Visible = False
            
            'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| Cash flow t|fffd|to dom|fffd|cnosti
            ThisWorkbook.Sheets("1_Kalkulace").Label34.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Visible = False
            
            'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| Cash flow dom|fffd|cnost|fffd| -- p|fffd|ehled naho|fffd|e
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tlacitko_infoVolneCashFlow").Visible = False
        Else
            'p|fffd|ejmenov|fffd|n|fffd| popisku pro sumu p|fffd||fffd|jm|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Caption = "Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem klienta"
                'doleva vr|fffd|tit suma ostatn|fffd|ch p|fffd||fffd|jm|fffd|
                    ThisWorkbook.Sheets("1_Kalkulace").Label41.Left = 45.75
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Left = 214.5
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = True
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = True
                    
                'doprava vr|fffd|tit zam k|fffd|d
                    ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Left = 383.25
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Left = 524
            'zam k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = False
            'p|fffd||fffd|jmy zvolen|fffd| dom|fffd|cnosti
            ThisWorkbook.Sheets("1_Kalkulace").TextBox13.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Label14.Visible = True
            'celkov|fffd| p|fffd||fffd|jmy v|fffd|ech dom|fffd|cnost|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").TextBox8.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Label10.Visible = True
            
            'Voln|fffd| m|fffd|s|fffd||fffd|n|fffd| cash flow V|fffd|ECH dom|fffd|cnost|fffd|
            ThisWorkbook.Sheets("1_Kalkulace").Label7.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox5.Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tlacitko_infoVolneCFlowPredOdect").Visible = True
            
            'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| Cash flow t|fffd|to dom|fffd|cnosti
            ThisWorkbook.Sheets("1_Kalkulace").Label34.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Visible = True
            
            'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| Cash flow dom|fffd|cnost|fffd| -- p|fffd|ehled naho|fffd|e
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tlacitko_infoVolneCashFlow").Visible = True
        End If
End Sub
Attribute VB_Name = "List30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Sub prepnoutNaVystavbu()
ThisWorkbook.Sheets("2_V|fffd|stavba").Select
End Sub
Attribute VB_Name = "List38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "TabStrip1, 3, 0, MSForms, TabStrip"
Option Explicit

Attribute VB_Name = "List5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "TextBox89, 564, 1, MSForms, TextBox"
Attribute VB_Control = "Label108, 563, 2, MSForms, Label"
Attribute VB_Control = "CheckBox13, 561, 3, MSForms, CheckBox"
Attribute VB_Control = "ComboBox27, 560, 4, MSForms, ComboBox"
Attribute VB_Control = "Label97, 559, 5, MSForms, Label"
Attribute VB_Control = "Label97_ZAM_kod_popis, 558, 6, MSForms, Label"
Attribute VB_Control = "TextBox69_ZAM_kod, 557, 7, MSForms, TextBox"
Attribute VB_Control = "TextBox84_kontokorent2v1, 556, 8, MSForms, TextBox"
Attribute VB_Control = "Label98_kontokorent2v1, 555, 9, MSForms, Label"
Attribute VB_Control = "ComboBox4, 549, 10, MSForms, ComboBox"
Attribute VB_Control = "Label26, 548, 11, MSForms, Label"
Attribute VB_Control = "Label105, 545, 12, MSForms, Label"
Attribute VB_Control = "Label104, 544, 13, MSForms, Label"
Attribute VB_Control = "Label103, 543, 14, MSForms, Label"
Attribute VB_Control = "TextBox88, 542, 15, MSForms, TextBox"
Attribute VB_Control = "TextBox84, 541, 16, MSForms, TextBox"
Attribute VB_Control = "infoDenSplatkyVMesici, 538, 17, MSForms, TextBox"
Attribute VB_Control = "Label89, 493, 18, MSForms, Label"
Attribute VB_Control = "CheckBox10, 469, 19, MSForms, CheckBox"
Attribute VB_Control = "CheckBox9, 468, 20, MSForms, CheckBox"
Attribute VB_Control = "CheckBox8, 467, 21, MSForms, CheckBox"
Attribute VB_Control = "CheckBox1, 466, 22, MSForms, CheckBox"
Attribute VB_Control = "TextBox73, 412, 23, MSForms, TextBox"
Attribute VB_Control = "Label86, 411, 24, MSForms, Label"
Attribute VB_Control = "TextBox72, 410, 25, MSForms, TextBox"
Attribute VB_Control = "Label85, 409, 26, MSForms, Label"
Attribute VB_Control = "TextBox71, 408, 27, MSForms, TextBox"
Attribute VB_Control = "Label84, 407, 28, MSForms, Label"
Attribute VB_Control = "TextBox70, 406, 29, MSForms, TextBox"
Attribute VB_Control = "Label83, 405, 30, MSForms, Label"
Attribute VB_Control = "Label82, 403, 31, MSForms, Label"
Attribute VB_Control = "Label81, 402, 32, MSForms, Label"
Attribute VB_Control = "Label80, 401, 33, MSForms, Label"
Attribute VB_Control = "Label79, 400, 34, MSForms, Label"
Attribute VB_Control = "Label78, 399, 35, MSForms, Label"
Attribute VB_Control = "Label77, 398, 36, MSForms, Label"
Attribute VB_Control = "Label76, 397, 37, MSForms, Label"
Attribute VB_Control = "Label75, 396, 38, MSForms, Label"
Attribute VB_Control = "Label74, 395, 39, MSForms, Label"
Attribute VB_Control = "Label73, 394, 40, MSForms, Label"
Attribute VB_Control = "Label72, 393, 41, MSForms, Label"
Attribute VB_Control = "Label71, 392, 42, MSForms, Label"
Attribute VB_Control = "Label70, 391, 43, MSForms, Label"
Attribute VB_Control = "Label69, 390, 44, MSForms, Label"
Attribute VB_Control = "Label68, 389, 45, MSForms, Label"
Attribute VB_Control = "Label67, 388, 46, MSForms, Label"
Attribute VB_Control = "Label66, 386, 47, MSForms, Label"
Attribute VB_Control = "Label65, 385, 48, MSForms, Label"
Attribute VB_Control = "Label64, 384, 49, MSForms, Label"
Attribute VB_Control = "Label21, 383, 50, MSForms, Label"
Attribute VB_Control = "Label18, 380, 51, MSForms, Label"
Attribute VB_Control = "TextBox68, 379, 52, MSForms, TextBox"
Attribute VB_Control = "TextBox67, 378, 53, MSForms, TextBox"
Attribute VB_Control = "TextBox66, 377, 54, MSForms, TextBox"
Attribute VB_Control = "TextBox65, 376, 55, MSForms, TextBox"
Attribute VB_Control = "ComboBox18, 375, 56, MSForms, ComboBox"
Attribute VB_Control = "ComboBox17, 374, 57, MSForms, ComboBox"
Attribute VB_Control = "TextBox64, 373, 58, MSForms, TextBox"
Attribute VB_Control = "TextBox63, 372, 59, MSForms, TextBox"
Attribute VB_Control = "TextBox62, 371, 60, MSForms, TextBox"
Attribute VB_Control = "ComboBox16, 370, 61, MSForms, ComboBox"
Attribute VB_Control = "ComboBox15, 369, 62, MSForms, ComboBox"
Attribute VB_Control = "TextBox61, 368, 63, MSForms, TextBox"
Attribute VB_Control = "TextBox60, 367, 64, MSForms, TextBox"
Attribute VB_Control = "ComboBox14, 366, 65, MSForms, ComboBox"
Attribute VB_Control = "TextBox59, 364, 66, MSForms, TextBox"
Attribute VB_Control = "TextBox28, 363, 67, MSForms, TextBox"
Attribute VB_Control = "TextBox10, 362, 68, MSForms, TextBox"
Attribute VB_Control = "TextBox9, 360, 69, MSForms, TextBox"
Attribute VB_Control = "ComboBox13, 359, 70, MSForms, ComboBox"
Attribute VB_Control = "ComboBox12, 358, 71, MSForms, ComboBox"
Attribute VB_Control = "Label39, 355, 72, MSForms, Label"
Attribute VB_Control = "Label22, 354, 73, MSForms, Label"
Attribute VB_Control = "Label13, 353, 74, MSForms, Label"
Attribute VB_Control = "Label12, 352, 75, MSForms, Label"
Attribute VB_Control = "TextBox24, 297, 76, MSForms, TextBox"
Attribute VB_Control = "Label28, 296, 77, MSForms, Label"
Attribute VB_Control = "ListBox3, 281, 78, MSForms, ListBox"
Attribute VB_Control = "TextBox39, 277, 79, MSForms, TextBox"
Attribute VB_Control = "TextBox38, 276, 80, MSForms, TextBox"
Attribute VB_Control = "ComboBox10, 275, 81, MSForms, ComboBox"
Attribute VB_Control = "TextBox37, 274, 82, MSForms, TextBox"
Attribute VB_Control = "TextBox36, 273, 83, MSForms, TextBox"
Attribute VB_Control = "ComboBox9, 272, 84, MSForms, ComboBox"
Attribute VB_Control = "Label43, 271, 85, MSForms, Label"
Attribute VB_Control = "Label42, 270, 86, MSForms, Label"
Attribute VB_Control = "Label40, 269, 87, MSForms, Label"
Attribute VB_Control = "TextBox35, 268, 88, MSForms, TextBox"
Attribute VB_Control = "TextBox33, 267, 89, MSForms, TextBox"
Attribute VB_Control = "ComboBox8, 266, 90, MSForms, ComboBox"
Attribute VB_Control = "Label41, 265, 91, MSForms, Label"
Attribute VB_Control = "TextBox34, 264, 92, MSForms, TextBox"
Attribute VB_Control = "ComboBox7, 258, 93, MSForms, ComboBox"
Attribute VB_Control = "TextBox32, 257, 94, MSForms, TextBox"
Attribute VB_Control = "Label38, 256, 95, MSForms, Label"
Attribute VB_Control = "TextBox31, 255, 96, MSForms, TextBox"
Attribute VB_Control = "Label37, 254, 97, MSForms, Label"
Attribute VB_Control = "TextBox21, 252, 98, MSForms, TextBox"
Attribute VB_Control = "Label36, 251, 99, MSForms, Label"
Attribute VB_Control = "Label35, 250, 100, MSForms, Label"
Attribute VB_Control = "Label32, 249, 101, MSForms, Label"
Attribute VB_Control = "TextBox20, 248, 102, MSForms, TextBox"
Attribute VB_Control = "CheckBox7, 246, 103, MSForms, CheckBox"
Attribute VB_Control = "CheckBox6, 245, 104, MSForms, CheckBox"
Attribute VB_Control = "CheckBox5, 244, 105, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 243, 106, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 242, 107, MSForms, CheckBox"
Attribute VB_Control = "CheckBox2, 241, 108, MSForms, CheckBox"
Attribute VB_Control = "Label25, 239, 109, MSForms, Label"
Attribute VB_Control = "TextBox19, 238, 110, MSForms, TextBox"
Attribute VB_Control = "Label24, 237, 111, MSForms, Label"
Attribute VB_Control = "TextBox18, 236, 112, MSForms, TextBox"
Attribute VB_Control = "Label23, 235, 113, MSForms, Label"
Attribute VB_Control = "Label10, 191, 114, MSForms, Label"
Attribute VB_Control = "TextBox8, 190, 115, MSForms, TextBox"
Attribute VB_Control = "ComboBox6, 189, 116, MSForms, ComboBox"
Attribute VB_Control = "Label11, 188, 117, MSForms, Label"
Attribute VB_Control = "ComboBox5, 187, 118, MSForms, ComboBox"
Attribute VB_Control = "Label9, 185, 119, MSForms, Label"
Attribute VB_Control = "TextBox7, 184, 120, MSForms, TextBox"
Attribute VB_Control = "TextBox5, 175, 121, MSForms, TextBox"
Attribute VB_Control = "Label7, 173, 122, MSForms, Label"
Attribute VB_Control = "TextBox4, 172, 123, MSForms, TextBox"
Attribute VB_Control = "Label6, 171, 124, MSForms, Label"
Attribute VB_Control = "ListBox1, 167, 125, MSForms, ListBox"
Attribute VB_Control = "TextBox30, 161, 126, MSForms, TextBox"
Attribute VB_Control = "Label34, 159, 127, MSForms, Label"
Attribute VB_Control = "TextBox29, 158, 128, MSForms, TextBox"
Attribute VB_Control = "TextBox27, 156, 129, MSForms, TextBox"
Attribute VB_Control = "TextBox26, 155, 130, MSForms, TextBox"
Attribute VB_Control = "Label33, 154, 131, MSForms, Label"
Attribute VB_Control = "Label31, 152, 132, MSForms, Label"
Attribute VB_Control = "TextBox25, 151, 133, MSForms, TextBox"
Attribute VB_Control = "Label30, 148, 134, MSForms, Label"
Attribute VB_Control = "Label29, 147, 135, MSForms, Label"
Attribute VB_Control = "Label27, 145, 136, MSForms, Label"
Attribute VB_Control = "TextBox23, 142, 137, MSForms, TextBox"
Attribute VB_Control = "TextBox22, 141, 138, MSForms, TextBox"
Attribute VB_Control = "TabStrip3, 122, 139, MSForms, TabStrip"
Attribute VB_Control = "ListBox2, 97, 140, MSForms, ListBox"
Attribute VB_Control = "TabStrip1, 68, 141, MSForms, TabStrip"
Attribute VB_Control = "TextBox1, 69, 142, MSForms, TextBox"
Attribute VB_Control = "TextBox2, 70, 143, MSForms, TextBox"
Attribute VB_Control = "TextBox3, 71, 144, MSForms, TextBox"
Attribute VB_Control = "Label1, 77, 145, MSForms, Label"
Attribute VB_Control = "Label2, 78, 146, MSForms, Label"
Attribute VB_Control = "Label3, 79, 147, MSForms, Label"
Attribute VB_Control = "Label4, 80, 148, MSForms, Label"
Attribute VB_Control = "Label5, 81, 149, MSForms, Label"
Attribute VB_Control = "ComboBox2, 84, 150, MSForms, ComboBox"
Attribute VB_Control = "TextBox11, 207, 151, MSForms, TextBox"
Attribute VB_Control = "Label14, 210, 152, MSForms, Label"
Attribute VB_Control = "Label15, 211, 153, MSForms, Label"
Attribute VB_Control = "Label16, 212, 154, MSForms, Label"
Attribute VB_Control = "ComboBox1, 213, 155, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 214, 156, MSForms, ComboBox"
Attribute VB_Control = "Label17, 215, 157, MSForms, Label"
Attribute VB_Control = "Label19, 216, 158, MSForms, Label"
Attribute VB_Control = "TextBox12, 217, 159, MSForms, TextBox"
Attribute VB_Control = "TextBox13, 218, 160, MSForms, TextBox"
Attribute VB_Control = "TextBox14, 227, 161, MSForms, TextBox"
Attribute VB_Control = "TextBox15, 231, 162, MSForms, TextBox"
Attribute VB_Control = "TextBox16, 232, 163, MSForms, TextBox"
Attribute VB_Control = "TextBox17, 234, 164, MSForms, TextBox"
Attribute VB_Control = "Label44, 291, 165, MSForms, Label"
Attribute VB_Control = "ComboBox11, 292, 166, MSForms, ComboBox"
Attribute VB_Control = "ListBox4, 298, 167, MSForms, ListBox"
Attribute VB_Control = "TextBox40, 301, 168, MSForms, TextBox"
Attribute VB_Control = "Label45, 302, 169, MSForms, Label"
Attribute VB_Control = "Label46, 303, 170, MSForms, Label"
Attribute VB_Control = "Label47, 304, 171, MSForms, Label"
Attribute VB_Control = "TextBox41, 305, 172, MSForms, TextBox"
Attribute VB_Control = "TextBox42, 306, 173, MSForms, TextBox"
Attribute VB_Control = "Label48, 307, 174, MSForms, Label"
Attribute VB_Control = "TextBox43, 308, 175, MSForms, TextBox"
Attribute VB_Control = "TextBox44, 309, 176, MSForms, TextBox"
Attribute VB_Control = "Label49, 310, 177, MSForms, Label"
Attribute VB_Control = "Label50, 311, 178, MSForms, Label"
Attribute VB_Control = "Label51, 312, 179, MSForms, Label"
Attribute VB_Control = "TextBox45, 313, 180, MSForms, TextBox"
Attribute VB_Control = "TextBox46, 314, 181, MSForms, TextBox"
Attribute VB_Control = "Label52, 315, 182, MSForms, Label"
Attribute VB_Control = "TextBox47, 316, 183, MSForms, TextBox"
Attribute VB_Control = "TextBox48, 317, 184, MSForms, TextBox"
Attribute VB_Control = "Label53, 318, 185, MSForms, Label"
Attribute VB_Control = "Label54, 319, 186, MSForms, Label"
Attribute VB_Control = "Label55, 320, 187, MSForms, Label"
Attribute VB_Control = "TextBox49, 321, 188, MSForms, TextBox"
Attribute VB_Control = "TextBox50, 322, 189, MSForms, TextBox"
Attribute VB_Control = "Label56, 323, 190, MSForms, Label"
Attribute VB_Control = "TextBox51, 324, 191, MSForms, TextBox"
Attribute VB_Control = "TextBox52, 325, 192, MSForms, TextBox"
Attribute VB_Control = "Label57, 326, 193, MSForms, Label"
Attribute VB_Control = "Label58, 327, 194, MSForms, Label"
Attribute VB_Control = "Label59, 328, 195, MSForms, Label"
Attribute VB_Control = "TextBox53, 329, 196, MSForms, TextBox"
Attribute VB_Control = "TextBox54, 330, 197, MSForms, TextBox"
Attribute VB_Control = "Label60, 331, 198, MSForms, Label"
Attribute VB_Control = "TextBox55, 332, 199, MSForms, TextBox"
Attribute VB_Control = "TextBox56, 333, 200, MSForms, TextBox"
Attribute VB_Control = "Label61, 334, 201, MSForms, Label"
Attribute VB_Control = "Label62, 335, 202, MSForms, Label"
Attribute VB_Control = "Label63, 336, 203, MSForms, Label"
Attribute VB_Control = "TextBox57, 337, 204, MSForms, TextBox"
Attribute VB_Control = "TextBox58, 338, 205, MSForms, TextBox"
Attribute VB_Control = "Label87, 413, 206, MSForms, Label"
Attribute VB_Control = "TextBox74, 416, 207, MSForms, TextBox"
Attribute VB_Control = "TextBox75, 417, 208, MSForms, TextBox"
Attribute VB_Control = "Label88, 418, 209, MSForms, Label"
Attribute VB_Control = "CheckBox11, 470, 210, MSForms, CheckBox"
Attribute VB_Control = "CheckBox12, 471, 211, MSForms, CheckBox"
Attribute VB_Control = "Label112, 473, 212, MSForms, Label"
Attribute VB_Control = "Label113, 474, 213, MSForms, Label"
Attribute VB_Control = "TextBox76, 475, 214, MSForms, TextBox"
Attribute VB_Control = "TextBox77, 476, 215, MSForms, TextBox"
Attribute VB_Control = "Label114, 478, 216, MSForms, Label"
Attribute VB_Control = "ComboBox19, 480, 217, MSForms, ComboBox"
Attribute VB_Control = "TextBox78, 481, 218, MSForms, TextBox"
Attribute VB_Control = "TextBox79, 482, 219, MSForms, TextBox"
Attribute VB_Control = "Label20, 483, 220, MSForms, Label"
Attribute VB_Control = "TextBox80, 484, 221, MSForms, TextBox"
Attribute VB_Control = "infoDatumCerpaniTextbox, 486, 222, MSForms, TextBox"
Attribute VB_Control = "infoMaxDoplnkovaCastka, 489, 223, MSForms, TextBox"
Attribute VB_Control = "infoPrijemZaPoslednich12Mesicu, 490, 224, MSForms, TextBox"
Attribute VB_Control = "infoPrijemPrumernyMesicniCelkem, 492, 225, MSForms, TextBox"
Attribute VB_Control = "Label90, 494, 226, MSForms, Label"
Attribute VB_Control = "Label91, 495, 227, MSForms, Label"
Attribute VB_Control = "Label92, 496, 228, MSForms, Label"
Attribute VB_Control = "Label93, 497, 229, MSForms, Label"
Attribute VB_Control = "Label94, 498, 230, MSForms, Label"
Attribute VB_Control = "Label95, 499, 231, MSForms, Label"
Attribute VB_Control = "infoVydajeOstatniTextbox, 500, 232, MSForms, TextBox"
Attribute VB_Control = "Label96, 501, 233, MSForms, Label"
Attribute VB_Control = "Label97_kreditniKarta2v1, 502, 234, MSForms, Label"
Attribute VB_Control = "Label99, 505, 235, MSForms, Label"
Attribute VB_Control = "Label100, 506, 236, MSForms, Label"
Attribute VB_Control = "TextBox81, 507, 237, MSForms, TextBox"
Attribute VB_Control = "TextBox82, 508, 238, MSForms, TextBox"
Attribute VB_Control = "TextBox83_kreditniKarta2v1, 509, 239, MSForms, TextBox"
Attribute VB_Control = "info_kontaktni_telefon_textbox, 513, 240, MSForms, TextBox"
Attribute VB_Control = "Label106, 520, 241, MSForms, Label"
Attribute VB_Control = "Label107, 521, 242, MSForms, Label"
Attribute VB_Control = "ComboBox20, 522, 243, MSForms, ComboBox"
Attribute VB_Control = "ComboBox21, 523, 244, MSForms, ComboBox"
Attribute VB_Control = "ComboBox22, 524, 245, MSForms, ComboBox"
Attribute VB_Control = "ComboBox23, 525, 246, MSForms, ComboBox"
Attribute VB_Control = "ComboBox24, 526, 247, MSForms, ComboBox"
Attribute VB_Control = "ComboBox25, 527, 248, MSForms, ComboBox"
Attribute VB_Control = "info_slevaBU, 528, 249, MSForms, TextBox"
Attribute VB_Control = "infoTypPojisteniTextbox, 529, 250, MSForms, TextBox"
Attribute VB_Control = "Label8, 530, 251, MSForms, Label"
Attribute VB_Control = "TextBox6, 531, 252, MSForms, TextBox"
Attribute VB_Control = "Label98, 532, 253, MSForms, Label"
Attribute VB_Control = "Label101, 534, 254, MSForms, Label"
Attribute VB_Control = "TextBox86, 535, 255, MSForms, TextBox"
Attribute VB_Control = "Label102, 536, 256, MSForms, Label"
Attribute VB_Control = "TextBox87, 537, 257, MSForms, TextBox"
Attribute VB_Control = "ComboBox26, 540, 258, MSForms, ComboBox"
Attribute VB_Control = "infoVolneCashFlowTextbox, 551, 259, MSForms, TextBox"
Attribute VB_Control = "infoVolneCFlowPredOdectTextbox, 552, 260, MSForms, TextBox"
Option Explicit

Dim zvolenyUcel As String
Dim MozneUcelyPodleProduktu As String
Dim Row As Integer
Dim Col As Integer
Dim minCastka As String
Dim maxCastka As String
Dim minSplatnost As String
Dim maxSplatnost As String
Dim minCislo As String
Dim maxCislo As String
Dim hodnotaPred As String
Dim moznostiFixacePosunMin As String
Dim moznostiFixacePosunMax As String
Dim moznostiFixaceRange As String
Dim N As String
Dim UcelRange As String
Dim ScreenUpdatingStavPred As String
Dim verzeKalkulatoru As String
Dim splatkaPredprepoctem As Variant
Dim splatkaPoprepoctu As Variant
Dim VyplnenoPred As Variant
Dim VyplnenoPredTim As Variant
Dim VyplnenoPredDelkaFixace As Variant
Dim VyplnenoPredTypZajisteni As Variant
Dim VyplnenoPredDenVMesici As Variant
Dim VyplnenoPredTimSlevaBU As Variant
Dim VyplnenoPredTypPojisteni As Variant
Dim aktualniZalozka As Integer
Dim nezobrazHlasku1PrijmyPrepnutiZadatele As Boolean
Dim nezobrazHlasku2PrijmyPrepnutiZadatele As Boolean
Dim nezobrazHlasku3PrijmyPrepnutiZadatele As Boolean
Dim tab1value As Integer
Dim sazbaPredZmenouObcanstvi
Public Sub automaticky_vypocti_splatku()
'pokud se zm|fffd|n|fffd| |fffd|daje v sekci produkt, |fffd||fffd|stka, splatnost, datum atd. a jsou vypln|fffd|ny |fffd|daje pot|fffd|ebn|fffd| pro v|fffd|po|fffd|et, spust|fffd| se propo|fffd|et spl|fffd|tky, jinak nic
'TextBox28.Value = "" Or Not (IsNumeric(Val(TextBox28.Value))) Or _

splatkaPredprepoctem = ThisWorkbook.Sheets("Data ze vstupu").Range("E84")

If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "" Or Not (IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value))) Or _
ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value = "" Or Not (IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value))) Or _
ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Value = "" Or Not (IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Value))) Or _
ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Value = "" Or _
ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Value = "" Or _
ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Value = "" Or Not (IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value)) Or _
ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Value = "" Or Not (IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value)) Or _
ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "" Or IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value, ThisWorkbook.Sheets("Seznamy").Range("C336:C340"), 1, False)) Or _
ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = "" Or Not (IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value))) Or ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = 0 Then
    'nic
Else
        Call vypocti_splatku
        splatkaPoprepoctu = ThisWorkbook.Sheets("Data ze vstupu").Range("E84")
        
        'n|fffd|kter|fffd| p|fffd||fffd|jmy jsou omezen|fffd| v|fffd||fffd||fffd| spl|fffd|tky (nap|fffd|. pron|fffd|jem), proto je pot|fffd|eba p|fffd|i p|fffd|epo|fffd|tu spl|fffd|tky tyto p|fffd||fffd|padn|fffd| aktualizovat :-)
        ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox37.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 33).Value, "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, "### ### ###")
        Call prumernyMesicniPrijemSuma
End If


End Sub
Private Sub ComboBox20_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.BackColor = 12648447
End Sub
'''Private Sub ComboBox20_Change()
'''        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox20_kontrolka")
'''        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Value <> "" Then
'''            .Fill.ForeColor.RGB = RGB(0, 255, 0)
'''            .AutoShapeType = 9
'''        Else
'''            .Fill.ForeColor.RGB = RGB(255, 0, 0)
'''            .AutoShapeType = 34
'''        End If
'''        End With
'''
'''    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox20
'''        'pokud vybran|fffd| mo|fffd|nost nen|fffd| v nab|fffd|dce - vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
'''        If .Value <> "" Then
'''            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Data ze vstupu").Range("AC129:AC131"), 1, False)) Then
'''                .BackColor = vbRed
'''                .Value = Left(.Value, Len(.Value) - 1)
'''            Else
'''                .BackColor = vbWhite
''''''''''                ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value = ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Value
''''''''''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox21.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 32).Value
''''''''''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox22.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 33).Value
''''''''''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox23.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 34).Value
''''''''''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox24.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 35).Value
''''''''''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox25.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 36).Value
'''            End If
'''        End If
'''    End With
'''End Sub
Private Sub ComboBox20_LostFocus()
                ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value = ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Value
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox21.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 32).Value
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox22.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 33).Value
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox23.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 34).Value
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox24.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 35).Value
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox25.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 36).Value
ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.BackColor = vbWhite
End Sub

Private Sub ComboBox27_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox27
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C200:C202"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
            Else
                .BackColor = vbWhite
                Call ObnovSazbu
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value <> sazbaPredZmenouObcanstvi Then
                  Call vynulovatSplatku
                  Call automaticky_vypocti_splatku
                End If
            End If
        End If
    End With

End Sub

Private Sub CheckBox13_Click()
'obnovit sazbu p|fffd|i od|fffd|krtnut|fffd| individu|fffd|ln|fffd| sazby
    If ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.Value = False Then
    Call ObnovSazbuTlacitko
    Call automaticky_vypocti_splatku
    End If
End Sub

Private Sub infoVolneCashFlowTextbox_Change()

End Sub
Private Sub infoVolneCashFlowTextbox_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Visible = False
End Sub



Private Sub infoVolneCFlowPredOdectTextbox_lostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Visible = False
End Sub

Private Sub TextBox13_Change()

End Sub

Private Sub TextBox6_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox6.BackColor = 12648447
End Sub
Private Sub TextBox6_Change()
'ThisWorkbook.Sheets("1_Kalkulace").TextBox6.Text = Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox6.Value / 100, "0.00 %")
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox6
        If IsNumeric(.Value) = False Then
            'MsgBox "Provolena jsou pouze |fffd||fffd|sla! Bude obnovena v|fffd|choz|fffd| sazba", vbCritical, "CHYBA - Sazba"
            .BackColor = vbRed
            .Value = ""
            .Activate
        ElseIf Len(.Value) > 4 Then
            .Value = Left(.Value, 4)
        'OMEZEN|fffd| na jedno m|fffd|sto a desetiny a setiny
        ElseIf InStr(1, .Value, ",") <> 2 And Len(.Value) > 1 Then
            .Value = Left(.Value, 1)
        Else
            .BackColor = vbWhite
            '.Value = Format(.Value, "#.##")
        End If
        '''ThisWorkbook.Sheets("Data ze vstupu").Range("E57").Value = Format(.Value, "#.00")
    End With
End Sub
Private Sub TextBox6_LostFocus()

ThisWorkbook.Sheets("1_Kalkulace").TextBox6.BackColor = vbWhite
End Sub

Private Sub ComboBox26_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.BackColor = 12648447
ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.ListFillRange = "=" & ThisWorkbook.Sheets("Seznamy").Range("D497").Value
End Sub
Private Sub ComboBox26_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox26
        If Len(.Value) > 60 Then
            .Value = Left(.Value, 60)
        End If
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range(ThisWorkbook.Sheets("Seznamy").Range("D496").Value), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                .BackColor = vbWhite
            End If
        End If
    End With
End Sub
Private Sub ComboBox26_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.BackColor = vbWhite
If ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Text <> "" Then
    'else
    If ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value < ThisWorkbook.Sheets("Data ze vstupu").Range("G75").Value Then
      Call obnovDatumCerpaniVzorec
    End If
Else
    Call obnovDatumCerpaniVzorec
End If
End Sub

Private Sub TextBox70_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox70.BackColor = 12648447
End Sub
Private Sub TextBox70_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox70
        If Len(.Value) > 60 Then
            .Value = Left(.Value, 60)
        End If
    End With
End Sub
Private Sub TextBox70_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox70.BackColor = vbWhite
End Sub
Private Sub TextBox71_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox71.BackColor = 12648447
End Sub
Private Sub TextBox71_Change()
    'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
            Dim IDExternisty_format As Object
            Set IDExternisty_format = CreateObject("vbscript.regexp")
            IDExternisty_format.Pattern = "^(\s?)\d*$"

With ThisWorkbook.Sheets("1_Kalkulace").TextBox71
            If IDExternisty_format.test(.Value) = False Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla!", vbCritical, "CHYBA - ID z|fffd|stupce"
                .Value = ""
            End If
            
        If Len(.Value) > 8 Then
            .Value = Left(.Value, 8)
        End If
        If IsNumeric(.Value) = False And .Value <> "" Or Val(.Value) <> Int(Val(.Value)) Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - ID extern|fffd|ho z|fffd|stupce"
                .Value = ""
        Else
            .BackColor = vbWhite
        End If
    End With
End Sub
Private Sub TextBox71_LostFocus()
'ID extern|fffd|ho z|fffd|stupce - 8 m|fffd|stn|fffd| |fffd||fffd|slo
With ThisWorkbook.Sheets("1_Kalkulace").TextBox71
    If Len(.Value) <> 0 And Len(.Value) <> 8 Then
        .BackColor = vbRed
        MsgBox "Zadejte ID extern|fffd|ho z|fffd|stupce (8 m|fffd|stn|fffd| |fffd||fffd|slo)", vbCritical, "CHYBA - ID extern|fffd|ho z|fffd|stupce"
        .Activate
    Else
            If .Value = "" Or ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ESC" Then

                Else
'                    'ID externisty nenalezeno v seznamu
                    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") <> "ESC" Then
                        If IsError(ThisWorkbook.Sheets("Data ze vstupu").Range("G52").Value) Then
                            MsgBox "Zadan|fffd| ID nebylo nalezeno v seznamu externist|fffd| (platn|fffd|mu k datu vyd|fffd|n|fffd| kalkul|fffd|toru). " & vbNewLine & "Pokud jste si jisti ID '" & .Value & "', pokra|fffd|ujte ru|fffd|n|fffd|m vypln|fffd|n|fffd|m |fffd|daj|fffd|.", vbCritical, "ID EXTERNISTY - Bez p|fffd|eklepu?"
                            '''.Value = ""
                            'aktivovat dal|fffd||fffd| pole
                            ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Activate
                        Else
                            'N|fffd|zev extern|fffd| spole|fffd|nosti
                            ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("G52").Value
                            'jmeno externisty
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("G53").Value
                            'telefon externisty
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("G55").Value
                            'email externisty
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("G56").Value
                        End If
                    End If
            End If
        .BackColor = vbWhite
    End If
End With
End Sub
Sub vymazat_udaje_externisty_Klepnut|fffd|()

    If MsgBox("P|fffd|ejete si vymazat |fffd|daje extern|fffd|ho partnera?", vbYesNo + vbQuestion, "Vymazat?") = vbYes Then
        'N|fffd|zev extern|fffd| spole|fffd|nosti
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Value = ""
            'jmeno externisty
            ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Value = ""
            'ID externisty
            ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Value = ""
            'telefon externisty
            ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Value = ""
            'email externisty
            ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Value = ""
        
            '''ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Activate
    End If
End Sub

Private Sub TextBox72_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox72.BackColor = 12648447
End Sub
Private Sub TextBox72_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox72
            Dim telefonExternisty_format As Object
            Set telefonExternisty_format = CreateObject("vbscript.regexp")
            telefonExternisty_format.Pattern = "^(\+?)\d*\s*\d*\s*\d*\s*\d*\s*\d*$" '--- (pr|fffd|zdn|fffd|) nebo (3 |fffd||fffd|sla s mezerami) nebo (mezin|fffd|rodn|fffd| form|fffd|t)..
        
        If telefonExternisty_format.test(.Value) = False Then
            .BackColor = vbRed
            MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla!" & vbNewLine & "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
            .Value = ""
        Else
            .BackColor = vbWhite
        End If
        'mezin|fffd|rodn|fffd| form|fffd|t m|fffd||fffd|e b|fffd|t jak chce
        If Left(.Value, 1) = "+" Or Left(.Value, 2) = "00" Then
            .Text = .Value
            If Len(.Value) > 25 Then
                .BackColor = vbWhite
                .Value = Left(.Value, 25)
            End If
        'jinak pokud |fffd|esk|fffd| |fffd||fffd|slo, tak dev|fffd|t |fffd||fffd|slic odd|fffd|len|fffd|ch dv|fffd|ma mezerami = 11 znak|fffd|
        Else
            If IsNumeric(Val(.Value)) = False Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - telefon extern|fffd|ho z|fffd|stupce"
                .Activate
            Else
            .Value = Format(.Value, "### ### ###")
                If Len(.Value) > 11 Then
                    .Value = Format(Left(.Value, 11), "### ### ###")
                End If
            End If
        End If
    End With
End Sub
Private Sub TextBox72_LostFocus()
With ThisWorkbook.Sheets("1_Kalkulace").TextBox72
'Kontaktn|fffd| telefon
    If Val(.Value) = 0 Or Left(.Value, 1) = "+" Or Left(.Value, 2) = "00" Then
            .BackColor = vbWhite
        ElseIf Len(.Value) > 11 Then
            .BackColor = vbWhite
            .Value = Format(Left(.Value, 11), "### ### ###")
        ElseIf Len(.Value) <> 11 Then
            .BackColor = vbRed
            MsgBox "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
            .Activate
        Else
            .BackColor = vbWhite
'            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = .Value
    End If
End With
End Sub
Private Sub TextBox73_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox73.BackColor = 12648447
End Sub
Private Sub TextBox73_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox73
        If Len(.Value) > 60 Then
            .Value = Left(.Value, 60)
        End If
    End With
End Sub
Private Sub TextBox73_LostFocus()
With ThisWorkbook.Sheets("1_Kalkulace").TextBox73
    Dim email_format As Object
    Set email_format = CreateObject("vbscript.regexp")
    email_format.Pattern = "^[\w-\.]+@([\w-]+\.)+[A-Za-z]{2,5}$"
    
'E-mail extern|fffd|ho z|fffd|stupce
    If .Value = "@" Or .Value = "" Then
        .Value = "@"
        Else
       'kontrola p|fffd|es objekt, kter|fffd| m|fffd||fffd|e obsahovat pouze omezen|fffd| znaky '.Pattern = "^[\w-\.]+@([\w-]+\.)+[A-Za-z]{2,5}$"
           If email_format.test(.Value) = False Then
                .BackColor = vbRed
                MsgBox "Zadejte e-mail ve spr|fffd|vn|fffd|m form|fffd|tu", vbCritical, "CHYBA - E-mail extern|fffd|ho z|fffd|stupce"
                .Activate
           End If
    End If
    .BackColor = vbWhite
End With
End Sub
Private Sub ComboBox12_GotFocus()
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox12
    .ListFillRange = "=" & ThisWorkbook.Sheets("Seznamy").Range("D12").Value
    VyplnenoPredTim = .Value
    .BackColor = 12648447
End With
End Sub
Private Sub ComboBox12_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox12_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "-" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox12
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                '.Activate
            Else
                .BackColor = vbWhite

''--                Call promazatZmenaProduktu
            End If
        End If
        'oprava zamrz|fffd|n|fffd| p|fffd|i ukl|fffd|d|fffd|n|fffd| (pokud je viditeln|fffd| list Uvodni_obrazovka, sko|fffd||fffd| to na n|fffd|j)
            If ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = True Then
            ThisWorkbook.Sheets("Uvodni_obrazovka").Select
            End If
    End With
End Sub
Private Sub ComboBox12_LostFocus()
'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox12
    If .Value <> "" Then
        If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte produkt ze seznamu", vbCritical, "CHYBA - Typ produktu"
                    .Activate
        Else
                    'pokud je zvoleno u hlavn|fffd|ho |fffd|adatele Trval|fffd| pobyt "Ob|fffd|an RF (Bez pobytu v |fffd|R)" -- povolen je pouze produkt "Hypot|fffd|ka bez hranic"
                        If ThisWorkbook.Sheets("Data ze vstupu").Range("E106").Value = "Ob|fffd|an RF (Bez pobytu v |fffd|R)" And ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "Hypot|fffd|ka bez hranic" Then
                            MsgBox "Pro ob|fffd|any RF (Bez pobytu v |fffd|R) lze poskytnout pouze produkt 'Hypot|fffd|ka bez hranic'", vbInformation, "OMEZEN|fffd| PRODUKTU - Ob|fffd|anstv|fffd| hlavn|fffd|ho |fffd|adatele"
                            ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "Hypot|fffd|ka bez hranic"
                        End If
                    
                    'max dostupn|fffd| |fffd||fffd|stka |fffd|v|fffd|ru, pokud se zm|fffd|n|fffd| produkt a zm|fffd|n|fffd| se p|fffd|vodn|fffd| po|fffd|adovan|fffd| |fffd||fffd|stka, mus|fffd| d|fffd|t hl|fffd|ku a zm|fffd|nit v|fffd||fffd|i na maxim|fffd|ln|fffd| mo|fffd|nou dostupnou
                    maxCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E18").Value
                    If IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value)) = True Then
                        If Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value) > maxCastka Then
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox9.BackColor = vbRed
                            MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| v|fffd||fffd|e |fffd|v|fffd|ru (" & Format(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value), "### ### ##0 K|fffd|") & ") se sn|fffd|ila na maxim|fffd|ln|fffd| dostupnou (max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbInformation, "V|fffd||fffd|e |fffd|v|fffd|ru - sn|fffd|ena na " & Format(maxCastka, "### ### ##0 K|fffd|")
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = maxCastka
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox9.BackColor = vbWhite
                        End If
                    End If
                        'obnoven|fffd| sazby
                    Call ObnovSazbu
                        
                    If ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Value = "" Then
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(77, 6).Value, "d.m.yyyy")
                    End If
                    If VyplnenoPredTim <> ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
        End If
        Call promazatZmenaProduktu
        .BackColor = vbWhite
        'vynulovat zobrazen|fffd| sazby, pokud nen|fffd| vypln|fffd|na |fffd||fffd|stka
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "  " Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
        End If
    Else
        MsgBox "Vyberte produkt ze seznamu", vbCritical, "CHYBA - Typ produktu"
        .Activate
    End If
End With
End Sub
Private Sub zobrazitDoplnkovouCastTextbox()
'|fffd||fffd|el |fffd|v|fffd|ru
Dim zobrazitDoplnkovouCast As Boolean
zobrazitDoplnkovouCast = ThisWorkbook.Sheets("Data ze vstupu").Range("J69")
With ThisWorkbook.Sheets("1_Kalkulace").TextBox28
        'po|fffd|adovan|fffd| v|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|sti
        .Enabled = zobrazitDoplnkovouCast
        '''--nepovinn|fffd| pole
        '''ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox28_kontrolka").Visible = zobrazitDoplnkovouCast
        If ThisWorkbook.Sheets("Data ze vstupu").Range("J69").Value = False Then
            .BackColor = &HE5E5E5
            .Value = ""
        Else
            .BackColor = vbWhite
        End If
End With
End Sub

Public Sub promazatZmenaProduktu()
Call zobrazitDoplnkovouCastTextbox
        'aktualizace maxim|fffd|ln|fffd| hodnota voliteln|fffd| dopl|fffd|kov|fffd| |fffd||fffd|sti
            ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(68, 5).Value, "### ### ##0")
        'aktualizace |fffd||fffd|stka celkem
            ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(70, 5).Value, "### ### ##0")
            
        Call mozneUcelyDleProduktu
        'nastav|fffd| spr|fffd|vn|fffd| mo|fffd|nosti |fffd||fffd|el|fffd| do comboBoxu
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.ListFillRange = "=" & MozneUcelyPodleProduktu
        'kdy|fffd| je vypln|fffd|n|fffd| zvolen|fffd| |fffd||fffd|el
        zvolenyUcel = ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Value
    If ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "" Then
        If zvolenyUcel <> "" Then
            UcelRange = VBA.Mid(MozneUcelyPodleProduktu, 9, 20)
            If IsError(Application.VLookup(zvolenyUcel, ThisWorkbook.Sheets("Seznamy").Range(UcelRange), 1, False)) Then
                'proma|fffd|e, pokud se neshoduj|fffd| a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
                'MsgBox "Volba '" & zvolenyUcel & "' nen|fffd| pro tento produkt k dispozici, vyberte z mo|fffd|n|fffd|ch |fffd||fffd|el|fffd|", vbExclamation, "UPOZORN|fffd|N|fffd| - Zvolen|fffd| |fffd||fffd|el |fffd|v|fffd|ru"
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.BackColor = vbRed
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Value = ThisWorkbook.Sheets("Seznamy").Range(VBA.Mid(MozneUcelyPodleProduktu, 9, 4))
                'ComboBox13.Activate
            End If
        End If
    Else
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
    End If
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.BackColor = vbWhite
            'po|fffd|et m|fffd|s|fffd|c|fffd| = Po|fffd|adovan|fffd| d|fffd|lka splatnosti |fffd|v|fffd|ru -- kdy|fffd| je mimo min. nebo max.
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox61
                If .Value <> "" Then
                     minSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value
                     maxSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value
                    If Val(.Value) < ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value Then
                        .BackColor = vbRed
                        MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| doba spl|fffd|cen|fffd| (" & Format(TextBox61.Value, "## m|fffd|s|fffd|c|fffd|") & ") se prodlou|fffd|ila na minim|fffd|ln|fffd| dostupnou (min. " & Format(minSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & ")", vbInformation, "Doba spl|fffd|cen|fffd| - prodlou|fffd|ena na " & ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value & " m|fffd|s|fffd|c|fffd|"
                        .Value = ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value
                        .BackColor = vbWhite
                    ElseIf Val(.Value) > ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value Then
                        .BackColor = vbRed
                        MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| doba spl|fffd|cen|fffd| (" & Format(TextBox61.Value, "## m|fffd|s|fffd|c|fffd|") & ") se zkr|fffd|tila na maxim|fffd|ln|fffd| dostupnou (max. " & Format(maxSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & ")", vbInformation, "Doba spl|fffd|cen|fffd| - zkr|fffd|cena na " & ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value & " m|fffd|s|fffd|c|fffd|"
                        .Value = ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value
                        .BackColor = vbWhite
                    End If
                End If
            End With
            
            'sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| |fffd||fffd|tu
            If ThisWorkbook.Sheets("Seznamy").Range("L10").Value = "lze sjednat" Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ano"
            Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ne"
            End If
            
            'u P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r nastavit 'sleva za aktivn|fffd| |fffd||fffd|et = "ne" a 'poji|fffd|t|fffd|n|fffd| = "Nen|fffd| sjedn|fffd|no"
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r" Then
'                'sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| |fffd||fffd|tu
'                ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ne"
                'poji|fffd|t|fffd|n|fffd| nen|fffd| mo|fffd|n|fffd|
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "Nen|fffd| sjedn|fffd|no"
                            'typ pobytu -- pokud vr|fffd|tit "Ob|fffd|an |fffd|R"
                            If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 Then
                                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value = "Ob|fffd|an |fffd|R"
                            Else
                                ThisWorkbook.Sheets("Data ze vstupu").Cells(29, 19).Value = "Ob|fffd|an |fffd|R"
                            End If
            'u Hypot|fffd|ky bez hranic nastavit 'sleva za aktivn|fffd| |fffd||fffd|et = "ne" a 'poji|fffd|t|fffd|n|fffd| = "Nen|fffd| sjedn|fffd|no"
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "Hypot|fffd|ka bez hranic" Then
                            
                            'typ pobytu -- zvolit "Ob|fffd|an RF (Bez pobytu v |fffd|R)"
                            If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 Then
                                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value = "Ob|fffd|an RF (Bez pobytu v |fffd|R)"
                            Else
                                ThisWorkbook.Sheets("Data ze vstupu").Cells(29, 19).Value = "Ob|fffd|an RF (Bez pobytu v |fffd|R)"
                            End If
                            
'                'sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| |fffd||fffd|tu
'                ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ne"
                'poji|fffd|t|fffd|n|fffd| nen|fffd| mo|fffd|n|fffd|
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "Nen|fffd| sjedn|fffd|no"
            Else
                ''sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| |fffd||fffd|tu
                'ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ano"
                'poji|fffd|t|fffd|n|fffd| nen|fffd| mo|fffd|n|fffd|
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "Klasik (7,5% z v|fffd||fffd|e m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky)"
                            
                            'typ pobytu -- vr|fffd|tit "Ob|fffd|an |fffd|R"
                            If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 Then
                                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value = "Ob|fffd|an |fffd|R"
                            Else
                                ThisWorkbook.Sheets("Data ze vstupu").Cells(29, 19).Value = "Ob|fffd|an |fffd|R"
                            End If
            End If

''''            'sleva za aktivn|fffd| |fffd||fffd|et - nelze sjednat u v|fffd|ech produkt|fffd| (rozd|fffd|lovadlo na listu Seznamy)
''''            With ThisWorkbook.Sheets("1_Kalkulace").ComboBox17
''''                If ThisWorkbook.Sheets("seznamy").Range("L10").Value = "nelze sjednat" Then
''''                    .ListFillRange = "=" & "Seznamy!C331:C331"
''''                    If .Value <> "" Then
''''                        If .Value <> "ne" Then
''''                            .BackColor = vbRed
''''                            MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| 'sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| b|fffd|n|fffd|ho |fffd||fffd|tu' nen|fffd| pro zvolen|fffd| produkt dostupn|fffd|. " & vbNewLine & "Sleva bude nastavena na hodnotu 'ne' ", vbInformation, "Sleva za b|fffd|n|fffd| |fffd||fffd|et - nelze sjednat"
''''                            .Value = "ne"
''''                            .BackColor = vbWhite
''''                        End If
''''                    End If
''''                Else
''''                    .ListFillRange = "=" & "Seznamy!C330:C331"
''''                End If
''''            End With
''''
''''            'poji|fffd|t|fffd|n|fffd| nen|fffd| mo|fffd|n|fffd| u v|fffd|ech produkt|fffd| (rozd|fffd|lovadlo na listu Seznamy)
''''            With ThisWorkbook.Sheets("1_Kalkulace").ComboBox18
''''                If ThisWorkbook.Sheets("seznamy").Range("L9").Value = "nelze sjednat" Then
''''                    .ListFillRange = "=" & "Seznamy!C336:C340"
''''                    If .Value <> "" Then
''''                        If .Value <> "Nen|fffd| sjedn|fffd|no" Then
''''                            .BackColor = vbRed
''''                            MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| varianta poji|fffd|t|fffd|n|fffd| '" & .Value & "' nen|fffd| pro zvolen|fffd| produkt dostupn|fffd|. " & vbNewLine & "Varianta poji|fffd|t|fffd|n|fffd| bude zm|fffd|n|fffd|na na 'Nen|fffd| sjedn|fffd|no' ", vbInformation, "Poji|fffd|t|fffd|n|fffd| - zm|fffd|na varianty na 'Nen|fffd| sjedn|fffd|no'"
''''                            .Value = "Nen|fffd| sjedn|fffd|no"
''''                            .BackColor = vbWhite
''''                        End If
''''                    End If
''''                Else
''''                    .ListFillRange = "=" & "Seznamy!C336:C340"
''''                End If
''''            End With
        'd|fffd|lka fixace |fffd|v|fffd|ru -- kdy|fffd| nen|fffd| p|fffd|vodn|fffd| zvolen|fffd| v nab|fffd|dce, tak zvolit prvn|fffd| v nab|fffd|dce
        Call moznostiFixace
        If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Value, ThisWorkbook.Sheets("Seznamy").Range(Cells(311 + moznostiFixacePosunMin, 3).Address, Cells(311 + moznostiFixacePosunMin + moznostiFixacePosunMax, 3).Address), 1, False)) Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Value = ThisWorkbook.Sheets("Seznamy").Cells(311 + moznostiFixacePosunMin, 3)
        End If
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.BackColor = vbWhite
        'obnovit sazbu, proto|fffd|e se mohla zm|fffd|nit |fffd||fffd|stka (=LTV), splatnost (=jin|fffd| p|fffd|smo), poji|fffd|t|fffd|n|fffd|
        Call ObnovSazbu
        'spl|fffd|tka, by se m|fffd|la p|fffd|epo|fffd||fffd|tat, aby po zm|fffd|n|fffd| v|fffd|ech parametr|fffd| byla aktu|fffd|ln|fffd|
        Call automaticky_vypocti_splatku
End Sub
Private Sub mozneUcelyDleProduktu()
'pro prvn|fffd| produkt |fffd||fffd|el
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = ThisWorkbook.Sheets("Seznamy").Range("C14").Value Then
        MozneUcelyPodleProduktu = "Seznamy!F290:F296"
     End If
'pro druh|fffd| produkt |fffd||fffd|el
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = ThisWorkbook.Sheets("Seznamy").Range("C15").Value Then
        MozneUcelyPodleProduktu = "Seznamy!G290:G293"
     End If
'pro t|fffd|et|fffd| produkt |fffd||fffd|el
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = ThisWorkbook.Sheets("Seznamy").Range("C16").Value Then
        MozneUcelyPodleProduktu = "Seznamy!H290:H291"
     End If
'pro |fffd|tvrt|fffd| produkt |fffd||fffd|el
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = ThisWorkbook.Sheets("Seznamy").Range("C17").Value Then
        MozneUcelyPodleProduktu = "Seznamy!I290:I290"
     End If
'pro p|fffd|t|fffd| produkt |fffd||fffd|el
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = ThisWorkbook.Sheets("Seznamy").Range("C18").Value Then
        MozneUcelyPodleProduktu = "Seznamy!J290:J299"
     End If
End Sub
Private Sub ComboBox13_GotFocus()
'Typ produktu ---> nastav|fffd| rozd|fffd|ln|fffd| |fffd||fffd|el |fffd|v|fffd|ru
Call mozneUcelyDleProduktu
If ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "" Then
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox13
        .BackColor = 12648447
'        Call promazatZmenaProduktu
        'kdy|fffd| je vypln|fffd|n|fffd| zvolen|fffd| |fffd||fffd|el
        zvolenyUcel = .Value
        If zvolenyUcel <> "" Then
            UcelRange = VBA.Mid(MozneUcelyPodleProduktu, 9, 20)
            If IsError(Application.VLookup(zvolenyUcel, ThisWorkbook.Sheets("Seznamy").Range(UcelRange), 1, False)) Then
                'proma|fffd|e, pokud se neshoduj|fffd| a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
                'MsgBox "Volba '" & zvolenyUcel & "' nen|fffd| pro tento produkt k dispozici, vyberte z mo|fffd|n|fffd|ch |fffd||fffd|el|fffd|", vbExclamation, "UPOZORN|fffd|N|fffd| - Zvolen|fffd| |fffd||fffd|el |fffd|v|fffd|ru"
                .BackColor = vbRed
                .Value = ThisWorkbook.Sheets("Seznamy").Range(VBA.Mid(MozneUcelyPodleProduktu, 9, 4))
                .Activate
            End If
        Else
            .Value = ThisWorkbook.Sheets("Seznamy").Range(VBA.Mid(MozneUcelyPodleProduktu, 9, 4))
            .Activate
        End If
    .BackColor = 12648447
    End With
Else
ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
End If
End Sub
Private Sub ComboBox13_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox13_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Value <> "" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox13
        zvolenyUcel = .Value
        Call mozneUcelyDleProduktu
        UcelRange = VBA.Mid(MozneUcelyPodleProduktu, 9, 20)
        If .Value <> "" Then
            If IsError(Application.VLookup(zvolenyUcel, ThisWorkbook.Sheets("Seznamy").Range(UcelRange), 1, False)) Then
                'proma|fffd|e, pokud se neshoduj|fffd| a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                '.Value = ThisWorkbook.Sheets("Seznamy").Range(VBA.Mid(MozneUcelyPodleProduktu, 9, 4))
                .Activate
            Else
                .BackColor = vbWhite
            End If
        End If
    End With
End Sub
Private Sub ComboBox13_LostFOcus()
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox13
    'If .Value <> "" Then
        zvolenyUcel = .Value
        Call mozneUcelyDleProduktu
        UcelRange = VBA.Mid(MozneUcelyPodleProduktu, 9, 20)
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "" Then
                If IsError(Application.VLookup(zvolenyUcel, ThisWorkbook.Sheets("Seznamy").Range(UcelRange), 1, False)) Then
                    'proma|fffd|e, pokud se neshoduj|fffd| a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
                    .BackColor = vbRed
                    'MsgBox "Vyberte |fffd||fffd|el ze seznamu", vbCritical, "CHYBA - Zvolen|fffd| |fffd||fffd|el |fffd|v|fffd|ru"
                    '.Value = ThisWorkbook.Sheets("Seznamy").Range(VBA.Mid(MozneUcelyPodleProduktu, 9, 4))
                    .Activate
                End If
            Else
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
            End If
        Call zobrazitDoplnkovouCastTextbox
        Call ObnovSazbu
    'End If
    .BackColor = vbWhite
End With
End Sub

Private Sub ComboBox4_GotFocus()
'jm|fffd|no bank|fffd||fffd|e
ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.BackColor = 12648447

If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ESC" Then
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.ListFillRange = ""
    If ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Value = "" Then
      ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Value = "Sberbank CZ, a.s."
      ThisWorkbook.Sheets("1_Kalkulace").TextBox87.Value = "hypoteky@sberbankcz.cz"
      ThisWorkbook.Sheets("1_Kalkulace").TextBox86.Value = "800 133 444"
    End If
 Else
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.ListFillRange = ThisWorkbook.Sheets("seznam_bankeru").Range("B5").Value
End If
End Sub
Private Sub ComboBox4_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox4
        If Len(.Value) > 60 Then
            .Value = Left(.Value, 60)
        End If
        If .Value <> "" Then
        End If
    End With
End Sub
Private Sub ComboBox4_LostFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox4
            If .Value <> "" And ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
             If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("seznam_bankeru").Range(ThisWorkbook.Sheets("seznam_bankeru").Range("B7").Value), 1, False)) Then
                If MsgBox("Zadan|fffd| jm|fffd|no nebylo nalezeno v seznamu bank|fffd||fffd||fffd| (platn|fffd|mu k datu vyd|fffd|n|fffd| kalkul|fffd|toru). " & vbNewLine & "Jste si jisti jm|fffd|nem '" & .Value & "'? " & vbNewLine & vbNewLine & "Pokud ano pokra|fffd|ujte ru|fffd|n|fffd|m vypln|fffd|n|fffd|m e-mailu a telefonu." & vbNewLine & "Pokud ne vyberte jm|fffd|no ze seznamu.", vbYesNo + vbQuestion, "JM|fffd|NO BANK|fffd||fffd|E - Bez p|fffd|eklepu?") = vbNo Then
                    .BackColor = vbRed
                    .Value = ""
                    .Activate
                Else
                End If
             Else
                'e-mail
                ThisWorkbook.Sheets("1_Kalkulace").TextBox87.Value = ThisWorkbook.Sheets("seznam_bankeru").Range("G5").Value
                'telefon
                ThisWorkbook.Sheets("1_Kalkulace").TextBox86.Value = ThisWorkbook.Sheets("seznam_bankeru").Range("G6").Value
             End If
            End If
                
                'pokud datum |fffd|erp|fffd|n|fffd| je men|fffd||fffd| ne|fffd| doporu|fffd|en|fffd|, dej tam dnes()+14
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Text <> "" Then
                    'else
                    If ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value < ThisWorkbook.Sheets("Data ze vstupu").Range("G75").Value Then
                      Call obnovDatumCerpaniVzorec
                    End If
                Else
                    Call obnovDatumCerpaniVzorec
                End If
        .BackColor = vbWhite
    End With
End Sub


Private Sub TextBox86_GotFocus()
'telefon bank|fffd||fffd|e
ThisWorkbook.Sheets("1_Kalkulace").TextBox86.BackColor = 12648447
End Sub
Private Sub TextBox86_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox86
            Dim telefonBankere_format As Object
            Set telefonBankere_format = CreateObject("vbscript.regexp")
            telefonBankere_format.Pattern = "^(\+?)\d*\s*\d*\s*\d*\s*\d*\s*\d*$" '--- (pr|fffd|zdn|fffd|) nebo (3 |fffd||fffd|sla s mezerami) nebo (mezin|fffd|rodn|fffd| form|fffd|t)..
        
        If telefonBankere_format.test(.Value) = False Then
            .BackColor = vbRed
            MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla!" & vbNewLine & "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
            .Value = ""
        Else
            .BackColor = vbWhite
        End If
        'mezin|fffd|rodn|fffd| form|fffd|t m|fffd||fffd|e b|fffd|t jak chce
        If Left(.Value, 1) = "+" Or Left(.Value, 2) = "00" Then
            .Text = .Value
            If Len(.Value) > 25 Then
                .BackColor = vbWhite
                .Value = Left(.Value, 25)
            End If
        'jinak pokud |fffd|esk|fffd| |fffd||fffd|slo, tak dev|fffd|t |fffd||fffd|slic odd|fffd|len|fffd|ch dv|fffd|ma mezerami = 11 znak|fffd|
        Else
            If IsNumeric(Val(.Value)) = False Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - telefon bank|fffd||fffd|e"
                .Activate
            Else
            .Value = Format(.Value, "### ### ###")
                If Len(.Value) > 11 Then
                    .Value = Format(Left(.Value, 11), "### ### ###")
                End If
            End If
        End If
    End With
End Sub
Private Sub TextBox86_LostFocus()
With ThisWorkbook.Sheets("1_Kalkulace").TextBox86
'Kontaktn|fffd| telefon
    If Val(.Value) = 0 Or Left(.Value, 1) = "+" Or Left(.Value, 2) = "00" Then
            .BackColor = vbWhite
        ElseIf Len(.Value) > 11 Then
            .BackColor = vbWhite
            .Value = Format(Left(.Value, 11), "### ### ###")
        ElseIf Len(.Value) <> 11 Then
            .BackColor = vbRed
            MsgBox "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
            .Activate
        Else
            .BackColor = vbWhite
'            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = .Value
    End If
End With
End Sub

Private Sub TextBox87_GotFocus()
'e-mail bank|fffd||fffd|e
ThisWorkbook.Sheets("1_Kalkulace").TextBox87.BackColor = 12648447
End Sub
Private Sub TextBox87_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox87
        If Len(.Value) > 60 Then
            .Value = Left(.Value, 60)
        End If
    End With
End Sub
Private Sub TextBox87_LostFocus()
With ThisWorkbook.Sheets("1_Kalkulace").TextBox87
    Dim email_format As Object
    Set email_format = CreateObject("vbscript.regexp")
    email_format.Pattern = "^[\w-\.]+@([\w-]+\.)+[A-Za-z]{2,5}$"
    
'E-mail bank|fffd||fffd|e
    If .Value = "@" Or .Value = "" Or .Value = "@sberbankcz.cz" Then
        .Value = "@"
        Else
       'kontrola p|fffd|es objekt, kter|fffd| m|fffd||fffd|e obsahovat pouze omezen|fffd| znaky '.Pattern = "^[\w-\.]+@([\w-]+\.)+[A-Za-z]{2,5}$"
           If email_format.test(.Value) = False Then
                .BackColor = vbRed
                MsgBox "Zadejte e-mail ve spr|fffd|vn|fffd|m form|fffd|tu", vbCritical, "CHYBA - E-mail bank|fffd||fffd|e"
                .Activate
           End If
    End If
    .BackColor = vbWhite
End With
End Sub


Private Sub TextBox9_GotFocus()
'kontrola, |fffd|e je spr|fffd|vn|fffd| vypln|fffd|n|fffd| produkt
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
        If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
            .BackColor = vbWhite
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
        Else
                VyplnenoPred = .Value
                .BackColor = 12648447
        End If
    End With
End Sub
Private Sub TextBox9_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox9_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
Dim castka_format As Object
Set castka_format = CreateObject("vbscript.regexp")
castka_format.Pattern = "^\s*\d*\s*\d*\s*\d*$" '--- 3 |fffd||fffd|sla mezera..
        
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
        maxCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E18").Value
        If Len(.Value) > 25 Then
            .Value = Left(.Value, Len(.Value) - 1)
        End If
        If castka_format.test(.Value) = False Then
            .BackColor = vbRed
            MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
            .Value = ""
            '.Activate
        Else
               If Val(.Value) < 0 Then
                  .BackColor = vbRed
                  MsgBox "Vypl|fffd|te spr|fffd|vnou v|fffd||fffd|i |fffd|v|fffd|ru (min. " & Format(minCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
                  .Value = minCastka
                  .Activate
               'max |fffd||fffd|stka -- zru|fffd|eno pouze pokud del|fffd||fffd| ne|fffd| XXX XXX XXX = 11 m|fffd|st
               ElseIf Len(.Value) > 11 Then
                   .BackColor = vbRed
                   .Value = Format(Left(.Value, 11), "### ### ###")
                   'MsgBox "Vypl|fffd|te spr|fffd|vnou v|fffd||fffd|i |fffd|v|fffd|ru (max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
                   '''TextBox28.Value = maxCastka - Val(.Value)
                   .BackColor = vbWhite
                   .Activate
               Else
                   .BackColor = vbWhite
                   Row = 67
                   Col = 5
                   .Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
                   'maxim|fffd|ln|fffd| hodnota voliteln|fffd| dopl|fffd|kov|fffd| |fffd||fffd|sti
                   Row = 68
                   Col = 5
                   
                            
'''                            With ThisWorkbook.Sheets("1_Kalkulace").TextBox28
'''                                 If .Value <> "" And Val(.Value) <> 0 Then
'''                                     If IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) = True Then
'''                                         If IsNumeric(.Value) = False Or (ThisWorkbook.Sheets("Data ze vstupu").Cells(69, 5).Value <> "" And _
'''                                         (Val(.Value) > Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) Or Val(.Value) < 0) Then
'''                                             .BackColor = vbRed
'''                                             MsgBox "Zadejte spr|fffd|vn|fffd| po|fffd|adovanou dopl|fffd|kovou |fffd||fffd|stku (max. " & Format(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value), "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|stky |fffd|v|fffd|ru"
'''                                             .Value = ""
'''                                             .Activate
'''''                                         ElseIf VyplnenoPred <> .Value Then
'''''                                             Call vynulovatSplatku
'''''                                             Call automaticky_vypocti_splatku
'''''                                 '            splatkaPoprepoctu = 0
'''                                         End If
'''                                     Else
'''                                     .Value = ""
'''                                     End If
'''                                 End If
'''                                 .BackColor = vbWhite
'''                             End With
                        '''If .Text <> "" Then
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
                        '''End If
                   'po|fffd|adovan|fffd| dopl|fffd|kov|fffd| |fffd||fffd|stka
                   Row = 70
                   Col = 5
                   ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
               End If
        End If
    End With
End Sub
Private Sub TextBox9_LostFocus()

'kontrola, |fffd|e je spr|fffd|vn|fffd| vypln|fffd|n|fffd| produkt
With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
    If .Value <> "" Then
        'pokud nen|fffd| zvolen|fffd| produkt z nab|fffd|dky
        If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
                .BackColor = vbWhite
        End If
        
            minCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E17").Value
            maxCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E18").Value
        
        If Val(.Value) < minCastka Then
        
                  .BackColor = vbRed
                  '''MsgBox "Vypl|fffd|te spr|fffd|vnou v|fffd||fffd|i |fffd|v|fffd|ru (min. " & Format(minCastka, "### ### ##0 K|fffd|") & ", max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
                  If MsgBox("Minim|fffd|ln|fffd| v|fffd||fffd|e |fffd|v|fffd|ru dle zvolen|fffd|ho produktu je " & Format(minCastka, "### ### ###") & " K|fffd|, chcete p|fffd|esto zadat " & Format(.Value, "### ### ##0") & " K|fffd|?", vbYesNo + vbQuestion, "Minimum produktu") = vbYes Then
                      'do nothing
                      .BackColor = vbWhite
                  Else
                      .Value = Format(minCastka, "### ### ###")
                      .BackColor = vbWhite
                      .Activate
                  End If
        End If
        
        If Val(.Value) > maxCastka Then
                  .BackColor = vbRed
                  '''MsgBox "Vypl|fffd|te spr|fffd|vnou v|fffd||fffd|i |fffd|v|fffd|ru (min. " & Format(minCastka, "### ### ##0 K|fffd|") & ", max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
                  If MsgBox("Maxim|fffd|ln|fffd| v|fffd||fffd|e |fffd|v|fffd|ru dle zvolen|fffd|ho produktu je " & Format(maxCastka, "### ### ###") & " K|fffd|, chcete p|fffd|esto zadat " & Format(.Value, "### ### ##0") & " K|fffd|?", vbYesNo + vbQuestion, "P|fffd|ekro|fffd|eno maximum produktu") = vbYes Then
                      'do nothing
                      .BackColor = vbWhite
                  Else
                      .Value = Format(maxCastka, "### ### ###")
                      .BackColor = vbWhite
                      .Activate
                  End If
        End If
              
        
        If IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) = True Then
            If Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Value) > Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value) Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox28.BackColor = vbRed
                MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| v|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|sti (" & Format(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Value), "### ##0 K|fffd|") & ") se sn|fffd|ila na maxim|fffd|ln|fffd| dostupnou (max. " & Format(Val(TextBox10.Value), "### ### ##0 K|fffd|") & ")", vbInformation, "V|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|sti |fffd|v|fffd|ru - sn|fffd|ena"
                ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Value = Val(TextBox10.Value)
                ThisWorkbook.Sheets("1_Kalkulace").TextBox28.BackColor = vbWhite
            End If
        End If
        'obnoven|fffd| sazby
            Call ObnovSazbu
        'v|fffd|po|fffd|et spl|fffd|tky
            If VyplnenoPred <> .Value Or ThisWorkbook.Sheets("Data ze vstupu").Range("E82").Value = 0 Then
'''                        Call vynulovatSplatku
                Call automaticky_vypocti_splatku
            End If
        '|fffd||fffd|stka celkem
            Row = 70
            Col = 5
            ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
        'splatkaPoprepoctu = 0
        
        
        
        'v|fffd||fffd|e tr|fffd|n|fffd| nemovitosti mus|fffd| b|fffd|t min. stejn|fffd|
''''        If ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value <> "" Then
''''                If Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox60) < Val(.Value) Then
''''                ThisWorkbook.Sheets("1_Kalkulace").TextBox60.BackColor = vbRed
''''                MsgBox "V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti mus|fffd| b|fffd|t min. stejn|fffd| nebo vy|fffd||fffd||fffd| ne|fffd| po|fffd|adovan|fffd| v|fffd||fffd|e |fffd|v|fffd|ru " & Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value, "### ### ##0 K|fffd|") & ".", vbInformation, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti by m|fffd|la b|fffd|t nav|fffd||fffd|ena"
''''                'ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value = ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value
''''                End If
''''        End If
    Else
        Call vynulovatSplatku
    End If
    .BackColor = vbWhite
        
        'vynulovat zobrazen|fffd| sazby, pokud nen|fffd| vypln|fffd|na |fffd||fffd|stka
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "  " Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
        End If
End With
    'd|fffd|lka fixace |fffd|v|fffd|ru -- kdy|fffd| nen|fffd| p|fffd|vodn|fffd| zvolen|fffd| v nab|fffd|dce, tak zvolit prvn|fffd| v nab|fffd|dce
    Call kontrolaFixace
End Sub
Private Sub TextBox28_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox28
    If .Enabled = False Then
        .BackColor = &HE5E5E5
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Activate
    Else
        VyplnenoPred = .Value
        .BackColor = 12648447
    End If
    End With
End Sub
Private Sub TextBox28_Change()
'''---- nen|fffd| povinn|fffd| pole -- shape u textboxu vymaz|fffd|n
'''        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox28_kontrolka")
'''        If ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Value <> "" Then
'''            .Fill.ForeColor.RGB = RGB(0, 255, 0)
'''            .AutoShapeType = 9
'''        Else
'''            .Fill.ForeColor.RGB = RGB(255, 0, 0)
'''            .AutoShapeType = 34
'''        End If
'''        End With
    'po|fffd|adovan|fffd| dopl|fffd|kov|fffd| |fffd||fffd|stka
    Dim doplnkovaCastka_format As Object
    Set doplnkovaCastka_format = CreateObject("vbscript.regexp")
    doplnkovaCastka_format.Pattern = "^\s*\d*\s*\d*\s*\d*$" '--- 3 |fffd||fffd|sla mezera..
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox28
        If doplnkovaCastka_format.test(.Value) = False Then
                '.BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - Dopl|fffd|kov|fffd| |fffd||fffd|st |fffd|v|fffd|ru"
                .Value = ""
                '.Activate
        End If
        If .Value <> "" Then
                    .Value = Format(.Value, "### ##0")
                    If Len(.Value) > 7 Then
                        .Value = Format(Left(.Value, 7), "### ##0")
                    End If
            If IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) = True Then
                If Val(.Value) > Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value) Then
                  .BackColor = vbRed
                  MsgBox "Vypl|fffd|te spr|fffd|vnou dopl|fffd|kov|fffd| |fffd||fffd|sti (max. " & Format(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value), "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|stky"
                  .Value = Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)
                  .Activate
                Else
                  Row = 69
                  Col = 5
                  .Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ##0")
                  .BackColor = vbWhite
                
                End If
            End If
            
        End If
        '|fffd||fffd|stka celkem
        Row = 70
        Col = 5
        ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
    End With
End Sub
Private Sub TextBox28_LostFocus()
'po|fffd|adovan|fffd| dopl|fffd|kov|fffd| |fffd||fffd|stka kontrola, |fffd|e nen|fffd| v|fffd|t|fffd||fffd| ne|fffd| povolen|fffd| maximum
With ThisWorkbook.Sheets("1_Kalkulace").TextBox28
    If .Value <> "" And Val(.Value) <> 0 Then
        If IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) = True Then
'''            If Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox59) > Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox60) Then
'''                MsgBox "V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti mus|fffd| b|fffd|t min. stejn|fffd| nebo vy|fffd||fffd||fffd| ne|fffd| po|fffd|adovan|fffd| v|fffd||fffd|e |fffd|v|fffd|ru " & Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value, "### ### ##0 K|fffd|") & ".", vbInformation, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti by m|fffd|la b|fffd|t nav|fffd||fffd|ena"
'''            End If
            If IsNumeric(.Value) = False Or (ThisWorkbook.Sheets("Data ze vstupu").Cells(69, 5).Value <> "" And _
            (Val(.Value) > Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value)) Or Val(.Value) < 0) Then
                .BackColor = vbRed
                MsgBox "Zadejte spr|fffd|vn|fffd| po|fffd|adovanou dopl|fffd|kovou |fffd||fffd|stku (max. " & Format(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value), "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|stky |fffd|v|fffd|ru"
                .Value = ""
                .Activate
            End If
        Else
        .Value = ""
        End If
    End If
    If VyplnenoPred <> .Value Then
                Call ObnovSazbu
                Call vynulovatSplatku
                Call automaticky_vypocti_splatku
    '            splatkaPoprepoctu = 0
    End If
    
    If .Enabled = False Then
        .BackColor = &HE5E5E5
    Else
        .BackColor = vbWhite
    End If
End With
    'd|fffd|lka fixace |fffd|v|fffd|ru -- kdy|fffd| nen|fffd| p|fffd|vodn|fffd| zvolen|fffd| v nab|fffd|dce, tak zvolit prvn|fffd| v nab|fffd|dce
    Call kontrolaFixace
End Sub
Private Sub ComboBox14_GotFocus()
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox14
    .BackColor = 12648447
    VyplnenoPredTypZajisteni = .Value
End With
End Sub
Private Sub ComboBox14_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox14_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Value <> "" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    'pokud vybran|fffd| typ zaji|fffd|t|fffd|n|fffd| nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox14
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C167:C171"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                    If VyplnenoPredTypZajisteni <> .Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
                .BackColor = vbWhite
            End If
        End If
    End With
End Sub
Private Sub ComboBox14_LostFocus()
'typ zaji|fffd|t|fffd|n|fffd|
'pokud vybran|fffd| typ zaji|fffd|t|fffd|n|fffd| nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox14
        If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C167:C171"), 1, False)) Then
                .BackColor = vbRed
                MsgBox "Vyberte typ zaji|fffd|t|fffd|n|fffd| ze seznamu", vbCritical, "CHYBA - Typ zaji|fffd|t|fffd|n|fffd|"
                .Activate
        End If
    .BackColor = vbWhite
End With
End Sub

Private Sub TextBox60_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox60
        VyplnenoPred = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub TextBox60_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox60_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
    'V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti (CZK)
     minCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E21").Value
     maxCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E22").Value
     With ThisWorkbook.Sheets("1_Kalkulace").TextBox60
     
    Dim vyseHodnotyNemovitosti_format As Object
    Set vyseHodnotyNemovitosti_format = CreateObject("vbscript.regexp")
    vyseHodnotyNemovitosti_format.Pattern = "^\s*\d*\s*\d*\s*\d*$" '--- 3 |fffd||fffd|sla mezera..
        If vyseHodnotyNemovitosti_format.test(.Value) = False Then
                '.BackColor = vbRed
                .Value = ""
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti"
                '.Activate
        End If
    'pokud hodnota nemovitosti nen|fffd| v rozmez|fffd|
        If IsNumeric(Val(.Value)) = False Or Val(.Value) > maxCastka Then
            .BackColor = vbRed
            MsgBox "Vypl|fffd|te spr|fffd|vnou v|fffd||fffd|i hodnoty nemovitosti (max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti"
            .Value = maxCastka
        Else
            .BackColor = vbWhite
            Row = 72
            Col = 5
            .Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
        End If
    End With
End Sub
Private Sub TextBox60_LostFocus()
'V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti (CZK)
 minCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E21").Value
 maxCastka = ThisWorkbook.Sheets("Data ze vstupu").Range("E22").Value
 
 
With ThisWorkbook.Sheets("1_Kalkulace").TextBox60
    If .Value <> "" Then
''            If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value <> "" Then
''                If Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox9) > Val(.Value) Then
''                MsgBox "V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti mus|fffd| b|fffd|t min. stejn|fffd| nebo vy|fffd||fffd||fffd| ne|fffd| po|fffd|adovan|fffd| v|fffd||fffd|e |fffd|v|fffd|ru " & Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value, "### ### ##0 K|fffd|") & ".", vbInformation, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti by m|fffd|la b|fffd|t nav|fffd||fffd|ena"
''                '.Value = ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value
''                End If
''            End If
        If IsNumeric(Val(.Value)) = False Then
           MsgBox "Vypl|fffd|te v|fffd||fffd|i hodnoty nemovitosti jako |fffd||fffd|slo", vbCritical, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti"
           .Value = ""
        Else
           If Val(.Value) < minCastka Then
               .BackColor = vbRed
               MsgBox "V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti mus|fffd| b|fffd|t min. " & Format(minCastka, "### ### ##0 K|fffd|") & " a " & vbNewLine & " max. " & Format(maxCastka, "### ### ##0 K|fffd|") & ")", vbCritical, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti"
               '.Value = minCastka
               .Activate
            ElseIf Val(.Value) > maxCastka Then
               .BackColor = vbRed
               MsgBox "V|fffd||fffd|e tr|fffd|n|fffd| hodnoty nemovitosti m|fffd||fffd|e b|fffd|t max. " & Format(maxCastka, "### ### ##0 K|fffd|") & "", vbCritical, "CHYBA - V|fffd||fffd|e hodnoty nemovitosti"
               .Value = ""
               .Activate
            Else
               Row = 72
               Col = 5
               .Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "### ### ##0")
                    If VyplnenoPred <> .Value Then
                    Call ObnovSazbu
                    Call vynulovatSplatku
                    Call automaticky_vypocti_splatku
                    End If
    '            splatkaPoprepoctu = 0
           End If
        End If
    Else
        Call vynulovatSplatku
        
    End If
    .BackColor = vbWhite
End With
    'd|fffd|lka fixace |fffd|v|fffd|ru -- kdy|fffd| nen|fffd| p|fffd|vodn|fffd| zvolen|fffd| v nab|fffd|dce, tak zvolit prvn|fffd| v nab|fffd|dce
    Call kontrolaFixace
End Sub
Private Sub TextBox61_GotFocus()
    If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
        ThisWorkbook.Sheets("1_Kalkulace").TextBox61.BackColor = vbWhite
    Else
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox61
            VyplnenoPred = .Value
            .BackColor = 12648447
        End With
    End If
    
End Sub
Private Sub TextBox61_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox61_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    'd|fffd|lka splatnosti
     minSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value
     maxSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value
     With ThisWorkbook.Sheets("1_Kalkulace").TextBox61
    'pokud hodnota nemovitosti nen|fffd| v rozmez|fffd|
                .Value = Format(.Value, "###")
                If Len(.Value) > 3 Then
                    .Value = Format(Left(.Value, 3), "###")
                End If
        If .Value <> "" Then
            If IsNumeric(.Value) = False Then
            .BackColor = vbRed
            MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - Po|fffd|adovan|fffd| d|fffd|lka spl|fffd|cen|fffd|"
            .Value = ""
            ElseIf Val(.Value) > maxSplatnost Then
            .BackColor = vbRed
            MsgBox "Vypl|fffd|te spr|fffd|vnou po|fffd|adovanou d|fffd|lku spl|fffd|cen|fffd| (min. " & Format(minSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & "," & vbNewLine & "max. " & Format(maxSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & ")", vbCritical, "CHYBA - Po|fffd|adovan|fffd| d|fffd|lka spl|fffd|cen|fffd|"
            .Value = ""
            End If
        Else
            .BackColor = vbWhite
        End If
    End With
End Sub
Private Sub TextBox61_LostFocus()
'd|fffd|lka splatnosti
 With ThisWorkbook.Sheets("1_Kalkulace").TextBox61
    If .Value <> "" Then
        If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
                 ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
        Else
         minSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E19").Value
         maxSplatnost = ThisWorkbook.Sheets("Data ze vstupu").Range("E20").Value
        'pokud hodnota nemovitosti nen|fffd| v rozmez|fffd|
            If .Value <> "" And IsNumeric(.Value) = False Or Val(.Value) < minSplatnost Or Val(.Value) > maxSplatnost Then
                .BackColor = vbRed
                MsgBox "Vypl|fffd|te spr|fffd|vnou po|fffd|adovanou d|fffd|lku spl|fffd|cen|fffd| (min. " & Format(minSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & "," & vbNewLine & "max. " & Format(maxSplatnost, "##0 m|fffd|s|fffd|c|fffd|") & ")", vbCritical, "CHYBA - Po|fffd|adovan|fffd| d|fffd|lka spl|fffd|cen|fffd|"
                .Value = ""
                .Activate
            Else
                'datum splatnosti
                Row = 78
                Col = 6
                ThisWorkbook.Sheets("1_Kalkulace").TextBox62.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
                    If VyplnenoPred <> .Value Then
                        Call ObnovSazbu
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
    '                splatkaPoprepoctu = 0
            End If
        End If
    Else
        'vynulov|fffd|n|fffd| spl|fffd|tky, pokud se zm|fffd|n|fffd| n|fffd|jak|fffd| |fffd|daj
        Call vynulovatSplatku
    End If
    .BackColor = vbWhite
End With
End Sub
Sub vynulovatSplatku()
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2") = ""
End Sub

Private Sub ComboBox15_GotFocus()
    If IsError(Application.VLookup(ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value, ThisWorkbook.Sheets("Seznamy").Range("C14:C18"), 1, False)) Then
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
    Else
        'nastavuje po|fffd|et fixac|fffd| podle vybran|fffd|ho produktu, LTV -- pokud je dostupn|fffd| sazba, zobraz|fffd| fixaci, pokud nen|fffd| dostupn|fffd| sazba nic
        Call moznostiFixace
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox15
            .ListFillRange = moznostiFixaceRange
            VyplnenoPredDelkaFixace = .Value
            .BackColor = 12648447
        End With
    End If
End Sub
Private Sub moznostiFixace()
        moznostiFixacePosunMin = ThisWorkbook.Sheets("Seznamy").Range("D308")
        moznostiFixacePosunMax = ThisWorkbook.Sheets("Seznamy").Range("D309") - 1
        moznostiFixaceRange = ("=Seznamy!C" & 311 + moznostiFixacePosunMin & ":C" & 311 + moznostiFixacePosunMin + moznostiFixacePosunMax)
End Sub
Private Sub kontrolaFixace()
'kdy|fffd| neodpov|fffd|d|fffd| v|fffd|b|fffd|ru z moznostiFixace
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox15
    'pouze pokud nen|fffd| p|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV produktu
    If ThisWorkbook.Sheets("Seznamy").Range("D312").Value = "zvolen|fffd| fixace nen|fffd| dostupn|fffd|" And ThisWorkbook.Sheets("Seznamy").Range("D4").Value <> "p|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV" Then
        .BackColor = vbRed
        MsgBox "P|fffd|vodn|fffd| po|fffd|adovan|fffd| d|fffd|lka fixace '" & .Value & "' nen|fffd| pro zvolenou kombinaci produktu a LTV dostupn|fffd|. D|fffd|lka fixace bude zm|fffd|n|fffd|na na '" & ThisWorkbook.Sheets("Seznamy").Range("D311").Value & "' ", vbInformation, "D|fffd|lka fixace - zm|fffd|na na " & ThisWorkbook.Sheets("Seznamy").Range("D311").Value
        .Value = ThisWorkbook.Sheets("Seznamy").Range("D311").Value
        .BackColor = vbWhite
    End If
    End With
End Sub
Private Sub ComboBox15_Change()
    With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox15_kontrolka")
    If ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Value <> "" Then
        .Visible = False
        '.Fill.ForeColor.RGB = RGB(0, 255, 0)
        .AutoShapeType = 9
    Else
        .Visible = True
        .Fill.ForeColor.RGB = RGB(255, 0, 0)
        .AutoShapeType = 34
    End If
    End With
    
    moznostiFixacePosunMin = ThisWorkbook.Sheets("Seznamy").Range("D308")
    moznostiFixacePosunMax = ThisWorkbook.Sheets("Seznamy").Range("D309") - 1
    'pokud vybran|fffd| typ zaji|fffd|t|fffd|n|fffd| nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox15
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range(Cells(311 + moznostiFixacePosunMin, 3).Address, Cells(311 + moznostiFixacePosunMin + moznostiFixacePosunMax, 3).Address), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
            .BackColor = vbWhite
                        Call ObnovSazbu
                    If VyplnenoPredDelkaFixace <> .Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
            End If
        End If
    End With
End Sub
Private Sub ComboBox15_LostFocus()
    'If ComboBox15.Value <> "" Then
moznostiFixacePosunMin = ThisWorkbook.Sheets("Seznamy").Range("D308")
moznostiFixacePosunMax = ThisWorkbook.Sheets("Seznamy").Range("D309") - 1
    'pokud vybran|fffd| d|fffd|lka fixace nen|fffd| v nab|fffd|dce vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox15
        '    If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range(Cells(311 + moznostiFixacePosunMin, 3).Address, Cells(311 + moznostiFixacePosunMin + moznostiFixacePosunMax, 3).Address), 1, False)) Then
                    '.BackColor = vbRed
                    'MsgBox "Vyberte d|fffd|lku fixace ze seznamu", vbCritical, "CHYBA - D|fffd|lka fixace"
                    'dopln|fffd| prvn|fffd| mo|fffd|nou fixaci
                    .Value = ThisWorkbook.Sheets("Seznamy").Range("D311").Value
                    '.Activate
                    Else
                        If VyplnenoPred <> .Value Then
                            Call vynulovatSplatku
                            Call automaticky_vypocti_splatku
                        End If
                    splatkaPoprepoctu = 0
                End If
        '    Else
        '            .BackColor = vbWhite
        '    End If
    'End If
    .BackColor = vbWhite
End With
End Sub
Private Sub ComboBox16_GotFocus()
    With ComboBox16
        VyplnenoPredDenVMesici = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub ComboBox16_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox16_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Value <> "" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    'datum prvn|fffd| spl|fffd|tky
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox16
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C321:C323"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                .BackColor = vbWhite
                'datum prvn|fffd| spl|fffd|tky
                TextBox64.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(77, 6).Value, "d.m.yyyy")
                'datum splatnosti
                Row = 78
                Col = 6
                TextBox62.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
                    If VyplnenoPredDenVMesici <> .Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
            End If
        End If
    End With
End Sub
Private Sub ComboBox16_LostFocus()
'datum prvn|fffd| spl|fffd|tky
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox16
    If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C321:C323"), 1, False)) Then
        .BackColor = vbRed
        MsgBox "Vyberte den spl|fffd|tky ze seznamu", vbCritical, "CHYBA - Den spl|fffd|tky"
        .Activate
    Else
        .BackColor = vbWhite
        'datum prvn|fffd| spl|fffd|tky
        TextBox64.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(77, 6).Value, "d.m.yyyy")
        'datum splatnosti
        Row = 78
        Col = 6
        TextBox62.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
            If VyplnenoPred <> .Value Then
                Call vynulovatSplatku
                Call automaticky_vypocti_splatku
            End If
    End If
End With
End Sub

'info n|fffd|pov|fffd|da - hint Voln|fffd| m|fffd|s|fffd||fffd|n|fffd| Cash Flow
Private Sub tlacitko_infoVolneCashFlowTextbox()
    ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Visible = Not (ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Visible)
    ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Value = "  Info: Voln|fffd| m|fffd|s|fffd||fffd|n|fffd| CashFlow v|fffd|ech dom|fffd|cnost|fffd| po ode|fffd|ten|fffd| m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky "
    'ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Activate
End Sub
'''Private Sub infoVolneCashFlowTextbox_GotFocus()
'''ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Visible = True
'''End Sub

'Private Sub infoVolneCashFlowTextbox_LostFocus()
'ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Visible = False
'End Sub

Private Sub tlacitko_infoVolneCFlowPredOdect()
    ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Visible = Not (ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Visible)
    ThisWorkbook.Sheets("1_Kalkulace").infoVolneCFlowPredOdectTextbox.Value = "  Info: Voln|fffd| m|fffd|s|fffd||fffd|n|fffd| CashFlow v|fffd|ech dom|fffd|cnost|fffd| p|fffd|ed ode|fffd|ten|fffd|m m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky "
    'ThisWorkbook.Sheets("1_Kalkulace").infoVolneCashFlowTextbox.Activate
End Sub


'info n|fffd|pov|fffd|da - hint
Private Sub Obr|fffd|zek23_Klepnut|fffd|()
ThisWorkbook.Sheets("1_Kalkulace").infoMaxDoplnkovaCastka.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").infoMaxDoplnkovaCastka.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("M69").Value
ThisWorkbook.Sheets("1_Kalkulace").infoMaxDoplnkovaCastka.Activate
End Sub
Private Sub infoMaxDoplnkovaCastka_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoMaxDoplnkovaCastka.Visible = False
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub tlacitko_infoDenSplatkyVMesici()
ThisWorkbook.Sheets("1_Kalkulace").infoDenSplatkyVMesici.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").infoDenSplatkyVMesici.Value = "Info: p|fffd|ipravujeme mo|fffd|nost volby spl|fffd|tky na 10., 15., 20. den v m|fffd|s|fffd|ci"
ThisWorkbook.Sheets("1_Kalkulace").infoDenSplatkyVMesici.Activate
End Sub
Private Sub infoDenSplatkyVMesici_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoDenSplatkyVMesici.Visible = False
'ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
End Sub

'info n|fffd|pov|fffd|da - hint
Private Sub tlacitko_info_datum_cerpani()
ThisWorkbook.Sheets("1_Kalkulace").infoDatumCerpaniTextbox.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").infoDatumCerpaniTextbox.Value = "Info: Doporu|fffd|en|fffd| minim|fffd|ln|fffd| datum |fffd|erp|fffd|n|fffd| (dnes + 14 dn|fffd|)"
ThisWorkbook.Sheets("1_Kalkulace").infoDatumCerpaniTextbox.Activate
End Sub
Private Sub infoDatumCerpaniTextbox_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoDatumCerpaniTextbox.Visible = False
'ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
End Sub
Private Sub TextBox63_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox63
        VyplnenoPred = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub TextBox63_Change()
        
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox63_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    'max form|fffd|t datumu je 10 znak|fffd| (DD.MM.RRRR)
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox63
            Dim datum_format As Object
            Set datum_format = CreateObject("vbscript.regexp")
            datum_format.Pattern = "(0?[1-9]|[12][0-9]|3[01])[\/.]? ?(0?[1-9]|1[012])?[\/.]? ?((19|20)?\d?\d?)?" '---- "^\s*\d*[-.\\\/]?\d*[-.\\\/]?\d*?$"
       
        If datum_format.test(.Value) = False Then
                '.BackColor = vbRed
                .Value = ""
                '.Activate
        End If
        If Len(.Value) > 10 Then
            If (Mid(.Value, 3, 1) = " " Or Mid(.Value, 4, 1) = " ") Then
                .Value = Left(.Value, 12)
            Else
                .Value = Left(.Value, 10)
            End If
        ElseIf InStr(1, .Value, ",") Then
            .BackColor = vbRed
            MsgBox "Datum |fffd|erp|fffd|n|fffd| odd|fffd|lujte te|fffd|kou nebo lom|fffd|tkem", vbCritical, "CHYBA - Datum |fffd|erp|fffd|n|fffd|"
            .BackColor = vbWhite
            .Value = ""
        End If
    End With
End Sub
Private Sub TextBox63_LostFocus()
    verzeKalkulatoru = ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value
    Dim a
    a = DateValue(Now())
        'Datum (zah|fffd|jen|fffd|) |fffd|erp|fffd|n|fffd|
        Row = 76
        Col = 5
With ThisWorkbook.Sheets("1_Kalkulace").TextBox63
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value
        
        If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) = False Then
            .BackColor = vbRed
            MsgBox "Zadejte spr|fffd|vn|fffd| datum zah|fffd|jen|fffd| |fffd|erp|fffd|n|fffd|, nebo obnovte v|fffd|choz|fffd| hodnotu tla|fffd||fffd|tkem", vbCritical, "CHYBA - Datum zah|fffd|jen|fffd| |fffd|erp|fffd|n|fffd|"
            .Activate
        ElseIf Not (verzeKalkulatoru = "HST" Or verzeKalkulatoru = "SGA") And CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) < DateValue(Now()) Then
            .BackColor = vbRed
            MsgBox "Datum |fffd|erp|fffd|n|fffd| nem|fffd||fffd|e b|fffd|t d|fffd||fffd|ve ne|fffd| dnes." & vbNewLine & "Bude obnovena v|fffd|choz|fffd| doporu|fffd|en|fffd| hodnota.", vbCritical, "CHYBA - Datum zah|fffd|jen|fffd| |fffd|erp|fffd|n|fffd|"
            Call obnovDatumCerpani
            .Activate
        'pokud je chybn|fffd| zad|fffd|no
        ElseIf Application.WorksheetFunction.IsError(Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V22").Value) Then
        .BackColor = vbRed
            MsgBox "Datum |fffd|erp|fffd|n|fffd| je v chybn|fffd|m form|fffd|tu." & vbNewLine & "Bude obnovena v|fffd|choz|fffd| doporu|fffd|en|fffd| hodnota.", vbCritical, "CHYBA - Datum zah|fffd|jen|fffd| |fffd|erp|fffd|n|fffd|"
            Call obnovDatumCerpani
            .Activate
        'pokud, sobota, ned|fffd|le, sv|fffd|tek, datum na n|fffd|sleduj|fffd|c|fffd| pracovn|fffd| den
        ElseIf CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) <> Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V22").Value Then
            .BackColor = vbRed
            MsgBox "Datum |fffd|erp|fffd|n|fffd| nem|fffd||fffd|e b|fffd|t v sobotu, ned|fffd|li nebo st|fffd|tn|fffd| sv|fffd|tek." & vbNewLine & "Bude dopln|fffd|no datum n|fffd|sleduj|fffd|c|fffd|ho pracovn|fffd|ho dne.", vbInformation, "CHYBA - Datum zah|fffd|jen|fffd| |fffd|erp|fffd|n|fffd|"
            .Text = Format(Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V22").Value, "d.m.yyyy")
            '.Activate
        Else
            .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value
            .Text = Format(.Text, "d.m.yyyy")
            
            'datum prvn|fffd| spl|fffd|tky
                If IsError(Application.VLookup(ComboBox16.Value, ThisWorkbook.Sheets("Seznamy").Range("C321:C323"), 1, False)) Then
                    ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.BackColor = vbRed
                    ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(77, 6).Value, "d.m.yyyy")
                End If
            'datum splatnosti
            Row = 78
            Col = 6
            ThisWorkbook.Sheets("1_Kalkulace").TextBox62.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
                If VyplnenoPred <> .Value Then
                    Call vynulovatSplatku
                    Call automaticky_vypocti_splatku
                End If
        '    splatkaPoprepoctu = 0
        End If
        .BackColor = vbWhite
End With
End Sub
Private Sub TextBox64_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox64
        VyplnenoPred = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub textbox64_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox64_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
With ThisWorkbook.Sheets("1_Kalkulace").TextBox64
    If Len(.Value) > 10 Then
            If (Mid(.Value, 3, 1) = " " Or Mid(.Value, 4, 1) = " ") Then
                .Value = Left(.Value, 12)
            Else
                .Value = Left(.Value, 10)
            End If
    ElseIf InStr(1, .Value, ",") Then
                .BackColor = vbRed
                MsgBox "Datum |fffd|erp|fffd|n|fffd| odd|fffd|lujte te|fffd|kou nebo lom|fffd|tkem", vbCritical, "CHYBA - Datum |fffd|erp|fffd|n|fffd|"
                .BackColor = 12648447
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
    End If
End With
End Sub
Private Sub TextBox64_LostFocus()
'kontrola, pokud nen|fffd| datum naho|fffd|e spr|fffd|vn|fffd| vr|fffd|t|fffd| se na datum naho|fffd|e
With ThisWorkbook.Sheets("1_Kalkulace").TextBox64
        If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) = False Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
                .BackColor = vbWhite
        ElseIf IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) = False Then
            .BackColor = vbRed
            MsgBox "Zadejte spr|fffd|vn|fffd| datum prvn|fffd| spl|fffd|tky, nebo obnovte v|fffd|choz|fffd| hodnotu tla|fffd||fffd|tkem", vbCritical, "CHYBA - Datum prvn|fffd| spl|fffd|tky"
            .Activate
        Else
            'kontrola prvn|fffd| spl|fffd|tka max. 3 roky po na|fffd|erp|fffd|n|fffd|
            If CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) + 3 * 365 < CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) Then
            .Activate
            MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t m|fffd|n|fffd| ne|fffd| 3 roky od na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!" & vbNewLine & "Zadejte znovu, nebo obnovte v|fffd|choz|fffd| hodnotu tla|fffd||fffd|tkem", vbCritical, "CHYBA - Datum prvn|fffd| spl|fffd|tky"
            ElseIf InStr(1, .Value, ",") Then
                .BackColor = vbRed
                MsgBox "Datum |fffd|erp|fffd|n|fffd| odd|fffd|lujte te|fffd|kou nebo lom|fffd|tkem", vbCritical, "CHYBA - Datum |fffd|erp|fffd|n|fffd|"
                .BackColor = 12648447
                .Value = ""
                .Activate
            Else
                'Datum prvn|fffd| spl|fffd|tky
                Row = 77
                Col = 6
                .Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
                .BackColor = vbWhite
                'datum splatnosti
                Row = 78
                Col = 6
                TextBox62.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value, "d.m.yyyy")
            End If
                If VyplnenoPred <> .Value Then
                    Call vynulovatSplatku
                    Call automaticky_vypocti_splatku
                End If
    '    splatkaPoprepoctu = 0
        End If
End With
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub tlacitko_info_slevaBU()
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Visible = True
'ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Value =
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Activate
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub info_slevaBU_gotFocus()
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Value = "Info: Aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| |fffd||fffd|tu = p|fffd||fffd|choz|fffd| mzda a 3 odchoz|fffd| transakce."
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Activate
End Sub
Private Sub info_slevaBU_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").info_slevaBU.Visible = False
End Sub

Private Sub ComboBox17_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox17
        VyplnenoPredTimSlevaBU = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub ComboBox17_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox17_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value <> "" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    'sleva za veden|fffd| |fffd||fffd|tu
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox17
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C330:C331"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                .BackColor = vbWhite
                    'obnoven|fffd| sazby
                    Call ObnovSazbu
                    'If VyplnenoPredTimSlevaBU <> .Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    'End If
            End If
        End If
    End With
End Sub
Private Sub ComboBox17_LostFocus()
'sleva za veden|fffd| |fffd||fffd|tu
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox17
        If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C330:C331"), 1, False)) Then
            .BackColor = vbRed
            MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Sleva za veden|fffd| b|fffd|n|fffd|ho |fffd||fffd|tu"
            .Activate
        'u P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r nastavit 'sleva za aktivn|fffd| |fffd||fffd|et = "ne"
        ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r" And .Value <> "ne" Then
        MsgBox "Sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| b|fffd|n|fffd|ho |fffd||fffd|tu nen|fffd| pro zvolen|fffd| produkt dostupn|fffd|.", vbInformation, "Sleva za b|fffd|n|fffd| |fffd||fffd|et - nelze sjednat"
        .Value = "ne"
        'u Hypot|fffd|ky bez hranic nastavit 'sleva za aktivn|fffd| |fffd||fffd|et = "ne"
        ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "Hypot|fffd|ka bez hranic" And .Value <> "ne" And ThisWorkbook.Sheets("Seznamy").Range("H1").Value <> True Then
        MsgBox "Sleva za aktivn|fffd| u|fffd||fffd|v|fffd|n|fffd| b|fffd|n|fffd|ho |fffd||fffd|tu je dostupn|fffd| pouze pro typ pobytu 'Ob|fffd|an |fffd|R', 'Trval|fffd| pobyt v |fffd|R' nebo 'P|fffd|echodn|fffd| / dlouhodob|fffd| pobyt v |fffd|R'.", vbInformation, "Sleva za b|fffd|n|fffd| |fffd||fffd|et - nelze sjednat"
        .Value = "ne"
        Else
    '        splatkaPoprepoctu = 0
        End If
        .BackColor = vbWhite
End With
'vynulovat zobrazen|fffd| sazby, pokud nen|fffd| vypln|fffd|na |fffd||fffd|stka
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
    If .Value = "" Or .Value = "  " Or .Value = 0 Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
    End If
    End With
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub tlacitko_info_typ_pojisteni()
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Visible = True
'ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Value =
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Activate
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub infoTypPojisteniTextbox_gotFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Value = "Info: P|fffd|i sjedn|fffd|n|fffd| poji|fffd|t|fffd|n|fffd| sleva " & Format(ThisWorkbook.Sheets("Seznamy").Range("I9").Value * 100, "0.0") & " % na |fffd|rokov|fffd| sazb|fffd|."
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Activate
End Sub
Private Sub infoTypPojisteniTextbox_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoTypPojisteniTextbox.Visible = False
End Sub


Private Sub ComboBox18_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox18
    'verze HST je|fffd|t|fffd| obsahuje v|fffd|echny typy poji|fffd|t|fffd|n|fffd|, jinak ne
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") = "HST" Then
        .ListFillRange = "=Seznamy!C336:C340"
    Else
        .ListFillRange = "=Seznamy!I336:I338"
    End If
        VyplnenoPredTypPojisteni = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub ComboBox18_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox18_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value <> "" Then
            .Visible = False
            '.Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Visible = True
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    'typ poji|fffd|t|fffd|n|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox18
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C336:C340"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                .BackColor = vbWhite
                        Call ObnovSazbu
                    If VyplnenoPredTypPojisteni <> .Value Then
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
            End If
        End If
    End With
End Sub
Private Sub ComboBox18_LostFocus()
'typ poji|fffd|t|fffd|n|fffd|
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox18
    If .Value <> "" Then
        If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C336:C340"), 1, False)) Then
            .BackColor = vbRed
            MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Typ poji|fffd|t|fffd|n|fffd|"
            .Activate
        'u P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r nastavit 'typ poji|fffd|t|fffd|n|fffd| = "Nen|fffd| sjedn|fffd|no"
        ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r" And .Value <> "Nen|fffd| sjedn|fffd|no" Then
        MsgBox "Poji|fffd|t|fffd|n|fffd| nen|fffd| pro zvolen|fffd| produkt dostupn|fffd|.", vbInformation, "Poji|fffd|t|fffd|n|fffd| - nelze sjednat"
        .Value = "Nen|fffd| sjedn|fffd|no"
        'u Hypot|fffd|ky bez hranic nastavit 'typ poji|fffd|t|fffd|n|fffd| = "Nen|fffd| sjedn|fffd|no"
        ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "Hypot|fffd|ka bez hranic" And .Value <> "Nen|fffd| sjedn|fffd|no" And ThisWorkbook.Sheets("Seznamy").Range("H1").Value <> True Then
        MsgBox "Poji|fffd|t|fffd|n|fffd| je dostupn|fffd| pouze pro typ pobytu 'Ob|fffd|an |fffd|R', 'Trval|fffd| pobyt v |fffd|R' nebo 'P|fffd|echodn|fffd| / dlouhodob|fffd| pobyt v |fffd|R'.", vbInformation, "Poji|fffd|t|fffd|n|fffd| - nelze sjednat"
        .Value = "Nen|fffd| sjedn|fffd|no"
        
        Else
            Call pojisteniNelzePoskytnoutVek
'''                If VyplnenoPred <> .Value Then
'''                    Call vynulovatSplatku
'''                    Call automaticky_vypocti_splatku
'''                End If
'''            'obnoven|fffd| sazby
'''            Call ObnovSazbu
'''    '        splatkaPoprepoctu = 0
        End If
    Else
        Call vynulovatSplatku
    End If
    .BackColor = vbWhite
End With
'vynulovat zobrazen|fffd| sazby, pokud nen|fffd| vypln|fffd|na |fffd||fffd|stka
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
    If .Value = "" Or .Value = "  " Or .Value = 0 Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
    End If
    End With
End Sub
Private Sub pojisteniNelzePoskytnoutVek()
    'kdy|fffd| v|fffd|k nad 60 let, nelze pojistit
    If ThisWorkbook.Sheets("Data ze vstupu").Range("N104").Value = True Then
    
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox18
            If .Value <> "" Then
                If .Value <> "Nen|fffd| sjedn|fffd|no" Then
                    .BackColor = vbRed
                    MsgBox "P|fffd|vodn|fffd| po|fffd|adovanou variantu poji|fffd|t|fffd|n|fffd| '" & .Value & "' nelze poskytnout klientovi nad 60 let. " & vbNewLine & "Varianta poji|fffd|t|fffd|n|fffd| bude zm|fffd|n|fffd|na na 'Nen|fffd| sjedn|fffd|no' ", vbInformation, "Poji|fffd|t|fffd|n|fffd| - zm|fffd|na varianty na 'Nen|fffd| sjedn|fffd|no'"
                    .Value = "Nen|fffd| sjedn|fffd|no"
                    .BackColor = vbWhite
                End If
            End If
End With
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "Nen|fffd| sjedn|fffd|no"
    Else
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.BackColor = vbWhite
    End If
End Sub
Private Sub TextBox65_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox65
        VyplnenoPred = .Value
        .BackColor = 12648447
    End With
End Sub
Private Sub TextBox65_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox65_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value <> 0 Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox65
        If IsNumeric(.Value) = False Then
            'MsgBox "Provolena jsou pouze |fffd||fffd|sla! Bude obnovena v|fffd|choz|fffd| sazba", vbCritical, "CHYBA - Sazba"
            '.BackColor = vbRed
            '.Activate
        ElseIf Len(.Value) > 4 Then
            .Value = Left(.Value, 4)
        'OMEZEN|fffd| na jedno m|fffd|sto p|fffd|ed desetinou |fffd||fffd|rkou (a desetiny a setiny)
        ElseIf InStr(1, .Value, ",") <> 2 And Len(.Value) > 1 Then
            .Value = Left(.Value, 1)
        Else
            .BackColor = vbWhite
            '.Value = Format(.Value, "#.##")
        End If
        ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value = Format(.Value, "#.00")
    End With
End Sub
Private Sub TextBox65_LostFocus()
'sazba, kontrola, |fffd|e je |fffd||fffd|slo
With ThisWorkbook.Sheets("1_Kalkulace").TextBox65
    If .Value <> "" Then
        Row = 81
        Col = 5
            If IsNumeric(.Value) = False Then
                .BackColor = vbRed
                'MsgBox "Zadejte sazbu jako desetinn|fffd| |fffd||fffd|slo, nebo obnovte v|fffd|choz|fffd| hodnotu tla|fffd||fffd|tkem", vbCritical, "CHYBA - |fffd|rokov|fffd| sazba"
                .Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("F81").Value, "0.00")
                '.Activate
            Else
                .Text = Format(.Value, "#.00")
                    If VyplnenoPred <> .Value Then
                        'pokud zad|fffd|m rozd|fffd|lnou sazbu, ne|fffd| sazbu ze seznamu, za|fffd|krtni individu|fffd|ln|fffd|
                            If .Value <> ThisWorkbook.Sheets("Data ze vstupu").Range("F81").Value Then
                                ThisWorkbook.Sheets("Data ze vstupu").Range("H81").Value = True
                                'obarvit |fffd|erven|fffd| p|fffd|smo
                                ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.ForeColor = &HFF&
                            End If
                        Call vynulovatSplatku
                        Call automaticky_vypocti_splatku
                    End If
    '            splatkaPoprepoctu = 0
            End If
    Else
        Call vynulovatSplatku
    End If
    .BackColor = vbWhite
End With
End Sub
Private Sub ComboBox11_GotFocus()
With ThisWorkbook.Sheets("1_Kalkulace").ComboBox11
        VyplnenoPred = .Value
        .BackColor = 12648447
End With
End Sub
Private Sub ComboBox11_Change()
''        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox11_kontrolka")
''        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Value <> "" Then
''            .Fill.ForeColor.RGB = RGB(0, 255, 0)
''            .AutoShapeType = 9
''        Else
''            .Fill.ForeColor.RGB = RGB(255, 0, 0)
''            .AutoShapeType = 34
''        End If
''        End With
    
    'po|fffd|et |fffd|adatel|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox11
        If Len(.Value) > 1 Then
            'mo|fffd|n|fffd| zadat pouze d|fffd|lku 1 znaku
            .Value = Left(.Value, 1)
        Else
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("D344:D347"), 1, False)) Then
                .BackColor = vbRed
            Else
                .BackColor = vbWhite
                aktualniZalozka = ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value
                'ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Tabs(aktualniZalozka).Activate
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Activate
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = aktualniZalozka
                .Activate
                'pokus o opravu poskakov|fffd|n|fffd| ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 20
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 19
            End If
        End If
    End With
End Sub
Private Sub ComboBox11_LostFocus()
'po|fffd|et |fffd|adatel|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox11
        If IsError(Application.VLookup(.Text, ThisWorkbook.Sheets("Seznamy").Range("D344:D347"), 1, False)) Then
            .BackColor = vbRed
            MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Po|fffd|et |fffd|adatel|fffd|"
            .Value = 1
            .Activate
        Else
            ScreenUpdatingStavPred = Application.ScreenUpdating
            Application.ScreenUpdating = False
            .BackColor = vbWhite
            Call menu_zadatele
                        'VIDITELNOST podbarven|fffd| / zv|fffd|razn|fffd|n|fffd| {|fffd|erven|fffd|ch nebo zelen|fffd|ch} z|fffd|lo|fffd|ek ThisWorkbook.Sheets("1_Kalkulace").TabStrip1 (kdy|fffd| nejsou vypln|fffd|ny v|fffd|echny |fffd|daje Hlavn|fffd|ho |fffd|adatele, spolu|fffd|ad 1, spolu|fffd|ad 2..
                        Select Case .Value
                        Case 0
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Visible = False
                        Case 1
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Visible = False
                        Case 2
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Visible = False
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Visible = False
                        Case 3
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Visible = False
                        Case 4
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Visible = True
                            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Visible = True
                        End Select
            'po|fffd|et |fffd|len|fffd| dom|fffd|cnosti (pokud celkem 1 dom|fffd|cnost, minim|fffd|ln|fffd| by m|fffd|l odpov|fffd|dat po|fffd|tu |fffd|adatel|fffd|)
            ''ponech|fffd|n ko|fffd|kopes, kter|fffd| vypln|fffd|, v p|fffd||fffd|pad|fffd| |fffd|e zm|fffd|na a st|fffd|le je jen jedna dom|fffd|cnost(?)

                If ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value <> 0 And VyplnenoPred <> .Value Then
                MsgBox "Zm|fffd|nili jste po|fffd|et |fffd|adatel|fffd|, zkontrolujte po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|.", vbInformation, "Zkontrolovat - Po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|"
                    'pokud je vybr|fffd|n men|fffd||fffd| po|fffd|et |fffd|adatel|fffd|, ne|fffd| byl p|fffd|ed t|fffd|m, nesk|fffd|kat na souhrn, ale na p|fffd|edchoz|fffd|ho |fffd|adatele
                End If
            
''            If ThisWorkbook.Sheets("Data ze vstupu").Range("X36") = 1 Then
''                ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Value = .Value
''                ThisWorkbook.Sheets("1_Kalkulace").TextBox11.BackColor = vbWhite
''            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
        End If
    End With
    Call promazatNeaktivniZadatele
    Call vydajeDomacnostiAktualizace
End Sub
Private Sub promazatNeaktivniZadatele()
'--------promazat po|fffd|et |fffd|adatel|fffd|
Dim posunPromazaniZadatelu As Integer
Select Case ThisWorkbook.Sheets("1_Kalkulace").ComboBox11
Case 1
posunPromazaniZadatelu = 2
Case 2
posunPromazaniZadatelu = 1
Case 3
posunPromazaniZadatelu = 0
Case 4
GoTo konec
End Select

'v souhrnu se neobjev|fffd| |fffd|daje dal|fffd||fffd|ch |fffd|adatel|fffd|, dokud nezad|fffd|m jejich jm|fffd|no
    ThisWorkbook.Sheets("Data ze vstupu").Range("Q" & 30 - posunPromazaniZadatelu & ":Q30").FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,""@"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("S" & 30 - posunPromazaniZadatelu & ":S30").FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,""Ob|fffd|an |fffd|R"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("T" & 30 - posunPromazaniZadatelu & ":T30").FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,""Spolu|fffd|adatel"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 30 - posunPromazaniZadatelu & ":U30").FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,1,"""")"

'ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0
        'pokus o opravu poskakov|fffd|n|fffd| ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    ''ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = 0

    ThisWorkbook.Sheets("Data ze vstupu").Range("O" & 30 - posunPromazaniZadatelu & ":P30").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("R" & 30 - posunPromazaniZadatelu & ":R30").Value = ""
      
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 86 - posunPromazaniZadatelu & ":Z86").FormulaR1C1 = "FALSE"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC" & 86 - posunPromazaniZadatelu & ":AC86").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 93 - posunPromazaniZadatelu & ":W93").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("Y" & 93 - posunPromazaniZadatelu & ":Y93").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 105 - posunPromazaniZadatelu & ":V105").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 116 - posunPromazaniZadatelu & ":W116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Y" & 116 - posunPromazaniZadatelu & ":Y116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC" & 116 - posunPromazaniZadatelu & ":AC116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 124 - posunPromazaniZadatelu & ":W124").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U" & 132 - posunPromazaniZadatelu & ":Z132").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z" & 140 - posunPromazaniZadatelu & ":AA140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC" & 140 - posunPromazaniZadatelu & ":AC140").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AE" & 140 - posunPromazaniZadatelu & ":AF140").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AH" & 140 - posunPromazaniZadatelu & ":AH140").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AJ" & 140 - posunPromazaniZadatelu & ":AK140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AM" & 140 - posunPromazaniZadatelu & ":AM140").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AO" & 140 - posunPromazaniZadatelu & ":AP140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AR" & 140 - posunPromazaniZadatelu & ":AR140").Value = ""
konec:
    Call promazatNeaktivniDomacnosti
End Sub
Private Sub promazatNeaktivniDomacnosti()
'-------------promazat dom|fffd|cnosti
'aktu|fffd|ln|fffd| po|fffd|et dom|fffd|cnost|fffd| porovnat kdy|fffd| 2 --> nepromazat nic, kdy|fffd| 1 --> promazat 1
Dim posunPromazaniDomacnosti As Integer

Select Case Val(ThisWorkbook.Sheets("Data ze vstupu").Range("X36").Value)
Case 1
posunPromazaniDomacnosti = 1
ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Tabs(1).Visible = False
        'pokus o opravu, aby se aktualizoval TabStrip3 a neposkakoval p|fffd|i p|fffd|ej|fffd|d|fffd|n|fffd| my|fffd||fffd|
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 18.75
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 17.5
Case Else
GoTo konec
End Select
    ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = 0
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z" & 147 - posunPromazaniDomacnosti & ":AA147").Value = ""
    'po|fffd|et |fffd|len|fffd| dom
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC" & 147 - posunPromazaniDomacnosti & ":AC147").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AD" & 147 - posunPromazaniDomacnosti & ":AD147").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AE" & 147 - posunPromazaniDomacnosti & ":AE147").FormulaR1C1 = "=IF(RC[-6]<>"""",""Byt / D|fffd|m v osobn|fffd|m vlastnictv|fffd|"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("AF" & 147 - posunPromazaniDomacnosti & ":AF147").FormulaR1C1 = "=IF(RC[-7]<>"""",""|fffd|esk|fffd| republika"","""")"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z" & 164 - posunPromazaniDomacnosti & ":AE164").Value = ""
konec:
End Sub
Private Sub TextBox1_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox1.BackColor = 12648447
        'pokus o opravu poskakov|fffd|n|fffd| ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 20
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 19
End Sub
Private Sub TextBox1_Change()
''        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox1_kontrolka")
''        If ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Value <> "" Then
''            ''.Visible = False
''            .Fill.ForeColor.RGB = RGB(0, 255, 0)
''            .AutoShapeType = 9
''        Else
''            .Fill.ForeColor.RGB = RGB(255, 0, 0)
''            .AutoShapeType = 34
''        End If
''        End With

        With ThisWorkbook.Sheets("1_Kalkulace").TextBox1
            If Len(.Value) > 60 Then
                .Value = Left(.Value, 60)
            End If
        End With

    Row = 27
    Col = 15
    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Value
End Sub
Private Sub TextBox1_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox1.BackColor = vbWhite
    Call TabStrip1_podbarveni
End Sub
Private Sub TextBox2_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox2.BackColor = 12648447
End Sub
Private Sub TextBox2_Change()
''        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox2_kontrolka")
''        If ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Value <> "" Then
''           ''.Visible = False
''            .Fill.ForeColor.RGB = RGB(0, 255, 0)
''            .AutoShapeType = 9
''        Else
''            .Fill.ForeColor.RGB = RGB(255, 0, 0)
''            .AutoShapeType = 34
''        End If
''        End With
               

    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox2
    Dim telefon_format As Object
    Set telefon_format = CreateObject("vbscript.regexp")
    telefon_format.Pattern = "^(\+?)\d*\s*\d*\s*\d*\s*\d*\s*\d*$" '--- (pr|fffd|zdn|fffd|) nebo (3 |fffd||fffd|sla s mezerami) nebo (mezin|fffd|rodn|fffd| form|fffd|t)..
        If telefon_format.test(.Value) = False Then
            .BackColor = vbRed
            MsgBox "Povolena jsou pouze |fffd||fffd|sla!" & vbNewLine & "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
            .Value = ""
        Else
            .BackColor = 12648447
        End If
        'mezin|fffd|rodn|fffd| form|fffd|t m|fffd||fffd|e b|fffd|t jak chce
        If IsNumeric(InStr(1, .Value, "+")) And InStr(1, .Value, "+") <> 0 Then
                If IsNumeric(InStr(1, .Value, "+")) And InStr(1, .Value, "+") <> 0 Then
                    .Text = Mid(.Value, InStr(1, .Value, "+"))
                Else
                    .Text = .Value
                End If
            If Len(.Value) > 25 Then
                .BackColor = vbWhite
                .Value = Left(.Value, 25)
            End If
        'jinak pokud |fffd|esk|fffd| |fffd||fffd|slo, tak dev|fffd|t |fffd||fffd|slic odd|fffd|len|fffd|ch dv|fffd|ma mezerami = 11 znak|fffd|
        Else
                .Value = Format(.Value, "### ### ###")
            If Len(.Value) > 11 Then
                .Value = Format(Left(.Value, 11), "### ### ###")
            End If
        End If
        Row = 27
        Col = 16
        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = .Value
    End With
End Sub
Private Sub TextBox2_LostFocus()
'Kontaktn|fffd| telefon
Dim telefon_format_cr As Object
Dim telefon_format_ostatni As Object
Set telefon_format_cr = CreateObject("vbscript.regexp")
Set telefon_format_ostatni = CreateObject("vbscript.regexp")
telefon_format_cr.Pattern = "^(\d{3}\s\d{3}\s\d{3})?$" '--- 3 |fffd||fffd|sla mezera..
telefon_format_ostatni.Pattern = "^(\+\d*\s*\d*\s*\d*\s*\d*\s*\d*)?$" '--- t|fffd|m|fffd||fffd| libovoln|fffd| |fffd||fffd|sel a mezer

    With ThisWorkbook.Sheets("1_Kalkulace").TextBox2
    If Val(.Value) = 0 Then
    'nic
    Else
        If Left(.Value, 1) = "+" Or Left(.Value, 2) = "00" Then
                If telefon_format_ostatni.test(.Value) = False Then
                    .BackColor = vbRed
                    MsgBox "Telefonn|fffd| |fffd||fffd|slo |fffd|R zad|fffd|vejte bez p|fffd|edvolby jako 9 |fffd||fffd|sel," & vbNewLine & "mezin|fffd|rodn|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
                    .Value = ""
                    .Activate
                ElseIf Val(.Value) = 0 Then
                .BackColor = vbWhite
                End If
            ElseIf Len(.Value) > 11 Then
                .BackColor = vbWhite
                .Value = Format(Left(.Value, 11), "### ### ###")
             ElseIf telefon_format_cr.test(ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Value) = False Then
                .BackColor = vbRed
                MsgBox "Telefonn|fffd| |fffd||fffd|slo v |fffd|R zad|fffd|vejte jako 9 |fffd||fffd|sel (nap|fffd|. 234 567 890)," & vbNewLine & "mezin|fffd|rodn|fffd| s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
                .Value = ""
                .Activate
            ElseIf Len(.Value) <> 11 Or telefon_format_cr.test(ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Value) = False Then
                .BackColor = vbRed
                MsgBox "Telefonn|fffd| |fffd||fffd|slo v |fffd|R zad|fffd|vejte bez p|fffd|edvolby ve form|fffd|tu 9 |fffd||fffd|sel (nap|fffd|. 234 567 890)," & vbNewLine & "mezin|fffd|rodn|fffd| s p|fffd|edvolbou (nap|fffd|. +421).", vbCritical, "CHYBA - Kontaktn|fffd| telefon"
                .Value = ""
                .Activate
            Else
                
        End If
    End If
        .BackColor = vbWhite
        Call TabStrip1_podbarveni
    End With
End Sub
'info n|fffd|pov|fffd|da - hint
Private Sub tlacitko_info_kontaktni_telefon()
ThisWorkbook.Sheets("1_Kalkulace").info_kontaktni_telefon_textbox.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").info_kontaktni_telefon_textbox.Value = "Info: Zahrani|fffd|n|fffd| telefonn|fffd| |fffd||fffd|slo zadejte s mezin|fffd|rodn|fffd| p|fffd|edvolbou (nap|fffd|. +421)"
ThisWorkbook.Sheets("1_Kalkulace").info_kontaktni_telefon_textbox.Activate
End Sub
Private Sub info_kontaktni_telefon_textbox_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").info_kontaktni_telefon_textbox.Visible = False
ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Activate
End Sub
Private Sub TextBox3_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox3.BackColor = 12648447
End Sub
Private Sub TextBox3_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox3
        'max form|fffd|t datumu je 10 znak|fffd| (DD.MM.RRRR)
        If Len(.Value) > 10 Then
            If (Mid(.Value, 3, 1) = " " Or Mid(.Value, 4, 1) = " ") Then
                .Value = Left(.Value, 12)
            Else
                .Value = Left(.Value, 10)
            End If
        ElseIf InStr(1, .Value, ",") Then
            .BackColor = vbRed
            MsgBox "Datum narozen|fffd| odd|fffd|lujte te|fffd|kou nebo lom|fffd|tkem", vbCritical, "CHYBA - Datum narozen|fffd|"
            .BackColor = 12648447
            .Value = Left(.Value, Len(.Value) - 1)
        End If
    End With
End Sub
Private Sub TextBox3_LostFocus()
'sazba, kontrola, |fffd|e je |fffd||fffd|slo
With ThisWorkbook.Sheets("1_Kalkulace").TextBox3
    'Datum narozen|fffd| ulo|fffd|en|fffd| do listu
    Row = 27
    Col = 18
    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = .Value
    Row = 81
    Col = 5
    If .Value <> "" Then
        If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value) = False Then
        .BackColor = vbRed
        MsgBox "Zadejte datum narozen|fffd| ve spr|fffd|vn|fffd|m form|fffd|tu", vbCritical, "CHYBA - Datum narozen|fffd|"
        .Activate
        'kontrola na minim|fffd|ln|fffd| v|fffd|k 21 let hlavn|fffd|ho |fffd|adatele
        ElseIf ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 And ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value > (Date - 21 * 365) Then
            .BackColor = vbRed
            MsgBox "Minim|fffd|ln|fffd| v|fffd|k hlavn|fffd|ho |fffd|adatele je 21 let, zkontrolujte datum nebo vypl|fffd|te jin|fffd|ho klienta", vbCritical, "CHYBA - Minim|fffd|ln|fffd| v|fffd|k"
            .Activate
        'kontrola na minim|fffd|ln|fffd| v|fffd|k 18 let
        ElseIf ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value > (Date - 18 * 365) Then
            .BackColor = vbRed
            MsgBox "Minim|fffd|ln|fffd| v|fffd|k klienta je 18 let, zkontrolujte datum nebo vypl|fffd|te jin|fffd|ho klienta", vbCritical, "CHYBA - Minim|fffd|ln|fffd| v|fffd|k"
            .Activate
        ElseIf ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value < 0 Then
            .BackColor = vbRed
            MsgBox "Zkontrolujte datum narozen|fffd|", vbCritical, "CHYBA - Datum narozen|fffd|"
            .Activate
        ElseIf InStr(1, .Value, ",") Then
                .BackColor = vbRed
                MsgBox "Datum narozen|fffd| odd|fffd|lujte te|fffd|kou nebo lom|fffd|tkem", vbCritical, "CHYBA - Datum narozen|fffd|"
                .BackColor = 12648447
                .Value = ""
                .Activate
        Else
            .BackColor = vbWhite
        End If
    Else
        .BackColor = vbWhite
    End If

        Call pojisteniNelzePoskytnoutVek
        Call TabStrip1_podbarveni
End With
End Sub
Private Sub TextBox7_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox7.BackColor = 12648447
End Sub
Private Sub TextBox7_Change()
    'e/mail
    Row = 27
    Col = 17
    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value
End Sub
Private Sub TextBox7_LostFocus()
'E-mail klient
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value = "@" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value = "" Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value = "@"
            ThisWorkbook.Sheets("1_Kalkulace").TextBox7.BackColor = vbWhite
            Else
           'kontrola p|fffd|es objekt, kter|fffd| m|fffd||fffd|e obsahovat pouze omezen|fffd| znaky '.Pattern = "^[\w-\.]+@([\w-]+\.)+[A-Za-z]{2,5}$"
           With CreateObject("vbscript.regexp")
               .Pattern = "^[\w-\.]+@[\w-]+\.+[A-Za-z]{2,5}$"
               If .test(ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value) = False Then
               ThisWorkbook.Sheets("1_Kalkulace").TextBox7.BackColor = vbRed
               MsgBox "Zadejte e-mail ve spr|fffd|vn|fffd|m form|fffd|tu", vbCritical, "CHYBA - E-mail klienta"
               ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Activate
               Else
               ThisWorkbook.Sheets("1_Kalkulace").TextBox7.BackColor = vbWhite
               End If
           End With
        End If
        Call TabStrip1_podbarveni
 End Sub
Private Sub ComboBox2_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.BackColor = 12648447
    sazbaPredZmenouObcanstvi = ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value
End Sub
Private Sub ComboBox2_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox2_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox2
        'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce, vyma|fffd|e zad|fffd|van|fffd| text
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C144:C148"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
            Else
                .BackColor = vbWhite
                'Trval|fffd| pobyt
                ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 19).Value = .Value
                'pokud je hlavn|fffd| |fffd|adatel 'Ob|fffd|an mimo EU s dlouhod./trval|fffd|m pobytem v |fffd|R', zobrazit pole odkud je p|fffd||fffd|jem = ovliv|fffd|uje v|fffd||fffd|i |fffd|rokov|fffd| sazby
                If .Value = "Ob|fffd|an mimo EU s dlouhod./trval|fffd|m pobytem v |fffd|R" And ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 And ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ZAM" Then
                  ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = True
                  ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = True
                Else
                  ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = False
                  ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = False
                End If
            End If
        End If
    End With
End Sub
Private Sub ComboBox2_LostFocus()
    'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox2
        If ComboBox2.Value <> "" Then
            If IsError(Application.VLookup(ComboBox2.Value, ThisWorkbook.Sheets("Seznamy").Range("C144:C148"), 1, False)) Then
                ComboBox2.BackColor = vbRed
                MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Trval|fffd| pobyt"
                ComboBox2.Activate
            Else
                'Trval|fffd| pobyt
                Row = 27
                Col = 19
                ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = ComboBox2.Value
                
            End If
        End If
        'pokud je 'Ob|fffd|an RF (Bez pobytu v |fffd|R)', je dostupn|fffd| pouze 'Hypot|fffd|ka bez hranic'
        If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0 And .Value = "Ob|fffd|an RF (Bez pobytu v |fffd|R)" And ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value <> "Hypot|fffd|ka bez hranic" Then
            MsgBox "Pro hlavn|fffd|ho |fffd|adatele s ob|fffd|anstv|fffd|m '" & .Value & "' nen|fffd| dostupn|fffd| produkt '" & ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value & "'. Produkt bude zm|fffd|n|fffd|n na 'Hypot|fffd|ka bez hranic'.", vbInformation, "Zm|fffd|na produktu na Hypot|fffd|ku bez hranic"
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "Hypot|fffd|ka bez hranic"
            Call promazatZmenaProduktu
        End If
        ComboBox2.BackColor = vbWhite
        Call TabStrip1_podbarveni
        Call ObnovSazbu
         If ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value <> sazbaPredZmenouObcanstvi Then
           Call vynulovatSplatku
           Call automaticky_vypocti_splatku
         End If
    End With
End Sub
Private Sub ComboBox5_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.BackColor = 12648447
End Sub
Private Sub ComboBox5_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox5_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox5
        'kontrola pokud vybran|fffd| 'Typ |fffd|adatele' nen|fffd| v nab|fffd|dce
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C139:C140"), 1, False)) Then
                .BackColor = vbRed
                .Value = Left(.Value, Len(.Value) - 1)
                .Activate
            Else
                .BackColor = vbWhite
                ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 20).Value = .Value
            End If
        End If
        If .Value = "Ru|fffd|itel" Or ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
        Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = True
        End If
    End With
End Sub
Private Sub ComboBox5_LostFocus()
    'kontrola pokud vybran|fffd| 'Typ |fffd|adatele' nen|fffd| v nab|fffd|dce
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox5
        If .Value <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C139:C140"), 1, False)) Then
                .BackColor = vbRed
                MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Typ |fffd|adatele"
                .Activate
            Else
                'Typ |fffd|adatele
                ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 20).Value = .Value
            End If
        End If
        .BackColor = vbWhite
        Call TabStrip1_podbarveni
    End With
End Sub
Private Sub ComboBox6_GotFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox6
        .BackColor = 12648447
        VyplnenoPred = .Value
    End With
End Sub
Private Sub ComboBox6_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox6_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
    
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox6
        '|fffd||fffd|slo dom|fffd|cnosti
        If Len(.Value) > 1 Then
            'mo|fffd|n|fffd| zadat pouze d|fffd|lku 1 znaku
            .Value = Left(.Value, 1)
        Else
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("D352:D353"), 1, False)) Then
                .BackColor = vbRed
                .Value = ""
            Else
                .BackColor = vbWhite
                'tady ten |fffd||fffd|dek d|fffd|l|fffd| pot|fffd| u Welcome-makra
                'kdy|fffd| je jin|fffd| dom|fffd|cnost
                ThisWorkbook.Sheets("Data ze vstupu").Cells(27 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21).Value = Val(.Value)
                Call menu_domacnost
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = Val(.Value) - 1
                Call TabStrip1_podbarveni
                'ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 18.75
                'ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 17.5
''''                ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
''''                ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = aktualniZalozka
                '.Activate
            End If
        End If
    End With
    
    'po|fffd|et |fffd|len|fffd| v dom|fffd|cnosti -- kontrolka pol|fffd||fffd|ka
    Call textbox11_kontrolka_zmena
End Sub
Private Sub ComboBox6_LostFocus()
'|fffd||fffd|slo dom|fffd|cnosti
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox6
        If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("D352:D353"), 1, False)) Then
            .BackColor = vbRed
            MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - |fffd||fffd|slo dom|fffd|cnosti"
            .Activate
        Else
            .BackColor = vbWhite
            Row = 27
            Col = 21
            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Val(.Value)
            Call menu_domacnost
            'po|fffd|et |fffd|len|fffd| dom|fffd|cnosti (pokud celkem 1 dom|fffd|cnost, minim|fffd|ln|fffd| by m|fffd|l odpov|fffd|dat po|fffd|tu |fffd|adatel|fffd|)

                'pokud u vybran|fffd|ho |fffd|adatele zm|fffd|n|fffd|m dom|fffd|cnost
                If ThisWorkbook.Sheets("data ze vstupu").Range("AC145").Value <> 0 And ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Value <> VyplnenoPred Then
                        'dom|fffd|cnost 1 - kdy|fffd| je men|fffd||fffd|
                        If ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value <> "" Or ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value <> 0 Then
                            'kdy|fffd| nebylo pr|fffd|zdn|fffd|, zkontrolovat minim|fffd|ln|fffd| po|fffd|et a v p|fffd||fffd|pad|fffd|, |fffd|e je po|fffd|et |fffd|len|fffd| ni|fffd||fffd||fffd| ne|fffd| min. ho doplnit
                            If ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value < ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value Then
                                MsgBox "Zm|fffd|nili jste dom|fffd|cnost spolu|fffd|adatele, zkontrolujte po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|.", vbInformation, "Zkontrolovat - Po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|"
                                '''ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value = ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value
                            End If
                        Else
                        'kdy|fffd| bylo pr|fffd|zdn|fffd|, doplnit tam minim|fffd|ln|fffd| po|fffd|et
                        '''ThisWorkbook.Sheets("Data ze vstupu").Range("AC145").Value = ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value
                        End If
        
                        'dom|fffd|cnost 2 - kdy|fffd| je men|fffd||fffd|
                        If ThisWorkbook.Sheets("Data ze vstupu").Range("AC146").Value <> "" Or ThisWorkbook.Sheets("Data ze vstupu").Range("AC146").Value <> 0 Then
                            'kdy|fffd| nebylo pr|fffd|zdn|fffd|, zkontrolovat minim|fffd|ln|fffd| po|fffd|et a v p|fffd||fffd|pad|fffd|, |fffd|e je po|fffd|et |fffd|len|fffd| ni|fffd||fffd||fffd| ne|fffd| min. ho doplnit
                            If ThisWorkbook.Sheets("Data ze vstupu").Range("AC146").Value < ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value Then
                                MsgBox "Zm|fffd|nili jste dom|fffd|cnost spolu|fffd|adatele, zkontrolujte po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|.", vbInformation, "Zkontrolovat - Po|fffd|ty |fffd|len|fffd| dom|fffd|cnost|fffd|"
                                '''ThisWorkbook.Sheets("Data ze vstupu").Range("AC146").Value = ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value
                            End If
                        Else
                        'kdy|fffd| bylo pr|fffd|zdn|fffd|, doplnit tam minim|fffd|ln|fffd| po|fffd|et
                        '''ThisWorkbook.Sheets("Data ze vstupu").Range("AC146").Value = ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value
                        End If
                End If
                
        End If
        
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 18.75
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 17.5
        'Call TabStrip1_podbarveni
    End With
    Call promazatNeaktivniZadatele
End Sub
'-------------------------------------------

'-------------p|fffd||fffd|jmy celkem-----------------
    Private Sub TextBox34_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox34.BackColor = 12648447
    End Sub
    Private Sub TextBox34_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox34_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Value <> 0 Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox34
            'Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem klienta celkov|fffd|
                If .Value <> "" And Not IsNumeric(.Value) Then
                .BackColor = vbRed
                'MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem klienta"
                .Value = ""
                Else
                    '''If Val(.Value) < 0 Then
                    '''    .Value = ""
                    '''    MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem klienta"
                    ''''kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    '''Elseif
                    If Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                            If .Enabled = False Then
                            .BackColor = &HE5E5E5
                            Else
                            .BackColor = vbWhite
                            End If
                    .Text = Format(.Value, "### ### ##0")
                    'Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem klienta celkov|fffd|
                    Row = 83
                    Col = 29
                    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = .Value
                End If
                Call prijmyVsechDomacnostiSuma
                Call vydajeDomacnostiAktualizace

        End With
    End Sub
    Private Sub TextBox34_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox34.BackColor = vbWhite
        Call TabStrip1_podbarveni
    End Sub
    Sub prumernyMesicniPrijemSuma()
        'pokud je nen|fffd| zvolen |fffd||fffd|dn|fffd| detail p|fffd||fffd|jm|fffd|, tak je textbox ENABLED a lze do n|fffd|j zapisovat, jinak se zobraz|fffd| suma ze sekce s detaily
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox34
            If ThisWorkbook.Sheets("Data ze vstupu").Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value = True Then
                .Enabled = True
                .Font.Bold = False
                .BackColor = vbWhite
                '.Value = ""
                '.Activate
            Else
                .Enabled = False
                .BackColor = &HE5E5E5
                .Font.Bold = True
                .Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0)
            End If
        End With
        Call aktualizovatLimity2v1
    End Sub
    'info n|fffd|pov|fffd|da - hint
    Private Sub Obr|fffd|zek24_Klepnut|fffd|()
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Text = "Info: Editovateln|fffd| pro orienta|fffd|n|fffd| v|fffd|po|fffd|et nebo needitovateln|fffd| sou|fffd|et zvolen|fffd|ch p|fffd||fffd|jm|fffd| n|fffd|e"
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Activate
    End Sub
    Private Sub infoPrijemPrumernyMesicniCelkem_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Visible = False
    End Sub
'------------------------------------------------------


'--------------(p|fffd||fffd|jem dle ZAM k|fffd|du)-------------------
Private Sub TextBox69_ZAM_kod_GotFocus()
ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.BackColor = 12648447
End Sub

Private Sub TextBox69_ZAM_kod_Change()
    'pokud vybran|fffd| produkt nen|fffd| v nab|fffd|dce a vypln|fffd| prvn|fffd| mo|fffd|nost z rozmez|fffd|
            Dim ZAM_kod_format As Object
            Set ZAM_kod_format = CreateObject("vbscript.regexp")
            ZAM_kod_format.Pattern = "^(\s?)\d*$"

With ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod
            If ZAM_kod_format.test(.Value) = False Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla!", vbCritical, "CHYBA - p|fffd||fffd|jem dle ZAM k|fffd|du"
                .Value = ""
            End If
            
        If Len(.Value) > 10 Then
            .Value = Left(.Value, 10)
        End If
        If IsNumeric(.Value) = False And .Value <> "" Or Val(.Value) <> Int(Val(.Value)) Then
                .BackColor = vbRed
                MsgBox "Povolena jsou pouze cel|fffd| |fffd||fffd|sla", vbCritical, "CHYBA - p|fffd||fffd|jem dle ZAM k|fffd|du"
                .Value = ""
        Else
            .BackColor = vbWhite
        End If
    End With
End Sub
Private Sub TextBox69_ZAM_kod_LostFocus()
'p|fffd||fffd|jem dle ZAM k|fffd|du |fffd||fffd|slo
With ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod
    ''    If Len(.Value) <> 0 And Len(.Value) > 9 Then
    ''        .BackColor = vbRed
    ''        MsgBox "Zadejte p|fffd||fffd|jem dle ZAM k|fffd|du", vbCritical, "CHYBA - p|fffd||fffd|jem dle ZAM k|fffd|du"
    ''        .Activate
    ''    Else
            .BackColor = vbWhite
    ''    End If
End With
Call prumernyMesicniPrijemSuma
End Sub

'-----------p|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti---------------
    Private Sub Textbox14_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox14.BackColor = 12648447
    End Sub
    Private Sub TextBox14_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox14_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Value <> 0 Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - 1. m|fffd|s|fffd|c
        Row = 90
        Col = 21
        'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox14
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - nastaven|fffd| v|fffd|stupn|fffd|ho pole, zaokrouhlen|fffd| a p|fffd|i|fffd|azen|fffd| hodnoty, tedy aktualizace
        Row = 90
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox17.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, 0), "### ### ###")
        'p|fffd||fffd|jmy za 12M, pokud se od sebe li|fffd||fffd| 2 nejvy|fffd||fffd||fffd| p|fffd||fffd|jmy o 100%
        Call zobrazeniPolePrijmy12Mesicu
    End Sub
    Private Sub Textbox14_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox14.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox15_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox15.BackColor = 12648447
    End Sub
    Private Sub TextBox15_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox15_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Value <> 0 Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - 2. m|fffd|s|fffd|c
        Row = 90
        Col = 22
        'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox15
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 2. m|fffd|s|fffd|c"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 2. m|fffd|s|fffd|c"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                           .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - nastaven|fffd| v|fffd|stupn|fffd|ho pole, zaokrouhlen|fffd| a p|fffd|i|fffd|azen|fffd| hodnoty, tedy aktualizace
        Row = 90
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox17.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, 0), "### ### ###")
        'p|fffd||fffd|jmy za 12M, pokud se od sebe li|fffd||fffd| 2 nejvy|fffd||fffd||fffd| p|fffd||fffd|jmy o 100%
        Call zobrazeniPolePrijmy12Mesicu
    End Sub
    Private Sub Textbox15_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox15.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox16_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox16.BackColor = 12648447
    End Sub
    Private Sub TextBox16_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox16_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Value <> "" And ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Value <> 0 Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - 3. m|fffd|s|fffd|c
        Row = 90
        Col = 23
        'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox16
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 3. m|fffd|s|fffd|c"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 3. m|fffd|s|fffd|c"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                           .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - nastaven|fffd| v|fffd|stupn|fffd|ho pole, zaokrouhlen|fffd| a p|fffd|i|fffd|azen|fffd| hodnoty, tedy aktualizace
        Row = 90
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox17.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, 0), "### ### ###")
        'p|fffd||fffd|jmy za 12M, pokud se od sebe li|fffd||fffd| 2 nejvy|fffd||fffd||fffd| p|fffd||fffd|jmy o 100%
        Call zobrazeniPolePrijmy12Mesicu
    End Sub
    Private Sub Textbox16_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox16.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Sub zobrazeniPolePrijmy12Mesicu()
        Row = 90
        Col = 26
        Dim zobrazPrijmy12Mesicu As Boolean
        zobrazPrijmy12Mesicu = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
            'pokud je vid|fffd|t,
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox75
            If .Visible = True Then
                If zobrazPrijmy12Mesicu = False Then
                .Value = ""
                .Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Label88.Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox75_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 22").Visible = False
                End If
            Else
                If zobrazPrijmy12Mesicu = True Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox75_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Label88.Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 22").Visible = True
                .Visible = True
                    If .Value = 0 Then
                    .BackColor = vbRed
                    MsgBox "P|fffd||fffd|jmy za 3 m|fffd|s|fffd|ce se od sebe li|fffd||fffd| o v|fffd|ce ne|fffd| 100%" & vbNewLine & "Vypl|fffd|te pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd| ", vbExclamation, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jmy za 3 m|fffd|s|fffd|ce"
                    .Activate
                    End If
                End If
            End If
        End With
    End Sub
    Private Sub Textbox75_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox75.BackColor = 12648447
    End Sub
    Private Sub TextBox75_Change()
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox75_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| - 12 m|fffd|s|fffd|c|fffd|, zobraz|fffd| se jen pokud se (nejvy|fffd||fffd||fffd| dva ze 3M) li|fffd||fffd| o v|fffd|ce ne|fffd| 100%
        Row = 90
        Col = 25
        'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox75
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        'P|fffd||fffd|jmy ze zam|fffd|stn|fffd|n|fffd| za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd| - nastaven|fffd| v|fffd|stupn|fffd|ho pole, zaokrouhlen|fffd| a p|fffd|i|fffd|azen|fffd| hodnoty, tedy aktualizace
        Row = 90
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox17.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, 0), "### ### ###")
    End Sub
    Private Sub Textbox75_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox75.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    'info n|fffd|pov|fffd|da - hint
    Private Sub Obr|fffd|zek22_Klepnut|fffd|()
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Text = "Info: Vypl|fffd|te, pokud se jeden z p|fffd||fffd|jm|fffd| za 3 m|fffd|s|fffd|ce li|fffd||fffd| o v|fffd|ce ne|fffd| 100 %"
        ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Activate
    End Sub
    Private Sub infoPrijemZaPoslednich12Mesicu_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Visible = False
    End Sub
'------------------------------------------------------

'-----------p|fffd||fffd|jmy dle da|fffd|ov|fffd|ho p|fffd|izn|fffd|n|fffd|---------------
    'Z|fffd|klad dan|fffd| ze z|fffd|visl|fffd| |fffd|innosti - |fffd||fffd|dek 31
    Private Sub TextBox40_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox40.BackColor = 12648447
    End Sub
    Private Sub TextBox40_Change()
        'Kontrola hodnoty vstupu
        Row = 113
        Col = 21
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox40_41_42_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox40
                    
                    If .Value <> "-" And .Value <> "" And Not IsNumeric(.Value) Then
                            'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                            .Value = ""
                            .BackColor = vbRed
                            '.Activate
                    Else
                        ''''m|fffd||fffd|e b|fffd|t i z|fffd|porn|fffd| = ztr|fffd|ta z podnik|fffd|n|fffd|
                        ''If Val(.Value) < 0 Then
                        ''    .Value = ""
                        ''    MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        ''    'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ''Elseif
                        If Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        
        'aktualizace vstupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox40_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox40.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox41_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox41.BackColor = 12648447
    End Sub
    'Z|fffd|klad dan|fffd| z podnik|fffd|n|fffd| (OSV|fffd|) - |fffd||fffd|dek 37
    Private Sub TextBox41_Change()
        'Kontrola hodnoty vstupu
        Row = 113
        Col = 22
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox40_41_42_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox41
                    If .Value <> "-" And .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
''                      ''m|fffd||fffd|e b|fffd|t i z|fffd|porn|fffd| = ztr|fffd|ta z podnik|fffd|n|fffd|
''                        If Val(.Value) < 0 Then
''                            .Value = ""
''                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
''                        Else
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        If Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        
        'aktualizace vstupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox41_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox41.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox42_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox42.BackColor = 12648447
    End Sub
    'Z|fffd|klad dan|fffd| z pron|fffd|jmu - |fffd||fffd|dek 39
    Private Sub TextBox42_Change()
        'Z|fffd|klad dan|fffd| z pron|fffd|jmu

        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox40_41_42_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
        
        'Kontrola hodnoty vstupu
        Row = 113
        Col = 23
        
                'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox42
                    If .Value <> "-" And .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
''                        'm|fffd||fffd|e b|fffd|t i ztr|fffd|ta z podnik|fffd|n|fffd|
''                        If Val(.Value) < 0 Then
''                            .Value = ""
''                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
''                        Elseif
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        If Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        
        'aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox42_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox42.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox44_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox44.BackColor = 12648447
    End Sub
    'Da|fffd| celkem - |fffd||fffd|dek 74
    Private Sub TextBox44_Change()
        'Z|fffd|klad dan|fffd| z pron|fffd|jmu
        'Kontrola hodnoty vstupu
        Row = 113
        Col = 25
        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox44_kontrolka")
        If ThisWorkbook.Sheets("1_Kalkulace").TextBox44.Value <> "" Then
            .Fill.ForeColor.RGB = RGB(0, 255, 0)
            .AutoShapeType = 9
        Else
            .Fill.ForeColor.RGB = RGB(255, 0, 0)
            .AutoShapeType = 34
        End If
        End With
                
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox44
                    If .Value <> "-" And .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        ''If Val(.Value) < 0 Then
                        ''    .Value = ""
                        ''    MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        ''ElseIf
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        If Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        
        'aktualizace vstupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox44_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox44.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox48_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox48.BackColor = 12648447
    End Sub
    'Odpisy nemovitosti (nutno konzultovat s pracovn|fffd|ky Retail Underwriting) P|fffd||fffd|loha |fffd|. 1/ odst. 2 A
    Private Sub TextBox48_Change()
        Row = 113
        Col = 29
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox48
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Pr|fffd|m|fffd|rn|fffd| p|fffd||fffd|jem za posledn|fffd|ch 12 m|fffd|s|fffd|c|fffd|"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        End If
                            .BackColor = 12648447
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
        'aktualizace vstupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0), "### ### ###")
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox48_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox48.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
'------------------------------------------------

'-----------p|fffd||fffd|jmy dle obratu---------------
    Private Sub TextBox84_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox84.BackColor = 12648447
    End Sub
    Private Sub TextBox84_Change()
        'Profesn|fffd| komora
        Row = 102
        Col = 21
        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Value
            
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox84_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Value <> "" And ThisWorkbook.Sheets("Data ze vstupu").Cells(102 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value <> "neplatn|fffd| PS|fffd| podnikatele pro v|fffd|po|fffd|et obratu" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox84
            If .Value <> "" And Not IsNumeric(.Value) Then
                .Value = ""
                .BackColor = vbRed
                '.Activate
            Else
                If Val(.Value) < 0 Then
                    .Value = ""
                    MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| PS|fffd|", vbCritical, "CHYBA - PS|fffd|"
                    'kontrola, aby bylo |fffd||fffd|slo jen na 5 m|fffd|st + 1 mezery = 6
                ElseIf Len(.Value) > 6 Then
                    .Value = Left(.Value, 6)
                End If
                    .BackColor = 12648447
                    ThisWorkbook.Sheets("Data ze vstupu").Cells(102 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21).Value = Round(Val(.Value), 0)
                    .Text = Format(.Value, "### ##")
            End If
        End With
        'm|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem z obratu
        Row = 102
        Col = 23
        ThisWorkbook.Sheets("1_Kalkulace").TextBox19.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    End Sub
    Private Sub TextBox84_LostFocus()
        'kontrola zda je vybran|fffd| mo|fffd|nost v nab|fffd|dce
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox84
                    If .Value <> "" Then
                        If Len(.Value) < 6 Then
                            .BackColor = vbRed
                            MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|esk|fffd| PS|fffd|", vbCritical, "CHYBA - PS|fffd|"
                            .Activate
                        End If
                    End If
            .BackColor = vbWhite
        End With
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox18_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox18.BackColor = 12648447
    End Sub
    Private Sub TextBox18_Change()
    'P|fffd||fffd|jmy dle profesn|fffd| komory - hodnoty
                With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox18_kontrolka")
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox18.Value <> "" Then
                    .Fill.ForeColor.RGB = RGB(0, 255, 0)
                    .AutoShapeType = 9
                Else
                    .Fill.ForeColor.RGB = RGB(255, 0, 0)
                    .AutoShapeType = 34
                End If
                End With
            'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox18
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    .Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem podle |fffd|7 P|fffd||fffd|loha DP"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        Row = 102
                        Col = 22
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                        'm|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem z obratu
                        Row = 102
                        Col = 23
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox19.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
                End If
            End With
    End Sub
    Private Sub TextBox18_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox18.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
      Private Sub TextBox88_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox88.BackColor = 12648447
    End Sub
    Private Sub TextBox88_Change()
    'P|fffd||fffd|jmy dle profesn|fffd| komory - hodnoty
                With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox88_kontrolka")
                'minim|fffd|ln|fffd| 1 milion
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Value <> "" And IsNumeric(Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Value)) And ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Value >= 1000000 Then
                    .Fill.ForeColor.RGB = RGB(0, 255, 0)
                    .AutoShapeType = 9
                Else
                    .Fill.ForeColor.RGB = RGB(255, 0, 0)
                    .AutoShapeType = 34
                End If
                End With
            'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox88
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    .Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem podle |fffd|7 P|fffd||fffd|loha DP"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        'p|fffd||fffd|jmy - minul|fffd| obdob|fffd|
                        Row = 102
                        Col = 24
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                        'v|fffd|sledn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem z obratu
                        Row = 102
                        Col = 23
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox19.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
                End If
            End With
    End Sub
    Private Sub TextBox88_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox88.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
'--------------------------------------------

'-----------p|fffd||fffd|jmy dle pau|fffd||fffd|lu---------------
    Private Sub TextBox20_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox20.BackColor = 12648447
    End Sub
    Private Sub TextBox20_Change()
        'P|fffd||fffd|jmy podle |fffd|7 P|fffd||fffd|loha 1 DP (|fffd|. 101)
        Row = 121
        Col = 21
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Value <> "" Then
                .Visible = True
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").Visible = True
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Value <> "" Then
                .Visible = False
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
            
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox21_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Value <> "" Then
                .Visible = False
                '.Fill.ForeColor.RGB = RGB(0, 255, 0)
                '.AutoShapeType = 9
            Else
                .Visible = True
                '.Fill.ForeColor.RGB = RGB(255, 0, 0)
                '.AutoShapeType = 34
            End If
            End With
            
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka")
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Value <> "" Then
                    .Visible = True
                    If ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Value <> "" Then
                        .Fill.ForeColor.RGB = RGB(0, 255, 0)
                        .AutoShapeType = 9
                    End If
                ElseIf ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Value <> "" Then
                    .Visible = False
                    If ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Value <> "" Then
                        .Fill.ForeColor.RGB = RGB(255, 0, 0)
                        .AutoShapeType = 34
                    End If
                End If
            End With
            
        'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox20
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jmy podle |fffd|7 P|fffd||fffd|loha 1 DP"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Value = Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Value, "## %")
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox31.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 25).Value, 0), "### ### ###")
                End If
            End With
    End Sub
    Private Sub TextBox20_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox20.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox21_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox21.BackColor = 12648447
    End Sub
    Private Sub TextBox21_Change()
        'P|fffd||fffd|jmy podle |fffd|9 P|fffd||fffd|loha 2 DP (|fffd|. 201)*
        Row = 121
        Col = 22
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox21_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Value <> "" Then
                .Visible = True
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Visible = True
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
            

            If ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").Visible = False
                    'ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").Fill.ForeColor.RGB = RGB(0, 255, 0)
                    'ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").AutoShapeType = 9
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").Fill.ForeColor.RGB = RGB(0, 255, 0)
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").AutoShapeType = 9
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").Visible = True
                    'ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").Fill.ForeColor.RGB = RGB(255, 0, 0)
                    'ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka").AutoShapeType = 34
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").Fill.ForeColor.RGB = RGB(255, 0, 0)
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox20_kontrolka").AutoShapeType = 34
            End If

        'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox21
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
         '          .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jmy podle |fffd|9 P|fffd||fffd|loha 2 DP"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Value = Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Value, "## %")
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox31.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 25).Value, 0), "### ### ###")
                End If
            End With
    End Sub
    Private Sub TextBox21_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox21.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub ComboBox7_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.BackColor = 12648447
    End Sub
    Private Sub ComboBox7_Change()
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox7_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox7
            'Pau|fffd||fffd|ln|fffd| sazba
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C391:C394"), 1, False)) Then
                    .BackColor = vbRed
                    .Value = Left(.Value, Len(.Value) - 1)
                    '.Activate
                Else
                    .BackColor = 12648447
                End If
            End If
        End With
    End Sub
    Private Sub ComboBox7_LostFocus()
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox7
            ThisWorkbook.Sheets("Data ze vstupu").Cells(121 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 23).Value = .Value
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C391:C394"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte variantu ze seznamu", vbCritical, "CHYBA - Pau|fffd||fffd|ln|fffd| sazba"
                    .Value = ""
                    .Activate
                End If
            End If
                Call prumernyMesicniPrijemSuma
                ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(121 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, "#0 %")
                ThisWorkbook.Sheets("1_Kalkulace").TextBox31.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(121 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 25).Value, 0), "### ### ### ###")
            .BackColor = vbWhite
            Call TabStrip1_podbarveni
        End With
    End Sub
'--------------------------------------------

'----------p|fffd||fffd|jem extern|fffd|ho prodejce---------
    Private Sub TextBox52_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox52.BackColor = 12648447
    End Sub
    Private Sub TextBox52_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 1
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox52_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox52.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With

        'Kontrola hodnoty vstupu
        Row = 129
        Col = 21
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox52
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 1. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox52_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox52.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox53_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox53.BackColor = 12648447
    End Sub
    Private Sub TextBox53_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 2
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox53_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox53.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 129
        Col = 22
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox53
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 2. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox53_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox53.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox54_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox54.BackColor = 12648447
    End Sub
    Private Sub TextBox54_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 3
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox54_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox54.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 129
        Col = 23
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox54
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 3. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox54_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox54.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox56_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox56.BackColor = 12648447
    End Sub
    Private Sub TextBox56_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 4
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox56_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox56.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 129
        Col = 24
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox56
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 4. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox56_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox56.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox57_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox57.BackColor = 12648447
    End Sub
    Private Sub TextBox57_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 5
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox57_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox57.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 129
        Col = 25
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox57
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 5. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox57_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox57.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox58_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox58.BackColor = 12648447
    End Sub
    Private Sub TextBox58_Change()
        'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 6
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox58_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox58.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With

        'Kontrola hodnoty vstupu
        Row = 129
        Col = 26
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox58
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem extern|fffd|ho prodejce - 6. m|fffd|s|fffd|c"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox58_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox58.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
'--------------------------------------------

'------------OSTATN|fffd| P|fffd||fffd|JMY------------------
    '---Ostatn|fffd| p|fffd||fffd|jmy - typ p|fffd||fffd|jmu 1---
    Private Sub ComboBox8_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.BackColor = 12648447
    End Sub
    Private Sub ComboBox8_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With

            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka").Visible = False
            End If
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox8
            'typ p|fffd||fffd|jmu 1 kontrola zda vybran|fffd| je v nab|fffd|dce
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                        .BackColor = vbRed
                        .Value = Left(.Value, Len(.Value) - 1)
                        .Activate
                Else
                .BackColor = 12648447
                'Aktualizace v|fffd|stupu
                ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
                End If
            End If
            ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value = .Value
            Call zobrazPrijmyOstatniPocetNezaopatrenychDeti1
        End With
    End Sub
    Private Sub ComboBox8_LostFocus()
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox8
            'typ p|fffd||fffd|jmu 1 kontrola zda vybran|fffd| je v nab|fffd|dce
            Row = 137
            Col = 26
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                            .BackColor = vbRed
                            MsgBox "Vyberte typ p|fffd||fffd|jmu ze seznamu", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - Typ p|fffd||fffd|jmu 1"
                            .Value = ""
                            .Activate
                Else
                    'zobrazen|fffd| pole 'po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd|', pokud se maj|fffd| u dan|fffd|ho p|fffd||fffd|jmu zobrazit
                    Call zobrazPrijmyOstatniPocetNezaopatrenychDeti1
                    Call prumernyMesicniPrijemSuma
                End If
            End If
            .BackColor = vbWhite
            'Aktualizace v|fffd|stupu
            ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
            Call TabStrip1_podbarveni
        End With
    End Sub
Private Sub zobrazPrijmyOstatniPocetNezaopatrenychDeti1()
    If ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value = False Then
        ThisWorkbook.Sheets("1_Kalkulace").Label87.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka").Visible = False
    Else
        ThisWorkbook.Sheets("1_Kalkulace").Label87.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka").Visible = True
    End If
End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 1---
    Private Sub TextBox33_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox33.BackColor = 12648447
    End Sub
    Private Sub TextBox33_Change()
        'Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 1
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox8_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox33_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka").Visible = False
            End If
        'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox33
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - p|fffd||fffd|jem 1"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox33_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox33.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox74_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox74.BackColor = 12648447
    End Sub
    Private Sub TextBox74_Change()
        'Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 1
            'po|fffd|et d|fffd|t|fffd|
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox74_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 137
        Col = 29
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox74
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 1"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 1 m|fffd|st= 1
                    ElseIf Len(.Value) > 1 Then
                        .Value = Left(.Value, 1)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "#")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox74_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox74.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
        
    '---Ostatn|fffd| p|fffd||fffd|jmy - typ p|fffd||fffd|jmu 2---
    Private Sub ComboBox9_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.BackColor = 12648447
    End Sub
    Private Sub ComboBox9_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka").Visible = False
            End If
        'typ p|fffd||fffd|jmu 2 kontrola zda vybran|fffd| je v nab|fffd|dce
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox9
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                    .BackColor = vbRed
                    .Value = Left(.Value, Len(.Value) - 1)
                    .Activate
                Else
                    .BackColor = 12648447
                    'Aktualizace v|fffd|stupu
                    Row = 137
                    Col = 33
                    TextBox37.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, 0), "### ### ###")
                End If
            End If
            ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value = .Value
            Call zobrazPrijmyOstatniPocetNezaopatrenychDeti2
        End With
    End Sub
    Private Sub ComboBox9_LostFocus()
        'typ p|fffd||fffd|jmu 2 kontrola zda vybran|fffd| je v nab|fffd|dce
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox9
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte typ p|fffd||fffd|jmu ze seznamu", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - Typ p|fffd||fffd|jmu 2"
                    .Value = ""
                    .Activate
                Else
                    'zobrazen|fffd| pole 'po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd|', pokud se maj|fffd| u dan|fffd|ho p|fffd||fffd|jmu zobrazit
                    Call zobrazPrijmyOstatniPocetNezaopatrenychDeti2
                    Call prumernyMesicniPrijemSuma
                End If
            End If
            .BackColor = vbWhite
            'Aktualizace v|fffd|stupu
            TextBox37.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 33).Value, 0), "### ### ###")
            Call TabStrip1_podbarveni
        End With
    End Sub
Private Sub zobrazPrijmyOstatniPocetNezaopatrenychDeti2()
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 35).Value = False Then
            ThisWorkbook.Sheets("1_Kalkulace").Label112.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka").Visible = False
        Else
            ThisWorkbook.Sheets("1_Kalkulace").Label112.Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka").Visible = True
        End If
End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 2---
    Private Sub TextBox36_GotFocus()
       ThisWorkbook.Sheets("1_Kalkulace").TextBox36.BackColor = 12648447
    End Sub
    Private Sub TextBox36_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox9_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox36_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka").Visible = False
            End If
        'Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 2
        'Kontrola hodnoty vstupu
        Row = 137
        Col = 32
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox36
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - p|fffd||fffd|jem 2"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox37.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 33).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox36_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox36.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 2---
    Private Sub TextBox76_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox76.BackColor = 12648447
    End Sub
    Private Sub TextBox76_Change()
        'Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 2
            'po|fffd|et d|fffd|t|fffd|
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox76_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 137
        Col = 34
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox76
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 2"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 1 m|fffd|st = 1
                    ElseIf Len(.Value) > 1 Then
                        .Value = Left(.Value, 1)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "#")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox37.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 33).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox76_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox76.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 3---
    Private Sub ComboBox10_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.BackColor = 12648447
    End Sub
    Private Sub ComboBox10_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox10_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox38_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox10_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox38_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox10_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox38_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka").Visible = False
            End If
        'typ p|fffd||fffd|jmu 3 kontrola zda vybran|fffd| je v nab|fffd|dce
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox10
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                            .BackColor = vbRed
                            .Value = Left(.Value, Len(.Value) - 1)
                            .Activate
                Else
                    .BackColor = 12648447
                    'Aktualizace v|fffd|stupu
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, 0), "### ### ###")
                End If
            End If
            ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 36).Value = .Value
            Call zobrazPrijmyOstatniPocetNezaopatrenychDeti3
        End With
    End Sub
    Private Sub ComboBox10_LostFocus()
        'typ p|fffd||fffd|jmu 3 kontrola zda vybran|fffd| je v nab|fffd|dce
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox10
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte typ p|fffd||fffd|jmu ze seznamu", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - Typ p|fffd||fffd|jmu 3"
                    .Value = ""
                    .Activate
                Else
                    'zobrazen|fffd| pole 'po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd|', pokud se maj|fffd| u dan|fffd|ho p|fffd||fffd|jmu zobrazit
                    Call zobrazPrijmyOstatniPocetNezaopatrenychDeti3
                    Call prumernyMesicniPrijemSuma
                End If
            End If
            .BackColor = vbWhite
            'Aktualizace v|fffd|stupu
            ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, 0), "### ### ###")
            Call TabStrip1_podbarveni
        End With
    End Sub
Private Sub zobrazPrijmyOstatniPocetNezaopatrenychDeti3()
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 40).Value = False Then
            ThisWorkbook.Sheets("1_Kalkulace").Label113.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka").Visible = False
        Else
            ThisWorkbook.Sheets("1_Kalkulace").Label113.Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka").Visible = True
        End If
End Sub

    
    '---Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 3---
    Private Sub TextBox38_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox38.BackColor = 12648447
    End Sub
    Private Sub TextBox38_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox10_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox38_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox10_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox38_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox10_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox38_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka").Visible = False
            End If
        'Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 3
        'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox38
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - p|fffd||fffd|jem 3"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 37).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox38_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox38.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 3---
    Private Sub TextBox77_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox77.BackColor = 12648447
    End Sub
    Private Sub TextBox77_Change()
        'Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 3
            'po|fffd|et d|fffd|t|fffd|
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox77_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Kontrola hodnoty vstupu
        Row = 137
        Col = 39
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox77
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 3"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 1 m|fffd|sto
                    ElseIf Len(.Value) > 1 Then
                        .Value = Left(.Value, 1)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "#")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox77_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox77.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - typ p|fffd||fffd|jmu 4---
    Private Sub ComboBox19_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.BackColor = 12648447
    End Sub
    Private Sub ComboBox19_Change()
                If ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value <> "" Then
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka").Visible = True
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                Else
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka").Visible = False
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka").Visible = False
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka").Visible = False
                End If
            With ThisWorkbook.Sheets("1_Kalkulace").ComboBox19
            'typ p|fffd||fffd|jmu 4 kontrola zda vybran|fffd| je v nab|fffd|dce
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                    .BackColor = vbRed
                    .Value = Left(.Value, Len(.Value) - 1)
                    .Activate
                Else
                    .BackColor = 12648447
                    'Aktualizace v|fffd|stupu
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, 0), "### ### ###")
                End If
            End If
            ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 41).Value = .Value
            Call zobrazPrijmyOstatniPocetNezaopatrenychDeti4
        End With
    End Sub
    Private Sub ComboBox19_LostFocus()
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox19
            'typ p|fffd||fffd|jmu 4 kontrola zda vybran|fffd| je v nab|fffd|dce
            If .Value <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C359:C375"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte typ p|fffd||fffd|jmu ze seznamu", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - Typ p|fffd||fffd|jmu 4"
                    .Value = ""
                    .Activate
                Else
                    Row = 137
                    Col = 41
                    'zobrazen|fffd| pole 'po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd|', pokud se maj|fffd| u dan|fffd|ho p|fffd||fffd|jmu zobrazit
                    Call zobrazPrijmyOstatniPocetNezaopatrenychDeti4
                    Call prumernyMesicniPrijemSuma
                End If
            End If
            .BackColor = vbWhite
            'Aktualizace v|fffd|stupu
            ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, 0), "### ### ###")
            Call TabStrip1_podbarveni
        End With
    End Sub
Private Sub zobrazPrijmyOstatniPocetNezaopatrenychDeti4()
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 45).Value = False Then
            ThisWorkbook.Sheets("1_Kalkulace").Label20.Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka").Visible = False
        Else
            ThisWorkbook.Sheets("1_Kalkulace").Label20.Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka").Visible = True
        End If
End Sub
'---Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 4---
    Private Sub TextBox78_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox78.BackColor = 12648447
    End Sub
    Private Sub TextBox78_Change()
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value <> "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value <> "" Then
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka").Visible = True
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka").Visible = True
                    'typ p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'v|fffd||fffd|e p|fffd||fffd|jmu
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
                    'po|fffd|et d|fffd|t|fffd|
                        With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka")
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Value <> "" Then
                            .Fill.ForeColor.RGB = RGB(0, 255, 0)
                            .AutoShapeType = 9
                        Else
                            .Fill.ForeColor.RGB = RGB(255, 0, 0)
                            .AutoShapeType = 34
                        End If
                        End With
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox19_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox78_kontrolka").Visible = False
                ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka").Visible = False
            End If
        'Ostatn|fffd| p|fffd||fffd|jmy - v|fffd||fffd|e p|fffd||fffd|jmu 4
        'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox78
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| p|fffd||fffd|jmy - p|fffd||fffd|jem 4"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 42).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox78_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox78.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    '---Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 4---
    Private Sub TextBox80_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox80.BackColor = 12648447
    End Sub
    Private Sub TextBox80_Change()
            'po|fffd|et d|fffd|t|fffd|
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox80_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        'Ostatn|fffd| p|fffd||fffd|jmy - po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 4
        'Kontrola hodnoty vstupu
        Row = 137
        Col = 44
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox80
                If .Value <> "" And Not IsNumeric(.Value) Then
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .Value = ""
                        MsgBox "Vypl|fffd|te p|fffd||fffd|jem jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Po|fffd|et nezaopat|fffd|en|fffd|ch d|fffd|t|fffd| p|fffd||fffd|jmu 4"
                        'kontrola, aby bylo |fffd||fffd|slo jen na 1 m|fffd|sto
                    ElseIf Len(.Value) > 1 Then
                        .Value = Left(.Value, 1)
                    End If
                        .BackColor = 12648447
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "#")
                End If
            End With
        'Aktualizace v|fffd|stupu
        ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, 0), "### ### ###")
    End Sub
    Private Sub TextBox80_LostFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox80.BackColor = vbWhite
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub

'----------sekce p|fffd||fffd|jmy za|fffd|kr|fffd|v|fffd|tka----------
Private Sub CheckBox1_Change()
        'Range("U80").Value = CheckBox2.Value
        Call zobrazeniPrijemZeZavisleCinnosti
        Call prumernyMesicniPrijemSuma
        Call zobrazeniPolePrijmy12Mesicu
        Call TabStrip1_podbarveni
    End Sub
    Private Sub zobrazeniPrijemZeZavisleCinnosti()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("53:55").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("54:55").EntireRow.Hidden = True
        End Select
    End Sub
    
    'p|fffd||fffd|jmy dle da|fffd|ov|fffd|ho p|fffd|izn|fffd|n|fffd|
    Private Sub CheckBox8_Change()
        'nelzeKombinovatPrijmyDanovehoPriznani-Obratu
        If nezobrazHlasku3PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox9 = True Then
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = False
            MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem dle z|fffd|kladu dan|fffd|' a 'P|fffd||fffd|jem z obratu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
        'nelzeKombinovatPrijmyDanovehoPriznani-Pausalu
        ElseIf nezobrazHlasku3PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox10 = True Then
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = False
            MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem dle z|fffd|kladu dan|fffd|' a 'P|fffd||fffd|jem z pau|fffd||fffd|lu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
        Else
            Call zobrazeniPrijemDleDanovehoPriznani
            Call prumernyMesicniPrijemSuma
        End If
        Call TabStrip1_podbarveni
        nezobrazHlasku3PrijmyPrepnutiZadatele = False
    End Sub
    
    Private Sub zobrazeniPrijemDleDanovehoPriznani()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("56:57").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("57:57").EntireRow.Hidden = True
        End Select
    End Sub
    
    'p|fffd||fffd|jmy dle obratu
    Private Sub CheckBox9_Change()
        'nelzeKombinovatPrijmyObratuPausalu
            If nezobrazHlasku1PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox10 = True Then
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = False
                MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem z obratu' a 'P|fffd||fffd|jem z pau|fffd||fffd|lu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
        'nelzeKombinovatPrijmyDanovehoPriznani-a-Obratu
            ElseIf nezobrazHlasku1PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox9 = True Then
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = False
                MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem dle z|fffd|kladu dan|fffd|' a 'P|fffd||fffd|jem z obratu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
            Else
                Call zobrazeniPrijemDleObratu
                Call prumernyMesicniPrijemSuma
            End If
            
        Call TabStrip1_podbarveni
        'vynulov|fffd|n|fffd| .. ale rad|fffd|ji nuluji pouze jednou u posledn|fffd|ho checkboxu, kter|fffd| m|fffd| tuto hl|fffd|ku
        nezobrazHlasku1PrijmyPrepnutiZadatele = False
    End Sub

    Private Sub zobrazeniPrijemDleObratu()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("58:59").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("59:59").EntireRow.Hidden = True
        End Select
    End Sub
    'p|fffd||fffd|jem dle pau|fffd||fffd|lu
    Private Sub CheckBox10_Change()
            'nelzeKombinovatPrijmyObratuPausalu
            If nezobrazHlasku2PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox10 = True Then
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = False
                MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem z obratu' a 'P|fffd||fffd|jem z pau|fffd||fffd|lu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
            'nelzeKombinovatPrijmyDanovehoPriznani-Pausalu
            ElseIf nezobrazHlasku2PrijmyPrepnutiZadatele = False And ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True And ThisWorkbook.Sheets("1_Kalkulace").CheckBox10 = True Then
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = False
                MsgBox "Nelze zvolit kombinaci 'P|fffd||fffd|jem dle z|fffd|kladu dan|fffd|' a 'P|fffd||fffd|jem z pau|fffd||fffd|lu'", vbCritical, "CHYBA - Nepovolen|fffd| kombinace p|fffd||fffd|jm|fffd|"
            Else
                Call zobrazeniPrijemDlePausalu
                Call prumernyMesicniPrijemSuma
            End If
            
        Call TabStrip1_podbarveni
        nezobrazHlasku2PrijmyPrepnutiZadatele = False
    End Sub
    Private Sub zobrazeniPrijemDlePausalu()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("60:61").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("61:61").EntireRow.Hidden = True
        End Select
    End Sub
    'p|fffd||fffd|jem pro extern|fffd| prodejce
    Private Sub CheckBox11_Change()
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
        Call zobrazeniPrijemExternihoProdejce
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
    End Sub
    Private Sub zobrazeniPrijemExternihoProdejce()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("62:63").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("63:63").EntireRow.Hidden = True
        End Select
    End Sub
    'ostatn|fffd| p|fffd||fffd|jmy
    Private Sub CheckBox12_Change()
        'pokus o opravu chyby p|fffd|i skr|fffd|v|fffd|n|fffd| |fffd||fffd|dku CheckBox11.Activate
        Call zobrazeniPrijemOstatni
        Call prumernyMesicniPrijemSuma
        Call TabStrip1_podbarveni
        Call zobrazPrijmyOstatniPocetNezaopatrenychDeti1
        Call zobrazPrijmyOstatniPocetNezaopatrenychDeti2
        Call zobrazPrijmyOstatniPocetNezaopatrenychDeti3
        Call zobrazPrijmyOstatniPocetNezaopatrenychDeti4
    End Sub
    Private Sub zobrazeniPrijemOstatni()
        Select Case ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value
        Case True:  ThisWorkbook.Sheets("1_Kalkulace").Rows("64:65").EntireRow.Hidden = False
        Case False
            'h|fffd|zelo chyby, kdy|fffd| byl kurzor v jednom z textbox|fffd|, kter|fffd| se m|fffd|li skr|fffd|vat
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
            ThisWorkbook.Sheets("1_Kalkulace").Rows("65:65").EntireRow.Hidden = True
        End Select
    End Sub
'---------------------------------------------

'--------------ThisWorkbook.Sheets("1_Kalkulace").TabStrip1 - |fffd|adatel, spolu|fffd|adatel|fffd|------------------
    Private Sub TabStrip1_podbarveni()
        'hlavn|fffd| |fffd|adatel
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(100, 5).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_hlavniZad").Fill.ForeColor.RGB = vbRed
        End If
        'spolu|fffd|adatel 1
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(100, 6).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad1").Fill.ForeColor.RGB = vbRed
        End If
        'spolu|fffd|adatel 2
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(100, 7).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad2").Fill.ForeColor.RGB = vbRed
        End If
        'spolu|fffd|adatel 3
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(100, 8).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip1_spoluzad3").Fill.ForeColor.RGB = vbRed
        End If
    End Sub


Private Sub TabStrip1_Change()
Application.ReferenceStyle = xlA1
    Row = 83
    Col = 21
    Dim blaaa
    'p|fffd||fffd|jmy ze z|fffd|visl|fffd| |fffd|innosti
    blaaa = "'Data ze vstupu'!" & Cells(Row + a, Col).Address
    
    'o|fffd|et|fffd|en|fffd|, aby se nezobrazovala hl|fffd|ka p|fffd|i p|fffd|epnut|fffd| |fffd|adatel|fffd| (Tabstripu) - na chvili se m|fffd||fffd|ou potkat spolu nedovolen|fffd| p|fffd||fffd|jmy
    nezobrazHlasku1PrijmyPrepnutiZadatele = True
    nezobrazHlasku2PrijmyPrepnutiZadatele = True
    nezobrazHlasku3PrijmyPrepnutiZadatele = True
    
    '|fffd|daje o klientech - vyb|fffd|rac|fffd| z|fffd|lo|fffd|ka
    
    ScreenUpdatingStavPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    
    'Jm|fffd|no a p|fffd||fffd|jmen|fffd| klienta
    Row = 27
    Col = 15
    ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    'Datum narozen|fffd|
    Row = 27
    Col = 18
    ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    'Kontaktn|fffd| telefon
    Row = 27
    Col = 16
    ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    'e/mail
    Row = 27
    Col = 17
    ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    
    'Trval|fffd| pobyt
    Row = 27
    Col = 19
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    'Typ |fffd|adatele
    Row = 27
    Col = 20
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    '|fffd||fffd|slo dom|fffd|cnosti
    Row = 27
    Col = 21
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
    
    'Call menu_prijem
    Call menu_domacnost
    
        Select Case ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value
        Case 0
            'zam k|fffd|d
            If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True
            End If
        
        ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox1_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox5_kontrolka").Visible = False
        
        '|fffd||fffd|slo dom|fffd|cnosti p|fffd|edvypln|fffd|na needitovateln|fffd| 1
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Value = 1
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox6_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label11.Visible = False
        
        'p|fffd||fffd|jem ze zem|fffd| -- visible pokud 'Ob|fffd|an RF / mimo EU', -- ovliv|fffd|uje v|fffd||fffd|i |fffd|rokov|fffd| sazby
        If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ZAM" Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = ThisWorkbook.Sheets("Data ze vstupu").Range("R83").Value
            ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = ThisWorkbook.Sheets("Data ze vstupu").Range("R83").Value
        End If
        
        
        ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label2.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label3.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label4.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label5.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label9.Visible = True
        
        Case 1
            'ZAM k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox1_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox5_kontrolka").Visible = True
        
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox6_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label11.Visible = True
        
        'p|fffd||fffd|jem ze zem|fffd| - visible pouze u hlavn|fffd|ho |fffd|adatele
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = False
        
        ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label2.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label3.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label4.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label5.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label9.Visible = True
        
        
        Case 2
            'ZAM k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox1_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox5_kontrolka").Visible = True
        
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox6_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label11.Visible = True
        
        'p|fffd||fffd|jem ze zem|fffd| - visible pouze u hlavn|fffd|ho |fffd|adatele
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = False
        
        ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label2.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label3.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label4.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label5.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label9.Visible = True
        
        
        Case 3
            'ZAM k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox1_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Visible = True ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox2_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox5_kontrolka").Visible = True
        
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox6_kontrolka").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label11.Visible = True
        
        'p|fffd||fffd|jem ze zem|fffd| - visible pouze u hlavn|fffd|ho |fffd|adatele
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = False
        
        ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label2.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label3.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label4.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label5.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label9.Visible = True
        
        Case 4
            'ZAM k|fffd|d
            ThisWorkbook.Sheets("1_Kalkulace").Label97_ZAM_kod_popis.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Visible = False ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox1_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Visible = False ': ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox2_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox3_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox2_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("Combobox5_kontrolka").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox6_kontrolka").Visible = False
        
        'p|fffd||fffd|jem ze zem|fffd| - visible pouze u hlavn|fffd|ho |fffd|adatele
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label97.Visible = False
        
        ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label1.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label2.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label3.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label4.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label5.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label9.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label11.Visible = False
        
        End Select
    
    'Propojen|fffd| sekce p|fffd||fffd|jmy |fffd|adatel|fffd| - p|fffd|evzat|fffd| |fffd||fffd|zen|fffd|
    ThisWorkbook.Sheets("Data ze vstupu").Range("R80").Value = ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value
    
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Visible = False
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Visible = False
    
    Row = 83
    Col = 21
        Select Case ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value
        Case 0
            'pokud p|fffd||fffd|jem
            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Visible = False
            
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
                    'skr|fffd|t, pokud ZAM verze (hlavn|fffd| je zad|fffd|n|fffd| p|fffd||fffd|jmu dle k|fffd|du)
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
                Else
                    'odkr|fffd|t = p|fffd||fffd|jem je povinn|fffd| |fffd|daj pro hlavn|fffd|ho |fffd|adatele
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = True
                End If
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Visible = True
        Case 1
            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Visible = False
            
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
                Else
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = True
                End If
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Visible = True
        Case 2
            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Visible = False
            
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
                Else
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = True
                End If
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Visible = True
        Case 3
            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Visible = False
            
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
                Else
                    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = True
                End If
            Label41.Visible = True
        Case 4
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox1
                .LinkedCell = ""
                .Value = False
            End With
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox8
                .LinkedCell = ""
                .Value = False
            End With
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox9
                .LinkedCell = ""
                .Value = False
            End With
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox10
                .LinkedCell = ""
                .Value = False
            End With
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox11
                .LinkedCell = ""
                .Value = False
            End With
            With ThisWorkbook.Sheets("1_Kalkulace").CheckBox12
                .LinkedCell = ""
                .Value = False
            End With
            
            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Visible = True
            
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("Obr|fffd|zek 24").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Label41.Visible = False
            
        
        End Select
    
                'p|fffd||fffd|jmy ze z|fffd|visl|fffd| |fffd|innosti
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21).Address
                'p|fffd||fffd|jmy dle da|fffd|ov|fffd|ho p|fffd|izn|fffd|n|fffd|
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21 + 1).Address
                'p|fffd||fffd|jmy dle obratu
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21 + 2).Address
                'p|fffd||fffd|jmy dle pau|fffd||fffd|lu
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21 + 3).Address
                'p|fffd||fffd|jmy pro extern|fffd| prodejce
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21 + 4).Address
                'ostatn|fffd| p|fffd||fffd|jmy
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.LinkedCell = "='Data ze vstupu'!" & Cells(83 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 21 + 5).Address
    'Pr|fffd|m|fffd|rn|fffd| m|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem CELKEM, editovateln|fffd|, pokud nejsou zatr|fffd|eny p|fffd||fffd|jmy jinak suma sekc|fffd| s detailn|fffd|mi p|fffd||fffd|jmy
        Row = 83
        Col = 29
        ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    '---------------------
    'P|fffd||fffd|jmy ze z|fffd|visl|fffd| |fffd|innosti
        'P|fffd||fffd|jmy za 1. m|fffd|s|fffd|c
        Row = 90
        Col = 21
        ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        'P|fffd||fffd|jmy za 2. m|fffd|s|fffd|c
        Row = 90
        Col = 22
        ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        'P|fffd||fffd|jmy za 3. m|fffd|s|fffd|c
        Row = 90
        Col = 23
        ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'P|fffd||fffd|jmy celkem
        Row = 90
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox17.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'P|fffd||fffd|jmy za 12 m|fffd|s|fffd|c|fffd|
        Row = 90
        Col = 25
        ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        
    '---------------------
    'Z|fffd|klad dan|fffd| ze z|fffd|visl|fffd| |fffd|innosti
        Row = 113
        Col = 21
        ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Z|fffd|klad dan|fffd| z podnik|fffd|n|fffd| (OSV|fffd|) - |fffd||fffd|dek 37
        Row = 113
        Col = 22
        ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Z|fffd|klad dan|fffd| z pron|fffd|jmu - |fffd||fffd|dek 39
        Row = 113
        Col = 23
        ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Z|fffd|klad dan|fffd| (ro|fffd|n|fffd| p|fffd||fffd|jmy celkem)
        Row = 113
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Da|fffd| celkem - |fffd||fffd|dek 74
        Row = 113
        Col = 25
        ThisWorkbook.Sheets("1_Kalkulace").TextBox44.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Zdravotn|fffd| poji|fffd|t|fffd|n|fffd|
        Row = 113
        Col = 26
        ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Soci|fffd|ln|fffd| poji|fffd|t|fffd|n|fffd| (nepovinn|fffd| nemocensk|fffd| poji|fffd|t|fffd|n|fffd| nen|fffd| zapo|fffd|teno)
        Row = 113
        Col = 27
        ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        '|fffd|ist|fffd| p|fffd||fffd|jem celkem za p|fffd||fffd|slu|fffd|n|fffd| zda|fffd|ovac|fffd| obdob|fffd|
        Row = 113
        Col = 28
        ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Odpisy nemovitosti (nutno konzultovat s pracovn|fffd|ky Retail Underwriting) P|fffd||fffd|loha |fffd|. 1/ odst. 2 A
        Row = 113
        Col = 29
        ThisWorkbook.Sheets("1_Kalkulace").TextBox48.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        '|fffd|ist|fffd| p|fffd||fffd|jem za p|fffd||fffd|slu|fffd|n|fffd| zda|fffd|ovac|fffd| obdob|fffd| v|fffd|etn|fffd| odpis|fffd|
        Row = 113
        Col = 30
        ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        '|fffd|IST|fffd| M|fffd|S|fffd||fffd|N|fffd| P|fffd||fffd|JEM
        Row = 113
        Col = 31
        ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
        'Kontroln|fffd| v|fffd|po|fffd|et dan|fffd|
        Row = 113
        Col = 32
        ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
    '---------------------
    'V|fffd|po|fffd|et p|fffd||fffd|jmu dle obratu
        Row = 102
        Col = 21
        ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ##")
        
        Row = 102
        Col = 22
        ThisWorkbook.Sheets("1_Kalkulace").TextBox18.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        
        Row = 102
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        
        Row = 102
        Col = 23
        ThisWorkbook.Sheets("1_Kalkulace").TextBox19.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    '---------------------
    'Pau|fffd||fffd|l stanoven|fffd| bankou  P|fffd||fffd|jmy podle |fffd|7 P|fffd||fffd|loha 1 DP (|fffd|. 101)
        Row = 121
        Col = 21
        ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        
        'P|fffd||fffd|jmy podle |fffd|9 P|fffd||fffd|loha 2 DP (|fffd|. 201)*
        Row = 121
        Col = 22
        ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
        
        'Pau|fffd||fffd|ln|fffd| sazba
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(121 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 23).Value, "## %")
        
        
        'Pau|fffd||fffd|l stanoven|fffd| bankou
        Row = 121
        Col = 24
        ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "## %")
        
        'M|fffd|s|fffd||fffd|n|fffd| p|fffd||fffd|jem podnikatele
        Row = 121
        Col = 25
        ThisWorkbook.Sheets("1_Kalkulace").TextBox31.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value, "### ### ###")
    
    '---------------------
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|ce
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 31).Value
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox21.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 32).Value
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox22.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 33).Value
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox23.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 34).Value
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox24.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 35).Value
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox25.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129 + ThisWorkbook.Sheets("1_kalkulace").TabStrip1.Value, 36).Value
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 1
    Row = 129
    Col = 21
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox52
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 2
    Row = 129
    Col = 22
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox53
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 3
    Row = 129
    Col = 23
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox54
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 4
    Row = 129
    Col = 24
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox56
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 5
    Row = 129
    Col = 25
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox57
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|c 6
    Row = 129
    Col = 26
    
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox58
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Externista celkem
    Row = 129
    Col = 27
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox55
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, Col).Value
        .Value = Format(.Value, "### ### ###")
    End With
    
    '---------------------
    'ostatn|fffd| p|fffd||fffd|jmy - typ, v|fffd||fffd|e p|fffd||fffd|jmu 1
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value
    ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 29).Value
    
    'ostatn|fffd| p|fffd||fffd|jmy - typ, v|fffd||fffd|e p|fffd||fffd|jmu 2
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value
    ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox37.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 33).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 34).Value
    
    'ostatn|fffd| p|fffd||fffd|jmy - typ, v|fffd||fffd|e p|fffd||fffd|jmu 3
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 36).Value
    ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 37).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 38).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 39).Value
    
    'ostatn|fffd| p|fffd||fffd|jmy - typ, v|fffd||fffd|e p|fffd||fffd|jmu 4
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 41).Value
    ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 42).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 43).Value, "### ### ###")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(137 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 44).Value
    
    'rozhodne jestli je pole p|fffd||fffd|jem editovateln|fffd|, nebo jestli je to suma
    Call prumernyMesicniPrijemSuma
    'Call zobrazeniPolePrijmy12Mesicu
    
    'nepovinn|fffd| p|fffd||fffd|jmy, pokud spolu|fffd|adatel je pouze ru|fffd|itel.
    '''t|fffd|m, |fffd|e spolu|fffd|adatel nemus|fffd| m|fffd|t p|fffd||fffd|jmy (m|fffd||fffd|e p|fffd|istupovat pouze kv|fffd|li SJM apod. tuto podm|fffd|nku s ru|fffd|itelem ru|fffd||fffd|me)
'''        If ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Value = "Ru|fffd|itel" Then
'''            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = False
'''        Else
'''            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox34_kontrolka").Visible = True
'''        End If
    
    'od|fffd|lut|fffd|n|fffd| pol|fffd| po tom, co se do nich zapsalo (on change, ale u|fffd| se nespustilo, |fffd|e maj b|fffd|t b|fffd|l|fffd| (lostfocus))
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox14.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox15.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox16.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox75.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Visible = False
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Visible = False
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox40.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox41.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox42.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox44.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox48.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox84.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox18.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox20.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox21.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox52.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox53.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox54.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox56.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox57.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox58.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox33.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox74.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox36.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox76.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox38.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox77.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox78.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox80.BackColor = vbWhite
    
            
    
    Application.ScreenUpdating = ScreenUpdatingStavPred
    End Sub
Private Sub domacnostiPoleVisible()
    'p|fffd||fffd|jmy zvolen|fffd| dom
    ThisWorkbook.Sheets("1_Kalkulace").Label14.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox13.Visible = True
    'po|fffd|et |fffd|len|fffd| dom
    ThisWorkbook.Sheets("1_Kalkulace").Label15.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox11_kontrolka").Visible = True
    'PS|fffd| dom
    ThisWorkbook.Sheets("1_Kalkulace").Label16.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox12_kontrolka").Visible = True
    
    'typ bydlen|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").Label17.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox3_kontrolka").Visible = True
    'zem|fffd| dom
    ThisWorkbook.Sheets("1_Kalkulace").Label19.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox1_kontrolka").Visible = True
    'celkov|fffd| p|fffd|ijmy dom
    ThisWorkbook.Sheets("1_Kalkulace").Label10.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox8.Visible = True
    
    'suma bank i nebank spl|fffd|tek
    ThisWorkbook.Sheets("1_Kalkulace").Label26.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox22.Visible = True
    'v|fffd||fffd|e spl|fffd|tky ru|fffd| z|fffd|vazku
    ThisWorkbook.Sheets("1_Kalkulace").Label27.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox23.Visible = True
    'ostatn|fffd| v|fffd|daje
    ThisWorkbook.Sheets("1_Kalkulace").Label31.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Visible = True
    'celkov|fffd| v|fffd||fffd|e nesplacen|fffd|ch |fffd|v|fffd|r|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").Label108.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox89.Visible = True
    
    'v|fffd|daje zvolen|fffd| dom|fffd|cnost|fffd| celkem
    ThisWorkbook.Sheets("1_Kalkulace").Label33.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox29.Visible = True
    
    'souhrn v tabulce dom|fffd|cnosti
    ThisWorkbook.Sheets("1_Kalkulace").ListBox3.Visible = False
    ThisWorkbook.Sheets("1_Kalkulace").ListBox4.Visible = False
    
    'suma limit|fffd| kreditn|fffd|ch karet
    ThisWorkbook.Sheets("1_Kalkulace").Label29.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox25.Visible = True
    'suma limit|fffd| kontokorentn|fffd|ch r|fffd|mc|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").Label30.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox26.Visible = True
    'v|fffd||fffd|ivn|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").Label28.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox24.Visible = True
    'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| CF t|fffd|to dom|fffd|cnosti
            'zam verze
            If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ZAM" Then
                'nic
            Else
                ThisWorkbook.Sheets("1_Kalkulace").Label34.Visible = True: ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Visible = True
            End If
    
End Sub
'--------------ThisWorkbook.Sheets("1_Kalkulace").TabStrip3 - dom|fffd|cnosti------------------
    Private Sub TabStrip3_podbarveni()
        'dom|fffd|cnost 1
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(245, 5).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost1").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost1").Fill.ForeColor.RGB = vbRed
        End If
        'dom|fffd|cnost 2
        If ThisWorkbook.Sheets("Data ze vstupu").Cells(245, 6).Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost2").Fill.ForeColor.RGB = vbGreen
            Else
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost2").Fill.ForeColor.RGB = vbRed
        End If
    End Sub

'------------------TABSTRIP 3 - DOM|fffd|CNOSTI---------------------------
    Private Sub TabStrip3_Change()
    ScreenUpdatingStavPred = Application.ScreenUpdating
    Application.ScreenUpdating = False
    
    Dim b As Integer
    b = ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value
    Select Case b
    'dom|fffd|cnost 1
    Case 0
    Call domacnostiPoleVisible
    
    'dom|fffd|cnost 2
    Case 1
    Call domacnostiPoleVisible
    
    'dom|fffd|cnost 3
    Case 2
    Call domacnostiPoleVisible
    
    'souhrn dom|fffd|cnosti
    Case 3
        'p|fffd||fffd|jmy zvolen|fffd| dom
        ThisWorkbook.Sheets("1_Kalkulace").Label14.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox13.Visible = False
        'po|fffd|et |fffd|len|fffd| dom
        ThisWorkbook.Sheets("1_Kalkulace").Label15.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox11_kontrolka").Visible = False
        'PS|fffd| dom
        ThisWorkbook.Sheets("1_Kalkulace").Label16.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("TextBox12_kontrolka").Visible = False
        
        'typ bydlen|fffd|
        ThisWorkbook.Sheets("1_Kalkulace").Label17.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox3_kontrolka").Visible = False
        'zem|fffd| dom
        ThisWorkbook.Sheets("1_Kalkulace").Label19.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox1_kontrolka").Visible = False
        'celkov|fffd| p|fffd|ijmy dom
        ThisWorkbook.Sheets("1_Kalkulace").Label10.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox8.Visible = False
        
        'suma bank i nebank spl|fffd|tek
        ThisWorkbook.Sheets("1_Kalkulace").Label26.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox22.Visible = False
        'v|fffd||fffd|e spl|fffd|tky ru|fffd| z|fffd|vazku
        ThisWorkbook.Sheets("1_Kalkulace").Label27.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox23.Visible = False
        'ostatn|fffd| v|fffd|daje
        ThisWorkbook.Sheets("1_Kalkulace").Label31.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Visible = False
        'celkov|fffd| v|fffd||fffd|e nesplacen|fffd|ch |fffd|v|fffd|r|fffd|
        ThisWorkbook.Sheets("1_Kalkulace").Label108.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox89.Visible = False
        
        'v|fffd|daje zvolen|fffd| dom|fffd|cnost|fffd| celkem
        ThisWorkbook.Sheets("1_Kalkulace").Label33.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox29.Visible = False
        
        'souhrn v listbox tabulce dom|fffd|cnosti
        ThisWorkbook.Sheets("1_Kalkulace").ListBox3.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").ListBox4.Visible = True
        
        'suma limit|fffd| kreditn|fffd|ch karet
        ThisWorkbook.Sheets("1_Kalkulace").Label29.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox25.Visible = False
        'suma limit|fffd| kontokorentn|fffd|ch r|fffd|mc|fffd|
        ThisWorkbook.Sheets("1_Kalkulace").Label30.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox26.Visible = False
        'v|fffd||fffd|ivn|fffd|
        ThisWorkbook.Sheets("1_Kalkulace").Label28.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox24.Visible = False
        'voln|fffd| m|fffd|s|fffd||fffd|n|fffd| CF t|fffd|to dom|fffd|cnosti
        ThisWorkbook.Sheets("1_Kalkulace").Label34.Visible = False: ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Visible = False
    
    End Select
    
    'po|fffd|et |fffd|len|fffd| v dom|fffd|cnosti -- kontrolka pol|fffd||fffd|ka
    Call textbox11_kontrolka_zmena
    
    'Hodnoty dom|fffd|cnosti - sekce
    
    'P|fffd||fffd|jmy dom|fffd|cnosti celkem
    Row = 145
    Col = 28
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox13
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti
    Row = 145
    Col = 29
    ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
    
    'PS|fffd| dom|fffd|cnosti
    Row = 145
    Col = 30
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox12
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ##")
    End With
    
    'Typ bydlen|fffd|
    Row = 145
    Col = 31
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
    
    'Zem|fffd|
    Row = 145
    Col = 32
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
    
    'V|fffd|daje dom|fffd|cnosti - sekce
    
    'Suma spl|fffd|tek bankovn|fffd|ch i nebankovn|fffd|ch ***
    'v|fffd|etn|fffd| |fffd|v|fffd|r|fffd| ze stavebn|fffd|ho spo|fffd|en|fffd| a spl|fffd|tek leasingu
    Row = 162
    Col = 26
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox22
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'V|fffd||fffd|e spl|fffd|tky ru|fffd|itelsk|fffd|ho z|fffd|vazku
    Row = 162
    Col = 27
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox23
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Ostatn|fffd| v|fffd|daje
    Row = 162
    Col = 28
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox27
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Celkov|fffd| v|fffd||fffd|e nesplacen|fffd|ch |fffd|v|fffd|r|fffd|
    Row = 162
    Col = 37
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox89
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Suma limit|fffd| kreditn|fffd|ch karet
    Row = 162
    Col = 29
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox25
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'Suma limit|fffd| Kontokorentn|fffd|ch r|fffd|mc|fffd|
    Row = 162
    Col = 30
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox26
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'V|fffd||fffd|ivn|fffd|
    Row = 162
    Col = 31
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox24
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'V|fffd|daje celkem
    Row = 162
    Col = 32
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox29
        .Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + b, Col).Value
        .Text = Format(.Text, "### ### ###")
    End With
    
    'V|fffd|daje dom|fffd|cnost|fffd||fffd||fffd||fffd| celkem
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox4
        .Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(167, 32).Value, 0)
        .Text = Format(.Text, "### ### ###")
    End With
    
    'p|fffd||fffd|jmy dom|fffd|cnost|fffd||fffd||fffd||fffd| celkem
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox8
        .Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(150, 28).Value, 0)
        .Text = Format(.Text, "### ### ###")
    End With
    
    'od|fffd|lut|fffd|n|fffd| pol|fffd| po tom, co se do nich zapsalo (on change, ale u|fffd| se nespustilo, |fffd|e maj b|fffd|t b|fffd|l|fffd| (lostfocus))
    ThisWorkbook.Sheets("1_Kalkulace").TextBox11.BackColor = vbWhite
    'ThisWorkbook.Sheets("1_Kalkulace").TextBox12.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox22.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox23.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox27.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox89.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox25.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox26.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox24.BackColor = vbWhite
    
    Application.ScreenUpdating = ScreenUpdatingStavPred
    End Sub
'--------------------------------------------

'------------DOM|fffd|CNOSTI a v|fffd|daje-------------
    Private Sub prijmyVsechDomacnostiSuma()
        'P|fffd||fffd|jmy T|fffd|TO dom|fffd|cnosti celkem
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox13
            .Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(145 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, 28).Value, 0)
            .Text = Format(.Value, "### ### ###")
        End With
        
        'p|fffd||fffd|jmy V|fffd|ECH dom|fffd|cnost|fffd||fffd||fffd||fffd| celkem
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox8
            .Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(150, 28).Value, 0)
            .Text = Format(.Value, "### ### ###")
        End With
    End Sub
    'Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti
    Private Sub TextBox11_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").TextBox11.BackColor = 12648447
    End Sub
    Private Sub textbox11_kontrolka_zmena()
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox11_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Value = "" Or ((ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = 0 And Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox11) < ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value) Or (ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = 1 And Val(ThisWorkbook.Sheets("1_Kalkulace").TextBox11) < ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value)) Then
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            Else
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            End If
            End With
    End Sub
    Private Sub TextBox11_Change()
            Call textbox11_kontrolka_zmena
        Row = 145
        Col = 29
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox11
                If .Value <> "" Then
                    If Not IsNumeric(.Value) Then
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .Value = ""
                            MsgBox "Vypl|fffd|te po|fffd|et |fffd|len|fffd| jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti"
                            'kontrola, aby bylo |fffd||fffd|slo jen na 2 m|fffd|sta
                        ElseIf Len(.Value) > 2 Then
                            .Value = Left(.Value, 2)
                        ElseIf Val(.Value) > 20 Then
                            .BackColor = vbRed
                            MsgBox "Do jedn|fffd| dom|fffd|cnosti lze zapo|fffd||fffd|tat pouze 20 |fffd|len|fffd|", vbCritical, "CHYBA - Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti"
                            .Value = ""
                        Else
                        .BackColor = 12648447
                        End If
                    End If
                End If
                ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                .Text = Format(.Value, "##")
            End With
        Call prijmyVsechDomacnostiSuma
        Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub TextBox11_LostFocus()
        Row = 145
        Col = 29
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox11
            If .Value <> "" Then
                    Select Case ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value
                    Case 0
                        If Val(.Value) < ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value Then
                            .BackColor = vbRed
                            MsgBox "Zkontrolujte po|fffd|et |fffd|len|fffd| dom|fffd|cnosti 1 minim|fffd|ln|fffd| by m|fffd|l b|fffd|t " & ThisWorkbook.Sheets("Data ze vstupu").Range("E255").Value & ", nebo zm|fffd||fffd|te |fffd||fffd|slo dom|fffd|cnosti spolu|fffd|adatele.", vbInformation, "UPOZORN|fffd|N|fffd| - Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti"
                            '.Value = ""
                            '.Activate
                        End If
                    Case 1
                        If Val(.Value) < ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value Then
                            .BackColor = vbRed
                            MsgBox "Zkontrolujte po|fffd|et |fffd|len|fffd| dom|fffd|cnosti minim|fffd|ln|fffd| by m|fffd|l b|fffd|t " & ThisWorkbook.Sheets("Data ze vstupu").Range("F255").Value & ", nebo zm|fffd||fffd|te |fffd||fffd|slo dom|fffd|cnosti spolu|fffd|adatele.", vbInformation, "UPOZORN|fffd|N|fffd| - Po|fffd|et |fffd|len|fffd| dom|fffd|cnosti"
                            '.Value = ""
                            '.Activate
                        End If
                    End Select
                    
                'If Val(.Value) < ComboBox11.Value And ThisWorkbook.Sheets("Data ze vstupu").Range("X36").Value = 1 Then
        
                    .BackColor = 12648447
                    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                    .Text = Format(.Value, "##")
            End If
        End With
    ThisWorkbook.Sheets("1_Kalkulace").TextBox11.BackColor = vbWhite
    Call TabStrip1_podbarveni
    Call TabStrip3_podbarveni
    End Sub
    Private Sub TextBox12_GotFocus()
    'PS|fffd| dom|fffd|cnost|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").TextBox12.BackColor = 12648447
    End Sub
    Private Sub TextBox12_Change()

    Row = 145
    Col = 30
        With ThisWorkbook.Sheets("1_Kalkulace").TextBox12
            If .Value <> "" And Not IsNumeric(.Value) Then
                .Value = ""
                .BackColor = vbRed
                '.Activate
            Else
                If Val(.Value) < 0 Then
                    .Value = ""
                    MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| PS|fffd|", vbCritical, "CHYBA - PS|fffd|"
                    'kontrola, aby bylo |fffd||fffd|slo jen na 5 m|fffd|st + 1 mezery = 6
                ElseIf Len(.Value) > 6 Then
                    .Value = Left(.Value, 6)
                End If
                    .BackColor = 12648447
                    ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                    .Text = Format(.Value, "### ##")
            End If
        End With
        
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox12_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Value <> "" And ThisWorkbook.Sheets("Seznamy").Cells(181 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, 16).Value <> "neplatn|fffd| PS|fffd| dom|fffd|cnosti" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
    End Sub
    Private Sub TextBox12_LostFocus()
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox12
    If .Value <> "" Then
        If Len(.Value) < 6 Then
            .BackColor = vbRed
            MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|esk|fffd| PS|fffd|", vbCritical, "CHYBA - PS|fffd|"
            .Activate
        End If
    End If
    
    'kontrola, aby bylo |fffd||fffd|slo jen na 5 m|fffd|st + 1 mezery = 6
                
    .BackColor = vbWhite
        Row = 145
        Col = 30
        
            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
            .Text = Format(.Value, "### ##")
        End With
    Call vydajeDomacnostiAktualizace
    Call TabStrip1_podbarveni
    Call TabStrip3_podbarveni
    End Sub
    Private Sub ComboBox3_GotFocus()
    'typ bydlen|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.BackColor = 12648447
    End Sub
    Private Sub ComboBox3_Change()
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox3_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox3
            If .Text <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C126:C132"), 1, False)) Then
                    .BackColor = vbRed
                    .Text = Left(.Text, Len(.Text) - 1)
                    .Activate
                Else
'                    .BackColor = 12648447
                End If
            End If
        End With
    End Sub
    Private Sub ComboBox3_LostFocus()
    'typ bydlen|fffd|
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox3
            If .Text <> "" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C126:C132"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte typ bydlen|fffd| ze seznamu", vbCritical, "CHYBA - Typ bydlen|fffd|"
                    .Value = ""
                    .Activate
                End If
            End If
            .BackColor = vbWhite
            Row = 145
            Col = 31
            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = .Value
            Call vydajeDomacnostiAktualizace
            Call TabStrip1_podbarveni
            Call TabStrip3_podbarveni
        End With
    End Sub
    Private Sub ComboBox1_GotFocus()
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.BackColor = 12648447
    End Sub
    Private Sub ComboBox1_Change()
            With ThisWorkbook.Sheets("1_Kalkulace").Shapes("ComboBox1_kontrolka")
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Value <> "" Then
                .Fill.ForeColor.RGB = RGB(0, 255, 0)
                .AutoShapeType = 9
            Else
                .Fill.ForeColor.RGB = RGB(255, 0, 0)
                .AutoShapeType = 34
            End If
            End With
    'zem|fffd|
    With ThisWorkbook.Sheets("1_Kalkulace").ComboBox1
        If .Text <> "" Then
            If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C205:C221"), 1, False)) Then
                .BackColor = vbRed
                .Text = Left(.Text, Len(.Text) - 1)
                .Activate
            Else
'                .BackColor = 12648447
                    'With ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox12_kontrolka")
                    If .Value <> "|fffd|esk|fffd| republika" Then
                        '.Fill.ForeColor.RGB = RGB(0, 255, 0)
                        '.AutoShapeType = 9
                        ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox12_kontrolka").Visible = False
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Enabled = False
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox12.BackColor = 15066597
                    Else
                        '.Fill.ForeColor.RGB = RGB(255, 0, 0)
                        '.AutoShapeType = 34
                        ThisWorkbook.Sheets("1_Kalkulace").Shapes("Textbox12_kontrolka").Visible = True
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Enabled = True
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox12.BackColor = vbWhite
                    End If
                    'End With
                        Row = 145
                        Col = 32
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = .Value
                        Call vydajeDomacnostiAktualizace
                        Call TabStrip1_podbarveni
                        Call TabStrip3_podbarveni
            End If
        End If
    End With
    End Sub
    Private Sub ComboBox1_LostFocus()
    'zem|fffd|
        With ThisWorkbook.Sheets("1_Kalkulace").ComboBox1
            If .Text <> "|fffd|esk|fffd| republika" Then
                If IsError(Application.VLookup(.Value, ThisWorkbook.Sheets("Seznamy").Range("C205:C221"), 1, False)) Then
                    .BackColor = vbRed
                    MsgBox "Vyberte zemi ze seznamu", vbCritical, "CHYBA - Zem|fffd|"
                    .Value = "|fffd|esk|fffd| republika"
                    .Activate
                End If
            End If
            .BackColor = vbWhite
            'Row = 145
            'Col = 32
            'ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = .Value
        End With
End Sub
'--------------------------------------------

'------------------V|fffd|DAJE--------------------
    Private Sub Textbox22_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox22.BackColor = 12648447
    End Sub
    Private Sub TextBox22_Change()
    'Suma spl|fffd|tek bankovn|fffd|ch i nebankovn|fffd|ch ***
    'v|fffd|etn|fffd| |fffd|v|fffd|r|fffd| ze stavebn|fffd|ho spo|fffd|en|fffd| a spl|fffd|tek leasingu
    Row = 162
    Col = 26
    'Kontrola hodnoty vstupu
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox22
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Suma bankovn|fffd|ch i nebankovn|fffd|ch spl|fffd|tek"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub Textbox22_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox22.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox23_GotFocus()
    'V|fffd||fffd|e spl|fffd|tky ru|fffd|itelsk|fffd|ho z|fffd|vazku
    ThisWorkbook.Sheets("1_Kalkulace").TextBox23.BackColor = 12648447
    End Sub
    Private Sub TextBox23_Change()
    Row = 162
    Col = 27
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox23
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - V|fffd||fffd|e spl|fffd|tky ru|fffd|itelsk|fffd|ho z|fffd|vazku"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub Textbox23_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox23.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox24_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox24.BackColor = 12648447
    End Sub
    Private Sub TextBox24_Change()
    'V|fffd||fffd|ivn|fffd|
    Row = 162
    Col = 31
            'Kontrola hodnoty vstupu
                With ThisWorkbook.Sheets("1_Kalkulace").TextBox24
                    If .Value <> "" And Not IsNumeric(.Value) Then
                        'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                        .Value = ""
                        .BackColor = vbRed
                        '.Activate
                    Else
                        If Val(.Value) < 0 Then
                            .BackColor = vbRed
                            MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - V|fffd||fffd|ivn|fffd|"
                            .Value = ""
                            'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                        ElseIf Len(.Value) > 11 Then
                            .Value = Left(.Value, 11)
                        Else
                            .BackColor = 12648447
                        End If
                            ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                            .Text = Format(.Value, "### ### ##0")
                    End If
                End With
    Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub Textbox24_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox24.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox25_GotFocus()
    'Suma limit|fffd| kreditn|fffd|ch karet
    ThisWorkbook.Sheets("1_Kalkulace").TextBox25.BackColor = 12648447
    End Sub
    Private Sub TextBox25_Change()
    Row = 162
    Col = 29
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox25
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Suma limit|fffd| kreditn|fffd|ch karet"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub Textbox25_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox25.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub
    Private Sub Textbox26_GotFocus()
    'Suma limit|fffd| kontokorentn|fffd|ch r|fffd|mc|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").TextBox26.BackColor = 12648447
    End Sub
    Private Sub TextBox26_Change()
    Row = 162
    Col = 30
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox26
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Suma limit|fffd| kontokorentn|fffd|ch r|fffd|mc|fffd|"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    Call vydajeDomacnostiAktualizace
    End Sub
    Private Sub Textbox26_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox26.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub

'info n|fffd|pov|fffd|da - hint
Private Sub Obr|fffd|zek27_Klepnut|fffd|()
ThisWorkbook.Sheets("1_Kalkulace").infoVydajeOstatniTextbox.Visible = True
ThisWorkbook.Sheets("1_Kalkulace").infoVydajeOstatniTextbox.Text = "Info: V|fffd|echny ostatn|fffd| v|fffd|daje"
ThisWorkbook.Sheets("1_Kalkulace").infoVydajeOstatniTextbox.Activate
End Sub
Private Sub infoVydajeOstatniTextbox_LostFocus()
ThisWorkbook.Sheets("1_Kalkulace").infoVydajeOstatniTextbox.Visible = False
End Sub
    Private Sub Textbox27_GotFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox27.BackColor = 12648447
    End Sub
    Private Sub TextBox27_Change()
    'Ostatn|fffd| v|fffd|daje
    Row = 162
    Col = 28
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox27
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| v|fffd|daje"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    Call vydajeDomacnostiAktualizace
    End Sub
    
    Private Sub Textbox27_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox27.BackColor = vbWhite
    Call TabStrip1_podbarveni
    End Sub
    Private Sub TextBox89_GotFocus()
     ThisWorkbook.Sheets("1_Kalkulace").TextBox89.BackColor = 12648447
    End Sub
    Private Sub TextBox89_Change()
        'Celkov|fffd| v|fffd||fffd|e nesplacen|fffd|ch |fffd|v|fffd|r|fffd|
        Row = 162
        Col = 37
            With ThisWorkbook.Sheets("1_Kalkulace").TextBox89
                If .Value <> "" And Not IsNumeric(.Value) Then
                    'MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - P|fffd||fffd|jem ze z|fffd|visl|fffd| |fffd|innosti - 1. m|fffd|s|fffd|c"
                    .Value = ""
                    .BackColor = vbRed
                    '.Activate
                Else
                    If Val(.Value) < 0 Then
                        .BackColor = vbRed
                        MsgBox "Vypl|fffd|te jako nez|fffd|porn|fffd| |fffd||fffd|slo", vbCritical, "CHYBA - Ostatn|fffd| v|fffd|daje"
                        .Value = ""
                        'kontrola, aby bylo |fffd||fffd|slo jen na 9 m|fffd|st + 2 mezery = 11
                    ElseIf Len(.Value) > 11 Then
                        .Value = Left(.Value, 11)
                    Else
                        .BackColor = 12648447
                    End If
                        ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value = Round(Val(.Value), 0)
                        .Text = Format(.Value, "### ### ##0")
                End If
            End With
    End Sub
    Private Sub TextBox89_LostFocus()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox89.BackColor = vbWhite
    End Sub
Private Sub vydajeDomacnostiAktualizace()
    'V|fffd|daje celkem
    'v|fffd|daje t|fffd|to dom|fffd|cnosti
    ThisWorkbook.Sheets("1_Kalkulace").TextBox29.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(162 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, 32).Value, "### ### ###")
    'voln|fffd| CashFlow t|fffd|to dom|fffd|cnosti
    ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(162 + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, 36).Value, "### ### ###")
    'v|fffd|daje v|fffd|ech dom|fffd|cnost|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").TextBox4.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(167, 32).Value, "### ### ###")
    'Voln|fffd| CashFlow V|fffd|ECH dom|fffd|cnost|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").TextBox5.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Cells(167, 36).Value, "### ### ###")
    'aktualizovat produkty 2v1
    Call aktualizovatLimity2v1
End Sub
'    Private Sub TextBox29_LostFocus()
'    'V|fffd|daje celkem
'    Row = 162
'    Col = 32
'    'v|fffd|daje t|fffd|to dom|fffd|cnosti
'    TextBox29.Text = Format(Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value, Col).Value, 0), "### ### ###")
'    End Sub

Private Sub aktualizovatLimity2v1()
    ThisWorkbook.Sheets("1_Kalkulace").TextBox81.LinkedCell = "=Seznamy!K433"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox82.LinkedCell = "=Seznamy!K434"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox83_kreditniKarta2v1.LinkedCell = "=Seznamy!P434"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox84_kontokorent2v1.LinkedCell = "=Seznamy!T434"
End Sub

'
'
'-----sekce na posun tabul|fffd|torem-----
Private Sub ComboBox4_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox87.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Activate
            ActiveWindow.SmallScroll Down:=62
        End If
    End If
End Sub
Private Sub TextBox87_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox86.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Activate
        End If
    End If
End Sub
Private Sub TextBox86_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox87.Activate
        End If
    End If
End Sub

Private Sub TextBox71_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox86.Activate
        End If
    End If
End Sub
Private Sub ComboBox26_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Activate
        End If
    End If
End Sub

Private Sub TextBox72_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Activate
        End If
    End If
End Sub
Private Sub TextBox70_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Activate
        End If
    End If
End Sub
Private Sub TextBox73_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox6.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Activate
        End If
    End If
End Sub
Private Sub TextBox6_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Activate
        End If
    End If
End Sub
Private Sub ComboBox12_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Activate
        ElseIf Shift = 1 Then
'''            If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") = "ESC" Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox6.Activate
'''            Else
'''                ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Activate
'''                'posunout okno dolu
'''                ActiveWindow.SmallScroll Down:=62
'''            End If
        End If
    End If
End Sub
Private Sub ComboBox13_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
        End If
    End If
End Sub
Private Sub TextBox9_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Enabled = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Activate
            End If
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Activate
        End If
    End If
End Sub
Private Sub TextBox10_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
        End If
    End If
End Sub
Private Sub TextBox28_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
        End If
    End If
End Sub
Private Sub TextBox59_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Activate
        End If
    End If
End Sub
Private Sub ComboBox14_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Activate
        ElseIf Shift = 1 Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Enabled = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
            End If
        End If
    End If
End Sub
Private Sub TextBox60_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Activate
        End If
    End If
End Sub
Private Sub TextBox61_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Activate
        End If
    End If
End Sub
Private Sub ComboBox15_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Activate
        End If
    End If
End Sub
Private Sub ComboBox16_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Activate
        End If
    End If
End Sub
Private Sub TextBox63_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
'Datum (zah|fffd|jen|fffd|) |fffd|erp|fffd|n|fffd|
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Activate
        End If
    End If
End Sub
Private Sub TextBox64_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
        End If
    End If
End Sub
Private Sub TextBox62_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
        End If
    End If
End Sub
Private Sub ComboBox17_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
        End If
    End If
End Sub
Private Sub ComboBox18_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Activate
        End If
    End If
End Sub

Private Sub TextBox65_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Activate
        End If
    End If
End Sub
Private Sub TextBox66_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
        End If
    End If
End Sub
Private Sub TextBox67_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
        End If
    End If
End Sub
Private Sub TextBox68_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
        End If
    End If
End Sub
'sekce klient
Private Sub ComboBox11_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
        End If
    End If
End Sub
Private Sub TabStrip1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Activate
        End If
    End If
End Sub
Private Sub TextBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Activate
        End If
    End If
End Sub
Private Sub TextBox2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Activate
        End If
    End If
End Sub
Private Sub TextBox3_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Activate
        End If
    End If
End Sub
Private Sub TextBox7_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Activate
        End If
    End If
End Sub
Private Sub ComboBox2_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    'v|fffd|ichni krom hlavn|fffd|ho |fffd|adatele
        If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
            If Shift = 0 Then
                If ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible Then
                    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Activate
                ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible Then
                    ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Activate
                Else
                    If ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True Then
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Activate
                    ElseIf ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Enabled = True Then
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Activate
                    Else
                        ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
                    End If
                End If
            ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Activate
            End If
        End If
    
End Sub

Private Sub ComboBox5_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Activate
        ElseIf Shift = 1 Then ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
        End If
    End If
End Sub
Private Sub ComboBox6_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
        'v|fffd|ichni krom hlavn|fffd|ho |fffd|adatele
        If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
            If Shift = 0 Then
                    If ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True Then
                        ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Activate
                    Else
                        If ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Enabled = True Then
                            ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Activate
                        Else
                            ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
                        End If
                    End If
            ElseIf Shift = 1 Then
                If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value <> 0 Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
                End If
            End If
        End If
End Sub
Private Sub TextBox69_ZAM_kod_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
            If Shift = 0 Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Enabled = True Then
                    ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Activate
                Else
                    ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
                End If
            ElseIf Shift = 1 Then
                If ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value <> 0 Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
                End If
            End If
    End If
End Sub

Private Sub TextBox34_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
        ElseIf Shift = 1 Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Activate
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Activate
            ElseIf ComboBox5.Visible Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
            End If
        End If
    End If
End Sub
Private Sub CheckBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
            End If
        ElseIf Shift = 1 Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Enabled = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Activate
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Activate
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Visible Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Activate
            ElseIf ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Visible Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Activate
            End If
        End If
    End If
End Sub

Private Sub TextBox14_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Activate
        Else
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
        End If
    ElseIf Shift = 1 Then
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
    End If
End If
End Sub
Private Sub TextBox15_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Activate
        Else
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
        End If
    ElseIf Shift = 1 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Activate
        Else
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
        End If
    End If
End If
End Sub
Private Sub TextBox16_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
            End If
        Else
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
        End If
    ElseIf Shift = 1 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Activate
        Else
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
        End If
    End If
End If
End Sub
Private Sub TextBox75_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
    ElseIf Shift = 1 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Activate
        Else
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
        End If
    End If
End If
End Sub
Private Sub CheckBox8_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
    If Shift = 0 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Activate
        Else
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
        End If
    ElseIf Shift = 1 Then
        If ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = True Then
            If ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Visible = True Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Activate
            Else
            ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Activate
            End If
        Else
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Activate
        End If
    End If
End If
End Sub

Private Sub TextBox40_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        ElseIf Shift = 1 Then
        ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
        End If
    End If
End Sub
Private Sub TextBox41_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox42_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox44.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox44_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox48.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox48_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox44.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
           End If
        End If
    End If
End Sub
Private Sub CheckBox9_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox48.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox84_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox18.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
           End If
        ElseIf Shift = 1 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
        End If
    End If
End Sub
Private Sub TextBox18_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox88_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox18.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        End If
    End If
End Sub
Private Sub CheckBox10_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Activate
           Else
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") <> "ESC" Then
                 ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
                Else
                 ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
                End If
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox20_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        ElseIf Shift = 1 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
        End If
    End If
End Sub
Private Sub TextBox21_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
           End If
        End If
    End If
End Sub
Private Sub ComboBox7_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
           End If
        End If
    End If
End Sub
Private Sub CheckBox11_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
           End If
        End If
    End If
End Sub
Private Sub ComboBox20_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox52.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
        End If
    End If
End Sub

Private Sub TextBox52_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox53.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox20.Activate
        End If
    End If
End Sub
Private Sub TextBox53_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox54.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox52.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox54_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox56.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox53.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox56_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox57.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox54.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox57_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox58.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox56.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox58_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox57.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
           End If
        End If
    End If
End Sub
Private Sub CheckBox12_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox58.Activate
           Else
                If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") <> "ESC" Then
                 ThisWorkbook.Sheets("1_Kalkulace").CheckBox11.Activate
                Else
                 ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Activate
                End If
           End If
        End If
    End If
End Sub
Private Sub ComboBox8_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
        End If
    End If
End Sub
Private Sub TextBox33_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox74_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Activate
           Else
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
    
Private Sub ComboBox9_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox36_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox76_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Activate
           Else
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub ComboBox10_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox38_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox77_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Activate
           Else
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub ComboBox19_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox78_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
           End If
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox80_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
           ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Activate
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TabStrip3_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Activate
        ElseIf Shift = 1 Then
           If ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = True Then
                If ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Visible = True Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Activate
                Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Activate
                End If
           Else
           ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Activate
           End If
        End If
    End If
End Sub
Private Sub TextBox11_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Value <> "|fffd|esk|fffd| republika" Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Activate
            End If
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Activate
        End If
    End If
End Sub
Private Sub TextBox12_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Activate
        End If
    End If
End Sub
Private Sub ComboBox3_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Activate
        ElseIf Shift = 1 Then
            If ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Value <> "|fffd|esk|fffd| republika" Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Activate
            Else
                ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Activate
            End If
        End If
    End If
End Sub
Private Sub ComboBox1_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox22.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Activate
        End If
    End If
End Sub
'sekce v|fffd|daje
Private Sub TextBox22_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox23.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Activate
        End If
    End If
End Sub
Private Sub TextBox23_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox24.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox22.Activate
        End If
    End If
End Sub
Private Sub TextBox24_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox89.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox23.Activate
        End If
    End If
End Sub
Private Sub TextBox25_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox26.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox89.Activate
        End If
    End If
End Sub
Private Sub TextBox26_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Activate
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox25.Activate
        End If
    End If
End Sub
Private Sub TextBox27_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            'posunout okno nahoru
            ActiveWindow.SmallScroll Down:=-100
'''            If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") = "ESC" Then
                ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Activate
'''            Else
'''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
'''            End If
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox26.Activate
        End If
    End If
End Sub
Private Sub TextBox89_KeyDown(ByVal KeyCode As MSForms.ReturnInteger, ByVal Shift As Integer)
    If KeyCode = vbKeyTab Or KeyCode = vbKeyReturn Then
        If Shift = 0 Then
            'posunout okno nahoru
            'ActiveWindow.SmallScroll Down:=-100
'''            If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") = "ESC" Then
                ThisWorkbook.Sheets("1_Kalkulace").TextBox25.Activate
'''            Else
'''                ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
'''            End If
        ElseIf Shift = 1 Then
            ThisWorkbook.Sheets("1_Kalkulace").TextBox24.Activate
        End If
    End If
End Sub




Attribute VB_Name = "List55"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit
Sub CestneProhlaseniKonsolidacePdf()
            Dim pocet_radku
            Dim radek
            Dim nazev_souboru
            Dim SaveAsName
            Dim ulozeny_word
            Dim novy_dokument
            
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu
            pocet_radku = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D7").Value - 1  'ale pozor, m|fffd|nus 1, proto|fffd|e pole za|fffd||fffd|n|fffd| od nuly
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Visible = True
            ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("C9").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''LOOP na hodnoty
            
                    ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Select
                    ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9").Select
                    
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    nazev_souboru = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D5").Value
                                        
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
'                      If ThisWorkbook.Sheets("DoplneniZadosti").Range("D3").Value = "TOP UP" Then
'                            ActiveSheet.Shapes.Range(Array("DoplneniZadosti-TOPUP")).Select
'                      Else
                            ActiveSheet.Shapes.Range(Array("CestneProhlaseniKonsolidaceWord")).Select
'                      End If
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                        wd.Visible = True
                        'wd.Visible = False
                    
                    Dim podslozka As String
                    podslozka = ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D4").Value
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\" & podslozka) Then MkDir "C:\" & podslozka
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\" & podslozka & "\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 'novy_dokument.Visible = False
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku
                                'kdy|fffd| nen|fffd| cizinec - odstranit odstavec "hodnota |fffd||fffd|stky, ...se m|fffd||fffd|e zm|fffd|nit "
'                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
'                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
'                                    .Selection.Rows.Delete
'                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
'                                End If
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
            
                        SaveAsName = "C:\" & podslozka & "\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (= |fffd|e|fffd|en|fffd| |fffd|skal|fffd|, pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Saved = True
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.documents(1).Saved = True
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
'            If ThisWorkbook.Sheets("A_Predbezna_nabidka").Range("C10").Value <> "Servis" Then
                ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Visible = False
                ThisWorkbook.Sheets("3_Konsolidace").Select
'            End If
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
''                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|en|fffd| dokument PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
                        MsgBox "K vygenerov|fffd|n|fffd| je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| dokument."
                        wd.documents(1).Close
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select

                 Resume EndTry1

                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub

Attribute VB_Name = "List58"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = "mival"
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas4").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas4").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas4").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas4").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPR3()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = "mival"
            'ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas3").Range("D1").Value - 1
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas3").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas3").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas3").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas3").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas3").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas3").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas3").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas3").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas3").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas3").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas3").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas3").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku 'm|fffd|nus 1, proto|fffd|e pole od nuly
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
            
            
            'vymazat dle po|fffd|tu |fffd|adatel|fffd| 1= vymazat 4, 3, 2
                    'If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    'Dim pocetSekci As Integer
                    'pocetSekci = .documents(1).Sections.Count
'                    If ThisWorkbook.Sheets("GDPR-souhlas3").Value = 3 Then
'                        .documents(1).Sections(4).Range.Delete
'                        .documents(1).Bookmarks("\EndOfDoc").Select
'                        With novy_dokument.Selection
'                            .EndKey
'                            .TypeBackspace
'                        End With
'                    End If
            '        dle po|fffd|tu |fffd|adatel|fffd| 2= vymazat 4, 3
            '        dle po|fffd|tu |fffd|adatel|fffd| 3= vymazat 4
            
            
            
                        'SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        'wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("GDPR-souhlas3").Visible = False
            
            'ThisWorkbook.Protect (abc)
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List59"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = "mival"
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas4").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas4").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas4").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas4").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPR4()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = "mival"
            'ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas4").Range("D1").Value - 1
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas4").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas4").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas4").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas4").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas4").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas4").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas4").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas4").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas4").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas4").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas4").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas4").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku 'm|fffd|nus 1, proto|fffd|e pole od nuly
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
            
            
            'vymazat dle po|fffd|tu |fffd|adatel|fffd| 1= vymazat 4, 3, 2
                    'If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    'Dim pocetSekci As Integer
                    'pocetSekci = .documents(1).Sections.Count
'                    If ThisWorkbook.Sheets("GDPR-souhlas4").Value = 3 Then
'                        .documents(1).Sections(4).Range.Delete
'                        .documents(1).Bookmarks("\EndOfDoc").Select
'                        With novy_dokument.Selection
'                            .EndKey
'                            .TypeBackspace
'                        End With
'                    End If
            '        dle po|fffd|tu |fffd|adatel|fffd| 2= vymazat 4, 3
            '        dle po|fffd|tu |fffd|adatel|fffd| 3= vymazat 4
            
            
            
                        'SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        'wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("GDPR-souhlas4").Visible = False
            
            'ThisWorkbook.Protect (abc)
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Sub NabidkaPdf()
'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku

'potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
End If

'nab|fffd|dka CZ
Call ThisWorkbook.Sheets("HU_nabidka").NabidkaCZ

'rusk|fffd| nab|fffd|dka
If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
   Call ThisWorkbook.Sheets("HU_nabidka").NabidkaRU
End If


End Sub
            
            Sub NabidkaCZ()
            On Error GoTo ErrHandler:
            
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = 35
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
            '''pole_popisky_pro_word(2) = 'klient_jm'
            '''pole_popisky_pro_word(3) = ..
            ReDim pole_popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("HU_nabidka").Visible = True
            ThisWorkbook.Sheets("HU_nabidka").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("HU_nabidka").Range("C8").Select
                ThisWorkbook.Sheets("HU_nabidka").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               pole_popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_radek(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("HU_nabidka").Select
                        ''If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("HU_nabidka").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("HU_nabidka").Range("D8").Select
                            ThisWorkbook.Sheets("HU_nabidka").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_radek(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("HU_nabidka").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("HU_nabidka").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("HU_nabidka").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("Nabidka")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    rok_mesic = Range("A3")
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            .documents(1).Saved = True
                            '''.ActiveWindow.Close
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku - 1 'm|fffd|nus 1, proto|fffd|e v posledn|fffd|m sloupci m|fffd|m n|fffd|zev souboru
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                            
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
                        .documents(1).Saved = True
            
                        SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("HU_nabidka").Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou nab|fffd|dku PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
            End Sub
        Sub NabidkaRU()
        
        On Error GoTo ErrHandler:
        'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
        pocet_radku = 34
        
           Dim ScreenUpdatingStavPred As Boolean
           ScreenUpdatingStavPred = Application.ScreenUpdating
           Application.ScreenUpdating = False
        
        'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
        '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
        '''pole_popisky_pro_word(1) = 'datum_vyhotoveni'
        '''pole_popisky_pro_word(2) = 'klient_jm'
        '''pole_popisky_pro_word(3) = ..
        ReDim pole_popisky_pro_word(pocet_radku) As String
        
        ThisWorkbook.Sheets("HU_nabidka_RU").Visible = True
        ThisWorkbook.Sheets("HU_nabidka_RU").Select
        
        'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
            'ThisWorkbook.Sheets("HU_nabidka_RU").Range("C8").Select
            ThisWorkbook.Sheets("HU_nabidka_RU").Range("C8").Select
        ActiveCell.Offset(0, 0).Range("A1").Select
        For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
           pole_popisky_pro_word(radek) = ActiveCell.Value
           ActiveCell.Offset(1, 0).Range("A1").Select
           Next radek
        
        'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
        ReDim pole_radek(pocet_radku) As String
        
        ''sem d|fffd|t LOOP na nab|fffd|dku_RU
        
                ThisWorkbook.Sheets("HU_nabidka_RU").Select
                    ''If ThisWorkbook.Sheets("HU_nabidka_RU").Range("E6").Value = "generuji" Then
                        'ThisWorkbook.Sheets("HU_nabidka_RU").Range("E8").Select
                        ThisWorkbook.Sheets("HU_nabidka_RU").Range("E8").Select
                    ''Else
                    ''    ThisWorkbook.Sheets("HU_nabidka_RU").Range("D8").Select
                    ''End If
        
                'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                ActiveCell.Offset(0, 0).Range("A1").Select
                For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                   pole_radek(radek) = ActiveCell.Value
                   ActiveCell.Offset(1, 0).Range("A1").Select
                   Next radek
        
                'n|fffd|zev souboru
                '''nazev_souboru = "nabidka-hypotecniho-uveru"
                    ''If ThisWorkbook.Sheets("HU_nabidka_RU").Range("E6").Value = "generuji" Then
                        nazev_souboru = ThisWorkbook.Sheets("HU_nabidka_RU").Range("E7").Value
                    ''Else
                    ''  nazev_souboru = ThisWorkbook.Sheets("HU_nabidka_RU").Range("D7").Value
                    ''End If
                
                'prom|fffd|nn|fffd| z Excelu
                Dim wd As Object
                'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                'otev|fffd|en|fffd| objektu (jm|fffd|no)
                  'kdy|fffd|
                    If ThisWorkbook.Sheets("HU_nabidka_RU").Range("E6").Value = "generuji" Then
                        ActiveSheet.Shapes.Range(Array("NabidkaRU")).Select
                    Else
                        ActiveSheet.Shapes.Range(Array("Nabidka")).Select
                    End If
                  Selection.Verb Verb:=xlOpen
                  Application.ScreenUpdating = False
                 
                 'p|fffd|i|fffd|azen|fffd| instance wordu
                Set wd = GetObject(class:="Word.Application")
                    'wd.WindowState = wdWindowStateMinimize
                     wd.Visible = True
                
                
                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                rok_mesic = Range("A3")
                ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
                
                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"
                        'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                    With wd
                        .documents(1).SaveAs FileName:=SaveAsName
                        .documents(1).Saved = True
                        '''.ActiveWindow.Close
                        .documents(1).Close SaveChanges:=False
                    End With
                         
                        'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                         Set ulozeny_word = GetObject(SaveAsName)
                        'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                         Set novy_dokument = ulozeny_word.Application
                             novy_dokument.Visible = True
                             
                    With novy_dokument
                    'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                        For radek = 0 To pocet_radku - 1 'm|fffd|nus 1, proto|fffd|e v posledn|fffd|m sloupci m|fffd|m n|fffd|zev souboru
                                If pole_radek(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(pole_popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_radek(radek)
                                End If
                        Next radek
            
                    .documents(1).SaveAs FileName:=SaveAsName
                    .documents(1).Saved = True
        
                    SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
                        '17 is the value of the symbolic constant wdFormatPDF.
                    wd.ActiveDocument.SaveAs SaveAsName, 17
                        'novy_dokument.SaveAs SaveAsName, 17
                        
                        ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                        '.ActiveWindow.Close
                     End With
        
        ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
        
        
konec:
        'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
            
            If wd.documents.Count > 1 Then
                wd.documents(1).Close SaveChanges:=True
                Else
                wd.Quit SaveChanges:=True
            End If
        
        Set wd = Nothing
        Set ulozeny_word = Nothing
        Set novy_dokument = Nothing
        
        ThisWorkbook.Sheets("HU_nabidka_RU").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Select
        Application.ScreenUpdating = ScreenUpdatingStavPred
        
        ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
        '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
        ''    Select Case YesNo
        ''    Case vbYes
            myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
        ''    Case vbNo
        ''    End Select
        
ErrHandler:
             ' error handling code
                Select Case Err.Number
                Case 0
                Case 20
                Case 4198
                    MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou nab|fffd|dku PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                Case 5153
        '            wd.ActiveWindow.Close
        '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                Case Else
                    MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                End Select
             
             Resume EndTry1
            
            'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
            On Error GoTo konec
        End Sub



Attribute VB_Name = "List60"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = "mival"
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas2").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas2").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas2").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas2").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPR2()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = "mival"
            'ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas2").Range("D1").Value - 1
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas2").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas2").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas2").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas2").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas2").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas2").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas2").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas2").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas2").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas2").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas2").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas2").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku 'm|fffd|nus 1, proto|fffd|e pole od nuly
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
            
            
            'vymazat dle po|fffd|tu |fffd|adatel|fffd| 1= vymazat 4, 3, 2
                    'If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    'Dim pocetSekci As Integer
                    'pocetSekci = .documents(1).Sections.Count
'                    If ThisWorkbook.Sheets("GDPR-souhlas2").Value = 3 Then
'                        .documents(1).Sections(4).Range.Delete
'                        .documents(1).Bookmarks("\EndOfDoc").Select
'                        With novy_dokument.Selection
'                            .EndKey
'                            .TypeBackspace
'                        End With
'                    End If
            '        dle po|fffd|tu |fffd|adatel|fffd| 2= vymazat 4, 3
            '        dle po|fffd|tu |fffd|adatel|fffd| 3= vymazat 4
            
            
            
                        'SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        'wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("GDPR-souhlas2").Visible = False
            
            'ThisWorkbook.Protect (abc)
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List61"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'Sub GDPRPdf()
'''pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
''    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
''    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
'
'''potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
''End If
'
''GDPR CZ
'Dim abc
'abc = "mival"
'ThisWorkbook.Unprotect (abc)
'
'    Call ThisWorkbook.Sheets("GDPR-souhlas2").GDPRCZ
'
'If ThisWorkbook.Sheets("Kalkulace").Range("C10").Value <> "Servis" Then
'    ThisWorkbook.Sheets("GDPR-souhlas2").Visible = False
'    ThisWorkbook.Protect (abc)
'End If
''anglicky, rusky
''If ThisWorkbook.Sheets("GDPR-souhlas2").Range("E6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("GDPR-souhlas2").GDPR_ENRU
''End If
'
'End Sub
            
Sub GDPR1()
            On Error GoTo ErrHandler:
            Dim abc
            
            abc = "mival"
            'ThisWorkbook.Unprotect (abc)
            'pocet_radku ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
            pocet_radku = ThisWorkbook.Sheets("GDPR-souhlas1").Range("D1").Value - 1
            
               Dim ScreenUpdatingStavPred As Boolean
               ScreenUpdatingStavPred = Application.ScreenUpdating
               Application.ScreenUpdating = False
            
            'cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
            '''nebo-li pro lep|fffd||fffd| pochopen|fffd|
            '''popisky_pro_word(1) = 'datum_vyhotoveni'
            '''popisky_pro_word(2) = 'klient_jm'
            '''popisky_pro_word(3) = ..
            ReDim popisky_pro_word(pocet_radku) As String
            
            ThisWorkbook.Sheets("GDPR-souhlas1").Visible = True
            ThisWorkbook.Sheets("GDPR-souhlas1").Select
            
            'tady za|fffd||fffd|naj|fffd| POPISKY (=n|fffd|zev Z|fffd|LO|fffd|KY ve Wordu)
                'ThisWorkbook.Sheets("GDPR-souhlas1").Range("C8").Select
                ThisWorkbook.Sheets("GDPR-souhlas1").Range("C8").Select
            ActiveCell.Offset(0, 0).Range("A1").Select
            For radek = 0 To pocet_radku  'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty v |fffd||fffd|dku sta|fffd||fffd|
               popisky_pro_word(radek) = ActiveCell.Value
               ActiveCell.Offset(1, 0).Range("A1").Select
               Next radek
            
            'cyklus pro na|fffd|ten|fffd| hodnot(do prom|fffd|nn|fffd| typu pole)... na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky
            ReDim pole_hodnot(pocet_radku) As String
            
            ''sem d|fffd|t LOOP na nab|fffd|dku_RU
            
                    ThisWorkbook.Sheets("GDPR-souhlas1").Select
                        ''If ThisWorkbook.Sheets("GDPR-souhlas1").Range("E6").Value = "generuji" Then
                        ''    ThisWorkbook.Sheets("GDPR-souhlas1").Range("E8").Select
                        ''Else
                            'ThisWorkbook.Sheets("GDPR-souhlas1").Range("D8").Select
                            ThisWorkbook.Sheets("GDPR-souhlas1").Range("D8").Select
                        ''End If
            
                    'Do While Not IsEmpty(ActiveCell.Offset(0, 0).Range("A1"))
                    ActiveCell.Offset(0, 0).Range("A1").Select
                    For radek = 0 To pocet_radku 'cyklus proch|fffd|zej|fffd|c|fffd| hodnoty (=na|fffd|te do pole jednotliv|fffd| |fffd|daje o klientovi k dota|fffd|en|fffd| do nab|fffd|dky)
                       pole_hodnot(radek) = ActiveCell.Value
                       ActiveCell.Offset(1, 0).Range("A1").Select
                       Next radek
            
                    'n|fffd|zev souboru
                    '''nazev_souboru = "nabidka-hypotecniho-uveru"
                        ''If ThisWorkbook.Sheets("GDPR-souhlas1").Range("E6").Value = "generuji" Then
                        ''    nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas1").Range("E7").Value
                        ''Else
                            nazev_souboru = ThisWorkbook.Sheets("GDPR-souhlas1").Range("D7").Value
                        ''End If
                    
                    'prom|fffd|nn|fffd| z Excelu
                    Dim wd As Object
                    'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
                    'otev|fffd|en|fffd| objektu (jm|fffd|no)
                      'kdy|fffd|
                            ActiveSheet.Shapes.Range(Array("GDPR_word")).Select
                            
                      Selection.Verb Verb:=xlOpen
                      Application.ScreenUpdating = False
                     
                     'p|fffd|i|fffd|azen|fffd| instance wordu
                    Set wd = GetObject(class:="Word.Application")
                        'wd.WindowState = wdWindowStateMinimize
                         wd.Visible = True
                        
                                Dim podslozka As String
                    
                                podslozka = ThisWorkbook.Sheets("Zadost").Range("D4").Value
                                
                                'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                                ' zkontroluje jestli je na disku C: podadres|fffd||fffd| ... pokud neexistuje, vytvo|fffd||fffd|
                                If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                                If Not DirExists("C:\Sberbank CZ\" & podslozka) Then MkDir "C:\Sberbank CZ\" & podslozka
                                
                                'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                                SaveAsName = "C:\Sberbank CZ\" & podslozka & "\" & nazev_souboru & ".docx"
                    
                    
                    
                    
                    'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
                    'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
                    ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
                    If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
                    
                    'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".docx"
                    SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".docx"
                            'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
                        With wd
                            .documents(1).SaveAs FileName:=SaveAsName
                            '''.ActiveWindow.Close
                                'workaround zbaven|fffd| se dotazu k ulo|fffd|en|fffd|
                                .documents(1).Saved = True
                            .documents(1).Close SaveChanges:=False
                        End With
                             
                            'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
                             Set ulozeny_word = GetObject(SaveAsName)
                            'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
                             Set novy_dokument = ulozeny_word.Application
                                 novy_dokument.Visible = True
                                 
                        With novy_dokument
                        'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
                            For radek = 0 To pocet_radku 'm|fffd|nus 1, proto|fffd|e pole od nuly
                            
                                
                                If pole_hodnot(radek) = "vymazat |fffd||fffd|dek" Then
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.Rows.Delete
                                Else
                                    .documents(1).Bookmarks(popisky_pro_word(radek)).Select
                                    .Selection.TypeText Text:=pole_hodnot(radek)
                                End If
                            
                            
                            Next radek
                
                        .documents(1).SaveAs FileName:=SaveAsName
            
            
            'vymazat dle po|fffd|tu |fffd|adatel|fffd| 1= vymazat 4, 3, 2
                    'If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    'Dim pocetSekci As Integer
                    'pocetSekci = .documents(1).Sections.Count
'                    If ThisWorkbook.Sheets("GDPR-souhlas1").Value = 3 Then
'                        .documents(1).Sections(4).Range.Delete
'                        .documents(1).Bookmarks("\EndOfDoc").Select
'                        With novy_dokument.Selection
'                            .EndKey
'                            .TypeBackspace
'                        End With
'                    End If
            '        dle po|fffd|tu |fffd|adatel|fffd| 2= vymazat 4, 3
            '        dle po|fffd|tu |fffd|adatel|fffd| 3= vymazat 4
            
            
            
                        'SaveAsName = "C:\Sberbank CZ\" & nazev_souboru & ".pdf"
                            '17 is the value of the symbolic constant wdFormatPDF.
                        'wd.ActiveDocument.SaveAs SaveAsName, 17
                            'novy_dokument.SaveAs SaveAsName, 17
                            
                            ''mo|fffd|no zav|fffd||fffd|t jen toto okno
                            '.ActiveWindow.Close
                         End With
            
            ''konec loopu, vr|fffd|t|fffd| se na ruskou nab|fffd|dku
            
            
konec:
            'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
                
                wd.documents(1).Saved = True
                
                If wd.documents.Count > 1 Then
                    wd.documents(1).Close SaveChanges:=True
                    Else
                    wd.Quit SaveChanges:=True
                End If
            
            Set wd = Nothing
            Set ulozeny_word = Nothing
            Set novy_dokument = Nothing
            
            ThisWorkbook.Sheets("GDPR-souhlas1").Visible = False
            
            'ThisWorkbook.Protect (abc)
            ThisWorkbook.Sheets("1_Kalkulace").Select
            Application.ScreenUpdating = ScreenUpdatingStavPred
            
            ''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou nab|fffd|dku?" _
            '', vbYesNo + vbQuestion, "Otev|fffd||fffd|t nab|fffd|dku?")
            ''    Select Case YesNo
            ''    Case vbYes
                myval = Shell("explorer " & SaveAsName, vbMaximizedFocus)
            ''    Case vbNo
            ''    End Select
            
ErrHandler:
                 ' error handling code
                    Select Case Err.Number
                    Case 0
                    Case 20
                    Case 4198
                        MsgBox "K vygenerov|fffd|n|fffd| GDPR souhlasu je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou GDPR souhlas PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
                    Case 5153
            '            wd.ActiveWindow.Close
            '            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
                    Case Else
                        MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
                    End Select
                 
                 Resume EndTry1
                
                'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
EndTry1:
                On Error GoTo konec
End Sub
Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "List9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Module1"
Option Explicit
Dim splatkaCelkem
'Dim pocetMesicu
    
'    Dim urokovaSazba
    Dim jistinaPred
    Dim splatkaJistiny
    Dim month
Dim posledniSplatka As Double
Dim maximalniUver As Long

'    Dim vypujcenaCastka
Public a As Integer
Public Row As Integer
Public Col As Integer
Public SplatkaFinal As Long
Public suma As Double
Sub PrepnoutR1C1()
'p|fffd|epne mezi stylem vzorc|fffd|
Application.ReferenceStyle = xlR1C1
End Sub

Sub PrepnoutA1()
'p|fffd|epne mezi stylem vzorc|fffd|
Application.ReferenceStyle = xlA1
End Sub
'Sub testRPSN()
'Call HledamSpravneRPSN(8.99, 300000, 4414, 34.634535039374, 96)
'
'End Sub

'Sub MaxVyseUveru()
'Dim CF As Long
''Dim mesicniSplatka As Long
'Dim UrokovaSazba As Double
'Dim vypujcenaCastka As Long
'Dim pocetMesicu As Integer
'
'UrokovaSazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
'vypujcenaCastka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
'pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
'CF = ThisWorkbook.Sheets("Data ze vstupu").Range("C8").Value
'
'Call najdiSplatku(mesicniSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu, "normal")
'End Sub

Sub RPSN()
Dim sazba As Double
Dim vyseUveru As Long
Dim vypoctenaSplatka As Long
Dim pocetMesicu As Integer


sazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
vyseUveru = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
vypoctenaSplatka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value
pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
Call HledamSpravneRPSN(sazba, vyseUveru, vypoctenaSplatka, posledniSplatka, pocetMesicu)
End Sub

Sub HledamSpravneRPSN(sazba As Double, vyseUveru As Long, vypoctenaSplatka As Long, posledniSplatka As Double, pocetMesicu As Integer)
'Public suma As Double
'Dim vyseUveru As Long
Dim sazbaRPSN1 As Double 'levy okraj v prohledavanem intervalu
Dim sazbaRPSN2 As Double 'pravy okraj v prohledavanem intervalu
'Dim sazba
Dim minulaSuma As Double
Dim sazbaRPSN As Double
Dim j As Integer

minulaSuma = 0
suma = 0
sazbaRPSN1 = sazba
sazbaRPSN2 = sazba * 3
sazbaRPSN = sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2
' testuji vysi RPSN
For j = 1 To 1000
    If Not Round(suma * 1000, 14) = vyseUveru And Not Round(suma * 1000, 14) = Round(minulaSuma * 1000, 14) Or j = 1 Then
'    If Not Round(suma, 0) = vyseUveru Or j = 1 Then
        
        minulaSuma = suma
        
        ' Volim novou vysi sazbaRPSN a testujuji
        Call VypocetRPSN(vypoctenaSplatka, posledniSplatka, pocetMesicu, sazbaRPSN, vyseUveru, sazba)
'        GoTo vyskoc
        If suma < vyseUveru Then
            sazbaRPSN2 = sazbaRPSN ' posunuji levy okraj intervalu

        ElseIf suma > vyseUveru Then
            sazbaRPSN1 = sazbaRPSN  ' posunuji pravy okraj intervalu

        ElseIf Round(suma, 0) = vyseUveru Or Not Round(suma, 2) = Round(minulaSuma, 2) Then
            GoTo vyskoc
        End If
        
        'vypocitam novou sazbu RPSN uz s posunutymi kraji intervalu
        sazbaRPSN = Round(sazbaRPSN1 + (sazbaRPSN2 - sazbaRPSN1) / 2, 8)
        
        
    Else:
'        Debug.Print "RPSN je " & sazbaRPSN & " soucetRPSN je " & suma & " a dosla jsem na konec"
        GoTo vyskoc
    
    End If
Next
vyskoc:
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7").Value = Round(sazbaRPSN, 2)
'Debug.Print "RPSN je " & Round(sazbaRPSN, 14) & " soucetRPSN je " & suma & " minula suma byla" & minulaSuma & " uver byl " & vyseUveru & " j = " & j & " leva hranice je " & sazbaRPSN1 & " prava hranice je " & sazbaRPSN2
End Sub

Sub VypocetRPSN(Splatka As Long, posledniSplatka As Double, pocetMesicu As Integer, sazbaRPSN As Double, vyseUveru As Long, sazba As Double)
'    Dim suma As Double
'    sazbaRPSN = 9.5132
    Dim pocetDni As Integer
    Dim jednorazovyPoplatekpocetDni1 As Integer
    Dim jednorazovyPoplatekpocetDni2 As Integer
    Dim jednorazovyPoplatekpocetDni3 As Integer
    Dim jednorazovyPoplatekpocetDni4 As Integer
    Dim jednorazovyPoplatekpocetDni5 As Integer
    Dim i As Integer
    Dim datumCerpani As Date
    Dim datumSplatky As Date
    Dim jednorazovyPoplatekdatumSplatky1 As Date
    Dim jednorazovyPoplatekdatumSplatky2 As Date
    Dim jednorazovyPoplatekdatumSplatky3 As Date
    Dim jednorazovyPoplatekdatumSplatky4 As Date
    Dim jednorazovyPoplatekdatumSplatky5 As Date
    Dim prestupnyRok As Boolean
    Dim jednorazovyPoplatek1 As Double
    Dim jednorazovyPoplatek2 As Double
    Dim jednorazovyPoplatek3 As Double
    Dim jednorazovyPoplatek4 As Double
    Dim jednorazovyPoplatek5 As Double
    
    Dim pravidelnyPoplatek1 As Double
    Dim pravidelnyPoplatek2 As Double
    Dim urokOdlozeni As Double
    Dim k As Integer
    Dim ZbyleUroky As Double
    
    jednorazovyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C11").Value
    jednorazovyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C12").Value
    jednorazovyPoplatek3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C13").Value
    jednorazovyPoplatek4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C14").Value
    jednorazovyPoplatek5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C15").Value
    
    datumCerpani = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V22").Value
    
    jednorazovyPoplatekdatumSplatky1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B11").Value
    jednorazovyPoplatekdatumSplatky2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B12").Value
    jednorazovyPoplatekdatumSplatky3 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B13").Value
    jednorazovyPoplatekdatumSplatky4 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B14").Value
    jednorazovyPoplatekdatumSplatky5 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B15").Value
    
    jednorazovyPoplatekpocetDni1 = jednorazovyPoplatekdatumSplatky1 - datumCerpani
    jednorazovyPoplatekpocetDni2 = jednorazovyPoplatekdatumSplatky2 - datumCerpani
    jednorazovyPoplatekpocetDni3 = jednorazovyPoplatekdatumSplatky3 - datumCerpani
    jednorazovyPoplatekpocetDni4 = jednorazovyPoplatekdatumSplatky4 - datumCerpani
    jednorazovyPoplatekpocetDni5 = jednorazovyPoplatekdatumSplatky5 - datumCerpani
    
    ' Do vypoctu RPSN musim zapocitat i odurocene jednorazove poplatky
    suma = jednorazovyPoplatek1 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni1 / 365) + jednorazovyPoplatek2 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni2 / 365) + jednorazovyPoplatek3 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni3 / 365) + jednorazovyPoplatek4 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni4 / 365) + jednorazovyPoplatek5 / (1 + sazbaRPSN / 100) ^ (jednorazovyPoplatekpocetDni5 / 365)
    pravidelnyPoplatek1 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C18").Value
    pravidelnyPoplatek2 = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C19").Value
    
    ' Ke splatce prictu vsechny pravidelne poplatky, splatnost maji ve stejny den jako splatka
    Splatka = Splatka + pravidelnyPoplatek1 + pravidelnyPoplatek2
    
'V KONSOLID|fffd|N|fffd|M KALKUL|fffd|TORU NELZE SPL|fffd|TKU ODLO|fffd|IT A PROTO NEN|fffd| T|fffd|EBA |fffd|E|fffd|IT
    
'   zapocitavam do RPSN i dobu kdy jsou spl|fffd|ty odlo|fffd|en|fffd|, |fffd|rok zapo|fffd||fffd|t|fffd|v|fffd|m ka|fffd|d|fffd| |fffd|tvrtlet|fffd|, poji|fffd|t|fffd|n|fffd| ka|fffd|d|fffd| m|fffd|s|fffd|c
    ZbyleUroky = 0
    For k = 24 To 71
        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("A" & k).Value = True Then
            If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "poji|fffd|t|fffd|n|fffd|" Then
                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
                pocetDni = datumSplatky - datumCerpani
                suma = suma + (pravidelnyPoplatek1 + pravidelnyPoplatek2) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            ElseIf ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("B" & k).Value = "kvart|fffd|l" Then
                datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & k).Value
                pocetDni = datumSplatky - datumCerpani
                urokOdlozeni = vyseUveru * sazba
                If urokOdlozeni > Splatka Then
                    ZbyleUroky = ZbyleUroky + urokOdlozeni - Splatka
                    urokOdlozeni = Splatka
                End If
                suma = suma + (urokOdlozeni) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
            End If
        End If
    Next
    
    For i = 1 To pocetMesicu
        datumSplatky = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("V" & 71 + i).Value
        prestupnyRok = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("M" & 71 + i).Value
        pocetDni = datumSplatky - datumCerpani
    ' vypocet RPSN v jednom mesici plu rovnou pricteni k sume
    ' treba ocetrit pocet dnu v prestupnem roce to se bude delit 366 misto 365
        If prestupnyRok = False Then
            If i < pocetMesicu Then
                suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni
            Else
                suma = suma + (Splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365)
'                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 365) & " RPSN je " & pocetDni / 365 & " " & pocetDni & " " & datumSplatky
            End If
        ElseIf prestupnyRok = True Then
            If i < pocetMesicu Then
                suma = suma + Splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
'                Debug.Print i & " " & splatka / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je " & pocetDni / 366 & " " & pocetDni
            Else
                suma = suma + (Splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366)
'                Debug.Print i & " " & (splatka - posledniSplatka) / (1 + sazbaRPSN / 100) ^ (pocetDni / 366) & " RPSN je "; pocetDni / 366 & " " & pocetDni
            End If
        End If
            If suma > vyseUveru + ZbyleUroky Then
                GoTo skonci
            End If
    Next
skonci:

'    Debug.Print suma & " " & i
End Sub
'Sub mericCasu()
'Dim StartTime
'StartTime = Timer
' Call najdiSplatku
'
'Debug.Print Timer - StartTime
'End Sub
'Sub testDen()
'Dim datumCerpani
'Dim datumPrvniSplatky
'
''datumCerpani = DateValue("24.12.2017")
'datumCerpani = DateValue("17.4.2017")
'
''Debug.Print datumCerpani
'posunoutNaPracovniDen (datumCerpani)
''Debug.Print datumCerpani
'
''datumPrvniSplatky = "1.2.2017"
'
'End Sub
'
'Sub posunoutNaPracovniDen(datumSplatky)
''svyhledat --- v ciselnik_svatky
'    'If WorksheetFunction.VLookup(datumSplatky, ThisWorkbook.Sheets("ciselniky_svatky").Range("A4:A14"), 1, False) = True Then
'
'    If IsError(Application.VLookup(datumSplatky, ThisWorkbook.Sheets("ciselnik_svatky").Range("B17:B101"), 1, False)) Then
'      datumSplatky = DateAdd("d", 1, datumSplatky)
'      'Debug.Print datumSplatky
'    End If
'
'End Sub
Sub Splatka()
Dim mesicniSplatka As Long
Dim UrokovaSazba As Double
Dim vypujcenaCastka As Long
Dim pocetMesicu As Integer
 
UrokovaSazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
vypujcenaCastka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value
pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
mesicniSplatka = -Pmt(UrokovaSazba / 12 / 100, pocetMesicu, vypujcenaCastka)

Call najdiSplatku(mesicniSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu, "normal")
End Sub

Sub najdiSplatku(mesicniSplatka As Long, UrokovaSazba As Double, vypujcenaCastka As Long, pocetMesicu As Integer, typ As String)
 
    Dim i As Integer
    Dim newSplatka As Long
    Dim x1
    Dim x2
    Dim x1jistina
    Dim x2jistina
    Dim pocitadlo As Integer
    Dim posledniSplatkaPredchozi

'    urokovaSazba = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value
'    pocetMesicu = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value
'    vypujcenaCastka = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3").Value

    'startovaciSplatka - Excel vzorcem Platba (vzorec bere 12 stejn|fffd|ch m|fffd|s|fffd|c|fffd| = sazba / 12)
'    newSplatka = -WorksheetFunction.Pmt(urokovaSazba / 12 / 100, pocetMesicu, vypujcenaCastka, 0)
    newSplatka = mesicniSplatka
    x1 = newSplatka * 0.9
    x2 = newSplatka * 1.1
    
    splatkaCelkem = newSplatka
    
    month = 0
    pocitadlo = 0
    posledniSplatkaPredchozi = 0
    
    Do While pocitadlo < 300 And Not (Round(jistinaPred, 0) = 0 And pocetMesicu = month)
    ''''And jistinaPred >= 0 And jistinaPred < splatkaCelkem And pocetMesicu - 1 = month)
        pocitadlo = pocitadlo + 1
        
            
            Call splatkovyKalendar(newSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu)
            
            If Round(posledniSplatka, 0) = Round(posledniSplatkaPredchozi, 0) Then
                ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = Application.WorksheetFunction.RoundUp(newSplatka, 0)
                ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J2").Value = posledniSplatka
                GoTo konec
            Else
                posledniSplatkaPredchozi = posledniSplatka
            End If
        
            'jistinaPoSplatce < splatkaCelkem a pocetMesicu = month
            If jistinaPred >= 0 And jistinaPred < splatkaCelkem And pocetMesicu = month Then
                x1 = newSplatka
                    'posledn|fffd| spl|fffd|tka je ni|fffd||fffd||fffd| ne|fffd| pravideln|fffd|, ale v|fffd|t|fffd||fffd| ne|fffd| 0 = vyrovn|fffd|v|fffd|m rozd|fffd|l, kv|fffd|li zaokrouhlen|fffd| spl|fffd|tek
                    'o|fffd|et|fffd|it jistinaPoSplatce > 0
                    'moc vysok|fffd| spl|fffd|tka
                    
                'optim|fffd|ln|fffd| spl|fffd|tka
                
            
            'jistinaPoSplatce > splatkaCelkem and pocetMesicu = month
            ElseIf jistinaPred > splatkaCelkem And pocetMesicu = month Then
                'moc n|fffd|zk|fffd| spl|fffd|tka -- lev|fffd| hranice hledan|fffd| spl|fffd|tky (x1)
                ''x1jistina = jistinaPred
                x1 = newSplatka
                
            
            'jistinaPoSplatce <= splatkaCelkem and pocetMesicu > month
            ElseIf jistinaPred <= splatkaCelkem And pocetMesicu > month Then
                'moc vysok|fffd| spl|fffd|tka -- prav|fffd| hranice hledan|fffd| spl|fffd|tky (x1)
                ''x2jistina = jistinaPred
                x2 = newSplatka
            End If
            
                newSplatka = x1 + Abs((x2 - x1) / 2)
        
        
    Loop

konec:

''MsgBox "pocitadlo=" & pocitadlo & "hur|fffd| zaokrouhlit spl|fffd|tku + zbytek jistiny = posledn|fffd| spl|fffd|tka"
''    - 12 stejn|fffd|ch spl|fffd|tek
''
'zaokrouhlit spl|fffd|tku
newSplatka = WorksheetFunction.Ceiling(newSplatka, 1)
'znovu dosadit do kalend|fffd||fffd|e
Call splatkovyKalendar(newSplatka, UrokovaSazba, vypujcenaCastka, pocetMesicu)

'Debug.Print "newSplatka=" & newSplatka
'Debug.Print "posledniSplatka=" & posledniSplatka
SplatkaFinal = newSplatka
If typ = "normal" Then
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = SplatkaFinal
ElseIf typ = "max" Then
    maximalniUver = SplatkaFinal
    ThisWorkbook.Sheets("Data ze vstupu").Range("E12").Value = SplatkaFinal
End If
'    - zbytek jistiny = posledn|fffd| spl|fffd|tka

    
     
     'jistinaPoSplatce
     'splatkaCelkem
    
    'vr|fffd|t|fffd| se na za|fffd||fffd|tek (a rozp|fffd|l|fffd| hledan|fffd| interval)
    
    
    'ThisWorkbook.Sheets("List1").Range("A2").GoalSeek Goal:=0, ChangingCell:=ThisWorkbook.Sheets("List1").Range("B1")
    

    
 End Sub
 Sub splatkovyKalendar(splatkaCelkem, UrokovaSazba As Double, vypujcenaCastka As Long, pocetMesicu As Integer)
     Dim i As Integer
     Dim j As Integer
     Dim splatkaUrok
     Dim pocetDni
     Dim ZbyleUroky
     'spl|fffd|tkov|fffd| kalend|fffd||fffd| se zvolenou spl|fffd|tkou
    'i = po|fffd|et m|fffd|s|fffd|c|fffd|
    
'''        splatkaCelkem = 9100
'''        jistinaPred = 100000
'''        pocetMesicu = 12
'''        urokovaSazba = 1.79
    
'    Debug.Print splatkaCelkem
    
    jistinaPred = vypujcenaCastka
    
    For j = 24 To 35
        If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("A" & j).Value = True Then
            pocetDni = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("K" & j).Value
            splatkaUrok = jistinaPred * UrokovaSazba / 100 * pocetDni / 360
            splatkaUrok = Round(splatkaUrok, 2)
        Else
            GoTo pokracuj
        End If
    Next
    
pokracuj:
    
    For i = 1 To pocetMesicu
        '|fffd|rok za obdob|fffd| 5 000
        'vzorec jistinaPoSplatce*(sazba / 12 / 100) * pocetDni / 360
        'pocetDni = 30
'
        pocetDni = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("K" & 71 + i).Value
'        splatkaUrok = jistinaPred * urokovaSazba / 100 * pocetDni / 360
'        splatkaUrok = Round(splatkaUrok, 2)

        splatkaUrok = jistinaPred * UrokovaSazba / 100 * pocetDni / 360
        splatkaUrok = Round(splatkaUrok, 2)
        
'        Debug.Print "i=" & i & "-dni=" & pocetDni & "-splatkaUrok=" & splatkaUrok
        
        If splatkaUrok > splatkaCelkem Then
            ZbyleUroky = splatkaUrok - splatkaCelkem
            splatkaUrok = splatkaCelkem
        End If
        'spl|fffd|tka celkem 15 000 = |fffd|rok 5 000 + spl|fffd|tka jistiny 10 000
        'spl|fffd|tka jistiny 10 000 = spl|fffd|tka celkem 15 000 - |fffd|rok 5 000
        splatkaJistiny = splatkaCelkem - splatkaUrok ' kdy|fffd| bude urok vy|fffd||fffd||fffd| ne|fffd| je spl|fffd|tka tak je zaji|fffd|t|fffd|no, |fffd|e spl|fffd|tka jistiny bude 0
            
        'jistina po spl|fffd|tce = jistinaPred pro dal|fffd||fffd| m|fffd|s|fffd|c = 990 000
''        If i = pocetMesicu And jistinaPred < 2 * splatkaCelkem Then
''            'jistinaPred = jistinaPred - splatkaJistiny
''            MsgBox "bla"
''        Else
        If ZbyleUroky > 0 Then
            ZbyleUroky = ZbyleUroky - splatkaJistiny
            If ZbyleUroky < 0 Then
                splatkaJistiny = -ZbyleUroky
                ZbyleUroky = 0
                jistinaPred = jistinaPred - splatkaJistiny
            End If
        Else

        jistinaPred = jistinaPred - splatkaJistiny
        End If
''        End If
        
        month = i
'        i = i + 1
'        Debug.Print i & " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & "splatka uroku " & splatkaUrok
        
        If jistinaPred + 2 * i < splatkaCelkem Then
        'If jistinaPred < 0 Then
'            Debug.Print i & " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & "splatka uroku " & splatkaUrok
            GoTo konec
'            Debug.Print " month="; month & ", jistinaPred(dal|fffd||fffd| spl|fffd|tku)=" & jistinaPred & "pocetMesicu " & pocetMesicu
        End If
    Next
    
konec:
'posledn|fffd| spl|fffd|tka
        posledniSplatka = jistinaPred
        
        If Round(jistinaPred, 0) = 0 Then
            GoTo konec2
        End If
konec2:
 End Sub

'Sub testRPSN()
'Call HledamSpravneRPSN(6.65, 500000, 8561, 56, 71)
'
'' jen pro testovani pak tyto promee zrusit
''sazba = 6.65
''vyseUveru = 500000
''pocetMesicu = 71
''vypoctenaSplatka = 8561
''posledniSplatka = 56
'
'End Sub



Attribute VB_Name = "Module10"
Option Explicit
Sub ZadostI()
    If ThisWorkbook.Sheets("Zadost").Range("D106").Value = True Or ThisWorkbook.Sheets("Zadost").Range("D107").Value = True Then
    Call ZadostStandardPlus
    Else
    Call ZadostKlasikPremium
        If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value = "ESC" Then
          Select Case Val(ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Value)
            Case 4
                List59.GDPR4
            Case 3
                List58.GDPR3
            Case 2
                List60.GDPR2
            Case 1
                List61.GDPR1
          End Select
        End If
    End If
End Sub
    
Sub ZadostStandardPlus()
If Val(ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Value) > 2 Then
    MsgBox "Do |fffd||fffd|dosti se propisuj|fffd| pouze |fffd|daje pro hlavn|fffd|ho |fffd|adatele a jednoho spoludlu|fffd|n|fffd|ka. " & vbNewLine & vbNewLine & "V p|fffd||fffd|pad|fffd| v|fffd|ce |fffd|adatel|fffd| je t|fffd|eba |fffd|daje doplnit ru|fffd|n|fffd| p|fffd||fffd|mo do |fffd||fffd|dosti.", vbInformation, "|fffd||fffd|DOST - Upozorn|fffd|n|fffd|"
End If
Dim ScreenUpdatingStavPred As Boolean
ScreenUpdatingStavPred = Application.ScreenUpdating
Application.ScreenUpdating = False

'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku

' Zadost , vypln|fffd|n|fffd| zadan|fffd|ch |fffd|daj|fffd| do |fffd|ablony
Dim wd As Object
ThisWorkbook.Sheets("Zadost").Visible = True
ThisWorkbook.Sheets("Zadost").Select

'prom|fffd|nn|fffd| z Excelu
Dim CisloObchZast
CisloObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D4").Value)
Dim NazSpolObchZast
NazSpolObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D5").Value)
Dim MobTelObchZast
MobTelObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D6").Value)

Dim HlavZadJmeno
HlavZadJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("D7").Value)
Dim SpoluzadJmeno
SpoluzadJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("E7").Value)

Dim HlavZadRodneCislo
HlavZadRodneCislo = CStr(ThisWorkbook.Sheets("Zadost").Range("D8").Value)
Dim SpoluzadRodneCislo
SpoluzadRodneCislo = CStr(ThisWorkbook.Sheets("Zadost").Range("E8").Value)

Dim HlavZadDatumNar
HlavZadDatumNar = CStr(ThisWorkbook.Sheets("Zadost").Range("D9").Value)
Dim SpoluzadDatumNar
SpoluzadDatumNar = CStr(ThisWorkbook.Sheets("Zadost").Range("E9").Value)

Dim HlavZadStatPrislus
HlavZadStatPrislus = CStr(ThisWorkbook.Sheets("Zadost").Range("D10").Value)
Dim SpoluzadStatPrislus
SpoluzadStatPrislus = CStr(ThisWorkbook.Sheets("Zadost").Range("E10").Value)

Dim HlavZadPohlavi
HlavZadPohlavi = CStr(ThisWorkbook.Sheets("Zadost").Range("D11").Value)
Dim SpoluzadPohlavi
SpoluzadPohlavi = CStr(ThisWorkbook.Sheets("Zadost").Range("E11").Value)

Dim SpoluzadRodPomerVuci
SpoluzadRodPomerVuci = CStr(ThisWorkbook.Sheets("Zadost").Range("E12").Value)

Dim HlavZadTypDokladuTot
HlavZadTypDokladuTot = CStr(ThisWorkbook.Sheets("Zadost").Range("D13").Value)
Dim SpoluzadTypDokladuTo
SpoluzadTypDokladuTo = CStr(ThisWorkbook.Sheets("Zadost").Range("E13").Value)

Dim HlavZadCisloDokladuT
HlavZadCisloDokladuT = CStr(ThisWorkbook.Sheets("Zadost").Range("D14").Value)
Dim SpoluzadCisloDokladu
SpoluzadCisloDokladu = CStr(ThisWorkbook.Sheets("Zadost").Range("E14").Value)

Dim HlavZadNejvysDosazVz
HlavZadNejvysDosazVz = CStr(ThisWorkbook.Sheets("Zadost").Range("D15").Value)
Dim SpoluzadNejvysDosazV
SpoluzadNejvysDosazV = CStr(ThisWorkbook.Sheets("Zadost").Range("E15").Value)

Dim HlavZadStav
HlavZadStav = CStr(ThisWorkbook.Sheets("Zadost").Range("D16").Value)
Dim SpoluzadStav
SpoluzadStav = CStr(ThisWorkbook.Sheets("Zadost").Range("E16").Value)

Dim HlavZadPocClenuDom
HlavZadPocClenuDom = CStr(ThisWorkbook.Sheets("Zadost").Range("D17").Value)
Dim SpoluzadPocClenuDom
SpoluzadPocClenuDom = CStr(ThisWorkbook.Sheets("Zadost").Range("E17").Value)

Dim HlavZadTypBydl
HlavZadTypBydl = CStr(ThisWorkbook.Sheets("Zadost").Range("D18").Value)
Dim SpoluzadTypBydl
SpoluzadTypBydl = CStr(ThisWorkbook.Sheets("Zadost").Range("E18").Value)

Dim HlavZadAdrTrvUlice
HlavZadAdrTrvUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("D19").Value)
Dim SpoluzadAdrTrvUlice
SpoluzadAdrTrvUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("E19").Value)

Dim HlavZadAdrTrvMesto
HlavZadAdrTrvMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("D20").Value)
Dim SpoluzadAdrTrvMesto
SpoluzadAdrTrvMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("E20").Value)

Dim HlavZadAdrTrvPSC
HlavZadAdrTrvPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D21").Value)
Dim SpoluzadAdrTrvPSC
SpoluzadAdrTrvPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("E21").Value)

Dim HlavZadAdrTrvStat
HlavZadAdrTrvStat = CStr(ThisWorkbook.Sheets("Zadost").Range("D22").Value)
Dim SpoluzadAdrTrvStat
SpoluzadAdrTrvStat = CStr(ThisWorkbook.Sheets("Zadost").Range("E22").Value)

Dim HlavZadAdrKorespUlic
HlavZadAdrKorespUlic = CStr(ThisWorkbook.Sheets("Zadost").Range("D23").Value)
Dim SpoluzadAdrKorespUli
SpoluzadAdrKorespUli = CStr(ThisWorkbook.Sheets("Zadost").Range("E23").Value)

Dim HlavZadAdrKorespMest
HlavZadAdrKorespMest = CStr(ThisWorkbook.Sheets("Zadost").Range("D24").Value)
Dim SpoluzadAdrKorespMes
SpoluzadAdrKorespMes = CStr(ThisWorkbook.Sheets("Zadost").Range("E24").Value)

Dim HlavZadAdrKorespPSC
HlavZadAdrKorespPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D25").Value)
Dim SpoluzadAdrKorespPSC
SpoluzadAdrKorespPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("E25").Value)

Dim HlavZadAdrKorespStat
HlavZadAdrKorespStat = CStr(ThisWorkbook.Sheets("Zadost").Range("D26").Value)
Dim SpoluzadAdrKorespSta
SpoluzadAdrKorespSta = CStr(ThisWorkbook.Sheets("Zadost").Range("E26").Value)

Dim HlavZadTelDomu
HlavZadTelDomu = CStr(ThisWorkbook.Sheets("Zadost").Range("D27").Value)
Dim SpoluzadTelDomu
SpoluzadTelDomu = CStr(ThisWorkbook.Sheets("Zadost").Range("E27").Value)

Dim HlavZadMobTel
HlavZadMobTel = CStr(ThisWorkbook.Sheets("Zadost").Range("D28").Value)
Dim SpoluzadMobTel
SpoluzadMobTel = CStr(ThisWorkbook.Sheets("Zadost").Range("E28").Value)

Dim HlavZadEmail
HlavZadEmail = CStr(ThisWorkbook.Sheets("Zadost").Range("D29").Value)
Dim SpoluzadEmail
SpoluzadEmail = CStr(ThisWorkbook.Sheets("Zadost").Range("E29").Value)

Dim HlavZadZamPredmetCin
HlavZadZamPredmetCin = CStr(ThisWorkbook.Sheets("Zadost").Range("D30").Value)
Dim SpoluzadZamPredmetCi
SpoluzadZamPredmetCi = CStr(ThisWorkbook.Sheets("Zadost").Range("E30").Value)

Dim HlavZadZamPracPozice
HlavZadZamPracPozice = CStr(ThisWorkbook.Sheets("Zadost").Range("D31").Value)
Dim SpoluzadZamPracPozic
SpoluzadZamPracPozic = CStr(ThisWorkbook.Sheets("Zadost").Range("E31").Value)

Dim HlavZadZamOd
HlavZadZamOd = CStr(ThisWorkbook.Sheets("Zadost").Range("D32").Value)
Dim SpoluzadZamOd
SpoluzadZamOd = CStr(ThisWorkbook.Sheets("Zadost").Range("E32").Value)

Dim HlavZadZamNazev
HlavZadZamNazev = CStr(ThisWorkbook.Sheets("Zadost").Range("D33").Value)
Dim SpoluzadZamNazev
SpoluzadZamNazev = CStr(ThisWorkbook.Sheets("Zadost").Range("E33").Value)

Dim HlavZadZamICO
HlavZadZamICO = CStr(ThisWorkbook.Sheets("Zadost").Range("D34").Value)
Dim SpoluzadZamICO
SpoluzadZamICO = CStr(ThisWorkbook.Sheets("Zadost").Range("E34").Value)

Dim HlavZadZamSidlo
HlavZadZamSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("D35").Value)
Dim SpoluzadZamSidlo
SpoluzadZamSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("E35").Value)

Dim HlavZadZamTypSml
HlavZadZamTypSml = CStr(ThisWorkbook.Sheets("Zadost").Range("D36").Value)
Dim SpoluzadZamTypSml
SpoluzadZamTypSml = CStr(ThisWorkbook.Sheets("Zadost").Range("E36").Value)

Dim HlavZadZamSmlDo
HlavZadZamSmlDo = CStr(ThisWorkbook.Sheets("Zadost").Range("D37").Value)
Dim SpoluzadZamSmlDo
SpoluzadZamSmlDo = CStr(ThisWorkbook.Sheets("Zadost").Range("E37").Value)

Dim HlavZadZamTel
HlavZadZamTel = CStr(ThisWorkbook.Sheets("Zadost").Range("D38").Value)
Dim SpoluzadZamTel
SpoluzadZamTel = CStr(ThisWorkbook.Sheets("Zadost").Range("E38").Value)

Dim HlavZadZamPrijem3M
HlavZadZamPrijem3M = CStr(ThisWorkbook.Sheets("Zadost").Range("D39").Value)
Dim SpoluzadZamPrijem3M
SpoluzadZamPrijem3M = CStr(ThisWorkbook.Sheets("Zadost").Range("E39").Value)

Dim HlavZadZamZkusebDoba
HlavZadZamZkusebDoba = CStr(ThisWorkbook.Sheets("Zadost").Range("D40").Value)
Dim SpoluzadZamZkusebDob
SpoluzadZamZkusebDob = CStr(ThisWorkbook.Sheets("Zadost").Range("E40").Value)

Dim HlavZadPodnikatJmeno
HlavZadPodnikatJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("D41").Value)
Dim SpoluzadPodnikatJmen
SpoluzadPodnikatJmen = CStr(ThisWorkbook.Sheets("Zadost").Range("E41").Value)

Dim HlavZadPodnikatICO
HlavZadPodnikatICO = CStr(ThisWorkbook.Sheets("Zadost").Range("D42").Value)
Dim SpoluzadPodnikatICO
SpoluzadPodnikatICO = CStr(ThisWorkbook.Sheets("Zadost").Range("E42").Value)

Dim HlavZadPodnikatSidlo
HlavZadPodnikatSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("D43").Value)
Dim SpoluzadPodnikatSidl
SpoluzadPodnikatSidl = CStr(ThisWorkbook.Sheets("Zadost").Range("E43").Value)

Dim SpoluzadPodnPrij12M
SpoluzadPodnPrij12M = CStr(ThisWorkbook.Sheets("Zadost").Range("D44").Value)
Dim SpoluzadPodnikatPrijem12M
SpoluzadPodnikatPrijem12M = CStr(ThisWorkbook.Sheets("Zadost").Range("E44").Value)

Dim HlavZadPodnikatObor
HlavZadPodnikatObor = CStr(ThisWorkbook.Sheets("Zadost").Range("D45").Value)
Dim SpoluzadPodnikatObor
SpoluzadPodnikatObor = CStr(ThisWorkbook.Sheets("Zadost").Range("E45").Value)

Dim HlavZadPodnikatDatZa
HlavZadPodnikatDatZa = CStr(ThisWorkbook.Sheets("Zadost").Range("D46").Value)
Dim SpoluzadPodnikatDatZ
SpoluzadPodnikatDatZ = CStr(ThisWorkbook.Sheets("Zadost").Range("E46").Value)

Dim HlavZadTypPrijmu1
HlavZadTypPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("D47").Value)
Dim SpoluzadTypPrijmu1
SpoluzadTypPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("E47").Value)

Dim HlavZadCastkaPrijmu1
HlavZadCastkaPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("D48").Value)
Dim SpoluzadCastkPrijmu1
SpoluzadCastkPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("E48").Value)

Dim HlavZadTypPrijmu2
HlavZadTypPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("D49").Value)
Dim SpoluzadTypPrijmu2
SpoluzadTypPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("E49").Value)

Dim HlavZadCastkaPrijmu2
HlavZadCastkaPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("D50").Value)
Dim SpoluzadCastkaPrijmu2
SpoluzadCastkaPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("E50").Value)

Dim HlavZadTypPrijmu3
HlavZadTypPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("D51").Value)
Dim SpoluzadTypPrijmu3
SpoluzadTypPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("E51").Value)

Dim HlavZadCastkaPrijmu3
HlavZadCastkaPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("D52").Value)
Dim SpoluzadCastkPrijmu3
SpoluzadCastkPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("E52").Value)

Dim HlavZadTypPrijmu4
HlavZadTypPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("D53").Value)
Dim SpoluzadTypPrijmu4
SpoluzadTypPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("E53").Value)

Dim HlavZadCastkaPrijmu4
HlavZadCastkaPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("D54").Value)
Dim SpoluzadCastkPrijmu4
SpoluzadCastkPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("E54").Value)

Dim HlavZadVydSplatUveru
HlavZadVydSplatUveru = CStr(ThisWorkbook.Sheets("Zadost").Range("D55").Value)
Dim SpoluzadVydSplatUver
SpoluzadVydSplatUver = CStr(ThisWorkbook.Sheets("Zadost").Range("E55").Value)

Dim HlavZadVydLimitKTK
HlavZadVydLimitKTK = CStr(ThisWorkbook.Sheets("Zadost").Range("D56").Value)
Dim SpoluzadVydLimitKTK
SpoluzadVydLimitKTK = CStr(ThisWorkbook.Sheets("Zadost").Range("E56").Value)

Dim HlavZadVydLimitKK
HlavZadVydLimitKK = CStr(ThisWorkbook.Sheets("Zadost").Range("D57").Value)
Dim SpoluzadVydLimitKK
SpoluzadVydLimitKK = CStr(ThisWorkbook.Sheets("Zadost").Range("E57").Value)

Dim HlavZadVydSplatLeasi
HlavZadVydSplatLeasi = CStr(ThisWorkbook.Sheets("Zadost").Range("D58").Value)
Dim SpoluzadVydSplatLeas
SpoluzadVydSplatLeas = CStr(ThisWorkbook.Sheets("Zadost").Range("E58").Value)

Dim HlavZadVydSrazZeMzdy
HlavZadVydSrazZeMzdy = CStr(ThisWorkbook.Sheets("Zadost").Range("D59").Value)
Dim SpoluzadVydSrazZeMzd
SpoluzadVydSrazZeMzd = CStr(ThisWorkbook.Sheets("Zadost").Range("E59").Value)

Dim HlavZadVydVyzivne
HlavZadVydVyzivne = CStr(ThisWorkbook.Sheets("Zadost").Range("D60").Value)
Dim SpoluzadVydVyzivne
SpoluzadVydVyzivne = CStr(ThisWorkbook.Sheets("Zadost").Range("E60").Value)

Dim HlavZadVydZavazVuciD
HlavZadVydZavazVuciD = CStr(ThisWorkbook.Sheets("Zadost").Range("D61").Value)
Dim SpoluzadVydZavazVuci
SpoluzadVydZavazVuci = CStr(ThisWorkbook.Sheets("Zadost").Range("E61").Value)

Dim HlavZadVydNemovitost
HlavZadVydNemovitost = CStr(ThisWorkbook.Sheets("Zadost").Range("D62").Value)
Dim SpoluzadVydNemovitos
SpoluzadVydNemovitos = CStr(ThisWorkbook.Sheets("Zadost").Range("E62").Value)

Dim HlavZadVydDalsi
HlavZadVydDalsi = CStr(ThisWorkbook.Sheets("Zadost").Range("D63").Value)
Dim SpoluzadVydDalsi
SpoluzadVydDalsi = CStr(ThisWorkbook.Sheets("Zadost").Range("E63").Value)

Dim datumCasTisku
datumCasTisku = CStr(ThisWorkbook.Sheets("Zadost").Range("D64").Value)

Dim NemovitostVyuziti
NemovitostVyuziti = CStr(ThisWorkbook.Sheets("Zadost").Range("D65").Value)
Dim PredmetZastavy
PredmetZastavy = CStr(ThisWorkbook.Sheets("Zadost").Range("D66").Value)
Dim NemovitostCena
NemovitostCena = CStr(ThisWorkbook.Sheets("Zadost").Range("D67").Value)
Dim ZdrojeVlastni
ZdrojeVlastni = CStr(ThisWorkbook.Sheets("Zadost").Range("D68").Value)
Dim ZdrojeCizi
ZdrojeCizi = CStr(ThisWorkbook.Sheets("Zadost").Range("D69").Value)
Dim NemovitostAdrUlice
NemovitostAdrUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("D70").Value)
Dim NemovitostAdrMesto
NemovitostAdrMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("D71").Value)
Dim NemovitostAdrPSC
NemovitostAdrPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D72").Value)

Dim UverTyp
UverTyp = CStr(ThisWorkbook.Sheets("Zadost").Range("D73").Value)

Dim UverVyse
UverVyse = CStr(ThisWorkbook.Sheets("Zadost").Range("D75").Value)
Dim UverDoplnCast
UverDoplnCast = CStr(ThisWorkbook.Sheets("Zadost").Range("D76").Value)
Dim UverCelkVyse
UverCelkVyse = CStr(ThisWorkbook.Sheets("Zadost").Range("D77").Value)
Dim PocetSplatek
PocetSplatek = CStr(ThisWorkbook.Sheets("Zadost").Range("D78").Value)
Dim AnuitSplaceniAzPoDoc
AnuitSplaceniAzPoDoc = CStr(ThisWorkbook.Sheets("Zadost").Range("D79").Value)
Dim PozadovFixace
PozadovFixace = CStr(ThisWorkbook.Sheets("Zadost").Range("D80").Value)
Dim PojistSchopSplacet
PojistSchopSplacet = CStr(ThisWorkbook.Sheets("Zadost").Range("D81").Value)
Dim TypZadatele
TypZadatele = CStr(ThisWorkbook.Sheets("Zadost").Range("D82").Value)
Dim TypZadatele6Padem
TypZadatele6Padem = CStr(ThisWorkbook.Sheets("Zadost").Range("E83").Value)

'za|fffd|krt|fffd|v|fffd|tka
Dim ucelUveru_koupe
ucelUveru_koupe = CStr(ThisWorkbook.Sheets("Zadost").Range("D84").Value)
Dim ucelUveru_DanZNabiti
ucelUveru_DanZNabiti = CStr(ThisWorkbook.Sheets("Zadost").Range("D85").Value)
Dim ucelUveru_prevodPrav
ucelUveru_prevodPrav = CStr(ThisWorkbook.Sheets("Zadost").Range("D86").Value)
Dim ucelUveru_refinanc
ucelUveru_refinanc = CStr(ThisWorkbook.Sheets("Zadost").Range("D87").Value)
Dim ucelUveru_VyplaDluhu
ucelUveru_VyplaDluhu = CStr(ThisWorkbook.Sheets("Zadost").Range("D88").Value)
Dim ucelUveru_VystavbRek
ucelUveru_VystavbRek = CStr(ThisWorkbook.Sheets("Zadost").Range("D89").Value)
Dim ucelUveru_ZpetPropla
ucelUveru_ZpetPropla = CStr(ThisWorkbook.Sheets("Zadost").Range("D90").Value)
Dim ucelUveru_BezUcelu
ucelUveru_BezUcelu = CStr(ThisWorkbook.Sheets("Zadost").Range("D91").Value)
Dim ucelUveru_Konsolidac
ucelUveru_Konsolidac = CStr(ThisWorkbook.Sheets("Zadost").Range("D92").Value)
Dim ucelUveru_NaPronajem
ucelUveru_NaPronajem = CStr(ThisWorkbook.Sheets("Zadost").Range("D93").Value)
Dim ucelUveru_Ostatni
ucelUveru_Ostatni = CStr(ThisWorkbook.Sheets("Zadost").Range("D94").Value)




'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)

' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"

'otev|fffd|en|fffd| objektu (jm|fffd|no je zde zadostWord2zadatele)
  ThisWorkbook.Sheets("Zadost").Shapes.Range("zadostWord2zadatele").Select
  Selection.Verb Verb:=xlOpen
  
 
 'p|fffd|i|fffd|azen|fffd| instance wordu
 Set wd = GetObject(class:="Word.Application")
     wd.Visible = True

Dim nazev_souboru As String
nazev_souboru = "Zadost_" & Format(Now, "YYYY-MM-DD_HH-MM-SS")
'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
Dim SaveAsName
SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"

'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
With wd
    .documents(1).SaveAs FileName:=SaveAsName
    .documents(1).Saved = True
    '''.ActiveWindow.Close
    .documents(1).Close SaveChanges:=False
End With
 
'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
 Dim ulozeny_word As Object
 Set ulozeny_word = GetObject(SaveAsName)
'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
 Dim novy_dokument As Object
 Set novy_dokument = ulozeny_word.Application
     novy_dokument.Visible = True
     
With novy_dokument
'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
    .documents(1).Bookmarks("CisloObchZast").Select
    .Selection.TypeText Text:=CisloObchZast
    
    .documents(1).Bookmarks("NazSpolObchZast").Select
    .Selection.TypeText Text:=NazSpolObchZast
    
    .ActiveDocument.Bookmarks("MobTelObchZast").Select
    .Selection.TypeText Text:=MobTelObchZast
    
    .documents(1).Bookmarks("HlavZadJmeno").Select
    .Selection.TypeText Text:=HlavZadJmeno
    .documents(1).Bookmarks("SpoluzadJmeno").Select
    .Selection.TypeText Text:=SpoluzadJmeno
    
    .documents(1).Bookmarks("HlavZadJmeno2").Select
    .Selection.TypeText Text:=HlavZadJmeno
    .documents(1).Bookmarks("SpoluzadJmeno2").Select
    .Selection.TypeText Text:=SpoluzadJmeno
    
    .ActiveDocument.Bookmarks("HlavZadRodneCislo").Select
    .Selection.TypeText Text:=HlavZadRodneCislo
    .ActiveDocument.Bookmarks("SpoluzadRodneCislo").Select
    .Selection.TypeText Text:=SpoluzadRodneCislo
    
    .ActiveDocument.Bookmarks("HlavZadDatumNar").Select
    .Selection.TypeText Text:=HlavZadDatumNar
    .ActiveDocument.Bookmarks("SpoluzadDatumNar").Select
    .Selection.TypeText Text:=SpoluzadDatumNar
    
    .ActiveDocument.Bookmarks("HlavZadStatPrislus").Select
    .Selection.TypeText Text:=HlavZadStatPrislus
    .ActiveDocument.Bookmarks("SpoluzadStatPrislus").Select
    .Selection.TypeText Text:=SpoluzadStatPrislus
    
    .ActiveDocument.Bookmarks("HlavZadPohlavi").Select
    .Selection.TypeText Text:=HlavZadPohlavi
    .ActiveDocument.Bookmarks("SpoluzadPohlavi").Select
    .Selection.TypeText Text:=SpoluzadPohlavi
    
    .ActiveDocument.Bookmarks("SpoluzadRodPomerVuci").Select
    .Selection.TypeText Text:=SpoluzadRodPomerVuci
    
    .ActiveDocument.Bookmarks("HlavZadTypDokladuTot").Select
    .Selection.TypeText Text:=HlavZadTypDokladuTot
    .ActiveDocument.Bookmarks("SpoluzadTypDokladuTo").Select
    .Selection.TypeText Text:=SpoluzadTypDokladuTo

    .ActiveDocument.Bookmarks("HlavZadCisloDokladuT").Select
    .Selection.TypeText Text:=HlavZadCisloDokladuT
    .ActiveDocument.Bookmarks("SpoluzadCisloDokladu").Select
    .Selection.TypeText Text:=SpoluzadCisloDokladu
    
    .ActiveDocument.Bookmarks("HlavZadNejvysDosazVz").Select
    .Selection.TypeText Text:=HlavZadNejvysDosazVz
    .ActiveDocument.Bookmarks("SpoluzadNejvysDosazV").Select
    .Selection.TypeText Text:=SpoluzadNejvysDosazV

    .ActiveDocument.Bookmarks("HlavZadStav").Select
    .Selection.TypeText Text:=HlavZadStav
    .ActiveDocument.Bookmarks("SpoluzadStav").Select
    .Selection.TypeText Text:=SpoluzadStav
    
    .ActiveDocument.Bookmarks("HlavZadPocClenuDom").Select
    .Selection.TypeText Text:=HlavZadPocClenuDom
    .ActiveDocument.Bookmarks("SpoluzadPocClenuDom").Select
    .Selection.TypeText Text:=SpoluzadPocClenuDom
    
    .ActiveDocument.Bookmarks("HlavZadTypBydl").Select
    .Selection.TypeText Text:=HlavZadTypBydl
    .ActiveDocument.Bookmarks("SpoluzadTypBydl").Select
    .Selection.TypeText Text:=SpoluzadTypBydl
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvUlice").Select
    .Selection.TypeText Text:=HlavZadAdrTrvUlice
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvUlice").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvUlice
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvMesto").Select
    .Selection.TypeText Text:=HlavZadAdrTrvMesto
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvMesto").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvMesto
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvPSC").Select
    .Selection.TypeText Text:=HlavZadAdrTrvPSC
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvPSC").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvPSC
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvStat").Select
    .Selection.TypeText Text:=HlavZadAdrTrvStat
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvStat").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvStat
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespUlic").Select
    .Selection.TypeText Text:=HlavZadAdrKorespUlic
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespUli").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespUli
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespMest").Select
    .Selection.TypeText Text:=HlavZadAdrKorespMest
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespMes").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespMes
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespPSC").Select
    .Selection.TypeText Text:=HlavZadAdrKorespPSC
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespPSC").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespPSC
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespStat").Select
    .Selection.TypeText Text:=HlavZadAdrKorespStat
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespSta").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespSta
    
    .ActiveDocument.Bookmarks("HlavZadTelDomu").Select
    .Selection.TypeText Text:=HlavZadTelDomu
    .ActiveDocument.Bookmarks("SpoluzadTelDomu").Select
    .Selection.TypeText Text:=SpoluzadTelDomu
    
    .ActiveDocument.Bookmarks("HlavZadMobTel").Select
    .Selection.TypeText Text:=HlavZadMobTel
    .ActiveDocument.Bookmarks("SpoluzadMobTel").Select
    .Selection.TypeText Text:=SpoluzadMobTel
    
    .ActiveDocument.Bookmarks("HlavZadEmail").Select
    .Selection.TypeText Text:=HlavZadEmail
    .ActiveDocument.Bookmarks("SpoluzadEmail").Select
    .Selection.TypeText Text:=SpoluzadEmail
    
    .ActiveDocument.Bookmarks("HlavZadZamPredmetCin").Select
    .Selection.TypeText Text:=HlavZadZamPredmetCin
    .ActiveDocument.Bookmarks("SpoluzadZamPredmetCi").Select
    .Selection.TypeText Text:=SpoluzadZamPredmetCi
    
    .ActiveDocument.Bookmarks("HlavZadZamPracPozice").Select
    .Selection.TypeText Text:=HlavZadZamPracPozice
    .ActiveDocument.Bookmarks("SpoluzadZamPracPozic").Select
    .Selection.TypeText Text:=SpoluzadZamPracPozic
    
    .ActiveDocument.Bookmarks("HlavZadZamOd").Select
    .Selection.TypeText Text:=HlavZadZamOd
    .ActiveDocument.Bookmarks("SpoluzadZamOd").Select
    .Selection.TypeText Text:=SpoluzadZamOd
    
    .ActiveDocument.Bookmarks("HlavZadZamNazev").Select
    .Selection.TypeText Text:=HlavZadZamNazev
    .ActiveDocument.Bookmarks("SpoluzadZamNazev").Select
    .Selection.TypeText Text:=SpoluzadZamNazev
    
    .ActiveDocument.Bookmarks("HlavZadZamICO").Select
    .Selection.TypeText Text:=HlavZadZamICO
    .ActiveDocument.Bookmarks("SpoluzadZamICO").Select
    .Selection.TypeText Text:=SpoluzadZamICO
    
    .ActiveDocument.Bookmarks("HlavZadZamSidlo").Select
    .Selection.TypeText Text:=HlavZadZamSidlo
    .ActiveDocument.Bookmarks("SpoluzadZamSidlo").Select
    .Selection.TypeText Text:=SpoluzadZamSidlo
    
    .ActiveDocument.Bookmarks("HlavZadZamTypSml").Select
    .Selection.TypeText Text:=HlavZadZamTypSml
    .ActiveDocument.Bookmarks("SpoluzadZamTypSml").Select
    .Selection.TypeText Text:=SpoluzadZamTypSml
    
    .ActiveDocument.Bookmarks("HlavZadZamSmlDo").Select
    .Selection.TypeText Text:=HlavZadZamSmlDo
    .ActiveDocument.Bookmarks("SpoluzadZamSmlDo").Select
    .Selection.TypeText Text:=SpoluzadZamSmlDo
    
    .ActiveDocument.Bookmarks("HlavZadZamTel").Select
    .Selection.TypeText Text:=HlavZadZamTel
    .ActiveDocument.Bookmarks("SpoluzadZamTel").Select
    .Selection.TypeText Text:=SpoluzadZamTel
    
    .ActiveDocument.Bookmarks("HlavZadZamPrijem3M").Select
    .Selection.TypeText Text:=HlavZadZamPrijem3M
    .ActiveDocument.Bookmarks("SpoluzadZamPrijem3M").Select
    .Selection.TypeText Text:=SpoluzadZamPrijem3M
    
    .ActiveDocument.Bookmarks("HlavZadZamZkusebDoba").Select
    .Selection.TypeText Text:=HlavZadZamZkusebDoba
    .ActiveDocument.Bookmarks("SpoluzadZamZkusebDob").Select
    .Selection.TypeText Text:=SpoluzadZamZkusebDob
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatJmeno").Select
    .Selection.TypeText Text:=HlavZadPodnikatJmeno
    .ActiveDocument.Bookmarks("SpoluzadPodnikatJmen").Select
    .Selection.TypeText Text:=SpoluzadPodnikatJmen
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatICO").Select
    .Selection.TypeText Text:=HlavZadPodnikatICO
    .ActiveDocument.Bookmarks("SpoluzadPodnikatICO").Select
    .Selection.TypeText Text:=SpoluzadPodnikatICO
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatSidlo").Select
    .Selection.TypeText Text:=HlavZadPodnikatSidlo
    .ActiveDocument.Bookmarks("SpoluzadPodnikatSidl").Select
    .Selection.TypeText Text:=SpoluzadPodnikatSidl
    
    .ActiveDocument.Bookmarks("SpoluzadPodnPrij12M").Select
    .Selection.TypeText Text:=SpoluzadPodnPrij12M
    .ActiveDocument.Bookmarks("SpoluzadPodnikatPrijem12M").Select
    .Selection.TypeText Text:=SpoluzadPodnikatPrijem12M
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatObor").Select
    .Selection.TypeText Text:=HlavZadPodnikatObor
    .ActiveDocument.Bookmarks("SpoluzadPodnikatObor").Select
    .Selection.TypeText Text:=SpoluzadPodnikatObor
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatDatZa").Select
    .Selection.TypeText Text:=HlavZadPodnikatDatZa
    .ActiveDocument.Bookmarks("SpoluzadPodnikatDatZ").Select
    .Selection.TypeText Text:=SpoluzadPodnikatDatZ
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu1").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu1
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu1").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu1
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu1").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu1
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu1").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu1
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu2").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu2
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu2").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu2
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu2").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu2
    .ActiveDocument.Bookmarks("SpoluzadCastkaPrijmu2").Select
    .Selection.TypeText Text:=SpoluzadCastkaPrijmu2
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu3").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu3
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu3").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu3
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu3").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu3
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu3").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu3
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu4").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu4
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu4").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu4
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu4").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu4
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu4").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu4
    
    .ActiveDocument.Bookmarks("HlavZadVydSplatUveru").Select
    .Selection.TypeText Text:=HlavZadVydSplatUveru
    .ActiveDocument.Bookmarks("SpoluzadVydSplatUver").Select
    .Selection.TypeText Text:=SpoluzadVydSplatUver
    
    .ActiveDocument.Bookmarks("HlavZadVydLimitKTK").Select
    .Selection.TypeText Text:=HlavZadVydLimitKTK
    .ActiveDocument.Bookmarks("SpoluzadVydLimitKTK").Select
    .Selection.TypeText Text:=SpoluzadVydLimitKTK
    
    .ActiveDocument.Bookmarks("HlavZadVydLimitKK").Select
    .Selection.TypeText Text:=HlavZadVydLimitKK
    .ActiveDocument.Bookmarks("SpoluzadVydLimitKK").Select
    .Selection.TypeText Text:=SpoluzadVydLimitKK
    
    .ActiveDocument.Bookmarks("HlavZadVydSplatLeasi").Select
    .Selection.TypeText Text:=HlavZadVydSplatLeasi
    .ActiveDocument.Bookmarks("SpoluzadVydSplatLeas").Select
    .Selection.TypeText Text:=SpoluzadVydSplatLeas
    
    .ActiveDocument.Bookmarks("HlavZadVydSrazZeMzdy").Select
    .Selection.TypeText Text:=HlavZadVydSrazZeMzdy
    .ActiveDocument.Bookmarks("SpoluzadVydSrazZeMzd").Select
    .Selection.TypeText Text:=SpoluzadVydSrazZeMzd
    
    .ActiveDocument.Bookmarks("HlavZadVydVyzivne").Select
    .Selection.TypeText Text:=HlavZadVydVyzivne
    .ActiveDocument.Bookmarks("SpoluzadVydVyzivne").Select
    .Selection.TypeText Text:=SpoluzadVydVyzivne
    
    .ActiveDocument.Bookmarks("HlavZadVydZavazVuciD").Select
    .Selection.TypeText Text:=HlavZadVydZavazVuciD
    .ActiveDocument.Bookmarks("SpoluzadVydZavazVuci").Select
    .Selection.TypeText Text:=SpoluzadVydZavazVuci
    
    .ActiveDocument.Bookmarks("HlavZadVydNemovitost").Select
    .Selection.TypeText Text:=HlavZadVydNemovitost
    .ActiveDocument.Bookmarks("SpoluzadVydNemovitos").Select
    .Selection.TypeText Text:=SpoluzadVydNemovitos
    
    .ActiveDocument.Bookmarks("HlavZadVydDalsi").Select
    .Selection.TypeText Text:=HlavZadVydDalsi
    .ActiveDocument.Bookmarks("SpoluzadVydDalsi").Select
    .Selection.TypeText Text:=SpoluzadVydDalsi
    
    
    
    
    
    .ActiveDocument.Bookmarks("NemovitostVyuziti").Select
    .Selection.TypeText Text:=NemovitostVyuziti
    .ActiveDocument.Bookmarks("datumCasTisku").Select
    .Selection.TypeText Text:=datumCasTisku
    .ActiveDocument.Bookmarks("PredmetZastavy").Select
    .Selection.TypeText Text:=PredmetZastavy
    .ActiveDocument.Bookmarks("NemovitostCena").Select
    .Selection.TypeText Text:=NemovitostCena
    .ActiveDocument.Bookmarks("ZdrojeVlastni").Select
    .Selection.TypeText Text:=ZdrojeVlastni
    .ActiveDocument.Bookmarks("ZdrojeCizi").Select
    .Selection.TypeText Text:=ZdrojeCizi
    
    .ActiveDocument.Bookmarks("NemovitostAdrUlice").Select
    .Selection.TypeText Text:=NemovitostAdrUlice
    .ActiveDocument.Bookmarks("NemovitostAdrMesto").Select
    .Selection.TypeText Text:=NemovitostAdrMesto
    .ActiveDocument.Bookmarks("NemovitostAdrPSC").Select
    .Selection.TypeText Text:=NemovitostAdrPSC
    
    .ActiveDocument.Bookmarks("UverTyp").Select
    .Selection.TypeText Text:=UverTyp
    .ActiveDocument.Bookmarks("UverVyse").Select
    .Selection.TypeText Text:=UverVyse
    .ActiveDocument.Bookmarks("UverDoplnCast").Select
    .Selection.TypeText Text:=UverDoplnCast
    .ActiveDocument.Bookmarks("UverCelkVyse").Select
    .Selection.TypeText Text:=UverCelkVyse
    .ActiveDocument.Bookmarks("PocetSplatek").Select
    .Selection.TypeText Text:=PocetSplatek
    .ActiveDocument.Bookmarks("AnuitSplaceniAzPoDoc").Select
    .Selection.TypeText Text:=AnuitSplaceniAzPoDoc
    .ActiveDocument.Bookmarks("PozadovFixace").Select
    .Selection.TypeText Text:=PozadovFixace
    .ActiveDocument.Bookmarks("PojistSchopSplacet").Select
    .Selection.TypeText Text:=PojistSchopSplacet
    .ActiveDocument.Bookmarks("TypZadatele").Select
    .Selection.TypeText Text:=TypZadatele
    .ActiveDocument.Bookmarks("TypZadatele6Padem").Select
    .Selection.TypeText Text:=TypZadatele6Padem
    
'    .ActiveDocument.Bookmarks("ucelUveru_koupe").Select
'    Selection.Value Value:=ucelUveru_koupe
    .ActiveDocument.FormFields("ucelUveru_koupe").CheckBox.Value = ucelUveru_koupe
    .ActiveDocument.FormFields("ucelUveru_DanZNabiti").CheckBox.Value = ucelUveru_DanZNabiti
    .ActiveDocument.FormFields("ucelUveru_prevodPrav").CheckBox.Value = ucelUveru_prevodPrav
    .ActiveDocument.FormFields("ucelUveru_refinanc").CheckBox.Value = ucelUveru_refinanc
    .ActiveDocument.FormFields("ucelUveru_VyplaDluhu").CheckBox.Value = ucelUveru_VyplaDluhu
    .ActiveDocument.FormFields("ucelUveru_VystavbRek").CheckBox.Value = ucelUveru_VystavbRek
    .ActiveDocument.FormFields("ucelUveru_ZpetPropla").CheckBox.Value = ucelUveru_ZpetPropla
    .ActiveDocument.FormFields("ucelUveru_BezUcelu").CheckBox.Value = ucelUveru_BezUcelu
    .ActiveDocument.FormFields("ucelUveru_Konsolidac").CheckBox.Value = ucelUveru_Konsolidac
    .ActiveDocument.FormFields("ucelUveru_NaPronajem").CheckBox.Value = ucelUveru_NaPronajem
    .ActiveDocument.FormFields("ucelUveru_Ostatni").CheckBox.Value = ucelUveru_Ostatni

        'vymazat l|fffd|ka|fffd|sk|fffd| dotazn|fffd|k, pokud nen|fffd| poji|fffd|t|fffd|n|fffd|
                If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    Dim pocetSekci As Integer
                    pocetSekci = .documents(1).Sections.Count
                    .documents(1).Sections(pocetSekci).Range.Delete
                    .documents(1).Bookmarks("\EndOfDoc").Select
                    With novy_dokument.Selection
                        .EndKey
                        .TypeBackspace
                    End With
                Else
                    'jinak naplnit hodnoty do l|fffd|ka|fffd|sk|fffd|ho dotazn|fffd|ku
                    Dim pojisteniLekarDotazVyseUveru
                    pojisteniLekarDotazVyseUveru = ThisWorkbook.Sheets("Zadost").Range("D100").Value
                    Dim pojisteniLekarDotazDobaSplaceniLet
                    pojisteniLekarDotazDobaSplaceniLet = ThisWorkbook.Sheets("Zadost").Range("D101").Value
                    Dim pojisteniLekarDotazProdejceJmeno
                    pojisteniLekarDotazProdejceJmeno = ThisWorkbook.Sheets("Zadost").Range("D102").Value
                    Dim pojisteniLekarDotazProdejceTel
                    pojisteniLekarDotazProdejceTel = ThisWorkbook.Sheets("Zadost").Range("D103").Value
                    Dim pojisteniLekarDotazProdejceEmail
                    pojisteniLekarDotazProdejceEmail = ThisWorkbook.Sheets("Zadost").Range("D105").Value
        Dim pojLekarDotazStand
        pojLekarDotazStand = ThisWorkbook.Sheets("Zadost").Range("D106").Value
        Dim pojLekarDotazPlus
        pojLekarDotazPlus = ThisWorkbook.Sheets("Zadost").Range("D107").Value
''        Dim pojLekarDotazKlasik
''        pojLekarDotazKlasik = ThisWorkbook.Sheets("Zadost").Range("D108").Value
''        Dim pojLekarDotazPremium
''        pojLekarDotazPremium = ThisWorkbook.Sheets("Zadost").Range("D109").Value
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazVyseUveru").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazVyseUveru
                            
                    .documents(1).Bookmarks("pojisteniLekarDotazDobaSplaceniLet").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazDobaSplaceniLet
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceJmeno").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceJmeno
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceTel").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceTel
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceEmail").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceEmail
                    'za|fffd|krt|fffd|vac|fffd| pole
''                     .documents(1).FormFields("pojLekarDotazKlasik").CheckBox.Value = pojLekarDotazKlasik
''                     .documents(1).FormFields("pojLekarDotazPremium").CheckBox.Value = pojLekarDotazPremium
                     .documents(1).FormFields("pojLekarDotazStand").CheckBox.Value = pojLekarDotazStand
                     .documents(1).FormFields("pojLekarDotazPlus").CheckBox.Value = pojLekarDotazPlus
                End If

.ActiveDocument.Save 'As Filename:=saveasnamePDF
Dim saveasnamePDF
saveasnamePDF = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
'17 is the value of the symbolic constant wdFormatPDF.
.ActiveDocument.SaveAs saveasnamePDF, 17
    
''mo|fffd|no zav|fffd||fffd|t jen toto okno
'.ActiveWindow.Close
End With

'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
    
    If wd.documents.Count > 1 Then
        wd.documents(1).Close SaveChanges:=True
        Else
        wd.Quit SaveChanges:=True
    End If

Set wd = Nothing
Set ulozeny_word = Nothing
Set novy_dokument = Nothing
    
'aktivuje v Excelu bu|fffd|ku..
'ThisWorkbook.Sheets("Zadost").Range("A1").Select
ThisWorkbook.Sheets("Zadost").Select
Range("A1").Select
ThisWorkbook.Sheets("Zadost").Visible = False
ThisWorkbook.Sheets("1_Kalkulace").Select
Application.ScreenUpdating = ScreenUpdatingStavPred


''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou |fffd||fffd|dost?" _
'', vbYesNo + vbQuestion, "Otev|fffd||fffd|t |fffd||fffd|dost pro editaci?")
''    Select Case YesNo
''    Case vbYes
    Dim myval
    myval = Shell("explorer " & SaveAsName, 1)
''    Case vbNo
''    End Select
End Sub
    
Sub ZadostKlasikPremium()
If Val(ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Value) > 2 Then
    MsgBox "Do |fffd||fffd|dosti se propisuj|fffd| pouze |fffd|daje pro hlavn|fffd|ho |fffd|adatele a jednoho spoludlu|fffd|n|fffd|ka. " & vbNewLine & vbNewLine & "V p|fffd||fffd|pad|fffd| v|fffd|ce |fffd|adatel|fffd| je t|fffd|eba |fffd|daje doplnit ru|fffd|n|fffd| p|fffd||fffd|mo do |fffd||fffd|dosti.", vbInformation, "|fffd||fffd|DOST - Upozorn|fffd|n|fffd|"
End If
Dim ScreenUpdatingStavPred As Boolean
ScreenUpdatingStavPred = Application.ScreenUpdating
Application.ScreenUpdating = False

'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku

' Zadost , vypln|fffd|n|fffd| zadan|fffd|ch |fffd|daj|fffd| do |fffd|ablony
Dim wd As Object
ThisWorkbook.Sheets("Zadost").Visible = True
ThisWorkbook.Sheets("Zadost").Select

'prom|fffd|nn|fffd| z Excelu
Dim CisloObchZast
CisloObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D4").Value)
Dim NazSpolObchZast
NazSpolObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D5").Value)
Dim MobTelObchZast
MobTelObchZast = CStr(ThisWorkbook.Sheets("Zadost").Range("D6").Value)

Dim HlavZadJmeno
HlavZadJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("D7").Value)
Dim SpoluzadJmeno
SpoluzadJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("E7").Value)

Dim HlavZadRodneCislo
HlavZadRodneCislo = CStr(ThisWorkbook.Sheets("Zadost").Range("D8").Value)
Dim SpoluzadRodneCislo
SpoluzadRodneCislo = CStr(ThisWorkbook.Sheets("Zadost").Range("E8").Value)

Dim HlavZadDatumNar
HlavZadDatumNar = CStr(ThisWorkbook.Sheets("Zadost").Range("D9").Value)
Dim SpoluzadDatumNar
SpoluzadDatumNar = CStr(ThisWorkbook.Sheets("Zadost").Range("E9").Value)

Dim HlavZadStatPrislus
HlavZadStatPrislus = CStr(ThisWorkbook.Sheets("Zadost").Range("D10").Value)
Dim SpoluzadStatPrislus
SpoluzadStatPrislus = CStr(ThisWorkbook.Sheets("Zadost").Range("E10").Value)

Dim HlavZadPohlavi
HlavZadPohlavi = CStr(ThisWorkbook.Sheets("Zadost").Range("D11").Value)
Dim SpoluzadPohlavi
SpoluzadPohlavi = CStr(ThisWorkbook.Sheets("Zadost").Range("E11").Value)

Dim SpoluzadRodPomerVuci
SpoluzadRodPomerVuci = CStr(ThisWorkbook.Sheets("Zadost").Range("E12").Value)

Dim HlavZadTypDokladuTot
HlavZadTypDokladuTot = CStr(ThisWorkbook.Sheets("Zadost").Range("D13").Value)
Dim SpoluzadTypDokladuTo
SpoluzadTypDokladuTo = CStr(ThisWorkbook.Sheets("Zadost").Range("E13").Value)

Dim HlavZadCisloDokladuT
HlavZadCisloDokladuT = CStr(ThisWorkbook.Sheets("Zadost").Range("D14").Value)
Dim SpoluzadCisloDokladu
SpoluzadCisloDokladu = CStr(ThisWorkbook.Sheets("Zadost").Range("E14").Value)

Dim HlavZadNejvysDosazVz
HlavZadNejvysDosazVz = CStr(ThisWorkbook.Sheets("Zadost").Range("D15").Value)
Dim SpoluzadNejvysDosazV
SpoluzadNejvysDosazV = CStr(ThisWorkbook.Sheets("Zadost").Range("E15").Value)

Dim HlavZadStav
HlavZadStav = CStr(ThisWorkbook.Sheets("Zadost").Range("D16").Value)
Dim SpoluzadStav
SpoluzadStav = CStr(ThisWorkbook.Sheets("Zadost").Range("E16").Value)

Dim HlavZadPocClenuDom
HlavZadPocClenuDom = CStr(ThisWorkbook.Sheets("Zadost").Range("D17").Value)
Dim SpoluzadPocClenuDom
SpoluzadPocClenuDom = CStr(ThisWorkbook.Sheets("Zadost").Range("E17").Value)

Dim HlavZadTypBydl
HlavZadTypBydl = CStr(ThisWorkbook.Sheets("Zadost").Range("D18").Value)
Dim SpoluzadTypBydl
SpoluzadTypBydl = CStr(ThisWorkbook.Sheets("Zadost").Range("E18").Value)

Dim HlavZadAdrTrvUlice
HlavZadAdrTrvUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("D19").Value)
Dim SpoluzadAdrTrvUlice
SpoluzadAdrTrvUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("E19").Value)

Dim HlavZadAdrTrvMesto
HlavZadAdrTrvMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("D20").Value)
Dim SpoluzadAdrTrvMesto
SpoluzadAdrTrvMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("E20").Value)

Dim HlavZadAdrTrvPSC
HlavZadAdrTrvPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D21").Value)
Dim SpoluzadAdrTrvPSC
SpoluzadAdrTrvPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("E21").Value)

Dim HlavZadAdrTrvStat
HlavZadAdrTrvStat = CStr(ThisWorkbook.Sheets("Zadost").Range("D22").Value)
Dim SpoluzadAdrTrvStat
SpoluzadAdrTrvStat = CStr(ThisWorkbook.Sheets("Zadost").Range("E22").Value)

Dim HlavZadAdrKorespUlic
HlavZadAdrKorespUlic = CStr(ThisWorkbook.Sheets("Zadost").Range("D23").Value)
Dim SpoluzadAdrKorespUli
SpoluzadAdrKorespUli = CStr(ThisWorkbook.Sheets("Zadost").Range("E23").Value)

Dim HlavZadAdrKorespMest
HlavZadAdrKorespMest = CStr(ThisWorkbook.Sheets("Zadost").Range("D24").Value)
Dim SpoluzadAdrKorespMes
SpoluzadAdrKorespMes = CStr(ThisWorkbook.Sheets("Zadost").Range("E24").Value)

Dim HlavZadAdrKorespPSC
HlavZadAdrKorespPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D25").Value)
Dim SpoluzadAdrKorespPSC
SpoluzadAdrKorespPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("E25").Value)

Dim HlavZadAdrKorespStat
HlavZadAdrKorespStat = CStr(ThisWorkbook.Sheets("Zadost").Range("D26").Value)
Dim SpoluzadAdrKorespSta
SpoluzadAdrKorespSta = CStr(ThisWorkbook.Sheets("Zadost").Range("E26").Value)

Dim HlavZadTelDomu
HlavZadTelDomu = CStr(ThisWorkbook.Sheets("Zadost").Range("D27").Value)
Dim SpoluzadTelDomu
SpoluzadTelDomu = CStr(ThisWorkbook.Sheets("Zadost").Range("E27").Value)

Dim HlavZadMobTel
HlavZadMobTel = CStr(ThisWorkbook.Sheets("Zadost").Range("D28").Value)
Dim SpoluzadMobTel
SpoluzadMobTel = CStr(ThisWorkbook.Sheets("Zadost").Range("E28").Value)

Dim HlavZadEmail
HlavZadEmail = CStr(ThisWorkbook.Sheets("Zadost").Range("D29").Value)
Dim SpoluzadEmail
SpoluzadEmail = CStr(ThisWorkbook.Sheets("Zadost").Range("E29").Value)

Dim HlavZadZamPredmetCin
HlavZadZamPredmetCin = CStr(ThisWorkbook.Sheets("Zadost").Range("D30").Value)
Dim SpoluzadZamPredmetCi
SpoluzadZamPredmetCi = CStr(ThisWorkbook.Sheets("Zadost").Range("E30").Value)

Dim HlavZadZamPracPozice
HlavZadZamPracPozice = CStr(ThisWorkbook.Sheets("Zadost").Range("D31").Value)
Dim SpoluzadZamPracPozic
SpoluzadZamPracPozic = CStr(ThisWorkbook.Sheets("Zadost").Range("E31").Value)

Dim HlavZadZamOd
HlavZadZamOd = CStr(ThisWorkbook.Sheets("Zadost").Range("D32").Value)
Dim SpoluzadZamOd
SpoluzadZamOd = CStr(ThisWorkbook.Sheets("Zadost").Range("E32").Value)

Dim HlavZadZamNazev
HlavZadZamNazev = CStr(ThisWorkbook.Sheets("Zadost").Range("D33").Value)
Dim SpoluzadZamNazev
SpoluzadZamNazev = CStr(ThisWorkbook.Sheets("Zadost").Range("E33").Value)

Dim HlavZadZamICO
HlavZadZamICO = CStr(ThisWorkbook.Sheets("Zadost").Range("D34").Value)
Dim SpoluzadZamICO
SpoluzadZamICO = CStr(ThisWorkbook.Sheets("Zadost").Range("E34").Value)

Dim HlavZadZamSidlo
HlavZadZamSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("D35").Value)
Dim SpoluzadZamSidlo
SpoluzadZamSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("E35").Value)

Dim HlavZadZamTypSml
HlavZadZamTypSml = CStr(ThisWorkbook.Sheets("Zadost").Range("D36").Value)
Dim SpoluzadZamTypSml
SpoluzadZamTypSml = CStr(ThisWorkbook.Sheets("Zadost").Range("E36").Value)

Dim HlavZadZamSmlDo
HlavZadZamSmlDo = CStr(ThisWorkbook.Sheets("Zadost").Range("D37").Value)
Dim SpoluzadZamSmlDo
SpoluzadZamSmlDo = CStr(ThisWorkbook.Sheets("Zadost").Range("E37").Value)

Dim HlavZadZamTel
HlavZadZamTel = CStr(ThisWorkbook.Sheets("Zadost").Range("D38").Value)
Dim SpoluzadZamTel
SpoluzadZamTel = CStr(ThisWorkbook.Sheets("Zadost").Range("E38").Value)

Dim HlavZadZamPrijem3M
HlavZadZamPrijem3M = CStr(ThisWorkbook.Sheets("Zadost").Range("D39").Value)
Dim SpoluzadZamPrijem3M
SpoluzadZamPrijem3M = CStr(ThisWorkbook.Sheets("Zadost").Range("E39").Value)

Dim HlavZadZamZkusebDoba
HlavZadZamZkusebDoba = CStr(ThisWorkbook.Sheets("Zadost").Range("D40").Value)
Dim SpoluzadZamZkusebDob
SpoluzadZamZkusebDob = CStr(ThisWorkbook.Sheets("Zadost").Range("E40").Value)

Dim HlavZadPodnikatJmeno
HlavZadPodnikatJmeno = CStr(ThisWorkbook.Sheets("Zadost").Range("D41").Value)
Dim SpoluzadPodnikatJmen
SpoluzadPodnikatJmen = CStr(ThisWorkbook.Sheets("Zadost").Range("E41").Value)

Dim HlavZadPodnikatICO
HlavZadPodnikatICO = CStr(ThisWorkbook.Sheets("Zadost").Range("D42").Value)
Dim SpoluzadPodnikatICO
SpoluzadPodnikatICO = CStr(ThisWorkbook.Sheets("Zadost").Range("E42").Value)

Dim HlavZadPodnikatSidlo
HlavZadPodnikatSidlo = CStr(ThisWorkbook.Sheets("Zadost").Range("D43").Value)
Dim SpoluzadPodnikatSidl
SpoluzadPodnikatSidl = CStr(ThisWorkbook.Sheets("Zadost").Range("E43").Value)

Dim SpoluzadPodnPrij12M
SpoluzadPodnPrij12M = CStr(ThisWorkbook.Sheets("Zadost").Range("D44").Value)
Dim SpoluzadPodnikatPrijem12M
SpoluzadPodnikatPrijem12M = CStr(ThisWorkbook.Sheets("Zadost").Range("E44").Value)

Dim HlavZadPodnikatObor
HlavZadPodnikatObor = CStr(ThisWorkbook.Sheets("Zadost").Range("D45").Value)
Dim SpoluzadPodnikatObor
SpoluzadPodnikatObor = CStr(ThisWorkbook.Sheets("Zadost").Range("E45").Value)

Dim HlavZadPodnikatDatZa
HlavZadPodnikatDatZa = CStr(ThisWorkbook.Sheets("Zadost").Range("D46").Value)
Dim SpoluzadPodnikatDatZ
SpoluzadPodnikatDatZ = CStr(ThisWorkbook.Sheets("Zadost").Range("E46").Value)

Dim HlavZadTypPrijmu1
HlavZadTypPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("D47").Value)
Dim SpoluzadTypPrijmu1
SpoluzadTypPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("E47").Value)

Dim HlavZadCastkaPrijmu1
HlavZadCastkaPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("D48").Value)
Dim SpoluzadCastkPrijmu1
SpoluzadCastkPrijmu1 = CStr(ThisWorkbook.Sheets("Zadost").Range("E48").Value)

Dim HlavZadTypPrijmu2
HlavZadTypPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("D49").Value)
Dim SpoluzadTypPrijmu2
SpoluzadTypPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("E49").Value)

Dim HlavZadCastkaPrijmu2
HlavZadCastkaPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("D50").Value)
Dim SpoluzadCastkaPrijmu2
SpoluzadCastkaPrijmu2 = CStr(ThisWorkbook.Sheets("Zadost").Range("E50").Value)

Dim HlavZadTypPrijmu3
HlavZadTypPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("D51").Value)
Dim SpoluzadTypPrijmu3
SpoluzadTypPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("E51").Value)

Dim HlavZadCastkaPrijmu3
HlavZadCastkaPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("D52").Value)
Dim SpoluzadCastkPrijmu3
SpoluzadCastkPrijmu3 = CStr(ThisWorkbook.Sheets("Zadost").Range("E52").Value)

Dim HlavZadTypPrijmu4
HlavZadTypPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("D53").Value)
Dim SpoluzadTypPrijmu4
SpoluzadTypPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("E53").Value)

Dim HlavZadCastkaPrijmu4
HlavZadCastkaPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("D54").Value)
Dim SpoluzadCastkPrijmu4
SpoluzadCastkPrijmu4 = CStr(ThisWorkbook.Sheets("Zadost").Range("E54").Value)

Dim HlavZadVydSplatUveru
HlavZadVydSplatUveru = CStr(ThisWorkbook.Sheets("Zadost").Range("D55").Value)
Dim SpoluzadVydSplatUver
SpoluzadVydSplatUver = CStr(ThisWorkbook.Sheets("Zadost").Range("E55").Value)

Dim HlavZadVydLimitKTK
HlavZadVydLimitKTK = CStr(ThisWorkbook.Sheets("Zadost").Range("D56").Value)
Dim SpoluzadVydLimitKTK
SpoluzadVydLimitKTK = CStr(ThisWorkbook.Sheets("Zadost").Range("E56").Value)

Dim HlavZadVydLimitKK
HlavZadVydLimitKK = CStr(ThisWorkbook.Sheets("Zadost").Range("D57").Value)
Dim SpoluzadVydLimitKK
SpoluzadVydLimitKK = CStr(ThisWorkbook.Sheets("Zadost").Range("E57").Value)

Dim HlavZadVydSplatLeasi
HlavZadVydSplatLeasi = CStr(ThisWorkbook.Sheets("Zadost").Range("D58").Value)
Dim SpoluzadVydSplatLeas
SpoluzadVydSplatLeas = CStr(ThisWorkbook.Sheets("Zadost").Range("E58").Value)

Dim HlavZadVydSrazZeMzdy
HlavZadVydSrazZeMzdy = CStr(ThisWorkbook.Sheets("Zadost").Range("D59").Value)
Dim SpoluzadVydSrazZeMzd
SpoluzadVydSrazZeMzd = CStr(ThisWorkbook.Sheets("Zadost").Range("E59").Value)

Dim HlavZadVydVyzivne
HlavZadVydVyzivne = CStr(ThisWorkbook.Sheets("Zadost").Range("D60").Value)
Dim SpoluzadVydVyzivne
SpoluzadVydVyzivne = CStr(ThisWorkbook.Sheets("Zadost").Range("E60").Value)

Dim HlavZadVydZavazVuciD
HlavZadVydZavazVuciD = CStr(ThisWorkbook.Sheets("Zadost").Range("D61").Value)
Dim SpoluzadVydZavazVuci
SpoluzadVydZavazVuci = CStr(ThisWorkbook.Sheets("Zadost").Range("E61").Value)

Dim HlavZadVydNemovitost
HlavZadVydNemovitost = CStr(ThisWorkbook.Sheets("Zadost").Range("D62").Value)
Dim SpoluzadVydNemovitos
SpoluzadVydNemovitos = CStr(ThisWorkbook.Sheets("Zadost").Range("E62").Value)

Dim HlavZadVydDalsi
HlavZadVydDalsi = CStr(ThisWorkbook.Sheets("Zadost").Range("D63").Value)
Dim SpoluzadVydDalsi
SpoluzadVydDalsi = CStr(ThisWorkbook.Sheets("Zadost").Range("E63").Value)

Dim datumCasTisku
datumCasTisku = CStr(ThisWorkbook.Sheets("Zadost").Range("D64").Value)

Dim NemovitostVyuziti
NemovitostVyuziti = CStr(ThisWorkbook.Sheets("Zadost").Range("D65").Value)
Dim PredmetZastavy
PredmetZastavy = CStr(ThisWorkbook.Sheets("Zadost").Range("D66").Value)
Dim NemovitostCena
NemovitostCena = CStr(ThisWorkbook.Sheets("Zadost").Range("D67").Value)
Dim ZdrojeVlastni
ZdrojeVlastni = CStr(ThisWorkbook.Sheets("Zadost").Range("D68").Value)
Dim ZdrojeCizi
ZdrojeCizi = CStr(ThisWorkbook.Sheets("Zadost").Range("D69").Value)
Dim NemovitostAdrUlice
NemovitostAdrUlice = CStr(ThisWorkbook.Sheets("Zadost").Range("D70").Value)
Dim NemovitostAdrMesto
NemovitostAdrMesto = CStr(ThisWorkbook.Sheets("Zadost").Range("D71").Value)
Dim NemovitostAdrPSC
NemovitostAdrPSC = CStr(ThisWorkbook.Sheets("Zadost").Range("D72").Value)

Dim UverTyp
UverTyp = CStr(ThisWorkbook.Sheets("Zadost").Range("D73").Value)

Dim UverVyse
UverVyse = CStr(ThisWorkbook.Sheets("Zadost").Range("D75").Value)
Dim UverDoplnCast
UverDoplnCast = CStr(ThisWorkbook.Sheets("Zadost").Range("D76").Value)
Dim UverCelkVyse
UverCelkVyse = CStr(ThisWorkbook.Sheets("Zadost").Range("D77").Value)
Dim PocetSplatek
PocetSplatek = CStr(ThisWorkbook.Sheets("Zadost").Range("D78").Value)
Dim AnuitSplaceniAzPoDoc
AnuitSplaceniAzPoDoc = CStr(ThisWorkbook.Sheets("Zadost").Range("D79").Value)
Dim PozadovFixace
PozadovFixace = CStr(ThisWorkbook.Sheets("Zadost").Range("D80").Value)
Dim PojistSchopSplacet
PojistSchopSplacet = CStr(ThisWorkbook.Sheets("Zadost").Range("D81").Value)
Dim TypZadatele
TypZadatele = CStr(ThisWorkbook.Sheets("Zadost").Range("D82").Value)
Dim TypZadatele6Padem
TypZadatele6Padem = CStr(ThisWorkbook.Sheets("Zadost").Range("E83").Value)

'za|fffd|krt|fffd|v|fffd|tka
Dim ucelUveru_koupe
ucelUveru_koupe = CStr(ThisWorkbook.Sheets("Zadost").Range("D84").Value)
Dim ucelUveru_DanZNabiti
ucelUveru_DanZNabiti = CStr(ThisWorkbook.Sheets("Zadost").Range("D85").Value)
Dim ucelUveru_prevodPrav
ucelUveru_prevodPrav = CStr(ThisWorkbook.Sheets("Zadost").Range("D86").Value)
Dim ucelUveru_refinanc
ucelUveru_refinanc = CStr(ThisWorkbook.Sheets("Zadost").Range("D87").Value)
Dim ucelUveru_VyplaDluhu
ucelUveru_VyplaDluhu = CStr(ThisWorkbook.Sheets("Zadost").Range("D88").Value)
Dim ucelUveru_VystavbRek
ucelUveru_VystavbRek = CStr(ThisWorkbook.Sheets("Zadost").Range("D89").Value)
Dim ucelUveru_ZpetPropla
ucelUveru_ZpetPropla = CStr(ThisWorkbook.Sheets("Zadost").Range("D90").Value)
Dim ucelUveru_BezUcelu
ucelUveru_BezUcelu = CStr(ThisWorkbook.Sheets("Zadost").Range("D91").Value)
Dim ucelUveru_Konsolidac
ucelUveru_Konsolidac = CStr(ThisWorkbook.Sheets("Zadost").Range("D92").Value)
Dim ucelUveru_NaPronajem
ucelUveru_NaPronajem = CStr(ThisWorkbook.Sheets("Zadost").Range("D93").Value)
Dim ucelUveru_Ostatni
ucelUveru_Ostatni = CStr(ThisWorkbook.Sheets("Zadost").Range("D94").Value)




'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)

' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"

'otev|fffd|en|fffd| objektu (jm|fffd|no je zde zadostWord2zadatele)
  ThisWorkbook.Sheets("Zadost").Shapes.Range("zadostWord2zadateleKlasikPrem").Select
  Selection.Verb Verb:=xlOpen
  
 
 'p|fffd|i|fffd|azen|fffd| instance wordu
 Set wd = GetObject(class:="Word.Application")
     wd.Visible = True

Dim nazev_souboru As String
nazev_souboru = "Zadost_" & Format(Now, "YYYY-MM-DD_HH-MM-SS")
'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
Dim SaveAsName
SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"

'ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
With wd
    .documents(1).SaveAs FileName:=SaveAsName
    .documents(1).Saved = True
    '''.ActiveWindow.Close
    .documents(1).Close SaveChanges:=False
End With
 
'otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
 Dim ulozeny_word As Object
 Set ulozeny_word = GetObject(SaveAsName)
'pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
 Dim novy_dokument As Object
 Set novy_dokument = ulozeny_word.Application
     novy_dokument.Visible = True
     
With novy_dokument
'upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
    .documents(1).Bookmarks("CisloObchZast").Select
    .Selection.TypeText Text:=CisloObchZast
    
    .documents(1).Bookmarks("NazSpolObchZast").Select
    .Selection.TypeText Text:=NazSpolObchZast
    
    .ActiveDocument.Bookmarks("MobTelObchZast").Select
    .Selection.TypeText Text:=MobTelObchZast
    
    .documents(1).Bookmarks("HlavZadJmeno").Select
    .Selection.TypeText Text:=HlavZadJmeno
    .documents(1).Bookmarks("SpoluzadJmeno").Select
    .Selection.TypeText Text:=SpoluzadJmeno
    
    .documents(1).Bookmarks("HlavZadJmeno2").Select
    .Selection.TypeText Text:=HlavZadJmeno
    .documents(1).Bookmarks("SpoluzadJmeno2").Select
    .Selection.TypeText Text:=SpoluzadJmeno
    
    .ActiveDocument.Bookmarks("HlavZadRodneCislo").Select
    .Selection.TypeText Text:=HlavZadRodneCislo
    .ActiveDocument.Bookmarks("SpoluzadRodneCislo").Select
    .Selection.TypeText Text:=SpoluzadRodneCislo
    
    .ActiveDocument.Bookmarks("HlavZadDatumNar").Select
    .Selection.TypeText Text:=HlavZadDatumNar
    .ActiveDocument.Bookmarks("SpoluzadDatumNar").Select
    .Selection.TypeText Text:=SpoluzadDatumNar
    
    .ActiveDocument.Bookmarks("HlavZadStatPrislus").Select
    .Selection.TypeText Text:=HlavZadStatPrislus
    .ActiveDocument.Bookmarks("SpoluzadStatPrislus").Select
    .Selection.TypeText Text:=SpoluzadStatPrislus
    
    .ActiveDocument.Bookmarks("HlavZadPohlavi").Select
    .Selection.TypeText Text:=HlavZadPohlavi
    .ActiveDocument.Bookmarks("SpoluzadPohlavi").Select
    .Selection.TypeText Text:=SpoluzadPohlavi
    
    .ActiveDocument.Bookmarks("SpoluzadRodPomerVuci").Select
    .Selection.TypeText Text:=SpoluzadRodPomerVuci
    
    .ActiveDocument.Bookmarks("HlavZadTypDokladuTot").Select
    .Selection.TypeText Text:=HlavZadTypDokladuTot
    .ActiveDocument.Bookmarks("SpoluzadTypDokladuTo").Select
    .Selection.TypeText Text:=SpoluzadTypDokladuTo

    .ActiveDocument.Bookmarks("HlavZadCisloDokladuT").Select
    .Selection.TypeText Text:=HlavZadCisloDokladuT
    .ActiveDocument.Bookmarks("SpoluzadCisloDokladu").Select
    .Selection.TypeText Text:=SpoluzadCisloDokladu
    
    .ActiveDocument.Bookmarks("HlavZadNejvysDosazVz").Select
    .Selection.TypeText Text:=HlavZadNejvysDosazVz
    .ActiveDocument.Bookmarks("SpoluzadNejvysDosazV").Select
    .Selection.TypeText Text:=SpoluzadNejvysDosazV

    .ActiveDocument.Bookmarks("HlavZadStav").Select
    .Selection.TypeText Text:=HlavZadStav
    .ActiveDocument.Bookmarks("SpoluzadStav").Select
    .Selection.TypeText Text:=SpoluzadStav
    
    .ActiveDocument.Bookmarks("HlavZadPocClenuDom").Select
    .Selection.TypeText Text:=HlavZadPocClenuDom
    .ActiveDocument.Bookmarks("SpoluzadPocClenuDom").Select
    .Selection.TypeText Text:=SpoluzadPocClenuDom
    
    .ActiveDocument.Bookmarks("HlavZadTypBydl").Select
    .Selection.TypeText Text:=HlavZadTypBydl
    .ActiveDocument.Bookmarks("SpoluzadTypBydl").Select
    .Selection.TypeText Text:=SpoluzadTypBydl
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvUlice").Select
    .Selection.TypeText Text:=HlavZadAdrTrvUlice
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvUlice").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvUlice
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvMesto").Select
    .Selection.TypeText Text:=HlavZadAdrTrvMesto
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvMesto").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvMesto
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvPSC").Select
    .Selection.TypeText Text:=HlavZadAdrTrvPSC
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvPSC").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvPSC
    
    .ActiveDocument.Bookmarks("HlavZadAdrTrvStat").Select
    .Selection.TypeText Text:=HlavZadAdrTrvStat
    .ActiveDocument.Bookmarks("SpoluzadAdrTrvStat").Select
    .Selection.TypeText Text:=SpoluzadAdrTrvStat
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespUlic").Select
    .Selection.TypeText Text:=HlavZadAdrKorespUlic
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespUli").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespUli
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespMest").Select
    .Selection.TypeText Text:=HlavZadAdrKorespMest
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespMes").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespMes
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespPSC").Select
    .Selection.TypeText Text:=HlavZadAdrKorespPSC
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespPSC").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespPSC
    
    .ActiveDocument.Bookmarks("HlavZadAdrKorespStat").Select
    .Selection.TypeText Text:=HlavZadAdrKorespStat
    .ActiveDocument.Bookmarks("SpoluzadAdrKorespSta").Select
    .Selection.TypeText Text:=SpoluzadAdrKorespSta
    
    .ActiveDocument.Bookmarks("HlavZadTelDomu").Select
    .Selection.TypeText Text:=HlavZadTelDomu
    .ActiveDocument.Bookmarks("SpoluzadTelDomu").Select
    .Selection.TypeText Text:=SpoluzadTelDomu
    
    .ActiveDocument.Bookmarks("HlavZadMobTel").Select
    .Selection.TypeText Text:=HlavZadMobTel
    .ActiveDocument.Bookmarks("SpoluzadMobTel").Select
    .Selection.TypeText Text:=SpoluzadMobTel
    
    .ActiveDocument.Bookmarks("HlavZadEmail").Select
    .Selection.TypeText Text:=HlavZadEmail
    .ActiveDocument.Bookmarks("SpoluzadEmail").Select
    .Selection.TypeText Text:=SpoluzadEmail
    
    .ActiveDocument.Bookmarks("HlavZadZamPredmetCin").Select
    .Selection.TypeText Text:=HlavZadZamPredmetCin
    .ActiveDocument.Bookmarks("SpoluzadZamPredmetCi").Select
    .Selection.TypeText Text:=SpoluzadZamPredmetCi
    
    .ActiveDocument.Bookmarks("HlavZadZamPracPozice").Select
    .Selection.TypeText Text:=HlavZadZamPracPozice
    .ActiveDocument.Bookmarks("SpoluzadZamPracPozic").Select
    .Selection.TypeText Text:=SpoluzadZamPracPozic
    
    .ActiveDocument.Bookmarks("HlavZadZamOd").Select
    .Selection.TypeText Text:=HlavZadZamOd
    .ActiveDocument.Bookmarks("SpoluzadZamOd").Select
    .Selection.TypeText Text:=SpoluzadZamOd
    
    .ActiveDocument.Bookmarks("HlavZadZamNazev").Select
    .Selection.TypeText Text:=HlavZadZamNazev
    .ActiveDocument.Bookmarks("SpoluzadZamNazev").Select
    .Selection.TypeText Text:=SpoluzadZamNazev
    
    .ActiveDocument.Bookmarks("HlavZadZamICO").Select
    .Selection.TypeText Text:=HlavZadZamICO
    .ActiveDocument.Bookmarks("SpoluzadZamICO").Select
    .Selection.TypeText Text:=SpoluzadZamICO
    
    .ActiveDocument.Bookmarks("HlavZadZamSidlo").Select
    .Selection.TypeText Text:=HlavZadZamSidlo
    .ActiveDocument.Bookmarks("SpoluzadZamSidlo").Select
    .Selection.TypeText Text:=SpoluzadZamSidlo
    
    .ActiveDocument.Bookmarks("HlavZadZamTypSml").Select
    .Selection.TypeText Text:=HlavZadZamTypSml
    .ActiveDocument.Bookmarks("SpoluzadZamTypSml").Select
    .Selection.TypeText Text:=SpoluzadZamTypSml
    
    .ActiveDocument.Bookmarks("HlavZadZamSmlDo").Select
    .Selection.TypeText Text:=HlavZadZamSmlDo
    .ActiveDocument.Bookmarks("SpoluzadZamSmlDo").Select
    .Selection.TypeText Text:=SpoluzadZamSmlDo
    
    .ActiveDocument.Bookmarks("HlavZadZamTel").Select
    .Selection.TypeText Text:=HlavZadZamTel
    .ActiveDocument.Bookmarks("SpoluzadZamTel").Select
    .Selection.TypeText Text:=SpoluzadZamTel
    
    .ActiveDocument.Bookmarks("HlavZadZamPrijem3M").Select
    .Selection.TypeText Text:=HlavZadZamPrijem3M
    .ActiveDocument.Bookmarks("SpoluzadZamPrijem3M").Select
    .Selection.TypeText Text:=SpoluzadZamPrijem3M
    
    .ActiveDocument.Bookmarks("HlavZadZamZkusebDoba").Select
    .Selection.TypeText Text:=HlavZadZamZkusebDoba
    .ActiveDocument.Bookmarks("SpoluzadZamZkusebDob").Select
    .Selection.TypeText Text:=SpoluzadZamZkusebDob
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatJmeno").Select
    .Selection.TypeText Text:=HlavZadPodnikatJmeno
    .ActiveDocument.Bookmarks("SpoluzadPodnikatJmen").Select
    .Selection.TypeText Text:=SpoluzadPodnikatJmen
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatICO").Select
    .Selection.TypeText Text:=HlavZadPodnikatICO
    .ActiveDocument.Bookmarks("SpoluzadPodnikatICO").Select
    .Selection.TypeText Text:=SpoluzadPodnikatICO
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatSidlo").Select
    .Selection.TypeText Text:=HlavZadPodnikatSidlo
    .ActiveDocument.Bookmarks("SpoluzadPodnikatSidl").Select
    .Selection.TypeText Text:=SpoluzadPodnikatSidl
    
    .ActiveDocument.Bookmarks("SpoluzadPodnPrij12M").Select
    .Selection.TypeText Text:=SpoluzadPodnPrij12M
    .ActiveDocument.Bookmarks("SpoluzadPodnikatPrijem12M").Select
    .Selection.TypeText Text:=SpoluzadPodnikatPrijem12M
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatObor").Select
    .Selection.TypeText Text:=HlavZadPodnikatObor
    .ActiveDocument.Bookmarks("SpoluzadPodnikatObor").Select
    .Selection.TypeText Text:=SpoluzadPodnikatObor
    
    .ActiveDocument.Bookmarks("HlavZadPodnikatDatZa").Select
    .Selection.TypeText Text:=HlavZadPodnikatDatZa
    .ActiveDocument.Bookmarks("SpoluzadPodnikatDatZ").Select
    .Selection.TypeText Text:=SpoluzadPodnikatDatZ
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu1").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu1
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu1").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu1
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu1").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu1
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu1").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu1
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu2").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu2
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu2").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu2
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu2").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu2
    .ActiveDocument.Bookmarks("SpoluzadCastkaPrijmu2").Select
    .Selection.TypeText Text:=SpoluzadCastkaPrijmu2
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu3").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu3
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu3").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu3
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu3").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu3
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu3").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu3
    
    .ActiveDocument.Bookmarks("HlavZadTypPrijmu4").Select
    .Selection.TypeText Text:=HlavZadTypPrijmu4
    .ActiveDocument.Bookmarks("SpoluzadTypPrijmu4").Select
    .Selection.TypeText Text:=SpoluzadTypPrijmu4
    .ActiveDocument.Bookmarks("HlavZadCastkaPrijmu4").Select
    .Selection.TypeText Text:=HlavZadCastkaPrijmu4
    .ActiveDocument.Bookmarks("SpoluzadCastkPrijmu4").Select
    .Selection.TypeText Text:=SpoluzadCastkPrijmu4
    
    .ActiveDocument.Bookmarks("HlavZadVydSplatUveru").Select
    .Selection.TypeText Text:=HlavZadVydSplatUveru
    .ActiveDocument.Bookmarks("SpoluzadVydSplatUver").Select
    .Selection.TypeText Text:=SpoluzadVydSplatUver
    
    .ActiveDocument.Bookmarks("HlavZadVydLimitKTK").Select
    .Selection.TypeText Text:=HlavZadVydLimitKTK
    .ActiveDocument.Bookmarks("SpoluzadVydLimitKTK").Select
    .Selection.TypeText Text:=SpoluzadVydLimitKTK
    
    .ActiveDocument.Bookmarks("HlavZadVydLimitKK").Select
    .Selection.TypeText Text:=HlavZadVydLimitKK
    .ActiveDocument.Bookmarks("SpoluzadVydLimitKK").Select
    .Selection.TypeText Text:=SpoluzadVydLimitKK
    
    .ActiveDocument.Bookmarks("HlavZadVydSplatLeasi").Select
    .Selection.TypeText Text:=HlavZadVydSplatLeasi
    .ActiveDocument.Bookmarks("SpoluzadVydSplatLeas").Select
    .Selection.TypeText Text:=SpoluzadVydSplatLeas
    
    .ActiveDocument.Bookmarks("HlavZadVydSrazZeMzdy").Select
    .Selection.TypeText Text:=HlavZadVydSrazZeMzdy
    .ActiveDocument.Bookmarks("SpoluzadVydSrazZeMzd").Select
    .Selection.TypeText Text:=SpoluzadVydSrazZeMzd
    
    .ActiveDocument.Bookmarks("HlavZadVydVyzivne").Select
    .Selection.TypeText Text:=HlavZadVydVyzivne
    .ActiveDocument.Bookmarks("SpoluzadVydVyzivne").Select
    .Selection.TypeText Text:=SpoluzadVydVyzivne
    
    .ActiveDocument.Bookmarks("HlavZadVydZavazVuciD").Select
    .Selection.TypeText Text:=HlavZadVydZavazVuciD
    .ActiveDocument.Bookmarks("SpoluzadVydZavazVuci").Select
    .Selection.TypeText Text:=SpoluzadVydZavazVuci
    
    .ActiveDocument.Bookmarks("HlavZadVydNemovitost").Select
    .Selection.TypeText Text:=HlavZadVydNemovitost
    .ActiveDocument.Bookmarks("SpoluzadVydNemovitos").Select
    .Selection.TypeText Text:=SpoluzadVydNemovitos
    
    .ActiveDocument.Bookmarks("HlavZadVydDalsi").Select
    .Selection.TypeText Text:=HlavZadVydDalsi
    .ActiveDocument.Bookmarks("SpoluzadVydDalsi").Select
    .Selection.TypeText Text:=SpoluzadVydDalsi
    
    
    
    
    
    .ActiveDocument.Bookmarks("NemovitostVyuziti").Select
    .Selection.TypeText Text:=NemovitostVyuziti
    .ActiveDocument.Bookmarks("datumCasTisku").Select
    .Selection.TypeText Text:=datumCasTisku
    .ActiveDocument.Bookmarks("PredmetZastavy").Select
    .Selection.TypeText Text:=PredmetZastavy
    .ActiveDocument.Bookmarks("NemovitostCena").Select
    .Selection.TypeText Text:=NemovitostCena
    .ActiveDocument.Bookmarks("ZdrojeVlastni").Select
    .Selection.TypeText Text:=ZdrojeVlastni
    .ActiveDocument.Bookmarks("ZdrojeCizi").Select
    .Selection.TypeText Text:=ZdrojeCizi
    
    .ActiveDocument.Bookmarks("NemovitostAdrUlice").Select
    .Selection.TypeText Text:=NemovitostAdrUlice
    .ActiveDocument.Bookmarks("NemovitostAdrMesto").Select
    .Selection.TypeText Text:=NemovitostAdrMesto
    .ActiveDocument.Bookmarks("NemovitostAdrPSC").Select
    .Selection.TypeText Text:=NemovitostAdrPSC
    
    .ActiveDocument.Bookmarks("UverTyp").Select
    .Selection.TypeText Text:=UverTyp
    .ActiveDocument.Bookmarks("UverVyse").Select
    .Selection.TypeText Text:=UverVyse
    .ActiveDocument.Bookmarks("UverDoplnCast").Select
    .Selection.TypeText Text:=UverDoplnCast
    .ActiveDocument.Bookmarks("UverCelkVyse").Select
    .Selection.TypeText Text:=UverCelkVyse
    .ActiveDocument.Bookmarks("PocetSplatek").Select
    .Selection.TypeText Text:=PocetSplatek
    .ActiveDocument.Bookmarks("AnuitSplaceniAzPoDoc").Select
    .Selection.TypeText Text:=AnuitSplaceniAzPoDoc
    .ActiveDocument.Bookmarks("PozadovFixace").Select
    .Selection.TypeText Text:=PozadovFixace
    .ActiveDocument.Bookmarks("PojistSchopSplacet").Select
    .Selection.TypeText Text:=PojistSchopSplacet
    .ActiveDocument.Bookmarks("TypZadatele").Select
    .Selection.TypeText Text:=TypZadatele
    .ActiveDocument.Bookmarks("TypZadatele6Padem").Select
    .Selection.TypeText Text:=TypZadatele6Padem
    
'    .ActiveDocument.Bookmarks("ucelUveru_koupe").Select
'    Selection.Value Value:=ucelUveru_koupe
    .ActiveDocument.FormFields("ucelUveru_koupe").CheckBox.Value = ucelUveru_koupe
    .ActiveDocument.FormFields("ucelUveru_DanZNabiti").CheckBox.Value = ucelUveru_DanZNabiti
    .ActiveDocument.FormFields("ucelUveru_prevodPrav").CheckBox.Value = ucelUveru_prevodPrav
    .ActiveDocument.FormFields("ucelUveru_refinanc").CheckBox.Value = ucelUveru_refinanc
    .ActiveDocument.FormFields("ucelUveru_VyplaDluhu").CheckBox.Value = ucelUveru_VyplaDluhu
    .ActiveDocument.FormFields("ucelUveru_VystavbRek").CheckBox.Value = ucelUveru_VystavbRek
    .ActiveDocument.FormFields("ucelUveru_ZpetPropla").CheckBox.Value = ucelUveru_ZpetPropla
    .ActiveDocument.FormFields("ucelUveru_BezUcelu").CheckBox.Value = ucelUveru_BezUcelu
    .ActiveDocument.FormFields("ucelUveru_Konsolidac").CheckBox.Value = ucelUveru_Konsolidac
    .ActiveDocument.FormFields("ucelUveru_NaPronajem").CheckBox.Value = ucelUveru_NaPronajem
    .ActiveDocument.FormFields("ucelUveru_Ostatni").CheckBox.Value = ucelUveru_Ostatni

        'vymazat l|fffd|ka|fffd|sk|fffd| dotazn|fffd|k, pokud nen|fffd| poji|fffd|t|fffd|n|fffd|
                If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
                    Dim pocetSekci As Integer
                    pocetSekci = .documents(1).Sections.Count
                    .documents(1).Sections(pocetSekci).Range.Delete
                    .documents(1).Bookmarks("\EndOfDoc").Select
'                    Application.SendKeys ("{LEFT}")
'                    Application.SendKeys ("{DELETE}")
'                    Application.SendKeys ("{DELETE}")
                    With novy_dokument.Selection
                        .EndKey
                        .MoveLeft
                        .Delete
'                        .TypeBackspace

'                        .TypeBackspace
'                        .TypeBackspace
''                        Application.SendKeys ("{LEFT}")
''                        Application.SendKeys ("{LEFT}")
'                        VBA.SendKeys ("{DELETE}")
'                        VBA.SendKeys ("{DELETE}")
''                        Selection.Delete Unit:=wdCharacter, Count:=1
''                        Selection.Delete Unit:=wdCharacter, Count:=1
                       End With
                Else
                    'jinak naplnit hodnoty do l|fffd|ka|fffd|sk|fffd|ho dotazn|fffd|ku
                    Dim pojisteniLekarDotazVyseUveru
                    pojisteniLekarDotazVyseUveru = ThisWorkbook.Sheets("Zadost").Range("D100").Value
                    Dim pojisteniLekarDotazDobaSplaceniLet
                    pojisteniLekarDotazDobaSplaceniLet = ThisWorkbook.Sheets("Zadost").Range("D101").Value
                    Dim pojisteniLekarDotazProdejceJmeno
                    pojisteniLekarDotazProdejceJmeno = ThisWorkbook.Sheets("Zadost").Range("D102").Value
                    Dim pojisteniLekarDotazProdejceTel
                    pojisteniLekarDotazProdejceTel = ThisWorkbook.Sheets("Zadost").Range("D103").Value
                    Dim pojisteniLekarDotazProdejceEmail
                    pojisteniLekarDotazProdejceEmail = ThisWorkbook.Sheets("Zadost").Range("D105").Value
''        Dim pojLekarDotazStand
''        pojLekarDotazStand = ThisWorkbook.Sheets("Zadost").Range("D106").Value
''        Dim pojLekarDotazPlus
''        pojLekarDotazPlus = ThisWorkbook.Sheets("Zadost").Range("D107").Value
        Dim pojLekarDotazKlasik
        pojLekarDotazKlasik = ThisWorkbook.Sheets("Zadost").Range("D108").Value
        Dim pojLekarDotazPremium
        pojLekarDotazPremium = ThisWorkbook.Sheets("Zadost").Range("D109").Value
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazVyseUveru").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazVyseUveru
                            
                    .documents(1).Bookmarks("pojisteniLekarDotazDobaSplaceniLet").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazDobaSplaceniLet
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceJmeno").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceJmeno
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceTel").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceTel
                    
                    .documents(1).Bookmarks("pojisteniLekarDotazProdejceEmail").Select
                    .Selection.TypeText Text:=pojisteniLekarDotazProdejceEmail
                    'za|fffd|krt|fffd|vac|fffd| pole
                     .documents(1).FormFields("pojLekarDotazKlasik").CheckBox.Value = pojLekarDotazKlasik
                     .documents(1).FormFields("pojLekarDotazPremium").CheckBox.Value = pojLekarDotazPremium
''                     .documents(1).FormFields("pojLekarDotazStand").CheckBox.Value = pojLekarDotazStand
''                     .documents(1).FormFields("pojLekarDotazPlus").CheckBox.Value = pojLekarDotazPlus
                End If

.ActiveDocument.Save 'As Filename:=saveasnamePDF
Dim saveasnamePDF
saveasnamePDF = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
'17 is the value of the symbolic constant wdFormatPDF.
.ActiveDocument.SaveAs saveasnamePDF, 17
    
''mo|fffd|no zav|fffd||fffd|t jen toto okno
'.ActiveWindow.Close
End With

'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
    
    If wd.documents.Count > 1 Then
        wd.documents(1).Close SaveChanges:=True
        Else
        wd.Quit SaveChanges:=True
    End If

Set wd = Nothing
Set ulozeny_word = Nothing
Set novy_dokument = Nothing
    
'aktivuje v Excelu bu|fffd|ku..
'ThisWorkbook.Sheets("Zadost").Range("A1").Select
ThisWorkbook.Sheets("Zadost").Select
Range("A1").Select
ThisWorkbook.Sheets("Zadost").Visible = False
ThisWorkbook.Sheets("1_Kalkulace").Select
Application.ScreenUpdating = ScreenUpdatingStavPred


''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovanou |fffd||fffd|dost?" _
'', vbYesNo + vbQuestion, "Otev|fffd||fffd|t |fffd||fffd|dost pro editaci?")
''    Select Case YesNo
''    Case vbYes
    Dim myval
    myval = Shell("explorer " & SaveAsName, 1)
''    Case vbNo
''    End Select
End Sub

Attribute VB_Name = "Module11"
Option Explicit
Dim ScreenUpdatingStavPred As Boolean
Dim chyba As Boolean

Sub vypocti_splatku()
Call kontrolaVyplneni
If chyba = True Then
    GoTo konec
End If

'pro p|fffd|edhypot|fffd||fffd|n|fffd| |fffd|v|fffd|r v|fffd|po|fffd|et p|fffd|eskakuje iteraci rovnou k RPSN (spl|fffd|tka pouze |fffd|rok|fffd| ze st|fffd|le stejn|fffd| jistiny -- spl|fffd|tka je zde = "suma |fffd|rok|fffd|" / "po|fffd|et m|fffd|s|fffd|c|fffd|")
If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C6").Value = "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r" Then ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H2").Value: GoTo lbl2

' V|fffd|po|fffd|et spl|fffd|tky pro DTI (DTI spl|fffd|tka, kdyby nebyla sleva na sazb|fffd|)
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G9").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H10").Value = Null
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = Null
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J7").Value 'nastartov|fffd|n|fffd| prvn|fffd| spl|fffd|tky vypo|fffd|ten|fffd| vzorcem v se|fffd|it|fffd|
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G469").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("E22"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2")
    'pokud rozd|fffd|l zaplacen|fffd| a vyp|fffd|j|fffd|en|fffd| |fffd||fffd|stky vy|fffd||fffd||fffd| ne|fffd| po|fffd|et m|fffd|s|fffd|c|fffd|, m|fffd|la by existovat i ni|fffd||fffd||fffd| varianta spl|fffd|tky
    If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G469").Value - ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("E22").Value > ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C7").Value Then
        ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value - 100
        ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G469").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("E22"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2")
    End If
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H10").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C8").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("D8").Value

' V|fffd|po|fffd|et spr|fffd|vn|fffd| spl|fffd|tky
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G469").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("E22"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2")
'blablabla ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Select

'pou|fffd|ije zaokrouhlen|fffd| spl|fffd|tky na cel|fffd| koruny vzorcem v bu|fffd|ce
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("H11").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G11").Value

lbl2:
If ThisWorkbook.Sheets("data ze vstupu").Range("U202").Value <> "Vypln|fffd|no" Then
    'nevypln|fffd|ny poplatky = nic
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7").Value = 0
    GoTo konec
Else
' RPSN Makro pro list 'v|fffd|po|fffd|et_spl|fffd|tky'
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi hodnota v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))
'  prvn|fffd| provede zaokrouhlov|fffd|n|fffd| hodnot poji|fffd|t|fffd|n|fffd| a spl|fffd|tky pro v|fffd|po|fffd|et RPSN



'zaokrouhlov|fffd|n|fffd| poji|fffd|t|fffd|n|fffd| - pokud p|fffd|edhypo = 0
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C18").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("D18").Value

ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7").Value = 5
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("N469").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C3"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7")
'blabla Range("G7").Select
End If

' vynuluje pole, kter|fffd| se m|fffd|n|fffd| na nezobrazit pokud se zm|fffd|n|fffd| zadan|fffd| hodnoty. (je t|fffd|eba nejd|fffd||fffd|ve spustit v|fffd|po|fffd|et spl|fffd|tky a RPSN)
    
konec:
'je|fffd|t|fffd| jednou dota|fffd|en|fffd| poji|fffd|t|fffd|n|fffd|, aby se prom|fffd|tlo spl|fffd|tkov|fffd|ho kalend|fffd||fffd|e v p|fffd||fffd|pad|fffd| nevypln|fffd|n|fffd| poplatk|fffd|
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C18").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("D18").Value
'BLABLA    ThisWorkbook.Sheets("1_Kalkulace").Select
'' zobrazVypocetList1_Kalkulace Makro
'    Range("B1").Value = "zobrazVypocet"
'    Range("C1").Value = "zobrazVypocetRPSN"

    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = xlSheetVeryHidden
    Application.ScreenUpdating = ScreenUpdatingStavPred
End Sub

Sub kontrolaVyplneni()
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| vyp|fffd|j|fffd|en|fffd| |fffd|astka
' po nalezen|fffd| spl|fffd|tky je|fffd|t|fffd| druh|fffd| |fffd||fffd|st, kde se hled|fffd| sazba (RPSN)

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'Dim ScreenUpdatingStavPred As Boolean
    ScreenUpdatingStavPred = Application.ScreenUpdating
'    Application.ScreenUpdating = False
With Application
        .MaxIterations = 300
        .MaxChange = 0.0001
    End With

'pokud nejsou v|fffd|echny vstupy
Dim test As Boolean
test = IsNumeric(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("J7").Value)

If test = False Then
'    GoTo konec
    chyba = True
Else
    chyba = False
End If


'kontrola pokud p|fffd|ekro|fffd|eno LTV, vr|fffd|t|fffd| se na v|fffd||fffd|i |fffd|v|fffd|ru
If ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value = "p|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV" Then
    ''ThisWorkbook.Sheets("1_Kalkulace").TextBox9.BackColor = vbRed
    ''MsgBox "P|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV!", vbCritical, "CHYBA - P|fffd|ekro|fffd|eno LTV"
    '''zvolit v|fffd||fffd|i |fffd|v|fffd|ru
    ''ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
'    GoTo konec
    chyba = True
End If

'kontrola pokud nen|fffd| vypln|fffd|n |fffd|rok nebo je 0
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value) = False Or ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox65.BackColor = vbRed
    If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value) = True Then
        MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|rokovou sazbu nebo obnovte tla|fffd||fffd|tkem 'resetovat sazbu'!", vbCritical, "CHYBA - |fffd|rokov|fffd| sazba"
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
    End If
'    GoTo konec
    chyba = True
End If

'kontrola pokud nen|fffd| vypln|fffd|no 'datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru' nebo je |fffd|patn|fffd| form|fffd|t
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) = False Or ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.BackColor = vbRed
    MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!", vbCritical, "CHYBA - Datum |fffd|erp|fffd|n|fffd|"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
'    GoTo konec
    chyba = True
End If

If ThisWorkbook.Sheets("Data ze vstupu").Range("E77").Value = "" Then
    Call ObnovSazbuTlacitko
End If

'hlaska pokud nen|fffd| vypln|fffd|no 'datum prvn|fffd| spl|fffd|tky' nebo je |fffd|patn|fffd| form|fffd|t
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) = False Or CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.BackColor = vbRed
    'MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum prvn|fffd| spl|fffd|tky nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!", vbCritical, "CHYBA - datum prvn|fffd| spl|fffd|tky"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
'    GoTo konec
    chyba = True
End If

'hlaska pokud datum prvn|fffd| spl|fffd|tky je men|fffd||fffd| (= d|fffd||fffd|v) ne|fffd| datum |fffd|erp|fffd|n|fffd|
If DateValue(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C36").Value) < DateValue(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("C22").Value) Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.BackColor = vbRed
    MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t po na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
'    GoTo konec
    chyba = True
End If
End Sub

Attribute VB_Name = "Module12"
Sub HST_SplatnostPodleVyseSplatky()
 If ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = 0 Then
  MsgBox "Vypl|fffd|te v|fffd||fffd|i |fffd|v|fffd|ru", vbCritical, "CHYBA - V|fffd||fffd|e |fffd|v|fffd|ru"
 ElseIf ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = "p|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = "" Or ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = 0 Then
  MsgBox "Vypl|fffd|te |fffd|rokovou sazbu", vbCritical, "CHYBA - |fffd|rokov|fffd| sazba"
 Else
  HST_vypocet_splatnosti.Show
 End If
End Sub
Sub obnovDatumCerpani()
    Call obnovDatumCerpaniVzorec
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
End Sub
Sub obnovDatumCerpaniVzorec()
' obnov|fffd| datum na|fffd|erp|fffd|n|fffd| navr|fffd|en|fffd| podle data vyhotoven|fffd| kalkul|fffd|toru.. =dnes+14 den, sobota a ned|fffd|le --> posun na pond|fffd|l|fffd|
    ThisWorkbook.Sheets("Data ze vstupu").Range("E76").FormulaR1C1 = "=IF(WEEKDAY(TODAY()+14,2)=6,TODAY()+14+2," & Chr(10) & "IF(WEEKDAY(TODAY()+14,2)=7,TODAY()+14+1," & Chr(10) & "TODAY()+14))"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value, "d.m.yyyy")
End Sub
Sub obnovDatumPrvniSplatky()
' obnov|fffd| datum prvn|fffd| spl|fffd|tky navr|fffd|en|fffd| podle data vyhotoven|fffd| kalkul|fffd|toru
    ThisWorkbook.Sheets("Data ze vstupu").Range("E77").Formula = "=IF(ISERROR(v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR!V24),""-"",v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR!V24)"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Text = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value, "d.m.yyyy")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
End Sub
Sub ObnovSazbuTlacitko()
'vynuluje indik|fffd|tor individu|fffd|ln|fffd| sazby
ThisWorkbook.Sheets("Data ze vstupu").Range("H81").Value = False
'obarvit p|fffd|smo individu|fffd|ln|fffd| na zeleno
ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.ForeColor = &H3C7000

Call ObnovSazbu
ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku

End Sub

Sub ObnovSazbu()
'individu|fffd|ln|fffd| = False, d|fffd|t sazbu z matice
If ThisWorkbook.Sheets("Data ze vstupu").Range("H81").Value = False Then

' na stisknut|fffd| tla|fffd||fffd|tka dopln|fffd| zp|fffd|t vzorec na automatick|fffd| dota|fffd|en|fffd| p|fffd||fffd|slu|fffd|n|fffd| sazby z |fffd||fffd|seln|fffd|ku, pokud byla sazba ru|fffd|n|fffd| p|fffd|eps|fffd|na
    ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Formula = "=Seznamy!D4"
'    ThisWorkbook.Sheets("1_Kalkulace").Select
    If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value) = False Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.LinkedCell = ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value
    Else
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.LinkedCell = ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value, "0.00")
    End If

'vynulovat zobrazen|fffd| sazby, pokud nen|fffd| vypln|fffd|na |fffd||fffd|stka
    With ThisWorkbook.Sheets("1_Kalkulace").TextBox9
    If .Value = "" Or .Value = "  " Or .Value = 0 Then
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
    End If
    End With
End If
End Sub



Attribute VB_Name = "Module13"
        Option Explicit
        Dim nazevListu As String
        Global datumAktualizaceExternistu
        Global pocetExternichSpol As Integer
        
        Sub AktualizovatSeznamExternistu()
            nazevListu = "SeznamIDExternistu"
            
            If worksheetexists(nazevListu) Then
                Application.DisplayAlerts = False
                Worksheets(nazevListu).Delete
                Application.DisplayAlerts = True
                Call GetDataExternistu
                'aby se neaktualizovalo v|fffd|ckr|fffd|t za den
                datumAktualizaceExternistu = Date
            Else
                Call GetDataExternistu
            End If
            ThisWorkbook.Worksheets(nazevListu).Visible = False
            
        End Sub
        Private Sub GetDataExternistu()
        Dim ExcelKalkulator As Workbook
        Dim DataZWebuWorkbook As Workbook
        Dim DataZWebu As Worksheet
        
        Set ExcelKalkulator = ActiveWorkbook
        
        ' Open The Web Workbook
        Workbooks.Open ("http://vbcz/externiziskatele/person_xls.php?akt=1")
        
        ' Set the Web Workbook and Worksheet Variables
        Set DataZWebuWorkbook = ActiveWorkbook
        Set DataZWebu = ActiveSheet
        
        
        ' Copy The Web Worksheet To My Workbook and Rename
        DataZWebu.Copy After:=ExcelKalkulator.Sheets(Sheets.Count)
        ExcelKalkulator.Sheets(ActiveSheet.Name).Name = nazevListu
        
        ' Close the Web Workbook
        ThisWorkbook.Sheets("1_Kalkulace").Activate
        DataZWebuWorkbook.Close SaveChanges:=False
        End Sub
        
        Public Function worksheetexists(nazevListu As String, Optional wrkbk As Workbook) As Boolean
            Dim wrksht As Worksheet
        
            If wrkbk Is Nothing Then
                Set wrkbk = ActiveWorkbook
            End If
        
            On Error Resume Next
        
            Set wrksht = wrkbk.Worksheets(nazevListu)
            worksheetexists = (Err.Number = 0)
            Set wrksht = Nothing
        
            On Error GoTo 0
        End Function
        
        Sub AktualizovatSeznamExternichSpolecnosti()
            nazevListu = "SeznamExternichSpolecnosti"

            If worksheetexists(nazevListu) Then
                Application.DisplayAlerts = False
                Worksheets(nazevListu).Delete
                Application.DisplayAlerts = True
                Call GetDataExternichSpolecnosti
            Else
                Call GetDataExternichSpolecnosti
            End If
            'semsem nahradit servi-ces za services
           ThisWorkbook.Worksheets(nazevListu).Visible = False
        End Sub
        Private Sub GetDataExternichSpolecnosti()
        Dim ExcelKalkulator As Workbook
        Dim DataZWebuWorkbook As Workbook
        Dim DataZWebu As Worksheet

        Set ExcelKalkulator = ActiveWorkbook

        ' Open The Web Workbook
        Workbooks.Open ("http://vbcz/externiziskatele/comp_xls.php?name=&akt=1")

        ' Set the Web Workbook and Worksheet Variables
        Set DataZWebuWorkbook = ActiveWorkbook
        Set DataZWebu = ActiveSheet


        ' Copy The Web Worksheet To My Workbook and Rename
        DataZWebu.Copy After:=ExcelKalkulator.Sheets(Sheets.Count)
        ExcelKalkulator.Sheets(ActiveSheet.Name).Name = nazevListu

        ' Close the Web Workbook
        ThisWorkbook.Sheets("1_Kalkulace").Activate
        DataZWebuWorkbook.Close SaveChanges:=False
        
        'dot|fffd|hnout adresy a se|fffd|adit podle abecedy
        Call adresyExternichSpolecnosti
        End Sub
        
        Sub adresyExternichSpolecnosti()
        Dim idSpolecnosti As String
        Dim ie As Object
        Dim my_url As String
        Dim Results As Object
        Dim itm As Variant
        
        'vymazat, pokud ji|fffd| nebylo vymaz|fffd|no
            If ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Range("C1").Value <> "Smlouva" Then
              Union(ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Columns("C:Q"), ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Columns("T:V")).Delete
            End If
        
        pocetExternichSpol = 0
        Do While Not IsEmpty(ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 1).Value)
        
        
         idSpolecnosti = ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 1).Value
                    ' open IE, navigate to the website of interest
                    Set ie = CreateObject("InternetExplorer.Application")
                    my_url = "http://vbcz/externiziskatele/comp_contacts.php?id=" & CStr(idSpolecnosti) & "&akt=1&name="
        
                    With ie
                        .Visible = False
                        .navigate my_url
                        .Top = 50
                        .Left = 530
                        .Height = 400
                        .Width = 400
        
                    Do Until Not ie.Busy And ie.readyState = 4
                        DoEvents
                    Loop
        
                    End With
        
                ' na|fffd||fffd|st adresu
                    Set Results = ie.document.getElementsByTagName("input")
                    For Each itm In Results
                        If InStr(1, itm.outerhtml, "f_adr", vbTextCompare) > 0 Then
                                If itm.Value = "" Then
                                  ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 5).EntireRow.Delete
                                  '(kv|fffd|li vymaz|fffd|n|fffd| |fffd||fffd|dku)
                                  pocetExternichSpol = pocetExternichSpol - 1
                                Else
                                  ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 5).Value = itm.Value
                                End If
        
                            Exit For
                        End If
                    Next
                    ie.Quit
                    Set ie = Nothing
        
        'naj|fffd|t dal|fffd||fffd| spole|fffd|nost
        pocetExternichSpol = pocetExternichSpol + 1
        Loop
        
        
        
        'p|fffd|idat fiktivn|fffd| spole|fffd|nost CCC, a.s. (pou|fffd||fffd|v|fffd| Call Centrum pro obejit|fffd| kontrol)
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Cells(3 + pocetExternichSpol, 2).Value = "CCC, a.s."
        
        'srovnat spole|fffd|nosti podle abecedy
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Sort.SortFields.Clear
        ThisWorkbook.Sheets("SeznamExternichSpolecnosti").Sort.SortFields.Add Key:=Range("B3:B" & 3 + pocetExternichSpol), _
                SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
                
            With ActiveWorkbook.Sheets("SeznamExternichSpolecnosti").Sort
                .SetRange Range("A3:E" & 3 + pocetExternichSpol)
                .Header = xlGuess
                .MatchCase = False
                .Orientation = xlTopToBottom
                .SortMethod = xlPinYin
                .Apply
            End With
        
        'opravit vzorce pro dota|fffd|en|fffd| extern|fffd| spole|fffd|nosti dle ID
        ThisWorkbook.Sheets("Data ze vstupu").Range("G52").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:J,10,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G53").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:D,3,0)&"" ""& VLOOKUP(G54,SeznamIDExternistu!A:D,4,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G55").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:F,6,0)"
        ThisWorkbook.Sheets("Data ze vstupu").Range("G56").Formula = "=VLOOKUP(G54,SeznamIDExternistu!A:G,7,0)"
        
        'seznam extern|fffd|ch spole|fffd|nost|fffd| - pokud se n|fffd|jak|fffd| p|fffd|idaly/ubraly, tak aby se objevili p|fffd|esn|fffd|
        ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.ListFillRange = "=SeznamExternichSpolecnosti!B3:B" & 3 + pocetExternichSpol
        
        Set Results = Nothing
        '''MsgBox "Seznam extern|fffd|ch spole|fffd|nost|fffd| aktualizov|fffd|n z intranetu"
        End Sub
Attribute VB_Name = "Module14"

Sub konsolidace_zadosti_PDF()

' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz p|fffd|i tisku)
Application.ScreenUpdating = False

' nap|fffd|e do bu|fffd|ky A2 = "zobrazovat hl|fffd|ky" .. na kterou jsou v|fffd|z|fffd|ny v|fffd|echny hl|fffd|ky
    Range("A2").Value = "zobrazovat hl|fffd|ky"
    
' kontrola, nesv|fffd|t|fffd| |fffd|erven|fffd| hl|fffd|ka, upozor|fffd|uj|fffd|c|fffd|, |fffd|e se n|fffd|co m|fffd| vyplnit (= v|fffd|e vypln|fffd|no)
ThisWorkbook.Sheets("3_Konsolidace").Select
Range("F26").Select
varovna_hlaska = ActiveCell.Value
If varovna_hlaska <> "" Then
MsgBox ("|fffd||fffd|dosti nelze vygenerovat! Mus|fffd|te vyplnit v|fffd|echna po|fffd|adovan|fffd| pole!")
End If

' kdy|fffd| |fffd||fffd|dn|fffd| hl|fffd|ka nesv|fffd|t|fffd|, (= v|fffd|e vypln|fffd|no), m|fffd||fffd|e se vygenerovat
If varovna_hlaska = "" Then

' Create and save .pdf
Dim pdfName As String, FolderName As String, FullName As String
ThisWorkbook.Sheets("3_Konsolidace").Select

' zkontroluje jestli je na disku C: slo|fffd|ka Sberbank CZ, pokud ne, vytvo|fffd||fffd| ji
If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"

' vytvo|fffd||fffd| slo|fffd|ku podle data a |fffd|asu RRRR-MM-DD-HH-MM-SS
FolderName = "Sberbank CZ\" & Range("A1").Text
If Not DirExists("C:\" & FolderName) Then MkDir "C:\" & FolderName

' ulo|fffd||fffd| jako PDF pod n|fffd|zvem
ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D4").Value = FolderName
pdfName = "Zadost_o_konsolidaci_Sberbank CZ"
FullName = "C:\" & FolderName & "\" & pdfName
If MsgBox("|fffd||fffd|dosti budou ulo|fffd|eny ve form|fffd|tu PDF do " & FullName & ", p|fffd|ejete si prov|fffd|st?", vbYesNo + vbQuestion) = vbNo Then Exit Sub



        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 1
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 1"
        Else
            ' tisk |fffd||fffd|dost Konsolidace1 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_1").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_1").Select
            Range("A16").Select
            tisk_zadost_1 = ActiveCell.Value
            If tisk_zadost_1 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_01" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_1").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 2
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 2"
        Else
            ' tisk |fffd||fffd|dost Konsolidace2 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_2").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_2").Select
            Range("A16").Select
            tisk_zadost_2 = ActiveCell.Value
            If tisk_zadost_2 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_02" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_2").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 3
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 3"
        Else
            ' tisk |fffd||fffd|dost Konsolidace3 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_3").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_3").Select
            Range("A16").Select
            tisk_zadost_3 = ActiveCell.Value
            If tisk_zadost_3 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_03" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_3").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 4
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 4"
        Else
             ' tisk |fffd||fffd|dost Konsolidace4 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_4").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_4").Select
            Range("A16").Select
            tisk_zadost_4 = ActiveCell.Value
            If tisk_zadost_4 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_04" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_4").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 5
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 5"
        Else
             ' tisk |fffd||fffd|dost Konsolidace5 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_5").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_5").Select
            Range("A16").Select
            tisk_zadost_5 = ActiveCell.Value
            If tisk_zadost_5 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_05" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_5").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 6
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 6"
        Else
             ' tisk |fffd||fffd|dost Konsolidace6 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_6").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_6").Select
            Range("A16").Select
            tisk_zadost_6 = ActiveCell.Value
            If tisk_zadost_6 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_06" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_6").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 7
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 7"
        Else
             ' tisk |fffd||fffd|dost Konsolidace7 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_7").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_7").Select
            Range("A16").Select
            tisk_zadost_7 = ActiveCell.Value
            If tisk_zadost_7 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_07" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_7").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 8
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 8"
        Else
             ' tisk |fffd||fffd|dost Konsolidace8 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_8").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_8").Select
            Range("A16").Select
            tisk_zadost_8 = ActiveCell.Value
            If tisk_zadost_8 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_08" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_8").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 9
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 9"
        Else
             ' tisk |fffd||fffd|dost Konsolidace9 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_9").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_9").Select
            Range("A16").Select
            tisk_zadost_9 = ActiveCell.Value
            If tisk_zadost_9 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_09" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_9").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
        '-------------------
        ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D6").Value = 10
        If ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D2").Value = "tisknout" Then
            Call Sheets("CestneProhlaseniKonsolidace").CestneProhlaseniKonsolidacePdf
        'ElseIf ThisWorkbook.Sheets("CestneProhlaseniKonsolidace").Range("D9") = "Zonky s.r.o." Then
        '    'netiskne se nic
        '    MsgBox "Zonky s.r.o. |fffd||fffd|dost o splacen|fffd| nepos|fffd|l|fffd|me (=netiskne se), klient je povinen dolo|fffd|it potvrzen|fffd| o doplacen|fffd| |fffd|v|fffd|ru", vbInformation, "Konsolidovan|fffd| |fffd|v|fffd|r |fffd|. 10"
        Else
             ' tisk |fffd||fffd|dost Konsolidace10 -> pouze pokud neobsahuje v|fffd|tu *** formul|fffd||fffd| se netiskne ***
            ThisWorkbook.Sheets("Zadost_konsolidace_10").Visible = True
            ThisWorkbook.Sheets("Zadost_konsolidace_10").Select
            Range("A16").Select
            tisk_zadost_10 = ActiveCell.Value
            If tisk_zadost_10 <> "*** FORMUL|fffd||fffd| SE NETISKNE! ***" Then
            Range("A1:C47").ExportAsFixedFormat Type:=xlTypePDF, FileName:=FullName & "_10" _
    , Quality:=xlQualityMedium, IncludeDocProperties:=False, _
    IgnorePrintAreas:=False, OpenAfterPublish:=False
            ThisWorkbook.Sheets("Zadost_konsolidace_10").Select:
            End If
            ActiveWindow.SelectedSheets.Visible = False
        End If
        
    yesno = MsgBox("P|fffd|ejete si otev|fffd||fffd|t slo|fffd|ku s ulo|fffd|en|fffd|mi PDF |fffd||fffd|dostmi?" _
, vbYesNo + vbQuestion, "Otev|fffd||fffd|t slo|fffd|ku?")
    Select Case yesno
    Case vbYes
    myval = Shell("explorer C:\" & FolderName, 1)
    Case vbNo
    End Select
    
' zapne aktualizaci obrazovky (na za|fffd||fffd|tku vypnuto, aby nep|fffd|eskakoval obraz p|fffd|i tisku)
Application.ScreenUpdating = True

' vr|fffd|t|fffd| se na list konsolidace
ThisWorkbook.Sheets("3_Konsolidace").Select

End If

End Sub



Attribute VB_Name = "Module15"

Private Sub odzlutitZlutaPole()
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.BackColor = vbWhite
End Sub
Private Sub welcome_screen_schovat()
'p|fffd|i otev|fffd|en|fffd| automaticky zkontroluje, zda jsou povolen|fffd| makra a v p|fffd||fffd|pad|fffd|, |fffd|e ano
'schov|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem jak zapnout makra' a zobraz|fffd| list A, B, C a D
Application.ScreenUpdating = False
    'zapnout automatick|fffd| p|fffd|epo|fffd|et listu/se|fffd|itu p|fffd|i spu|fffd|t|fffd|n|fffd| kalkul|fffd|toru
    Application.Calculation = xlCalculationAutomatic
    ActiveWindow.Zoom = 100
    ThisWorkbook.Sheets("1_Kalkulace").ScrollArea = "A1:I100"
    
    
      'dod|fffd|lat Call ESC_schovat
    ThisWorkbook.Sheets("1_Kalkulace").Visible = True
     If ThisWorkbook.Sheets("Data ze vstupu").Range("E4").Value <> "ESC" Then
      ThisWorkbook.Sheets("2_V|fffd|stavba").Visible = True
      ThisWorkbook.Sheets("3_Konsolidace").Visible = True
      'dod|fffd|lat Call ESC_zobrazit
     End If
    ThisWorkbook.Sheets("1_Kalkulace").Select
    ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = False
    Range("C6").Select
    ActiveWindow.Zoom = 100
Application.ScreenUpdating = True
'    Call ulozitPodNovymNazvem
'    Call odzlutitZlutaPole
End Sub

Private Sub welcome_screen_zobrazit()
'(p|fffd|i zav|fffd|en|fffd| automaticky) zobraz|fffd| '|fffd|vodn|fffd| obrazovku s n|fffd|vodem, jak zapnout makra' a schov|fffd| v|fffd|echny listy
'Application.ScreenUpdating = False

    'schovat v|fffd|echny listy
    ThisWorkbook.Sheets("Uvodni_obrazovka").Visible = True
    ThisWorkbook.Sheets("1_Kalkulace").Visible = False
    ThisWorkbook.Sheets("2_V|fffd|stavba").Visible = False
    ThisWorkbook.Sheets("3_Konsolidace").Visible = False

  ThisWorkbook.Sheets("Uvodni_obrazovka").Select
  Range("A1").Select
  ActiveWindow.Zoom = 85
Application.ScreenUpdating = True

End Sub

Sub resetovat_kalkulator()
    yesno = MsgBox("Opravdu si p|fffd|ejete vymazat v|fffd|echny |fffd|daje?", vbYesNo + vbQuestion, "Vymazat v|fffd|echny |fffd|daje?")
    Select Case yesno
    Case vbYes
    Call ThisWorkbook.Sheets("3_Konsolidace").konsolidace_vymazat
    Call reset_list_2_Vystavba
    Call reset_list_1_Kalkulace
    MsgBox "Hotovo", vbInformation, "Vymaz|fffd|n|fffd| |fffd|daj|fffd|"
    Application.ScreenUpdating = True
        ThisWorkbook.Sheets("2_V|fffd|stavba").Select
        ThisWorkbook.Sheets("2_V|fffd|stavba").Range("C4").Select
        ThisWorkbook.Sheets("1_Kalkulace").Select
        ThisWorkbook.Sheets("1_Kalkulace").Range("C6").Select
    Case vbNo
    End Select
End Sub
Sub resetovat_kalkulator_bez_dotazu()
'    yesno = MsgBox("Opravdu si p|fffd|ejete vymazat v|fffd|echny |fffd|daje?", vbYesNo + vbQuestion, "Vymazat v|fffd|echny |fffd|daje?")
'    Select Case yesno
'    Case vbYes
    Call ThisWorkbook.Sheets("3_Konsolidace").konsolidace_vymazat
    Call reset_list_2_Vystavba
    Call reset_list_1_Kalkulace
'    MsgBox "Hotovo", vbInformation, "Vymaz|fffd|n|fffd| |fffd|daj|fffd|"
    Application.ScreenUpdating = True
        ThisWorkbook.Sheets("2_V|fffd|stavba").Select
        ThisWorkbook.Sheets("2_V|fffd|stavba").Range("C4").Select
        ThisWorkbook.Sheets("1_Kalkulace").Select
        ThisWorkbook.Sheets("1_Kalkulace").Range("C6").Select
'    Case vbNo
'    End Select
End Sub
Private Sub reset_list_2_Vystavba()
' promaz|fffd|n|fffd| listu v|fffd|stavba
        ScreenUpdatingStavPred = Application.ScreenUpdating
        Application.ScreenUpdating = False
    Sheets("2_V|fffd|stavba").Range("C4:C6").ClearContents
    Sheets("2_V|fffd|stavba").Range("C9:C10").ClearContents
    Sheets("2_V|fffd|stavba").Range("C12:C13").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G4").ClearContents
    Sheets("2_V|fffd|stavba").Range("I4").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G8").ClearContents
    Sheets("2_V|fffd|stavba").Range("I8").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G10").ClearContents
    Sheets("2_V|fffd|stavba").Range("I10").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G12").ClearContents
    Sheets("2_V|fffd|stavba").Range("I12").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G14").ClearContents
    Sheets("2_V|fffd|stavba").Range("I14").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G16").ClearContents
    Sheets("2_V|fffd|stavba").Range("I16").ClearContents

    Sheets("2_V|fffd|stavba").Range("G18").ClearContents
    Sheets("2_V|fffd|stavba").Range("I18").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G20").ClearContents
    Sheets("2_V|fffd|stavba").Range("I20").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G22").ClearContents
    Sheets("2_V|fffd|stavba").Range("I22").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G24").ClearContents
    Sheets("2_V|fffd|stavba").Range("I24").ClearContents

    Sheets("2_V|fffd|stavba").Select
    Range("C4").Select
'    Application.ScreenUpdating = ScreenUpdatingStavPred
End Sub
Private Sub reset_list_2_Vystavba_develop()
' promaz|fffd|n|fffd| listu v|fffd|stavba
        ScreenUpdatingStavPred = Application.ScreenUpdating
        Application.ScreenUpdating = False
    Sheets("2_V|fffd|stavba").Range("C4:C7").ClearContents
    Sheets("2_V|fffd|stavba").Range("C10:C11").ClearContents
    Sheets("2_V|fffd|stavba").Range("C13:C14").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G4").ClearContents
    Sheets("2_V|fffd|stavba").Range("I4").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G8").ClearContents
    Sheets("2_V|fffd|stavba").Range("I8").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G10").ClearContents
    Sheets("2_V|fffd|stavba").Range("I10").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G12").ClearContents
    Sheets("2_V|fffd|stavba").Range("I12").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G14").ClearContents
    Sheets("2_V|fffd|stavba").Range("I14").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G16").ClearContents
    Sheets("2_V|fffd|stavba").Range("I16").ClearContents

    Sheets("2_V|fffd|stavba").Range("G18").ClearContents
    Sheets("2_V|fffd|stavba").Range("I18").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G20").ClearContents
    Sheets("2_V|fffd|stavba").Range("I20").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G22").ClearContents
    Sheets("2_V|fffd|stavba").Range("I22").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G24").ClearContents
    Sheets("2_V|fffd|stavba").Range("I24").ClearContents

    Sheets("2_V|fffd|stavba").Select
    Range("C4").Select
'    Application.ScreenUpdating = ScreenUpdatingStavPred
End Sub

Private Sub reset_list_1_Kalkulace()
'
' Makro1 Makro
' 'reset v|fffd|ech |fffd|daj|fffd| v kalkul|fffd|toru
'
ThisWorkbook.Sheets("1_Kalkulace").ScrollArea = "A1:I100"

ThisWorkbook.Sheets("1_Kalkulace").ListBox2.Left = 10
ThisWorkbook.Sheets("1_Kalkulace").ListBox1.Left = 10
ThisWorkbook.Sheets("1_Kalkulace").ListBox3.Left = 10
ThisWorkbook.Sheets("1_Kalkulace").ListBox4.Left = 10


        ScreenUpdatingStavPred = Application.ScreenUpdating
        Application.ScreenUpdating = False
    
ThisWorkbook.Sheets("Data ze vstupu").Visible = True
ThisWorkbook.Sheets("Data ze vstupu").Select

    'seznam bank|fffd||fffd||fffd| dle jm|fffd|na - pokud se n|fffd|jak|fffd| p|fffd|idaly/ubraly, tak aby se objevili p|fffd|esn|fffd|
    'ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.ListFillRange = "=" & ThisWorkbook.Sheets("seznam_bankeru").Range("B5").Value
       
    
    'vynulov|fffd|n|fffd| formul|fffd||fffd|e p|fffd|edsmluvn|fffd| informace
    ThisWorkbook.Sheets("Data ze vstupu").Range("U207").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("U210").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("U211").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("U212").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("W222").Value = ""
    'odhad nemovitosti
    ThisWorkbook.Sheets("Data ze vstupu").Range("W225").Value = ""
    '--------------------------
    
    'v souhrnu se neobjev|fffd| |fffd|daje dal|fffd||fffd|ch |fffd|adatel|fffd|, dokud nezad|fffd|m jejich jm|fffd|no
    ThisWorkbook.Sheets("Data ze vstupu").Range("Q28:Q30").FormulaR1C1 = "=IF(RC[-2]<>"""",""@"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("S28:S30").FormulaR1C1 = "=IF(RC[-4]<>"""",""Ob|fffd|an |fffd|R"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("T28:T30").FormulaR1C1 = "=IF(RC[-5]<>"""",""Spolu|fffd|adatel"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("U28:U30").FormulaR1C1 = "=IF(RC[-6]<>"""",1,"""")"
    '--------------------------

    ThisWorkbook.Sheets("Data ze vstupu").Range("O27:P30").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("Q27:Q30").FormulaR1C1 = "=IF(RC[-2]<>"""",""@"","""")"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("R27:R30").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("S27:S30").FormulaR1C1 = "=IF(RC[-4]<>"""",""Ob|fffd|an |fffd|R"","""")"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("T27:T30").Value = "=IF(RC[-5]<>"""",""Spolu|fffd|adatel"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("U27:U30").Value = "=IF(RC[-7]<>"" "",1,"""")"
    
    'extern|fffd| partner
    'ThisWorkbook.Sheets("Data ze vstupu").Range("E52:E55").Value = ""
    'ThisWorkbook.Sheets("Data ze vstupu").Range("E56").Value = "@"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value = "F|fffd|R hypot|fffd|ka"
    ThisWorkbook.Sheets("Data ze vstupu").Range("E66").Value = "Koup|fffd|"
    ThisWorkbook.Sheets("Data ze vstupu").Range("E67").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("E69").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("E71").Value = "Bytov|fffd| jednotka"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("E72:E73").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("E74").Value = "5 let"
    ThisWorkbook.Sheets("Data ze vstupu").Range("E75").Value = 10
    
    'ThisWorkbook.Sheets("Data ze vstupu").Range("E76").FormulaR1C1 = "=IF(WEEKDAY(TODAY()+14,2)=6,TODAY()+14+2," & Chr(10) & "IF(WEEKDAY(TODAY()+14,2)=7,TODAY()+14+1," & Chr(10) & "TODAY()+14))"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Value = Format(Now + 14, "d.m.yyyy")
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.BackColor = vbWhite
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("E77:E78").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("E77").Formula = "=IF(ISERROR(v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR!V24),""-"",v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR!V24)"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Text = Format(ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Text, "d.m.yyyy")
    
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("E79").Value = "ano"
    ThisWorkbook.Sheets("Data ze vstupu").Range("E80").Value = "Standard (5 % z v|fffd||fffd|e m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky)"
    ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U83:Z86").Value = "FALSE"
    ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value = 0
    ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Value = 0
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC83:AC86").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U90:W93").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("Y90:Y93").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U102:V105").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("X102:X105").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U113:W116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Y113:Y116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC113:AC116").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U121:W124").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("U129:Z132").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z137:AA140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC137:AC140").Value = "1"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AE137:AF140").Value = ""
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AH137:AH140").Value = "1"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AJ137:AK140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AM137:AM140").Value = "1"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("AO137:AP140").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AR137:AR140").Value = "1"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z145:AA147").Value = ""
    'po|fffd|et |fffd|len|fffd| dom
    ThisWorkbook.Sheets("Data ze vstupu").Range("AC145:AC147").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AD145:AD147").Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Range("AE145:AE147").Value = "=IF(RC[-6]<>"""",""Byt / D|fffd|m v osobn|fffd|m vlastnictv|fffd|"","""")"
    ThisWorkbook.Sheets("Data ze vstupu").Range("AF145:AF147").Value = "=IF(RC[-7]<>"""",""|fffd|esk|fffd| republika"","""")"
    
    ThisWorkbook.Sheets("Data ze vstupu").Range("Z162:AE164").Value = ""
    
ThisWorkbook.Sheets("Data ze vstupu").Visible = False
ThisWorkbook.Sheets("1_Kalkulace").Select

'--------------------------------------------
    'extern|fffd| prodejce
'    ThisWorkbook.Sheets("1_Kalkulace").ComboBox26.Value = ""
'    ThisWorkbook.Sheets("1_Kalkulace").TextBox70.Value = ""
'    ThisWorkbook.Sheets("1_Kalkulace").TextBox71.Value = ""
'    ThisWorkbook.Sheets("1_Kalkulace").TextBox72.Value = ""
'    ThisWorkbook.Sheets("1_Kalkulace").TextBox73.Value = "@"
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Value = "F|fffd|R hypot|fffd|ka"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.BackColor = vbWhite
    Call ThisWorkbook.Sheets("1_Kalkulace").promazatZmenaProduktu
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.Value = "Koup|fffd|"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox13.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox10.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox59.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.Value = "Bytov|fffd| jednotka"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox14.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox60.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox61.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.Value = "5 let"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox15.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.Value = 20
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox16.BackColor = vbWhite
    
    'ThisWorkbook.Sheets("1_Kalkulace").TextBox62.Value = "-"
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.Value = "ano"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox17.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.Value = "Klasik (7,5% z v|fffd||fffd|e m|fffd|s|fffd||fffd|n|fffd| spl|fffd|tky)"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox18.BackColor = vbWhite
    'individu|fffd|ln|fffd| sazba = false a obarvit p|fffd|smo na zeleno
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13 = False
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox13.ForeColor = &H3C7000
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox65.BackColor = vbWhite
    'tady jsou linked cell.. tak|fffd|e by vymazalo vzorec
    'ThisWorkbook.Sheets("1_Kalkulace").TextBox66.Value = ""
    'ThisWorkbook.Sheets("1_Kalkulace").TextBox67.Value = ""
    'ThisWorkbook.Sheets("1_Kalkulace").TextBox68.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox11.Value = 1
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox1.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox2.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox3.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox7.Value = "@"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox2.Value = "Ob|fffd|an |fffd|R"
    'p|fffd||fffd|jem ze zem|fffd|
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox27.Value = "|fffd|R"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox5.Value = "Spolu|fffd|adatel"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox6.Value = 1
    ThisWorkbook.Sheets("1_Kalkulace").TextBox34.Value = ""
    
    'checkboxy p|fffd||fffd|jmy
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox1.Value = False
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox8.Value = False
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox9.Value = False
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox10.Value = False
    ThisWorkbook.Sheets("1_Kalkulace").CheckBox12.Value = False
    
    'ZAM k|fffd|d
    ThisWorkbook.Sheets("1_Kalkulace").TextBox69_ZAM_kod.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemPrumernyMesicniCelkem.Visible = False
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox14.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox15.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox16.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox75.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").infoPrijemZaPoslednich12Mesicu.Visible = False
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox40.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox41.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox42.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox43.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox44.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox45.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox46.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox47.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox48.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox49.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox50.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox51.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox84.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox18.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox88.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox19.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox20.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox21.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox7.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox32.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox31.Value = ""
    
    'P|fffd||fffd|jem externisty - m|fffd|s|fffd|ce
    ThisWorkbook.Sheets("Data ze vstupu").Range("AE129:AE132").Value = ThisWorkbook.Sheets("Data ze vstupu").Cells(129, 29).Value
    ThisWorkbook.Sheets("1_Kalkulace").TextBox52.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox53.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox54.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox56.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox57.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox58.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox55.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox8.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox9.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox10.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox19.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox33.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox36.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox38.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox78.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox35.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox37.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox39.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox79.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox74.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox76.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox77.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox80.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox13.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox11.Value = ""
    ThisWorkbook.Sheets("Data ze vstupu").Cells(145, 29).Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox12.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.Value = "Byt / D|fffd|m v osobn|fffd|m vlastnictv|fffd|"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox3.BackColor = vbWhite
    
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.Value = "|fffd|esk|fffd| republika"
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox1.BackColor = vbWhite
    ThisWorkbook.Sheets("1_Kalkulace").TextBox8.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox22.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox23.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox24.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox25.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox26.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox27.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox89.Value = ""
    
    ThisWorkbook.Sheets("1_Kalkulace").infoVydajeOstatniTextbox.Visible = False
    'po|fffd|adovan|fffd| v|fffd||fffd|e dopl|fffd|kov|fffd| |fffd||fffd|sti
    ThisWorkbook.Sheets("1_Kalkulace").TextBox28.Enabled = True

    
    ThisWorkbook.Sheets("1_Kalkulace").TextBox29.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox30.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox4.Value = ""
    ThisWorkbook.Sheets("1_Kalkulace").TextBox5.Value = ""
    
    
    'ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = True
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G2").Value = 0
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Range("G7").Value = 0
    'ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky").Visible = False
    
    Application.ScreenUpdating = ScreenUpdatingStavPred
    
    ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 20
    ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Height = 19
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 18.75
        ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Height = 17.5
        
        
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost1").Fill.ForeColor.RGB = vbRed
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("TabStrip3_domacnost2").Fill.ForeColor.RGB = vbRed
        
    ActiveWindow.Zoom = 100
    ActiveWindow.SmallScroll Down:=-100
End Sub

Attribute VB_Name = "Module16"
Option Explicit

    Function OdstarnDiakr(Source As Variant) As String
    
        Const cz As String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||61a||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||75e||fffd|.,:;?!|fffd||fffd|%()=+<>/\*||fffd|"
        Const en As String = "aAcCdDeEeEeEiInNoOoOrRsStTuUuUuUyYzZ"

        Dim TmpS As String
        Dim OutS As String
        Dim i As Integer

        OutS = ""

           If IsNull(Source) Or Source = "" Then
            OdstarnDiakr = ""
           Else

           For i = 1 To Len(Source)
                TmpS = Mid(Source, i, 1)
           If InStr(1, cz, TmpS, vbBinaryCompare) > 0 Then TmpS = Mid(en, InStr(1, cz, TmpS, vbBinaryCompare), 1)
                OutS = OutS & TmpS
           Next i
            OdstarnDiakr = OutS
           End If
           
    End Function

Attribute VB_Name = "Module17"
Option Explicit

Dim nazevKalkulatorNevyplneny As String
Sub ulozitPodNazvemPodleVerze()
nazevKalkulatorNevyplneny = ThisWorkbook.Sheets("1_Kalkulace").Range("F7").Value & ".xlsm"
znovu:
    On Error GoTo znovu
    ActiveWorkbook.SaveAs FileName:=nazevKalkulatorNevyplneny
End Sub
Sub ulozitPodNovymNazvem()
Dim workbook_Name As Variant
Dim abc As String

nazevKalkulatorNevyplneny = ThisWorkbook.Sheets("1_Kalkulace").Range("F7").Value & ".xlsm"
ulozeni:
If nazevKalkulatorNevyplneny = ThisWorkbook.Name Then
        MsgBox "Ulo|fffd|te soubor pod nov|fffd|m n|fffd|zvem " & vbNewLine & "(zadejte nap|fffd||fffd|klad p|fffd||fffd|jmen|fffd| a jm|fffd|no klienta)", vbApplicationModal, "V|fffd|tejte v hypote|fffd|n|fffd|m kalkul|fffd|toru SBERBANK!"
        workbook_Name = Application.GetSaveAsFilename("p|fffd||fffd|jmen|fffd| a jm|fffd|no klienta", , , "Zadejte n|fffd|zev souboru (nap|fffd|. p|fffd||fffd|jmen|fffd| a jm|fffd|no klienta)") & "xlsm"
            
'o|fffd|et|fffd|it If right(workbook_Name,5) <> ".xlsm" Then ".xlsm"
            
    If workbook_Name <> "Falsexlsm" Then
        ActiveWorkbook.SaveAs FileName:=workbook_Name
        MsgBox "Kalkul|fffd|tor byl |fffd|sp|fffd|n|fffd| ulo|fffd|en pod n|fffd|zvem " & vbNewLine & workbook_Name, vbApplicationModal, "Hotovo!"
    Else
        MsgBox "N|fffd|co se nepovedlo, pros|fffd|m zkuste to znovu", vbCritical, "Chyba ulo|fffd|en|fffd| pod nov|fffd|m n|fffd|zvem"
        GoTo ulozeni
    End If
Else
'nic
        
End If
End Sub

Attribute VB_Name = "Module18"

Sub generovatESIP()
'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
    Call vypocti_splatku_maxPRIBOR
    

'potvrzen|fffd|, kdy|fffd| nebylo zad|fffd|no jm|fffd|no, |fffd|e skute|fffd|n|fffd| chce pokra|fffd|ovat
'''If ThisWorkbook.Sheets("Data ze vstupu").Range("E102").Value = 0 Then
'''    If MsgBox("Nezadali jste jm|fffd|no. Jste si jist|fffd|, |fffd|e chcete vygenerovat anonymn|fffd| nab|fffd|dku?", vbYesNo + vbQuestion, "Pokra|fffd|ovat bez jm|fffd|na hlavn|fffd|ho |fffd|adatele?") = vbNo Then Exit Sub
'''End If

'ESIP v |fffd|e|fffd|tin|fffd|
If ThisWorkbook.Sheets("ESIP").Range("D6").Value = "Nejd|fffd||fffd|ve je nutn|fffd| vyplnit poplatky" Then
    MsgBox "Nelze pokra|fffd|ovat bez vypln|fffd|n|fffd| poplatk|fffd|!", vbCritical, "CHYBA - Vypln|fffd|n|fffd| poplatk|fffd|"
    On Error Resume Next
    Select Case Err.Number
        Case 400
        'kdy|fffd| u|fffd| je otev|fffd|en|fffd| formul|fffd||fffd| -- tak nic
        Case Else
        Predsmluvni_informace.Show
    End Select
    ''Call ThisWorkbook.Sheets("1_Kalkulace").Predsmluvky
ElseIf ThisWorkbook.Sheets("ESIP").Range("D6").Value = "generuji" Then
    Call ThisWorkbook.Sheets("ESIP").ESIP
End If

''ESIP jazykov|fffd| mutace
''If ThisWorkbook.Sheets("ESIP").Range("D6").Value = "generuji" Then
''   Call ThisWorkbook.Sheets("ESIP").ESIP_RU
''End If


End Sub

Sub vypocti_splatku_maxPRIBOR()
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))

If ThisWorkbook.Sheets("data ze vstupu").Range("U202").Value <> "Vypln|fffd|no" Then
    'nevypln|fffd|ny poplatky = nic
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G7").Value = 0
    GoTo konec
End If
' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'ud|fffd|lat hl|fffd|ku, pokud nejsou v|fffd|echny vstupy .. Range ("E22")
'On Error GoTo konec:
Dim ScreenUpdatingStavPred As Boolean
    ScreenUpdatingStavPred = Application.ScreenUpdating
'    Application.ScreenUpdating = False
With Application
        .MaxIterations = 300
        .MaxChange = 0.0001
    End With

'ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Visible = True
'BLABLA ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Select


'dal|fffd||fffd| testov|fffd|n|fffd| na pot|fffd|ebn|fffd| vstupn|fffd| data
Dim test As Boolean
test = IsNumeric(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("J7").Value)
'hlaska1 = ThisWorkbook.Sheets("3_Produkty").Range("A10")
'test1 = IsNumeric(ThisWorkbook.Sheets("3_Produkty").Range("B10").Value)
'hlaska2 = ThisWorkbook.Sheets("3_Produkty").Range("A18")
'test2 = IsNumeric(ThisWorkbook.Sheets("3_Produkty").Range("B18").Value)



If test = False Then
'BLABLA    ThisWorkbook.Sheets("1_Kalkulace").Select
'    MsgBox "Zkontrolujte hodnoty pro v|fffd|po|fffd|et spl|fffd|tky!", vbCritical, "CHYBA - Hodnoty pro v|fffd|po|fffd|et spl|fffd|tky"
    GoTo konec
End If


'kontrola pokud p|fffd|ekro|fffd|eno LTV, vr|fffd|t|fffd| se na v|fffd||fffd|i |fffd|v|fffd|ru
If ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value = "p|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV" Then
    ''ThisWorkbook.Sheets("1_Kalkulace").TextBox9.BackColor = vbRed
    ''MsgBox "P|fffd|ekro|fffd|eno maxim|fffd|ln|fffd| LTV!", vbCritical, "CHYBA - P|fffd|ekro|fffd|eno LTV"
    '''zvolit v|fffd||fffd|i |fffd|v|fffd|ru
    ''ThisWorkbook.Sheets("1_Kalkulace").TextBox9.Activate
    GoTo konec
End If

'kontrola pokud nen|fffd| vypln|fffd|n |fffd|rok nebo je 0
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value) = False Or ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox65.BackColor = vbRed
    If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("E81").Value) = True Then
        MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| |fffd|rokovou sazbu nebo obnovte tla|fffd||fffd|tkem 'resetovat sazbu'!", vbCritical, "CHYBA - |fffd|rokov|fffd| sazba"
        ThisWorkbook.Sheets("1_Kalkulace").TextBox65.Activate
    End If
    GoTo konec
End If

'kontrola pokud nen|fffd| vypln|fffd|no 'datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru' nebo je |fffd|patn|fffd| form|fffd|t
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value) = False Or ThisWorkbook.Sheets("Data ze vstupu").Range("G76").Value <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.BackColor = vbRed
    MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!", vbCritical, "CHYBA - Datum |fffd|erp|fffd|n|fffd|"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox63.Activate
    GoTo konec
End If

If ThisWorkbook.Sheets("Data ze vstupu").Range("E77").Value = "" Then
Call ObnovSazbuTlacitko
End If

'hlaska pokud nen|fffd| vypln|fffd|no 'datum prvn|fffd| spl|fffd|tky' nebo je |fffd|patn|fffd| form|fffd|t
If IsNumeric(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) = False Or CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("G77").Value) <= 0 Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.BackColor = vbRed
    'MsgBox "Vypl|fffd|te spr|fffd|vn|fffd| datum prvn|fffd| spl|fffd|tky nebo obnovte tla|fffd||fffd|tkem 'obnovit doporu|fffd|en|fffd|'!", vbCritical, "CHYBA - datum prvn|fffd| spl|fffd|tky"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
    GoTo konec
End If

'hlaska pokud datum prvn|fffd| spl|fffd|tky je men|fffd||fffd| (= d|fffd||fffd|v) ne|fffd| datum |fffd|erp|fffd|n|fffd|
If DateValue(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C24").Value) < DateValue(ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C22").Value) Then
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.BackColor = vbRed
    MsgBox "Datum prvn|fffd| spl|fffd|tky mus|fffd| b|fffd|t po na|fffd|erp|fffd|n|fffd| |fffd|v|fffd|ru!"
    ThisWorkbook.Sheets("1_Kalkulace").TextBox64.Activate
    GoTo konec
End If

'pro p|fffd|edhypot|fffd||fffd|n|fffd| |fffd|v|fffd|r v|fffd|po|fffd|et p|fffd|eskakuje iteraci rovnou k RPSN (spl|fffd|tka pouze |fffd|rok|fffd| ze st|fffd|le stejn|fffd| jistiny -- spl|fffd|tka je zde = "suma |fffd|rok|fffd|" / "po|fffd|et m|fffd|s|fffd|c|fffd|")
If ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C6").Value = "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r" Then ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("H2").Value: GoTo lbl2

' V|fffd|po|fffd|et spl|fffd|tky pro DTI (DTI spl|fffd|tka, kdyby nebyla sleva na sazb|fffd|)
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C8").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G9").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("H10").Value = Null
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value = Null
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("J7").Value 'nastartov|fffd|n|fffd| prvn|fffd| spl|fffd|tky vypo|fffd|ten|fffd| vzorcem v se|fffd|it|fffd|
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G421").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("E22"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2")
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("H10").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C8").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("D8").Value


' V|fffd|po|fffd|et spr|fffd|vn|fffd| spl|fffd|tky
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G421").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("E22"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2")
'blablabla ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Select

lbl2:
If ThisWorkbook.Sheets("data ze vstupu").Range("U202").Value <> "Vypln|fffd|no" Then
    'nevypln|fffd|ny poplatky = nic
    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G7").Value = 0
    GoTo konec
Else
' RPSN Makro pro list 'v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR'
' se|fffd|te spl|fffd|tky jistiny a celkem by m|fffd|la vyj|fffd|t stejn|fffd| hodnota jako p|fffd|vodn|fffd| |fffd|astka
' m|fffd|n|fffd| se mi hodnota v|fffd||fffd|e spl|fffd|tky (na z|fffd|klad|fffd| hledan|fffd| sazby (RPSN))
'  prvn|fffd| provede zaokrouhlov|fffd|n|fffd| hodnot poji|fffd|t|fffd|n|fffd| a spl|fffd|tky pro v|fffd|po|fffd|et RPSN

'pou|fffd|ije zaokrouhlen|fffd| spl|fffd|tky na cel|fffd| koruny vzorcem v bu|fffd|ce
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("H11").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G2").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G11").Value

'zaokrouhlov|fffd|n|fffd| poji|fffd|t|fffd|n|fffd|
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C18").Value = ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("D18").Value

ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G7").Value = 5
ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("N421").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("C3"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Range("G7")
'blabla Range("G7").Select
End If

' vynuluje pole, kter|fffd| se m|fffd|n|fffd| na nezobrazit pokud se zm|fffd|n|fffd| zadan|fffd| hodnoty. (je t|fffd|eba nejd|fffd||fffd|ve spustit v|fffd|po|fffd|et spl|fffd|tky a RPSN)
    
konec:
'BLABLA    ThisWorkbook.Sheets("1_Kalkulace").Select
'' zobrazVypocetList1_Kalkulace Makro
'    Range("B1").Value = "zobrazVypocet"
'    Range("C1").Value = "zobrazVypocetRPSN"

    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
'    ThisWorkbook.Sheets("v|fffd|po|fffd|et_spl|fffd|tky_maxPRIBOR").Visible = xlSheetVeryHidden
    Application.ScreenUpdating = ScreenUpdatingStavPred
End Sub





Attribute VB_Name = "Module19"
Option Explicit

Private Sub vymazRadek()
Sheets("1_Kalkulace").Rows("101:150").EntireRow.Delete XlDeleteShiftDirection.xlShiftUp
End Sub

Attribute VB_Name = "Module2"


'funkce, kter|fffd| ov|fffd||fffd|uje, zda existuje slo|fffd|ka
Function DirExists(sSDirectory As String) As Boolean
If Dir(sSDirectory, vbDirectory) <> "" Then DirExists = True
End Function

Private Sub SplatkovyKalendarPdf()
'pro jistotu p|fffd|epo|fffd|te spl|fffd|tku a RPSN
    Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
    Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
' vypne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = False
    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = True
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Select

        posledni_radek_tisku = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H9").Value
        
        
        Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("1:462").Hidden = False
        skryt_oblast_prazdnych_radku = Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("H7").Value
        Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("" & skryt_oblast_prazdnych_radku & "").Hidden = True
        
        'skryt_oblast_prazdnych_radku_kvartalu = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("I7").Value
        For i = 0 To 11
            If Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("A" & 18 + i).Value = False Then
                Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows(18 + i).Hidden = True
            End If
        Next i
        
        skryt_oblast_prazdnych_radku_pojisteni = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("J7").Value
        Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Rows("" & skryt_oblast_prazdnych_radku_pojisteni & "").Hidden = True
        
        ' zkontroluje jestli je na disku C: slo|fffd|ka hypo-kalkul|fffd|tor, pokud ne, vytvo|fffd||fffd| ji
        If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ\"
        If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
        
        Dim nazev_souboru As String
        nazev_souboru = "splatkovy-kalendar-" & Format(Now, "YYYY-MM-DD_HH-MM-SS") & ".pdf"
                
                    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17:L462").Delete
                    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Range("B17", Cells(462, 12)).SpecialCells(xlCellTypeVisible).Copy
                    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17").PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlPasteSpecialOperationNone
                    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B17").PasteSpecial Paste:=xlPasteFormats
                    Application.CutCopyMode = False
                    
                        Dim sht As Worksheet
                        Dim LastRow As Long
                    Set sht = ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final")
                    LastRow = sht.Cells(sht.Rows.Count, "B").End(xlUp).Row
                    sht.Visible = True
                    sht.Select
                    sht.Range("B17", Cells(LastRow - 1, 12)).Sort key1:=Range("C18"), order1:=xlAscending, Header:=xlYes
                    sht.PageSetup.PrintArea = "$B$1:$L$" & LastRow
                    
            
        
        
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B1", Cells(LastRow, 12)).ExportAsFixedFormat Type:=xlTypePDF, _
            FileName:="C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru, Quality:=xlQualityStandard, IncludeDocProperties:=True, IgnorePrintAreas:=False, OpenAfterPublish:=False
            
            'p|fffd||fffd|padn|fffd| tisk
            'Application.Dialogs(xlDialogPrint).Show Arg4:=1, Arg12:=True
            
        ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Range("B1").Select
                myval = Shell("explorer " & "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru, 1)
konec:
    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd|").Visible = False
    ThisWorkbook.Sheets("Spl|fffd|tkov|fffd| kalend|fffd||fffd| final").Visible = False
    ThisWorkbook.Sheets("1_Kalkulace").Select
    ' zapne aktualizaci obrazovky (aby nep|fffd|eskakoval obraz)
    Application.ScreenUpdating = True
End Sub


Attribute VB_Name = "Module20"
Option Explicit

Sub Makro3()
'
' Makro3 Makro
'

'
    ActiveCell.FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,RC[9],"" "")"
    Range("N29").Select
    ActiveCell.FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,RC[9],"" "")"
    Range("N30").Select
    ActiveCell.FormulaR1C1 = ""
    Range("N30").Select
    ActiveCell.FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,RC[9],"" "")"
    Range("N31").Select
End Sub
Sub Makro5()
'
' Makro5 Makro
'

'
    Range("Q28").Select
    ActiveCell.FormulaR1C1 = "=IF(VALUE(R26C23)>RC13,""@"","""")"
    Range("Q28").Select
    Selection.Copy
    Range(Selection, Selection.End(xlDown)).Select
    ActiveSheet.Paste
End Sub

Attribute VB_Name = "Module21"
Option Explicit

Sub Makro1()
'
' Makro1 Makro


' promaz|fffd|n|fffd| listu v|fffd|stavba
    Sheets("2_V|fffd|stavba").Range("C4:C6").ClearContents
    Sheets("2_V|fffd|stavba").Range("C9:C10").ClearContents
    Sheets("2_V|fffd|stavba").Range("C12:C13").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("G24").ClearContents
    Sheets("2_V|fffd|stavba").Range("G22").ClearContents
    Sheets("2_V|fffd|stavba").Range("G20").ClearContents
    Sheets("2_V|fffd|stavba").Range("G18").ClearContents
    Sheets("2_V|fffd|stavba").Range("G16").ClearContents
    Sheets("2_V|fffd|stavba").Range("G14").ClearContents
    Sheets("2_V|fffd|stavba").Range("G12").ClearContents
    Sheets("2_V|fffd|stavba").Range("G10").ClearContents
    Sheets("2_V|fffd|stavba").Range("G8").ClearContents
    Sheets("2_V|fffd|stavba").Range("G4").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("I24").ClearContents
    Sheets("2_V|fffd|stavba").Range("I22").ClearContents
    Sheets("2_V|fffd|stavba").Range("I20").ClearContents
    Sheets("2_V|fffd|stavba").Range("I18").ClearContents
    Sheets("2_V|fffd|stavba").Range("I16").ClearContents
    Sheets("2_V|fffd|stavba").Range("I14").ClearContents
    Sheets("2_V|fffd|stavba").Range("I12").ClearContents
    Sheets("2_V|fffd|stavba").Range("I10").ClearContents
    Sheets("2_V|fffd|stavba").Range("I8").ClearContents
    Sheets("2_V|fffd|stavba").Range("I4").ClearContents
    
    Sheets("2_V|fffd|stavba").Range("C4").Select
'-----------------------
End Sub
Attribute VB_Name = "Module22"
'Option Explicit

'Sub pokus()
'
'
'If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
'If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"
'
''otev|fffd|en|fffd| objektu (jm|fffd|no je zde zadostWord2zadatele)
'  ThisWorkbook.Sheets("Zadost").Shapes.Range("zadostWord2zadatele").Select
'  Selection.Verb Verb:=xlOpen
'
'
' 'p|fffd|i|fffd|azen|fffd| instance wordu
' Set wd = GetObject(class:="Word.Application")
'     wd.Visible = True
'
'Dim nazev_souboru As String
'nazev_souboru = "Zadost_" & Format(Now, "YYYY-MM-DD_HH-MM-SS")
''n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
'Dim SaveAsName
'SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".docx"
'
''ulo|fffd||fffd|me jako nov|fffd| soubor a zav|fffd|eme (abychom si nepobo|fffd|ili |fffd|ablonu v Excelu)
'With wd
'    .documents(1).SaveAs Filename:=SaveAsName
'    .documents(1).Saved = True
'    '''.ActiveWindow.Close
'    .documents(1).Close SaveChanges:=False
'End With
'
''otev|fffd|eme nov|fffd| ulo|fffd|en|fffd| Word
' Dim ulozeny_word As Object
' Set ulozeny_word = GetObject(SaveAsName)
''pracujeme se souborem wordu - s vlastnostmi t|fffd||fffd|dy "Application"
' Dim novy_dokument As Object
' Set novy_dokument = ulozeny_word.Application
'     novy_dokument.Visible = True
'
'With novy_dokument
''upravujeme dokument (dopl|fffd|ujeme na|fffd|ten|fffd| |fffd|daje, do m|fffd|sta z|fffd|lo|fffd|ek p|fffd|edvytvo|fffd|en|fffd|ch ve Wordu)
'
'''        .Documents(1).Bookmarks("\EndOfDoc").Range.InsertBreak
'''        .Documents(1).Bookmarks("\EndOfDoc").Range.InsertFile Filename:="C:\Users\saska mirek\Desktop\Vojta - hypokalk |fffd|prava 24.5.2017\LD_Sberbank hypo_word_V1.docx"
'
''.Documents(1).Bookmarks("poji|fffd|t|fffd|n|fffd|").Range.Delete
'
'
'    'vymazat l|fffd|ka|fffd|sk|fffd| dotazn|fffd|k, pokud nen|fffd| poji|fffd|t|fffd|n|fffd|
'    If ThisWorkbook.Sheets("Zadost").Range("D110").Value = "vymazat" Then
'        pocetSekci = .documents(1).Sections.Count
'        .documents(1).Sections(pocetSekci).Range.Delete
'        .documents(1).Bookmarks("\EndOfDoc").Select
'        With novy_dokument.Selection
'            .EndKey
'            .TypeBackspace
'        End With
'    Else
'        'naplnit hodnoty do l|fffd|ka|fffd|sk|fffd|ho dotazn|fffd|ku
'        Dim pojisteniLekarDotazVyseUveru
'        pojisteniLekarDotazVyseUveru = ThisWorkbook.Sheets("Zadost").Range("D100").Value
'        Dim pojisteniLekarDotazDobaSplaceniLet
'        pojisteniLekarDotazDobaSplaceniLet = ThisWorkbook.Sheets("Zadost").Range("D101").Value
'        Dim pojisteniLekarDotazProdejceJmeno
'        pojisteniLekarDotazProdejceJmeno = ThisWorkbook.Sheets("Zadost").Range("D102").Value
'        Dim pojisteniLekarDotazProdejceTel
'        pojisteniLekarDotazProdejceTel = ThisWorkbook.Sheets("Zadost").Range("D103").Value
'        Dim pojisteniLekarDotazProdejceEmail
'        pojisteniLekarDotazProdejceEmail = ThisWorkbook.Sheets("Zadost").Range("D105").Value
'        Dim pojLekarDotazStand
'        pojLekarDotazStand = ThisWorkbook.Sheets("Zadost").Range("D106").Value
'        Dim pojLekarDotazPlus
'        pojLekarDotazPlus = ThisWorkbook.Sheets("Zadost").Range("D107").Value
'        Dim pojLekarDotazKlasik
'        pojLekarDotazKlasik = ThisWorkbook.Sheets("Zadost").Range("D108").Value
'        Dim pojLekarDotazPremium
'        pojLekarDotazPremium = ThisWorkbook.Sheets("Zadost").Range("D109").Value
'        .documents(1).Bookmarks("pojisteniLekarDotazVyseUveru").Select
'        .Selection.TypeText Text:=pojisteniLekarDotazVyseUveru
'
'        .documents(1).Bookmarks("pojisteniLekarDotazDobaSplaceniLet").Select
'        .Selection.TypeText Text:=pojisteniLekarDotazDobaSplaceniLet
'
'        .documents(1).Bookmarks("pojisteniLekarDotazProdejceJmeno").Select
'        .Selection.TypeText Text:=pojisteniLekarDotazProdejceJmeno
'
'        .documents(1).Bookmarks("pojisteniLekarDotazProdejceTel").Select
'        .Selection.TypeText Text:=pojisteniLekarDotazProdejceTel
'
'        .documents(1).Bookmarks("pojisteniLekarDotazProdejceEmail").Select
'        .Selection.TypeText Text:=pojisteniLekarDotazProdejceEmail
'
'
'
'         .documents(1).FormFields("pojLekarDotazStand").CheckBox.Value = pojLekarDotazStand
'         .documents(1).FormFields("pojLekarDotazPlus").CheckBox.Value = pojLekarDotazPlus
'    End If
'    'Set aRange = .documents(1).Range(Start:=.documents(1).Bookmarks("konecZadosti").Range.Start, End:=.documents(1).Bookmarks("\EndOfDoc").Range.End)
'    'aRange.Delete
'    '''.documents(1).Application.SendKeys ("{BACKSPACE}")
'    '''.documents(1).Sections(pocetSekci).Range.Delete
'
'
'
'    'For Each oSec In .Documents(1).Sections
'    'If oSec.Index > 1 Then
'        ''.Documents(1).Range(oSec.Range.Start - 1, oSec.Range.End).Delete
'        '.Documents(1).Sections(pocetSekci).Range(oSec.Range.Start - 1, oSec.Range.End).Delete
'    'End If
'    'Next oSec
'
'.ActiveDocument.Save 'As Filename:=saveasnamePDF
'Dim saveasnamePDF
'saveasnamePDF = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"
''17 is the value of the symbolic constant wdFormatPDF.
'.ActiveDocument.SaveAs saveasnamePDF, 17
'
'''mo|fffd|no zav|fffd||fffd|t jen toto okno
''.ActiveWindow.Close
'End With
'
''pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
'
'    If wd.documents.Count > 1 Then
'        wd.documents(1).Close SaveChanges:=True
'        Else
'        wd.Quit SaveChanges:=True
'    End If
'
'Set wd = Nothing
'Set ulozeny_word = Nothing
'Set novy_dokument = Nothing
'
'End Sub
Attribute VB_Name = "Module23"
Option Explicit

'Sub splatkaZPoctuMesicu()
'
'    Debug.Print ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B3").Value
'    Debug.Print ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("F384").Value
'    Debug.Print ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value
'
'
'    ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("F384").GoalSeek Goal:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B3"), ChangingCell:=ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5")
'    ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value = WorksheetFunction.Ceiling(ThisWorkbook.Sheets("v|fffd|po|fffd|et_splatnosti").Range("B5").Value, 1)
'End Sub
Attribute VB_Name = "Module3"

Sub Message()
'
' Message Makro
'

'
    a = "Hello"
    G = a
    
    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("TextBox 3")).Select
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters.Text = _
        "POMP" & Chr(13) & "" & Chr(13) & a & Chr(13) & "" & Chr(13) & G
    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 5).ParagraphFormat. _
        FirstLineIndent = 0
    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(1, 5).Font
        .NameComplexScript = "+mn-cs"
        .NameFarEast = "+mn-ea"
        .Fill.Visible = msoTrue
        .Fill.ForeColor.RGB = RGB(255, 0, 0)
        .Fill.Transparency = 0
        .Fill.Solid
        .Size = 11
        .Name = "+mn-lt"
    End With
'    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(6, 1).ParagraphFormat. _
'        FirstLineIndent = 0
'    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(6, 1).Font
'        .NameComplexScript = "+mn-cs"
'        .NameFarEast = "+mn-ea"
'        .Fill.Visible = msoTrue
'        .Fill.ForeColor.RGB = RGB(255, 0, 0)
'        .Fill.Transparency = 0
'        .Fill.Solid
'        .Size = 11
'        .Name = "+mn-lt"
'    End With
'    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(7, 5).ParagraphFormat. _
'        FirstLineIndent = 0
'    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(7, 5).Font
'        .NameComplexScript = "+mn-cs"
'        .NameFarEast = "+mn-ea"
'        .Fill.Visible = msoTrue
'        .Fill.ForeColor.RGB = RGB(255, 0, 0)
'        .Fill.Transparency = 0
'        .Fill.Solid
'        .Size = 11
'        .Name = "+mn-lt"
'    End With
'    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(12, 1).ParagraphFormat. _
'        FirstLineIndent = 0
'    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(12, 1).Font
'        .NameComplexScript = "+mn-cs"
'        .NameFarEast = "+mn-ea"
'        .Fill.Visible = msoTrue
'        .Fill.ForeColor.RGB = RGB(255, 0, 0)
'        .Fill.Transparency = 0
'        .Fill.Solid
'        .Size = 11
'        .Name = "+mn-lt"
'    End With
'    Selection.ShapeRange(1).TextFrame2.TextRange.Characters(13, 9).ParagraphFormat. _
'        FirstLineIndent = 0
'    With Selection.ShapeRange(1).TextFrame2.TextRange.Characters(13, 9).Font
'        .NameComplexScript = "+mn-cs"
'        .NameFarEast = "+mn-ea"
'        .Fill.Visible = msoTrue
'        .Fill.ForeColor.RGB = RGB(255, 0, 0)
'        .Fill.Transparency = 0
'        .Fill.Solid
'        .Size = 11
'        .Name = "+mn-lt"
'    End With
    Range("G34").Select
End Sub


Attribute VB_Name = "Module4"


Sub Spoluzadatele1()
    
    
    UserForm1.Show
    
End Sub
Sub Predsmluvky()
    
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E8").Value = "v po|fffd||fffd|dku" Then
        Predsmluvni_informace.Show
    Else
       MsgBox ThisWorkbook.Sheets("Data ze vstupu").Range("F8").Value, vbCritical, "Nelze pokra|fffd|ovat na vypln|fffd|n|fffd| poplatk|fffd| a tisk ESIP"
    End If
    
End Sub

Sub Danove_priznani_skryt()
'
' Danove_priznani_skryt Makro
'

'
    ThisWorkbook.Sheets("1_Kalkulace").Shapes("Drop Down 52").Select
    With Selection
    .Visible = True
    End With
    
    Rows("44:71").Select
    Selection.EntireRow.Hidden = False
    Range("B28").Select
End Sub

Sub Skr|fffd|v|fffd|n|fffd|_box|fffd|()
'
' Skr|fffd|v|fffd|n|fffd|_box|fffd| Makro
'

'
    
    With Array("Drop Down 42")
        .Placement = xlMove
        .PrintObject = False
    End With
    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Drop Down 43")).Select
    With Selection
        .Placement = xlFreeFloating
        End With
End Sub

Attribute VB_Name = "Module5"
Option Explicit

Sub Skr|fffd|v|fffd|n|fffd|1()
' Toto skr|fffd|v|fffd| |fffd||fffd|dky k p|fffd||fffd|jm|fffd|m u da|fffd|ov|fffd|ho p|fffd|izn|fffd|n|fffd|
    a = ThisWorkbook.Sheets("Data ze vstupu").Range("N3").Value
    ThisWorkbook.Sheets("1_Kalkulace").Select
    If a = 0 Then Rows("43:49").EntireRow.Hidden = True
    If a = 1 Then Rows("43:49").EntireRow.Hidden = False
End Sub

Sub Skr|fffd|v|fffd|n|fffd|2()
' Toto skr|fffd|v|fffd| |fffd||fffd|dky a nastaven|fffd| dle produktu
'    B = ThisWorkbook.Sheets("Data ze vstupu").Range("M6").Value
'    C = ThisWorkbook.Sheets("Data ze vstupu").Range("M12").Value
'    ThisWorkbook.Sheets("1_Kalkulace").Select
'    Select Case B
'    Case "F|fffd|R hypot|fffd|ka":                                Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = True
'    Case "F|fffd|R hypot|fffd|ka (na pron|fffd|jem)":                  Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = True
'    Case "F|fffd|R hypot|fffd|ka (s deklarovan|fffd|m p|fffd||fffd|jmem)":       Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = True
'    Case "REFINANCOV|fffd|N|fffd| hypot|fffd|ky - s p|fffd||fffd|jmem":          Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = True
'    Case "REFINANCOV|fffd|N|fffd| hypot|fffd|ky - bez p|fffd||fffd|jmu":         Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = True
'    Case "AMERICK|fffd| hypot|fffd|ka":                           Rows("98:103").EntireRow.Hidden = False: Rows("104:109").EntireRow.Hidden = True
'    Case "AMERICK|fffd| hypot|fffd|ka (s deklarovan|fffd|m p|fffd||fffd|jmem)":  Rows("98:103").EntireRow.Hidden = False: Rows("104:109").EntireRow.Hidden = True
'    Case "P|fffd|EDHYPOTE|fffd|N|fffd| |fffd|v|fffd|r":                          Rows("98:103").EntireRow.Hidden = True: Rows("104:109").EntireRow.Hidden = False: Select Case C
'            Case "Ano": Rows("108:109").EntireRow.Hidden = False
'            Case "Ne": Rows("108:109").EntireRow.Hidden = True
'        End Select
'End Select
End Sub

Sub Skr|fffd|v|fffd|n|fffd|3()
' Toto skr|fffd|v|fffd| |fffd||fffd|dky ke konsolidaci a zobrazuje list s Konsolidac|fffd|
'    D = ThisWorkbook.Sheets("Data ze vstupu").Range("N9").Value
'    ThisWorkbook.Sheets("1_Kalkulace").Select
'    If D = 0 Then Rows("110:112").EntireRow.Hidden = True: ThisWorkbook.Sheets(15).Visible = False
'    If D = 1 Then Rows("110:112").EntireRow.Hidden = False: ThisWorkbook.Sheets(15).Visible = True
        
End Sub

Sub Skr|fffd|v|fffd|n|fffd|4()
' Toto skr|fffd|v|fffd| list s v|fffd|stavbou nebo naopak zobrazuje, z|fffd|le|fffd||fffd| na volb|fffd| |fffd|erp|fffd|n|fffd|
'    E = ThisWorkbook.Sheets("Data ze vstupu").Range("M15").Value
'    Select Case E
'    Case "Jednor|fffd|zov|fffd|":             ThisWorkbook.Sheets(27).Visible = False
'    Case "Postupn|fffd| - v|fffd|stavba":     ThisWorkbook.Sheets(27).Visible = True
'    End Select
End Sub

Attribute VB_Name = "Module6"
Option Explicit



Attribute VB_Name = "Module7"
Option Explicit

'Sub BarvaTest()
''
'' BarvaTest Makro
''
'
''
'  u = Range("U203").Value
'  If u = 0 Then
'  ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Rounded Rectangle 2")).Select
'    With Selection.ShapeRange.Fill
'        .Visible = msoTrue
'        .ForeColor.RGB = RGB(229, 229, 229)
'        .Transparency = 0
'        .Solid
'    End With
'    Else
'    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Rounded Rectangle 2")).Select
'    With Selection.ShapeRange.Fill
'        .Visible = msoTrue
'        .ForeColor.RGB = RGB(54, 154, 30)
'        .Transparency = 0
'        .Solid
'    End With
'    End If
'    Range("C21").Select
'End Sub
Sub Makro4()
'
' Makro4 Makro
'

'
    Selection.ShapeRange.Item(1).Hyperlink.Follow NewWindow:=False, AddHistory _
        :=True
    ThisWorkbook.Sheets("1_Kalkulace").Select
    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Rounded Rectangle 3")).Select
    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Rounded Rectangle 2")).Select
    With Selection.ShapeRange.Line
        .Visible = msoTrue
        .ForeColor.RGB = RGB(54, 154, 30)
        .Transparency = 0
    End With
    Range("N14").Select
    ThisWorkbook.Sheets("1_Kalkulace").Shapes.Range(Array("Rounded Rectangle 2")).Select
    With Selection.ShapeRange.Fill
        .Visible = msoTrue
        .ForeColor.RGB = RGB(54, 154, 30)
        .Transparency = 0
        .Solid
    End With
    With Selection.ShapeRange.Line
        .Visible = msoTrue
        .ForeColor.RGB = RGB(235, 127, 46)
        .Transparency = 0
    End With
    Range("L13").Select
End Sub


Attribute VB_Name = "Module8"


Public Sub menu_zadatele()
'menu |fffd|adatel|fffd| (hlavn|fffd| |fffd|adatel, spolu|fffd|adatel 1, spolu|fffd|adatel 2, spolu|fffd|adatel 3, souhrn)
    'po|fffd|et |fffd|adatel|fffd|
    N = ThisWorkbook.Sheets("Data ze vstupu").Range("W26").Value
Select Case N
    Case 0
    With ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    .Tabs(0).Visible = True
    .Tabs(1).Visible = False
    .Tabs(2).Visible = False
    .Tabs(3).Visible = False
    .Tabs(4).Visible = False
    End With
    
    Case 1
    With ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    .Tabs(0).Visible = True
    .Tabs(1).Visible = False
    .Tabs(2).Visible = False
    .Tabs(3).Visible = False
    .Tabs(4).Visible = True
    End With
    
    Case 2
    With ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    .Tabs(0).Visible = True
    .Tabs(1).Visible = True
    .Tabs(2).Visible = False
    .Tabs(3).Visible = False
    .Tabs(4).Visible = True
    End With
    
    Case 3
    With ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    .Tabs(0).Visible = True
    .Tabs(1).Visible = True
    .Tabs(2).Visible = True
    .Tabs(3).Visible = False
    .Tabs(4).Visible = True
    End With
    
    Case 4
    With ThisWorkbook.Sheets("1_Kalkulace").TabStrip1
    .Tabs(0).Visible = True
    .Tabs(1).Visible = True
    .Tabs(2).Visible = True
    .Tabs(3).Visible = True
    .Tabs(4).Visible = True
    End With
End Select
End Sub
Public Sub menu_domacnost()
'z|fffd|lo|fffd|ky dom|fffd|cnost|fffd| - jednotliv|fffd| dom|fffd|cnost 1, dom|fffd|cnost 2, dom|fffd|cnost 3, jsou viditeln|fffd| podle vybran|fffd|ch |fffd||fffd|sel dom|fffd|cnosti u |fffd|adatel|fffd|
    Row = 35
    Col = 24
'dom|fffd|cnost 1
    Select Case ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col).Value
        Case 0
             With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
            .Tabs(0).Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tabstrip3_domacnost1").Visible = False
            End With
        Case 1
            With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
           .Tabs(0).Visible = True
           ThisWorkbook.Sheets("1_Kalkulace").Shapes("tabstrip3_domacnost1").Visible = True
           End With
    End Select
'dom|fffd|cnost 2
    Select Case ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col + 1).Value
        Case 0
             With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
            .Tabs(1).Visible = False
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tabstrip3_domacnost2").Visible = False
            End With
        Case 1
             With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
            .Tabs(1).Visible = True
            ThisWorkbook.Sheets("1_Kalkulace").Shapes("tabstrip3_domacnost2").Visible = True
            End With
    End Select
''dom|fffd|cnost 3
'    Select Case ThisWorkbook.Sheets("Data ze vstupu").Cells(Row, Col + 2).Value
'        Case 0
'             With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
'            .Tabs(2).Visible = False
'            End With
'        Case 1
'             With ThisWorkbook.Sheets("1_Kalkulace").TabStrip3
'            .Tabs(2).Visible = True
'            End With
'    End Select

'Souhrn vid|fffd|t v|fffd|dy
ThisWorkbook.Sheets("1_Kalkulace").TabStrip3.Tabs(3).Visible = True

End Sub
Public Sub nastaveni_policek_danprijmy()

TextBox43.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 24).Value, 0)
TextBox43.Value = Format(TextBox43.Value, "### ### ### ###")

TextBox45.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 26).Value, 0)
TextBox45.Value = Format(TextBox45.Value, "### ### ### ###")

TextBox46.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 27).Value, 0)
TextBox46.Value = Format(TextBox46.Value, "### ### ### ###")

TextBox47.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 28).Value, 0)
TextBox47.Value = Format(TextBox47.Value, "### ### ### ###")

TextBox49.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 30).Value, 0)
TextBox49.Value = Format(TextBox49.Value, "### ### ### ###")

TextBox50.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 31).Value, 0)
TextBox50.Value = Format(TextBox50.Value, "### ### ### ###")

TextBox51.Value = Round(ThisWorkbook.Sheets("Data ze vstupu").Cells(Row + ThisWorkbook.Sheets("1_Kalkulace").TabStrip1.Value, 32).Value, 0)
TextBox51.Value = Format(TextBox51.Value, "### ### ### ###")

End Sub

Attribute VB_Name = "Module9"

Sub ChecklistPdf()
''pocet_sloupcu ve zdrojov|fffd|m Excelu 16 ale pole za|fffd||fffd|n|fffd| od nuly je jenom 15 (list dopisy_zdroj_hodnot-jeden_mesic)
'pocet_sloupcu = 15
'
''cyklus pro na|fffd|ten|fffd| jednoho |fffd||fffd|dku s popisky (do prom|fffd|nn|fffd| typu pole)
'ReDim pole_popisky_pro_word(pocet_sloupcu) As String
''''nebo-li pro lep|fffd||fffd| pochopen|fffd|
''''pole_popisky_pro_word(1) = 'datum_odeslani'
''''pole_popisky_pro_word(2) = 'uver_cislo'
''''pole_popisky_pro_word(3) = 'klient_jm'
    Dim ScreenUpdatingStavPred As Boolean
    ScreenUpdatingStavPred = Application.ScreenUpdating
    Application.ScreenUpdating = False

ThisWorkbook.Sheets("Checklist").Visible = True
ThisWorkbook.Sheets("Checklist").Select


'n|fffd|zev souboru podle syntaxe od LBO (David1 Stejskal)..
nazev_souboru = "checklist"

 Dim wd As Object
'prom|fffd|nn|fffd| z Excelu

'list v Excelu, kde je ulo|fffd|en|fffd| |fffd|ablona (jako objekt wordu)
'otev|fffd|en|fffd| objektu (jm|fffd|no)
  'kdy|fffd|
    ActiveSheet.Shapes.Range(Array("checklist")).Select
  Selection.Verb Verb:=xlOpen
 
 'p|fffd|i|fffd|azen|fffd| instance wordu
 Set wd = GetObject(class:="Word.Application")
     wd.Visible = False

'n|fffd|zev a cesta pro ulo|fffd|en|fffd| souboru (vyu|fffd||fffd|v|fffd|me, kde je soubor Excelu a tam ulo|fffd||fffd|me jako libovoln|fffd| n|fffd|zev)
'vytvo|fffd|it podadres|fffd||fffd| .. pokud neexistuje
rok_mesic = Range("A3")
' zkontroluje jestli je na disku C: slo|fffd|ka hypo-dopisy, pokud ne, vytvo|fffd||fffd| ji
If Not DirExists("C:\Sberbank CZ") Then MkDir "C:\Sberbank CZ"
If Not DirExists("C:\Sberbank CZ\hypo-kalkul|fffd|tor") Then MkDir "C:\Sberbank CZ\hypo-kalkul|fffd|tor"

SaveAsName = "C:\Sberbank CZ\hypo-kalkul|fffd|tor\" & nazev_souboru & ".pdf"

'17 is the value of the symbolic constant wdFormatPDF.
wd.documents(1).SaveAs SaveAsName, 17

''mo|fffd|no zav|fffd||fffd|t jen toto okno
'.ActiveWindow.Close

'pokud je v|fffd|ce jak jeden otev|fffd|en|fffd| dokument, zav|fffd|e pouze okno, jinak zav|fffd|e cel|fffd| word (|fffd|skal|fffd| = pokud m|fffd|m rozpracovanou jinou aplikaci, ta se p|fffd|ihl|fffd|s|fffd|, jestli chci ulo|fffd|it ten jin|fffd| rozpracovan|fffd| soubor)
    If wd.documents.Count > 1 Then
        wd.documents(1).Close SaveChanges:=True
        wd.Visible = True
        Else
        wd.Quit SaveChanges:=True
    End If

Set wd = Nothing
Set ulozeny_word = Nothing
Set novy_dokument = Nothing

ThisWorkbook.Sheets("Checklist").Visible = False
ThisWorkbook.Sheets("1_Kalkulace").Select
Application.ScreenUpdating = ScreenUpdatingStavPred

''YesNo = MsgBox("P|fffd|ejete si otev|fffd||fffd|t vygenerovan|fffd| checklist?" _
'', vbYesNo + vbQuestion, "Otev|fffd||fffd|t slo|fffd|ku?")
''    Select Case YesNo
''    Case vbYes
    myval = Shell("explorer " & SaveAsName, 1)
''    Case vbNo
''    End Select
End Sub



Attribute VB_Name = "Predsmluvni_informace"
Attribute VB_Base = "0{9D1147B5-8EA4-4F97-9C82-0A405A6B31C7}{881ECD6F-1E3D-4966-842B-C224CCBC57CC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub Image1_Click()
'Tisk
''MsgBox "Kliknut|fffd| na tla|fffd||fffd|tko tisk zaznamen|fffd|no", vbDefaultButton1, "Tisk bude dopln|fffd|n v dal|fffd||fffd| verzi"
Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
    Call generovatESIP
End Sub

Private Sub Image2_Click()
'ZAV|fffd||fffd|T
Unload Predsmluvni_informace
End Sub


Private Sub TextBox2_Change()
    With TextBox2
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 2 Then
            .Value = Left(.Value, 2)
        Else
            ThisWorkbook.Sheets("Data ze vstupu").Range("U207").Value = Val(.Value)
            TextBox12.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W207").Value, "#0")
        End If
    End With
End Sub

Private Sub TextBox3_Change()
    With TextBox3
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 2 Then
            .Value = Left(.Value, 2)
        Else
            ThisWorkbook.Sheets("Data ze vstupu").Range("U210").Value = Val(TextBox3.Value)
            TextBox13.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W210").Value, "### ### ###")
        End If
    End With
End Sub

Private Sub TextBox4_Change()
    With TextBox4
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 2 Then
            .Value = Left(.Value, 2)
        Else
            ThisWorkbook.Sheets("Data ze vstupu").Range("U211").Value = Val(TextBox4.Value)
            TextBox14.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W211").Value, "### ### ###")
        End If
    End With
End Sub

Private Sub TextBox5_Change()
    With TextBox5
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 2 Then
            .Value = Left(.Value, 2)
        Else
            ThisWorkbook.Sheets("Data ze vstupu").Range("U212").Value = Val(TextBox5.Value)
            TextBox15.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W212").Value, "### ### ###")
        End If
    End With
End Sub

Private Sub TextBox6_Change()
    With TextBox6
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 2 Then
            .Value = Left(.Value, 2)
        Else
            ThisWorkbook.Sheets("Data ze vstupu").Range("U217").Value = Val(TextBox6.Value)
            TextBox16.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W217").Value, "### ### ###")
        End If
    End With
End Sub

Private Sub TextBox7_Change()
    With TextBox7
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 6 Then
            .Value = Left(.Value, 6)
        Else
            .Value = Format(.Value, "### ###")
            ThisWorkbook.Sheets("Data ze vstupu").Range("W222").Value = Val(.Value)
        End If
    End With
End Sub


Private Sub TextBox9_Change()
    With TextBox9
        If IsNumeric(.Value) = False Then
            .Value = ""
        ElseIf Len(.Value) > 6 Then
            .Value = Left(.Value, 6)
        Else
            .Value = Format(.Value, "### ###")
            ThisWorkbook.Sheets("Data ze vstupu").Range("W225").Value = Val(.Value)
        End If
    End With
End Sub

Sub UserForm_Initialize()
'Label1.Caption = "Zvolen|fffd| produkt: " & ThisWorkbook.Sheets("Data ze vstupu").Range("E65").Value
TextBox2.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("U207").Value
TextBox12.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W207").Value, "#0")
TextBox3.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("U210").Value
TextBox13.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W210").Value, "### ### ###")
TextBox4.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("U211").Value
TextBox14.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W211").Value, "### ### ###")
TextBox5.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("U212").Value
TextBox15.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W212").Value, "### ### ###")
TextBox6.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("U217").Value
TextBox16.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W217").Value, "### ### ###")
TextBox7.Value = ThisWorkbook.Sheets("Data ze vstupu").Range("W222").Value
TextBox8.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W224").Value, "### ### ###")

'odhad, pokud vypln|fffd|n ru|fffd|n|fffd|, na|fffd||fffd|st hodnotu ru|fffd|n|fffd|, jinak nechat
If ThisWorkbook.Sheets("Data ze vstupu").Range("W225").Value = 0 Then
    TextBox9.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("V225").Value, "### ### ###")
Else
    TextBox9.Value = Format(ThisWorkbook.Sheets("Data ze vstupu").Range("W225").Value, "### ### ###")
End If

'viditelnost u v|fffd|eho krom americk|fffd| hypo
    If ThisWorkbook.Sheets("Data ze vstupu").Range("Y212").Value = "TRUE" Then
            MultiPage1.Value = 0
            MultiPage1.Enabled = True
            MultiPage2.Top = 228
        Else
            'promazat hodnotu - p|fffd|i zm|fffd|n|fffd| produktu
            ThisWorkbook.Sheets("Data ze vstupu").Range("U212").Value = ""
            MultiPage1.Value = 1
            MultiPage1.Enabled = False
            MultiPage2.Top = 198
    End If
'viditelnost pouze u konsolidace a refinancov|fffd|n|fffd|
    If ThisWorkbook.Sheets("Data ze vstupu").Range("Y217").Value = "TRUE" Then
            MultiPage2.Value = 0
            MultiPage2.Enabled = True
        Else
            'promazat hodnotu - p|fffd|i zm|fffd|n|fffd| produktu
            ThisWorkbook.Sheets("Data ze vstupu").Range("U217").Value = ""
            MultiPage2.Value = 1
            MultiPage2.Enabled = False
    End If
End Sub

Private Sub UserForm_Terminate()
ThisWorkbook.Sheets("Data ze vstupu").Range("U207").Value = TextBox2.Value
ThisWorkbook.Sheets("Data ze vstupu").Range("U210").Value = TextBox3.Value
ThisWorkbook.Sheets("Data ze vstupu").Range("U211").Value = TextBox4.Value
ThisWorkbook.Sheets("Data ze vstupu").Range("U212").Value = TextBox5.Value
ThisWorkbook.Sheets("Data ze vstupu").Range("U217").Value = TextBox6.Value
ThisWorkbook.Sheets("Data ze vstupu").Range("W222").Value = TextBox7.Value

'odhad
ThisWorkbook.Sheets("Data ze vstupu").Range("W225").Value = TextBox9.Value

Call ThisWorkbook.Sheets("1_Kalkulace").vynulovatSplatku
Call ThisWorkbook.Sheets("1_Kalkulace").automaticky_vypocti_splatku
End Sub
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Deactivate()
 Application.DisplayFormulaBar = True
End Sub

Private Sub Workbook_Activate()
'servis
If True Then
    Application.DisplayFormulaBar = False
    ActiveWindow.DisplayWorkbookTabs = False
    ActiveWindow.DisplayHeadings = False
End If


''''kontrola na datum bez mezer
'''ThisWorkbook.Sheets("Data ze vstupu").Range("B8").Value = Format(Date, "D.M.YYYY")
'''If IsDate(ThisWorkbook.Sheets("Data ze vstupu").Range("B8").Value) Then
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C8").Value = "chyba"
'''  Else
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C8").Value = "datum v po|fffd||fffd|dku"
'''End If
'''
'''If CDate(ThisWorkbook.Sheets("Data ze vstupu").Range("D8").Value - 1) >= Date Then
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C8").Value = "DNES a v|fffd|c"
'''  Else
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C8").Value = "dnes a m|fffd||fffd|"
'''End If
'''
''''kontrola na datum s mezerami
'''ThisWorkbook.Sheets("Data ze vstupu").Range("B9").Value = Format(Date, "D. M. YYYY")
'''If IsDate(ThisWorkbook.Sheets("Data ze vstupu").Range("B9").Value) Then
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C9").Value = "chyba"
'''  Else
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C9").Value = "datum v po|fffd||fffd|dku"
'''End If
'''
'''If DateValue(ThisWorkbook.Sheets("Data ze vstupu").Range("B9").Value) >= Date Then
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C9").Value = "chyba"
'''  Else
'''    ThisWorkbook.Sheets("Data ze vstupu").Range("C9").Value = "datum v po|fffd||fffd|dku"
'''End If
'''
''''v|fffd|sledn|fffd| hl|fffd|ka z listu, pokud nen|fffd| ani v jednom form|fffd|tu (D.M.RRRR nebo D. M. YYYY)
'''If ThisWorkbook.Sheets("Data ze vstupu").Range("B10").Value = "datum bez mezer" Or ThisWorkbook.Sheets("Data ze vstupu").Range("B10").Value = "datum s mezerami" Then
'''    'nic
'''Else
'''    MsgBox ThisWorkbook.Sheets("Data ze vstupu").Range("B10").Value, vbCritical, "CHYBN|fffd| NASTAVEN|fffd| SYST|fffd|MU - Datum a |fffd|as (Kr|fffd|tk|fffd| form|fffd|t)"
'''End If



    
End Sub


Public Sub Workbook_Open()
    Application.Calculation = xlCalculationAutomatic
    ActiveWindow.Zoom = 100
    
    ThisWorkbook.Sheets("1_Kalkulace").Unprotect ("mival")
    ThisWorkbook.Sheets("1_Kalkulace").ScrollArea = "A1:I100"
    If ThisWorkbook.Sheets("Data ze vstupu").Range("E4") = "ESC" Then
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_uploadDoWorkflow").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_checklist").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_konsolidace").Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label97_kreditniKarta2v1.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox83_kreditniKarta2v1.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").Label98_kontokorent2v1.Visible = False
        ThisWorkbook.Sheets("1_Kalkulace").TextBox84_kontokorent2v1.Visible = False
        'p|fffd||fffd|jem externisty - nen|fffd| u v|fffd|ech ESC, aby se nemuselo vysv|fffd|tlovat u koho je (tajn|fffd|)
        ThisWorkbook.Sheets("1_Kalkulace").Rows("62").EntireRow.Hidden = True
    Else
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_uploadDoWorkflow").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_checklist").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Shapes("button_konsolidace").Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label97_kreditniKarta2v1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox83_kreditniKarta2v1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").Label98_kontokorent2v1.Visible = True
        ThisWorkbook.Sheets("1_Kalkulace").TextBox84_kontokorent2v1.Visible = True
        'p|fffd||fffd|jem externisty - nen|fffd| u v|fffd|ech ESC, aby se nemuselo vysv|fffd|tlovat u koho je (tajn|fffd|)
        ThisWorkbook.Sheets("1_Kalkulace").Rows("62").EntireRow.Hidden = False
    End If
    Range("a9").Select
    ThisWorkbook.Sheets("1_Kalkulace").Protect Password:=("mival"), AllowFormattingRows:=True
    ThisWorkbook.Sheets("1_Kalkulace").ComboBox4.Activate
''    On Error GoTo ErrHandler
''    Application.EnableEvents = False
''    Call welcome_screen_schovat
''ErrHandler:
''     ' error handling code
''        Select Case Err.Number
''        Case 0
''        Case 20
'''        Case 4198
'''            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd|" & vbNewLine & "(otev|fffd|enou nab|fffd|dku PDF)", vbCritical, "Chyba - nelze ulo|fffd|it PDF!"
'''        Case 5153
'''            wd.ActiveWindow.Close
'''            MsgBox "K vygenerov|fffd|n|fffd| nab|fffd|dky je pot|fffd|eba nejd|fffd||fffd|ve zav|fffd||fffd|t p|fffd|vodn|fffd| (otev|fffd|enou nab|fffd|dku)"
''        Case Else
''            MsgBox Err.Number & vbCrLf & Err.Description, vbCritical, "Chyba!"
''        End Select
''
''     Resume konec
''
''    'zru|fffd|en|fffd| v|fffd|eho error-handlen|fffd|
''konec:
''    Application.EnableEvents = True
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
''    Call welcome_screen_zobrazit
End Sub
Private Sub Workbook_AfterSave(ByVal Success As Boolean)
'ThisWorkbook.Sheets("1_Kalkulace").ComboBox12.Activate
End Sub
Private Sub Workbook_Close()
'ActiveWindow.DisplayWorkbookTabs = True
'Application.DisplayFormulaBar = True
End Sub

'If Success Then
' SendKeys "+"
'End If
'End Sub
'Private Sub Workbook_Activate()
' SendKeys "+"
' MsgBox "Aktiv"
' SendKeys "+"
'End Sub
'Private Sub Workbook_Deactivate()
' SendKeys "+"
' MsgBox "Deaktiv"
' SendKeys "+"
'End Sub
'Private Sub Workbook_SheetActivate(ByVal Sh As Object)
' If Sh.Name = "Uvodni_obrazovka" Then
'    SendKeys "+"
'    MsgBox Sh.Name
' End If
'End Sub


' InQuest injected base64 decoded content
' zu)u
' KnjX
' KnjX
' ^rz,
' gx!e
' gx!e
' zfZ>
' O*Yj8
' KnjX
' ^rz,
' ^rz,

INQUEST-PP=macro
