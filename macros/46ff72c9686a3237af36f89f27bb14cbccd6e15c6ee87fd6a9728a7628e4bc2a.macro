Attribute VB_Name = "Module1"
Public MyVariable As Boolean

Public Function GetSelectedSlicerItems(SlicerName As String) As String
    Dim oSc As SlicerCache
    Dim oSi As SlicerItem
    Dim lCt As Long
    On Error Resume Next
    Application.Volatile
    Set oSc = ThisWorkbook.SlicerCaches(SlicerName)
    If MyVariable = False Then
    
    If Not oSc Is Nothing Then
        For Each oSi In oSc.SlicerItems
            If oSi.Selected Then
                GetSelectedSlicerItems = GetSelectedSlicerItems & oSi.Name & ", "
                lCt = lCt + 1
            ElseIf oSi.HasData = False Then
                lCt = lCt + 1
            End If
        Next
        If Len(GetSelectedSlicerItems) > 0 Then
            If lCt = oSc.SlicerItems.Count Then
                GetSelectedSlicerItems = "All Items"
            Else
                GetSelectedSlicerItems = Left(GetSelectedSlicerItems, Len(GetSelectedSlicerItems) - 2)
            End If
        Else
            GetSelectedSlicerItems = "No items selected"
        End If
    Else
        GetSelectedSlicerItems = "No slicer with name '" & SlicerName & "' was found"
    End If
    
    End If
End Function

Sub RefreshPTable()
ActiveSheet.Unprotect ("abc")
'Worksheets("SelectedLocation").Unprotect ("abc")
Worksheets("M&E").PivotTables("PTReportTap").RefreshTable

Worksheets("M&E").PivotTables("PTReportTap").PivotFields(13).ShowDetail = False
 Worksheets("M&E").PivotTables("PTReportTap").PivotFields(58).ShowDetail = True
 Worksheets("M&E").PivotTables("PTReportTap").PivotFields(12).ShowDetail = True
 ' Worksheets("SelectedLocation").Protect Password:="abc"
  ActiveSheet.Protect Password:="abc"
End Sub

Sub CompareData()
ActiveSheet.Unprotect ("abc")
'Worksheets("SelectedLocation").Unprotect ("abc")
 Worksheets("M&E").PivotTables("PTReportTap").RefreshTable
 Worksheets("M&E").PivotTables("PTReportTap").PivotFields(13).ShowDetail = False
 Worksheets("M&E").PivotTables("PTReportTap").PivotFields(58).ShowDetail = True
 Worksheets("M&E").PivotTables("PTReportTap").PivotFields(12).ShowDetail = True
 ActiveSheet.Unprotect ("abc")
 ActiveSheet.Range("K15:K136").value = ActiveSheet.Range("E15:E126").value
 ActiveSheet.Range("J7:J12").value = ActiveSheet.Range("C7:C12").value
 
 'Worksheets("SelectedLocation").Protect Password:="abc"
  ActiveSheet.Protect Password:="abc"
End Sub

Sub validateAllRow()
Dim row As Range
Dim r As Integer
Dim Followup As Integer
r = 0

MsgBox ("It's will take time to vildate ,Please wait,Thanks")
For Each row In [Tbl_Nutrition4Ws].Rows

If row.Columns(26).value > 0 Then
 validateRowData (row.row)
 
 Else
 EmpatyValidateRowData (row.row)
 End If
 
 If row.Columns(19).value <> "Jan" Then
 Followup = Followup + row.Columns(27).value + row.Columns(28).value + row.Columns(29).value
 End If
 
 
 
    
Next

If Followup = 0 Then
 Cells(3, 3).value = "You are not report in follow up cases , Please double check your data"
 Else
 Cells(3, 3).value = ""
 End If

MsgBox ("Validate Data finished please see it in the left side,Thanks")
End Sub
Public Sub EmpatyValidateRowData(RowValue As Integer)
Dim value As Integer

If Cells(RowValue, 1).value <> "" Then
 Cells(RowValue, 1).value = ""
 End If
 
End Sub

Function rowMsg(msg As String, newMsg As String) As String

If msg <> "" Then

rowMsg = msg & Chr(10) & newMsg
End If

End Function

Public Sub validateRowData(RowValue As Integer)
Dim value As Integer

Cells(RowValue, 1).value = ""
MyVariable = True

Cells(RowValue, 1).value = ""

If IsEmpty(Cells(RowValue, 2).value) Then
Cells(RowValue, 1).value = "1 -  Hub (Please select)"
End If

' ---------------------------------

If IsEmpty(Cells(RowValue, 3).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation Type (Funding source) (Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation Type (Funding source) (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 4).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation Type (Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation Type (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 5).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation(Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 7).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Donor(Please Enter)")

Else

Cells(RowValue, 1).value = "1 Donor (Please Enter)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 8).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Choose Yes if it's an HRP project, and No if it's a non-HRP projec")

Else

Cells(RowValue, 1).value = "1 Choose Yes if it's an HRP project, and No if it's a non-HRP project"

    End If

End If


' --WHERE---------------------------------------------------------------------------------------------------------------------------

If Not Cells(RowValue, 68).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 Governorate (Please select)")

Else

Cells(RowValue, 1).value = "2 Governorate (Please select)"

    End If

End If

' --------------------------------------------

If Not Cells(RowValue, 69).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 District (Please select)")

Else

Cells(RowValue, 1).value = "2 District (Please select)"

    End If

End If


' --------------------------------------------

If Not Cells(RowValue, 70).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 SubDistrict (Please select)")

Else

Cells(RowValue, 1).value = "2 SubDistrict (Please select)"

    End If

End If


' --------------------------------------------

If Not Cells(RowValue, 71).value Like "C*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 Community (Please select)")

Else

Cells(RowValue, 1).value = "2 Community (Please select)"

    End If

End If



' --WHAT---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 17).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "5 Activity Group (Please select)")

Else

Cells(RowValue, 1).value = "5 Activity Group (Please select)"

    End If

End If




' ---------------------------------

If IsEmpty(Cells(RowValue, 18).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "5 Activity (Please select)")

Else

Cells(RowValue, 1).value = "5 Activity (Please select)"

    End If

End If


' --WHEN---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 19).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "3 Month (Please Select)")

Else

Cells(RowValue, 1).value = "3 Month (Please select)"

    End If

End If


' -- Status---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 20).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "4 Status  (Please Select)")

Else

Cells(RowValue, 1).value = "4 Status (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 22).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "4 Beneficiaries Type  (Please Select)")

Else

Cells(RowValue, 1).value = "4 Beneficiaries Type (Please select)"

    End If

End If



' -- WHOM---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If Cells(RowValue, 26).value <> Cells(RowValue, 23).value + Cells(RowValue, 24).value + Cells(RowValue, 25).value Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total Not equal the sum")

Else

Cells(RowValue, 1).value = "Auto Total Not equal the sum"

    End If

End If



' -- More Validation  ---------------------------------------------------------------------------------------------------------------------------

' ---Cu5 PIN------------------------------

If Cells(RowValue, 78).value Like "Cu5" Then
If Cells(RowValue, 26).value + Cells(RowValue, 27).value + Cells(RowValue, 28).value + Cells(RowValue, 29).value > Cells(RowValue, 79).value Then
If IsEmpty(Cells(RowValue, 21).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total are more than Children under 5 in need for this communities ,Please write justification in the comments .")

Else

Cells(RowValue, 1).value = "Auto Total are more than Children under 5 in need for this communities ,Please write justification in the comments ."

    End If
End If
End If
End If


' ---PLWs PIN------------------------------

If Cells(RowValue, 78).value Like "PLW" Then
If Cells(RowValue, 26).value + Cells(RowValue, 27).value + Cells(RowValue, 28).value + Cells(RowValue, 29).value > Cells(RowValue, 80).value Then
If IsEmpty(Cells(RowValue, 21).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total are more than PLW in need for this communities ,Please write justification in the comments .")

Else

Cells(RowValue, 1).value = "Auto Total are more than PLW in need for this communities ,Please write justification in the comments ."

    End If
End If
End If
End If



' Finding for CU5-------------------------------

If Cells(RowValue, 18).value Like "*of children 6-59 months screened for acute malnutrition*" And Cells(RowValue, 26).value > 50 And WorksheetFunction.Sum(Range("AF" & RowValue & ":Ak" & RowValue)) <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the finding for the screening or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the finding for the screening or write justification in the comments  ."
End If
End If
End If

' Finding for PLWs -------------------------------

If Cells(RowValue, 18).value Like "*PLWs screened for acute*" And Cells(RowValue, 26).value > 50 And Cells(RowValue, 44).value <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the finding for the screening of PLW or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the finding for the screening of PLW or write justification in the comments"
End If
End If
End If

' Performance indicators -------------------------------

If Cells(RowValue, 18).value Like "*treatment*" And Cells(RowValue, 26).value > 10 And WorksheetFunction.Sum(Range("AS" & RowValue & ":BB" & RowValue)) <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter Performance indicators (Recovered,Died,Defaulted or Non-recovered) or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter Performance indicators (Recovered,Died,Defaulted or Non-recovered) or write justification in the comments "
End If
End If
End If


' Name of HFs or Mobile treatment-------------------------------

If Cells(RowValue, 18).value Like "*treatment*" And (IsEmpty(Cells(RowValue, 15).value) And IsEmpty(Cells(RowValue, 16).value)) Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the health center name or Mobile number or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the health center name or Mobile number or write justification in the comments "
End If
End If
End If

If Cells(RowValue, 18).value Like "*awareness sessions conducted*" And IsEmpty(Cells(RowValue, 25).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter Number of IYCF awareness sessions conducted in Undefined ")

Else

Cells(RowValue, 1).value = "Please enter Number of IYCF awareness sessions conducted in Undefined "
End If
End If


' CASH-------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 56).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Conditionality  (Please Select) ")

Else

Cells(RowValue, 1).value = "Cash Conditionality  (Please Select) "
End If
End If

'---------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 57).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Restriction  (Please Select) ")

Else

Cells(RowValue, 1).value = "Cash Restriction (Please Select) "
End If
End If

' ----------------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 58).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Transfer/Voucher Value (USD)  (Please enert) ")

Else

Cells(RowValue, 1).value = "Cash Transfer/Voucher Value (USD) (Please enert) "
End If
End If



MyVariable = False


End Sub




Sub validateAllSupplyRows()
Dim row As Range
Dim r As Integer
r = 0
ActiveSheet.Unprotect ("abc")
MsgBox ("It's will take time to vildate ,Please wait,Thanks")
For Each row In [Tbl_NutritionSupply].Rows



 validateAllSupplyRow (row.row)
 
    
Next

MsgBox ("Validate Data finished please see in the left side,Thanks")
ActiveSheet.Protect Password:="abc"
End Sub

Public Sub validateAllSupplyRow(RowValue As Integer)
Dim value As Integer


If WorksheetFunction.Sum(Range("U" & RowValue & ":BT" & RowValue)) > 0 Then


MyVariable = True
Cells(RowValue, 1).value = ""
Select Case True
    Case IsEmpty(Cells(RowValue, 4).value)
         Cells(RowValue, 1).value = "1 Organisation "
    Case IsEmpty(Cells(RowValue, 6).value)
         Cells(RowValue, 1).value = "1 Donor "
         
    Case IsEmpty(Cells(RowValue, 7).value)
         Cells(RowValue, 1).value = "3 Month "
         
    Case IsEmpty(Cells(RowValue, 8).value)
         Cells(RowValue, 1).value = "5 Transaction type"
         
    Case IsEmpty(Cells(RowValue, 11).value)
         Cells(RowValue, 1).value = "2 Governorate "
         
    Case Cells(RowValue, 12).value = ""
         Cells(RowValue, 1).value = "2 District )"
         
    Case IsEmpty(Cells(RowValue, 13).value)
         Cells(RowValue, 1).value = "2 SubDistrict "
    
     Case Cells(RowValue, 76).value = ""
         Cells(RowValue, 1).value = "2 Community "
         
    Case IsEmpty(Cells(RowValue, 16).value)
         Cells(RowValue, 1).value = "2 Type of Nutrition Services "
         
            
    Case IsEmpty(Cells(RowValue, 17).value) And IsEmpty(Cells(RowValue, 18).value) And IsEmpty(Cells(RowValue, 19).value) And IsEmpty(Cells(RowValue, 20).value)
         Cells(RowValue, 1).value = "2 Enter HFs or Camp or mobile or Warehouse"
         
    
         
    

         
    Case Else
        Cells(RowValue, 1).value = ""
        
     
        
End Select




MyVariable = False
End If

End Sub
Attribute VB_Name = "Module2"
Sub MacCMHFsSort()
Attribute MacCMHFsSort.VB_ProcData.VB_Invoke_Func = " \n14"
'
' MacCMHFsSort Macro
'

'
    ActiveWorkbook.Worksheets("CMHFs").ListObjects("Tbl_CMHFs").Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets("CMHFs").ListObjects("Tbl_CMHFs").Sort.SortFields. _
        Add Key:=Range("Tbl_CMHFs[[#All],[ComPcode]]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("CMHFs").ListObjects("Tbl_CMHFs").Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub
Sub MacCMCampsSort()
Attribute MacCMCampsSort.VB_ProcData.VB_Invoke_Func = " \n14"
'
' MacCMCampsSort Macro
'

'
    ActiveWorkbook.Worksheets("CMCAMPs").ListObjects("Tbl_CMCamp").Sort.SortFields. _
        Clear
    ActiveWorkbook.Worksheets("CMCAMPs").ListObjects("Tbl_CMCamp").Sort.SortFields. _
        Add Key:=Range("Tbl_CMCamp[[#All],[ComPcode]]"), SortOn:=xlSortOnValues, _
        Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("CMCAMPs").ListObjects("Tbl_CMCamp").Sort
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

    Private Sub Worksheet_Change(ByVal Target As Range)
    
   On Error GoTo Err
If MyVariable = False Then

'show all Column without hiden any of them
If Target.Column = 3 And Target.row = 1 And Target.value Like "*Show All Columns*" Then
ActiveSheet.Unprotect ("abc")
        Application.Columns("U:BT").Select
        Application.Selection.EntireColumn.Hidden = False
        Target.Activate

ActiveSheet.Protect Password:="abc"

        ElseIf Target.Column = 3 And Target.row = 1 And Target.value Like "*Show Columns Based on a Cell Activity*" Then
    ActiveSheet.Unprotect ("abc")
        Application.Columns("U:BT").Select
        Application.Selection.EntireColumn.Hidden = True
        
       Call ShowOnlyYes
       
        
     ActiveSheet.Protect Password:="abc"
    
    End If
    
   
    'If Cells(Target.row, 20).value > 0 Then
    If WorksheetFunction.Sum(Range("U" & Target.row & ":BT" & Target.row)) > 0 Then
     ActiveSheet.Unprotect ("abc")
    validateRowData (Target.row)
    
     ActiveSheet.Protect Password:="abc"
    
    End If
    End If
    
Err:
    ' This is your 'Catch'
    
    End Sub

Sub ShowOnlyYes()

Dim i As Integer

For i = 21 To 72
     If Cells(4, i).value = "Yes" Then
        Application.Columns(i).Select
        Application.Selection.EntireColumn.Hidden = False
    End If
Next i


End Sub





Public Sub validateRowData(RowValue As Integer)
Dim value As Integer

MyVariable = True
Select Case True
    Case IsEmpty(Cells(RowValue, 4).value)
         Cells(RowValue, 1).value = "1 Organisation "
    Case IsEmpty(Cells(RowValue, 6).value)
         Cells(RowValue, 1).value = "1 Donor "
         
    Case IsEmpty(Cells(RowValue, 7).value)
         Cells(RowValue, 1).value = "3 Month "
         
    Case IsEmpty(Cells(RowValue, 8).value)
         Cells(RowValue, 1).value = "5 Transaction type"
         
    Case IsEmpty(Cells(RowValue, 11).value)
         Cells(RowValue, 1).value = "2 Governorate "
         
    Case Cells(RowValue, 12).value = ""
         Cells(RowValue, 1).value = "2 District )"
         
    Case IsEmpty(Cells(RowValue, 13).value)
         Cells(RowValue, 1).value = "2 SubDistrict "
    
     Case Cells(RowValue, 76).value = ""
         Cells(RowValue, 1).value = "2 Community "
         
    Case IsEmpty(Cells(RowValue, 16).value)
         Cells(RowValue, 1).value = "2 Type of Nutrition Services "
         
            
    Case IsEmpty(Cells(RowValue, 17).value) And IsEmpty(Cells(RowValue, 18).value) And IsEmpty(Cells(RowValue, 19).value) And IsEmpty(Cells(RowValue, 20).value)
         Cells(RowValue, 1).value = "2 Enter HFs or Camp or mobile or Warehouse"
         
    
         
    

         
    Case Else
        Cells(RowValue, 1).value = ""
        
     
        
End Select




MyVariable = False


End Sub



Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

    Private Sub Worksheet_Change(ByVal Target As Range)
    
   On Error GoTo Err
If MyVariable = False Then

'show all Column without hiden any of them
If Target.Column = 3 And Target.row = 1 And Target.value Like "*Show All Columns*" Then
        Application.Columns("AA:BI").Select
        Application.Selection.EntireColumn.Hidden = False
        Target.Activate
        ElseIf Target.Column = 3 And Target.row = 1 And Target.value Like "*Show Columns Based on a Cell Activity*" Then
         Application.Columns("AD:BI").Select
        Application.Selection.EntireColumn.Hidden = True
        
         
         ElseIf Target.Column = 18 And Range("C1").value Like "*Show Columns Based on a Cell Activity*" Then
        
         SelectCaseLikeActivites (Target.value)
         Target.Activate
    
    
    End If
    
   
    If (Cells(Target.row, 26).value > 0 Or (Cells(Target.row, 23).value + Cells(Target.row, 24).value + Cells(Target.row, 25).value) > 0) And (Range("F2").value <> "No") Then
    
    validateRowData (Target.row)
    
    End If
    End If
    
Err:
    ' This is your 'Catch'
    
    End Sub

Sub SelectCaseLikeCMAMActivites(NutActivitey As String)


End Sub
Sub SelectCaseLikeActivites(NutActivitey As String)

Application.Columns("AD:BI").Select
Application.Selection.EntireColumn.Hidden = True



Select Case True
    Case NutActivitey Like "*of children 6-59 months screened for acute malnutrition*"
         Application.Columns("AD:AO").Select
         Application.Selection.EntireColumn.Hidden = False
                
    Case NutActivitey Like "*PLWs screened for acute*"
        Application.Columns("AP:AR").Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*PLW reached with MAM treatment*"
        Application.Range("AT1,AV1,AX1,AZ1,BB1").EntireColumn.Select
        'Application.Union(Columns("AJ"), Columns("AL"), Columns("AN"), Columns("AP"), Columns("AS")).Select
        'Application.Range("a1,b1,d1,e1,g1,h1").EntireColumn.Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*SMART nutrition assessments conducted*"
        Application.Columns("BC").Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*IYCF awareness sessions conducted*"
        Application.Columns("AP:AQ").Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*Cash*"
        Application.Columns("BD:BI").Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*treatment*"
        Application.Columns("AS:BB").Select
        Application.Selection.EntireColumn.Hidden = False
        
    Case NutActivitey Like "*PLW*"
        Application.Columns("AP:AQ").Select
        Application.Selection.EntireColumn.Hidden = False
        
    
         
    Case Else
        Columns("AA:AY").EntireColumn.Hidden = True
        
End Select



End Sub
Public Sub validateRowData(RowValue As Integer)
Dim value As Integer

MyVariable = True

Cells(RowValue, 1).value = ""

If IsEmpty(Cells(RowValue, 2).value) Then
Cells(RowValue, 1).value = "1 -  Hub (Please select)"
End If

' ---------------------------------

If IsEmpty(Cells(RowValue, 3).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation Type (Funding source) (Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation Type (Funding source) (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 4).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation Type (Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation Type (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 5).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Organisation(Please select)")

Else

Cells(RowValue, 1).value = "1 Organisation (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 7).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Donor(Please Enter)")

Else

Cells(RowValue, 1).value = "1 Donor (Please Enter)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 8).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "1 Choose Yes if it's an HRP project, and No if it's a non-HRP projec")

Else

Cells(RowValue, 1).value = "1 Choose Yes if it's an HRP project, and No if it's a non-HRP project"

    End If

End If


' --WHERE---------------------------------------------------------------------------------------------------------------------------

If Not Cells(RowValue, 68).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 Governorate (Please select)")

Else

Cells(RowValue, 1).value = "2 Governorate (Please select)"

    End If

End If

' --------------------------------------------

If Not Cells(RowValue, 69).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 District (Please select)")

Else

Cells(RowValue, 1).value = "2 District (Please select)"

    End If

End If


' --------------------------------------------

If Not Cells(RowValue, 70).value Like "*SY*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 SubDistrict (Please select)")

Else

Cells(RowValue, 1).value = "2 SubDistrict (Please select)"

    End If

End If


' --------------------------------------------

If Not Cells(RowValue, 71).value Like "C*" Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "2 Community (Please select)")

Else

Cells(RowValue, 1).value = "2 Community (Please select)"

    End If

End If



' --WHAT---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 17).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "5 Activity Group (Please select)")

Else

Cells(RowValue, 1).value = "5 Activity Group (Please select)"

    End If

End If




' ---------------------------------

If IsEmpty(Cells(RowValue, 18).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "5 Activity (Please select)")

Else

Cells(RowValue, 1).value = "5 Activity (Please select)"

    End If

End If


' --WHEN---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 19).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "3 Month (Please Select)")

Else

Cells(RowValue, 1).value = "3 Month (Please select)"

    End If

End If


' -- Status---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If IsEmpty(Cells(RowValue, 20).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "4 Status  (Please Select)")

Else

Cells(RowValue, 1).value = "4 Status (Please select)"

    End If

End If


' ---------------------------------

If IsEmpty(Cells(RowValue, 22).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "4 Beneficiaries Type  (Please Select)")

Else

Cells(RowValue, 1).value = "4 Beneficiaries Type (Please select)"

    End If

End If



' -- WHOM---------------------------------------------------------------------------------------------------------------------------

' ---------------------------------

If Cells(RowValue, 26).value <> Cells(RowValue, 23).value + Cells(RowValue, 24).value + Cells(RowValue, 25).value Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total Not equal the sum")

Else

Cells(RowValue, 1).value = "Auto Total Not equal the sum"

    End If

End If



' -- More Validation  ---------------------------------------------------------------------------------------------------------------------------

' ---Cu5 PIN------------------------------

If Cells(RowValue, 78).value Like "Cu5" Then
If Cells(RowValue, 26).value + Cells(RowValue, 27).value + Cells(RowValue, 28).value + Cells(RowValue, 29).value > Cells(RowValue, 79).value Then
If IsEmpty(Cells(RowValue, 21).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total are more than Children under 5 in need for this communities ,Please write justification in the comments .")

Else

Cells(RowValue, 1).value = "Auto Total are more than Children under 5 in need for this communities ,Please write justification in the comments ."

    End If
End If
End If
End If


' ---PLWs PIN------------------------------

If Cells(RowValue, 78).value Like "PLW" Then
If Cells(RowValue, 26).value + Cells(RowValue, 27).value + Cells(RowValue, 28).value + Cells(RowValue, 29).value > Cells(RowValue, 80).value Then
If IsEmpty(Cells(RowValue, 21).value) Then

    If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Auto Total are more than PLW in need for this communities ,Please write justification in the comments .")

Else

Cells(RowValue, 1).value = "Auto Total are more than PLW in need for this communities ,Please write justification in the comments ."

    End If
End If
End If
End If



' Finding for CU5-------------------------------

If Cells(RowValue, 18).value Like "*of children 6-59 months screened for acute malnutrition*" And Cells(RowValue, 26).value > 50 And WorksheetFunction.Sum(Range("AF" & RowValue & ":Ak" & RowValue)) <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the finding for the screening or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the finding for the screening or write justification in the comments  ."
End If
End If
End If

' Finding for PLWs -------------------------------

If Cells(RowValue, 18).value Like "*PLWs screened for acute*" And Cells(RowValue, 26).value > 50 And Cells(RowValue, 44).value <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the finding for the screening of PLW or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the finding for the screening of PLW or write justification in the comments"
End If
End If
End If

' Performance indicators -------------------------------

If Cells(RowValue, 18).value Like "*treatment*" And Cells(RowValue, 26).value > 5 And WorksheetFunction.Sum(Range("AS" & RowValue & ":BB" & RowValue)) <= 0 Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter Performance indicators (Recovered,Died,Defaulted or Non-recovered) or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter Performance indicators (Recovered,Died,Defaulted or Non-recovered) or write justification in the comments "
End If
End If
End If


' Name of HFs or Mobile treatment-------------------------------

If Cells(RowValue, 18).value Like "*treatment*" And (IsEmpty(Cells(RowValue, 15).value) And IsEmpty(Cells(RowValue, 16).value)) Then
If IsEmpty(Cells(RowValue, 21).value) Then
 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter the health center name or Mobile number or write justification in the comments ")

Else

Cells(RowValue, 1).value = "Please enter the health center name or Mobile number or write justification in the comments "
End If
End If
End If



If Cells(RowValue, 18).value Like "*awareness sessions conducted*" And IsEmpty(Cells(RowValue, 25).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Please enter Number of IYCF awareness sessions conducted in Undefined ")

Else

Cells(RowValue, 1).value = "Please enter Number of IYCF awareness sessions conducted in Undefined "
End If
End If

' CASH-------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 56).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Conditionality  (Please Select) ")

Else

Cells(RowValue, 1).value = "Cash Conditionality  (Please Select) "
End If
End If

'---------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 57).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Restriction  (Please Select) ")

Else

Cells(RowValue, 1).value = "Cash Restriction (Please Select) "
End If
End If

' ----------------------------------------

If Cells(RowValue, 18).value Like "*Cash*" And IsEmpty(Cells(RowValue, 58).value) Then

 If Cells(RowValue, 1).value <> "" Then

Cells(RowValue, 1).value = rowMsg(Cells(RowValue, 1).value, "Cash Transfer/Voucher Value (USD)  (Please enert) ")

Else

Cells(RowValue, 1).value = "Cash Transfer/Voucher Value (USD) (Please enert) "
End If
End If



MyVariable = False


End Sub


Function rowMsg(msg As String, newMsg As String) As String

If msg <> "" Then

rowMsg = msg & Chr(10) & newMsg
End If

End Function


Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
