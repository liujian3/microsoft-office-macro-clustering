Attribute VB_Name = "Module01_Admin"
Sub AC_1()

Application.ScreenUpdating = False

    ActiveSheet.Unprotect Password:="merservs"

End Sub

Sub AC_2()

Application.ScreenUpdating = False
    
    ActiveSheet.Protect Password:="merservs", UserInterfaceOnly:=True, AllowFormattingRows:=True 'DrawingObjects:=True, Contents:=True, Scenarios:=True,
    ActiveSheet.EnableOutlining = True
    
    
    
End Sub


Sub Top_Of_Page()
            
    
    'ActiveWindow.SmallScroll Up:=40
    ActiveWindow.ScrollRow = 1
    ActiveWindow.SmallScroll toleft:=3
    

End Sub

Sub Mid_Of_Page()
            
    
    ActiveWindow.SmallScroll Up:=10
    ActiveWindow.SmallScroll toleft:=3
   

End Sub

Sub Buttons()
    Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = True
    Sheets("VRF").Shapes("Email_PDF_Vendor").Visible = True
End Sub

Sub Reset_PB()
     ActiveSheet.ResetAllPageBreaks
End Sub
Attribute VB_Name = "Module02_Reset"
Sub ClearUnlockedCellsVRF()
'Resetting and clearing form for next time
Dim WorkRange As Range
Dim Cell As Range


Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Sheets("VRF").Select
Set WorkRange = ActiveSheet.UsedRange

    
    For Each Cell In WorkRange
        If Cell.Locked = False Then Cell.Value = ""
    Next Cell
    
    'ActiveSheet.Shapes("YesButton").Fill.BackColor.RGB = RGB(255, 255, 0) 'Yellow
    'ActiveSheet.Shapes("NoButton").BackColor = RGB(255, 255, 0)   'Yellow
    
    'Call Reset_ButtonColour
    
    ActiveSheet.Unprotect Password:="merservs"
    Rows("27:33").Select
    Selection.EntireRow.Hidden = False 'Open all Agent rows
    Rows("44:44").Select
    Selection.EntireRow.Hidden = False 'Close Small Business row
    Rows("52:61").Select
    Selection.EntireRow.Hidden = False 'Open all Additional Address rows
    Rows("71:90").Select
    Selection.EntireRow.Hidden = False 'Open all Delivery Term rows
    Rows("81:89").Select
    Selection.EntireRow.Hidden = True 'Hide Additional Ports of Shipments in Delivery Term rows
    Rows("98:105").Select
    Selection.EntireRow.Hidden = False 'Open all Local Bank row
    Rows("106:113").Select
    Selection.EntireRow.Hidden = False 'Open all OS Bank rows
    Rows("141:142").Select
    Selection.EntireRow.Hidden = False 'Open all Supply Chain rows
    Rows("143:144").Select
    Selection.EntireRow.Hidden = False 'Open all KAS Finance rows
    Rows("149:149").Select
    Selection.EntireRow.Hidden = False 'Open Legal row
    
    Sheets("(7) Agent").Visible = True
    Sheets("CTA").Visible = True
    
    Sheets("VRF").Pictures("KmartLogo").Visible = True
    Sheets("VRF").Pictures("TAPL_Logo").Visible = False
    
    [DateVRF].Formula = "=Today()" 'Current date
    Range("MERC,NOME,PUMR,OMER,OSEA,PEPS,AUS,NZ,OS,KTAS,Agt_Flag,CTA_Flag").Value = False
    [Agt_LU].Formula = "=IF(Vend_Type=""OS"",VLOOKUP(Action_Req,OS_Agt_LU,2,0),IF(Vend_Type=""Local"",VLOOKUP(Action_Req,Local_CTA_LU,2,0),""""))"
    [CTA_AGT].Formula = "=IF(Vend_Type=""OS"",""Open Agent Form"","""")"
    
    [Action_Req].Value = "Select Action required"
    Sheets("VRF").Shapes("Agt_CB").Visible = False
    Sheets("VRF").Shapes("CTA_CB").Visible = False
    
    [Agent_Kmart] = "Select Agent number/Enter Agent Name"
    [OrdviaAgent] = "Yes/No"
    'Range("Yes_Button,No_Button") = False
    [Bus_Type] = "Select Business Type or Enter Details"
    [Inv_Attached].Value = "Yes/No"
    [Rtn_Goods_Add].Value = False
    [Local_Perc].Formula = "=IF(Vend_Type=""OS"","""",IF(CTA_Flag=TRUE,IF(Cons_CTA=TRUE,ConPayTerm,SettDisc),""""))"
    [Ord_Currency].Value = "Select Currency"
    [Est_Ann_Spend].Value = ""
    
    Sheets("VRF").Shapes("CB_RTNGOODS").Visible = True
    Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = False
    Sheets("VRF").Shapes("Email_PDF_Vendor").Visible = False
    
    
    
    [CTA_Form].Formula = "=IF(Vend_Type=""OS"","""", IF(Vend_Type=""Local"", ""Open CTA Form"",""""))"
    [Loc_Term_Typ].Formula = "=IF(OR(Vend_Type=""OS"",Vend_Type=""Exp""),"""",IF(CTA_Flag=FALSE,""Select Local Terms Type"",IF(Cons_CTA=TRUE,""Consolidated Terms"",IF(Non_Cons_CTA=TRUE,""Settlement Discount"",""Select Local Terms Type""))))"
    [Pay_Meth].Value = "Select Payment method" 'Reset Payment method
    [PT_Definition].Formula = "=PT_MthlyWkly"
       
    [Delv_Term_Descp_Local].Value = "Select Delivery Terms" 'Reset Delivery Terms
    [Delv_Term_Code].Formula = "=IF(ISNA(VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0)),"""",((VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0))))"
    
    [MinOrdQtyOpt].Formula = "=IF(CTA_Flag=FALSE,"""",MinOrdQty)"
    [MinOrdValOpt].Formula = "=IF(CTA_Flag=FALSE,"""",MinOrdDollar)"
    
    Range("X_Dock,B2B_Cap").Value = "Yes/No"
    
    Range("DT_Desc_1,DT_Desc_2,DT_Desc_3,DT_Desc_4,DT_Desc_5,DT_Desc_6").Value = "Select Delivery Terms" 'Reset Delivery Terms
    Range("DT_Country_1,DT_Country_2,DT_Country_3,DT_Country_4,DT_Country_5,DT_Country_6,DT_SP_1,DT_SP_2,DT_SP_3,DT_SP_4,DT_SP_5,DT_SP_6").Value = ""
    
    [DT_SRC_1].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_1,INDIRECT(DT_LUPC_1),2,FALSE)),"""",VLOOKUP(DT_SP_1,INDIRECT(DT_LUPC_1),2,FALSE))"
    [DT_SRC_2].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_2,INDIRECT(DT_LUPC_2),2,FALSE)),"""",VLOOKUP(DT_SP_2,INDIRECT(DT_LUPC_2),2,FALSE))"
    [DT_SRC_3].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_3,INDIRECT(DT_LUPC_3),2,FALSE)),"""",VLOOKUP(DT_SP_3,INDIRECT(DT_LUPC_3),2,FALSE))"
    [DT_SRC_4].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_4,INDIRECT(DT_LUPC_4),2,FALSE)),"""",VLOOKUP(DT_SP_4,INDIRECT(DT_LUPC_4),2,FALSE))"
    [DT_SRC_5].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_5,INDIRECT(DT_LUPC_5),2,FALSE)),"""",VLOOKUP(DT_SP_5,INDIRECT(DT_LUPC_5),2,FALSE))"
    [DT_SRC_6].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_6,INDIRECT(DT_LUPC_6),2,FALSE)),"""",VLOOKUP(DT_SP_6,INDIRECT(DT_LUPC_6),2,FALSE))"
    
    [DT_DTC_1].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_1,INDIRECT(DT_LUPC_1),3,FALSE)),"""",VLOOKUP(DT_SP_1,INDIRECT(DT_LUPC_1),3,FALSE))"
    [DT_DTC_2].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_2,INDIRECT(DT_LUPC_2),3,FALSE)),"""",VLOOKUP(DT_SP_2,INDIRECT(DT_LUPC_2),3,FALSE))"
    [DT_DTC_3].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_3,INDIRECT(DT_LUPC_3),3,FALSE)),"""",VLOOKUP(DT_SP_3,INDIRECT(DT_LUPC_3),3,FALSE))"
    [DT_DTC_4].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_4,INDIRECT(DT_LUPC_4),3,FALSE)),"""",VLOOKUP(DT_SP_4,INDIRECT(DT_LUPC_4),3,FALSE))"
    [DT_DTC_5].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_5,INDIRECT(DT_LUPC_5),3,FALSE)),"""",VLOOKUP(DT_SP_5,INDIRECT(DT_LUPC_5),3,FALSE))"
    [DT_DTC_6].Formula = "=IF(ISERROR(VLOOKUP(DT_SP_6,INDIRECT(DT_LUPC_6),3,FALSE)),"""",VLOOKUP(DT_SP_6,INDIRECT(DT_LUPC_6),3,FALSE))"
    
    [DT_DM_1].Formula = "=IF(DT_Desc_1<>""Select Delivery Terms"",""DALLL"","""")"
    [DT_DM_2].Formula = "=IF(DT_Desc_2<>""Select Delivery Terms"",""DALLL"","""")"
    [DT_DM_3].Formula = "=IF(DT_Desc_3<>""Select Delivery Terms"",""DALLL"","""")"
    [DT_DM_4].Formula = "=IF(DT_Desc_4<>""Select Delivery Terms"",""DALLL"","""")"
    [DT_DM_5].Formula = "=IF(DT_Desc_5<>""Select Delivery Terms"",""DALLL"","""")"
    [DT_DM_6].Formula = "=IF(DT_Desc_6<>""Select Delivery Terms"",""DALLL"","""")"
    
    [Bank_YN].Value = "Yes/No"
        
    [VA_1].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D70,IF(KTAS=TRUE,Lists!C70,Lists!B70))"
    [VA_2].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D71,IF(KTAS=TRUE,Lists!C71,IF(Agt_Type<>""Select Agent type"",Vend_Ackn_Agent,Vend_Ackn_Non_Agent)))"
    [VA_3].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D72,IF(KTAS=TRUE,Lists!C72,Lists!B72))"
    [VA_4].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D73,IF(KTAS=TRUE,Lists!C73,Lists!B73))"
    [VA_5].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D74,IF(KTAS=TRUE,Lists!C74,Lists!B74))"
    
    [VAB_1].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D76,IF(KTAS=TRUE,Lists!C76,Lists!B76))"
    [VAB_2].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D77,IF(KTAS=TRUE,Lists!C77,Lists!B77))"
    [VAB_3].Formula = "=IF(OR(PEPS=TRUE,PUMR=TRUE),Lists!D78,IF(KTAS=TRUE,Lists!C78,Lists!B78))"
    
    [Supp_Acceptance].Formula = "=IF(Agt_Type<>""Select Agent type"",""Vendor acceptance of 5 (a) & 5 (b) & 7(b)"",""Vendor acceptance of 5 (a) & 5 (b)"")"
    
    [Auth_CB].Formula = "=IF(Completed_By="""","""",Completed_By)"
    
    Call ClearUnlockedCellsCTA
    Sheets("CTA").Visible = False
    Call ClearUnlockedCellsAgent
    Sheets("(7) Agent").Visible = False
    Sheets("EmailMsg").Visible = False
    
    Sheets("VRF").Select
    ActiveSheet.Protect Password:="merservs"
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    
    [Completed_By].Select
    Sheets("Contents").Visible = True
    Sheets("VRF").Visible = False
    
    
    
End Sub


Sub Open_CTA_Renewal()
'Open CTA form and hide VRF
'
    Application.ScreenUpdating = False
    Sheets("CTA").Visible = True
    Sheets("VRF").Visible = False
    Sheets("CTA").Select
    Sheets("CTA").Shapes("Email_CTA_Vendor").Visible = True
    Sheets("Contents").Visible = False
    [CTA_Renewal] = "Renew"

    
End Sub


Sub Open_VRF()
'Open VRF form and hide CTA
'
    Application.ScreenUpdating = False
    Sheets("VRF").Visible = True
    [CTA_Renewal] = ""
    Sheets("CTA").Visible = False
    Sheets("Contents").Visible = False
    
    Sheets("VRF").Select
    

    
End Sub
Sub Open_Expense_Vendors()
'Open VRF form and hide CTA
'
    Application.ScreenUpdating = False
    Sheets("VRF").Visible = True
    [CTA_Renewal] = ""
    Sheets("CTA").Visible = False
    Sheets("Contents").Visible = False
    [Action_Req] = "Add New Vendor"
    '[NOME] = True
    
    Call NOME_Vndr
    
    Sheets("VRF").Select
    [Completed_By].Select
    
End Sub
Sub Open_KTAS()
'Open VRF form and hide CTA
'
    Application.ScreenUpdating = False
    Sheets("VRF").Visible = True
    [CTA_Renewal] = ""
    Sheets("CTA").Visible = False
    Sheets("Contents").Visible = False
    [NOME] = True
    [KTAS] = True
    Call NOME_Vndr
    
    Sheets("VRF").Select
    [Completed_By].Select
    
End Sub

Sub ClearUnlockedCellsCTA()
'Resetting and clearing form for next time
Dim WorkRange As Range
Dim Cell As Range

Application.Calculation = xlCalculationManual
Application.ScreenUpdating = False

Sheets("CTA").Select
Set WorkRange = ActiveSheet.UsedRange

    
    For Each Cell In WorkRange
        If Cell.Locked = False Then Cell.Value = ""
    Next Cell
        
    ActiveSheet.Unprotect Password:="merservs"
       
    [CTA_Aus].Formula = "=IF(AUS=TRUE,TRUE,FALSE)"
    [CTA_NZ].Formula = "=IF(NZ=TRUE,TRUE,FALSE)"
    [Vend_Name].Formula = "=IF(Company_Name="""","""",Company_Name)"
    [ABN].Formula = "=IF(ABNVRF="""","""",ABNVRF)"
    [CTA_CONTACT].Formula = "=IF(VRF_Contact="""","""",VRF_Contact)"
    [State_Country] = "Select Option"
    [ReviewDate].Formula = "=IF(Start_Date="""","""",DATE(YEAR(Start_Date)+1,MONTH(Start_Date),DAY(Start_Date)-1))"
    [LeadDept].Formula = "=IF(Dept="""","""",Dept)"
    [CTA_Delv_Term].Formula = "=IF(Delv_Term_Descp_Local=""Select Delivery Terms"",""Select Delivery Terms"",Delv_Term_Descp_Local)"
    [Delv_Code].Formula = "=IF(ISNA(VLOOKUP(CTA_Delv_Term,Loc_Delv_Terms_Code,2,0)),"""",((VLOOKUP(CTA_Delv_Term,Loc_Delv_Terms_Code,2,0))))"
    [ConPayTerm].Formula = "=IF(ISERROR(Cons_SD+Cons_BVR+Cons_BDR+Cons_SCR),(Cons_BVR+Cons_BDR+Cons_SCR),(Cons_SD+Cons_BVR+Cons_BDR+Cons_SCR))"
    [SettDisc].Formula = "=IF(Loc_Term_Typ=""Settlement Discount - Enter %"",Local_Perc,""Select or Enter agreed %"")"
    '[Pay_Cycle].Formula = "=IF(Pay_Term="""",""Select Payment Cycle"",Pay_Term)"
    Range("Pay_Cycle,Pay_Cycle_Non").Formula = "=IF(Pay_Term="""",VLOOKUP(SettDisc,CTA_Pref_SettDisc,2,0),Pay_Term)"
    '[Cons_Payt_Total].Formula = "=IF(ISERROR(Cons_SD+Cons_BVR+Cons_BDR+Cons_SCR),(Cons_BVR+Cons_BDR+Cons_SCR),(Cons_SD+Cons_BVR+Cons_BDR+Cons_SCR))"
    Range("Purch_Base_Flat,BVR_Flat,BVD_Flat,SCR_Flat,Tier1").Value = "Select Option"
    Range("Tier2,Tier3,Tier4").Value = "If annual purchases between"
    [Tier5].Value = "If annual purchases are between and exceeding"
    [Dollar2].Formula = "=IF(ISNUMBER(SEARCH(""exceeding"",Tier2)),Dollar1,"""")"
    [Dollar3].Formula = "=IF(ISNUMBER(SEARCH(""exceeding"",Tier3)),Dollar2,"""")"
    [Dollar4].Formula = "=IF(ISNUMBER(SEARCH(""exceeding"",Tier4)),Dollar3,"""")"
    [Dollar5].Formula = "=IF(ISNUMBER(SEARCH(""exceeding"",Tier5)),Dollar4,"""")"
    [InitialID].Value = ""
    [AddID].Formula = "=IF(InitialID=""Access Not Required"",""Access Not Required"","""")"
    [NumAddID].Formula = "=IF(OR(InitialID=""Access Not Required"",AddID=""Access Not Required""),""N/A"",IF(AddID=35,1,""""))"
    [TotalAddID].Formula = "=IF(ISERROR(AddID*NumAddID),"""",(AddID*NumAddID))"
    Range("MinOrdDollar,MinOrdQty,NLRTerm").Value = "Select Option"
    [NLRFrequency].Formula = "=IF(NLRTerm=""Not Applicable"",""Not Applicable"",""Select Option"")"
    [NSOD].Value = 10
    ActiveSheet.Outline.ShowLevels RowLevels:=1 ' to collapse the rows
    'ActiveSheet.Outline.ShowLevels RowLevels:=2 ' to expand the rows
    [SuppAcceptName].Formula = "=IF(Vend_Name="""","""",Vend_Name)"
    [BuyerDept].Formula = "=IF(LeadDept="""","""",LeadDept)"
    Sheets("CTA").Shapes("Email_CTA_Vendor").Visible = True
    
    On Error Resume Next
    For Each ws In Application.ActiveWorkbook.Worksheets
        ws.PageSetup.CenterFooter = [Company_Name].Value
    Next
        
    ActiveSheet.Protect Password:="merservs"
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    [B4].Select
    [Cons_CTA] = True
    Call Consolidated_CTA
    
    
End Sub


Sub ClearUnlockedCellsAgent()

'Resetting and clearing form for next time
Dim WorkRange As Range
Dim Cell As Range

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    
    Sheets("(7) Agent").Select
    Set WorkRange = ActiveSheet.UsedRange
    
    For Each Cell In WorkRange
        If Cell.Locked = False Then Cell.Value = ""
    Next Cell
        
    ActiveSheet.Unprotect Password:="merservs"
    
    [Agt_Type].Value = "Select Agent type"
    Range("Agt_Inv_Attach,Agt_Vend_Auth,Agt_Auth,Agt_Bank").Value = "Yes/No"
    
    ActiveSheet.Protect Password:="merservs"
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    [Agent_CompName].Select
      
       
End Sub

'Sub Reset_ButtonColour()
    
    'With ActiveSheet.YesButton
        '.BackColor = RGB(255, 255, 0)   'Yellow
        ''.BackColor.RGB = RGB(255, 255, 255)   'White
    'End With
        
   ' With ActiveSheet.NoButton
        '.BackColor = RGB(255, 255, 0)   'Yellow
        ''.BackColor.RGB = RGB(255, 255, 255)   'White
    'End With
    
'End Sub


Attribute VB_Name = "Module03_Action"
Sub VRF_Action()
'
' Vendor Registration Form
' Macro recorded 08/01/2016 by mprice
'
'

'Dim FormDate As Date
'Dim FileDate As String

    
    'Reminder to enter Contact details
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False

    'FormDate = [Date].Value
    'FileDate = [Date].Text
    '[DateVRF].Value = FormDate

    If [Completed_By] = "" Or [Dept] = "" Then                       'To check if Completed by details are entered
        Range("MERC,NOME,OMER,OSEA,PUMR,PEPS") = False  'Reset Checkbox MERCH  OMER 'NOME OSEA PUMR PEPS
        Range("AUS,NZ,OS,KTAS") = False                 'Reset Checkbox Aus, NZ, OS, KTAS
        MsgBox "Please enter your Name, Dept# and contact details."
        
        If [Dept] = "" Then
            [Dept].Select
        End If
        If [Completed_By] = "" Then
            [Completed_By].Select
        End If
        
    Else
        ' No Vendor Type Selected
        If [Sum_Vend_Type] > 1 Or [Sum_Vend_Type].Value = 0 Then                         'Checkbox tick>1 more than 1 type of vendor selected only one can be selected
            MsgBox "Please only select one A. Type of Vendor."
        
            'Clear all flags
            Range("MERC,NOME,OMER,OSEA,PUMR,PEPS") = False  'Reset Checkbox MERCH NOME OMER OSEA PUMR PEPS
            Range("AUS,NZ,OS,KTAS") = False                 'Reset Checkbox Aus, NZ, OS, KTAS
            Range("Yes_Button,No_Button") = False           'Reset Small Business buttons
            [Action_Req] = "Select Action required"
            [B2B_Cap] = "Yes/No"
            [X_Dock] = "Yes/No"
            [Pay_Term] = ""                                 'Clear Payment terms and reset checks for all vendor types to blank for their re-selection
            [Delv_Term_Descp_Local] = "Select Delivery Terms" 'Reset Delivery Terms
            [Pay_Meth] = "Select Payment method"            'Reset Payment method
            [G12].Select
        
        End If
        Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = True
        'MERC                                           'Local Vendor Merch
        If [MERC] = True Then
            Application.ScreenUpdating = False
            Call Unhide_OS_Rows
            Call Hide_OSMerch_Rows
            If [AUS] = True Then                  'Unfair check/Small business for Aus only and less than 20 employees or $10mill
                Call Unfair_Contracts_Check
            Else
                Call Close_Unfair_Contracts_Check
            End If
            'Call Close_Unfair_Contracts_Check 'Call Unfair_Contracts_Check      'Remove unfair contracts requirement for local MERC (AP Oct 2017)' Added back for Small business 30day credit (AP July 2019)
            Call Hide_LocBank_Rows            'Call UnHide_LocBank_Rows         'Hide bank details requirement
            
            
            Sheets("(7) Agent").Visible = False
            Sheets("VRF").Shapes("Agt_CB").Visible = False
            Sheets("VRF").Shapes("CB_RTNGOODS").Visible = True
            Sheets("CTA").Shapes("Email_CTA_Vendor").Visible = False
            Sheets("CTA").Visible = False
            Sheets("VRF").Shapes("CTA_CB").Visible = True
            Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = True
            
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(78)
            Sheets("VRF").HPageBreaks.Add Before:=Rows(135)
                        
            [Ord_Email_Add] = ""
            [Pay_Term].Value = "3 Monthly (MF) Merch Splr - End of 3rd mth" 'Default Payment terms for MERC
            [Pay_Meth].Value = "T/Trf or Direct Credit"                     'Default Payment method T/T for MERC
            ActiveSheet.Unprotect Password:="merservs"
            [PT_Definition].Formula = "=PT_MthlyWkly"
            ActiveSheet.Protect Password:="merservs"
            [Local_Perc].Formula = "=IF(CTA_Flag=TRUE,IF(Cons_CTA=TRUE,ConPayTerm,SettDisc),"""")"
            ActiveSheet.Unprotect Password:="merservs"
            [Ord_Qty_Min].Formula = "=CTA_Ord_Qty_Min"
            [MinOrdQtyOpt].Formula = "=IF(CTA_Flag=FALSE,"""",MinOrdQty)"
            [Ord_Val_Min].Formula = "=CTA_Ord_Val_Min"
            [MinOrdValOpt].Formula = "=IF(CTA_Flag=FALSE,"""",MinOrdDollar)"
            ActiveSheet.Protect Password:="merservs"
            
            If [Sum_Brand_Local].Value > 1 Or ([OS] Or [KTAS] = True) Then 'if both Aus & NZ selected in Local - Only one can be selected
                MsgBox "Please select one, either Australia or New Zealand B. Brand/Purchase Organisation for this Vendor type."
                Range("AUS,NZ,OS,KTAS") = False         'Reset Checkbox Aus, NZ, OS, KTAS
                [G12].Select
            End If
            
            If [Sum_Brand_Local].Value = 1 Then
                If [AUS] = True Then                    'Auto select Currency & Delivery Term for local Aus Vendor
                    [Ord_Currency] = "AUD"
                    [Delv_Term_Descp_Local] = "Dlvd Regional XDO DC"
                    [Delv_Meth_Local].Formula = "=IF(Delv_Term_Code=""A"",""DALLL"",IF(VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,3,0)=0,"""",VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,3,0)))"
                End If
                If [NZ] = True Then                     'Auto select Currency & Delivery Term for local NZ Vendor
                    [Ord_Currency] = "NZD"
                    [Delv_Term_Descp_Local] = "Dlvd AUK XDO DC"
                    [Delv_Meth_Local].Formula = "=IF(Delv_Term_Code=""A"",""DNEWZ"",IF(VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,3,0)=0,"""",VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,3,0)))"
                End If
                [Action_Req].Select
            Else
                [G15].Select
            End If
            
            'Update Logo
            Call Logo
            
            'Remove Overseas Supplier Only inadvertently entered if any
            Call Clear_OS_Details

            
            
        'NOME
        ElseIf [NOME] = True Then                 'Local Vendor Non-merch
            
            Call NOME_Vndr
            
        
        'OSEA
        ElseIf [OSEA] = True Then                       'Overseas Vendor Non-merch
            
            Call Hide_OS_Rows
            Call Open_Delivery_Terms_Rows               'Allow for GNFR Vendor registration needs Delivery terms
            Call Unhide_OSBank_Rows
            Call Hide_LocMerch_Rows
            '[CTA_Renewal_But].Visible = False
            
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(90)
            
            Sheets("CTA").Visible = False
            [OS] = True               'Tick Z100 OS flag automatically
            Range("Ord_Email_Add,Pay_Term") = ""    'Clear payment terms for manual input
            [Pay_Term] = "Non Merch U000 - 30 days from date of Invoice"    'Update Payment terms to default for OSEA
            [Pay_Meth].Value = "T/Trf or Direct Credit" 'Default Payment method T/T for OSEA
            ActiveSheet.Unprotect Password:="merservs"
            [PT_Definition].Formula = "=PT_Wkly"
            ActiveSheet.Protect Password:="merservs"
            [Ord_Currency].Value = "USD"
            
            If [Sum_Brand_OS].Value > 0 Then
                [KTAS] = False
                [Action_Req].Select
            End If
            
            If [Sum_Brand_OS].Value = 1 And [OS] = True Then
                MsgBox "Please select Australia and/or New Zealand in B. Brand/Purchase Organisation."
                [G15].Select
            End If
                        
            'Update Logo
            Call Logo
            
            
        'OMER
        ElseIf [OMER] = True Then                       'Overseas Vendor Merch
            
            Call Unhide_OS_Rows
            Call Hide_LocMerch_Rows
            '[CTA_Renewal_But].Visible = False
            Sheets("(7) Agent").Visible = False
            Sheets("VRF").Shapes("Agt_CB").Visible = True
            Sheets("CTA").Visible = False
            Sheets("VRF").Shapes("CTA_CB").Visible = False
            
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(78)
            Sheets("VRF").HPageBreaks.Add Before:=Rows(135)
            
            Range("AUS,NZ,OS") = True       'Tick Z100 OS flag automatically
            Range("Ord_Email_Add,Ord_Qty_Min,Ord_Val_Min,Delv_Meth_Local,BSB").Value = ""
            [Pay_Term].Value = "90 Days from dlvy to Frt Fwdr" 'Default Payment terms 90 Days for OMER
            [Pay_Meth].Value = "T/Trf or Direct Credit" 'Default Payment method T/T for OMER
            ActiveSheet.Unprotect Password:="merservs"
            [PT_Definition].Formula = "=PT_Wkly"
            ActiveSheet.Protect Password:="merservs"
            [Ord_Currency].Value = "USD"
            Range("X_Dock,B2B_Cap") = "Yes/No"
            [Delv_Term_Descp_Local].Value = "Select Delivery Terms"
            [Delv_Term_Code].Formula = "=IF(ISNA(VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0)),"""",((VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0))))"
            
            If [Sum_Brand_OS].Value > 1 Then
                [KTAS] = False
                [Action_Req].Select
            End If
            
            'Update Logo
            Call Logo
            
            [Action_Req].Select
            
        'PUMR
        ElseIf [PUMR] = True Then
            
            Call Hide_OS_Rows
            Call Hide_LocBank_Rows            'Call UnHide_LocBank_Rows
            If [AUS] = True Then                  'Unfair check/Small Business for Aus only and less than 20 employees or $10mill
                Call Unfair_Contracts_Check
            Else
                Call Close_Unfair_Contracts_Check
            End If
            'Call Close_Unfair_Contracts_Check 'Removed to allow for Small business 30day credit (AP July 2019)
            '[CTA_Renewal_But].Visible = False
            
            Sheets("(7) Agent").Visible = False
            Sheets("VRF").Shapes("Agt_CB").Visible = False
            Sheets("CTA").Visible = False
            Sheets("VRF").Shapes("CTA_CB").Visible = False
            
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(90)
            
            [Ord_Email_Add] = "Enter if Required"
            [Pay_Term] = "Non Merch 7000 - 7 days from date of Invoice"
            [Pay_Meth] = "T/Trf or Direct Credit"
            ActiveSheet.Unprotect Password:="merservs"
            [PT_Definition].Formula = "=PT_Wkly"
            ActiveSheet.Protect Password:="merservs"
            [Loc_Term_Typ] = "Select Local Terms Type"
                        
            If [OS] = True Then                         'No Overseas supplier can be selected for this vendor type
                MsgBox "You cannot check this box for Local Vendors.  Please re-select."
                [OS] = False                            'Reset Checkbox OS
            End If
            
            If [Sum_Brand] = 1 Then
                If [AUS] Or [KTAS] = True Then
                    [Ord_Currency] = "AUD"              'Auto select Currency for local Aus Vendor
                End If
                If [NZ] = True Then
                    [Ord_Currency] = "NZD"              'Auto select Currency for local NZ Vendor
                End If
                [Action_Req].Select
            Else
                [G15].Select
            End If
                     
                                  
            'Update Logo
            Call Logo
                       
        'PEPS
        ElseIf [PEPS] = True Then
            
            Call Hide_OS_Rows
            Call Hide_LocBank_Rows            'Call UnHide_LocBank_Rows
            If [AUS] = True Then                  'Unfair check/Small Business for Aus only and less than 20 employees or $10mill
                Call Unfair_Contracts_Check
            Else
                Call Close_Unfair_Contracts_Check
            End If
            'Call Close_Unfair_Contracts_Check ' Removed to allow for Small business 30day credit (AP July 2019)
            '[CTA_Renewal_But].Visible = False
            
            Sheets("(7) Agent").Visible = False
            Sheets("VRF").Shapes("Agt_CB").Visible = False
            Sheets("CTA").Visible = False
            Sheets("VRF").Shapes("CTA_CB").Visible = False
            
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(90)
            
            [Ord_Email_Add] = "Enter if Required"
            [Pay_Term] = "Immediate Terms 000"
            [Pay_Meth] = "T/Trf or Direct Credit"
            ActiveSheet.Unprotect Password:="merservs"
            [PT_Definition].Formula = "=PT_Immediate"
            ActiveSheet.Protect Password:="merservs"
            [Loc_Term_Typ] = "Select Local Terms Type"
            
            If [OS] = True Then                         'No Overseas supplier can be selected for this vendor type
                MsgBox "You cannot check this box for Local Vendors.  Please re-select."
                [OS] = False                            'Reset Checkbox OS
            End If
            
            If [Sum_Brand] = 1 Then
                If [AUS] Or [KTAS] = True Then
                    [Ord_Currency] = "AUD"              'Auto select Currency for local Aus Vendor
                End If
                If [NZ] = True Then
                    [Ord_Currency] = "NZD"              'Auto select Currency for local NZ Vendor
                End If
                [Action_Req].Select
            Else
                [G15].Select
            End If
                                           
            'Update Logo
            Call Logo
            
        End If
    
    End If
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
        
End Sub

Sub NOME_Vndr()
    Call Hide_OS_Rows
    Call Hide_LocBank_Rows            'Call UnHide_LocBank_Rows
    
    If ([AUS] = True Or [KTAS] = True) Then                  'Unfair check for Aus only and less than 20 employees
        Call Unfair_Contracts_Check
    Else
        Call Close_Unfair_Contracts_Check
    End If
    
    '[CTA_Renewal_But].Visible = False
    Sheets("(7) Agent").Visible = False
    Sheets("VRF").Shapes("Agt_CB").Visible = False
    Sheets("CTA").Visible = False
    Sheets("VRF").Shapes("CTA_CB").Visible = False
    Sheets("VRF").Shapes("Email_PDF_Vendor").Visible = False
    [B2B_Cap] = "Yes"
    [X_Dock] = "Yes"
    
    Call Reset_PB
    Sheets("VRF").HPageBreaks.Add Before:=Rows(90)
    
    [Ord_Email_Add] = "" '"Enter if Required"
    [Pay_Term] = "Non Merch U000 - 30 days from date of Invoice"    'Update Payment terms to default for NOME
    [Local_Perc].Value = ""
    [Pay_Meth] = "T/Trf or Direct Credit"                 'Default Payment method T/T for NOME
    ActiveSheet.Unprotect Password:="merservs"
    [PT_Definition].Formula = "=PT_Wkly"
    ActiveSheet.Protect Password:="merservs"
    If [Sum_Brand].Value > 1 Then               'if both Aus & NZ selected in Local - Reset to allow to choose again
        MsgBox "Please only select one, either Australia or New Zealand B. Brand/Purchase Organisation or Tyre & Auto."
        Range("AUS,NZ,OS,KTAS") = False         'Reset Checkbox Aus, NZ, OS, KTAS
        [G12].Select
    End If
    
    If [OS] = True Then                         'Remove Z100 Overseas tick as not required for local Merch if tick accidentally
        MsgBox "You cannot check this box for Local Vendors."
        [OS] = False                            'Reset Checkbox OS
        [G12].Select
    End If
    
    If [Sum_Brand].Value = 1 Then
        If ([AUS] Or [KTAS] = True) Then
            [Ord_Currency] = "AUD"              'Auto select Currency for local Aus Vendor
        End If
        If [NZ] = True Then
            [Ord_Currency] = "NZD"              'Auto select Currency for local NZ Vendor
        End If
        [Action_Req].Select
    Else
        [G15].Select
    End If
               
    If [KTAS] = True Then
        Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = False
        Sheets("VRF").Shapes("Email_PDF_Vendor").Visible = True
    Else
        Sheets("VRF").Shapes("Email_VRF_Vendor").Visible = True
        Sheets("VRF").Shapes("Email_PDF_Vendor").Visible = False
    End If
    
    'Update Logo
    Call Logo
    
    'Remove Overseas Supplier Only inadvertently entered if any
    Call Clear_OS_Details

End Sub
    
Sub Agent()

    If [Agt_Flag] = True And [Agt_LU] = "A" Then
        Sheets("(7) Agent").Visible = True
        Sheets("(7) Agent").Select
        'Call ClearUnlockedCellsAgent
    Else
        Sheets("(7) Agent").Visible = False
        [Agt_Flag] = False
    End If


End Sub

Sub CTA()

    [MERC] = True
    If [CTA_Flag] = True And [Agt_LU] = "C" Then
        Sheets("CTA").Visible = True
        Sheets("CTA").Select
        Sheets("CTA").Shapes("Email_CTA_Vendor").Visible = False
        'Call ClearUnlockedCellsCTA
    Else
        Sheets("CTA").Visible = False
        [CTA_Flag] = False
        Sheets("CTA").Shapes("Email_CTA_Vendor").Visible = True
    End If



End Sub

Sub Hide_OS_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("27:33").Select                'Close all Agent rows
    Selection.EntireRow.Hidden = True
    Rows("44:44").Select                'Close Small Business row
    Selection.EntireRow.Hidden = True
    Rows("52:61").Select                'Close all Optional Address rows
    Selection.EntireRow.Hidden = True
    Rows("71:89").Select                'Close all Delivery Terms rows
    Selection.EntireRow.Hidden = True
    Rows("95:95").Select                'Open Important Note row
    Selection.EntireRow.Hidden = False
    Rows("106:109").Select              'Close all OS Bank rows
    Selection.EntireRow.Hidden = True
    Rows("141:142").Select              'Close all Supply Chain rows
    Selection.EntireRow.Hidden = True
    Rows("143:144").Select              'Close all KAS Finance rows
    Selection.EntireRow.Hidden = True
    Rows("148:149").Select              'Close Legal row
    Selection.EntireRow.Hidden = True
    Range("Yes_Button,No_Button") = False
    ActiveSheet.Protect Password:="merservs"
    
End Sub


Sub Open_Delivery_Terms_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("71:89").Select                'Open all Delivery Terms rows
    Selection.EntireRow.Hidden = False
    Rows("141:142").Select              'Open all Supply Chain rows
    Selection.EntireRow.Hidden = False
    ActiveSheet.Protect Password:="merservs"
End Sub

Sub Unhide_OS_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("27:33").Select                    'Open all Agent rows
    Selection.EntireRow.Hidden = False
    Rows("52:52").Select                    'Close all Optional Address rows except Header
    Selection.EntireRow.Hidden = False
    Sheets("VRF").Shapes("CB_RTNGOODS").Visible = True
    Rows("53:61").Select
    Selection.EntireRow.Hidden = True
    Rows("72:73").Select                    'Close all Local Delivery Terms rows
    Selection.EntireRow.Hidden = True
    Rows("75:89").Select                    'Close Addtional Ports rows
    Selection.EntireRow.Hidden = False
    Rows("95:95").Select                    'Hide Important Note row
    Selection.EntireRow.Hidden = True
    Rows("98:113").Select                  'Open all OS Bank rows
    Selection.EntireRow.Hidden = False
    Rows("141:142").Select                  'Open all Supply Chain rows
    Selection.EntireRow.Hidden = False
    Rows("143:144").Select                  'Open all KAS Finance rows
    Selection.EntireRow.Hidden = False
    ActiveSheet.Protect Password:="merservs"
End Sub



Sub Hide_OSMerch_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("27:33").Select
    Selection.EntireRow.Hidden = True   'Close all Agent rows
    Rows("71:74").Select
    Selection.EntireRow.Hidden = False  'Open all Local Delivery Terms rows
    Rows("78:89").Select
    Selection.EntireRow.Hidden = True   'Close all Port of Shipment rows
    Rows("95:95").Select
    Selection.EntireRow.Hidden = True   'Hide Important Note row
    Rows("106:109").Select
    Selection.EntireRow.Hidden = True   'Close all OS Bank rows
    Rows("143:144").Select
    Selection.EntireRow.Hidden = True   'Close all KAS Finance rows
    ActiveSheet.Protect Password:="merservs"
End Sub

Sub Hide_LocMerch_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("43:44").Select
    Selection.EntireRow.Hidden = True   'Close Small Business row
    Rows("71:71").Select
    Selection.EntireRow.Hidden = False  'Open Delivery Terms header
    Rows("72:73").Select
    Selection.EntireRow.Hidden = True   'Close all Local Delivery Terms rows
    'Rows("104:105").Select
    'Selection.EntireRow.Hidden = True   'Close all Local Bank rows
    Rows("104:105").Select
    Selection.EntireRow.Hidden = True   'Close all RD&GM approval rows
    Rows("148:149").Select
    Selection.EntireRow.Hidden = True   'Close Legal row
    'Range("Yes_Button,No_Button") = False
    ActiveSheet.Protect Password:="merservs"
End Sub

Sub Hide_LocBank_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Sheets("VRF").Shapes("CB_RTNGOODS").Visible = False
    Rows("95:95").Select
    Selection.EntireRow.Hidden = False 'Open Important Note row
    Rows("98:112").Select
    Selection.EntireRow.Hidden = True 'Close all Local Bank rows
    ActiveSheet.Protect Password:="merservs"
End Sub

Sub Unhide_OSBank_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Sheets("VRF").Shapes("CB_RTNGOODS").Visible = False
    Rows("95:95").Select
    Selection.EntireRow.Hidden = True 'Hide Important Note row
    Rows("98:113").Select
    Selection.EntireRow.Hidden = False 'Open all OS Bank rows
    ActiveSheet.Protect Password:="merservs"
End Sub

Sub UnHide_LocBank_Rows()
    ActiveSheet.Unprotect Password:="merservs"
    Sheets("VRF").Shapes("CB_RTNGOODS").Visible = False
    Rows("95:95").Select
    Selection.EntireRow.Hidden = False 'Open Important Note row
    Rows("104:105").Select
    Selection.EntireRow.Hidden = False 'Open all Local Bank rows
    ActiveSheet.Protect Password:="merservs"
End Sub


Sub Unfair_Contracts_Check()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("43:44").Select
    Selection.EntireRow.Hidden = False 'Open Small Business row
    Rows("148:149").Select
    Selection.EntireRow.Hidden = False 'Open Legal row
    ActiveSheet.Protect Password:="merservs"

End Sub


Sub Close_Unfair_Contracts_Check()
    ActiveSheet.Unprotect Password:="merservs"
    Rows("43:44").Select
    Selection.EntireRow.Hidden = True 'Close Small Business row
    Rows("148:149").Select
    Selection.EntireRow.Hidden = True 'Close Legal row
    ActiveSheet.Protect Password:="merservs"

End Sub

Sub Optional_Address()

    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False

    If [Opt_Add].Value > 0 Then
        ActiveSheet.Unprotect Password:="merservs"
        Rows("53:61").Select
        Selection.EntireRow.Hidden = False 'Open all Optional Address rows
        [add_Address].Select
        ActiveSheet.Protect Password:="merservs"
        If [OMER] = True Then
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(68)
            Sheets("VRF").HPageBreaks.Add Before:=Rows(135)
        ElseIf [MERC] = True Then
            Call Reset_PB
            Sheets("VRF").HPageBreaks.Add Before:=Rows(78)
            Sheets("VRF").HPageBreaks.Add Before:=Rows(135)
        End If
    Else
        ActiveSheet.Unprotect Password:="merservs"
        Rows("53:61").Select
        Selection.EntireRow.Hidden = True 'Open all Optional Address rows
        [Pay_Term].Select
        ActiveSheet.Protect Password:="merservs"
        Call Reset_PB
        Sheets("VRF").HPageBreaks.Add Before:=Rows(78)
        Sheets("VRF").HPageBreaks.Add Before:=Rows(135)
    End If
    
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True

End Sub

Sub Clear_OS_Details()

    [OrdviaAgent].Value = "Yes/No"
    [Agt_Type].Value = "Select Agent type"
    Range("SAP_Exp_Agt_No,Export_Agent,Linked_Exp_Agt_No,Linked_Exp_Agt_Name,Bank_Num,Swift_Code,IBAN,IFSC") = ""
    

End Sub

Sub Clear_Delivery_Terms()

    Range("Ord_Qty_Min,Delv_Meth,Delv_Term_Descp") = "N/A"
    Range("Shipment_Port,Ord_Qty_Min,Delv_Meth,BSB") = ""
    Range("X_Dock,B2B_Cap") = "Yes/No"
    [Delv_Term_Descp] = "Select Delivery Terms"
    [Delv_Term_Code].Formula = "=IF(ISNA(VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0)),"""",((VLOOKUP(Delv_Term_Descp_Local,Loc_Delv_Terms_Code,2,0))))"
    
    
End Sub

Sub Logo()

    If [Sum_Brand] > 0 And ([AUS] = True Or [NZ] = True) Then
        Sheets("VRF").Pictures("TAPL_Logo").Visible = False
        Sheets("VRF").Pictures("KmartLogo").Visible = True
    ElseIf [KTAS] = True And [Sum_Brand] = 1 Then
        Sheets("VRF").Pictures("TAPL_Logo").Visible = True
        Sheets("VRF").Pictures("KmartLogo").Visible = False
    End If

End Sub

Sub Consolidated_CTA()
    
    ActiveSheet.Unprotect Password:="merservs"
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    
    If [Cons_CTA] = True Then
        [Non_Cons_CTA] = False
        Rows("30:36").Select                'Payment and Consolidated Terms
        Selection.EntireRow.Hidden = False
        Rows("37:85").Select                'Payment Terms and Settlement Discount & Flat Terms
        Selection.EntireRow.Hidden = True
        Rows("86:102").Select               'Consolidated Terms Components
        Selection.EntireRow.Hidden = False
        Rows("103:115").Select               'Hide Dollar One Rebates to avoid future agreements but maintained for possible re-signing of existing agreements
        Selection.EntireRow.Hidden = True
        Rows("204:207").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("208:212").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = True
        Rows("221:221").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = True
        Rows("223:227").Select              'Purchase Return Information
        Selection.EntireRow.Hidden = True
        [Corp_Num].Select
        
        Call Reset_PB
        Sheets("CTA").HPageBreaks.Add Before:=Rows(147) 'Page break
        'Sheets("CTA").HPageBreaks.Add Before:=Rows(228)
        ActiveWindow.View = xlPageBreakPreview
        ActiveSheet.VPageBreaks(1).DragOff xlToRight, 1
        ActiveWindow.View = xlNormalView
        
        Sheets("CTA").HPageBreaks.Add Before:=Rows(228) 'Page break
       
        
    Else
        Rows("30:36").Select                'Payment and Consolidated Terms
        Selection.EntireRow.Hidden = False
        Rows("37:85").Select                'Payment Terms and Settlement Discount & Flat Terms
        Selection.EntireRow.Hidden = False
        Rows("86:102").Select               'Consolidated Terms Components
        Selection.EntireRow.Hidden = False
        Rows("204:207").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("208:212").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("221:221").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("223:227").Select              'Purchase Return Information
        Selection.EntireRow.Hidden = False
        [Corp_Num].Select
    End If
    
    ActiveSheet.Protect Password:="merservs"
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True

End Sub

Sub Non_Consolidated_CTA()
    
    ActiveSheet.Unprotect Password:="merservs"
    Application.Calculation = xlCalculationManual
    Application.ScreenUpdating = False
    
    If [Non_Cons_CTA] = True Then
        [Cons_CTA] = False
        Rows("30:36").Select                'Payment and Consolidated Terms
        Selection.EntireRow.Hidden = True
        Rows("37:85").Select                'Payment Terms and Settlement Discount & Flat Terms
        Selection.EntireRow.Hidden = False
        Rows("86:102").Select               'Consolidated Terms Components
        Selection.EntireRow.Hidden = True
        Rows("204:207").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = True
        Rows("208:212").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("221:221").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("223:227").Select              'Purchase Return Information
        Selection.EntireRow.Hidden = False
        [Corp_Num].Select
        
        Call Reset_PB
        Sheets("CTA").HPageBreaks.Add Before:=Rows(118)
        'Sheets("CTA").HPageBreaks.Add Before:=Rows(213)
        ActiveWindow.View = xlPageBreakPreview
        ActiveSheet.VPageBreaks(1).DragOff xlToRight, 1
        ActiveWindow.View = xlNormalView
        
    Else
        Rows("30:36").Select                'Payment and Consolidated Terms
        Selection.EntireRow.Hidden = False
        Rows("37:85").Select                'Payment Terms and Settlement Discount & Flat Terms
        Selection.EntireRow.Hidden = False
        Rows("86:102").Select               'Consolidated Terms Components
        Selection.EntireRow.Hidden = False
        Rows("204:207").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("208:212").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("221:221").Select              'Calculation and payment of allowances
        Selection.EntireRow.Hidden = False
        Rows("223:227").Select              'Purchase Return Information
        Selection.EntireRow.Hidden = False
        [Corp_Num].Select
    End If
    
    ActiveSheet.Protect Password:="merservs"
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    
End Sub


Sub CTA_AusNZ()

If [CTA_Aus] And [CTA_NZ] = True Then
    MsgBox "You cannot check one Vendor purchase region.  Please re-select."
    [CTA_NZ] = False
    [CTA_Aus] = False
End If



End Sub

Sub Further_Additional_Information()

ActiveSheet.Unprotect Password:="merservs"

If [AddInfo] = True Then
    Rows("219:312").Select
    Selection.EntireRow.Hidden = False
    [B220].Select
Else
    Rows("219:312").Select
    Selection.EntireRow.Hidden = True
    [B155].Select
End If

ActiveSheet.Protect Password:="merservs"

End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub YesButton_Click()
Application.ScreenUpdating = False
    If YesButton.Value = True Then
        With YesButton
            .BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        End With
        NoButton.Value = False
        With NoButton
            .BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        End With
        ActiveSheet.Unprotect Password:="merservs"
        Rows("143:143").Select
        Selection.EntireRow.Hidden = False 'Open Legal row
        ActiveSheet.Protect Password:="merservs", UserInterfaceOnly:=True, AllowFormattingRows:=True 'DrawingObjects:=True, Contents:=True, Scenarios:=True,
        ActiveSheet.EnableOutlining = True
        [Inv_Attached].Select
    'Else
        'With YesButton
            '.BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        'End With
        'NoButton.Value = False
        'With NoButton
            '.BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        'End With
    End If
    
End Sub


Private Sub NoButton_Click()
Application.ScreenUpdating = False
    If NoButton.Value = True Then
        With NoButton
            .BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        End With
        YesButton.Value = False
        With YesButton
            .BackColor = RGB(255, 255, 255)   'White
            '.BackColor = RGB(255, 255, 0)   'Yellow
            '.Caption = "Click here: No"
        End With
        ActiveSheet.Unprotect Password:="merservs"
        Rows("143:143").Select
        Selection.EntireRow.Hidden = True 'Close Legal row
        ActiveSheet.Protect Password:="merservs"
        [Inv_Attached].Select
    End If
End Sub

Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforePrint(Cancel As Boolean)
'Mandatory fields that need to be entered before document can be printed for each type of Actioned required.
'Work around to print is not to change the Action Required from "Select Action Required or Print Page Only" and the form will print

Dim FormDate As Date

    If [CTA_Renewal] <> "Renew" Then
        FormDate = [DateVRF].Value
        [DateVRF].Value = FormDate
        
    End If

MsgBox "Only a Blank form or a correctly completed form can be printed.  If any required information is missing for the 'Action Required' selected, the form will not be printed until the missing items are completed as requested.", vbOKOnly, "Please note!"

    'New Supplier or Add New Vendor & Agent
If ([Action_Req] = "Add New Vendor" Or [Action_Req] = "Add New Vendor & Non-KAS Agent(7)" Or [Action_Req] = "Add New Vendor - Non-KAS" Or [Action_Req] = "Add New Vendor - KAS") And [Completed_By] <> "" And [CTA_Renewal] <> "Renew" Then
    
    If [Company_Name] = "" Then 'No Company Name entered
        MsgBox "Registered Company Name Required!", vbOKOnly, "Entry Required!"
        [Company_Name].Select
        Cancel = True
    End If
    If [ABNVRF] = "" And [Sum_LocVend_Type] = 1 Then  'No ABN entered
        MsgBox "ABN/GST Required!", vbOKOnly, "Entry Required!"
        [ABNVRF].Select
        Cancel = True
    End If
    If [Inv_Attached] = "Yes/No" Or [Inv_Attached] = "No" Then 'No invoice attached confirmed
        MsgBox "Provide a copy of the Vendor invoice and send with Registration?", vbOKOnly, "Entry Required!"
        [Inv_Attached].Select
        Cancel = True
    End If
    If [VRF_Contact] = "" Then 'No Contact name entered
        MsgBox "Supplier Contact Name Required!", vbOKOnly, "Entry Required!"
        [VRF_Contact].Select
        Cancel = True
    End If
    If [Ord_Email_Add] = "" And ([MERC] = True Or [OMER] = True) Then 'No Order email entered
        MsgBox "Order Email Required!", vbOKOnly, "Entry Required!"
        [Ord_Email_Add].Select
        Cancel = True
    End If
    If [Remit_Email_Add] = "" Then ' No Remittance email entered
        MsgBox "Remittance Email Required!", vbOKOnly, "Entry Required!"
        [Remit_Email_Add].Select
        Cancel = True
    End If
    If [Est_Ann_Spend] = "" And [Sum_Merch] = 1 Then 'No Estimated spend entered for Merchandise Vendor
        MsgBox "Enter Estimated Annual Spend with Vendor by Kmart!", vbOKOnly, "Entry Required!"
        [Est_Ann_Spend].Select
        Cancel = True
    End If
    ' Removed as prefilled now
    'If [Pay_Meth] = "" Or [Pay_Meth] = "Select Payment method" Then 'No Payment Method selected
        'MsgBox "Select Payment Method!", vbOKOnly, "Entry Required!"
        '[Pay_Meth].Select
        'Cancel = True
    'End If
    'If [Pay_Term] = "" Or [Pay_Term].Value = "Select Payment Cycle" Then 'No Payment Terms entered
        'MsgBox "Select Payment terms!", vbOKOnly, "Entry Required!"
        '[Pay_Term].Select
        'Cancel = True
    'End If
    'If [Ord_Currency] = "" Or [Ord_Currency].Value = "Select Currency" Then ' No Currency entered
        'MsgBox "Select Trading Currency!", vbOKOnly, "Entry Required!"
        '[Ord_Currency].Select
        'Cancel = True
    'End If
    If ((([DT_Desc_1] = "" And [Delv_Term_Descp_Local] = "") And [Sum_Merch] = 1) Or (([DT_Desc_1] = "Select Delivery Terms" And [Delv_Term_Descp_Local] = "Select Delivery Terms") And [Sum_Merch] = 1)) Then 'No Delivery Term entered
        If [Sum_LocVend_Type] = 1 Then
            MsgBox "Please select Delivery Terms", vbOKOnly, "Entry Required!"
            [Delv_Term_Descp_Local].Select
            Cancel = True
        Else
            MsgBox "Please select Delivery Terms", vbOKOnly, "Entry Required!"
            [DT_Desc_1].Select
            Cancel = True
            If [DT_Country_1].Value = "" And [DT_Desc_1] <> "Select Delivery Terms" Then ' No Export Country entered
                MsgBox "Please enter Export Country.", vbOKOnly, "Entry Required!"
                [DT_Country_1].Select
                Cancel = True
            End If
            If [DT_SP_1].Value = "" And [DT_Country_1] <> "" Then ' No Port of Shipment entered
                MsgBox "Please enter Port of Shipment.", vbOKOnly, "Entry Required!"
                [DT_SP_1].Select
                Cancel = True
            End If
        End If
    End If
    If [Bank_YN] = "No" Or [Bank_YN] = "Yes/No" Then 'No Bank details confirmation attached confirmed
        MsgBox "Provide a copy of the Bank Deposit Slip or Bank Statment Header and send with Registration", vbOKOnly, "Entry Required!"
        [Bank_YN].Select
        Cancel = True
    End If
    If [Bank_Name].Value = "" And [Vend_Type] = "OS" Then
        MsgBox "Name of Bank Required!", vbOKOnly, "Entry Required!" 'No bank name entered
        [Bank_Name].Select
        Cancel = True
    End If
    'If [BSB] = "" And [Sum_LocVend_Type] = 1 Then 'No BSB entered for a Local and Expense Supplier
        'MsgBox "BSB Required!", vbOKOnly, "Entry Required!"
        '[BSB].Select
        'Cancel = True
    'End If
    If [Swift_Code] = "" And [Vend_Type] = "OS" Then 'No Swift Code entered
        MsgBox "Swift Code Required!", vbOKOnly, "Entry Required!"
        [Swift_Code].Select
        Cancel = True
    End If
    If [Bank_Acc_Num].Value = "" And [Vend_Type] = "OS" Then 'No Account number entered
        MsgBox "Account Number Required!", vbOKOnly, "Entry Required!"
        [Bank_Acc_Num].Select
        Cancel = True
    End If
    If [Bank_Acc_Name].Value = "" And [Vend_Type] = "OS" Then 'No Bank Account Name Entered
        MsgBox "Bank Account Name Required!", vbOKOnly, "Entry Required!"
        [Bank_Acc_Name].Select
        Cancel = True
    End If
End If

     ' New Additional Port or Scanpack
If ([Action_Req].Value = "Add Addt'l Port for O/Seas Vndr" Or [Action_Req].Value = "Add Scanpack for O/Seas Vndr") Then
    
    If [Company_Name].Value = "" Then 'No Company Name entered
        MsgBox "Registered Company Name Required!", vbOKOnly, "Entry Required!"
        [Company_Name].Select
        Cancel = True
    End If
    If [DT_Desc_1] = "" Or [DT_Desc_1] = "Select Delivery Terms" Then
        MsgBox "Please select Delivery Terms", vbOKOnly, "Entry Required!"
        [DT_Desc_1].Select
        Cancel = True
    End If
    MsgBox "Please ensure you have entered the details of the Kmart Supplier# you wish to copy details of in the Message area.", vbOKOnly, "Please Note!"
    [Message_Box].Select
End If

    ' Add New Non-KAS Agent
If [Action_Req].Value = "Add New Non-KAS Agent" Then
    If [Agt_Flag] = True Then
        Sheets("(7) Agent").Select
        If [Agt_Type] = "Select Agent type" Then
            MsgBox "Agent Type needs to be selected!", vbOKOnly, "Entry Required!"
            [Agt_Type].Select
            Cancel = True
        End If
        If [Agent_CompName] = "" Then
            MsgBox "Agent Company needs to be entered!", vbOKOnly, "Entry Required!"
            [Agent_CompName].Select
            Cancel = True
        End If
        If [Agent_AccNum] = "" Then
            MsgBox "Agent Bank Number to be entered!", vbOKOnly, "Entry Required!"
            [Agent_AccNum].Select
            Cancel = True
        End If
    End If

    If [Company_Name] = "" Then 'No Company Name entered
        MsgBox "Supplier's Registered Company Name Required!", vbOKOnly, "Entry Required!"
        [Company_Name].Select
        Cancel = True
    End If
    If [VRF_Contact] = "" Then
        MsgBox "Supplier Contact Name Required!", vbOKOnly, "Entry Required!"
        [VRF_Contact].Select
        Cancel = True
    End If
    If [Ord_Email_Add] = "" Then
        MsgBox "Supplier's Order Email Required!", vbOKOnly, "Entry Required!"
        [Ord_Email_Add].Select
        Cancel = True
    End If
    
End If

   ' New Order Only - Local Vendor
If [Action_Req].Value = "New Order only - Local Vendor" Then
    
    If [Company_Name] = "" Then 'No Company Name entered
        MsgBox "Registered Company Name Required!", vbOKOnly, "Entry Required!"
        [Company_Name].Select
        Cancel = True
    End If
    If [Trading_Name].Value = "" Then
        MsgBox "Company Trading Name Required!", vbOKOnly, "Entry Required!"
        [Trading_Name].Select
        Cancel = True
    End If
    If [ABNVRF] = "" Then
        MsgBox "ABN/GST Required!", vbOKOnly, "Entry Required!"
        [v32].Select
        Cancel = True
    End If
    If [VRF_Contact] = "" Then
        MsgBox "Supplier Contact Name Required!", vbOKOnly, "Entry Required!"
        [VRF_Contact].Select
        Cancel = True
    End If
    If [Ord_Email_Add] = "" Then
        MsgBox "Order Email Required!", vbOKOnly, "Entry Required!"
        [Ord_Email_Add].Select
        Cancel = True
    End If
    'Removed as prefilled
    'If [Delv_Term_Descp_Local].Value = "" Or [Delv_Term_Descp_Local].Value = "Select Delivery Terms" Then
        'MsgBox "Please select Delivery Terms", vbOKOnly, "Entry Required!"
        '[Delv_Term_Descp_Local].Select
        'Cancel = True
    'End If
    'If [Message_Box] = "" Then 'No details provide for copying of details of existing payment supplier in message box
        'MsgBox "Please enter details of Payee Supplier No. for payments to be linked to Corp# or SAP# in the Message Area", vbOKOnly, "Entry Required!"
        '[Message_Box].Select
        'Cancel = True
    'End If
End If

    'Change Details
If ([Action_Req].Value = "Change Vendor Details" Or [Action_Req].Value = "Change Agent Details") Then 'Change Supplier/Agent Details
    If [Kmart_Num] = "" Then 'No Kmart# provided
        MsgBox "Kmart Supplier No. or Kmart Agent No. Required!", vbOKOnly, "Entry Required!"
        [Kmart_Num].Select
        Cancel = True
    End If
    If [Company_Name] = "" Then 'No Company Name entered
        MsgBox "Vendor Contact Name Required!", vbOKOnly, "Entry Required!"
        [Company_Name].Select
        Cancel = True
    End If
    If [Message_Box].Value = "" Then 'No details provide for change of details in message box
        MsgBox "Please provide details of reasons for changes to Vendor/Agent account in the Message Area.", vbOKOnly, "Entry Required!"
        [Message_Box].Select
        Cancel = True
    End If
End If


    'Local Merch Number of Employees

'If [MERC] = True And [Opt_SB] = 0 Then
     'MsgBox "Do you employ less than 20 people i.e. small business?", vbOKOnly, "Entry Required!"
        '[L42].Select
        'Cancel = True
'End If

'Non-Merch Number of Employees
If [NOME] = True And [No_Emp] = "" And [AUS] = True Then
     MsgBox "Please enter the number of employees.", vbOKOnly, "Entry Required!"
        [No_Emp].Select
        'Cancel = True
End If

If ([KTAS] = True And [PEPS] = False And [PUMR] = False And [Action_Req] <> "Select Action required") And [Opt_SB] = 0 And [Completed_By] <> "" Then
     MsgBox "Do you employ less than 20 people i.e. small business?", vbOKOnly, "Entry Required!"
        [L42].Select
        Cancel = True
End If


'CTA Renewal Only
If [CTA_Renewal] = "Renew" Then
    If [Vend_Name] <> "" Then
        If [Corp_Num] = "" Then
            MsgBox "Corporate Number Required!", vbOKOnly, "Entry Required!"
            [Corp_Num].Select
            Cancel = True
        End If
        If [Vend_Name] = "" Then
            MsgBox "Vendor Name Required!", vbOKOnly, "Entry Required!"
            [Vend_Name].Select
            Cancel = True
        End If
        If [ABN] = "" Then
            MsgBox "ABN Number Required!", vbOKOnly, "Entry Required!"
            [ABN].Select
            Cancel = True
        End If
        If [Start_Date] = "" Then
            MsgBox "Start Date Required!", vbOKOnly, "Entry Required!"
            [Start_Date].Select
            Cancel = True
        End If
        If [LeadDept] = "" Then
            MsgBox "Lead Department Detail Required!", vbOKOnly, "Entry Required!"
            [LeadDept].Select
            Cancel = True
        End If
        If [CTA_Delv_Term] = "Select Delivery Terms" Then
            MsgBox "Delivery Term Required!", vbOKOnly, "Entry Required!"
            [CTA_Delv_Term].Select
            Cancel = True
        End If
        If [Non_Cons_CTA] = True Then
            If [Pay_Cycle_Non] = "Select Payment Cycle" Then
                MsgBox "Payment Cycle Required!", vbOKOnly, "Entry Required!"
                [Pay_Cycle_Non].Select
                Cancel = True
            End If
            
        End If
        If [Cons_CTA] = True Then
            If [Pay_Cycle] = "Select Payment Cycle" Then
                MsgBox "Payment Cycle Required!", vbOKOnly, "Entry Required!"
                [Pay_Cycle].Select
                Cancel = True
            End If
        End If
    End If
    
End If
    
    
    
    
    
'Update Footer
'Dim WorkRng As Range
On Error Resume Next
'xTitleId = "VRF"
'Set WorkRng = Application.Selection.Range("Company_name")
'Set WorkRng = Application.InputBox("Range (single cell)", xTitleId, WorkRng.Address, Type:=8)
    For Each ws In Application.ActiveWorkbook.Worksheets
        ws.PageSetup.CenterFooter = [Company_Name].Value
    Next


End Sub


Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
    
        
        'If [GM_Auth] = "" And [Pay_Term] <> "" Then
            'MsgBox "If non-preferred Payment terms have been agreed to, please obtain General Manager authorisation.", vbOKOnly, "Authorisation Required!"
            '[GM_Auth].Select
            'Cancel = True
        'End If
    
End Sub

Private Sub Workbook_Open()

With Sheets("CTA")
    .Protect "merservs", , , , True
    .EnableOutlining = True
End With

End Sub



INQUEST-PP=macro
