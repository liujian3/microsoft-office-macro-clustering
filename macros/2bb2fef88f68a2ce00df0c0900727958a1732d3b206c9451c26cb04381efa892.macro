Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub workbook_Open()
Dim start As String
Dim dz As Integer 'dz Datenzeilen
Dim kv As Integer 'kv Kopiervorlage
Dim i As Integer
Dim cb As CommandBar
Dim flag
Rem ### Startmakro beim |fffd|ffnen der Datei zur Spalteneinstellung "DATEN" bzw.
Rem ### Vorbereitung der Leerdatei
Application.ScreenUpdating = False
Rem #1# Ausblenden von Men|fffd|leisten u.a. ###
    Application.CommandBars(1).Enabled = False 'Men|fffd|leiste ausblenden
'    For Each cb In Application.CommandBars 'alle Men|fffd|-,Symbol-,Kontextleisten ausblenden
'        cb.Enabled = False
'        Next cb
    Application.CommandBars("Standard").Visible = False 'Symbolleiste Standard ausblenden
    Application.CommandBars("Formatting").Visible = False 'Symbolleiste Format ausblenden
    With ActiveWindow
    .DisplayHeadings = False 'Ausblenden Zeilen- und Spaltenk|fffd|pfe
    '.DisplayHorizontalScrollBar = False 'Ausblenden horizontale Bildlaufleiste
    '.DisplayVerticalScrollBar = False 'Ausblenden vertikale Bildlaufleiste
    .DisplayWorkbookTabs = False 'Ausblenden Registerlaschen
    End With
    '
    With Application
    .DisplayStatusBar = False 'Ausblenden Statusleiste (unterhalb Registerleiste)
    .DisplayFormulaBar = False 'Ausblenden Bearbeitungsleiste (unterhalb Symbolleiste)
    End With
    
Rem #2# Ausblenden Registerbl|fffd|tter mit Ausnahme DATEN ###
    
    Sheets("ABIES").Visible = xlVeryHidden
    Sheets("SD").Visible = xlVeryHidden
    Sheets("P").Visible = xlVeryHidden
    Sheets("KOPF").Visible = xlVeryHidden
    Sheets("DATEN").Visible = True
    Sheets("DATEN").Select
    ActiveSheet.Unprotect ("mallnitz")
    Application.Calculation = xlCalculationManual

    dz = Cells(3, 4).Value
    kv = Cells(4, 4).Value
Rem #3# Ausblenden s|fffd|mtlicher Hilfsspalten in DATEN ###
    Cells(2, 2).Activate 'Zellenwert Erfassungsverfahren
    Columns("A:HZ").Hidden = True 'alle Spalten ausblenden
    Columns("IA:II").Hidden = True 'gr|fffd|ner Ergebnisbereich ausblenden
    Columns("IJ:IL").Hidden = False 'Grauspalten einblenden
    Rows("1:2").Hidden = True 'Kopfzeilen ausblenden
    Rows("6:6").Hidden = True 'obere Zeile Kopiervorlage ausblenden
    Rows(kv).Hidden = True 'untere Zeile Kopiervorlage ausblenden

Rem #4# Zelle B2 hat Wert 0 bei Leerdatei, sonst 1 - 5 je nach Erfassungsart
    If Cells(2, 2).Value > 0 Then '1A Datei mit ausgew|fffd|hltem Erfassungsverfahren
        Rem #4A# Programmverhalten bei erneutem |fffd|ffnen ###
        Columns("B:B").Hidden = False 'Spalte Datenzeile einblenden
        Columns("AA:AG").Hidden = False 'Spalten Grunddaten einblenden
        Columns("HA:HD").Hidden = False 'Spalten sonstige Daten einblenden
        Columns("IA:II").Hidden = False 'gr|fffd|ner Ergebnisbereich einblenden
        If Cells(2, 2).Value = 1 Then '1.1A Erfassungsverfahren |fffd|bernahme aus Liste
            Columns("CA:CF").Hidden = False 'Spalten Kerndaten |fffd|bernahme aus Liste einblenden
            Rows("7:" & dz).Hidden = False 'alle Datenzeilen einblenden
        Else '1.1B Programmverhalten bei |fffd|brigen Erfassungsverfahren
            If Cells(2, 115).Value < 7 Then
            '1.1.1A alle Datenzeilen ausblenden, wenn keine Datenzeilen gef|fffd|llt
                Rows("7:" & dz).Hidden = True
            Else '1.1.1B vorgef|fffd|llte Datenzeilen einblenden, Leerzeilen ausblenden
                For i = 7 To Cells(2, 115).Value
                    Rows(i).Hidden = False
                    Next i
                For i = Cells(2, 115).Value + 1 To dz
                    Rows(i).Hidden = True
                    Next i
            End If '1.1.1Z
            Cells(2, 106).Value = 0 'Baumart fixiert - nein
            Cells(2, 109).Value = 0 'GKL fixiert - nein
            Cells(2, 109).Value = 0 'L|fffd|nge fixiert - nein
            Columns("DA:DI").Hidden = False 'Spalten Kerndaten |fffd|brige Erf.verf einblenden
            If Cells(2, 2).Value = 5 Then '1.1.2A Verfahren Einfeldeingabe
                Columns("DE:DG").Hidden = True
            Else '1.1.2B Verfahren Mehrfeldeingabe
                Columns("DH:DI").Hidden = True
            End If '1.1.2Z
        End If '1.1Z
    Else '1B Datei ohne ausgew|fffd|hltes Erfassungsverfahren
        Rem #4B# Programmverhalten beim erstmaligen |fffd|ffnen
        Columns("B:B").Hidden = True 'Spalte Datenzeilen ausblenden

        Sheets("ABIES").Unprotect ("mallnitz")
        Sheets("ABIES").Cells(3, 21).Value = "" 'Pr|fffd|fziffer Plausibilit|fffd|t l|fffd|schen
        Sheets("ABIES").Protect ("mallnitz")
        Sheets("DATEN").Select
        Cells(2, 17).Value = 0 'Zellenwert Sortierfolge zur|fffd|cksetzen
        Cells(7, 27).Value = ""
        For i = 7 To dz
            Cells(i, 21).Value = i - 6 'Sortierspalte systematisch numerieren
            Cells(i, 145).Value = 0 'Pr|fffd|fspalte Plausibilit|fffd|t HNR/LosNr zur|fffd|cksetzen
            Next i
        'Application.ScreenUpdating = True
        UserForm1.Label8.Visible = False
        UserForm1.Label9.Visible = False
'        flag = Cells(2, 27).Value
'        If flag = "ja" Then
        flag = GetEnvironmentVariable("AbiesEnv")
        If flag = True Then
            Columns("IJ:IK").Hidden = True 'Grauspalten ausblenden (IM im sichtb.Bereich)
            Rows("7:25").Hidden = False 'Zeile Benutzerhinweise und Schaltfl|fffd|chen einblenden
            Cells(1, 246).Select
        Else
            Rows("7:25").Hidden = True 'Zeilen Benutzerhinweise und Schaltfl|fffd|chen ausblenden
            Columns("HU:HX").Hidden = False 'Grauspelten vor Gr|fffd|nbereich einblenden
            Columns("IJ:IK").Hidden = False 'Grauspalten einblenden (IM au|fffd|h. sichtb.Bereich)
            Application.Calculation = xlCalculationAutomatic
            Application.ScreenUpdating = True
            UserForm1.Show 'Maske Erfassungsverfahren einblenden
        End If
    End If '1Z
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
If Cells(2, 115).Value < 7 Then
    Cells(4, 27).Select
Else
    Cells(7, 27).Select
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub Workbook_BeforeClose(Cancel As Boolean)
Dim cb As CommandBar
Dim i As Integer
'Sheets("DATEN").Select
If CloseMode = vbFormControlMenu Then

    For Each cb In Application.CommandBars
        cb.Enabled = True
        Next cb
    With ActiveWindow
    .DisplayHeadings = True
    .DisplayHorizontalScrollBar = True
    .DisplayVerticalScrollBar = True
    .DisplayWorkbookTabs = True
    End With
    With Application
    .DisplayAlerts = True
    .DisplayStatusBar = True
    .DisplayFormulaBar = True
    End With
Application.CommandBars(1).Enabled = True
Application.CommandBars("Standard").Visible = True
Application.CommandBars("Formatting").Visible = True
Application.CommandBars("Standard").Enabled = True
Application.CommandBars("Formatting").Enabled = True
Application.ScreenUpdating = True
Application.DisplayAlerts = True
'Sheets("DATEN").Select
'    If i = 2 Then
'        MsgBox "blabla"
'        Else
'        MsgBox "blubb"
'        End If
    'Cancel = True
Else

    For Each cb In Application.CommandBars
        cb.Enabled = True
        Next cb
    With ActiveWindow
    .DisplayHeadings = True
    .DisplayHorizontalScrollBar = True
    .DisplayVerticalScrollBar = True
    .DisplayWorkbookTabs = True
    End With
    With Application
    .DisplayAlerts = True
    .DisplayStatusBar = True
    .DisplayFormulaBar = True
    End With
Application.CommandBars(1).Enabled = True
Application.CommandBars("Standard").Visible = True
Application.CommandBars("Formatting").Visible = True
Application.CommandBars("Standard").Enabled = True
Application.CommandBars("Formatting").Enabled = True
Application.DisplayAlerts = True
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
Columns("B:HT").Hidden = True
Columns("HU:HZ").Hidden = True
Columns("C").Hidden = False
'Application.Calculation = xlCalculationAutomatic
'ActiveWorkbook.Save
ActiveSheet.Protect ("mallnitz")
End If
End Sub




Attribute VB_Name = "Modul1"
Private Declare Function GetEnvVar Lib "kernel32" Alias "GetEnvironmentVariableA" _
    (ByVal lpName As String, ByVal lpBuffer As String, ByVal nSize As Long) As Long

Function GetEnvironmentVariable(var As String) As String
Dim numChars As Long

    GetEnvironmentVariable = String(255, " ")

    numChars = GetEnvVar(var, GetEnvironmentVariable, 255)

End Function



Sub MaskePlausibilit|fffd|t|fffd|ffnen()
    Rem #(S)# |fffd|ffnen Userform2 Hilfsmaske Plausibilit|fffd|t |fffd|ber Schaltfl|fffd|che
    Rem #(S)# DATEN - PLAUSIBILIT|fffd|TSPR|fffd|FUNG ###
    Grundbildschirmsicht
    Sheets("DATEN").Select
    
    If Cells(2, 4).Value < 7 Then '1A wenn keine Datens|fffd|tze vorhanden, dann keine Plausipr|fffd|fung
        MsgBox "Datei enth|fffd|lt keine Datens|fffd|tze - Plausibilit|fffd|tspr|fffd|fung demzufolge nicht m|fffd|glich!", _
        48, "Hinweis Plausibilit|fffd|tspr|fffd|fung"
    Else '1B sonst (d.h. Datens|fffd|tze vorhanden - |fffd|ffnen Maske Plausibilit|fffd|tspr|fffd|fung)
        ActiveSheet.Unprotect ("mallnitz")
        Columns("I:M").Hidden = True
        Cells(4, 8).Value = 1 'Flag Plausi gestartet
        UserForm2.CommandButton1.Enabled = True 'Starten
        UserForm2.CommandButton2.Enabled = True 'Abbrechen
        UserForm2.Label2.Visible = False 'Pr|fffd|fergebnis Struktur
        UserForm2.CommandButton3.Visible = False 'Struktur bearbeiten
        UserForm2.Label3.Enabled = False 'Pr|fffd|fung Grunddaten
        UserForm2.Label4.Visible = False 'Pr|fffd|fergebnis Grunddaten
        UserForm2.CommandButton4.Visible = False 'Grunddaten bearbeiten
        UserForm2.Label5.Enabled = False 'Dublettenpr|fffd|fung
        UserForm2.Label6.Visible = False 'Pr|fffd|fergebnis Dubletten
        UserForm2.CommandButton5.Visible = False 'Dublettenpr|fffd|fung bearbeiten
        UserForm2.Label7.Enabled = False 'Pr|fffd|fung Kerndaten
        UserForm2.Label8.Visible = False 'Pr|fffd|fergebnis Kerndaten (hart)
        UserForm2.CommandButton6.Visible = False 'Kerndaten bearbeiten
        UserForm2.Label9.Enabled = False 'Pr|fffd|fung Zusatzdaten
        UserForm2.Label10.Visible = False 'Pr|fffd|fergebnis Zusatzdaten
        UserForm2.CommandButton7.Visible = False 'Zusatzdaten bearbeiten
        UserForm2.CommandButton8.Enabled = False 'ok
        UserForm2.Label11.Visible = False 'Haken Struktur
        UserForm2.Label12.Visible = False 'Haken Grunddaten
        UserForm2.Label13.Visible = False 'Haken Dubletten
        UserForm2.Label14.Visible = False 'Haken Kerndaten
        UserForm2.Label15.Visible = False 'Haken Zusatzdaten
        UserForm2.Label16.Visible = False 'Gesamtpr|fffd|fung erfolgreich
        UserForm2.Label17.Visible = False 'Haken Gesamtpr|fffd|fung
        UserForm2.Label18.Visible = False 'Pr|fffd|fergebnis Kerndaten (weich)
        UserForm2.Label19.Visible = False 'ohne Nachbearbeitung weiter (weich)
        UserForm2.Label20.Visible = False 'Handzeichen RVR ausblenden
        UserForm2.CommandButton9.Visible = False 'ok Kerndaten (weich)
        UserForm2.CommandButton10.Visible = False 'Kerndaten (weich RVR) bearbeiten
        UserForm2.Label21.Visible = False 'Pr|fffd|fergebnis identische GKL (weich)
        UserForm2.Label22.Visible = False 'ohne Nachbearbeitung weiter (weich) GKL
        UserForm2.Label23.Visible = False 'Handzeichen GKL ausblenden
        UserForm2.CommandButton11.Visible = False 'ok GKL (weich)
        UserForm2.CommandButton12.Visible = False 'GKL (weich) bearbeiten
        UserForm2.CommandButton1.SetFocus
        UserForm2.Show
    End If '1Z Ende Datens|fffd|tze vorhanden ja/nein - |fffd|ffnen Plausimaske ja/nein
End Sub



Sub MaskeErfassungsverfahren|fffd|ffnen()
Attribute MaskeErfassungsverfahren|fffd|ffnen.VB_ProcData.VB_Invoke_Func = "u\n14"
    Rem #(S)# |fffd|ffnen Userform1 Hilfsmaske Erfassungsverfahren / Grunddaten
    Rem #(S)# bei erstmaligem Programmstart bzw. nach Schaltfl|fffd|che DATEN - ABBRECHEN,
    Rem #(S)# wenn keine Datens|fffd|tze in Tabellenblatt DATEN
        ActiveSheet.Unprotect ("mallnitz")
        UserForm1.Label8.Visible = False
        UserForm1.Label9.Visible = False
        UserForm1.Show
End Sub



Sub MaskeKopfdaten|fffd|ffnen()
    If Sheets("DATEN").Cells(4, 8).Value = 1 Then
        MsgBox "Wechsel in Kopf-/Losdaten w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;" _
        & " bitte erst Plausbilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", _
        48, "Funktion Kopf-/Losdaten"
        Exit Sub
    Else
    End If
    Grundbildschirmsicht
    Rem #(S)# |fffd|ffnen Userform8 Hilfsmaske Kopf-/Losdaten |fffd|ber Schaltfl|fffd|che DATEN -
    Rem #(S)# KOPF/LOSDATEN ###
    MsgBox "Hinweis: Kopf- und Losdaten werden nicht automatisiert nach Abies FIS8 NRW" _
    & " |fffd|bernommen", 64, "Funktion Kopf- / Losdaten"
    
    Rem #(1)# Vorbereitung |fffd|bernahme Kopf-/ Losdaten aus Datenblatt KOPF ###
    Application.ScreenUpdating = False
    Sheets("KOPF").Visible = True
    Sheets("KOPF").Select
    ActiveSheet.Unprotect ("mallnitz")
    Rows("1:1").Hidden = True
    Columns("B:Z").Hidden = True
    
    Rem #(2)# Einlesen Kopfdaten ###
    UserForm8.TextBox1 = Format(Cells(4, 5).Value, "dd.mm.yyyy") 'Hiebsbeginn E4
    UserForm8.TextBox2 = Cells(6, 5).Value 'Waldbesitzer Partnernummer E6
    UserForm8.TextBox3 = Cells(7, 5).Value 'Niederlassung Partnernummer E7
    UserForm8.TextBox4 = Cells(8, 5).Value 'Adresse E8
    UserForm8.TextBox5 = Cells(9, 5).Value 'Langname Waldbesitzer E9
    UserForm8.TextBox6 = Cells(11, 5).Value 'Zusammenschluss Partnernummer E11
    UserForm8.TextBox7 = Cells(12, 5).Value 'Niederlassung Zusammenschluss E12
    UserForm8.TextBox8 = Cells(13, 5).Value 'Adresse Zusammenschluss E13
    UserForm8.TextBox9 = Cells(14, 5).Value 'Langname Zusammenschluss E14
    UserForm8.TextBox10 = Cells(20, 5).Value 'Datenquelle E20
    UserForm8.ComboBox1 = Cells(21, 5).Value 'Ma|fffd|nahme E21
    UserForm8.ComboBox2 = Cells(22, 5).Value 'Ausf|fffd|hrende E22
    UserForm8.TextBox11 = Cells(24, 10).Value 'Abt/UAbt E24
    UserForm8.TextBox12 = Cells(25, 5).Value 'BE E25
    UserForm8.TextBox13 = Cells(32, 5).Value 'Langname Waldort E32
    UserForm8.TextBox14 = Cells(34, 5).Value 'Projekt zentral E34
    UserForm8.TextBox15 = Cells(35, 5).Value 'Projekt FoA E35
    UserForm8.TextBox16 = Cells(36, 5).Value 'Projekt FBB E36
    UserForm8.ComboBox3 = Cells(38, 5).Value 'Herkunft E38
    UserForm8.TextBox17 = Cells(40, 5).Value 'Bemerkung extern E40
    UserForm8.TextBox18 = Cells(41, 5).Value 'Bemerkung intern E41
    If Cells(6, 5).Value = 100 Then '1A Staatswald
        UserForm8.TextBox3.Enabled = False 'Niederlassung Waldbesitzer
        UserForm8.TextBox4.Enabled = False 'Adresse Waldbesitzer
        UserForm8.TextBox5.Enabled = False 'Langname Waldbesitzer
        UserForm8.Label5.Enabled = False 'Zusammenschluss Partnernummer
        UserForm8.TextBox6.Visible = False 'Zusammenschluss Partnernummer
        UserForm8.Label6.Enabled = False 'Zusammenschluss NL/Adresse
        UserForm8.TextBox7.Visible = False 'Zusammenschluss NL
        UserForm8.TextBox8.Visible = False 'Zusammenschluss Adresse
        UserForm8.Label7.Enabled = False 'Zusammenschluss Langname
        UserForm8.TextBox9.Visible = False 'Zusammenschluss Langname
        UserForm8.Label27.Enabled = False 'Leistung EO
        UserForm8.ComboBox5.Visible = False 'Leistung EO
        UserForm8.CheckBox1.Visible = False '8a
    Else '1B Nichtstaatswald
        UserForm8.TextBox3.Enabled = True
        UserForm8.TextBox4.Enabled = True
        UserForm8.TextBox5.Enabled = True
        UserForm8.Label5.Enabled = True
        UserForm8.TextBox6.Visible = True
        UserForm8.Label6.Enabled = True
        UserForm8.TextBox7.Visible = True
        UserForm8.TextBox8.Visible = True
        UserForm8.Label7.Enabled = True
        UserForm8.TextBox9.Visible = True
        UserForm8.Label27.Enabled = True
        UserForm8.ComboBox5.Visible = True
        UserForm8.CheckBox1.Visible = True
    End If '1Z
    
    Rem #(3)# Aussteuern MASSNAHMENART (Combobox1) ###
    UserForm8.ComboBox1.Value = Sheets("KOPF").Cells(21, 5).Value
    If Cells(6, 5).Value = "" And Cells(9, 5).Value = "" = True Then
    '2A Feld WB Partnernr oder Langname leer
        With UserForm8.ComboBox1
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!AW23:AY23"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    ElseIf Cells(6, 5).Value = 100 Then '2B Staatswald
        With UserForm8.ComboBox1
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!AW3:AY15"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    Else '2C Nichtstaatswald
        With UserForm8.ComboBox1
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!AW23:AY36"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    End If '2Z
    
    Rem #(4)# Aussteuern AUSF|fffd|HRENDE (Combobox2) ###
    UserForm8.ComboBox2.Value = Sheets("KOPF").Cells(22, 5).Value
    If Cells(6, 5).Value = "" And Cells(9, 5).Value = "" = True Then
    '3A Feld WB Partnernummer oder Langname leer
        With UserForm8.ComboBox2
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BC23:BE23"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    ElseIf Cells(6, 5).Value = 100 Then '3B Staatswald
        With UserForm8.ComboBox2
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BC3:BE7"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    Else '3C Nichtstaatswald
        With UserForm8.ComboBox2
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BC23:BE28"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    End If '3Z
    
    Rem #(5)# Aussteuern ABGANGSART (Combobox4) ###
    UserForm8.ComboBox4.Value = Sheets("KOPF").Cells(49, 5).Value
    If Cells(6, 5).Value = "" And Cells(9, 5).Value = "" = True Then
    '4A Feld WB Partnernummer oder Langname leer
        With UserForm8.ComboBox4
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BO23:BQ23"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    ElseIf Cells(6, 5).Value = 100 Then '4B Staatswald
        With UserForm8.ComboBox4
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BO3:BQ9"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    Else '4C Nichtstaatswald
        With UserForm8.ComboBox4
            .ColumnCount = 2
            .ColumnHeads = True
            .RowSource = "SD!BO23:BQ25"
            .ColumnWidths = "0cm;4cm"
            .MatchRequired = True
        End With
    End If '4Z
    
    Rem #(6)# Ausblenden Losdaten, wenn WB leer ###
    If Cells(6, 5).Value = "" And Cells(9, 5).Value = "" = True Then
    '5A Feld WB Partnernummer oder Langname leer
        UserForm8.Frame2.Visible = False 'dann Losdaten ausblenden
        UserForm8.CommandButton1.Visible = True 'zur|fffd|ck zum Hauptblatt in Kopfdaten
    Else '5B sonst Losdaten einblenden
        UserForm8.Frame2.Visible = True
        UserForm8.CommandButton1.Visible = False
    End If '5Z
    
    Rem #(7)# Aussteuern Zertifikate ###
    If Cells(17, 5).Value = 0 Then '6A
        UserForm8.CheckBox2.Value = False 'Zertifikat
        UserForm8.TextBox31.Visible = False 'Langname Zertifikat
    Else '6B
        UserForm8.CheckBox2.Value = True
        UserForm8.TextBox31.Value = Cells(18, 5).Value
        UserForm8.TextBox31.Visible = True
    End If '6Z
    
    Rem #(8)# Einlesen Losdaten ###
    UserForm8.TextBox19 = Cells(43, 5).Value 'K|fffd|ufervorschlag Partnernummer E43
    UserForm8.TextBox20 = Cells(44, 5).Value 'K|fffd|ufervorschlag NL E44
    UserForm8.TextBox21 = Cells(45, 5).Value 'K|fffd|ufervorschlag Adresse E45
    UserForm8.TextBox22 = Cells(46, 5).Value 'K|fffd|ufervorschlag Langname E46
    UserForm8.TextBox23 = Cells(48, 5).Value 'Vertragsvorschlag Langname E48
    UserForm8.ComboBox4 = Cells(49, 5).Value 'Abgangsart E49
    UserForm8.ComboBox5 = Cells(50, 5).Value 'Leistung EO E50
    If Cells(51, 5).Value = 1 Then '7A
        UserForm8.CheckBox1.Value = True 'Leistung 8a E51
    Else '7B
        UserForm8.CheckBox1.Value = False
    End If '7Z
    UserForm8.TextBox24 = Cells(52, 5).Value 'Unternehmer(1) E52
    UserForm8.TextBox25 = Cells(53, 5).Value 'Kommentar(1) E53
    UserForm8.TextBox26 = Cells(54, 5).Value 'Unternehmer(2) E54
    UserForm8.TextBox27 = Cells(55, 5).Value 'Kommentar(2) E55
    UserForm8.TextBox28 = Cells(56, 5).Value 'Unternehmer(3) E56
    UserForm8.TextBox29 = Cells(57, 5).Value 'Kommentar(3) E57
    UserForm8.TextBox30 = Cells(59, 5).Value 'Bemerkung E59
    UserForm8.ComboBox6 = Cells(60, 5).Value 'Entrindungszustand E60
    UserForm8.ComboBox7 = Cells(61, 5).Value 'Logistikstatus E61
    UserForm8.ComboBox8 = Cells(63, 5).Value 'Zugangstyp E63
    
    Rem #(9)#  Aussteuern Kernfelder / alle Felder ###
    If Cells(65, 5).Value = 1 Then '8A wenn nur Kernfelder, dann nachfolgend ausblenden
        UserForm8.OptionButton1 = True 'Kernfelder
        UserForm8.OptionButton2 = False 'alle Felder
        UserForm8.Label13.Visible = False 'BE
        UserForm8.Label15.Visible = False 'ProjektNr
        UserForm8.Label16.Visible = False 'zentral
        UserForm8.Label17.Visible = False 'FoA
        UserForm8.Label18.Visible = False 'FBB
        UserForm8.Label20.Visible = False 'Bemerkung extern
        UserForm8.Label21.Visible = False 'Bemerkung intern
        UserForm8.Label28.Visible = False 'Entrindungszustand
        UserForm8.Label29.Visible = False 'Logistikstatus
        UserForm8.Label30.Visible = False 'Unternehmer(1)
        UserForm8.Label31.Visible = False 'Kommentar(1)
        UserForm8.Label32.Visible = False 'Unternehmer(2)
        UserForm8.Label33.Visible = False 'Kommentar(2)
        UserForm8.Label34.Visible = False 'Unternehmer(3)
        UserForm8.Label35.Visible = False 'Kommentar(3)
        UserForm8.Label36.Visible = False 'Bemerkung
        UserForm8.TextBox12.Visible = False 'BE
        UserForm8.TextBox14.Visible = False 'zentral
        UserForm8.TextBox15.Visible = False 'FoA
        UserForm8.TextBox16.Visible = False 'FBB
        UserForm8.TextBox17.Visible = False 'Bemerkung extern
        UserForm8.TextBox18.Visible = False 'Bemerkung intern
        UserForm8.TextBox24.Visible = False 'Unternehmer(1)
        UserForm8.TextBox25.Visible = False 'Kommentar(1)
        UserForm8.TextBox26.Visible = False 'Unternehmer(2)
        UserForm8.TextBox27.Visible = False 'Kommentar(2)
        UserForm8.TextBox28.Visible = False 'Unternehmer(3)
        UserForm8.TextBox29.Visible = False 'Kommentar(3)
        UserForm8.TextBox30.Visible = False 'Bemerkung
        UserForm8.ComboBox6.Visible = False 'Entrindungszustand
        UserForm8.ComboBox7.Visible = False 'Logistikstatus
    Else '8B sonst nachfolgend einblenden
        UserForm8.OptionButton1 = False 'Kernfelder
        UserForm8.OptionButton2 = True 'alle Felder
        UserForm8.Label13.Visible = True 'BE
        UserForm8.Label15.Visible = True 'ProjektNr
        UserForm8.Label16.Visible = True 'zentral
        UserForm8.Label17.Visible = True 'FoA
        UserForm8.Label18.Visible = True 'FBB
        UserForm8.Label20.Visible = True 'Bemerkung extern
        UserForm8.Label21.Visible = True 'Bemerkung intern
        UserForm8.Label28.Visible = True 'Entrindungszustand
        UserForm8.Label29.Visible = True 'Logistikstatus
        UserForm8.Label30.Visible = True 'Unternehmer(1)
        UserForm8.Label31.Visible = True 'Kommentar(1)
        UserForm8.Label32.Visible = True 'Unternehmer(2)
        UserForm8.Label33.Visible = True 'Kommentar(2)
        UserForm8.Label34.Visible = True 'Unternehmer(3)
        UserForm8.Label35.Visible = True 'Kommentar(3)
        UserForm8.Label36.Visible = True 'Bemerkung
        UserForm8.TextBox12.Visible = True 'BE
        UserForm8.TextBox14.Visible = True 'zentral
        UserForm8.TextBox15.Visible = True 'FoA
        UserForm8.TextBox16.Visible = True 'FBB
        UserForm8.TextBox17.Visible = True 'Bemerkung extern
        UserForm8.TextBox18.Visible = True 'Bemerkung intern
        UserForm8.TextBox24.Visible = True 'Unternehmer(1)
        UserForm8.TextBox25.Visible = True 'Kommentar(1)
        UserForm8.TextBox26.Visible = True 'Unternehmer(2)
        UserForm8.TextBox27.Visible = True 'Kommentar(2)
        UserForm8.TextBox28.Visible = True 'Unternehmer(3)
        UserForm8.TextBox29.Visible = True 'Kommentar(3)
        UserForm8.TextBox30.Visible = True 'Bemerkung
        UserForm8.ComboBox6.Visible = True 'Entrindungszustand
        UserForm8.ComboBox7.Visible = True 'Logistikstatus
    End If '8Z
    
    Rem #(10)# Einblenden Maske Kopf/Losdaten ###
    Sheets("KOPF").Range("A2").Select
    Application.ScreenUpdating = True
    UserForm8.Show
End Sub



Sub BlattschutzAufheben()
Attribute BlattschutzAufheben.VB_ProcData.VB_Invoke_Func = "b\n14"
    Rem #(S)# Einblenden Userform3 Hilfsmaske Passwort Blattschutz abfragen ###
    Dim frm As UserForm
    Set frm = UserForm3
    frm.TextBox1.PasswordChar = "*" 'Textfeld Passwort
    frm.TextBox1.SetFocus
    frm.Label2.Visible = False 'Passwort falsch!
    UserForm3.Show
End Sub



Sub Speichern|fffd|ffnenDialog()
    Dim flag
    Rem #(S)# Aktion bei Schaltfl|fffd|che Speichern |fffd|ber Schaltfl|fffd|che DATEN - SPEICHERN ###
    If Sheets("DATEN").Cells(4, 8).Value = 1 Then
        MsgBox "Funktion w|fffd|hrend lfd. Plausipr|fffd|fung nicht verf|fffd|gbar; bitte erst" _
        & " Plausbilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion Datei |fffd|ffnen / speichern"
        Exit Sub
    Else
    End If
    Grundbildschirmsicht
    Sheets("DATEN").Select
    UserForm11.OptionButton1 = False '|fffd|ffnen Explorer
    UserForm11.OptionButton2 = False 'Speichern xls
    UserForm11.OptionButton3 = False 'Speichern xlsm
    UserForm11.CommandButton1.Enabled = False 'Schaltfl|fffd|che ok
    UserForm11.CommandButton2.Enabled = True 'Schaltfl|fffd|che Abbruch
    If Cells(2, 2).Value = 1 Then
        UserForm11.Frame1.Enabled = True ' Frame Explorer f|fffd|r Auswahl Importdatei aktivieren
        UserForm11.OptionButton1.Enabled = True
        UserForm11.Label1.Visible = False
    Else
        UserForm11.Frame1.Enabled = False ' Frame Explorer f|fffd|r Auswahl Importdatei deaktivieren
        UserForm11.OptionButton1.Enabled = False
        UserForm11.Label1.Visible = True
    End If

    flag = GetEnvironmentVariable("AbiesEnv")
    If flag = True Then
    Rem     MsgBox "Variable AbiesEnv ist gesetzt!"
            UserForm11.Frame2.Enabled = False ' Frame 2 f|fffd|r Abies-extern deaktiv
            UserForm11.Frame3.Enabled = True ' Frame 3 f|fffd|r Abies-intern aktiv
            UserForm11.Label2.Visible = False ' Info Abies-intern ausgeblendet
            UserForm11.Label3.Visible = True ' Info Abies-extern eingeblendet
            UserForm11.OptionButton2.Enabled = False
            UserForm11.OptionButton3.Enabled = False
            UserForm11.OptionButton4.Enabled = True ' f|fffd|r Zwischenspeicherung Abies-intern gesetzt
    Else
    Rem     MsgBox "Variable AbiesEnv ist NICHT gesetzt!"
            UserForm11.Frame2.Enabled = True ' Frame 2 f|fffd|r Abies-extern aktiv
            UserForm11.Frame3.Enabled = False ' Frame 3 f|fffd|r Abies-intern deaktiv
            UserForm11.Label2.Visible = True ' Info Abies-intern eingeblendet
            UserForm11.Label3.Visible = False ' Infor Abies-extern ausgeblendet
    Rem     neu V151229 Anfang
            Sheets("DATEN").Unprotect ("mallnitz")
            Sheets("DATEN").Cells(3, 8).Value = 1 ' immer xlsm-Modus
            Sheets("DATEN").Protect ("mallnitz")
    Rem     neu V151229 Ende
            If Cells(3, 8).Value = 1 Then ' Zeile 3 Spalte 8(H), wenn 1 dann vorher als xlsm gepeichert
                UserForm11.OptionButton2.Enabled = False ' Speichern als xls deaktiv
            Else
                UserForm11.OptionButton2.Enabled = True ' Speichern als xls aktiv
            End If
            UserForm11.OptionButton3.Enabled = True
            UserForm11.OptionButton4.Enabled = False
    End If
    UserForm11.Show
End Sub



Sub AbbrechenSchlie|fffd|en()
    Dim flag
    flag = GetEnvironmentVariable("AbiesEnv")
    
    Grundbildschirmsicht
    Sheets("DATEN").Select
    Beep
    
    Rem #(1)# Aktion bei Schaltfl|fffd|che Abbrechen |fffd|ber Schaltfl|fffd|che DATEN - ABBRECHEN ###
    Dim i As Integer
    Sheets("DATEN").Unprotect ("mallnitz")
    If flag = True Then Cells(3, 8).Value = 1 'wenn intern, dann xlsm
    
    Rem #(2)# Deaktivierung Fixierung ###
    Cells(2, 106).Value = 0 'Fixieren Baumart - nein
    Cells(2, 108).Value = 0 'Fixieren GKL - nein
    Cells(2, 109).Value = 0 'Fixieren L|fffd|nge - nein

    
    Rem #(3)# Programmverhalten, wenn keine Datens|fffd|tze vorhanden sind
    Rem #(3)# R|fffd|ckverzweigung in Maske Erfassungsart ausw|fffd|hlen) ###
    If Cells(2, 8).Value = 0 Then '1A Datens|fffd|tze vorhanden - nein
        If Cells(2, 2).Value = 0 Then '1.1A keine Erfassungsart ausgew|fffd|hlt
            UserForm1.OptionButton1 = False '|fffd|bernahme aus Liste
            UserForm1.OptionButton2 = False 'Datenerfassung Mehrfeldeingabe
            UserForm1.OptionButton3 = False 'Datenerfassung Einfeldeingabe
            UserForm1.OptionButton4 = False 'Datenerfassung PNT
        ElseIf Cells(2, 2).Value = 1 Then '1.1B Erfassungsart |fffd|bernahme aus Liste
            UserForm1.OptionButton1 = True
            UserForm1.OptionButton2 = False
            UserForm1.OptionButton3 = False
            UserForm1.OptionButton4 = False
        ElseIf Cells(2, 2).Value = 2 Then '1.1C Erfassungsart Mehrfeldeingabe mit Best|fffd|tigung
            UserForm1.OptionButton1 = False
            UserForm1.OptionButton2 = True
            UserForm1.OptionButton3 = False
            UserForm1.OptionButton4 = False
        ElseIf Cells(2, 2).Value = 4 Then '1.1D Erf.art Mehrfeldeingabe ohne Best|fffd|tigung
            UserForm1.OptionButton1 = False
            UserForm1.OptionButton2 = False
            UserForm1.OptionButton3 = False
            UserForm1.OptionButton4 = True
        Else '1.1E Erfassungsart Einfeldeingabe
            UserForm1.OptionButton1 = False
            UserForm1.OptionButton2 = False
            UserForm1.OptionButton3 = True
            UserForm1.OptionButton4 = False
        End If '1Z
            UserForm1.Label8.Visible = False
            UserForm1.Label9.Visible = False
            UserForm1.Show
            
    Rem #(4)# Programmverhalten, wenn Datens|fffd|tze vorhanden sind ###
    Else '1B
        i = MsgBox("Sollen die |fffd|nderungen gespeichert werden?", vbYesNoCancel + 32, _
        "Sicherheitsabfrage Abbrechen / Schlie|fffd|en")
        If i = 2 Then '1.2A Auswahl Abbruch
        Else '1.2B
            If i = 6 Then '1.2.1A Auswahl Ja
                If Sheets("ABIES").Cells(3, 10).Value = "nein" Then '1.2.1.1A
                    If MsgBox("Daten sind nicht plausibilit|fffd|tsgepr|fffd|ft und k|fffd|nnen" _
                    & " deshalb nicht nach Abies NG NRW importiert werden!" _
                    & " Wollen Sie trotzdem fortsetzen?", vbYesNo + 48 + 256, _
                    "Hinweis Plausibilit|fffd|tsstatus") = vbNo Then '1.2.1.1.1A
                    Exit Sub
                    Else '1.2.1.1.1B
                    End If '1.2.1.1.1Z
                Else '1.2.1.1B
                End If '1.2.1.1Z

                If Sheets("DATEN").Cells(3, 8).Value = 1 Then ' Datei ist im xlsm-Format
                    If Sheets("ABIES").Cells(3, 10).Value = "nein" Then
                        MsgBox ("Dateiimport nach Abies NG nur mit Plausibilit|fffd|tsstatus m|fffd|glich")
                    Else
                        MsgBox ("Dateiimport nach Abies NG m|fffd|glich")
                    End If
                Else
                    MsgBox ("Dateiimport nach Abies NG nur im Format 'xlsm' m|fffd|glich")
                End If

                If flag = True Then Sheets("DATEN").Cells(2, 3).Value = 1
                
                If Sheets("DATEN").Cells(2, 3).Value = 1 Then
                    ActiveWorkbook.Save
                Else
                    MsgBox ("Bitte erst |fffd|ber |fffd|FFNEN / SPEICHERN unter anderem Dateinamen abspeichern")
                    Exit Sub
                End If

            Else '1.2.1B Auswahl Nein
                If MsgBox("Datei wird ohne Speicherung geschlossen!" _
                & " Zwischenzeitliche |fffd|nderungen / Erg|fffd|nzungen gehen verloren!" _
                & " Wollen Sie trotzdem fortsetzen?", vbYesNo + 48, _
                "Sicherheitsabfrage Abbrechen / Schlie|fffd|en") = vbNo Then
                Exit Sub
                Else
                End If
            End If '1.2.1Z

            Application.DisplayAlerts = False 'R|fffd|ckfrage unterdr|fffd|cken
            Application.DisplayFormulaBar = True
            ActiveWorkbook.Close
        End If '1.2Z
    End If '1Z
End Sub



Sub Zuruecksetzen()
Attribute Zuruecksetzen.VB_ProcData.VB_Invoke_Func = "z\n14"
    Rem #(S)# internes Makro zum Zur|fffd|cksetzen der Datei datenseitig auf Ausgangszustand ###
    Dim frm As UserForm
        Set frm = UserForm17
        frm.TextBox1.PasswordChar = "*" 'Textfeld Passwort
        frm.TextBox1.SetFocus
        frm.Label2.Visible = False 'Passwort falsch!
        UserForm17.Show
End Sub



Sub MaskeDatenErfassen|fffd|ffnen()
Attribute MaskeDatenErfassen|fffd|ffnen.VB_ProcData.VB_Invoke_Func = "d\n14"
    Rem #(S)# |fffd|ffnen der jeweiligen Hilfsmaske nach Erfassungsart |fffd|ber Schaltfl|fffd|che
    Rem #(S)# DATEN - DATEN ERFASSEN ###
    Dim i As Integer
    Dim z As Integer
    Grundbildschirmsicht
    Sheets("DATEN").Select
    Sheets("DATEN").Unprotect ("mallnitz")
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    
    Sheets("DATEN").Select
    z = Cells(2, 115)
    If Cells(4, 8).Value = 1 Then
        MsgBox "Funktion Daten erfassen w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;" _
        & " bitte erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion Daten erfassen"
        Exit Sub
    ElseIf Cells(2, 2).Value = 0 Then
        MsgBox "Kein Erfassungsverfahren ausgew|fffd|hlt - Datenerfassung nicht m|fffd|glich!", 48, _
        "Funktion Daten erfassen"
        Exit Sub
    Else
    End If
    
    Rem #(1)# Pr|fffd|fschleife, ob letzter Datensatz plausibel ###
    If Cells(z, 12).Value <> -1 And Cells(2, 115).Value <> 6 = True Then '1A
        Application.ScreenUpdating = True
        MsgBox "letzter Datensatz nicht plausibel! Vor weiterer Erfassung Korrektur" _
        & " erforderlich!", 16, "Funktion Daten erfassen"
        Exit Sub
    Else '1B
    End If '1Z
    Rows("7:506").Hidden = True

    For i = 7 To Cells(2, 4) + 0 '4 - letzte Datenzeile
        Rows(i).Hidden = False
        Next i
    Application.ScreenUpdating = True
    
    Rem ##### Verfahren |fffd|bernahme aus Liste ###
    If Cells(2, 2).Value = 1 Then '2A
        MsgBox "Das gew|fffd|hlte Erfassungsverfahren dient vorrangig der |fffd|bernahme" _
        & " von Daten aus Kopiervorlagen; eine (manuelle) Erfassung ist nur" _
        & " im Tabellenbereich 'Kerndaten' m|fffd|glich", 64, "Funktion Daten erfassen"
        Rows("7:506").Hidden = False
    Else '2B
        Application.Calculation = xlCalculationAutomatic
        
    Rem #(2)# Verfahren Mehrfeldeingabe mit Eingabebest|fffd|tigung ###
        If Cells(2, 2).Value = 2 Then '2.1A
            If Cells(2, 106).Value = 1 Then 'Baumart fixiert - ja '2.1.1A
                UserForm4.CheckBox4.Value = True 'Baumart angehakt
                UserForm4.TextBox1.Enabled = False 'Textfeld Baumart ausgegraut
            Else '2.1.1B
                UserForm4.CheckBox4.Value = False
                UserForm4.TextBox1.Enabled = True
            End If '2.1.1Z
            If Cells(2, 108).Value = 1 Then 'GKL fixiert - ja '2.1.2A
                UserForm4.CheckBox5.Value = True 'GKL angehakt
                UserForm4.TextBox4.Enabled = False 'Textfeld GKL ausgegraut
            Else '2.1.2B
                UserForm4.CheckBox5.Value = False
                UserForm4.TextBox4.Enabled = True
            End If '2.1.2Z
            If Cells(2, 109).Value = 1 Then 'L|fffd|nge fixiert - ja '2.1.3A
                UserForm4.CheckBox6.Value = True 'L|fffd|nge angehakt
                UserForm4.TextBox5.Enabled = False 'Textfeld L|fffd|nge ausgegraut
            Else '2.1.3B
                UserForm4.CheckBox6.Value = False
                UserForm4.TextBox5.Enabled = True
            End If '2.1.3Z
            If Cells(2, 115).Value = 6 Then '2.1.4A noch keine Daten vorher erfasst
                UserForm4.TextBox1.Value = ""
                UserForm4.TextBox2.Value = ""
                UserForm4.TextBox3.Value = ""
                UserForm4.TextBox4.Value = ""
                UserForm4.TextBox5.Value = ""
                UserForm4.TextBox6.Value = ""
                UserForm4.TextBox1.SetFocus
            Else '2.1.4B
                UserForm4.TextBox1.Value = Cells(z, 134).Value 'letzte Baumart |fffd|bernehmen
                If Cells(z, 116).Value = 1 Then ''2.1.4.1A Klammerstamm - ja
                    UserForm4.TextBox2.Value = Cells(z, 107).Value 'letzte Holznr |fffd|bernehmen
                    UserForm4.TextBox4.Value = "" 'GKL leeren
                Else '2.1.4.1B
                    UserForm4.TextBox2.Value = Cells(z, 107).Value + 1 'letzte Holznummer +1
                    UserForm4.TextBox4.Value = Cells(z, 154).Value 'letzte GKL |fffd|bernehmen
                End If '2.1.4.1Z
                UserForm4.TextBox3.Value = Cells(z, 111).Value 'Klammerstammkz |fffd|bernehmen
                UserForm4.TextBox5.Value = Cells(z, 109).Value 'L|fffd|nge |fffd|bernehmen
                UserForm4.TextBox5.Value = Format(UserForm4.TextBox5.Value, "#0.00")
            End If '2.1.4Z
            If Cells(2, 106).Value = 1 Then 'Baumart fixiert - ja '2.1.5A
                If Cells(2, 108).Value = 1 Then '2.1.5.1A GKL fixiert - ja
                    If Cells(2, 109).Value = 1 Then '2.1.5.1.1A L|fffd|nge fixiert - ja
                        UserForm4.TextBox6.SetFocus 'Fokus auf MDM
                    Else '2.1.5.1.1B
                        UserForm4.TextBox5.SelStart = 0
                        UserForm4.TextBox5.SelLength = Len(UserForm4.TextBox5.Text)
                        UserForm4.TextBox5.SetFocus 'Fokus auf L|fffd|nge
                    End If '2.1.5.1.1Z
                Else '2.1.5.1B
                    UserForm4.TextBox4.SelStart = 0
                    UserForm4.TextBox4.SelLength = Len(UserForm4.TextBox4.Text)
                    UserForm4.TextBox4.SetFocus 'Fokus auf GKL
                End If '2.1.5.1Z
            Else '2.1.5B
                UserForm4.TextBox1.SelStart = 0
                UserForm4.TextBox1.SelLength = Len(UserForm4.TextBox1.Text)
                UserForm4.TextBox1.SetFocus 'Fokus auf Baumart
            End If '2.1.5Z
            UserForm4.Label9.Caption = Cells(z + 1, 2).Value 'lfd Nr Folgezeile
            UserForm4.Label11.Visible = False 'Fehlermeldung Baumart ausblenden
            UserForm4.Label12.Visible = False 'Fehlermeldung HNR ausblenden
            UserForm4.Label13.Visible = False 'Fehlermeldung GKL ausblenden
            UserForm4.Label14.Visible = False 'Fehlermeldung L|fffd|nge ausblenden
            UserForm4.Label15.Visible = False 'Fehlermeldung MDM ausblenden
            UserForm4.Show
            
        ElseIf Cells(2, 2).Value = 5 Then '2.1B
        
        Rem #(3)# Verfahren Einfeldeingabe ###
            Cells(2, 106).Value = 1 'Fixierung Baumart - ja
            Cells(2, 108).Value = 1 'Fixierung GKL - ja
            z = Cells(2, 115).Value
            UserForm5.CheckBox4.Value = True 'Fixierung Baumart angehakt
            UserForm5.CheckBox4.Enabled = True
            UserForm5.CheckBox5.Value = True 'Fixierung GKL angehakt
            UserForm5.TextBox5.Value = ""
            If Cells(2, 115).Value = 6 Then '2.1.1A
                UserForm5.TextBox1.Value = ""
                UserForm5.TextBox2.Value = ""
                UserForm5.TextBox4.Value = ""
            Else '2.1.1B
                UserForm5.TextBox1.Value = Cells(z, 134).Value '|fffd|bernahme Baumart
                If Cells(z, 116).Value = 1 Then '2.1.1.1A Klammerstamm - ja
                    UserForm5.TextBox2.Value = Cells(z, 107).Value '|fffd|bernahme HNR
                    UserForm5.TextBox4.Value = "" 'GKL leer
                Else '2.1.1.1B
                    UserForm5.TextBox2.Value = Cells(z, 107).Value + 1 'HNR+1
                    UserForm5.TextBox4.Value = Cells(z, 154).Value '|fffd|bernahme GKL
                End If '2.1.1.1Z
            End If '2.1.1Z
            If UserForm5.TextBox1.Value = "" Then '2.1.2A Baumart leer
                UserForm5.TextBox1.Enabled = True
            Else '2.1.2B
                UserForm5.TextBox1.Enabled = True
            End If '2.1.2Z
            If UserForm5.TextBox4.Value = "" Then '2.1.3A GKL leer
                UserForm5.TextBox4.Enabled = True
            Else '2.1.3B
                UserForm5.TextBox4.Enabled = True
            End If '2.1.3Z
            UserForm5.Label9.Caption = Cells(z + 1, 2).Value 'Z|fffd|hler lfdNR
            UserForm5.Label11.Visible = False 'Fehlermeldung Baumart ausblenden
            UserForm5.Label12.Visible = False 'Fehlermeldung HNR ausblenden
            UserForm5.Label13.Visible = False 'Fehlermeldung GKL ausblenden
            UserForm5.Label14.Visible = False 'Fehlermeldung L|fffd|nge/MDM ausblenden

            UserForm5.CommandButton3.Enabled = False
            UserForm5.CommandButton3.Visible = False
            If z = 6 Then '2.1.5A
                UserForm5.TextBox1.SetFocus 'Fokus auf Baumart
            Else '2.1.5B
                UserForm5.TextBox5.SetFocus 'Fokus auf L|fffd|nge/MDM
            End If '2.1.5Z
            UserForm5.Show
        Else '2.1C
        
        Rem #(4)# Verfahren Mehrfeldeingabe ohne Eingabebest|fffd|tigung ###
            z = Cells(2, 115).Value
            Cells(2, 106).Value = 1 'Fixierung Baumart - ja
            UserForm6.CheckBox4.Value = True
            UserForm6.CheckBox4.Enabled = False
            If Cells(2, 108).Value = 1 Then '2.1.1A Fixierung GKL - ja
                UserForm6.CheckBox5.Value = True
                UserForm6.TextBox4.Enabled = False
            Else '2.1.1B
                UserForm6.CheckBox5.Value = False
                UserForm6.TextBox4.Enabled = True
            End If '2.1.1Z
            If Cells(2, 109).Value = 1 Then '2.1.2A Fixierung L|fffd|nge - ja
                UserForm6.CheckBox6.Value = True
                UserForm6.TextBox5.Enabled = False
            Else '2.1.2B
                UserForm6.CheckBox6.Value = False
                UserForm6.TextBox5.Enabled = True
            End If '2.1.2Z
            If Cells(2, 115).Value = 6 Then '2.1.3A
                UserForm6.TextBox1.Value = ""
                UserForm6.TextBox2.Value = ""
                UserForm6.TextBox4.Value = ""
            Else '2.1.3B
                UserForm6.TextBox1.Value = Cells(z, 134).Value '|fffd|bernahme Baumart
                If Cells(z, 116).Value = 1 Then '2.1.3.1A Klammerstamm - ja
                    UserForm6.TextBox2.Value = Cells(z, 107).Value '|fffd|bernahme HNR
                    UserForm6.TextBox4.Enabled = True 'GKL entsperrt und leer
                    UserForm6.TextBox4.Value = ""
                Else '2.1.3.1B
                    UserForm6.TextBox2.Value = Cells(z, 107).Value + 1 'HNR+1
                    UserForm6.TextBox4.Value = Cells(z, 192).Value '|fffd|bernahme Ziffer GKL
                End If '2.1.3.1Z
            End If '2.1.3Z
            UserForm6.Label9.Caption = Cells(z + 1, 2).Value
            UserForm6.Label11.Visible = False 'Fehlermeldung ausblenden
            UserForm6.Label12.Visible = False
            UserForm6.Label13.Visible = False
            UserForm6.Label14.Visible = False
            UserForm6.Label15.Visible = False
            UserForm6.TextBox1.SetFocus
            UserForm6.Show
        End If '2.1Z
    End If '2Z
    Application.Calculation = xlCalculationAutomatic
End Sub



Sub HilfsspaltenAusblenden()
Attribute HilfsspaltenAusblenden.VB_ProcData.VB_Invoke_Func = "x\n14"
    Rem (S) internes Makro zum Zur|fffd|cksetzen (Ausblenden) s|fffd|mtlicher Hilfsspalten in DATEN ###
    Dim frm As UserForm
        Set frm = UserForm16
        frm.TextBox1.PasswordChar = "*" 'Textfeld Passwort
        frm.TextBox1.SetFocus
        frm.Label2.Visible = False 'Passwort falsch!
        UserForm16.Show
End Sub



Sub DatenblattAbiesEinblenden()
Attribute DatenblattAbiesEinblenden.VB_ProcData.VB_Invoke_Func = "a\n14"
    Rem (S) internes Makro zum Einblenden des Datenblattes ABIES ###
    Dim frm As UserForm
        Set frm = UserForm15
        frm.TextBox1.PasswordChar = "*" 'Textfeld Passwort
        frm.TextBox1.SetFocus
        frm.Label2.Visible = False 'Passwort falsch!
        UserForm15.Show
End Sub



Sub MaskeSortieren|fffd|ffnen()
    Rem (S) |fffd|ffnen Userform7 Hilfsmaske Daten sortieren |fffd|ber Schaltlf|fffd|che DATEN - SORTIEREN ###
    Grundbildschirmsicht
    Sheets("DATEN").Select
    UserForm7.OptionButton1 = False
    UserForm7.OptionButton2 = False
    UserForm7.OptionButton3 = False
    UserForm7.OptionButton4 = False
    UserForm7.OptionButton5 = False
    UserForm7.CommandButton1.Enabled = False
    UserForm7.CommandButton2.Enabled = True
    If Cells(4, 8).Value = 1 Then
        MsgBox "Funktion Sortieren w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;" _
        & " bitte erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion Sortieren"
    ElseIf Cells(2, 4).Value < 7 Then '1A wenn keine Datens|fffd|tze vorh., dann Abbr Sortierung
        MsgBox "Keine Datens|fffd|tze vorhanden - Sortierung nicht m|fffd|glich!", 48, _
        "Funktion Sortieren"
    Else '1B sonst (d.h. Datens|fffd|tze vorhanden)
        UserForm7.Show
    End If '1Z Ende Sortierung ja/nein in Abh|fffd|ngigkeit vorhandener Datens|fffd|tze
End Sub



Sub UebersichtKubatur()
    Rem (S) Herleitung Kubaturwerte und |fffd|ffnen Userform10 |fffd|bersicht Kubatur nach BA und GKL ###
    Dim i%
    Dim z%
    Grundbildschirmsicht
    Sheets("DATEN").Select
    
    Application.ScreenUpdating = False
    If Sheets("DATEN").Cells(4, 8).Value = 1 Then 'Flag lfd Plausipr|fffd|fung
        MsgBox "Anzeige Kubatur w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich; bitte" _
        & " erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion |fffd|bersicht Kubatur"
    ElseIf Sheets("ABIES").Cells(3, 10).Value = "ja" Then '1A Plausibilit|fffd|t = ja, dann
        Sheets("SD").Visible = True
        Sheets("SD").Select
        Sheets("SD").Unprotect ("mallnitz")
        z = 3
        For i = 3 To 112
            If Cells(i, 109).Value = 0 Then '1.1A
            Else '1.1B
                Cells(z, 125).Value = Cells(i, 102).Value
                If Cells(i, 103).Value = 0 Then Cells(z, 128).Value = "" _
                Else Cells(z, 128).Value = Cells(i, 103).Value
                If Cells(i, 104).Value = 0 Then Cells(z, 129).Value = "" _
                Else Cells(z, 129).Value = Cells(i, 104).Value
                If Cells(i, 105).Value = 0 Then Cells(z, 130).Value = "" _
                Else Cells(z, 130).Value = Cells(i, 105).Value
                If Cells(i, 106).Value = 0 Then Cells(z, 131).Value = "" _
                Else Cells(z, 131).Value = Cells(i, 106).Value
                If Cells(i, 107).Value = 0 Then Cells(z, 132).Value = "" _
                Else Cells(z, 132).Value = Cells(i, 107).Value
                If Cells(i, 108).Value = 0 Then Cells(z, 133).Value = "" _
                Else Cells(z, 133).Value = Cells(i, 108).Value
                Cells(z, 134).Value = Cells(i, 109).Value
                z = z + 1
            End If '1.1Z
            Next i
        Cells(1, 134).Value = z
        With UserForm10.ListBox1
            .ColumnCount = 11
            .ColumnHeads = True
            .RowSource = "SD!DU3:EE" & z
            .ColumnWidths = "0cm;1,2cm;4,5cm;1,7cm;1,7cm;1,7cm;1,7cm;1,7cm;1,7cm;1,9cm;1cm"
        '    .MatchRequired = True
        End With
        UserForm10.Label1.Caption = Format(Cells(1, 109).Value, "#,##0.00")
        If Cells(1, 103).Value = 0 Then '1.2A
            UserForm10.Label3.Visible = False
        Else '1.2B
            UserForm10.Label3.Visible = True
            UserForm10.Label3.Caption = Format(Cells(1, 103).Value, "#,##0.00")
        End If '1.2Z
        If Cells(1, 104).Value = 0 Then '1.3A
            UserForm10.Label4.Visible = False
        Else '1.3B
            UserForm10.Label4.Visible = True
            UserForm10.Label4.Caption = Format(Cells(1, 104).Value, "#,##0.00")
        End If '1.3Z
        If Cells(1, 105).Value = 0 Then '1.4A
            UserForm10.Label5.Visible = False
        Else '1.4B
            UserForm10.Label5.Visible = True
            UserForm10.Label5.Caption = Format(Cells(1, 105).Value, "#,##0.00")
        End If '1.4Z
        If Cells(1, 106).Value = 0 Then '1.5A
            UserForm10.Label6.Visible = False
        Else '1.5B
            UserForm10.Label6.Visible = True
            UserForm10.Label6.Caption = Format(Cells(1, 106).Value, "#,##0.00")
        End If '1.5Z
        If Cells(1, 107).Value = 0 Then '1.6A
            UserForm10.Label7.Visible = False
        Else '1.6B
            UserForm10.Label7.Visible = True
            UserForm10.Label7.Caption = Format(Cells(1, 107).Value, "#,##0.00")
        End If '1.6Z
        If Cells(1, 108).Value = 0 Then '1.7A
            UserForm10.Label8.Visible = False
        Else '1.7B
            UserForm10.Label8.Visible = True
            UserForm10.Label8.Caption = Format(Cells(1, 108).Value, "#,##0.00")
        End If '1.7Z
        Sheets("SD").Protect ("mallnitz")
        Sheets("SD").Visible = False
        Sheets("DATEN").Select
        Application.ScreenUpdating = True
        UserForm10.Show
    Else '1B sonst (Plausibilit|fffd|t = nein)
        MsgBox "Bitte erst Plausibilit|fffd|tskontrolle durchf|fffd|hren!", 64, _
        "Funktion |fffd|bersicht Kubatur"
    End If '1Z
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
End Sub



Sub DatensatzKopierenL|fffd|schen()
    Sheets("DATEN").Select
    Grundbildschirmsicht
    Sheets("DATEN").Unprotect ("mallnitz")
    
    Dim dz As Integer 'dz maximale Datenzeilen
    dz = Cells(3, 4).Value
    If Cells(2, 4).Value < 7 Then
        MsgBox "Datei enth|fffd|lt keine Datens|fffd|tze - Kopier/L|fffd|schfunktion nicht m|fffd|glich!", 64, _
        "Funktion Kopieren / L|fffd|schen"
    ElseIf Cells(4, 8).Value = 1 Then
        MsgBox "Funktion Kopieren / L|fffd|schen w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;" _
        & " bitte erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion Datens|fffd|tze kopieren / l|fffd|schen"
    Else
        MsgBox "nachfolgende Funktion |fffd|ndert unwiderruflich Datenstruktur und" _
        & " sollte nur in Ausnahmef|fffd|llen (z.B. nachtr|fffd|gliche |fffd|nderung von / in Klammerst|fffd|mme)" _
        & " genutzt werden", 48, "Funktion Kopieren / L|fffd|schen"
        Sheets("DATEN").Unprotect ("mallnitz")
        Range("C7:IL" & dz).Select
        Selection.Sort Key1:=Range("U7"), Order1:=xlAscending, Key2:=Range("R7") _
        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
        False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
        :=xlSortNormal 'Herstellung der urspr|fffd|nglichen Datensatzreihenfolge
        Cells(7, 27).Select
        Sheets("DATEN").Protect ("mallnitz")
        UserForm12.TextBox1.Value = ""
        UserForm12.TextBox1.Enabled = True 'Textfeld Nr. Datensatzzeile
        UserForm12.Label3.Visible = False 'ung|fffd|ltige Datenzeilennummer
        UserForm12.Label4.Visible = False 'Warntext Kopieren/L|fffd|schen
        UserForm12.CommandButton1.Enabled = False 'Schaltfl|fffd|che ok
        UserForm12.CommandButton2.Enabled = True 'Schaltfl|fffd|che Abbruch
        UserForm12.CommandButton3.Visible = False 'Schaltfl|fffd|che Kopieren/L|fffd|schen Abbruch
        UserForm12.CommandButton4.Visible = False 'Schaltfl|fffd|che Kopieren/L|fffd|schen Fortfahren
        UserForm12.OptionButton1 = False 'Optionsschaltfl|fffd|che Kopieren zur|fffd|cksetzen
        UserForm12.OptionButton2 = False 'Optionsschaltfl|fffd|che L|fffd|schen zur|fffd|cksetzen
        UserForm12.OptionButton1.Enabled = False 'Optionsschaltfl|fffd|che Kopieren
        UserForm12.OptionButton2.Enabled = False 'Optionsschaltfl|fffd|che L|fffd|schen
        UserForm12.Show
    End If
End Sub



Sub Seitenansicht()
    Dim dzmax As Integer
    dzmax = Cells(2, 4).Value
    If dzmax < 7 Or Cells(2, 2).Value = 0 = True Then
        MsgBox "Keine Daten erfasst! - Seitenansicht nicht aktiv", 64, "Funktion Seitenansicht"
    ElseIf Cells(4, 8).Value = 1 Then
        MsgBox "Funktion Seitenansicht w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;  bitte" _
        & " erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, "Funktion Seitenansicht"
    Else
        UserForm13.CommandButton1.Enabled = False
        UserForm13.CommandButton2.Enabled = True
        UserForm13.OptionButton1.Value = False
        UserForm13.OptionButton2.Value = False
        UserForm13.Show
    End If
End Sub



Sub KerndatenEinblenden()
    If Sheets("DATEN").Cells(4, 8).Value = 1 Then
        MsgBox "Funktion Kerndaten einblenden w|fffd|hrend lfd. Plausipr|fffd|fung nicht m|fffd|glich;  bitte" _
        & " erst Plausibilit|fffd|tspr|fffd|fung abschlie|fffd|en oder abbrechen", 48, _
        "Funktion Kerndaten einblenden"
    Else
    Grundbildschirmsicht
    End If
End Sub



Sub Grundbildschirmsicht()
    Rem #1# Ausblenden von Men|fffd|leisten u.a. ###
        Application.CommandBars(1).Enabled = False 'Men|fffd|leiste ausblenden
        Application.CommandBars("Standard").Visible = False 'Symbolleiste Standard ausblenden
        Application.CommandBars("Formatting").Visible = False 'Symbolleiste Format ausblenden
        With ActiveWindow
        .DisplayHeadings = False 'Ausblenden Zeilen- und Spaltenk|fffd|pfe
        .DisplayWorkbookTabs = False 'Ausblenden Registerlaschen
        End With
        '
        With Application
        .DisplayStatusBar = False 'Ausblenden Statusleiste (unterhalb Registerleiste)
        .DisplayFormulaBar = False 'Ausblenden Bearbeitungsleiste (unterhalb Symbolleiste)
        End With
    
    Sheets("DATEN").Select
    Sheets("DATEN").Unprotect ("mallnitz")
    ActiveSheet.PageSetup.PrintArea = ""
    ActiveSheet.DisplayAutomaticPageBreaks = False
    Columns("HA:HD").Hidden = False
    If Cells(2, 2).Value = 0 Then
        Columns("AA:HD").Hidden = True
    Else
        Columns("AA:AG").Hidden = False
        Columns("AH:AI").Hidden = True
        Columns("HA:HD").Hidden = False
        If Cells(2, 2).Value = 1 Then
            Columns("CA:CF").Hidden = False
        ElseIf Cells(2, 2).Value = 5 Then
        Columns("DA:DD").Hidden = False
        Columns("DH:DI").Hidden = False
        Else
        Columns("DA:DG").Hidden = False
        End If
    End If
    Sheets("DATEN").Protect ("mallnitz")
End Sub



Sub ProgrammInternLeerStarten()
    Sheets("DATEN").Unprotect ("mallnitz")
    Columns("IJ:IK").Hidden = False
    UserForm1.Show
    Sheets("DATEN").Protect ("mallnitz")
End Sub



Sub ProgrammNachStartAbbrechen()
    Application.DisplayAlerts = False 'R|fffd|ckfrage unterdr|fffd|cken
    ActiveWorkbook.Close
End Sub



Sub SymbolFormatleistenEinblenden()
Attribute SymbolFormatleistenEinblenden.VB_ProcData.VB_Invoke_Func = "f\n14"
    Rem (S) internes Makro zum Einblenden der Symbol- und Formatleisten ###
    Dim frm As UserForm
        Set frm = UserForm18
        frm.TextBox1.PasswordChar = "*" 'Textfeld Passwort
        frm.TextBox1.SetFocus
        frm.Label2.Visible = False 'Passwort falsch!
        UserForm18.Show
End Sub
Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True





Attribute VB_Name = "Tabelle6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{D172EFC3-E237-4EEA-97FC-011D675CB015}{D0E4B906-725F-49F4-838F-8004CADDD1B2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ComboBox1_Click()
Rem ### Kalamit|fffd|t - |fffd|bernahme (Default)Wert aus Zelle AC5 ###
Sheets("DATEN").Cells(6, 29).Value = ComboBox1.Value
End Sub

Private Sub ComboBox2_Click()
Rem ### Schadholz - |fffd|bernahme (Default)Wert aus Zelle AD5 ###
Sheets("DATEN").Cells(6, 30).Value = ComboBox2.Value
End Sub

Private Sub ComboBox3_Click()
Rem ### Zugangsart - |fffd|bernahme (Default)Wert aus Zelle AE5 ###
Sheets("DATEN").Cells(6, 31).Value = ComboBox3.Value
End Sub

Private Sub ComboBox4_Click()
Rem ### Rindenmessung - |fffd|bernahme (Default)Wert aus Zelle AF5 ###
Sheets("DATEN").Cells(6, 32).Value = ComboBox4.Value
End Sub

Private Sub ComboBox5_Click()
Rem ### Farbe - |fffd|bernahme (Default)Wert aus Zelle AG5 ###
Sheets("DATEN").Cells(6, 33).Value = ComboBox5.Value
End Sub

Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che OK ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
Columns("C:HZ").Hidden = True
If Cells(2, 2).Value = 0 Then '1A wenn kein Erfassungsverfahren ausgew|fffd|hlt, dann
    MsgBox "Erfassungsverfahren ausw|fffd|hlen!", 48, "Funktion Erfasssungsverfahren / Grunddaten"
    Columns("IA:II").Hidden = True 'gr|fffd|ner Bereich
Else '1B sonst (d.h. Erfassungsverfahren war ausgew|fffd|hlt)
    Columns("B:B").Hidden = False 'Datensatzzeile
    Columns("AA:AG").Hidden = False 'Erfassungsbereich Grunddaten
    Columns("HA:HD").Hidden = False 'Erfassungsbereich Zusatzdaten
    Columns("IA:IK").Hidden = False 'gr|fffd|ner Bereich und Grauspalten
    Rows("512").Hidden = True 'Kopiervorlage
'    Cells(6, 27).Value = Cells(7, 27).Value '|fffd|bernahme Basisgrunddaten als Kopiervorlage
'    Cells(6, 28).Value = Cells(7, 28).Value
'    Cells(6, 29).Value = Cells(7, 29).Value
'    Cells(6, 30).Value = Cells(7, 30).Value
'    Cells(6, 31).Value = Cells(7, 31).Value
'    Cells(6, 32).Value = Cells(7, 32).Value
'    Cells(6, 33).Value = Cells(7, 33).Value
    If Cells(2, 2).Value = 1 Then '1B.1A Erfassungsverfahren |fffd|bernahme aus Liste, dann
        Columns("CA:CF").Hidden = False 'Erfassungsbereich Kerndaten aus Liste einblenden
        Rows("7:506").Hidden = False 'Datenbereich einblenden
        Cells(7, 27).Value = Cells(6, 27).Value
        Cells(7, 28).Value = Cells(6, 28).Value
        Cells(7, 29).Value = Cells(6, 29).Value
        Cells(7, 30).Value = Cells(6, 30).Value
        Cells(7, 31).Value = Cells(6, 31).Value
        Cells(7, 32).Value = Cells(6, 32).Value
        Cells(7, 33).Value = Cells(6, 33).Value
        Application.ScreenUpdating = True
        Cells(7, 80).Select
    Else '1B.1B sonst (d.h. Erfassungsverfahren |fffd|ber Hilfsmaske
        Range("AA7:AG7").Select 'Erfassungsbereich Grunddaten l|fffd|schen
        Selection.ClearContents
        Columns("DA:DI").Hidden = False 'Erfassungsbereich Kerndaten aus Masken einblenden
        Rows("7:506").Hidden = True 'alle Datenzeilen ausblenden
        If Cells(2, 2).Value = 5 Then '1B.1B.1A wenn Erfassungsverfahren Einfeldeingabe, dann
            Columns("DE:DG").Hidden = True 'Sp Klammerstamm, L|fffd|nge, Mittendurchm ausblenden
        Else '1B.1B.1B sonst (d.h. Mehrfelderfassung)
            Columns("DH:DI").Hidden = True 'Spalten L|fffd|nge/MDM, MDM>1m ausblenden
        End If '1b.1B.1Z
        Application.ScreenUpdating = True
        Cells(4, 27).Select
    End If '1B.1Z
    UserForm1.Hide
    Unload Me
End If '1Z
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Abbruch ###
Beep
If MsgBox("Datei ohne Speicherung schlie|fffd|en?", vbOKCancel + 32 + 256, _
"Sicherheitsabfrage Abbrechen") = vbOK Then '256 Abbrechen Standard
        Application.DisplayAlerts = False 'R|fffd|ckfrage unterdr|fffd|cken
        With Application
        '.DisplayAlerts = True
        .DisplayStatusBar = True
        .DisplayFormulaBar = True
        End With
        'Application.Quit 'Excel schlie|fffd|en
        ActiveWorkbook.Close
    Else
    End If
End Sub

Private Sub OptionButton1_Click()
Rem ### |fffd|bernahme aus Liste ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm1.OptionButton1.Value = True Then
    UserForm1.OptionButton2.Value = False
    UserForm1.OptionButton3.Value = False
    UserForm1.OptionButton4.Value = False
    Cells(2, 2).Value = 1
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton2_Click()
Rem ### Mehrfelderfassung mit Eingabebest|fffd|tigung ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm1.OptionButton2.Value = True Then
    UserForm1.OptionButton1.Value = False
    UserForm1.OptionButton3.Value = False
    UserForm1.OptionButton4.Value = False
    Cells(2, 2).Value = 2
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton3_Click()
Rem ### Einfelderfassung ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm1.OptionButton3.Value = True Then
    UserForm1.OptionButton1.Value = False
    UserForm1.OptionButton2.Value = False
    UserForm1.OptionButton4.Value = False
    Cells(2, 2).Value = 5
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton4_Click()
Rem ### Mehrfelderfassung ohne Eingabebest|fffd|tigung ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm1.OptionButton4.Value = True Then
    UserForm1.OptionButton1.Value = False
    UserForm1.OptionButton2.Value = False
    UserForm1.OptionButton3.Value = False
    Cells(2, 2).Value = 4
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub TextBox1_Change()
Rem ### Losnummer - |fffd|bernahme (Default)Wert aus Zelle AA5 ###
Sheets("DATEN").Cells(6, 27).Value = TextBox1.Value
Application.Calculation = xlCalculationAutomatic
If Cells(7, 39).Value < 9 Or TextBox1.Value = "" = True Then
    Label8.Visible = True
    TextBox1.Value = ""
    TextBox1.BackColor = vbYellow
    Cancel = True
    TextBox1.SetFocus
    Else
    Label8.Visible = False
    TextBox1.BackColor = vbWhite
    End If
End Sub

Private Sub TextBox2_Change()
Rem ### Rotte - |fffd|bernahme (Default)Wert aus Zelle AB5 ###
Sheets("DATEN").Cells(6, 28).Value = TextBox2.Value
Application.Calculation = xlCalculationAutomatic
If Cells(7, 43).Value < 9 Then
    Label9.Visible = True
    'TextBox2.Value = ""
    TextBox2.BackColor = vbYellow
    'Cancel = True
    TextBox2.SetFocus
    Else
    Label9.Visible = False
    TextBox2.BackColor = vbWhite
    End If
End Sub

Private Sub userform_initialize()
UserForm1.TextBox1.Value = Sheets("DATEN").Cells(6, 27).Value 'Losnummer
UserForm1.ComboBox1.Value = Sheets("DATEN").Cells(6, 29).Value 'Kalamit|fffd|tskennzeichen
With ComboBox1
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!A3:B11"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
UserForm1.ComboBox2.Value = Sheets("DATEN").Cells(6, 30).Value 'Schadholzkennzeichen
With ComboBox2
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!G3:H7"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
UserForm1.ComboBox3.Value = Sheets("DATEN").Cells(6, 31).Value 'Zugangsart
With ComboBox3
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!N3:O4"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
UserForm1.TextBox2.Value = Sheets("DATEN").Cells(6, 28).Value 'Rotte
UserForm1.ComboBox4.Value = Sheets("DATEN").Cells(6, 32).Value 'Kennzeichen Rindenmessung
With ComboBox4
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!T3:U5"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
UserForm1.ComboBox5.Value = Sheets("DATEN").Cells(6, 33).Value 'Farbe
With ComboBox5
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!Z3:AA11"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
UserForm1.OptionButton1 = False '|fffd|bernahme aus Liste
UserForm1.OptionButton2 = False 'Mehrfeldeingabe mit Eingabebest|fffd|tigung
UserForm1.OptionButton3 = False 'Einfeldeingabe
UserForm1.OptionButton4 = False 'Mehrfeldeingabe ohne Eingabebest|fffd|tigung

Select Case Cells(2, 2).Value 'Zellenwert Erfassungsverfahren
Case 1: UserForm1.OptionButton1 = True
Case 2: UserForm1.OptionButton2 = True
Case 4: UserForm1.OptionButton4 = True
Case 5: UserForm1.OptionButton3 = True
End Select
End Sub
Attribute VB_Name = "UserForm10"
Attribute VB_Base = "0{BBC918E7-A63D-4034-AD55-A03AA520A636}{50DA986E-6A01-4EC3-8BB7-5001911814B3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che zur|fffd|ck zum Datenblatt ###

UserForm10.Hide
Unload Me
Application.ScreenUpdating = False
Application.Calculation = xlCalculationManual
Sheets("SD").Visible = True
Sheets("SD").Select
Sheets("SD").Unprotect ("mallnitz")
    For i = 3 To Cells(1, 134).Value + 1
        Cells(i, 125).Value = ""
        Cells(i, 128).Value = ""
        Cells(i, 129).Value = ""
        Cells(i, 130).Value = ""
        Cells(i, 131).Value = ""
        Cells(i, 132).Value = ""
        Cells(i, 133).Value = ""
        Cells(i, 134).Value = ""
        Next i
Application.Calculation = xlCalculationAutomatic

Sheets("SD").Protect ("mallnitz")
Sheets("SD").Visible = False
Application.ScreenUpdating = True
Sheets("DATEN").Select
End Sub

Private Sub ListBox1_Click()

End Sub
Attribute VB_Name = "UserForm11"
Attribute VB_Base = "0{06E16CC5-DD20-406C-813E-4946B0C27ABF}{517B67A3-6BD7-4C91-8BC8-D7C2E4C2DD9C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che OK ###
UserForm11.Hide
Unload Me
If OptionButton1.Value = True Then '1A Explorer |fffd|ffnen
    Application.Dialogs(xlDialogOpen).Show
Else '1B
    If OptionButton4.Value = True Then
        Sheets("DATEN").Unprotect ("mallnitz")
        Sheets("DATEN").Cells(3, 8).Value = 1 ' Zeile 3 Spalte 8(H) = 1 f|fffd|r Format xlsm
        Sheets("DATEN").Protect ("mallnitz")
        ActiveWorkbook.Save ' ## Variante unter 130405A03
        ' ActiveWorkbook.SaveAs dateiname, FileFormat:=52  ' ## Neu 150413A03
        
    ElseIf OptionButton2.Value = True Then '1.1A als xls speichern
        ' Neu in 150413A03 Anfang
        If MsgBox("Dateiimport nach Abies NG nur im Format 'xlsm' m|fffd|glich!" _
        & " Wollen Sie trotzdem mit 'xls-Speicherung' fortsetzen?", vbYesNo + 48 + 256, _
        "Funktion Datei speichern im xls-Format") = vbNo Then
            Exit Sub
        Else
        End If
        ' Neu in 150413A03 Ende
'        ActiveWorkbook.Save
        dateiname = Application.GetSaveAsFilename( _
        "\", fileFilter:="Microsoft Office Excel-Arbeitsmappe (*.xls),*.xls")
        If dateiname <> False Then '1.1.1A Dateiname ok
            Sheets("DATEN").Unprotect ("mallnitz")
            Sheets("DATEN").Cells(3, 8).Value = 0
            Sheets("DATEN").Cells(2, 3).Value = 1
            Sheets("DATEN").Protect ("mallnitz")
            MsgBox "Speichern als: " & dateiname, 64, "Funktion Datei speichern im xls.Format"
            ActiveWorkbook.SaveAs dateiname, FileFormat:=56

        Else '1.1.1B Aktion abbrechen
            MsgBox "Aktion abgebrochen!", 48, "Funktion Datei speichern"
        End If '1.1.1Z
        
    Else '1.1B als xlsm speichern
        Rem neu V151229 R|fffd|ckfrage deaktiviert, da immer xlsm-Format
'        If MsgBox("R|fffd|ckkonvertierung in das xls-Format ist nicht mehr m|fffd|glich!" _
'        & " Wollen Sie trotzdem fortsetzen?", vbYesNo + 48 + 256, _
'        "Funktion Datei speichern im xlsm-Format") = vbNo Then
'            Exit Sub
'        Else
'        End If
        dateiname = Application.GetSaveAsFilename( _
        "\Dateiname.xlsm", fileFilter:="Excel 2010 Datei mit Makro (*.xlsm),*.xlsm")
    
        On Error GoTo errorHandler 'xlsm Speicherung nicht m|fffd|glich, Abfangen des Fehlers
        If dateiname <> False Then '1.1.2A Dateiname ok
            Sheets("DATEN").Unprotect ("mallnitz")
            Sheets("DATEN").Cells(2, 3).Value = 1
            Sheets("DATEN").Cells(3, 8).Value = 1 ' Zeile 3 Spalte 8(H) = 1 f|fffd|r Format xlsm
            Sheets("DATEN").Protect ("mallnitz")
            MsgBox "Speichern als.. " & dateiname, 64, "Funktion Speichern im xlsm-Foramt"
            ActiveWorkbook.SaveAs dateiname, FileFormat:=52
            
        Else '1.1.2B Aktion abbrechen
            MsgBox "Aktion abgebrochen!", 48, "Funktion Datei speichern"
        End If '1.1.2Z
        OptionButton1.Value = False
        OptionButton2.Value = False
        OptionButton3.Value = False
        CommandButton1.Enabled = False
        Exit Sub
errorHandler:
MsgBox "Dateityp kann nicht erstellt werden!" & vbCrLf _
& "Bitte installieren sie das Office 2010 Konverterpaket", _
vbCritical + vbOKOnly, "Funktion Datei speichern im xlsm-Format"
    End If '1.1Z
End If '1Z
OptionButton1.Value = False
OptionButton2.Value = False
OptionButton3.Value = False
OptionButton4.Value = False
CommandButton1.Enabled = False
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che ABBRUCH ###
OptionButton1.Value = False
OptionButton2.Value = False
OptionButton3.Value = False
OptionButton4.Value = False
CommandButton1.Enabled = False
UserForm11.Hide
Unload Me
End Sub

Private Sub OptionButton1_Click()
Rem ### |fffd|ffnen des Explorers zur Auswahl einer Datei ###
OptionButton1.Value = True
OptionButton2.Value = False
OptionButton3.Value = False
OptionButton4.Value = False
CommandButton1.Enabled = True
CommandButton1.SetFocus
End Sub
Private Sub OptionButton2_Click()
Rem ### Speichern im Dateiforma xls ###
OptionButton1.Value = False
OptionButton2.Value = True
OptionButton3.Value = False
OptionButton4.Value = False
CommandButton1.Enabled = True
CommandButton1.SetFocus
End Sub
Private Sub OptionButton3_Click()
Rem ### Speichern im Dateiforma xlsm ###
OptionButton1.Value = False
OptionButton2.Value = False
OptionButton3.Value = True
OptionButton4.Value = False
CommandButton1.Enabled = True
CommandButton1.SetFocus
End Sub
Private Sub OptionButton4_Click()
Rem ### Zwischenspeicherung  ###
OptionButton1.Value = False
OptionButton2.Value = False
OptionButton3.Value = False
OptionButton4.Value = True
CommandButton1.Enabled = True
CommandButton1.SetFocus
End Sub
Attribute VB_Name = "UserForm12"
Attribute VB_Base = "0{9FF50E95-5B6D-447B-93F5-206B3927CFB6}{EF073F2E-D268-4A66-9224-50DC234A5438}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Auswahl Kopieren/L|fffd|schen OK ###
Dim dz As Integer
dz = Cells(3, 5).Value
TextBox1.Enabled = False 'Textfeld Nr. Datensatzzeile sperren
OptionButton1.Enabled = False 'Optionsschaltfl|fffd|che Kopieren sperren
OptionButton2.Enabled = False 'Optionsschaltfl|fffd|che L|fffd|schen sperren
CommandButton1.Enabled = False
CommandButton2.Enabled = False
If OptionButton1.Value = True Then
    Label4.Caption = "ACHTUNG: Die kopierte Datenzeile wird direkt unter die" _
    & " ausgew|fffd|hlte Datenzeile " & dz & " eingef|fffd|gt und die Datenzeilen neu" _
    & " durchnummeriert. Die bisherigen Nummern der nachfolgenden Datenzeilen gehen" _
    & " unwiderruflich verloren!"
Else
    Label4.Caption = "ACHTUNG: Die ausgew|fffd|hlte Datenzeile " & dz & " wird unwiderruflich" _
    & " gel|fffd|scht und die Datenzeilen neu durchnummeriert. Die bisherige Nummernfolge" _
    & " der nachfolgenden Datenzeilen geht verloren!"
End If
Label4.Visible = True
CommandButton3.Visible = True
CommandButton4.Visible = True
CommandButton3.SetFocus
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Auswahl Kopieren/L|fffd|schen ABBRUCH ###
UserForm12.Hide
Unload Me
End Sub

Private Sub CommandButton3_Click()
Rem ### Schaltfl|fffd|che Auswahlbest|fffd|tigung Kopieren ABBRUCH ###
UserForm12.Hide
Unload Me
End Sub

Private Sub CommandButton4_Click()
Rem ### Schaltfl|fffd|che Auswahlbest|fffd|tigung Kopieren FORTFAHREN ###
Dim dzd As Integer 'Datenzeile DATEN
Dim dza As Integer 'Datenzeile ABIES
Dim zd As Integer 'Z|fffd|hler DATEN
Dim za As Integer 'Z|fffd|hler ABIES
Dim dzmax As Integer 'Zeile maximale Datenzeile
Dim kv As Integer 'Zeile Kopiervorlage
dzd = Cells(3, 5).Value + 6 'Zeile markierter Datenzeile
dza = Cells(3, 5).Value + 4
dzmax = Cells(3, 4).Value
kv = Cells(4, 4).Value
Sheets("DATEN").Select
Sheets("DATEN").Unprotect ("mallnitz")
Application.ScreenUpdating = False
If OptionButton1.Value = True Then
    If Cells(3, 4).Value > 209 Then
        MsgBox "maximal m|fffd|gliche Datens|fffd|tze |fffd|berschritten - weitere Kopie nicht m|fffd|glich!", _
        48, "Funktion Kopieren / L|fffd|schen"
        Exit Sub
    Else
    End If
    Rows(dzd).Select
    Selection.Copy
    Rows(dzd + 1).Select
    Selection.Insert
    Application.CutCopyMode = False
    Cells(3, 4).Value = Cells(3, 4).Value + 1
    Cells(4, 4).Value = Cells(4, 4).Value + 1
    kv = Cells(4, 4).Value
    If Cells(3, 5).Value = Cells(3, 4).Value - 7 Then
        Range("AH" & kv & ":BZ" & kv).Select
        Selection.Copy
        Range("AH" & dzd & ":BZ" & dzd + 1).Select
        ActiveSheet.Paste
        Range("CG" & kv & ":CZ" & kv).Select
        Selection.Copy
        Range("CG" & dzd & ":CZ" & dzd + 1).Select
        ActiveSheet.Paste
        Range("DJ" & kv & ":GZ" & kv).Select
        Selection.Copy
        Range("DJ" & dzd & ":GZ" & dzd + 1).Select
        ActiveSheet.Paste
        Range("HE" & kv & ":II" & kv).Select
        Selection.Copy
        Range("HE" & dzd & ":II" & dzd + 1).Select
        ActiveSheet.Paste
    Else
        Range("AH" & kv & ":BZ" & kv).Select
        Selection.Copy
        Range("AH" & dzd & ":BZ" & dzd + 2).Select
        ActiveSheet.Paste
        Range("CG" & kv & ":CZ" & kv).Select
        Selection.Copy
        Range("CG" & dzd & ":CZ" & dzd + 2).Select
        ActiveSheet.Paste
        Range("DJ" & kv & ":GZ" & kv).Select
        Selection.Copy
        Range("DJ" & dzd & ":GZ" & dzd + 2).Select
        ActiveSheet.Paste
        Range("HE" & kv & ":II" & kv).Select
        Selection.Copy
        Range("HE" & dzd & ":II" & dzd + 2).Select
        ActiveSheet.Paste
    End If
    Cells(2, 115).Value = Cells(2, 115).Value + 1
    Cells(dzd + 1, 60).Value = 1 'Flag kopierte Zeile setzen
    Cells(dzd + 1, 27).Font.Color = vbBlue
    Cells(dzd + 1, 28).Font.Color = vbBlue
    Cells(dzd + 1, 29).Font.Color = vbBlue
    Cells(dzd + 1, 30).Font.Color = vbBlue
    Cells(dzd + 1, 31).Font.Color = vbBlue
    Cells(dzd + 1, 32).Font.Color = vbBlue
    Cells(dzd + 1, 33).Font.Color = vbBlue
    Cells(dzd + 1, 80).Font.Color = vbBlue
    Cells(dzd + 1, 81).Font.Color = vbBlue
    Cells(dzd + 1, 82).Font.Color = vbBlue
    Cells(dzd + 1, 83).Font.Color = vbBlue
    Cells(dzd + 1, 84).Font.Color = vbBlue
    Cells(dzd + 1, 106).Font.Color = vbBlue
    Cells(dzd + 1, 107).Font.Color = vbBlue
    Cells(dzd + 1, 108).Font.Color = vbBlue
    Cells(dzd + 1, 109).Font.Color = vbBlue
    Cells(dzd + 1, 110).Font.Color = vbBlue
    Cells(dzd + 1, 111).Font.Color = vbBlue
    Cells(dzd + 1, 112).Font.Color = vbBlue
    Cells(dzd + 1, 113).Font.Color = vbBlue
    Cells(dzd + 1, 210).Font.Color = vbBlue
    Cells(dzd + 1, 211).Font.Color = vbBlue
    Cells(dzd + 1, 212).Font.Color = vbBlue
    For zd = 7 To Cells(3, 4).Value
        Cells(zd, 2).Value = zd - 6
        Cells(zd, 21).Value = zd - 6
        Next zd
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Select
    Sheets("ABIES").Unprotect ("mallnitz")
    Rows(dza).Select
    Selection.Copy
    Rows(dza + 1).Select
    Selection.Insert
    Application.CutCopyMode = False
    For za = 5 To Sheets("DATEN").Cells(3, 4).Value - 2
        Cells(za, 1).Value = za - 4
        Next za
    Sheets("ABIES").Protect ("mallnitz")
    Sheets("ABIES").Visible = False
    Sheets("DATEN").Select
    Cells(dzd + 1, 27).Select
Else
    Rows(dzd).Select
    Selection.Delete
    Cells(3, 4).Value = Cells(3, 4).Value - 1
    Cells(4, 4).Value = Cells(4, 4).Value - 1
    Cells(2, 115).Value = Cells(2, 115).Value - 1
    kv = Cells(4, 4).Value
'    'Range("AA & kv &:GZ & kv &").Select
'    Rows(kv).Select
'    Selection.Copy
'    'Range("AA & dzd &:GZ & dzd &").Select
'    Rows(dzd).Select
'    ActiveSheet.Paste
'    Application.CutCopyMode = False
    Range("AH" & kv & ":BZ" & kv).Select
    Selection.Copy
    Range("AH" & dzd & ":BZ" & dzd - 1).Select
    ActiveSheet.Paste
    Range("CG" & kv & ":CZ" & kv).Select
    Selection.Copy
    Range("CG" & dzd & ":CZ" & dzd - 1).Select
    ActiveSheet.Paste
    Range("DJ" & kv & ":GZ" & kv).Select
    Selection.Copy
    Range("DJ" & dzd & ":GZ" & dzd - 1).Select
    ActiveSheet.Paste
    Range("HE" & kv & ":II" & kv).Select
    Selection.Copy
    Range("HE" & dzd & ":II" & dzd - 1).Select
    ActiveSheet.Paste
'    Range("EJ" & kv).Select
'    Selection.Copy
'    Range("EJ" & dzd).Select
'    ActiveSheet.Paste
'    Range("EL" & kv).Select
'    Selection.Copy
'    Range("EL" & dzd).Select
'    ActiveSheet.Paste
'    Range("FT" & kv).Select
'    Selection.Copy
'    Range("FT" & dzd).Select
'    ActiveSheet.Paste
'    Range("FX" & kv).Select
'    Selection.Copy
'    Range("FX" & dzd).Select
'    ActiveSheet.Paste
'    Range("GF" & kv).Select
'    Selection.Copy
'    Range("GF" & dzd).Select
'    ActiveSheet.Paste
'    Range("EH" & kv).Select
'    Selection.Copy
'    Range("EH" & dzd - 1).Select
'    ActiveSheet.Paste
'    Range("EJ" & kv).Select
'    Selection.Copy
'    Range("EJ" & dzd - 1).Select
'    ActiveSheet.Paste
'    Range("EL" & kv).Select
'    Selection.Copy
'    Range("EL" & dzd - 1).Select
'    ActiveSheet.Paste
'    Range("FT" & kv).Select
'    Selection.Copy
'    Range("FT" & dzd - 1).Select
'    ActiveSheet.Paste
'    Range("FX" & kv).Select
'    Selection.Copy
'    Range("FX" & dzd - 1).Select
'    ActiveSheet.Paste
'    Range("GF" & kv).Select
'    Selection.Copy
'    Range("GF" & dzd - 1).Select
'    ActiveSheet.Paste
'    Cells(dzd, 138) = Cells(kv, 138)
'    Cells(dzd, 140) = Cells(kv, 140)
'    Cells(dzd, 142) = Cells(kv, 142)
'    Cells(dzd, 176) = Cells(kv, 176)
'    Cells(dzd, 180) = Cells(kv, 180)
'    Cells(dzd, 188) = Cells(kv, 188)
'    Cells(dzd - 1, 138) = Cells(kv, 138)
'    Cells(dzd - 1, 140) = Cells(kv, 140)
'    Cells(dzd - 1, 142) = Cells(kv, 142)
'    Cells(dzd - 1, 176) = Cells(kv, 176)
'    Cells(dzd - 1, 180) = Cells(kv, 180)
'    Cells(dzd - 1, 188) = Cells(kv, 188)
    For zd = 7 To Cells(3, 4).Value
        Cells(zd, 2).Value = zd - 6
        Cells(zd, 21).Value = zd - 6
        Next zd
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Select
    Sheets("ABIES").Unprotect ("mallnitz")
    Rows(dza).Select
    Selection.Delete
    For za = 5 To Sheets("DATEN").Cells(3, 4).Value - 2
        Cells(za, 1).Value = za - 4
        Next za
    Sheets("ABIES").Protect ("mallnitz")
    Sheets("ABIES").Visible = False
End If
UserForm12.Hide
Sheets("DATEN").Protect ("mallnitz")
Application.ScreenUpdating = True
End Sub

Private Sub OptionButton1_Click()
Rem ### Optionsschaltfl|fffd|che Kopieren ###
If OptionButton1.Value = True Then
    OptionButton2.Value = False
    CommandButton1.Enabled = True
Else
End If
End Sub

Private Sub OptionButton2_Click()
Rem ### Optionsschaltfl|fffd|che L|fffd|schen ###
If OptionButton2.Value = True Then
    OptionButton1.Value = False
    CommandButton1.Enabled = True
Else
End If
End Sub

Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Dim z As Integer
Sheets("DATEN").Select
Sheets("DATEN").Unprotect ("mallnitz")
Sheets("DATEN").Cells(3, 5).Value = TextBox1.Value
If Cells(3, 6).Value = 1 Then
    Label3.Visible = True
    TextBox1.Value = ""
    TextBox1.BackColor = vbYellow
    Cancel = True
    TextBox1.SetFocus
Else
    Label3.Visible = False
    TextBox1.BackColor = vbWhite
End If
If Cells(3, 6).Value = 9 Then
    OptionButton1.Enabled = True
    OptionButton2.Enabled = True
Else
    OptionButton1.Value = False
    OptionButton2.Value = False
    OptionButton1.Enabled = False
    OptionButton2.Enabled = False
    CommandButton1.Enabled = False
End If
z = Cells(3, 5).Value + 6
Cells(z, 2).Select
Sheets("DATEN").Protect ("mallnitz")
End Sub
Attribute VB_Name = "UserForm13"
Attribute VB_Base = "0{5B35F746-C584-4075-8CA6-208A17D2A5E6}{7069FBE2-8DD6-4B5A-85C6-CCBEE544816A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che OK ###
Dim dzmax As Integer
dzmax = Cells(2, 4).Value
UserForm13.Hide
Unload Me
Sheets("DATEN").Unprotect ("mallnitz")
Worksheets("DATEN").PageSetup.PrintArea = "AA3:II" & dzmax 'Druckbereich = Datenbereich
Columns("AA:AA").Hidden = True 'Grunddaten Losnummer ausblenden
Columns("CA:DI").Hidden = True 'Ausblenden Kerndaten
If OptionButton1.Value = True Then 'Variante mit Zusatzdaten
    Columns("HA:HD").Hidden = False
    Columns("AB:AB").Hidden = True 'Grunddaten Rotte ausblenden
    Columns("AG:AG").Hidden = True 'Grunddaten Farbe ausblenden
    Columns("AH:AI").Hidden = False 'Grunddaten Rotte lang, Farbe lang einblenden
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$3:$5"
        .LeftHeader = "ABIES FIS8 NRW - Vorlage Schnellerfassung Einzelst|fffd|mme"
        .RightHeader = "Druckdatum: &D" & Chr(10) & "&T"
        .LeftFooter = "&9Datei: &F \ &A"
        .RightFooter = "&9Seite: &P von &N"
        .PrintGridlines = True
        .Orientation = xlLandscape
        .PaperSize = xlPaperA4
        .BlackAndWhite = True
    End With
Else 'Variante ohne Zusatzdaten
    Columns("HA:HD").Hidden = True
    Columns("AB:AB").Hidden = False 'Grunddaten Rotte ausblenden
    Columns("AG:AG").Hidden = False 'Grunddaten Farbe ausblenden
    Columns("AH:AI").Hidden = True 'Grunddaten Rotte lang, Farbe lang einblenden
    With ActiveSheet.PageSetup
        .PrintTitleRows = "$3:$5"
        .LeftHeader = "ABIES FIS8 NRW - Vorlage Schnellerfassung Einzelst|fffd|mme"
        .RightHeader = "Druckdatum: &D" & Chr(10) & "&T"
        .LeftFooter = "&9Datei: &F \ &A"
        .RightFooter = "&9Seite: &P von &N"
        .PrintGridlines = True
        .Orientation = xlPortrait
        .PaperSize = xlPaperA4
        .BlackAndWhite = True
    End With
End If


ActiveWindow.SelectedSheets.PrintPreview
Sheets("DATEN").Protect ("mallnitz")

End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che ABBRUCH ###
UserForm13.Hide
Unload Me
End Sub

Private Sub OptionButton1_Click()
Rem ### Optionsschaltfl|fffd|che mit Zusatzdaten ###
If OptionButton1.Value = True Then
    OptionButton2.Value = False
    CommandButton1.Enabled = True
Else
End If
End Sub

Private Sub OptionButton2_Click()
Rem ### Optionsschaltfl|fffd|che ohne Zusatzdaten ###
If OptionButton2.Value = True Then
    OptionButton1.Value = False
    CommandButton1.Enabled = True
Else
End If
End Sub
Attribute VB_Name = "UserForm14"
Attribute VB_Base = "0{DDF6F3CA-D5BF-4979-A597-D8EAEB9E45B5}{3DB52B09-4F69-452C-BAAF-CD72DDCD10B3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
UserForm14.Hide
Unload Me
End Sub
Attribute VB_Name = "UserForm15"
Attribute VB_Base = "0{21A23CE3-16CA-49AE-9CD5-E559871020F5}{98AC6908-940F-4E02-9F00-27809EA7C5D4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Passwort pr|fffd|fen ###
Dim dzmax As Integer 'Maximalzahl m|fffd|glicher Datenzeilen
Dim kv As Integer 'Zeilennummer Kopiervorlage
Const passwabies = "amBerg"
'Const passwzurucksetzen = "kisangani"
'dzmax = Cells(3, 4).Value
'kv = Sheets("DATEN").Cells(4, 4).Value
If TextBox1.Value = passwabies Then
    UserForm15.Hide
    Sheets("DATEN").Select
    Sheets("DATEN").Unprotect ("mallnitz")
    Sheets("DATEN").Rows("1:2").Hidden = False
    Sheets("DATEN").Protect ("mallnitz")
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Select
    Sheets("ABIES").Protect ("mallnitz")
    With ActiveWindow
    .DisplayWorkbookTabs = True
    End With
    Unload Me
Else
    Label2.Visible = True
    TextBox1.SetFocus
    TextBox1.SelStart = 0
    TextBox1.SelLength = Len(TextBox1.Text)
    End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
UserForm15.Hide
Unload Me
End Sub

Attribute VB_Name = "UserForm16"
Attribute VB_Base = "0{A2447B9F-88ED-4418-BFFC-72B1F06C7837}{A51661C8-B763-456D-92B8-7346EFF6E568}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Passwort pr|fffd|fen ###
Dim dzmax As Integer 'Maximalzahl m|fffd|glicher Datenzeilen
Dim kv As Integer 'Zeilennummer Kopiervorlage
Const passwausblenden = "kisangani"
'Const passwzurucksetzen = "kisangani"
'dzmax = Cells(3, 4).Value
'kv = Sheets("DATEN").Cells(4, 4).Value
If TextBox1.Value = passwausblenden Then
    UserForm16.Hide
    Sheets("DATEN").Select
    Application.ScreenUpdating = False
    Application.CommandBars(1).Enabled = False
    'For Each cb In Application.CommandBars
    '    cb.Enabled = False
    '    Next cb
    With ActiveWindow
    .DisplayHeadings = False
    '.DisplayHorizontalScrollBar = False
    '.DisplayVerticalScrollBar = False
    .DisplayWorkbookTabs = False
    End With
    
    With Application
    .DisplayStatusBar = False
    .DisplayFormulaBar = False
    End With
    Application.Calculation = xlCalculationManual
    ActiveSheet.Unprotect ("mallnitz")
    dzmax = Cells(3, 4).Value
    kv = Cells(4, 4).Value
    Rows("1:2").Hidden = True
    Rows("6:6").Hidden = True
    Rows(kv).Hidden = True
    Columns("B:B").Hidden = False
    Columns("C:HZ").Hidden = True
    Columns("AA:AG").Hidden = False
    Columns("HA:HD").Hidden = False
    If Cells(2, 2).Value = 1 Then '1A
        Rows("7:" & dzmax).Hidden = False
        Columns("CA:CF").Hidden = False
    Else '1B
        For i = 7 To dzmax
            If Cells(i, 115).Value = 0 Then '1.1A
                Rows(i).Hidden = True
            Else '1.1B
                Rows(i).Hidden = False
            End If '1.1Z
            Next i
        Columns("DA:DI").Hidden = False
        If Cells(2, 2).Value = 5 Then '1.2A
            Columns("DE:DG").Hidden = True
        Else '1.2B
            Columns("DH:DI").Hidden = True
        End If '1.2Z
    End If '1Z
    ActiveSheet.Protect ("mallnitz")
    Sheets("ABIES").Visible = False
    Sheets("SD").Protect ("mallnitz")
    Sheets("SD").Visible = False
    Sheets("P").Protect ("mallnitz")
    Sheets("P").Visible = False
    Sheets("KOPF").Protect ("mallnitz")
    Sheets("KOPF").Visible = False
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Cells(7, 27).Select
    Unload Me
Else
    Label2.Visible = True
    TextBox1.SetFocus
    TextBox1.SelStart = 0
    TextBox1.SelLength = Len(TextBox1.Text)
    End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
UserForm16.Hide
Unload Me
End Sub

Attribute VB_Name = "UserForm17"
Attribute VB_Base = "0{80E7388F-63AB-4924-A0AB-15BD6F2D373A}{7A324E36-A80B-4DDD-A804-6DA95F1BBF03}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Passwort pr|fffd|fen ###
Dim dzmax As Integer 'Maximalzahl m|fffd|glicher Datenzeilen
Dim kv As Integer 'Zeilennummer Kopiervorlage
Const passwzuruecksetzen = "zermatt"
'Const passwzurucksetzen = "kisangani"
'dzmax = Cells(3, 4).Value
'kv = Sheets("DATEN").Cells(4, 4).Value
If TextBox1.Value = passwzuruecksetzen Then
    UserForm17.Hide
Rem #(1)# Bereich Registerblatt DATEN ###
    Application.ScreenUpdating = False
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Unprotect ("mallnitz")
    Sheets("DATEN").Select
    ActiveSheet.Unprotect ("mallnitz")
    Columns("IJ:IK").Hidden = True
    zz = Cells(3, 4).Value
    kv = Cells(4, 4).Value
    Rows("7:" & zz).Hidden = False
    If zz > 506 Then
        Rows("207:" & zz).Select
        Selection.Delete
        Cells(3, 4).Value = 506
        Cells(4, 4).Value = 512
        Sheets("ABIES").Select
        Rows("505:" & zz - 2).Select
        Selection.Delete
        Sheets("DATEN").Select
    ElseIf zz < 506 Then
        For i = zz To 505
            Rows(kv).Select
            Selection.Copy
            Rows(zz + 1).Select
            Selection.Insert
            Cells(3, 4).Value = Cells(3, 4).Value + 1
            Cells(4, 4).Value = Cells(4, 4).Value + 1
            kv = kv + 1
            Next i
        Sheets("ABIES").Select
        For i = zz - 2 To 503
            Rows("5:5").Select
            Selection.Copy
            Rows(zz - 1).Select
            Selection.Insert
            Next i
        Sheets("DATEN").Select
    Else
    End If
    Range("AH512:BZ512").Select
    Selection.Copy
    Range("AH7:BZ506").Select
    ActiveSheet.Paste
    Range("CG512:CZ512").Select
    Selection.Copy
    Range("CG7:CZ506").Select
    ActiveSheet.Paste
    Range("DJ512:GZ512").Select
    Selection.Copy
    Range("DJ7:GZ506").Select
    ActiveSheet.Paste
    Range("HE512:II512").Select
    Selection.Copy
    Range("HE7:II506").Select
    ActiveSheet.Paste
    For zz = 7 To 506
        Cells(zz, 2).Value = zz - 6
        Next zz

Rem #(1A)# L|fffd|schen der Eingabebereiche und |fffd|bernahme Formatkopie ###
    Range("AA7:AG506").Select 'Erfassungsbereich Grunddaten
    Selection.ClearContents
    Range("CB7:CF506").Select 'Erfassungsbereich Kerndaten aus Liste
    Selection.ClearContents
    Range("DB7:DI506").Select 'Erfassungsbereich Kerndaten aus Masken
    Selection.ClearContents
    Range("HB7:HD506").Select 'Erfassungsbereich Zusatzdaten
    Selection.ClearContents
    Range("AA512:AG512").Select 'Formatkopie Grunddaten aus Liste aus Basiszeile
    Selection.Copy
    Range("AA6:AG6").Select
    ActiveSheet.Paste
    Range("CB512:CF512").Select 'Formatkopie Kerndaten aus Liste aus Basiszeile
    Selection.Copy
    Range("CB7:CF506").Select
    ActiveSheet.Paste
    Range("DB512:DI512").Select 'Formatkopie Kerndaten aus Masken aus Basiszeile
    Selection.Copy
    Range("DB7:DI506").Select
    ActiveSheet.Paste
    Range("HB512:HD512").Select 'Formatkopie Zusatzdaten aus Basiszeile
    Selection.Copy
    Range("HB7:HD506").Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Rows("7:506").Hidden = False
Rem #(1B)# R|fffd|cksetzung der Z|fffd|hlfelder und Grundeinstellung der Hilfsmasken ###
    Cells(1, 3).Value = Date & " " & Time ' NEU unter 150413A03
    Cells(2, 3).Value = ""
    Cells(2, 16).Value = 0 'weiter, obwohl nicht RVR-l|fffd|ngenkonform zur|fffd|cksetzen
    Cells(3, 17).Value = 0 'weiter, obwohl doppelte GKL zur|fffd|cksetzen
    Cells(2, 2).Value = 0 'keine Erfassungsart ausgew|fffd|hlt
    Cells(2, 17).Value = 0
    Cells(2, 106).Value = 0 'Fixierung Baumart - nein
    Cells(2, 108).Value = 0 'Fixierung GKL - nein
    Cells(2, 109).Value = 0 'Fixierung L|fffd|nge - nein
    Cells(2, 115).Value = 6 'letzte Datenzeile zur|fffd|cksetzen
    Cells(3, 8).Value = "" 'Format xls(0) bzw. xlsm(1) zur|fffd|cksetzen
    Cells(3, 26).Value = 0 'Flag f|fffd|r einmaligen Hinweis 5-stufiges P.verfahren
    Cells(4, 8).Value = 0 'Flag Plausipr|fffd|fung zur|fffd|cksetzen
    Cells(7, 27).Value = ""
    Cells(5, 27).Activate
    UserForm1.OptionButton1 = False 'Erfassungsarten deaktivieren
    UserForm1.OptionButton2 = False
    UserForm1.OptionButton3 = False
    UserForm1.OptionButton4 = False
    UserForm4.TextBox1.Enabled = True 'Mehrfeldeingabe Baumart
    UserForm4.TextBox4.Enabled = True 'Mehrfeldeingabe GKL
    UserForm4.TextBox5.Enabled = True 'Mehrfeldeingabe L|fffd|nge
    UserForm5.TextBox1.Enabled = True 'Einfeldeingabe Baumart
    UserForm5.TextBox4.Enabled = True 'Einfeldeingabe GKL
    UserForm5.TextBox5.Enabled = True 'Einfeldeingabe L|fffd|nge/MDM
    UserForm6.TextBox1.Enabled = True 'PNT Baumart
    UserForm6.TextBox4.Enabled = True 'PNT GKL
    UserForm6.TextBox5.Enabled = True 'PNT L|fffd|nge
    For i = 7 To 506
        Cells(i, 21).Value = i - 6 'Standardz|fffd|hler setzen
        Cells(i, 83).Interior.ColorIndex = xlColorIndexNone 'L|fffd|ngenfeld Kerndaten aus Liste
        Cells(i, 109).Interior.ColorIndex = xlColorIndexNone 'L|fffd|ngenfeld Kerndaten aus Masken
        Cells(i, 112).Interior.ColorIndex = xlColorIndexNone 'L|fffd|ngen/MDMfeld Kerndaten aus Masken
        Cells(i, 2).Font.Color = vbBlack 'Zeilenz|fffd|hler
        Cells(i, 27).Font.Color = vbBlack 'Losnummer
        Cells(i, 28).Font.Color = vbBlack 'Rotte
        Cells(i, 29).Font.Color = vbBlack 'Kalamit|fffd|t
        Cells(i, 30).Font.Color = vbBlack 'Schadholz
        Cells(i, 31).Font.Color = vbBlack 'Zugangsart
        Cells(i, 32).Font.Color = vbBlack 'Rindenmessung
        Cells(i, 33).Font.Color = vbBlack 'Farbe
        Cells(i, 80).Font.Color = vbBlack 'Baumart aus Liste
        Cells(i, 81).Font.Color = vbBlack 'Holznummer aus Liste
        Cells(i, 82).Font.Color = vbBlack 'GKL aus Liste
        Cells(i, 83).Font.Color = vbBlack 'L|fffd|nge aus Liste
        Cells(i, 84).Font.Color = vbBlack 'MDM aus Liste
        Cells(i, 106).Font.Color = vbBlack 'Baumart aus Masken
        Cells(i, 107).Font.Color = vbBlack 'Holznummer aus Masken
        Cells(i, 108).Font.Color = vbBlack 'GKL aus Masken
        Cells(i, 109).Font.Color = vbBlack 'L|fffd|nge aus Masken
        Cells(i, 110).Font.Color = vbBlack 'MDM aus Masken
        Cells(i, 111).Font.Color = vbBlack 'Klammerstamm aus Masken
        Cells(i, 112).Font.Color = vbBlack 'L|fffd|nge/MDM aus Masken
        Cells(i, 113).Font.Color = vbBlack 'MDM>1m aus Masken
        Cells(i, 210).Font.Color = vbBlack 'Rindenabzug
        Cells(i, 211).Font.Color = vbBlack 'Bemerkungen extern
        Cells(i, 212).Font.Color = vbBlack 'Bemerkungen intern
        Next i
    Rows("7:506").Hidden = True
Rem #(1C)# Aktivierung Blattschutz Registerblatt DATEN ###
    ActiveSheet.Protect ("mallnitz")

Rem #(2)# Bereich Registerblatt KOPF ###
    Sheets("KOPF").Visible = True
    Sheets("KOPF").Select
    ActiveSheet.Unprotect ("mallnitz")
    s = 5
Rem #(2A)# R|fffd|cksetzung der Feldeintr|fffd|ge auf <Leer> bzw. Standardwerte ###
    Cells(4, s).Value = "" 'Hiebsbeginn
    Cells(6, s).Value = "" 'Waldbesitzer Partnernummer
    Cells(7, s).Value = 1 'Waldbesitzer NL
    Cells(8, s).Value = 1 'Waldbesitzer Adresse
    Cells(9, s).Value = "" 'Waldbesitzer Langname
    Cells(11, s).Value = "" 'Zusammenschluss Partnernummer
    Cells(12, s).Value = 1 'Zusammenschluss NL
    Cells(13, s).Value = 1 'Zusammenschluss Adresse
    Cells(14, s).Value = "" 'Zusammenschluss Langname
    Cells(17, s).Value = 0 'Zertifikat - nein
    Cells(18, s).Value = "" 'Zertifikat Langname
    Cells(21, s).Value = "" 'Ma|fffd|nahme NR
    Cells(22, s).Value = "" 'Ausf|fffd|hrende NR
    Cells(24, s).Value = "" 'Abt/UAbt
    Cells(25, s).Value = "" 'BE
    Cells(32, s).Value = "" 'Waldort Langname
    Cells(34, s).Value = "" 'Projekt zentral
    Cells(35, s).Value = "" 'Projekt FoA
    Cells(36, s).Value = "" 'Projekt FBB
    Cells(38, s).Value = 1 'Herkunft Forstwirtschaft
    Cells(40, s).Value = "" 'Bemerkung extern
    Cells(41, s).Value = "" 'Bemerkung intern

    Cells(43, s).Value = "" 'K|fffd|ufervorschlag Partnernummer
    Cells(44, s).Value = 1 'K|fffd|ufervorschlag NL
    Cells(45, s).Value = 1 'K|fffd|ufervorschlag Adresse
    Cells(46, s).Value = "" 'K|fffd|ufervorschlag Langname
    Cells(48, s).Value = "" 'Vertragsvorschlag Langname
    Cells(49, s).Value = "*" 'Abgangsart - keine
    Cells(50, s).Value = 99  'Leistung EO - leer
    Cells(51, s).Value = 0 'Leistung 8a - nein
    Cells(52, s).Value = "" 'Unternehmer(1)
    Cells(53, s).Value = "" 'Kommentar(1)
    Cells(54, s).Value = "" 'Unternehmer(2)
    Cells(55, s).Value = "" 'Kommentar(2)
    Cells(56, s).Value = "" 'Unternehmer(3)
    Cells(57, s).Value = "" 'Kommentar(3)
    Cells(59, s).Value = "" 'Bemerkung
    Cells(60, s).Value = "ue" 'Entrindungszustand
    Cells(61, s).Value = "" 'Logistikstatus
    Cells(63, s).Value = "F" 'Zugangstyp - Finalma|fffd|
    Cells(65, s).Value = 1 'nur Kernfelder anzeigen
    ActiveSheet.Protect ("mallnitz")
    Sheets("KOPF").Visible = False
Rem #(3A)# Zur|fffd|cksetzen Schleifenz|fffd|hler |fffd|bersicht Kubatur ###
    Sheets("SD").Visible = True
    Sheets("SD").Select
    Sheets("SD").Unprotect ("mallnitz")
    Sheets("SD").Cells(1, 134).Value = 3
    Sheets("SD").Protect ("mallnitz")
    Sheets("SD").Visible = False
Rem #(4A)# Zur|fffd|cksetzen Pr|fffd|fsummenz|fffd|hler Registerblatt ABIES ###
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Select
    Sheets("ABIES").Unprotect ("mallnitz")
    Sheets("ABIES").Cells(3, 22).Value = 222
    For i = 5 To 504
        Cells(i, 1).Value = i - 4
        Next i
    Sheets("ABIES").Protect ("mallnitz")
    Sheets("ABIES").Visible = False
    Sheets("DATEN").Select
    Cells(7, 27).Value = ""
    
    Application.ScreenUpdating = True
    Unload Me
Else
    Label2.Visible = True
    TextBox1.SetFocus
    TextBox1.SelStart = 0
    TextBox1.SelLength = Len(TextBox1.Text)
    End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
UserForm17.Hide
Unload Me
End Sub
Attribute VB_Name = "UserForm18"
Attribute VB_Base = "0{200340B0-23E9-4BEF-BC93-282CE4B41389}{8783042A-9752-4DF1-A2DD-B87B114B67DE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Passwort pr|fffd|fen ###
Const passwformat = "feiStritZ"
If TextBox1.Value = passwformat Then
    UserForm18.Hide
    For Each cb In Application.CommandBars
    cb.Enabled = True
    Next cb
    With ActiveWindow
    .DisplayHeadings = True
    .DisplayHorizontalScrollBar = True
    .DisplayVerticalScrollBar = True
    .DisplayWorkbookTabs = True
    End With
    With Application
    .DisplayAlerts = True
    .DisplayStatusBar = True
    .DisplayFormulaBar = True
    End With
    Application.CommandBars(1).Enabled = True
    Application.CommandBars("Standard").Visible = True
    Application.CommandBars("Formatting").Visible = True
    Application.CommandBars("Standard").Enabled = True
    Application.CommandBars("Formatting").Enabled = True
    Application.DisplayAlerts = True
    Unload Me
Else
    Label2.Visible = True
    TextBox1.SetFocus
    TextBox1.SelStart = 0
    TextBox1.SelLength = Len(TextBox1.Text)
    End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
UserForm18.Hide
Unload Me
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{2F781867-FA9D-4E54-9942-A9368A8E3A8D}{D3508C64-A3F6-4C21-80E1-76BA3E8AEA1C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che STARTEN ###
    Cells(2, 16).Value = 0 'Wert RVR-Konformit|fffd|t Kerndaten zur|fffd|cksetzen
    Cells(3, 16).Value = 0 'Wert idGKL-Klammerstamm zur|fffd|cksetzen
    CommandButton10.Enabled = True 'Schaltfl|fffd|che RVR-Konformit|fffd|t ok
'    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 25").Enabled = False
'    Schaltfl|fffd|che Kopf-/Losdaten
'    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 28").Enabled = False
'    Schaltfl|fffd|che Daten erfassen
'    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 439").Enabled = False
'    Schaltfl|fffd|che sortieren
    If Cells(3, 26).Value = 1 Then
    Else
    MsgBox "5-stufige Plausibilit|fffd|tspr|fffd|fung; evt. kritische Datens|fffd|tze bitte |fffd|ber" _
    & " Schaltfl|fffd|che 'bearbeiten' unter Beachtung der stichwortartigen Hinweismeldungen" _
    & " korrigieren", 64, "Funktion Plausibilit|fffd|tspr|fffd|fung"
    Cells(3, 26).Value = 1
    End If
    Plausibilitaetspruefung
End Sub

Sub Plausibilitaetspruefung()
Rem #(S)# Plausibilit|fffd|tspr|fffd|fung starten ###
    Dim i As Integer
    Dim z As Integer
    Dim dzmax As Integer
    Sheets("DATEN").Select
    ActiveSheet.Unprotect ("mallnitz")
    dzmax = Cells(3, 4).Value
    Application.ScreenUpdating = False
    Rows("7:" & dzmax).Hidden = False
    Rows("6:6").Hidden = True
    Rem #(1A)# Daten aufsteigend sortieren nach LfdNr ###
    Range("A7:IH" & dzmax).Select 'sortieren aufsteigend nach lfdNr
    Selection.Sort Key1:=Range("B7"), Order1:=xlAscending, Key2:=Range("A7") _
    , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    Application.Calculation = xlCalculationManual
    Rem #(1B)# Zellschutz in Eingabebereichen aufheben (falls mit |fffd|bernahme aus
    Rem #(1B)# Listen mit Zellschutz) ###
    Range("AA7:AG" & dzmax).Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("CB7:CF" & dzmax).Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("DB7:DI" & dzmax).Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    Range("HB7:HD" & dzmax).Select
    Selection.Locked = False
    Selection.FormulaHidden = False
    z = 0
    CommandButton1.Enabled = False 'Schaltfl|fffd|che starten sperren
    Columns("B:B").Hidden = False
    Application.Calculation = xlCalculationAutomatic
    Application.Calculation = xlCalculationManual
    Rem #(1C)# Formatierung der L|fffd|ngenzellen auf cm ###
    For i = 7 To Cells(2, 4).Value '4 Maxwert Dz aus Liste Sp 87 oder Maskenerf Sp 115
        Cells(i, 83).Select 'Formatierung L|fffd|nge aus Liste
        Selection.NumberFormat = "0.00"
        Cells(i, 109).Select 'Formatierung L|fffd|nge aus Masken
        Selection.NumberFormat = "0.00"
        Next i
    For i = 7 To Cells(3, 4).Value
        If Cells(i, 25).Value = 1 Then 'Flag kopierte Zeile gesetzt
            Cells(i, 27).Font.Color = vbBlack
            Cells(i, 28).Font.Color = vbBlack
            Cells(i, 29).Font.Color = vbBlack
            Cells(i, 30).Font.Color = vbBlack
            Cells(i, 31).Font.Color = vbBlack
            Cells(i, 32).Font.Color = vbBlack
            Cells(i, 33).Font.Color = vbBlack
            Cells(i, 80).Font.Color = vbBlack
            Cells(i, 81).Font.Color = vbBlack
            Cells(i, 82).Font.Color = vbBlack
            Cells(i, 83).Font.Color = vbBlack
            Cells(i, 84).Font.Color = vbBlack
            Cells(i, 106).Font.Color = vbBlack
            Cells(i, 107).Font.Color = vbBlack
            Cells(i, 108).Font.Color = vbBlack
            Cells(i, 109).Font.Color = vbBlack
            Cells(i, 110).Font.Color = vbBlack
            Cells(i, 111).Font.Color = vbBlack
            Cells(i, 112).Font.Color = vbBlack
            Cells(i, 113).Font.Color = vbBlack
            Cells(i, 210).Font.Color = vbBlack
            Cells(i, 211).Font.Color = vbBlack
            Cells(i, 212).Font.Color = vbBlack
            Cells(i, 25).Value = "" 'Flag kopierte Zeile zur|fffd|cksetzen
        Else
        End If
        Next i
    Rem #(2A)# Plausipr|fffd|fung Strukturdaten (Ausblenden Datenzeilen, wenn Spalte 9 = -1)###
    For i = 7 To dzmax
        If Cells(i, 9).Value = -1 Then  '1A 9/I Plausipr|fffd|fung Strukturdaten; wenn plausibel,
                                        'dann ausblenden
            Rows(i).Hidden = True
        Else '1B sonst einblenden und Z|fffd|hler um +1 erh|fffd|hen
            z = z + 1
            Rows(i).Hidden = False
            If z = 1 Then Cells(2, 9).Value = i 'Wert 1. unplausible Datenzeile
                                                'in Zelle I2 abspeichern
        End If '1Z Ende Z|fffd|hlschleife fehlerhafte Datens|fffd|tze Strukturdaten
        Next i
    Rem #(2B)# Einblenden Pr|fffd|fergebnis und Schaltfl|fffd|che Strukturdaten bearbeiten ###
    Label2.Visible = True 'Pr|fffd|fergebnis Strukturdaten
    CommandButton3.Visible = True 'Schaltfl|fffd|che Strukturdaten bearbeiten
    Rem #(2C)# Programmverhalten, wenn Strukturdaten ok ###
    If z = 0 Then '2A wenn Strukturdaten plausibel, dann
        Label2.Caption = "strukturelle Pr|fffd|fung plausibel!" 'Ergebnis blau einblenden
        Label2.ForeColor = vbBlue
        Label11.Visible = True 'Haken Strukturdaten einblenden
        CommandButton3.Enabled = False 'Schaltfl|fffd|che Strukturdaten bearbeiten sperren
        UserForm2.Repaint
        Columns("I:I").Hidden = True 'Plausispalte Strukturdaten ausblenden
        Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
        Rem #(3A)# Fortsetzung Plausipr|fffd|fung Grunddaten (Ausblenden Datenzeile,
        Rem #(3A)# wenn Spalte 10 = -1) ###
        Label3.Enabled = True 'Pr|fffd|fung Grunddaten
        For i = 7 To dzmax
            If Cells(i, 10).Value = -1 Then '2A.1A wenn Grunddaten (J/10) plausibel, dann
                Cells(i, 27).Font.Color = vbBlack 'Schriftfarbe Losnummer schwarz
                Cells(i, 28).Font.Color = vbBlack 'Schriftfarbe Rotte schwarz
                Cells(i, 29).Font.Color = vbBlack 'Schriftfarbe Kalamit|fffd|t schwarz
                Cells(i, 30).Font.Color = vbBlack 'Schriftfarbe Schadholz schwarz
                Cells(i, 31).Font.Color = vbBlack 'Schriftfarbe Zugangsart schwarz
                Cells(i, 32).Font.Color = vbBlack 'Schriftfarbe Rindenmessung schwarz
                Cells(i, 33).Font.Color = vbBlack 'Schriftfarbe Farbe schwarz
                Cells(i, 34).Font.Color = vbBlack 'Schriftfarbe Rotte Langtext schwarz
                Cells(i, 35).Font.Color = vbBlack 'Schriftfarbe Farbe Langtext schwarz
                Rows(i).Hidden = True 'Datenzeile ausblenden
            Else '2A.1B sonst (d.h. Grunddaten fehlerhaft)
                z = z + 1 'Anzahl fehlerhafte Datens|fffd|tze +1
                Rows(i).Hidden = False 'Datenzeile einblenden
                If Cells(i, 39).Value = 9 Then Cells(i, 27).Font.Color = vbBlack _
                Else Cells(i, 27).Font.Color = vbRed 'Losnummer
                If Cells(i, 43).Value = 9 Then Cells(i, 28).Font.Color = vbBlack _
                Else Cells(i, 28).Font.Color = vbRed 'Rotte
                If Cells(i, 43).Value = 9 Then Cells(i, 34).Font.Color = vbBlack _
                Else Cells(i, 34).Font.Color = vbRed 'Rotte Langtext
                If Cells(i, 40).Value = 9 Then Cells(i, 29).Font.Color = vbBlack _
                Else Cells(i, 29).Font.Color = vbRed 'Kalamit|fffd|t
                If Cells(i, 41).Value = 9 Then Cells(i, 30).Font.Color = vbBlack _
                Else Cells(i, 30).Font.Color = vbRed 'Schadholz
                If Cells(i, 42).Value = 9 Then Cells(i, 31).Font.Color = vbBlack _
                Else Cells(i, 31).Font.Color = vbRed 'Zugangsart
                If Cells(i, 44).Value = 9 Then Cells(i, 32).Font.Color = vbBlack _
                Else Cells(i, 32).Font.Color = vbRed 'Rindenmessung
                If Cells(i, 45).Value = 9 Then Cells(i, 33).Font.Color = vbBlack _
                Else Cells(i, 33).Font.Color = vbRed 'Farbe
                If Cells(i, 45).Value = 9 Then Cells(i, 35).Font.Color = vbBlack _
                Else Cells(i, 35).Font.Color = vbRed 'Farbe Langtext
                If z = 1 Then Cells(2, 10).Value = i    'Wert 1. unplausible Datenzeile in
                                                        'Zelle J2 abspeichern
            End If '2A.1Z Ende Z|fffd|hlschleife fehlerhafte Grunddaten
            Next i
        Rem #(3B)# Einblenden Pr|fffd|fergebnis und Schaltlf|fffd|che Grunddaten bearbeiten ###
        Label4.Visible = True 'Pr|fffd|fergebnis Grunddaten
        CommandButton4.Visible = True 'Schaltfl|fffd|che Grunddaten bearbeiten
        Rem #(3C)# Programmverhalten, wenn Grunddaten ok ###
        If z = 0 Then '2A.2A wenn alle Grunddaten plausibel, dann
            Label4.Caption = "Daten vollst|fffd|ndig und plausibel!"
            Label4.ForeColor = vbBlue
            Label12.Visible = True 'Haken Grunddaten
            CommandButton4.Enabled = False 'Schaltfl|fffd|che Grunddaten bearbeiten sperren
            UserForm2.Repaint
            Columns("J:J").Hidden = True 'Plausispalte Grunddaten ausblenden
            Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
            Columns("AH:AI").Hidden = True 'Rotte lang und Farbe lang ausblenden
            Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
            Rem #(4A)# Fortsetzung Plausipr|fffd|fung Kerndaten  (Ausblenden der Datenzeile,
            Rem #(4A)# wenn Spalte 12 = -1) ###
            Label7.Enabled = True 'Pr|fffd|fung Kerndaten aktiv
            For i = 7 To dzmax
                If Cells(i, 12).Value = -1 Then '2A.2A.1A wenn Kerndaten (L/12) plausi, dann
                    Cells(i, 27).Font.Color = vbBlack 'Losnummer
                    Cells(i, 80).Font.Color = vbBlack 'Baumart Liste
                    Cells(i, 81).Font.Color = vbBlack 'HNR Liste
                    Cells(i, 82).Font.Color = vbBlack 'GKL Liste
                    Cells(i, 83).Font.Color = vbBlack 'L|fffd|nge Liste
                    Cells(i, 84).Font.Color = vbBlack 'MDM Liste
                    Cells(i, 106).Font.Color = vbBlack 'Baumart Maske
                    Cells(i, 107).Font.Color = vbBlack 'HNR Maske
                    Cells(i, 108).Font.Color = vbBlack 'GKL Maske
                    Cells(i, 109).Font.Color = vbBlack 'L|fffd|nge Maske
                    Cells(i, 110).Font.Color = vbBlack 'MDM Maske
                    Cells(i, 111).Font.Color = vbBlack 'Klammerstamm Maske
                    Cells(i, 112).Font.Color = vbBlack 'L|fffd|nge/MDM Maske
                    Cells(i, 113).Font.Color = vbBlack 'MDM>1m Maske
                    Rows(i).Hidden = True
                Else '2A.2A.1B. sonst (d.h. Kerndaten fehlerhaft)
                    z = z + 1
                    'Cells(i, 27).Font.Color = vbRed
                    If Cells(i, 132).Value = 9 Then
                        Cells(i, 80).Font.Color = vbBlack
                        Cells(i, 106).Font.Color = vbBlack
                        Cells(i, 29).Font.Color = vbBlack
                        Cells(i, 30).Font.Color = vbBlack
                        Else
                        Cells(i, 80).Font.Color = vbRed
                        Cells(i, 106).Font.Color = vbRed
                        Cells(i, 29).Font.Color = vbRed
                        Cells(i, 30).Font.Color = vbRed
                        End If
                    If Cells(i, 140).Value = 9 Then Cells(i, 81).Font.Color = vbBlack _
                    Else Cells(i, 81).Font.Color = vbRed
                    If Cells(i, 153).Value = 9 Then Cells(i, 82).Font.Color = vbBlack _
                    Else Cells(i, 82).Font.Color = vbRed
                    If Cells(i, 163).Value = 9 Then Cells(i, 83).Font.Color = vbBlack _
                    Else Cells(i, 83).Font.Color = vbRed
                    If Cells(i, 167).Value = 9 Then Cells(i, 84).Font.Color = vbBlack _
                    Else Cells(i, 84).Font.Color = vbRed
                    'If Cells(i, 132).Value = 9 Then Cells(i, 106).Font.Color = vbBlack _
                    'Else Cells(i, 106).Font.Color = vbRed
                    If Cells(i, 140).Value = 9 Then Cells(i, 107).Font.Color = vbBlack _
                    Else Cells(i, 107).Font.Color = vbRed
                    If Cells(i, 153).Value = 9 Then Cells(i, 108).Font.Color = vbBlack _
                    Else Cells(i, 108).Font.Color = vbRed
                    If Cells(i, 163).Value = 9 Then Cells(i, 109).Font.Color = vbBlack _
                    Else Cells(i, 109).Font.Color = vbRed
                    If Cells(i, 167).Value = 9 Then Cells(i, 110).Font.Color = vbBlack _
                    Else Cells(i, 110).Font.Color = vbRed
                    If Cells(i, 199).Value = 9 Then Cells(i, 111).Font.Color = vbBlack _
                    Else Cells(i, 111).Font.Color = vbRed
                    If Cells(i, 200).Value = 9 Then Cells(i, 112).Font.Color = vbBlack _
                    Else Cells(i, 112).Font.Color = vbRed
                    If Cells(i, 167).Value = 9 Then Cells(i, 113).Font.Color = vbBlack _
                    Else Cells(i, 113).Font.Color = vbRed
                    Rows(i).Hidden = False
                    If z = 1 Then Cells(2, 12).Value = i
                End If '2A.2A.1Z Ende Z|fffd|hlschleife Kerndaten (hart)
                Next i
                Rem #(4B)# Einblenden Pr|fffd|fergebnis und Schaltfl|fffd|che Kerndaten bearbeiten ###
                Label8.Visible = True 'Pr|fffd|fergebnis Kerndaten (hart) einblenden
                CommandButton6.Visible = True 'Schaltfl|fffd|che Kerndaten bearbeiten einblenden
                Rem #(4C)# Programmverhalten, wenn Kerndaten ok ###
                If z = 0 Then '2A.2A.2A wenn alle Kerndaten (hart) fehlerfrei, dann
                    CommandButton6.Enabled = False 'Schaltf Kerndaten bearbeiten deaktivieren
                    Rem #(5A)# Fortsetzung Pr|fffd|fung identische GKL bei Klammerst|fffd|mmen
                    Rem #(5A)# Datenzeilen ausblenden, wenn Spalte 200 = -1) ###
                    Columns("X:X").Hidden = False 'Pr|fffd|fspalte GKL einblenden
                    For i = 7 To dzmax
                        If Cells(i, 142).Value <> 8 Then
                        '2A.2A.2A.1A wenn KlammerstammIdentischeGKL = nein
                        'Wert Spalte EL/142 <>8), dann
                            Cells(i, 82).Interior.ColorIndex = xlColorIndexNone
                            'GKL Liste Hintergrundfarbe keine
                            Cells(i, 108).Interior.ColorIndex = xlColorIndexNone
                            'GKL Erfassung Hintergrundfarbe keine
                            Rows(i).Hidden = True
                        Else    '2A.2A.2A.1B sonst (bei Klammerst|fffd|mmen mit gleicher GKL
                                'in direkter Folge)
                            z = z + 1
                            Rows(i).Hidden = False
                            Cells(i, 82).Interior.ColorIndex = 36   'GKL Liste Hintergrund
                                                                    'farbe hellgelb
                            Cells(i, 108).Interior.ColorIndex = 36  'GKL Erfassung Hinter-
                                                                    'grundfarbe hellgelb
                            If z = 1 Then Cells(2, 24).Value = i
                        End If '2A.2A.2A.1Z Ende Z|fffd|hlschleife KlammerstammIdentischeGKL
                        Next i
                        
                    Rem #(5B)# alle Datens|fffd|tze GKL konform ###
                    If z = 0 Then '2A.2A.2A.2A wenn alle KD KlammerstammGKLkonform, dann
                        Columns("X:X").Hidden = True 'Pr|fffd|fspalten GKL ausblenden
                        Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                        Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                        Label21.Visible = False
                        Cells(3, 16).Value = 0 'keine identischen GKL-Kombinationen
                    Else '2A.2A.2A.2B sonst (bei Klammerst mit idend GKL in direkter Folge)
                        Rem #(5C)# Programmverhalten, wenn KD nicht alle GKL-konform ###
                        Label8.Caption = "Daten vollst|fffd|ndig"
                        Label8.ForeColor = vbRed
                        Beep
                        If z = 1 Then '2A.2A.2A.2B.1A wenn 1 kritischer Datensatz, dann
                            Label21.Caption = z & " Datensatz Klammerstamm mit" _
                            & " Teilst|fffd|cken ident. GKL in Direktfolge"
                        Else '2A.2A.2A.2B.1B sonst (bei >1 kritischer Datensatz)
                            Label21.Caption = z & " Datens|fffd|tze Klammerstamm mit" _
                            & " Teilst|fffd|cken ident. GKL in Direktfolge"
                        End If '2A.2A.2A.2B.1Z Ende Schleife Zahl Datens|fffd|tze identischeGKL
                        Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                        Columns("HA:HD").Hidden = True 'Zusatzdaten ausblenden
                        
                        Label21.ForeColor = vbRed
                        Label21.Visible = True 'Anzahl Datens|fffd|tze mit ident GKL einblenden
                        If Cells(3, 16).Value = 1 Then '2A.2A.2A.2B.2A wenn auff. D ok, dann
                            Label22.Visible = True 'identische GKL-Datens|fffd|tze ok
                            Label23.Visible = True 'Handsymbol einblenden
                            Columns("X:X").Hidden = True ' Pr|fffd|fspalte KD GKL ausblenden
                            Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                            Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                            z = 0
                        Else '2A.2A.2A.2B.2B sonst (auff|fffd|llige Datens|fffd|tze ok nicht gesetzt)
                            CommandButton11.Visible = True 'Schaltf GKL bearbeiten einblenden
                            CommandButton12.Visible = True 'Schaltf GKL ok einblenden
                            CommandButton11.SetFocus
                            Label22.Visible = False 'identische GKL-Datens|fffd|tze ok ausblenden
                            Label23.Visible = False 'Handsymbol ausblenden
                            Application.Calculation = xlCalculationAutomatic
                            Exit Sub
                        End If  '2A.2A.2A.2B.2Z Ende Schleife Programmverhalten
                                'GKL-Konformit|fffd|t
                    End If '2A.2A.2A.2Z Ende Pr|fffd|fschleife GKL-Konformit|fffd|t
                    Rem #(6A)# Fortsetzung Pr|fffd|fung Kerndaten RVR-Konformit|fffd|t
                    Rem #(6A)#(Datenzeilen ausblenden, wenn Spalte 14 = -1) ###
                    
                    Columns("N:N").Hidden = False ' Pr|fffd|fspalte Kerndaten RVR einblenden
                    Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                    Columns("HA:HD").Hidden = True 'Zusatzdaten ausblenden
                    For i = 7 To dzmax
                        If Cells(i, 160).Value <> 2 Then '2A.2A.2A.3A w KD RVR-konf (N/14),
                            Cells(i, 83).Interior.ColorIndex = xlColorIndexNone
                            'L|fffd|nge Liste Hintergrundfarbe keine
                            Cells(i, 109).Interior.ColorIndex = xlColorIndexNone
                            'L|fffd|nge Maske Hintergrundfarbe keine
                            Cells(i, 112).Interior.ColorIndex = xlColorIndexNone
                            'L|fffd|nge/MDM Maske Hintergrundfarbe keine
                            Rows(i).Hidden = True
                        Else '2A.2A.2A.3B sonst (bei nicht RVR-Konformit|fffd|t)
                            z = z + 1
                            Rows(i).Hidden = False
                            Cells(i, 83).Interior.ColorIndex = 36
                            Cells(i, 109).Interior.ColorIndex = 36
                            Cells(i, 112).Interior.ColorIndex = 36
                            If z = 1 Then Cells(2, 14).Value = i
                        End If '2A.2A.2A.3Z Ende Z|fffd|hlschleife RVR-Konformit|fffd|t
                        Next i
                    Rem #(6B)# Programmverhalten, wenn Kerndaten RVR-konform
                    If z = 0 Then '2A.2A.2A.4A wenn alle Daten RVR-konform
                        Cells(2, 16).Value = 0 'alle Kerndaten RVR-konform
                        Label8.Caption = "Daten vollst|fffd|ndig und plausibel!"
                        Label8.ForeColor = vbBlue
                        Label14.Visible = True 'Haken Kerndaten
                        Label18.Visible = False 'Anz nicht RVR-konf Datens|fffd|tze ausblenden
                        CommandButton9.Visible = False 'Schaltfl RVR bearbeiten ausblenden
                        CommandButton10.Visible = False 'Schaltfl|fffd|che RVR ok ausblenden
                        Columns("N:N").Hidden = True 'Pr|fffd|fspalte RVR-Konformit|fffd|t ausblenden
                        Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                        Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                    Else '2A.2A.2A.4B sonst (nicht alle Datens|fffd|tze RVR-konform)
                        Beep
                        Rem #(6C)# Programmverhalten, wenn Kerndaten nicht (alle) RVR-konform
                        Label8.Caption = "Daten vollst|fffd|ndig"
                        Label8.ForeColor = vbRed
                        If z = 1 Then '2A.2A.2A.4B.1A
                            Label18.Caption = z & " Datensatz nicht RVR-l|fffd|ngenkonform"
                        Else '2A.2A.2A.4B.1B
                            Label18.Caption = z & " Datens|fffd|tze nicht RVR-l|fffd|ngenkonform"
                        End If '2A.2A.2A.4B.1Z
                        
                        Label18.ForeColor = vbRed
                        Label18.Visible = True 'Anz nicht RVR-konformer Datens|fffd|tze einblenden
                        If Cells(2, 16).Value = 1 Then '2A.2A.2A.4B.2A
                            Label19.Visible = True 'nicht RVR-konforme Datens|fffd|tze ok
                            Label20.Visible = True 'Handsymbol einblenden
                            Columns("N:N").Hidden = True ' Pr|fffd|fsp Kerndaten RVR ausblenden
                            Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                            Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                            z = 0
                        Else '2A.2A.2A.4B.2B
                            CommandButton9.Visible = True 'Schaltfl|fffd|che RVR bearbeiten
                            CommandButton10.Visible = True 'Schaltfl|fffd|che RVR ok |fffd|bernehmen
                            CommandButton9.SetFocus
                            Label19.Visible = False 'nicht RVR-konf Datens|fffd|tze ok ausblenden
                            Label20.Visible = False 'Handsymbol ausblenden
                            Application.Calculation = xlCalculationAutomatic
                            Exit Sub
                        End If '2A.2A.2A.4B.2Z
                        
                    End If '2A.2A.2A.4Z Ende Pr|fffd|fschleife RVR-Konformit|fffd|t
                        
                    Columns("L:L").Hidden = True 'Pr|fffd|fspalte Kerndaten ausblenden
                    Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                    Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                    UserForm2.Repaint
                    Rem #(7A)# Fortsetzung Plausipr|fffd|fung Kerndaten Los/HNR ###
                    z = 0
                    Rows("7:" & dzmax).Hidden = False
                    For i = 7 To dzmax
                        Cells(i, 145).Value = 0 '145/EO R|fffd|cksetzung Pr|fffd|fspalte HNR Dubletten
                        Next i
                    Rem #(7B)# 1. Pr|fffd|flauf
                    Application.Calculation = xlCalculationAutomatic
                    Application.Calculation = xlCalculationManual
                    For i = 7 To dzmax
                        If Cells(i, 177).Value = 1 Then '2A.2A.2A.5A 177/FU
                        'Pr|fffd|fung Zeile/Folgezeile 1, wenn Klammerstamm und ungleiche Losnr
                            Cells(i, 145).Value = 1 'dann Zeile kritisch und
                            Cells(i + 1, 145).Value = 1 'Folgezeile kritisch
                        Else '2A.2A.2A.5B
                        End If '2A.2A.2A.5Z Ende 1. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Next i
                    Rem #(7C)# Sortieren nach Spalten EI (Los&HNR) und B
                    Rem #(7C)# (lfdNr) aufsteigend ###
                    Range("A7:IH" & dzmax).Select
                    Selection.Sort Key1:=Range("EI7"), Order1:=xlAscending, Key2:=Range("B7") _
                    , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
                    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
                    :=xlSortNormal
                    Application.Calculation = xlCalculationAutomatic
                    Application.Calculation = xlCalculationManual
                    Rem #(7D)# 2. Pr|fffd|flauf
                    For i = 7 To dzmax
                        If Cells(i, 140).Value = 1 Then '2A.2A.2A.6A 1, wenn LosHNR
                                                        'identisch und ungleich F
                            Cells(i, 145).Value = 1 'dann Zeile kritisch und
                            Cells(i - 1, 145).Value = 1 'und Vorzeile kritisch
                        Else '2A.2A.2A.6B
                        End If '2A.2A.2A.6Z Ende 2. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Rem #(7E)# 3. Pr|fffd|flauf
                        If Cells(i, 176).Value = 1 Then '2A.2A.2A.7A 1, wenn HNR und Los
                            'mit Folgezeile identisch und BA nicht gleich
                            Cells(i, 145).Value = 1 'dann Zeile kritisch
                            Cells(i + 1, 145).Value = 1 'und Folgezeile kritisch
                        Else '2A.2A.2A.7B
                        End If '2A.2A.2A.7Z Ende 3. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Rem #(7F)# 4. Pr|fffd|flauf
                        If Cells(i, 180).Value = 1 Then '2A.2A.2A.8A 1, wenn LosHNR
                            'identisch und lfdNr. nicht fortz|fffd|hlend
                            Cells(i, 145).Value = 1 'dann Zeile kritisch
                        Else '2A.2A.2A.8B
                        End If '2A.2A.2A.8Z Ende 4. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Next i
                    Rem #(7G)# Sortieren nach Sp EI (Los&HNR) und B (lfdNR) absteigend ###
                    Range("A7:IH" & dzmax).Select
                    Selection.Sort Key1:=Range("EI7"), Order1:=xlAscending, Key2:=Range("B7") _
                    , Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
                    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
                    :=xlSortNormal
                    Application.Calculation = xlCalculationAutomatic
                    Application.Calculation = xlCalculationManual
                    Rem #(7H)# 5. Pr|fffd|flauf
                    For i = 7 To dzmax
                        If Cells(i, 188).Value = 1 Then '2A.2A.2A.9A 1, wenn LosHNR
                            'identisch und lfdNr. nicht fortz|fffd|hlend
                            Cells(i, 145).Value = 1 'dann Zeile kritisch
                        Else '2A.2A.2A.9B
                        End If '2A.2A.2A.9Z Ende 5. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Rem #(7I)# 6. Pr|fffd|flauf
                        If Cells(i, 144).Value = 4 Then '2A.2A.2A.10A 4,
                            'wenn mind ein Kerndatum leer
                            Cells(i, 145).Value = 0 'dann Zeile r|fffd|cksetzen
                        Else '2A.2A.2A.10B
                        End If '2A.2A.2A.10Z Ende 6. Pr|fffd|fschleife HNR-Konformit|fffd|t
                        Next i
                    Rem #(7K)# Ausblenden Datenzeilen, wenn Spalte 11 = -1
                    Label5.Enabled = True 'Pr|fffd|fzeile LosNr/HNR aktiv
                    Application.Calculation = xlCalculationAutomatic
                    Application.Calculation = xlCalculationManual
                    For i = 7 To dzmax
                        If Cells(i, 11).Value = -1 Then '2A.2A.2A.11A wenn
                            'HNR-konform (K/11), dann
                            Cells(i, 27).Font.Color = vbBlack
                            Cells(i, 80).Font.Color = vbBlack
                            Cells(i, 81).Font.Color = vbBlack
                            Cells(i, 106).Font.Color = vbBlack
                            Cells(i, 107).Font.Color = vbBlack
                            Cells(i, 111).Font.Color = vbBlack
                            Cells(i, 112).Font.Color = vbBlack
                            Rows(i).Hidden = True
                        Else '2A.2A.2A.11B sonst (bei Nicht-HNR-Konformit|fffd|t)
                            z = z + 1
                            Rows(i).Hidden = False
                            Cells(i, 27).Font.Color = vbRed
                            Cells(i, 80).Font.Color = vbRed
                            Cells(i, 81).Font.Color = vbRed
                            Cells(i, 106).Font.Color = vbRed
                            Cells(i, 107).Font.Color = vbRed
                            Cells(i, 111).Font.Color = vbRed
                            Cells(i, 112).Font.Color = vbRed
                            If z = 1 Then Cells(2, 11).Value = i
                        End If '2A.2A.2A.11Z Ende Z|fffd|hlschleife HNR-Konformit|fffd|t
                        Next i
                    Rem #(7L)# Einblenden Pr|fffd|fergebnis und Schaltfl Los/HNR bearbeiten ###
                    Label6.Visible = True 'Pr|fffd|fergebnis LosNr/HNR
                    CommandButton5.Visible = True 'Schaltfl|fffd|che LosNr. bearbeiten einblenden
                    Rem #(7M)# Programmverhalten, wenn LosNr/HNR ok
                    If z = 0 Then '2A.2A.2A.12A alle Datens|fffd|tze HNR-konform
                        Label6.Caption = "Daten vollst|fffd|ndig und plausibel!"
                        Label6.ForeColor = vbBlue
                        Label13.Visible = True 'Haken LosNr/HNR
                        CommandButton5.Enabled = False 'Schaltfl|fffd|che LosNr bearbeiten sperren
                        Columns("K:K").Hidden = True 'Pr|fffd|fspalte LosNr ausblenden
                        Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                        Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
                        UserForm2.Repaint
                        Rem #(7N)# R|fffd|cksortierung nach Spalte B (lfdNR)
                        Rows("7:" & dzmax).Hidden = False
                        Range("A7:IH" & dzmax).Select
                        Selection.Sort Key1:=Range("B7"), Order1:=xlAscending, Key2:=Range("A7") _
                        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
                        False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
                        :=xlSortNormal
                        Application.Calculation = xlCalculationAutomatic
                        Application.Calculation = xlCalculationManual
                        Rem #(8A)# Fortsetzung Plausipr|fffd|fung Zusatzdaten
                        Rem #(8A)# Ausblenden Datenzeile, wenn Spalte 13 = -1) ###
                        Label9.Enabled = True 'Pr|fffd|fzeile Zusatzdaten aktiv
                        For i = 7 To dzmax
                            If Cells(i, 13).Value = -1 Then '2A.2A.2A.12A.1A wenn
                                'Zusatzdaten (M/13) plausibel, dann
                                Cells(i, 32).Font.Color = vbBlack 'Rindenmessung
                                Cells(i, 84).Font.Color = vbBlack 'MDM aus Liste
                                Cells(i, 110).Font.Color = vbBlack 'MDM aus Maske
                                Cells(i, 112).Font.Color = vbBlack 'L|fffd|nge/MDM aus Maske
                                Cells(i, 210).Font.Color = vbBlack 'Rindenabzug
                                Cells(i, 211).Font.Color = vbBlack 'Bemerkung extern
                                Cells(i, 212).Font.Color = vbBlack 'Bemerkung intern
                                Rows(i).Hidden = True
                            Else '2A.2A.2A.12A.1B sonst (bei Zusatzdaten nicht plausibel)
                                z = z + 1
                                If Cells(i, 215).Value = 1 Then Cells(i, 210).Font.Color _
                                = vbRed Else Cells(i, 210).Font.Color = vbBlack
                                If Cells(i, 216).Value = 1 Then Cells(i, 211).Font.Color _
                                = vbRed Else Cells(i, 211).Font.Color = vbBlack
                                If Cells(i, 217).Value = 1 Then Cells(i, 212).Font.Color _
                                = vbRed Else Cells(i, 212).Font.Color = vbBlack
                                If Cells(i, 214).Value = 4 Then Cells(i, 32).Font.Color _
                                = vbRed Else
                                If Cells(i, 215).Value = 7 Then
                                    Cells(i, 84).Font.Color = vbRed
                                    Cells(i, 110).Font.Color = vbRed
                                    Cells(i, 112).Font.Color = vbRed
                                Else
                                End If
                                Rows(i).Hidden = False
                                If z = 1 Then Cells(2, 13).Value = i
                            End If '2A.2A.2A.12A.1Z Ende Z|fffd|hlschleife Zusatzdaten
                            Next i
                        Rem #(8B)# Einblenden Pr|fffd|fergebnis und Schaltfl|fffd|che Zusatzdaten
                        Rem #(8B)# bearbeiten ###
                        Label10.Visible = True 'Pr|fffd|fergebnis Zusatzdaten
                        CommandButton7.Visible = True 'Schaltfl ZD bearbeiten einblenden
                        Rem #(8C)# Programmverhalten, wenn Zusatzdaten ok
                        If z = 0 Then '2A.2A.2A.12A.2A wenn alle Zusatzdaten plausibel, dann
                            Application.Calculation = xlCalculationAutomatic
                            Application.Calculation = xlCalculationManual
                            Label10.Caption = "Daten vollst|fffd|ndig und plausibel!"
                            Label10.ForeColor = vbBlue
                            Label15.Visible = True 'Haken Zusatzdaten
                            Label16.Visible = True 'Pr|fffd|fergebnis Gesamtpr|fffd|fung
                            Label17.Visible = True 'Haken Gesamtpr|fffd|fung
                            CommandButton2.Enabled = False 'Schaltfl|fffd|che abbrechen sperren
                            CommandButton7.Enabled = False 'Schaltfl ZD bearbeiten sperren
                            CommandButton8.Enabled = True 'Schaltfl|fffd|che ok aktivieren
                            CommandButton8.SetFocus
                            Columns("M:M").Hidden = True 'Pr|fffd|fspalte Zusatzdaten ausblenden
                            Columns("Y:Y").Hidden = True 'Abstandsspalte ausblenden
                            Columns("AA:AG").Hidden = False 'Grunddaten einblenden
                            UserForm2.Repaint
                            Sheets("ABIES").Unprotect ("mallnitz")
                            Rem #(9A)# Fixierung Pr|fffd|fsummenwerte in Registerblatt DATEN
                            Rem #(9A)# und ABIES
                            Application.Calculation = xlCalculationAutomatic
                            Sheets("DATEN").Cells(2, 15).Value = _
                            Sheets("DATEN").Cells(3, 15).Value '|fffd|bernahme Pr|fffd|fsummenwert II
                            Sheets("ABIES").Cells(3, 22).Value = _
                            Sheets("DATEN").Cells(2, 6).Value '|fffd|bernahme Pr|fffd|fsummenwert I
                            Sheets("ABIES").Cells(2, 22).Value = _
                            Sheets("DATEN").Cells(4, 15).Value '|fffd|bernahme 0 bzw. Zufallswert
                            
                            Application.Calculation = xlCalculationManual
                            Sheets("ABIES").Protect ("mallnitz")
                            Application.ScreenUpdating = True
                            Application.ScreenUpdating = False
                            
                        Else '2A.2A.2A.12A.2B sonst (bei nicht plausiblen Zusatzdaten)
                            Rem #(8D)# Ergebnis Zusatzdaten kritisch ###
                            Label10.ForeColor = vbRed
                            Beep
                            CommandButton7.Enabled = True 'Schaltfl ZD bearbeiten aktiv
                            Columns("M:M").Hidden = False 'Pr|fffd|fspalte Zusatzdaten einblenden
                            Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                            Columns("AA:AG").Hidden = True 'Grunddaten ausblenden
                            If z = 1 Then
                                Label10.Caption = z & " kritischer Datensatz"
                            Else
                                Label10.Caption = z & " kritische Datens|fffd|tze"
                            End If
                            CommandButton7.SetFocus
                        End If '2A.2A.2A.12A.2Z Ende Pr|fffd|fschleife Zusatzdaten
                        
                    Else '2A.2A.2A.12B sonst (bei nicht HNR-konformen Datens|fffd|tzen)
                        Rem #(7P)# Ergebnis Kerndaten Los/HNR kritisch ###
                        Label6.ForeColor = vbRed
                        Beep
                        CommandButton5.Enabled = True 'Schaltfl|fffd|che LosNr bearbeiten aktiv
                        Columns("K:K").Hidden = False 'Pr|fffd|fspalte LNR einblenden
                        Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                        If z = 1 Then
                            Label6.Caption = z & " kritischer Datensatz"
                        Else
                            Label6.Caption = z & " kritische Datens|fffd|tze"
                        End If
                        CommandButton5.SetFocus
                    End If '2A.2A.2A.12Z Ende Schleife HNR-Konformit|fffd|t
                Else '2A.2A.2B sonst (bei unplausiblen Kerndaten (hart))
                    Rem #(4E)# Ergebnis Kerndaten kritisch ###
                    Label8.ForeColor = vbRed
                    Beep
                    CommandButton6.Enabled = True 'Schaltfl|fffd|che Kerndaten bearbeiten aktiv
                    Columns("L:L").Hidden = False 'Pr|fffd|fspalte Kerndaten einblenden
                    Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                    Columns("HA:HD").Hidden = True 'Zusatzdaten ausblenden
                    If z = 1 Then
                        Label8.Caption = z & " kritischer Datensatz"
                    Else
                        Label8.Caption = z & " kritische Datens|fffd|tze"
                    End If
                    CommandButton6.SetFocus
                End If '2A.2A.2Z Ende Schleife Kerndaten (hart)
            Else '2A.2B sonst (bei unplausiblen Grunddaten)
                Rem #(3D)# Ergebnis Grunddaten kritisch ###
                Label4.ForeColor = vbRed
                Beep
                CommandButton4.Enabled = True 'Schaltfl|fffd|che Grunddaten bearbeiten aktiv
                Columns("J:J").Hidden = False 'Pr|fffd|fspalte Grunddaten einblenden
                Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
                Columns("HA:HD").Hidden = True 'Zusatzdaten ausblenden
                If Cells(2, 48).Value = 1 Then Columns("AH").Hidden _
                = False Else Columns("AH").Hidden = True 'Rotte lang
                If Cells(2, 49).Value = 1 Then Columns("AI").Hidden _
                = False Else Columns("AI").Hidden = True 'Farbe lang
                If z = 1 Then
                    Label4.Caption = z & " kritischer Datensatz"
                Else
                    Label4.Caption = z & " kritische Datens|fffd|tze"
                End If
                CommandButton4.SetFocus
            End If '2A.2Z Ende Schleife Grunddaten

        Else '2B sonst (bei unplausiblen Strukturdaten)
            Rem #(2D)# Ergebnis Strukturdaten kritisch ###
            Label2.ForeColor = vbRed
            Beep
            CommandButton3.Enabled = True 'Schaltfl|fffd|che Strukturdaten bearbeiten aktiv
            Columns("I:I").Hidden = False 'Pr|fffd|fspalte Strukturdaten einblenden
            Columns("Y:Y").Hidden = False 'Abstandsspalte einblenden
            If z = 1 Then
                Label2.Caption = z & " kritischer Datensatz"
            Else
                Label2.Caption = z & " kritische Datens|fffd|tze"
            End If
            i = Cells(2, 9).Value
            If Cells(i - 1, 53).Value = 5 Then
                Rows(i - 1).Hidden = False
            Else
                Rows("6:6").Hidden = False
            End If
            CommandButton3.SetFocus
        End If '2Z Ende Schleife Strukturdaten
        
Rem #(10A)# Markierung DS, wenn selbst plausibel, aber nicht im Gesamtzusammenhang ###
    For i = 7 To dzmax
        If Cells(i, 4).Value = 1 Then   '3A 1, wenn selbst plausibel,
                                        'aber nicht im Gesamtzusammenhang
            Cells(i, 2).Font.Color = vbRed
            If Cells(i, 132).Value = 9 Then Cells(i, 80).Font.Color = vbBlack _
            Else Cells(i, 80).Font.Color = vbRed 'Baumart Liste
            If Cells(i, 140).Value = 9 Then Cells(i, 81).Font.Color = vbBlack _
            Else Cells(i, 81).Font.Color = vbRed 'HNR Liste
            If Cells(i, 153).Value = 9 Then Cells(i, 82).Font.Color = vbBlack _
            Else Cells(i, 82).Font.Color = vbRed 'GKL Liste
            If Cells(i, 163).Value = 9 Then Cells(i, 83).Font.Color = vbBlack _
            Else Cells(i, 83).Font.Color = vbRed 'L|fffd|nge Liste
            If (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 9) _
            Or (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 0) = True Then _
            Cells(i, 84).Font.Color = vbBlack Else Cells(i, 84).Font.Color _
            = vbRed 'MDM Liste
            If Cells(i, 132).Value = 9 Then Cells(i, 106).Font.Color = vbBlack _
            Else Cells(i, 106).Font.Color = vbRed 'Baumart
            If Cells(i, 140).Value = 9 Then Cells(i, 107).Font.Color = vbBlack _
            Else Cells(i, 107).Font.Color = vbRed 'HNR
            If Cells(i, 153).Value = 9 Then Cells(i, 108).Font.Color = vbBlack _
            Else Cells(i, 108).Font.Color = vbRed 'GKL
            If Cells(i, 163).Value = 9 Then Cells(i, 109).Font.Color = vbBlack _
            Else Cells(i, 109).Font.Color = vbRed 'L|fffd|nge
            If (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 9) _
            Or (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 0) = True Then _
            Cells(i, 110).Font.Color = vbBlack Else Cells(i, 110).Font.Color = vbRed 'MDM
            If Cells(i, 199).Value = 9 Then Cells(i, 111).Font.Color = vbBlack _
            Else Cells(i, 111).Font.Color = vbRed 'Klammerstamm
            If Cells(i, 200).Value = 9 Then Cells(i, 112).Font.Color = vbBlack _
            Else Cells(i, 112).Font.Color = vbRed 'L|fffd|nge/MDM
            If (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 9) _
            Or (Cells(i, 167).Value = 9 And Cells(i, 215).Value = 0) = True Then _
            Cells(i, 113).Font.Color = vbBlack Else Cells(i, 113).Font.Color = vbRed 'MDM>99
        Else '3B
            Cells(i, 2).Font.Color = vbBlack
            Cells(i, 80).Font.Color = vbBlack
            Cells(i, 81).Font.Color = vbBlack
            Cells(i, 82).Font.Color = vbBlack
            Cells(i, 83).Font.Color = vbBlack
            Cells(i, 84).Font.Color = vbBlack
            Cells(i, 106).Font.Color = vbBlack
            Cells(i, 107).Font.Color = vbBlack
            Cells(i, 108).Font.Color = vbBlack
            Cells(i, 109).Font.Color = vbBlack
            Cells(i, 110).Font.Color = vbBlack
            Cells(i, 111).Font.Color = vbBlack
            Cells(i, 112).Font.Color = vbBlack
            Cells(i, 113).Font.Color = vbBlack
        End If '3Z
        Next i
    Columns("B:B").Hidden = False
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Plausipr|fffd|fung ABBRECHEN ###
    Dim i As Integer
    MsgBox "Plausibilit|fffd|tspr|fffd|fung wird abgebrochen, Gesamtdatensicht wiederhergestellt", _
    64, "Funktion Plausibilit|fffd|tspr|fffd|fung"
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Columns("B:B").Hidden = False
    Columns("I:N").Hidden = True
    Columns("X:X").Hidden = True
    Columns("AA:AG").Hidden = False 'Grunddaten einblenden
    Columns("HA:HD").Hidden = False 'Zusatzdaten einblenden
    Rows("6:6").Hidden = True
    Rows("7:506").Hidden = False
    Range("A7:IH506").Select
    
    Selection.Sort Key1:=Range("B7"), Order1:=xlAscending, Key2:=Range("A7") _
    , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    
    If Cells(2, 2).Value > 1 Then
        For i = 7 To Cells(2, 115).Value
            Rows(i).Hidden = False
            Next i
        For i = Cells(2, 115).Value + 1 To 506
            Rows(i).Hidden = True
            Next i
    Else
        Rows("7:506").Hidden = False
    End If
    Cells(4, 8).Value = 0 'Flag Plausibearbeitung zur|fffd|cksetzen
    Cells(5, 27).Select
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 25").Enabled = True
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 28").Enabled = True
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 439").Enabled = True
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton3_Click()
Rem ### Schaltfl|fffd|che Strukturdaten Bearbeiten ###
    Dim i As Integer
    ActiveSheet.Unprotect ("mallnitz")
    UserForm2.Hide
    Columns("I:I").Hidden = False
    i = Cells(2, 9).Value
    Application.ScreenUpdating = True
    Cells(i, 9).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton4_Click()
Rem ### Schaltfl|fffd|che Grunddaten Bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Columns("J:J").Hidden = False
    i = Cells(2, 10).Value
    Application.ScreenUpdating = True
    Cells(i, 27).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton5_Click()
Rem ### Schaltfl|fffd|che Kerndaten Los/HNR Bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationAutomatic
    Columns("K:K").Hidden = False
    Rows("7:506").Hidden = False
    Range("A7:IH506").Select
    Selection.Sort Key1:=Range("B7"), Order1:=xlAscending, Key2:=Range("A7") _
    , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    Application.Calculation = xlCalculationManual
    For i = 7 To 506
        If Cells(i, 4).Value = 1 Then
            Rows(i).Hidden = False
            Else
            Rows(i).Hidden = True
            End If
        Next i
    i = Cells(2, 11).Value
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    If Cells(2, 2).Value = 1 Then Cells(i, 80).Select Else Cells(i, 106).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton6_Click()
Rem ### Schaltfl|fffd|che Kerndaten Bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    ActiveSheet.Unprotect ("mallnitz")
    Columns("L:L").Hidden = False
    For i = 7 To 506
        If Cells(i, 4).Value = 1 Then
            Rows(i).Hidden = False
            Else
            Rows(i).Hidden = True
            End If
        Next i
    i = Cells(2, 12).Value
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    If Cells(2, 2).Value = 1 Then Cells(i, 80).Select Else Cells(i, 106).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton7_Click()
Rem ### Schaltfl|fffd|che Zusatzdaten Bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Columns("M:M").Hidden = False
    i = Cells(2, 13).Value
    Application.ScreenUpdating = True
    Cells(i, 210).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton8_Click()
Rem ### Schaltfl|fffd|che Plausipr|fffd|fung ok ###
    Dim i As Integer
    Dim dzmax As Integer
    UserForm2.Hide
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    ActiveSheet.Unprotect ("mallnitz")
    dzmax = Cells(3, 4).Value
    If Cells(2, 2).Value > 1 Then
        For i = 7 To Cells(2, 115).Value
            Rows(i).Hidden = False
            Next i
        For i = Cells(2, 115).Value + 1 To dzmax
            Rows(i).Hidden = True
            Next i
        Else
        Rows("7:" & dzmax).Hidden = False
        End If
    Columns("B:B").Hidden = False
    Columns("I:M").Hidden = True
    Rows("6:6").Hidden = True
    Cells(2, 2).Activate
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 25").Enabled = True
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 28").Enabled = True
    Sheets("DATEN").DrawingObjects("Schaltfl|fffd|che 439").Enabled = True
    Application.Calculation = xlCalculationAutomatic
    If Sheets("ABIES").Cells(3, 10).Value = "ja" Then
        If Sheets("DATEN").Cells(2, 236).Value = Sheets("ABIES").Cells(2, 21).Value Then
            Sheets("DATEN").Cells(2, 239).Value = "J"
            Sheets("DATEN").Cells(4, 239).Font.Color = vbGreen
        Else
            Sheets("DATEN").Cells(2, 239).Value = "L"
            Sheets("DATEN").Cells(4, 239).Font.Color = vbRed
        End If
    Else
    End If
    Cells(4, 8).Value = 0 'Flag Plausibearbeitung zur|fffd|cksetzen
    Application.ScreenUpdating = True
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton9_Click()
Rem ### Schaltfl|fffd|che L|fffd|nge nicht RVR-konform bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Columns("N:N").Hidden = False
    i = Cells(2, 14).Value
    Application.ScreenUpdating = True
    Cells(i, 106).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton10_Click()
Rem ### Schaltfl|fffd|che weiter trotz L|fffd|nge nicht RVR-konform ###
    Cells(2, 16).Value = 1
    CommandButton9.Visible = False
    CommandButton10.Visible = False
    Label19.Caption = "ohne Nachbearbeitung fortgesetzt"
    Label19.ForeColor = vbRed
    Plausibilitaetspruefung
End Sub

Private Sub CommandButton11_Click()
Rem ### Schaltfl|fffd|che Datens|fffd|tze mit identischer GKL bearbeiten ###
    Dim i As Integer
    UserForm2.Hide
    ActiveSheet.Unprotect ("mallnitz")
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Columns("X:X").Hidden = False
    For i = 7 To 506
        If Cells(i, 186).Value = 1 Then
            Rows(i).Hidden = False
            Else
            Rows(i).Hidden = True
            End If
        Next i
    i = Cells(2, 24).Value
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Cells(i, 106).Select
    ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton12_Click()
Rem ### Schaltfl|fffd|che weiter trotz Datens|fffd|tze mit identischer GKL ###
    Cells(3, 16).Value = 1
    CommandButton11.Visible = False
    CommandButton12.Visible = False
    Label21.Visible = False
    Label22.Caption = "ohne Nachbearbeitung fortgesetzt"
    Label22.ForeColor = vbRed
    Plausibilitaetspruefung
End Sub

Attribute VB_Name = "UserForm3"
Attribute VB_Base = "0{2B76439B-BB6E-4128-8314-FB78079022C3}{8C4D64E8-49EF-49A5-82C0-004D7BFC6B59}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Passwort pr|fffd|fen ###
Dim dzmax As Integer 'Maximalzahl m|fffd|glicher Datenzeilen
Dim kv As Integer 'Zeilennummer Kopiervorlage
Const passwblattschutz = "mallnitz"
Const passwzurucksetzen = "kisangani"
dzmax = Cells(3, 4).Value
kv = Sheets("DATEN").Cells(4, 4).Value
If TextBox1.Value = passwblattschutz Then
    UserForm3.Hide
    Sheets("DATEN").Select
        Dim cb As CommandBar
        For Each cb In Application.CommandBars
            cb.Enabled = True
            Next cb
        With ActiveWindow
        .DisplayHeadings = True
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = True
        .DisplayWorkbookTabs = True
        End With
        With Application
        .DisplayStatusBar = True
        .DisplayFormulaBar = True
        End With
        Application.CommandBars("Standard").Visible = True
        Application.CommandBars("Formatting").Visible = True
        Sheets("DATEN").Unprotect ("mallnitz")
        Columns("A:IH").Hidden = False
        Columns("IJ:IM").Hidden = False
        Columns("E:G").Hidden = True
        Columns("I:N").Hidden = True
        Columns("P:Y").Hidden = True
        Rows("1:3").Hidden = False
        Rows("6:6").Hidden = False
        Rows("7:" & dzmax + 5).Hidden = False
        Rows(kv).Hidden = False
    Sheets("ABIES").Visible = True
    Sheets("ABIES").Select
    
        For Each cb In Application.CommandBars
            cb.Enabled = True
            Next cb
        With ActiveWindow
        .DisplayHeadings = True
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = True
        .DisplayWorkbookTabs = True
        End With
        With Application
        .DisplayStatusBar = True
        .DisplayFormulaBar = True
        End With
        Sheets("ABIES").Unprotect ("mallnitz")
    Sheets("KOPF").Visible = True
    Sheets("KOPF").Select
        For Each cb In Application.CommandBars
            cb.Enabled = True
            Next cb
        With ActiveWindow
        .DisplayHeadings = True
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = True
        .DisplayWorkbookTabs = True
        End With
        With Application
        .DisplayStatusBar = True
        .DisplayFormulaBar = True
        End With
    Sheets("SD").Visible = True
    Sheets("SD").Select
        For Each cb In Application.CommandBars
            cb.Enabled = True
            Next cb
        With ActiveWindow
        .DisplayHeadings = True
        .DisplayHorizontalScrollBar = True
        .DisplayVerticalScrollBar = True
        .DisplayWorkbookTabs = True
        End With
        With Application
        .DisplayStatusBar = True
        .DisplayFormulaBar = True
        End With
        Sheets("SD").Unprotect ("mallnitz")
    Sheets("P").Visible = True
    Sheets("P").Unprotect ("mallnitz")
    Sheets("DATEN").Select
    Unload Me
Else
    Label2.Visible = True
    TextBox1.SetFocus
    TextBox1.SelStart = 0
    TextBox1.SelLength = Len(TextBox1.Text)
    End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
UserForm3.Hide
Unload Me
End Sub
Attribute VB_Name = "UserForm4"
Attribute VB_Base = "0{83C18D9E-F3B9-45D7-94E6-FF895ED5CEA8}{FE862713-00B4-41EF-8166-9D059D6ED0C2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox4_Click()
Rem ### Kontrollk|fffd|stchenfeld Baumart ###
If CheckBox4.Value = True Then
    Cells(2, 106).Value = 1
    If TextBox1.Value = "" Then
        TextBox1.Enabled = True
    Else
        TextBox1.Enabled = False
    End If
Else
    Cells(2, 106).Value = 0
    TextBox1.Enabled = True
End If
End Sub

Private Sub CheckBox5_Click()
Rem ### Kontrollk|fffd|stchenfeld GKL ###
If CheckBox5.Value = True Then
    Cells(2, 108).Value = 1
    If TextBox4.Value = "" Then
        TextBox4.Enabled = True
    Else
        TextBox4.Enabled = False
    End If
Else
    Cells(2, 108).Value = 0
    TextBox4.Enabled = True
End If
End Sub

Private Sub CheckBox6_Click()
Rem ### Kontrollk|fffd|stchenfeld L|fffd|nge ###
If CheckBox6.Value = True Then
    Cells(2, 109).Value = 1
    If TextBox5.Value = "" Then
        TextBox5.Enabled = True
    Else
        TextBox5.Enabled = False
    End If
Else
    Cells(2, 109).Value = 0
    TextBox5.Enabled = True
End If
End Sub

Private Sub CommandButton1_Click()
Rem ### Schaltl|fffd|che |fffd|bernehmen ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
'Application.ScreenUpdating = True
Application.Calculation = xlCalculationManual
Rows(z).Hidden = False
Cells(z, 106).Value = TextBox1.Value
Rem ### Textfeld Baumart leer ###
If Cells(z, 106).Value = "" Then
    TextBox1.SetFocus
    TextBox1.BackColor = vbYellow
    Beep
    Else
    Rem ### Textfeld Baumart mit Wert ###
    TextBox1.BackColor = vbWhite
    Cells(z, 107).Value = TextBox2.Value
    Rem ### Textfeld Holznummer leer ###
    If Cells(z, 107).Value = "" Then
        TextBox2.SetFocus
        TextBox2.BackColor = vbYellow
        Beep
        Else
        Rem ### Textfeld Holznummer mit Wert ###
        TextBox2.BackColor = vbWhite
        Rem ### Textfeld Klammerstamm ohne / mit Wert ###
        If TextBox3.Value = "" Then
            Cells(z, 111).Value = ""
            Else
            Cells(z, 111).Value = Cells(z, 191).Value
            End If
        Cells(z, 108).Value = TextBox4.Value
        Rem ### Textfeld GKL leer ###
        If Cells(z, 108).Value = "" Then
            TextBox4.SetFocus
            TextBox4.BackColor = vbYellow
            Beep
            Else
            Rem ### Textfeld GKL mit Wert ###
            TextBox4.BackColor = vbWhite
            Cells(z, 109).Value = TextBox5.Value
            Rem ### Textfeld L|fffd|nge leer ###
            If Cells(z, 109).Value = "" Then
                TextBox5.SetFocus
                TextBox5.BackColor = vbYellow
                Beep
                Else
                Rem ### Textfeld L|fffd|nge mit Wert ###
                TextBox5.BackColor = vbWhite
                Cells(z, 109).Value = Str(TextBox5.Value)
                Cells(z, 110).Value = TextBox6.Value
                Rem ### Textfeld MDM leer ###
                If Cells(z, 110).Value = "" Then
                    TextBox6.SetFocus
                    TextBox6.BackColor = vbYellow
                    Beep
                    Else
                    Rem ### Textfeld MDM mit Wert ###
                    TextBox6.BackColor = vbwhithe
                    If Cells(2, 115).Value > 5 Then
                        Rem ### |fffd|bernahme Grunddaten aus Vorzeile ###
                        Cells(z, 27).Value = Cells(z - 1, 27).Value
                        Cells(z, 28).Value = Cells(z - 1, 28).Value
                        Cells(z, 29).Value = Cells(z - 1, 29).Value
                        Cells(z, 30).Value = Cells(z - 1, 30).Value
                        Cells(z, 31).Value = Cells(z - 1, 31).Value
                        Cells(z, 32).Value = Cells(z - 1, 32).Value
                        Cells(z, 33).Value = Cells(z - 1, 33).Value
                    Else
                    End If
                    Cells(2, 115).Value = Cells(2, 115).Value + 1
                    Rem ### Pr|fffd|fung auf maximale Datensatzzahl ###
                    If Cells(2, 115).Value > 506 Then
                        MsgBox ("maximale Anzahl Datens|fffd|tze erreicht - weitere Erfassung nicht m|fffd|glich")
                        Cells(2, 115).Value = Cells(2, 115).Value - 1
                        Cells(z, 27).Value = ""
                        Cells(z, 28).Value = ""
                        Cells(z, 29).Value = ""
                        Cells(z, 30).Value = ""
                        Cells(z, 31).Value = ""
                        Cells(z, 32).Value = ""
                        Cells(z, 33).Value = ""
                        CommandButton2.SetFocus
                        Else
                        Rem ### neue Zeile einblenden ###
                        'Rows(z + 1).Hidden = False
                        Rem ### |fffd|bernahme Defaultwerte aus aktiver Zeile in Erfassungsmaske ###
                        Application.Calculation = xlCalculationAutomatic
                        UserForm4.TextBox1.Value = Cells(z, 134).Value
                        If Cells(2, 106).Value = 1 Then
                            TextBox1.Enabled = False
                            Else
                            TextBox1.Enabled = True
                            End If
                        If Cells(z, 116).Value = 1 Then
                            UserForm4.TextBox2.Value = Cells(z, 107).Value
                            UserForm4.TextBox4.Value = ""
                            Else
                            UserForm4.TextBox2.Value = Cells(z, 107).Value + 1
                            UserForm4.TextBox4.Value = Cells(z, 154).Value
                            End If
                        Application.Calculation = xlCalculationAutomatic
                        If Cells(2, 108).Value = 1 Then
                            TextBox4.Enabled = False
                            Else
                            TextBox4.Enabled = True
                            End If
                        UserForm4.TextBox3.Value = ""
                        UserForm4.TextBox5.Value = Cells(z, 109).Value
                        UserForm4.TextBox5.Value = Format(UserForm4.TextBox5.Value, "#0.00")
                        If Cells(2, 109).Value = 1 Then
                            TextBox5.Enabled = False
                            Else
                            TextBox5.Enabled = True
                            End If
                        UserForm4.TextBox6.Value = ""
                        If Cells(z, 116).Value = 1 Then
                            TextBox3.SetFocus
                            TextBox4.Enabled = True
                            Else
                            If Cells(2, 106).Value = 1 Then
                                    If Cells(2, 108).Value = 1 Then
                                            If Cells(2, 109).Value = 1 Then
                                                UserForm4.TextBox6.SetFocus
                                                Else
                                                UserForm4.TextBox5.SelStart = 0
                                                UserForm4.TextBox5.SelLength = Len(UserForm4.TextBox5.Text)
                                                UserForm4.TextBox5.SetFocus
                                                End If
                                        Else
                                        UserForm4.TextBox4.SelStart = 0
                                        UserForm4.TextBox4.SelLength = Len(UserForm4.TextBox4.Text)
                                        UserForm4.TextBox4.SetFocus
                                        End If
                                Else
                                UserForm4.TextBox1.SelStart = 0
                                UserForm4.TextBox1.SelLength = Len(UserForm4.TextBox1.Text)
                                UserForm4.TextBox1.SetFocus
                                End If
                            End If
                        Label9.Caption = Cells(z + 1, 2).Value
                        Application.ScreenUpdating = True
                        Application.ScreenUpdating = False
                        End If
                    End If
                End If
            End If
        End If
    End If
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Abbrechen ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If Cells(z - 1, 116).Value = 1 Then
    If MsgBox("Klammerstammerfassung nicht abgeschlossen - Abbruch f|fffd|hrt zu" _
    & " unplausiblen Datens|fffd|tzen! Soll Vorgang trotzdem abgebrochen werden?", _
    vbYesNo + 48 + 256, "Funktion Daten erfassen") = vbNo Then
        Exit Sub
    Else
    End If
Else
End If
Sheets("DATEN").Unprotect ("mallnitz")
Cells(z, 106).Value = ""
Cells(z, 107).Value = ""
Cells(z, 108).Value = ""
Cells(z, 109).Value = ""
Cells(z, 110).Value = ""
Cells(z, 111).Value = ""
Rows(z).Hidden = True
If Cells(2, 4).Value > 6 Then
    Cells(7, 106).Select
Else
    Cells(4, 27).Select
End If
Sheets("DATEN").Protect ("mallnitz")
Sheets("DATEN").Select
UserForm4.Hide
Unload Me
End Sub

Private Sub CommandButton3_Click()
Cells(2, 26).Value = 4
UserForm9.Show
End Sub

Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Baumart ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 106).Value = TextBox1.Value
TextBox1.Value = Cells(z, 134).Value
If Cells(z, 128).Value = 1 Or TextBox1.Value = "" = True Then
    Label11.Visible = True
    TextBox1.Value = ""
    TextBox1.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox1.SetFocus
Else
    Label11.Visible = False
    TextBox1.BackColor = vbWhite
End If
End Sub

Private Sub TextBox2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Holznummer ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 107).Value = TextBox2.Value
If Cells(z, 141).Value < 9 Or TextBox2.Value = "" = True Then
    Label12.Visible = True
    TextBox2.Value = ""
    TextBox2.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox2.SetFocus
Else
    Label12.Visible = False
    TextBox2.BackColor = vbWhite
End If
End Sub

Private Sub Textbox3_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Klammerstamm ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If TextBox3.Value = "" Then
    Cells(z, 191).Value = ""
Else
    Cells(z, 191).Value = "x"
    TextBox4.Enabled = True
End If
End Sub

Private Sub Textbox4_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld GKL ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 108).Value = TextBox4.Value
TextBox4.Value = Cells(z, 154).Value
If Cells(z, 153).Value = 1 Or TextBox4.Value = "" = True Then
    Label13.Visible = True
    TextBox4.Value = ""
    TextBox4.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox4.SetFocus
Else
    Label13.Visible = False
    TextBox4.BackColor = vbWhite
End If
End Sub

Private Sub TextBox5_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld L|fffd|nge ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If IsNumeric(TextBox5.Value) Then
    Cells(z, 109).Value = Str(TextBox5.Value)
Else
    Cells(z, 109).Value = TextBox5.Value
End If
Application.Calculation = xlCalculationAutomatic
If Cells(z, 159).Value = 1 Or TextBox5.Value = "" = True Then
    Label14.Visible = True
    TextBox5.Value = ""
    TextBox5.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox5.SetFocus
Else
    Label14.Visible = False
    TextBox5.BackColor = vbWhite
End If
End Sub

Private Sub TextBox6_Change()
Rem ### Textfeld MDM ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If IsNumeric(TextBox6.Value) And TextBox6.Value >= 10 = True Then
    TextBox6.BackColor = vbWhite
    CommandButton1.SetFocus
Else
    If IsNumeric(TextBox6.Value) = True Then
        TextBox6.BackColor = vbWhite
    Else
        TextBox6.Value = ""
        TextBox6.BackColor = vbYellow
        'Beep
    End If
End If
End Sub
Attribute VB_Name = "UserForm5"
Attribute VB_Base = "0{76FAD3A4-A182-4105-BE50-E4BBC99873CE}{DB56D43F-2488-44EF-9BD6-27D9BCC6C124}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox4_Click()
Rem ### Kontrollk|fffd|stchenfeld Baumart ###
If CheckBox4.Value = True Then
    Cells(2, 106).Value = 1
    If TextBox1.Value = "" Then
        TextBox1.Enabled = True
    Else
        TextBox1.Enabled = False
    End If
Else
    Cells(2, 106).Value = 0
    TextBox1.Enabled = True
End If
End Sub

Private Sub CheckBox5_Click()
Rem ### Kontrollk|fffd|stchenfeld GKL ###
If CheckBox5.Value = True Then
    Cells(2, 108).Value = 1
    If TextBox4.Value = "" Then
        TextBox4.Enabled = True
    Else
        TextBox4.Enabled = False
    End If
Else
    Cells(2, 108).Value = 0
    TextBox4.Enabled = True
End If
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Abbrechen ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If Cells(z - 1, 116).Value = 1 Then
    If MsgBox("Klammerstammerfassung nicht abgeschlossen - Abbruch f|fffd|hrt zu" _
    & " unplausiblen Datens|fffd|tzen! Soll Vorgang trotzdem abgebrochen werden?", _
    vbYesNo + 48 + 256, "Funktion Daten erfassen") = vbNo Then
        Exit Sub
    Else
    End If
Else
End If
Sheets("DATEN").Unprotect ("mallnitz")
Cells(z, 106).Value = ""
Cells(z, 107).Value = ""
Cells(z, 108).Value = ""
Cells(z, 109).Value = ""
Cells(z, 110).Value = ""
Rows(z).Hidden = True
If Cells(2, 4).Value > 6 Then
    Cells(7, 106).Select
Else
    Cells(4, 27).Select
End If
Sheets("DATEN").Protect ("mallnitz")
UserForm5.Hide
Unload Me
End Sub

Private Sub CommandButton3_Click()
Rem ### Schaltfl|fffd|che |fffd|bernehmen (Erstdatensatz) ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Application.ScreenUpdating = False
Rows(z).Hidden = False
Cells(z, 106).Value = TextBox1.Value
If Cells(z, 106).Value = "" Then
    TextBox1.SetFocus
    TextBox1.BackColor = vbYellow
    Beep
Else
    TextBox1.BackColor = vbWhite
    Cells(z, 107).Value = TextBox2.Value
    If Cells(z, 107).Value = "" Then
        TextBox2.SetFocus
        TextBox2.BackColor = vbYellow
        Beep
    Else
        TextBox2.BackColor = vbWhite
        Cells(z, 108).Value = TextBox4.Value
        If Cells(z, 108).Value = "" Then
            TextBox4.SetFocus
            TextBox4.BackColor = vbYellow
            Beep
        Else
            TextBox4.BackColor = vbWhite
            If Cells(z, 112).Value = "" Then
                CommandButton2.SetFocus
            Else
                'Rows(z + 1).Hidden = False
                Cells(2, 115).Value = Cells(2, 115).Value + 1
                Application.ScreenUpdating = True
                Label9.Caption = Cells(z + 1, 2).Value
                If Cells(2, 115).Value > 5 Then
                'If Cells(2, 115).Value > 7 Then
                    Cells(z, 27).Value = Cells(z - 1, 27).Value
                    Cells(z, 28).Value = Cells(z - 1, 28).Value
                    Cells(z, 29).Value = Cells(z - 1, 29).Value
                    Cells(z, 30).Value = Cells(z - 1, 30).Value
                    Cells(z, 31).Value = Cells(z - 1, 31).Value
                    Cells(z, 32).Value = Cells(z - 1, 32).Value
                    Cells(z, 33).Value = Cells(z - 1, 33).Value
                Else
                End If
                UserForm5.TextBox1.Value = Cells(z, 134).Value
                If Cells(z, 116).Value = 1 Then
                    TextBox2.Value = Cells(z, 107).Value
                Else
                    TextBox2.Value = Cells(z, 107).Value + 1
                End If
                TextBox5.Value = ""
                TextBox5.BackColor = vbWhite
                Cancel = True
                CommandButton3.Enabled = False
                CommandButton2.Enabled = False
                If Cells(z, 116).Value = 1 Or Cells(2, 108).Value = 0 = True Then
                    TextBox4.SelStart = 0
                    TextBox4.SelLength = Len(TextBox4.Text)
                    TextBox4.SetFocus
                    CommandButton2.Enabled = True
                Else
                    TextBox5.SetFocus
                End If
            End If
        End If
    End If
End If
Application.ScreenUpdating = True
End Sub

Private Sub CommandButton4_Click()
Rem ### Schaltfl|fffd|che Baumartenkatalog einblenden ###
Cells(2, 26).Value = 5
UserForm9.Show
End Sub

Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Baumart ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 106).Value = TextBox1.Value
TextBox1.Value = Cells(z, 134).Value
If Cells(z, 128).Value = 1 Or TextBox1.Value = "" = True Then
    Label11.Visible = True
    TextBox1.Value = ""
    TextBox1.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox1.SetFocus
Else
    Label11.Visible = False
    TextBox1.BackColor = vbWhite
End If
End Sub

Private Sub TextBox2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Holznummer ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 107).Value = TextBox2.Value
If Cells(z, 141).Value < 9 Or TextBox2.Value = "" = True Then
    Label12.Visible = True
    TextBox2.Value = ""
    TextBox2.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox2.SetFocus
Else
    Label12.Visible = False
    TextBox2.BackColor = vbWhite
End If
End Sub

Private Sub Textbox4_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld GKL ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 108).Value = TextBox4.Value
TextBox4.Value = Cells(z, 154).Value
If Cells(z, 153).Value = 1 Or TextBox4.Value = "" = True Then
    Label13.Visible = True
    TextBox4.Value = ""
    TextBox4.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox4.SetFocus
Else
    Label13.Visible = False
    TextBox4.BackColor = vbWhite
    CommandButton2.Enabled = True
End If
End Sub

Private Sub TextBox5_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld L|fffd|nge/MDM ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Application.ScreenUpdating = False
If TextBox5.Value = "" Then
Else
Rows(z).Hidden = False
End If
Cells(z, 112).Value = TextBox5.Value
If CommandButton3.Enabled = True Then
    CommandButton3.SetFocus
Else
    Rem ### Textfeld L|fffd|nge/MDM leer ###
    If TextBox5.Value = "" Then
        If CommandButton2.Enabled = True Then
            CommandButton2.SetFocus
        Else
            CommandButton2.Enabled = True
        End If
    Else
        Rem ### Textfeld L|fffd|nge/MDM mit Wert ###
        Cells(z, 112).Value = TextBox5.Value
        Rem ### Pr|fffd|fung L|fffd|nge / MDM unzul|fffd|ssig ###
        If Cells(z, 159).Value = 1 Or Cells(z, 167).Value = 1 _
        Or Cells(z, 167).Value = 8 Or TextBox5.Value = "" = True Then
            Label14.Visible = True
            TextBox5.Value = ""
            TextBox5.BackColor = vbYellow
            Beep
            Cancel = True
            TextBox5.SetFocus
        Else
            Rem ### L|fffd|nge / MDM zul|fffd|ssig ###
            Label14.Visible = False
            TextBox5.BackColor = vbWhite
            Rem ### Daten |fffd|bernehmen ###
            Cells(z, 106).Value = TextBox1.Value
            Rem ### Textfeld Baumart leer
            If Cells(z, 106).Value = "" Then
                TextBox1.SetFocus
                TextBox1.BackColor = vbYellow
            Else
                Rem ### Textfeld Baumart mit Wert ###
                TextBox1.BackColor = vbWhite
                Cells(z, 107).Value = TextBox2.Value
                Rem ### Textfeld Holznummer leer ###
                If Cells(z, 107).Value = "" Then
                    TextBox2.SetFocus
                    TextBox2.BackColor = vbYellow
                Else
                    Rem ### Textfeld Holznummer mit Wert ###
                    TextBox2.BackColor = vbWhite
                    Cells(z, 108).Value = TextBox4.Value
                    Rem ### Textfeld GKL leer ###
                    If Cells(z, 108).Value = "" Then
                        TextBox4.SetFocus
                        TextBox4.BackColor = vbYellow
                    Else
                        Rem ### Textfeld GKL mit Wert ###
                        TextBox4.BackColor = vbWhite
                        'Rows(z + 1).Hidden = False
                        Label9.Caption = Cells(z + 1, 2).Value
                        'If Cells(2, 115).Value > 6 Then
                        If Cells(2, 115).Value > 5 Then
                            Cells(z, 27).Value = Cells(z - 1, 27).Value
                            Cells(z, 28).Value = Cells(z - 1, 28).Value
                            Cells(z, 29).Value = Cells(z - 1, 29).Value
                            Cells(z, 30).Value = Cells(z - 1, 30).Value
                            Cells(z, 31).Value = Cells(z - 1, 31).Value
                            Cells(z, 32).Value = Cells(z - 1, 32).Value
                            Cells(z, 33).Value = Cells(z - 1, 33).Value
                        Else
                        End If
                        Cells(2, 115).Value = Cells(2, 115).Value + 1
                        If Cells(2, 115).Value > 506 Then
                            MsgBox ("maximale Anzahl Datens|fffd|tze erreicht - weitere" _
                            & " Erfassung nicht m|fffd|glich")
                            Beep
                            Cells(2, 115).Value = Cells(2, 115).Value - 1
                            Cells(z, 27).Value = ""
                            Cells(z, 28).Value = ""
                            Cells(z, 29).Value = ""
                            Cells(z, 30).Value = ""
                            Cells(z, 31).Value = ""
                            Cells(z, 32).Value = ""
                            Cells(z, 33).Value = ""
                            CommandButton2.SetFocus
                        Else
                            UserForm5.TextBox1.Value = Cells(z, 134).Value
                            If Cells(z, 116).Value = 1 Then
                                TextBox2.Value = Cells(z, 107).Value
                            Else
                                TextBox2.Value = Cells(z, 107).Value + 1
                            End If
                            TextBox5.Value = ""
                            TextBox5.BackColor = vbWhite
                            Cancel = True
                            TextBox5.SetFocus
                            If Cells(z, 116).Value = 1 Or Cells(2, 108).Value = 0 = True Then
                                TextBox4.SelStart = 0
                                TextBox4.SelLength = Len(TextBox4.Text)
                                TextBox4.SetFocus
                            Else
                            End If
                            Application.ScreenUpdating = True
                        End If
                    End If
                End If
            End If
        End If
    End If
End If
Application.ScreenUpdating = True
End Sub

Attribute VB_Name = "UserForm6"
Attribute VB_Base = "0{DA36F938-4A60-46FA-A16C-9B0C5A513464}{126CB962-9412-4777-B457-E4B9500A5D26}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox5_Click()
Rem ### Kontrollk|fffd|stchenfeld GKL ###
If CheckBox5.Value = True Then
    Cells(2, 108).Value = 1
    If TextBox4.Value = "" Then
        TextBox4.Enabled = True
    Else
        TextBox4.Enabled = False
    End If
Else
    Cells(2, 108).Value = 0
    TextBox4.Enabled = True
End If
End Sub

Private Sub CheckBox6_Click()
Rem ### Kontrollk|fffd|stchenfeld L|fffd|nge ###
If CheckBox6.Value = True Then
    Cells(2, 109).Value = 1
    If TextBox5.Value = "" Then
        TextBox5.Enabled = True
    Else
        TextBox5.Enabled = False
    End If
Else
    Cells(2, 109).Value = 0
    TextBox5.Enabled = True
End If
End Sub

Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che |fffd|bernehmen ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
'z = Sheets("DATEN").Cells(2, 192).Value + 1
Application.ScreenUpdating = False
Rows(z).Hidden = False
'Application.Calculation = xlCalculationManual
Cells(z, 106).Value = TextBox1.Value
If Cells(z, 106).Value = "" Then
    Rem ### Baumart leer ###
    TextBox1.SetFocus
    TextBox1.BackColor = vbYellow
    Beep
Else
    Rem ### Baumart mit Wert
    TextBox1.BackColor = vbWhite
    Cells(z, 107).Value = TextBox2.Value
    If Cells(z, 107).Value = "" Then
        Rem ### Holznummer leer ###
        TextBox2.SetFocus
        TextBox2.BackColor = vbYellow
        Beep
    Else
        Rem ### Holznummer mit Wert ###
        TextBox2.BackColor = vbWhite
        If Cells(z, 116).Value = 0 Then
            Cells(z, 111).Value = ""
        Else
            Cells(z, 111).Value = "x"
        End If
        Cells(z, 192).Value = TextBox4.Value
        Cells(z, 108).Value = Cells(z, 193).Value
        If Cells(z, 193).Value = "" Then
            Rem ### GKL leer ###
            TextBox4.SetFocus
            TextBox4.BackColor = vbYellow
            Beep
        Else
            Rem ### GKL mit Wert ###
            TextBox4.BackColor = vbWhite
            Cells(z, 194).Value = TextBox5.Value
            If Cells(z, 116).Value = 0 Then
                Rem ### L|fffd|ngentransformation in m bei Nichtklammerstamm ###
                Cells(z, 109).Value = Cells(z, 194).Value / 10
            Else
                Rem ### L|fffd|ngentransformation in m bei Klammerstamm ###
                Cells(z, 109).Value = Cells(z, 194).Value / 10 * (-1)
            End If
            If Cells(z, 194).Value = "" Then
                Rem ### L|fffd|nge leer ###
                TextBox5.SetFocus
                TextBox5.BackColor = vbYellow
                Beep
            Else
                Rem ### L|fffd|nge nicht leer ###
                TextBox5.BackColor = vbWhite
                Cells(z, 110).Value = TextBox6.Value
                If Cells(z, 110).Value = "" Then
                    Rem ### MDM leer ###
                    TextBox6.SetFocus
                    TextBox6.BackColor = vbYellow
                    Beep
                Else
                    Rem ### MDM mit Wert ###
                    TextBox6.BackColor = vbWhite
                    Rem ### neue Datenzeile einblenden und Pr|fffd|fung auf Max.zahl ###
                    'Rows(z + 1).Hidden = False
                    Application.Calculation = xlCalculationAutomatic
                    'If Cells(2, 115).Value > 6 Then
                    If Cells(2, 115).Value > 5 Then
                        Cells(z, 27).Value = Cells(z - 1, 27).Value
                        Cells(z, 28).Value = Cells(z - 1, 28).Value
                        Cells(z, 29).Value = Cells(z - 1, 29).Value
                        Cells(z, 30).Value = Cells(z - 1, 30).Value
                        Cells(z, 31).Value = Cells(z - 1, 31).Value
                        Cells(z, 32).Value = Cells(z - 1, 32).Value
                        Cells(z, 33).Value = Cells(z - 1, 33).Value

                    Else
                    End If
                    Cells(2, 115).Value = Cells(2, 115).Value + 1
                    If Cells(2, 115).Value > 506 Then
                        MsgBox ("maximale Anzahl Datens|fffd|tze erreicht - weitere Erfassung" _
                        & " nicht m|fffd|glich")
                        Cells(2, 115).Value = Cells(2, 115).Value - 1
                        Cells(z, 27).Value = ""
                        Cells(z, 28).Value = ""
                        Cells(z, 29).Value = ""
                        Cells(z, 30).Value = ""
                        Cells(z, 31).Value = ""
                        Cells(z, 32).Value = ""
                        Cells(z, 33).Value = ""
                        CommandButton2.SetFocus
                    Else
                        Rem ### Defaultwert in Erfassungsmaske ###
                        UserForm6.TextBox1.Value = Cells(z, 134).Value
                        TextBox6.Value = ""
                        If Cells(z, 116).Value = 1 Then
                            UserForm6.TextBox2.Value = Cells(z, 107).Value
                            TextBox4.Value = ""
                            TextBox5.Value = ""
                        Else
                            UserForm6.TextBox2.Value = Cells(z, 107).Value + 1
                            TextBox4.Value = Cells(z, 192).Value
                            TextBox5.Value = Cells(z, 194).Value
                        End If
                        If Cells(2, 108).Value = 1 And Cells(z, 116).Value = 0 = True Then
                            TextBox4.Enabled = False
                            If Cells(2, 109).Value = 1 Then
                                TextBox5.Enabled = False
                                TextBox6.SetFocus
                            Else
                                TextBox5.Enabled = True
                                TextBox5.SelStart = 0
                                TextBox5.SelLength = Len(TextBox5.Text)
                                TextBox5.SetFocus
                            End If
                        Else
                            TextBox4.Enabled = True
                            TextBox4.SelStart = 0
                            TextBox4.SelLength = Len(TextBox4.Text)
                            TextBox4.SetFocus
                        End If
                        Label9.Caption = Cells(z + 1, 2).Value
                        Application.ScreenUpdating = True
                    End If
                End If
            End If
        End If
    End If
End If

End Sub

Private Sub CommandButton2_Click()
Rem ### Abbrechen ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If Cells(z - 1, 116).Value = 1 Then
    If MsgBox("Klammerstammerfassung nicht abgeschlossen - Abbruch f|fffd|hrt zu" _
    & " unplausiblen Datens|fffd|tzen! Soll Vorgang trotzdem abgebrochen werden?", _
    vbYesNo + 48 + 256, "Funktion Daten erfassen") = vbNo Then
        Exit Sub
    Else
    End If
Else
End If
Sheets("DATEN").Unprotect ("mallnitz")
Cells(z, 106).Value = ""
Cells(z, 107).Value = ""
Cells(z, 108).Value = ""
Cells(z, 109).Value = ""
Cells(z, 110).Value = ""
Cells(z, 111).Value = ""
Rows(z).Hidden = True
If Cells(2, 4).Value > 6 Then
    Cells(7, 106).Select
Else
    Cells(4, 27).Select
End If
Sheets("DATEN").Protect ("mallnitz")
UserForm6.Hide
Unload Me
End Sub

Private Sub CommandButton4_Click()
Rem ### Schaltfl|fffd|che Baumartenkatalog einblenden ###
Cells(2, 26).Value = 6
UserForm9.Show
End Sub

Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Baumart ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 106).Value = TextBox1.Value
TextBox1.Value = Cells(z, 134).Value
If Cells(z, 128).Value = 1 Or TextBox1.Value = "" = True Then
    Label11.Visible = True
    TextBox1.Value = ""
    TextBox1.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox1.SetFocus
Else
    Label11.Visible = False
    TextBox1.BackColor = vbWhite
End If
End Sub

Private Sub TextBox2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Holznummer ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
Cells(z, 107).Value = TextBox2.Value
If Cells(z, 141).Value < 9 Or TextBox2.Value = "" = True Then
    Label12.Visible = True
    TextBox2.Value = ""
    TextBox2.BackColor = vbYellow
    Beep
    Cancel = True
    TextBox2.SetFocus
Else
    Label12.Visible = False
    TextBox2.BackColor = vbWhite
End If
End Sub

Private Sub TextBox4_Change()
Rem ### Textfeld GKL ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If (TextBox4.Value >= 2 And TextBox4.Value <= 6) Or TextBox4.Value = 9 = True Then
    Cells(z, 192).Value = TextBox4.Value
    If Cells(2, 109).Value = 0 Then
        TextBox5.SelStart = 0
        TextBox5.SelLength = Len(TextBox5.Text)
        TextBox5.SetFocus
    Else
        TextBox6.SetFocus
    End If
Else
    TextBox4.Value = ""
    Cancel = True
End If
End Sub

Private Sub TextBox5_Change()
Rem ### Textfeld L|fffd|nge ###
Dim a As Integer
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If Left(TextBox5.Value, 1) = "-" Then
    a = 4
Else
    a = 3
End If
If IsNumeric(TextBox5.Value) Or Left(TextBox5.Value, 1) = "-" = True Then
    
    If Len(TextBox5.Value) = a Then
        Cells(z, 194).Value = Str(TextBox5.Value)
        TextBox6.SetFocus
        End If
Else
    TextBox5.Value = ""
    TextBox5.SetFocus
End If
If Left(TextBox5.Value, 1) = "-" Then Cells(z, 111).Value = "x"
    
End Sub

Private Sub TextBox6_Change()
Rem ### Textfeld MDM ###
Dim z As Integer
z = Sheets("DATEN").Cells(2, 115).Value + 1
If IsNumeric(TextBox6.Value) And TextBox6.Value >= 10 = True Then
    TextBox6.BackColor = vbWhite
    CommandButton1.SetFocus
Else
    If IsNumeric(TextBox6.Value) = True Then
        TextBox6.BackColor = vbWhite
    Else
        TextBox6.Value = ""
        TextBox6.BackColor = vbYellow
        'Beep
    End If
End If

End Sub
Attribute VB_Name = "UserForm7"
Attribute VB_Base = "0{775B5EC4-C1E0-4C4F-9889-36D7F5D2FC9E}{A94E4F4C-3220-46F2-8852-85D86611F806}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che Sortieren ###
Dim i As Integer
Dim maxzeile As Integer
UserForm7.Hide
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
Application.ScreenUpdating = False
maxzeile = Cells(3, 4).Value
Application.Calculation = xlCalculationManual
Rows("7:" & maxzeile).Hidden = False
If Cells(2, 17).Value = 1 Then 'Losnummer und HNR
    Range("C7:IL" & maxzeile).Select
    Selection.Sort Key1:=Range("Q7"), Order1:=xlAscending, Key2:=Range("R7") _
    , Order2:=xlAscending, Key3:=Range("V7"), Order1:=xlAscending, _
    Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    
ElseIf Cells(2, 17).Value = 2 Then 'Holznummer und GKL
    If Cells(2, 116).Value > 0 Then
        MsgBox ("Die Datei enth|fffd|lt Klammerst|fffd|mme; die Teilst|fffd|cke der Klammerst|fffd|mme" _
        & " behalten die urspr|fffd|ngliche Sortierreihenfolge!")
    Else
    End If
    Range("C7:IL" & maxzeile).Select
    Selection.Sort Key1:=Range("R7"), Order1:=xlAscending, Key2:=Range("V7") _
    , Order2:=xlAscending, Key3:=Range("T7"), Order3:=xlAscending, _
    Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    
ElseIf Cells(2, 17).Value = 3 Then 'Baumart und HNR
    Range("C7:IL" & maxzeile).Select
    Selection.Sort Key1:=Range("S7"), Order1:=xlAscending, Key2:=Range("R7") _
    , Order2:=xlAscending, Key3:=Range("V7"), Order1:=xlAscending, Header:=xlGuess, _
    OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
    
ElseIf Cells(2, 17).Value = 4 Then 'Baumart und GKL
    If Cells(2, 116).Value = 0 Then
        Range("C7:IL" & maxzeile).Select
        Selection.Sort Key1:=Range("S7"), Order1:=xlAscending, Key2:=Range("T7") _
        , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
        False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
        :=xlSortNormal
    Else
        MsgBox ("Datei enth|fffd|lt Klammerst|fffd|mmer; Sortierung nicht m|fffd|glich!")
    End If
        
     
ElseIf Cells(2, 17).Value = 5 Then 'Ausgangszustand wiederherstellen
    Range("C7:IL" & maxzeile).Select
    Selection.Sort Key1:=Range("U7"), Order1:=xlAscending, Key2:=Range("R7") _
    , Order2:=xlAscending, Header:=xlGuess, OrderCustom:=1, MatchCase:= _
    False, Orientation:=xlTopToBottom, DataOption1:=xlSortNormal, DataOption2 _
    :=xlSortNormal
Else
    MsgBox "Keine Sortierung m|fffd|glich"
End If
If Cells(2, 2).Value = 1 Then
    Else
    For i = 7 To maxzeile
        If Cells(i, 4).Value = 0 Then
            Rows(i).Hidden = True
        Else
            Rows(i).Hidden = False
        End If
        Next i
    End If
Sheets("ABIES").Unprotect ("mallnitz")
Sheets("ABIES").Cells(3, 22).Value = Sheets("ABIES").Cells(3, 22).Value + 3
Sheets("ABIES").Protect ("mallnitz")
Application.Calculation = xlCalculationAutomatic
Application.ScreenUpdating = True
Cells(5, 27).Select
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che Abbrechen ###
Sheets("DATEN").Cells(2, 17).Value = 0
UserForm7.Hide
Unload Me
End Sub

Private Sub OptionButton1_Click()
Rem ### Sortieren nach Losnummer / Holznummer ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm7.OptionButton1.Value = True Then
    UserForm7.OptionButton2.Value = False
    UserForm7.OptionButton3.Value = False
    UserForm7.OptionButton4.Value = False
    UserForm7.OptionButton5.Value = False
    UserForm7.CommandButton1.Enabled = True
    Cells(2, 17).Value = 1
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton2_Click()
Rem ### Sortieren nach Holznummer / G|fffd|teklasse ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm7.OptionButton2.Value = True Then
    UserForm7.OptionButton1.Value = False
    UserForm7.OptionButton3.Value = False
    UserForm7.OptionButton4.Value = False
    UserForm7.OptionButton5.Value = False
    UserForm7.CommandButton1.Enabled = True
    Cells(2, 17).Value = 2
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton3_Click()
Rem ### Sortieren nach Baumart / Holznummer ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm7.OptionButton3.Value = True Then
    UserForm7.OptionButton1.Value = False
    UserForm7.OptionButton2.Value = False
    UserForm7.OptionButton4.Value = False
    UserForm7.OptionButton5.Value = False
    UserForm7.CommandButton1.Enabled = True
    Cells(2, 17).Value = 3
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton4_Click()
Rem ### Sortieren nach Baumart / G|fffd|teklasse ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm7.OptionButton4.Value = True Then
    UserForm7.OptionButton1.Value = False
    UserForm7.OptionButton2.Value = False
    UserForm7.OptionButton3.Value = False
    UserForm7.OptionButton5.Value = False
    UserForm7.CommandButton1.Enabled = True
    Cells(2, 17).Value = 4
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub

Private Sub OptionButton5_Click()
Rem ### Ausgangszustand wiederherstellen ###
Sheets("DATEN").Select
ActiveSheet.Unprotect ("mallnitz")
If UserForm7.OptionButton5.Value = True Then
    UserForm7.OptionButton1.Value = False
    UserForm7.OptionButton2.Value = False
    UserForm7.OptionButton3.Value = False
    UserForm7.OptionButton4.Value = False
    UserForm7.CommandButton1.Enabled = True
    Cells(2, 17).Value = 5
Else
End If
ActiveSheet.Protect ("mallnitz")
End Sub
Attribute VB_Name = "UserForm8"
Attribute VB_Base = "0{ECF3108E-2F91-45D3-A7F3-445939FC6585}{4A8160FC-E590-4063-93D7-B018F98B2F87}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CheckBox1_Click()
Rem ### 8a Kontrolle Holzernte ###
If CheckBox1.Value = True Then
    Cells(51, 5).Value = 1
Else
    Cells(51, 5).Value = 0
End If
End Sub

Private Sub CheckBox2_Click()
Rem ### Zertifikate ###
If CheckBox2.Value = True Then
    Cells(17, 5).Value = 1
    TextBox31.Visible = True
Else
    Cells(17, 5).Value = 0
    TextBox31.Value = ""
    TextBox31.Visible = False
    Cells(18, 5).Value = ""
End If
End Sub

Private Sub ComboBox1_Click()
Rem ### Ma|fffd|nahme ###
Sheets("KOPF").Cells(21, 5).Value = ComboBox1.Value
End Sub

Private Sub ComboBox2_Click()
Rem ### Ausf|fffd|hrende ###
Sheets("KOPF").Cells(22, 5).Value = ComboBox2.Value
End Sub

Private Sub ComboBox3_Click()
Rem ### Herkunft ###
Sheets("KOPF").Cells(38, 5).Value = ComboBox3.Value
End Sub

Private Sub ComboBox4_Click()
Rem ### Losdaten Abgangsart ###
Sheets("KOPF").Cells(49, 5).Value = ComboBox4.Value
End Sub

Private Sub ComboBox5_Click()
Rem ### Losdaten Leistung EO ###
Sheets("KOPF").Cells(50, 5).Value = ComboBox5.Value
If Cells(50, 5).Value = 0 Then
    CheckBox1.Visible = False
    Cells(51, 5).Value = 0
Else
    CheckBox1.Visible = True
End If
End Sub

Private Sub ComboBox6_Click()
Rem ### Entrindungszustand ###
Sheets("KOPF").Cells(60, 5).Value = ComboBox6.Value
End Sub

Private Sub ComboBox7_Click()
Rem ### Logistikstatus ###
Sheets("KOPF").Cells(61, 5).Value = ComboBox7.Value
End Sub

Private Sub ComboBox8_Click()
Rem ### Zugangstyp ###
Sheets("KOPF").Cells(63, 5).Value = ComboBox8.Value
End Sub

Private Sub CommandButton1_Click()
Rem ### Schaltfl|fffd|che zur|fffd|ck zum Hauptblatt ###
If Cells(6, 5).Value = "" And Cells(9, 5).Value = "" = True Then
    If MsgBox("Waldbesitzer ohne Partnernummer oder Langname! Trotzdem fortsetzen?", _
    vbYesNo + 32 + 256, "Funktion Kopf- / Losdaten") = vbNo Then
        TextBox2.SetFocus
        Exit Sub
    Else
    End If
Else
End If
UserForm8.Hide
Unload Me
Rows("1:1").Hidden = False
Columns("B:Z").Hidden = False
Sheets("KOPF").Visible = False
Sheets("DATEN").Select
End Sub

Private Sub CommandButton2_Click()
Rem ### Schaltfl|fffd|che zur|fffd|ck zum Hauptblatt ###
If Cells(6, 5).Value <> 100 And Cells(50, 5).Value = 99 And Cells(51, 5).Value = 0 = True Then
    If MsgBox("Losdaten ohne Leistung EO! Trotzdem fortsetzen?", vbYesNo + 32 + 256, _
    "Funktion Kopf- / Losdaten") = vbNo Then
        Exit Sub
    Else
    End If
ElseIf Cells(6, 5).Value = 100 And Cells(21, 5).Value = "" = True Then
    If MsgBox("Ma|fffd|nahme fehlt! Trotzdem fortsetzen?", vbYesNo + 32 + 256, _
    "Funktion Kopf- / Losdaten") = vbNo Then
        ComboBox1.SetFocus
        Exit Sub
    Else
    End If
ElseIf Cells(6, 5).Value = 100 And Cells(22, 5).Value = "" = True Then
    If MsgBox("Ausf|fffd|hrende fehlt! Trotzdem fortsetzen?", vbYesNo + 32 + 256, _
    "Funktion Kopf- / Losdaten") = vbNo Then
        ComboBox2.SetFocus
        Exit Sub
    Else
    End If
ElseIf Cells(24, 5).Value = "" And Cells(32, 5).Value = "" = True Then
    If MsgBox("Waldort fehlt! Trotzdem fortsetzen?", vbYesNo + 32 + 256, _
    "Funktion Kopf- / Losdaten") = vbNo Then
        TextBox11.SetFocus
        Exit Sub
    Else
    End If
End If
UserForm8.Hide
Unload Me
Rows("1:1").Hidden = False
Columns("B:Z").Hidden = False
Sheets("KOPF").Visible = False
Sheets("DATEN").Select
End Sub

Private Sub OptionButton1_Click()
Rem ### Optionsfeld NUR KERNDATEN ###
Cells(65, 5).Value = 1
UserForm8.OptionButton1 = True 'Kernfelder
UserForm8.OptionButton2 = False 'alle Felder
UserForm8.Label13.Visible = False 'BE
UserForm8.Label15.Visible = False 'ProjektNr
UserForm8.Label16.Visible = False 'zentral
UserForm8.Label17.Visible = False 'FoA
UserForm8.Label18.Visible = False 'FBB
UserForm8.Label20.Visible = False 'Bemerkung extern
UserForm8.Label21.Visible = False 'Bemerkung intern
UserForm8.Label28.Visible = False 'Entrindungszustand
UserForm8.Label29.Visible = False 'Logistikstatus
UserForm8.Label30.Visible = False 'Unternehmer(1)
UserForm8.Label31.Visible = False 'Kommentar(1)
UserForm8.Label32.Visible = False 'Unternehmer(2)
UserForm8.Label33.Visible = False 'Kommentar(2)
UserForm8.Label34.Visible = False 'Unternehmer(3)
UserForm8.Label35.Visible = False 'Kommentar(3)
UserForm8.Label36.Visible = False 'Bemerkung
UserForm8.TextBox12.Visible = False 'BE
UserForm8.TextBox14.Visible = False 'zentral
UserForm8.TextBox15.Visible = False 'FoA
UserForm8.TextBox16.Visible = False 'FBB
UserForm8.TextBox17.Visible = False 'Bemerkung extern
UserForm8.TextBox18.Visible = False 'Bemerkung intern
UserForm8.TextBox24.Visible = False 'Unternehmer(1)
UserForm8.TextBox25.Visible = False 'Kommentar(1)
UserForm8.TextBox26.Visible = False 'Unternehmer(2)
UserForm8.TextBox27.Visible = False 'Kommentar(2)
UserForm8.TextBox28.Visible = False 'Unternehmer(3)
UserForm8.TextBox29.Visible = False 'Kommentar(3)
UserForm8.TextBox30.Visible = False 'Bemerkung
UserForm8.ComboBox6.Visible = False 'Entrindungszustand
UserForm8.ComboBox7.Visible = False 'Logistikstatus
End Sub

Private Sub OptionButton2_Click()
Rem ### Optionsfeld NUR KERNDATEN ###
Cells(65, 5).Value = 0
UserForm8.OptionButton1 = False 'Kernfelder
UserForm8.OptionButton2 = True 'alle Felder
UserForm8.Label13.Visible = True 'BE
UserForm8.Label15.Visible = True 'ProjektNr
UserForm8.Label16.Visible = True 'zentral
UserForm8.Label17.Visible = True 'FoA
UserForm8.Label18.Visible = True 'FBB
UserForm8.Label20.Visible = True 'Bemerkung extern
UserForm8.Label21.Visible = True 'Bemerkung intern
UserForm8.Label28.Visible = True 'Entrindungszustand
UserForm8.Label29.Visible = True 'Logistikstatus
UserForm8.Label30.Visible = True 'Unternehmer(1)
UserForm8.Label31.Visible = True 'Kommentar(1)
UserForm8.Label32.Visible = True 'Unternehmer(2)
UserForm8.Label33.Visible = True 'Kommentar(2)
UserForm8.Label34.Visible = True 'Unternehmer(3)
UserForm8.Label35.Visible = True 'Kommentar(3)
UserForm8.Label36.Visible = True 'Bemerkung
UserForm8.TextBox12.Visible = True 'BE
UserForm8.TextBox14.Visible = True 'zentral
UserForm8.TextBox15.Visible = True 'FoA
UserForm8.TextBox16.Visible = True 'FBB
UserForm8.TextBox17.Visible = True 'Bemerkung extern
UserForm8.TextBox18.Visible = True 'Bemerkung intern
UserForm8.TextBox24.Visible = True 'Unternehmer(1)
UserForm8.TextBox25.Visible = True 'Kommentar(1)
UserForm8.TextBox26.Visible = True 'Unternehmer(2)
UserForm8.TextBox27.Visible = True 'Kommentar(2)
UserForm8.TextBox28.Visible = True 'Unternehmer(3)
UserForm8.TextBox29.Visible = True 'Kommentar(3)
UserForm8.TextBox30.Visible = True 'Bemerkung
UserForm8.ComboBox6.Visible = True 'Entrindungszustand
UserForm8.ComboBox7.Visible = True 'Logistikstatus
End Sub
Private Sub TextBox1_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld HIEBSBEGINN #################################################
If IsDate(TextBox1.Value) Or TextBox1.Value = "" = True Then
    TextBox1.BackColor = vbWhite
    If TextBox1.Value = "" Then
        Cells(4, 5).Value = ""
    Else
        Cells(4, 5).Value = CDate(TextBox1.Value)
    End If
    TextBox1 = Format(TextBox1, "dd.mm.yyyy")
Else
    TextBox1.BackColor = vbYellow
    TextBox1.Value = ""
    Cancel = True
    TextBox1.SetFocus
End If
End Sub

Private Sub TextBox2_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld WALDBESITZER PARTNERNUMMER ##################################
If IsNumeric(TextBox2.Value) Or TextBox2.Value = "" = True Then
    TextBox2.BackColor = vbWhite
    If TextBox2.Value = "" Then
        Cells(6, 5).Value = ""
    Else
        Cells(6, 5).Value = Str(TextBox2.Value)
        If Cells(6, 6).Value = 1 Then
            CommandButton1.Visible = True
            TextBox2.BackColor = vbYellow
            TextBox2.Value = ""
            Cancel = True
            TextBox2.SetFocus
        Else
            TextBox2.BackColor = vbWhite
            Frame2.Visible = True
            CommandButton1.Visible = False
        End If
    End If
Else
    TextBox2.BackColor = vbYellow
    TextBox2.Value = ""
    Cancel = True
    TextBox2.SetFocus
End If
If Cells(6, 5).Value = 100 Then
    TextBox3.Value = 1
    TextBox3.Enabled = False
    Cells(7, 5).Value = 1
    TextBox4.Value = 1
    TextBox4.Enabled = False
    Cells(8, 5).Value = 1
    TextBox5.Value = "Landesbetrieb Wald u. Holz NRW - Staatswald"
    TextBox5.Enabled = False
    Cells(9, 5).Value = "Landesbetrieb Wald u. Holz NRW - Staatswald"
    Label5.Enabled = False
    TextBox6.Visible = False
    Label6.Enabled = False
    TextBox7.Visible = False
    TextBox8.Visible = False
    Label7.Enabled = False
    TextBox9.Visible = False
    Cells(14, 5).Value = ""
    Label27.Enabled = False
    ComboBox5.Visible = False
    Cells(50, 5).Value = ""
    CheckBox1.Visible = False
    UserForm8.ComboBox1.Value = Sheets("KOPF").Cells(21, 5).Value
    With ComboBox1
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!AW3:AY15"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
    UserForm8.ComboBox2.Value = Sheets("KOPF").Cells(22, 5).Value
    With ComboBox2
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!BC3:BE7"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
    UserForm8.ComboBox4.Value = Sheets("KOPF").Cells(49, 5).Value
    With ComboBox4
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!BO3:BQ9"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
    CheckBox2.Value = True
    Cells(17, 5).Value = 1
    TextBox31.Visible = True
Else
    TextBox3.Enabled = True
    TextBox4.Enabled = True
    TextBox5.Enabled = True
    TextBox5.Value = ""
    Cells(9, 5).Value = ""
    Label5.Enabled = True
    TextBox6.Visible = True
    Label6.Enabled = True
    TextBox7.Visible = True
    TextBox8.Visible = True
    Label7.Enabled = True
    TextBox9.Visible = True
    TextBox9.Value = ""
    Cells(14, 5).Value = ""
    Label27.Enabled = True
    ComboBox5.Visible = True
    CheckBox1.Visible = True
    UserForm8.ComboBox1.Value = Sheets("KOPF").Cells(21, 5).Value
    With ComboBox1
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!AW23:AY36"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
    UserForm8.ComboBox2.Value = Sheets("KOPF").Cells(22, 5).Value
    With ComboBox2
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!BC23:BE28"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
    UserForm8.ComboBox4.Value = Sheets("KOPF").Cells(49, 5).Value
    With ComboBox4
        .ColumnCount = 2
        .ColumnHeads = True
        .RowSource = "SD!BO23:BQ25"
        .ColumnWidths = "0cm;4cm"
        .MatchRequired = True
    End With
End If
End Sub

Private Sub Textbox3_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld WALDBESITZER NIEDERLASSUNGSNUMMER ###########################
If IsNumeric(TextBox3.Value) Or TextBox3.Value = "" = True Then
    TextBox3.BackColor = vbWhite
    If TextBox3.Value = "" Then
        Cells(7, 5).Value = ""
    Else
        Cells(7, 5).Value = Str(TextBox3.Value)
        If Cells(7, 6).Value = 1 Then
            TextBox3.BackColor = vbYellow
            TextBox3.Value = ""
            Cancel = True
            TextBox3.SetFocus
        Else
            TextBox3.BackColor = vbWhite
        End If
    End If
Else
    TextBox3.BackColor = vbYellow
    TextBox3.Value = ""
    Cancel = True
    TextBox3.SetFocus
End If
End Sub

Private Sub Textbox4_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld WALDBESITZER ADRESSNUMMER ##################################
If IsNumeric(TextBox4.Value) Or TextBox4.Value = "" = True Then
    TextBox4.BackColor = vbWhite
    If TextBox4.Value = "" Then
        Cells(8, 5).Value = ""
    Else
        Cells(8, 5).Value = Str(TextBox4.Value)
        If Cells(8, 6).Value = 1 Then
            TextBox4.BackColor = vbYellow
            TextBox4.Value = ""
            Cancel = True
            TextBox4.SetFocus
        Else
            TextBox4.BackColor = vbWhite
        End If
    End If
Else
    TextBox4.BackColor = vbYellow
    TextBox4.Value = ""
    Cancel = True
    TextBox4.SetFocus
End If
End Sub

Private Sub TextBox5_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld WALDBESITZER LANGNAME ##################################
Cells(9, 5).Value = TextBox5.Value
If Cells(9, 5).Value <> "" Then
    Frame2.Visible = True
    CommandButton1.Visible = False
Else
End If
End Sub

Private Sub Textbox6_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ZUSAMMENSCHLUSS PARTNERNUMMER ##################################
If IsNumeric(TextBox6.Value) Or TextBox6.Value = "" = True Then
    TextBox6.BackColor = vbWhite
    If TextBox6.Value = "" Then
        Cells(11, 5).Value = ""
    Else
        Cells(11, 5).Value = Str(TextBox6.Value)
        If Cells(11, 6).Value = 1 Then
            TextBox6.BackColor = vbYellow
            TextBox6.Value = ""
            Cancel = True
            TextBox6.SetFocus
        Else
            TextBox6.BackColor = vbWhite
        End If
    End If
Else
    TextBox6.BackColor = vbYellow
    TextBox6.Value = ""
    Cancel = True
    TextBox6.SetFocus
End If
End Sub

Private Sub Textbox7_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ZUSAMMENSCHLUSS NIEDERLASSUNGSNUMMER ###########################
If IsNumeric(TextBox7.Value) Or TextBox7.Value = "" = True Then
    TextBox7.BackColor = vbWhite
    If TextBox7.Value = "" Then
        Cells(12, 5).Value = ""
    Else
        Cells(12, 5).Value = Str(TextBox7.Value)
        If Cells(12, 6).Value = 1 Then
            TextBox7.BackColor = vbYellow
            TextBox7.Value = ""
            Cancel = True
            TextBox7.SetFocus
        Else
            TextBox7.BackColor = vbWhite
        End If
    End If
Else
    TextBox7.BackColor = vbYellow
    TextBox7.Value = ""
    Cancel = True
    TextBox7.SetFocus
End If
End Sub

Private Sub Textbox8_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ZUSAMMENSCHLUSS ADRESSNUMMER ##################################
If IsNumeric(TextBox8.Value) Or TextBox8.Value = "" = True Then
    TextBox8.BackColor = vbWhite
    If TextBox8.Value = "" Then
        Cells(13, 5).Value = ""
    Else
        Cells(13, 5).Value = Str(TextBox8.Value)
        If Cells(13, 6).Value = 1 Then
            TextBox8.BackColor = vbYellow
            TextBox8.Value = ""
            Cancel = True
            TextBox8.SetFocus
        Else
            TextBox8.BackColor = vbWhite
        End If
    End If
Else
    TextBox8.BackColor = vbYellow
    TextBox8.Value = ""
    Cancel = True
    TextBox8.SetFocus
End If
End Sub

Private Sub TextBox9_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ZUSAMMENSCHLUSS LANGNAME ##################################
Cells(14, 5).Value = TextBox5.Value
End Sub

Private Sub TextBox11_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ABT/UABT ##################################################
Cells(24, 5).Value = TextBox11.Value
If Cells(24, 9).Value = 1 Then
    TextBox11.BackColor = vbYellow
    TextBox11.Value = ""
    Cancel = True
    TextBox11.SetFocus
Else
    TextBox11.BackColor = vbWhite
    TextBox11.Value = Cells(24, 10).Value
    ComboBox2.SetFocus
End If
End Sub

Private Sub Textbox12_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld BE ########################################################
If IsNumeric(TextBox12.Value) Or TextBox12.Value = "" = True Then
    TextBox12.BackColor = vbWhite
    If TextBox12.Value = "" Then
        Cells(25, 5).Value = ""
    Else
        Cells(25, 5).Value = Str(TextBox12.Value)
        If Cells(25, 6).Value = 1 Then
            TextBox12.BackColor = vbYellow
            TextBox12.Value = ""
            Cancel = True
            TextBox12.SetFocus
        Else
            TextBox12.BackColor = vbWhite
        End If
    End If
Else
    TextBox12.BackColor = vbYellow
    TextBox12.Value = ""
    Cancel = True
    TextBox12.SetFocus
End If
End Sub

Private Sub TextBox13_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Langname Waldort #########################################
Cells(32, 5).Value = TextBox13.Value
End Sub

Private Sub TextBox14_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Projektnummer zentral ####################################
Cells(34, 5).Value = TextBox14.Value
End Sub

Private Sub TextBox15_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Projektnummer FoA ########################################
Cells(35, 5).Value = TextBox15.Value
End Sub

Private Sub TextBox16_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld Projektnummer FBB ########################################
Cells(36, 5).Value = TextBox16.Value
End Sub

Private Sub TextBox17_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld BEMERKUNG EXTERN #########################################
Cells(40, 5).Value = TextBox16.Value
End Sub

Private Sub TextBox18_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld BEMERKUNG INTERN #########################################
Cells(41, 5).Value = TextBox16.Value
End Sub

Private Sub Textbox19_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld K|fffd|UFERVORSCHLAG PARTNERNUMMER ############################
If IsNumeric(TextBox19.Value) Or TextBox19.Value = "" = True Then
    TextBox19.BackColor = vbWhite
    If TextBox19.Value = "" Then
        Cells(43, 5).Value = ""
    Else
        Cells(43, 5).Value = Str(TextBox19.Value)
        If Cells(43, 6).Value = 1 Then
            TextBox19.BackColor = vbYellow
            TextBox19.Value = ""
            Cancel = True
            TextBox19.SetFocus
        Else
            TextBox19.BackColor = vbWhite
        End If
    End If
Else
    TextBox19.BackColor = vbYellow
    TextBox19.Value = ""
    Cancel = True
    TextBox19.SetFocus
End If
End Sub

Private Sub Textbox20_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld K|fffd|UFERVORSCHLAG NIEDERLASSUNGSNUMMER #######################
If IsNumeric(TextBox20.Value) Or TextBox20.Value = "" = True Then
    TextBox20.BackColor = vbWhite
    If TextBox20.Value = "" Then
        Cells(44, 5).Value = ""
    Else
        Cells(44, 5).Value = Str(TextBox20.Value)
        If Cells(44, 6).Value = 1 Then
            TextBox20.BackColor = vbYellow
            TextBox20.Value = ""
            Cancel = True
            TextBox20.SetFocus
        Else
            TextBox20.BackColor = vbWhite
        End If
    End If
Else
    TextBox20.BackColor = vbYellow
    TextBox20.Value = ""
    Cancel = True
    TextBox20.SetFocus
End If
End Sub

Private Sub Textbox21_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld K|fffd|ufervorschlag ADRESSNUMMER ##############################
If IsNumeric(TextBox21.Value) Or TextBox21.Value = "" = True Then
    TextBox21.BackColor = vbWhite
    If TextBox21.Value = "" Then
        Cells(45, 5).Value = ""
    Else
        Cells(45, 5).Value = Str(TextBox21.Value)
        If Cells(45, 6).Value = 1 Then
            TextBox21.BackColor = vbYellow
            TextBox21.Value = ""
            Cancel = True
            TextBox21.SetFocus
        Else
            TextBox21.BackColor = vbWhite
        End If
    End If
Else
    TextBox21.BackColor = vbYellow
    TextBox21.Value = ""
    Cancel = True
    TextBox21.SetFocus
End If
End Sub

Private Sub TextBox22_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld K|fffd|UFERVORSCHLAG LANGNAME ################################
Cells(46, 5).Value = TextBox22.Value
End Sub

Private Sub TextBox23_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld VERTRAGSVORSCHLAG LANGNAME ##############################
Cells(48, 5).Value = TextBox23.Value
End Sub

Private Sub TextBox24_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld UNTERNEHMER (1) #########################################
Cells(52, 5).Value = TextBox24.Value
End Sub

Private Sub TextBox25_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld KOMMENTAR (1) ###########################################
Cells(53, 5).Value = TextBox25.Value
End Sub

Private Sub TextBox26_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld UNTERNEHMER (2) #########################################
Cells(54, 5).Value = TextBox26.Value
End Sub

Private Sub TextBox27_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld KOMMENTAR (2) ###########################################
Cells(55, 5).Value = TextBox27.Value
End Sub

Private Sub TextBox28_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld UNTERNEHMER (3) #########################################
Cells(56, 5).Value = TextBox28.Value
End Sub

Private Sub TextBox29_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld KOMMENTAR (1) ###########################################
Cells(57, 5).Value = TextBox29.Value
End Sub

Private Sub TextBox30_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld BEMERKUNGEN #############################################
Cells(59, 5).Value = TextBox30.Value
End Sub

Private Sub TextBox31_BeforeUpdate(ByVal Cancel As MSForms.ReturnBoolean)
Rem ### Textfeld ZERTIFIKATE #############################################
Cells(18, 5).Value = TextBox31.Value
End Sub

Private Sub userform_initialize()
Rem ### combobox MASSNAHMENART ###
'UserForm8.ComboBox1.Value = Sheets("KOPF").Cells(21, 5).Value
'With ComboBox1
'    .ColumnCount = 2
'    .ColumnHeads = True
'    .RowSource = "SD!AW3:AY15"
'    .ColumnWidths = "1cm;3cm"
'    .MatchRequired = True
'End With
Rem ### combobox AUSFUEHRENDE ###
'UserForm8.ComboBox2.Value = Sheets("KOPF").Cells(22, 5).Value
'With ComboBox2
'    .ColumnCount = 2
'    .ColumnHeads = True
'    .RowSource = "SD!BC3:BE8"
'    .ColumnWidths = "1cm;3cm"
'    .MatchRequired = True
'End With
Rem ### combobox HERKUNFT ###
UserForm8.ComboBox3.Value = Sheets("KOPF").Cells(38, 5).Value
With ComboBox3
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!BI3:BK4"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
Rem ### combobox ABGANGSART ###
'UserForm8.ComboBox4.Value = Sheets("KOPF").Cells(49, 5).Value
'With ComboBox4
'    .ColumnCount = 2
'    .ColumnHeads = True
'    .RowSource = "SD!BO3:BQ11"
'    .ColumnWidths = "1cm;3cm"
'    .MatchRequired = True
'End With
Rem ### combobox LEISTUNG EO ###
UserForm8.ComboBox5.Value = Sheets("KOPF").Cells(50, 5).Value
With ComboBox5
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!BU3:BW8"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
Rem ### combobox ENTRINDUNGSZUSTAND ###
UserForm8.ComboBox6.Value = Sheets("KOPF").Cells(60, 5).Value
With ComboBox6
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!CA3:CC6"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
Rem ### combobox LOGISTIKSTATUS ###
UserForm8.ComboBox7.Value = Sheets("KOPF").Cells(61, 5).Value
With ComboBox7
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!CG3:CI11"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
Rem ### combobox ZUGANGSTYP ###
UserForm8.ComboBox8.Value = Sheets("KOPF").Cells(63, 5).Value
With ComboBox8
    .ColumnCount = 2
    .ColumnHeads = True
    .RowSource = "SD!CM3:CO4"
    .ColumnWidths = "0cm;4cm"
    .MatchRequired = True
End With
End Sub
Attribute VB_Name = "UserForm9"
Attribute VB_Base = "0{1E45014A-0E02-4A5B-A311-CF22C634E2A7}{61F10536-0CD8-4E43-B1BB-8978335CBFF4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub ListBox1_Click()
Rem ### Listenfeld Baumarten ###
If Cells(2, 26).Value = 4 Then
    UserForm4.TextBox1.Value = ListBox1.Value
    UserForm4.TextBox2.SetFocus
    ElseIf Cells(2, 26).Value = 5 Then
        UserForm5.TextBox1.Value = ListBox1.Value
        UserForm5.TextBox2.SetFocus
        Else
        UserForm6.TextBox1.Value = ListBox1.Value
        UserForm6.TextBox2.SetFocus
        End If
UserForm9.Hide
Unload Me
End Sub

Private Sub userform_initialize()
With UserForm9.ListBox1
    .ColumnCount = 4
    .ColumnHeads = True
    .RowSource = "SD!AF3:AI137"
    .ColumnWidths = "2cm;2cm;0cm;5cm"
'    .MatchRequired = True
End With
End Sub


INQUEST-PP=macro
