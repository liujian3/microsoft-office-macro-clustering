Attribute VB_Name = "Arkusz1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "import, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "dane_tytulowe, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "drukowanie, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "opisy, 4, 3, MSForms, CheckBox"
Attribute VB_Control = "ofertowe, 5, 4, MSForms, CheckBox"
Attribute VB_Control = "help2, 8, 5, MSForms, Label"
Attribute VB_Control = "help1, 7, 6, MSForms, Label"
Attribute VB_Control = "help3, 9, 7, MSForms, Label"
Attribute VB_Control = "help5, 10, 8, MSForms, Label"
Attribute VB_Control = "help7, 11, 9, MSForms, Label"
Attribute VB_Control = "help4, 12, 10, MSForms, Label"
Attribute VB_Control = "help2a, 17, 11, MSForms, Label"
Attribute VB_Control = "help1a, 16, 12, MSForms, Label"
Attribute VB_Control = "dostosowanie, 15, 13, MSForms, CommandButton"
Attribute VB_Control = "help3a, 18, 14, MSForms, Label"
Attribute VB_Control = "help4a, 19, 15, MSForms, Label"
Attribute VB_Control = "help5a, 20, 16, MSForms, Label"
Attribute VB_Control = "help7a, 21, 17, MSForms, Label"
Attribute VB_Control = "kryteria_kat, 22, 18, MSForms, CommandButton"
Attribute VB_Control = "help6, 23, 19, MSForms, Label"
Attribute VB_Control = "help6a, 24, 20, MSForms, Label"
Private Sub dane_tytulowe_Click()
    tytulowe.Show
End Sub
Private Sub dostosowanie_Click()
    dostosuj_wszystko
End Sub
Private Sub drukowanie_Click()
    druki.Show
End Sub
Private Sub import_Click()
    importy.Show
End Sub
Private Sub kryteria_kat_Click()
    kryteria.Show
End Sub
Private Sub opisy_Click()
    Odblokuj "menu"
    If opisy.Value = True Then
        Cells(14, 9) = 1
    Else
        Cells(14, 9) = 0
    End If
    Blokuj "menu"
End Sub
Private Sub ofertowe_Click()
    Odblokuj "menu"
    If ofertowe.Value = True Then
        Cells(16, 9) = 1
    Else
        Cells(16, 9) = 0
    End If
    Blokuj "menu"
End Sub
Private Sub help1_Click()
    If help1a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = True
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    End If
End Sub
Private Sub help2_Click()
    If help2a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = True
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    End If
End Sub
Private Sub help3_Click()
    If help3a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = True
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    End If
End Sub
Private Sub help4_Click()
    If help4a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = True
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    End If
End Sub
Private Sub help5_Click()
    If help5a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = True
        help6a.Visible = False
        help7a.Visible = False
    End If
End Sub
Private Sub help6_Click()
    If help6a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = True
        help7a.Visible = False
    End If
End Sub
Private Sub help7_Click()
    If help7a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
        help5a.Visible = False
        help6a.Visible = False
        help7a.Visible = True
    End If
End Sub
Private Sub Worksheet_Activate()
    help1a.Visible = False
    help2a.Visible = False
    help3a.Visible = False
    help4a.Visible = False
    help5a.Visible = False
    help6a.Visible = False
    help7a.Visible = False
    If Application.WorksheetFunction.Sum(Sheets("dane").Range("sumy_suma")) = 0 Then
        dostosowanie.Enabled = False
        dane_tytulowe.Enabled = False
        kryteria_kat.Enabled = False
        drukowanie.Enabled = False
    Else
        dostosowanie.Enabled = True
        dane_tytulowe.Enabled = True
        kryteria_kat.Enabled = True
        drukowanie.Enabled = True
    End If
End Sub
Attribute VB_Name = "Arkusz13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Arkusz9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Ten_skoroszyt"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforePrint(Cancel As Boolean)
    If Sheets("dane").Range("blokada_wydruku") Then
        MsgBox "Drukowanie arkusza dozwolone tylko poprzez MENU"
        Sheets("MENU").Activate
        Cancel = True
    End If
End Sub
Attribute VB_Name = "czyszczenie_przez_uzytkownika"
Sub wyczysc_wszystko()
    czysc_i_blokuj_wszystko
End Sub
Attribute VB_Name = "dostosowywanie"
Option Private Module

'DOSTOSOWANIE WSZYSTKICH STRON I KATEGORII
Sub dostosuj_wszystko()
    BlokujArkusz False
    Dim ws As Worksheet
    
    
    'dostosowanie strony tytu|fffd|owej w zale|fffd|no|fffd|ci od typu przeliczenia
    Odblokuj "Strona Tytu|fffd|owa"
    Sheets("Strona Tytu|fffd|owa").Activate
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Top = Sheets("Strona Tytu|fffd|owa").Range("L37").Top
    If Sheets("dane").Range("typ") = 1 Then
        Sheets("Strona Tytu|fffd|owa").Range("46:46,59:59").EntireRow.Hidden = True
        Sheets("Strona Tytu|fffd|owa").Range("45:45,47:55,57:58,63:63").EntireRow.Hidden = False
        If Sheets("dane").Range("C10") <> "" Then
            Sheets("Strona Tytu|fffd|owa").Rows(54).Hidden = False
            Sheets("Strona Tytu|fffd|owa").Rows(62).Hidden = True
            If Len(Sheets("dane").Range("C10")) > 90 Then
                Sheets("Strona Tytu|fffd|owa").Rows(54).RowHeight = 27
            Else
                Sheets("Strona Tytu|fffd|owa").Rows(54).RowHeight = 13.5
            End If
        Else
            Sheets("Strona Tytu|fffd|owa").Rows(62).Hidden = False
            Sheets("Strona Tytu|fffd|owa").Rows(62).RowHeight = 13.5
            Sheets("Strona Tytu|fffd|owa").Rows(54).Hidden = True
        End If
        If Sheets("dane").Range("C11") <> "" Then
            Sheets("Strona Tytu|fffd|owa").Rows(55).Hidden = False
            If Len(Sheets("dane").Range("C11")) > 90 Then
                Sheets("Strona Tytu|fffd|owa").Rows(55).RowHeight = 27
            Else
                Sheets("Strona Tytu|fffd|owa").Rows(55).RowHeight = 13.5
            End If
        Else
            Sheets("Strona Tytu|fffd|owa").Rows(55).Hidden = True
        End If
    Else
        Sheets("Strona Tytu|fffd|owa").Range("45:45,49:58,63:63").EntireRow.Hidden = True
        Sheets("Strona Tytu|fffd|owa").Range("46:46,59:59,62:62").EntireRow.Hidden = False
        Sheets("Strona Tytu|fffd|owa").Rows(62).RowHeight = 91
    End If
    If Sheets("dane").Range("C20") Then Sheets("Strona Tytu|fffd|owa").Rows(64).Hidden = False _
        Else Sheets("Strona Tytu|fffd|owa").Rows(64).Hidden = True
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").ScaleHeight 0.5, msoTrue
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Top = _
        Sheets("Strona Tytu|fffd|owa").Range("L66").Top - Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Height
    Range("lista_do_wydruku").Cells(1) = True
    Blokuj "Strona Tytu|fffd|owa"
    
    'dostosowanie ka|fffd|dej kategorii, domy|fffd|lny wydruk, je|fffd|li aktywna, chowanie nieaktywnych
    For i = 1 To 8
        Set ws = Worksheets("Kategoria " & i)
        If Sheets("dane").Cells(2, 2 + i) > 0 And Sheets("dane").Cells(2, 2 + i) <> "" Then
            If ws.Visible = False Then ws.Visible = True
            ws.Activate
            dostosuj_dla_kategorii 'funkcja dostosowuj|fffd|ca kategori|fffd|
            Range("lista_do_wydruku").Cells(i + 1) = True
            Range("widac").Cells(i + 1) = True
        Else
            If ws.Visible = True Then ws.Visible = False
            Range("lista_do_wydruku").Cells(i + 1) = False
            Range("widac").Cells(i + 1) = False
        End If
    Next i
    
    'zwijanie wierszy w opisie
    Odblokuj "Opis"
    Set ws = Worksheets("Opis")
    ws.Activate
    For i = Application.WorksheetFunction.Min(ws.Range("podzialy_opis")) To Application.WorksheetFunction.Max(ws.Range("podzialy_opis"))
        If ws.Cells(i, 7) = 0 Then
            If ws.Rows(i).Hidden = False Then ws.Rows(i).Hidden = True
        Else
            If ws.Rows(i).Hidden = True Then ws.Rows(i).Hidden = False
        End If
    Next i
    Blokuj "Opis"
    
    'domy|fffd|lne drukowanie opisu, je|fffd|li nie jest pusty, chowanie, je|fffd|li pusty
    If ws.Cells(1, 7) = 0 Then
        Range("lista_do_wydruku").Cells(10) = False
        Range("widac").Cells(10) = False
        If ws.Visible = True Then ws.Visible = False
    Else
        Range("lista_do_wydruku").Cells(10) = True
        Range("widac").Cells(10) = True
        If ws.Visible = False Then ws.Visible = True
    End If
    
    'chowanie "druku"
    If Sheets("druk").Visible = True Then Sheets("druk").Visible = False
    
    BlokujArkusz
    Sheets("MENU").Activate
    Application.Calculation = xlCalculationAutomatic
End Sub

Private Sub dostosuj_dla_kategorii()
    Dim ikona As Object
    Dim ws As Worksheet
    Set ws = ActiveSheet
    Application.Calculation = xlCalculationManual
    Odblokuj ws.Name
    
    'wysoko|fffd||fffd| wiersza z kryterium kwalifikacji
    If Len(Sheets("dane").Cells(16, 2 + ws.Cells(4, 8))) <= 30 Then ws.Rows(4).RowHeight = 18 Else ws.Rows(4).RowHeight = 30.75
    
    'widoczno|fffd||fffd| wiersza z danymi ofertowymi
    If ws.Cells(Application.WorksheetFunction.Max(Range("dane!podzialy")) + 1, 9) = 1 Then _
        ws.Rows(Application.WorksheetFunction.Max(Range("dane!podzialy")) + 1).Hidden = False Else _
        ws.Rows(Application.WorksheetFunction.Max(Range("dane!podzialy")) + 1).Hidden = True
    
    'wszystkie cienkie linie
    Range(ws.Cells(Application.WorksheetFunction.Min(Range("dane!podzialy")), 3), _
            ws.Cells(Application.WorksheetFunction.Max(Range("dane!podzialy")) - 1, 6)).Select
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .Color = RGB(170, 170, 170)
        .Weight = xlHairline
    End With
    'brak linii w lewej kolumnie
    Range(ws.Cells(Application.WorksheetFunction.Min(Range("dane!podzialy")), 2), _
            ws.Cells(Application.WorksheetFunction.Max(Range("dane!podzialy")) - 1, 2)).Select
    Selection.Borders.LineStyle = xlNone
    
    'przesuni|fffd|cie ikon przed zwijaniem wierszy (konieczne w 2003)
    For Each ikona In ws.Shapes
        ikona.Top = 5
    Next ikona
    
    'zwijanie wierszy
    For i = 7 To Application.WorksheetFunction.Max(Range("dane!podzialy")) - 1
        If ws.Cells(i, 9) = 0 Then
            If ws.Rows(i).Hidden = False Then ws.Rows(i).Hidden = True
        Else
            If ws.Rows(i).Hidden = True Then ws.Rows(i).Hidden = False
        End If
    Next i
    
    'wywo|fffd|anie "pozycji" dla ka|fffd|dej sekcji (ka|fffd|dej ikony)
    pozycja 1, "i_smierc1"
    pozycja 2, "i_lapka"
    pozycja 3, "i_kalectwo1"
    pozycja 4, "i_serce1"
    pozycja 5, "i_pluslozko1"
    pozycja 6, "i_lozko1"
    pozycja 7, "i_smierc2"
    pozycja 8, "i_kalectwo2"
    pozycja 9, "i_serce2"
    pozycja 10, "i_pluslozko2"
    pozycja 11, "i_lozko2"
    pozycja 12, "i_smierc3"
    pozycja 13, "i_dziecko"
    pozycja 14, "i_assistance"
    pozycja 15, "i_zdrowie"
    
    'kraw|fffd|dzie przy drugim "nag|fffd||fffd|wku"
    If ws.Cells(Range("dane!podzialy").Cells(14) - 1, 9) <> 0 Then
        ws.Range(ws.Cells(Range("dane!podzialy").Cells(14) - 1, 2), _
                 ws.Cells(Range("dane!podzialy").Cells(14) - 1, 6)).Select
        With Selection.Borders(xlEdgeTop)
            .LineStyle = xlContinuous
            .Color = RGB(170, 170, 170)
            .Weight = xlMedium
        End With
        With Selection.Borders(xlEdgeBottom)
            .LineStyle = xlContinuous
            .Color = RGB(170, 170, 170)
            .Weight = xlMedium
        End With
    End If
    
    ws.Cells(1, 1).Select
    Blokuj ws.Name
    Application.Calculation = xlCalculationAutomatic
End Sub

Private Sub pozycja(i As Integer, obrazek As String)
    Dim ws As Worksheet
    Set ws = ActiveSheet
    Dim widac As Integer
    Dim gora As Integer
    Dim dol As Integer
    Dim koniecpetli As Integer
    If i = 13 Then
        koniecpetli = Range("dane!podzialy").Cells(i + 1) - 2
    Else
        koniecpetli = Range("dane!podzialy").Cells(i + 1) - 1
    End If
    widac = 0
    For j = Range("dane!podzialy").Cells(i) To koniecpetli
        If ws.Cells(j, 9) <> 0 Then
            widac = widac + 1
            'wysoko|fffd|ci wierszy w zale|fffd|no|fffd|ci od linii tekstu
            If ws.Cells(j, 14) = 1 Then
                If ws.Rows(j).RowHeight <> 18 Then ws.Rows(j).RowHeight = 18
            ElseIf ws.Cells(j, 14) = 2 Then
                If ws.Rows(j).RowHeight <> 30.75 Then ws.Rows(j).RowHeight = 30.75
            ElseIf ws.Cells(j, 14) = 3 Then
                If ws.Rows(j).RowHeight <> 43.5 Then ws.Rows(j).RowHeight = 43.5
            ElseIf ws.Cells(j, 14) = 4 Then
                If ws.Rows(j).RowHeight <> 55.5 Then ws.Rows(j).RowHeight = 55.5
            ElseIf ws.Cells(j, 14) = 6 Then
                If ws.Rows(j).RowHeight <> 81 Then ws.Rows(j).RowHeight = 81
            ElseIf ws.Cells(j, 14) = 7 Then
                If ws.Rows(j).RowHeight <> 97.5 Then ws.Rows(j).RowHeight = 97.5
            End If
            If widac = 1 Then gora = j
            dol = j
        End If
    Next j
    
    'ustawianie ikon, ewentualne zwi|fffd|kszanie wysoko|fffd|ci wierszy, szeroko|fffd|ci linii dla pe|fffd|nych klas |fffd|wiadcze|fffd|
    If widac > 0 Then
        ws.Shapes(obrazek).ScaleHeight 0.34, msoTrue
        If ws.Range(ws.Cells(gora, 2), ws.Cells(dol, 2)).Height < ws.Shapes(obrazek).Height + 5.25 Then
            For k = gora To dol
                If ws.Cells(k, 9) <> 0 Then ws.Rows(k).RowHeight = (ws.Shapes(obrazek).Height + 5.25) / widac
            Next k
        End If
        ws.Shapes(obrazek).Top = ws.Cells(gora, 1).Top + ws.Range(ws.Cells(gora, 1), ws.Cells(dol, 1)) _
                    .Height / 2 - ws.Shapes(obrazek).Height / 2
        ws.Shapes(obrazek).Left = 18.75
        ws.Range(ws.Cells(gora, 2), ws.Cells(dol, 6)).Select
        With Selection.Borders(xlEdgeTop)
            .LineStyle = xlContinuous
            .Color = RGB(170, 170, 170)
            .Weight = xlMedium
        End With
        With Selection.Borders(xlEdgeBottom)
            .LineStyle = xlContinuous
            .Color = RGB(170, 170, 170)
            .Weight = xlMedium
        End With
    Else
        ws.Shapes(obrazek).Top = 5
        ws.Shapes(obrazek).Left = ws.Cells(1, 8).Left + 5
    End If

End Sub
Attribute VB_Name = "druki"
Attribute VB_Base = "0{487B9006-EF77-426A-9232-7384111B02CF}{440E2BFC-B7DA-435B-9C8D-83C947C2A676}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub drukuj_dostosuj_Click()
    druki.Hide
    drukuj_wszystko False, False
    druki.Show
End Sub

Private Sub drukuj_pdf_Click()
    druki.Hide
    drukuj_wszystko False, True
    druki.Show
End Sub

Private Sub drukuj_szybko_Click()
    druki.Hide
    drukuj_wszystko True, False
    druki.Show
End Sub
Private Sub help1_Click()
    If help1a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
    Else
        help1a.Visible = True
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
    End If
End Sub
Private Sub help2_Click()
    If help2a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = True
        help3a.Visible = False
        help4a.Visible = False
    End If
End Sub
Private Sub help3_Click()
    If help3a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = True
        help4a.Visible = False
    End If
End Sub
Private Sub help4_Click()
    If help4a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
        help4a.Visible = True
    End If
End Sub
Private Sub powrot_Click()
    druki.Hide
End Sub
Private Sub UserForm_Activate()
    help1a.Visible = False
    help2a.Visible = False
    help3a.Visible = False
    help4a.Visible = False
    
    If Val(Application.Version) < 12 Then
        drukuj_pdf.Enabled = False
    Else
        drukuj_pdf.Enabled = True
    End If
End Sub
Private Sub zmien_zakres_Click()
    druki_strony.Show
End Sub
Attribute VB_Name = "druki_strony"
Attribute VB_Base = "0{0A93CF5B-8F26-4F74-B3DA-C6A532C466B0}{A93E08AC-B696-4AAC-B506-5739EA9AE46E}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ok_Click()
    druki_strony.Hide
End Sub

Private Sub tytulowa_Click()
    If tytulowa.Value = True Then
        Range("lista_do_wydruku").Cells(1) = True
    Else
        Range("lista_do_wydruku").Cells(1) = False
    End If
End Sub

Private Sub kat1_Click()
    If kat1.Value = True Then
        Range("lista_do_wydruku").Cells(2) = True
    Else
        Range("lista_do_wydruku").Cells(2) = False
    End If
End Sub

Private Sub kat2_Click()
    If kat2.Value = True Then
        Range("lista_do_wydruku").Cells(3) = True
    Else
        Range("lista_do_wydruku").Cells(3) = False
    End If
End Sub

Private Sub kat3_Click()
    If kat3.Value = True Then
        Range("lista_do_wydruku").Cells(4) = True
    Else
        Range("lista_do_wydruku").Cells(4) = False
    End If
End Sub

Private Sub kat4_Click()
    If kat4.Value = True Then
        Range("lista_do_wydruku").Cells(5) = True
    Else
        Range("lista_do_wydruku").Cells(5) = False
    End If
End Sub

Private Sub kat5_Click()
    If kat5.Value = True Then
        Range("lista_do_wydruku").Cells(6) = True
    Else
        Range("lista_do_wydruku").Cells(6) = False
    End If
End Sub

Private Sub kat6_Click()
    If kat6.Value = True Then
        Range("lista_do_wydruku").Cells(7) = True
    Else
        Range("lista_do_wydruku").Cells(7) = False
    End If
End Sub

Private Sub kat7_Click()
    If kat7.Value = True Then
        Range("lista_do_wydruku").Cells(8) = True
    Else
        Range("lista_do_wydruku").Cells(8) = False
    End If
End Sub

Private Sub kat8_Click()
    If kat8.Value = True Then
        Range("lista_do_wydruku").Cells(9) = True
    Else
        Range("lista_do_wydruku").Cells(9) = False
    End If
End Sub

Private Sub opis_Click()
    If opis.Value = True Then
        Range("lista_do_wydruku").Cells(10) = True
    Else
        Range("lista_do_wydruku").Cells(10) = False
    End If
End Sub

Private Sub UserForm_Activate()
    If Sheets("Kategoria 1").Visible Then kat1.Enabled = True Else kat1.Enabled = False
    If Sheets("Kategoria 2").Visible Then kat2.Enabled = True Else kat2.Enabled = False
    If Sheets("Kategoria 3").Visible Then kat3.Enabled = True Else kat3.Enabled = False
    If Sheets("Kategoria 4").Visible Then kat4.Enabled = True Else kat4.Enabled = False
    If Sheets("Kategoria 5").Visible Then kat5.Enabled = True Else kat5.Enabled = False
    If Sheets("Kategoria 6").Visible Then kat6.Enabled = True Else kat6.Enabled = False
    If Sheets("Kategoria 7").Visible Then kat7.Enabled = True Else kat7.Enabled = False
    If Sheets("Kategoria 8").Visible Then kat8.Enabled = True Else kat8.Enabled = False
    If Sheets("Opis").Visible Then opis.Enabled = True Else opis.Enabled = False

    tytulowa.Value = Range("lista_do_wydruku").Cells(1)
    kat1.Value = Range("lista_do_wydruku").Cells(2)
    kat2.Value = Range("lista_do_wydruku").Cells(3)
    kat3.Value = Range("lista_do_wydruku").Cells(4)
    kat4.Value = Range("lista_do_wydruku").Cells(5)
    kat5.Value = Range("lista_do_wydruku").Cells(6)
    kat6.Value = Range("lista_do_wydruku").Cells(7)
    kat7.Value = Range("lista_do_wydruku").Cells(8)
    kat8.Value = Range("lista_do_wydruku").Cells(9)
    opis.Value = Range("lista_do_wydruku").Cells(10)
End Sub

Attribute VB_Name = "drukowanie"
Option Private Module

'PRZYGOTOWANIE STRONY WYDRUKU, DRUKOWANIE
Sub drukuj_wszystko(ponowny As Boolean, pdf As Boolean)
    Dim ws As Worksheet
    Dim wiersz As Integer
    Dim szer As Double
    Dim inazwa As String
    Dim ikona As Object
    Dim podzialy As Integer
    Dim stopka_tekst As String
    
    If Sheets("dane").Range("blokada_PPE") Then
        MsgBox "Uwaga! Dane w arkuszu dotycz|fffd| ubezpieczenia PPE, BONUS," & Chr(10) _
                & "lub wyst|fffd|puj|fffd| sumy ubezpieczenia zale|fffd|ne od wynagrodzenia." & Chr(10) _
                & "Drukowanie zosta|fffd|o zablokowane.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
        Exit Sub
    End If
    
    If Workbooks.Count > 1 Then
        odp = MsgBox("Uwaga: w tym momencie otwartych jest " & Workbooks.Count - 1 & " innych skoroszyt|fffd|w " _
            & "programu Excel. Je|fffd|li skoroszyty zawieraj|fffd| du|fffd|o formu|fffd|, zaleca si|fffd| ich zamkni|fffd|cie, aby nie spowalnia|fffd| dzia|fffd|ania " _
            & "programu. Czy chcesz kontynuowa|fffd| bez zamykania innych plik|fffd|w?", vbYesNo, "Ostrze|fffd|enie")
        If odp = vbNo Then Exit Sub
    End If
    
    BlokujArkusz False
    
    Application.EnableCancelKey = xlDisabled
  '  On Error GoTo przerwij:
    
    'czy to wydruk ponowny?
    If ponowny Then GoTo drukowanie:
            
    'wyb|fffd|r drukarki
    If Not pdf Then
        ok = MsgBox("Aktywna drukarka to: " & ActivePrinter & "." & Chr(10) _
            & "Czy chcesz wybra|fffd| inn|fffd| drukark|fffd|?", vbYesNo)
        If ok = vbYes Then Application.Dialogs(xlDialogPrinterSetup).Show
    End If
    
    'czy drukowana Strona Tytu|fffd|owa, obszar druku, stopka
    If Range("lista_do_wydruku").Cells(1) Then
        With Sheets("Strona Tytu|fffd|owa").PageSetup
            .PrintArea = "$A$1:$L$69"
            .LeftFooter = "Osoba do kontaktu: " & Sheets("dane").Range("C7")
            .RightFooter = "Wersja programu: " & Sheets("dane").Range("H20")
        End With
    End If
    
    'odkrywanie i czyszczenie strony wydruku
    If Sheets("druk").Visible = False Then Sheets("druk").Visible = True
    wyczysc_druk
    
    'roboczy obszar druku (maksymalny), usuni|fffd|cie podzia|fffd||fffd|w stron
    Sheets("druk").PageSetup.PrintArea = "$B$2:$F$" & 8 * Application.WorksheetFunction.Max(Range("dane!podzialy_str")) + _
                Application.WorksheetFunction.Max(Range("dane!podzialy_opis"))
    Sheets("druk").ResetAllPageBreaks

    
    'szeroko|fffd|ci kolumn jak w "Kategorii 1"
    For i = 1 To 7
        Sheets("druk").Columns(i).ColumnWidth = Sheets("Kategoria 1").Columns(i).ColumnWidth
    Next i

    wiersz = 1

    'P|fffd|TLA DLA WSZYSTKICH AKTYWNYCH KATEGORII - kopiowanie do arkusza "druk"
    For i = 1 To 8
        If Range("lista_do_wydruku").Cells(1 + i) Then
            'kopiowanie tekstu z formatami
            Set ws = Sheets("Kategoria " & i)
            Odblokuj "Kategoria " & i
            ws.Range("A1:G" & Application.WorksheetFunction.Max(Range("dane!podzialy_str")) + 1).Copy
            Sheets("druk").Cells(wiersz, 1).PasteSpecial Paste:=xlPasteValuesAndNumberFormats
            ws.Range("A1:G" & Application.WorksheetFunction.Max(Range("dane!podzialy_str")) + 1).Copy
            Sheets("druk").Cells(wiersz, 1).PasteSpecial Paste:=xlPasteFormats
            
            'ukrywanie ukrytych w kategorii wierszy
            For j = 1 To Application.WorksheetFunction.Max(Range("dane!podzialy_str")) + 1
                If ws.Rows(j).Hidden = True Then
                    Sheets("druk").Rows(wiersz - 1 + j).Hidden = True
                Else
                    Sheets("druk").Rows(wiersz - 1 + j).RowHeight = ws.Rows(j).RowHeight
                End If
            Next j
            
            'tworzenie listy mo|fffd|liwych podzia|fffd||fffd|w stron
            Range("dane!podzialy_temp") = ""
            For j = 1 To Application.WorksheetFunction.Count(Range("dane!podzialy_str")) - 1
                podzialy = 0
                For j2 = Range("dane!podzialy").Cells(j) To Range("dane!podzialy_str").Cells(j + 1) - 1
                    If ws.Rows(j2).Hidden = False Then podzialy = podzialy + 1
                Next j2
                If podzialy > 0 Then
                    If j = 15 And Range("dane!podzialy_temp").Cells(14) = "" Then
                        Range("dane!podzialy_temp").Cells(14) = Range("dane!podzialy_str").Cells(14)
                    Else
                        Range("dane!podzialy_temp").Cells(j) = Range("dane!podzialy_str").Cells(j)
                    End If
                End If
            Next j
            Range("dane!podzialy_temp").Cells(Application.WorksheetFunction.Count(Range("dane!podzialy_str"))) = _
                Range("dane!podzialy_str").Cells(Application.WorksheetFunction.Count(Range("dane!podzialy_str")))
            
            'kopiowanie ikonek
            For Each ikona In ws.Shapes
                ikona.Copy
                Sheets("druk").Activate
                Sheets("druk").Cells(1, 1).Select
                Sheets("druk").Paste
                With Selection.ShapeRange
                    .Left = ikona.Left
                    .Top = ikona.Top + Sheets("druk").Cells(wiersz, 1).Top
                End With
            Next ikona
            
            'ukrycie tekstu z wiersza 2 dla wszystkich kategorii poza kategori|fffd| 1
            If i <> 1 Then Cells(wiersz + 1, 2).ClearContents
            
            'ustawienie podzia|fffd||fffd|w stron
            For j = 2 To Application.WorksheetFunction.Max(Range("dane!podzialy_str"))
                'wyszukanie podzia|fffd|u strony
                If Sheets("druk").Rows(j + wiersz - 1).Hidden = False Then Sheets("druk").Cells(j + wiersz - 1, 1).Select 'bez zaznaczania wyst|fffd|puje b|fffd||fffd|d, z niewiadomych powod|fffd|w
                If Sheets("druk").Rows(j + wiersz - 1).PageBreak = xlPageBreakAutomatic Then
                    podzialy = j
                    'znalezienie w|fffd|a|fffd|ciwego miejsca na podzia|fffd| strony
                    Do Until Application.WorksheetFunction.CountIf(Range(Range("dane!podzialy_temp").Cells(2), _
                                Range("dane!podzialy_temp").Cells(Range("dane!podzialy_str").Count)), j) = 1 Or j < 3
                        j = j - 1
                    Loop
                    'modu|fffd| ustawiaj|fffd|cy nag|fffd||fffd|wek, je|fffd|li jest potrzebny i wstawiaj|fffd|cy podzia|fffd| strony
                    If j > Application.WorksheetFunction.Min(Range("dane!podzialy_temp")) Then
                        If j < Range("dane!podzialy_str").Cells(14) Then
                            Sheets("druk").Rows(j + wiersz - 1).Insert
                            Sheets("druk").Rows(j + wiersz - 1).Insert
                            Sheets("druk").Rows(j + wiersz - 1).RowHeight = ws.Rows(4).RowHeight
                            Sheets("druk").Rows(j + wiersz).RowHeight = ws.Rows(5).RowHeight
                            ws.Range("B4:F5").Copy
                            Sheets("druk").Cells(j + wiersz - 1, 2).PasteSpecial Paste:=xlPasteValuesAndNumberFormats
                            Sheets("druk").Cells(j + wiersz - 1, 2).PasteSpecial Paste:=xlPasteFormats
                            If Sheets("druk").Rows(j + wiersz - 1).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(j + wiersz - 1)
                            wiersz = wiersz + 2
                        ElseIf j = Range("dane!podzialy_str").Cells(15) Then
                            Sheets("druk").Rows(j + wiersz - 1).Insert
                            Sheets("druk").Rows(j + wiersz - 1).RowHeight = ws.Rows(Range("dane!podzialy_str").Cells(14)).RowHeight
                            ws.Range(ws.Cells(Range("dane!podzialy_str").Cells(14), 2), ws.Cells(Range("dane!podzialy_str").Cells(14), 6)).Copy
                            Sheets("druk").Cells(j + wiersz - 1, 2).PasteSpecial Paste:=xlPasteValues
                            Sheets("druk").Cells(j + wiersz - 1, 2).PasteSpecial Paste:=xlPasteFormats
                            If Sheets("druk").Rows(j + wiersz - 1).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(j + wiersz - 1)
                             wiersz = wiersz + 1
                        Else
                            If Sheets("druk").Rows(j + wiersz - 1).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(j + wiersz - 1)
                        End If
                    Else
                        If Sheets("druk").Rows(j + wiersz - 1).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(j + wiersz - 1)
                    End If
                    j = podzialy
                End If
            Next j
            Blokuj "Kategoria " & i
            
            'przesuni|fffd|cie pozycji do wstawiania kom|fffd|rek nast|fffd|pnych kategorii
            wiersz = wiersz + Application.WorksheetFunction.Max(Range("dane!podzialy_str")) + 1
        End If
    Next i

    'USTAWIENIA DLA OPISU - kopiowanie zawarto|fffd|ci jako obrazy (inne szeroko|fffd|ci kolumn)
    If Range("dane!lista_do_wydruku").Cells(10) Then
        Set ws = Sheets("Opis")
        'przerwa od ostatniej kategorii, tytu|fffd|
        Sheets("druk").Rows(wiersz).RowHeight = 15
        Sheets("druk").Rows(wiersz + 1).RowHeight = 15
        Sheets("druk").Cells(wiersz + 1, 2) = "Szczeg|fffd|owy opis zdarze|fffd| obj|fffd|tych ubezpieczeniem"
        Sheets("druk").Cells(2, 2).Copy
        Sheets("druk").Cells(wiersz + 1, 2).PasteSpecial Paste:=xlPasteFormats
        Sheets("druk").Rows(wiersz + 2).RowHeight = 10.5
        
        'tworzenie listy mo|fffd|liwych podzia|fffd||fffd|w stron
        Range("dane!podzialy_temp") = ""
        For j = 1 To Application.WorksheetFunction.Count(Range("dane!podzialy_opis")) - 1
            If ws.Cells(ws.Range("podzialy_opis").Cells(j), 7) > 0 Then _
                Range("dane!podzialy_temp").Cells(j) = Range("dane!podzialy_opis").Cells(j)
        Next j
        
        'kopiowanie nag|fffd||fffd|wka
        ws.Range("B2:E2").CopyPicture xlPrinter
        Sheets("druk").Activate
        Sheets("druk").Cells(wiersz + 3, 2).Select
        ActiveSheet.Paste
        szer = Selection.Width - Sheets("druk").Range("B:F").Width
        inazwa = Selection.Name
        Sheets("druk").Shapes(inazwa).PictureFormat.CropBottom = 2
        Sheets("druk").Rows(wiersz + 3).RowHeight = Selection.Height
        If szer > 0 Then Sheets("druk").Shapes(inazwa).PictureFormat.CropRight = szer
        wiersz = wiersz + 4
            
        'kopiowanie wszystkich opis|fffd|w
        For i = 1 To Application.WorksheetFunction.Count(ws.Range("podzialy_opis")) - 1
            If ws.Cells(ws.Range("podzialy_opis").Cells(i), 7) > 0 Then
                ws.Range("B" & ws.Range("podzialy_opis").Cells(i) & ":E" & ws.Range("podzialy_opis").Cells(i + 1) - 1).CopyPicture xlPrinter
                Sheets("druk").Activate
                Sheets("druk").Cells(wiersz, 2).Select
                ActiveSheet.Paste
                szer = Selection.Width - Sheets("druk").Range("B:F").Width
                inazwa = Selection.Name
                If szer > 0 Then
                    Sheets("druk").Shapes(inazwa).PictureFormat.CropLeft = szer
                    Selection.ShapeRange.Left = Sheets("druk").Cells(1, 2).Left
                End If
                For j = ws.Range("podzialy_opis").Cells(i) To ws.Range("podzialy_opis").Cells(i + 1) - 1
                    Sheets("druk").Rows(j + wiersz - ws.Range("podzialy_opis").Cells(i)).RowHeight = _
                        Sheets("druk").Shapes(inazwa).Height / (ws.Range("podzialy_opis").Cells(i + 1) - ws.Range("podzialy_opis").Cells(i))
                Next j
                Sheets("druk").Shapes(inazwa).PictureFormat.CropBottom = 3
                
                'modu|fffd| ustawiaj|fffd|cy nag|fffd||fffd|wek, je|fffd|li jest potrzebny i wstawiaj|fffd|cy podzia|fffd| strony
                For j = ws.Range("podzialy_opis").Cells(i) To ws.Range("podzialy_opis").Cells(i + 1) - 1
                    If Sheets("druk").Rows(j + wiersz - ws.Range("podzialy_opis").Cells(i)).PageBreak = xlPageBreakAutomatic Then
                        If ws.Range("podzialy_opis").Cells(i) > Application.WorksheetFunction.Min(Range("dane!podzialy_temp")) Then
                            Sheets("druk").Rows(wiersz).Insert
                            ws.Range("B2:E2").CopyPicture xlPrinter
                            Sheets("druk").Activate
                            Sheets("druk").Cells(wiersz, 2).Select
                            ActiveSheet.Paste
                            szer = Selection.Width - Sheets("druk").Range("B:F").Width
                            inazwa = Selection.Name
                            Sheets("druk").Shapes(inazwa).PictureFormat.CropBottom = 3
                            Sheets("druk").Rows(wiersz).RowHeight = Selection.Height
                            If szer > 0 Then Sheets("druk").Shapes(inazwa).PictureFormat.CropRight = szer
                            If Sheets("druk").Rows(wiersz).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(wiersz)
                            wiersz = wiersz + 1
                        Else
                            If Sheets("druk").Rows(wiersz - 1).PageBreak = xlPageBreakNone Then Sheets("druk").HPageBreaks.Add Before:=Sheets("druk").Rows(wiersz - 1)
                            Sheets("druk").Rows(wiersz - 4 & ":" & wiersz - 2).Hidden = True
                        End If
                    End If
                Next j
                
                'przesuni|fffd|cie pozycji do wstawiania kom|fffd|rek
                wiersz = wiersz + ws.Range("podzialy_opis").Cells(i + 1) - ws.Range("podzialy_opis").Cells(i)
            End If
        Next i
    End If
    
    'w|fffd|a|fffd|ciwy obszar druku
    Sheets("druk").PageSetup.PrintArea = "$B$2:$F$" & wiersz
    
drukowanie:
    'schowanie niedrukowanych arkuszy
    If Not Range("dane!lista_do_wydruku").Cells(1) Then Sheets("Strona Tytu|fffd|owa").Visible = False
    If Sheets("MENU").Visible = True Then Sheets("MENU").Visible = False
    For i = 1 To 8
        If Sheets("Kategoria " & i).Visible = True Then Sheets("Kategoria " & i).Visible = False
    Next i
    If Sheets("Opis").Visible = True Then Sheets("Opis").Visible = False
    If Sheets("Dane").Visible = True Then Sheets("Dane").Visible = False
    If Application.WorksheetFunction.Or(Range(Range("dane!lista_do_wydruku").Cells(2), Range("dane!lista_do_wydruku").Cells(10))) Then _
            Sheets("druk").Visible = True Else Sheets("druk").Visible = False

    'w|fffd||fffd|czenie wydruku
    Range("dane!blokada_wydruku") = False
    
    'wydruk normalny czy pdf
    If pdf Then
        'drukowanie do pdf
        pdf_nazwa = Application.GetSaveAsFilename(Left(ThisWorkbook.Name, _
            Len(ThisWorkbook.Name) - 3) & "pdf", "PDF (*.pdf), *.pdf")
        If pdf_nazwa <> False Then ActiveWorkbook.ExportAsFixedFormat Type:=xlTypePDF, _
            Filename:=pdf_nazwa, Quality:=xlQualityStandard, IncludeDocProperties:=True, _
            IgnorePrintAreas:=False, OpenAfterPublish:=True
    Else
        'drukowanie z podgl|fffd|dem
        ActiveWorkbook.PrintOut , , , True
    End If
        
    'odkrycie schowanych wcze|fffd|niej arkuszy
    Sheets("MENU").Visible = True
    Sheets("Strona Tytu|fffd|owa").Visible = True
    For i = 1 To 8
        If Range("dane!widac").Cells(1 + i) = True Then Sheets("Kategoria " & i).Visible = True
    Next i
    If Range("dane!widac").Cells(10) = True Then Sheets("Opis").Visible = True
    
    GoTo nie_bylo_przerwane:
przerwij:
    MsgBox "Wyst|fffd|pi|fffd| b|fffd||fffd|d. Wykonywanie dzia|fffd|a|fffd| zosta|fffd|o przerwane"
nie_bylo_przerwane:
   ' wyczysc_druk, zablokuj
   Sheets("druk").Visible = False
   Range("dane!blokada_wydruku") = True
   
   BlokujArkusz
   Sheets("MENU").Activate
End Sub

'czyszczenie arkusza "druk"
Sub wyczysc_druk()
    Dim ikona As Object
    Sheets("druk").Cells.EntireRow.Hidden = False
    Sheets("druk").Cells.Clear
    For Each ikona In Sheets("druk").Shapes
        ikona.Delete
    Next ikona
End Sub


Attribute VB_Name = "funkcje_dev"
Option Private Module

Public Const h_ As String = "fL"
Public Const a_ As String = "MSH"
Public Const s_ As String = "V6a"
Public Const l_ As String = "Slj"
Public Const o_ As String = "bhL"

'kopiowanie pierwszej kategorii po dokonaniu na nim zmian na kategorie 2-8
    'b|fffd|dzie dobrze dzia|fffd|a|fffd| tylko na ca|fffd|kowicie odblokowanym arkuszu
Private Sub kopiuj_pierwszy_arkusz()
    Dim nazwa As String
    For i = 2 To 8
        nazwa = "Kategoria " & 10 - i
        Application.DisplayAlerts = False
        Sheets(nazwa).Delete
        Application.DisplayAlerts = True
        Sheets("Kategoria 1").Copy After:=Sheets("Kategoria 1")
        Sheets("Kategoria 1 (2)").Name = nazwa
        Sheets(nazwa).Range("H4") = 10 - i
    Next i
End Sub

Sub Blokuj(str)
    Sheets(str).Protect Password:=h_ & a_ & s_ & l_ & o_
End Sub

Sub Odblokuj(str)
    Sheets(str).Unprotect Password:=h_ & a_ & s_ & l_ & o_
End Sub

Sub BlokujArkusz(Optional x As Boolean = True)
    If x = True Then 'BLOKOWANIE
        ActiveWorkbook.Protect Structure:=True, Windows:=False, Password:=h_ & a_ & s_ & l_ & o_
    ElseIf x = False Then 'ODBLOKOWANIE
        ActiveWorkbook.Unprotect Password:=h_ & a_ & s_ & l_ & o_
    End If
End Sub

'odblokowanie arkusza do developerki
Private Sub odblokuj_wszystko()
    BlokujArkusz False
    
    Dim ws As Worksheet
    For Each ws In ActiveWorkbook.Worksheets
        If ws.Visible = False Then ws.Visible = True
    Next ws
    
    Odblokuj "MENU"
    Odblokuj "Strona Tytu|fffd|owa"
    Odblokuj "Opis"
    For i = 1 To 8
        Odblokuj "Kategoria " & i
    Next i
End Sub

'zablokowanie do wysy|fffd|ki
Sub czysc_i_blokuj_wszystko()
    wyczysc_dane
        
    BlokujArkusz False
    Sheets("druk").Visible = True
    wyczysc_druk
    
    Blokuj "MENU"
    Odblokuj "Strona Tytu|fffd|owa"
    With Sheets("Strona Tytu|fffd|owa").PageSetup
        .LeftFooter = "Osoba do kontaktu: "
        .RightFooter = "Wersja programu: "
    End With
    Blokuj "Strona Tytu|fffd|owa"
    Blokuj "Opis"
    For i = 1 To 8
        Blokuj "Kategoria " & i
    Next i
    
    dostosuj_wszystko
    
    BlokujArkusz False
    Sheets("dane").Visible = False
    
    BlokujArkusz
    
    Sheets("MENU").Activate
End Sub
Attribute VB_Name = "importowanie"
Option Private Module

Sub wyczysc_dane()
    BlokujArkusz False
    Sheets("dane").Range("C2:J18").Clear
    Sheets("dane").Range("sumy").Offset(0, 1).Resize(, 8) = 0
    BlokujArkusz
    Sheets("dane").Range("blokada_PPE") = False
    Sheets("dane").Range("freq") = 12
End Sub

Sub importuj_pka()
    Dim katalog As String
    Dim pka As String
    katalog = ThisWorkbook.Path
    ChDir katalog
    filetoopen = Application.GetOpenFilename("PKA Opiekun (*.xls; *.xlsb; *.xlsm), *.xls;*.xlsb;*.xlsm")
    If filetoopen <> False Then
        BlokujArkusz False
        wyczysc_dane
        wyczysc_druk
        Workbooks.Open Filename:=filetoopen
        pka = ActiveWorkbook.Name

        Application.EnableCancelKey = xlDisabled
        On Error GoTo przerwij:
        Workbooks(pka).Unprotect Password:=h_ & a_ & s_ & l_ & o_
        Workbooks(pka).Sheets("tablice").Visible = True
        Workbooks(pka).Sheets("UWR").Visible = True
        Workbooks(pka).Sheets("licznik_1").Visible = True

        ThisWorkbook.Activate
        Application.Calculation = xlCalculationManual
        
        Sheets("dane").Range("typ") = 1
        
            'ma|fffd||fffd|onkowie - str. tytu|fffd|owa
            Odblokuj "Strona Tytu|fffd|owa"
            If Workbooks(pka).Sheets("tablice").Range("czy_wmalz") Then Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = False Else _
                Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = True
            Blokuj "Strona Tytu|fffd|owa"
        
        Sheets("dane").Range("C4") = Workbooks(pka).Sheets("tablice").Range("dane_pracodawcy").Cells(1)
        Sheets("dane").Range("C5") = Workbooks(pka).Sheets("tablice").Range("dane_pracodawcy").Cells(2)
        Sheets("dane").Range("D5") = Workbooks(pka).Sheets("tablice").Range("dane_pracodawcy").Cells(3)
        Sheets("dane").Range("C6") = Workbooks(pka).Sheets("tablice").Range("dane_grupy").Cells(3)
        Sheets("dane").Range("D6") = Workbooks(pka).Sheets("licznik_1").Range("licznik_data_liczenia")
        Sheets("dane").Range("C7") = Workbooks(pka).Sheets("tablice").Range("dane_agenta").Cells(1) _
                        & " (" & Workbooks(pka).Sheets("tablice").Range("dane_agenta").Cells(2) & ")" _
                        & " / tel. " & Workbooks(pka).Sheets("tablice").Range("dane_agenta").Cells(3)
        Sheets("dane").Range("C8") = Workbooks(pka).Sheets("tablice").Range("nr_kwotacji")
        Sheets("dane").Range("C10") = Workbooks(pka).Sheets("tablice").Range("dane_grupy").Cells(1)
        Sheets("dane").Range("C11") = Workbooks(pka).Sheets("tablice").Range("dane_grupy").Cells(2)
        Sheets("dane").Range("H20") = Workbooks(pka).Sheets("tablice").Range("wersja")
        If Application.WorksheetFunction.Sum(Workbooks(pka).Sheets("tablice").Range("ponad_ala")) > 0 _
                Then Sheets("dane").Range("C20") = True Else Sheets("dane").Range("C20") = False
        Sheets("dane").Range("D20") = Workbooks(pka).Sheets("UWR").Range("ALA")
        Sheets("dane").Range("C22") = Workbooks(pka).Sheets("tablice").Range("LS_zm_liczby_dni_lista").Cells(10, 2)
        Sheets("dane").Range("D22") = Workbooks(pka).Sheets("tablice").Range("ZDR_podn_wiek")
        Sheets("dane").Range("E22") = Workbooks(pka).Sheets("tablice").Range("ZOD_podn_wiek")
        
        Sheets("dane").Range("freq") = Workbooks(pka).Sheets("tablice").Range("freq")
        
        Dim nrkat As String
        For i = 1 To 4
            If i = 4 Then nrkat = "4_5" Else nrkat = i
            Sheets("dane").Cells(18, 2 + i) = "|fffd|redni wiek - " & Workbooks(pka).Sheets("tablice").Range("sredni_wiek").Cells(i) _
                    & "; udzia|fffd| m|fffd|czyzn - " & Format(1 - Workbooks(pka).Sheets("tablice").Range("odsetek_kobiet_kat").Cells(i), "0.00%") _
                    & "; udzia|fffd| prac. biurowych - " & Format(Workbooks(pka).Sheets("tablice").Range("kl_ryz_" & nrkat), "0.00%") _
                    & "; procent przyst|fffd|puj|fffd|cych - " & Format(Workbooks(pka).Sheets("tablice").Range("odsetek_przyst"), "0.00%")
            Sheets("dane").Cells(2, 2 + i) = Workbooks(pka).Sheets("tablice").Range("skladka_ochronna").Cells(i)
            Sheets("dane").Cells(15, 2 + i) = Workbooks(pka).Sheets("tablice").Range("ludzie_w_podgrupach").Cells(i)
            If i <> 4 Then Sheets("dane").Cells(16, 2 + i) = Workbooks(pka).Sheets("tablice").Range("kryterium_kategorii").Cells(i)
            If Sheets("dane").Cells(16, 2 + i) = False Then Sheets("dane").Cells(16, 2 + i) = 0
        Next i
        
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("A4:A54").Copy
        Sheets("dane").Cells(102, 13).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("C4:C54").Copy
        Sheets("dane").Cells(102, 14).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("E4:E54").Copy
        Sheets("dane").Cells(102, 15).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("G4:G54").Copy
        Sheets("dane").Cells(102, 16).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        
        For i = 1 To 51
            If Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Cells(3 + i, 10) = 1 Then
                poz = Application.WorksheetFunction.Match(Sheets("dane").Cells(i + 101, 13), Sheets("dane").Range("M:M"), 0)
                Sheets("dane").Range(Sheets("dane").Cells(i + 101, 14), Sheets("dane").Cells(i + 101, 16)).Copy
                Sheets("dane").Cells(poz, 14).PasteSpecial Paste:=xlValues
            End If
        Next i
        
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("A55:A78").Copy
        Sheets("dane").Cells(102, 13).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Range("C55:C78").Copy
        Sheets("dane").Cells(102, 14).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        
        Sheets("Dane").Range("F13") = 1
        For i = 1 To 24
            If Workbooks(pka).Sheets("tablice").Range("eksport_sum_skl").Cells(54 + i, 10) = 1 Then
                poz = Application.WorksheetFunction.Match(Sheets("dane").Cells(i + 101, 13), Sheets("dane").Range("M:M"), 0)
                Sheets("dane").Cells(i + 101, 14).Copy
                Sheets("dane").Cells(poz, 17).PasteSpecial Paste:=xlValues
            End If
        Next i
        
        If Workbooks(pka).Sheets("tablice").Range("proc") Then
            MsgBox "Uwaga! Zaimportowany arkusz zawiera sumy ubezpieczenia zale|fffd|ne" & Chr(10) _
                & "od wynagrodzenia. Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        End If
        
        Sheets("dane").Range(Sheets("dane").Cells(100, 13), Sheets("dane").Cells(200, 21)).Clear
    
    Sheets("dane").Range("ERROR") = False
    GoTo nie_bylo_przerwane:
przerwij:
    MsgBox "Wyst|fffd|pi|fffd| b|fffd||fffd|d. Wykonywanie dzia|fffd|a|fffd| zosta|fffd|o przerwane"
    Sheets("dane").Range("ERROR") = True
nie_bylo_przerwane:
    Application.Calculation = xlCalculationAutomatic
        Workbooks(pka).Close savechanges:=False
    Else
        Sheets("dane").Range("ERROR") = True
    End If
    BlokujArkusz
End Sub
Sub importuj_przelicznik(Optional blokada_bg As Boolean = True)
    Dim katalog As String
    Dim wzr As String
    Dim szkod As String
    Dim opcje As Integer
    katalog = ThisWorkbook.Path
    ChDir katalog
    filetoopen = Application.GetOpenFilename("Przelicznik (*.xls; *.xlsx), *.xls;*.xlsx")
    If filetoopen <> False Then
        BlokujArkusz False
        wyczysc_dane
        wyczysc_druk
        Sheets("dane").Range("D6") = FileDateTime(filetoopen)
        Workbooks.Open Filename:=filetoopen, UpdateLinks:=False
        wzr = ActiveWorkbook.Name
        
        On Error GoTo przerwij:
        If blokada_bg And Workbooks(wzr).Sheets("WYCENA").Cells(6, 1) Then
            For i = 88 To 94
                If Workbooks(wzr).Sheets("WYCENA").Range("EG" & i) = "tak" Then
                    MsgBox "Przeliczenie nie mo|fffd|e by|fffd| wykonane." & Chr(10) & _
                        "W przeliczniku s|fffd| przekroczone limity." & Chr(10) & _
                        "Wymagane jest przeliczenie przez Biuro G|fffd||fffd|wne.", vbOKOnly + vbExclamation
                    ThisWorkbook.Sheets("dane").Range("ERROR") = True
                    GoTo nie_bylo_przerwane: 'nazwa myl|fffd|ca, przerywa, tylko bez komunikatu
                End If
            Next i
        End If
        
        Workbooks(wzr).Unprotect Password:="e"
        Workbooks(wzr).Sheets("FORMULARZ").Visible = True
        Workbooks(wzr).Sheets("PARAMETRY").Visible = True
        Workbooks(wzr).Sheets("REKORDY").Visible = True
        Workbooks(wzr).Sheets("WYCENA").Unprotect Password:="e"
        Application.EnableCancelKey = xlDisabled
        
        opcje = Application.WorksheetFunction.CountA(Workbooks(wzr).Sheets("WYCENA").Range("C15:C100"))
        ThisWorkbook.Activate
        Application.Calculation = xlCalculationManual
        
        If Workbooks(wzr).Sheets("REKORDY").Range("C20") <= 3 Or Workbooks(wzr).Sheets("REKORDY").Range("C20") = 6 Then
            Sheets("dane").Range("typ") = 1
        ElseIf Workbooks(wzr).Sheets("REKORDY").Range("C20") = 4 Then
            Sheets("dane").Range("typ") = 2
        Else
            Sheets("dane").Range("typ") = 3
        End If
        
        'ma|fffd||fffd|onkowie - str. tytu|fffd|owa
        If Sheets("dane").Range("typ") = 1 Then
            Odblokuj "Strona Tytu|fffd|owa"
            ok = MsgBox("Czy wsp|fffd|ma|fffd||fffd|onek mo|fffd|e by|fffd| uczestnikiem ubezpieczenia?", vbYesNo, "Kontrola danych")
            If ok = vbYes Then Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = False Else _
                Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = True
            Blokuj "Strona Tytu|fffd|owa"
        End If
        
        Workbooks(wzr).Sheets("WYCENA").Range("KLOCEK").Resize(8, 1).Offset(1).Copy
        Sheets("dane").Cells(13, 3).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        
        Sheets("dane").Range("C4") = Workbooks(wzr).Sheets("FORMULARZ").Range("D6")
        Sheets("dane").Range("C5") = Workbooks(wzr).Sheets("FORMULARZ").Range("D8")
        Sheets("dane").Range("E6") = Workbooks(wzr).Sheets("FORMULARZ").Range("D16")
        Sheets("dane").Range("C8") = Workbooks(wzr).Sheets("WYCENA").Range("D7")
        Sheets("dane").Range("C10") = Workbooks(wzr).Sheets("FORMULARZ").Range("D12")
        'Sheets("dane").Range("H20") = wzr
        Sheets("dane").Range("H20") = "przelicznik_" & 100 * Workbooks(wzr).Sheets("WYCENA").Range("prowizja")
        Sheets("dane").Range("H22") = Workbooks(wzr).Sheets("FORMULARZ").Range("D7")
        
        Sheets("dane").Range("freq") = Workbooks(wzr).Sheets("WYCENA").Range("freq")
        
        szkod = Workbooks(wzr).Sheets("REKORDY").Range("C67")
        If InStr(szkod, "ZDR") > 0 Then
            szkod = Right(szkod, Len(szkod) - InStr(szkod, "ZDR") - 2)
            Sheets("dane").Range("C22") = Val(szkod) - 1
            If Val(szkod) = 7 Then Sheets("dane").Range("C22") = 7
            If Val(szkod) = 8 Then Sheets("dane").Range("C22") = 6
            If Val(szkod) = 9 Then Sheets("dane").Range("C22") = 9
            If Val(szkod) = 10 Then Sheets("dane").Range("C22") = 8
            szkod = Right(szkod, Len(szkod) - 4)
            If Left(szkod, 1) = "P" Then
                Sheets("dane").Range("D22") = True
            Else
                Sheets("dane").Range("D22") = False
            End If
            If Right(szkod, 1) = "A" Then
                Sheets("dane").Range("E22") = True
            Else
                Sheets("dane").Range("E22") = False
            End If
        Else
            Sheets("dane").Range("C22") = 0
            Sheets("dane").Range("D22") = False
            Sheets("dane").Range("E22") = False
        End If
        
        Workbooks(wzr).Sheets("WYCENA").Range(Workbooks(wzr).Sheets("WYCENA").Cells(16, 3), Workbooks(wzr).Sheets("WYCENA").Cells(15 + opcje, 3)).Copy
        Sheets("dane").Cells(102, 13).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        For i = 1 To 8
            If Workbooks(wzr).Sheets("WYCENA").Columns(16 * i - 9).Hidden = False Then
                Sheets("dane").Cells(18, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(8, 16 * i - 9)
          '      Sheets("dane").Cells(16, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(11, 16 * i - 9)
                Sheets("dane").Cells(15, 2 + i) = Workbooks(wzr).Sheets("PARAMETRY").Cells(72, 28 + i)
                Sheets("dane").Cells(2, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(10, 16 * i - 8)
                Workbooks(wzr).Sheets("WYCENA").Range(Workbooks(wzr).Sheets("WYCENA").Cells(16, 16 * i - 9), Workbooks(wzr).Sheets("WYCENA").Cells(15 + opcje, 16 * i - 9)).Copy
                Sheets("dane").Cells(102, 13 + i).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
            End If
        Next i
    
        For i = 1 To opcje
            If Sheets("dane").Cells(i + 101, 13) <> "" Then
                poz = Application.WorksheetFunction.Match(Sheets("dane").Cells(i + 101, 13), Sheets("dane").Range("M:M"), 0)
                Sheets("dane").Range(Sheets("dane").Cells(i + 101, 14), Sheets("dane").Cells(i + 101, 21)).Copy
                Sheets("dane").Cells(poz, 14).PasteSpecial Paste:=xlValues
            End If
        Next i
        
        Sheets("dane").Range(Sheets("dane").Cells(100, 13), Sheets("dane").Cells(200, 21)).Clear
        
        If Application.WorksheetFunction.Max(Sheets("dane").Range("sumy")) > Workbooks(wzr).Sheets("PARAMETRY").Range("R70") _
                Then Sheets("dane").Range("C20") = True Else Sheets("dane").Range("C20") = False
        Sheets("dane").Range("D20") = Workbooks(wzr).Sheets("PARAMETRY").Range("R70")
        
        If Workbooks(wzr).Sheets("WYCENA").Range("PPE") Then
            MsgBox "Uwaga! Zaimportowany arkusz zawiera dane dotycz|fffd|ce Pracowniczego" & Chr(10) _
                & "Programu Emerytalnego. Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        ElseIf Workbooks(wzr).Sheets("WYCENA").Range("wyn") Then
            MsgBox "Uwaga! Zaimportowany arkusz zawiera sumy ubezpieczenia zale|fffd|ne" & Chr(10) _
                & "od wynagrodzenia. Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        ElseIf Left(Workbooks(wzr).Sheets("REKORDY").Range("C61"), 3) = "ZUB" And Val(Workbooks(wzr).Sheets("REKORDY").Range("C62")) < 1 Then
            MsgBox "Uwaga! Zaimportowany arkusz dotyczy ubezpieczenia " & Chr(34) & "BONUS" & Chr(34) & "." & Chr(10) _
                & "Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        End If
        
    
    Sheets("dane").Range("ERROR") = False
    GoTo nie_bylo_przerwane:
przerwij:
    MsgBox "Wyst|fffd|pi|fffd| b|fffd||fffd|d. Wykonywanie dzia|fffd|a|fffd| zosta|fffd|o przerwane"
    Sheets("dane").Range("ERROR") = True
nie_bylo_przerwane:
    Application.Calculation = xlCalculationAutomatic
        Workbooks(wzr).Close savechanges:=False
    Else
        Sheets("dane").Range("ERROR") = True
    End If
    BlokujArkusz
End Sub

Sub importuj_wzr()
    Dim katalog As String
    Dim wzr As String
    Dim szkod As String
    Dim opcje As Integer
    katalog = ThisWorkbook.Path
    ChDir katalog
    filetoopen = Application.GetOpenFilename("Wybrany_zakres_rekordy (*.xls), *.xls")
    If filetoopen <> False Then
        BlokujArkusz False
        wyczysc_dane
        wyczysc_druk
        Sheets("dane").Range("D6") = FileDateTime(filetoopen)
        Workbooks.Open Filename:=filetoopen, UpdateLinks:=False
        wzr = ActiveWorkbook.Name
        
        Application.EnableCancelKey = xlDisabled
        On Error GoTo przerwij:
        opcje = Application.WorksheetFunction.CountA(Workbooks(wzr).Sheets("WYCENA").Range("C15:C100"))
        ThisWorkbook.Activate
        Application.Calculation = xlCalculationManual
        
        If Workbooks(wzr).Sheets("REKORDY").Range("C20") <= 3 Or Workbooks(wzr).Sheets("REKORDY").Range("C20") = 6 Then
            Sheets("dane").Range("typ") = 1
        ElseIf Workbooks(wzr).Sheets("REKORDY").Range("C20") = 4 Then
            Sheets("dane").Range("typ") = 2
        Else
            Sheets("dane").Range("typ") = 3
        End If
        
        'ma|fffd||fffd|onkowie - str. tytu|fffd|owa
        If Sheets("dane").Range("typ") = 1 Then
            Odblokuj "Strona Tytu|fffd|owa"
            ok = MsgBox("Czy wsp|fffd|ma|fffd||fffd|onek mo|fffd|e by|fffd| uczestnikiem ubezpieczenia?", vbYesNo, "Kontrola danych")
            If ok = vbYes Then Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = False Else _
                Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = True
            Blokuj "Strona Tytu|fffd|owa"
        End If
        
        Workbooks(wzr).Sheets("WYCENA").Range("KLOCEK").Resize(8, 1).Offset(1).Copy
        Sheets("dane").Cells(13, 3).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=True
        
        Sheets("dane").Range("C4") = Workbooks(wzr).Sheets("FORMULARZ").Range("D6")
        Sheets("dane").Range("C5") = Workbooks(wzr).Sheets("FORMULARZ").Range("D8")
        Sheets("dane").Range("E6") = Workbooks(wzr).Sheets("FORMULARZ").Range("D16")
        Sheets("dane").Range("C8") = Workbooks(wzr).Sheets("WYCENA").Range("D7")
        Sheets("dane").Range("C10") = Workbooks(wzr).Sheets("FORMULARZ").Range("D12")
    '    Sheets("dane").Range("H20") = wzr
        Sheets("dane").Range("H20") = "wybrany_zakres_rekordy_" & 100 * Workbooks(wzr).Sheets("WYCENA").Range("prowizja")
        Sheets("dane").Range("H22") = Workbooks(wzr).Sheets("FORMULARZ").Range("D7")
        
        Sheets("dane").Range("freq") = Workbooks(wzr).Sheets("WYCENA").Range("freq")
        
        szkod = Workbooks(wzr).Sheets("REKORDY").Range("C67")
        If InStr(szkod, "ZDR") > 0 Then
            szkod = Right(szkod, Len(szkod) - InStr(szkod, "ZDR") - 2)
            Sheets("dane").Range("C22") = Val(szkod) - 1
            If Val(szkod) = 7 Then Sheets("dane").Range("C22") = 7
            If Val(szkod) = 8 Then Sheets("dane").Range("C22") = 6
            If Val(szkod) = 9 Then Sheets("dane").Range("C22") = 9
            If Val(szkod) = 10 Then Sheets("dane").Range("C22") = 8
            szkod = Right(szkod, Len(szkod) - 4)
            If Left(szkod, 1) = "P" Then
                Sheets("dane").Range("D22") = True
            Else
                Sheets("dane").Range("D22") = False
            End If
            If Right(szkod, 1) = "A" Then
                Sheets("dane").Range("E22") = True
            Else
                Sheets("dane").Range("E22") = False
            End If
        Else
            Sheets("dane").Range("C22") = 0
            Sheets("dane").Range("D22") = False
            Sheets("dane").Range("E22") = False
        End If
        
        Workbooks(wzr).Sheets("WYCENA").Range(Workbooks(wzr).Sheets("WYCENA").Cells(16, 3), Workbooks(wzr).Sheets("WYCENA").Cells(15 + opcje, 3)).Copy
        Sheets("dane").Cells(102, 13).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        For i = 1 To 8
            Sheets("dane").Cells(18, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(8, 16 * i - 9)
          '  Sheets("dane").Cells(16, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(11, 16 * i - 9)
            Sheets("dane").Cells(15, 2 + i) = Workbooks(wzr).Sheets("PARAMETRY").Cells(72, 28 + i)
            Sheets("dane").Cells(2, 2 + i) = Workbooks(wzr).Sheets("WYCENA").Cells(10, 16 * i - 8)
            Workbooks(wzr).Sheets("WYCENA").Range(Workbooks(wzr).Sheets("WYCENA").Cells(16, 16 * i - 9), Workbooks(wzr).Sheets("WYCENA").Cells(15 + opcje, 16 * i - 9)).Copy
            Sheets("dane").Cells(102, 13 + i).PasteSpecial Paste:=xlValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
        Next i
    
        For i = 1 To opcje
            If Sheets("dane").Cells(i + 101, 13) <> "" Then
                poz = Application.WorksheetFunction.Match(Sheets("dane").Cells(i + 101, 13), Sheets("dane").Range("M:M"), 0)
                Sheets("dane").Range(Sheets("dane").Cells(i + 101, 14), Sheets("dane").Cells(i + 101, 21)).Copy
                Sheets("dane").Cells(poz, 14).PasteSpecial Paste:=xlValues
            End If
        Next i
        
        Sheets("dane").Range(Sheets("dane").Cells(100, 13), Sheets("dane").Cells(200, 21)).Clear
        
        If Application.WorksheetFunction.Max(Sheets("dane").Range("sumy")) > Workbooks(wzr).Sheets("PARAMETRY").Range("R70") _
                Then Sheets("dane").Range("C20") = True Else Sheets("dane").Range("C20") = False
        Sheets("dane").Range("D20") = Workbooks(wzr).Sheets("PARAMETRY").Range("R70")
        
        If Workbooks(wzr).Sheets("WYCENA").Range("PPE") Then
            MsgBox "Uwaga! Zaimportowany arkusz zawiera dane dotycz|fffd|ce Pracowniczego" & Chr(10) _
                & "Programu Emerytalnego. Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        ElseIf Workbooks(wzr).Sheets("WYCENA").Range("wyn") Then
            MsgBox "Uwaga! Zaimportowany arkusz zawiera sumy ubezpieczenia zale|fffd|ne" & Chr(10) _
                & "od wynagrodzenia. Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        ElseIf Left(Workbooks(wzr).Sheets("REKORDY").Range("C61"), 3) = "ZUB" And Val(Workbooks(wzr).Sheets("REKORDY").Range("C62")) < 1 Then
            MsgBox "Uwaga! Zaimportowany arkusz dotyczy ubezpieczenia " & Chr(34) & "BONUS" & Chr(34) & "." & Chr(10) _
                & "Kategorie mog|fffd| nie wy|fffd|wietla|fffd| si|fffd| poprawnie." & Chr(10) & "Opcja drukowania zostanie zablokowana.", _
                vbOKOnly + vbExclamation, "Ostrze|fffd|enie"
            Sheets("dane").Range("blokada_PPE") = True
        End If
        
    
    Sheets("dane").Range("ERROR") = False
    GoTo nie_bylo_przerwane:
przerwij:
    MsgBox "Wyst|fffd|pi|fffd| b|fffd||fffd|d. Wykonywanie dzia|fffd|a|fffd| zosta|fffd|o przerwane"
    Sheets("dane").Range("ERROR") = True
nie_bylo_przerwane:
    Application.Calculation = xlCalculationAutomatic
        Workbooks(wzr).Close savechanges:=False
    Else
        Sheets("dane").Range("ERROR") = True
    End If
    BlokujArkusz
End Sub
Attribute VB_Name = "importy"
Attribute VB_Base = "0{135E4F7B-B00D-49DE-B74D-1F81DF01108E}{F32768DD-BB7A-41E2-BEEE-A06ABDA30FA7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub help1_Click()
    If help1a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
    Else
        help1a.Visible = True
        help2a.Visible = False
        help3a.Visible = False
    End If
End Sub
Private Sub help2_Click()
    If help2a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = True
        help3a.Visible = False
    End If
End Sub
Private Sub help3_Click()
    If help3a.Visible = True Then
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = False
    Else
        help1a.Visible = False
        help2a.Visible = False
        help3a.Visible = True
    End If
End Sub
Private Sub import_pka_Click()
    importy.Hide
    importuj_pka
    If Not Sheets("dane").Range("ERROR") Then
        dostosuj_wszystko
    Else
        importy.Show
    End If
End Sub

Private Sub import_przelicznik_Click()
    importy.Hide
    importuj_przelicznik Not odblokuj_bg.Value
    If Not Sheets("dane").Range("ERROR") Then
        dostosuj_wszystko
    Else
        importy.Show
    End If
End Sub

Private Sub import_wzr_Click()
    importy.Hide
    importuj_wzr
    If Not Sheets("dane").Range("ERROR") Then
        dostosuj_wszystko
    Else
        importy.Show
    End If
End Sub
Private Sub powrot_Click()
    importy.Hide
End Sub

Private Sub zaawansowane_Click()
    If zaawansowane.Value = True Then
        ok = InputBox("has|fffd|o:", "Has|fffd|o")
        If ok = "xxx" Then
            importy.Height = 267
            zaawansowane.Caption = "Ukryj opcje zaawansowane"
        Else
            zaawansowane.Value = False
        End If
    Else
        importy.Height = 182
        zaawansowane.Caption = "Poka|fffd| opcje zaawansowane (WYMAGANE HAS|fffd|O)"
    End If
End Sub

Private Sub UserForm_Activate()
    help1a.Visible = False
    help2a.Visible = False
    help3a.Visible = False
    odblokuj_bg.Value = False
    zaawansowane.Value = False
    importy.Height = 182
End Sub

Attribute VB_Name = "kryteria"
Attribute VB_Base = "0{B080E54B-D152-4570-84DF-69D50D974D0D}{848F5317-3708-4D42-B37A-A07899136978}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ok_Click()
    If kat1.Enabled Then
        Sheets("dane").Cells(16, 3) = kat1.Value
        Odblokuj "Kategoria 1"
        If Len(kat1.Value) <= 30 Then
            Sheets("Kategoria 1").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 1").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 1"
    End If
    If kat2.Enabled Then
        Sheets("dane").Cells(16, 4) = kat2.Value
        Odblokuj "Kategoria 2"
        If Len(kat2.Value) <= 30 Then
            Sheets("Kategoria 2").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 2").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 2"
    End If
    If kat3.Enabled Then
        Sheets("dane").Cells(16, 5) = kat3.Value
        Odblokuj "Kategoria 3"
        If Len(kat3.Value) <= 30 Then
            Sheets("Kategoria 3").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 3").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 3"
    End If
    If kat4.Enabled Then
        Sheets("dane").Cells(16, 6) = kat4.Value
        Odblokuj "Kategoria 4"
        If Len(kat4.Value) <= 30 Then
            Sheets("Kategoria 4").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 4").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 4"
    End If
    If kat5.Enabled Then
        Sheets("dane").Cells(16, 7) = kat5.Value
        Odblokuj "Kategoria 5"
        If Len(kat5.Value) <= 30 Then
            Sheets("Kategoria 5").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 5").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 5"
    End If
    If kat6.Enabled Then
        Sheets("dane").Cells(16, 8) = kat6.Value
        Odblokuj "Kategoria 6"
        If Len(kat6.Value) <= 30 Then
            Sheets("Kategoria 6").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 6").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 6"
    End If
    If kat7.Enabled Then
        Sheets("dane").Cells(16, 9) = kat7.Value
        Odblokuj "Kategoria 7"
        If Len(kat7.Value) <= 30 Then
            Sheets("Kategoria 7").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 7").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 7"
    End If
    If kat8.Enabled Then
        Sheets("dane").Cells(16, 10) = kat8.Value
        Odblokuj "Kategoria 8"
        If Len(kat8.Value) <= 30 Then
            Sheets("Kategoria 8").Rows(4).RowHeight = 18
        Else
            Sheets("Kategoria 8").Rows(4).RowHeight = 30.75
        End If
        Blokuj "Kategoria 8"
    End If
    kryteria.Hide
End Sub

Private Sub UserForm_Activate()
    If Sheets("Kategoria 1").Visible Then kat1.Enabled = True Else kat1.Enabled = False
    If Sheets("Kategoria 2").Visible Then kat2.Enabled = True Else kat2.Enabled = False
    If Sheets("Kategoria 3").Visible Then kat3.Enabled = True Else kat3.Enabled = False
    If Sheets("Kategoria 4").Visible Then kat4.Enabled = True Else kat4.Enabled = False
    If Sheets("Kategoria 5").Visible Then kat5.Enabled = True Else kat5.Enabled = False
    If Sheets("Kategoria 6").Visible Then kat6.Enabled = True Else kat6.Enabled = False
    If Sheets("Kategoria 7").Visible Then kat7.Enabled = True Else kat7.Enabled = False
    If Sheets("Kategoria 8").Visible Then kat8.Enabled = True Else kat8.Enabled = False
    
    kat1.Value = Sheets("dane").Cells(16, 3)
    kat2.Value = Sheets("dane").Cells(16, 4)
    kat3.Value = Sheets("dane").Cells(16, 5)
    kat4.Value = Sheets("dane").Cells(16, 6)
    kat5.Value = Sheets("dane").Cells(16, 7)
    kat6.Value = Sheets("dane").Cells(16, 8)
    kat7.Value = Sheets("dane").Cells(16, 9)
    kat8.Value = Sheets("dane").Cells(16, 10)
End Sub
Attribute VB_Name = "tytulowe"
Attribute VB_Base = "0{3BC12894-8DAC-4EC5-89E7-4CDC35F41541}{ABA19BE0-A261-4A2D-9CEA-BE4384849E8C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub UserForm_Activate()
    nazwa.Value = Sheets("dane").Range("C4")
    adres.Value = Sheets("dane").Range("C5")
    kod.Value = Sheets("dane").Range("D5")
    mdata.Value = Sheets("dane").Range("C6")
    dane_agenta.Value = Sheets("dane").Range("C7")
    numer.Value = Sheets("dane").Range("C8")
    kryt1.Value = Sheets("dane").Range("C10")
    kryt2.Value = Sheets("dane").Range("C11")
    If Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = False Then malzonek.Value = True Else malzonek.Value = False
    If Sheets("dane").Range("typ") = 1 Then
        numer_l.Enabled = True
        numer.Enabled = True
        kryt1_l.Enabled = True
        kryt1.Enabled = True
        kryt2_l.Enabled = True
        kryt2.Enabled = True
        malzonek.Enabled = True
    Else
        numer_l.Enabled = False
        numer.Enabled = False
        kryt1_l.Enabled = False
        kryt1.Enabled = False
        kryt2_l.Enabled = False
        kryt2.Enabled = False
        malzonek.Enabled = False
    End If
End Sub

Private Sub zapisz_Click()
    Odblokuj "Strona Tytu|fffd|owa"
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Top = Sheets("Strona Tytu|fffd|owa").Range("L37").Top
'    If Len(nazwa.Value) >= 50 Then
'        Sheets("Strona Tytu|fffd|owa").Rows(38).Hidden = False
'    Else
'        Sheets("Strona Tytu|fffd|owa").Rows(38).Hidden = True
'    End If
    If kryt1.Value <> "" Then
        Sheets("Strona Tytu|fffd|owa").Rows(54).Hidden = False
        Sheets("Strona Tytu|fffd|owa").Rows(62).Hidden = True
        If Len(kryt1.Value) > 90 Then
            Sheets("Strona Tytu|fffd|owa").Rows(54).RowHeight = 27
        Else
            Sheets("Strona Tytu|fffd|owa").Rows(54).RowHeight = 13.5
        End If
    Else
        Sheets("Strona Tytu|fffd|owa").Rows(62).Hidden = False
        Sheets("Strona Tytu|fffd|owa").Rows(54).Hidden = True
    End If
    If kryt2.Value <> "" Then
        Sheets("Strona Tytu|fffd|owa").Rows(55).Hidden = False
        If Len(kryt2.Value) > 90 Then
            Sheets("Strona Tytu|fffd|owa").Rows(55).RowHeight = 27
        Else
            Sheets("Strona Tytu|fffd|owa").Rows(55).RowHeight = 13.5
        End If
    Else
        Sheets("Strona Tytu|fffd|owa").Rows(55).Hidden = True
    End If
    If malzonek.Value = True Then Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = False Else _
                Sheets("Strona Tytu|fffd|owa").Rows(56).Hidden = True
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").ScaleHeight 0.5, msoTrue
    Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Top = _
        Sheets("Strona Tytu|fffd|owa").Range("L66").Top - Sheets("Strona Tytu|fffd|owa").Shapes("odpowiedzialny").Height
    Sheets("dane").Range("C4") = nazwa.Value
    Sheets("dane").Range("C5") = adres.Value
    Sheets("dane").Range("D5") = kod.Value
    Sheets("dane").Range("C6") = mdata.Value
    Sheets("dane").Range("C7") = dane_agenta.Value
    Sheets("dane").Range("C8") = numer.Value
    Sheets("dane").Range("C10") = kryt1.Value
    Sheets("dane").Range("C11") = kryt2.Value
    Blokuj "Strona Tytu|fffd|owa"
    tytulowe.Hide
End Sub



INQUEST-PP=macro
