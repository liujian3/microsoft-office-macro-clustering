Attribute VB_Name = "Module1"
Option Explicit
Public prirarr(21, 6) ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public UverArr(2, 2, 2) '|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public SelArr(65536) ' |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public ProgMode As Boolean '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Public Undomode As Boolean '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|

Public Sub keyzone_add(KeyValue As Integer) ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim i, startrow, endrow, countcol, l
startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value
countcol = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h5").value

For i = startrow To endrow
If Range(Cells(i, 7), Cells(i, 7)).value >= KeyValue Then
Range(Cells(i, 1), Cells(i, 1)).value = 0
Range(Cells(i, 3), Cells(i, 3)).value = 1
Range(Cells(i, 1), Cells(i, countcol)).Interior.ColorIndex = xlNone
Else
Range(Cells(i, 3), Cells(i, 3)).value = 0
End If
Next i
Call RefreshData
End Sub






Public Sub RefreshData() ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| P2-C
Dim startrow, endrow
startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value
Dim sumall, i, l, oldaddress, sumvib, sumkey, lastkey, lastkey1
l = 0
   rows(startrow & ":" & endrow).Sort Key1:=Range("B" & startrow), Order1:=xlDescending, Key2:=Range( _
        "E" & startrow), Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase _
        :=False, Orientation:=xlTopToBottom

'oldaddress = Selection.Address
 'On Error Resume Next
'lastkey = startrow
'For i = startrow To endrow

'sumall = sumall + Range(Cells(i, 7), Cells(i, 7)).value
'If Range(Cells(i, 1), Cells(i, 1)).value = 1 Then
'sumvib = sumvib + Range(Cells(i, 7), Cells(i, 7)).value
'Else

'lastkey = i
'End If

    
    
    
  'If Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
'sumkey = sumkey + Range(Cells(i, 7), Cells(i, 7)).value
'lastkey = i
'End If

'Next i

    'Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D3").value = sumall
    'Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D14").value = sumkey
   ' Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h4").value = lastkey + 1
  '  Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value = CInt(endrow)
 '   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value = CInt(startrow)
    
    
'    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
'    Range(oldaddress).Select


'Dim startrow, endrow
'startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
'endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value
'Dim sumall, i, oldaddress, sumvib, sumkey, lastkey

  ' rows(startrow & ":" & endrow).Sort Key1:=Range("B" & startrow), Order1:=xlDescending, Key2:=Range( _
   '     "B" & startrow), Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase _
    '    :=False, Orientation:=xlTopToBottom

oldaddress = Selection.Address
 On Error Resume Next
lastkey = startrow
For i = startrow To endrow

sumall = sumall + Range(Cells(i, 7), Cells(i, 7)).value
'If Range(Cells(i, 1), Cells(i, 1)).value = 1 Then
'sumvib = sumvib + Range(Cells(i, 7), Cells(i, 7)).value
'End If
'Next i


If Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
sumkey = sumkey + Range(Cells(i, 7), Cells(i, 7)).value
End If
'lastkey = i
'Next i


 If Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
'sumkey = sumkey + Range(Cells(i, 7), Cells(i, 7)).value
lastkey = i
End If


If Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
'sumkey = sumkey + Range(Cells(i, 7), Cells(i, 7)).value
l = l + 1
End If

Next i



    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D3").value = sumall
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D14").value = sumkey
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h4").value = lastkey + l
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value = CInt(endrow)
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value = CInt(startrow)
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D15").value = l
   ' Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D15").value = (lastkey + l) - CInt(startrow)
   ' Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("a2").value = l
    If CInt(endrow) > CInt(startrow) Then
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D4").value = (CInt(endrow) - CInt(startrow)) + 1
    End If
    
    Range(oldaddress).Select
'If Err <> 0 Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd|2-|fffd|" & vbCrLf & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.xls" & vbCrLf & Err.Description
 

'MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| P2-C "

End Sub


Public Sub fselarr(fromrow, torow) '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Dim i, sumall
'|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd|
SelArr(0) = fromrow
SelArr(1) = torow

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i = fromrow To torow
If Range(Cells(i, 1), Cells(i, 1)).value = 1 Then
SelArr(i) = True
Else
SelArr(i) = False
End If
Next i









End Sub
Public Sub rndaddsellarr(countadd As Integer)
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim i, rndrownum, rndval
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If IsEmpty(SelArr(0)) Then MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| need call fselarr "
 For i = 1 To countadd
tryenother:
rndval = Round(Rnd * (SelArr(1) - SelArr(0)), 0)
rndrownum = SelArr(0) + rndval
If Not SelArr(rndrownum) Then
  SelArr(rndrownum) = True
Else
GoTo tryenother
End If
Next i

End Sub
Public Sub SetVibByArr(countcol)
Dim i
For i = SelArr(0) To SelArr(1)
If SelArr(i) Then
    Range(Cells(i, 1), Cells(i, countcol)).Select
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    Range(Cells(i, 1), Cells(i, 1)).value = 1
    End With
Else
    Range(Cells(i, 1), Cells(i, countcol)).Interior.ColorIndex = xlNone
End If

Next i
End Sub
Public Sub fa()

Dim i, j, tmpval
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i = 10 To 29
For j = 0 To 6
   tmpval = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, j + 2).value
    prirarr(i - 10, j) = tmpval
    Next j
'Debug.Print prirarr(i - 10, 0) & vbTab & prirarr(i - 10, 1) & vbTab & prirarr(i - 10, 2) & vbTab & prirarr(i - 10, 3) & vbTab & prirarr(i - 10, 4) & vbTab & prirarr(i - 10, 5) & vbTab & prirarr(i - 10, 6)
Next i

'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i = 10 To 36

UverArr(Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 14).value - 1, Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 15).value - 1, Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 16).value - 1) = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Cells(i, 17).value
Next i
'Debug.Print
End Sub

Public Function IndexInFa(ByPercentvalue)
Dim i
ByPercentvalue = CCur(Fmt(ByPercentvalue))
IndexInFa = Null
For i = 0 To 19
If prirarr(i, 0) = ByPercentvalue Then
IndexInFa = i
Exit Function
End If
Next i
End Function
Public Function Fmt(value) As Double   '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
Fmt = CDbl(Replace(value, ".", ","))
End Function
Public Sub spdown()
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim pval, index, prirlevel
If IsEmpty(prirarr(0, 0)) Then
Call fa
End If
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("d10").Select
 pval = ActiveCell.value
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If IsNull(IndexInFa(pval)) Then
ActiveCell.value = 0.95
End If
index = IndexInFa(pval)
If index < 19 And index >= 0 Then
ActiveCell.value = prirarr(index + 1, 0)
Call setPrirKoef
End If
End Sub
Public Sub spup()
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Dim pval, index, prirlevel
If IsEmpty(prirarr(0, 0)) Then
Call fa
End If
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("d10").Select
 pval = ActiveCell.value
'|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
If IsNull(IndexInFa(pval)) Then
ActiveCell.value = 0.95
End If
index = IndexInFa(pval)
If index <= 19 And index > 0 Then
ActiveCell.value = prirarr(index - 1, 0)
Call setPrirKoef
End If
End Sub

Public Sub setPrirKoef() '|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|
On Error Resume Next
 Dim pval, index, prirlevel, prirvalue, i
 
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("d10").Select
 pval = ActiveCell.value
 index = IndexInFa(pval)
     Range("d11").Select
 prirlevel = ActiveCell.value
      Range("d12").Select
If prirlevel <= 5 And prirlevel >= 0 Then

For i = 1 To prirlevel + 1
prirvalue = prirvalue + prirarr(index, i)
Next i
Range("d12").value = prirvalue
'ActiveCell.Value = prirvalue

Else
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 5 |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Application.Undo
End If
End Sub


Attribute VB_Name = "calc"
Attribute VB_Base = "0{D63F1721-1ED2-4407-B6F6-818BF49D6D10}{3D9ACA37-273D-4FFF-85BD-5195469209FE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()

End Sub

Private Sub Label1_Click()

End Sub
Attribute VB_Name = "keyzone"
Attribute VB_Base = "0{094362BC-8D3B-419A-B856-9FB8383DAC7D}{BC492D6B-3F7F-4D11-8E8A-FA7B63A73043}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
If Me.Key_Val < 1 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
'Call keyzone_add(Module1.Fmt(Me.Key_Val))
Dim i, startrow, endrow, countcol
startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value
countcol = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h5").value

For i = startrow To endrow
If Range(Cells(i, 7), Cells(i, 7)).value >= Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D13").value Then
Range(Cells(i, 1), Cells(i, 1)).value = 0
Range(Cells(i, 3), Cells(i, 3)).value = 1
Range(Cells(i, 1), Cells(i, countcol)).Interior.ColorIndex = xlNone
Else
Range(Cells(i, 3), Cells(i, 3)).value = 0
End If
Next i
Call RefreshData

For i = startrow To endrow
If Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").rows(i).Select
sumall = sumall + ActiveCell.value
   Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D15").value = sumall
End If
Next i

Me.Hide
ProgMode = False
Exit Sub
err1:
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| " & vbCrLf & Err.Description

End Sub

Private Sub Key_Val_Change()

End Sub

Private Sub Label2_Click()

End Sub

Private Sub Label3_Click()

End Sub

Private Sub UserForm_Activate()
ProgMode = True
Me.Key_Val = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("d13").value
End Sub

Private Sub UserForm_Deactivate()
ProgMode = False
End Sub

Attribute VB_Name = "r_select"
Attribute VB_Base = "0{AE0D5D32-9023-4B35-91F7-3EC5DB604498}{B9E36BD4-622F-431D-8A7D-8E8E6593F8D4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit

Private Sub CommandButton1_Click()

Dim startrow As Integer
 Dim endrow As Integer
 Dim countcol As Integer
 On Error Resume Next
 
 startrow = Me.startrow
 'InputBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ")
 If Err.Number <> 0 Then
 MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
 Exit Sub
 End If

 endrow = Me.endrow
' InputBox ("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ")
 If Err.Number <> 0 Or endrow <= startrow Then
 MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
 Exit Sub
 End If


 countcol = Me.countcol
 'InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| ", , 1)
 If Err.Number <> 0 Or countcol < 1 Then
 MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1 "
 Exit Sub
 End If
 
 Dim countv As Integer
Dim countrows, rndrownum, i, rownum
countrows = endrow - startrow

 countv = Me.countv
 'InputBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| ", , 25)
 If Err.Number <> 0 Or countcol < 1 Then
 MsgBox "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 1 "
 Exit Sub
 End If



If countv >= countrows Then
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If

If Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("d14").value >= (Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("d3").value * 0.75) Then

MsgBox "C|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 75% |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|."
Exit Sub
End If


On Error GoTo 0


 Dim rows(30000) As Boolean
 
 For i = 1 To countv
tryenother:
rndrownum = startrow + Round(Rnd * countrows, 0)
If Not rows(rndrownum) Then
  rows(rndrownum) = True
Else
GoTo tryenother
End If
Next i
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|
 
 For i = startrow To endrow
    Range(Cells(i, 1), Cells(i, countcol)).Select
    If ActiveCell.value = 1 Then
    If MsgBox("  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & vbCrLf & "  |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|. " & vbCrLf & vbCrLf & vbCrLf & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|?", 4) = 7 Then Exit Sub
    GoTo gclear
    End If
Next i
gclear:
 '|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i = startrow To endrow
    Range(Cells(i, 1), Cells(i, countcol)).Select
    Selection.Interior.ColorIndex = xlNone
    Range(Cells(i, 1), Cells(i, 1)).Select
    ActiveCell.value = 0
Next i
 
 
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
For i = startrow To endrow

If rows(i) Then
    Range(Cells(i, 1), Cells(i, countcol)).Select
    With Selection.Interior
        .ColorIndex = 15
        .Pattern = xlSolid
    Range(Cells(i, 1), Cells(i, 1)).Select
    ActiveCell.value = 1
    End With
End If

Next i





Range(Cells(startrow, 1), Cells(endrow, countcol)).Select
Call bordersel
Me.Hide
ProgMode = False
End Sub






Private Sub countv_Enter()
Me.info.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd||fffd|' |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
End Sub

Private Sub countv_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.info.Caption = ""
End Sub


Private Sub Label5_Click()

End Sub

Private Sub startrow_Enter()
Me.info.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
End Sub

Private Sub startrow_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.info.Caption = ""
End Sub
Private Sub endrow_Enter()
Me.info.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| "
End Sub

Private Sub endrow_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.info.Caption = ""
End Sub

Private Sub UserForm_Activate()
ProgMode = True
End Sub

Private Sub UserForm_Deactivate()
ProgMode = False
End Sub

Private Sub UserForm_Initialize()
'me.endrow.text = selection.
Dim s, sr, er, oldaddress
'Call find_selrange
    
    'Worksheets("Sheet1").Activate
   ' ActiveCell.CurrentRegion.Select
'MsgBox ActiveCell.CurrentRegion.rows.Count
 Me.startrow = 10
 Me.endrow = ActiveCell.CurrentRegion.rows.Count

sr = 10

For s = 10 To 32000
Range(Cells(s, 2), Cells(s, 2)).Select
If ActiveCell.value = 1 Then sr = s + 1
If IsEmpty(ActiveCell.value) Then
er = s - 1
GoTo exfnder
End If
Next s

exfnder:
oldaddress = Selection.Address

Me.startrow = sr
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("h6").Select
Me.endrow = CInt(ActiveCell.value)

If Me.endrow <= Me.startrow Then Me.endrow = 25
Me.countcol = ActiveCell.CurrentRegion.Columns.Count
If Me.countcol < 9 Then Me.countcol = 9



    Range("D17").Select
    Me.countv = ActiveCell.value



Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
Range(oldaddress).Select


'Me.countv = Round((Me.endrow - Me.startrow) / 4, 0)
End Sub
Sub find_selrange()
Dim s, sr, er
sr = 10

For s = 10 To 32000
Range(Cells(2, sr), Cells(2, sr)).Select
If ActiveCell.value = 1 Then sr = s + 1
If ActiveCell.value <> 1 And ActiveCell.value <> 0 Then
er = s - 1
Exit Sub
End If
Next s


End Sub





Sub bordersel()
    
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .Weight = xlMedium
        .ColorIndex = xlAutomatic
    End With
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
End Sub

Attribute VB_Name = "sel_data_range"
Attribute VB_Base = "0{C69EE8F3-7863-4C1D-A632-C3AD32C503BF}{6D5F124E-C0F6-4A12-8949-E10B36A582EC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Dim sumall As Currency, i As Integer, oldaddress, sumvib As Currency, sumkey As Currency, lastkey As Integer




   rows(Me.startrow & ":" & Me.endrow).Select
    Selection.Sort Key1:=Range("B" & Me.startrow), Order1:=xlDescending, Key2:=Range( _
        "G" & Me.startrow), Order2:=xlDescending, Header:=xlGuess, OrderCustom:=1, MatchCase _
        :=False, Orientation:=xlTopToBottom
        
        sel_data_range.Hide

oldaddress = Selection.Address
 On Error Resume Next
lastkey = Me.startrow
For i = Me.startrow To Me.endrow
Range(Cells(i, 7), Cells(i, 7)).Select
sumall = sumall + ActiveCell.value
If ActiveCell.EntireRow.Cells(1, 1).value = 1 Then
sumvib = sumvib + ActiveCell.value
Else

Range(Cells(i, 2), Cells(i, 2)).Select
If ActiveCell.value = 1 Then
Range(Cells(i, 7), Cells(i, 7)).Select
sumkey = sumkey + ActiveCell.value
lastkey = i
End If
End If
Next i

    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range("D3").Select
    ActiveCell.value = sumall
    Range("D14").Select
    ActiveCell.value = sumkey
     Range("h4").Select
    ActiveCell.value = lastkey + 1
     Range("h6").Select
    ActiveCell.value = CInt(Me.endrow)
     Range("h3").Select
    ActiveCell.value = CInt(Me.startrow)
    Range("D4").Select
    ActiveCell.value = CInt(Me.endrow) - CInt(Me.startrow)
    
    Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Range(oldaddress).Select
'If Err <> 0 Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|.xls"


MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|, |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "


ProgMode = False
Call RefreshData
End Sub


Private Sub endrow_Enter()
Me.info_text.Caption = " |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|  |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd||fffd|' |fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd|" & CInt(Me.endrow) + 1

End Sub

Private Sub endrow_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.info_text.Caption = ""
End Sub

Private Sub startrow_Enter()
Me.info_text.Caption = "|fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| < 10. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "
End Sub

Private Sub startrow_Exit(ByVal Cancel As MSForms.ReturnBoolean)
Me.info_text.Caption = ""
End Sub

Private Sub UserForm_Activate()
ProgMode = True
Dim s, sr, er


For s = 10 To 32000
Range(Cells(s, 7), Cells(s, 7)).Select

If IsEmpty(ActiveCell.value) Then
er = s - 1
GoTo exfnder
End If

If Not IsNumeric(ActiveCell.value) Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & s & " |fffd| |fffd||fffd||fffd||fffd| '|fffd||fffd||fffd||fffd||fffd|' |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| - |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| "

Exit Sub

End If
ActiveCell.value = CCur(Module1.Fmt(ActiveCell.value))
ActiveCell.NumberFormat = "#,##0.00"

Next s

exfnder:
Me.startrow = 10
Me.endrow = er
If CInt(Me.endrow) < CInt(Me.startrow) Then
Me.endrow = Me.startrow
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|."
End If

End Sub









Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub SpinButton1_SpinDown()
Call spdown
End Sub


Private Sub SpinButton1_SpinUp()
Call spup
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
'If ProgMode Or Undomode Then Exit Sub
'If Target.Address <> "$D$11" Then Exit Sub
'If IsEmpty(prirarr(0, 0)) Then Call fa
'Call setPrirKoef
'Undomode = False
ProgMode = True

'Application.Undo


'Undomode = False
'If MsgBox("|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|. |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbOKCancel) = vbOK Then calc.Show

End Sub


Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton5, 52, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton2, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton3, 5, 3, MSForms, CommandButton"
Attribute VB_Control = "CommandButton4, 6, 4, MSForms, CommandButton"
Private Sub CommandButton1_Click()
keyzone.Show
End Sub

Private Sub CommandButton2_Click()
sel_data_range.Show
End Sub

Private Sub CommandButton3_Click()


Dim i, startrow, endrow, countcol
startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value
countcol = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h5").value

For i = startrow To endrow
If Range(Cells(i, 7), Cells(i, 7)).value >= Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("D13").value Then
Range(Cells(i, 1), Cells(i, 1)).value = 0
Range(Cells(i, 3), Cells(i, 3)).value = 1
Range(Cells(i, 1), Cells(i, countcol)).Interior.ColorIndex = xlNone
Else
Range(Cells(i, 3), Cells(i, 3)).value = 0
End If
Next i

If Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("d4").value <= 6 Then

For i = startrow To endrow
Range(Cells(i, 1), Cells(i, 1)).value = 1
Range(Cells(i, 1), Cells(i, countcol)).Interior.ColorIndex = xlNone

Next i
Exit Sub
Else

Call RefreshData



r_select.Show
End If

End Sub

Private Sub CommandButton4_Click()
Dim startrow As Integer, endrow As Integer
ProgMode = True

startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value

If startrow < 10 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| > 10  "
Exit Sub
End If
    
If MsgBox("|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & startrow & " |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| " & endrow, vbOKCancel) = 1 Then
rows(startrow & ":" & endrow).Delete Shift:=xlUp
End If
ProgMode = False

End Sub

Private Sub CommandButton5_Click()
Dim i, n, startrow, endrow, countcol
startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value

n = 10
For i = startrow To endrow
If Range(Cells(i, 1), Cells(i, 1)).value = 1 Or Range(Cells(i, 2), Cells(i, 2)).value = 1 Then
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").rows(i).Copy
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").rows(n).Select
    Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Paste
    n = n + 1
End If
Next i

End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 5, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()
Dim startrow As Integer, endrow As Integer
ProgMode = True

startrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h3").value
endrow = Sheets("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Range("h6").value

If startrow < 10 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| > 10  "
Exit Sub
End If
    

rows(startrow & ":" & endrow).Delete Shift:=xlUp

ProgMode = False
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
