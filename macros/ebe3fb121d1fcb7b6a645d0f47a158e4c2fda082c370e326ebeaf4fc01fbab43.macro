Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'|fffd|Z|fffd||fffd||fffd||312|l|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd|
Private Sub WorkSheet_Change(ByVal Target As Range)
    
    Call ThisWorkbook.Open_Change(Target, "")
    
    If Target Is Nothing = False Then
        Call ThisWorkbook.ChkSheet2Value(Target)
    Else
       Target.Interior.colorIndex = 2
    End If
End Sub


Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'|fffd|Z|fffd||fffd||fffd||312|l|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd|
Public Sub WorkSheet_Change(ByVal Target As Range)
    'Dim taraget_cells(16) As String
    Dim taraget_cells(36)   As String
    Dim count As Integer
    
    'Sheet1
    
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    'taraget_cells(0) = "$E$57"
    'taraget_cells(1) = "$E$59"
    'taraget_cells(2) = "$E$61"
    'taraget_cells(3) = "$E$63"
    'taraget_cells(4) = "$E$65"
    'taraget_cells(5) = "$E$67"
    'taraget_cells(6) = "$E$69"
    'taraget_cells(7) = "$E$71"
    'taraget_cells(8) = "$E$73"
    'taraget_cells(9) = "$E$75"
    'taraget_cells(10) = "$E$77"
    'taraget_cells(11) = "$E$79"
    'taraget_cells(12) = "$E$81"
    'taraget_cells(13) = "$E$83"
    'taraget_cells(14) = "$E$85"
    'taraget_cells(15) = "$E$87"
    
    ' |fffd|e|fffd||fffd||fffd||688||292|u|fffd||fffd||fffd|i|fffd|[
    taraget_cells(0) = "$E$31"      ' NYK VESSEL CODE
    taraget_cells(1) = "$E$33"      ' PRESTO Vessel Code
    taraget_cells(2) = "$E$35"      ' Vessel Name
    taraget_cells(3) = "$E$37"      ' IMO No.
    taraget_cells(4) = "$E$39"      ' Team Code
    taraget_cells(5) = "$E$41"      ' Vesssel Type
    taraget_cells(6) = "$E$43"      ' VSL Owned / Chartered
    taraget_cells(7) = "$E$45"      ' Management Scheme
    taraget_cells(8) = "$E$47"      ' Crew member
    taraget_cells(9) = "$E$49"      ' Class
    taraget_cells(10) = "$E$51"     ' Flag
    taraget_cells(11) = "$E$53"     ' Port Registered
    taraget_cells(12) = "$E$55"     ' Call Sign
    taraget_cells(13) = "$E$57"     ' Net Tonnage(NRT)
    taraget_cells(14) = "$E$59"     ' GRT(International)
    taraget_cells(15) = "$E$61"     ' D/W(Summer)
    taraget_cells(16) = "$E$63"     ' Operating Period(Start)
    taraget_cells(17) = "$E$65"     ' Operating Period(End)
    taraget_cells(18) = "$E$67"     ' Ship Management Company
    taraget_cells(19) = "$E$69"     ' Real Owner
    taraget_cells(20) = "$E$71"     ' Real Owner-more
    taraget_cells(21) = "$E$73"     ' Owner Registered(English)
    taraget_cells(22) = "$E$75"     ' Operating Company
    taraget_cells(23) = "$E$77"     ' Chaterpart Owner
    taraget_cells(24) = "$E$79"     ' Chaterpart Owner--more
    taraget_cells(25) = "$E$81"     ' Charter
    taraget_cells(26) = "$E$83"     ' Broker
    taraget_cells(27) = "$E$85"     ' Broker-more
    taraget_cells(28) = "$E$87"     ' Counterpart for NAV9000 Audit
    taraget_cells(29) = "$E$89"     ' Vessel Tel No
    taraget_cells(30) = "$E$91"     ' Vessel E-mail Address
    taraget_cells(31) = "$E$93"     ' INMARSAT-C
    taraget_cells(32) = "$E$96"     ' Chartering Type
    taraget_cells(33) = "$E$101"    ' Build Place
    taraget_cells(34) = "$E$103"    ' ShipNet Vessel Type
    taraget_cells(35) = "$E$107"    ' E-MAIL ADDRESS
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
    Dim sheet1_object As Worksheet
    Dim sheet2_object As Worksheet
    Dim value1 As String
    Dim value2 As String
    
    ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
    Dim value3 As String                    ' Vessel Type|fffd||64fe|
    Dim sheetVslType_object As Worksheet    ' Vessel Type|fffd|V|fffd|[|fffd|g
    Dim vsl_type_row As Integer             ' |fffd|I|fffd||fffd||fffd|s
    Dim vsl_type As String                  ' |fffd||656a|(B:|fffd|o|fffd||fffd||fffd|G|fffd|l|fffd|AA:|fffd||fffd||fffd||fffd||fffd||511|D|fffd|AC:|fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D|fffd|AO:|fffd||fffd||fffd||311||fffd|)
    ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||fffd| |fffd|||fffd||
    
    Dim values1() As String

    On Error GoTo Err_Sheet1Change
    
    Set sheet1_object = Worksheets("Input sheet1 (for Applicant)")
    Set sheet2_object = Worksheets("Input sheet2 (for Applicant)")
   
    ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
    Set sheetVslType_object = Worksheets("1_Vessel Type")
    ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||fffd| |fffd|||fffd||
    
    '|fffd||fffd||28c||152||fffd|
    Application.ScreenUpdating = False
    
    ' 20180416 |fffd|X|fffd|V |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
    'Vesel Typr / Chartering type / Management Scheme
    'If Target.Address = "$E$43" Or Target.Address = "$E$45" _
        Or Target.Address = "$E$43:$G$43" Or Target.Address = "$E$45:$H$45" Then
    If Target.Address = "$E$41" Or Target.Address = "$E$43" Or Target.Address = "$E$45" _
        Or Target.Address = "$E$41:$G$41" Or Target.Address = "$E$43:$G$43" Or Target.Address = "$E$45:$H$45" Then
    ' 20180416 |fffd|X|fffd|V |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||fffd| |fffd|||fffd||
        
        '|fffd||fffd||282||30d|X|fffd|V|fffd||fffd||fffd||fffd||fffd||202||fffd|
         Application.ScreenUpdating = False
   
        ' |fffd||fffd|U|fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        sheet1_object.Unprotect
        sheet2_object.Unprotect
       
        '|fffd||fffd||282||312|l|fffd||251|S|fffd|p|fffd||303|R|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||90bd||fffd||7c1|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|O|fffd||fffd||fffd||fffd||fffd|l|fffd||fffd||fffd||64fe||fffd||fffd||fffd||fffd|
        value1 = sheet1_object.Range("$E$43").value         ' VSL Owned / Chartered
        value2 = sheet1_object.Range("$E$45").value         ' Management Scheme
        
        ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
        value3 = sheet1_object.Range("$E$41").value         ' Vessel Type
        
        ' Vessel Type|fffd||fffd||fffd||fffd|[B:|fffd|o|fffd||fffd||fffd|G|fffd|l][A:|fffd||fffd||fffd||fffd||fffd||511|D][C:|fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D(|fffd||fffd|q)][O:|fffd||fffd||fffd||311||fffd|]|fffd||24b||656a||fffd||fffd||fffd||fffd|
        If value3 <> "" Then
            vsl_type_row = sheetVslType_object.Range("$C$2:$C$42").Find(value3).Row
            If IsNumeric(vsl_type_row) Then
                vsl_type = sheetVslType_object.Range("$E$" & vsl_type_row).value
            End If
        End If
        ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||fffd| |fffd|||fffd||
                
        If value1 <> "" Then
            values1 = Split(value1, " ")
            If UBound(values1) = 1 Then
                value1 = values1(1)
            Else
                value1 = values1(1) & " " & values1(2)
            End If
        End If
        
        
        ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
        For count = 0 To UBound(taraget_cells) - 1
            sheet1_object.Range(taraget_cells(count)).Interior.colorIndex = 2
        Next
        
        '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|Xstart
        'Sheet2|fffd||314|w|fffd|i|fffd||fffd|
        Call UnLockedCells_ChangeColor_all(2)
      
      
        'VLS Owned/Chartered|fffd||fffd|C/S|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Feeder VSL|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd|A
        'Management Scheme|fffd||24e||fffd||fffd||fffd||fffd|I|fffd||fffd|Non Owned/Chartered|fffd||fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|v|fffd||fffd||fffd|O|fffd||fffd||fffd||fffd|
        '|fffd||fffd||fffd||4c1|FC/S|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Feeder VSL|fffd||30e||fffd||fffd||341|ANon Owned/Chartered|fffd||20a|O|fffd||311|I|fffd||fffd||fffd||fffd||fffd||142||fffd||fffd||202||fffd|
        
        If value1 = "C/S" Or value1 = "Feeder VSL" Then
            Application.EnableEvents = False
            Range(taraget_cells(7)).value = "Non Owned/Chartered"
            value2 = "Non Owned/Chartered"
            'Sheet1|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
            Call Sheet1_ManagementSchemeItem5_ChangeColor(vsl_type, sheet1_object, taraget_cells)
            'Sheet2|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
            Call UnLockedCells_ChangeColor_all(15)
           
            Application.EnableEvents = True
        End If
  
  
        '|fffd|O|fffd||fffd||fffd|[|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||fffd||fffd||30f|C|fffd||fffd|
        
        ' Management Scheme|fffd||312|l|fffd||fffd||fffd|w|fffd||80b3||fffd||a0bd||fffd||a347|
        If value2 <> "" Then
        
            ' Management Scheme|fffd||312|l|fffd||fffd||fffd|u3:Chartered Vessel (under 1 year)|fffd|v|fffd||30f||a347|
            If value2 = "Chartered Vessel (under 1 year)" Then
                'Sheet1|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                Call Sheet1_ManagementSchemeItem3_ChangeColor(vsl_type, sheet1_object, taraget_cells)
                'Sheet2|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                    '|fffd|D|fffd||d0aa||fffd||fffd||fffd||fffd||fffd||511|D|fffd||30f||a347|
                    If vsl_type = "A" Then
                        Call UnLockedCells_ChangeColor_ForPCC(15)
                    '|fffd|D|fffd||d0aa||fffd||fffd||fffd||fffd||fffd||511|D|fffd||20a|O|fffd||30f||a347|
                    Else
                        Call UnLockedCells_ChangeColor(15)
                    End If
            
            ' Management Scheme|fffd||312|l|fffd||fffd||fffd|u5:Non Owned/Chartered|fffd|v|fffd||30f||a347|
            ElseIf value2 = "Non Owned/Chartered" Then
                'Sheet1|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                Call Sheet1_ManagementSchemeItem5_ChangeColor(vsl_type, sheet1_object, taraget_cells)
                'Sheet2|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                Call UnLockedCells_ChangeColor_all(15)
            
            ' Management Scheme|fffd||312|l|fffd||fffd||fffd|u1:owned vessel(Other Company Management)|fffd|v|fffd|A|fffd|u2:Chartered Vessel (1 year or over)|fffd|v|fffd|A|fffd|u4:Joint Ownership|fffd|v|fffd||30f||a347|
            Else
                'Sheet1|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                Call Sheet1_ManagementSchemeItem124_ChangeColor(vsl_type, sheet1_object)
                'Sheet2|fffd||314|w|fffd|i|fffd||fffd||752||fffd|
                Call Sheet2_ManagementSchemeItem124_ChangeColor(vsl_type, sheet2_object)
    
            End If
            
        End If
        
        '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|Xend
        
        
        ' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||141|||fffd||
        
        
        ' 20180416 |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd|@|fffd|||fffd|| |fffd||209||fffd||fffd||303||fffd||fffd|W|fffd|b|fffd|N|fffd||fffd||fffd|T|fffd|u|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd| |fffd|||fffd||
'        '"8.C/S" |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"9.Feeder VSL"
'        If value1 = "C/S" Or value1 = "Feeder VSL" Or value2 = "Chartered Vessel (under 1 year)" Then
'            '|fffd|O|fffd||fffd||fffd|[|fffd|A|fffd|E|fffd|g
'            For count = 0 To UBound(taraget_cells) - 1
'               sheet1_object.Range(taraget_cells(count)).Interior.colorIndex = 15
'            Next
'            'Sheet2|fffd||314|w|fffd|i|fffd||fffd||fffd|O|fffd||fffd||fffd|[|fffd|A|fffd|E|fffd|g
'            Call UnLockedCells_ChangeColor(15)
'        Else
'            For count = 0 To UBound(taraget_cells) - 1
'                sheet1_object.Range(taraget_cells(count)).Interior.colorIndex = 2
'            Next
'            'Sheet2|fffd||314|w|fffd|i|fffd||fffd|
'            Call UnLockedCells_ChangeColor(2)
'        End If
        ' 20180416 |fffd|R|fffd||fffd||fffd||fffd||fffd|g|fffd|A|fffd|E|fffd|g|fffd|@|fffd|||fffd|| |fffd||209||fffd||fffd||303||fffd||fffd|W|fffd|b|fffd|N|fffd||fffd||fffd|T|fffd|u|fffd||fffd||fffd|W|fffd||fffd||fffd|[|fffd||fffd||fffd||fffd| |fffd|||fffd||
        
        ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
        sheet1_object.Protect ' UserInterfaceOnly:=True
        sheet2_object.Protect ' UserInterfaceOnly:=True
              
        '|fffd||fffd||282||30d|X|fffd|V|fffd||fffd||fffd||fffd||fffd||fffd|
        Application.ScreenUpdating = True


    End If

    
    'sheet2|fffd||312|l|fffd|`|fffd|F|fffd|b|fffd|N
    Call ChkSheet1Value(Target)
    
    
    '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True
    
    Exit Sub
    
Err_Sheet1Change:
   '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
   sheet1_object.Unprotect
   sheet2_object.Unprotect
   '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = True
   
   MsgBox "error method: " & "WorkSheet_Change()--Sheet1" & vbCrLf & _
            "error number: " & Err.Number & vbCrLf & _
                "erorr description: " & Err.Description, vbExclamation

End Sub

' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd|||fffd||
' Management Scheme|fffd||312|l|fffd||fffd||fffd|u3:Chartered Vessel (under 1 year)|fffd|v|fffd||30f||a347||fffd||fffd|sheet1|fffd||314|w|fffd|i|fffd||752||fffd|
Private Sub Sheet1_ManagementSchemeItem3_ChangeColor(ByVal value As String, _
                        ByVal sheet_object As Worksheet, _
                        ByRef taraget_cells() As String)

    Dim colorIdx(36)        As Integer  ' |fffd|w|fffd|i|fffd|F|fffd||752||fffd||3d0||fffd|
    Dim count               As Integer  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
 
    ' |fffd||fffd||fffd||fffd|
    colorIdx(0) = 2                     ' NYK VESSEL CODE
    colorIdx(2) = 2                     ' Vessel Name
    colorIdx(3) = 2                     ' IMO No.
    colorIdx(4) = 2                     ' Team Code
    colorIdx(5) = 2                     ' Vesssel Type
    colorIdx(6) = 2                     ' VSL Owned / Chartered
    colorIdx(7) = 2                     ' Management Scheme
    colorIdx(8) = 2                     ' Crew member
    colorIdx(9) = 2                     ' Class
    colorIdx(10) = 2                    ' Flag
    colorIdx(11) = 2                    ' Port Registered
    colorIdx(12) = 2                    ' Call Sign
    colorIdx(13) = 2                    ' Net Tonnage(NRT)
    colorIdx(14) = 2                    ' GRT(International)
    colorIdx(15) = 2                    ' D/W(Summer)
    colorIdx(16) = 15                   ' Operating Period(Start)
    colorIdx(17) = 15                   ' Operating Period(End)
    colorIdx(18) = 15                   ' Ship Management Company
    colorIdx(19) = 15                   ' Real Owner
    colorIdx(20) = 15                   ' Real Owner-more
    colorIdx(21) = 15                   ' Owner Registered(English)
    colorIdx(22) = 15                   ' Operating Company
    colorIdx(23) = 15                   ' Chaterpart Owner
    colorIdx(24) = 15                   ' Chaterpart Owner--more
    colorIdx(25) = 15                   ' Charter
    colorIdx(26) = 15                   ' Broker
    colorIdx(27) = 15                   ' Broker-more
    colorIdx(28) = 15                   ' Counterpart for NAV9000 Audit
    colorIdx(29) = 15                   ' Vessel Tel No
    colorIdx(30) = 15                   ' Vessel E-mail Address
    colorIdx(31) = 15                   ' INMARSAT-C
    colorIdx(35) = 2                    ' E-MAIL ADDRESS
    
    Select Case value
        Case "B"            ' |fffd|o|fffd||fffd||fffd|G|fffd|l
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 2            ' Build Place
            colorIdx(34) = 2            ' ShipNet Vessel Type
        Case "A"            ' |fffd||fffd||fffd||fffd||fffd||511|D
            colorIdx(1) = 2             ' PRESTO Vessel Code
            colorIdx(32) = 2            ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
   
        Case "C"            ' |fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D(|fffd||fffd|q)
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
       
        Case Else           ' |fffd||fffd||fffd||311||fffd|
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
        
    End Select

    For count = 0 To UBound(taraget_cells) - 1
        sheet_object.Range(taraget_cells(count)).Interior.colorIndex = colorIdx(count)
    Next

End Sub

' 201911 |fffd||1c9||fffd||fffd|@start
' Management Scheme|fffd||312|l|fffd||fffd||fffd|u5:Non Owned/Chartered|fffd|v|fffd||30f||a347||fffd||fffd|sheet1|fffd||314|w|fffd|i|fffd||752||fffd|
Private Sub Sheet1_ManagementSchemeItem5_ChangeColor(ByVal value As String, _
                        ByVal sheet_object As Worksheet, _
                        ByRef taraget_cells() As String)

    Dim colorIdx(36)        As Integer  ' |fffd|w|fffd|i|fffd|F|fffd||752||fffd||3d0||fffd|
    Dim count               As Integer  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
 
    ' |fffd||fffd||fffd||fffd|
    colorIdx(0) = 2                     ' NYK VESSEL CODE
    colorIdx(2) = 2                     ' Vessel Name
    colorIdx(3) = 2                     ' IMO No.
    colorIdx(4) = 2                     ' Team Code
    colorIdx(5) = 2                     ' Vesssel Type
    colorIdx(6) = 2                     ' VSL Owned / Chartered
    colorIdx(7) = 2                     ' Management Scheme
    colorIdx(8) = 2                     ' Crew member
    colorIdx(9) = 2                     ' Class
    colorIdx(10) = 2                    ' Flag
    colorIdx(11) = 2                    ' Port Registered
    colorIdx(12) = 2                    ' Call Sign
    colorIdx(13) = 15                    ' Net Tonnage(NRT)
    colorIdx(14) = 2                    ' GRT(International)
    colorIdx(15) = 2                    ' D/W(Summer)
    colorIdx(16) = 15                   ' Operating Period(Start)
    colorIdx(17) = 15                   ' Operating Period(End)
    colorIdx(18) = 15                   ' Ship Management Company
    colorIdx(19) = 15                   ' Real Owner
    colorIdx(20) = 15                   ' Real Owner-more
    colorIdx(21) = 15                   ' Owner Registered(English)
    colorIdx(22) = 15                   ' Operating Company
    colorIdx(23) = 15                   ' Chaterpart Owner
    colorIdx(24) = 15                   ' Chaterpart Owner--more
    colorIdx(25) = 15                   ' Charter
    colorIdx(26) = 15                   ' Broker
    colorIdx(27) = 15                   ' Broker-more
    colorIdx(28) = 15                   ' Counterpart for NAV9000 Audit
    colorIdx(29) = 15                   ' Vessel Tel No
    colorIdx(30) = 15                   ' Vessel E-mail Address
    colorIdx(31) = 15                   ' INMARSAT-C
    colorIdx(35) = 2                    ' E-MAIL ADDRESS
    
    Select Case value
        Case "B"            ' |fffd|o|fffd||fffd||fffd|G|fffd|l
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 2            ' Build Place
            colorIdx(34) = 2            ' ShipNet Vessel Type
        Case "A"            ' |fffd||fffd||fffd||fffd||fffd||511|D
            colorIdx(1) = 2             ' PRESTO Vessel Code
            colorIdx(32) = 2            ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
   
        Case "C"            ' |fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D(|fffd||fffd|q)
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
       
        Case Else           ' |fffd||fffd||fffd||311||fffd|
            colorIdx(1) = 15            ' PRESTO Vessel Code
            colorIdx(32) = 15           ' Chartering Type
            colorIdx(33) = 15           ' Build Place
            colorIdx(34) = 15           ' ShipNet Vessel Type
        
    End Select

    For count = 0 To UBound(taraget_cells) - 1
        sheet_object.Range(taraget_cells(count)).Interior.colorIndex = colorIdx(count)
    Next

End Sub   '201911 |fffd||1c9||fffd||fffd|@end

' Management Scheme|fffd||312|l|fffd||fffd||fffd|u1:owned vessel(Other Company Management)|fffd|v|fffd|A|fffd|u2:Chartered Vessel(1 year or over)|fffd|v|fffd|A|fffd|u4:Joint Ownership|fffd|v|fffd||30f||a347||fffd||fffd|sheet2|fffd||314|w|fffd|i|fffd||752||fffd|
Private Sub Sheet1_ManagementSchemeItem124_ChangeColor(ByVal value As String, _
                        ByVal sheet_object As Worksheet)

    Dim colorIdx(4)         As Integer  ' |fffd|w|fffd|i|fffd|F|fffd||752||fffd||3d0||fffd|
    Dim count               As Integer  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    Dim taraget_cells(4)    As String

    taraget_cells(0) = "$E$33"          ' PRESTO Vessel Code
    taraget_cells(1) = "$E$96"          ' Chartering Type
    taraget_cells(2) = "$E$101"         ' Build Place
    taraget_cells(3) = "$E$103"         ' ShipNet Vessel Type

    
    Select Case value
        Case "B"            ' |fffd|o|fffd||fffd||fffd|G|fffd|l
            colorIdx(0) = 15        ' PRESTO Vessel Code
            colorIdx(1) = 15        ' Chartering Type
            colorIdx(2) = 2         ' Build Place
            colorIdx(3) = 2         ' ShipNet Vessel Type
        
        Case "A"            ' |fffd||fffd||fffd||fffd||fffd||511|D
            colorIdx(0) = 2         ' PRESTO Vessel Code
            colorIdx(1) = 2         ' Chartering Type
            colorIdx(2) = 15        ' Build Place
            colorIdx(3) = 15        ' ShipNet Vessel Type
            
        Case "C"            ' |fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D(|fffd||fffd|q)
            colorIdx(0) = 15        ' PRESTO Vessel Code
            colorIdx(1) = 15        ' Chartering Type
            colorIdx(2) = 15        ' Build Place
            colorIdx(3) = 15        ' ShipNet Vessel Type
            
        Case Else           ' |fffd||fffd||fffd||311||fffd|
            colorIdx(0) = 15        ' PRESTO Vessel Code
            colorIdx(1) = 15        ' Chartering Type
            colorIdx(2) = 15        ' Build Place
            colorIdx(3) = 15        ' ShipNet Vessel Type
    End Select
    
    For count = 0 To UBound(taraget_cells) - 1
        sheet_object.Range(taraget_cells(count)).Interior.colorIndex = colorIdx(count)
    Next

End Sub

' Management Scheme|fffd||312|l|fffd||fffd||fffd|u1:owned vessel(Other Company Management)|fffd|v|fffd|A|fffd|u2:Chartered Vessel (1 year or over)|fffd|v|fffd|A|fffd|u4:Joint Ownership|fffd|v|fffd||30f||a347||fffd||fffd|sheet2|fffd||314|w|fffd|i|fffd||752||fffd|
'|fffd|D|fffd||fffd|(value)|fffd||242||fffd||fffd||fffd||115||fffd||fffd||82dc2||fffd|
Private Sub Sheet2_ManagementSchemeItem124_ChangeColor(ByVal value As String, _
                        ByVal sheet_object As Worksheet)
    
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Modify Start
    Dim colorIdx(36)        As Integer  ' |fffd|w|fffd|i|fffd|F|fffd||752||fffd||3d0||fffd|
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Modify End
    Dim count               As Integer  ' |fffd|J|fffd|E|fffd||fffd||fffd|^|fffd|[
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Modify Start
    Dim taraget_cells(36)   As String
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Modify End

    taraget_cells(0) = "$E$87"          ' RT total
    taraget_cells(1) = "$E$94"          ' Total Loadable
    taraget_cells(2) = "$E$97"          ' Hold Capacity
    taraget_cells(3) = "$E$99"          ' Tank Capacity
    taraget_cells(4) = "$E$101"         ' Bale Capacity
    taraget_cells(5) = "$E$124"         ' Bow to Bridge front
    taraget_cells(6) = "$E$126"         ' Bow to Side port
    taraget_cells(7) = "$E$128"         ' Bow to Stern port(s)
    taraget_cells(8) = "$E$130"         ' Keel To of mast (Normal)
    taraget_cells(9) = "$E$132"         ' Keel To of mast (Folded All)
    taraget_cells(10) = "$E$134"        ' Stern Car Ladder Deck
    taraget_cells(11) = "$E$136"        ' Stern Car Ladder Breadth
    taraget_cells(12) = "$E$138"        ' Stern Car Ladder Length
    taraget_cells(13) = "$E$140"        ' Stern Car Ladder Load
    taraget_cells(14) = "$E$142"        ' Midship Car Ladder Right Deck
    taraget_cells(15) = "$E$144"        ' Midship Car Ladder Right Breadth
    taraget_cells(16) = "$E$146"        ' Midship Car Ladder Right Length
    taraget_cells(17) = "$E$148"        ' Midship Car Ladder Right Load
    taraget_cells(18) = "$E$150"        ' Midship Car Ladder Left Deck
    taraget_cells(19) = "$E$152"        ' Midship Car Ladder Left Breadth
    taraget_cells(20) = "$E$154"        ' Midship Car Ladder Left Length
    taraget_cells(21) = "$E$156"        ' Midship Car Ladder Left Load
    taraget_cells(22) = "$E$247"        ' Mobile Phone
    taraget_cells(23) = "$E$253"        ' Company
    taraget_cells(24) = "$E$256"        ' Company
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
    taraget_cells(25) = "$E$103"        'Grain Capacity
    '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
    '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
    taraget_cells(26) = "$E$14"
    taraget_cells(27) = "$E$16"
    taraget_cells(28) = "$E$18"
    taraget_cells(29) = "$E$25"
    taraget_cells(30) = "$E$70"
    taraget_cells(31) = "$E$110"
    taraget_cells(32) = "$E$168"       ' NRT
    taraget_cells(33) = "$E$170"      ' Panama Tonnage(Gross)
    taraget_cells(34) = "$E$176"       ' Suezu Tonnage(Net)
    taraget_cells(35) = "$E$192"       ' Built(yyyy/mm/dd)
    '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
    
    
    Select Case value
        Case "ALL_CLEAR"    ' |fffd||fffd||fffd||fffd||fffd||fffd||fffd|i|fffd||fffd||fffd|j
            colorIdx(0) = 2         ' RT total
            colorIdx(1) = 2         ' Total Loadable
            colorIdx(2) = 2         ' Hold Capacity
            colorIdx(3) = 2         ' Tank Capacity
            colorIdx(4) = 2         ' Bale Capacity
            colorIdx(5) = 2         ' Bow to Bridge front
            colorIdx(6) = 2         ' Bow to Side port
            colorIdx(7) = 2         ' Bow to Stern port(s)
            colorIdx(8) = 2         ' Keel To of mast (Normal)
            colorIdx(9) = 2         ' Keel To of mast (Folded All)
            colorIdx(10) = 2        ' Stern Car Ladder Deck
            colorIdx(11) = 2        ' Stern Car Ladder Breadth
            colorIdx(12) = 2        ' Stern Car Ladder Length
            colorIdx(13) = 2        ' Stern Car Ladder Load
            colorIdx(14) = 2        ' Midship Car Ladder Right Deck
            colorIdx(15) = 2        ' Midship Car Ladder Right Breadth
            colorIdx(16) = 2        ' Midship Car Ladder Right Length
            colorIdx(17) = 2        ' Midship Car Ladder Right Load
            colorIdx(18) = 2        ' Midship Car Ladder Left Deck
            colorIdx(19) = 2        ' Midship Car Ladder Left Breadth
            colorIdx(20) = 2        ' Midship Car Ladder Left Length
            colorIdx(21) = 2        ' Midship Car Ladder Left Load
            colorIdx(22) = 2        ' Mobile Phone
            colorIdx(23) = 2        ' Company
            colorIdx(24) = 2        ' Company
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(25) = 2        'Grain Capacity
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(26) = 2
            colorIdx(27) = 2
            colorIdx(28) = 15
            colorIdx(29) = 2
            colorIdx(30) = 2
            colorIdx(31) = 2
            colorIdx(32) = 2      ' NRT
            colorIdx(33) = 2      ' Panama Tonnage(Gross)
            colorIdx(34) = 2      ' Suezu Tonnage(Net)
            colorIdx(35) = 2      ' Built(yyyy/mm/dd)
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
        Case "B"            ' |fffd|o|fffd||fffd||fffd|G|fffd|l
            colorIdx(0) = 15        ' RT total
            colorIdx(1) = 15        ' Total Loadable
            colorIdx(2) = 2         ' Hold Capacity
            colorIdx(3) = 2         ' Tank Capacity
            colorIdx(4) = 2         ' Bale Capacity
            colorIdx(5) = 15        ' Bow to Bridge front
            colorIdx(6) = 15        ' Bow to Side port
            colorIdx(7) = 15        ' Bow to Stern port(s)
            colorIdx(8) = 15        ' Keel To of mast (Normal)
            colorIdx(9) = 15        ' Keel To of mast (Folded All)
            colorIdx(10) = 15       ' Stern Car Ladder Deck
            colorIdx(11) = 15       ' Stern Car Ladder Breadth
            colorIdx(12) = 15       ' Stern Car Ladder Length
            colorIdx(13) = 15       ' Stern Car Ladder Load
            colorIdx(14) = 15       ' Midship Car Ladder Right Deck
            colorIdx(15) = 15       ' Midship Car Ladder Right Breadth
            colorIdx(16) = 15       ' Midship Car Ladder Right Length
            colorIdx(17) = 15       ' Midship Car Ladder Right Load
            colorIdx(18) = 15       ' Midship Car Ladder Left Deck
            colorIdx(19) = 15       ' Midship Car Ladder Left Breadth
            colorIdx(20) = 15       ' Midship Car Ladder Left Length
            colorIdx(21) = 15       ' Midship Car Ladder Left Load
            colorIdx(22) = 15       ' Mobile Phone
            colorIdx(23) = 15       ' Company
            colorIdx(24) = 15       ' Company
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(25) = 2        'Grain Capacity
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(26) = 2
            colorIdx(27) = 2
            colorIdx(28) = 15
            colorIdx(29) = 2
            colorIdx(30) = 2
            colorIdx(31) = 2
            colorIdx(32) = 2      ' NRT
            colorIdx(33) = 2      ' Panama Tonnage(Gross)
            colorIdx(34) = 2      ' Suezu Tonnage(Net)
            colorIdx(35) = 2      ' Built(yyyy/mm/dd)
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
        
        Case "A"            ' |fffd||fffd||fffd||fffd||fffd||511|D
            colorIdx(0) = 2         ' RT total
            colorIdx(1) = 15        ' Total Loadable
            colorIdx(2) = 15        ' Hold Capacity
            colorIdx(3) = 15        ' Tank Capacity
            colorIdx(4) = 15        ' Bale Capacity
            colorIdx(5) = 2         ' Bow to Bridge front
            colorIdx(6) = 2         ' Bow to Side port
            colorIdx(7) = 2         ' Bow to Stern port(s)
            colorIdx(8) = 2         ' Keel To of mast (Normal)
            colorIdx(9) = 2         ' Keel To of mast (Folded All)
            colorIdx(10) = 2        ' Stern Car Ladder Deck
            colorIdx(11) = 2        ' Stern Car Ladder Breadth
            colorIdx(12) = 2        ' Stern Car Ladder Length
            colorIdx(13) = 2        ' Stern Car Ladder Load
            colorIdx(14) = 2        ' Midship Car Ladder Right Deck
            colorIdx(15) = 2        ' Midship Car Ladder Right Breadth
            colorIdx(16) = 2        ' Midship Car Ladder Right Length
            colorIdx(17) = 2        ' Midship Car Ladder Right Load
            colorIdx(18) = 2        ' Midship Car Ladder Left Deck
            colorIdx(19) = 2        ' Midship Car Ladder Left Breadth
            colorIdx(20) = 2        ' Midship Car Ladder Left Length
            colorIdx(21) = 2        ' Midship Car Ladder Left Load
            colorIdx(22) = 2        ' Mobile Phone
            colorIdx(23) = 2        ' Company
            colorIdx(24) = 2        ' Company
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(25) = 15        'Grain Capacity
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
           '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(26) = 2
            colorIdx(27) = 2
            colorIdx(28) = 15
            colorIdx(29) = 2
            colorIdx(30) = 2
            colorIdx(31) = 2
            colorIdx(32) = 2      ' NRT
            colorIdx(33) = 2      ' Panama Tonnage(Gross)
            colorIdx(34) = 2      ' Suezu Tonnage(Net)
            colorIdx(35) = 2      ' Built(yyyy/mm/dd)
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            
        Case "C"            ' |fffd|R|fffd||fffd||fffd|e|fffd|i|fffd|D(|fffd||fffd|q)
            colorIdx(0) = 15        ' RT total
            colorIdx(1) = 2         ' Total Loadable
            colorIdx(2) = 15        ' Hold Capacity
            colorIdx(3) = 15        ' Tank Capacity
            colorIdx(4) = 15        ' Bale Capacity
            colorIdx(5) = 15        ' Bow to Bridge front
            colorIdx(6) = 15        ' Bow to Side port
            colorIdx(7) = 15        ' Bow to Stern port(s)
            colorIdx(8) = 15        ' Keel To of mast (Normal)
            colorIdx(9) = 15        ' Keel To of mast (Folded All)
            colorIdx(10) = 15       ' Stern Car Ladder Deck
            colorIdx(11) = 15       ' Stern Car Ladder Breadth
            colorIdx(12) = 15       ' Stern Car Ladder Length
            colorIdx(13) = 15       ' Stern Car Ladder Load
            colorIdx(14) = 15       ' Midship Car Ladder Right Deck
            colorIdx(15) = 15       ' Midship Car Ladder Right Breadth
            colorIdx(16) = 15       ' Midship Car Ladder Right Length
            colorIdx(17) = 15       ' Midship Car Ladder Right Load
            colorIdx(18) = 15       ' Midship Car Ladder Left Deck
            colorIdx(19) = 15       ' Midship Car Ladder Left Breadth
            colorIdx(20) = 15       ' Midship Car Ladder Left Length
            colorIdx(21) = 15       ' Midship Car Ladder Left Load
            colorIdx(22) = 15       ' Mobile Phone
            colorIdx(23) = 15       ' Company
            colorIdx(24) = 15       ' Company
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(25) = 15        'Grain Capacity
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(26) = 2
            colorIdx(27) = 2
            colorIdx(28) = 15
            colorIdx(29) = 2
            colorIdx(30) = 2
            colorIdx(31) = 2
            colorIdx(32) = 2      ' NRT
            colorIdx(33) = 2      ' Panama Tonnage(Gross)
            colorIdx(34) = 2      ' Suezu Tonnage(Net)
            colorIdx(35) = 2      ' Built(yyyy/mm/dd)
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            
        Case Else           ' |fffd||fffd||fffd||311||fffd|
            colorIdx(0) = 15        ' RT total
            colorIdx(1) = 15        ' Total Loadable
            colorIdx(2) = 15        ' Hold Capacity
            colorIdx(3) = 15        ' Tank Capacity
            colorIdx(4) = 15        ' Bale Capacity
            colorIdx(5) = 15        ' Bow to Bridge front
            colorIdx(6) = 15        ' Bow to Side port
            colorIdx(7) = 15        ' Bow to Stern port(s)
            colorIdx(8) = 15        ' Keel To of mast (Normal)
            colorIdx(9) = 15        ' Keel To of mast (Folded All)
            colorIdx(10) = 15       ' Stern Car Ladder Deck
            colorIdx(11) = 15       ' Stern Car Ladder Breadth
            colorIdx(12) = 15       ' Stern Car Ladder Length
            colorIdx(13) = 15       ' Stern Car Ladder Load
            colorIdx(14) = 15       ' Midship Car Ladder Right Deck
            colorIdx(15) = 15       ' Midship Car Ladder Right Breadth
            colorIdx(16) = 15       ' Midship Car Ladder Right Length
            colorIdx(17) = 15       ' Midship Car Ladder Right Load
            colorIdx(18) = 15       ' Midship Car Ladder Left Deck
            colorIdx(19) = 15       ' Midship Car Ladder Left Breadth
            colorIdx(20) = 15       ' Midship Car Ladder Left Length
            colorIdx(21) = 15       ' Midship Car Ladder Left Load
            colorIdx(22) = 15       ' Mobile Phone
            colorIdx(23) = 15       ' Company
            colorIdx(24) = 15       ' Company
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(25) = 15        'Grain Capacity
            '201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
            colorIdx(26) = 2
            colorIdx(27) = 2
            colorIdx(28) = 15
            colorIdx(29) = 2
            colorIdx(30) = 2
            colorIdx(31) = 2
            colorIdx(32) = 2      ' NRT
            colorIdx(33) = 2      ' Panama Tonnage(Gross)
            colorIdx(34) = 2      ' Suezu Tonnage(Net)
            colorIdx(35) = 2      ' Built(yyyy/mm/dd)
            '201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End
    End Select
    
    For count = 0 To UBound(taraget_cells) - 1
        sheet_object.Range(taraget_cells(count)).Interior.colorIndex = colorIdx(count)
    Next


End Sub
' 20180416 |fffd||1c9||fffd| |fffd|||fffd|| |fffd||fffd||fffd||fffd||fffd||702||fffd| |fffd|||fffd||

Private Sub UnLockedCells_ChangeColor(colorIndex As Integer)
    Dim Rng As Variant
    Dim Unchanged_Cells(10) As String
    Dim reverse_colorIndex As Integer
    
    Unchanged_Cells(0) = "$E$14"
    Unchanged_Cells(1) = "$E$16"
    Unchanged_Cells(2) = "$E$18"
    Unchanged_Cells(3) = "$E$25"
    Unchanged_Cells(4) = "$E$70"
    Unchanged_Cells(5) = "$E$110"
    
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    'Unchanged_Cells(6) = "$E$133"
    'Unchanged_Cells(7) = "$E$135"
    'Unchanged_Cells(8) = "$E$141"
    'Unchanged_Cells(9) = "$E$157"
    Unchanged_Cells(6) = "$E$168"       ' NRT
    Unchanged_Cells(7) = "$E$170"       ' Panama Tonnage(Gross)
    Unchanged_Cells(8) = "$E$176"       ' Suezu Tonnage(Net)
    Unchanged_Cells(9) = "$E$192"       ' Built(yyyy/mm/dd)
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
    If colorIndex = 15 Then
        reverse_colorIndex = 2
    ElseIf colorIndex = 2 Then
        reverse_colorIndex = 15
    End If
    

    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    'For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("E14:E498")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X Start
    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("E14:E556")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X End
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) Then
                    
                '|fffd|w|fffd||80b5||fffd||60a4||fffd||182||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'                If Rng.Interior.colorIndex = colorIndex Then Exit For
            
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
  
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    ' For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("G14:G498")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X Start
    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("G14:G556")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X End
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) Then
                '|fffd|w|fffd||80b5||fffd||60a4||fffd||182||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'                If Rng.Interior.colorIndex = colorIndex Then Exit For
                   
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
  
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    ' For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("I14:I498")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X Start
    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("I14:I556")
    '20190614 7|fffd||fffd||fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd||3cd|X End
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) Then
                '|fffd|w|fffd||80b5||fffd||60a4||fffd||182||fffd||fffd||fffd|F|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
'                If Rng.Interior.colorIndex = colorIndex Then Exit For
                    
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
    
End Sub

'201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X Start
Private Sub UnLockedCells_ChangeColor_ForPCC(colorIndex As Integer)
    Dim Rng As Variant
    Dim Unchanged_Cells(27) As String
    Dim reverse_colorIndex As Integer
    
    Unchanged_Cells(0) = "$E$14"        ' IMO No.
    Unchanged_Cells(1) = "$E$16"        ' Vessel Name
    Unchanged_Cells(2) = "$E$18"        ' Vessel Classification (|fffd||fffd||243|O|fffd||fffd||fffd|[|fffd||752||fffd|)
    Unchanged_Cells(3) = "$E$25"        ' Class
    Unchanged_Cells(4) = "$E$70"        ' Length of All(LOA)
    Unchanged_Cells(5) = "$E$110"       ' Draft(Summer)
    Unchanged_Cells(6) = "$E$168"       ' NRT
    Unchanged_Cells(7) = "$E$170"       ' Panama Tonnage(Gross)
    Unchanged_Cells(8) = "$E$176"       ' Suezu Tonnage(Net)
    Unchanged_Cells(9) = "$E$192"       ' Built(yyyy/mm/dd)
    'Dimensions/PCC
    Unchanged_Cells(10) = "$E$124"
    Unchanged_Cells(11) = "$E$126"
    Unchanged_Cells(12) = "$E$128"
    Unchanged_Cells(13) = "$E$130"
    Unchanged_Cells(14) = "$E$132"
    Unchanged_Cells(15) = "$E$134"
    Unchanged_Cells(16) = "$E$136"
    Unchanged_Cells(17) = "$E$138"
    Unchanged_Cells(18) = "$E$140"
    Unchanged_Cells(19) = "$E$142"
    Unchanged_Cells(20) = "$E$144"
    Unchanged_Cells(21) = "$E$146"
    Unchanged_Cells(22) = "$E$148"
    Unchanged_Cells(23) = "$E$150"
    Unchanged_Cells(24) = "$E$152"
    Unchanged_Cells(25) = "$E$154"
    Unchanged_Cells(26) = "$E$156"
    
    If colorIndex = 15 Then
        reverse_colorIndex = 2
    ElseIf colorIndex = 2 Then
        reverse_colorIndex = 15
    End If

    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("E14:E556")

        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) And Rng.Address <> Unchanged_Cells(10) And Rng.Address <> Unchanged_Cells(11) _
                            And Rng.Address <> Unchanged_Cells(12) And Rng.Address <> Unchanged_Cells(13) And Rng.Address <> Unchanged_Cells(14) _
                                And Rng.Address <> Unchanged_Cells(15) And Rng.Address <> Unchanged_Cells(16) And Rng.Address <> Unchanged_Cells(17) _
                                    And Rng.Address <> Unchanged_Cells(18) And Rng.Address <> Unchanged_Cells(19) And Rng.Address <> Unchanged_Cells(20) _
                                        And Rng.Address <> Unchanged_Cells(21) And Rng.Address <> Unchanged_Cells(22) And Rng.Address <> Unchanged_Cells(23) _
                                            And Rng.Address <> Unchanged_Cells(24) And Rng.Address <> Unchanged_Cells(25) And Rng.Address <> Unchanged_Cells(26) Then
                
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
  
    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("G14:G556")
    
        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) And Rng.Address <> Unchanged_Cells(10) And Rng.Address <> Unchanged_Cells(11) _
                            And Rng.Address <> Unchanged_Cells(12) And Rng.Address <> Unchanged_Cells(13) And Rng.Address <> Unchanged_Cells(14) _
                                And Rng.Address <> Unchanged_Cells(15) And Rng.Address <> Unchanged_Cells(16) And Rng.Address <> Unchanged_Cells(17) _
                                    And Rng.Address <> Unchanged_Cells(18) And Rng.Address <> Unchanged_Cells(19) And Rng.Address <> Unchanged_Cells(20) _
                                        And Rng.Address <> Unchanged_Cells(21) And Rng.Address <> Unchanged_Cells(22) And Rng.Address <> Unchanged_Cells(23) _
                                            And Rng.Address <> Unchanged_Cells(24) And Rng.Address <> Unchanged_Cells(25) And Rng.Address <> Unchanged_Cells(26) Then
                   
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
  
    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("I14:I556")
    
        If Rng.Locked = False Then
            If Rng.Address <> Unchanged_Cells(0) And Rng.Address <> Unchanged_Cells(1) And Rng.Address <> Unchanged_Cells(2) _
                And Rng.Address <> Unchanged_Cells(3) And Rng.Address <> Unchanged_Cells(4) And Rng.Address <> Unchanged_Cells(5) _
                    And Rng.Address <> Unchanged_Cells(6) And Rng.Address <> Unchanged_Cells(7) And Rng.Address <> Unchanged_Cells(8) _
                        And Rng.Address <> Unchanged_Cells(9) And Rng.Address <> Unchanged_Cells(10) And Rng.Address <> Unchanged_Cells(11) _
                            And Rng.Address <> Unchanged_Cells(12) And Rng.Address <> Unchanged_Cells(13) And Rng.Address <> Unchanged_Cells(14) _
                                And Rng.Address <> Unchanged_Cells(15) And Rng.Address <> Unchanged_Cells(16) And Rng.Address <> Unchanged_Cells(17) _
                                    And Rng.Address <> Unchanged_Cells(18) And Rng.Address <> Unchanged_Cells(19) And Rng.Address <> Unchanged_Cells(20) _
                                        And Rng.Address <> Unchanged_Cells(21) And Rng.Address <> Unchanged_Cells(22) And Rng.Address <> Unchanged_Cells(23) _
                                            And Rng.Address <> Unchanged_Cells(24) And Rng.Address <> Unchanged_Cells(25) And Rng.Address <> Unchanged_Cells(26) Then
                    
                If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                    Rng.Interior.colorIndex = colorIndex
                End If
            End If
        End If
    Next Rng
End Sub
'201907 |fffd||fffd||fffd||fffd||fffd|[|fffd|X End

'Management Scheme|fffd||312|l|fffd||fffd||fffd|u5:Non Owned/Chartered|fffd|v|fffd||30f||a347||fffd||24e||fffd||fffd|s
'(VLS Owned/Chartered|fffd||fffd|C/S|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|Feeder VSL|fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||141|u5:Non Owned/Chartered|fffd|v|fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd|@start

Private Sub UnLockedCells_ChangeColor_all(colorIndex As Integer)
    Dim Rng As Variant
    Dim Unchanged_Cells(10) As String
    Dim reverse_colorIndex As Integer
    
    
    If colorIndex = 15 Then
        reverse_colorIndex = 2
    ElseIf colorIndex = 2 Then
        reverse_colorIndex = 15
    End If
    

    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("E14:E556")

        If Rng.Locked = False Then
            If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                Rng.Interior.colorIndex = colorIndex
            End If
        End If
    Next Rng
  

    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("G14:G556")

        If Rng.Locked = False Then
            If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                Rng.Interior.colorIndex = colorIndex
            End If
        End If
    Next Rng
  

    For Each Rng In Worksheets("Input sheet2 (for Applicant)").Range("I14:I556")

        If Rng.Locked = False Then
            If Rng.Interior.colorIndex = colorIndex Or Rng.Interior.colorIndex = reverse_colorIndex Then
                Rng.Interior.colorIndex = colorIndex
            End If
        End If
    Next Rng
    
End Sub
'201911 |fffd||fffd||fffd||fffd||fffd|[|fffd|X|fffd|@end

'Sheet1|fffd||30d||fffd||fffd||682||fffd||fffd||3cd|X|fffd||242||202||fffd||fffd||fffd||fffd||fffd|Sheet2|fffd||313||fffd||fffd||fffd||fffd||fffd||fffd||682||193||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
Private Sub ChkSheet1Value(ByVal Target As Range)
    Dim ar As Variant
    Dim wkStr() As String
    Dim i As Integer
    Dim sheet1_object As Worksheet
    Dim sheet2_object As Worksheet

    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    'ar = Array("Vessel Name,$E$35,$E$16,$E$35:$H$35", "IMO No.,$E$37,$E$14,$E$37:$E$37", "Class,$E$49,$E$25,$E$49:$E$49", _
                "Flag,$E$51,$E$27,$E$51:$G$51", "Port Registered,$E$53,$E$29,$E$53:$G$53", _
                        "Call Sign,$E$55,$E$35,$E$55:$E$55", "Net Tonnage,$E$89,$E$133,$E$89:$E$89")
                        
    ar = Array("Vessel Name,$E$35,$E$16,$E$35:$H$35", "IMO No.,$E$37,$E$14,$E$37:$E$37", "Class,$E$49,$E$25,$E$49:$E$49", _
                "Flag,$E$51,$E$27,$E$51:$G$51", "Port Registered,$E$53,$E$29,$E$53:$G$53", _
                        "Call Sign,$E$55,$E$35,$E$55:$E$55", "Net Tonnage (NRT),$E$57,$E$168,$E$57:$E$57")
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
    
    Set sheet1_object = Worksheets("Input sheet1 (for Applicant)")
    Set sheet2_object = Worksheets("Input sheet2 (for Applicant)")
   
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    sheet1_object.Unprotect
    sheet2_object.Unprotect
   
   
    For i = 0 To UBound(ar)
        wkStr = Split(ar(i), ",")
        If wkStr(1) = Target.Address Or wkStr(3) = Target.Address Then
            If sheet2_object.Range(wkStr(2)).value <> "" And sheet1_object.Range(wkStr(1)).value <> "" _
                And sheet2_object.Range(wkStr(2)).value <> sheet1_object.Range(wkStr(1)).value Then
                MsgBox "Following columns in Sheet 1 and Sheet 2 have different values." & vbCrLf & _
                        "(3. Vessel Name, 4.IMO No., 10.Class, 11.Flag, 12.Port Registered," & vbCrLf & _
                            "13.Call Sign, 27.Net Tonnage(NRT).)", vbOKOnly + vbCritical, "ERROR"
                sheet1_object.Range(wkStr(1)).Interior.colorIndex = 3
                sheet2_object.Range(wkStr(2)).Interior.colorIndex = 3
                Exit For
            Else
                sheet1_object.Range(wkStr(1)).Interior.colorIndex = 2
                sheet2_object.Range(wkStr(2)).Interior.colorIndex = 2
            End If
        End If
    Next
   
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    sheet1_object.Protect
    sheet2_object.Protect
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    ' |fffd||60e||fffd||8440||fffd||fffd||58e|~
    If Intersect(Target, Range("A1:I1000")) Is Nothing Then Exit Sub
 
    If Application.CutCopyMode = 2 Then
        Application.CutCopyMode = 0
        
        MsgBox "Cut operation is prohibited. Please enter.", vbOKOnly + vbCritical, "ERROR"
    End If

End Sub
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

'|fffd|Z|fffd||fffd||fffd||312|l|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||24e||fffd||fffd|s|fffd||fffd||fffd||fffd||fffd|C|fffd|x|fffd||fffd||fffd|g|fffd|v|fffd||fffd||fffd|V|fffd|[|fffd|W|fffd||fffd|
Private Sub WorkSheet_Change(ByVal Target As Range)
    
On Error GoTo Err_Sheet2Change
    Dim value1  As String
    Dim sheet2_object As Worksheet

    '|fffd||fffd||28c||152||fffd|
    Application.ScreenUpdating = False
    
    
    Call ThisWorkbook.Open_Change(Target, "")
    
    If Target Is Nothing = False Then
        Call ChkSheet2Value(Target)
    Else
       Target.Interior.colorIndex = 2
    End If
    
    ' Mobile Phone |fffd||fffd||fffd|l|fffd||20a|O|fffd||354|w|fffd|i|fffd|F|fffd||fffd||502||242||fffd||fffd||fffd|
    Set sheet2_object = Worksheets("Input sheet2 (for Applicant)")
    If Target.Address = "$E$247" Then
        value1 = sheet2_object.Range("$E$247").value
        
        If Not IsNumeric(value1) Then
            sheet2_object.Range("$E$247").Interior.colorIndex = 3
        Else
            sheet2_object.Range("$E$247").Interior.colorIndex = 2
        End If
    
    End If
    
    
    '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True
    
    Exit Sub
    
Err_Sheet2Change:
   '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = True
   
   MsgBox "error method: " & "WorkSheet_Change()--Sheet2" & vbCrLf & _
            "error number: " & Err.Number & vbCrLf & _
                "erorr description: " & Err.Description, vbExclamation


    
End Sub


'Sheet2|fffd||30d||fffd||fffd||682||fffd||fffd||3cd|X|fffd||242||202||fffd||fffd||fffd||fffd||fffd|Sheet1|fffd||313||fffd||fffd||fffd||fffd||fffd||fffd||682||193||fffd||fffd||fffd||fffd||fffd||fffd|`|fffd|F|fffd|b|fffd|N
Private Sub ChkSheet2Value(ByVal Target As Range)
    Dim ar As Variant
    Dim wkStr() As String
    Dim i As Integer
    Dim sheet1_object As Worksheet
    Dim sheet2_object As Worksheet
   
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| --
    'ar = Array("Vessel Name,$E$35,$E$16,$E$16:$I$16", "IMO No.,$E$37,$E$14,$E$14:$E$14", "Class,$E$49,$E$25,$E$25:$E$25", _
                "Flag,$E$51,$E$27,$E$27:$G$27", "Port Registered,$E$53,$E$29,$E$29:$G$29", _
                "Call Sign,$E$55,$E$35,$E$35:$E$35", "Net Tonnage,$E$89,$E$133,$E$133:$E$133")
    ar = Array("Vessel Name,$E$35,$E$16,$E$16:$I$16", "IMO No.,$E$37,$E$14,$E$14:$E$14", "Class,$E$49,$E$25,$E$25:$E$25", _
                "Flag,$E$51,$E$27,$E$27:$G$27", "Port Registered,$E$53,$E$29,$E$29:$G$29", _
                "Call Sign,$E$55,$E$35,$E$35:$E$35", "Net Tonnage (NRT),$E$57,$E$168,$E$168:$E$168")
    ' 20180416 |fffd||3cd|X -- |fffd||fffd||fffd||fffd||fffd||702||fffd| --
   
    Set sheet1_object = Worksheets("Input sheet1 (for Applicant)")
    Set sheet2_object = Worksheets("Input sheet2 (for Applicant)")
   
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    sheet1_object.Unprotect
    sheet2_object.Unprotect
   
   
    For i = 0 To UBound(ar)
        wkStr = Split(ar(i), ",")
        If wkStr(2) = Target.Address Or wkStr(3) = Target.Address Then
            If sheet1_object.Range(wkStr(1)).value <> "" And sheet2_object.Range(wkStr(2)).value <> "" _
                And sheet1_object.Range(wkStr(1)).value <> sheet2_object.Range(wkStr(2)).value Then
                    MsgBox "Following columns in Sheet 1 and Sheet 2 have different values." & vbCrLf & _
                        "(3. Vessel Name, 4.IMO No., 10.Class, 11.Flag, 12.Port Registered," & vbCrLf & _
                            "13.Call Sign, 27.Net Tonnage(NRT).)", vbOKOnly + vbCritical, "ERROR"
                sheet2_object.Range(wkStr(2)).Interior.colorIndex = 3
                sheet1_object.Range(wkStr(1)).Interior.colorIndex = 3
                Exit For
            Else
                sheet2_object.Range(wkStr(2)).Interior.colorIndex = 2
                sheet1_object.Range(wkStr(1)).Interior.colorIndex = 2
            End If
        End If
    Next
   
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    sheet1_object.Protect
    sheet2_object.Protect

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    
    ' |fffd||60e||fffd||8440||fffd||fffd||58e|~
    If Intersect(Target, Range("A1:J1000")) Is Nothing Then Exit Sub
 
    If Application.CutCopyMode = 2 Then
        Application.CutCopyMode = 0
        
        MsgBox "Cut operation is prohibited. Please enter.", vbOKOnly + vbCritical, "ERROR"
    End If

End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit


'WorkBook|fffd|I|fffd|[|fffd|v|fffd||fffd||fffd||fffd||fffd||24f||fffd||fffd||fffd|
'Sheet2|fffd||318|A|fffd||fffd||fffd||fffd||fffd||90ca||fffd|X|fffd|g|fffd||312|l|fffd||16f11|O|fffd||fffd|`|fffd||250||752||80b7||fffd||fffd|B|fffd||fffd||fffd||316||fffd||fffd|O|fffd||fffd|`|fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||243||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub Workbook_Open()

    '2018/12|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added start
    '|fffd|}|fffd|N|fffd||fffd||fffd||fffd||fffd|N|fffd||fffd||fffd||fffd||fffd||a0bd||fffd||fffd|A|fffd|u|fffd|b|fffd|N|fffd||315||6cc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|\|fffd||fffd||fffd||fffd||fffd|g|fffd|p|fffd||94|\|fffd||242||fffd||fffd||fffd|
    ThisWorkbook.Unprotect Password:="Tx8-P7"
    If ThisWorkbook.Sheets("Input sheet1 (for Applicant)").Visible <> True Then ThisWorkbook.Sheets("Input sheet1 (for Applicant)").Visible = True
    If ThisWorkbook.Sheets("Input sheet2 (for Applicant)").Visible <> True Then ThisWorkbook.Sheets("Input sheet2 (for Applicant)").Visible = True
    If ThisWorkbook.Sheets("How to for Input Sheet2").Visible <> True Then ThisWorkbook.Sheets("How to for Input Sheet2").Visible = True
    '2018/xx|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki Modified start
    '|fffd||fffd||fffd|{|fffd||fffd|\|fffd|L|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|p|fffd||fffd|\|fffd|L|fffd||255||3cd|X|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||16891|R|fffd|h|fffd|~|fffd||fffd||fffd||fffd|
    If ThisWorkbook.Sheets("Worksheet (for NYKCODE)").Visible <> True Then ThisWorkbook.Sheets("Worksheet (for NYKCODE)").Visible = True
    '2018/xx|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki Modified end
    If ThisWorkbook.Sheets("Ledger (for NYKCODE)").Visible <> True Then ThisWorkbook.Sheets("Ledger (for NYKCODE)").Visible = True
    If ThisWorkbook.Sheets("How to").Visible <> True Then ThisWorkbook.Sheets("How to").Visible = True
    If ThisWorkbook.Sheets("Notice").Visible <> False Then ThisWorkbook.Sheets("Notice").Visible = False
    ThisWorkbook.Protect Password:="Tx8-P7"
    '2018/12|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added end

    Dim case_count As Integer
    Dim sheet_name As String
    Dim sheet_name_data As String
    Dim list_data_cell As String
    Dim list_set_cell As String
    Dim counter As Integer
    Dim name_teigi As String
    Dim name_start As String
    Dim name_end As String
    Dim manu_list As Variant
    Dim i As Integer
    
    On Error GoTo Err_WorkbookOpen

    
    '|fffd||fffd||28c||152||fffd|
    Application.ScreenUpdating = False
    
    'VPMS|fffd||fffd|Manufacturer of|fffd|@Alarm Management System|fffd||303||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
    For case_count = 0 To 2
    
        sheet_name = "Input sheet2 (for Applicant)"
                
        ' |fffd||fffd|U|fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        Worksheets(sheet_name).Unprotect
        
        Select Case case_count
            Case 0
                sheet_name_data = "2_VPMS"
                list_data_cell = "b"
                list_set_cell = Worksheets(sheet_name).Range("Vdr_Manufacture_Cell").Address '"e465"
                counter = 4
                name_teigi = "VPMS_MANUFACTURER"
            Case 1
                sheet_name_data = "2_VPMS"
                list_data_cell = "i"
                list_set_cell = Worksheets(sheet_name).Range("Alarm_Manufacture_Cell").Address '"e470"
                counter = 4
                name_teigi = "ALARM_MANUFACTURER"
            Case 2
                'ME|fffd||303||fffd||fffd|X|fffd|g|fffd||30f||fffd||fffd||fffd||fffd||752||fffd|
                sheet_name_data = "2_ME Type"
                list_data_cell = "b"
                list_set_cell = Worksheets(sheet_name).Range("Licensor_Cell").Address '"e224"
                counter = 3
                name_teigi = "ME_LICENSOR"
        End Select
        
        name_start = ""
        name_end = ""


        ''VPMS|fffd||303||fffd||fffd|X|fffd|g|fffd||303|Z|fffd|b|fffd|g
        manu_list = "" '|fffd||fffd||fffd||343||fffd||fffd|X|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|

        'Manufacturer|fffd||a5d7||fffd||fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
        i = counter
        Do Until Worksheets(sheet_name_data).Range(list_data_cell & i).value = ""
            If manu_list = "" Then name_start = list_data_cell & i
            manu_list = manu_list & "," & Worksheets(sheet_name_data).Range(list_data_cell & i).value
            i = i + 1
        Loop
        
        If manu_list <> "" Then name_end = list_data_cell & i
        
        Worksheets(sheet_name_data).Names.Add Name:=name_teigi, RefersTo:=Worksheets(sheet_name_data).Range(name_start & ":" & name_end)

        '|fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd|Manufacturer|fffd||a5d7||fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
        With Worksheets(sheet_name).Range(list_set_cell).Validation
            .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
            .Add Type:=xlValidateList, Formula1:=manu_list
            .ShowError = False
        End With
        Application.EnableEvents = False '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||152|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||fffd|Change|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||101|A|fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd||fffd|l|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||302||fffd|Change|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd|}|fffd|~|fffd||fffd||fffd||fffd|B
        Worksheets(sheet_name).Range(list_set_cell).value = Worksheets(sheet_name).Range(list_set_cell).value '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||fffd||fffd||302||702||70e|c|fffd||fffd||fffd|B
        Application.EnableEvents = True 'Change|fffd|C|fffd|x|fffd||fffd||fffd|g|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||60a4||fffd||256||7c2||fffd||fffd|B
        
        Call Open_Change(Worksheets(sheet_name).Range(list_set_cell), "open") '|fffd|A|fffd||fffd||fffd||fffd||fffd||90ca||fffd|X|fffd|g|fffd||312|l|fffd||fffd||752||80b7||fffd||fffd|B


    Next
    
    '|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||152|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||243|O|fffd||fffd||fffd|[|fffd|A|fffd|E|fffd|g|fffd||fffd||fffd||93c8||fffd||fffd|
    Call Worksheets("Input sheet1 (for Applicant)").WorkSheet_Change(Worksheets("Input sheet1 (for Applicant)").Range("$E$43"))
    Call Worksheets("Input sheet1 (for Applicant)").WorkSheet_Change(Worksheets("Input sheet1 (for Applicant)").Range("$E$45"))
    
    ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    Worksheets(sheet_name).Protect
    
    '2019/1|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added start
    ThisWorkbook.Worksheets("Input sheet1 (for Applicant)").Select
    '2019/1|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added end
    
    '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
    Application.ScreenUpdating = True

   Exit Sub
   
Err_WorkbookOpen:
   '|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
    Worksheets(sheet_name).Protect
    
    
   '|fffd||fffd||28c||152||fffd||fffd||fffd||fffd|
   Application.ScreenUpdating = True
   
   MsgBox "error method: " & "Workbook_Open()" & vbCrLf & _
            "error number: " & Err.Number & vbCrLf & _
                "erorr description: " & Err.Description, vbExclamation


End Sub



'Sheet2|fffd||303|Z|fffd||fffd||fffd||312|l|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||258|A|fffd||fffd||fffd||fffd||fffd||10a||58c|W|fffd||fffd||fffd||fffd|Z|fffd||fffd||fffd||303||fffd||fffd|X|fffd|g|fffd|l|fffd||fffd||3cd|X|fffd||fffd||fffd||fffd|
'|fffd|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd|Open|fffd||30f||a347||fffd||352|l|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd||102||fffd||fffd||fffd||a347||fffd||fffd||fffd||fffd||fffd||fffd||302||141|A|fffd|l|fffd||30f||fffd||fffd||fffd||fffd||fffd||fffd||342||fffd||fffd||202||fffd|(func <> "open")
Public Sub Open_Change(ByVal Target As Range, func As String)
    Dim kubun_sub_list As String, j As Long, k As Long
    Dim vpms_cell As Integer
    Dim manufacturer_cell As Integer
    Dim licensore_cell As Integer
    Dim lisensee_cell As Integer
    Dim unit_cell As Integer
    Dim type_cell As Integer
    Dim model_list As Variant
    Dim i As Integer
    Dim list_data_sheet As String
    Dim check_cell As String
    Dim list_data_cell As String
    Dim set_cell As String
    Dim list_data As String
    Dim me_sheet As String
    Dim active_data As String
    Dim seleted_data As String
    Dim name_start As String
    Dim name_end As String
    Dim Vdr_Model_Cell As String
    Dim Alarm_Model_Cell As String 'AESTEC013
    Dim type1_Cell As String
    Dim bore_Cell As String
    Dim type2_Cell As String
    Dim type3_Cell As String
    Dim type4_Cell As String
    Dim type5_Cell As String
    Dim sheet2_object As Worksheet
    
    Set sheet2_object = Worksheets("Input sheet2 (for Applicant)")

    '2019/05|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added start
    Dim sheet1_object As Worksheet
    Set sheet1_object = Worksheets("Input sheet1 (for Applicant)")
    If Target.Row = 265 And Target.Column = 5 Then
        ActiveSheet.Unprotect
        If sheet2_object.Range("E265").value = "Diesel/Turbine" Or sheet2_object.Range("E265").value = "Turbine" Then
        sheet2_object.Range("E267").Interior.colorIndex = 15
        sheet2_object.Range("E267").value = ""
        sheet2_object.Range("E267").Locked = True
        ElseIf Range("E265").value <> "Diesel/Turbine" And Range("E265").value <> "Turbine" Then
            If sheet1_object.Range("$E$45").value = "Chartered vessel(under 1 year)" Then
                sheet2_object.Range("E267").Interior.colorIndex = 15
            ElseIf sheet1_object.Range("$E$45").value <> "Chartered vessel(under 1 year)" Then
                sheet2_object.Range("E267").Interior.colorIndex = 2
            End If
        sheet2_object.Range("E267").Locked = False
        End If
    End If
    If func = "open" Then
        sheet2_object.Activate
        ActiveSheet.Unprotect
        If sheet2_object.Range("E265").value = "Diesel/Turbine" Or sheet2_object.Range("E265").value = "Turbine" Then
        sheet2_object.Range("E267").Interior.colorIndex = 15
        sheet2_object.Range("E267").value = ""
        sheet2_object.Range("E267").Locked = True
        ElseIf Range("E265").value <> "Diesel/Turbine" And Range("E265").value <> "Turbine" Then
            If sheet1_object.Range("$E$45").value = "Chartered vessel(under 1 year)" Then
                sheet2_object.Range("E267").Interior.colorIndex = 15
            ElseIf sheet1_object.Range("$E$45").value <> "Chartered vessel(under 1 year)" Then
                sheet2_object.Range("E267").Interior.colorIndex = 2
            End If
        sheet2_object.Range("E267").Locked = False
        End If
    End If
    '2019/05|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added end
 
    licensore_cell = sheet2_object.Range("Licensor_Cell").Row  '224
    lisensee_cell = sheet2_object.Range("Licensee_Cell").Row   '226
    unit_cell = sheet2_object.Range("Unit_Cell").Row    '228
    type_cell = sheet2_object.Range("Type1_Cell").Row '230
    
    vpms_cell = sheet2_object.Range("Vdr_Manufacture_Cell").Row '465
    Vdr_Model_Cell = sheet2_object.Range("Vdr_Model_Cell").Row  '467
    
    manufacturer_cell = sheet2_object.Range("Alarm_Manufacture_Cell").Row  '470
    Alarm_Model_Cell = sheet2_object.Range("Alarm_Model_Cell").Row  '472
 
    
    
    '|fffd|Z|fffd||fffd||fffd||315||fffd||fffd||fffd||fffd|I|fffd||fffd||fffd||fffd||fffd||34f||fffd||fffd||fffd||fffd||fffd||fffd||202||fffd|
    If Target.Cells.count <> 1 Then Exit Sub
    
    'VPMS
    'Input sheet2 (for Applicant)|fffd||fffd|465|fffd|s|fffd||688||20d|~|fffd||fffd||fffd||fffd|5|fffd||fffd||682||303|Z|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||302||74e||fffd||fffd|s
    If Target.Row = vpms_cell And Target.Column = 5 Then
        model_list = "" '|fffd||fffd||fffd||343||fffd||fffd|X|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        name_start = ""
        name_end = ""
       
            
        ' |fffd||fffd|U|fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Unprotect
        
        If Target.value <> "" Then
        
          '|fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd|Manufacturer|fffd||251||389||fffd||fffd||fffd||fffd||fffd|Model|fffd||308||a5d7||fffd||fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
          i = 4
          Do Until Worksheets("2_VPMS").Range("e" & i).value = ""
              If Worksheets("2_VPMS").Range("e" & i).value = Target.value Then
                  If model_list = "" Then name_start = "f" & i
                  model_list = model_list & "," & Worksheets("2_VPMS").Range("f" & i).value
              Else
                  If model_list <> "" Then
                      name_end = "f" & i - 1
                      Exit Do
                  End If
              End If
              i = i + 1
          Loop
          
          If name_end = "" Then name_end = "f" & i - 1
          
          
          '|fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd|Model|fffd||a5d7||fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
          If model_list <> "" Then
              Worksheets("2_VPMS").Names.Add Name:="VPMS_Model", RefersTo:=Worksheets("2_VPMS").Range(name_start & ":" & name_end)
              With Target.Offset(2, 0).Validation
                  .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
                  .Add Type:=xlValidateList, Formula1:=model_list
                  .ShowError = False
              End With
    
          End If
          
          'Open|fffd||fffd||fffd||343|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||302||702||715|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
          If func <> "open" Then Target.Offset(2, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
            
            Call Worksheet_OnChange(Target)
        Else
            With Target.Offset(2, 0).Validation
              .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
            End With
            Target.Offset(2, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
        End If
    End If
    
    'Manufacturer of|fffd|@Alarm Management System
    'Input sheet2 (for Applicant)|fffd||fffd|470|fffd|s|fffd||688||20d|~|fffd||fffd||fffd||fffd|5|fffd||fffd||682||303|Z|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||302||74e||fffd||fffd|s
    If Target.Row = manufacturer_cell And Target.Column = 5 Then
        model_list = "" '|fffd||fffd||fffd||343||fffd||fffd|X|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
        name_start = ""
        name_end = ""
        
        ' |fffd||fffd|U|fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Unprotect


        If Target.value <> "" Then
        
            '|fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd|Manufacturer|fffd||251||389||fffd||fffd||fffd||fffd||fffd|Model|fffd||308||a5d7||fffd||fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
            j = 4
            Do Until Worksheets("2_VPMS").Range("l" & j).value = ""
                If Worksheets("2_VPMS").Range("l" & j).value = Target.value Then
                    If model_list = "" Then name_start = "m" & j
                    model_list = model_list & "," & Worksheets("2_VPMS").Range("m" & j).value
                Else
                    If model_list <> "" Then
                        name_end = "m" & j - 1
                        Exit Do
                    End If
                End If
                j = j + 1
            Loop
            
            If name_end = "" Then name_end = "m" & j - 1
                    
            '|fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd|Model|fffd||a5d7||fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
            If model_list <> "" Then
                Worksheets("2_VPMS").Names.Add Name:="Alarm_Model", RefersTo:=Worksheets("2_VPMS").Range(name_start & ":" & name_end)
                With Target.Offset(2, 0).Validation
                    .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
                    .Add Type:=xlValidateList, Formula1:=model_list
                    .ShowError = False
                End With
            End If
            
            'Open|fffd||fffd||fffd||343|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||302||702||715|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            If func <> "open" Then Target.Offset(2, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
            
            Call Worksheet_OnChange(Target)
        Else
            With Target.Offset(2, 0).Validation
                .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
            End With

            Target.Offset(2, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
        End If
    End If
    
    'ME Type
    'Input sheet2 (for Applicant)|fffd||fffd|Licensor|fffd||20d|~|fffd||fffd||fffd||fffd|5|fffd||fffd||682||303|Z|fffd||fffd||fffd||313||fffd||fffd|e|fffd||fffd||fffd||3cd|X|fffd||fffd||fffd||a0bd||fffd||a347||fffd||302||74e||fffd||fffd|s
    If Target.Row = licensore_cell And Target.Column = 5 Then
        ' |fffd||fffd|U|fffd|A|fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||fffd||fffd||fffd||fffd|
        ActiveSheet.Unprotect
        
        
        list_data_sheet = "2_ME Type"
        For k = 0 To 7
         
            model_list = "" '|fffd||fffd||fffd||343||fffd||fffd|X|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            name_start = ""
            name_end = ""
     
            
            Select Case k
                Case 0
                    check_cell = "e"
                    list_data_cell = "f"
                    set_cell = "2"
                Case 1
                    check_cell = "i"
                    list_data_cell = "j"
                    set_cell = "4"
                Case 2
                    check_cell = "m"
                    list_data_cell = "n"
                    set_cell = "6"
                Case 3
                    check_cell = "q"
                    list_data_cell = "r"
                    set_cell = "8"
                Case 4
                    check_cell = "u"
                    list_data_cell = "v"
                    set_cell = "10"
                Case 5
                    check_cell = "y"
                    list_data_cell = "z"
                    set_cell = "12"
                Case 6
                    check_cell = "ac"
                    list_data_cell = "ad"
                    set_cell = "14"
                Case 7
                    check_cell = "ag"
                    list_data_cell = "ah"
                    set_cell = "16"
              
            End Select
    
            If Target.value <> "" Then
             
                 model_list = "" '|fffd||fffd||fffd||343||fffd||fffd|X|fffd|g|fffd||fffd||fffd|i|fffd|[|fffd||fffd||fffd||fffd||3d0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                 
                 '|fffd|I|fffd||fffd||fffd||fffd||fffd||a0bd|ME Type|fffd||251||389||fffd||fffd||fffd||fffd||fffd||a5d7||fffd||fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||fffd|
                 j = 3
                 Do Until Worksheets(list_data_sheet).Range(check_cell & j).value = ""
                     If Worksheets(list_data_sheet).Range(check_cell & j).value = Target.value Then
                        If model_list = "" Then name_start = list_data_cell & j
                        If Worksheets(list_data_sheet).Range(list_data_cell & j).value = "" Then
                            list_data = "" '|fffd|S|fffd|p|fffd||d4482||302||755|\|fffd||fffd||fffd||94|\
                        Else
                            list_data = Worksheets(list_data_sheet).Range(list_data_cell & j).value
                        End If
                        model_list = model_list & "," & list_data
                     Else
                        If model_list <> "" Then
                            name_end = list_data_cell & j - 1
                        Exit Do
                    End If
                     End If
                     j = j + 1
                 Loop
                 
                If name_end = "" Then name_end = list_data_cell & j - 1
                 
                '|fffd||3d0||fffd||fffd||243|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd||fffd||a5d7||fffd||fffd||fffd||fffd||34b|K|fffd||fffd||fffd||250||752||80b7||fffd||fffd|
                If model_list <> "" Then
                    Worksheets(list_data_sheet).Names.Add Name:="ME_" & set_cell, RefersTo:=Worksheets(list_data_sheet).Range(name_start & ":" & name_end)
                    With Target.Offset(set_cell, 0).Validation
                        .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
                        .Add Type:=xlValidateList, Formula1:=model_list
                        .ShowError = False
                    End With
                    Application.EnableEvents = False
                    'Open|fffd||fffd||fffd||343|_|fffd|E|fffd||fffd||fffd||fffd||fffd|[|fffd|h|fffd||fffd||fffd||312|l|fffd||fffd||fffd||fffd||fffd||302||702||715|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
                    If func <> "open" Then Target.Offset(set_cell, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|''
                    Application.EnableEvents = True
                Else
                    With Target.Offset(set_cell, 0).Validation
                        .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
                    End With
                    Application.EnableEvents = False
                    Target.Offset(set_cell, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
                    Application.EnableEvents = True
                End If
            Else
                With Target.Offset(set_cell, 0).Validation
                    .Delete '|fffd||fffd||fffd||142||250||752||80b3||fffd||fffd||102||fffd||fffd||fffd||fffd||a347||fffd||342||fffd||fffd||fffd||fffd||fffd||fffd||fffd||d3dc||fffd||fffd||fffd||103||fffd||fffd|X|fffd|g|fffd||fffd||fffd|N|fffd||fffd||fffd|A|fffd||242||fffd||fffd||fffd|
                End With
                Application.EnableEvents = False
                Target.Offset(set_cell, 0).value = "" '|fffd|\|fffd||fffd||fffd||fffd||fffd||fffd||102||fffd||fffd||fffd|f|fffd|[|fffd|^|fffd||fffd||fffd||d3dc|
                Application.EnableEvents = True
            End If
        Next
    End If

    '|fffd|A|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||313||fffd||fffd||357||fffd||fffd||243||fffd||fffd|X|fffd|g|fffd|l|fffd||20a|O|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd||fffd||a347||fffd||30f||fffd||fffd||fffd|
    If (Target.Address = sheet2_object.Range("Licensor_Cell").Address Or Target.Address = sheet2_object.Range("Licensee_Cell").Address Or _
            Target.Address = sheet2_object.Range("Unit_Cell").Address Or Target.Address = sheet2_object.Range("Bore_Cell").Address Or _
                Target.Address = sheet2_object.Range("Type1_Cell").Address Or Target.Address = sheet2_object.Range("Type2_Cell").Address Or _
                    Target.Address = sheet2_object.Range("Type3_Cell").Address Or Target.Address = sheet2_object.Range("Type4_Cell").Address Or _
                        Target.Address = sheet2_object.Range("Type5_Cell").Address Or Target.Address = sheet2_object.Range("Vdr_Model_Cell").Address Or _
                            Target.Address = sheet2_object.Range("Alarm_Model_Cell").Address) Then
                        
         Call Worksheet_OnChange(Target)
         
    End If
   
   ' |fffd|V|fffd|[|fffd|g|fffd||6cc||fffd||fffd||752||fffd|(UI|fffd||302||fffd|)
   ActiveSheet.Protect UserInterfaceOnly:=True

End Sub

'|fffd|A|fffd||fffd||fffd||fffd||fffd|X|fffd|g|fffd||313||fffd||fffd||357||fffd||fffd||243||fffd||fffd|X|fffd|g|fffd|l|fffd||20a|O|fffd||fffd||fffd|Z|fffd|b|fffd|g|fffd||fffd||fffd||a0bd||fffd||a347||fffd||30f||fffd||fffd||fffd|
Private Sub Worksheet_OnChange(ByVal Target As Range)

    Dim Name_define As String
    Dim chkbln As Boolean
    Dim Rng As Variant
    Dim sheet_name As String
    
    
    Name_define = ""
    chkbln = False
    
    Select Case Target.Name.Name '|fffd|Z|fffd||fffd||fffd||fffd||fffd||fffd|
    
        Case "Licensor_Cell"
            Name_define = "ME_LICENSOR"
            sheet_name = "2_ME Type"
        Case "Licensee_Cell"
            Name_define = "ME_2"
            sheet_name = "2_ME Type"
        Case "Unit_Cell"
            Name_define = "ME_4"
            sheet_name = "2_ME Type"
        Case "Type1_Cell"
            Name_define = "ME_6"
            sheet_name = "2_ME Type"
        Case "Bore_Cell"
            Name_define = "ME_8"
            sheet_name = "2_ME Type"
        Case "Type2_Cell"
            Name_define = "ME_10"
            sheet_name = "2_ME Type"
        Case "Type3_Cell"
            Name_define = "ME_12"
            sheet_name = "2_ME Type"
        Case "Type4_Cell"
            Name_define = "ME_14"
            sheet_name = "2_ME Type"
        Case "Type5_Cell"
            Name_define = "ME_16"
            sheet_name = "2_ME Type"
        
        Case "Vdr_Manufacture_Cell"
           Name_define = "VPMS_MANUFACTURER"
           sheet_name = "2_VPMS"
        Case "Vdr_Model_Cell"
           Name_define = "VPMS_Model"
           sheet_name = "2_VPMS"
        Case "Alarm_Manufacture_Cell"
           Name_define = "ALARM_MANUFACTURER"
           sheet_name = "2_VPMS"
        Case "Alarm_Model_Cell"
           Name_define = "Alarm_Model"
           sheet_name = "2_VPMS"
    End Select
    
    
    '|fffd||38f||6c3||fffd||fffd|X|fffd|g|fffd||312|l(|fffd||fffd||fffd|O|fffd||fffd|`|fffd||312|l|fffd||fffd|W|fffd|J)|fffd||193||fffd||fffd||352|l|fffd||fffd||fffd|r
    If Target <> "" And Name_define <> "" Then
        For Each Rng In Worksheets(sheet_name).Range(Name_define)
            If Rng = CStr(Target) Then
                chkbln = True
                Exit For
            End If
        Next Rng


        If chkbln = False Then
            Application.EnableEvents = False
            Worksheets("Input sheet2 (for Applicant)").Range(Cells(Target.Cells.Row, Target.Cells.Column).Address).value = ""
            MsgBox "Value is invalid.", vbCritical, "WARNING"
            Worksheets("Input sheet2 (for Applicant)").Range(Cells(Target.Cells.Row, Target.Cells.Column).Address).Select
            Application.EnableEvents = True
        End If
    End If

End Sub


'2018/12|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added start
'|fffd||82||fffd||fffd||fffd|O|fffd||250|\|fffd||fffd||fffd||fffd||fffd||fffd||fffd|\|fffd||fffd||fffd||242||fffd||fffd||fffd|
Private Sub Workbook_BeforeClose(Cancel As Boolean)
    Dim Answer As Long
    
    Application.DisplayAlerts = False       '### ADD ###
    If ThisWorkbook.Saved = False Then
         Answer = MsgBox("Do you want to save the changes to the '" & ThisWorkbook.Name & "' ?", vbExclamation + vbOKCancel, "Microsoft Excel")
        Select Case Answer
            Case vbCancel
'                Cancel = True              '### DEL ###
                ThisWorkbook.Saved = True   '### ADD ###
'                Exit Sub                   '### DEL ###
                GoTo END_PROC               '### ADD ###
        End Select
     End If

    ThisWorkbook.Unprotect Password:="Tx8-P7"
    On Error Resume Next
    If ThisWorkbook.Sheets("Notice").Visible <> True Then ThisWorkbook.Sheets("Notice").Visible = True
    If ThisWorkbook.Sheets("Input sheet1 (for Applicant)").Visible <> False Then ThisWorkbook.Sheets("Input sheet1 (for Applicant)").Visible = False
    If ThisWorkbook.Sheets("Input sheet2 (for Applicant)").Visible <> False Then ThisWorkbook.Sheets("Input sheet2 (for Applicant)").Visible = False
    If ThisWorkbook.Sheets("How to for Input Sheet2").Visible <> False Then ThisWorkbook.Sheets("How to for Input Sheet2").Visible = False
    '2018/xx|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki Modified start
    '|fffd||fffd||fffd|{|fffd||fffd|\|fffd|L|fffd||303|V|fffd|[|fffd|g|fffd||fffd||fffd|p|fffd||fffd|\|fffd|L|fffd||255||3cd|X|fffd||fffd||fffd|A|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||16891|R|fffd|h|fffd|~|fffd||fffd||fffd||fffd|
    If ThisWorkbook.Sheets("Worksheet (for NYKCODE)").Visible <> False Then ThisWorkbook.Sheets("Worksheet (for NYKCODE)").Visible = False
    '2018/xx|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki Modified end
    If ThisWorkbook.Sheets("Ledger (for NYKCODE)").Visible <> False Then ThisWorkbook.Sheets("Ledger (for NYKCODE)").Visible = False
    If ThisWorkbook.Sheets("How to").Visible <> False Then ThisWorkbook.Sheets("How to").Visible = False
    ThisWorkbook.Protect Password:="Tx8-P7"
    ThisWorkbook.Save
    
END_PROC:                                   '### ADD ###
    Application.DisplayAlerts = True        '### ADD ###
End Sub
'2018/12|fffd||fffd||fffd||fffd||fffd|[|fffd|X Masaki added end


INQUEST-PP=macro
