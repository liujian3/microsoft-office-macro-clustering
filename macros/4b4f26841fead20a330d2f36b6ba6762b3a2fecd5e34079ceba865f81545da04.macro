Attribute VB_Name = "List1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newRange As Range
  Dim sSh As String
  Dim sNeSh As String
  Dim sZK As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_handler
  
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False

Call zamek(c_UVER)
  Set newRange = ActiveCell
      
 
  Select Case Target.Address
    Case Range("uver_CU1").Address
      Target.Value = isCU(Target.Value)
    Case Range("UVER_FIRMA_T").Address
      Call vyskaRadku(c_UVER, "UVER_FIRMA_T", 25.5)
      Call hlavicka("UVER_FIRMA_T", Range("UVER_FIRMA_T").Value, Range("UVER_FIRMA_T").RowHeight)
    Case Range("UVER_SIDLO_T").Address
      Call vyskaRadku(c_UVER, "UVER_SIDLO_T", 25.5)
      Call hlavicka("UVER_SIDLO_T", Range("UVER_SIDLO_T").Value, Range("UVER_SIDLO_T").RowHeight)
    Case Range("UVER_SIZE_1").Address
      Call vyskaRadku(c_UVER, "UVER_SIZE_1", 25)
    Case Range("UVER_SIZE_2").Address
        Call vyskaRadku(c_UVER, "UVER_SIZE_2", 40)
    Case Range("uver_zadost").Address, Range("ZU_UVER").Address, Range("ZU_REALIZACE").Address
       Call set_SK_UVER(Target.Address = Range("ZU_REALIZACE").Address)
        If Target.Address = Range("ZU_UVER").Address Then
          If LCase(Range("ZU_UVER").Value) = "kontokorentn|fffd|" Or LCase(Range("ZU_UVER").Value) = "revolvingov|fffd|" Then
            Range("ZU_frekvence").Value = ""
           Sheets(c_UVER).Range("ZU_frekvence").Select
            Call DiagonalBorder(True)
           Selection.Locked = True
          Else
            Range("ZU_frekvence").Value = "DOPLNIT"
            Sheets(c_UVER).Range("ZU_frekvence").Select
            Selection.Locked = False
            Call DiagonalBorder(False)
          End If
        End If
    Case Range("UVER_ICO_T").Address
        Call hlavicka("UVER_ICO_T", Range("UVER_ICO_T").Value, Range("UVER_ICO_T").RowHeight)
    Case Else
      Call nastavCest
      Dim i As Integer
      On Error Resume Next
      ' tyto oblasti zde nemus|fffd| existovat, proto jsoe v sekci on error
      For i = 0 To UBound(s_Cest)
        If Target.Address = Sheets(c_UVER).Range("CEST_" & s_Cest(i) & "_UVER").Address Then
          Call CestneProhl("CEST_" & s_Cest(i) & "_UVER", Sheets(c_UVER).Range("CEST_" & s_Cest(i) & "_UVER").Value)
          Exit For
        End If
        
      Next i

      On Error GoTo 0
      On Error GoTo err_handler
      
      sZK = "ZU"
      If RangeExists(sZK & "_KB_P_J_1", Target.Address) Then
        Call Podpisovka("KB_P_J_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_F_1", Target.Address) Then
        Call Podpisovka("KB_P_F_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_D_1", Target.Address) Then
        Call Podpisovka("KB_P_D_1", Target.Value)
      End If
      
        
  End Select

  On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler

  
err_handler:
  Sheets(sNeSh).Activate
  Call zamek(c_UVER, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
End Sub


Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error Resume Next
    Select Case Target.Address
        Case Range("ZU_OPT1_1").Address
            Range("ZU_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZU_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZU_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("uver_CU1").Select
        Case Range("ZU_OPT1_2").Address
            Range("ZU_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZU_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZU_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("uver_CU1").Select
        Case Range("ZU_OPT1_3").Address
            Range("ZU_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZU_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZU_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("uver_CU1").Select
        Case Range("UVER_OPT_1_C").Address
          Range("CEST_1A1_UVER").Select
    End Select
    On Error GoTo 0
End Sub
Attribute VB_Name = "List10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdDO_6, 11, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_5, 10, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_4, 9, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_3, 8, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_2, 7, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_1, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_1, 12, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_2, 13, 7, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_3, 14, 8, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_4, 15, 9, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_5, 16, 10, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_6, 17, 11, MSForms, CommandButton"
Option Explicit

Private Sub cmdDO_1_Click()
    Call radekAdd("DO_1")
End Sub
Private Sub cmdDO_2_Click()
    Call radekAdd("DO_2")
End Sub
Private Sub cmdDO_3_Click()
    Call radekAdd("DO_3")
End Sub
Private Sub cmdDO_4_Click()
    Call radekAdd("DO_4")
End Sub
Private Sub cmdDO_5_Click()
    Call radekAdd("DO_5")
End Sub
Private Sub cmdDO_6_Click()
    Call radekAdd("DO_6")
End Sub

Private Sub cmdDOo_1_Click()
    Call radekRemove("DO_1")
End Sub
Private Sub cmdDOo_2_Click()
    Call radekRemove("DO_2")
End Sub
Private Sub cmdDOo_3_Click()
    Call radekRemove("DO_3")
End Sub
Private Sub cmdDOo_4_Click()
    Call radekRemove("DO_4")
End Sub
Private Sub cmdDOo_5_Click()
    Call radekRemove("DO_5")
End Sub
Private Sub cmdDOo_6_Click()
    Call radekRemove("DO_6")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name

  If Not ActiveSheet.ProtectContents Then Exit Sub
  
  On Error GoTo err_handler
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  iMin = 18.75
  Set newR = Selection
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 Then
   bScreen = False
   Call zamek(c_Dodavatel)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(c_Dodavatel, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If

     On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler

  End If
  
    
    Select Case Target.Address
      Case Range("DO_FIRMA").Address
        Call vyskaRadku(c_Dodavatel, "DO_FIRMA", 20.25)
        Call hlavicka("DO_FIRMA", Range("DO_FIRMA").Value, Range("DO_FIRMA").RowHeight)
        Sheets(c_Dodavatel).Select
      Case Range("DO_ICO").Address
        If InStr(1, LCase(Range("DO_ICO").Value), "i|fffd|o") = 0 Then
          Range("DO_ICO").Value = "I|fffd|O: " & Range("DO_ICO").Value
        End If
        Call hlavicka("DO_ICO", Range("DO_ICO").Value, Range("DO_ICO").RowHeight)
        Sheets(c_Dodavatel).Select
    End Select
    
    
    

err_handler:
    Sheets(sNeSh).Activate
    Call zamek(c_Dodavatel, True)
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub
Attribute VB_Name = "List11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdRI_4, 10, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_3, 9, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_2, 8, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_1, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_1, 11, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_2, 12, 7, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_3, 13, 8, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_4, 14, 9, MSForms, CommandButton"
Option Explicit
Private Sub cmdRI_1_Click()
    Call radekAdd("RI_1")
End Sub
Private Sub cmdRI_2_Click()
    Call radekAdd("RI_2")
End Sub
Private Sub cmdRI_3_Click()
    Call radekAdd("RI_3")
End Sub
Private Sub cmdRI_4_Click()
    Call radekAdd("RI_4")
End Sub

Private Sub cmdRIo_1_Click()
    Call radekRemove("RI_1")
End Sub
Private Sub cmdRIo_2_Click()
    Call radekRemove("RI_2")
End Sub
Private Sub cmdRIo_3_Click()
    Call radekRemove("RI_3")
End Sub
Private Sub cmdRIo_4_Click()
    Call radekRemove("RI_4")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
    
'  sSh = getsSH
'  sNeSh = ActiveSheet.Name
'
'  If Not ActiveSheet.ProtectContents Then Exit Sub
'  On Error GoTo err_handler
'
'
'  Application.EnableEvents = False
'  Application.ScreenUpdating = False
'  iMin = 15
'
'  Set newR = Selection
'  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
'   bScreen = False
'   Call zamek(c_Rozbor)
'   iAkt = Target.Rows.Height
'   iNew = iMin
'   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
'    For i = 2 To iLastCol
'      If Cells(Target.Row, i).Value <> "" Then
'        Call vyskaRadku(c_Rozbor, Cells(Target.Row, i).Address, iMin)
'        If Target.Rows.Height > iNew Then
'          iNew = Target.Rows.Height
'        End If
'      End If
'    Next i
'    If iNew > iMin Then
'      Target.RowHeight = iNew
'    Else
'      Target.RowHeight = iMin
'    End If
'
'    On Error Resume Next
'      newR.Select
'    On Error GoTo 0
'    On Error GoTo err_handler
'  End If
'  Select Case Target.Address
'    Case Range("RI_soucet_1_1").Address, Range("RI_soucet_1_2").Address
'      Call RI_kontrola(1, c_Rozbor)
'    Case Range("RI_soucet_1_3").Address
'      Call RI_kontrola(3, c_Rozbor)
'    Case Range("RI_soucet_2_2").Address, Range("RI_soucet_2_3").Address, Range("RI_soucet_2_4").Address, Range("RI_soucet_2_5").Address
'      Call RI_kontrola(2, c_Rozbor)
'    Case Range("RI_soucet_3_1").Address, Range("RI_soucet_3_2").Address
'      Call RI_kontrola(4, c_Rozbor)
'    Case Range("RI_soucet_3_3").Address
'      Call RI_kontrola(6, c_Rozbor)
'    Case Range("RI_soucet_4_2").Address, Range("RI_soucet_4_3").Address, Range("RI_soucet_4_4").Address, Range("RI_soucet_4_5").Address
'      Call RI_kontrola(5, c_Rozbor)
'    Case Range("RP_FIRMA").Address
'        Call vyskaRadku(c_Rozbor, "RP_FIRMA", 20.25)
'        Call hlavicka("RP_FIRMA", Range("RP_FIRMA").Value, Range("RP_FIRMA").RowHeight)
'        Sheets(c_Rozbor).Select
'      Case Range("RP_ICO").Address
'        If InStr(1, LCase(Range("RP_ICO").Value), "i|fffd|o") = 0 Then
'          Range("RP_ICO").Value = "I|fffd|O: " & Range("RP_ICO").Value
'        End If
'        Call hlavicka("RP_ICO", Range("RP_ICO").Value, Range("RP_ICO").RowHeight)
'        Sheets(c_Rozbor).Select
'  End Select
'
'
'err_handler:
'  Sheets(sNeSh).Activate
'  Call zamek(c_Rozbor, True)
'  Application.ScreenUpdating = True
'  Application.EnableEvents = True
    
    
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_handler
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  iMin = 15
  
  Set newR = Selection
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
   bScreen = False
   Call zamek(sNeSh)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(sNeSh, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If
    
    On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler
  End If
  Select Case Target.Address
    Case Range("RI_soucet_1_1").Address, Range("RI_soucet_1_2").Address
      Call RI_kontrola(1, sNeSh)
    Case Range("RI_soucet_1_3").Address
      Call RI_kontrola(3, sNeSh)
    Case Range("RI_soucet_2_2").Address, Range("RI_soucet_2_3").Address, Range("RI_soucet_2_4").Address, Range("RI_soucet_2_5").Address
      Call RI_kontrola(2, sNeSh)
    Case Range("RI_soucet_3_1").Address, Range("RI_soucet_3_2").Address
      Call RI_kontrola(4, sNeSh)
    Case Range("RI_soucet_3_3").Address
      Call RI_kontrola(6, sNeSh)
    Case Range("RI_soucet_4_2").Address, Range("RI_soucet_4_3").Address, Range("RI_soucet_4_4").Address, Range("RI_soucet_4_5").Address
      Call RI_kontrola(5, sNeSh)
    Case Range("RP_FIRMA").Address
        Call vyskaRadku(sNeSh, "RP_FIRMA", 20.25)
        Call hlavicka("RP_FIRMA", Range("RP_FIRMA").Value, Range("RP_FIRMA").RowHeight)
        Sheets(sNeSh).Select
      Case Range("RP_ICO").Address
        If InStr(1, LCase(Range("RP_ICO").Value), "i|fffd|o") = 0 Then
          Range("RP_ICO").Value = "I|fffd|O: " & Range("RP_ICO").Value
        End If
        Call hlavicka("RP_ICO", Range("RP_ICO").Value, Range("RP_ICO").RowHeight)
        Sheets(sNeSh).Select
  End Select
  

err_handler:
  Sheets(sNeSh).Activate
  Call zamek(sNeSh, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
  
End Sub

Attribute VB_Name = "List12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdPAA_1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdPAA_2, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdPAA_3, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdPAA_4, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdPAoA_1, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdPAoA_2, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdPAoA_3, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdPAoA_4, 8, 7, MSForms, CommandButton"
Option Explicit
Private Sub cmdPAA_1_Click()
    Call radekAdd("PAA_1")
End Sub
Private Sub cmdPAA_2_Click()
    Call radekAdd("PAA_2")
End Sub
Private Sub cmdPAA_3_Click()
    Call radekAdd("PAA_3")
End Sub
Private Sub cmdPAA_4_Click()
    Call radekAdd("PAA_4")
End Sub

Private Sub cmdPAoA_1_Click()
    Call radekRemove("PAA_1")
End Sub

Private Sub cmdPAoA_2_Click()
    Call radekRemove("PAA_2")
End Sub


Private Sub cmdPAoA_3_Click()
    Call radekRemove("PAA_3")
End Sub


Private Sub cmdPAoA_4_Click()
    Call radekRemove("PAA_4")
End Sub



Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
    
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
   
    On Error GoTo err_hanlder
    
    iMin = 18.75
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Set newR = Selection
    Sheets(sSh).Activate
  
   Call zamek(ActiveSheet.Name)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(ActiveSheet.Name, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If
    
    Select Case Target.Address
      Case Range("PAA_PRAV").Address
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_FOO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_FOP").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_PO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_F").Row).EntireRow.Hidden = False
        If LCase(Range("PAA_PRAV").Value) = "natural person" Then
             Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_FOP").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_PO").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_F").Row).EntireRow.Hidden = True
            
        ElseIf LCase(Range("PAA_PRAV").Value) = "entrepreneur" Then
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_FOO").Row).EntireRow.Hidden = True
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_F").Row).EntireRow.Hidden = True
          ActiveSheet.Range("PAA_FOP").Value = "Company*/ First name and surname**"
        ElseIf LCase(Range("PAA_PRAV").Value) = "company" Then
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PAA_FOO").Row).EntireRow.Hidden = True
            ActiveSheet.Range("PAA_FOP").Value = "Company*/ Name**:"
        End If
      
      Case Range("PAA_KB_P_J_1").Address
        Call Podpisovka("KB_P_J_1", Target.Value)
      Case Range("PAA_KB_P_F_1").Address
        Call Podpisovka("KB_P_F_1", Target.Value)
      Case Range("PAA_KB_P_D_1").Address
        Call Podpisovka("KB_P_D_1", Target.Value)
    
    End Select


  End If
  
  
    On Error Resume Next
      newR.Select
    On Error GoTo 0
    
err_hanlder:
    Call zamek(ActiveSheet.Name, True)
    Sheets(sNeSh).Activate
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub




Attribute VB_Name = "List13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdPDA_1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdPDA_2, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdPDA_3, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdPDA_4, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdPDoA_1, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdPDoA_2, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdPDoA_4, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdPDoA_3, 8, 7, MSForms, CommandButton"
Option Explicit
Private Sub cmdPDA_1_Click()
    Call radekAdd("PDA_1")
End Sub
Private Sub cmdPDA_2_Click()
    Call radekAdd("PDA_2")
End Sub
Private Sub cmdPDA_3_Click()
    Call radekAdd("PDA_3")
End Sub
Private Sub cmdPDA_4_Click()
    Call radekAdd("PDA_4")
End Sub

Private Sub cmdPDoA_1_Click()
    Call radekRemove("PDA_1")
End Sub
Private Sub cmdPDoA_2_Click()
    Call radekRemove("PDA_2")
End Sub
Private Sub cmdPDoA_3_Click()
    Call radekRemove("PDA_3")
End Sub
Private Sub cmdPDoA_4_Click()
    Call radekRemove("PDA_4")
End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  iMin = 18.75
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
  
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
  On Error GoTo err_handler
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  Set newR = Selection
  Sheets(sSh).Activate
   Call zamek(sSh)
   
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(ActiveSheet.Name, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
        Target.RowHeight = iMin
    End If
    
  End If
    On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler
    
  Select Case Target.Address
    Case Range("PDA_PRAV").Address
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_FOO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_FOP").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_PO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_F").Row).EntireRow.Hidden = False
        If LCase(Range("PDA_PRAV").Value) = "natural person" Then
             Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_FOP").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_PO").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_F").Row).EntireRow.Hidden = True
            
        ElseIf LCase(Range("PDA_PRAV").Value) = "entrepreneur" Then
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_FOO").Row).EntireRow.Hidden = True
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_F").Row).EntireRow.Hidden = True
          ActiveSheet.Range("PDA_FOP").Value = "Company*/ First name and surname**"
        ElseIf LCase(Range("PDA_PRAV").Value) = "company" Then
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PDA_FOO").Row).EntireRow.Hidden = True
            ActiveSheet.Range("PDA_FOP").Value = "Company*/ Name**:"
        End If
      
      Case Range("PDA_KB_P_J_1").Address
        Call Podpisovka("KB_P_J_1", Target.Value)
      Case Range("PDA_KB_P_F_1").Address
        Call Podpisovka("KB_P_F_1", Target.Value)
      Case Range("PDA_KB_P_D_1").Address
      Call Podpisovka("KB_P_D_1", Target.Value)
    
    End Select
    
  
err_handler:
  Call zamek(sSh, True)
  Sheets(sNeSh).Activate
  Application.ScreenUpdating = True
  Application.EnableEvents = True

End Sub
Attribute VB_Name = "List15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_handler
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  Select Case Target.Address
      Case Range("DE_FIRMA").Address
        Call vyskaRadku(c_DE, "DE_FIRMA", 25.5)
        Call hlavicka("DE_FIRMA", Range("DE_FIRMA").Value, Range("DE_FIRMA").RowHeight)
        Sheets(c_DE).Select
      Case Range("DE_ICO").Address
        If InStr(1, LCase(Range("DE_ICO").Value), "i|fffd|o") = 0 Then
          Range("DE_ICO").Value = "I|fffd|O: " & Range("DE_ICO").Value
        End If
        Call hlavicka("DE_ICO", Range("DE_ICO").Value, Range("DE_ICO").RowHeight)
        Sheets(c_DE).Select
    End Select
    
err_handler:
    Sheets(sNeSh).Activate
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

End Sub
Attribute VB_Name = "List16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub CommandButton1_Click()
  ' tla|fffd||fffd|tko pro odesl|fffd|n|fffd| mailu je invisible - vid|fffd|t je v re|fffd|imu n|fffd|vrhu
  Dim fldr As Variant
  Dim sItem As String
  Dim xOutApp As Object
  Dim xMailItem As Object
  Dim xName As String
  Dim sForma As String
  Dim sName As String
  
  
  If ActiveWorkbook.Path = "" Then
    b_Save = False
    Set fldr = Application.FileDialog(msoFileDialogSaveAs)
    With fldr
        .FilterIndex = 2
        MsgBox "Se|fffd|it ulo|fffd|te jako " & Chr(34) & "Se|fffd|it Excelu s podporou maker (*.xlsm)" & Chr(34), vbInformation, POPIS_MSG
        If .Show Then
          sName = .SelectedItems(1)
          sForma = Split(sName, ".")(UBound(Split(sName, ".")))
          If LCase(sForma) <> "xlsm" Then
            sName = Left(sName, Len(sName) - Len(sForma)) + "xlsm"
          End If
            
            ActiveWorkbook.SaveAs sName, FileFormat:=xlOpenXMLWorkbookMacroEnabled
        Else
          Exit Sub
        End If
    sItem = .SelectedItems(1)
    End With
    
    b_Save = True

  Else
    ActiveWorkbook.Save
  End If
  
 
    On Error Resume Next
    Set xOutApp = CreateObject("Outlook.Application")
    Set xMailItem = xOutApp.CreateItem(0)
    xName = ActiveWorkbook.FullName
    With xMailItem
        .To = ""
        .CC = ""
        .Subject = "Test mail s p|fffd||fffd|lohou"
        .Body = "Mail s prilohou"
        .Attachments.add xName
        .Display
       '.send
    End With
    Set xMailItem = Nothing
    Set xOutApp = Nothing


End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
    Dim newRange As Range
    Dim i As Integer
    Dim sText As String
    Dim sSh As String
    Dim sNeSh As String
    
    sSh = getsSH
    sNeSh = ActiveSheet.Name
    
    If Not ActiveSheet.ProtectContents Then Exit Sub
    
    On Error GoTo err_handler
    
    
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Call zamek(c_UVOD)
    Set newRange = ActiveCell
    Select Case Target.Address
    Case Range("UVOD_FIRMA_T").Address
        Call vyskaRadku(c_UVOD, "UVOD_FIRMA_T", 25.5)
        Call hlavicka("UVOD_FIRMA_T", Range("UVOD_FIRMA_T").Value, Range("UVOD_FIRMA_T").RowHeight)
    Case Range("UVOD_ICO_T").Address
        Call hlavicka("UVOD_ICO_T", Range("UVOD_ICO_T").Value, Range("UVOD_ICO_T").RowHeight)
    Case Range("UVOD_KB_P_J_1").Address
      Call Podpisovka("KB_P_J_1", Target.Value)
    Case Range("UVOD_KB_P_F_1").Address
      Call Podpisovka("KB_P_F_1", Target.Value)
    Case Range("UVOD_KB_P_D_1").Address
      Call Podpisovka("KB_P_D_1", Target.Value)
    Case Range("UVOD_SIDLO_T").Address
        Call vyskaRadku(c_UVOD, "UVOD_SIDLO_T", 25.5)
        Call hlavicka("UVOD_SIDLO_T", Range("UVOD_SIDLO_T").Value, Range("UVOD_SIDLO_T").RowHeight)
     Case Else
    End Select

    
  On Error Resume Next
  newRange.Select
  On Error GoTo 0
  
err_handler:
  Sheets(sNeSh).Activate
  Call zamek(c_UVOD, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
    
End Sub


Attribute VB_Name = "List17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newRange As Range
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
If Not ActiveSheet.ProtectContents Then Exit Sub
  
  On Error GoTo err_hanlder
  
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  Call zamek(c_ZARUKA)
  Set newRange = ActiveCell
    
  Select Case Target.Address
    Case Range("ZZ_TYP_ZARUKY").Address
'    Debug.Print Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Row & ":" & Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Row + Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Rows.Count - 1
      Sheets(c_ZARUKA).Rows(Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Row & ":" & Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Row + Sheets(c_ZARUKA).Range("ZZ_TYP_ZARUKY_SK").Rows.Count - 1).EntireRow.Hidden = Not (Target.Value = "jin|fffd| (dopl|fffd|te):" Or Target.Value = "DOPLNIT")
    Case Range("zaruka_CU2").Address
      Target.Value = isCU(Target.Value)
    Case Range("ZARUK_FIRMA_T").Address
      Call vyskaRadku(c_ZARUKA, "ZARUK_FIRMA_T", 25.5)
      Call hlavicka("ZARUK_FIRMA_T", Range("ZARUK_FIRMA_T").Value, Range("ZARUK_FIRMA_T").RowHeight)
    Case Range("ZARUK_SIDLO_T").Address
      Call vyskaRadku(c_ZARUKA, "ZARUK_SIDLO_T", 25.5)
      Call hlavicka("ZARUK_SIDLO_T", Range("ZARUK_SIDLO_T").Value, Range("ZARUK_SIDLO_T").RowHeight)
    Case Range("zaruka_veritel_T").Address
      Call vyskaRadku(c_ZARUKA, "zaruka_veritel_T", 25.5)
    Case Range("ZARUK_VER_SIDLO_T").Address
      Call vyskaRadku(c_ZARUKA, "ZARUK_VER_SIDLO_T", 25.5)

    Case Range("ZARUK_ICO_T").Address
        Call hlavicka("ZARUK_ICO_T", Range("ZARUK_ICO_T").Value, Range("ZARUK_ICO_T").RowHeight)

    Case Range("ZARUKA_SIZE_1").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_1", 30)
    Case Range("ZARUKA_SIZE_3").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_3", 30)
    Case Range("ZARUKA_SIZE_4").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_4", 30)
    Case Range("ZARUKA_SIZE_5").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_5", 15)
    Case Range("ZARUKA_SIZE_6").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_6", 15)
    Case Range("ZARUKA_SIZE_7").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_7", 20)
    Case Range("ZARUKA_SIZE_8").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_8", 28)
    Case Range("ZARUKA_SIZE_10").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_10", 30)
    Case Range("ZARUKA_SIZE_B_1").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_B_1", 15)
    Case Range("ZARUKA_SIZE_K_1").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_K_1", 15)
    Case Range("ZARUKA_SIZE_K_2").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_K_2", 15)
    Case Range("ZARUKA_SIZE_K_3").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_K_3", 15)
    Case Range("ZARUKA_SIZE_S_1").Address
      Call vyskaRadku(c_ZARUKA, "ZARUKA_SIZE_S_1", 15)
    Case Range("ZARUKA_ZADOST").Address
      Select Case LCase(Range("ZARUKA_ZADOST").Value)
        Case "poskytnut|fffd| bankovn|fffd| z|fffd|ruky"
                Sheets(c_ZARUKA).Rows(Sheets(c_ZARUKA).Range("ZA_REG").Row).EntireRow.Hidden = True
        Case Else
            Sheets(c_ZARUKA).Rows(Sheets(c_ZARUKA).Range("ZA_REG").Row).EntireRow.Hidden = False
       End Select
    Case Else
      Call nastavCest
      Dim i As Integer
      On Error Resume Next
      For i = 0 To UBound(s_Cest)
        If Target.Address = Sheets(c_ZARUKA).Range("CEST_" & s_Cest(i) & "_ZARUKA").Address Then
          Call CestneProhl("CEST_" & s_Cest(i) & "_ZARUKA", Sheets(c_ZARUKA).Range("CEST_" & s_Cest(i) & "_ZARUKA").Value)
          Exit For
        End If
      Next i
      On Error GoTo 0
      On Error GoTo err_hanlder
      
      Dim sZK As String
      sZK = "ZZ"
      If RangeExists(sZK & "_KB_P_J_1", Target.Address) Then
        Call Podpisovka("KB_P_J_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_F_1", Target.Address) Then
        Call Podpisovka("KB_P_F_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_D_1", Target.Address) Then
        Call Podpisovka("KB_P_D_1", Target.Value)
      End If
  End Select
    
   On Error Resume Next
    newRange.Select
  On Error GoTo 0

err_hanlder:
  Sheets(sNeSh).Activate
  Call zamek(c_ZARUKA, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
End Sub





Private Sub Worksheet_SelectionChange(ByVal Target As Range)
If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error Resume Next
  Select Case Target.Address
        Case Range("ZZ_OPT1_1").Address
            Range("ZZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZZ_Vyse").Select
        Case Range("ZZ_OPT1_2").Address
            Range("ZZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZARUKA_SIZE_5").Select
            
        Case Range("ZZ_OPT2_1").Address
            Range("ZZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZZ_OPT2_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Call PostHide("B")
            Range("ZZ_OPT2_1").Offset(0, 1).Select
            If Range("ZZ_OPT2_13").Value = Sheets(c_POM).Range("POM_OPT_T").Value Then
              Call PostHide("B2")
            End If
        Case Range("ZZ_OPT2_2").Address
            Range("ZZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("ZZ_OPT2_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Call PostHide("K")
            Range("ZZ_OPT2_3").Offset(0, 1).Select
            If Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_T").Value Or Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_T").Value Then
              Call PostHide("K2")
            End If
            
        Case Range("ZZ_OPT2_3").Address
            Range("ZZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("ZZ_OPT2_3").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Call PostHide("S")
            Range("ZZ_OPT2_3").Offset(0, 1).Select
            
        Case Range("ZZ_OPT2_11").Address
          Range("ZZ_OPT2_11").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_12").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_13").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Call PostHide("B1")
          Range("ZARUKA_SIZE_B_1").Select
        Case Range("ZZ_OPT2_12").Address
          Range("ZZ_OPT2_11").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_12").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_13").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Call PostHide("B1")
          Range("ZARUKA_SIZE_B_1").Select
        Case Range("ZZ_OPT2_13").Address
          Range("ZZ_OPT2_11").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_12").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_13").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Call PostHide("B2")
          Range("ZZ_OPT2_13").Offset(0, 1).Select
          
        
        Case Range("ZZ_OPT2_21").Address
          Range("ZZ_OPT2_21").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_22").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Call PostHide("K1")
          Range("ZARUKA_SIZE_K_1").Select
        Case Range("ZZ_OPT2_22").Address
          Range("ZZ_OPT2_21").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_22").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Call PostHide("K1")
          Range("ZARUKA_SIZE_K_1").Select
        Case Range("ZZ_OPT2_23").Address
          Range("ZZ_OPT2_21").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_22").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Call PostHide("K2")
          Range("ZARUKA_SIZE_K_2").Select
        Case Range("ZZ_OPT2_24").Address
          Range("ZZ_OPT2_21").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_22").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Call PostHide("K2")
          Range("ZARUKA_SIZE_K_3").Select

        Case Range("ZZ_OPT2_31").Address
          Range("ZZ_OPT2_31").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_32").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_31").Offset(0, 1).Select
        Case Range("ZZ_OPT2_32").Address
          Range("ZZ_OPT2_31").Value = Sheets(c_POM).Range("POM_OPT_F").Value
          Range("ZZ_OPT2_32").Value = Sheets(c_POM).Range("POM_OPT_T").Value
          Range("ZZ_OPT2_32").Offset(0, 1).Select
        

    End Select
    On Error Resume Next
End Sub

Private Sub PostHide(sTyp As String)
  Call zamek(c_ZARUKA)
  Select Case sTyp
    Case "B1", "B2"
      Rows(Range("ZARUKA_SIZE_B_1").Row - 1 & ":" & Range("ZARUKA_SIZE_B_1").Row).EntireRow.Hidden = Not sTyp = "B1"
      If sTyp = "B2" Then Range("ZARUKA_SIZE_B_1").Value = ""
    Case "K1", "K2"
       Rows(Range("ZARUKA_SIZE_K_1").Row & ":" & Range("ZARUKA_SIZE_K_1").Row).EntireRow.Hidden = Not sTyp = "K1"
    Case Else
      Rows(Range("ZZ_OPT2_1").Row + 1 & ":" & Range("ZZ_OPT2_1").Row + 6).EntireRow.Hidden = Not sTyp = "B"
      Rows(Range("ZZ_OPT2_2").Row + 1 & ":" & Range("ZZ_OPT2_2").Row + 8).EntireRow.Hidden = Not sTyp = "K"
      Rows(Range("ZZ_OPT2_3").Row + 1 & ":" & Range("ZZ_OPT2_3").Row + 3).EntireRow.Hidden = Not sTyp = "S"
  End Select
  Call zamek(c_ZARUKA, True)
End Sub

Private Sub defaultZar()

  Call zamek(c_ZARUKA, False)
  
    Rows(Range("ZZ_OPT2_1").Row + 1 & ":" & Range("ZZ_OPT2_1").Row + 6).EntireRow.Hidden = False
    Rows(Range("ZZ_OPT2_2").Row + 1 & ":" & Range("ZZ_OPT2_2").Row + 8).EntireRow.Hidden = False
    Rows(Range("ZZ_OPT2_3").Row + 1 & ":" & Range("ZZ_OPT2_3").Row + 3).EntireRow.Hidden = False
  
    Range("ZZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
        
    Range("ZZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    
    Range("ZZ_OPT2_11").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_12").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_13").Value = Sheets(c_POM).Range("POM_OPT_F").Value
         
    Range("ZZ_OPT2_21").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_22").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_23").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_24").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    
    Range("ZZ_OPT2_31").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Range("ZZ_OPT2_32").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  
  Call zamek(c_ZARUKA, True)
    Range("ZARUKA_SIZE_B_1").Value = ""
    Range("ZARUKA_SIZE_S_1").Value = ""
    Range("ZARUKA_SIZE_K_1").Value = ""
    Range("ZARUKA_SIZE_K_2").Value = ""
    Range("ZARUKA_SIZE_K_3").Value = ""
End Sub
Attribute VB_Name = "List18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newRange As Range
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
If Not ActiveSheet.ProtectContents Then Exit Sub
  
  On Error GoTo err_handler
  
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  Set newRange = ActiveCell
    
  Call zamek(c_PRISLIB)
  Application.ScreenUpdating = False
  Select Case Target.Address
    Case Range("Prislib_CU").Address
      Target.Value = isCU(Target.Value)
    Case Range("PRISLIB_FIRMA_T").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_FIRMA_T", 25.5)
      Call hlavicka("PRISLIB_FIRMA_T", Range("PRISLIB_FIRMA_T").Value, Range("PRISLIB_FIRMA_T").RowHeight)
    Case Range("PRISLIB_SIDLO_T").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIDLO_T", 25.5)
      Call hlavicka("PRISLIB_SIDLO_T", Range("PRISLIB_SIDLO_T").Value, Range("PRISLIB_SIDLO_T").RowHeight)
    Case Range("PRISLIB_VER_FIRMA_T").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_VER_FIRMA_T", 25.5)
    Case Range("PRISLIB_VER_SIDLO_T").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_VER_SIDLO_T", 25.5)

    Case Range("PRISLIB_ICO_T").Address
        Call hlavicka("PRISLIB_ICO_T", Range("PRISLIB_ICO_T").Value, Range("PRISLIB_ICO_T").RowHeight)


    Case Range("PRISLIB_VER_FIRMA_T").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_VER_FIRMA_T", 25.5)
    Case Range("PRISLIB_SIZE_1").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_1", 35)
    Case Range("PRISLIB_SIZE_2").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_2", 15)
    Case Range("PRISLIB_SIZE_3").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_3", 35)
    Case Range("PRISLIB_SIZE_4").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_4", 35)
    Case Range("PRISLIB_SIZE_5").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_5", 15)
    Case Range("PRISLIB_SIZE_6").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_6", 20)
    Case Range("PRISLIB_SIZE_7").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_7", 15)
    Case Range("PRISLIB_SIZE_8").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_8", 15)
    Case Range("PRISLIB_SIZE_9").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_9", 15)
    Case Range("PRISLIB_SIZE_10").Address
      Call vyskaRadku(c_PRISLIB, "PRISLIB_SIZE_10", 35)
    Case Range("PRISLIB_ZADOST").Address
      Select Case LCase(Range("PRISLIB_ZADOST").Value)
        Case "zm|fffd|ny p|fffd||fffd|slibu |fffd|.", "doplnit"
                Sheets(c_PRISLIB).Rows(Sheets(c_PRISLIB).Range("PR_REG").Row).EntireRow.Hidden = False
        Case Else
            Sheets(c_PRISLIB).Rows(Sheets(c_PRISLIB).Range("PR_REG").Row).EntireRow.Hidden = True
       End Select
      
    Case Else
      Call nastavCest
      
      Dim i As Integer
      
      On Error Resume Next
      For i = 0 To UBound(s_Cest)
        If Target.Address = Sheets(c_PRISLIB).Range("CEST_" & s_Cest(i) & "_PRISLIB").Address Then
          Call CestneProhl("CEST_" & s_Cest(i) & "_PRISLIB", Sheets(c_PRISLIB).Range("CEST_" & s_Cest(i) & "_PRISLIB").Value)
          Exit For
        End If
      Next i
      On Error GoTo 0
      On Error GoTo err_handler
      
      Dim sZK As String
      sZK = "PZ"
      If RangeExists(sZK & "_KB_P_J_1", Target.Address) Then
        Call Podpisovka("KB_P_J_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_F_1", Target.Address) Then
        Call Podpisovka("KB_P_F_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_D_1", Target.Address) Then
        Call Podpisovka("KB_P_D_1", Target.Value)
      End If
    End Select
    
    
    
    
      On Error Resume Next
      newRange.Select
      On Error GoTo 0
      
err_handler:
    Sheets(sNeSh).Activate
    Call zamek(c_PRISLIB, True)
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
  If Not ActiveSheet.ProtectContents Then Exit Sub
    Call zamek(c_PRISLIB, False)
    On Error Resume Next
    Select Case Target.Address
        Case Range("PZ_OPT1_1").Address
            Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_4").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Rows(Range("PRISLIB_SIZE_7").Row).EntireRow.Hidden = False
            Sheets(c_PRISLIB).Range("PRISLIB_SIZE_7").Select
            
        Case Range("PZ_OPT1_2").Address
            Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("PZ_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_4").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Rows(Range("PRISLIB_SIZE_7").Row).EntireRow.Hidden = True
            Range("PRISLIB_SIZE_5").Select
            
        Case Range("PZ_OPT1_3").Address
            Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("PZ_OPT1_4").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Rows(Range("PRISLIB_SIZE_7").Row).EntireRow.Hidden = False
            Sheets(c_PRISLIB).Range("PRISLIB_SIZE_7").Select
            
        Case Range("PZ_OPT1_4").Address
            Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT1_4").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Rows(Range("PRISLIB_SIZE_7").Row).EntireRow.Hidden = True
            Range("PRISLIB_SIZE_2").Select
            
            
            
        Case Range("PZ_OPT2_1").Address
            Range("PZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("PZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Sheets(c_PRISLIB).Range("PRISLIB_SIZE_8").Select
        Case Range("PZ_OPT2_2").Address
            Range("PZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
            Range("PZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_T").Value
            Range("PRISLIB_SIZE_8").Select
    End Select
    Call zamek(c_PRISLIB, True)
  On Error GoTo 0
    
End Sub

Private Sub DefaultPZ()
  Call zamek(c_PRISLIB, False)
  
  Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  Range("PZ_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  Range("PZ_OPT1_4").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  Rows(Range("PRISLIB_SIZE_7").Row).EntireRow.Hidden = False
  
  Range("PZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_T").Value
  Range("PZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
  
  Call zamek(c_PRISLIB, True)
End Sub
Attribute VB_Name = "List19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newRange As Range
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_hanlder
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  Set newRange = ActiveCell
   
  Call zamek(c_CELNI)
  
  Select Case Target.Address
    Case Range("celnu_cu1").Address
      Target.Value = isCU(Target.Value)
    
    Case Range("CELNI_FIRMA_T").Address
      Call vyskaRadku(c_CELNI, "CELNI_FIRMA", 25.5)
      Call hlavicka("CELNI_FIRMA_T", Range("CELNI_FIRMA_T").Value, Range("CELNI_FIRMA_T").RowHeight)
    
    Case Range("CELNI_SIDLO_T").Address
      Call vyskaRadku(c_CELNI, "CELNI_SIDLO_T", 25.5)
      Call hlavicka("CELNI_SIDLO_T", Range("CELNI_SIDLO_T").Value, Range("CELNI_SIDLO_T").RowHeight)
    
    Case Range("CELNI_SIZE_1").Address
      Call vyskaRadku(c_CELNI, "CELNI_SIZE_1", 25.5)
    
    Case Range("CELNI_SIZE_3").Address
      Call vyskaRadku(c_CELNI, "CELNI_SIZE_3", 25.5)
      
    Case Range("CELNI_ICO_T").Address
        Call hlavicka("CELNI_ICO_T", Range("CELNI_ICO_T").Value, Range("CELNI_ICO_T").RowHeight)
       
    Case Range("CELNI_ZADOST").Address
      Select Case LCase(Range("CELNI_ZADOST").Value)
        Case "poskytnut|fffd| celn|fffd| z|fffd|ruky"
                Sheets(c_CELNI).Rows(Sheets(c_CELNI).Range("CE_REG").Row).EntireRow.Hidden = True
        Case Else
            Sheets(c_CELNI).Rows(Sheets(c_CELNI).Range("CE_REG").Row).EntireRow.Hidden = False
       End Select
      
    Case Else
      Call nastavCest
      
      Dim i As Integer
      On Error Resume Next
      
      For i = 0 To UBound(s_Cest)
        If Target.Address = Sheets(c_CELNI).Range("CEST_" & s_Cest(i) & "_CELNI").Address Then
          Call CestneProhl("CEST_" & s_Cest(i) & "_CELNI", Sheets(c_CELNI).Range("CEST_" & s_Cest(i) & "_CELNI").Value)
          Exit For
        End If
      Next i
      
      Dim sZK As String
        sZK = "ZC"
      If RangeExists(sZK & "_KB_P_J_1", Target.Address) Then
        Call Podpisovka("KB_P_J_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_F_1", Target.Address) Then
        Call Podpisovka("KB_P_F_1", Target.Value)
      ElseIf RangeExists(sZK & "_KB_P_D_1", Target.Address) Then
        Call Podpisovka("KB_P_D_1", Target.Value)
      End If
      
      On Error GoTo 0
  End Select
     
  On Error Resume Next
    newRange.Select
  On Error GoTo 0
  
err_hanlder:
  Sheets(sNeSh).Activate
  Call zamek(c_CELNI, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
End Sub



Attribute VB_Name = "List2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdPD_4, 4, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdPD_3, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdPD_2, 2, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdPD_1, 1, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdPDo_1, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdPDo_2, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdPDo_3, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdPDo_4, 8, 7, MSForms, CommandButton"
Option Explicit
Private Sub cmdPD_1_Click()
    Call radekAdd("PD_1")
End Sub
Private Sub cmdPD_2_Click()
    Call radekAdd("PD_2")
End Sub
Private Sub cmdPD_3_Click()
    Call radekAdd("PD_3")
End Sub
Private Sub cmdPD_4_Click()
    Call radekAdd("PD_4")
End Sub

Private Sub cmdPDo_1_Click()
    Call radekRemove("PD_1")
End Sub
Private Sub cmdPDo_2_Click()
    Call radekRemove("PD_2")
End Sub
Private Sub cmdPDo_3_Click()
    Call radekRemove("PD_3")
End Sub
Private Sub cmdPDo_4_Click()
    Call radekRemove("PD_4")
End Sub


Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
    
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
  
    On Error GoTo err_hanlder
    
    iMin = 18.75
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Set newR = Selection
    Sheets(sSh).Activate
  
    Call zamek(sSh)
    iAkt = Target.Rows.Height
    iNew = iMin
    iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(ActiveSheet.Name, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
        Target.RowHeight = iMin
    End If
    
  End If
  
    On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_hanlder
    
  Select Case Target.Address
    Case Range("PD_PRAV").Address
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_FOO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_FOP").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_PO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_F").Row).EntireRow.Hidden = False
        If LCase(Range("PD_PRAV").Value) = "fyzick|fffd| osoba" Then
             Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_FOP").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_PO").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_F").Row).EntireRow.Hidden = True
            
        ElseIf LCase(Range("PD_PRAV").Value) = "fyzick|fffd| osoba |fffd| podnikatel" Then
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_FOO").Row).EntireRow.Hidden = True
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_F").Row).EntireRow.Hidden = True
          ActiveSheet.Range("PD_FOP").Value = "Obchodn|fffd| firma* / jm|fffd|no a p|fffd||fffd|jmen|fffd|**"
        
        ElseIf LCase(Range("PD_PRAV").Value) = "pr|fffd|vnick|fffd| osoba" Then
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PD_FOO").Row).EntireRow.Hidden = True
            ActiveSheet.Range("PD_FOP").Value = "Obchodn|fffd| firma* / n|fffd|zev**"
        End If
      
      Case Range("PD_KB_P_J_1").Address
        Call Podpisovka("KB_P_J_1", Target.Value)
      
      Case Range("PD_KB_P_F_1").Address
        Call Podpisovka("KB_P_F_1", Target.Value)
      
      Case Range("PD_KB_P_D_1").Address
        Call Podpisovka("KB_P_D_1", Target.Value)
    End Select
    
    

err_hanlder:
  Call zamek(sSh, True)
  Sheets(sNeSh).Activate
  Application.ScreenUpdating = True
  Application.EnableEvents = True

End Sub





Attribute VB_Name = "List20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdDO_1_A, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_2_A, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_3_A, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_4_A, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_5_A, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdDO_6_A, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_1_A, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_2_A, 8, 7, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_3_A, 9, 8, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_4_A, 10, 9, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_5_A, 11, 10, MSForms, CommandButton"
Attribute VB_Control = "cmdDOo_6_A, 12, 11, MSForms, CommandButton"
Option Explicit

Private Sub cmdDO_1_A_Click()
    Call radekAdd("DO_1_A")
End Sub
Private Sub cmdDO_2_A_Click()
    Call radekAdd("DO_2_A")
End Sub
Private Sub cmdDO_3_A_Click()
    Call radekAdd("DO_3_A")
End Sub
Private Sub cmdDO_4_A_Click()
    Call radekAdd("DO_4_A")
End Sub
Private Sub cmdDO_5_A_Click()
    Call radekAdd("DO_5_A")
End Sub
Private Sub cmdDO_6_A_Click()
    Call radekAdd("DO_6_A")
End Sub

Private Sub cmdDOO_1_A_Click()
    Call radekRemove("DO_1", "_A")
End Sub
Private Sub cmdDOO_2_A_Click()
    Call radekRemove("DO_2", "_A")
End Sub
Private Sub cmdDOO_3_A_Click()
    Call radekRemove("DO_3", "_A")
End Sub
Private Sub cmdDOO_4_A_Click()
    Call radekRemove("DO_4", "_A")
End Sub
Private Sub cmdDOO_5_A_Click()
    Call radekRemove("DO_5", "_A")
End Sub
Private Sub cmdDOO_6_A_Click()
    Call radekRemove("DO_6", "_A")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name

  If Not ActiveSheet.ProtectContents Then Exit Sub
  
  On Error GoTo err_handler
  
  
  Application.EnableEvents = False
  Application.ScreenUpdating = False
  
  iMin = 18.75
  Set newR = Selection
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 Then
   bScreen = False
   Call zamek(c_Dodavatel_A)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(c_Dodavatel_A, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If

     On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler

  End If
  
    
    Select Case Target.Address
      Case Range("DO_FIRMA_A").Address
        Call vyskaRadku(c_Dodavatel_A, "DO_FIRMA_A", 20.25)
        Call hlavicka("DO_FIRMA_A", Range("DO_FIRMA_A").Value, Range("DO_FIRMA_A").RowHeight)
        Sheets(c_Dodavatel_A).Select
      Case Range("DO_ICO_A").Address
        If InStr(1, LCase(Range("DO_ICO_A").Value), "id no.:") = 0 Then
          Range("DO_ICO_A").Value = "ID No.: " & Range("DO_ICO_A").Value
        End If
        Call hlavicka("DO_ICO_A", Range("DO_ICO_A").Value, Range("DO_ICO_A").RowHeight)
        Sheets(c_Dodavatel_A).Select
    End Select
    
    
    

err_handler:
    Sheets(sNeSh).Activate
    Call zamek(c_Dodavatel_A, True)
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
End Sub

Attribute VB_Name = "List21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdRIo_4_A, 8, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_3_A, 7, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_2_A, 6, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdRIo_1_A, 5, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_4_A, 4, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_3_A, 3, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_2_A, 2, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdRI_1_A, 1, 7, MSForms, CommandButton"
Option Explicit
Private Sub cmdRI_1_A_Click()
    Call radekAdd("RI_1_A")
End Sub
Private Sub cmdRI_2_A_Click()
    Call radekAdd("RI_2_A")
End Sub
Private Sub cmdRI_3_A_Click()
    Call radekAdd("RI_3_A")
End Sub
Private Sub cmdRI_4_A_Click()
    Call radekAdd("RI_4_A")
End Sub

Private Sub cmdRIo_1_A_Click()
    Call radekRemove("RI_1", "_A")
End Sub
Private Sub cmdRIo_2_A_Click()
    Call radekRemove("RI_2", "_A")
End Sub
Private Sub cmdRIo_3_A_Click()
    Call radekRemove("RI_3", "_A")
End Sub
Private Sub cmdRIo_4_A_Click()
    Call radekRemove("RI_4", "_A")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
    
  sSh = getsSH
  sNeSh = ActiveSheet.Name

  If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_handler


  Application.EnableEvents = False
  Application.ScreenUpdating = False
  iMin = 15

  Set newR = Selection
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
   bScreen = False
   Call zamek(c_Rozbor_A)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(c_Rozbor_A, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If

    On Error Resume Next
      newR.Select
    On Error GoTo 0
    On Error GoTo err_handler
  End If
  Select Case Target.Address
    Case Range("RI_soucet_1_1_A").Address, Range("RI_soucet_1_2_A").Address
      Call RI_kontrola(1, c_Rozbor_A, "_A")
    Case Range("RI_soucet_1_3_A").Address
      Call RI_kontrola(3, c_Rozbor_A, "_A")
    Case Range("RI_soucet_2_2_A").Address, Range("RI_soucet_2_3_A").Address, Range("RI_soucet_2_4_A").Address, Range("RI_soucet_2_5_A").Address
      Call RI_kontrola(2, c_Rozbor_A, "_A")
    Case Range("RI_soucet_3_1_A").Address, Range("RI_soucet_3_2_A").Address
      Call RI_kontrola(4, c_Rozbor_A, "_A")
    Case Range("RI_soucet_3_3_A").Address
      Call RI_kontrola(6, c_Rozbor_A, "_A")
    Case Range("RI_soucet_4_2_A").Address, Range("RI_soucet_4_3_A").Address, Range("RI_soucet_4_4_A").Address, Range("RI_soucet_4_5_A").Address
      Call RI_kontrola(5, c_Rozbor_A, "_A")
    Case Range("RP_FIRMA_A").Address
        Call vyskaRadku(c_Rozbor_A, "RP_FIRMA_A", 20.25)
        Call hlavicka("RP_FIRMA_A", Range("RP_FIRMA_A").Value, Range("RP_FIRMA_A").RowHeight)
        Sheets(c_Rozbor_A).Select
      Case Range("RP_ICO_A").Address
        If InStr(1, LCase(Range("RP_ICO_A").Value), "id nr.:") = 0 Then
          Range("RP_ICO_A").Value = "ID No.: " & Range("RP_ICO_A").Value
        End If
        Call hlavicka("RP_ICO", Range("RP_ICO_A").Value, Range("RP_ICO_A").RowHeight)
        Sheets(c_Rozbor_A).Select
  End Select
  

err_handler:
  Sheets(sNeSh).Activate
  Call zamek(c_Rozbor_A, True)
  Application.ScreenUpdating = True
  Application.EnableEvents = True
    
  
End Sub


Attribute VB_Name = "List22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdOUo_8_A, 16, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_6_A, 15, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_5_A, 14, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_4_A, 13, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_3_A, 12, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_2_A, 11, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_1_A, 10, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdOUo_7_A, 9, 7, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_8_A, 8, 8, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_6_A, 7, 9, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_5_A, 6, 10, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_4_A, 5, 11, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_3_A, 4, 12, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_2_A, 3, 13, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_1_A, 2, 14, MSForms, CommandButton"
Attribute VB_Control = "cmdOU_7_A, 1, 15, MSForms, CommandButton"
Option Explicit
Private Sub cmdOU_1_A_Click()
    Call radekAdd("OU_1_A")
End Sub
Private Sub cmdOU_2_A_Click()
    Call radekAdd("OU_2_A")
End Sub

Private Sub cmdOU_3_A_Click()
    Call radekAdd("OU_3_A")
End Sub

Private Sub cmdOU_4_A_Click()
    Call radekAdd("OU_4_A")
End Sub

Private Sub cmdOU_5_A_Click()
    Call radekAdd("OU_5_A")
End Sub

Private Sub cmdOU_6_A_Click()
    Call radekAdd("OU_6_A")
End Sub

Private Sub cmdOU_7_A_Click()
    Call radekAdd("OU_7_A")
End Sub

Private Sub cmdOU_8_A_Click()
    Call radekAdd("OU_8_A")
End Sub

Private Sub cmdOUo_1_A_Click()
    Call radekRemove("OU_1", "_A")
End Sub

Private Sub cmdOUo_2_A_Click()
    Call radekRemove("OU_2", "_A")
End Sub

Private Sub cmdOUo_3_A_Click()
    Call radekRemove("OU_3", "_A")
End Sub

Private Sub cmdOUo_4_A_Click()
    Call radekRemove("OU_4", "_A")
End Sub

Private Sub cmdOUo_5_A_Click()
    Call radekRemove("OU_5", "_A")
End Sub

Private Sub cmdOUo_6_A_Click()
    Call radekRemove("OU_6", "_A")
End Sub

Private Sub cmdOUo_7_A_Click()
    Call radekRemove("OU_7", "_A")
End Sub

Private Sub cmdOUo_8_A_Click()
    Call radekRemove("OU_8", "_A")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
  On Error GoTo err_handler
  
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False

     bScreen = False
     Call zamek(c_Ostatni_A)
     
    If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 Then
     iMin = 15
     Set newR = Selection
     
     iAkt = Target.Rows.Height
     iNew = iMin
     iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
      For i = 2 To iLastCol
        If Cells(Target.Row, i).Value <> "" Then
          Call vyskaRadku(c_Ostatni_A, Cells(Target.Row, i).Address, iMin)
          If Target.Rows.Height > iNew Then
            iNew = Target.Rows.Height
          End If
        End If
      Next i
      If iNew > iMin Then
        Target.RowHeight = iNew
      Else
        Target.RowHeight = iMin
      End If

      On Error Resume Next
        newR.Select
      On Error GoTo 0
      On Error GoTo err_handler
    End If
    
    Select Case Target.Address
      Case Range("OD_FIRMA_A").Address
        Call vyskaRadku(c_Ostatni_A, "OD_FIRMA_A", 20.25)
        Call hlavicka("OD_FIRMA_A", Range("OD_FIRMA_A").Value, Range("OD_FIRMA_A").RowHeight)
        Sheets(c_Ostatni_A).Select
      Case Range("OD_ICO_A").Address
        If InStr(1, LCase(Range("OD_ICO_A").Value), "id no.:") = 0 Then
          Range("OD_ICO_A").Value = "ID No.: " & Range("OD_ICO_A").Value
        End If
        Call hlavicka("OD_ICO", Range("OD_ICO_A").Value, Range("OD_ICO_A").RowHeight)
        Sheets(c_Ostatni_A).Select
    End Select
    
    
err_handler:
    Sheets(sNeSh).Activate
    Call zamek(c_Ostatni_A, True)
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub


Attribute VB_Name = "List3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdPA_1, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdPA_2, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdPA_3, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdPA_4, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "cmdPAo_1, 5, 4, MSForms, CommandButton"
Attribute VB_Control = "cmdPAo_2, 6, 5, MSForms, CommandButton"
Attribute VB_Control = "cmdPAo_3, 7, 6, MSForms, CommandButton"
Attribute VB_Control = "cmdPAo_4, 8, 7, MSForms, CommandButton"
Option Explicit
Private Sub cmdPA_1_Click()
    Call radekAdd("PA_1")
End Sub
Private Sub cmdPA_2_Click()
    Call radekAdd("PA_2")
End Sub
Private Sub cmdPA_3_Click()
    Call radekAdd("PA_3")
End Sub
Private Sub cmdPA_4_Click()
    Call radekAdd("PA_4")
End Sub

Private Sub cmdPAo_1_Click()
    Call radekRemove("PA_1")
End Sub

Private Sub cmdPAo_2_Click()
    Call radekRemove("PA_2")
End Sub


Private Sub cmdPAo_3_Click()
    Call radekRemove("PA_3")
End Sub


Private Sub cmdPAo_4_Click()
    Call radekRemove("PA_4")
End Sub



Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
    
  If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 And ActiveSheet.ProtectContents Then
   
    On Error GoTo err_hanlder
    
    iMin = 18.75
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    Set newR = Selection
    Sheets(sSh).Activate
  
   Call zamek(ActiveSheet.Name)
   iAkt = Target.Rows.Height
   iNew = iMin
   iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(Target.Row, i).Value <> "" Then
        Call vyskaRadku(ActiveSheet.Name, Cells(Target.Row, i).Address, iMin)
        If Target.Rows.Height > iNew Then
          iNew = Target.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      Target.RowHeight = iNew
    Else
      Target.RowHeight = iMin
    End If
    
    Select Case Target.Address
      Case Range("PA_PRAV").Address
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_FOO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_FOP").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_PO").Row).EntireRow.Hidden = False
        Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_F").Row).EntireRow.Hidden = False
        If LCase(Range("PA_PRAV").Value) = "fyzick|fffd| osoba" Then
             Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_FOP").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_PO").Row).EntireRow.Hidden = True
            Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_F").Row).EntireRow.Hidden = True
            
        ElseIf LCase(Range("PA_PRAV").Value) = "fyzick|fffd| osoba |fffd| podnikatel" Then
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_FOO").Row).EntireRow.Hidden = True
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_F").Row).EntireRow.Hidden = True
          ActiveSheet.Range("PA_FOP").Value = "Obchodn|fffd| firma* / jm|fffd|no a p|fffd||fffd|jmen|fffd|**"
        ElseIf LCase(Range("PA_PRAV").Value) = "pr|fffd|vnick|fffd| osoba" Then
          Sheets(ActiveSheet.Name).Rows(Sheets(ActiveSheet.Name).Range("PA_FOO").Row).EntireRow.Hidden = True
          ActiveSheet.Range("PA_FOP").Value = "Obchodn|fffd| firma* / n|fffd|zev**"
        End If
      
      Case Range("PA_KB_P_J_1").Address
        Call Podpisovka("KB_P_J_1", Target.Value)
      Case Range("PA_KB_P_F_1").Address
        Call Podpisovka("KB_P_F_1", Target.Value)
      Case Range("PA_KB_P_D_1").Address
        Call Podpisovka("KB_P_D_1", Target.Value)
    
    End Select


  End If
  
  
    On Error Resume Next
      newR.Select
    On Error GoTo 0
    
err_hanlder:
    Call zamek(ActiveSheet.Name, True)
    Sheets(sNeSh).Activate
    Application.ScreenUpdating = True
    Application.EnableEvents = True
End Sub



Attribute VB_Name = "List32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "List4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmdPZ_1, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "cmdPZo_1, 3, 1, MSForms, CommandButton"
Attribute VB_Control = "cmdPZ_2, 4, 2, MSForms, CommandButton"
Attribute VB_Control = "cmdPZo_2, 5, 3, MSForms, CommandButton"
Private Sub cmdPZ_1_Click()
  Call radekAdd("PZ_1")
End Sub


Private Sub cmdPZo_1_Click()
    Call radekRemove("PZ_1")
End Sub

Private Sub cmdPZ_2_Click()
  Call radekAdd("PZ_2")
End Sub


Private Sub cmdPZo_2_Click()
    Call radekRemove("PZ_2")
End Sub
Attribute VB_Name = "List6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmsVZo_1, 12, 1, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_1, 2, 2, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_2, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_3, 6, 4, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_4, 10, 5, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_5, 11, 6, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_2, 13, 7, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_3, 14, 8, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_4, 15, 9, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_5, 16, 10, MSForms, CommandButton"
Option Explicit
Private Sub cmsVZ_1_Click()
    Call radekAdd("VZ_1")
End Sub
Private Sub cmsVZ_2_Click()
    Call radekAdd("VZ_2")
End Sub
Private Sub cmsVZ_3_Click()
    Call radekAdd("VZ_3")
End Sub
Private Sub cmsVZ_4_Click()
    Call radekAdd("VZ_4")
End Sub


Private Sub cmsVZ_5_Click()
  Call radekAdd("VZ_5")
End Sub


Private Sub cmsVZo_1_Click()
    Call radekRemove("VZ_1")
End Sub

Private Sub cmsVZo_2_Click()
    Call radekRemove("VZ_2")
End Sub

Private Sub cmsVZo_3_Click()
    Call radekRemove("VZ_3")
End Sub

Private Sub cmsVZo_4_Click()
    Call radekRemove("VZ_4")
End Sub

Private Sub cmsVZo_5_Click()
    Call radekRemove("VZ_5")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
    
    On Error GoTo err_hanlder
    
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    
     Call zamek(c_Vlast)
     
     
    If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 Then
      iMin = 15
      Set newR = Selection
      
      iAkt = Target.Rows.Height
      iNew = iMin
      iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
      For i = 2 To iLastCol
        If Cells(Target.Row, i).Value <> "" Then
          Call vyskaRadku(c_Vlast, Cells(Target.Row, i).Address, iMin)
          If Target.Rows.Height > iNew Then
            iNew = Target.Rows.Height
          End If
        End If
      Next i
       
      If iNew > iMin Then
        Target.RowHeight = iNew
      Else
        Target.RowHeight = iMin
      End If
       
      On Error Resume Next
        newR.Select
      On Error GoTo 0
      On Error GoTo err_hanlder
    End If
    
    
    Select Case Target.Address
      Case Range("VZ_FIRMA").Address
          Call vyskaRadku(c_Vlast, "VZ_FIRMA", 20.25)
          Call hlavicka("VZ_FIRMA", Range("VZ_FIRMA").Value, Range("VZ_FIRMA").RowHeight)
          Sheets(c_Vlast).Select
          
      Case Range("VZ_ICO").Address
          If InStr(1, LCase(Range("VZ_ICO").Value), "i|fffd|o") = 0 Then
            Range("VZ_ICO").Value = "I|fffd|O: " & Range("VZ_ICO").Value
          End If
          
          Call hlavicka("VZ_ICO", Range("VZ_ICO").Value, Range("VZ_ICO").RowHeight)
          Sheets(c_Vlast).Select
    End Select
    
    
err_hanlder:
  Call zamek(c_Vlast, True)
  Sheets(sNeSh).Activate
  Application.ScreenUpdating = True
  Application.EnableEvents = True
    
End Sub


Attribute VB_Name = "List7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "cmsVZo_5_A, 10, 0, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_4_A, 9, 1, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_3_A, 8, 2, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_2_A, 7, 3, MSForms, CommandButton"
Attribute VB_Control = "cmsVZo_1_A, 6, 4, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_5_A, 5, 5, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_4_A, 4, 6, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_3_A, 3, 7, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_2_A, 2, 8, MSForms, CommandButton"
Attribute VB_Control = "cmsVZ_1_A, 1, 9, MSForms, CommandButton"
Option Explicit
Private Sub cmsVZ_1_A_Click()
    Call radekAdd("VZ_1_A")
End Sub
Private Sub cmsVZ_2_A_Click()
    Call radekAdd("VZ_2_A")
End Sub
Private Sub cmsVZ_3_A_Click()
    Call radekAdd("VZ_3_A")
End Sub
Private Sub cmsVZ_4_A_Click()
    Call radekAdd("VZ_4_A")
End Sub


Private Sub cmsVZ_5_A_Click()
  Call radekAdd("VZ_5_A")
End Sub


Private Sub cmsVZo_1_A_Click()
    Call radekRemove("VZ_1", "_A")
End Sub

Private Sub cmsVZo_2_A_Click()
    Call radekRemove("VZ_2", "_A")
End Sub

Private Sub cmsVZo_3_A_Click()
    Call radekRemove("VZ_3", "_A")
End Sub

Private Sub cmsVZo_4_A_Click()
    Call radekRemove("VZ_4", "_A")
End Sub

Private Sub cmsVZo_5_A_Click()
    Call radekRemove("VZ_5", "_A")
End Sub

Private Sub Worksheet_Change(ByVal Target As Range)
  Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim i As Integer
  Dim sSh As String
  Dim sNeSh As String
  
  sSh = getsSH
  sNeSh = ActiveSheet.Name
  
  If Not ActiveSheet.ProtectContents Then Exit Sub
    
    On Error GoTo err_hanlder
    
    
    Application.EnableEvents = False
    Application.ScreenUpdating = False
    
     Call zamek(c_Vlast_A)
     
    If Target.Text <> "" And Target.Columns.Count = 1 And Target.Rows.Count = 1 Then
      iMin = 15
      Set newR = Selection
      
      iAkt = Target.Rows.Height
      iNew = iMin
      iLastCol = Cells(Target.Row, Columns.Count).End(xlToLeft).Column
      For i = 2 To iLastCol
        If Cells(Target.Row, i).Value <> "" Then
          Call vyskaRadku(c_Vlast_A, Cells(Target.Row, i).Address, iMin)
          If Target.Rows.Height > iNew Then
            iNew = Target.Rows.Height
          End If
        End If
      Next i
       
      If iNew > iMin Then
        Target.RowHeight = iNew
      Else
        Target.RowHeight = iMin
      End If
       
      On Error Resume Next
        newR.Select
      On Error GoTo 0
      On Error GoTo err_hanlder
    End If
    
    
    Select Case Target.Address
      Case Range("VZ_FIRMA_A").Address
          Call vyskaRadku(c_Vlast_A, "VZ_FIRMA_A", 20.25)
          Call hlavicka("VZ_FIRMA_A", Range("VZ_FIRMA_A").Value, Range("VZ_FIRMA_A").RowHeight)
          Sheets(c_Vlast_A).Select
          
      Case Range("VZ_ICO_A").Address
          If InStr(1, LCase(Range("VZ_ICO_A").Value), "ID N.:") = 0 Then
            Range("VZ_ICO_A").Value = "ID N.: " & Range("VZ_ICO_A").Value
          End If
          
          Call hlavicka("VZ_ICO_A", Range("VZ_ICO_A").Value, Range("VZ_ICO_A").RowHeight)
          Sheets(c_Vlast_A).Select
    End Select
    
    
err_hanlder:
  Call zamek(c_Vlast_A, True)
  Sheets(sNeSh).Activate
  Application.ScreenUpdating = True
  Application.EnableEvents = True
    
End Sub



Attribute VB_Name = "Module1"
Sub Makro1()
Attribute Makro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Makro1 Makro
'

'
    ActiveWindow.SmallScroll Down:=39
    Range("C50:AE50").Select
    ActiveWindow.SelectedSheets.HPageBreaks.add Before:=ActiveCell
    ActiveSheet.HPageBreaks(1).Delete
End Sub
Attribute VB_Name = "Module2"


Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True



Private Sub Workbook_BeforeClose(Cancel As Boolean)
'  Dim sAkt As String
'  sAkt = ActiveSheet.Name
  Call ZamekAll(True)
'  Call zamek(sAkt, True)
End Sub

Private Sub Workbook_BeforeSave(ByVal SaveAsUI As Boolean, Cancel As Boolean)
  If ActiveWorkbook.Path = "" And Range("POM_SAVE") = "F" Then
    Range("POM_SAVE") = "T"
    Set fldr = Application.FileDialog(msoFileDialogSaveAs)
    With fldr
        .FilterIndex = 2
        MsgBox "Se|fffd|it ulo|fffd|te jako " & Chr(34) & "Se|fffd|it Excelu s podporou maker (*.xlsm)" & Chr(34), vbInformation, POPIS_MSG
        If .Show Then
          sName = .SelectedItems(1)
          sForma = Split(sName, ".")(UBound(Split(sName, ".")))
          If LCase(sForma) <> "xlsm" Then
            sName = Left(sName, Len(sName) - Len(sForma)) + "xlsm"
          End If
'            Range("POM_SAVE") = "F"
            ActiveWorkbook.SaveAs sName, FileFormat:=xlOpenXMLWorkbookMacroEnabled
            Cancel = True
            
            Exit Sub
        Else
          Cancel = True
          Range("POM_SAVE") = "F"
          Exit Sub
        End If
'    sItem = .SelectedItems(1)
    End With
'    b_Save = True
'    MsgBox "Se|fffd|it ulo|fffd|te jako " & Chr(34) & "Se|fffd|it Excelu s podporou maker (*.xlsm)" & Chr(34), vbInformation, POPIS_MSG
  End If
End Sub

Private Sub Workbook_Open()
  
  On Error GoTo err_handler
    If ActiveWorkbook.FileFormat <> 53 And Sheets(c_POM).Range("POM_MAKRA").Value = "T" Then
        Range("POM_SAVE") = "F"
        Sheets(c_POM).Range("POM_MAKRA").Value = "F"
         Call ZamekAll
         Select Case Range("POM_AKT_NAZEV_EXL").Value
            Case "DOPLUDJU"
  '           |fffd||fffd|DN|fffd| Dialog
                Range("DE_FIRMA").Value = "Klient: "
                Range("DE_ICO").Value = "I|fffd|O: "
            Case "BALPOD"
              Sheets(c_UVOD).Activate
              frm_D1_BALPOD.Show
            Case "PROVLMAZ"
              frm_D1_PROVLMAZ.Show
            Case "PODKRNAV"
              frm_D1_PODKRNAV.Show
            Case "POHZADOV"
              frm_D1_POHZADOV.Show
          End Select
'  !!! NEZAPOMENOUT ZM|fffd|NIT Z|fffd|PAT|fffd| - POJMENOV|fffd|N|fffd| !!!
    End If
  On Error GoTo 0
err_handler:
  Call ZamekAll(True)
  Range("POM_AKT_SHT").Value = ActiveSheet.Name
  Application.ScreenUpdating = True
  Application.DisplayAlerts = True
  Application.EnableEvents = True
End Sub

Private Sub Workbook_SheetActivate(ByVal Sh As Object)
  Range("POM_AKT_SHT").Value = Sh.Name
End Sub
Attribute VB_Name = "frmCU"
Attribute VB_Base = "0{EEFA49CD-6615-40CA-8DE7-3CC014D8155A}{59B49477-5979-4426-8393-460CF8ADA56B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
  If isCU2(txtCU) Then
    Me.Hide
  Else
    MsgBox "|fffd||fffd|slo |fffd||fffd|tu st|fffd|le obsahuje nepovolen|fffd| znak.", vbInformation, "|fffd||fffd|slo |fffd||fffd|tu"
  End If
End Sub

Private Function isCU2(sText As String) As Boolean
  Dim sCU As String
  If sText <> "" Then
    sText = Replace(sText, Chr(96), "")
    sText = Replace(sText, Chr(97), "")

    isCU2 = IsNumeric(Replace(sText, "-", "", , 1))

  Else
    isCU2 = True
  End If
End Function
Attribute VB_Name = "frm_D1_BALPOD"
Attribute VB_Base = "0{7BC7CC0E-07F4-49AA-B544-125448FEAEDA}{45CD4FBC-7983-4462-90B6-CDBC2B209A14}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub cmdOk_Click()
    Dim sForma As String
    Const c_bonita_t As String = "dotazn|fffd|k pro vyhodnocen|fffd| bonity;"
    Const c_DE_t As String = "dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci;"
    Dim sSeznam As String
    Sheets(c_UVOD).Select
'    sSeznam = "vlastnick|fffd| vztahy, majetkov|fffd| pod|fffd|ly; rozbor dodavatelsko-odb|fffd|ratelsk|fffd|ch vztah|fffd|; rozbor pohled|fffd|vek a z|fffd|vazk|fffd|, finan|fffd|n|fffd| z|fffd|vazky, investice; ostatn|fffd| dopl|fffd|uj|fffd|c|fffd| |fffd|daje; dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci; prohl|fffd|en|fffd| o vlastnictv|fffd| majetku a z|fffd|vazc|fffd|ch;"
    ' ppvinn|fffd| pole
   
    Application.ScreenUpdating = False
    Call ZamekAll
    If optBalRO Or optKNzm Then
      Call dellRange(c_UVOD, "S_RO_1")
    ElseIf optKNzm Then
    
    Else
      Call dellRange(c_Ostatni, "ODU_RO")
      Sheets(c_Vlast).Shapes("S_RO_2").Delete
    End If
    ' maz|fffd|n|fffd| bu|fffd||fffd|k a list|fffd|
    If optPO Then
        Range("POM_TYP_KLIENT").Value = "PO"
        sForma = "PO"
        

        
        Call dellRange(c_UVER, "cbo_uver_FOP_b")
'        Sheets(c_UVER).Shapes("cbo_uver_FOP").Delete
        
         Call dellRange(c_ZARUKA, "cbo_zaruka_FOP_b")

         
         Call dellRange(c_PRISLIB, "cbo_prislib_FOP_b")

         
         Call dellRange(c_CELNI, "cbo_celni_FOP_b")
         
'         Call dellRange(c_UVER, "UVER_KLIENT")
'         Call dellRange(c_PRISLIB, "PRISLIB_KLIENT")
'         Call dellRange(c_ZARUKA, "ZARUKA_KLIENT")
'         Call dellRange(c_CELNI, "CELNI_KLIENT")
'         Call dellRange(c_UVOD, "UVOD_KLIENT")
 
    ElseIf optFOP Then
        sForma = "FOP"
        Range("POM_TYP_KLIENT").Value = "FOP"
    Else
    End If
    
    If optDE Then
        Call dellRange(c_UVOD, "V_UCET_1")
    Else
        Call dellRange(c_UVOD, "V_DE_1")
        frm_D3.chbOstatni8.Visible = False
    End If
    

    
'    Range("POM_MAKRO").Value = False
    Application.DisplayAlerts = True
    Range("UVOD_SEZNAM").Value = sSeznam
    Me.Hide
    frm_D3.Show

    On Error Resume Next
      Sheets(1).Activate
      Unload frm_D1_BALPOD
      Unload frm_D1_PROVLMAZ
      Unload frm_D1_PODKRNAV
      Unload frm_D2
      Unload frm_D3
      Unload frm_Podpisy2
    On Error GoTo 0
'
'
'    Sheets(c_UVOD).Select
'    Sheets(c_UVOD).Range("UVOD_jmeno_T").Select
    
    
  
End Sub




Private Sub optFOP_Click()
    optDE.Enabled = True
    optDE.Value = True
    frm_D2.lblOSOBA1.Caption = "Obchodn|fffd| firma*/jm|fffd|no a p|fffd||fffd|jmen|fffd|**"
End Sub

Private Sub optPO_Click()
    optDE.Enabled = False
    optUcet.Value = True
    frm_D2.lblOSOBA1.Caption = "Obchodn|fffd| firma*/n|fffd|zev**"
End Sub

Public Sub Test()
    frm_D1_BALPOD.Show
End Sub

Private Sub UserForm_Initialize()
'    zamek (c_POM)
'    Range("pom_zamek").Value = "F"
'    bScreen = False
    Call optPO_Click
'    Call zamek(c_UVOD)
'    Call zamek(c_UVER)
'    Call zamek(c_ZARUKA)
'    Call zamek(c_PRISLIB)
'    Call zamek(c_CELNI)
'    Call zamek(c_BONITA)
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
'  If CloseMode <> 1 Then
'    Cancel = 1
'    MsgBox "Pro ukon|fffd|en|fffd| pou|fffd|ijte tla|fffd||fffd|tko OK", vbInformation, POPIS_MSG
' End If
End Sub
Attribute VB_Name = "frm_D1_PODKRNAV"
Attribute VB_Base = "0{6C752763-DDC8-4412-93B1-057DCF550EED}{E066B2BE-E441-4868-8FFA-C131C4D754F1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Option Explicit
Private Sub cmdOk_Click()
  Dim text1 As String
   
    Application.ScreenUpdating = False
    Call ZamekAll
    If txtNazev = Empty Or txtIC = Empty Then
    MsgBox "N|fffd|zev klienta i I|fffd|O jsou povinn|fffd| |fffd|daje!"
    Exit Sub
End If
If chkPril1 = False And chkPril2 = False And chkPril3 = False And chkPril4 = False Then
    MsgBox "Vyberte alespo|fffd| 1 p|fffd||fffd|lohu!"
    Exit Sub
End If


Application.DisplayAlerts = False
If optCZ Then ' CZ
  If chkPril4 = True Then
      Sheets(c_Rozbor).Range("RP_Firma").Value = txtNazev
      Sheets(c_Rozbor).Range("RP_ICO").Value = "I|fffd|O: " & txtIC
  Else
      Sheets(c_Rozbor).Delete
  End If
  
  If chkPril3 = True Then
      Sheets(c_Ostatni).Range("OD_Firma").Value = txtNazev
      Sheets(c_Ostatni).Range("OD_ICO").Value = "I|fffd|O: " & txtIC
  Else
      Sheets(c_Ostatni).Delete
  End If
  
  If chkPril2 = True Then
      Sheets(c_Dodavatel).Range("DO_Firma").Value = txtNazev
      Sheets(c_Dodavatel).Range("DO_ICO").Value = "I|fffd|O: " & txtIC
  Else
      Sheets(c_Dodavatel).Delete
  End If
  
  
  If chkPril1 = True Then
      Sheets(c_Vlast).Range("VZ_Firma").Value = txtNazev
      Sheets(c_Vlast).Range("VZ_ICO").Value = "I|fffd|O: " & txtIC
  Else
      Sheets(c_Vlast).Delete
  End If
  
  Sheets(c_Vlast_A).Delete
  Sheets(c_Dodavatel_A).Delete
  Sheets(c_Ostatni_A).Delete
  Sheets(c_Rozbor_A).Delete

Else ' EN
  If chkPril4 = True Then
      Sheets(c_Rozbor_A).Range("RP_Firma_A").Value = txtNazev
      Sheets(c_Rozbor_A).Range("RP_ICO_A").Value = "ID No.: " & txtIC
  Else
      Sheets(c_Rozbor_A).Delete
  End If
  
  If chkPril3 = True Then
      Sheets(c_Ostatni_A).Range("OD_Firma_A").Value = txtNazev
      Sheets(c_Ostatni_A).Range("OD_ICO_A").Value = "ID No.: " & txtIC
  Else
      Sheets(c_Ostatni_A).Delete
  End If
  
  If chkPril2 = True Then
      Sheets(c_Dodavatel_A).Range("DO_Firma_A").Value = txtNazev
      Sheets(c_Dodavatel_A).Range("DO_ICO_A").Value = "ID No.: " & txtIC
  Else
      Sheets(c_Dodavatel_A).Delete
  End If
  
  
  If chkPril1 = True Then
      Sheets(c_Vlast_A).Range("VZ_Firma_A").Value = txtNazev
      Sheets(c_Vlast_A).Range("VZ_ICO_A").Value = "ID No.: " & txtIC
  Else
      Sheets(c_Vlast_A).Delete
  End If
  Sheets(c_Vlast).Delete
  Sheets(c_Dodavatel).Delete
  Sheets(c_Ostatni).Delete
  Sheets(c_Rozbor).Delete

End If
  Range("POM_MAKRA").Value = "F"

Application.DisplayAlerts = True
    Unload Me
    

    Call ZamekAll(True)
    ActiveWorkbook.Protect Structure:=True, Windows:=False, Password:="simplebl"
    Application.ScreenUpdating = True
  
End Sub

Private Sub cmdUzavrit_Click()
  Unload Me
  ActiveWorkbook.Close savechanges:=False
End Sub
Attribute VB_Name = "frm_D1_POHZADOV"
Attribute VB_Base = "0{F84F381A-41C0-4232-84E1-B5E388F2E7E5}{C44FC606-4EA5-48FF-84FB-29D3084AFBCE}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub cmdOk_Click()
    Application.ScreenUpdating = False
'    Call ZamekAll
    Application.DisplayAlerts = False
    If optCZ Then
      ActiveWorkbook.Sheets(c_Dodavatel_A).Delete
      Range("DO_ICO").Value = "I|fffd|O: "
      Range("DO_Firma").Value = "Klient: "
    Else
    
      ActiveWorkbook.Sheets(c_Dodavatel).Delete
      Range("DO_ICO_A").Value = "ID No.: "
      Range("DO_Firma_A").Value = "Client: "
    End If
    
    Application.DisplayAlerts = True
    Unload Me
End Sub
Attribute VB_Name = "frm_D1_PROVLMAZ"
Attribute VB_Base = "0{6620CA93-744D-4952-901C-9437C6F6FC9F}{3AAC04B7-2B3C-4AA3-9D38-140CF5E4FD8B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Option Explicit
Private Sub cmdOk_Click()
   
    Application.ScreenUpdating = False
'    Call ZamekAll
    If Not chbDluznik And Not chbAvalista Then
        MsgBox "Mus|fffd|te vybrat aspo|fffd| jednu variantu.", vbInformation
        Exit Sub
    End If
    Application.DisplayAlerts = False
    If optCZ Then
      ActiveWorkbook.Sheets(c_DLUZNIK_EN).Delete
      ActiveWorkbook.Sheets(c_AVAL_EN).Delete
      If Not chbDluznik Then
          ActiveWorkbook.Sheets(c_DLUZNIK).Delete
      End If
      
      If Not chbAvalista Then
          ActiveWorkbook.Sheets(c_AVAL).Delete
      End If
    Else
    
      ActiveWorkbook.Sheets(c_DLUZNIK).Delete
      ActiveWorkbook.Sheets(c_AVAL).Delete
      If Not chbDluznik Then
          ActiveWorkbook.Sheets(c_DLUZNIK_EN).Delete
      Else
        ActiveWorkbook.Sheets(c_DLUZNIK_EN).Name = c_DLUZNIK
      End If
      
      If Not chbAvalista Then
          ActiveWorkbook.Sheets(c_AVAL_EN).Delete
      Else
        ActiveWorkbook.Sheets(c_AVAL_EN).Name = c_AVAL
      End If
    End If
    
    Application.DisplayAlerts = True
    Unload Me

    
  
End Sub


Private Sub optCZ_Click()
  Range("POM_JAZYK").Value = "CZ"
End Sub

Private Sub optEn_Click()
  Range("POM_JAZYK").Value = "EN"
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
'  If CloseMode <> 1 Then
'    Cancel = 1
'    MsgBox "Pro ukon|fffd|en|fffd| pou|fffd|ijte tla|fffd||fffd|tko OK", vbInformation, POPIS_MSG
' End If
End Sub
Attribute VB_Name = "frm_D2"
Attribute VB_Base = "0{A2A969D7-3F04-4B0B-B6FA-69654BE0DB2A}{A83D1E74-8213-4154-83F3-6B6F01886FA3}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdOk_Click()
    Dim sShName As String
    Dim sJme As String
    ' uvod
    sShName = c_UVOD
    If sheetExist(sShName) Then
      Sheets(sShName).Select
      Sheets(sShName).Range("UVOD_jmeno").Value = lblOSOBA1.Caption
      Sheets(sShName).Range("UVOD_ICO_T").Value = lblOSOBA2.Caption
      Sheets(sShName).Range("UVOD_sidlo").Value = lblOSOBA3.Caption
      
      Sheets(sShName).Range("UVOD_FIRMA_T").Value = txtOSOBA.Text
      Sheets(sShName).Range("UVOD_ICO_T").Value = txtIco.Text
      Sheets(sShName).Range("UVOD_SIDLO_T").Value = txtSidlo.Text
'      Sheets(sShName).Range("UVOD_tel_T").Value = txtTel.Text
      Sheets(sShName).Range("UVOD_telCislo_T").Value = txtTelCislo.Text
      Sheets(sShName).Range("UVOD_mail_T").Value = txtMail.Text
      
      If frm_D1_BALPOD.optPO Then
        frm_Podpisy2.txtFirma = txtOSOBA.Text
'        Sheets(sShName).Range("UVOD_POD_FRM").Value = txtOSOBA.Text
      Else
        frm_Podpisy2.txtFirma = ""
'        Sheets(sShName).Range("UVOD_POD_FRM").Value = ""
      End If
      If chbDPH Then
        Sheets(sShName).Range("UVOD_DPH").Value = "Ano"
      Else
        Sheets(sShName).Range("UVOD_DPH").Value = "Ne"
      End If
      
    End If
    
    ' |fffd||fffd|dost o |fffd|v|fffd|r
    sShName = c_UVER
    If sheetExist(sShName) Then
      Sheets(sShName).Range("UVER_FIRMA").Value = lblOSOBA1.Caption
      
      Sheets(sShName).Range("UVER_FIRMA_T").Value = txtOSOBA.Text
      Sheets(sShName).Range("UVER_ICO_T").Value = txtIco.Text
      Sheets(sShName).Range("UVER_SIDLO_t").Value = txtSidlo.Text
    End If
    
    ' |fffd||fffd|dost o z|fffd|ruku
    sShName = c_ZARUKA
    If sheetExist(sShName) Then
      Sheets(sShName).Range("ZARUK_FIRMA").Value = lblOSOBA1.Caption
      
      Sheets(sShName).Range("ZARUK_FIRMA_t").Value = txtOSOBA.Text
      Sheets(sShName).Range("ZARUK_ICO_T").Value = txtIco.Text
      Sheets(sShName).Range("ZARUK_SIDLO_T").Value = txtSidlo.Text
    End If
    
    ' p|fffd||fffd|slib o z|fffd|ruku
    sShName = c_PRISLIB
    If sheetExist(sShName) Then
      Sheets(sShName).Range("PRISLIB_FIRMA").Value = lblOSOBA1.Caption
      
      Sheets(sShName).Range("PRISLIB_FIRMA_T").Value = txtOSOBA.Text
      Sheets(sShName).Range("PRISLIB_ICO_T").Value = txtIco.Text
      Sheets(sShName).Range("PRISLIB_SIDLO_T").Value = txtSidlo.Text
    End If
    
    ' |fffd||fffd|dost o celn|fffd| z|fffd|ruku
    sShName = c_CELNI
    If sheetExist(sShName) Then
      Sheets(sShName).Range("CELNI_FIRMA").Value = lblOSOBA1.Caption
      
      Sheets(sShName).Range("CELNI_FIRMA_T").Value = txtOSOBA.Text
      Sheets(sShName).Range("CELNI_ICO_T").Value = txtIco.Text
      Sheets(sShName).Range("CELNI_SIDLO_t").Value = txtSidlo.Text
    End If
    
    If txtOSOBA <> "" Then
      sJme = txtOSOBA.Text
    Else
      sJme = Replace(lblOSOBA1.Caption, "*", "")
    End If
    
    ' vlastnick|fffd| vztahy
    sShName = c_Vlast
    If sheetExist(sShName) Then
      Sheets(sShName).Range("VZ_Firma").Value = sJme
      Sheets(sShName).Range("VZ_ICO").Value = "I|fffd|O: " & txtIco.Text
    End If
    
    ' dodavatelsko-odb vztahy
    sShName = c_Dodavatel
    If sheetExist(sShName) Then
      Sheets(sShName).Range("DO_Firma").Value = sJme
      Sheets(sShName).Range("DO_ICO").Value = "I|fffd|O: " & txtIco.Text
    End If
    
    ' rozbor pohl
    sShName = c_Rozbor
    If sheetExist(sShName) Then
      Sheets(sShName).Range("RP_Firma").Value = sJme
      Sheets(sShName).Range("RP_ICO").Value = "I|fffd|O: " & txtIco.Text
    End If
    
    ' ostatn|fffd| |fffd|daje
    sShName = c_Ostatni
    If sheetExist(sShName) Then
      Sheets(sShName).Range("OD_Firma").Value = sJme
      Sheets(sShName).Range("OD_ICO").Value = "I|fffd|O: " & txtIco.Text
    End If
    
    ' Dopl|fffd|uj|fffd|c|fffd| |fffd|daje DE
    sShName = c_DE
    If sheetExist(sShName) Then
      Sheets(sShName).Range("DE_Firma").Value = sJme
      Sheets(sShName).Range("DE_ICO").Value = "I|fffd|O: " & txtIco.Text
    End If
    
    
    Me.Hide
    frm_Podpisy2.Show
End Sub

'Private Sub txtDat1_AfterUpdate()
'    If txtDat1 <> "" Then
'        If Not IsDate(txtDat1) Then
'            MsgBox lblOSOBA5.Caption & " nen|fffd| datum.", vbInformation, POPIS_MSG
'            txtDat1 = ""
'            txtDat1.SetFocus
'        End If
'    End If
'End Sub




'Private Sub txtDat1_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'    Call txtDat1_AfterUpdate
'End Sub
'
'
'Private Sub txtDat2_AfterUpdate()
'    If txtDat2 <> "" Then
'        If Not IsDate(txtDat2) Then
'            MsgBox lblOSOBA7.Caption & " nen|fffd| datum.", vbInformation, POPIS_MSG
'            txtDat2 = ""
'            txtDat2.SetFocus
'        End If
'    End If
'End Sub
'
'Private Sub txtDat2_Exit(ByVal Cancel As MSForms.ReturnBoolean)
'    Call txtDat2_AfterUpdate
'End Sub


Private Sub txtIco_Change()
    If lblOSOBA2.Caption = "I|fffd|O" Then
        If Not (txtIco = "" Or IsNumeric(txtIco)) Then
            MsgBox "Pole I|fffd|O m|fffd||fffd|e obsahovat pouze |fffd||fffd|slo", vbInformation, POPIS_MSG
            txtIco = ""
        End If
    End If
End Sub



Private Sub UserForm_Activate()
  chbDPH.Visible = Not frm_D1_BALPOD.optInd
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  If CloseMode <> 1 Then
    Cancel = 1
    MsgBox "Pro ukon|fffd|en|fffd| pou|fffd|ijte tla|fffd||fffd|tko OK", vbInformation, POPIS_MSG
 End If
End Sub
Attribute VB_Name = "frm_D3"
Attribute VB_Base = "0{ED5FAC6D-AFEF-4D3B-AA9A-C0FFA6E1777E}{5A335268-1FBF-4314-82B4-24C85C4FAE75}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Private Sub cmdOk_Click()
    Dim sForma As String
    Const c_bonita_t As String = "dotazn|fffd|k pro vyhodnocen|fffd| bonity;"
    Const c_DE_t As String = "dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci;"
    Dim sSeznam As String
    Sheets(c_UVOD).Select
    sSeznam = "Seznam podklad|fffd|: "
'    sSeznam = "vlastnick|fffd| vztahy, majetkov|fffd| pod|fffd|ly; rozbor dodavatelsko-odb|fffd|ratelsk|fffd|ch vztah|fffd|; rozbor pohled|fffd|vek a z|fffd|vazk|fffd|, finan|fffd|n|fffd| z|fffd|vazky, investice; ostatn|fffd| dopl|fffd|uj|fffd|c|fffd| |fffd|daje; dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci; prohl|fffd|en|fffd| o vlastnictv|fffd| majetku a z|fffd|vazc|fffd|ch;"
    ' ppvinn|fffd| pole
    Application.ScreenUpdating = False
    

    
    If frm_D1_BALPOD.optPO Then

        sForma = "PO"
    Else
      sForma = "FOP"
    End If
    
    Me.Hide
    
    If frm_D1_BALPOD.optInd Then
        frm_D2.lblOSOBA4.Visible = False
        
        frm_D2.Label1.Visible = False
        frm_D2.txtTelCislo.Visible = False
        
        frm_D2.Label2.Visible = False
        frm_D2.txtMail.Visible = False
        
        If chbProduckt1 Or chbProduckt2 Or chbProduckt3 Or chbProduckt4 Then
          frm_D2.Show
        ElseIf chbOstatni3 Or chbOstatni2 Then
          frm_Podpisy2.Show
        End If
    Else
      Call dellRange(c_UVER, "ZU_PODPISY")
      Call dellRange(c_ZARUKA, "ZZ_PODPISY")
      Call dellRange(c_PRISLIB, "PZ_PODPISY")
      Call dellRange(c_CELNI, "ZC_PODPISY")
      Call dellRange(c_DE, "DU_PODPISY")
      frm_D2.Show
    End If
    
    
    Application.DisplayAlerts = False
    Call ZamekAll
    ' en verze
    ActiveWorkbook.Sheets(c_DLUZNIK_EN).Visible = xlSheetVeryHidden
    ActiveWorkbook.Sheets(c_AVAL_EN).Visible = xlSheetVeryHidden
    ' =========
    If Not chbProduckt1 Then
        Sheets(c_UVER).Delete
    Else
       Call dellRange(c_UVER, "S_" & sForma & "_1")
       If Not chbCMZRB Then Call dellRange(c_UVER, "UVER_CMZRB")
       If Not cbPGRLF Then Call dellRange(c_UVER, "UVER_PGRLF")
       sSeznam = sSeznam & "|fffd||fffd|dost o podnikatelsk|fffd| |fffd|v|fffd|r; "
        If optZadUver Then
              Sheets(c_UVER).Range("uver_zadost").Value = "poskytnut|fffd| |fffd|v|fffd|ru"
              Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_REG").Row).EntireRow.Hidden = True
              Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_1").Rows.Count + 2).EntireRow.Hidden = True
              Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_2").Rows.Count + 2).EntireRow.Hidden = False
        ElseIf optZadZm Then
          Sheets(c_UVER).Range("uver_zadost").Value = "zm|fffd|nu podm|fffd|nek"
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_REG").Row).EntireRow.Hidden = False
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_1").Rows.Count + 2).EntireRow.Hidden = False
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_2").Rows.Count + 2).EntireRow.Hidden = True
        ElseIf optZadPrisl Then
          Sheets(c_UVER).Range("uver_zadost").Value = "poskytnut|fffd| p|fffd||fffd|slibu |fffd|v|fffd|ru"
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_REG").Row).EntireRow.Hidden = True
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_1").Rows.Count + 2).EntireRow.Hidden = True
          Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_2").Rows.Count + 2).EntireRow.Hidden = False
        End If
        
         With Sheets(c_UVER).Range("uver_zadost").Validation
            If frm_D1_BALPOD.optBalKN Then
                .Delete
                .add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
        xlBetween, Formula1:="DOPLNIT,poskytnut|fffd| |fffd|v|fffd|ru,poskytnut|fffd| p|fffd||fffd|slibu |fffd|v|fffd|ru"
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End If
        
        End With
    End If
    
    
    
    
    
    If Not chbProduckt2 Then
        ActiveWorkbook.Sheets(c_ZARUKA).Visible = xlSheetVeryHidden
    Else
        Call dellRange(c_ZARUKA, "S_" & sForma & "_2")
        sSeznam = sSeznam & "|fffd||fffd|dost o bankovn|fffd| z|fffd|ruku; "
         If optZZ1 Then
              Sheets(c_ZARUKA).Range("zaruka_zadost").Value = optZZ1.Tag
              Sheets(c_ZARUKA).Rows(Sheets(c_ZARUKA).Range("ZA_REG").Row).EntireRow.Hidden = True
         ElseIf optZZ2 Then
              Sheets(c_ZARUKA).Range("zaruka_zadost").Value = optZZ2.Tag
         End If
         

         With Sheets(c_ZARUKA).Range("ZARUKA_ZADOST").Validation
            If frm_D1_BALPOD.optBalKN Then
                .Delete
                .add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="DOPLNIT,poskytnut|fffd| bankovn|fffd| z|fffd|ruky"
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End If

        End With
    End If
    
    
    If Not chbProduckt3 Then
        ActiveWorkbook.Sheets(c_PRISLIB).Visible = xlSheetVeryHidden
    Else
        Call dellRange(c_PRISLIB, "S_" & sForma & "_3")
        sSeznam = sSeznam & " |fffd||fffd|dost o p|fffd||fffd|slib bankovn|fffd| z|fffd|ruky; "
        If optZP1 Then
              Sheets(c_PRISLIB).Range("prislib_zadost").Value = optZP1.Tag
              Sheets(c_PRISLIB).Rows(Sheets(c_PRISLIB).Range("PR_REG").Row).EntireRow.Hidden = True
         ElseIf optZP2 Then
              Sheets(c_PRISLIB).Range("prislib_zadost").Value = optZP2.Tag
              Sheets(c_PRISLIB).Rows(Sheets(c_PRISLIB).Range("PR_REG").Row).EntireRow.Hidden = True
        ElseIf optZP3 Then
              Sheets(c_PRISLIB).Range("prislib_zadost").Value = optZP3.Tag
         End If

         With Sheets(c_PRISLIB).Range("PRISLIB_ZADOST").Validation
            If frm_D1_BALPOD.optBalKN Then
                .Delete
                .add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="DOPLNIT,neodvolateln|fffd|ho p|fffd||fffd|slibu bankovn|fffd| z|fffd|ruky,odvolateln|fffd|ho p|fffd||fffd|slibu bankovn|fffd| z|fffd|ruky"
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End If

        End With
    End If
    If Not chbProduckt4 Then
        ActiveWorkbook.Sheets(c_CELNI).Visible = xlSheetVeryHidden
    Else
        Call dellRange(c_CELNI, "S_" & sForma & "_4")
        sSeznam = sSeznam & "|fffd||fffd|dost o bankovn|fffd| z|fffd|ruku za celn|fffd| dluh; "
        If optZC1 Then
              Sheets(c_CELNI).Range("celni_zadost").Value = optZC1.Tag
              Sheets(c_CELNI).Rows(Sheets(c_CELNI).Range("CE_REG").Row).EntireRow.Hidden = True
         ElseIf optZC2 Then
              Sheets(c_CELNI).Range("celni_zadost").Value = optZC2.Tag
         End If

         With Sheets(c_CELNI).Range("CELNI_ZADOST").Validation
            If frm_D1_BALPOD.optBalKN Then
                .Delete
                .add Type:=xlValidateList, AlertStyle:=xlValidAlertStop, Operator:= _
                xlBetween, Formula1:="DOPLNIT,poskytnut|fffd| celn|fffd| z|fffd|ruky"
                .IgnoreBlank = True
                .InCellDropdown = True
                .InputTitle = ""
                .ErrorTitle = ""
                .InputMessage = ""
                .ErrorMessage = ""
                .ShowInput = True
                .ShowError = True
            End If
        
        End With
    End If

    If Not chbOstatni4 Then
      ActiveWorkbook.Sheets(c_Vlast).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Vlastnick|fffd| vztahy, majetkov|fffd| pod|fffd|ly; "
    End If
    
    If Not chbOstatni5 Then
      ActiveWorkbook.Sheets(c_Dodavatel).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Rozbor dodavatelsko-odb|fffd|ratelsk|fffd|ch vztah|fffd|; "
    End If
    
    If Not chbOstatni6 Then
      ActiveWorkbook.Sheets(c_Rozbor).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Rozbor pohled|fffd|vek a z|fffd|vazk|fffd|, investice; "
      If CInt(cboRozborKs.Value) > 1 Then Call AddAval(c_Rozbor, CInt(cboRozborKs.Value))
    End If
    
    If Not chbOstatni7 Then
      ActiveWorkbook.Sheets(c_Ostatni).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Ostatn|fffd| dopl|fffd|uj|fffd|c|fffd| |fffd|daje; "
    End If
    
    If Not chbOstatni8 Then
      ActiveWorkbook.Sheets(c_DE).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci; "
    End If
    
'    If Not frm_D1_BALPOD.optDE Then
'      ActiveWorkbook.Sheets(c_DE).Visible = xlSheetVeryHidden
'    Else
'      sSeznam = sSeznam & "Dopl|fffd|uj|fffd|c|fffd| |fffd|daje k da|fffd|ov|fffd| evidenci; "
'    End If
    
    If Not chbOstatni2 Then
      ActiveWorkbook.Sheets(c_DLUZNIK).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Prohl|fffd|en|fffd| o vlastnictv|fffd| majetku a z|fffd|vazc|fffd|ch - dlu|fffd|n|fffd|k; "
      If CInt(txtDluzPocet) > 1 Then Call AddAval(c_DLUZNIK, CInt(txtDluzPocet))
    End If
    
    If Not chbOstatni3 Then
      ActiveWorkbook.Sheets(c_AVAL).Visible = xlSheetVeryHidden
    Else
      sSeznam = sSeznam & "Prohl|fffd|en|fffd| o vlastnictv|fffd| majetku a z|fffd|vazc|fffd|ch - avalista; "
      If CInt(txtAvalPocet) > 1 Then Call AddAval(c_AVAL, CInt(txtAvalPocet))
    End If
    
    If Not cboPrilohy1 Then
      ActiveWorkbook.Sheets(c_PREHLED).Visible = xlSheetVeryHidden
    End If

    Sheets(c_POM).Range("POM_MAKRA").Value = False
    Application.DisplayAlerts = True
    Range("UVOD_SEZNAM").Value = Left(sSeznam, Len(sSeznam) - 2) + "."
    
    If frm_D1_BALPOD.optInd Then
        ActiveWorkbook.Sheets(c_UVOD).Visible = xlSheetVeryHidden
    End If
    
  
    
'    glob_zamek = True
'    Call ZamekAll(True)
'    ActiveWorkbook.Protect Structure:=True, Windows:=False, Password:="simplebl"
'    bScreen = True
'    Application.ScreenUpdating = bScreen
'    Sheets(c_UVOD).Select
'    Range("UVOD_jmeno_T").Select
    
    
  
End Sub



Private Sub chbOstatni3_Change()
    Call EnabledCon(Label1, chbOstatni3.Value)
    Call EnabledCon(txtAvalPocet, chbOstatni3.Value)
End Sub

Private Sub chbOstatni2_Change()
  Call EnabledCon(Label2, chbOstatni2.Value)
  Call EnabledCon(txtDluzPocet, chbOstatni2.Value)
End Sub

Private Sub chbOstatni6_Change()
  cboRozborKs.Enabled = chbOstatni6
End Sub

Private Sub chbProduckt1_Change()
    Call EnabledCon(frmoZoUver, chbProduckt1)
    frmZadostoUver.Visible = chbProduckt1
'    optZadUver.Visible = frm_D1_BALPOD.optBalKN
    optZadZm.Visible = Not frm_D1_BALPOD.optBalKN
'    optZadPrisl.Visible = frm_D1_BALPOD.optBalKN
    If frm_D1_BALPOD.optBalKN Then
        optZadUver.Value = True
    Else
        optZadZm.Value = True
    End If
End Sub

Private Sub chbProduckt2_Change()
    Call EnabledCon(frmZadostoZ, chbProduckt2)
    frmZadostoZ.Visible = chbProduckt2
    
'    optZZ1.Visible = frm_D1_BALPOD.optBalKN
    optZZ2.Visible = Not frm_D1_BALPOD.optBalKN

    If frm_D1_BALPOD.optBalKN Then
        optZZ1.Value = True
    Else
        optZZ2.Value = True
    End If
End Sub

Private Sub chbProduckt3_Change()
    Call EnabledCon(frmZadostoP, chbProduckt3)
    frmZadostoP.Visible = chbProduckt3
    
'    optZP1.Visible = frm_D1_BALPOD.optBalKN
    optZP3.Visible = Not frm_D1_BALPOD.optBalKN
'    optZP2.Visible = frm_D1_BALPOD.optBalKN
    If frm_D1_BALPOD.optBalKN Then
        optZP1.Value = True
    Else
        optZP3.Value = True
    End If
End Sub

Private Sub chbProduckt4_Change()
    Call EnabledCon(frmZadostoC, chbProduckt4)
    frmZadostoC.Visible = chbProduckt4
    
'    optZC1.Visible = frm_D1_BALPOD.optBalKN
    optZC2.Visible = Not frm_D1_BALPOD.optBalKN
    If frm_D1_BALPOD.optBalKN Then
        optZC1.Value = True
    Else
        optZC2.Value = True
    End If
End Sub




Private Sub txtAvalPocet_AfterUpdate()
  If Not IsNumeric(Replace(Replace(txtAvalPocet, ".", "A"), ",", "B")) Then
    MsgBox "Rozsah po|fffd|tu list|fffd| je 1 - 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
    txtAvalPocet = 1
  Else
    If CInt(txtAvalPocet) < 1 Then
      MsgBox "Minim|fffd|ln|fffd| po|fffd|et list|fffd| je 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
      txtAvalPocet = 1
    End If
    If CInt(txtAvalPocet) > 30 Then
      MsgBox "Maxim|fffd|ln|fffd| po|fffd|et list|fffd| je 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
      txtAvalPocet = 30
    End If
  End If
End Sub


Private Sub txtDluzPocet_AfterUpdate()
  If Not IsNumeric(Replace(Replace(txtDluzPocet, ".", "A"), ",", "B")) Then
    MsgBox "Rozsah po|fffd|tu list|fffd| je 1 - 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
    txtDluzPocet = 1
  Else
    If CInt(txtDluzPocet) < 1 Then
      MsgBox "Minim|fffd|ln|fffd| po|fffd|et list|fffd| je 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
      txtDluzPocet = 1
    End If
    If CInt(txtDluzPocet) > 30 Then
      MsgBox "Maxim|fffd|ln|fffd| po|fffd|et list|fffd| je 30", vbInformation, "Rozsah po|fffd|tu list|fffd|"
      txtDluzPocet = 30
    End If
  End If
End Sub

Private Sub UserForm_Activate()
  
  If frm_D1_BALPOD.optBalKN Then
      frm_D3.Caption = frm_D1_BALPOD.optBalKN.Tag
    ElseIf frm_D1_BALPOD.optKNzm Then
        frm_D3.Caption = frm_D1_BALPOD.optKNzm.Tag
    ElseIf frm_D1_BALPOD.optBalRO Then
      frm_D3.Caption = frm_D1_BALPOD.optBalRO.Tag
    ElseIf frm_D1_BALPOD.optInd Then
      frm_D3.Caption = frm_D1_BALPOD.optInd.Tag
    End If
  
'  If frm_D1_BALPOD.optBalRO Then
'      cmdOK_Click
'  End If
  
  

End Sub

Private Sub UserForm_Initialize()
        
    frmoZoUver.Visible = Not frm_D1_BALPOD.optBalRO
    chbOstatni2.Visible = Not frm_D1_BALPOD.optBalRO
    Label1.Visible = Not frm_D1_BALPOD.optBalRO
    txtAvalPocet.Visible = Not frm_D1_BALPOD.optBalRO
    Call EnabledCon(Label1, False)
    Call EnabledCon(txtAvalPocet, False)

    
    chbOstatni3.Visible = Not frm_D1_BALPOD.optBalRO
    Label2.Visible = Not frm_D1_BALPOD.optBalRO
    txtDluzPocet.Visible = Not frm_D1_BALPOD.optBalRO
    Call EnabledCon(Label2, False)
    Call EnabledCon(txtDluzPocet, False)
    
'    chbOstatni4.Visible = frm_D1_BALPOD.optInd
'    chbOstatni5.Visible = frm_D1_BALPOD.optInd
'    chbOstatni6.Visible = frm_D1_BALPOD.optInd
'    chbOstatni7.Visible = frm_D1_BALPOD.optInd
    chbOstatni8.Visible = frm_D1_BALPOD.optDE ' frm_D1_BALPOD.optInd Or (frm_D1_BALPOD.optKNzm Or frm_D1_BALPOD.optBalKN) And frm_D1_BALPOD.optDE
    chbOstatni8.Value = chbOstatni8.Visible
    frmDE.Visible = chbOstatni8.Visible
    If Not chbOstatni8.Visible Then
      frmDalsiDok.Top = frmDE.Top
      frmPrilohy.Top = frmDalsiDok.Top + frmDalsiDok.Height
    
    End If
'    Call EnabledCon(chbProduckt1, Not frm_D1.optBalRO)
'    Call EnabledCon(chbProduckt2, Not frm_D1.optBalRO)
'    Call EnabledCon(chbProduckt3, Not frm_D1.optBalRO)
'    Call EnabledCon(chbProduckt4, Not frm_D1.optBalRO)
    
    chbProduckt1.Value = False
    chbProduckt2.Value = False
    chbProduckt3.Value = False
    chbProduckt4.Value = False
    
    chbOstatni2.Value = False
    chbOstatni3.Value = False
    chbOstatni4.Value = True
    chbOstatni5.Value = True
    chbOstatni6.Value = True
    chbOstatni7.Value = True
'    chbOstatni8.Value = True
    
    If frm_D1_BALPOD.optBalKN Then
      frmIND.Caption = ""
      frmIND.SpecialEffect = fmSpecialEffectFlat
      
      frmProdukty.Caption = "Druh produktu (|fffd||fffd|dosti) po|fffd|adovan|fffd| klientem"
      frmProdukty.SpecialEffect = fmSpecialEffectEtched
      
      frmDalsiDok.Caption = "Dal|fffd||fffd| po|fffd|adovan|fffd| dokumenty"
      frmDalsiDok.SpecialEffect = fmSpecialEffectEtched
    ElseIf frm_D1_BALPOD.optKNzm Then
      frmIND.Caption = ""
      frmIND.SpecialEffect = fmSpecialEffectFlat
      
      frmProdukty.Caption = "Druh produktu (|fffd||fffd|dosti) po|fffd|adovan|fffd| klientem"
      frmProdukty.SpecialEffect = fmSpecialEffectEtched
      
      frmDalsiDok.Caption = "Dal|fffd||fffd| po|fffd|adovan|fffd| dokumenty"
      frmDalsiDok.SpecialEffect = fmSpecialEffectEtched
    ElseIf frm_D1_BALPOD.optBalRO Then
      frmIND.Caption = ""
      frmIND.SpecialEffect = fmSpecialEffectFlat
      frmDalsiDok.Visible = False
      frmProdukty.Visible = False
      
      frmDalsiDok.Caption = "Dal|fffd||fffd| po|fffd|adovan|fffd| dokumenty"
      frmDalsiDok.SpecialEffect = fmSpecialEffectEtched
      
      frmDE.Top = frmPodklKN.Top
      frmPodklKN.Top = frmProdukty.Top
      
      
'      frmDalsiDok.Top = frmDalsiDok.Top
      
    ElseIf frm_D1_BALPOD.optInd Then
      frmIND.Caption = "Vyberte individu|fffd|ln|fffd| dokument/y"
      frmIND.SpecialEffect = fmSpecialEffectEtched
      frmProdukty.Caption = ""
      frmProdukty.SpecialEffect = fmSpecialEffectFlat
      frmDalsiDok.Caption = ""
      frmDalsiDok.SpecialEffect = fmSpecialEffectFlat
      chbOstatni4.Value = False
      chbOstatni5.Value = False
      chbOstatni6.Value = False
      chbOstatni7.Value = False
      chbOstatni8.Value = False
    End If
    
    cboRozborKs.Clear
    cboRozborKs.AddItem 1
    cboRozborKs.AddItem 2
    cboRozborKs.AddItem 3
    cboRozborKs.ListIndex = 0
    
    cboRozborKs.Enabled = chbOstatni6.Value
    
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
'  If CloseMode <> 1 Then
'    Cancel = 1
'    MsgBox "Pro ukon|fffd|en|fffd| pou|fffd|ijte tla|fffd||fffd|tko OK", vbInformation, POPIS_MSG
' End If
End Sub

Attribute VB_Name = "frm_Podpisy"
Attribute VB_Base = "0{FA012C63-EE40-46D9-B3FF-1D46F28D8299}{47F17FE8-7DBC-49EF-B2A2-2D2B9B42AF73}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit

Private Sub cmdOk_Click()

    Sheets(c_UVOD).Range("UVOD_KB_P_D_1").Value = txtDne
    Sheets(c_UVOD).Range("UVOD_KB_P_J_1").Value = txtKB
    Sheets(c_UVOD).Range("UVOD_KB_P_F_1").Value = cboPracovnik
    Me.Hide
 
End Sub



Private Sub txtDne_AfterUpdate()
    If txtDne <> "" Then
        If Not IsDate(txtDne) Then
            MsgBox Label1.Caption & " nen|fffd| datum.", vbInformation, POPIS_MSG
            txtDne.SetFocus
        End If
    End If
End Sub

Private Sub txtDne_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    Call txtDne_AfterUpdate
End Sub

Private Sub UserForm_Initialize()
    txtDne.Text = Date
    
    cboPracovnik.Clear
    cboPracovnik.AddItem "bankovn|fffd| poradce"
    cboPracovnik.AddItem "bankovn|fffd| poradce - universal"
    cboPracovnik.AddItem "bankovn|fffd| poradce Top Affluent"
    cboPracovnik.AddItem "bankovn|fffd| poradce TOP SB"
    cboPracovnik.AddItem "vedouc|fffd| bankovn|fffd| poradce TOP SB"
    cboPracovnik.AddItem "|fffd|editel pobo|fffd|ky"
    cboPracovnik.AddItem "n|fffd|m|fffd|stek |fffd|editele pobo|fffd|ky"
    cboPracovnik.AddItem "pracovn|fffd|k obchodn|fffd| podpory"
    cboPracovnik.AddItem "specialista pro podnikatelsk|fffd| |fffd|v|fffd|ry"
    cboPracovnik.AddItem "poradce pro hypote|fffd|n|fffd| |fffd|v|fffd|ry"
    cboPracovnik.AddItem "|fffd|editel Retailov|fffd| divize"
    cboPracovnik.AddItem "n|fffd|m|fffd|stek |fffd|editele Retailov|fffd| divize"
    cboPracovnik.AddItem "investi|fffd|n|fffd| specialista"
    cboPracovnik.AddItem "pokladn|fffd|k"
    cboPracovnik.AddItem "vedouc|fffd| t|fffd|mu pokladn|fffd|k|fffd|"
    cboPracovnik.AddItem "bankovn|fffd| poradce - Corporate"
    cboPracovnik.AddItem "|fffd|editel Korpor|fffd|tn|fffd| divize"
    cboPracovnik.AddItem "n|fffd|m|fffd|stek |fffd|editele Korpor|fffd|tn|fffd| divize"
    cboPracovnik.AddItem "komer|fffd|n|fffd| pracovn|fffd|k - Corporate"
    cboPracovnik.AddItem "vedouc|fffd| komer|fffd|n|fffd| pracovn|fffd|k - Corporate"
    cboPracovnik.AddItem "analytik -Corporate"
    cboPracovnik.AddItem "vedouc|fffd| analytik - Corporate"
    cboPracovnik.AddItem "pracovn|fffd|k pro zpracov|fffd|n|fffd| transakc|fffd|"
    cboPracovnik.AddItem "pracovn|fffd|k pro zpracov|fffd|n|fffd| transakc|fffd| |fffd| vedouc|fffd| t|fffd|mu"
    cboPracovnik.AddItem "Middle Office specialista - podpora prodeje"
    cboPracovnik.AddItem "Middle Office specialista"
    cboPracovnik.AddItem "Middle Office - specialista podnikatelsk|fffd|ch |fffd|v|fffd|r|fffd|"
    cboPracovnik.AddItem "Middle Office |fffd| vedouc|fffd| specialista podnikatelsk|fffd|ch |fffd|v|fffd|r|fffd|"
    cboPracovnik.AddItem "mana|fffd|er |fffd||fffd|zen|fffd| center zpracov|fffd|n|fffd| DIST"
    cboPracovnik.AddItem "z|fffd|stupce vedouc|fffd|ho |fffd||fffd|zen|fffd| Center aktivn|fffd|ch produkt|fffd|"
    cboPracovnik.AddItem "specialista |fffd||fffd|zen|fffd| center aktivn|fffd|ch produkt|fffd| 2"
    cboPracovnik.AddItem "specialista Podpory obchodn|fffd|ho vym|fffd|h|fffd|n|fffd|"
    cboPracovnik.AddItem "analytik obchodn|fffd|ho vym|fffd|h|fffd|n|fffd|"
    cboPracovnik.AddItem "|fffd|editel Priv|fffd|tn|fffd|ho bankovnictv|fffd|"
    cboPracovnik.AddItem "priv|fffd|tn|fffd| bank|fffd||fffd|"
    cboPracovnik.AddItem "vedouc|fffd| T|fffd|mu priv|fffd|tn|fffd|ch bank|fffd||fffd||fffd|"
    cboPracovnik.AddItem "z|fffd|stupce |fffd|editele Priv|fffd|tn|fffd|ho bankovnictv|fffd| a ved. Invest. t|fffd|mu"
    cboPracovnik.AddItem "komer|fffd|n|fffd| pracovn|fffd|k - Private Banking"
    cboPracovnik.AddItem "vedouc|fffd| t|fffd|mu komer|fffd|n|fffd|ch pracovn|fffd|k|fffd| - Private Banking"
    cboPracovnik.AddItem "komer|fffd|n|fffd| pracovn|fffd|k - TOP Corporations"
    cboPracovnik.AddItem "vedouci komer|fffd|n|fffd| pracovn|fffd|k - Top Corporations"
    cboPracovnik.AddItem "bankovn|fffd| poradce - Top Corporations"
    cboPracovnik.AddItem "|fffd|editel Obchodn|fffd| divize |fffd|echy - Top Corporations"
    cboPracovnik.AddItem "z|fffd|stupce |fffd|editele Obchodn|fffd| divize |fffd|echy |fffd| Top Corporations"
    cboPracovnik.AddItem "|fffd|editel Obchodn|fffd| divize Finan|fffd|n|fffd| instituce"
    cboPracovnik.AddItem "|fffd|editel Obchodn|fffd| divize Morava |fffd| Top Corporations"
    cboPracovnik.AddItem "z|fffd|stupce |fffd|editele Obchodn|fffd| divize Morava |fffd| Top Corporations"
    cboPracovnik.AddItem "specialista zpracov|fffd|n|fffd| pasivn|fffd|ch produkt|fffd|"
    cboPracovnik.AddItem "specialista zpracov|fffd|n|fffd| pasivn|fffd|ch produkt|fffd| TL"
    cboPracovnik.AddItem "specialista z|fffd|kaznick|fffd|ho servisu"
    cboPracovnik.AddItem "vedouc|fffd| specialista z|fffd|kaznick|fffd|ho servisu"
    cboPracovnik.AddItem "pracovn|fffd|k podpory - Centrum pasivn|fffd|ch produkt|fffd|"
    cboPracovnik.AddItem "pracovn|fffd|k podpory - Centrum pasivn|fffd|ch produkt|fffd| TL"
    cboPracovnik.AddItem "specialista  |fffd||fffd|zen|fffd| Center pasivn|fffd|ch produkt|fffd|"
    cboPracovnik.AddItem "vedouc|fffd| specialista |fffd||fffd|zen|fffd| Center pasivn|fffd|ch produkt|fffd|"
    cboPracovnik.AddItem "specialista akceptace platebn|fffd|ch karet"
    cboPracovnik.AddItem "specialista zpracov|fffd|n|fffd| pasivn|fffd|ch produkt|fffd| TL"
    cboPracovnik.AddItem "vedouc|fffd| monitoringu"
    cboPracovnik.AddItem "pracovn|fffd|k klientsk|fffd|ho servisu"
    cboPracovnik.AddItem "vedouc|fffd| t|fffd|mu Spr|fffd|va zaji|fffd|t|fffd|n|fffd|"
    cboPracovnik.AddItem "specialista t|fffd|mu Spr|fffd|va zaji|fffd|t|fffd|n|fffd|"
    cboPracovnik.ListIndex = 0
    
End Sub

Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
  If CloseMode <> 1 Then
    Cancel = 1
    MsgBox "Pro ukon|fffd|en|fffd| pou|fffd|ijte tla|fffd||fffd|tko OK", vbInformation, POPIS_MSG
 End If
End Sub
Attribute VB_Name = "frm_Podpisy2"
Attribute VB_Base = "0{C62CAF27-C87C-43EF-B6E9-EC8D8D1359C5}{B87947E3-0A77-455C-8DD7-909EE2A8565B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


Private Sub cboZU_KL_Change()
    Call EnabledCon(Klient2, cboZU_KL.Value > 1)
    Call EnabledCon(Klient3, cboZU_KL.Value > 2)
    Call EnabledCon(Klient4, cboZU_KL.Value > 3)
End Sub


Private Sub CommandButton1_Click()
    Dim sFirma As String
    Dim i As Integer
    Dim sLists(4) As String
    Dim sList As Variant
    Dim sListZK As String
    
    sLists(0) = c_UVOD
    sLists(1) = c_UVER
    sLists(2) = c_ZARUKA
    sLists(3) = c_PRISLIB
    sLists(4) = c_CELNI
    
    If frm_D1_BALPOD.optPO Then sFirma = txtFirma
  Call ZamekAll
  On Error Resume Next
For Each sList In sLists
  Select Case sList
    Case c_UVOD
      sListZK = "UVOD"
    Case c_UVER
      sListZK = "ZU"
    Case c_ZARUKA
      sListZK = "ZZ"
    Case c_PRISLIB
      sListZK = "PZ"
    Case c_CELNI
      sListZK = "ZC"
  End Select
    
  If sheetExist(CStr(sList)) And (frm_D1_BALPOD.optInd Or sList = c_UVOD) Then
    
    With Sheets(sList)
            .Range(sListZK & "_KB_P_D_1").Value = frm_Podpisy2.txtDne.Text
            .Range(sListZK & "_KB_P_J_1").Value = frm_Podpisy2.txtKB.Text
            .Range(sListZK & "_KB_P_F_1").Value = frm_Podpisy2.cboPracovnik.Value
        For i = 1 To 4
'          If frm_D1_BALPOD.optPO And sFirma <> "" Then
'            .Range(sListZK & "_KL_N_" & i).Value = sFirma
'          ElseIf frm_D1_BALPOD.optFOP Then
'            .Range(sListZK & "_KL_N_" & i).Value = ""
'          End If
            .Range(sListZK & "_KL_J_" & i).Value = frm_Podpisy2.Controls("txtKL" & i).Text
            .Range(sListZK & "_KL_F_" & i).Value = frm_Podpisy2.Controls("txtKLF" & i).Text
        Next i
      If frm_D1_BALPOD.optFOP Then
        Call dellRange(CStr(sList), sListZK & "_F1")
        Call dellRange(CStr(sList), sListZK & "_F2")
      End If
      
      Select Case cboZU_KL.ListIndex
        Case 0
          Call dellRange(CStr(sList), sListZK & "_KL_3")
          .Range(sListZK & "_KL_2").Value = ""
          .Range(sListZK & "_KL_2").Borders(xlDiagonalDown).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlDiagonalUp).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlEdgeLeft).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlEdgeTop).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlEdgeBottom).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlEdgeRight).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlInsideVertical).LineStyle = xlNone
          .Range(sListZK & "_KL_2").Borders(xlInsideHorizontal).LineStyle = xlNone
          .Range(sListZK & "_KL_2").FormatConditions.Delete
        Case 1
          Call dellRange(CStr(sList), sListZK & "_KL_3")
        Case 2
          .Range(sListZK & "_KL_4").Value = ""
          .Range(sListZK & "_KL_4").Borders(xlDiagonalDown).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlDiagonalUp).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlEdgeLeft).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlEdgeTop).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlEdgeBottom).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlEdgeRight).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlInsideVertical).LineStyle = xlNone
          .Range(sListZK & "_KL_4").Borders(xlInsideHorizontal).LineStyle = xlNone
          .Range(sListZK & "_KL_4").FormatConditions.Delete
      End Select
    End With
  End If
Next sList

   If sheetExist(c_DLUZNIK) Then
    Sheets(c_DLUZNIK).Range("PD_KB_P_D_1").Value = frm_Podpisy2.txtDne.Text
    Sheets(c_DLUZNIK).Range("PD_KB_P_J_1").Value = frm_Podpisy2.txtKB.Text
    Sheets(c_DLUZNIK).Range("PD_KB_P_F_1").Value = frm_Podpisy2.cboPracovnik.Value
  End If
  
  If sheetExist(c_AVAL) Then
    Sheets(c_AVAL).Range("PA_KB_P_D_1").Value = frm_Podpisy2.txtDne.Text
    Sheets(c_AVAL).Range("PA_KB_P_J_1").Value = frm_Podpisy2.txtKB.Text
    Sheets(c_AVAL).Range("PA_KB_P_F_1").Value = frm_Podpisy2.cboPracovnik.Value
  End If
  
  On Error GoTo 0

  Me.Hide
End Sub



Private Sub UserForm_Initialize()
  Const c_KL As String = "1|2|3|4"
  
  Dim rRange As Range

  Call PlneniCmb("cboZU_KL", c_KL, Me)
    
    Call EnabledCon(Klient2, False)
    Call EnabledCon(Klient3, False)
    Call EnabledCon(Klient4, False)
    
    lblOSOBA1.Visible = frm_D1_BALPOD.optPO
    txtFirma.Visible = frm_D1_BALPOD.optPO
    
    Label3467.Visible = frm_D1_BALPOD.optPO
    txtKLF1.Visible = frm_D1_BALPOD.optPO
    
    Label3481.Visible = frm_D1_BALPOD.optPO
    txtKLF2.Visible = frm_D1_BALPOD.optPO
    
    Label3483.Visible = frm_D1_BALPOD.optPO
    txtKLF3.Visible = frm_D1_BALPOD.optPO
    
    Label3482.Visible = frm_D1_BALPOD.optPO
    txtKLF4.Visible = frm_D1_BALPOD.optPO
    
    cboPracovnik.Clear
    
    For Each rRange In Sheets(c_POM).Range("POM_KB")
        cboPracovnik.AddItem rRange.Value
    Next rRange
    
    cboPracovnik.ListIndex = 0

    
    txtKLF1.Clear
    txtKLF2.Clear
    txtKLF3.Clear
    txtKLF4.Clear
    
    For Each rRange In Sheets(c_POM).Range("POM_PO")
        txtKLF1.AddItem rRange.Value
        txtKLF2.AddItem rRange.Value
        txtKLF3.AddItem rRange.Value
        txtKLF4.AddItem rRange.Value
    Next rRange
    
    txtKLF1.ListIndex = 0
    txtKLF2.ListIndex = 0
    txtKLF3.ListIndex = 0
    txtKLF4.ListIndex = 0
    
    txtDne.Text = Date
    
    
    If frm_D1_BALPOD.optInd Then
      If Not (frm_D3.chbProduckt1 Or frm_D3.chbProduckt2 Or frm_D3.chbProduckt3 Or frm_D3.chbProduckt4) Then
        Frame1.Visible = False
        CommandButton1 = Frame1.Top + (CommandButton1.Top - Frame2.Top)
        Frame2.Top = Frame1.Top
      End If
    End If
End Sub



Attribute VB_Name = "modFunkce"
Option Explicit

' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
' !!! pri libovolne zmene nutne povysit verzi !!!
' !!!! nutne zachovat zpetnou kompatibilitu !!!!!
' !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

'===============================
' n|fffd|zvy list|fffd|
Public Const c_WORKSBOOK As String = "BALPOD.xltm"
Public Const c_UVOD As String = "|fffd|VOD"
Public Const c_UVER As String = "|fffd||fffd|dost o |fffd|v|fffd|r"
Public Const c_ZARUKA As String = "|fffd||fffd|dost o z|fffd|ruku"
Public Const c_PRISLIB As String = "|fffd||fffd|dost o p|fffd||fffd|slib z|fffd|ruky"
Public Const c_CELNI As String = "|fffd||fffd|dost o celn|fffd| z|fffd|ruku"
Public Const c_AVAL As String = "Prohl|fffd|en|fffd| - avalista, ru|fffd|itel"
Public Const c_DLUZNIK As String = "Prohl|fffd|en|fffd| - dlu|fffd|n|fffd|k"
Public Const c_DE As String = "Dopl|fffd|uj|fffd|c|fffd| |fffd|daje DE"
Public Const c_Vlast As String = "Vlastnick|fffd| vztahy"
Public Const c_Rozbor As String = "Rozbor pohl. a z|fffd|v., investice"
Public Const c_Dodavatel As String = "Dodavatelsko-odb|fffd|ratelsk|fffd| vztah"
Public Const c_Ostatni As String = "Z|fffd|vazky u jin|fffd|ch v|fffd||fffd|itel|fffd|"
Public Const c_POM As String = "Pomocn|fffd|"
Public Const c_PREHLED As String = "P|fffd|ehled zak|fffd|zek"

Public Const c_Rozbor_2 As String = "Rozbor pohl. a z|fffd|v., invest"


Public Const POPIS_MSG = "bal|fffd||fffd|ek pro KN"

Public Const c_AVAL_EN As String = "Prohl|fffd|en|fffd| - avalista,ru|fffd|itel(A"
Public Const c_DLUZNIK_EN As String = "Prohl|fffd|en|fffd| - dlu|fffd|n|fffd|k(A"

Public Const c_Dodavatel_A As String = "Dodavatelsko-odb|fffd|ratelsk|fffd| v (A"
Public Const c_Vlast_A As String = "Vlastnick|fffd| vztahy (A"
Public Const c_Rozbor_A As String = "Rozbor pohl. a z|fffd|v., invest (A"
Public Const c_Ostatni_A As String = "Z|fffd|vazky u jin|fffd|ch v|fffd||fffd|itel|fffd| (A"

Public s_Cest(13) As String

Public bScreen As Boolean

Public glob_zamek As Boolean
Public glob_OPT As Boolean
Public b_Change As Boolean
Public b_Save As Boolean

Public Sub nastavCest()
  s_Cest(0) = "1A1"
  s_Cest(1) = "1A2"
  
  s_Cest(2) = "1B1"
  s_Cest(3) = "1B2"
  
  s_Cest(4) = "1C1"
  s_Cest(5) = "1C2"
  
  s_Cest(6) = "1D1"
  s_Cest(7) = "1D2"
  
  s_Cest(8) = "1E1"
  
  s_Cest(9) = "2"
  
  s_Cest(10) = "5A"
  s_Cest(11) = "5B"
  
  s_Cest(12) = "6"
  s_Cest(13) = "10"

  
End Sub



Public Sub EnabledCon(where As Object, where_value As Boolean, Optional inculde_where As Boolean = True)
  ' PROCEDURA AKTIVUJE/DEAKTIVUJE OBJEKT
  ' @PARAM where - objekt, kter|fffd| se m|fffd| aktivovat/deaktivovat. V p|fffd||fffd|pad|fffd| framu budou nastaveny v|fffd|echny hodnoty uvnit|fffd|.
  ' @PARAM where_value - m|fffd| hodnoty true (pro ativaci)/false (pro deaktivaci). Lze p|fffd|edat i hodnotu objektu.
  ' @PARAM inculde_where - Moznost pouziti pouze pro jeden control
  ' nap|fffd|. EnabledCon Frame1, OptionButton1.Value, kdy se Frame1 zaktivn|fffd|, pokud je zat|fffd||fffd|en OptionButton1 a naopak.
  ' VMAT 18.12.2014
  
    Dim col As String
    Dim Control As Object
    
    If where_value Then
      col = "&H80000005"
    Else
      col = "&H80000004"
    End If
    If (TypeOf where Is MSForms.TextBox) Or (TypeOf where Is MSForms.ComboBox) Or _
       (TypeOf where Is MSForms.ListBox) Then
      If inculde_where Then
        where.BackColor = col
      End If
    ElseIf (TypeOf where Is MSForms.Frame) Or (TypeOf where Is MSForms.MultiPage) Then
      For Each Control In where.Controls
        If (TypeOf Control Is MSForms.TextBox) Or (TypeOf Control Is MSForms.ComboBox) Or _
           (TypeOf Control Is MSForms.ListBox) Then
          Control.BackColor = col
        End If
        Control.Enabled = where_value
      Next
    End If
    
    If inculde_where = True Then
      where.Enabled = where_value
    End If
End Sub

Sub radekAdd(sNazev As String)
  ' p|fffd|id|fffd|n|fffd| |fffd||fffd|dk|fffd| do tabulky
  ' @sNazev n|fffd|zev bu|fffd|ky, nad kterou se bude |fffd||fffd|dek p|fffd|id|fffd|vat
  
 Dim iPosledniSl As Integer
' vytvo|fffd|en|fffd| |fffd||fffd|dku
  On Error GoTo err_handler
  Application.ScreenUpdating = False
  Call zamek(ActiveSheet.Name)
  Range(sNazev).Select ' v|fffd|b|fffd|r bu|fffd|ky
  Selection.EntireRow.Insert , CopyOrigin:=xlFormatFromLeftOrAbove ' vlo|fffd|en|fffd| |fffd||fffd|dky nad vybranou bu|fffd|ku
  iPosledniSl = Cells(Range(sNazev).Row, Columns.Count).End(xlToLeft).Column - Range(sNazev).Column ' posledn|fffd| vypl|fffd||fffd|n|fffd| sloupec (za tabulkou je znak K, kter|fffd| ur|fffd|uje po|fffd|et sloupc|fffd| tabulky)
  ' zkop|fffd|rov|fffd|n|fffd| hodnot z polsedn|fffd| r|fffd|dky do p|fffd|edposledn|fffd|
  Range(sNazev).Select
  Selection.Resize(1, iPosledniSl - 2).Select
  Selection.Copy
  Selection.Offset(-1, 0).Select
  
 ' r|fffd|me|fffd|ek
  Selection.PasteSpecial Paste:=xlPasteAll
    ' zam|fffd|en|fffd|
    Range(sNazev).Select
    Selection.Resize(1, iPosledniSl - 2).Select
    Selection.Value = ""
    Application.CutCopyMode = False
    Range(sNazev).Select
    Select Case sNazev
      Case "PA_2", "PAA_2", "PDA_2", "PD_2"
        Call validaceCislo("P", "U", Selection.Row)
    End Select
    Range(sNazev).Select
    
err_handler:

    Call zamek(ActiveSheet.Name, True)
    Application.ScreenUpdating = True
    
End Sub

Sub radekRemove(sNazev As String, Optional sJazyk As String = "")
  ' p|fffd|id|fffd|n|fffd| |fffd||fffd|dk|fffd| do tabulky
  ' @sNazev n|fffd|zev bu|fffd|ky, nad kterou se bude |fffd||fffd|dek p|fffd|id|fffd|vat
  
 Dim iPosledniSl As Integer
' vytvo|fffd|en|fffd| |fffd||fffd|dku
    If IsNumeric(Range(sNazev & "_S" & sJazyk).Value) And Range(sNazev & "_S" & sJazyk).Value <> "" Then
       If CInt(Range(sNazev & "_S" & sJazyk).Value) <= 3 Then
            MsgBox "Bylo dosa|fffd|eno nejmen|fffd||fffd|ho mo|fffd|n|fffd|ho po|fffd|tu zobrazen|fffd|ch |fffd||fffd|dk|fffd|, proto nejde operaci dokon|fffd|it.", vbInformation
            Exit Sub
       End If
    End If
    If MsgBox("Smaz|fffd|n|fffd| posledn|fffd|ho |fffd||fffd|dku je nevratn|fffd| operace. M|fffd| se pokra|fffd|ovat?", vbYesNo, "Odstran|fffd|n|fffd| posledn|fffd|ho |fffd||fffd|dku") = vbNo Then
        Exit Sub
    End If
  On Error GoTo err_handler
  Application.ScreenUpdating = False
  Call zamek(ActiveSheet.Name)
  Range(sNazev & sJazyk).Select ' v|fffd|b|fffd|r bu|fffd|ky
  
  iPosledniSl = Cells(Range(sNazev & sJazyk).Row, Columns.Count).End(xlToLeft).Column - Range(sNazev & sJazyk).Column ' posledn|fffd| vypl|fffd||fffd|n|fffd| sloupec (za tabulkou je znak K, kter|fffd| ur|fffd|uje po|fffd|et sloupc|fffd| tabulky)
  ' zkop|fffd|rov|fffd|n|fffd| hodnot z polsedn|fffd| r|fffd|dky do p|fffd|edposledn|fffd|
  Range(sNazev & sJazyk).Select
  Selection.Resize(1, iPosledniSl).Select
  Selection.Offset(-1, 0).Select
  Selection.Copy
  Selection.Offset(1, 0).Select
  Selection.PasteSpecial Paste:=xlPasteAll
  Application.CutCopyMode = False
  
 ' r|fffd|me|fffd|ek
 
    ' zam|fffd|en|fffd|
    Range(sNazev & sJazyk).Select
    Selection.Offset(-1, 0).Select
    Selection.EntireRow.Delete Shift:=xlUp ' odstran|fffd| |fffd||fffd|dek nad vybranou bu|fffd|ku
    Range(sNazev & sJazyk).Select
    
err_handler:
    Call zamek(ActiveSheet.Name, True)
    Application.ScreenUpdating = True
    
End Sub


Public Sub zamek(sSheet As String, Optional bOperace As Boolean = False)

'  Application.ScreenUpdating = False
    If bOperace Then
        Sheets(sSheet).EnableSelection = xlNoRestrictions 'xlUnlockedCells
        Sheets(sSheet).Protect DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowInsertingRows:=True, AllowDeletingRows:=True
        
    Else
        Sheets(sSheet).Unprotect Password:=""
    End If
'  Application.ScreenUpdating = bScreen

End Sub

Public Sub ZamekAll(Optional bOperace As Boolean = False)
    Dim vSheet As Worksheet
    
    For Each vSheet In ActiveWorkbook.Sheets
      If vSheet.Name <> ActiveSheet.Name Then Call zamek(vSheet.Name, bOperace)
    Next vSheet
      Call zamek(ActiveSheet.Name, bOperace)
End Sub

Public Sub dellRange(sNameSheet As String, sName As String)
  Call zamek(sNameSheet)
  Sheets(sNameSheet).Rows(Range(sName).Row & ":" & Range(sName).Row + Range(sName).Rows.Count - 1).EntireRow.Delete
End Sub

Public Function sPole(sText As String, iDelka As Integer) As String
Dim vpole As Variant
Dim sVysl As String, sCelk As String
Dim i As Integer
vpole = Split(sText, " ")

For i = 0 To UBound(vpole)
    If Len(sVysl + " " + vpole(i)) > iDelka Then
        If sCelk <> "" Then sCelk = sCelk & Chr(10)
        sCelk = sCelk & sVysl
        sVysl = vpole(i)
    Else
     sVysl = sVysl + " " + vpole(i)
    End If
    
    sCelk = sCelk & sVysl
    sPole = sCelk

Next i

End Function

Public Function iRadek(sText As String) As Integer
iRadek = UBound(Split(sText, Chr(10)))
End Function

Sub SloucenaBunka1AutoFit(sRange As Range)

    Dim rngSloucenaBunka As Range
    Dim rngSloupec As Range
    Dim rngBunka As Range
   
    Dim astrTextMaxDelka
   
    Dim dblBunka1PrizpusobenaSirka As Double
    Dim dblBunka1PrizpusobenaVyska As Double
   
    Dim intPocetRadku As Integer
   
    Dim strObsah As String
    Dim strTemp As String



    'v|fffd|ce|fffd||fffd|dkov|fffd|, jednosloupcov|fffd| slou|fffd|en|fffd| bu|fffd|ka se zalomen|fffd|m
    'Set rngSloucenaBunka = Range("B2:B3")
    Set rngSloucenaBunka = sRange.MergeArea

    'v|fffd|b|fffd|r slou|fffd|en|fffd| bu|fffd|ky
    rngSloucenaBunka.Select
    'po|fffd|et |fffd||fffd|dk|fffd| slou|fffd|en|fffd| bu|fffd|ky
    intPocetRadku = rngSloucenaBunka.Rows.Count

    With rngSloucenaBunka
        'zru|fffd|en|fffd| slou|fffd|en|fffd|
        .MergeCells = False
        'nekorektn|fffd| pro ru|fffd|n|fffd| zalomen|fffd| v|fffd|ce|fffd||fffd|dkov|fffd| obsah
        '.Cells(1).EntireColumn.AutoFit
        'p|fffd|vodn|fffd| obsah prvn|fffd| bu|fffd|ky
        strObsah = .Cells(1).Text
        'zru|fffd|en|fffd| slou|fffd|en|fffd|
        .MergeCells = False
        'a) nastaven|fffd| |fffd||fffd||fffd|ky prvn|fffd| bu|fffd|ky podle p|fffd|vodn|fffd| |fffd||fffd||fffd|ky slou|fffd|en|fffd| bu|fffd|ky
        '.Cells(1).ColumnWidth = dblSloucenaBunkaPuvodniSirka
        'b) p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky bu|fffd|ky podle jej|fffd| nejdel|fffd||fffd| textov|fffd| polo|fffd|ky
        'vytvo|fffd|en|fffd| |fffd|et|fffd|zce maticov|fffd| konstanty z obsahu bu|fffd|ky
        strTemp = "={""" & Replace(strObsah, vbLf, """;""") & """}"
        'p|fffd|id|fffd|n|fffd| do|fffd|asn|fffd|ho definovan|fffd|ho n|fffd|zvu
        ActiveWorkbook.Names.add Name:="XYZnazev", RefersToR1C1:=strTemp
        'text s maxim|fffd|ln|fffd| d|fffd|lkou (vyhodnocen jako maticov|fffd| vzorec)
        astrTextMaxDelka = _
            Evaluate("=INDEX(XYZnazev,MATCH(MAX(LEN(XYZnazev)),LEN(XYZnazev),0))")
        'odstran|fffd|n|fffd| do|fffd|asn|fffd|ho n|fffd|zvu
        ActiveWorkbook.Names("XYZnazev").Delete
        'nejdel|fffd||fffd| textov|fffd| polo|fffd|ka (|fffd||fffd|dek) prvn|fffd| bu|fffd|ky jako do|fffd|asn|fffd| obsah
        .Cells(1) = astrTextMaxDelka
        'zru|fffd|en|fffd| zalamov|fffd|n|fffd|
        .Cells(1).WrapText = False
        'p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky prvn|fffd| bu|fffd|ky nejdel|fffd||fffd| textov|fffd| polo|fffd|ce
        .Cells(1).Columns.AutoFit
        '|fffd||fffd||fffd|ka po p|fffd|izp|fffd|soben|fffd|
        dblBunka1PrizpusobenaSirka = .Cells(1).ColumnWidth
        'navr|fffd|cen|fffd| p|fffd|vodn|fffd|ho obsahu
        .Cells(1) = strObsah
        'navr|fffd|cen|fffd| zalamov|fffd|n|fffd| (po vlo|fffd|en|fffd| textu k n|fffd|mu dojde automaticky)
        .Cells(1).WrapText = True
        'p|fffd|izp|fffd|soben|fffd| v|fffd||fffd|ky prvn|fffd| bu|fffd|ky
        .Cells(1).Rows.AutoFit
        'v|fffd||fffd|ka po p|fffd|izp|fffd|soben|fffd|
        dblBunka1PrizpusobenaVyska = .Cells(1).RowHeight
        'znovuslou|fffd|en|fffd|
        .MergeCells = True
        'nastaven|fffd| p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky pro prvn|fffd| bu|fffd|ku
        '.Cells(1).ColumnWidth = dblBunka1PrizpusobenaSirka
        'rovnom|fffd|rn|fffd| rozd|fffd|len|fffd| pot|fffd|ebn|fffd| v|fffd||fffd|ky na v|fffd|echny |fffd||fffd|dky
        'slou|fffd|en|fffd| bu|fffd|ky
        .RowHeight = dblBunka1PrizpusobenaVyska / intPocetRadku
    End With

End Sub

Sub SloucenaBunka2AutoFit(sRange As Range)

    Dim rngSloucenaBunka As Range
    Dim rngBunka As Range

    Dim astrTextMaxDelka
    Dim strTextMaxDelka As Variant
   
    Dim dblSloucenaBunkaPuvodniSirka As Double
    Dim dblBunka1PuvodniSirka As Double
    Dim dblBunka1PrizpusobenaSirka As Double
    Dim dblBunka1PrizpusobenaVyska As Double
   
    Dim intPocetRadku As Integer
   
    Dim strObsah As String
    Dim strTemp As String


    'jedno|fffd||fffd|dkov|fffd|, v|fffd|cesloupcov|fffd| slou|fffd|en|fffd| bu|fffd|ka se zalomen|fffd|m
    'Set rngSloucenaBunka = Range("D5:E5")
    Set rngSloucenaBunka = sRange.MergeArea

    'v|fffd|b|fffd|r slou|fffd|en|fffd| bu|fffd|ky
    rngSloucenaBunka.Select

    'p|fffd|izp|fffd|soben|fffd| v|fffd||fffd|ky pouze pro prvn|fffd| |fffd||fffd|dek obsahu
    'rngSloucenaBunka.EntireRow.AutoFit
    'tot|fffd|
    'rngSloucenaBunka.Cells(1).EntireRow.AutoFit

    With rngSloucenaBunka
        'celkov|fffd| |fffd||fffd||fffd|ka slou|fffd|en|fffd| bu|fffd|ky
        'v nastaviteln|fffd|ch jednotk|fffd|ch (units)
        'ColumnWidth nelze aplikovat p|fffd||fffd|mo na slou|fffd|enou bu|fffd|ku
        'pro nestejn|fffd| |fffd|irok|fffd| sloupce vrac|fffd| Null
        For Each rngBunka In rngSloucenaBunka
            dblSloucenaBunkaPuvodniSirka = dblSloucenaBunkaPuvodniSirka + _
                rngBunka.ColumnWidth
        Next
        'p|fffd|vodn|fffd| obsah prvn|fffd| bu|fffd|ky
        strObsah = .Cells(1).Text
        'p|fffd|vodn|fffd| |fffd||fffd||fffd|ka prvn|fffd| bu|fffd|ky oblasti
        'dblBunka1PuvodniSirka = .Cells(1).ColumnWidth
        'zru|fffd|en|fffd| slou|fffd|en|fffd|
        .MergeCells = False
        'a) nastaven|fffd| |fffd||fffd||fffd|ky prvn|fffd| bu|fffd|ky podle p|fffd|vodn|fffd| |fffd||fffd||fffd|ky slou|fffd|en|fffd| bu|fffd|ky
        '.Cells(1).ColumnWidth = dblSloucenaBunkaPuvodniSirka
        'b) p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky bu|fffd|ky podle jej|fffd| nejdel|fffd||fffd| textov|fffd| polo|fffd|ky
        'vytvo|fffd|en|fffd| |fffd|et|fffd|zce maticov|fffd| konstanty z obsahu bu|fffd|ky
        strTemp = "={""" & Replace(strObsah, vbLf, """;""") & """}"
        'p|fffd|id|fffd|n|fffd| do|fffd|asn|fffd|ho definovan|fffd|ho n|fffd|zvu
        ActiveWorkbook.Names.add Name:="XYZnazev", RefersToR1C1:=strTemp
        'text s maxim|fffd|ln|fffd| d|fffd|lkou (vyhodnocen jako maticov|fffd| vzorec)
        strTextMaxDelka = _
            Evaluate("=INDEX(XYZnazev,MATCH(MAX(LEN(XYZnazev)),LEN(XYZnazev),0))")
        'odstran|fffd|n|fffd| do|fffd|asn|fffd|ho n|fffd|zvu
        ActiveWorkbook.Names("XYZnazev").Delete
        'nejdel|fffd||fffd| textov|fffd| polo|fffd|ka (|fffd||fffd|dek) prvn|fffd| bu|fffd|ky jako do|fffd|asn|fffd| obsah
        .Cells(1) = strTextMaxDelka
        'zru|fffd|en|fffd| zalamov|fffd|n|fffd|
        .Cells(1).WrapText = False
        'p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky prvn|fffd| bu|fffd|ky nejdel|fffd||fffd| textov|fffd| polo|fffd|ce
        .Cells(1).Columns.AutoFit
        '|fffd||fffd||fffd|ka po p|fffd|izp|fffd|soben|fffd|
        dblBunka1PrizpusobenaSirka = .Cells(1).ColumnWidth
        'navr|fffd|cen|fffd| p|fffd|vodn|fffd|ho obsahu
        .Cells(1) = strObsah
        'navr|fffd|cen|fffd| zalamov|fffd|n|fffd| (po vlo|fffd|en|fffd| textu k n|fffd|mu dojde automaticky)
        .Cells(1).WrapText = True
        'p|fffd|izp|fffd|soben|fffd| v|fffd||fffd|ky prvn|fffd| bu|fffd|ky
        .Cells(1).Rows.AutoFit
        'v|fffd||fffd|ka po p|fffd|izp|fffd|soben|fffd|
        dblBunka1PrizpusobenaVyska = .RowHeight
        'znovuslou|fffd|en|fffd|
        'nerespektuje nastavenou velikost
        .MergeCells = True
        'nastaven|fffd| p|fffd|vodn|fffd| |fffd||fffd||fffd|ky a p|fffd||fffd|zp|fffd|soben|fffd| v|fffd||fffd|ky pro prvn|fffd| bu|fffd|ku
        '.Cells(1).ColumnWidth = dblBunka1PuvodniSirka
        'nastaven|fffd| p|fffd|izp|fffd|soben|fffd| |fffd||fffd||fffd|ky a v|fffd||fffd|ky pro prvn|fffd| bu|fffd|ku
        .Cells(1).ColumnWidth = dblBunka1PrizpusobenaSirka
        .Cells(1).RowHeight = dblBunka1PrizpusobenaVyska
    End With

End Sub

Public Function isCU(sText As String) As String ' Boolean
  Dim sCU As String
  If sText <> "" Then
    sText = Replace(sText, " ", "")


    Debug.Print Replace(sText, "-", "", , 1)
    If IsNumeric(Replace(sText, "-", "", , 1)) Then
      isCU = sText
    Else
        frmCU.txtCU.Text = sText
        frmCU.Show
        isCU = frmCU.txtCU.Text
        Unload frmCU
    End If
  Else
    isCU = ""
  End If
End Function


Public Sub vyskaRadku(sSheet As String, sNazev As String, iVyska As Double)
  Dim iColumnWidth As Double
  Dim iColumnWidthAll As Double
  Dim iCellHeight As Double
  Dim oRange As Range
  Dim oRangeSel As Range
  Dim bZM As Boolean
    bZM = False
    
  Application.ScreenUpdating = False
    
    If Sheets(sSheet).ProtectContents Then
      Call zamek(sSheet)
      bZM = True
    End If
    
    Sheets(sSheet).Select
    Set oRangeSel = Selection
    Debug.Print oRangeSel.Address
    iColumnWidth = Sheets(sSheet).Range(sNazev).ColumnWidth
    Sheets(sSheet).Range(sNazev).Select
    Sheets(sSheet).Range(sNazev).UnMerge
    iCellHeight = Sheets(sSheet).Range(sNazev).RowHeight
    For Each oRange In Selection
      iColumnWidthAll = iColumnWidthAll + oRange.ColumnWidth
    Next oRange
    Sheets(sSheet).Range(sNazev).ColumnWidth = iColumnWidthAll
    Sheets(sSheet).Range(sNazev).Rows.AutoFit
    Selection.Merge
    Sheets(sSheet).Range(sNazev).ColumnWidth = iColumnWidth
    oRangeSel.Select
    If Sheets(sSheet).Range(sNazev).RowHeight < iVyska Then Sheets(sSheet).Range(sNazev).RowHeight = iVyska
    If 18.75 > iVyska And Sheets(sSheet).Range(sNazev).Value = "" Then Sheets(sSheet).Range(sNazev).RowHeight = iVyska
    
    If bZM Then
      Call zamek(sSheet, True)
    End If
  Application.ScreenUpdating = bScreen
End Sub

Public Sub PlneniCmb(sName As String, sValue As String, userFrm As UserForm, Optional iIndex As Integer = 0)

Dim vValue
Dim i As Integer
vValue = Split(sValue, "|")
userFrm.Controls(sName).Clear
For i = 0 To UBound(vValue)
  If vValue(i) <> "" Then userFrm.Controls(sName).AddItem vValue(i)
Next i
  If userFrm.Controls(sName).ListCount - 1 >= iIndex And iIndex > 0 Then
    userFrm.Controls(sName).ListIndex = iIndex
  Else
    If userFrm.Controls(sName).ListCount > 0 Then userFrm.Controls(sName).ListIndex = 0
  End If
End Sub

Public Function sheetExist(sName As String) As Boolean
   Dim vSheet As Worksheet
   sheetExist = False
  For Each vSheet In ActiveWorkbook.Sheets
    If vSheet.Name = sName Then
      sheetExist = True
      Exit Function
    End If
  Next vSheet
End Function

Public Sub AddAval(sName As String, iPocet As Byte)
  Dim i As Integer, j As Integer
  Dim btn As Button
'  Dim dWidth As Double, dHeight As Double, dLeft As Double, dTop As Double
'  dWidth = Sheets(sName).Shapes("cmdPA_1").Width
'  dHeight = Sheets(c_AVAL).Shapes("cmdPA_1").Height
'  dLeft = Sheets(c_AVAL).Shapes("cmdPA_1").Left
  For i = 2 To iPocet
    If i > 2 Then
      If (InStr(1, sName, "avalis") > 0 Or InStr(1, sName, c_Rozbor_2) > 0) And i >= 3 Then
        ActiveSheet.Name = Left(sName, Len(sName) - (2 + Len(i))) & " (" & i
        Sheets(sName).Copy After:=Sheets(sName)
      Else
        Sheets(sName).Copy After:=Sheets(sName & " (" & i - 1 & ")")
      End If
    Else
      Sheets(sName).Copy After:=Sheets(sName)
    End If
'    Call zamek(ActiveSheet.Name)
'
'    For j = 1 To 4
'      dTop = Sheets(c_AVAL).Shapes("cmdPA_" & j).Top + 0.4
'      ActiveSheet.Shapes("cmdPA_" & j).Delete
'      Set btn = ActiveSheet.Buttons.add(dLeft, dTop, dWidth, dHeight)
'      With btn
'        .OnAction = "btnS"
'        .Caption = "P|fffd|idat |fffd||fffd|dek"
'        .Name = "cmdPA" & i & "_" & j
'        .Placement = xlMoveAndSize
'        .Locked = False
'        .PrintObject = False
'      End With
'    Next j
  Next i
End Sub

'Sub btnS()
' MsgBox Application.Caller
'End Sub

Public Sub testAval()

  Call AddAval(c_AVAL, 4)
End Sub

Public Sub set_SK_UVER(bREAL As Boolean)
  Dim bSk As Boolean
  Dim i As Integer
  
  bSk = Sheets(c_UVER).Range("uver_zadost").Value = "poskytnut|fffd| p|fffd||fffd|slibu |fffd|v|fffd|ru" Or Sheets(c_UVER).Range("uver_zadost").Value = "poskytnut|fffd| |fffd|v|fffd|ru" And (Sheets(c_UVER).Range("ZU_UVER").Value = "Kontokorentn|fffd|" Or Sheets(c_UVER).Range("ZU_UVER").Value = "Revolvingov|fffd|")
  
  Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_REG").Row).EntireRow.Hidden = False
  Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_1").Rows.Count + 2).EntireRow.Hidden = False
  Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_2").Row & ":" & Sheets(c_UVER).Range("UVER_SK_2").Row + Sheets(c_UVER).Range("UVER_SK_2").Rows.Count + 2).EntireRow.Hidden = False
  
  For i = 1 To 7
    Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_SK_C" & i).Row).EntireRow.Hidden = False
  Next i
  
  Select Case LCase(Sheets(c_UVER).Range("uver_zadost").Value)
   Case "zm|fffd|nu podm|fffd|nek"
      Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_1").Row & ":" & Sheets(c_UVER).Range("UVER_SK_1").Row + Sheets(c_UVER).Range("UVER_SK_1").Rows.Count - 1).EntireRow.Hidden = True
   Case "DOPLNIT", "poskytnut|fffd| |fffd|v|fffd|ru", "poskytnut|fffd| p|fffd||fffd|slibu |fffd|v|fffd|ru"
      Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_REG").Row).EntireRow.Hidden = True
       Sheets(c_UVER).Rows(Sheets(c_UVER).Range("UVER_SK_2").Row & ":" & Sheets(c_UVER).Range("UVER_SK_2").Row + Sheets(c_UVER).Range("UVER_SK_2").Rows.Count - 1).EntireRow.Hidden = True
  End Select
  
  If Sheets(c_UVER).Range("uver_zadost").Value = "DOPLNIT" Or Sheets(c_UVER).Range("uver_zadost").Value = "poskytnut|fffd| |fffd|v|fffd|ru" And Sheets(c_UVER).Range("ZU_UVER").Value = "DOPLNIT" Then
    Sheets(c_UVER).Range("ZU_REALIZACE").Value = "DOPLNIT"
    If bREAL Then
      If Sheets(c_UVER).Range("uver_zadost").Value = "DOPLNIT" Then
        MsgBox "Nejd|fffd||fffd|ve vyberte '|fffd||fffd|dost o'.", vbInformation, "Cena za realizaci"
      Else
        MsgBox "Nejd|fffd||fffd|ve vyberte 'Typ |fffd|v|fffd|ru'.", vbInformation, "Cena za realizaci"
      End If
    End If
  End If
  
  If bSk Then
    For i = 1 To 7
      Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_SK_C" & i).Row).EntireRow.Hidden = True
    Next i
    Sheets(c_UVER).Range("ZU_REALIZACE").Value = "DOPLNIT"
  ElseIf Sheets(c_UVER).Range("ZU_REALIZACE").Value = "ne" Then
    For i = 3 To 7
      Sheets(c_UVER).Rows(Sheets(c_UVER).Range("ZU_SK_C" & i).Row).EntireRow.Hidden = True
    Next i
  End If

End Sub

Public Sub RI_kontrola(ID As Byte, sSheet As String, Optional sJazyk As String = "")
  Dim dSoucet As Double
  Dim sText As String
  dSoucet = 0
  sText = ""
  If 1 = ID Or 3 = ID Then
      If RI_kontrol_value("RI_soucet_1_1" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_1_2" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_1_3" & sJazyk, sSheet) < 0 Then
        If sText <> "" Then sText = sText & vbNewLine & vbNewLine
        sText = sText & "Sou|fffd|et hodnot ""DO splatnosti"" a ""PO splatnosti"" nesm|fffd| b|fffd|t v|fffd|t|fffd||fffd| ne|fffd| ""Kr|fffd|tkodob|fffd| pohled|fffd|vky z obchodn|fffd|ho styku."
      End If
  End If
  If 2 = ID Or 3 = ID Then
      If RI_kontrol_value("RI_soucet_1_3" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_2_2" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_2_3" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_2_4" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_2_5" & sJazyk, sSheet) < 0 Then
        If sText <> "" Then sText = sText & vbNewLine & vbNewLine
        sText = sText & "Sou|fffd|et hodnot ""po splatnosti do 30 dn|fffd|"", ""po splatnosti od 31-90 dn|fffd|"", ""po splatnosti od 91-365 dn|fffd|"" a ""po splatnosti nad 365 dn|fffd|"" nesm|fffd| b|fffd|t v|fffd|t|fffd||fffd| ne|fffd| ""z toho PO splatnosti"
      End If
  End If
  If 4 = ID Or 6 = ID Then
      If RI_kontrol_value("RI_soucet_3_1" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_3_2" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_3_3" & sJazyk, sSheet) < 0 Then
        If sText <> "" Then sText = sText & vbNewLine & vbNewLine
        sText = sText & "Sou|fffd|et hodnot ""DO splatnosti"" a ""PO splatnosti"" nesm|fffd| b|fffd|t v|fffd|t|fffd||fffd| ne|fffd| ""Kr|fffd|tkodob|fffd| z|fffd|vazky z obchodn|fffd|ho styku."
      End If
  End If
  If 5 = ID Or 6 = ID Then
      If RI_kontrol_value("RI_soucet_3_3" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_4_2" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_4_3" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_4_4" & sJazyk, sSheet) - RI_kontrol_value("RI_soucet_2_5" & sJazyk, sSheet) < 0 Then
        If sText <> "" Then sText = sText & vbNewLine & vbNewLine
        sText = sText & "Sou|fffd|et hodnot ""po splatnosti do 30 dn|fffd|"", ""po splatnosti od 31-90 dn|fffd|"", ""po splatnosti od 91-365 dn|fffd|"" a ""po splatnosti nad 365 dn|fffd|"" nesm|fffd| b|fffd|t v|fffd|t|fffd||fffd| ne|fffd| ""z toho PO splatnosti"
      End If
  End If
  
  If sText <> "" Then
    MsgBox sText, vbInformation, "Chybn|fffd| sou|fffd|et hodnot"
  End If
      
End Sub

Private Function RI_kontrol_value(sRange As String, sSheet As String) As Double

  If IsNumeric(Sheets(sSheet).Range(sRange).Value) And Sheets(sSheet).Range(sRange).Value <> "" Then
    RI_kontrol_value = CDbl(Sheets(sSheet).Range(sRange).Value)
  Else
    RI_kontrol_value = 0
  End If
End Function

Public Function pocetRadku(oRange As Range) As Byte
    pocetRadku = oRange.Rows.Count
End Function

Public Function RangeExists(R As String, tAdr As String) As Boolean
    Dim Test As Range
    On Error GoTo err_handler
      If Range(R).Address = tAdr Then
        RangeExists = True
      Else
        RangeExists = False
      End If
err_handler:
  RangeExists = False
End Function

Public Function getsSH() As String
  getsSH = Sheets(c_POM).Range("POM_AKT_SHT").Value
  If getsSH = "" Then getsSH = ActiveSheet.Name
End Function

Sub DiagonalBorder(Optional bVisible As Boolean = False)
'
' Makro4 Makro
'

'
    
    If Not bVisible Then
      Selection.Borders(xlDiagonalDown).LineStyle = xlNone
      Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Else
      With Selection.Borders(xlDiagonalDown)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
      With Selection.Borders(xlDiagonalUp)
          .LineStyle = xlContinuous
          .ColorIndex = 0
          .TintAndShade = 0
          .Weight = xlThin
      End With
    End If
    
End Sub
Attribute VB_Name = "modNastaveni"
Option Explicit

Private Const c_Dat_Ucin As Date = "11.11.2019"
Sub Makro2()
'
' Makro2 Makro
'

'

    Call ZamekAll(True)

End Sub

Sub zamekF()
  ' odemkne v|fffd|echny se|fffd|ity
  Call ZamekAll

End Sub

Sub eeeee()
    Application.ScreenUpdating = True
   Application.EnableEvents = True
End Sub


Public Function sira(rR As Range) As String
  Dim rc2 As Range
  Dim dSirka As Double
  dSirka = 0
  For Each rc2 In rR.Cells
    dSirka = dSirka + rc2.ColumnWidth
  Next rc2
  sira = dSirka
End Function


Sub MakroDefault()
'
' Makro2 Makro
'

'

    Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    Application.EnableEvents = True
    Sheets(c_UVER).Range("ZU_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_UVER).Range("ZU_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_UVER).Range("ZU_OPT1_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    
    Sheets(c_ZARUKA).Range("ZZ_CHB1_1").Value = ""
    Sheets(c_ZARUKA).Range("ZZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_ZARUKA).Range("ZZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_ZARUKA).Range("ZZ_OPT2_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_ZARUKA).Range("ZZ_OPT2_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_ZARUKA).Range("ZZ_OPT2_3").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_ZARUKA).Range("ZZ_OPT2_4").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    
    Sheets(c_PRISLIB).Range("PZ_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_PRISLIB).Range("PZ_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    
    Sheets(c_CELNI).Range("ZC_OPT1_1").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    Sheets(c_CELNI).Range("ZC_OPT1_2").Value = Sheets(c_POM).Range("POM_OPT_F").Value
    

End Sub

Private Sub setDOPLUDJU()
  Dim sSheets As Worksheet
  Call ZamekAll
  For Each sSheets In Sheets
    Call NastavStranku(sSheets)
    
    If Not sSheets.Name = c_DE Then
      sSheets.Visible = xlSheetVeryHidden
    Else
      sSheets.Visible = xlSheetVisible
       sSheets.PageSetup.RightFooter = _
        "" & Chr(10) & "&P/&N" & Chr(10) & "&4DATUM |fffd||fffd|INNOSTI |fffd|ABLONY " & c_Dat_Ucin & Chr(10) & "VER F DOPLUDJU.DOT"
    End If
  Next sSheets
  Range("POM_AKT_NAZEV_EXL").Value = "DOPLUDJU"
  Sheets(c_POM).Range("POM_MAKRA").Value = "T"
  Call ZamekAll(True)
  ActiveWorkbook.SaveAs ActiveWorkbook.Path & Application.PathSeparator & "DOPLUDJU", xlOpenXMLTemplateMacroEnabled
  MsgBox "DOPLUDJU vytvo|fffd|en - zm|fffd|nit spu|fffd|t|fffd|n|fffd| dailogu ve v makru open"
End Sub

Private Sub setPODKRNAV()
  Dim sSheets As Worksheet
  
  Call ZamekAll
  For Each sSheets In Sheets
  
    Call NastavStranku(sSheets)
    
    If Not (sSheets.Name = c_Vlast Or sSheets.Name = c_Dodavatel Or sSheets.Name = c_Rozbor Or sSheets.Name = c_Ostatni Or sSheets.Name = c_Vlast_A Or sSheets.Name = c_Dodavatel_A Or sSheets.Name = c_Rozbor_A Or sSheets.Name = c_Ostatni_A) Then
      sSheets.Visible = xlSheetVeryHidden
    Else
      sSheets.Visible = xlSheetVisible
       sSheets.PageSetup.RightFooter = _
        "" & Chr(10) & "&P/&N" & Chr(10) & "&4DATUM |fffd||fffd|INNOSTI |fffd|ABLONY " & c_Dat_Ucin & Chr(10) & "VER F PODKRNAV.DOT"
    End If
  
  Next sSheets
    Sheets(c_Vlast).Shapes("S_RO_2").Delete
    Call dellRange(c_Ostatni, "ODU_RO")
    Range("POM_AKT_NAZEV_EXL").Value = "PODKRNAV"
    Sheets(c_POM).Range("POM_MAKRA").Value = "T"
  Call ZamekAll(True)
  ActiveWorkbook.SaveAs ActiveWorkbook.Path & Application.PathSeparator & "PODKRNAV", xlOpenXMLTemplateMacroEnabled
  MsgBox "PODKRNAV vytvo|fffd|en - zm|fffd|nit spu|fffd|t|fffd|n|fffd| dailogu ve v makru open"
End Sub

Private Sub setPROVLMAZ()
  Dim sSheets As Worksheet
  Call ZamekAll
  For Each sSheets In Sheets
    Call NastavStranku(sSheets)
    
    If Not (sSheets.Name = c_AVAL Or sSheets.Name = c_DLUZNIK Or sSheets.Name = c_AVAL_EN Or sSheets.Name = c_DLUZNIK_EN) Then
      sSheets.Visible = xlSheetVeryHidden
    Else
      sSheets.Visible = xlSheetVisible
       sSheets.PageSetup.RightFooter = _
        "" & Chr(10) & "&P/&N" & Chr(10) & "&4DATUM |fffd||fffd|INNOSTI |fffd|ABLONY " & c_Dat_Ucin & Chr(10) & "VER F PROVLMAZ.DOT"
    End If
  Next sSheets
  Range("POM_AKT_NAZEV_EXL").Value = "PROVLMAZ"
  Sheets(c_POM).Range("POM_MAKRA").Value = "T"
  Call ZamekAll(True)
  Sheets(c_DLUZNIK).Select
  ActiveWorkbook.SaveAs ActiveWorkbook.Path & Application.PathSeparator & "PROVLMAZ", xlOpenXMLTemplateMacroEnabled
  MsgBox "PROVLMAZ vytvo|fffd|en - zm|fffd|nit spu|fffd|t|fffd|n|fffd| dailogu ve v makru open"
End Sub

Private Sub setBALPOD()
  Dim sSheets As Worksheet
  Call ZamekAll
  For Each sSheets In Sheets
    Call NastavStranku(sSheets)
    Debug.Print sSheets.Name = c_Dodavatel_A
    If sSheets.Name = c_POM Or sSheets.Name = c_Ostatni_A Or sSheets.Name = c_AVAL_EN Or sSheets.Name = c_DLUZNIK_EN Or sSheets.Name = c_Dodavatel_A Or sSheets.Name = c_Vlast_A Or sSheets.Name = c_Rozbor_A Then
      sSheets.Visible = xlSheetVeryHidden
    Else
      sSheets.Visible = xlSheetVisible
       sSheets.PageSetup.RightFooter = _
        "" & Chr(10) & "&P/&N" & Chr(10) & "&4DATUM |fffd||fffd|INNOSTI |fffd|ABLONY " & c_Dat_Ucin & Chr(10) & "VER F BALPOD.DOT"
    End If
  Next sSheets
  Range("POM_AKT_NAZEV_EXL").Value = "BALPOD"
  Call ZamekAll(True)
  ActiveWorkbook.Save
  MsgBox "BALPOD vytvo|fffd|en"
End Sub
 
 Private Sub NastavStranku(sSh As Worksheet)
 ' nastvaen|fffd| prvn|fffd| bu|fffd|ky, v|fffd|dy A1 mimo pomocn|fffd| list, kter|fffd| se nenastavuje
  If Not sSh.Name = c_POM Then
      sSh.Visible = xlSheetVisible
      sSh.Activate
      sSh.Range("A1").Select
    End If
 End Sub
 
Private Sub setAll()
  ' BALPOD
  Call setAllVISIBLE
  Call setBALPOD
  ' DOPLUDJU
  Call setAllVISIBLE
  Call setDOPLUDJU
  ' PODKRNVAL
  Call setAllVISIBLE
  Call setPODKRNAV
  ' POHZADOV
  Call setAllVISIBLE
  Call setPOHZADOV
  ' PROVLMAZ
  Call setAllVISIBLE
  Call setPROVLMAZ
  
  MsgBox "V|fffd|e OK"
End Sub

Private Sub setAllVISIBLE()
  Dim sSheets As Worksheet
  Call ZamekAll
  For Each sSheets In Sheets
      sSheets.Visible = xlSheetVisible
    
  Next sSheets
  Range("POM_AKT_NAZEV_EXL").Value = "BALPOD"
  Call ZamekAll(True)
  ActiveWorkbook.Save
  MsgBox "All visible"
End Sub

Private Sub setPOHZADOV()
  Dim sSheets As Worksheet
  Call ZamekAll
  For Each sSheets In Sheets
    Call NastavStranku(sSheets)
    
    If Not (sSheets.Name = c_Dodavatel Or sSheets.Name = c_Dodavatel_A) Then
      sSheets.Visible = xlSheetVeryHidden
    Else
      sSheets.Visible = xlSheetVisible
       sSheets.PageSetup.RightFooter = _
        "" & Chr(10) & "&P/&N" & Chr(10) & "&4DATUM |fffd||fffd|INNOSTI |fffd|ABLONY " & c_Dat_Ucin & Chr(10) & "VER F POHZADOV.DOT"
    End If
  Next sSheets
  Range("POM_AKT_NAZEV_EXL").Value = "POHZADOV"
  Sheets(c_POM).Range("POM_MAKRA").Value = "T"
  Call ZamekAll(True)
  Sheets(c_Dodavatel).Select
  ActiveWorkbook.SaveAs ActiveWorkbook.Path & Application.PathSeparator & "POHZADOV", xlOpenXMLTemplateMacroEnabled
  MsgBox "POHZADOV vytvo|fffd|en - zm|fffd|nit spu|fffd|t|fffd|n|fffd| dailogu ve v makru open"
End Sub

Attribute VB_Name = "modOstatni"
Sub VyskaRadkuAuto()
'
' VyskaRadkuAuto Makro
'
' Kl|fffd|vesov|fffd| zkratka: Ctrl+q
'
'Private Const c_Rozbor_ks As Integer = 3

Dim newR As Range
  Dim iLastCol As Integer
  Dim iMin As Double
  Dim iNew As Double
  Dim iAkt As Double
  Dim NazevSes As String
  Dim i As Integer
  iMin = 18.75
  Set newR = Selection
  Select Case ActiveSheet.Name
    Case c_UVER
      NazevSes = c_UVER
  End Select
   Application.ScreenUpdating = False
   Application.EnableEvents = False
   bScreen = False
   iAkt = newR.Rows.Height
   iNew = iMin
   iLastCol = Cells(newR.Row, Columns.Count).End(xlToLeft).Column
    For i = 2 To iLastCol
      If Cells(newR.Row, i).Value <> "" Then
        Call vyskaRadku(NazevSes, Cells(newR.Row, i).Address, iMin)
        If newR.Rows.Height > iNew Then
          iNew = newR.Rows.Height
        End If
      End If
    Next i
    If iNew > iMin Then
      newR.RowHeight = iNew
    Else
      newR.RowHeight = iMin
    End If
    Debug.Print "ok"
    Application.ScreenUpdating = True
   Application.EnableEvents = True
   bScreen = True
    On Error Resume Next
      newR.Select
    On Error GoTo 0
End Sub



Public Sub CestneProhl(sName As String, sText As String)
  Dim i As Integer
  Dim sPrip As String
  

  
  sPrip = Split(sName, "_")(UBound(Split(sName, "_")))
  

  Application.EnableEvents = False
  On Error GoTo err_handler
  For i = 1 To Worksheets.Count
    If Worksheets(i).Name = c_UVER Then
      Debug.Print Sheets(c_UVER).Range(Replace(sName, sPrip, "UVER")).Value
      Sheets(c_UVER).Range(Replace(sName, sPrip, "UVER")).Value = sText
    End If
    If Worksheets(i).Name = c_ZARUKA Then
      Debug.Print Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUKA")).Value
      Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUKA")).Value = sText
      Debug.Print Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUKA")).Value
    End If
    If Worksheets(i).Name = c_PRISLIB Then
      Debug.Print Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).Value
      Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).Value = sText
      Debug.Print Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).Value
    End If
    If Worksheets(i).Name = c_CELNI Then
      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value = sText
      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
    End If
  Next i
'  On Error GoTo 0
err_handler:
  Application.EnableEvents = True
  
End Sub

Public Sub hlavicka(sName As String, sText As String, dVyska As Double, Optional bSetW As Boolean = False, Optional sSh As String)
  Dim i As Integer
  Dim sPrip As String
  Dim bIco As Boolean
  

  
  
  sPrip = Split(sName, "_", 2)(0)
  sPrip = Replace(sPrip, "_A", "")
  sName = Replace(sName, "_A", "")
  If Right(sName, 2) <> "_T" Then
    sName = sName & "_T"
  End If
  
  bIco = False
  If InStr(1, sName, "_ICO_") > 0 Then
    sText = Replace(sText, "I|fffd|O: ", "")
    sText = Replace(sText, "ID No.: ", "")
    bIco = True
  End If
  ' ==== speci|fffd|ln|fffd| p|fffd||fffd|pad, kdy|fffd| je vol|fffd|n|fffd| z jin|fffd|ch list|fffd|, ne|fffd| list|fffd| |fffd||fffd|dost|fffd|
  If bSetW Then
    If bIco Then
      Sheets(c_UVOD).Range("UVOD_ICO_T").Value = sText
      Call vyskaRadku(c_UVOD, "UVOD_ICO_T", 25.5)
      dVyska = Sheets(c_UVOD).Range("UVOD_ICO_T").RowHeight
    Else
      Sheets(c_UVOD).Range("UVOD_FIRMA_T").Value = sText
      Call vyskaRadku(c_UVOD, "UVOD_FIRMA_T", 25.5)
      dVyska = Sheets(c_UVOD).Range("UVOD_FIRMA_T").RowHeight
    End If
  End If
  ' ============

  Application.EnableEvents = False
  Call ZamekAll
  On Error GoTo err_handler
  For i = 1 To Worksheets.Count
    Debug.Print Worksheets(i).Name
    If Worksheets(i).Name = c_UVOD Then
'      Debug.Print Sheets(c_UVOD).Range(Replace(sName, sPrip, "UVOD")).Value
      Sheets(c_UVOD).Range(Replace(sName, sPrip, "UVOD")).Value = sText
      Sheets(c_UVOD).Range(Replace(sName, sPrip, "UVOD")).RowHeight = dVyska
    End If
    If Worksheets(i).Name = c_UVER Then
'      Debug.Print Sheets(c_UVER).Range(Replace(sName, sPrip, "UVER")).Value
      Sheets(c_UVER).Range(Replace(sName, sPrip, "UVER")).Value = sText
      Sheets(c_UVER).Range(Replace(sName, sPrip, "UVER")).RowHeight = dVyska
    End If
    If Worksheets(i).Name = c_ZARUKA Then
'      Debug.Print Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUK")).Value
      Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUK")).Value = sText
      Sheets(c_ZARUKA).Range(Replace(sName, sPrip, "ZARUK")).RowHeight = dVyska
    End If
    If Worksheets(i).Name = c_PRISLIB Then
'      Debug.Print Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).Value
      Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).Value = sText
      Sheets(c_PRISLIB).Range(Replace(sName, sPrip, "PRISLIB")).RowHeight = dVyska
    End If
    If Worksheets(i).Name = c_CELNI Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value = sText
      Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).RowHeight = dVyska
    End If
    If Worksheets(i).Name = c_Vlast Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Vlast).Range(Replace(Replace(sName, "_T", ""), sPrip, "VZ")).Value = "I|fffd|O: " & sText
      Else
        Sheets(c_Vlast).Range(Replace(Replace(sName, "_T", ""), sPrip, "VZ")).Value = sText
      End If
    End If
    If Worksheets(i).Name = c_Vlast_A Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Vlast_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "VZ") & "_A").Value = "ID No.: " & sText
      Else
        Sheets(c_Vlast_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "VZ") & "_A").Value = sText
      End If
    End If
    If Worksheets(i).Name = c_Dodavatel Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Dodavatel).Range(Replace(Replace(sName, "_T", ""), sPrip, "DO")).Value = "I|fffd|O: " & sText
      Else
        Sheets(c_Dodavatel).Range(Replace(Replace(sName, "_T", ""), sPrip, "DO")).Value = sText
      End If
    End If
    If Worksheets(i).Name = c_Dodavatel_A Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Dodavatel_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "DO") & "_A").Value = "ID No.: " & sText
      Else
        Sheets(c_Dodavatel_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "DO") & "_A").Value = sText
      End If
    End If
    If InStr(1, Worksheets(i).Name, c_Rozbor_2) > 0 And Not Worksheets(i).Name = c_Rozbor_A Then ' Worksheets(i).Name = c_Rozbor Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(Worksheets(i).Name).Range(Replace(Replace(sName, "_T", ""), sPrip, "RP")).Value = "I|fffd|O: " & sText
      Else
        Sheets(Worksheets(i).Name).Range(Replace(Replace(sName, "_T", ""), sPrip, "RP")).Value = sText
      End If
    End If
    If Worksheets(i).Name = c_Rozbor_A Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Rozbor_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "RP") & "_A").Value = "ID No.: " & sText
      Else
        Sheets(c_Rozbor_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "RP") & "_A").Value = sText
      End If
    End If
    If Worksheets(i).Name = c_Ostatni Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Ostatni).Range(Replace(Replace(sName, "_T", ""), sPrip, "OD")).Value = "I|fffd|O: " & sText
      Else
        Sheets(c_Ostatni).Range(Replace(Replace(sName, "_T", ""), sPrip, "OD")).Value = sText
      End If
    End If
     If Worksheets(i).Name = c_Ostatni_A Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_Ostatni_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "OD") & "_A").Value = "ID No.: " & sText
      Else
        Sheets(c_Ostatni_A).Range(Replace(Replace(sName, "_T", ""), sPrip, "OD") & "_A").Value = sText
      End If
    End If
    If Worksheets(i).Name = c_DE Then
'      Debug.Print Sheets(c_CELNI).Range(Replace(sName, sPrip, "CELNI")).Value
      If bIco Then
        Sheets(c_DE).Range(Replace(Replace(sName, "_T", ""), sPrip, "DE")).Value = "I|fffd|O: " & sText
      Else
        Sheets(c_DE).Range(Replace(Replace(sName, "_T", ""), sPrip, "DE")).Value = sText
      End If
    End If
  Next i
  Call ZamekAll(True)
'  On Error GoTo 0
err_handler:
  Application.EnableEvents = True
  
End Sub

Public Function RozdilM(dVznik As Range, dSplat As Range) As Integer
  If Not (IsDate(dVznik) And IsDate(dSplat)) Then
   RozdilM = 1
   Exit Function
  End If
  RozdilM = Abs(DateDiff("m", dVznik, dSplat))
End Function

Public Sub Podpisovka(sPole As String, sText As String)
  Dim sPr As String
  Dim i As Integer
  Dim j As Integer

  Call ZamekAll

  Application.EnableEvents = False
  Application.ScreenUpdating = False
  On Error Resume Next
  For j = 0 To ActiveWorkbook.Sheets.Count
    With Sheets(j)
      If .Visible And .Name <> ActiveSheet.Name Then
        Select Case .Name
          Case c_UVOD
            .Range("UVOD_" & sPole).Value = sText
          Case c_UVER
            .Range("ZU_" & sPole).Value = sText
          Case c_ZARUKA
            .Range("ZZ_" & sPole).Value = sText
          Case c_PRISLIB
            .Range("PZ_" & sPole).Value = sText
          Case c_CELNI
            .Range("ZC_" & sPole).Value = sText
          Case Else
            If InStr(1, .Name, c_DLUZNIK) > 0 Then
              If Range("POM_JAZYK").Value = "EN" Then
                .Range("PDA_" & sPole).Value = sText
              Else
                .Range("PD_" & sPole).Value = sText
              End If
            End If
            If InStr(1, .Name, Left(c_AVAL, 20)) > 0 Then
              If Range("POM_JAZYK").Value = "EN" Then
                .Range("PAA_" & sPole).Value = sText
              Else
                .Range("PA_" & sPole).Value = sText
              End If
            End If
        End Select
      End If
    End With
  Next j
  On Error GoTo 0
  Application.EnableEvents = True
  Application.ScreenUpdating = True
  Call ZamekAll(True)

End Sub

Public Sub validaceCislo(sRange1 As String, sRange2 As String, iRow As Integer)
'
' Makro1 Makro
'

'
  Call zamek(ActiveSheet.Name)
'  Range(sRange).Select
'ActiveSheet.Range(sRange1 & iRow & ":" & sRange2 & iRow).Select
'ActiveSheet.Range(sRange1 & iRow).Select

    With Range(sRange1 & iRow & ":" & sRange2 & iRow)
        .Validation.Delete
        .Validation.add Type:=xlValidateCustom, AlertStyle:=xlValidAlertStop, Operator:= _
        xlEqual, Formula1:="=ISNUMBER(" & sRange1 & iRow & ")"
        .Validation.IgnoreBlank = True
        .Validation.InCellDropdown = True
        .Validation.InputTitle = ""
        .Validation.ErrorTitle = "|fffd||fffd|slo"
        .Validation.InputMessage = ""
        .Validation.ErrorMessage = "Zadejte pouze |fffd||fffd|selnou hodnotu."
        .Validation.ShowInput = True
        .Validation.ShowError = True
    End With
  Call zamek(ActiveSheet.Name, True)
End Sub


INQUEST-PP=macro
