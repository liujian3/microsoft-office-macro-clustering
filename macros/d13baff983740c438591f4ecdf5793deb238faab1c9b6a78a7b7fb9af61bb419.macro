Attribute VB_Name = "AcestRegistruDeLucru"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Foaie1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ComboBox1, 11, 0, MSForms, ComboBox"
Attribute VB_Name = "Foaie3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module1"
Dim fs_rows_length As Long
Dim cntx As Long
Sub getMatches()
    
    Dim lr As Long
    Dim celPaste As Range
    
    If Worksheets("KAY|fffd|TLAR").AutoFilterMode = True Then
        Worksheets("KAY|fffd|TLAR").Rows.AutoFilter
        Else
        End If
    timezone = Sheets("Settings").Range("B1").Value - 1
    dayzone = Sheets("Settings").Range("D1").Value - 8
    sourcer = Sheets("Settings").Range("F1").Value
    If sourcer = 1 Then
        sourcer = "soccerstand.com/"
        suffix = "_en_1_"
    End If
    
       
        
    x1 = ThisWorkbook.Sheets("Settings").Range("I1").Value
    
    
    If Sheets("DataPort").Range("j1").Value > 2 Then


        Sheets("DataPort").Range("j40").ClearContents
    Dim lRetVal As Long
    lRetVal = MsgBox("EVET DERSENIZ LISTE SILINIR VE YENI BULTEN GELIR." & _
    Chr(10) & "HAYIR DERSENIZ EN SON HANGI MACTA KALDIYSA ORDAN DEVAM EDER." & _
    Chr(10) & "EGER IPTAL DERSENIZ HICBIR ISLEM YAPMAZ." & _
    Chr(10) & "LISTEYI ARSIVE KAYDETMEDIYSENIZ IPTAL DIYIP KAYIT YAPTIKTAN SONRA BULTEN CEK|fffd|N.", _
    vbYesNoCancel + vbQuestion, "BULTEN GUNCELLEME SECENEKLERI LUTFEN BIR SECIM YAPIN!")
    If lRetVal = vbNo Then
        Sheets("DataPort").Range("j40").Value = 2
        Else
        If lRetVal = vbYes Then
        Sheets("DataPort").Range("j40").Value = 1
        Else
        If lRetVal = vbCancel Then
        Exit Sub
    End If
    End If
    End If
        Else
        End If
        If Sheets("DataPort").Range("j40").Value = 1 Then
        ClearLIST
        ClearPrevious
        Else
        End If
        ZBasla = TimeValue(Now)
    a1 = Sheets("DataPort").Range("j1").Value
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    b1 = 1
    Set HTTP = CreateObject("MSXML2.XMLHTTP")
    HTTP.Open "GET", "https://d." & sourcer & "x/feed/f_1_" & dayzone & "_" & timezone & suffix, False
    HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
    HTTP.Send
    fs_input = HTTP.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    
        Call Show_PrBar_Or_No(fs_rows_length, "Maclar Guncelleniyor Lutfen Bekleyiniz...")
    For i = 0 To fs_rows_length - 4
        If bShowBar Then Call MyProgresBar
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            first_home = "": first_away = "": second_home = "": second_away = ""
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "AD" Then
                    date_match = DateAdd("s", fs_row_parts(1), "01/01/1970")
                    date_match = DateAdd("h", timezone, date_match)
                    date_match = Format(date_match, "dd.mm.yyyy hh:mm")
                End If
                If fs_row_parts(0) = "AE" Then home_name = fs_row_parts(1)
                If fs_row_parts(0) = "AF" Then away_name = fs_row_parts(1)
                If fs_row_parts(0) = "BA" Then first_home = fs_row_parts(1)
                If fs_row_parts(0) = "BB" Then first_away = fs_row_parts(1)
                If fs_row_parts(0) = "BC" Then second_home = fs_row_parts(1)
                If fs_row_parts(0) = "BD" Then second_away = fs_row_parts(1)
            Next j
            
            Sheets("DataPort").Range("B37").Value = tour_name
            Sheets("DataPort").Range("B38").Value = date_match
            Sheets("DataPort").Range("B39").Value = home_name
            Sheets("DataPort").Range("B40").Value = away_name
            Sheets("DataPort").Range("B41").Value = match_id
            Application.Calculation = xlCalculationAutomatic
            ddd = Sheets("DataPort").Range("J41").Value
            If ddd > 0 Then
            GoTo 5:
            Else
            End If

            If first_home <> "" And second_home <> "" Then
                half_time = first_home & "-" & first_away
                full_time = (Val(first_home) + Val(second_home)) & "-" & (Val(first_away) + Val(second_away))
                Sheets("DataPort").Range("B42").Value = half_time
                Sheets("DataPort").Range("B43").Value = full_time
            Else
                Sheets("DataPort").Range("B42").Value = ""
                Sheets("DataPort").Range("B43").Value = ""
            End If
End If
            
            Dim abc As Long
            SonSatir = Sheets("Settings").Cells(Rows.Count, 12).End(xlUp).Row
            For abc = 2 To SonSatir
            If Sheets("DataPort").Cells(37, 2).Value = Sheets("Settings").Cells(abc, 12).Value And Sheets("Settings").Cells(1, 13).Value = "T|fffd|M ANAL|fffd|Z" Then
            
21:
            
            Application.Calculation = xlCalculationManual
            Set HTTP = CreateObject("MSXML2.XMLHTTP")
            HTTP.Open "GET", "https://www." & sourcer & "match/" & match_id & "/", False
            HTTP.Send
            fs_input = HTTP.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Pattern = "participantEncodedIds = \[\'(.*)\',\'(.*)\'\]"
            If objRegExp.test(fs_input) = True Then
                Set objMatches = objRegExp.Execute(fs_input)
                home_id1 = objMatches.Item(0).submatches(0)
                away_id1 = objMatches.Item(0).submatches(1)
            End If
            objRegExp.Pattern = "tournamentStageEncodedId = \'(.*?)\'"
            If objRegExp.test(fs_input) = True Then
                Set objMatches = objRegExp.Execute(fs_input)
                tournament_stage_id1 = objMatches.Item(0).submatches(0)
            End If
            objRegExp.Pattern = "tournamentEncodedId = \'(.*?)\'"
            If objRegExp.test(fs_input) = True Then
                Set objMatches = objRegExp.Execute(fs_input)
                tournament_id1 = objMatches.Item(0).submatches(0)
            End If
            Application.Calculation = xlCalculationAutomatic
            Sheets("DataPort").Range("B44").Value = home_id1
            Sheets("DataPort").Range("B45").Value = away_id1
            Sheets("DataPort").Range("B46").Value = tournament_stage_id1
            Sheets("DataPort").Range("B47").Value = tournament_id1
            
            If Sheets("DataPort").Range("J46").Value = 1 Then GoTo 40:
            If Sheets("DataPort").Range("J46").Value = 0 Then GoTo 42:
42:
            ClearDataPort
            Application.Calculation = xlCalculationManual
            b1 = 2
            Set HTTP = CreateObject("MSXML2.XMLHTTP")
            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_table_overall?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
            HTTP.Send
            fs_input = HTTP.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = True
            objRegExp.Pattern = Chr(9)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(13)
            fs_input = objRegExp.Replace(fs_input, "")
            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
                objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
                If objRegExp.test(fs_input) = True Then
                    Set objMatches = objRegExp.Execute(fs_input)
                    For Each M In objMatches
                        Sheets("DataPort").Range("a" & b1).Value = M.submatches(1)
                        Sheets("DataPort").Range("b" & b1).Value = M.submatches(6)
                        Sheets("DataPort").Range("c" & b1).Value = M.submatches(9)
                        Sheets("DataPort").Range("d" & b1).Value = M.submatches(12)
                        Sheets("DataPort").Range("e" & b1).Value = M.submatches(15)
                        Sheets("DataPort").Range("f" & b1).Value = M.submatches(18)
                        Sheets("DataPort").Range("g" & b1).Value = M.submatches(21)
                        Sheets("DataPort").Range("h" & b1).Value = M.submatches(22)
                        Sheets("DataPort").Range("i" & b1).Value = M.submatches(25)
                        b1 = b1 + 1
                    Next
                End If
            End If

            b1 = 2
            Set HTTP = CreateObject("MSXML2.XMLHTTP")
            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_table_home?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
            HTTP.Send
            fs_input = HTTP.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = True
            objRegExp.Pattern = Chr(9)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(13)
            fs_input = objRegExp.Replace(fs_input, "")
            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
                objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
                If objRegExp.test(fs_input) = True Then
                    Set objMatches = objRegExp.Execute(fs_input)
                    For Each M In objMatches
                        Sheets("DataPort").Range("k" & b1).Value = M.submatches(1)
                        Sheets("DataPort").Range("l" & b1).Value = M.submatches(6)
                        Sheets("DataPort").Range("m" & b1).Value = M.submatches(9)
                        Sheets("DataPort").Range("n" & b1).Value = M.submatches(12)
                        Sheets("DataPort").Range("o" & b1).Value = M.submatches(15)
                        Sheets("DataPort").Range("p" & b1).Value = M.submatches(18)
                        Sheets("DataPort").Range("q" & b1).Value = M.submatches(21)
                        Sheets("DataPort").Range("r" & b1).Value = M.submatches(22)
                        Sheets("DataPort").Range("s" & b1).Value = M.submatches(25)
                        b1 = b1 + 1
                    Next
                End If
            End If
            
            b1 = 2
            Set HTTP = CreateObject("MSXML2.XMLHTTP")
            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_table_away?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
            HTTP.Send
            fs_input = HTTP.ResponseText
            Set objRegExp = CreateObject("VBScript.RegExp")
            objRegExp.Global = True
            objRegExp.MultiLine = True
            objRegExp.Pattern = Chr(9)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(10)
            fs_input = objRegExp.Replace(fs_input, "")
            objRegExp.Pattern = Chr(13)
            fs_input = objRegExp.Replace(fs_input, "")
            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
                objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
                If objRegExp.test(fs_input) = True Then
                    Set objMatches = objRegExp.Execute(fs_input)
                    For Each M In objMatches
                        Sheets("DataPort").Range("u" & b1).Value = M.submatches(1)
                        Sheets("DataPort").Range("v" & b1).Value = M.submatches(6)
                        Sheets("DataPort").Range("w" & b1).Value = M.submatches(9)
                        Sheets("DataPort").Range("x" & b1).Value = M.submatches(12)
                        Sheets("DataPort").Range("y" & b1).Value = M.submatches(15)
                        Sheets("DataPort").Range("z" & b1).Value = M.submatches(18)
                        Sheets("DataPort").Range("aa" & b1).Value = M.submatches(21)
                        Sheets("DataPort").Range("ab" & b1).Value = M.submatches(22)
                        Sheets("DataPort").Range("ac" & b1).Value = M.submatches(25)
                        b1 = b1 + 1
                    Next
                End If
            End If
            Application.Calculation = xlCalculationAutomatic
'            b1 = 2
'            Set HTTP = CreateObject("MSXML2.XMLHTTP")
'            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_form_overall?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
'            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
'            HTTP.Send
'            fs_input = HTTP.ResponseText
'            Set objRegExp = CreateObject("VBScript.RegExp")
'            objRegExp.Global = True
'            objRegExp.MultiLine = True
'            objRegExp.Pattern = Chr(9)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(10)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(13)
'            fs_input = objRegExp.Replace(fs_input, "")
'            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
'                objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
'                If objRegExp.test(fs_input) = True Then
'                    Set objMatches = objRegExp.Execute(fs_input)
'                    For Each M In objMatches
'                        Sheets("DataPort").Range("AE1").Value = M.submatches(9)
'                        F = M.submatches(9)
'                            If F <= 5 Then
'                        Sheets("DataPort").Range("AE" & b1).Value = M.submatches(1)
'                        Sheets("DataPort").Range("AF" & b1).Value = M.submatches(6)
'                        Sheets("DataPort").Range("AG" & b1).Value = M.submatches(9)
'                        Sheets("DataPort").Range("AH" & b1).Value = M.submatches(12)
'                        Sheets("DataPort").Range("AI" & b1).Value = M.submatches(15)
'                        Sheets("DataPort").Range("AJ" & b1).Value = M.submatches(18)
'                        Sheets("DataPort").Range("AK" & b1).Value = M.submatches(21)
'                        Sheets("DataPort").Range("AL" & b1).Value = M.submatches(22)
'                        Sheets("DataPort").Range("AM" & b1).Value = M.submatches(25)
'                        b1 = b1 + 1
'                        Else: GoTo 10:
'                        End If
'10:
'                    Next
'                End If
'            End If

'               b1 = 2
'            Set HTTP = CreateObject("MSXML2.XMLHTTP")
'            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_form_home?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
'            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
'            HTTP.Send
'            fs_input = HTTP.ResponseText
'            Set objRegExp = CreateObject("VBScript.RegExp")
'            objRegExp.Global = True
'            objRegExp.MultiLine = True
'            objRegExp.Pattern = Chr(9)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(10)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(13)
'            fs_input = objRegExp.Replace(fs_input, "")
'            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
'            objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
'            If objRegExp.test(fs_input) = True Then
'                    Set objMatches = objRegExp.Execute(fs_input)
'                    For Each M In objMatches
'                        Sheets("DataPort").Range("AO1").Value = M.submatches(9)
'                        F = M.submatches(9)
'                            If F <= 5 Then
'                        Sheets("DataPort").Range("AO" & b1).Value = M.submatches(1)
'                        Sheets("DataPort").Range("AP" & b1).Value = M.submatches(6)
'                        Sheets("DataPort").Range("AQ" & b1).Value = M.submatches(9)
'                        Sheets("DataPort").Range("AR" & b1).Value = M.submatches(12)
'                        Sheets("DataPort").Range("AS" & b1).Value = M.submatches(15)
'                        Sheets("DataPort").Range("AT" & b1).Value = M.submatches(18)
'                        Sheets("DataPort").Range("AU" & b1).Value = M.submatches(21)
'                        Sheets("DataPort").Range("AV" & b1).Value = M.submatches(22)
'                        Sheets("DataPort").Range("AW" & b1).Value = M.submatches(25)
'                        b1 = b1 + 1
'                        Else: GoTo 20:
'                        End If
'20:
'                    Next
'                End If
'            End If

'            b1 = 2
'            Set HTTP = CreateObject("MSXML2.XMLHTTP")
'            HTTP.Open "GET", "https://d." & sourcer & "x/feed/ss_1_" & tournament_id1 & "_" & tournament_stage_id1 & "_form_away?hp1=" & home_id1 & "&hp2=" & away_id1 & "&e=" & match_id, False
'            HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
'            HTTP.Send
'            fs_input = HTTP.ResponseText
'            Set objRegExp = CreateObject("VBScript.RegExp")
'            objRegExp.Global = True
'            objRegExp.MultiLine = True
'            objRegExp.Pattern = Chr(9)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(10)
'            fs_input = objRegExp.Replace(fs_input, "")
'            objRegExp.Pattern = Chr(13)
'            fs_input = objRegExp.Replace(fs_input, "")
'            If InStr(1, fs_input, "col_wins_pen") = 0 And InStr(1, fs_input, "col_wins_ot") = 0 Then
'            objRegExp.Pattern = "<tr(.*?)>([0-9]+)\.<(.*?)>(.*?)team_name_span(.*?)>(.*?)>(.*?)<(.*?)col_matches_played(.*?)>(.*?)<(.*?)wins(.*?)>(.*?)<(.*?)draws(.*?)>(.*?)<(.*?)losses(.*?)>(.*?)<(.*?)goals(.*?)>(.*?):(.*?)<(.*?)points(.*?)>(.*?)<\/td>"
'            If objRegExp.test(fs_input) = True Then
'                    Set objMatches = objRegExp.Execute(fs_input)
'                    For Each M In objMatches
'                        Sheets("DataPort").Range("AY1").Value = M.submatches(9)
'                        F = M.submatches(9)
'                            If F <= 5 Then
'                        Sheets("DataPort").Range("AY" & b1).Value = M.submatches(1)
'                        Sheets("DataPort").Range("AZ" & b1).Value = M.submatches(6)
'                        Sheets("DataPort").Range("BA" & b1).Value = M.submatches(9)
'                        Sheets("DataPort").Range("BB" & b1).Value = M.submatches(12)
'                        Sheets("DataPort").Range("BC" & b1).Value = M.submatches(15)
'                        Sheets("DataPort").Range("BD" & b1).Value = M.submatches(18)
'                        Sheets("DataPort").Range("BE" & b1).Value = M.submatches(21)
'                        Sheets("DataPort").Range("BF" & b1).Value = M.submatches(22)
'                        Sheets("DataPort").Range("BG" & b1).Value = M.submatches(25)
'                        b1 = b1 + 1
'                        Else: GoTo 30:
'                        End If
'30:
'                    Next
'                End If
'            End If
            
40:
                On Error Resume Next
'                Sheets("KAY|fffd|TLAR").Range("A" & a1).Value = Sheets("DataPort").Range("B42").Value
                Sheets("KAY|fffd|TLAR").Range("B" & a1).Value = Sheets("DataPort").Range("B42").Value
                Sheets("KAY|fffd|TLAR").Range("C" & a1).Value = Sheets("DataPort").Range("B43").Value
                Sheets("KAY|fffd|TLAR").Range("D" & a1).Value = Sheets("DataPort").Range("B39").Value
                Sheets("KAY|fffd|TLAR").Range("E" & a1).Value = Sheets("DataPort").Range("B40").Value
                Sheets("KAY|fffd|TLAR").Range("F" & a1).Value = Sheets("Analiza").Range("AF2").Value & "-" & Sheets("Analiza").Range("AH2").Value
                Sheets("KAY|fffd|TLAR").Range("G" & a1).Value = Sheets("Analiza").Range("AJ2").Value
                Sheets("KAY|fffd|TLAR").Range("H" & a1).Value = Sheets("Analiza").Range("AK2").Value
                Sheets("KAY|fffd|TLAR").Range("I" & a1).Value = Sheets("Analiza").Range("AJ3").Value
                Sheets("KAY|fffd|TLAR").Range("J" & a1).Value = Sheets("Analiza").Range("AK3").Value
                Sheets("KAY|fffd|TLAR").Range("K" & a1).Value = Sheets("Analiza").Range("AJ4").Value
                Sheets("KAY|fffd|TLAR").Range("L" & a1).Value = Sheets("Analiza").Range("AK4").Value
                Sheets("KAY|fffd|TLAR").Range("M" & a1).Value = Sheets("Analiza").Range("AJ5").Value
                Sheets("KAY|fffd|TLAR").Range("N" & a1).Value = Sheets("Analiza").Range("AK5").Value
                Sheets("KAY|fffd|TLAR").Range("O" & a1).Value = Sheets("Analiza").Range("AJ6").Value
                Sheets("KAY|fffd|TLAR").Range("P" & a1).Value = Sheets("Analiza").Range("AK6").Value
                Sheets("KAY|fffd|TLAR").Range("Q" & a1).Value = Sheets("Analiza").Range("AJ7").Value
                Sheets("KAY|fffd|TLAR").Range("R" & a1).Value = Sheets("Analiza").Range("AK7").Value
                Sheets("KAY|fffd|TLAR").Range("S" & a1).Value = Sheets("Analiza").Range("AJ8").Value
                Sheets("KAY|fffd|TLAR").Range("T" & a1).Value = Sheets("Analiza").Range("AK8").Value
                Sheets("KAY|fffd|TLAR").Range("U" & a1).Value = Sheets("Analiza").Range("AJ9").Value
                Sheets("KAY|fffd|TLAR").Range("V" & a1).Value = Sheets("Analiza").Range("AK9").Value
                Sheets("KAY|fffd|TLAR").Range("W" & a1).Value = Sheets("Analiza").Range("AJ10").Value
                Sheets("KAY|fffd|TLAR").Range("X" & a1).Value = Sheets("Analiza").Range("AK10").Value
                Sheets("KAY|fffd|TLAR").Range("Y" & a1).Value = Sheets("Analiza").Range("AJ11").Value
                Sheets("KAY|fffd|TLAR").Range("Z" & a1).Value = Sheets("Analiza").Range("AK11").Value
                Sheets("KAY|fffd|TLAR").Range("AA" & a1).Value = Sheets("DataPort").Range("B37").Value
                Sheets("KAY|fffd|TLAR").Range("AB" & a1).Value = Sheets("DataPort").Range("B38").Value
                Sheets("KAY|fffd|TLAR").Range("AC" & a1).Value = Sheets("DataPort").Range("B41").Value
'                Sheets("KAY|fffd|TLAR").Range("AD" & a1).Value = Sheets("DataPort").Range("Q37").Value
'                Sheets("KAY|fffd|TLAR").Range("AE" & a1).Value = Sheets("DataPort").Range("R37").Value
'                Sheets("KAY|fffd|TLAR").Range("AF" & a1).Value = Sheets("DataPort").Range("S37").Value
'                Sheets("KAY|fffd|TLAR").Range("AG" & a1).Value = Sheets("DataPort").Range("T37").Value
'                Sheets("KAY|fffd|TLAR").Range("AH" & a1).Value = Sheets("DataPort").Range("U37").Value
'                Sheets("KAY|fffd|TLAR").Range("AI" & a1).Value = Sheets("DataPort").Range("V37").Value
'                Sheets("KAY|fffd|TLAR").Range("AJ" & a1).Value = Sheets("DataPort").Range("W37").Value
'                Sheets("KAY|fffd|TLAR").Range("AK" & a1).Value = Sheets("DataPort").Range("X37").Value
'                Sheets("KAY|fffd|TLAR").Range("AL" & a1).Value = Sheets("DataPort").Range("Y37").Value
'                Sheets("KAY|fffd|TLAR").Range("AM" & a1).Value = Sheets("DataPort").Range("Z37").Value
'                Sheets("KAY|fffd|TLAR").Range("AN" & a1).Value = Sheets("DataPort").Range("AA37").Value
'                Sheets("KAY|fffd|TLAR").Range("AO" & a1).Value = Sheets("DataPort").Range("AB37").Value
'                Sheets("KAY|fffd|TLAR").Range("AP" & a1).Value = Sheets("DataPort").Range("AC37").Value
'                Sheets("KAY|fffd|TLAR").Range("AQ" & a1).Value = Sheets("DataPort").Range("AD37").Value
'                Sheets("KAY|fffd|TLAR").Range("AR" & a1).Value = Sheets("DataPort").Range("AE37").Value
'                Sheets("KAY|fffd|TLAR").Range("AS" & a1).Value = Sheets("DataPort").Range("AF37").Value
'                Sheets("KAY|fffd|TLAR").Range("AT" & a1).Value = Sheets("DataPort").Range("AG37").Value
'                Sheets("KAY|fffd|TLAR").Range("AU" & a1).Value = Sheets("DataPort").Range("AH37").Value
'                Sheets("KAY|fffd|TLAR").Range("AV" & a1).Value = Sheets("DataPort").Range("AI37").Value
'                Sheets("KAY|fffd|TLAR").Range("AW" & a1).Value = Sheets("DataPort").Range("AJ37").Value
'                Sheets("KAY|fffd|TLAR").Range("AX" & a1).Value = Sheets("DataPort").Range("AK37").Value
'                Sheets("KAY|fffd|TLAR").Range("AY" & a1).Value = Sheets("DataPort").Range("AL37").Value
'                Sheets("KAY|fffd|TLAR").Range("AZ" & a1).Value = Sheets("DataPort").Range("AM37").Value
'                Sheets("KAY|fffd|TLAR").Range("BA" & a1).Value = Sheets("DataPort").Range("AN37").Value
'                Sheets("KAY|fffd|TLAR").Range("BB" & a1).Value = Sheets("DataPort").Range("AO37").Value
'                Sheets("KAY|fffd|TLAR").Range("BC" & a1).Value = Sheets("DataPort").Range("AP37").Value
'                Sheets("KAY|fffd|TLAR").Range("BD" & a1).Value = Sheets("DataPort").Range("AQ37").Value
'                Sheets("KAY|fffd|TLAR").Range("BE" & a1).Value = Sheets("DataPort").Range("AR37").Value
'                Sheets("KAY|fffd|TLAR").Range("BF" & a1).Value = Sheets("DataPort").Range("AS37").Value
'                Sheets("KAY|fffd|TLAR").Range("BG" & a1).Value = Sheets("DataPort").Range("AT37").Value
'                Sheets("KAY|fffd|TLAR").Range("BH" & a1).Value = Sheets("DataPort").Range("AU37").Value
'                Sheets("KAY|fffd|TLAR").Range("BI" & a1).Value = Sheets("DataPort").Range("AV37").Value
'                Sheets("KAY|fffd|TLAR").Range("BJ" & a1).Value = Sheets("DataPort").Range("AW37").Value
'                Sheets("KAY|fffd|TLAR").Range("BK" & a1).Value = Sheets("DataPort").Range("AX37").Value
'                Sheets("KAY|fffd|TLAR").Range("BL" & a1).Value = Sheets("DataPort").Range("AY37").Value
'                Sheets("KAY|fffd|TLAR").Range("BM" & a1).Value = Sheets("DataPort").Range("AZ37").Value
'                Sheets("KAY|fffd|TLAR").Range("BN" & a1).Value = Sheets("DataPort").Range("BA37").Value
'                Sheets("KAY|fffd|TLAR").Range("BO" & a1).Value = Sheets("DataPort").Range("BB37").Value
'                Sheets("KAY|fffd|TLAR").Range("BP" & a1).Value = Sheets("DataPort").Range("BC37").Value
'                Sheets("KAY|fffd|TLAR").Range("BQ" & a1).Value = Sheets("DataPort").Range("BD37").Value
'                Sheets("KAY|fffd|TLAR").Range("BR" & a1).Value = Sheets("DataPort").Range("BE37").Value
'                Sheets("KAY|fffd|TLAR").Range("BS" & a1).Value = Sheets("DataPort").Range("BF37").Value
           
            If x1 = 0 Then
            ThisWorkbook.Save
            x1 = ThisWorkbook.Sheets("Settings").Range("I1").Value
            Else
            End If
            x1 = x1 - 1
            a1 = a1 + 1

        Sheets("DataPort").Range("B37:B47").Copy Sheets("DataPort").Range("F37:F47")
        Sheets("DataPort").Range("B37:B47").ClearContents
        Sheets("DataPort").Range("K37:BF47").ClearContents

5:
        Set celPaste = fncelPasteOnStatistic
        sbSelectRangeWithSheetVisible celPaste
        Else
        If Sheets("DataPort").Cells(37, 2).Value = Sheets("Settings").Cells(1, 13).Value Then
GoTo 21:
        End If
        End If
        Next abc

    Next i
    
    If bShowBar Then Call MyProgresBar
    If bShowBar Then Unload frmStatusBar
    
    src = ThisWorkbook.Sheets("KAY|fffd|TLAR").Range("D" & Cells.Rows.Count).End(xlUp).Row
    ThisWorkbook.Sheets("KAY|fffd|TLAR").Range("B1:AC" & src).Sort Key1:=Sheets("KAY|fffd|TLAR").Columns("AB"), Header:=xlYes, Order1:=xlAscending
    zBitis = TimeValue(Now)
    MsgBox "MACLAR GUNCELLENDI BOL SANSLAR !" & Chr(10) & _
    "Ge|fffd|en S|fffd|re " & CDate(zBitis - ZBasla), vbInformation, " Sonu|fffd| Penceresi"
    Application.ScreenUpdating = False
End Sub


Sub getResults()
    On Error Resume Next
    lRetVal = MsgBox("Mac Sonuclarini |fffd|ekmek Istiyor Musun ?", vbYesNo + vbQuestion, "Mac Sonuclar|fffd| Cekme...")
    If lRetVal = vbNo Then
        Exit Sub
    End If
        If Worksheets("KAY|fffd|TLAR").AutoFilterMode = True Then
        Worksheets("KAY|fffd|TLAR").Rows.AutoFilter
        Else
        End If
    timezone = ThisWorkbook.Sheets("Settings").Range("B1").Value - 1
    dayzone = ThisWorkbook.Sheets("Settings").Range("D1").Value - 8
    sourcer = ThisWorkbook.Sheets("Settings").Range("F1").Value

    If sourcer = 1 Then
        sourcer = "soccerstand.com/"
        suffix = "_en_1_"
    End If
    Set HTTP = CreateObject("MSXML2.XMLHTTP")
    HTTP.Open "GET", "https://d." & sourcer & "x/feed/f_1_" & dayzone & "_" & timezone & suffix, False
    HTTP.setRequestHeader "X-Fsign", "SW9D1eZo"
    HTTP.Send
    fs_input = HTTP.ResponseText
    fs_rows = Split(fs_input, "~")
    fs_rows_length = UBound(fs_rows) - LBound(fs_rows)
    For i = 0 To fs_rows_length - 4
        fs_row = Split(fs_rows(i), "|fffd|")
        fs_row_length = UBound(fs_row) - LBound(fs_row)
        fs_index = Split(fs_row(0), ChrW(&HF7))
        If IsArray(fs_index) Then
            fs_index_name = fs_index(0)
            fs_index_value = fs_index(1)
        End If
        If fs_index_name = "SA" Then
            sport_id = fs_index_value
        ElseIf fs_index_name = "ZA" Then
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "ZA" Then tour_name = fs_row_parts(1)
                If fs_row_parts(0) = "ZB" Then country_id = fs_row_parts(1)
            Next j
        ElseIf fs_index_name = "AA" Then
            first_home = "": first_away = "": second_home = "": second_away = ""
            For j = 0 To fs_row_length - 1
                fs_row_parts = Split(fs_row(j), ChrW(&HF7))
                If fs_row_parts(0) = "AA" Then match_id = fs_row_parts(1)
                If fs_row_parts(0) = "BA" Then first_home = fs_row_parts(1)
                If fs_row_parts(0) = "BB" Then first_away = fs_row_parts(1)
                If fs_row_parts(0) = "BC" Then second_home = fs_row_parts(1)
                If fs_row_parts(0) = "BD" Then second_away = fs_row_parts(1)
                If fs_row_parts(0) = "AB" Then status_game = fs_row_parts(1)
                If fs_row_parts(0) = "AC" Then status_game_code = fs_row_parts(1)
            Next j
            Set fcell = ThisWorkbook.Sheets("KAY|fffd|TLAR").Columns("AC:AC").Find(match_id)
            rowindx = CStr(fcell.Row)
            If status_game = 3 And (status_game_code = 3 Or status_game_code = 10 Or status_game_code = 11) And first_home <> "" And second_home <> "" Then
                Sheets("KAY|fffd|TLAR").Range("B" & rowindx).Value = first_home & "-" & first_away
                Sheets("KAY|fffd|TLAR").Range("C" & rowindx).Value = (Val(first_home) + Val(second_home)) & "-" & (Val(first_away) + Val(second_away))
            End If
        End If
    rowindx = 0
    Next i
End Sub


Sub ClearPrevious()
Sheets("DataPort").Range("a2:AC35").ClearContents
Sheets("DataPort").Range("AE2:AM35").ClearContents
Sheets("DataPort").Range("AO2:AW35").ClearContents
Sheets("DataPort").Range("AY2:BG35").ClearContents
Sheets("DataPort").Range("b37:f47").ClearContents

End Sub
    
Sub ClearDataPort()
Sheets("DataPort").Range("a2:AC35").ClearContents
Sheets("DataPort").Range("AE2:AM35").ClearContents

End Sub

    
Function fncelPasteOnStatistic() As Range
    With Sheets("KAY|fffd|TLAR")
        Set fncelPasteOnStatistic = .Cells(.Rows.Count, "D").End(xlUp).Offset(1)
    End With
End Function
Sub sbSelectRangeWithSheetVisible(rng As Range)
    Dim ws As Worksheet
    Set ws = rng.Parent
    ws.Visible = xlSheetVisible
    ws.Activate
    rng.Select
End Sub
Sub ClearLIST()
    Dim lastRow As Long: lastRow = Range("KAY|fffd|TLAR!D2").End(xlDown).Row 'change to whatever column you have
    Dim i As Long
    Sheets("KAY|fffd|TLAR").Activate
    Range(Cells(2, 2), Cells(lastRow, 29)).ClearContents
End Sub



Attribute VB_Name = "Module2"
Sub eski()
    src = ThisWorkbook.Sheets("KAY|fffd|TLAR").Range("C" & Cells.Rows.Count).End(xlUp).Row
    dest = ThisWorkbook.Sheets("ARS|fffd|V").Range("C" & Cells.Rows.Count).End(xlUp).Row + 1
    ThisWorkbook.Sheets("KAY|fffd|TLAR").Range("A3:S" & src).Copy ThisWorkbook.Sheets("ARS|fffd|V").Range("A" & dest)
    MsgBox "ARSIV BASARI ILE KAYIT EDILMISTIR !", vbInformation, "ARSIV KAYDETME ISLEMI"
End Sub
Sub ClearArchive()
    src = ThisWorkbook.Sheets("ARS|fffd|V").Range("D" & Cells.Rows.Count).End(xlUp).Row
   
    ThisWorkbook.Sheets("ARS|fffd|V").Range("B2:AC" & src).ClearContents
    
End Sub
Sub copyToArchive()
Application.ScreenUpdating = False
Application.Calculation = xlManual
Dim Ws1 As Worksheet
Dim Ws2 As Worksheet
Set Ws1 = Sheets("KAY|fffd|TLAR")
Set Ws2 = Sheets("ARS|fffd|V")
UR1 = Ws1.Range("C" & Rows.Count).End(xlUp).Row
For RR1 = 2 To UR1
        If Ws1.Range("C" & RR1).Value <> "" Then
        UR2 = Ws2.Range("D" & Rows.Count).End(xlUp).Row + 1
        Ws1.Range("B" & RR1 & ":AC" & RR1).Copy
        Ws2.Range("B" & UR2).PasteSpecial Paste:=xlPasteValues
        End If
Next RR1
Application.CutCopyMode = False
Application.Calculation = xlAutomatic
Calculate
Application.ScreenUpdating = True
MsgBox "ARSIV BASARI ILE KAYIT EDILMISTIR !", vbInformation, "ARSIV KAYDETME ISLEMI"
End Sub



Attribute VB_Name = "Module____3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Module____5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sayfa7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "frmStatusBar"
Attribute VB_Base = "0{A692EE80-2549-47C6-8BD4-A977A5E9A894}{F5988545-99BD-4B2F-9FE9-3963AF05DDC5}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




'---------------------------------------------------------------------------------------
' Module    : frmStatusBar
' Author    : The_Prist (|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
' Purpose   : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'            (|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| 300 |fffd||fffd||fffd||fffd||fffd|)
'---------------------------------------------------------------------------------------

Private Sub UserForm_Initialize()
10        FrameProgress.Width = 0.0001
End Sub
Attribute VB_Name = "mCustomProgressBarModule"
'---------------------------------------------------------------------------------------
' Author    : The_Prist(|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|)
'             WebMoney - R298726502453; |fffd||fffd||fffd||fffd||fffd||fffd|.|fffd||fffd||fffd||fffd||fffd||fffd| - 41001332272872
'             http://www.excel-vba.ru
' Purpose   : |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
'---------------------------------------------------------------------------------------
Option Explicit
Public bShowBar As Boolean
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public dblProgressWidth As Double, dblStep As Double, dblPercent As Double
'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Sub MyProgresBar()
    dblProgressWidth = dblProgressWidth + dblStep
    frmStatusBar.FrameProgress.Width = dblProgressWidth
    If dblProgressWidth > dblPercent Then
        frmStatusBar.lblPercentWhite.Caption = Format(dblPercent / frmStatusBar.FramePrgBar.Width, "0%")
        frmStatusBar.lblPercentBlack.Caption = frmStatusBar.lblPercentWhite.Caption
        dblPercent = dblPercent + dblStep
        frmStatusBar.Repaint
        DoEvents
    End If
End Sub
Function Show_PrBar_Or_No(lCnt As Long, Optional sUfCaption As String = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|...")
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| 10 |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    bShowBar = (lCnt > 10)
    If bShowBar = False Then Exit Function
    
    frmStatusBar.Caption = sUfCaption
    dblStep = frmStatusBar.FramePrgBar.Width / lCnt
    frmStatusBar.lblPercentWhite.Left = 96
    frmStatusBar.lblPercentBlack.Left = frmStatusBar.lblPercentWhite.Left
    
    frmStatusBar.Show 0
    dblPercent = 0: dblProgressWidth = 0
End Function


INQUEST-PP=macro
