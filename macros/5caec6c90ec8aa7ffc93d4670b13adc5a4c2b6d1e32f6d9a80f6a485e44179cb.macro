Attribute VB_Name = "Module1"
Option Explicit

Sub main()

Dim nrec() As String

Open "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\duravit\2016\no6.csv" For Input As #1
Open "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\duravit\2016\no6-rabatt.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, tmp
    aRec = Split(tmp, ";")
    ReDim nrec(UBound(aRec))
    For i = 0 To UBound(aRec)
        If i = 0 Then nrec(i) = "35" Else nrec(i) = aRec(i)
    Next i
    
    For i = 0 To UBound(nrec)
      tmp2 = tmp2 & nrec(i) & ";"
    Next i
    Print #2, tmp2
Loop

Close #1: Close #2

End Sub
Sub Upcase()

Dim nrec() As String

Dim fn1 As String
fn1 = "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\villeroy & boch\VB og GBG  prisfil 2016"
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, tmp
    tmp = UCase$(tmp)
    Print #2, tmp
Loop

Close #1: Close #2

End Sub

Sub FAP()

Dim nrec() As String
Dim lc As Integer
Dim plc As Integer
Dim fn1 As String
fn1 = "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\fap italia\FAP_EURO_Gennaio_2016"
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, tmp
    lc = lc + 1
    If Mid$(tmp, 1, 1) = "f" Then
        tmp = UCase$(tmp)
        plc = plc + 1
        Print #2, tmp
    End If
Loop
Debug.Print "Lines: " & lc & ", prods = " & plc
Close #1: Close #2

End Sub

Sub Rondine()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
fn1 = "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\rondine\LISTINO RONDINE 2016_Kalkulert"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    products_written = products_written + 1
    aRec = Split(sTmp1, ";")
    If aRec(4) = "m2" Then aRec(4) = "m2"
    If aRec(16) = "" Then
        aRec(16) = aRec(15)
        If products_written < 100 Then Debug.Print "Linje: " & products_written & " - Kolonne Q = blank, satt til verdi " & aRec(15) & " fra kolonne P"
        lmod = lmod + 1
    End If
    
    'Debug.Print sTmp1
    sTmp2 = ""
    For i = 0 To UBound(aRec)
        If sTmp2 <> "" Then sTmp2 = sTmp2 & ";" & aRec(i) Else sTmp2 = aRec(i)
    Next i
    'Debug.Print sTmp2
    Print #2, sTmp2
    
Loop

Debug.Print "Total: " & products_written & ", mod = " & lmod
Close #1: Close #2


End Sub


Sub genEAN()

pfx = "608"
lev = "68"
maxrecs = 80

Open "c:\temp\ean.txt" For Output As #1

For i = 1 To maxrecs
    a = Right("00000000" & i, 8)
    Print #1, pfx & lev & a
Next i

Close #1

End Sub

Sub Flaviker()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
fn1 = "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\flaviker\priser flaviker 2016\Listino Excel FLAVIKER 2016"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)
' 0 + 3 + 6 + 8 = beskrivelse
    Line Input #1, sTmp1
    products_written = products_written + 1
    aRec = Split(sTmp1, ";")
    newrec = sTmp1 & ";" & aRec(0) & " " & aRec(3) & " " & aRec(6) & " " & aRec(8)
    Print #2, newrec
    
Loop

'Debug.Print "Total: " & products_written & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub HansGrohe()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\hansgrohe\pris 2018\NO hansgrohe_AXOR_Prisliste_2018"

'HG-nr.  Nrf nummer  EAN-nr. Materialekorttekst   Pris pr. 01.01.2018 ekskl. moms    Valuta
'0       1           2       3                    4

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom i pris
    '--------------------------------------------------------------------------
    aRec(4) = Replace(aRec(4), " ", "")
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
'    dp1 = CDbl(aRec(4))
'    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
    
    newrec = aRec(0) & ";" & aRec(3) & ";STK;" & aRec(4)
    Print #2, newrec
    iOutlines = iOutlines + 1
    
Loop

Debug.Print Now & " Total: " & iOutlines  ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub Scala()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\norinnredning\SCALA BAD"
'ABCDEFGHI
'0123456789
'
'A D stk E (eks mva)
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    products_written = products_written + 1
    aRec = Split(sTmp1, ";")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    'aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom i pris
    '--------------------------------------------------------------------------
    'aRec(4) = Replace(aRec(4), " ", "")
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
'    dp1 = CDbl(aRec(4))
    'sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
    
    If aRec(2) <> "" Then
        newrec = aRec(0) & ";" & aRec(1) & ";stk;" & aRec(2)
        Print #2, newrec
    Else
        Debug.Print "Nada: " & sTmp1
    End If
Loop

Debug.Print Now & " Total: " & products_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub



Sub Unidrain()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Unidrain\Bad og Flis 2017"
'ABCDEFGHIJ
'0123456789

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    'aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom i pris
    '--------------------------------------------------------------------------
    'aRec(4) = Replace(aRec(4), " ", "")
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
    ' dp1 = CDbl(aRec(4))
    ' sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
    
    If aRec(9) <> "" Then
        newrec = aRec(1) & ";" & aRec(2) & ";stk;" & aRec(9)
        Print #2, newrec
        products_written = products_written + 1
    Else
        Debug.Print "Priskolonne: '" & aRec(9) & "', string=" & sTmp1
    End If
Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub


Sub BathRoomBrands()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String

' 1 = Varekode
' 2 = Beskrivelse
' 3 = Enhet
' 4 = Listepris

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\burlington"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\arcade"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\clearwater"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\britton"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\cleargreen"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\aqua"
GoTo xxx
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\bathroomsbrand\zamori"

'ABCDEFGHIJ
'0123456789
xxx:
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    
    aRec = Split(sTmp1, ";")
    'aRec(3) = Replace(aRec(3), ",", ".")
    
    eur = CDbl(aRec(3))
    nok = eur * 9.45
    sTmp2 = Format$(CStr(nok), "##############") & ",00"
    
    'Debug.Print sTmp2
    sOutrec = aRec(0) & ";" & aRec(1) & ";stk;" & sTmp2
    Print #2, sOutrec
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom i pris
    '--------------------------------------------------------------------------
    'aRec(4) = Replace(aRec(4), " ", "")
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
    ' dp1 = CDbl(aRec(4))
    ' sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
    If UBound(aRec) <> 6 Then
        'Print #2, "Error line: " & lcnt & " Text=" & sTmp1
        err_cnt = err_cnt + 1
    Else
        'Print #2, "OK line: " & lcnt & " Text=" & sTmp1
        ok_cnt = ok_cnt + 1
    End If
    
'    If aRec(9) <> "" Then
'        newrec = aRec(1) & ";" & aRec(2) & ";stk;" & aRec(9)
'        Print #2, newrec
'        products_written = products_written + 1
'    Else
'        Debug.Print "Priskolonne: '" & aRec(9) & "', string=" & sTmp1
'    End If
Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt
Debug.Print "[" & Now & "] Err=" & err_cnt & ", OK=" & ok_cnt

Close #1: Close #2


End Sub

Sub FAP_New()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim bSkipRec As Boolean
Dim sSpecialDesc As String
Dim iSkipped_recs As Integer



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\fap italia\EURO_OTTOBRE_17_comm"


Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2
Open fn1 & "_error.txt" For Output As #3

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    'sTmp1 = Replace(sTmp1, "|fffd|", "")
    'sTmp1 = Replace(sTmp1, "|fffd|", "")
    
    aRec = Split(sTmp1, ";")
    'aRec(3) = Replace(aRec(3), ",", ".")
    sUnit = Trim$(UCase$(aRec(3)))
    If Mid$(sUnit, 1, 3) = "MIX" Then sUnit = "MIX"
    
    eur = 0
    nok = 0
    Select Case sUnit
        Case "M|fffd|", "M2"
            sOutUnit = "M2"
            eur = CDbl(aRec(4))
            
        Case "PZ PC", "ML", "MIX"
            sOutUnit = "STK"
            eur = CDbl(aRec(5))
                        
        Case Else
            bSkipRec = True
            iSkipped_recs = iSkipped_recs + 1
    End Select
    

    If Not bSkipRec Then
        If eur <> 0 Then
            nok = eur * 9.55
            sTmp2 = Format$(CStr(nok), "##############") & ",00"
            If aRec(7) <> "" Then sSpecialDesc = "(" & aRec(7) & ")" Else sSpecialDesc = ""
            sOutrec = aRec(0) & ";" & Trim$(aRec(1)) & " " & Trim$(aRec(2)) & " " & sSpecialDesc & ";" & sOutUnit & ";" & sTmp2
            Print #2, sOutrec
            products_written = products_written + 1
        
        End If
    Else
        Print #3, "Skipped: " & sTmp1
    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt
Debug.Print "[" & Now & "] Skipped recs: " & iSkipped_recs

Close #1: Close #2: Close #3


End Sub


Sub Flaviker_New()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\flaviker\priser 2017\Listino FLP 2017 ufficiale"

'ABCDEFGHIJ
'0123456789

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    'sTmp1 = Replace(sTmp1, "|fffd|", "")
    'sTmp1 = Replace(sTmp1, "|fffd|", "")
    
    aRec = Split(sTmp1, ";")
    'aRec(3) = Replace(aRec(3), ",", ".")
    sUnit = Trim$(UCase$(aRec(7)))
    ' b = art
    ' c + " " + minus mellom i desc + d + " " + j
    ' cnf = stk
    '
    
    eur = 0
    nok = 0
    Select Case sUnit
        Case "M|fffd|", "M2"
            'Debug.Print "M|fffd|"
            sOutUnit = "M2"
            eur = CDbl(aRec(4))
            
        Case "PZ", "CNF"
            'Debug.Print "PZ PC"
            sOutUnit = "STK"
            eur = CDbl(aRec(4))
                        
        Case Else
            Print #2, "Line: " & lcnt & ", verdi=" & sUnit & ", line=" & sTmp1
    End Select
    
'a d b+c + "  " +h
' d=enh
'fNKU    COLOR LINE BEIGE    25X75   M2   50,60  46,00   6   1,125   16,80   54  60,75
'  (1,125 pakke)
'
'Hvis m2 er pris i kol. E
'Hvis unit = pz, pris i kol F

    If eur <> 0 Then
        nok = eur * 9.45
        sTmp2 = Format$(CStr(nok), "##############") & ",00"
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        If aRec(3) <> "" Then sSpecialDesc = "(" & aRec(3) & ")" Else sSpecialDesc = ""
        sOutrec = aRec(1) & ";" & Trim$(aRec(2)) & " " & sSpecialDesc & " " & aRec(9) & ";" & sOutUnit & ";" & sTmp2
        Print #2, sOutrec
        products_written = products_written + 1
    
    End If
    


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub
Sub Flaviker_Newer()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\flaviker\pris 2018\List_FLP_20180112"
'ABCDEFGHIJ
'0123456789

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)
'Serie   T.m.    Materiale   Descrizione Formato Importo VAL per UM  Stato   PZ/SC   M2/SC   KG/SC   SC/PL   M2/PL   KG/PL   Codice EAN/UPC  Codice Merceologico
'0       1       2           3           4       5       6   7   8   9       10      11      12      13      14      15      16              17
    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern spaces
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    
    aRec = Split(sTmp1, ";")
    'aRec(3) = Replace(aRec(3), ",", ".")
    sUnit = Trim$(UCase$(aRec(8)))
    
    eur = 0
    nok = 0
    Select Case sUnit
        Case "M|fffd|", "M2"
            sOutUnit = "M2"
            sSpecialDesc = "(" & aRec(11) & " M2, " & aRec(12) & " KG)"
        Case "PZ", "CNF"
            sOutUnit = "STK"
            sSpecialDesc = "(" & aRec(10) & " STK)"
                        
        Case Else
            Debug.Print "Line: " & lcnt & ", verdi=" & sUnit & ", line=" & sTmp1
    End Select
    
    eur = CDbl(aRec(5))

    If eur <> 0 Then
        nok = eur * 9.55
        sTmp2 = Format$(CStr(nok), "##############") & ",00"
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        
        sOutrec = aRec(2) & ";" & Trim$(aRec(3)) & " " & sSpecialDesc & ";" & sOutUnit & ";" & sTmp2
        Print #2, sOutrec
        
        products_written = products_written + 1
    
    End If
    


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub


Sub Cosmic()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\icosmos\2017 COSMIC PRICE LIST EXPORT_A 20.03.17"
'fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\icosmos\xxx"

'ABCDEFGHIJ
'0123456789
' b+c+f+g
' pris=e
' alt i stk
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    aRec = Split(sTmp1, ";")
    
    sTmp2 = aRec(4) ' Se etter verdi i eur kolonne
    If (sTmp2 <> "") And IsNumeric(sTmp2) Then
    
        sOutrec = aRec(0) & ";" & aRec(1) & " " & aRec(2) & " " & aRec(5) & " " & aRec(6) & ";" & "STK;"
        
        eur = 0
        nok = 0
        
        eur = CDbl(aRec(4))
        
        If eur <> 0 Then
            nok = eur * 9.45
            sTmp2 = Format$(CStr(nok), "##############") & ",00"
            sOutrec = sOutrec & sTmp2
            Print #2, sOutrec
            products_written = products_written + 1
        Else
            Debug.Print "Mangler eller NULL EUR i rec# " & lcnt & " (" & sTmp1 & ")"
        
        End If
    Else
       Debug.Print "Ingen verdi i prisfelt, rec# " & lcnt & " (" & sTmp1 & ")"
    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub Pompdor()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\icosmos\2017 POMDOR PRICE LIST EXPORT_A 23.03.17"

'ABCDEFGHIJ
'0123456789
' b+c+f+g
' pris=e
' alt i stk
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    aRec = Split(sTmp1, ";")
    
    sTmp2 = aRec(4) ' Se etter verdi i eur kolonne
    If (sTmp2 <> "") And IsNumeric(sTmp2) Then
    
        sOutrec = aRec(0) & ";" & aRec(1) & " " & aRec(2) & " " & aRec(5) & " " & aRec(6) & ";" & "STK;"
        
        eur = 0
        nok = 0
        
        eur = CDbl(aRec(4))
        
        If eur <> 0 Then
            nok = eur * 9.45
            sTmp2 = Format$(CStr(nok), "##############") & ",00"
            sOutrec = sOutrec & sTmp2
            Print #2, sOutrec
            products_written = products_written + 1
        Else
            Debug.Print "Mangler eller NULL EUR i rec# " & lcnt & " (" & sTmp1 & ")"
        
        End If
    Else
       Debug.Print "Ingen verdi i prisfelt, rec# " & lcnt & " (" & sTmp1 & ")"
    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub BathPlus()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\icosmos\2017 BATH+ PRICE LIST EXPORT_A 28.08.17"

'ABCDEFGHIJ
'0123456789
' b+c+f+g
' pris=e
' alt i stk
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    aRec = Split(sTmp1, ";")
    
    sTmp2 = aRec(4) ' Se etter verdi i eur kolonne
    If (sTmp2 <> "") And IsNumeric(sTmp2) Then
    
        sOutrec = aRec(0) & ";" & aRec(1) & " " & aRec(2) & " " & aRec(5) & " " & aRec(6) & ";" & "STK;"
        
        eur = 0
        nok = 0
        
        eur = CDbl(aRec(4))
        
        If eur <> 0 Then
            nok = eur * 9.45
            sTmp2 = Format$(CStr(nok), "##############") & ",00"
            sOutrec = sOutrec & sTmp2
            Print #2, sOutrec
            products_written = products_written + 1
        Else
            Debug.Print "Mangler eller NULL EUR i rec# " & lcnt & " (" & sTmp1 & ")"
        
        End If
    Else
       Debug.Print "Ingen verdi i prisfelt, rec# " & lcnt & " (" & sTmp1 & ")"
    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub Holtan()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim sDesc As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\holtan nordmark\Prisfil, Holtan, 2017"

'ABCDEFGHIJ
'0123456789
' b+c+f+g
' pris=e
' alt i stk
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2


' Varenr.;Beskrivelse;Utsalgspris eks.mva.
'DX = h|fffd|yre
'SX = venstre

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    aRec = Split(sTmp1, ";")
    sDesc = aRec(1)
    
    If InStr(1, sDesc, "DX") > 0 Then
        Debug.Print "DX: Before: " & sDesc
        sDesc = Replace(aRec(1), "DX", "(h|fffd|yre)")
        Debug.Print "     After: " & sDesc
    End If
    
    If InStr(1, sDesc, "SX") > 0 Then
        Debug.Print "SX: Before: " & sDesc
        sDesc = Replace(aRec(1), "SX", "(venstre)")
        Debug.Print "     After: " & sDesc
    End If
    
    sOutrec = aRec(0) & ";" & sDesc & ";" & aRec(2) & ";" & "STK;"
    Print #2, sOutrec
    
'    eur = 0
'    nok = 0
'
'    eur = CDbl(aRec(4))
'
'    If eur <> 0 Then
'        nok = eur * 9.45
'        sTmp2 = Format$(CStr(nok), "##############") & ",00"
'        sOutrec = sOutrec & sTmp2
'        Print #2, sOutrec
'        products_written = products_written + 1
'    Else
'        Debug.Print "Mangler eller NULL EUR i rec# " & lcnt & " (" & sTmp1 & ")"
'
'    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub FjernDrittOgLortiExcel()
    Dim MyRange As Range
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
 
    For Each MyRange In ActiveSheet.UsedRange
        If 0 < InStr(MyRange, Chr(10)) Then
            MyRange = Replace(MyRange, Chr(10), "")
        End If
        If 0 < InStr(MyRange, Chr(11)) Then
            MyRange = Replace(MyRange, Chr(11), "")
        End If
        If 0 < InStr(MyRange, Chr(13)) Then
            MyRange = Replace(MyRange, Chr(13), "")
        End If
    Next
 
    Application.ScreenUpdating = True
    Application.Calculation = xlCalculationAutomatic
End Sub

Sub Spesialverktoy()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\spesialverkt|fffd|y\Prisliste brutto 01042017-2"

'ABCDEFGHIJ
'0123456789
' b+c+f+g
' pris=e
' alt i stk
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    aRec = Split(sTmp1, ";")
    
    sTmp2 = aRec(0) ' Se etter verdi i produktnr-kolonne
    If (sTmp2 <> "") Then
    
        sOutrec = aRec(0) & ";" & aRec(2) & ";" & UCase$(aRec(3)) & ";" & aRec(6)
        
        Print #2, sOutrec
        products_written = products_written + 1
    Else
       Debug.Print "Ingen verdi i produkrnr.-felt, rec# " & lcnt & " (" & sTmp1 & ")"
    End If


Loop

Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub Clearwater()

' Arcade Burlington Clearwater
' Clearwater + kolonne = transport, f|fffd|rste 38 linjer skal ha + transport
'1800180;HG iBox Universal u. lekkasjesikring;STK;1541,00

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer

Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Bathroombrands\priser 2018\clearwater"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
'Line Input #1, sTmp1
' Pund = * 11

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    If aRec(1) <> "" Then
        'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        'aRec(3) = Replace(aRec(3), """", "")
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), "|fffd|", "")
        dp1 = CDbl(aRec(3)) * 11
        dp1 = Format(dp1, "####################")
        '--------------------------------------------------------------------------
        ' Legg p|fffd| fortjeneste
        '--------------------------------------------------------------------------
    '    dp1 = CDbl(aRec(4))
    '    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
        If Mid$(aRec(1), 1, 1) = "N" Then
            Debug.Print dp1
            dp1 = dp1 + 3000
            Debug.Print dp1
            iAdd = iAdd + 1
            
        End If
        newrec = aRec(1) & ";" & aRec(2) & ";stk;" & CStr(dp1) & ",00" ' aRec(3)
        Print #2, newrec
        iOutlines = iOutlines + 1
    Else
        'Debug.Print "Skipped: " & sTmp1
    
    End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub
Sub Burlington()

' Arcade Burlington Clearwater
' Clearwater + kolonne = transport, f|fffd|rste 38 linjer skal ha + transport
'1800180;HG iBox Universal u. lekkasjesikring;STK;1541,00

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer

Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Bathroombrands\priser 2018\burlington"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
'Line Input #1, sTmp1
' Pund = * 11

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    If aRec(1) <> "" Then
        aRec(1) = Replace(aRec(1), " ", "")
        aRec(1) = Replace(aRec(1), " ", "")
        'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        'aRec(3) = Replace(aRec(3), """", "")
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), "|fffd|", "")
        dp1 = CDbl(aRec(3)) * 11
        dp1 = Format(dp1, "####################")
        '--------------------------------------------------------------------------
        ' Legg p|fffd| fortjeneste
        '--------------------------------------------------------------------------
    '    dp1 = CDbl(aRec(4))
    '    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
'        If Mid$(aRec(1), 1, 1) = "N" Then
'            Debug.Print dp1
'            dp1 = dp1 + 3000
'            Debug.Print dp1
'            iAdd = iAdd + 1
'
'        End If
        newrec = aRec(1) & ";" & aRec(2) & ";stk;" & CStr(dp1) & ",00" ' aRec(3)
        Print #2, newrec
        iOutlines = iOutlines + 1
    Else
        Debug.Print "Skipped: " & sTmp1
    
    End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub


Sub Arcade()

' Arcade Burlington Clearwater
' Clearwater + kolonne = transport, f|fffd|rste 38 linjer skal ha + transport
'1800180;HG iBox Universal u. lekkasjesikring;STK;1541,00

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer

Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Bathroombrands\priser 2018\arcade"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
'Line Input #1, sTmp1
' Pund = * 11

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    If aRec(1) <> "" Then
        aRec(1) = Replace(aRec(1), " ", "")
        aRec(1) = Replace(aRec(1), " ", "")
        'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        'aRec(3) = Replace(aRec(3), """", "")
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), " ", "")
        aRec(3) = Replace(aRec(3), "|fffd|", "")
        dp1 = CDbl(aRec(3)) * 11
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
        '--------------------------------------------------------------------------
        ' Legg p|fffd| fortjeneste
        '--------------------------------------------------------------------------
    '    dp1 = CDbl(aRec(4))
    '    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
'        If Mid$(aRec(1), 1, 1) = "N" Then
'            Debug.Print dp1
'            dp1 = dp1 + 3000
'            Debug.Print dp1
'            iAdd = iAdd + 1
'
'        End If
        newrec = aRec(1) & ";" & aRec(2) & ";stk;" & CStr(dp1) & ",00" ' aRec(3)
        Print #2, newrec
        iOutlines = iOutlines + 1
    Else
        Debug.Print "Skipped: " & sTmp1
    
    End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub

Sub Colorker_1()


' CO+code
'
Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim desc As String

Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\colorker\colorker"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    desc = Trim$(aRec(1)) & " " & Trim$(aRec(2)) & " " & Trim$(aRec(3)) & " " & Trim$(aRec(0)) & " (m2/box " & aRec(7) & ")"
    
    'aRec(1) = Replace(aRec(1), " ", "")
    'aRec(1) = Replace(aRec(1), " ", "")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    'aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom og |fffd| i pris
    '--------------------------------------------------------------------------
    ' Kolonne 5
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), "|fffd|", "")
    dp1 = CDbl(aRec(5)) * 9.5
    If dp1 > 0 Then dp1 = Format(dp1, "####################")
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
'    dp1 = CDbl(aRec(4))
'    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
'        If Mid$(aRec(1), 1, 1) = "N" Then
'            Debug.Print dp1
'            dp1 = dp1 + 3000
'            Debug.Print dp1
'            iAdd = iAdd + 1
'
'        End If
    newrec = "CO" & aRec(15) & ";" & desc & ";m2;" & CStr(dp1) & ",00"
    Print #2, newrec
    iOutlines = iOutlines + 1

Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub


Sub Colorker_2()


' CO+code
'
Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim desc As String
Dim sUnit As String
Dim iOutlines As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\colorker\zyx"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11

Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    If Trim$(UCase$(aRec(4))) = "M2" Then
        desc = Trim$(aRec(0)) & " " & Trim$(aRec(1)) & " " & Trim$(aRec(3)) & " " & Trim$(aRec(0)) & " (m2/boks: " & aRec(8) & ")"
        sUnit = "m2"
    Else
        desc = Trim$(aRec(0)) & " " & Trim$(aRec(1)) & " " & Trim$(aRec(3)) & " " & Trim$(aRec(0)) & " (stk/eske: " & aRec(7) & ")"
        sUnit = "stk"
    End If
    'aRec(1) = Replace(aRec(1), " ", "")
    'aRec(1) = Replace(aRec(1), " ", "")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    'aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom og |fffd| i pris
    '--------------------------------------------------------------------------
    ' Kolonne 5
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), "|fffd|", "")
    dp1 = CDbl(aRec(5)) * 9.5
    If dp1 > 0 Then dp1 = Format(dp1, "####################")
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
'    dp1 = CDbl(aRec(4))
'    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
'        If Mid$(aRec(1), 1, 1) = "N" Then
'            Debug.Print dp1
'            dp1 = dp1 + 3000
'            Debug.Print dp1
'            iAdd = iAdd + 1
'
'        End If
    newrec = "CO" & aRec(2) & ";" & desc & ";" & sUnit & ";" & CStr(dp1) & ",00"
    Print #2, newrec
    iOutlines = iOutlines + 1

Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub

Sub Emil()


' CO+code
'
Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim desc As String
Dim sUnit As String
Dim iOutlines As Integer
Dim iPrNo As Integer

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\emil\emil"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
' Line Input #1, sTmp1
' Pund = * 11

iPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    
    desc = Trim$(aRec(1)) & " " & Trim$(aRec(2)) & " " & Trim$(aRec(3))
    '**  For 120x240 6 mm, we charge 120 euro for each wooden crate (packaging)
    
    'aRec(1) = Replace(aRec(1), " ", "")
    'aRec(1) = Replace(aRec(1), " ", "")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    'aRec(3) = Replace(aRec(3), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom og |fffd| i pris
    '--------------------------------------------------------------------------
    ' Kolonne 5
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), " ", "")
    aRec(5) = Replace(aRec(5), "*", "")
    aRec(5) = Replace(aRec(5), "*", "")
    dp1 = CDbl(aRec(5)) * 9.5
    If dp1 > 0 Then dp1 = Format(dp1, "####################")
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
'    dp1 = CDbl(aRec(4))
'    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
'        If Mid$(aRec(1), 1, 1) = "N" Then
'            Debug.Print dp1
'            dp1 = dp1 + 3000
'            Debug.Print dp1
'            iAdd = iAdd + 1
'
'        End If
    newrec = "EMIL" & iPrNo & ";" & desc & ";stk.;" & CStr(dp1) & ",00"
    iPrNo = iPrNo + 1
    Print #2, newrec
    iOutlines = iOutlines + 1

Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub

Sub mapei_08042018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim iOutlines As Integer
Dim iPrNo As Integer
Dim sNewrec As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Mapei\pris 2018\2018"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
' Line Input #1, sTmp1
' Pund = * 11

iPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes i beskrivelse
    '--------------------------------------------------------------------------
    aRec(1) = Replace(aRec(1), """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom og |fffd| i pris
    '--------------------------------------------------------------------------
    'aRec(5) = Replace(aRec(5), " ", "")
    'aRec(5) = Replace(aRec(5), " ", "")
    'aRec(5) = Replace(aRec(5), "*", "")
    'aRec(5) = Replace(aRec(5), "*", "")
    
    'dp1 = CDbl(aRec(5)) * 9.5
    'If dp1 > 0 Then dp1 = Format(dp1, "####################")
    dp1 = Format(aRec(13), "####################.00")
    sUnit = aRec(4)
    
    '--------------------------------------------------------------------------
    ' Legg p|fffd| fortjeneste
    '--------------------------------------------------------------------------
    '    dp1 = CDbl(aRec(4))
    '    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
    '        If Mid$(aRec(1), 1, 1) = "N" Then
    '            Debug.Print dp1
    '            dp1 = dp1 + 3000
    '            Debug.Print dp1
    '            iAdd = iAdd + 1
    '
    '        End If
    'Debug.Print CStr(dp1) & "---" & CStr(dp1) ' & ",00"
    
    sNewrec = aRec(0) & ";" & aRec(1) & ";" & aRec(4) & ";" & CStr(dp1)
    
    iPrNo = iPrNo + 1
    Print #2, sNewrec
    iOutlines = iOutlines + 1

Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub

Sub Eurobagno_08042018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim iOutlines As Integer
Dim iPrNo As Integer
Dim sNewrec As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\eurobagno\priser\2018\parigi_may"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
' Line Input #1, sTmp1
' Pund = * 11

iPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(9), """", "")
        
        sUnit = UCase$(Trim$(aRec(15)))
        If sUnit = "PZ" Then sUnit = "stk."
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        'aRec(5) = Replace(aRec(5), " ", "")
        'aRec(5) = Replace(aRec(5), " ", "")
        'aRec(5) = Replace(aRec(5), "*", "")
        'aRec(5) = Replace(aRec(5), "*", "")
        
'       dp1 = CDbl(aRec(5)) * 9.5
'       If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        
        dp1 = CDbl(aRec(17)) * 9.5
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        '--------------------------------------------------------------------------
        ' Legg p|fffd| fortjeneste
        '--------------------------------------------------------------------------
        '    dp1 = CDbl(aRec(4))
        '    sTmp2 = Format$(CStr(dp1 * 1.43), "##############")
        '        If Mid$(aRec(1), 1, 1) = "N" Then
        '            Debug.Print dp1
        '            dp1 = dp1 + 3000
        '            Debug.Print dp1
        '            iAdd = iAdd + 1
        '
        '        End If
        'Debug.Print CStr(dp1) & "---" & CStr(dp1) ' & ",00"
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        iPrNo = iPrNo + 1
        Print #2, sNewrec
        iOutlines = iOutlines + 1
    Else
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd
Close #1: Close #2


End Sub


Sub Bathroombrands_22052018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim iOutlines As Integer
Dim iPrNo As Integer
Dim sNewrec As String
Dim iSkipRec As Integer


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Bathroombrands\priser 2018\bathroombrands_may"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
' Line Input #1, sTmp1
' Pund = * 11

iPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(2) = Trim$(Replace(aRec(2), "#", ""))
        
        If Not IsNumeric(aRec(8)) Then
            Debug.Print "Skipped record " & sTmp1
            iSkipRec = iSkipRec + 1
            
        Else
                '--------------------------------------------------------------------------
                ' Fjern Quotes i beskrivelse
                '--------------------------------------------------------------------------
                sDesc = Replace(aRec(10), """", "")
                
                'sUnit = UCase$(Trim$(aRec(15)))
                'If sUnit = "PZ" Then sUnit = "stk."
                sUnit = "stk."
                '--------------------------------------------------------------------------
                ' Fjern mellomrom og |fffd| i pris
                '--------------------------------------------------------------------------
                'aRec(5) = Replace(aRec(5), " ", "")
                'aRec(5) = Replace(aRec(5), " ", "")
                'aRec(5) = Replace(aRec(5), "*", "")
                'aRec(5) = Replace(aRec(5), "*", "")
                
            '       dp1 = CDbl(aRec(5)) * 9.5
            '       If dp1 > 0 Then dp1 = Format(dp1, "####################")
                
                
                dp1 = CDbl(aRec(8)) * 11
                If dp1 > 0 Then dp1 = Format(dp1, "####################")
                
                
                sNewrec = aRec(2) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
                
                iPrNo = iPrNo + 1
                Print #2, sNewrec
                iOutlines = iOutlines + 1
            End If
        End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub


Sub Clearwater_22052018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim iOutlines As Integer
Dim iPrNo As Integer
Dim sNewrec As String
Dim iSkipRec As Integer


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Bathroombrands\priser 2018\clearwater_may"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
' Line Input #1, sTmp1
' Pund = * 11

iPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(2) = Trim$(Replace(aRec(2), "#", ""))
        
        If Not IsNumeric(aRec(8)) Then
            Debug.Print "Skipped record " & sTmp1
            iSkipRec = iSkipRec + 1
            
        Else
                '--------------------------------------------------------------------------
                ' Fjern Quotes i beskrivelse
                '--------------------------------------------------------------------------
                sDesc = Replace(aRec(10), """", "")
                
                'sUnit = UCase$(Trim$(aRec(15)))
                'If sUnit = "PZ" Then sUnit = "stk."
                sUnit = "stk."
                '--------------------------------------------------------------------------
                ' Fjern mellomrom og |fffd| i pris
                '--------------------------------------------------------------------------
                'aRec(5) = Replace(aRec(5), " ", "")
                'aRec(5) = Replace(aRec(5), " ", "")
                'aRec(5) = Replace(aRec(5), "*", "")
                'aRec(5) = Replace(aRec(5), "*", "")
                
            '       dp1 = CDbl(aRec(5)) * 9.5
            '       If dp1 > 0 Then dp1 = Format(dp1, "####################")
                
                
                dp1 = CDbl(aRec(8)) * 11
                
                ' Legg til kr.3000 p|fffd| N-produkter
                If Mid$(aRec(2), 1, 1) = "N" Then
                    Debug.Print "Lagt til kr. 3000 p|fffd| produkt " & aRec(2) & " (" & sDesc & ")" 'dp1
                    dp1 = dp1 + 3000
                    'Debug.Print dp1
                    iAdd = iAdd + 1
                    
                End If
                
                If dp1 > 0 Then dp1 = Format(dp1, "####################")
                
                
                sNewrec = aRec(2) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
                
                iPrNo = iPrNo + 1
                Print #2, sNewrec
                iOutlines = iOutlines + 1
            End If
        End If
    
Loop

Debug.Print Now & " Total: " & iOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Villeroy_22052018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\villeroy & boch\pris 2018\Kopi av Offisiell pris fil 2018  med og uten MVA"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(2), """", "")
        
        sUnit = UCase$(Trim$(aRec(3)))
        If sUnit = "SET" Then sUnit = "sett" Else sUnit = "stk."
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        'aRec(5) = Replace(aRec(5), " ", "")
        'aRec(5) = Replace(aRec(5), " ", "")
        'aRec(5) = Replace(aRec(5), "*", "")
        'aRec(5) = Replace(aRec(5), "*", "")
        
    '       dp1 = CDbl(aRec(5)) * 9.5
    '       If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        
        dp1 = CDbl(aRec(13)) ' * 11
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub


Sub Holtan_14062018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\holtan nordmark\Prisfil Novellini 2018"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(2), """", "")
        sDesc = Replace(aRec(2), "  ", " ")
        
        sUnit = UCase$(Trim$(aRec(3)))
        If sUnit = "SET" Then sUnit = "sett" Else sUnit = "stk."
        sUnit = "stk."
        
        
        
        dp1 = CDbl(aRec(3))
        
        ' Legg til frakt
        dp2 = dp1 + 125
        
        If dp2 > 0 Then dp2 = Format(dp2, "####################")
       
        
        sNewrec = aRec(0) & ";" & sDesc & " inkl. frakttillegg;" & sUnit & ";" & CStr(dp2) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Rondine_20082018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.5


' Varenr C
' Beskrivelse D
' Hvis M2, ta med kolonne I
' cp og ml = clp og ml, pcs = stk., m2 er m2

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\rondine\LISTINO RONDINE 2018 master"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11


'EFFETTO ESTETICO    SERIE                                                                           COLLECTION  CODICE             SKU  DESCRIZIONE                                                               PRODUCT   FORMATO            SIZE U.M.     SPESS.           TH CKN.   PZ / BOX    M2 / BOX    KG / M2 BOX      PALLET M2        PALLET    KG         PALLET   ML / BOX    KG / ML ML        PALLET    EURO                  < PALLLET EURO                       ? PALLET NETTO EURO                  < PALLLET   NETTO EURO                       ? PALLET
'FORESTA DI GRES CHALET  J85220  CH GRIGIO BAT   8x45    ml      30          42      720 13,5    1,27    567 5,40        1,62

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(2) = Trim$(Replace(aRec(2), "#", ""))
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(3), """", "")
        sDesc = Replace(aRec(3), "  ", " ")
        
        sUnit = UCase$(Trim$(aRec(5)))
        If sUnit = "SET" Then sUnit = "sett"
        If sUnit = "PZ" Then sUnit = "stk."
        Debug.Print "Unit=" & sUnit
        
        If aRec(19) = "" Then
            dp1 = CDbl(aRec(18))
        Else
             dp1 = CDbl(aRec(19))
        End If
        
        dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(2) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub GRB_BlackWhite_05092018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.7


' Varenr G+nr
' Desc + , color
' Beskrivelse D
' Hvis M2, ta med kolonne I
' cp og ml = clp og ml, pcs = stk., m2 er m2

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\GRB Miksers\prislister exel\2018 BLACK AND WHITE CATALOGUE GRB - NORWAY"
'2018_NORWAY PRICE
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
'Line Input #1, sTmp1
' Pund = * 11


'EFFETTO ESTETICO    SERIE                                                                           COLLECTION  CODICE             SKU  DESCRIZIONE                                                               PRODUCT   FORMATO            SIZE U.M.     SPESS.           TH CKN.   PZ / BOX    M2 / BOX    KG / M2 BOX      PALLET M2        PALLET    KG         PALLET   ML / BOX    KG / ML ML        PALLET    EURO                  < PALLLET EURO                       ? PALLET NETTO EURO                  < PALLLET   NETTO EURO                       ? PALLET
'FORESTA DI GRES CHALET  J85220  CH GRIGIO BAT   8x45    ml      30          42      720 13,5    1,27    567 5,40        1,62

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        '60710602;KALA;Bidet mixer;white;76,50

        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = "G" + Trim$(aRec(0))
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        'sDesc = Replace(aRec(3), """", "")
        'sDesc = Replace(aRec(3), "  ", " ")
        
        sUnit = "stk." 'UCase$(Trim$(aRec(5)))
        sDesc = aRec(1) & " " + aRec(2) & ", " & aRec(3)
        If aRec(4) <> "" Then
            dp1 = CDbl(aRec(4))
        End If
        
        dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub GRB_Other_05092018()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.7


' Varenr G+nr
' Desc + , color
' Beskrivelse D
' Hvis M2, ta med kolonne I
' cp og ml = clp og ml, pcs = stk., m2 er m2

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\GRB Miksers\prislister exel\2018_NORWAY PRICE"
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11


'EFFETTO ESTETICO    SERIE                                                                           COLLECTION  CODICE             SKU  DESCRIZIONE                                                               PRODUCT   FORMATO            SIZE U.M.     SPESS.           TH CKN.   PZ / BOX    M2 / BOX    KG / M2 BOX      PALLET M2        PALLET    KG         PALLET   ML / BOX    KG / ML ML        PALLET    EURO                  < PALLLET EURO                       ? PALLET NETTO EURO                  < PALLLET   NETTO EURO                       ? PALLET
'FORESTA DI GRES CHALET  J85220  CH GRIGIO BAT   8x45    ml      30          42      720 13,5    1,27    567 5,40        1,62

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        '60710602;KALA;Bidet mixer;white;76,50

        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = "G" + Trim$(aRec(0))
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        'sDesc = Replace(aRec(3), """", "")
        'sDesc = Replace(aRec(3), "  ", " ")
        
        sUnit = "stk." 'UCase$(Trim$(aRec(5)))
        sDesc = aRec(1) & " " + aRec(2)
        If aRec(3) <> "" Then sDesc = sDesc & ", " & aRec(3)
        If aRec(4) <> "" Then sDesc = sDesc & ", " & aRec(4)

        If aRec(6) <> "" Then
            dp1 = CDbl(aRec(6))
        End If
        
        dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub TECE_11012019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.7


' Varenr G+nr
' Desc + , color
' Beskrivelse D
' Hvis M2, ta med kolonne I
' cp og ml = clp og ml, pcs = stk., m2 er m2

fn1 = "Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\TECE\Priser 2019"
'      Z:\Drift og kunder\BAD OG FLIS\LEVERAND|fffd|RER\TECE
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1
' Pund = * 11


'EFFETTO ESTETICO    SERIE                                                                           COLLECTION  CODICE             SKU  DESCRIZIONE                                                               PRODUCT   FORMATO            SIZE U.M.     SPESS.           TH CKN.   PZ / BOX    M2 / BOX    KG / M2 BOX      PALLET M2        PALLET    KG         PALLET   ML / BOX    KG / ML ML        PALLET    EURO                  < PALLLET EURO                       ? PALLET NETTO EURO                  < PALLLET   NETTO EURO                       ? PALLET
'FORESTA DI GRES CHALET  J85220  CH GRIGIO BAT   8x45    ml      30          42      720 13,5    1,27    567 5,40        1,62

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    ' |fffd|
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    

    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")

        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(aRec(0))
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        'sDesc = Replace(aRec(3), """", "")
        'sDesc = Replace(aRec(3), "  ", " ")
        
        sUnit = "stk." 'UCase$(Trim$(aRec(5)))
        sDesc = Trim$(aRec(1))
        
        'If aRec(3) <> "" Then sDesc = sDesc & ", " & aRec(3)
        'If aRec(4) <> "" Then sDesc = sDesc & ", " & aRec(4)

        If aRec(5) <> "" Then
            dp1 = CDbl(aRec(5))
        End If
        
        'dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub
Sub Flaviker_24042019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim lcnt As Integer
Dim ok_cnt As Integer
Dim err_cnt As Integer
Dim nok As Double
Dim eur As Double
Dim sOutrec As String
Dim sUnit As String
Dim sOutUnit As String
Dim sSpecialDesc As String
Dim bSkipRec As Boolean
Dim products_written As Double

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\flaviker\priser 2019\Listino FLAVIKER 2019 DEFINITIVO"
'ABCDEFGHIJ
'0123456789

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Line Input #1, sTmp1 ' Header line

Do Until EOF(1)

'Serie   Materiale   Descrizione Formato Listino 2019    VAL UM  PZ/SC   M2/SC   KG/SC   SC/PL   M2/PL   KG/PL   Codice EAN/UPC  Codice Merceologico
'        artikkel    Beskrivelse + " " + I
'0       1           2           3       4               5   6   7       8        9       10      11      12      13      14      15      16              17
'
'Serie   T.m.    Materiale   Descrizione Formato Importo VAL per UM  Stato   PZ/SC   M2/SC   KG/SC   SC/PL   M2/PL   KG/PL   Codice EAN/UPC  Codice Merceologico
'0       1       2           3           4       5       6   7   8   9       10      11      12      13      14      15      16              17
    Line Input #1, sTmp1
    bSkipRec = False
    lcnt = lcnt + 1
    '--------------------------------------------------------------------------
    ' Fjern Quotes
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, """", "")
    
    '--------------------------------------------------------------------------
    ' Fjern spaces
    '--------------------------------------------------------------------------
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    sTmp1 = Replace(sTmp1, "  ", " ")
    
    aRec = Split(sTmp1, ";")
    'aRec(3) = Replace(aRec(3), ",", ".")
    sUnit = Trim$(UCase$(aRec(6)))
    
    eur = 0
    nok = 0
    Select Case sUnit
        Case "M|fffd|", "M2"
            sOutUnit = "M2"
            sSpecialDesc = "(" & aRec(11) & " M2, " & aRec(12) & " KG)"
        Case "PZ", "CNF"
            sOutUnit = "STK"
            sSpecialDesc = "(" & aRec(10) & " STK)"
                        
        Case Else
            Debug.Print "Line: " & lcnt & ", verdi=" & sUnit & ", line=" & sTmp1
    End Select
    
    sSpecialDesc = aRec(2) & " " & aRec(8)
    
    eur = CDbl(aRec(4))

    If eur <> 0 Then
        nok = eur * 9.65
        sTmp2 = Format$(CStr(nok), "##############") & ",00"
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        aRec(2) = Replace(aRec(2), "  ", " ")
        
        'sOutrec = aRec(2) & ";" & Trim$(aRec(3)) & " " & sSpecialDesc & ";" & sOutUnit & ";" & sTmp2
        sOutrec = aRec(1) & ";" & sSpecialDesc & ";" & sOutUnit & ";" & sTmp2
        Print #2, sOutrec
        
        products_written = products_written + 1
    
    End If
    


Loop

'Debug.Print "[" & Now & "] Produktlinjer: " & products_written & ", lines = " & lcnt

Close #1: Close #2


End Sub

Sub Villeroy_24042019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim sPris As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\villeroy & boch\pris 2018\Kopi av Offisiell pris fil 2018  med og uten MVA"
fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\villeroy & boch\pris 2019\Offisiell prisfil 2019  30 nov"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' c + e
' STK for alle
' Skip header line
Line Input #1, sTmp1
' Pund = * 11

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(2), """", "")
        If aRec(4) <> "" Then sDesc = sDesc & " " & aRec(4)
        
        sUnit = "Stk." ' UCase$(Trim$(aRec(3)))
        'If sUnit = "SET" Then sUnit = "sett" Else sUnit = "stk."
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom og |fffd| i pris
        '--------------------------------------------------------------------------
        sPris = aRec(8)
        sPris = Replace(sPris, " ", "")
        sPris = Replace(sPris, " ", "")
        
    '       dp1 = CDbl(aRec(5)) * 9.5
    '       If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        
        dp1 = CDbl(sPris) ' * 11
        '--------------------------------------------------------------------------
        ' Legg p|fffd| litt for frakt
        '--------------------------------------------------------------------------
        dp1 = dp1 + 75
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
        
        
        sNewrec = aRec(0) & ";" & sDesc & " inkl. frakttillegg" & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Scala_24042019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim products_written As Double
Dim newrec As String
Dim sDesc As String

fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\norinnredning\SCALA BAD . Prisliste. 40% Rabatt - 2019 KATALOG."
'ABCDEFGHI
'0123456789
'
'A D stk E (eks mva)
'
Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

Do Until EOF(1)

    Line Input #1, sTmp1
    products_written = products_written + 1
    aRec = Split(sTmp1, ";")
    'If UBound(aRec) > 6 Then Debug.Print "Line: " & products_written & " - " & UBound(aRec)
    
    sDesc = aRec(1)
    
    '--------------------------------------------------------------------------
    ' Fjern Quotes og doble mellomrom i beskrivelse
    '--------------------------------------------------------------------------
    sDesc = Replace(sDesc, """", "")
    sDesc = Replace(sDesc, "  ", " ")
    sDesc = Replace(sDesc, "  ", " ")
    sDesc = Replace(sDesc, "  ", " ")
    sDesc = Replace(sDesc, "  ", " ")
    sDesc = Replace(sDesc, "  ", " ")
    sDesc = Replace(sDesc, "  ", " ")
    'Debug.Print sDesc
    
    '--------------------------------------------------------------------------
    ' Fjern mellomrom i pris
    '--------------------------------------------------------------------------
    aRec(2) = Replace(aRec(2), " ", "")
    
    
    If aRec(2) <> "" Then
        '--------------------------------------------------------------------------
        ' Legg p|fffd| litt for frakt
        '--------------------------------------------------------------------------
        dp1 = CDbl(aRec(2))
        dp1 = Format$(CStr(dp1 + 75), "##############")
        newrec = aRec(0) & ";" & Trim$(sDesc) & " inkl. frakttillegg" & ";stk;" & dp1
        Print #2, newrec
    Else
        Debug.Print "Nada: " & sTmp1
    End If
Loop

Debug.Print Now & " Total: " & products_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub Duravit_26042019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim products_written As Double
Dim newrec As String
Dim sDesc As String
Dim sVarenummer As String
Dim sBeskrivelse As String
Dim sEnhet As String
Dim sPris As String


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Duravit\NO9"

' To be safe
Close #1: Close #2

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header rec
Line Input #1, sTmp1

Do Until EOF(1)
'Prisliste   Artikel Artikelbeskrivelse 1    Artikelbeskrivelse 2    NRF-nummer  Pris eks mva    Valuta  Tollnummer  EAN Stk pr palle    Vekt kg lengde  bredde  h|fffd|yde   Status
'0           1       2                       3                       4           5

    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    
    sVarenummer = Trim$(aRec(1))  ' B
    If sVarenummer <> "" Then
        sTmp2 = Trim$(aRec(2))
        sTmp2 = Replace(sTmp2, ",", "")
        sBeskrivelse = sTmp2 & ", " & aRec(3)
        sEnhet = "STK"
        sPris = aRec(5)
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom i pris
        '--------------------------------------------------------------------------
        sPris = Replace(sPris, " ", "")
        dp1 = CDbl(sPris)
        
        '--------------------------------------------------------------------------
        ' Legg p|fffd| litt for frakt
        '--------------------------------------------------------------------------
        dp1 = Format$(CStr(dp1 + 75), "##############")
        Print #2, sVarenummer & ";" & sBeskrivelse & ";" & sEnhet & ";" & dp1
        products_written = products_written + 1
    End If

Loop

Debug.Print Now & " Total: " & products_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub Spesialverktoy_26042019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim products_written As Double
Dim dLinesRead As Double
Dim newrec As String
Dim sDesc As String
Dim sVarenummer As String
Dim sBeskrivelse As String
Dim sEnhet As String
Dim sPris As String


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\spesialverkt|fffd|y\Prisliste brutto 01042019 Bad & Flis"

' To be safe
Close #1: Close #2

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header rec
Line Input #1, sTmp1

Do Until EOF(1)
'Varenr. Beskrivelse Basisenhet  Gammel pris Ny pris 01042019    Ny netto pris
'0       1           2           3           4                   5
    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    dLinesRead = dLinesRead + 1
    
    sVarenummer = Trim$(aRec(0))
    
    If sVarenummer <> "" Then
    
        'sTmp2 = Trim$(aRec(2))
        'sTmp2 = Replace(sTmp2, ",", "")
        sBeskrivelse = Trim$(aRec(1))
        sEnhet = aRec(2)
        sPris = aRec(5)
        
        '--------------------------------------------------------------------------
        ' Fjern mellomrom i pris
        '--------------------------------------------------------------------------
        sPris = Replace(sPris, " ", "")
        dp1 = CDbl(sPris)
        dp1 = Format$(dp1, "##############")
        
        '--------------------------------------------------------------------------
        ' Legg p|fffd| litt for frakt
        '--------------------------------------------------------------------------
        'dp1 = Format$(CStr(dp1 + 75), "##############")
        
        Print #2, sVarenummer & ";" & sBeskrivelse & ";" & sEnhet & ";" & dp1
        products_written = products_written + 1
    Else
        Debug.Print "****** Ikke varenummer p|fffd| linje " & dLinesRead & " *************"
    End If

Loop

Debug.Print Now & " Total: " & products_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub Imperial_26042019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dDp1 As Double
Dim dProducts_written As Double
Dim dLinesRead As Double

Dim sVarenummer As String
Dim sBeskrivelse As String
Dim sEnhet As String
Dim sPris As String

Dim dPUNDkurs As Double

dPUNDkurs = 12


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Imperial\priser 2019\Imperial Price List GBP Y7 NET 010617"

'----------------------------------------
' To be safe, close in- and output files
'----------------------------------------
Close #1: Close #2

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

'----------------------------------------
' Skip header rec
'----------------------------------------
Line Input #1, sTmp1

Do Until EOF(1)
    'Page    Imperial Stockcode  Description Finish  Y7
    '0       1                   2           3       4
    
    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    dLinesRead = dLinesRead + 1
    
    sVarenummer = Trim$(aRec(1))
    
    If sVarenummer <> "" Then
    
        'sTmp2 = Trim$(aRec(2))
        'sTmp2 = Replace(sTmp2, ",", "")
        sBeskrivelse = Trim$(aRec(2)) & ", " & Trim$(aRec(3))
        
        '---------------------------------------------------------
        ' Add page number to description if provided in price file
        '---------------------------------------------------------
        If Trim$(aRec(0)) <> "" Then sBeskrivelse = sBeskrivelse & " (side " & Trim$(aRec(0)) & ")"
        
        sEnhet = "STK" 'aRec(2)
        sPris = aRec(4)
        
        '----------------------------------
        ' Remove any spaces in price column
        '----------------------------------
        sPris = Replace(sPris, " ", "")
        
        dDp1 = CDbl(sPris) ' Convert to double presicion
        
        '-----------------
        ' Convert |fffd| to NOK
        '-----------------
        dDp1 = dDp1 * dPUNDkurs
        
        
        '-----------------------
        ' Add the Karlsen-factor
        '-----------------------
        'dDp1 = Format$(CStr(dDp1 + 75), "##############")
        
        Print #2, sVarenummer & ";" & sBeskrivelse & ";" & sEnhet & ";" & dDp1
        dProducts_written = dProducts_written + 1
    Else
        Debug.Print "****** No article number on line " & dLinesRead & " ******"
    End If

Loop

Debug.Print Now & " Total: " & dProducts_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub ByggDekor_24052019()


Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dDp1 As Double
Dim dProducts_written As Double
Dim dLinesRead As Double

Dim sVarenummer As String
Dim sBeskrivelse As String
Dim sEnhet As String
Dim sPris As String

Dim dPUNDkurs As Double

dPUNDkurs = 12


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\byggdekor\Pris forhandler 2019"

'----------------------------------------
' To be safe, close in- and output files
'----------------------------------------
Close #1: Close #2

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

'----------------------------------------
' Skip header rec
'----------------------------------------
Line Input #1, sTmp1

Do Until EOF(1)

'Varenummer  Beskrivelse Dimensjon pr stk (cm)                   antall stk pr eske  "EAN code/piece"  Salgsenhet      Forhandler-pris eks mva     Veil. Ink mva
'0           1
    
    Line Input #1, sTmp1
    aRec = Split(sTmp1, ";")
    dLinesRead = dLinesRead + 1
    
    sVarenummer = Trim$(aRec(0))
    
    If sVarenummer <> "" Then
    
        'sTmp2 = Trim$(aRec(2))
        'sTmp2 = Replace(sTmp2, ",", "")
        sBeskrivelse = Trim$(aRec(1))
        Select Case UCase$(Trim$(aRec(3)))
            Case "X"
                sBeskrivelse = sBeskrivelse & " " & Trim$(aRec(2)) & " x " & Trim$(aRec(4)) & " x " & Trim$(aRec(6)) & ". antall pr. eske: " & Trim$(aRec(7))
            Case ""
                sBeskrivelse = sBeskrivelse & " " & Trim$(aRec(2))
        End Select
        
        sEnhet = Trim$(aRec(9))
        
        sPris = aRec(10)
        
        '----------------------------------
        ' Remove any spaces in price column
        '----------------------------------
        sPris = Replace(sPris, " ", "")
        
        Print #2, sVarenummer & ";" & sBeskrivelse & ";" & sEnhet & ";" & sPris
        dProducts_written = dProducts_written + 1

    End If
        
Loop

Debug.Print Now & " Total: " & dProducts_written ' & ", mod = " & lmod
Close #1: Close #2


End Sub

Sub GRB_Mixers_08062019()

'---------------------------------------------------------------------------------------------------------
' VIKTIG! GRB-filen inneholder felter med ";" som m|fffd| fjernes i Excel F|fffd|R eksport til CSV
'---------------------------------------------------------------------------------------------------------

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim dSkipRec As Double
Dim dEUROkurs As Double
Dim sProductNumber As String
Dim sDesc As String
Dim sUnit As String

dEUROkurs = 9.75


fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\GRB Miksers\priser\GRB 2019 FULL PRICES"

' Just in case
Close #1: Close #2: Close #3

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2
Open fn1 & "_incool_out.csv" For Output As #3

'0
'G + 00022222    b + c + d + e + f   b og f skal v|fffd|re med stor F bokstav etc, sklilt med komma               euro som 9,75
'REFERENCE   COLLECTION  PRODUCT ACCESORIES  MAIN COMPONENT  FINISH  PRICE   WEIGHT  BARCODE
'0       1                   2                   3               4       5
'6010    INCOOL-ACCESSORIES  Wash basin spout    Plate |fffd|45 mm    200 mm  chrome  76  0,478   8,4352E+12


' Skip header line
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    
    ' Fjern evt. underlige quotes
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    sTmp1 = Replace(sTmp1, "|fffd|", "")
    
    
    aRec = Split(sTmp1, ";")
    
    If Trim$(aRec(0)) <> "" Then

        '--------------------------------------------------------------------------
        ' Fjern leading/trailing space i produktnummer og legg p|fffd| G
        '--------------------------------------------------------------------------
        sProductNumber = "G" & Trim$(aRec(0))
        
        aRec(1) = Trim$(aRec(1))
        aRec(2) = Trim$(aRec(2))
        If Mid$(aRec(2), 1, 1) = """" Then aRec(2) = Mid$(aRec(2), 2)
        If Mid$(aRec(2), Len(aRec(2)), 1) = """" Then
            aRec(2) = Mid$(aRec(2), 1, Len(aRec(2)) - 1)
            aRec(2) = Replace(aRec(2), """""", """")
        End If

        aRec(3) = Trim$(aRec(3))
        aRec(4) = Trim$(aRec(4))
        aRec(5) = Trim$(aRec(5))
        
        sDesc = UCase$(Mid$(aRec(1), 1, 1)) & LCase$(Mid$(aRec(1), 2))
        sDesc = sDesc & ", " & UCase$(Mid$(aRec(2), 1, 1)) & LCase$(Mid$(aRec(2), 2))
        
        If (aRec(3) <> "" And aRec(3) <> "-") Then sDesc = sDesc & ", " & aRec(3)
        If (aRec(4) <> "" And aRec(4) <> "-") Then sDesc = sDesc & ", " & LCase$(Mid$(aRec(4), 1, 1)) & LCase$(Mid$(aRec(4), 2))
        If (aRec(5) <> "" And aRec(5) <> "-") Then sDesc = sDesc & ", " & UCase$(Mid$(aRec(5), 1, 1)) & LCase$(Mid$(aRec(5), 2))
        
        sUnit = "stk."

        aRec(6) = Trim$(aRec(6))
        If aRec(6) <> "" Then
            dp1 = CDbl(aRec(6))
        End If
        
        dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        sNewrec = sProductNumber & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        If (InStr(1, aRec(1), "IN COOL") > 0) Or (InStr(1, aRec(1), "INCOOL") > 0) Then
            Print #3, sNewrec
        Else
            Print #2, sNewrec
        End If
        
        dOutlines = dOutlines + 1
        
    Else
        dSkipRec = dSkipRec + 1

    End If
    
Loop

Debug.Print Now & " Total: " & dOutlines & ", add = " & iAdd & ", skipped = " & dSkipRec
Close #1: Close #2: Close #3


End Sub

Sub Rondine_12072019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.75

' art = c
' besk d + e ( + i (hvis verdi) + ")" kg/m2 + 21,46 , m2 pr. pall + L, kg pr. pall + M
'
' Hvis det er pz, ha med stk. pr. boks: + H
' Pris fra Q
' Enhet m2 eller stk



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\rondine\LISTINO RONDINE 2019 master"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(2) = Trim$(Replace(aRec(2), "#", ""))
        
        sUnit = UCase$(Trim$(aRec(5)))
        If sUnit = "ML" Then sUnit = "stk."
        If sUnit = "PZ" Then sUnit = "stk."
        If sUnit = "CP" Then sUnit = "stk."
        If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(3), """", "")
        sDesc = Replace(aRec(3), "  ", " ")
        
        If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        Select Case sUnit
            Case "M2"
                If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
                If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
            Case "stk."
                If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        End Select
        
        
        
        If aRec(16) <> "" Then
            dp1 = CDbl(aRec(16))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        dp1 = dp1 * dEUROkurs
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(2) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    Else
        iSkipRec = iSkipRec + 1
    End If
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2


End Sub


Sub Novellini_02092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.75

' art = c
' besk d + e ( + i (hvis verdi) + ")" kg/m2 + 21,46 , m2 pr. pall + L, kg pr. pall + M
'
' Hvis det er pz, ha med stk. pr. boks: + H
' Pris fra Q
' Enhet m2 eller stk



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\Novellini\Prisfil 2019"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        
        sUnit = "Stk." 'UCase$(Trim$(aRec(5)))
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(1), """", "")
        sDesc = Replace(aRec(1), "  ", " ")
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        If aRec(3) <> "" Then
            dp1 = CDbl(aRec(3))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'dp1 = dp1 * dEUROkurs
        dp1 = dp1 + 50
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = aRec(0) & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Unidrain_reframe_16092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sProdNo As String
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.75

' art = c
' besk d + e ( + i (hvis verdi) + ")" kg/m2 + 21,46 , m2 pr. pall + L, kg pr. pall + M
'
' Hvis det er pz, ha med stk. pr. boks: + H
' Pris fra Q
' Enhet m2 eller stk



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\unidrain\Prisliste Reframe forhandler"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 4) <> ";;;;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        sProdNo = "uni" & aRec(0)
        sUnit = "Stk." 'UCase$(Trim$(aRec(5)))
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(3), """", "")
        
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        If aRec(4) <> "" Then
            dp1 = CDbl(aRec(4))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'dp1 = dp1 * dEUROkurs
        'dp1 = dp1 + 50
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = sProdNo & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Jonland_17092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sProdNo As String
Dim sDesc As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double

dEUROkurs = 9.75

' art = c
' besk d + e ( + i (hvis verdi) + ")" kg/m2 + 21,46 , m2 pr. pall + L, kg pr. pall + M
'
' Hvis det er pz, ha med stk. pr. boks: + H
' Pris fra Q
' Enhet m2 eller stk



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\j|fffd|nland\Jonland-01022019"

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2

' Skip header line
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 2) <> ";;" Then
        aRec = Split(sTmp1, ";")
        
        '--------------------------------------------------------------------------
        ' Fjern # samt leading/trailing space i produktnummer
        '--------------------------------------------------------------------------
        aRec(0) = Trim$(Replace(aRec(0), "#", ""))
        sProdNo = aRec(0)
        sUnit = "Plate" 'UCase$(Trim$(aRec(5)))
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Fjern Quotes og dobbelt space i beskrivelse
        '--------------------------------------------------------------------------
        sDesc = Replace(aRec(1), """", "")
        sDesc = Replace(sDesc, "  ", " ")
        sDesc = sDesc & " (frakt tilkommer)"
        
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        If aRec(2) <> "" Then
            dp1 = CDbl(aRec(2))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'dp1 = dp1 * dEUROkurs
        'dp1 = dp1 + 50
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = sProdNo & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        Print #2, sNewrec
        dOutlines = dOutlines + 1
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2


End Sub

Sub Stromberg_100_18092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim fn2 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sProdNo As String
Dim sDesc As String
Dim sDesc1 As String
Dim sDesc2 As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double
Dim dFraktTillegg As Double



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\NOK prisfil 100 kr frakt"
fn2 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\no_art.txt"

dFraktTillegg = 100

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2
Open fn2 For Append As #3

'-------------------------------------------------------------
' Skip 2 header lines
'-------------------------------------------------------------
Line Input #1, sTmp1
Line Input #1, sTmp1

dPrNo = 1

Do Until EOF(1)
    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 2) <> ";;" Then
        '--------------------------------------------------------------------------
        ' Erstatt ';"' med ';'
        '         '";' med ';'
        '         ',;' med ';'
        '--------------------------------------------------------------------------
        sTmp1 = Replace(sTmp1, ";""", ";")
        sTmp1 = Replace(sTmp1, """;", ";")
        sTmp1 = Replace(sTmp1, ",;", ";")
        
        aRec = Split(sTmp1, ";")
        
        sProdNo = Trim$(aRec(0))
        sUnit = "Stk."
        
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Erstatt '""' med '"'
        '--------------------------------------------------------------------------
        aRec(2) = Replace(aRec(2), """""", """")
        
        sDesc = aRec(1) & ", " & aRec(2) & " (frakt er inkludert)"
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        
        If aRec(3) <> "" Then
            dp1 = CDbl(Trim$(aRec(3)))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'Legg p|fffd| frakttillegg
        dp1 = dp1 + dFraktTillegg
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = sProdNo & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        If sProdNo = "S" Then
            Debug.Print "Ikke varenummer"
            iSkipRec = iSkipRec + 1
            Print #3, sTmp1
        Else
            Print #2, sNewrec
            dOutlines = dOutlines + 1
        End If
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2: Close #3

End Sub


Sub Stromberg_vegger_18092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim fn2 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sProdNo As String
Dim sDesc As String
Dim sDesc1 As String
Dim sDesc2 As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double
Dim dFraktTillegg As Double



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\Nok prisfil 750 frakt - dusjvegger"
fn2 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\no_art.txt"

dFraktTillegg = 750

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2
Open fn2 For Append As #3

'-------------------------------------------------------------
' Skip 2 header lines
'-------------------------------------------------------------
Line Input #1, sTmp1
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 2) <> ";;" Then
        '--------------------------------------------------------------------------
        ' Erstatt ';"' med ';'
        '         '";' med ';'
        '         ',;' med ';'
        '--------------------------------------------------------------------------
        sTmp1 = Replace(sTmp1, ";""", ";")
        sTmp1 = Replace(sTmp1, """;", ";")
        sTmp1 = Replace(sTmp1, ",;", ";")
        
        aRec = Split(sTmp1, ";")
        
        sProdNo = Trim$(aRec(0))
        sUnit = "Stk."
        
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Erstatt '""' med '"'
        '--------------------------------------------------------------------------
        aRec(1) = Replace(aRec(1), """""", """")
        aRec(2) = Replace(aRec(2), """""", """")
        
        sDesc = aRec(1) & " " & aRec(2) & " (frakt er inkludert)"
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        
        If aRec(3) <> "" Then
            dp1 = CDbl(Trim$(aRec(3)))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'Legg p|fffd| frakttillegg
        dp1 = dp1 + dFraktTillegg
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = sProdNo & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        If sProdNo = "S" Then
            Debug.Print "Ikke varenummer"
            iSkipRec = iSkipRec + 1
            Print #3, sTmp1
        Else
            Print #2, sNewrec
            dOutlines = dOutlines + 1
        End If
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2: Close #3

End Sub
Sub Stromberg_750_18092019()

Dim nrec() As String
Dim sTmp1 As String
Dim sTmp2 As String
Dim fn1 As String
Dim fn2 As String
Dim aRec() As String
Dim dp1 As Double
Dim dp2 As Double
Dim iAdd As Integer
Dim sProdNo As String
Dim sDesc As String
Dim sDesc1 As String
Dim sDesc2 As String
Dim sUnit As String
Dim dOutlines As Double
Dim dPrNo As Double
Dim sNewrec As String
Dim iSkipRec As Integer
Dim dEUROkurs As Double
Dim dFraktTillegg As Double



fn1 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\Nok prisfil 750 frakt"
fn2 = "Z:\BAD OG FLIS\LEVERAND|fffd|RER\stromberg\no_art.txt"

dFraktTillegg = 750

Open fn1 & ".csv" For Input As #1
Open fn1 & "_out.csv" For Output As #2
Open fn2 For Append As #3

'-------------------------------------------------------------
' Skip 2 header lines
'-------------------------------------------------------------
Line Input #1, sTmp1
Line Input #1, sTmp1

dPrNo = 1
Do Until EOF(1)

    Line Input #1, sTmp1
    If Mid$(Trim$(sTmp1), 1, 2) <> ";;" Then
        '--------------------------------------------------------------------------
        ' Erstatt ';"' med ';'
        '         '";' med ';'
        '         ',;' med ';'
        '--------------------------------------------------------------------------
        sTmp1 = Replace(sTmp1, ";""", ";")
        sTmp1 = Replace(sTmp1, """;", ";")
        sTmp1 = Replace(sTmp1, ",;", ";")
        
        aRec = Split(sTmp1, ";")
        
        sProdNo = Trim$(aRec(0))
        sUnit = "Stk."
        
        'If sUnit = "ML" Then sUnit = "stk."
        'If sUnit = "PZ" Then sUnit = "stk."
        'If sUnit = "CP" Then sUnit = "stk."
        'If sUnit = "M2" Then sUnit = "M2"
        
        
        '--------------------------------------------------------------------------
        ' Erstatt '""' med '"'
        '--------------------------------------------------------------------------
        aRec(2) = Replace(aRec(2), """""", """")
        
        sDesc = aRec(1) & ", " & aRec(2) & " (frakt er inkludert)"
        
        'If aRec(4) <> "" Then sDesc = sDesc + " " & aRec(4)
        'If aRec(8) <> "" Then sDesc = sDesc + " (m2 pr. boks: " & aRec(8) & ")"
        
        'Select Case sUnit
        '    Case "M2"
        '        If aRec(9) <> "" Then sDesc = sDesc + ", kg. pr. m2: " & aRec(9)
        '        If aRec(11) <> "" Then sDesc = sDesc + ", m2 pr. pall: " & aRec(11)
        '    Case "stk."
        '        If aRec(7) <> "" Then sDesc = sDesc + ", stk. pr. boks: " & aRec(7)
        'End Select
        
        
        
        
        If aRec(3) <> "" Then
            dp1 = CDbl(Trim$(aRec(3)))
        Else
             Debug.Print "************** OBS - mangler pris **************"
             iSkipRec = iSkipRec + 1
        End If
        
        'Legg p|fffd| frakttillegg
        dp1 = dp1 + dFraktTillegg
        
        If dp1 > 0 Then dp1 = Format(dp1, "####################")
       
        
        sNewrec = sProdNo & ";" & sDesc & ";" & sUnit & ";" & CStr(dp1) & ",00"
        
        dPrNo = dPrNo + 1
        If sProdNo = "S" Then
            Debug.Print "Ikke varenummer"
            iSkipRec = iSkipRec + 1
            Print #3, sTmp1
        Else
            Print #2, sNewrec
            dOutlines = dOutlines + 1
        End If
    Else
        iSkipRec = iSkipRec + 1
        Debug.Print sTmp1
    End If
    
Loop

Debug.Print Now & " Total add: " & dOutlines; ", skipped = " & iSkipRec
Close #1: Close #2: Close #3


End Sub

Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True


INQUEST-PP=macro
