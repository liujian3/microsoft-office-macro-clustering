Attribute VB_Name = "IDCardNo_check"
Dim Wi(1 To 18) As Integer  '|423||fffd||fffd||fffd||fffd|
Private Function SetWi()
    Wi(1) = 7
    Wi(2) = 9
    Wi(3) = 10
    Wi(4) = 5
    Wi(5) = 8
    Wi(6) = 4
    Wi(7) = 2
    Wi(8) = 1
    Wi(9) = 6
    Wi(10) = 3
    Wi(11) = 7
    Wi(12) = 9
    Wi(13) = 10
    Wi(14) = 5
    Wi(15) = 8
    Wi(16) = 4
    Wi(17) = 2
    Wi(18) = 1
End Function

Public Function CheckCIDC15(ByVal StrID15 As String) As String
If Not VBA.IsNumeric(StrID15) Then
    CheckCIDC15 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||437||fffd||fffd||fffd||fffd||5b3||fffd||fffd||5a3||fffd|"
    Exit Function
End If
If VBA.Val(VBA.Mid(StrID15, 9, 2)) < 1 Or VBA.Val(VBA.Mid(StrID15, 9, 2)) > 12 Then
    CheckCIDC15 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||772||fffd||fffd||fffd||237||fffd||fffd|"
    Exit Function
End If
If VBA.Val(VBA.Mid(StrID15, 11, 2)) < 1 Or VBA.Val(VBA.Mid(StrID15, 11, 2)) > 31 Then
    CheckCIDC15 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||6b2||fffd||fffd||fffd||237||fffd||fffd|"
    Exit Function
Else
    If (VBA.Val(VBA.Mid(StrID15, 9, 2)) = 4 Or VBA.Val(VBA.Mid(StrID15, 9, 2)) = 6 Or VBA.Val(VBA.Mid(StrID15, 9, 2)) = 9 Or VBA.Val(VBA.Mid(StrID15, 9, 2)) = 11) And VBA.Val(VBA.Mid(StrID15, 11, 2)) = 31 Then
        CheckCIDC15 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||77a||fffd||fffd||fffd||fffd||6b2||fffd||1a5||fffd||fffd|"
        Exit Function
    ElseIf VBA.Val(VBA.Mid(StrID15, 9, 2)) = 2 And (VBA.Val(VBA.Mid(StrID15, 11, 2)) = 30 Or VBA.Val(VBA.Mid(StrID15, 11, 2)) = 31) Then
        CheckCIDC15 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||b7||fffd||fb||fffd||fffd|" & VBA.Val(VBA.Mid(StrID15, 11, 2)) & "|fffd||fffd|"
        Exit Function
    End If
End If
End Function

Public Function CheckCIDC18(ByVal StrID18 As String) As String
Dim StrID17 As String, AiWi As Integer, num As Integer, A18 As String
SetWi
If Not VBA.IsNumeric(VBA.Left(StrID18, 17)) Then
    CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
    Exit Function
End If
If VBA.Val(VBA.Mid(StrID18, 11, 2)) < 1 Or VBA.Val(VBA.Mid(StrID18, 11, 2)) > 12 Then
    CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||772||fffd||fffd||fffd||237||fffd||fffd|"
    Exit Function
End If
If VBA.Val(VBA.Mid(StrID18, 13, 2)) < 1 Or VBA.Val(VBA.Mid(StrID18, 13, 2)) > 31 Then
    CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" & vbCrLf & "|fffd||fffd||fffd||6b2||fffd||fffd||fffd||237||fffd||fffd|"
    Exit Function
Else
    If (VBA.Val(VBA.Mid(StrID18, 11, 2)) = 4 Or VBA.Val(VBA.Mid(StrID18, 11, 2)) = 6 Or VBA.Val(VBA.Mid(StrID18, 11, 2)) = 9 Or VBA.Val(VBA.Mid(StrID18, 11, 2)) = 11) And VBA.Val(VBA.Mid(StrID18, 13, 2)) = 31 Then
        CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||77a||fffd||fffd||fffd||fffd||6b2||fffd||1a5||fffd||fffd|"
        Exit Function
    ElseIf VBA.Val(VBA.Mid(StrID18, 11, 2)) = 2 And (VBA.Val(VBA.Mid(StrID18, 13, 2)) = 30 Or VBA.Val(VBA.Mid(StrID18, 13, 2)) = 31) Then
        CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|fffd||b7||fffd||fb||fffd||fffd|" & VBA.Val(VBA.Mid(StrID18, 13, 2)) & "|fffd||fffd|"
        Exit Function
    End If
End If
StrID17 = VBA.Left(StrID18, 17)
AiWi = 0
For num = 1 To 17
    AiWi = AiWi + VBA.Val(VBA.Mid(StrID17, num, 1)) * Wi(num)
Next num
Select Case AiWi Mod 11
    Case 0
        A18 = "1"
    Case 1
        A18 = "0"
    Case 2
        A18 = "X"
    Case 3
        A18 = "9"
    Case 4
        A18 = "8"
    Case 5
        A18 = "7"
    Case 6
        A18 = "6"
    Case 7
        A18 = "5"
    Case 8
        A18 = "4"
    Case 9
        A18 = "3"
    Case 10
        A18 = "2"
End Select
If A18 <> VBA.Right(StrID18, 1) Then
    CheckCIDC18 = "|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" '|3b2||fffd||fffd||423||fffd||fffd||fffd||bcbb||fffd||fffd||237|"
    Exit Function
End If
End Function

'|fffd||fffd||fffd||fffd||5a4||fffd||fffd||fffd||9eaf||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||e3b37||fffd||fffd||6b5||fffd||fffd||1f4||fffd||fffd||fffd||fffd||fffd||5b7||fffd||fffd||fffd||3e2||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||b7d7b||63f||fffd|
'|fffd||fffd||fffd||fffd|
Function CIDCheck(strId As String) As String
If VBA.Len(strId) = 15 Then
  CIDCheck = CheckCIDC15(strId)
ElseIf VBA.Len(strId) = 18 Then
  CIDCheck = CheckCIDC18(strId)
Else
  CIDCheck = "|fffd||fffd||fffd||fffd||5a4||3bb||fffd||fffd||fffd||fffd||fffd||fffd|"
End If
End Function

Function getCIDBirthday(strId As String) As String
    Dim idMsg As String
    getCIDBirthday = ""
    If VBA.Len(strId) = 15 Then
      idMsg = CheckCIDC15(strId)
      If idMsg <> "" Then
        Exit Function
      End If
      getCIDBirthday = "19" & VBA.LTrim(VBA.Val(VBA.Mid(strId, 7, 2))) & "-" & VBA.LTrim(VBA.Val(VBA.Mid(strId, 9, 2))) & "-" & VBA.LTrim(VBA.Val(VBA.Mid(strId, 11, 2)))
    ElseIf VBA.Len(strId) = 18 Then
      idMsg = CheckCIDC18(strId)
      If idMsg <> "" Then
        Exit Function
      End If
      getCIDBirthday = VBA.LTrim(VBA.Val(VBA.Mid(strId, 7, 4))) & "-" & VBA.LTrim(VBA.Val(VBA.Mid(strId, 11, 2))) & "-" & VBA.LTrim(VBA.Val(VBA.Mid(strId, 13, 2)))
    Else
      Exit Function
    End If
End Function
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True
Attribute VB_Control = "btnCheckProtect1, 22, 14, MSForms, CommandButton"
Attribute VB_Control = "applyDate, 21, 15, MSForms, Label"
Attribute VB_Control = "schoolCode, 20, 16, MSForms, Label"
Attribute VB_Control = "schoolName, 19, 17, MSForms, Label"
Attribute VB_Control = "applyer, 18, 18, MSForms, Label"
Attribute VB_Control = "projectName, 17, 19, MSForms, Label"
Attribute VB_Control = "subject, 16, 20, MSForms, Label"
Attribute VB_Control = "projectType, 15, 21, MSForms, Label"
Attribute VB_Control = "btnCheckProtect, 14, 22, MSForms, CommandButton"
Attribute VB_Control = "feeTitle, 13, 23, MSForms, CommandButton"
Attribute VB_Control = "memberTitle, 12, 24, MSForms, CommandButton"
Attribute VB_Control = "chargerTitle, 11, 25, MSForms, CommandButton"
Attribute VB_Control = "projectTitle, 10, 26, MSForms, CommandButton"
Attribute VB_Control = "btnEditProtect, 9, 27, MSForms, CommandButton"
Attribute VB_Control = "baseData, 8, 28, MSForms, TextBox"
Attribute VB_Control = "cyzkxxXmlStr, 7, 29, MSForms, TextBox"
Attribute VB_Control = "jfgsxxXmlStr, 6, 30, MSForms, TextBox"
Attribute VB_Control = "sqxmxxXmlStr, 5, 31, MSForms, TextBox"
Attribute VB_Control = "sqrxxXmlStr, 4, 32, MSForms, TextBox"
Attribute VB_Control = "psd, 3, 33, MSForms, TextBox"
Attribute VB_Control = "docPassword, 2, 34, MSForms, TextBox"
Attribute VB_Control = "docStatus, 1, 35, MSForms, TextBox"
Attribute VB_Control = "status, 0, 36, MSForms, TextBox"


'|fffd||5f2||fffd||fffd||fffd||9c63||fffd||fffd||fffd||fffd||165|
Private Sub btnCheckProtect1_Click()
    Call btnCheckProtect_Click
End Sub

'|fffd||fffd||fffd||fffd||fffd||fffd||9c63||fffd||fffd||fffd||fffd||165|
Private Sub btnCheckProtect_Click()
        
    If ThisDocument.status.Text = "0" Then  '|fffd||fffd||2be||fffd||fffd||5e1||5f4||32c|
        Dim flag As Boolean
        wd_protect (False)
        flag = checkAll()
        wd_protect (True)
        If flag = True Then
            Call MsgBox("|fffd||ec68||fffd||fffd||fffd||fffd||fffd||fffd||368||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
            setpsdWin.Show '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||53b||fffd||fffd||a3b31||fffd||5a4||fffd||fffd||fffd||fffd||fffd||2f2||fffd||fffd||738||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||2f3||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531|
        End If
    Else
         Call MsgBox("|fffd||ec68||fffd||fffd||fffd||fffd||fffd||fffd||368||fffd||fffd||fffd||fffd||98ec||fffd||fffd||fffd||fffd||fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||9c34||165||fffd||7b8||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
    End If
End Sub

'|fffd||f2d||fffd||ec68||fffd||fffd||fffd||770||fffd||165|
Private Sub btnEditProtect_Click()
    If ThisDocument.status.Text = "1" Then  '|fffd||fffd||2be||fffd||fffd||5e1||5f4||32c|
        If ThisDocument.psd.value = "" Then
            Call unlockDoc
        Else
            unLockWin.Show
        End If
    Else
        Call MsgBox("|fffd||ec68||fffd||fffd||fffd||fffd||3b4||368||fffd||fffd||fffd||fffd||98ec||fffd||fffd||5b1||fffd||fffd||fffd||7b8||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
    End If
End Sub

'|fffd||135||fffd||fffd||631||fffd||2b1||fffd||fffd||573||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Private Sub Document_Close()
    On Error Resume Next
    ThisDocument.baseData.value = ""
    Me.Shapes("Text Box 4").Visible = msoTrue
    ThisDocument.Save
End Sub


Private Sub Document_Open()
    On Error Resume Next
    Dim strDllPath As String
    Me.Shapes("Text Box 4").Visible = msoFalse '|fffd||fffd||fffd||fffd||fffd||fffd||2be|
    '|5e2||fffd||fffd||fffd||fffd||fffd|
    strDllPath = GetPath(ThisDocument.FullName) & "msxml3.dll"
    strDllPath = "regsvr32 -s " & VBA.Chr(34) & strDllPath & VBA.Chr(34)
    Shell (strDllPath)
    Dim rootElement As Object
    Set rootElement = GetDoc
    
    '|fffd||fffd||fffd||bce3||fffd||fffd||fffd||13c||fffd|
    Dim xmlcode As Object
    Set xmlcode = GetDoc
    xmlcode.async = False
    xmlcode.validateOnParse = False
    xmlcode.resolveExternals = False
    xmlcode.preserveWhiteSpace = True
    If xmlcode.Load(ThisDocument.Path + "\base.dat") = False Then
        MsgBox "|fffd||fffd||fffd||633||fffd||fffd||fffd||fffd||fffd||fffd||774||fffd||fffd||fffd|.|fffd||fffd||237||fffd||fffd|base.dat|fffd||fffd||fffd||ac68||fffd||fffd||fffd||fffd||fffd||36c||4bb||13f||bc|", vbCritical, "|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd|"
    Else
        ThisDocument.baseData.value = xmlcode.XML
    End If
    
    If Not Me.ProtectionType = wdAllowOnlyFormFields Then
        wd_protect (True)
    End If
    '|fffd||fffd||fffd||631||fffd||2be||5f4||32c||fffd||fffd||fffd||fffd||fffd||fffd||13f||63c||fffd|
    '|fffd||135||fffd||5f4||32c| 0:|fffd||1f1||fffd||fffd||fffd| 1:|fffd||fffd||fffd||fffd|
    ThisDocument.status.Width = 0.75
    ThisDocument.status.Height = 0.75
    '|fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisDocument.psd.Width = 0.75
    ThisDocument.psd.Height = 0.75
    '|fffd||ec68||fffd||fffd||fffd||775||fffd|XML|fffd||fffd||2bd||fffd||fffd||fffd||5b7||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    ThisDocument.sqrxxXmlStr.Width = 0.75
    ThisDocument.sqrxxXmlStr.Height = 0.75
    ThisDocument.sqxmxxXmlStr.Width = 0.75
    ThisDocument.sqxmxxXmlStr.Height = 0.75
    ThisDocument.jfgsxxXmlStr.Width = 0.75
    ThisDocument.jfgsxxXmlStr.Height = 0.75
    ThisDocument.cyzkxxXmlStr.Width = 0.75
    ThisDocument.cyzkxxXmlStr.Height = 0.75
    
    Call setProcessControl((ThisDocument.status = 0))
    ThisDocument.projectTitle.Select
End Sub



'-----------------------|fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||ec68|--------------------------------
Private Sub projectTitle_Click()
    If ThisDocument.status = 1 Then Exit Sub
    projectTitle.Select
    wd_protect (False)
    sqxmxxWin.Show
    If ThisDocument.sqxmxxXmlStr = "" Then
        projectTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||ec68|]"
    Else
        projectTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||7b8||fffd|]"
    End If
    wd_protect (True)
End Sub

'-----------------------|fffd||ac68||fffd||fffd||fffd||fffd||3e2||fffd||ec68|---------------------------------------
Private Sub chargerTitle_Click()
    If ThisDocument.status = 1 Then Exit Sub
    chargerTitle.Select
    wd_protect (False)
    sqrxxWin.Show
    If ThisDocument.sqrxxXmlStr = "" Then
        chargerTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||ec68|]"
    Else
        chargerTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||7b8||fffd|]"
    End If
    wd_protect (True)
End Sub

'------------------------|fffd||fffd||fffd||fffd||fffd||1ff||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||ec68|-----------------------
Private Sub memberTitle_Click()
    If ThisDocument.status = 1 Then Exit Sub
    memberTitle.Select
    wd_protect (False)
    zycyWin.Show
    If ThisDocument.cyzkxxXmlStr = "" Then
        memberTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||ec68|]"
    Else
        memberTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||7b8||fffd|]"
    End If
    wd_protect (True)
End Sub

Private Sub feeTitle_Click()
    If ThisDocument.status = 1 Then Exit Sub
    feeTitle.Select
    wd_protect (False)
    jfgsWin.Show
    If VBA.Val(getCellValue(ThisDocument.Tables(ThisDocument.Tables.Count - 2).Cell(8, 3).Range.Text)) = 0 Then
        feeTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||ec68|]"
    Else
        feeTitle.caption = "[|fffd||fffd||fffd||fffd||2f4||fffd||fffd||7b8||fffd|]"
    End If
    wd_protect (True)
End Sub

Public Sub PrintTheDoc()
    '|fffd||fffd||4e1||1f0||fffd||fffd||429||4b3||fffd||fffd||fffd||3f5||134||fffd||fffd||fffd||fffd||fffd|
    Dim btnCheckProtectHeight As Integer
    Dim btnCheckProtectWidth As Integer
    Dim strWarning As String
    
    btnCheckProtectHeight = btnCheckProtect.Height
    btnCheckProtectWidth = btnCheckProtect.Width
    Dim lret As Long
    If Not ThisDocument.status.Text = "1" Then
        strWarning = "|fffd||fffd||5e2||fffd||28fa||fffd||fffd||fffd||135||fffd||fffd||fffd||fffd||1f7b||5ae||1f0||fffd||fffd||fffd||fffd||fffd||9c63||fffd||fffd||fffd||fffd|" + VBA.Chr(13) + "|fffd||fffd||fffd||fffd||fffd||135||fffd||fffd||fffd||3b4||fffd||fffd||98ec||fffd||fffd||4aa||fffd||fffd||fffd||fffd||fffd||fffd||4e1||fffd||fffd|"
        lret = MsgBox(strWarning, vbYesNo + vbQuestion, "|fffd||135||fffd||3b4||fffd||fffd||9c63||fffd||fffd|")
        If lret = vbNo Then
            If (Me.ProtectionType = wdNoProtection) Then
                Call wd_protect(True)
                Call setProcessControl(True)
            End If
            Exit Sub
        End If
        '|fffd||fffd||fffd||631||fffd||fffd||fffd||2bd|
        Call setProcessControl(False)
        wd_protect (False)
        
        ThisDocument.Tables(2).Shading.BackgroundPatternColorIndex = wdWhite
        ThisDocument.Tables(4).Shading.BackgroundPatternColorIndex = wdWhite
        ThisDocument.Tables(6).Shading.BackgroundPatternColorIndex = wdWhite
        ThisDocument.Tables(ThisDocument.Tables.Count - 2).Shading.BackgroundPatternColorIndex = wdWhite
        ThisDocument.Tables(ThisDocument.Tables.Count - 1).Shading.BackgroundPatternColorIndex = wdWhite
        
        wd_protect (True)
    End If
    '|fffd||fffd||fffd||63c||fffd||9c34||165|
    btnCheckProtect.Height = 0.75
    btnCheckProtect.Width = 0.75
    Dim dlgPrint As Dialog
    Set dlgPrint = Dialogs(wdDialogFilePrint)
    lret = -1
    Err.Clear
    On Error GoTo ErrNoPrinter
    lret = dlgPrint.Display
    If lret = 0 Then
        GoTo ErrHandle
    End If

    
    dlgPrint.Execute
    
    GoTo ErrHandle
ErrNoPrinter:
    If lret < 0 Then
        MsgBox "|fb||fffd||fffd||5f0||fffd||434||fffd||4e1||fffd||fffd||fffd||fffd||fffd||134||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4e1||fffd||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||4e1||fffd||fffd||fffd||fffd|"
        If Me.ProtectionType = wdNoProtection Then
            Call wd_protect(True)
        End If
        If Not ThisDocument.status.Text = "1" Then
           Call setProcessControl(True)
           wd_protect (False)
            ThisDocument.Tables(2).Shading.BackgroundPatternColorIndex = wdGray25
            ThisDocument.Tables(4).Shading.BackgroundPatternColorIndex = wdGray25
            ThisDocument.Tables(6).Shading.BackgroundPatternColorIndex = wdGray25
            ThisDocument.Tables(ThisDocument.Tables.Count - 2).Shading.BackgroundPatternColorIndex = wdGray25
            ThisDocument.Tables(ThisDocument.Tables.Count - 1).Shading.BackgroundPatternColorIndex = wdGray25
            wd_protect (True)
        End If
        btnCheckProtect.Height = btnCheckProtectHeight
        btnCheckProtect.Width = btnCheckProtectWidth
    End If
ErrHandle:

     If Me.ProtectionType = wdNoProtection Then
        Call wd_protect(True)
     End If
     If Not ThisDocument.status.Text = "1" Then
        Call setProcessControl(True)
         wd_protect (False)
        ThisDocument.Tables(2).Shading.BackgroundPatternColorIndex = wdGray25
        ThisDocument.Tables(4).Shading.BackgroundPatternColorIndex = wdGray25
        ThisDocument.Tables(6).Shading.BackgroundPatternColorIndex = wdGray25
        ThisDocument.Tables(ThisDocument.Tables.Count - 2).Shading.BackgroundPatternColorIndex = wdGray25
        ThisDocument.Tables(ThisDocument.Tables.Count - 1).Shading.BackgroundPatternColorIndex = wdGray25
        wd_protect (True)
     End If
     btnCheckProtect.Height = btnCheckProtectHeight
     btnCheckProtect.Width = btnCheckProtectWidth
End Sub
Sub FilePrint()
'
' FilePrint Macro
' |fffd||fffd||4e1||fffd||edaf||fffd||135||fffd|
'
    Call ThisDocument.PrintTheDoc

End Sub
Sub FilePrintDefault()
'
' FilePrintDefault Macro
' |fffd||fffd||12c||fffd||3f7||fffd||2bd||fffd||fffd||4e1||fffd||fffd||1f0||fffd||135||fffd|
'
    Call ThisDocument.PrintTheDoc
    
End Sub

'|fffd||fffd||fffd||fffd||22b||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b7||fffd||fffd|
Public Function GetPath(ByVal strFullName As String) As String
    Dim i As Integer
    Dim intLen As Integer
    
    intLen = VBA.Len(strFullName)
    For i = intLen To 1 Step -1
        If VBA.Mid(strFullName, i, 1) = "\" Then
            Exit For
        End If
    Next
    GetPath = VBA.Left(strFullName, i)
End Function
Attribute VB_Name = "UserfrmChooseSchoolCode"
Attribute VB_Base = "0{916BA8FA-2D85-499B-9A71-A3957423D625}{98AAAC8F-DA97-4784-B989-02641B52DBE6}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







Public num1, num2 As Integer
Private xmlcode As Object
Private Sub btn_userfrmSubCodeCancel_Click()
    Unload Me
End Sub

Private Sub btn_userfrmSubCodeOk_Click()
Dim a, b As String
    If codeflag = 1 Then
        If Me.lbx_second.value <> "" Then
        Dim abc As String
        
           abc = Me.lbx_second.value
           Else
               MsgBox "|fffd||532||fffd||fffd||fffd||fffd||fffd||fffd||fffd||461||fffd||fffd||467||423|!", vbExclamation, "|fffd||fffd||fffd||fffd|"
               Exit Sub
        End If
        a = VBA.Trim(SplitStr(abc, ":")(1))
        b = VBA.Trim(SplitStr(abc, ":")(0))
        sqxmxxWin.schoolCode.value = a
        sqxmxxWin.schoolName.value = b
    End If
Unload Me
End Sub

Private Sub lbx_first_Change()
    Dim n, m As Integer
    Dim nownode As Object
    lbx_second.Clear
    n = lbx_first.ListIndex
    Set nownode = xmlcode.getElementsByTagName("SchoolCode").Item(n)
    n = 0
    While Not nownode.ChildNodes(n) Is Nothing
        If n Mod 2 = 1 Then
            lbx_second.AddItem (nownode.ChildNodes(n).Attributes(1).Text + ":" + nownode.ChildNodes(n).Attributes(0).Text)
        End If
        n = n + 1
    Wend
End Sub
Private Sub lbx_first_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Call btn_userfrmSubCodeOk_Click
End Sub

Private Sub UserForm_Initialize()
    Set xmlcode = GetDoc
    xmlcode.async = False
    xmlcode.validateOnParse = False
    xmlcode.resolveExternals = False
    xmlcode.preserveWhiteSpace = True
    
    If xmlcode.loadXML(ThisDocument.baseData.value) = False Then
        If xmlcode.Load(ThisDocument.Path + "\base.dat") = False Then
            MsgBox "|fffd||fffd||fffd||fffd||467||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||774||fffd||fffd||fffd|.", vbCritical, "|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd|"
            Exit Sub
        End If
    End If
    Call getuniversity
End Sub

Function getuniversity()
    Dim n As Integer
    n = 0
    While Not xmlcode.getElementsByTagName("SchoolCode").Item(n) Is Nothing
        lbx_first.AddItem (xmlcode.getElementsByTagName("SchoolCode").Item(n).Attributes(0).Text)
        n = n + 1
    Wend
End Function



Attribute VB_Name = "UserfrmSubCode"
Attribute VB_Base = "0{0D6B7626-315F-407B-A9BD-90689357AE33}{42F00C09-5A09-4D5C-9382-3C61F9E662B0}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







Public num1, num2 As Integer
Private xmlcode As Object
Private Sub btn_userfrmSubCodeCancel_Click()
Unload UserfrmSubCode
End Sub
Private Sub getSubjectB()
    Dim n, m As Integer
    Dim nownode As Object
    lbx_second.Clear
    n = firstSubjectIndex
    Set nownode = xmlcode.getElementsByTagName("SubjectA").Item(n)
    n = 0
    m = 0
    While Not nownode.ChildNodes(n) Is Nothing
        If n Mod 2 = 1 Then
            lbx_second.AddItem (nownode.ChildNodes(n).Attributes(1).Text + ":" + nownode.ChildNodes(n).Attributes(0).Text)
            While Not nownode.ChildNodes(n).ChildNodes(m) Is Nothing
                If m Mod 2 = 1 Then
                    lbx_second.AddItem (" " + nownode.ChildNodes(n).ChildNodes(m).Attributes(1).Text + ":" + nownode.ChildNodes(n).ChildNodes(m).Attributes(0).Text)
                End If
                m = m + 1
            Wend
            m = 0
        End If
        n = n + 1
    Wend
    

End Sub

Private Sub lbx_second_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Call btn_userfrmSubCodeOk_Click
End Sub

Private Sub UserForm_Initialize()
    Set xmlcode = GetDoc
    xmlcode.async = False
    xmlcode.validateOnParse = False
    xmlcode.resolveExternals = False
    xmlcode.preserveWhiteSpace = True
    
   
    If xmlcode.loadXML(ThisDocument.baseData.value) = False Then
         If xmlcode.Load(ThisDocument.Path + "\base.dat") = False Then
            MsgBox "|fffd||fffd||fffd||fffd||467||fffd||1b3||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical, "|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd|"
            Exit Sub
         End If
    End If
    Call getSubjectB
End Sub
'Function getSubjectA()
'    Dim n As Integer
'    n = 0
'    While Not xmlcode.getElementsByTagName("SubjectA").Item(n) Is Nothing
'        lbx_first.AddItem (xmlcode.getElementsByTagName("SubjectA").Item(n).Attributes(1).Text + xmlcode.getElementsByTagName("SubjectA").Item(n).Attributes(0).Text)
'        n = n + 1
'    Wend
'End Function

Private Sub btn_userfrmSubCodeOk_Click()
Dim a, b As String


If codeflag = 1 Then    '|fffd||fffd||fffd||fffd||fffd||fffd||467||fffd||fffd|
Dim abc As String
If VBA.IsNull(Me.lbx_second.value) Then
    abc = ""
Else
    abc = Me.lbx_second.value
End If
If abc = "" Then
    MsgBox "|fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||467||fffd||1b4||fffd||fffd||fffd|!", vbExclamation, "|fffd||fffd||fffd||fffd|"
    Exit Sub
End If
a = VBA.Trim(SplitStr(abc, ":")(1))
b = VBA.Trim(SplitStr(abc, ":")(0))
sqxmxxWin.researchDirection.value = b & "|fffd||fffd|" & a & "|fffd||fffd|"
End If

Unload UserfrmSubCode
End Sub


Attribute VB_Name = "choosePertinentSubject"
Attribute VB_Base = "0{6EABB38C-6345-4F1B-9A4E-90098619E14D}{BDC4D388-FE03-4C83-9C2E-D0399FC49693}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False








Private Sub chooseSubject1_Click()
    codeflag = 1
    jxxgxkSubCode.Show
End Sub

Private Sub chooseSubject2_Click()
    codeflag = 2
    jxxgxkSubCode.Show
End Sub

Private Sub chooseSubject3_Click()
    codeflag = 3
    jxxgxkSubCode.Show
End Sub

Private Sub CommandButton1_Click()
    subject1.value = ""
    subject2.value = ""
    subject3.value = ""
    sqxmxxWin.researchDirection.value = ""
End Sub

Private Sub Label1_Click()

End Sub

Private Sub submitBtn_Click()
    If subject1.value = "" Then
        Call MsgBox("|fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||23d||3f8||7f5||fffd||467||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        chooseSubject1.SetFocus
        Exit Sub
    End If
    If subject1.value = subject2.value Then
        Call MsgBox("|fffd||fffd||4bb||fffd||fffd| |fffd||fffd| |fffd||6b6||fffd||fffd||ecbb||fffd||fffd||fffd||fffd||36c|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        chooseSubject1.SetFocus
        Exit Sub
    End If
    If subject1.value = subject3.value Then
        Call MsgBox("|fffd||fffd||4bb||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||ecbb||fffd||fffd||fffd||fffd||36c|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        chooseSubject1.SetFocus
        Exit Sub
    End If
    If subject2.value <> "" And subject3.value <> "" And subject2.value = subject3.value Then
        Call MsgBox("|fffd||6b6||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||ecbb||fffd||fffd||fffd||fffd||36c|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        chooseSubject2.SetFocus
        Exit Sub
    End If
    
    Dim flag As String
    flag = subject1.value + "|fffd||fffd|"
    
    If subject2.value <> "" Then
        flag = flag + subject2.value + "|fffd||fffd|"
    End If
    If subject3.value <> "" Then
        flag = flag + subject3.value + "|fffd||fffd|"
    End If
   
    flag = VBA.Left(flag, VBA.Len(flag) - 1)
    
    sqxmxxWin.researchDirection.value = flag
    Unload Me
End Sub

Private Sub cancelBtn_Click()
    Unload Me
End Sub


Private Sub UserForm_Initialize()
    If sqxmxxWin.researchDirection.value <> "" Then
        Dim strs As Variant
        strs = SplitStr(sqxmxxWin.researchDirection.value, "|fffd||fffd|")
        subject1.value = strs(0) & "|fffd||fffd|"
        If UBound(strs) > 1 Then
            subject2.value = VBA.Mid(strs(1), 2) & "|fffd||fffd|"
        End If
        If UBound(strs) > 2 Then
            subject3.value = VBA.Mid(strs(2), 2) & "|fffd||fffd|"
        End If
    End If
End Sub
Attribute VB_Name = "chooseYearMonth"
Attribute VB_Base = "0{0107BCC7-0008-48ED-8DE7-2476F4814841}{0AE04041-5DB7-42BD-B8A8-4AE3CC1F5973}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







Private Sub CommandButton1_Click()
    If sYear.value = "" Then
         Call MsgBox("|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
         Exit Sub
    End If
    If sMonth.value = "" Then
         Call MsgBox("|fffd||fffd||461||fffd||fffd||fffd||b7||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
         Exit Sub
    End If
    Dim nextControl As Object
    Dim resultDate As String
    resultDate = sYear.value & "-" & sMonth.value
    Select Case codeflag
        Case 2:  '|fffd||fffd||531|-|fffd||fffd||13f||fffd||fffd||5fc||2b1||fffd||fffd|
           
        Case 3:  '|fffd||fffd||13f|-|fffd||1bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Project.sqxmxxWin.planFinishDate = resultDate
        Case 4:  '|fffd||fffd||13f|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
            Project.sqxmxxWin.applyDate = resultDate
        Case 5:  '|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
           
    End Select
    Unload Me
End Sub


Private Sub CommandButton2_Click()
    Unload Me
End Sub

Private Sub CommandButton3_Click()
   
End Sub

Private Sub UserForm_Activate()
    
    Select Case codeflag
        Case 2:  '|fffd||fffd||531|-|fffd||fffd||13f||fffd||fffd||5fc||2b1||fffd||fffd|
            
        Case 3:  '|fffd||fffd||13f|-|fffd||1bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
             With Project.sqxmxxWin
               Me.Move (.Left + .Frame2.Left + .planFinishDate.Left), (.Top + .planFinishDate.Top + .Frame2.Top + 30 + .planFinishDate.Height)
            End With
        Case 4:  '|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
             With Project.sqxmxxWin
               Me.Move (.Left + .Frame2.Left + .applyDate.Left), (.Top + .Frame2.Top + 30 + .applyDate.Top + .applyDate.Height)
            End With
        Case 5:  '|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd|
            
    End Select
End Sub

Private Sub UserForm_Initialize()
    Call currencySet(Me)
    Dim yearBound As Variant
    yearBound = SplitStr(chooseYearBound, "-")
    Dim i As Integer
    For i = Val(yearBound(0)) To Val(yearBound(1))
        sYear.AddItem i
    Next
    For i = 1 To 12
        sMonth.AddItem i
    Next
    
End Sub
Attribute VB_Name = "chooseYearMonthDay"
Attribute VB_Base = "0{14579219-DD5C-440C-8734-4FD4F2EBE973}{0700A847-4827-4FF0-8F37-2D8B3B8CA9AA}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Private Sub CommandButton1_Click()
    Dim resultDate As String
    If sYear.value = "" And sMonth.value = "" And sDay.value = "" Then
        resultDate = ""
        GoTo returnYMD
    End If
    If sYear.value = "" Then
         Call MsgBox("|fffd||fffd||461||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
         Exit Sub
    End If
    If sMonth.value = "" Then
         Call MsgBox("|fffd||fffd||461||fffd||fffd||fffd||b7||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
         Exit Sub
    End If
    If sDay.value = "" Then
         Call MsgBox("|fffd||fffd||461||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||2be|...")
         Exit Sub
    End If
    Dim nextControl As Object

    resultDate = sYear.value & "-" & sMonth.value & "-" & sDay.value
returnYMD:
    With Project.zycyWin
    Select Case codeflag
        Case 1:
        .memberBirthday0.value = resultDate
        Case 2:
        .memberBirthday1.value = resultDate
        Case 3:
        .memberBirthday2.value = resultDate
        Case 4:
        .memberBirthday3.value = resultDate
        Case 5:
        .memberBirthday4.value = resultDate
        Case 6:
        .memberBirthday5.value = resultDate
        Case 7:
        .memberBirthday6.value = resultDate
        Case 8:
        .memberBirthday7.value = resultDate
        Case 9:
        .memberBirthday8.value = resultDate
     End Select
      End With

    Unload Me
End Sub


Private Sub CommandButton2_Click()
    Unload Me
End Sub

Private Sub CommandButton3_Click()
   
End Sub

Private Sub sMonth_Change()
    sDay.Clear
    If sYear.value <> "" And sMonth.value <> "" Then
        Dim i As Integer
        Dim current As String
        Dim nextMonth As String
        current = sYear.value & "-" & sMonth.value & "-1"
        If sMonth.value = "12" Then
            nextMonth = VBA.LTrim(VBA.str(VBA.Val(sYear.value) + 1)) & "-01-01"
        Else
            nextMonth = sYear.value & "-" & VBA.LTrim(VBA.str(VBA.Val(sMonth.value) + 1)) & "-01"
        End If
        
        For i = 1 To VBA.DateDiff("d", current, nextMonth)
            sDay.AddItem i
        Next i
    End If
End Sub

Private Sub sYear_Change()
    Call sMonth_Change
End Sub

Private Sub UserForm_Activate()
    With Project.zycyWin
    Select Case codeflag
        Case 1:
        Me.Move (.Left + .frame3.Left + .memberBirthday0.Left), (.Top + .frame3.Top + 30 + .memberBirthday0.Top + .memberBirthday0.Height)
        Case 2:
        Me.Move (.Left + .frame3.Left + .memberBirthday1.Left), (.Top + .frame3.Top + 30 + .memberBirthday1.Top + .memberBirthday1.Height)
        Case 3:
        Me.Move (.Left + .frame3.Left + .memberBirthday2.Left), (.Top + .frame3.Top + 30 + .memberBirthday2.Top + .memberBirthday2.Height)
        Case 4:
        Me.Move (.Left + .frame3.Left + .memberBirthday3.Left), (.Top + .frame3.Top + 30 + .memberBirthday3.Top + .memberBirthday3.Height)
        Case 5:
        Me.Move (.Left + .frame3.Left + .memberBirthday4.Left), (.Top + .frame3.Top + 30 + .memberBirthday4.Top + .memberBirthday4.Height)
        Case 6:
        Me.Move (.Left + .frame3.Left + .memberBirthday5.Left), (.Top + .frame3.Top + 30 + .memberBirthday5.Top + .memberBirthday5.Height)
        Case 7:
        Me.Move (.Left + .frame3.Left + .memberBirthday6.Left), (.Top + .frame3.Top + 30 + .memberBirthday6.Top + .memberBirthday6.Height)
        Case 8:
        Me.Move (.Left + .frame3.Left + .memberBirthday7.Left), (.Top + .frame3.Top + 30 + .memberBirthday7.Top + .memberBirthday7.Height)
        Case 9:
        Me.Move (.Left + .frame3.Left + .memberBirthday8.Left), (.Top + .frame3.Top + 30 + .memberBirthday8.Top + .memberBirthday8.Height)
     End Select
      End With
End Sub

Private Sub UserForm_Initialize()
    Call currencySet(Me)
    Dim yearBound As Variant
    yearBound = SplitStr(chooseYearBound, "-")
    Dim i As Integer
    For i = Val(yearBound(0)) To Val(yearBound(1))
        sYear.AddItem i
    Next
    For i = 1 To 12
        sMonth.AddItem i
    Next
   
End Sub

Attribute VB_Name = "fun_for_word97"
Public Function SplitStr(strValue As String, strDivider As String) As Variant
   Dim arrArray() As String
   Dim nCounter As Integer
   Dim sHold As String
   Dim nSplitCounter As Integer
   
   nSplitCounter = 0
   ReDim arrArray(nSplitCounter)
   strDivider = VBA.Left$(strDivider, 1)
   For nCounter = 1 To VBA.Len(strValue)
       Select Case VBA.Asc(VBA.Mid$(strValue, nCounter, 1))
           Case VBA.Asc(strDivider)
                arrArray(nSplitCounter) = sHold
                sHold = ""
                nSplitCounter = nSplitCounter + 1
                ReDim Preserve arrArray(nSplitCounter)
           Case Else
               sHold = sHold + VBA.Mid$(strValue, nCounter, 1)
       End Select
   Next
   arrArray(nSplitCounter) = sHold
   SplitStr = arrArray
End Function
Public Function VB5Replace(ByVal MyString As String, ByVal ToFind As String, ByVal ReplaceTo As String) As String
        Dim tmp     As String
        Dim n     As Integer
        Dim L     As Integer
    
        tmp = MyString
        n = VBA.InStr(1, tmp, ToFind)
        L = VBA.Len(ToFind)
        Do While n
              tmp = VBA.Left(tmp, n - 1) & ReplaceTo & VBA.Mid(tmp, n + L)
              n = VBA.InStr(n, tmp, ToFind)
        Loop
    
        VB5Replace = tmp
  End Function

Attribute VB_Name = "jfgsWin"
Attribute VB_Base = "0{7DCB81FE-D2C5-47F7-A638-0D47BE63C2FF}{CCB6716D-55DC-4082-959E-A823FCFE3B45}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







Private tmpTszlf As String
Private tmpZxf As String
Private tmpSjcjf As String
Private tmpLwf As String
Private tmpDyclf As String
Private tmpYsf As String
Private tmpSbgzf As String
Private tmpGlf As String
Private tmpXxhyf As String
Private tmpQt As String
Private tmpApplyTotalFee As String
Private tmpOtherFeeSource As String
Private Const fIndex As Integer = 2 '|fffd||7b8||fffd||fffd||fffd||fffd||fffd||4aa||36c||2b1|pub_check|fffd||fffd|checkAll

Private Sub applyTotalFee_Change()
    tmpApplyTotalFee = textBoxFilter(applyTotalFee, tmpApplyTotalFee, True, False)
End Sub

Private Sub applyTotalFee_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(applyTotalFee, VBA.Val(KeyAscii), True, False)
End Sub


Private Sub otherFeeSource_Change()
    tmpApplyTotalFee = textBoxFilter(otherFeeSource, tmpOtherFeeSource, True, False)
End Sub

Private Sub otherFeeSource_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(otherFeeSource, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub dyclf_Change()
    tmpDyclf = textBoxFilter(dyclf, tmpDyclf, True, False)
    Call caclTotal
End Sub

Private Sub dyclf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(dyclf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub glf_Change()
    tmpGlf = textBoxFilter(glf, tmpGlf, True, False)
    Call caclTotal
End Sub


Private Sub glf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(glf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub lwf_Change()
    tmpLwf = textBoxFilter(lwf, tmpLwf, True, False)
    Call caclTotal
End Sub


Private Sub lwf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(lwf, VBA.Val(KeyAscii), True, False)
End Sub


Private Sub qt_Change()
    tmpQt = textBoxFilter(qt, tmpQt, True, False)
    Call caclTotal
End Sub


Private Sub qt_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(qt, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub sbgzf_Change()
    tmpSbgzf = textBoxFilter(sbgzf, tmpSbgzf, True, False)
    Call caclTotal
End Sub


Private Sub sbgzf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(sbgzf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub sjcjf_Change()
    tmpSjcjf = textBoxFilter(sjcjf, tmpSjcjf, True, False)
    Call caclTotal
End Sub


Private Sub sjcjf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(sjcjf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub tszlf_Change()
    tmpTszlf = textBoxFilter(tszlf, tmpTszlf, True, False)
    Call caclTotal
End Sub


Private Sub tszlf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(tszlf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub xxhyf_Change()
    tmpXxhyf = textBoxFilter(xxhyf, tmpXxhyf, True, False)
    Call caclTotal
End Sub


Private Sub xxhyf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(xxhyf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub ysf_Change()
    tmpYsf = textBoxFilter(ysf, tmpYsf, True, False)
    Call caclTotal
End Sub

Private Sub ysf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(ysf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub zxf_Change()
    tmpZxf = textBoxFilter(zxf, tmpZxf, True, False)
    Call caclTotal
End Sub

Private Sub zxf_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(zxf, VBA.Val(KeyAscii), True, False)
End Sub

Private Sub btn_kt_add_Click()
    tszlf.SetFocus
    zxf.SetFocus
    If checkForm() = False Then Exit Sub
    With ThisDocument.Range.Tables(ThisDocument.Tables.Count - fIndex)
        .Cell(3, 2).Range.Text = tszlf.value
        .Cell(3, 4).Range.Text = zxf.value
        .Cell(4, 2).Range.Text = sjcjf.value
        .Cell(4, 4).Range.Text = lwf.value
        .Cell(5, 2).Range.Text = dyclf.value
        .Cell(5, 4).Range.Text = ysf.value
        .Cell(6, 2).Range.Text = sbgzf.value
        .Cell(6, 4).Range.Text = glf.value
        .Cell(7, 2).Range.Text = xxhyf.value
        .Cell(7, 4).Range.Text = qt.value
        .Cell(8, 3).Range.Text = total.caption
    End With
    With ThisDocument.Range.Tables(6)
         .Cell(5, 2).Range.Text = applyTotalFee.value
         .Cell(5, 4).Range.Text = otherFeeSource.value
    End With
    Unload Me
End Sub

Private Sub btn_kt_clear_Click()
    Unload Me
End Sub

Private Sub UserForm_Initialize()
    If VBA.Val(getCellValue(ThisDocument.Tables(ThisDocument.Tables.Count - fIndex).Cell(8, 3).Range.Text)) > 0 Then
        With ThisDocument.Range.Tables(ThisDocument.Tables.Count - fIndex)
            tszlf.value = getCellValue(.Cell(3, 2).Range.Text)
            zxf.value = getCellValue(.Cell(3, 4).Range.Text)
            sjcjf.value = getCellValue(.Cell(4, 2).Range.Text)
            lwf.value = getCellValue(.Cell(4, 4).Range.Text)
            dyclf.value = getCellValue(.Cell(5, 2).Range.Text)
            ysf.value = getCellValue(.Cell(5, 4).Range.Text)
            sbgzf.value = getCellValue(.Cell(6, 2).Range.Text)
            glf.value = getCellValue(.Cell(6, 4).Range.Text)
            xxhyf.value = getCellValue(.Cell(7, 2).Range.Text)
            qt.value = getCellValue(.Cell(7, 4).Range.Text)
            total.caption = getCellValue(.Cell(8, 3).Range.Text)
        End With
    End If
    With ThisDocument.Range.Tables(6)
        applyTotalFee.value = getCellValue(.Cell(5, 2).Range.Text)
        otherFeeSource.value = getCellValue(.Cell(5, 4).Range.Text)
    End With
    tszlf.SetFocus
End Sub
Private Function caclTotal()
    total.caption = VBA.Val(tszlf.value) + VBA.Val(zxf.value) + VBA.Val(sjcjf.value) + VBA.Val(lwf.value) + VBA.Val(dyclf.value) + VBA.Val(ysf.value) + VBA.Val(sbgzf.value) + VBA.Val(glf.value) + VBA.Val(xxhyf.value) + VBA.Val(qt.value)
    If VBA.Left(total.caption, 1) = "." Then total.caption = "0" & total.caption
End Function

Private Function checkForm()
    checkForm = False
    If (mastInput(Me, "applyTotalFee", "|fffd||fffd||fffd||bfad||fffd||fffd||fffd||736||fffd|") = False) Then
        Exit Function
    End If
    If exitFun(applyTotalFee, "|fffd||fffd||fffd||bfad||fffd||fffd||fffd||736||fffd|", 3) = True Then Exit Function
    If exitFun(otherFeeSource, "|fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||fffd|", 3) = True Then Exit Function
    If exitFun(tszlf, "|37c||fffd||fffd||fffd||fffd||fffd||3f7||fffd|", 2) Then Exit Function
    If exitFun(zxf, "|fffd||fffd||46f||fffd||fffd|", 2) Then Exit Function
    If exitFun(sjcjf, "|fffd||fffd||fffd||772||27c||fffd||fffd||fffd|", 2) Then Exit Function
    If exitFun(lwf, "|fffd||fffd||fffd||fffd||fffd|", 2) Then Exit Function
    If exitFun(dyclf, "|fffd||fffd||fffd||432||fffd||fffd||f7||fffd|", 2) Then Exit Function
    If exitFun(ysf, "|4e1||2e2||fffd||fffd|", 2) Then Exit Function
    If exitFun(sbgzf, "|fffd||8c78||fffd||fffd||fffd||fa||fffd||2b9||fffd||f7||fffd|", 2) Then Exit Function
    If exitFun(glf, "|fffd||fffd||fffd||fffd||fffd||fffd|", 2) Then Exit Function
    If exitFun(xxhyf, "|421||fffd||37b||fffd||fffd||fffd||fffd|", 2) Then Exit Function
    If exitFun(qt, "|fffd||fffd||fffd||fffd|", 2) Then Exit Function
    
    checkForm = True
End Function
Attribute VB_Name = "jxxgxkSubCode"
Attribute VB_Base = "0{761C5A1B-6A46-4D92-8AFA-68647C95AFA9}{98CD1034-A95B-4205-AF56-AF3A9A047613}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False






Public num1, num2 As Integer
Private xmlcode As Object
Private Sub btn_userfrmSubCodeCancel_Click()
    Unload Me
End Sub
Private Sub lbx_first_Change()
    Dim n As Integer
    Dim nownode As Object
    lbx_second.Clear
    n = lbx_first.ListIndex
    Set nownode = xmlcode.getElementsByTagName("SubjectA").Item(n)
    n = 0
    While Not nownode.ChildNodes(n) Is Nothing
        If n Mod 2 = 1 Then
            lbx_second.AddItem (nownode.ChildNodes(n).Attributes(1).Text + ":" + nownode.ChildNodes(n).Attributes(0).Text)
        End If
        n = n + 1
    Wend
End Sub

Private Sub lbx_second_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    Call btn_userfrmSubCodeOk_Click
End Sub

Private Sub UserForm_Initialize()
    Set xmlcode = GetDoc
    xmlcode.async = False
    xmlcode.validateOnParse = False
    xmlcode.resolveExternals = False
    xmlcode.preserveWhiteSpace = True
    
   
    If xmlcode.loadXML(ThisDocument.baseData.value) = False Then
         If xmlcode.Load(ThisDocument.Path + "\base.dat") = False Then
            MsgBox "|fffd||fffd||fffd||fffd||467||fffd||1b3||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.", vbCritical, "|fffd||4b2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b7||fffd||fffd||fffd||fffd|"
            Exit Sub
         End If
    End If
    Call getSubjectA
End Sub
Function getSubjectA()
    Dim n As Integer
    n = 0
    While Not xmlcode.getElementsByTagName("SubjectA").Item(n) Is Nothing
        lbx_first.AddItem (xmlcode.getElementsByTagName("SubjectA").Item(n).Attributes(1).Text + xmlcode.getElementsByTagName("SubjectA").Item(n).Attributes(0).Text)
        n = n + 1
    Wend
End Function

Private Sub btn_userfrmSubCodeOk_Click()
    Dim a, b As String
    Dim abc As String
    
    
    If Me.lbx_second.value <> "" Then
        abc = Me.lbx_second.value
    Else
        MsgBox "|fffd||532||fffd||fffd||fffd||fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", vbExclamation, "|fffd||fffd||fffd||fffd|"
        Exit Sub
    End If
    a = VBA.Trim(SplitStr(abc, ":")(1))
    b = VBA.Trim(SplitStr(abc, ":")(0))
    
    If codeflag = 1 Then    '|fffd||fffd||fffd||fffd||467||fffd||1b5||fffd||fffd||fffd||fffd||467||fffd||fffd|
        choosePertinentSubject.subject1.value = b & "|fffd||fffd|" & a & "|fffd||fffd|"
    ElseIf codeflag = 2 Then
        choosePertinentSubject.subject2.value = b & "|fffd||fffd|" & a & "|fffd||fffd|"
    ElseIf codeflag = 3 Then
        choosePertinentSubject.subject3.value = b & "|fffd||fffd|" & a & "|fffd||fffd|"
    End If
    Unload Me
End Sub




Attribute VB_Name = "pub_check"
Public edition_status As String
Public Const password = "eplugger_sinoss"

Public codeflag As Integer
Public chooseYearBound As String
Dim rootElement  As Object
Public firstSubjectIndex As Integer

'|fffd||fffd||fffd|Table|fffd||fffd|Cell|fffd||fffd||fffd||5b5| |fffd||fffd||4aa||3aa||fffd||fffd||225||fffd||fffd||fffd||fffd||fffd||13b||633||fffd||fffd||fffd|
Public Function getCellValue(str As String) As String
    getCellValue = VBA.Left(str, VBA.Len(str) - 2)
End Function


'|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3aa||461||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||5b1||fffd||fffd||bc||fffd||fffd|
Public Sub currencySet(currentForm As UserForm)
    Dim col
    For Each col In currentForm.Controls
        If VBA.TypeName(col) = "ComboBox" Then
            col.Style = fmStyleDropDownList
        End If
    Next
End Sub

'|fffd||fffd||fffd||fffd||423||fffd||fffd|
Public Function mastInput(uf As UserForm, items As String, captions As String) As Boolean
    mastInput = False
    Dim control
    Dim formItems As Variant
    Dim formItemCaptions As Variant
    Dim tmp As String
    formItems = SplitStr(items, ",")
    formItemCaptions = SplitStr(captions, ",")
    Dim i As Integer
    For i = 0 To UBound(formItems)
        tmp = formItems(i)
        Set control = getControl(uf, tmp)
        If VBA.Trim(control.value) = "" Then
            Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||434| " + formItemCaptions(i), vbOKOnly, "|fffd||fffd||fffd||fffd|...")
            On Error Resume Next
            control.SetFocus
            Exit Function
        End If
    Next
    mastInput = True
End Function

'|3aa||133|Element|fffd||fffd||fffd||fffd||5b8||fffd||fffd||fffd||63c||fffd||fffd||fffd||fffd||3f5||fffd||fffd||fffd||3e2|
Public Sub makeXML(parent As Object, uf As UserForm, items As String)
    Dim ele As Object
    Dim formItems As Variant
    Dim i As Integer
    Dim control
    Dim tmp As String
    formItems = SplitStr(items, ",")
    Set rootElement = GetDoc
    
    For i = 0 To UBound(formItems)
        tmp = formItems(i)
        Set control = getControl(uf, tmp)
        Set ele = rootElement.createElement(formItems(i))
        ele.Text = control.value
        parent.appendChild ele
    Next
End Sub

'|3aa||133|Element|fffd||fffd||fffd||fffd||5b8||fffd||fffd||fffd||63c||fffd||fffd||fffd||fffd||3f5||fffd||fffd||fffd||3e2|
Public Sub getValueToControl(source As Object, targetFrm As UserForm, items As String)
    Dim txt As String
    Dim tmp As String
    Dim formItems As Variant
    formItems = SplitStr(items, ",")
    Dim i As Integer
    Dim control As Object
    For i = 0 To UBound(formItems)
        tmp = formItems(i)
        Set control = getControl(targetFrm, tmp)
        txt = source.getElementsByTagName(formItems(i)).Item(0).Text
        control.value = txt
    Next
End Sub


'|fffd||fffd|userForm|fffd||435||f5||fffd||5b8||fffd||fffd||fffd||13f||63c||fffd||fffd||fffd||fffd||fffd|
Public Function getControl(continer As UserForm, controlName As String) As Object
    Dim col
    For Each col In continer.Controls
            If col.Name = controlName Then
                   Set getControl = col
                   Exit Function
            End If
    Next
    Set getControl = Nothing
End Function

'|fffd||fffd||fffd||fffd|textBox|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|KeyAscii |3aa||fffd||fffd||fffd||fffd||fffd|ascii|fffd||fffd|canDecimal|3aa||fffd||1f7||fffd||fffd||fffd||fffd||bc||fffd||fffd||421||fffd||fffd| canNegative|3aa||fffd||1f7||fffd||fffd||fffd||fffd||bc||fffd||be3a||fffd||fffd|
  Public Function OnlyKeyPressNumber(txt As TextBox, KeyAscii As Integer, canDecimal As Boolean, canNegative As Boolean) As Integer
        Dim gNumbers As String
        gNumbers = "1234567890" + VBA.Chr(8) + VBA.Chr(45) + VBA.Chr(46)
        If VBA.InStr(gNumbers, VBA.Chr(KeyAscii)) = 0 Then KeyAscii = 0
        If Not canDecimal And KeyAscii = 46 Then KeyAscii = 0
        If Not canNegative And KeyAscii = 45 Then KeyAscii = 0
        If KeyAscii = 46 And VBA.InStr(txt.Text, ".") <> 0 Then KeyAscii = 0                                 '"."|fffd||fffd||fffd||5bb||fffd||733||fffd||fffd||fffd||4bb||fffd||fffd|
        If KeyAscii = 45 Then               '"-"|fffd||171||fffd||fffd||fffd||fffd||fffd||6b5||fffd||4bb||3bb|,|fffd||fffd||5bb||fffd||733||fffd||fffd||fffd||4bb||fffd||fffd|
            If VBA.InStr(txt.Text, "-") <> 0 Then
                    KeyAscii = 0
            Else
                    txt.SelStart = 0
            End If
        End If
        OnlyKeyPressNumber = KeyAscii
  End Function
  Public Function invertInput(KeyAscii As String) As String
    invertInput = KeyAscii
     Select Case KeyAscii
        Case "|fffd||fffd|":
            invertInput = "1"
        Case "|fffd||fffd|":
            invertInput = "2"
        Case "|fffd||fffd|":
            invertInput = "3"
        Case "|fffd||fffd|":
            invertInput = "4"
        Case "|fffd||fffd|":
            invertInput = "5"
        Case "|fffd||fffd|":
            invertInput = "6"
        Case "|fffd||fffd|":
            invertInput = "7"
        Case "|fffd||fffd|":
            invertInput = "8"
        Case "|fffd||fffd|":
            invertInput = "9"
        Case "|fffd||fffd|":
            invertInput = "0"
        Case "|fffd||fffd|"
            invertInput = "a"
        Case "|fffd||fffd|"
        invertInput = "b"
        Case "|fffd||fffd|"
        invertInput = "c"
        Case "|fffd||fffd|"
        invertInput = "d"
        Case "|fffd||fffd|"
        invertInput = "e"
        Case "|fffd||fffd|"
        invertInput = "f"
        Case "|fffd||fffd|"
        invertInput = "g"
        Case "|fffd||fffd|"
        invertInput = "h"
        Case "|fffd||fffd|"
        invertInput = "i"
        Case "|fffd||fffd|"
        invertInput = "j"
        Case "|fffd||fffd|"
        invertInput = "k"
        Case "|fffd||fffd|"
        invertInput = "l"
        Case "|fffd||fffd|"
        invertInput = "m"
        Case "|fffd||fffd|"
        invertInput = "n"
        Case "|fffd||fffd|"
        invertInput = "o"
        Case "|fffd||fffd|"
        invertInput = "p"
        Case "|fffd||fffd|"
        invertInput = "q"
        Case "|fffd||fffd|"
        invertInput = "r"
        Case "|fffd||fffd|"
        invertInput = "s"
        Case "|fffd||fffd|"
        invertInput = "t"
        Case "|fffd||fffd|"
        invertInput = "u"
        Case "|fffd||fffd|"
        invertInput = "v"
        Case "|fffd||fffd|"
        invertInput = "w"
        Case "|fffd||fffd|"
        invertInput = "x"
        Case "|fffd||fffd|"
        invertInput = "y"
        Case "|fffd||fffd|"
        invertInput = "z"
        Case "|fffd||fffd|"
        invertInput = "A"
        Case "|fffd||fffd|"
        invertInput = "B"
        Case "|fffd||fffd|"
        invertInput = "C"
        Case "|fffd||fffd|"
        invertInput = "D"
        Case "|fffd||fffd|"
        invertInput = "E"
        Case "|fffd||fffd|"
        invertInput = "F"
        Case "|fffd||fffd|"
        invertInput = "G"
        Case "|fffd||fffd|"
        invertInput = "H"
        Case "|fffd||fffd|"
        invertInput = "I"
        Case "|fffd||fffd|"
        invertInput = "J"
        Case "|fffd||fffd|"
        invertInput = "K"
        Case "|fffd||fffd|"
        invertInput = "L"
        Case "|fffd||fffd|"
        invertInput = "M"
        Case "|fffd||fffd|"
        invertInput = "N"
        Case "|fffd||fffd|"
        invertInput = "O"
        Case "|fffd||fffd|"
        invertInput = "P"
        Case "|fffd||fffd|"
        invertInput = "Q"
        Case "|fffd||fffd|"
        invertInput = "R"
        Case "|fffd||fffd|"
        invertInput = "S"
        Case "|fffd||fffd|"
        invertInput = "T"
        Case "|fffd||fffd|"
        invertInput = "U"
        Case "|fffd||fffd|"
        invertInput = "V"
        Case "|fffd||fffd|"
        invertInput = "W"
        Case "|fffd||fffd|"
        invertInput = "X"
        Case "|fffd||fffd|"
        invertInput = "Y"
        Case "|fffd||fffd|"
        invertInput = "Z"
    End Select
  End Function
  Public Function invertInputNum2(KeyAscii As String, canDecimal As Boolean, canNegative As Boolean) As String
    invertInputNum2 = KeyAscii
    Select Case KeyAscii
        Case "|fffd||fffd|":
            invertInputNum2 = "1"
        Case "|fffd||fffd|":
            invertInputNum2 = "2"
        Case "|fffd||fffd|":
            invertInputNum2 = "3"
        Case "|fffd||fffd|":
            invertInputNum2 = "4"
        Case "|fffd||fffd|":
            invertInputNum2 = "5"
        Case "|fffd||fffd|":
            invertInputNum2 = "6"
        Case "|fffd||fffd|":
            invertInputNum2 = "7"
        Case "|fffd||fffd|":
            invertInputNum2 = "8"
        Case "|fffd||fffd|":
            invertInputNum2 = "9"
        Case "|fffd||fffd|":
            invertInputNum2 = "0"
        Case "|fffd||fffd|":
            If canNegative = True Then
                invertInputNum2 = "-"
            Else
                invertInputNum2 = ""
            End If
        Case "|fffd||fffd|":
            If canDecimal = True Then
                invertInputNum2 = "."
            Else
                invertInputNum2 = ""
            End If
    End Select
  End Function
  
  '|fffd||fffd||fffd||fffd|textbox change|fffd||bc||fffd| |fffd||fffd||fffd||fffd||5bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Function textBoxFilter(txt As TextBox, value As String, canDecimal As Boolean, canNegative As Boolean) As String '|fffd||fffd||5b9||bc||fffd||beba||fffd||fffd| |fffd||fffd||fffd||fffd|TextBox|fffd||fffd|_Change|fffd||fffd||fffd||fffd||fffd||fffd|
        textBoxFilter = value
        Dim s As String
        Dim resultStr As String
        Dim i As Integer
        Dim gNumbers As String
        gNumbers = "1234567890" + VBA.Chr(8) + VBA.Chr(45) + VBA.Chr(46)
        For i = 1 To VBA.Len(txt.value)
            s = invertInputNum2(VBA.Right(VBA.Left(txt.value, i), 1), canDecimal, canNegative)
            If VBA.InStr(gNumbers, s) = 0 Then
               txt.value = value
               Exit Function
            End If
            resultStr = resultStr + s
        Next
        textBoxFilter = resultStr
        txt.value = resultStr
  End Function
    
  '|fffd||fffd||fffd||fffd|textbox change|fffd||bc||fffd| |fffd||536||fffd||5ea||fffd||fffd||22b||fffd||1f5||fffd||fffd||fffd||1f2||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
  Public Function textBoxNoCNFilter(txt As TextBox, value As String) As String
        textBoxNoCNFilter = value
        Dim s As String
        Dim resultStr As String
        Dim i As Integer
        Dim gKeys As String
        gKeys = "1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ" + VBA.Chr(8) + VBA.Chr(45) + VBA.Chr(46)
        For i = 1 To VBA.Len(txt.value)
            s = invertInput(VBA.Right(VBA.Left(txt.value, i), 1))
            If VBA.InStr(gKeys, s) = 0 Then
               txt.value = value
               Exit Function
            End If
            resultStr = resultStr + s
        Next
        textBoxNoCNFilter = resultStr
        txt.value = resultStr
  End Function
'|fffd||fffd||fffd||fffd|DOC|fffd||fffd||22b||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
Public Function setpasd(pword As String)
    Dim i As Integer
    Dim tips As String
    Dim section_index As Integer
    ThisDocument.status.value = 1 '|fffd||fffd||fffd||135||fffd||fffd||fffd||5f4||32c||fffd||fffd||3aa||fffd||fffd||fffd||fffd||5f4||32c|
    ThisDocument.psd.value = pword
  '  ThisDocument.btnCheckProtect.caption = "|fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" '|fffd||f0||fffd||165||fffd||fffd||2f5||fffd||fffd||fffd||27c||fffd||9c63||fffd||fffd||fffd||fffd||3aa||fffd||7b8||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    Call setProcessControl(False)
    
   ' MsgBox "|fffd||135||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||279||fffd||fffd||fffd|", vbInformation, "|fffd||fffd||fffd||fffd|"
    ThisDocument.Shapes("Text Box 7").Visible = msoFalse
    ThisDocument.Shapes("Text Box 22").Visible = msoFalse
    ThisDocument.btnEditProtect.Width = 153
    ThisDocument.btnEditProtect.Height = 21
    ThisDocument.btnCheckProtect.Enabled = False
    ThisDocument.btnCheckProtect1.Enabled = False
    wd_protect (False)
    
    ThisDocument.Tables(2).Shading.BackgroundPatternColorIndex = wdWhite '.BackgroundPatternColor = wdColorWhite
    ThisDocument.Tables(4).Shading.BackgroundPatternColorIndex = wdWhite
    ThisDocument.Tables(6).Shading.BackgroundPatternColorIndex = wdWhite
    ThisDocument.Tables(ThisDocument.Tables.Count - 2).Shading.BackgroundPatternColorIndex = wdWhite
    ThisDocument.Tables(ThisDocument.Tables.Count - 1).Shading.BackgroundPatternColorIndex = wdWhite
    tips = "|fffd||135||fffd||423||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||279||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||631||fffd||fffd||135||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f4||fffd||fffd||fffd|"
    Call MsgBox(tips, vbOKOnly, "|fffd||fffd||fffd||fffd|")
    wd_protect (True)
End Function

'|fffd||fffd||fffd||fffd|
Public Function unlockDoc()
    ThisDocument.status.value = 0 '|fffd||fffd||fffd||135||fffd||fffd||fffd||5f4||32c||fffd||fffd||3aa||fffd||1f1||fffd||fffd||fffd||5f4||32c|
   ' ThisDocument.btnCheckProtect.caption = "|fffd||fffd||fffd||fffd||ec68||fffd||fffd||fffd||772||fffd||fffd||fffd||fffd||fffd||fffd||135||fffd|"
    Call setProcessControl(True)
    ThisDocument.Shapes("Text Box 7").Visible = msoTrue
    ThisDocument.Shapes("Text Box 22").Visible = msoTrue
    wd_protect (False)
    ThisDocument.Tables(ThisDocument.Tables.Count).Cell(1, 1).Range.Text = ""
    ThisDocument.Tables(2).Shading.BackgroundPatternColorIndex = wdGray25 '= wdColorGray10
    ThisDocument.Tables(4).Shading.BackgroundPatternColorIndex = wdGray25
    ThisDocument.Tables(6).Shading.BackgroundPatternColorIndex = wdGray25
    ThisDocument.Tables(ThisDocument.Tables.Count - 2).Shading.BackgroundPatternColorIndex = wdGray25
    ThisDocument.Tables(ThisDocument.Tables.Count - 1).Shading.BackgroundPatternColorIndex = wdGray25
    wd_protect (True)
    ThisDocument.btnEditProtect.Width = 0.75
    ThisDocument.btnEditProtect.Height = 0.75
    ThisDocument.btnCheckProtect.Enabled = True
    ThisDocument.btnCheckProtect1.Enabled = True
    
End Function

'|fffd||fffd|/|fffd||fffd| DOC|fffd||fffd||22b||fffd||fffd|
Public Function wd_protect(p As Boolean)
    With ThisDocument
        If p = False Then
            If .ProtectionType = wdAllowOnlyFormFields Then
                .Unprotect password
            End If
        Else
            If Not .ProtectionType = wdAllowOnlyFormFields Then
                .Protect wdAllowOnlyFormFields, True, password
            End If
        End If
    End With
End Function

'|fffd||fffd||fffd||fffd||fffd||ec68||fffd||fffd||fffd||fffd||5f4||32c|  true:|fffd||ec68||5f4||32c|  flase:|5bb||fffd||fffd||5f4||32c|
Public Function setProcessControl(isUsed As Boolean)
    With ThisDocument
        wd_protect (False)
        .Sections(1).ProtectedForForms = True
        Dim i As Integer
        For i = 2 To .Sections.Count
            If i Mod 2 = 0 Then
                .Sections(i).ProtectedForForms = True
            Else
                .Sections(i).ProtectedForForms = Not isUsed
            End If
        Next
        wd_protect (True)
        .chargerTitle.Enabled = isUsed
        .projectTitle.Enabled = isUsed
        .memberTitle.Enabled = isUsed
        .feeTitle.Enabled = isUsed
        '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|formfields
        Dim n As Integer
        For n = 1 To .FormFields.Count
           .FormFields(n).Enabled = isUsed
        Next n
        .FormFields.Shaded = isUsed
        .Shapes("Text Box 22").Visible = isUsed
        If isUsed Then
            ThisDocument.btnCheckProtect1.Width = 153
            ThisDocument.btnCheckProtect1.Height = 21
        Else
            ThisDocument.btnCheckProtect1.Width = 0.75
            ThisDocument.btnCheckProtect1.Height = 0.75
        End If
    End With
End Function

'|fffd||fffd||fffd||fffd||ec68||fffd||fffd||fffd||fffd|
Public Function checkAll() As Boolean
    If ThisDocument.Tables.Count <> 16 Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2bd||fffd||471||fffd||fffd||fffd||3aa||fffd||1bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||472||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd||fffd||fffd||2b9||fffd||fffd||52d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd| ", vbOKOnly, "|fffd||fffd||fffd||63e||fffd||fffd||fffd|...")
        checkAll = False
        Exit Function
    End If
    Dim mess As String
    Dim tips As String
    Dim tmp As String
    Dim n As Integer
    Dim i As Integer
    mess = "|fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||b4||fffd||fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
    tips = "|fffd||fffd||2be||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3b4||fffd||fffd||434||fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
    n = 0
    i = 0
    
    
    '|fffd||fffd||531||fffd||fffd||3e2|
    If ThisDocument.sqrxxXmlStr.value = "" Then
        n = n + 1
        mess = mess + VBA.str(n) + ",  |fffd||fffd||fffd||fffd||fffd||2fb||fffd||fffd||fffd||fffd||fffd||3e2|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
    End If
    With ThisDocument.Tables(3)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(.Rows.Count, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            i = i + 1
            tips = tips + VBA.str(i) + ",  |fffd||fffd||fffd||fffd||fffd||7f1||fffd||fffd||2fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||43e||fffd||fffd||279||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        If VBA.Len(tmp) > 1200 Then
            n = n + 1
            mess = mess + VBA.str(n) + ",  |fffd||fffd||fffd||fffd||fffd||7f1||fffd||fffd||2fd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||43e||fffd||fffd||279||fffd|  |fffd||fffd||fffd||734||fffd||fffd||fffd|800|fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
     '|fffd||fffd||531||fffd||fffd||3e2|
    If ThisDocument.cyzkxxXmlStr.value = "" Then
        i = i + 1
        tips = tips + VBA.str(i) + ",  |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4aa||fffd||fffd||531||fffd||fffd||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
    End If
    
    With ThisDocument.Tables(5)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            i = i + 1
            tips = tips + VBA.str(i) + ",  |fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc7e||fffd||fffd||fffd||fffd||fffd||439||635||fffd||fffd||fffd||4aa||fffd||43e||fffd||fffd||279||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        If VBA.Len(tmp) > 1200 Then
            n = n + 1
            mess = mess + VBA.str(n) + ",  |fffd||fffd||531||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bc7e||fffd||fffd||fffd||fffd||fffd||439||635||fffd||fffd||fffd||4aa||fffd||43e||fffd||fffd||279||fffd|  |fffd||fffd||fffd||734||fffd||fffd||fffd|800|fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
    '|fffd||fffd||fffd||fffd||fffd||fffd||3e2|
    If ThisDocument.sqxmxxXmlStr.value = "" Then
        n = n + 1
        mess = mess + VBA.str(n) + ",  |fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd||3e2|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
    ElseIf ThisDocument.sqrxxXmlStr.value <> "" Then
        Dim sqxmxxXml As Object
        Dim strProType As String
        Set sqxmxxXml = GetDoc
        Call sqxmxxXml.loadXML(ThisDocument.sqxmxxXmlStr.value)
        strProType = sqxmxxXml.documentElement.getElementsByTagName("projectType").Item(0).Text
        
        If "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f|" = strProType Then
            Dim sqrxxXml As Object
            Dim strBirthday As String
            Set sqrxxXml = GetDoc
            Call sqrxxXml.loadXML(ThisDocument.sqrxxXmlStr.value)
            strBirthday = sqrxxXml.documentElement.getElementsByTagName("birthday").Item(0).Text
             
            If VBA.DateDiff("d", "1969-12-31", strBirthday) <= 0 Then
                n = n + 1
                mess = mess + VBA.str(n) + ",  |fffd||fffd||fffd||fffd||fffd||7f5||fffd||fffd||fffd||fffd||fffd||fffd||47e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd||fffd||bdf6||3a7||fffd||fffd|40|fffd||a8e9||fffd||fffd||fffd||fffd||461||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||13f||fffd||fffd||fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
            End If
        End If
        
    End If
     '|fffd||fffd||fffd||bfad||fffd||fffd|
'    If Val(ThisDocument.Tables(6).Cell(5, 2).Range.Text) = 0 Then
'        n = n + 1
'        mess = mess + VBA.str(n) + ",  |fffd||fffd||fffd||bfad||fffd||fffd||fffd||736||fffd| |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
'    End If
    
  
    'replace(trim(strTemp),chr(13),"")

    With ThisDocument.Tables(7)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            n = n + 1
            mess = mess + VBA.str(n) + ", |fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||fffd||6fa||fffd||2b5||fffd||fffd||4e6||fffd||fc||fffd||5b5||fffd||fffd||13f||1f0||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||5f4||fffd||fffd||fffd||fffd||fffd||1a1||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
    With ThisDocument.Tables(9)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            n = n + 1
            mess = mess + VBA.str(n) + ", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||13f||fffd||a862||fffd||43e||fffd||fffd||fffd||fffd||761||fffd||fffd||fffd||37b||fffd||1b5||fffd||fffd||635||fffd||fffd||fffd||475||3871|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
    With ThisDocument.Tables(11)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            n = n + 1
            mess = mess + VBA.str(n) + ", |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||2fc||b7||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||1bb||fffd||fffd||fffd||fffd||221||fffd||1f0||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||5fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
    With ThisDocument.Tables(13)
        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
        If tmp = "" Then
            n = n + 1
            mess = mess + VBA.str(n) + ", |fffd||fffd||fffd||121||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||fffd||6b3||279||fffd||fffd||fffd||fffd||fffd||fffd||573||279||fffd||fffd||fffd||fffd||43e||fffd||fffd||279||fffd||fffd||fffd||524||fffd||fffd||225||fffd||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        If VBA.Len(tmp) > 900 Then
            n = n + 1
            mess = mess + VBA.str(n) + ", |fffd||fffd||fffd||121||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd||fffd||fffd||fffd||fffd||fffd||6b3||279||fffd||fffd||fffd||fffd||fffd||fffd||573||279||fffd||fffd||fffd||fffd||43e||fffd||fffd||279||fffd||fffd||fffd||524||fffd||fffd||225||fffd||fffd|  |fffd||fffd||fffd||734||fffd||fffd||fffd|800|fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
        End If
        tmp = ""
    End With
    '|fffd||fffd|5
'    With ThisDocument.Tables(11)
'        tmp = VB5Replace(VBA.Trim(getCellValue(.Cell(2, 1).Range.Text)), VBA.Chr(13), "")
'        If tmp = "" Then
'            i = i + 1
'            tips = tips + VBA.str(i) + ",  |fffd||43e||fffd||fffd||279||fffd||fffd||fffd||524||fffd||fffd||225||fffd||fffd||2b9||fffd||f7||fffd||3a7| |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
'        End If
'        If VBA.Len(tmp) > 700 Then
'            n = n + 1
'            mess = mess + VBA.str(n) + ",  |fffd||43e||fffd||fffd||279||fffd||fffd||fffd||524||fffd||fffd||225||fffd||fffd||2b9||fffd||f7||fffd||3a7| |fffd||fffd||fffd||734||fffd||fffd||fffd|700|fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
'        End If
'        tmp = ""
'    End With
    '|fffd||fffd||fffd||fffd| |fffd||fffd||fffd||478||fffd||fffd||fffd|
    If Val(ThisDocument.Tables(ThisDocument.Tables.Count - 2).Cell(8, 3).Range.Text) = 0 Then
        n = n + 1
        mess = mess + VBA.str(n) + ",  |fffd||fffd||fffd||478||fffd||fffd||fffd|  |3b4||fffd||fffd||434|" + VBA.Chr(13) + VBA.Chr(13)
    End If
    
    If (Val(ThisDocument.Tables(6).Cell(5, 2).Range.Text) + Val(ThisDocument.Tables(6).Cell(5, 4).Range.Text)) <> Val(ThisDocument.Tables(ThisDocument.Tables.Count - 2).Cell(8, 3).Range.Text) Then
        n = n + 1
        mess = mess + VBA.str(n) + ", |fffd||fffd||fffd||bfad||fffd||fffd||fffd||736||fffd| |fffd||fffd| |fffd||fffd||fffd||478||fffd||fffd||fffd||13a||3fc||fffd||5b5|  |fffd||fffd||fffd||fffd||fffd|" + VBA.Chr(13) + VBA.Chr(13)
    End If
    
    Dim m_n As Integer
    
    m_n = n

    If m_n <> 0 Then
        mess = mess + VBA.Chr(13) + VBA.Chr(13) + VBA.Chr(13) + "|fffd||fffd||fffd||3f5||373||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(m_n) + "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||7b8||fffd|..."
        MsgBox mess, vbExclamation, "|fffd||fffd||fffd||3f5||373|"
        checkAll = False
        Exit Function
    End If
    If i <> 0 Then
        tips = tips + VBA.Chr(13) + VBA.Chr(13) + VBA.Chr(13) + "|fffd||fffd||fffd||3f5||373||3aa||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|" + CStr(i) + "|fffd||fffd||3b4||fffd||fffd||434||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fb||fffd||fffd||fffd||fffd||fffd||763||fffd|"
        If MsgBox(tips, vbYesNo + vbQuestion, "|fffd||fffd||2be|...") = vbNo Then
            checkAll = False
            Exit Function
        End If
    End If
    checkAll = True
End Function

'|fffd||fffd||fffd||fffd||fffd||3f1||fffd||fffd||fffd||fffd||fffd|
Public Function makeXMLReportData() As Boolean
    Set rootElement = GetDoc
    Dim rootEle As Object
    Dim ele As Object
    Dim listEle As Object
    Set rootEle = rootElement.createElement("EPlugger_Data")
    
    
    '|fffd||fffd||fffd||fffd|Charger|fffd||98e8||fffd||fffd||531||fffd||fffd||3e2||fffd||fffd|
    Dim sqrxxXml As Object
    Set sqrxxXml = GetDoc
    Call sqrxxXml.loadXML(ThisDocument.sqrxxXmlStr.value)
    
     
    '|fffd||fffd||fffd||fffd|Project|fffd||98e8||fffd||fffd||13f||fffd||fffd||3e2||fffd||fffd|
    Dim sqxmxxXml As Object
    Set sqxmxxXml = GetDoc
    Call sqxmxxXml.loadXML(ThisDocument.sqxmxxXmlStr.value)
    wd_protect (False)
    '|fffd||fffd|Project|fffd||fffd||fffd||43c||fffd||fffd||fffd| |fffd||fffd||fffd||bfad||fffd||fffd||fffd||736||fffd|
    Set ele = rootElement.createElement("applyTotalFee")
    ele.Text = Val(ThisDocument.Tables(6).Cell(5, 2).Range.Text)
    sqxmxxXml.documentElement.appendChild ele
    
    '|fffd||fffd|Project|fffd||fffd||fffd||43c||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||534||fffd||fffd||fffd||fffd|
    Set ele = rootElement.createElement("otherFeeSource")
    ele.Text = Val(ThisDocument.Tables(6).Cell(5, 4).Range.Text)
    sqxmxxXml.documentElement.appendChild ele
    
    '|fffd||fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||531||fffd||fffd|
    If ThisDocument.cyzkxxXmlStr.value <> "" Then
        Dim cyzkxxXml As Object
        Set cyzkxxXml = GetDoc
        Call cyzkxxXml.loadXML(ThisDocument.cyzkxxXmlStr.value)
        sqxmxxXml.documentElement.appendChild cyzkxxXml.documentElement
    End If
    '|fffd||fffd||fffd||fffd||4bb||fffd||fffd||fffd||fffd||fffd||2be|
    Set ele = rootElement.createElement("projectMode")
    ele.Text = "0"
    sqxmxxXml.documentElement.appendChild ele
    
    rootEle.appendChild sqrxxXml.documentElement
    rootEle.appendChild sqxmxxXml.documentElement
    
    Selection.End = ThisDocument.Content.Start
    Selection.Start = Selection.End
    
    '|fffd||fffd||2bd||2b9||fffd||fffd||423||fffd||fffd||fffd||fffd|
    
    Set ele = rootElement.createElement("version")
    ele.Text = "v3.0.1"
    rootEle.appendChild ele
    
    ThisDocument.Tables(ThisDocument.Tables.Count).Cell(1, 1).Range.Text = rootEle.XML
'    Selection.Font.Size = 1
'    Selection.InsertBefore (rootEle.XML)
'    ThisDocument.reportData.value = Selection.End
'    Selection.Font.Hidden = True
    wd_protect (True)
    makeXMLReportData = True
End Function

Public Function checItem(kind As Integer, Text As String) As Boolean
Dim temp As String '
Dim n As Integer
checItem = False
Select Case kind
 Case 1
  '|fffd||fffd||fffd||fffd|
  If CStr(VBA.Val(Text)) <> Text And "0" + VBA.CStr(VBA.Val(Text)) <> Text Then
   Exit Function
  End If
 Case 2
  '|fffd||7ef0|
  temp = Text
  For n = 1 To VBA.Len(Text)
    If Not (VBA.Left(temp, 1) Like "[0-9]" Or VBA.Left(temp, 1) Like "-") Then
     Exit Function
    End If
  Next n
 Case 3
 'e-mail
    If Not (VBA.InStr(1, Text, "@") > 0) Then
      Exit Function
    End If
  
End Select
checItem = True
End Function
'|fffd||f5||fffd|DOC|fffd||fffd||fffd||fffd|
Public Function GetDoc() As Object
    On Error Resume Next
    Dim lobjPJInput  As Object
    Set lobjPJInput = CreateObject("Msxml2.DOMDocument.3.0")
    If lobjPJInput Is Nothing Then
        MsgBox "|fffd||fffd||fffd||73c||fffd||9c63||fffd||fffd||fffd||fffd||fffd||fffd||fffd||b8||fffd||fffd||fffd||fffd||fffd||fffd||52d||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13c||fffd|msxml3.dll|fffd||fffd||fffd||fffd||fffd||fffd||fffd||9cbb||fffd||fffd||36c||4bb||13f||bc|" & VBA.Chr(13) & "  ", vbOKOnly, "|fffd||fffd||fffd||fffd||fffd||fffd|"
        Exit Function
    End If
    
    Set GetDoc = lobjPJInput
End Function

'|fffd||fffd||fffd||fffd|TextBox|fffd||fffd|Exit|fffd||bc||fffd||fffd||fffd| |fffd||fffd||fffd||436||fffd|txt|fffd||435||fffd||fffd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||fffd||fffd||fffd||427||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||6df6||fffd||fffd||fffd||fffd||fffd||635||fffd|boolean|fffd||fffd||fffd||fffd||fffd||fffd||fffd||1bd||fffd||fffd||fffd||fffd||1f7||fffd||fffd||1b3||fffd||fffd||fffd|true|fffd||fffd||2be||fffd||fffd||fffd||1b3||fffd||fffd||fffd|
Public Function exitFun(txt As TextBox, caption As String, checkMaxLen As Integer) As Boolean
    If VBA.Len(txt.value) > 0 Then
        If Not VBA.IsNumeric(txt.value) Then
            Call MsgBox(caption & " |fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||fffd||fffd||5b8||fffd||2bd||fffd||fffd||427|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
            exitFun = True
            On Error Resume Next
            txt.SetFocus
            Exit Function
        End If
        txt.value = VBA.Val(txt.value)
        If VBA.Left(txt.value, 1) = "." Then txt.value = "0" & txt.value
        
        Dim zeroTip As String
        Dim i As Integer
        For i = 1 To checkMaxLen
            zeroTip = zeroTip & "0"
        Next i
        Dim flag As Variant
        flag = SplitStr(txt.value, ".")
        If VBA.Len(flag(0)) > checkMaxLen Then
            Call MsgBox(caption & " |fffd||13d||fffd||fffd||4e6||421||fffd||fffd|1" & zeroTip & "|fffd||fffd||52a|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
            exitFun = True
            txt.SetFocus
            Exit Function
        End If
        If UBound(flag) = 1 Then
            If VBA.Len(flag(1)) > 2 Then
                Call MsgBox(caption & " |5bb||fffd||fffd||4aa||fffd||fffd||237||fffd||fffd||fffd||fffd||52a||fffd||fffd||fffd||fffd||421||fffd||fffd||fffd||fffd||fffd||fffd||fffd|2|3bb||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
                exitFun = True
                txt.SetFocus
                Exit Function
            End If
        End If
    End If
    exitFun = False
End Function

Attribute VB_Name = "setpsdWin"
Attribute VB_Base = "0{1D15F8CE-4A1A-485E-8823-8844A3609C18}{BE141136-FA5E-4122-B0FA-2F38F6CB0AE8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False






Private tmpPWD As String
Private tmpPWD2 As String

Private Sub btncannel_Click()
edition_status = "0" '|fffd||fffd||2be||fffd||fffd||fffd||fffd||221||fffd||fffd||fffd||fffd||165||fffd||fffd||221||fffd||fffd||fffd||fffd||9c63||fffd||fffd||fffd||fffd||fffd||fffd||fffd||532||fffd||4aa||fffd||fffd||fffd||fffd|XML|fffd||13c||fffd|
Unload setpsdWin
End Sub

Private Sub btnok_Click()
Dim n As Integer
If tbxpsd.value <> tbxpsd2.value Then
   MsgBox ("|fffd||fffd||fffd||bcbb||4bb||fffd||fffd|!|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|")
   tbxpsd.SetFocus
   Else
'  ThisDocument.psd.Value = tbxpsd.Value
'  ThisDocument.status.Value = 0
'  ThisDocument.Unprotect password
'  ThisDocument.Sections(2).ProtectedForForms = True
'  For n = 1 To ThisDocument.FormFields.Count
'    ThisDocument.FormFields(n).Enabled = False
'  Next n
'  ThisDocument.Sections(1).Range.Tables(2).Cell(3, 7).Range.text = "protected"
'  ThisDocument.Protect wdAllowOnlyFormFields, True, password
'  ThisDocument.btnCheckProtect.Caption = "|fffd||135||fffd||fffd||fffd||fffd||fffd|"
'  ThisDocument.label_txxg.Width = 0.75
'  ThisDocument.label_txxg1.Width = 0.75
'  Unload setpsd
    
        If makeXMLReportData() = True Then
        Call setpasd(tbxpsd.value)
        End If
    Unload Me
  ' edition_status = "1" '1|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||237||fffd||fffd||fffd||fffd||165||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||4bb||fffd||a3||fffd||fffd||fffd||fffd||fffd|XML|fffd||13c||fffd|
End If
  
End Sub


Private Sub OptionButton1_Click()
    tbxpsd.value = ""
    tbxpsd2.value = ""
    tbxpsd.Enabled = True
    tbxpsd2.Enabled = True
    tbxpsd.BackColor = &H80000005
    tbxpsd2.BackColor = &H80000005
    btnok.Enabled = False
    tbxpsd.SetFocus
End Sub

Private Sub OptionButton2_Click()
    tbxpsd.value = ""
    tbxpsd2.value = ""
    
    tbxpsd.Enabled = False
    tbxpsd2.Enabled = False
    tbxpsd.BackColor = &HE0E0E0
    tbxpsd2.BackColor = &HE0E0E0
    btnok.Enabled = True
End Sub


Private Sub tbxpsd_Change()
    tmpPWD = textBoxNoCNFilter(tbxpsd, tmpPWD)
    If tbxpsd.value <> tbxpsd2.value Then
        btnok.Enabled = False
    ElseIf tbxpsd.value = tbxpsd2.value And tbxpsd.value <> "" Then
        btnok.Enabled = True
    End If
End Sub

'Private Sub tbxpsd_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'    KeyAscii = VBA.Asc(invertInput(VBA.Chr(KeyAscii)))
'End Sub

Private Sub tbxpsd2_Change()
    tmpPWD2 = textBoxNoCNFilter(tbxpsd2, tmpPWD2)
    If tbxpsd.value <> tbxpsd2.value Then
        btnok.Enabled = False
    ElseIf tbxpsd.value = tbxpsd2.value And tbxpsd.value <> "" Then
        btnok.Enabled = True
    End If
End Sub

'Private Sub tbxpsd2_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
'    KeyAscii = VBA.Asc(invertInput(VBA.Chr(KeyAscii)))
'End Sub

Private Sub UserForm_Initialize()
    edition_status = "0"
    tbxpsd.SetFocus
    tbxpsd.IMEMode = fmIMEModeOff
    tbxpsd2.IMEMode = fmIMEModeOff
End Sub


Attribute VB_Name = "sqrxxWin"
Attribute VB_Base = "0{5E01AAE5-9056-4948-B30D-314F0EE013A1}{96F9025E-FBBF-4A47-8682-04A808C073AF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False







Private tmpPostalCode As String
Private tmpTelOffice As String
Private tmpTel As String
Private tmpEmail As String
Private tmpIDCardNo As String
Private gNumbers As String



Private Sub btn_kt_delete_Click()
    If MsgBox("|fffd||fffd||fffd||4aa||27e||fffd||fffd||fffd||fffd||bc||fffd||fffd|", vbYesNo + vbQuestion, "|27e||fffd||fffd|...") = vbYes Then
        applyer.value = ""
        gender.value = ""
        birthday.value = ""
        IDCardNo.value = ""
        title.value = ""
        division.value = ""
        duty.value = ""
        eduLevel.value = ""
        eduDegree.value = ""
        language.value = ""
        address.value = ""
        postalCode.value = ""
        telOffice.value = ""
        tel.value = ""
        email.value = ""
        With ThisDocument.Range.Tables(2)
            .Cell(2, 2).Range.Text = ""
            .Cell(2, 4).Range.Text = ""
            .Cell(2, 6).Range.Text = ""
            .Cell(3, 2).Range.Text = ""
            .Cell(3, 4).Range.Text = ""
            .Cell(4, 2).Range.Text = ""
            .Cell(4, 4).Range.Text = ""
            .Cell(4, 6).Range.Text = ""
            .Cell(5, 2).Range.Text = ""
            .Cell(5, 4).Range.Text = ""
            .Cell(6, 2).Range.Text = ""
            .Cell(7, 2).Range.Text = ""
            .Cell(7, 4).Range.Text = ""
            .Cell(7, 6).Range.Text = ""
        End With
        ThisDocument.applyer.caption = "        "
        ThisDocument.sqrxxXmlStr.value = ""
        btn_kt_delete.Enabled = False
        applyer.SetFocus
    End If
End Sub

Private Sub CommandButton1_Click()
    applyer.SetFocus
    If (checkForm() = False) Then
        Exit Sub
    End If
    With ThisDocument.Range.Tables(2)
        .Cell(2, 2).Range.Text = applyer.value
        .Cell(2, 4).Range.Text = gender.value
        .Cell(2, 6).Range.Text = birthday.value
        .Cell(3, 2).Range.Text = title.value
        .Cell(3, 4).Range.Text = division.value
        .Cell(4, 2).Range.Text = duty.value
        .Cell(4, 4).Range.Text = eduLevel.value
        .Cell(4, 6).Range.Text = eduDegree.value
        .Cell(5, 2).Range.Text = language.value
        .Cell(5, 4).Range.Text = email.value
        .Cell(6, 2).Range.Text = address.value
        .Cell(7, 2).Range.Text = postalCode.value
        .Cell(7, 4).Range.Text = tel.value
        .Cell(7, 6).Range.Text = telOffice.value
    End With
    ThisDocument.applyer.caption = applyer.value
    Dim rootElement As Object
    Set rootElement = GetDoc
    Dim rootEle As Object
    Dim cpsEle As Object
    
    Set rootEle = rootElement.createElement("Charger")
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2|
    Call makeXML(rootEle, Me, "applyer,gender,birthday,IDCardNo,title,division,duty,eduLevel,eduDegree,language,email,address,postalCode,telOffice,tel")
    ThisDocument.sqrxxXmlStr.value = rootEle.XML
    
    Unload Me
End Sub

Private Sub CommandButton2_Click()
    Unload Me
End Sub

Private Sub IDCardNo_Change()
    tmpIDCardNo = textBoxNoCNFilter(IDCardNo, tmpIDCardNo)
End Sub

Private Sub IDCardNo_Exit(ByVal Cancel As MSForms.ReturnBoolean)
    birthday.value = getCIDBirthday(IDCardNo)
End Sub


Private Sub IDCardNo_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If KeyAscii = 120 Then KeyAscii = 88
End Sub

Private Sub postalCode_Change()
    tmpPostalCode = textBoxFilter(postalCode, tmpPostalCode, False, False)
End Sub

Private Sub postalCode_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = OnlyKeyPressNumber(postalCode, VBA.Val(KeyAscii), False, False)
End Sub

Private Sub tel_Change()
    tmpTel = textBoxFilter(tel, tmpTel, False, False)
End Sub

Private Sub tel_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If VBA.InStr(gNumbers, VBA.Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub telOffice_Change()
    tmpTelOffice = textBoxFilter(telOffice, tmpTelOffice, False, True)
End Sub

Private Sub telOffice_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    If VBA.InStr(gNumbers, VBA.Chr(KeyAscii)) = 0 Then KeyAscii = 0
End Sub

Private Sub UserForm_Initialize()
    Call currencySet(Me)
    gender.List = SplitStr("|fffd||fffd|,|16e|", ",")
    title.List = SplitStr("|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||2a6|,|fffd||fffd||fffd||fffd|,|fffd||43e||fffd||531|,|fffd||fffd||fffd||43e||fffd||531|,|fffd||fffd||fffd||fffd||fffd||43e||fffd||531|,|fffd||43e||fffd||2b5||3f0||531|,|fffd||7fc||fffd||2b5||fffd||fffd||2a6|,|2b5||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||2b5||fffd||fffd||2a6|,|2b5||fffd||fffd||531|,|fffd||7fc||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||531|,|fffd||7fc||fffd||169||fffd||fffd||2a6|,|169||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||169||fffd||fffd||2a6|,|169||4b5||fffd||fffd||fffd||fffd||531|,|fffd||7fc||fffd||fffd||fffd||4bd||2a6|,|fffd||fffd||4bd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||4bd||2a6|,|fffd||fffd||4bd||fffd||fffd||fffd||fffd||531|,|fffd||7fc||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||531|,|fffd||7fc||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||531|,|fffd||7fc||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||2a6|,|fffd||fffd||fffd||531|,|fffd||7fc||fffd||373||fffd||fffd||2a6|,|373||fffd||fffd||2a6|,|fffd||fffd||fffd||fffd||373||fffd||fffd||2a6|,|373||fffd||fffd||531|,|fffd||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||f2d|,|fffd||fffd||fffd||fffd||fffd||f2d|,|fffd||fffd||fffd||fffd||fffd||f2d|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||f2d|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||531|,|fffd||43e||fffd||fffd||fffd||531|,|fffd||fffd||fffd||43e||fffd||fffd||fffd||531|,|fffd||fffd||531|,|fffd||fffd||fffd||fffd||fffd||fffd||531|,|fffd||fffd||fffd||fffd||531|,|fffd||fffd||fffd||fffd||4bd||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||4bd||2a6|,|fffd||fffd||fffd||fffd||4bd||2a6|,|4bd||2a6|,|4bd||2bf|,|fffd||fffd||fffd||fffd||4a9||2a6|,|fffd||fffd||fffd||fffd||fffd||fffd||4a9||2a6|,|fffd||fffd||fffd||fffd||4a9||2a6|,|4a9||2a6|,|4a9||2bf|,|fffd||fffd||fffd||3bb||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||3bb||fffd||2a6|,|fffd||fffd||fffd||73b||fffd||2a6|,|fffd||fffd||2a6|,|fffd||fffd||2bf|,|fffd||fffd||fffd||3bc||fffd||2a6|,|fffd||fffd||fffd||fffd||fffd||3bc||fffd||2a6|,|fffd||fffd||fffd||73c||fffd||2a6|,|fffd||fffd||2a6|,|fffd||fffd||2bf|", ",")
    eduLevel.List = SplitStr("|fffd||fffd||2bf||fffd||43e||fffd||fffd||fffd|,|2f6||2bf||fffd||43e||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||5e8||fffd||fffd|,|fffd||fffd||5e8||fffd||fffd|,|fffd||fffd||fffd||fffd|", ",")
    eduDegree.List = SplitStr("|fffd||fffd||2bf|,|2f6||2bf|,|467||2bf|,|fffd||fffd||fffd||fffd|", ",")
    gNumbers = "1234567890" + VBA.Chr(8) + VBA.Chr(45) + VBA.Chr(46)
    If ThisDocument.sqrxxXmlStr.value <> "" Then
        Dim sqrxxXml As Object
        Set sqrxxXml = GetDoc
        Call sqrxxXml.loadXML(ThisDocument.sqrxxXmlStr.value)
        Call getValueToControl(sqrxxXml.documentElement, Me, "applyer,gender,birthday,IDCardNo,title,division,duty,eduLevel,eduDegree,language,email,address,postalCode,telOffice,tel")
    End If
    btn_kt_delete.Enabled = (applyer.value <> "")
    applyer.SetFocus
End Sub

Private Function checkForm() As Boolean
    checkForm = False
    If mastInput(Me, "applyer,gender,IDCardNo,title,division,eduLevel,eduDegree,language,address,postalCode,email,tel", "|fffd||fffd||fffd||fffd|,|fffd||531||fffd|,|fffd||fffd||fffd||fffd||5a4||fffd||fffd|,|5b0||fffd||fffd|,|fffd||fffd||fffd||6b2||fffd||fffd||fffd|,|fffd||fffd||fffd||467||fffd||fffd|,|fffd||fffd||fffd||467||3bb|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|368||476||fffd||fffd||5b7|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,E-Mail,|fffd||5bb||fffd|") = False Then
        Exit Function
    End If
    Dim idMsg As String
    idMsg = CIDCheck(IDCardNo.value)
    If idMsg <> "" Then
        Call MsgBox(idMsg, vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        IDCardNo.SetFocus
        Exit Function
    End If
    If VBA.Len(email.value) > 0 And Not (VBA.InStr(1, email.value, "@") > 0) Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd| E-Mail |fffd||fffd||2bd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        email.SetFocus
        Exit Function
    End If
    If Not checItem(1, postalCode.value) Or VBA.Len(postalCode.value) <> 6 Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd| |fffd||2b1||fffd| |fffd||fffd||2bd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        postalCode.SetFocus
        Exit Function
    End If
    If Not checItem(2, telOffice.value) Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd| |fffd||336||fffd||fffd||7ef0| |fffd||fffd||2bd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        telOffice.SetFocus
        Exit Function
    End If
    If Not checItem(2, tel.value) Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2||fffd||fffd| |fffd||5bb||fffd| |fffd||fffd||2bd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        tel.SetFocus
        Exit Function
    End If
    checkForm = True
End Function
Attribute VB_Name = "sqxmxxWin"
Attribute VB_Base = "0{D21D7AF8-4AE8-4653-8EE7-60DFCEBD5DC0}{359F3BBD-3F0D-43EB-AB42-DD5F03659CE1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False



    








Private Sub applyDate_Enter()
    CommandButton8.SetFocus
End Sub

Private Sub CommandButton4_Click()
    codeflag = 1
    UserfrmChooseSchoolCode.Show
    projectType.SetFocus
End Sub

Private Sub CommandButton5_Click()
    If (checkForm() = False) Then
        Exit Sub
    End If
    projectName.SetFocus
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
    With ThisDocument
        .projectType.caption = projectType.value
        .subject.caption = subject.value
        .projectName.caption = projectName.value
        .schoolCode.caption = schoolCode.value
        .applyDate.caption = applyDate.value
        .schoolName.caption = schoolName.value + "|fffd||fffd||fffd||fffd||fffd||a3||fffd|"
    End With
    '|fffd||fffd||13f||fffd||fffd||fffd||fffd||fffd||fffd|
    With ThisDocument.Range.Tables(6)
        .Cell(1, 2).Range.Text = projectName.value
        .Cell(2, 2).Range.Text = researchDirection.value
        .Cell(3, 2).Range.Text = researchType.value
        .Cell(3, 4).Range.Text = planFinishDate.value
        .Cell(4, 2).Range.Text = lastProductMode.value
    End With
    Dim rootElement As Object
    Set rootElement = GetDoc
    Dim rootEle As Object
    Set rootEle = rootElement.createElement("Project")
    '|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||3e2|
    Call makeXML(rootEle, Me, "projectType,projectName,subject,schoolCode,applyDate,schoolName,researchDirection,researchType,planFinishDate,lastProductMode,qtContent")

    ThisDocument.sqxmxxXmlStr.value = rootEle.XML
    Unload Me
End Sub



Private Sub CommandButton3_Click()
    If firstSubjectIndex = -1 Then
        Call MsgBox("|fffd||fffd||fffd||fffd||461||fffd||fffd| |467||fffd||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        subject.SetFocus
        Exit Sub
    End If
    If subject.value = "|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|" Then
        choosePertinentSubject.Show
    Else
        codeflag = 1
        UserfrmSubCode.Show
    End If
End Sub


Private Sub CommandButton7_Click()
    codeflag = 3
    chooseYearBound = (2011) & "-" & (2020)
    chooseYearMonth.Show
End Sub

Private Sub CommandButton8_Click()
    codeflag = 4
    chooseYearBound = (2011) & "-" & (2013)
    chooseYearMonth.Show
End Sub


Private Sub planFinishDate_Enter()
    CommandButton7.SetFocus
End Sub

Private Sub qt_Change()
    qtContent.Enabled = qt.value
    Label97.Visible = qt.value
    If qt.value Then
        qtContent.BackColor = &H80000005
        qtContent.SetFocus
    Else
        qtContent.BackColor = &HE0E0E0
        qtContent.value = ""
    End If
End Sub

Private Sub qtContent_Change()
    Label97.Visible = qtContent.Enabled And (VBA.Trim(qtContent.value) = "")
End Sub



Private Sub researchDirection_Enter()
    CommandButton3.SetFocus
End Sub



Private Sub researchType_Change()

End Sub

Private Sub schoolName_Enter()
    CommandButton4.SetFocus
End Sub

Private Sub subject_Change()
'    If subject.value = "|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|" Then
'        choosePertinentSubject.Show
'        If subject.value = "|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|" Then
'            subject.value = ""
'            firstSubjectIndex = -1
'        Else
'
'        End If
'    Else
        firstSubjectIndex = subject.ListIndex
'    End If
    researchDirection.value = ""
End Sub

Private Sub subject_KeyPress(ByVal KeyAscii As MSForms.ReturnInteger)
    KeyAscii = 0
End Sub

Private Sub btn_kt_delete_Click()
    If MsgBox("|fffd||fffd||fffd||4aa||27e||fffd||fffd||fffd||fffd||bc||fffd||fffd|", vbYesNo + vbQuestion, "|27e||fffd||fffd|...") = vbYes Then
        '|fffd||fffd||fffd||fffd||ec68||fffd||fffd|
        researchDirection.value = ""
        researchType.value = ""
        planFinishDate.value = ""
        lastProductMode.value = ""
       ' applyTotalFee.value = ""
       ' otherFeeSource.value = ""
        projectType.value = ""
        projectName.value = ""
        subject.value = ""
        schoolCode.value = ""
        applyDate.value = ""
        schoolName.value = ""
        '|fffd||fffd||fffd||fffd||fffd||fffd||573||279||fffd||fffd||fffd||2bd|
        zz.value = False
        lw.value = False
        zxbg.value = False
        dzcbw.value = False
        zl.value = False
        qt.value = False
        With ThisDocument
            .projectType.caption = "        "
            .subject.caption = "        "
            .projectName.caption = "        "
            .schoolCode.caption = "        "
            .applyDate.caption = "        "
            .schoolName.caption = "|fffd||fffd||fffd||fffd||fffd||a3||fffd|"
        End With
        '|fffd||fffd||fffd||fffd||fffd||13f||fffd||fffd||fffd||fffd|
        With ThisDocument.Range.Tables(6)
            .Cell(1, 2).Range.Text = ""
            .Cell(2, 2).Range.Text = ""
            .Cell(3, 2).Range.Text = ""
            .Cell(3, 4).Range.Text = ""
            .Cell(4, 2).Range.Text = ""
        End With
        '|fffd||fffd||fffd|XML|fffd||ec68||fffd||fffd||fffd||fffd|
        ThisDocument.sqxmxxXmlStr.value = ""
        btn_kt_delete.Enabled = False
        projectName.SetFocus
    End If
End Sub

Private Sub CommandButton6_Click()
    Unload Me
End Sub



Private Sub UserForm_Initialize()
    Call currencySet(Me)
    projectType.List = SplitStr("|fffd||6eee||fffd||fffd||fffd||fffd||fffd||fffd||13f|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||13f|,|fffd||533||ffad||fffd||fffd||fffd||fffd||13f|", ",")
    subject.List = SplitStr("|fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||2fc||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|/|2fc||fffd||fffd||fffd||fffd||fffd||3bd||fffd||fffd||fffd|,|fffd||fffd||467|,|fffd||7fc||fffd||467|,|fffd||6bd||fffd||467|,|fffd||fffd||fffd||fffd||467|,|fffd||439||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467|,|fffd||fffd||2b7||467|,|fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467|,|fffd||fffd||467|,|fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467||fffd||fffd||fffd||13b||fffd||467|,|fffd||fffd||fffd||fffd||467||fffd||bd2b||fffd||fffd||467|,|37c||fffd||fffd||761||fffd||fffd||9c68||fffd||fffd||fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467|,|373||fffd||fffd||467|,|fffd||6f0||fffd||328||fffd||fffd||fffd||fffd||fffd||43e||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||43e||fffd|,|fffd||fffd||fffd||fffd||467|,|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|", ",")
    researchType.List = SplitStr("|fffd||fffd||fffd||fffd||fffd||43e||fffd|,|4e6||fffd||fffd||fffd||43e||fffd|,|2b5||fffd||fffd||fffd||bde2||579|", ",")
    If ThisDocument.sqxmxxXmlStr.value <> "" Then
        Dim sqxmxxXml As Object
        Set sqxmxxXml = GetDoc
        Call sqxmxxXml.loadXML(ThisDocument.sqxmxxXmlStr.value)
        Dim strSubject As String
        strSubject = sqxmxxXml.documentElement.getElementsByTagName("subject").Item(0).Text
        If VBA.Len(strSubject) > VBA.Len("|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|") Then
            If VBA.Left(strSubject, VBA.Len("|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|")) = "|fffd||fffd||fffd||fffd||467||fffd||fffd|/|fffd||6fa||fffd||fffd||43e||fffd|" Then
                subject.AddItem strSubject
            End If
        End If
        subject.value = strSubject
        Call getValueToControl(sqxmxxXml.documentElement, Me, "projectType,projectName,schoolCode,applyDate,schoolName,researchDirection,researchType,planFinishDate,lastProductMode,qtContent")
        Call setCheckBox(lastProductMode.value)
    End If
    firstSubjectIndex = subject.ListIndex
    btn_kt_delete.Enabled = (projectName.value <> "")
    projectName.SetFocus
End Sub

Private Function setCheckBox(selectedCaption As String)
    If VBA.InStr(selectedCaption, zz.caption) <> 0 Then zz.value = True
    If VBA.InStr(selectedCaption, lw.caption) <> 0 Then lw.value = True
    If VBA.InStr(selectedCaption, zxbg.caption) <> 0 Then zxbg.value = True
    If VBA.InStr(selectedCaption, dzcbw.caption) <> 0 Then dzcbw.value = True
    If VBA.InStr(selectedCaption, zl.caption) <> 0 Then zl.value = True
    If qtContent.value <> "" Then
        qt.value = True
        Call qt_Change
        Call qtContent_Change
    End If
End Function

Private Function checkForm() As Boolean
    checkForm = False
    If (mastInput(Me, "projectName,projectType,researchType,subject,researchDirection,schoolName,applyDate,planFinishDate", "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||fffd||13f||fffd||fffd||fffd||fffd|,|fffd||43e||fffd||fffd||fffd||fffd|,|467||fffd||fffd||fffd||fffd||fffd||fffd|,|fffd||43e||fffd||fffd||fffd||fffd||bcc34||fffd||fffd||fffd|,|fffd||fffd||fffd||fffd||467||423|,|fffd||ac68||fffd||fffd||fffd||fffd|,|fffd||1bb||fffd||fffd||fffd||fffd||2b1||fffd||fffd|") = False) Then
        Exit Function
    End If
    
    If VBA.DateDiff("d", applyDate.value, planFinishDate.value) <= 0 Then
        Call MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |4e6||421||fffd||fffd| |fffd||1bb||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        Exit Function
    End If
    If qt.value And VBA.Trim(qtContent.value) = "" Then
        Call MsgBox("|fffd||fffd||fffd||573||279||fffd||fffd||fffd||2bd||461||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||434||fffd||fffd||fffd||775||fffd||fffd||fffd||fffd||fffd||fffd||fffd||131||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        qtContent.SetFocus
        Exit Function
    End If
    
    Dim flag As String
    flag = ""
    If zz.value Then
        flag = flag + zz.caption + "|fffd||fffd|"
    End If
    If lw.value Then
        flag = flag + lw.caption + "|fffd||fffd|"
    End If
    If zxbg.value Then
        flag = flag + zxbg.caption + "|fffd||fffd|"
    End If
    If dzcbw.value Then
        flag = flag + dzcbw.caption + "|fffd||fffd|"
    End If
    If zl.value Then
        flag = flag + zl.caption + "|fffd||fffd|"
    End If
     If qt.value Then
        flag = flag + VBA.Trim(qtContent.value) + "|fffd||fffd|"
    End If
    
    If flag = "" Then
        Call MsgBox("|fffd||fffd||fffd||fffd||461||fffd||fffd||4bb||fffd||fffd| |fffd||fffd||fffd||573||279||fffd||fffd||fffd||2bd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
        Exit Function
    End If
   
    
    lastProductMode.value = VBA.Left(flag, VBA.Len(flag) - 1)
    
    
    checkForm = True
End Function

Attribute VB_Name = "unLockWin"
Attribute VB_Base = "0{26208D5E-C9E9-4CF0-9C7E-A9FEB7875064}{B3A44E0F-803E-4D82-9A58-2EC5ED3B0C81}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False





Private tmpPWD As String

Private Sub unLockBtn_Click()
    If pwd.value <> "" And pwd.value = ThisDocument.psd.value Then
        Call unlockDoc
        Unload Me
    Else
        MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
        pwd.value = ""
        pwd.SetFocus
    End If
    
End Sub

Private Sub cancelBtn_Click()
    Unload Me
End Sub

Private Sub pwd_Change()
 tmpPWD = textBoxNoCNFilter(pwd, tmpPWD)
End Sub
Attribute VB_Name = "zycyWin"
Attribute VB_Base = "0{7DC1A513-B109-4D6B-A216-143233C81CF8}{F5204E94-13B5-4E14-8802-CAE9F930E88C}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Const chooseLabel As String = "|461| |fffd||fffd|"
Private Const clearLabel As String = "|fffd||fffd| |fffd||fffd|"


Private Sub memberBirthday0_Enter()
    chooseBirthdayBtn0.SetFocus
End Sub

Private Sub memberBirthday1_Enter()
    chooseBirthdayBtn1.SetFocus
End Sub
Private Sub memberBirthday2_Enter()
    chooseBirthdayBtn2.SetFocus
End Sub
Private Sub memberBirthday3_Enter()
    chooseBirthdayBtn3.SetFocus
End Sub
Private Sub memberBirthday4_Enter()
    chooseBirthdayBtn4.SetFocus
End Sub
Private Sub memberBirthday5_Enter()
    chooseBirthdayBtn5.SetFocus
End Sub
Private Sub memberBirthday6_Enter()
    chooseBirthdayBtn6.SetFocus
End Sub
Private Sub memberBirthday7_Enter()
    chooseBirthdayBtn7.SetFocus
End Sub
Private Sub memberBirthday8_Enter()
    chooseBirthdayBtn8.SetFocus
End Sub
Private Sub memberBirthday0_Change()
    If memberBirthday0 <> "" Then
        chooseBirthdayBtn0.caption = clearLabel
    Else
        chooseBirthdayBtn0.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday1_Change()
    If memberBirthday1 <> "" Then
        chooseBirthdayBtn1.caption = clearLabel
    Else
        chooseBirthdayBtn1.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday2_Change()
    If memberBirthday2 <> "" Then
        chooseBirthdayBtn2.caption = clearLabel
    Else
        chooseBirthdayBtn2.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday3_Change()
    If memberBirthday3 <> "" Then
        chooseBirthdayBtn3.caption = clearLabel
    Else
        chooseBirthdayBtn3.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday4_Change()
    If memberBirthday4 <> "" Then
        chooseBirthdayBtn4.caption = clearLabel
    Else
        chooseBirthdayBtn4.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday5_Change()
    If memberBirthday5 <> "" Then
        chooseBirthdayBtn5.caption = clearLabel
    Else
        chooseBirthdayBtn5.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday6_Change()
    If memberBirthday6 <> "" Then
        chooseBirthdayBtn6.caption = clearLabel
    Else
        chooseBirthdayBtn6.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday7_Change()
    If memberBirthday7 <> "" Then
        chooseBirthdayBtn7.caption = clearLabel
    Else
        chooseBirthdayBtn7.caption = chooseLabel
    End If
End Sub
Private Sub memberBirthday8_Change()
    If memberBirthday8 <> "" Then
        chooseBirthdayBtn8.caption = clearLabel
    Else
        chooseBirthdayBtn8.caption = chooseLabel
    End If
End Sub

Private Sub chooseBirthdayBtn0_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn0, memberBirthday0, 1)
End Sub
Private Sub chooseBirthdayBtn1_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn1, memberBirthday1, 2)
End Sub
Private Sub chooseBirthdayBtn2_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn2, memberBirthday2, 3)
End Sub
Private Sub chooseBirthdayBtn3_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn3, memberBirthday3, 4)
End Sub
Private Sub chooseBirthdayBtn4_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn4, memberBirthday4, 5)
End Sub
Private Sub chooseBirthdayBtn5_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn5, memberBirthday5, 6)
End Sub
Private Sub chooseBirthdayBtn6_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn6, memberBirthday6, 7)
End Sub
Private Sub chooseBirthdayBtn7_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn7, memberBirthday7, 8)
End Sub
Private Sub chooseBirthdayBtn8_Click()
    Call chooseBirthdayBtnClick(chooseBirthdayBtn8, memberBirthday8, 9)
End Sub


Private Function chooseBirthdayBtnClick(btn As CommandButton, txt As TextBox, index As Integer)
    If btn.caption = clearLabel Then
        txt.value = ""
    Else
        codeflag = index
        chooseYearBound = (1960) & "-" & (1999)
        chooseYearMonthDay.Show
    End If
End Function



Private Sub btn_kt_add_Click()
    Dim ids As String
    Dim rowIndex As Integer
    ids = checkListValue("memberName,memberTitle,memberBirthday,memberSpecialty,memberUnit,memberDivide", "|fffd||fffd||fffd||fffd|,|5b0||fffd||fffd|/|5b0||fffd||fffd|,|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|,|5e8||4b5|,|fffd||fffd||fffd||fffd||fffd||fffd||3bb|,|fffd||5b9||fffd||fffd||fffd||fffd|")
    If ids = "false" Then Exit Sub
    With ThisDocument.Tables(4)
    For rowIndex = 0 To 8
        .Cell(3 + rowIndex, 1).Range.Text = ""
        .Cell(3 + rowIndex, 2).Range.Text = ""
        .Cell(3 + rowIndex, 3).Range.Text = ""
        .Cell(3 + rowIndex, 4).Range.Text = ""
        .Cell(3 + rowIndex, 5).Range.Text = ""
        .Cell(3 + rowIndex, 6).Range.Text = ""
    Next
    End With
    If ids = "" Then
        ThisDocument.cyzkxxXmlStr.value = ""
    Else
        ThisDocument.cyzkxxXmlStr.value = setListValue(ids, "memberName,memberTitle,memberBirthday,memberSpecialty,memberUnit,memberDivide")
    End If
    Unload Me
End Sub

Private Sub btn_kt_clear_Click()
    Unload Me
End Sub



'Private Sub btn_kt_delete_Click()
'    Dim formItems As Variant
'    formItems = SplitStr("memberName,memberTitle,chooseBirthdayBtn,memberSpecialty,memberUnit,memberDivide", ",")
'
'    If MsgBox("|fffd||fffd||fffd||4aa||27e||fffd||fffd||fffd||fffd||bc||fffd||fffd|", vbYesNo + vbQuestion, "|27e||fffd||fffd|...") = vbYes Then
'        For rowIndex = 0 To 8
'            For i = 0 To UBound(formItems)
'                Set control = getControl(Me, (formItems(i) + VBA.LTrim(VBA.str(rowIndex))))
'                control.value = ""
'                ThisDocument.Tables(4).Cell(3 + rowIndex, 1 + i).Range.text = ""
'            Next
'        Next
'        ThisDocument.cyzkxxXmlStr.value = ""
'        btn_kt_delete.Enabled = False
'        memberName0.SetFocus
'    End If
'End Sub


Private Sub UserForm_Initialize()
    Call currencySet(Me)
    If ThisDocument.cyzkxxXmlStr.value <> "" Then
        Dim sqrxxXml As Object
        Set sqrxxXml = GetDoc
        Call sqrxxXml.loadXML(ThisDocument.cyzkxxXmlStr.value)
        Call getListValueToControl(sqrxxXml, "ProjectMember", "memberName,memberTitle,memberBirthday,memberSpecialty,memberUnit,memberDivide")
    End If
    memberName0.SetFocus
End Sub

Private Function check() As Boolean
    check = False
    If Me.memberName.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |fffd||fffd||fffd||fffd|"
         Exit Function
    End If
    If Me.memberTitle.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |5b0||fffd||fffd|/|5b0||fffd||fffd|"
         Exit Function
    End If
     If Me.memberBirthday.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
         Exit Function
    End If
    If Me.memberSpecialty.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |5e8||4b5|"
         Exit Function
    End If
    If Me.memberDivide.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |fffd||5b9||fffd||fffd||fffd||fffd|"
         Exit Function
    End If
    If Me.memberUnit.value = "" Then
         MsgBox "|fffd||fffd||fffd||fffd||434| |fffd||fffd||fffd||fffd||fffd||fffd||3bb|"
         Exit Function
    End If
    check = True
End Function
Public Sub getListValueToControl(source As Object, entityNameTag As String, tagNames As String)
    Dim ele As Object
    Dim control As Object
    Dim i As Integer
    Dim rowIndex As Integer
    Dim formItems As Variant
    formItems = SplitStr(tagNames, ",")

    rowIndex = 0
    For Each ele In source.getElementsByTagName(entityNameTag)
        For i = 0 To UBound(formItems)
            Set control = getControl(Me, (formItems(i) + VBA.LTrim(VBA.str(rowIndex))))
            control.value = ele.getElementsByTagName(formItems(i)).Item(0).Text
        Next
        rowIndex = rowIndex + 1
    Next
End Sub

Public Function setListValue(successRowIds As String, tagNames As String) As String
    Dim i As Integer
    Dim rowIndex As String
    Dim index As Integer
    Dim tRowIndex As Integer
    Dim formItems As Variant
    Dim successRowId As Variant
    formItems = SplitStr(tagNames, ",")
    successRowId = SplitStr(successRowIds, ",")
    Dim control As Object
    Dim rootElement As Object
    Set rootElement = GetDoc
    Dim rootEle As Object
    Dim ele As Object
    Set rootEle = rootElement.createElement("projectMembers")
    tRowIndex = 0
    
    For index = 0 To UBound(successRowId)
        For i = 0 To UBound(formItems)
            Set control = getControl(Me, (formItems(i) + successRowId(index)))
            ThisDocument.Tables(4).Cell(3 + tRowIndex, i + 1).Range.Text = control.value
        Next
        rowIndex = VBA.LTrim(VBA.str(successRowId(index)))
        Set ele = rootElement.createElement("ProjectMember")
        Call pmakeXML(ele, Me, "memberName,memberTitle,memberBirthday,memberSpecialty,memberUnit,memberDivide", rowIndex)
        rootEle.appendChild ele
        tRowIndex = tRowIndex + 1
    Next
    setListValue = rootEle.XML
End Function
Public Function checkListValue(tagNames As String, captions As String) As String
    Dim i As Integer
    Dim blankNum As Integer
    Dim rowIndex As Integer
    Dim formItems As Variant
    Dim formItemCaptions As Variant
    Dim tipMsg As String
    Dim successRowIds As String
    Dim control As Object
    
    formItems = SplitStr(tagNames, ",")
    formItemCaptions = SplitStr(captions, ",")
    
    For rowIndex = 0 To 8
        tipMsg = "|fffd||bcb9||fffd||fffd||fffd|" + VBA.str(rowIndex + 1) + "|fffd||fffd||fffd||fffd| "
        blankNum = 0
        For i = 0 To UBound(formItems)
            Set control = getControl(Me, (formItems(i) + VBA.LTrim(VBA.str(rowIndex))))
            If control.value = "" Then
                tipMsg = tipMsg + formItemCaptions(i) + "|fffd||fffd|"
                blankNum = blankNum + 1
            End If
        Next
        If blankNum = 0 Then 'success
            successRowIds = successRowIds + VBA.LTrim(VBA.str(rowIndex)) + ","
        Else
            If blankNum = UBound(formItems) + 1 Then 'row is blank
                
            Else 'need tip
                Call MsgBox(VBA.Left(tipMsg, VBA.Len(tipMsg) - 1) + "|fffd||fffd||fffd||fffd||fffd||fffd|", vbOKOnly, "|fffd||fffd||fffd||fffd|...")
                On Error Resume Next
                checkListValue = "false"
                Exit Function
            End If
        End If
    Next
    If VBA.Len(successRowIds) > 0 Then
        checkListValue = VBA.Left(successRowIds, VBA.Len(successRowIds) - 1)
    Else
        checkListValue = ""
    End If
End Function
Public Sub makeXML(parent As Object, uf As UserForm, items As String)
    Dim ele As Object
    Dim formItems As Variant
    Dim i As Integer
    Dim control
    formItems = SplitStr(items, ",")
    Set rootElement = GetDoc
    
    For i = 0 To UBound(formItems)
        Set control = getControl(uf, formItems(i))
        Set ele = rootElement.createElement(formItems(i))
        ele.Text = control.value
        parent.appendChild ele
    Next
End Sub
Public Sub pmakeXML(parent As Object, uf As UserForm, items As String, rowIndex As String)
    Dim ele As Object
    Dim formItems As Variant
    Dim i As Integer
    Dim control As Object
    Dim rootElement As Object
    
    formItems = SplitStr(items, ",")
    Set rootElement = GetDoc
    
    For i = 0 To UBound(formItems)
        Set control = getControl(uf, formItems(i) + rowIndex)
        Set ele = rootElement.createElement(formItems(i))
        ele.Text = control.value
        parent.appendChild ele
    Next
End Sub


' InQuest injected base64 decoded content
' ,y'!
' ]k m

INQUEST-PP=macro
