Attribute VB_Name = "Module1"
'Module1 tombol
'Module2 cetak
'Module3 1721_refpartner.csv
'Module4 1721_refpegawaiA1.csv
'Module5 1721_bp_tidak_final.csv
'Module6 1721_bp_final.csv
'Module7 1721_I_bulanan.csv
'Module8 1721_bp_A1.csv
'Module9 updatePT
'Module10 migrasi

Sub Lamp1ma()
    Dim t
    t = Split(Worksheets("I").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("I").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Lamp1ms()
    Dim t
    t = Split(Worksheets("I").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("I").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '

Sub Lamp1ha()
    Dim t
    t = Split(Worksheets("I").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("I").Range("BI2") = Join(t, "/")
'
End Sub
Sub Lamp1hs()
    Dim t
    t = Split(Worksheets("I").Range("BI2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("I").Range("BI2") = Join(t, "/")
    If Range("BI2").Value < 1 Then Range("BI2").Value = 1
'
End Sub '


Sub Lamp2ma()
    Dim t
    t = Split(Worksheets("II ").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("II ").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Lamp2ms()
    Dim t
    t = Split(Worksheets("II ").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("II ").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '


Sub Lamp2ha()
    Dim t
    t = Split(Worksheets("II ").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("II ").Range("BI2") = Join(t, "/")
'
End Sub
Sub Lamp2hs()
    Dim t
    t = Split(Worksheets("II ").Range("BI2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("II ").Range("BI2") = Join(t, "/")
    If Range("BI2").Value < 1 Then Range("BI2").Value = 1
'
End Sub '


Sub LampA1ua()
    Dim t
    t = Split(Worksheets("1721-A1 ").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("1721-A1 ").Range("S2") = Join(t, "/")
'
End Sub
Sub LampA1us()
    Dim t
    t = Split(Worksheets("1721-A1 ").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("1721-A1 ").Range("S2") = Join(t, "/")
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '
Sub LampA1nilua()
    Dim t
    t = Split(Worksheets("1721-A1 <<").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("1721-A1 <<").Range("S2") = Join(t, "/")
'
End Sub
Sub LampA1nilus()
    Dim t
    t = Split(Worksheets("1721-A1 <<").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("1721-A1 <<").Range("S2") = Join(t, "/")
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '


Sub Lamp6ma()
    Dim t
    t = Split(Worksheets("VI").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VI").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Lamp6ms()
    Dim t
    t = Split(Worksheets("VI").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("VI").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1

End Sub

Sub Lamp6ua()
    Dim t
    t = Split(Worksheets("VI").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VI").Range("BI2") = Join(t, "/")
'
End Sub
Sub Lamp6us()
    Dim t
    t = Split(Worksheets("VI").Range("BI2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("VI").Range("BI2") = Join(t, "/")
    If Range("BI2").Value < 1 Then Range("BI2").Value = 1

End Sub

Sub Lamp7ma()
    Dim t
    t = Split(Worksheets("VII").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VII").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Lamp7ms()
    Dim t
    t = Split(Worksheets("VII").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("VII").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1

End Sub

Sub Lamp7ua()
    Dim t
    t = Split(Worksheets("VII").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VII").Range("BI2") = Join(t, "/")
'
End Sub
Sub Lamp7us()
    Dim t
    t = Split(Worksheets("VII").Range("BI2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("VII").Range("BI2") = Join(t, "/")
    If Range("BI2").Value < 1 Then Range("BI2").Value = 1

End Sub



Sub Lamp3ma()
    Dim t
    t = Split(Worksheets("III").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("III").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Lamp3ms()
    Dim t
    t = Split(Worksheets("III").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("III").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '


Sub Lamp3ha()
    Dim t
    t = Split(Worksheets("III").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("III").Range("BI2") = Join(t, "/")
'
End Sub
Sub Lamp3hs()
    Dim t
    t = Split(Worksheets("III").Range("BI2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("III").Range("BI2") = Join(t, "/")
    If Range("BI2").Value < 1 Then Range("BI2").Value = 1
'
End Sub '


Sub Indukma()
    Dim t
    t = Split(Worksheets("INDUK").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("INDUK").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub
Sub Indukms()
    Dim t
    t = Split(Worksheets("INDUK").Range("S2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("INDUK").Range("S2") = Join(t, "/")
    If Range("S2").Value > 12 Then Range("S2").Value = 12
    If Range("S2").Value < 1 Then Range("S2").Value = 1
'
End Sub '
Sub Indukpa()
    Dim t
    t = Split(Worksheets("INDUK").Range("AZ2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("INDUK").Range("AZ2") = Join(t, "/")
    If Range("AZ2").Value < 1 Then Range("AZ2").Value = 1
'
End Sub
Sub Indukps()
    Dim t
    t = Split(Worksheets("INDUK").Range("AZ2").Text, "/")
    t(0) = Format(t(0) - 1, "0")
    Worksheets("INDUK").Range("AZ2") = Join(t, "/")
    If Range("AZ2").Value < 0 Then Range("AZ2").Value = 0
'
End Sub '

Attribute VB_Name = "Module10"
Sub migrasi()
'
' migrasi Macro
'

'
    'disable iterative
    Application.Iteration = False
    
    Dim filelama
    filelama = Range("B20")
    Dim filebaru
    filebaru = ActiveWorkbook.Name
    
    '***copy sheet id
    Windows(filelama & ".xlsm").Activate
    Sheets("ID PRSHN").Select
    Range("E3:G16").Select
    Selection.Copy
    Range("A1").Select
    
    Windows(filebaru).Activate
    Sheets("ID PRSHN").Select
    Range("I3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Dim namawp
    namawp = Range("I3")
    Dim npwp
    npwp = Range("I4")
    Dim alamat
    alamat = Range("I5")
    Dim kota
    kota = Range("I6")
    Dim tahun
    tahun = Range("I7")
    Dim kpp
    kpp = Range("I12")
    Dim kotakpp
    kotakpp = Range("I13")
    Dim ttd
    ttd = Range("I15")
    Dim npwpttd
    npwpttd = Range("I16")
    
    Range("E3") = namawp
    Range("E4") = npwp
    Range("E5") = alamat
    Range("E6") = kota
    Range("E7") = tahun
    Range("E12") = kpp
    Range("E13") = kotakpp
    Range("E15") = ttd
    Range("E16") = npwpttd
    
    Range("I3:I16").Select
    Selection.ClearContents
    Range("A1").Select
    
    '***copy sheet nonPT
    'cari jumlah baris data
    Windows(filelama & ".xlsm").Activate
    Sheets("#NonPT").Select
    Range("JA3") = "=COUNT($A$3:$A$1048576)"
    Dim datanonptlama As Integer
    datanonptlama = Range("JA3")
    
    'clear data
    Windows(filebaru).Activate
    Sheets("#NonPT").Select
    Range("JA4") = "=COUNT($A$3:$A$1048576)"
    Dim datanonpt As Integer
    datanonpt = Range("JA4")
    If datanonpt = 0 Then Range("E3").Select
    If datanonpt > 0 Then
    Range("E3").Select
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.Offset(datanonpt - 1, 0)).Select
    Selection.EntireRow.Delete
    End If
    
    'make space for old data
    Range("A3:IW3").Select
    Selection.Copy
    If datanonptlama = 0 Then Range("E3:Q3").ClearContents
    If datanonptlama = 1 Then Range("A3:IW3").Select
    If datanonptlama > 1 Then
    Range("A3:IW3").Select
    Range(Selection, Selection.Offset(datanonptlama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    End If
    
    'copy data
    Windows(filelama & ".xlsm").Activate
    Sheets("#NonPT").Select
    If datanonptlama = 0 Then Range("E3").Copy
    If datanonptlama = 1 Then
    Range("E3:Q3").Select
    Selection.Copy
    End If
    If datanonptlama > 1 Then
    Range("E3:Q3").Select
    Range(Selection, Selection.Offset(datanonptlama - 1, 0)).Select
    Selection.Copy
    End If
    Range("E3").Select
    
    'paste data to filebaru
    Windows(filebaru).Activate
    Sheets("#NonPT").Select
    Range("E3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("E3").Select
    
    'clear data filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("#NonPT").Select
    Range("JA3").Select
    Selection.ClearContents
    Range("E3").Select
    
    '***copy sheet dtpeg
    'cari jumlah baris data
    Windows(filelama & ".xlsm").Activate
    Sheets("dt peg").Select
    Range("A5") = "=COUNT($A$8:$A$1048576)"
    Dim datapeglama As Integer
    datapeglama = Range("A5")
    
    'clear data
    Windows(filebaru).Activate
    Sheets("dt peg").Select
    Range("R9") = "=COUNT($A$3:$A$1048576)"
    Dim datapeg As Integer
    datapeg = Range("R9")
    Range("A8").Select
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.Offset(datapeg - 1, 0)).Select
    Selection.EntireRow.Delete
    
    'make space for old data
    Range("A8:Q8").Select
    Selection.Copy
    If datapeglama = 1 Then Range("A8:Q8").Select
    If datapeglama > 1 Then
    Range("A8:Q8").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    End If
    
    'copy data
    Windows(filelama & ".xlsm").Activate
    Sheets("dt peg").Select
    If datapeglama = 1 Then
    Range("B8:Q8").Select
    Selection.Copy
    End If
    If datapeglama > 1 Then
    Range("B8:Q8").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    End If
    Range("A1").Select
    
    'paste data to filebaru
    Windows(filebaru).Activate
    Sheets("dt peg").Select
    Range("B8").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    '***copy sheet 1
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("1").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("1").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("1").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("1").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("1").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("1").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("1").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("1").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("1").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("1").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 2
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("2").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("2").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("2").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("2").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("2").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("2").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("2").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("2").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("2").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("2").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 3
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("3").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("3").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("3").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("3").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("3").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("3").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("3").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("3").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("3").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("3").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 4
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("4").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("4").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("4").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("4").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("4").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("4").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("4").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("4").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("4").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("4").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 5
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("5").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("5").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("5").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("5").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("5").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("5").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("5").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("5").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("5").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("5").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 6
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("6").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("6").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("6").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("6").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("6").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("6").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("6").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("6").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("6").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("6").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 7
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("7").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("7").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("7").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("7").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("7").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("7").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("7").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("7").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("7").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("7").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 8
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("8").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("8").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("8").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("8").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("8").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("8").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("8").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("8").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("8").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("8").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 9
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("9").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("9").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("9").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("9").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("9").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("9").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("9").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("9").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("9").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("9").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 10
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("10").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("10").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("10").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("10").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("10").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("10").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("10").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("10").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("10").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("10").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 11
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("11").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("11").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("11").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("11").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("11").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("11").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("11").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("11").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("11").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("11").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet 12
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("12").Select
    ActiveSheet.Unprotect "ap2114"
    
    'make space for old data
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("12").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data1
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("12").Select
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data2
    Windows(filelama & ".xlsm").Activate
    Sheets("12").Select
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("12").Select
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'copy data3
    Windows(filelama & ".xlsm").Activate
    Sheets("12").Select
    Range("AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("12").Select
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("12").Select
    Range("J4:AA4").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'fix column AR data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("12").Select
    Range("AR4:AR1048576").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("12").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    '***copy sheet A1
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("#A-1").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data
    Range("A2:DD2").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    ActiveCell.Offset(datapeglama, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    'unprotect sheet filelama
    Windows(filelama & ".xlsm").Activate
    Sheets("#A-1").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data tunj
    Range("N2").Select
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Windows(filebaru).Activate
    Sheets("#A-1").Select
    Range("N2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'normalize data lama
    Windows(filelama & ".xlsm").Activate
    Sheets("#A-1").Select
    Range("N:N").Select
    'Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet filelama
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'protect sheet file baru
    Windows(filebaru).Activate
    Sheets("#A-1").Select
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    Range("A1").Select
    
    '***copy sheet sum
    'unprotect sheet filebaru
    Windows(filebaru).Activate
    Sheets("sum").Select
    ActiveSheet.Unprotect "ap2114"
    
    'copy data
    Range("A16:BP16").Select
    Selection.Copy
    Range(Selection, Selection.Offset(datapeglama - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    
    'clear datapeglama
    Windows(filelama & ".xlsm").Activate
    Sheets("dt peg").Select
    Range("A5").Select
    Selection.ClearContents
    Range("A1").Select
    Sheets("ID PRSHN").Select
    Windows(filebaru).Activate
    Sheets("ID PRSHN").Select
    
    'enable iterative
    Application.Iteration = True
    
    'message
    MsgBox ("Migrasi data selesai. Klik OK.")
    
End Sub






Attribute VB_Name = "Module2"
Sub CetakLamp6()
'
' Cetak Bukti Potong Tidak Final
    
    'disable iterative
    Application.Iteration = False
    
    Range("CS2").Select
    Selection.Copy
    Range("BI2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=True, Transpose:=False
    
    Dim Counter As Integer
    For Counter = 1 To Range("DB2") - Range("CS2") + 1

    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _
        :=True, IgnorePrintAreas:=False
    
        Dim t
    t = Split(Worksheets("VI").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VI").Range("BI2") = Join(t, "/")
    
    Next Counter
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("Proses Cetak telah selesai. Klik OK.")

        
End Sub

Sub CetakLamp7()
'
' Cetak Bukti Potong Final

    'disable iterative
    Application.Iteration = False
    
    Range("CS2").Select
    Selection.Copy
    Range("BI2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=True, Transpose:=False
    
    Dim Counter As Integer
    For Counter = 1 To Range("DB2") - Range("CS2") + 1

    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _
        :=True, IgnorePrintAreas:=False
    
        Dim t
    t = Split(Worksheets("VII").Range("BI2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("VII").Range("BI2") = Join(t, "/")
    
    Next Counter
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("Proses Cetak telah selesai. Klik OK.")

        
End Sub

Sub CetakA1()
'
' Cetak Lampiran A1

    'disable iterative
    'Application.Iteration = False
    
    Range("BD2").Select
    Selection.Copy
    Range("S2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=True, Transpose:=False
    
    
    
    Dim Counter As Integer
    For Counter = 1 To Range("BM2") - Range("BD2") + 1
    
    'Application.Wait (Now + TimeValue("00:00:10"))

    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _
        :=True, IgnorePrintAreas:=False
    
        Dim t
    t = Split(Worksheets("1721-A1 ").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("1721-A1 ").Range("S2") = Join(t, "/")
    
    Next Counter
    
    'enable iterative
    'Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("Proses Cetak telah selesai. Klik OK.")

        
End Sub


Sub CetakA1nonPTKP()
'
' Cetak Lampiran A1 dibawah PTKP

    'disable iterative
    'Application.Iteration = False
    
    Range("BD2").Select
    Selection.Copy
    Range("S2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=True, Transpose:=False
    
    
    
    Dim Counter As Integer
    For Counter = 1 To Range("BM2") - Range("BD2") + 1
    
    'Application.Wait (Now + TimeValue("00:00:10"))

    ActiveWindow.SelectedSheets.PrintOut From:=1, To:=1, Copies:=1, Collate _
        :=True, IgnorePrintAreas:=False
    
        Dim t
    t = Split(Worksheets("1721-A1 <<").Range("S2").Text, "/")
    t(0) = Format(t(0) + 1, "0")
    Worksheets("1721-A1 <<").Range("S2") = Join(t, "/")
    
    Next Counter
    
    'enable iterative
    'Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("Proses Cetak telah selesai. Klik OK.")

        
End Sub




Attribute VB_Name = "Module3"
Sub csvrefpartner()
'
' Buat 1721_refpartner.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("AA1:BO1").Select
    Selection.EntireColumn.Delete
    
    'make header
    'Range("AA1").Select
    'ActiveCell = "NPWP"
    'Range("AB1").Select
    'ActiveCell = "NIK"
    'Range("AC1").Select
    'ActiveCell = "Nama"
    'Range("AD1").Select
    'ActiveCell = "Alamat"
    'Range("AE1").Select
    'ActiveCell = "WP Luar Negeri"
    'Range("AF1").Select
    'ActiveCell = "Kode Negara"
    
    'copy data
    Sheets("#NonPT").Select
    Dim count As Integer
    count = Range("EL1")
    
    Range("EZ1:FE2").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.Copy
    
    'klo gak ada data?
    
    Sheets("menucsv").Select
    Range("AA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("AA2:AF2").Select
    Selection.Delete Shift:=xlUp
    
    'remove duplicates
    Range("AA1:AF1").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    ActiveSheet.Range(Selection, Selection).RemoveDuplicates Columns:=Array(1, 3), Header:= _
        xlYes
    
    'clear data
    Sheets("#NonPT").Select
    Range("E3").Select
    
    'back to csv
    Sheets("menucsv").Select
    Range("AA1").Select
    
    'format npwp
    Range("AA:AA").Select
    Selection.NumberFormat = "0"
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:Z").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_refpartner.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data
    Sheets("menucsv").Select
    Range("AA:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")
    
    
End Sub









Attribute VB_Name = "Module4"
Sub csvrefA1()
'
' Buat 1721_refpegawaiA1.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("AA1:BO1").Select
    Selection.EntireColumn.Delete
    
    'make header
    Range("AA1").Select
    ActiveCell = "NPWP"
    Range("AB1").Select
    ActiveCell = "NIK"
    Range("AC1").Select
    ActiveCell = "Nama"
    Range("AD1").Select
    ActiveCell = "Alamat"
    Range("AE1").Select
    ActiveCell = "Jenis Kelamin"
    Range("AF1").Select
    ActiveCell = "Status PTKP"
    Range("AG1").Select
    ActiveCell = "Jumlah Tanggungan"
    Range("AH1").Select
    ActiveCell = "Nama Jabatan"
    Range("AI1").Select
    ActiveCell = "WP Luar Negeri"
    Range("AJ1").Select
    ActiveCell = "Kode Negara"
    
    'isi kolom kosong
    Sheets("dt peg").Select
    Range("R8").Select
    ActiveCell.FormulaR1C1 = "=IF(LEN(RC[-14])=14,""0""&RC[-14],IF(LEN(RC[-14])=1,""000000000000000"",RC[-14]))"
    Range("S8").Select
    ActiveCell.FormulaR1C1 = "=RC[-16]"
    Range("T8").Select
    ActiveCell.FormulaR1C1 = "=RC[-18]"
    Range("U8").Select
    ActiveCell.FormulaR1C1 = "=RC[-7]"
    Range("V8").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-13]=""L"",""M"",""F"")"
    Range("W8").Select
    ActiveCell.FormulaR1C1 = "=UPPER(LEFT(RC[-13],FIND(""/"",RC[-13],1)-1))"
    Range("X8").Select
    ActiveCell.FormulaR1C1 = "=RIGHT(RC[-14],1)"
    Range("Y8").Select
    ActiveCell.FormulaR1C1 = "=RC[-12]"
    Range("Z8").Select
    ActiveCell.FormulaR1C1 = "=IF(RC[-15]=""WNA"",""Y"",IF(RC[-15]=""WNI"",""N"",""""))"
    Range("AA8").Select
    ActiveCell.FormulaR1C1 = "=IFERROR(VLOOKUP(RC[-15],'..'!R21C2:R215C3,2,0),"""")"
    
    'count data row
    Range("R6") = "=COUNTA(A8:A1000000)"
    Dim count
    count = Range("R6")
    
    'copy data
    'klo gak ada data?
    
    Range("R8:AA8").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Selection.Copy
    
    Sheets("menucsv").Select
    Range("AA2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    'format npwp
    Columns("AA:AB").Select
    Selection.NumberFormat = "0"
    
    'clear data
    Sheets("dt peg").Select
    Range("R8:AA8").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'back to csv
    Sheets("menucsv").Select
    Range("AA1").Select
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:Z").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_refpegawaiA1.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data
    Sheets("menucsv").Select
    Range("AA:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")

    
    
End Sub











Attribute VB_Name = "Module5"
Sub csvBPTidakFinal()
'
' Buat 1721_bp_tidak_final.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("AA1:BO1").Select
    Selection.EntireColumn.Delete
    
    'make header
    'Range("AA1").Select
    'ActiveCell = "Masa Pajak"
    'Range("AB1").Select
    'ActiveCell = "Tahun Pajak"
    'Range("AC1").Select
    'ActiveCell = "Pembetulan"
    'Range("AD1").Select
    'ActiveCell = "Nomor Bukti Potong"
    'Range("AE1").Select
    'ActiveCell = "NPWP"
    'Range("AF1").Select
    'ActiveCell = "NIK"
    'Range("AG1").Select
    'ActiveCell = "Nama"
    'Range("AH1").Select
    'ActiveCell = "Alamat"
    'Range("AI1").Select
    'ActiveCell = "WP Luar Negeri"
    'Range("AJ1").Select
    'ActiveCell = "Kode Negara"
    'Range("AK1").Select
    'ActiveCell = "Kode Pajak"
    'Range("AL1").Select
    'ActiveCell = "Jumlah Bruto"
    'Range("AM1").Select
    'ActiveCell = "Jumlah DPP"
    'Range("AN1").Select
    'ActiveCell = "Tanpa NPWP"
    'Range("AO1").Select
    'ActiveCell = "Tarif"
    'Range("AP1").Select
    'ActiveCell = "Jumlah PPh"
    'Range("AQ1").Select
    'ActiveCell = "NPWP Pemotong"
    'Range("AR1").Select
    'ActiveCell = "Nama Pemotong"
    'Range("AS1").Select
    'ActiveCell = "Tanggal Bukti Potong"
    
    'filter
    Dim masa
    masa = Range("C5")
    Dim pembetulan
    pembetulan = Range("D5")

    Sheets("#NonPT").Select
    Dim count As Integer
    count = Range("EL1")
    Dim counttdkfnl As Integer
    counttdkfnl = Range("EE1")
    
    Range("EB1:FN2").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.Copy
    Range("JA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("JA2:JS2").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.AutoFilter
    ActiveSheet.Range(Selection, Selection).AutoFilter Field:=1, Criteria1:=masa
    ActiveSheet.Range(Selection, Selection).AutoFilter Field:=3, Criteria1:=1
    
    'count data row
    'Range("JA1") = "=COUNTA(JA2:JA1000000)-1"
    'Dim count
    'count = Range("JA1")
    
    'copy data
    Range("JU1:KM1").Select
    If counttdkfnl > 0 Then
    Range(Selection, Selection.Offset(3, 0)).Select
    Range(Selection, Selection.End(xlDown)).Select
    End If
    Selection.Copy
    
    'klo tidak ada data?
    
    'paste data
    Sheets("menucsv").Select
    Range("AA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Range("AA2:BO2").Select
    Selection.Delete Shift:=xlUp
    
    'isi pembetulan
    If counttdkfnl > 0 Then
    Range("AC2").Select
    ActiveCell = pembetulan
    If count > 1 Then
    ActiveCell.Copy
    Range(Selection, Selection.Offset(counttdkfnl - 1, 0)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    End If
    End If
    
    'format number npwp
    Columns("AE:AE").Select
    Selection.NumberFormat = "0"
    Columns("AQ:AQ").Select
    Selection.NumberFormat = "0"
    
    'clear data
    Sheets("#NonPT").Select
    Range("JA2:KL2").Select
    Selection.AutoFilter
    Selection.EntireColumn.Delete
    Range("E3").Select
    
    'back to csv
    Sheets("menucsv").Select
    Range("A1").Select
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:Z").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    If counttdkfnl > 0 Then
    Selection.End(xlDown).Select
    End If
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_bp_tidak_final.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data
    Sheets("menucsv").Select
    Range("AA:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")

    
    
End Sub













Attribute VB_Name = "Module6"
Sub csvBPFinal()
'
' Buat 1721_bp_final.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("AA1:BO1").Select
    Selection.EntireColumn.Delete
    
    'make header
    'Range("AA1").Select
    'ActiveCell = "Masa Pajak"
    'Range("AB1").Select
    'ActiveCell = "Tahun Pajak"
    'Range("AC1").Select
    'ActiveCell = "Pembetulan"
    'Range("AD1").Select
    'ActiveCell = "Nomor Bukti Potong"
    'Range("AE1").Select
    'ActiveCell = "NPWP"
    'Range("AF1").Select
    'ActiveCell = "NIK"
    'Range("AG1").Select
    'ActiveCell = "Nama"
    'Range("AH1").Select
    'ActiveCell = "Alamat"
    'Range("AI1").Select
    'ActiveCell = "Kode Pajak"
    'Range("AJ1").Select
    'ActiveCell = "Jumlah Bruto"
    'Range("AK1").Select
    'ActiveCell = "Tarif"
    'Range("AL1").Select
    'ActiveCell = "Jumlah PPh"
    'Range("AM1").Select
    'ActiveCell = "NPWP Pemotong"
    'Range("AN1").Select
    'ActiveCell = "Nama Pemotong"
    'Range("AO1").Select
    'ActiveCell = "Tanggal Bukti Potong"
    
    'filter
    Dim masa
    masa = Range("C6")
    Dim pembetulan
    pembetulan = Range("D6")
        
    Sheets("#NonPT").Select
    Dim count As Integer
    count = Range("EL1")
    Dim counttdkfnl As Integer
    countfnl = Range("EF1")
    
    Range("EB1:FN2").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.Copy
    Range("JA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("JA2:JS2").Select
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.AutoFilter
    ActiveSheet.Range(Selection, Selection).AutoFilter Field:=1, Criteria1:=masa
    ActiveSheet.Range(Selection, Selection).AutoFilter Field:=3, Criteria1:=0
    
    'copy data1
    Range("JU1:KM1").Select
    If countfnl > 0 Then
    Range(Selection, Selection.End(xlDown)).Select
    End If
    Selection.Copy
    
    'paste data1
    Sheets("menucsv").Select
    Range("AA1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Range("AA2:BO2").Select
    Selection.Delete Shift:=xlUp
    
    
    
    
    'isi pembetulan
    If countfnl > 0 Then
    Range("AC2").Select
    ActiveCell = pembetulan
    If count > 1 Then
    ActiveCell.Copy
    Range(Selection, Selection.Offset(countfnl - 1, 0)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    End If
    End If
    
    'format number npwp
    Columns("AE:AE").Select
    Selection.NumberFormat = "0"
    Columns("AQ:AQ").Select
    Selection.NumberFormat = "0"
    
    'remove unused columns
    Columns("AI:AJ").Select
    Selection.EntireColumn.Delete
    Columns("AK:AL").Select
    Selection.EntireColumn.Delete
        
    'clear data
    Sheets("#NonPT").Select
    Range("JA2:KL2").Select
    Selection.AutoFilter
    Selection.EntireColumn.Delete
    Range("E3").Select
    
    'back to csv
    Sheets("menucsv").Select
    Range("AA1").Select
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:Z").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    If countfnl > 0 Then
    Selection.End(xlDown).Select
    End If
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_bp_final.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data
    Sheets("menucsv").Select
    Range("AA:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")
    

    
    
End Sub









Attribute VB_Name = "Module7"
Sub csvIbulanan()
'
' Buat 1721_I_bulanan.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("AA1:BO1").Select
    Selection.EntireColumn.Delete
    
    'make header
    'Range("AA1").Select
    'ActiveCell = "Masa Pajak"
    'Range("AB1").Select
    'ActiveCell = "Tahun Pajak"
    'Range("AC1").Select
    'ActiveCell = "Pembetulan"
    'Range("AD1").Select
    'ActiveCell = "NPWP"
    'Range("AE1").Select
    'ActiveCell = "Nama"
    'Range("AF1").Select
    'ActiveCell = "Kode Pajak"
    'Range("AG1").Select
    'ActiveCell = "Jumlah Bruto"
    'Range("AH1").Select
    'ActiveCell = "Jumlah PPh"
    'Range("AI1").Select
    'ActiveCell = "Kode Negara"
    
    'filter
    Dim masa As String
    masa = Range("C7")
    Dim pembetulan
    pembetulan = Range("D7")
    
    'count data row
    Sheets(masa).Select
    Dim count As Integer
    count = Range("BK1")
    Dim countptkp As Integer
    countptkp = Range("BL1")
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    'ActiveSheet.Outline.ShowLevels RowLevels:=0, ColumnLevels:=2
    Range("BK3:BX3").Select
    'klo gak ada data?
    Range(Selection, Selection.Offset(countptkp, 0)).Select
    Selection.Copy
    Range("CA3").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Selection.AutoFilter
    ActiveSheet.Range(Selection, Selection).AutoFilter Field:=1, Criteria1:=1
    
    'copy data1
    'Range("BP3:BQ3").Select
    'Range(Selection, Selection.End(xlDown)).Select
    'Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    
    'paste data1
    Sheets("menucsv").Select
    Range("V1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'copy data2
    'Sheets(masa).Select
    'Range("BR3:BS3").Select
    'Range(Selection, Selection.End(xlDown)).Select
    'Range(Selection, Selection.End(xlDown)).Select
    'Selection.Copy
    
    'paste data2
    'Sheets("menucsv").Select
    'Range("AG2").Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    'Application.CutCopyMode = False
    
    'hapus baris kedua
    'Range("AA2:BO2").Select
    'Selection.Delete Shift:=xlUp
    
    'isi kolom kosong
    'Range("AA2").Select
    'ActiveCell = masa
    'Range("AB2").Select
    'ActiveCell = "=thpj"
    Range("AC2").Select
    ActiveCell = pembetulan
    'Range("AF2").Select
    'ActiveCell = "21-100-01"
    
    'Range("AA2").Select
    'ActiveCell.Copy
    'Range("AD2").Select
    'Selection.End(xlDown).Select
    'ActiveCell.Offset(0, -3).Activate
    'Range(Selection, Selection.End(xlUp)).Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
    'Range("AB2").Select
    'ActiveCell.Copy
    'Range("AD2").Select
    'Selection.End(xlDown).Select
    'ActiveCell.Offset(0, -2).Activate
    'Range(Selection, Selection.End(xlUp)).Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    
    
    Range("AC2").Select
    ActiveCell.Copy
    Range(Selection, Selection.Offset(count, 0)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    'Range("AF2").Select
    'ActiveCell.Copy
    'Range("AG2").Select
    'Selection.End(xlDown).Select
    'ActiveCell.Offset(0, -1).Activate
    'Range(Selection, Selection.End(xlUp)).Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    'format number and npwp
    Columns("AD:AD").Select
    Selection.NumberFormat = "0"
    Columns("AG:AH").Select
    Selection.NumberFormat = "0"
    
    'clear data sheet masa
    Sheets(masa).Select
    Range("CA3:CN3").Select
    Selection.AutoFilter
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'back to csv
    Sheets("menucsv").Select
    Range("AA1").Select
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:Z").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    If count > 0 Then
    Selection.End(xlDown).Select
    End If
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select

    
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_I_bulanan.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data menu csv
    Sheets("menucsv").Select
    Range("V:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")

    
    
End Sub


Attribute VB_Name = "Module8"
Sub csvBPA1()
'
' Buat 1721_bp_A1.csv
    
    'disable iterative
    Application.Iteration = False
    
    'clear form
    Sheets("menucsv").Select
    Range("Y1:BS1").Select
    Selection.EntireColumn.Delete
    
    'variabel
    Dim masa
    masa = Range("C8")
    Dim pembetulan
    pembetulan = Range("D8")
    
    Range("G8").Select
    ActiveCell.FormulaR1C1 = "=TEXT('1721-A1 '!R[70]C[67],""00"")"
    Range("H8").Select
    ActiveCell.FormulaR1C1 = "=TEXT('1721-A1 '!R[70]C[73],""00"")"
    Range("I8").Select
    ActiveCell.FormulaR1C1 = "='1721-A1 '!R[70]C[80]"
    
    Dim tgl As String
    tgl = Range("G8")
    Dim bln As String
    bln = Range("H8")
    Dim thn As String
    thn = Range("I8")
    
    Range("G8:I8").Select
    Selection.ClearContents
    Range("A1").Select
    
    'copy data
    'klo gak ada data?
    Sheets("#A-1").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("BJ1:DC1").Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    Range("II1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    'Selection.AutoFilter
    'ActiveSheet.Range(Selection, Selection).AutoFilter Field:=1, Criteria1:=1
    'Range("IM1:KB1").Select
    'Range(Selection, Selection.End(xlDown)).Select
    Selection.Copy
    
    'paste data1
    Sheets("menucsv").Select
    Range("Z1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'count data row
    Range("Y1") = "=COUNTA(Z1:Z10)-1"
    Dim count
    count = Range("Y1")
    
    'isi kolom kosong
    'Range("AA2").Select
    'ActiveCell = masa
    'If count > 1 Then
    'ActiveCell.Copy
    'Range("Z2").Select
    'Selection.End(xlDown).Select
    'ActiveCell.Offset(0, 1).Activate
    'Range(Selection, Selection.End(xlUp)).Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    'End If
    
    'Range("AC2").Select
    'ActiveCell = pembetulan
    'If count > 1 Then
    'ActiveCell.Copy
    'Range("Z2").Select
    'Selection.End(xlDown).Select
    'ActiveCell.Offset(0, 3).Activate
    'Range(Selection, Selection.End(xlUp)).Select
    'Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    'End If
    
    Range("BS2").Select
    ActiveCell = "'" & tgl & "-" & bln & "-" & thn
    If count > 1 Then
    ActiveCell.Copy
    Range("BS2").Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(0, -1).Activate
    Selection.End(xlUp).Select
    ActiveCell.Offset(0, 1).Activate
    Range(Selection, Selection.End(xlUp)).Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    End If
    
    'format number and npwp
    Columns("AK:AK").Select
    Selection.NumberFormat = "0"
    Columns("AV:BQ").Select
    Selection.NumberFormat = "0"
    
    'clear data
    Sheets("#A-1").Select
    Range("II1:KB1").Select
    'Selection.AutoFilter
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'Stop
    
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'back to csv
    Sheets("menucsv").Select
    Range("AE1").Select
    
    'make csv
    Sheets("menucsv").Copy
    
    'delete menu
    Range("A:AD").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    Selection.End(xlDown).Select
    ActiveCell.Offset(1, 0).Activate
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    Range("A1").Select
    
    'save csv
    Dim relativePath As String
    relativePath = ThisWorkbook.Path & "\1721_bp_A1.csv"
    'relativePath = ThisWorkbook.Path & "\" & ActiveWorkbook.Name
    ActiveWorkbook.SaveAs Filename:=relativePath, FileFormat:=xlCSV, _
        CreateBackup:=False, _
    Local:=True
    Application.DisplayAlerts = True
    ActiveWindow.Close
    
    'clear data
    Sheets("menucsv").Select
    Range("V:BZ").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("File csv telah selesai. Klik OK.")

    
    
End Sub













Attribute VB_Name = "Module9"
Sub updatePT()
'
' updatePT Macro
'

'
    'disable iterative
    Application.Iteration = False
    
    'tentukan jumlah data PT
    Sheets("dt peg").Select
    Range("A5").Select
    ActiveCell.FormulaR1C1 = "=COUNT(R[3]C:R[1000000]C)"
    
    Dim x As Integer
    Dim count As Integer
    count = Range("A5")
    
    Range("A5").Select
    ActiveCell.ClearContents
    Range("A1").Select
    
    'update sheet 1
    'backup data
    Sheets("1").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True

    'update sheet 2
    'backup data
    Sheets("2").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 3
    'backup data
    Sheets("3").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 4
    'backup data
    Sheets("4").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 5
    'backup data
    Sheets("5").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 6
    'backup data
    Sheets("6").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 7
    'backup data
    Sheets("7").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 8
    'backup data
    Sheets("8").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 9
    'backup data
    Sheets("9").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 10
    'backup data
    Sheets("10").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 11
    'backup data
    Sheets("11").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet 12
    'backup data
    Sheets("12").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet #A-1
    Sheets("#A-1").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    'backup data
    Range("N2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("II2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("U2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("IJ2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False

    'del row
    Range("A3:DD3").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A2:DD2").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("II2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("N2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("IJ2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("U2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet sum
    Sheets("sum").Select
    Range("A17").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.EntireRow.Delete
    
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A16:BP16").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'update sheet 12 lagi
    'backup data
    Sheets("12").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    Range("J4:O4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("T4:U4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
        Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("CG4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("AA4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("CI4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del row
    Range("A5:BY5").Select
    Range(Selection, Selection.End(xlDown)).Select
    Range(Selection, Selection.End(xlDown)).Select
    Selection.Delete Shift:=xlUp
    
    'copy row
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Range("A4:BY4").Select
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("CA4:CF4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("J4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CG4:CH4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("T4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("CI4").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("AA4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    'del backup
    Range("CA4:CI4").Select
    Selection.EntireColumn.Delete
    Range("A1").Select
    
    'fix column AR
    Range("AR4:AR10000").Select
    Selection.Replace What:="=", Replacement:="XYZ", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("AR4:AR10000").Select
    Selection.Replace What:="XYZ", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
        
    'update sheet #A-1 lagi
    Sheets("#A-1").Select
    
    'unprotect sheet
    ActiveSheet.Unprotect "ap2114"
    
    'backup data
    Range("N2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("II2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Range("U2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Replace What:="=", Replacement:="XXX", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Selection.Copy
    Range("IJ2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    
    Range("A2:DD2").Select
    
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'restore data
    Range("II2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("N2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("IJ2").Select
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    Selection.Copy
    Range("U2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    Selection.Replace What:="XXX", Replacement:="=", LookAt:=xlPart, _
        SearchOrder:=xlByRows, MatchCase:=False, SearchFormat:=False, _
        ReplaceFormat:=False
    Range("A1").Select
    
    'protect sheet
    ActiveSheet.Protect "ap2114", DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
    
    'update sheet sum lagi
    Sheets("sum").Select
    Range("A16:BP16").Select
    
    If count = 1 Then Range("A1").Select
    If count > 1 Then
    Selection.Copy
    Range(Selection, Selection.Offset(count - 1, 0)).Select
    ActiveSheet.Paste
    Application.CutCopyMode = False
    Range("A1").Select
    End If
    
    'back to dt peg
    Sheets("dt peg").Select
    Range("A1").Select
    
    'enable iterative
    Application.Iteration = True
    
    'save file
    ActiveWorkbook.Save
    
    MsgBox ("Proses Update telah selesai. Klik OK.")
    
    
    
End Sub


















Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 2, 1, MSForms, SpinButton"
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 23, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 24, 1, MSForms, SpinButton"
Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 2, 1, MSForms, SpinButton"
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 12, 1, MSForms, SpinButton"
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet51"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SpinButton1, 1, 0, MSForms, SpinButton"
Attribute VB_Control = "SpinButton2, 2, 1, MSForms, SpinButton"
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
