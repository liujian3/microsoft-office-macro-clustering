Attribute VB_Name = "Mod_CreateCAR"
Option Explicit
Sub CreateCAR()
    Dim lngLrow             As Long
    Dim lngFrow             As Long
    Dim wbkTemp             As Workbook
    Dim wksSIL              As Worksheet
    Dim wksSummary          As Worksheet
    Dim QN                  As String
    Dim strQN               As String
    Dim strQN1              As String
    
    On Error Resume Next
    
    On Error GoTo 0
    
    Call UnprotectAll
    
    With Application
        .ScreenUpdating = False
        .DisplayAlerts = False
    End With
    
    ThisWorkbook.Unprotect "eaton222"
    Sheets("CAR").Visible = True
    Sheets("Input").Visible = True
    Sheets("System Issues List").Unprotect "eaton222"
    
    Set wbkTemp = ThisWorkbook
    Set wksSIL = wbkTemp.Sheets("System Issues List")
    Set wksSummary = wbkTemp.Sheets("SSA Summary")
    
    
    With wksSIL
        lngLrow = .Cells(.Rows.count, 2).End(xlUp).Row
        If WorksheetFunction.CountA(.Range("J4", "J" & lngLrow)) = 0 Then
            MsgBox ("You have not selected 'Yes' in column 'CA Form Requested' for any system issue, Please select it and rerun.")
            .Activate
            Call ProtectAll
            Exit Sub
        End If
        For lngFrow = 4 To lngLrow
            QN = .Range("B" & lngFrow).Value
            If .Range("J" & lngFrow).Value = "Yes" Then
                Sheets("CAR").Copy after:=Sheets(Sheets.count)
                Sheets("CAR (2)").Name = "CAR" & " " & QN
                Sheets("CAR" & " " & QN).Visible = xlSheetVisible
                Sheets("CAR" & " " & QN).Activate
                Range("G4").Value = wksSummary.Range("E3").Value
                Range("X6").Value = wksSummary.Range("E8").Value
                Range("B9").Value = .Range("C" & lngFrow).Value
                Range("P7").Value = QN
                Range("P7").Interior.Color = 65535
                
                strQN = Range("P7").Value
                strQN1 = "'" & "System Issues List" & "'" & "!A" & lngFrow
                
                Range("P7").Select
                Range("P7").Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                strQN1, TextToDisplay:=strQN
            
                Range("X5").Value = wksSummary.Range("E6").Value
                Range("X4").Value = "CAR" & " " & QN
                
                Dim rFound As Range
                Dim str As String
                Dim strEvidence As String
                Dim strLinkage  As String
        
                On Error Resume Next
            
            With Sheets("Input")
                    .Range("B4").Select
                    Set rFound = .Range("B4:BT31").Find(What:=QN, after:=ActiveCell, LookIn:=xlValues, LookAt:= _
                        xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:=False _
                        , SearchFormat:=False)
            On Error GoTo 0
            If Not rFound Is Nothing Then Application.GoTo rFound, True
                    strEvidence = ActiveCell.Offset(0, 6).Value
                    strLinkage = ActiveCell.Offset(0, 7).Value
                End With
                
                Sheets("CAR" & " " & QN).Activate
                Range("B13").Value = strLinkage
                Range("B17").Value = strEvidence
                Range("G7").Value = Date + 12
            ElseIf .Range("J" & lngFrow).Value = "Yes " Then
            
            Else
                .Range("D" & lngFrow).Value = "NA"
                .Range("B" & lngFrow, "J" & lngFrow).Interior.Color = RGB(128, 128, 128)
            End If
        Next
        .Activate
        .Rows("3:3").Select
        Selection.AutoFilter
        .Range("J3").Select
        ActiveWorkbook.Worksheets("System Issues List").AutoFilter.Sort.SortFields. _
            Clear
        ActiveWorkbook.Worksheets("System Issues List").AutoFilter.Sort.SortFields.Add _
            Key:=Range("J3"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption _
            :=xlSortNormal
        With ActiveWorkbook.Worksheets("System Issues List").AutoFilter.Sort
            .Header = xlYes
            .MatchCase = False
            .Orientation = xlTopToBottom
            .SortMethod = xlPinYin
            .Apply
        End With
        .AutoFilterMode = False
        End With
    
    Sheets("CAR").Visible = False
    Sheets("Input").Visible = False
    
    Call Hyperlink1
    wksSIL.Activate
    wksSIL.Range("B4").Activate
    Call ProtectAll
    
    Set wbkTemp = Nothing
    Set wksSIL = Nothing
    Set wksSummary = Nothing
    
    With Application
        .ScreenUpdating = False
        .DisplayAlerts = True
    End With
End Sub
Sub Hyperlink()
    Dim wbkSSA As Workbook
    Dim wksSSA As Worksheet
    Dim wksSSA1 As Worksheet
    Dim lngLrow, lngFrow As Long
    Dim strQN, strQN1 As String
    
    Set wbkSSA = ActiveWorkbook
    Set wksSSA = ActiveWorkbook.Sheets("SSA Summary")
    Set wksSSA1 = ActiveWorkbook.Sheets("System Issues List")
    
    With wksSSA
        .Activate
        lngLrow = .Cells(.Rows.count, 2).End(xlUp).Row
        For lngFrow = 54 To lngLrow
            strQN = .Range("B" & lngFrow).Value
            strQN1 = "'" & "CAR" & " " & strQN & "'"
            
            Range("B" & lngFrow).Select
            .Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                strQN1 & "!A1", TextToDisplay:=strQN
            'cell refernce change because of "Finding" column added in CAR form By Bhushan on 22Aug 2016.
            'Coorective action B21-B25
            'Target completion date X21-X25
            'Supplier Completion Date of CA X27-X31
            'Eaton Disposition Date of Deployment X31 - X35
                            
            .Range("H" & lngFrow).Value = "=IF(" & strQN1 & "!B21 = """",""""," & strQN1 & "!B21)"
            .Range("M" & lngFrow).Value = "=IF(" & strQN1 & "!G7 = """",""""," & strQN1 & "!G7)"
            .Range("M" & lngFrow).NumberFormat = "mm/dd/yyyy"
            .Range("N" & lngFrow).Value = "=IF(" & strQN1 & "!X7 = """",""""," & strQN1 & "!X7)"
            .Range("O" & lngFrow).Value = "=IF(" & strQN1 & "!X25 = """",""""," & strQN1 & "!X25)"
            .Range("O" & lngFrow).NumberFormat = "mm/dd/yyyy"
            .Range("P" & lngFrow).Value = "=IF(" & strQN1 & "!X31 = """",""""," & strQN1 & "!X31)"
            .Range("P" & lngFrow).NumberFormat = "mm/dd/yyyy"
            .Range("Q" & lngFrow).Value = "=IF(" & strQN1 & "!X35 = """",""""," & strQN1 & "!X35)"
            .Range("Q" & lngFrow).NumberFormat = "mm/dd/yyyy"
'            .Range("G" & lngFrow).Value = "=" & strQN1 & "!B21"
'            .Range("K" & lngFrow).Value = "=" & strQN1 & "!G7"
'            .Range("L" & lngFrow).Value = "=" & strQN1 & "!X7"
'            .Range("M" & lngFrow).Value = "=" & strQN1 & "!X21"
'            .Range("N" & lngFrow).Value = "=" & strQN1 & "!X27"
'            .Range("O" & lngFrow).Value = "=" & strQN1 & "!X31"
        Next lngFrow
    End With
        
    With wksSSA1
        .Activate
        lngLrow = .Cells(.Rows.count, 2).End(xlUp).Row
        For lngFrow = 4 To lngLrow
            If .Range("B" & lngFrow).Value <> vbNullString And .Range("J" & lngFrow).Value = "Yes " Then
                strQN = .Range("B" & lngFrow).Value
                strQN1 = "'" & "CAR" & " " & strQN & "'"
                .Range("B" & lngFrow).Select
                .Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                    strQN1 & "!A1", TextToDisplay:=strQN
            'cell refernce change because of "Finding" column added in CAR form By Bhushan on 22Aug 2016.
            'Coorective action B21-B25
            'Target completion date X21-X25
            'Supplier Completion Date of CA X27-X31
            'Eaton Disposition Date of Deployment X31 - X35
                            
                .Range("D" & lngFrow).Value = "=IF(" & strQN1 & "!B25 = """",""""," & strQN1 & "!B25)"
                .Range("E" & lngFrow).Value = "=IF(" & strQN1 & "!X7 = """",""""," & strQN1 & "!X7)"
                .Range("F" & lngFrow).Value = "=IF(" & strQN1 & "!G7 = """",""""," & strQN1 & "!G7)"
                .Range("F" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("G" & lngFrow).Value = "=IF(" & strQN1 & "!X25 = """",""""," & strQN1 & "!X25)"
                .Range("G" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("H" & lngFrow).Value = "=IF(" & strQN1 & "!X31 = """",""""," & strQN1 & "!X31)"
                .Range("H" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("I" & lngFrow).Value = "=IF(" & strQN1 & "!X35 = """",""""," & strQN1 & "!X35)"
                .Range("I" & lngFrow).NumberFormat = "mm/dd/yyyy"
'                .Range("D" & lngFrow).Value = "=" & strQN1 & "!B21"
'                .Range("E" & lngFrow).Value = "=" & strQN1 & "!X7"
'                .Range("F" & lngFrow).Value = "=" & strQN1 & "!G7"
'                .Range("G" & lngFrow).Value = "=" & strQN1 & "!X21"
'                .Range("H" & lngFrow).Value = "=" & strQN1 & "!X27"
'                .Range("I" & lngFrow).Value = "=" & strQN1 & "!X31"
            End If
        Next lngFrow
    End With
End Sub
Sub Hyperlink1()
    Dim wbkSSA As Workbook
    Dim wksSSA As Worksheet
    Dim lngLrow, lngFrow As Long
    Dim strQN, strQN1 As String
    Dim strQN2  As String
    Dim strQN3  As String
    
    Set wbkSSA = ActiveWorkbook
    Set wksSSA = ActiveWorkbook.Sheets("System Issues List")
    
    With wksSSA
        .Activate
        lngLrow = .Cells(.Rows.count, 10).End(xlUp).Row
        For lngFrow = 4 To lngLrow
            'If .Range("B" & lngFrow).Value <> vbNullString And .Range("J" & lngFrow).Value = "Yes" Then
            If .Range("B" & lngFrow).Value <> vbNullString Then
                .Activate
                strQN = .Range("B" & lngFrow).Value
                strQN1 = "'" & "CAR" & " " & strQN & "'"
                .Range("B" & lngFrow).Select
                .Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                    strQN1 & "!A1", TextToDisplay:=strQN
                    
            'cell refernce change because of "Finding" column added in CAR form By Bhushan on 30sept 2016.
            'Coorective action B21-B25
            'Target completion date X21-X25
            'Supplier Completion Date of CA X27-X31
            'Eaton Disposition Date of Deployment X31 - X35
                .Range("D" & lngFrow).Value = "=IF(" & strQN1 & "!B21 = """",""""," & strQN1 & "!B21)"
                .Range("E" & lngFrow).Value = "=IF(" & strQN1 & "!X7 = """",""""," & strQN1 & "!X7)"
                .Range("F" & lngFrow).Value = "=IF(" & strQN1 & "!G7 = """",""""," & strQN1 & "!G7)"
                .Range("F" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("G" & lngFrow).Value = "=IF(" & strQN1 & "!X25 = """",""""," & strQN1 & "!X25)"
                .Range("G" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("H" & lngFrow).Value = "=IF(" & strQN1 & "!X31 = """",""""," & strQN1 & "!X31)"
                .Range("H" & lngFrow).NumberFormat = "mm/dd/yyyy"
                .Range("I" & lngFrow).Value = "=IF(" & strQN1 & "!X35 = """",""""," & strQN1 & "!X35)"
                .Range("I" & lngFrow).NumberFormat = "mm/dd/yyyy"
'                .Range("D" & lngFrow).Value = "=" & strQN1 & "!B21"
'                .Range("E" & lngFrow).Value = "=" & strQN1 & "!X7"
'                .Range("F" & lngFrow).Value = "=" & strQN1 & "!G7"
'                .Range("G" & lngFrow).Value = "=" & strQN1 & "!X21"
'                .Range("H" & lngFrow).Value = "=" & strQN1 & "!X27"
'                .Range("I" & lngFrow).Value = "=" & strQN1 & "!X31"
                    
                strQN2 = "'" & "System Issues List" & "'" & "!A" & lngFrow
                strQN3 = Replace(strQN1, "'", "")
                Sheets(strQN3).Activate
                Range("P7").Select
                Range("P7").Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                strQN2, TextToDisplay:=strQN
            End If
        Next lngFrow
    End With
End Sub
Sub UnprotectAll()
    Dim wbk             As Workbook
    Dim wSheet          As Worksheet
    Set wbk = ThisWorkbook
    For Each wSheet In wbk.Worksheets
        wSheet.Unprotect "eaton222"
    Next wSheet
    Set wbk = Nothing
End Sub
Sub ProtectAll()
    Dim wbk             As Workbook
    Dim wSheet          As Worksheet
    Set wbk = ThisWorkbook
    For Each wSheet In wbk.Worksheets
        wSheet.Protect "eaton222"
    Next wSheet
    Set wbk = Nothing
End Sub
Sub DeleteModule()
       Dim vbCom As Object

    'MsgBox "Hi, I will delete myself "
    Set vbCom = Application.VBE.ActiveVBProject.VBComponents

    vbCom.Remove VBComponent:= _
    vbCom.Item("Mod_TransferModule")
    vbCom.Item ("Mod_SSA_Main")
    End Sub








Attribute VB_Name = "Mod_SSA_Main"
Dim Wb, WbTemp As Workbook, WsInput, WsScores, WsSummary As Worksheet
Sub ReadAssessment()

Dim MyFile, AFolder, SFolder, AFile, SFile, SFileName As String
Dim i, a As Integer, Category As String

    Application.ScreenUpdating = False
    Application.DisplayAlerts = False

    Set Wb = ThisWorkbook
    Set WsInput = Wb.Sheets("Input")
    Set WsScores = Wb.Sheets("Scores")
    
    
    MyFile = ThisWorkbook.Path
    AFolder = MyFile & "\ssa_audits"
    AFile = Dir(AFolder & "\*.xlsm")
    If AFile = vbNullString Then AFile = Dir(AFolder & "\*.xlsb")

' Open supplier assessments from specific folder

    If AFile = vbNullString Then
        MsgBox "No Assessment Available to Generate Summary. " & vbNewLine & vbNewLine & _
            "Kindly make sure to save all assessments in 'ssa_audits' Folder."
        Exit Sub
    End If
    Do While AFile <> vbNullString
    Unprotect_Workbook
    Sheets("message").Visible = True
    'Application.ScreenUpdating = True
    Sheets("message").Activate
    'Application.ScreenUpdating = False
    Sheets("Supplier Summary").Copy before:=Sheets("Input")
    Sheets("Supplier Summary (2)").Name = "SSA Summary"
    Sheets("Mitigations").Copy after:=Sheets("Input")
    Sheets("Mitigations (2)").Name = "System Issues List"
    Set WsSummary = Wb.Sheets("SSA Summary")
    Set WsMitiPlan = Wb.Sheets("System Issues List")
    WsMitiPlan.Activate
    WsSummary.Activate
    WsSummary.Visible = xlSheetVisible
    Range("N1").Value = Range("N1").Value
    WsMitiPlan.Visible = xlSheetVisible
    
    ClearInputs

    Workbooks.Open Filename:=AFolder & "\" & AFile
    
    ' Unhide all worksheets in Supplier Assessment Form
    Dim sh, SSA As Worksheet, ESC As Worksheet
    
    For Each sh In Workbooks(AFile).Sheets
        Workbooks(AFile).Unprotect "eaton222"
        sh.Visible = xlSheetVisible
        Workbooks(AFile).Protect "eaton222"
    Next
    
    Set ESC = Workbooks(AFile).Sheets("Eaton SSA Categories")
    Set SSA = Workbooks(AFile).Sheets("0.0 Supplier Site Profile")
    
    If SSA.Range("$D$4").Value = "Distributor" Then
        ThisWorkbook.Sheets("Input").Activate
        ActiveSheet.Range("F16,O16,X4:X6,X17:X19,AG5,AG7:AG25,AG27:AG29,AP9,AP13").Select
        Selection.FormulaR1C1 = "No"
        ActiveSheet.Range("D16,M16,V4:V6,V17:V19,AE5,AE7:AE25,AE27:AE29,AN9,AN13").Select
        Selection.FormulaR1C1 = 0
       
    End If
    ' for newly added opotion Aerospace questionaire dt - 24 Apr '17 - Hemant
    
    If SSA.Range("$B$4").Value = "Non-Aerospace Supplier" Then
        ThisWorkbook.Sheets("Input").Activate
        'ActiveSheet.Range("E16,N14:N23,W4:W14,W21:W35,AF17:AF22,AF25:AF27,AF29,AO4,AO6,AO8,AO10,AO12:AO22,DR7:DR8,DR11:DR14").Select
        ActiveSheet.Range("AG25,AG31,AY13:AY15").Select
        Selection.FormulaR1C1 = "No"
        
         ActiveSheet.Range("AE25,AE31,AW13:AW15").Select
        Selection.FormulaR1C1 = 0
        
 End If
 
Step1:
    If SSA.Range("$F4").Value = "Not Design Responsible" Then
        ThisWorkbook.Sheets("Input").Activate
        ActiveSheet.Range("AG7,AG8").Select
        Selection.FormulaR1C1 = "No"
        'ActiveSheet.Range("E16,N14:N23,W4:W14,W21:W35,AF17:AF22,AF25:AF27,AF29,AO4,AO6,AO8,AO10,AO12:AO22,DR7:DR8,DR11:DR14").Select
        ActiveSheet.Range("AE7:AE8").Select
        Selection.FormulaR1C1 = 0
    End If
    
    If SSA.Range("$F$31").Value = "Yes" Or SSA.Range("$F$32").Value = "Yes" Or SSA.Range("$F$33").Value = "Yes" Then
    'GoTo Step1:
        ThisWorkbook.Sheets("Input").Activate
        ActiveSheet.Range("D12,M5,M13:M15,AN8,AW12").Select
        Selection.FormulaR1C1 = 0
          
    End If
    
    'If SSA.Range("$E$59").Value <> "Yes" Or SSA.Range("$E$60").Value <> "Yes" Or SSA.Range("$E$61").Value <> "Yes" Or SSA.Range("$E$62").Value <> "Yes" Or SSA.Range("$E$59").Value <> "Yes" Or SSA.Range("$E$60").Value <> "Yes" Or SSA.Range("$E$61").Value <> "Yes" Or SSA.Range("$E$62").Value <> "Yes" Or SSA.Range("$E$59").Value <> "Yes" Or SSA.Range("$E$60").Value <> "Yes" Or SSA.Range("$E$61").Value <> "Yes" Or SSA.Range("$E$62").Value <> "Yes" Or SSA.Range("$I$59").Value <> "Yes" Or SSA.Range("$I$60").Value <> "Yes" Or SSA.Range("$I$61").Value <> "Yes" Or SSA.Range("$I$62").Value <> "Yes" Or SSA.Range("$E$59").Value <> "Yes" Or SSA.Range("$E$60").Value <> "Yes" Or SSA.Range("$E$61").Value <> "Yes" Or SSA.Range("$E$62").Value <> "Yes" Or SSA.Range("$M$59").Value <> "Yes" Or SSA.Range("$M$60").Value <> "Yes" Or SSA.Range("$M$61").Value <> "Yes" Or SSA.Range("$M$62").Value <> "Yes" Then
    'If SSA.Range("$Q$59").Value <> "Yes" Or SSA.Range("$Q$60").Value <> "Yes" Or SSA.Range("$Q$61").Value <> "Yes" Or SSA.Range("$Q$62").Value <> "Yes" Then
    'ThisWorkbook.Sheets("Input").Activate
     '   ActiveSheet.Range("M9").Select
      '  Selection.FormulaR1C1 = 0
          
    'End If
     '    End If
         
         If SSA.Range("$F$35").Value = "Yes" Then
    ThisWorkbook.Sheets("Input").Activate
        ActiveSheet.Range("BF4:BF5").Select
        Selection.FormulaR1C1 = 0
          
    End If
    
     If SSA.Range("$F$36").Value = "Yes" Then
    ThisWorkbook.Sheets("Input").Activate
        ActiveSheet.Range("BF6:BF7").Select
        Selection.FormulaR1C1 = 0
          
    End If
    
    Wb.Activate
    
    WsSummary.Range("E3") = ESC.Range("H3").Value
    WsSummary.Range("J4") = ESC.Range("H4").Value
    WsSummary.Range("E5") = ESC.Range("H6").Value
    WsSummary.Range("E6") = ESC.Range("H8").Value
    WsSummary.Range("E7") = ESC.Range("H10").Value
    WsSummary.Range("E8") = ESC.Range("H11").Value
    WsSummary.Range("L8") = SSA.Range("D16").Value
    
    WsSummary.Range("E11") = SSA.Range("E18").Value
    WsSummary.Range("E12") = SSA.Range("E19").Value
    WsSummary.Range("E13") = SSA.Range("E20").Value
    WsSummary.Range("E14") = SSA.Range("E21").Value
    
    WsSummary.Range("M11") = SSA.Range("M18").Value
    WsSummary.Range("M12") = SSA.Range("M19").Value
    WsSummary.Range("M13") = SSA.Range("M20").Value
    WsSummary.Range("M14") = SSA.Range("M21").Value
    
    WsSummary.Range("E16") = SSA.Range("E23").Value
    WsSummary.Range("E17") = SSA.Range("E24").Value
    WsSummary.Range("E18") = SSA.Range("E25").Value
    WsSummary.Range("E19") = SSA.Range("E26").Value
    
    WsSummary.Range("M16") = SSA.Range("M23").Value
    WsSummary.Range("M17") = SSA.Range("M24").Value
    WsSummary.Range("M18") = SSA.Range("M25").Value
    WsSummary.Range("M19") = SSA.Range("M26").Value
    
     WsSummary.Range("D32") = SSA.Range("E6").Value
     WsSummary.Range("D33") = SSA.Range("D7").Value
     WsSummary.Range("E34") = SSA.Range("F8").Value
     WsSummary.Range("E35") = SSA.Range("E9").Value
     WsSummary.Range("E36") = SSA.Range("F10").Value
     WsSummary.Range("E37") = SSA.Range("F11").Value
     
     WsSummary.Range("J22") = SSA.Range("B4").Value
     WsSummary.Range("L22") = SSA.Range("D4").Value
     WsSummary.Range("N22") = SSA.Range("F4").Value
     WsSummary.Range("P22") = SSA.Range("H4").Value
     WsSummary.Range("J32") = SSA.Range("D12").Value
     WsSummary.Range("J33") = SSA.Range("D13").Value
     
     WsSummary.Range("K34") = SSA.Range("O8").Value
     WsSummary.Range("K35") = SSA.Range("P5").Value
     WsSummary.Range("K36") = SSA.Range("P6").Value
     WsSummary.Range("K37") = SSA.Range("O7").Value
     
     WsSummary.Range("P32") = SSA.Range("N4").Value
     WsSummary.Range("P33") = SSA.Range("M9").Value
     WsSummary.Range("P34") = SSA.Range("N10").Value
     WsSummary.Range("Q34") = SSA.Range("P10").Value
     WsSummary.Range("P35") = SSA.Range("N11").Value
     WsSummary.Range("Q35") = SSA.Range("P11").Value
     WsSummary.Range("P36") = SSA.Range("N12").Value
     WsSummary.Range("P37") = SSA.Range("N13").Value
     
     If SSA.Range("F31").Value = "Yes" Then
     WsSummary.Range("B39").Interior.Color = 65280 'Green
     WsSummary.Range("B39") = "a"
     End If
     
     If SSA.Range("F32").Value = "Yes" Then
     WsSummary.Range("B40").Interior.Color = 65280 'Green
     WsSummary.Range("B40") = "a"
     End If
     
     If SSA.Range("F33").Value = "Yes" Then
     WsSummary.Range("B41").Interior.Color = 65280 'Green
     WsSummary.Range("B41") = "a"
     End If
     
     If SSA.Range("F34").Value = "Yes" Then
     WsSummary.Range("B42").Interior.Color = 65280 'Green
     WsSummary.Range("B42") = "a"
     End If
     
     If SSA.Range("F35").Value = "Yes" Then
     WsSummary.Range("B43").Interior.Color = 65280 'Green
     WsSummary.Range("B43") = "a"
     End If
     
     If SSA.Range("F36").Value = "Yes" Then
     WsSummary.Range("B44").Interior.Color = 65280 'Green
     WsSummary.Range("B44") = "a"
     End If
     
     If SSA.Range("F37").Value = "Yes" Then
     WsSummary.Range("F39").Interior.Color = 65280 'Green
     WsSummary.Range("F39") = "a"
     End If
     
     If SSA.Range("F38").Value = "Yes" Then
     WsSummary.Range("F40").Interior.Color = 65280 'Green
     WsSummary.Range("F40") = "a"
     End If
     
     If SSA.Range("F39").Value = "Yes" Then
     WsSummary.Range("F41").Interior.Color = 65280 'Green
     WsSummary.Range("F41") = "a"
     End If
     
     If SSA.Range("F40").Value = "Yes" Then
     WsSummary.Range("F42").Interior.Color = 65280 'Green
     WsSummary.Range("F42") = "a"
     End If
     
     If SSA.Range("F41").Value = "Yes" Then
     WsSummary.Range("F43").Interior.Color = 65280 'Green
     WsSummary.Range("F43") = "a"
     End If
     
     If SSA.Range("F42").Value = "Yes" Then
     WsSummary.Range("F44").Interior.Color = 65280 'Green
     WsSummary.Range("F44") = "a"
     End If
     
     If SSA.Range("F43").Value = "Yes" Then
     WsSummary.Range("J39").Interior.Color = 65280 'Green
     WsSummary.Range("J39") = "a"
     End If
     
     If SSA.Range("F44").Value = "Yes" Then
     WsSummary.Range("J40").Interior.Color = 65280 'Green
     WsSummary.Range("J40") = "a"
     End If
     
     If SSA.Range("J45").Value = "Yes" Then
     WsSummary.Range("J41").Interior.Color = 65280 'Green
     WsSummary.Range("J41") = "a"
     End If
     
     If SSA.Range("F46").Value = "Yes" Then
     WsSummary.Range("J42").Interior.Color = 65280 'Green
     WsSummary.Range("J42") = "a"
     End If
     
     If SSA.Range("F53").Value = "Yes" Then
     WsSummary.Range("J43").Interior.Color = 65280 'Green
     WsSummary.Range("J43") = "a"
     End If
     
     If SSA.Range("F54").Value = "Yes" Then
     WsSummary.Range("J44").Interior.Color = 65280 'Green
     WsSummary.Range("J44") = "a"
     End If
     
     If SSA.Range("F55").Value = "Yes" Then
     WsSummary.Range("N39").Interior.Color = 65280 'Green
     WsSummary.Range("N39") = "a"
     End If
     
     If SSA.Range("K53").Value = "Yes" Then
     WsSummary.Range("N40").Interior.Color = 65280 'Green
     WsSummary.Range("N40") = "a"
     End If
     
     If SSA.Range("K54").Value = "Yes" Then
     WsSummary.Range("N41").Interior.Color = 65280 'Green
     WsSummary.Range("N41") = "a"
     End If
     

     If SSA.Range("K55").Value = "Yes" Then
     WsSummary.Range("N42").Interior.Color = 65280 'Green
     WsSummary.Range("N42") = "a"
     End If
     
     If SSA.Range("E47").Value = "Yes" Then
     WsSummary.Range("N43").Interior.Color = 65280 'Green
     WsSummary.Range("N43") = "a"
     End If
     
     If SSA.Range("E48").Value = "Yes" Then
     WsSummary.Range("N44").Interior.Color = 65280 'Green
     WsSummary.Range("N44") = "a"
     End If
     
     If SSA.Range("E59").Value = "Yes" Then
     WsSummary.Range("B46").Interior.Color = 65280 'Green
     WsSummary.Range("B46") = "a"
     End If
     
     If SSA.Range("E60").Value = "Yes" Then
     WsSummary.Range("B47").Interior.Color = 65280 'Green
     WsSummary.Range("B47") = "a"
     End If
     
     If SSA.Range("E61").Value = "Yes" Then
     WsSummary.Range("B48").Interior.Color = 65280 'Green
     WsSummary.Range("B48") = "a"
     End If
     
     If SSA.Range("E62").Value = "Yes" Then
     WsSummary.Range("B49").Interior.Color = 65280 'Green
     WsSummary.Range("B49") = "a"
     End If
     
     If SSA.Range("I59").Value = "Yes" Then
     WsSummary.Range("B50").Interior.Color = 65280 'Green
     WsSummary.Range("B50") = "a"
     End If
     
     If SSA.Range("I60").Value = "Yes" Then
     WsSummary.Range("B51").Interior.Color = 65280 'Green
     WsSummary.Range("B51") = "a"
     End If
     
     If SSA.Range("I61").Value = "Yes" Then
     WsSummary.Range("F46").Interior.Color = 65280 'Green
     WsSummary.Range("F46") = "a"
     End If
     
     If SSA.Range("I62").Value = "Yes" Then
     WsSummary.Range("F47").Interior.Color = 65280 'Green
     WsSummary.Range("F47") = "a"
     End If
     
     If SSA.Range("M59").Value = "Yes" Then
     WsSummary.Range("F48").Interior.Color = 65280 'Green
     WsSummary.Range("F48") = "a"
     End If
     
     If SSA.Range("M60").Value = "Yes" Then
     WsSummary.Range("F49").Interior.Color = 65280 'Green
     WsSummary.Range("F49") = "a"
     End If
     
     If SSA.Range("M61").Value = "Yes" Then
     WsSummary.Range("F50").Interior.Color = 65280 'Green
     WsSummary.Range("F50") = "a"
     End If
     
     If SSA.Range("M62").Value = "Yes" Then
     WsSummary.Range("J46").Interior.Color = 65280 'Green
     WsSummary.Range("J46") = "a"
     End If
     
     If SSA.Range("Q59").Value = "Yes" Then
     WsSummary.Range("J47").Interior.Color = 65280 'Green
     WsSummary.Range("J47") = "a"
     End If
     
     If SSA.Range("Q60").Value = "Yes" Then
     WsSummary.Range("J48").Interior.Color = 65280 'Green
     WsSummary.Range("J48") = "a"
     End If
     
     If SSA.Range("Q61").Value = "Yes" Then
     WsSummary.Range("J49").Interior.Color = 65280 'Green
     WsSummary.Range("J49") = "a"
     End If
     
     If SSA.Range("Q62").Value = "Yes" Then
     WsSummary.Range("J50").Interior.Color = 65280 'Green
     WsSummary.Range("J50") = "a"
     End If
     
     If SSA.Range("G66").Value = "Yes" Then
     WsSummary.Range("N46").Interior.Color = 65280 'Green
     WsSummary.Range("N46") = "a"
     End If
     
     If SSA.Range("G67").Value = "Yes" Then
     WsSummary.Range("N47").Interior.Color = 65280 'Green
     WsSummary.Range("N47") = "a"
     End If
     
     If SSA.Range("K66").Value = "Yes" Then
     WsSummary.Range("N48").Interior.Color = 65280 'Green
     WsSummary.Range("N48") = "a"
     End If
     
     If SSA.Range("K67").Value = "Yes" Then
     WsSummary.Range("N49").Interior.Color = 65280 'Green
     WsSummary.Range("N49") = "a"
     End If
     
     If SSA.Range("N66").Value = "Yes" Then
     WsSummary.Range("N50").Interior.Color = 65280 'Green
     WsSummary.Range("N50") = "a"
     End If
     
     If SSA.Range("N67").Value = "Yes" Then
     WsSummary.Range("N51").Interior.Color = 65280 'Green
     WsSummary.Range("N51") = "a"
     End If
     
     
    Wb.Activate
    a = 6
    
' Pull Assessment Inputs to Scoring Sheet (14 Categories)
    For i = 4 To 11
         Category = Wb.Sheets("Scores").Range("B" & i).Value
         Workbooks(AFile).Sheets(Category).Range("C4:C31").Copy
         WsInput.Cells(4, a).PasteSpecial (xlPasteValues)
         a = a + 9
    Next i

    'If Workbooks(AFile).Sheets("Eaton SSA Categories").Range("I26").Value = "NA" Then
     '  WsInput.Range("AG7:AG8").Value = "No"
    'Else
     '   If Workbooks(AFile).Sheets("Eaton SSA Categories").Range("I26").Value = "Completed" Then
      '      Workbooks(AFile).Sheets("11.0 Product Engineering").Range("E4:E55").Copy
       '     WsInput.Range("CR4:CR16").PasteSpecial (xlPasteValues)
        'End If
    'End If

    'a = 105

    'For i = 15 To 17
     '   Category = Wb.Sheets("Scores").Range("B" & i).Value
      '  Workbooks(AFile).Sheets(Category).Range("E4:E55").Copy
       ' WsInput.Cells(4, a).PasteSpecial (xlPasteValues)
        'a = a + 9
    'Next i

    Dim b, c, d, e, r, maxrow, minrow As Long, RightAnswer, AnsY, Result, Cat, CatQ As String
    Dim Wt, TWt, TWt3, TWt5, TScore, TScore3, TScore5 As Long  '(Wt = Weightage, TScore = Total Score, TWt = Total Weightage)
    Dim WtColor As Variant
    
    b = 17
    c = 2
    d = 8
    e = 9
    t = 7
    i = 1

    While c < 71

    TWt = 0
    TWt1 = 0
    TWt3 = 0
    TWt5 = 0
    TScore = 0
    TScore1 = 0
    TScore3 = 0
    TScore5 = 0
    Cat = WsInput.Cells(3, c).Value

    For r = 4 To 31
        RightAnswer = WsInput.Cells(r, t - 2).Value ' expected right answer set by Eaton
        AnsY = WsInput.Cells(r, t - 1).Value ' input provided by supplier Yes or No
        Result = WsInput.Cells(r, t).Value
        Wt = WsInput.Cells(r, t - 3).Value
        WtColor = WsInput.Cells(r, t - 3).Interior.Color
        CatQ = Workbooks(AFile).Sheets(Cat).Cells(r, 4).Value

'Amendment done on 01st FEB 2017 -------"Amended by: Pravin Vadpalli for excluding ISO requirement against ISO/TS Certified Supplier."

'If CatQ = "ISO 9001" And ThisWorkbook.Sheets("Input").Range("O4").Value = "Yes" Then ThisWorkbook.Sheets("Input").Range("O5").Value = "Yes"
'If AnsY = "No" Then
'AnsY = "Yes"
'End If

' Issue:Modification in Aerospace Questionnaire and publisher - No linkage between new aero question added in questionnaire and publisher
' case: L14 is No & Supplier Mark it as Yes -- This is generating car, now supplier answer "Yes" is repalced by "No"
' UPdated by Hemant & Bhushan 29 Jun 2017

'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("O49").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("N49") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("AG31").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("Af31") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("AP29").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("AO29") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("BZ29").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("BY29") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("BZ30").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("BY30") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("BZ31").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("BY31") = "Yes"
'End If
'End If
'If SSA.Range("L14").Value = "No" And ThisWorkbook.Sheets("Input").Range("BZ32").Value = "Yes" Then
'If AnsY = "Yes" Then
'Range("BY32") = "Yes"
'End If
'End If

'AnsY = WsInput.Cells(r, t - 1).Value
 
' ammendment completed 29 Jun 2017
      
    'Validate Inputs and populate results
        If RightAnswer <> vbNullString Then
            If RightAnswer = "Yes" Then Result = "PASS"
            If RightAnswer = "Yes" And AnsY = "Yes" Then Result = "PASS"
            If RightAnswer = "Yes" And AnsY <> "Yes" Then Result = "FAIL"
            If RightAnswer = "Yes" And AnsY = "NA" Then Result = "NA"
            '        If RightAnswer = "Yes" And AnsY = "True" And AnsN = "False" Then
            '            Result = "PASS"
            '        Else
            '            Result = "FAIL"
            '    End If
            If RightAnswer = "No" And AnsY = "No" Then Result = "PASS"
            If RightAnswer = "No" And AnsY <> "No" Then Result = "FAIL"
            If RightAnswer = "No" And AnsY = "NA" Then Result = "NA"
            '        ElseIf RightAnswer = "No" And AnsY = "False" And AnsN = "True" Then
            '            Result = "PASS"
            '        Else
            '            Result = "FAIL"
            '    End If
        End If
        
        WsInput.Cells(r, t).Value = Result
        TWt = TWt + Wt
        If TScore = "NA" Then TScore = 0
        If Result = "PASS" Then TScore = TScore + Wt
        If Result = "NA" Then TScore = "NA"
        
        If SSA.Range("$D$4").Value = "Manufacturer" Then
            If Wt = 5 Then TWt5 = TWt5 + Wt
            If Wt < 5 And Wt > 2 Then TWt3 = TWt3 + Wt
            If Wt < 3 Then TWt1 = TWt1 + Wt
        Else
            If Wt = 5 And WtColor = 16777215 Then TWt5 = TWt5 + Wt
            If Wt < 5 And WtColor = 16777215 And Wt > 2 Then TWt3 = TWt3 + Wt
            If Wt < 3 And WtColor = 16777215 Then TWt1 = TWt1 + Wt
        End If
        
        If Wt = 5 And Result = "PASS" Then TScore5 = TScore5 + Wt
        If Wt = 3 And Result = "PASS" Then TScore3 = TScore3 + Wt
        If Wt = 1 And Result = "PASS" Then TScore1 = TScore1 + Wt
        
' Get Mitigation Plan (Pull Questions from SSA for 5 Rated Non Favorable Answers
        maxrow = WsSummary.Range("C65536").End(xlUp).Row + 1
        minrow = WsMitiPlan.Range("C65536").End(xlUp).Row + 1
        
        If Wt = 5 And Result = "FAIL" Then
            If CatQ = "ISO 9001" And ThisWorkbook.Sheets("Input").Range("O4").Value = "Yes" Then
            Else
                WsSummary.Range("B" & maxrow).Value = WsInput.Cells(r, c).Value
                WsSummary.Range("C" & maxrow).Value = CatQ
                WsSummary.Visible = xlSheetVisible
                WsSummary.Activate
                WsSummary.Range("C" & maxrow).Activate
                ActiveCell.Offset(0, -1).Activate
                ActiveCell.Interior.Color = 255 'Red
                ActiveCell.Offset(0, 1).Activate
                WsSummary.Range(maxrow + 1 & ":" & maxrow + 1).Copy
                WsSummary.Range(maxrow + 1 & ":" & maxrow + 1).Insert 'copiedcells
    '            AutoFitMergedCellRowHeight
                Sheets("CAR").Copy after:=Sheets(Sheets.count)
                QN = WsInput.Cells(r, c).Value
                Sheets("CAR (2)").Name = "CAR" & " " & QN
                Sheets("CAR" & " " & QN).Visible = xlSheetVisible
                Sheets("CAR" & " " & QN).Activate
                Range("G4").Value = WsSummary.Range("E3").Value
                Range("X5").Value = WsSummary.Range("E6").Value
                Range("X6").Value = WsSummary.Range("E7").Value
                Range("B9").Value = CatQ
                Range("P7").Value = WsInput.Cells(r, c).Value
                Range("P7").Interior.Color = 255
                
                strQN = Range("P7").Value
                strQN1 = "'" & "SSA Summary" & "'" & "!A" & maxrow
                Range("P7").Select
                Range("P7").Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                    strQN1, TextToDisplay:=strQN
                'Range("X5").Value = WsSummary.Range("J6").Value
                Range("X4").Value = "CAR" & " " & QN
                Range("B13").Value = WsInput.Cells(r, e).Value
                Range("B17").Value = WsInput.Cells(r, d).Value
                Range("G7").Value = Date + 14
                Range("X3").Value = Range("X3").Value
                i = i + 1
                WsSummary.Activate
            End If
        End If
        
' Get Mitigation Plan (Pull Questions from SSA for 1-3 Rated Non Favorable Answers
        If Wt = 3 And Result = "FAIL" Then
            If WsInput.Cells(r, c).Value = "C12Q12" Or WsInput.Cells(r, c).Value = "C12Q13" Or _
            WsInput.Cells(r, c).Value = "C12Q14" Or WsInput.Cells(r, c).Value = "C12Q15" Or _
            WsInput.Cells(r, c).Value = "C12Q16" Then
                WsMitiPlan.Range("B" & minrow).Value = WsInput.Cells(r, c).Value
                WsMitiPlan.Range("C" & minrow).Value = CatQ
                WsMitiPlan.Visible = xlSheetVisible
                WsMitiPlan.Activate
                WsMitiPlan.Range("C" & minrow).Activate
                ActiveCell.Offset(0, -1).Activate
                ActiveCell.Interior.Color = 65535 'Yellow
                ActiveCell.Offset(0, 8).Validation.Delete
                ActiveCell.Offset(0, 8).Value = "Yes "
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Copy
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Insert 'copiedcells
    '            AutoFitMergedCellRowHeight
                Sheets("CAR").Copy after:=Sheets(Sheets.count)
                QN = WsInput.Cells(r, c).Value
                Sheets("CAR (2)").Name = "CAR" & " " & QN
                Sheets("CAR" & " " & QN).Visible = xlSheetVisible
                Sheets("CAR" & " " & QN).Activate
                Range("G4").Value = WsSummary.Range("E3").Value
                Range("X5").Value = WsSummary.Range("E6").Value
                Range("X6").Value = WsSummary.Range("E7").Value
                Range("B9").Value = CatQ
                Range("P7").Value = WsInput.Cells(r, c).Value
                Range("P7").Interior.Color = 65535
                strQN = Range("P7").Value
                strQN1 = "'" & "System Issues List" & "'" & "!B" & minrow
                Range("P7").Select
                Range("P7").Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                    strQN1, TextToDisplay:=strQN
                'Range("X5").Value = WsSummary.Range("I6").Value
                Range("X4").Value = "CAR" & " " & QN
                Range("B13").Value = WsInput.Cells(r, e).Value
                Range("B17").Value = WsInput.Cells(r, d).Value
                Range("G7").Value = Date + 14
                i = i + 1
                WsMitiPlan.Activate
                
            Else
                WsMitiPlan.Range("B" & minrow).Value = WsInput.Cells(r, c).Value
                WsMitiPlan.Range("C" & minrow).Value = CatQ
                WsMitiPlan.Visible = xlSheetVisible
                WsMitiPlan.Activate
                WsMitiPlan.Range("C" & minrow).Activate
                ActiveCell.Offset(0, -1).Activate
                ActiveCell.Interior.Color = 65535 'Yellow
                ActiveCell.Offset(0, 1).Activate
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Copy
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Insert 'copiedcells
                Application.CutCopyMode = False
                AutoFitMergedCellRowHeight
            End If
        End If
        
        
        If Wt = 1 And Result = "FAIL" Then
            If WsInput.Cells(r, c).Value = "C12Q12" Or WsInput.Cells(r, c).Value = "C12Q13" Or _
            WsInput.Cells(r, c).Value = "C12Q14" Or WsInput.Cells(r, c).Value = "C12Q15" Or _
            WsInput.Cells(r, c).Value = "C12Q16" Then
                WsMitiPlan.Range("B" & minrow).Value = WsInput.Cells(r, c).Value
                WsMitiPlan.Range("C" & minrow).Value = CatQ
                WsMitiPlan.Visible = xlSheetVisible
                WsMitiPlan.Activate
                WsMitiPlan.Range("C" & minrow).Activate
                ActiveCell.Offset(0, -1).Activate
                ActiveCell.Interior.Color = 65535 'Yellow
                ActiveCell.Offset(0, 8).Validation.Delete
                ActiveCell.Offset(0, 8).Value = "Yes "
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Copy
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Insert 'copiedcells
    '            AutoFitMergedCellRowHeight
                Sheets("CAR").Copy after:=Sheets(Sheets.count)
                QN = WsInput.Cells(r, c).Value
                Sheets("CAR (2)").Name = "CAR" & " " & QN
                Sheets("CAR" & " " & QN).Visible = xlSheetVisible
                Sheets("CAR" & " " & QN).Activate
                Range("G4").Value = WsSummary.Range("E3").Value
                Range("X5").Value = WsSummary.Range("E6").Value
                Range("X6").Value = WsSummary.Range("E7").Value
                Range("B9").Value = CatQ
                Range("P7").Value = WsInput.Cells(r, c).Value
                Range("P7").Interior.Color = 65535
                strQN = Range("P7").Value
                strQN1 = "'" & "System Issues List" & "'" & "!B" & minrow
                Range("P7").Select
                Range("P7").Hyperlinks.Add Anchor:=Selection, Address:="", SubAddress:= _
                    strQN1, TextToDisplay:=strQN
                'Range("X5").Value = WsSummary.Range("I6").Value
                Range("X4").Value = "CAR" & " " & QN
                Range("B13").Value = WsInput.Cells(r, e).Value
                Range("B17").Value = WsInput.Cells(r, d).Value
                Range("G7").Value = Date + 14
                i = i + 1
                WsMitiPlan.Activate
                
            Else
                WsMitiPlan.Range("B" & minrow).Value = WsInput.Cells(r, c).Value
                WsMitiPlan.Range("C" & minrow).Value = CatQ
                WsMitiPlan.Visible = xlSheetVisible
                WsMitiPlan.Activate
                WsMitiPlan.Range("C" & minrow).Activate
                ActiveCell.Offset(0, -1).Activate
                ActiveCell.Interior.Color = 65535 'Yellow
                ActiveCell.Offset(0, 1).Activate
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Copy
                WsMitiPlan.Range(minrow + 1 & ":" & minrow + 1).Insert 'copiedcells
                Application.CutCopyMode = False
                AutoFitMergedCellRowHeight
            End If
        End If
    Next r
    
    Cells(1, 1).Select
' Get Weightages and Scores from Input to Scores
    'If TScore = "NA" Then
    '    WsScores.Cells(b, 3).Value = TScore
    '    WsScores.Cells(b, 4).Value = TScore
    '    WsScores.Cells(b, 5).Value = TScore
        
    '    WsScores.Cells(b, 6).Value = TScore
    '    WsScores.Cells(b, 7).Value = TScore
    '    WsScores.Cells(b, 8).Value = TScore
        
    '    WsScores.Cells(b, 9).Value = TScore
    '    WsScores.Cells(b, 10).Value = TScore
    '    WsScores.Cells(b, 11).Value = TScore
   ' Else
   '     If TScore >= 0 Then
   '         If TWt <> 0 Then
   '             WsScores.Cells(b, 3).Value = TWt
   '             WsScores.Cells(b, 4).Value = TScore
   '             WsScores.Cells(b, 5).Value = TScore / TWt
   '         End If
   '         If TWt5 <> 0 Then
   '             WsScores.Cells(b, 6).Value = TWt5
   '             WsScores.Cells(b, 7).Value = TScore5
   '             WsScores.Cells(b, 8).Value = TScore5 / TWt5
   '         End If
   '         If TWt3 <> 0 Then
   '             WsScores.Cells(b, 9).Value = TWt3
   '             WsScores.Cells(b, 10).Value = TScore3
   '             WsScores.Cells(b, 11).Value = TScore3 / TWt3
   '         End If
   '     End If
   ' End If

' Conditional Formatting (Scores Sheet) based on  Score %
    'If TScore / TWt < 0.7 Then WsScores.Cells(b, 5).Interior.Color = 255 'Red
    'If TScore / TWt >= 0.7 And TScore / TWt <= 0.9 Then WsScores.Cells(b, 5).Interior.Color = 65535 'Yellow
   ' If TScore = "NA" Then
   '     WsScores.Cells(b, 5).Interior.Color = 6908265 'Grey
   ' Else
   '     If TScore >= 0 Then
   '         If TScore / TWt < 0.9 Then WsScores.Cells(b, 5).Interior.Color = 65535 'Yellow
   '         If TScore / TWt >= 0.9 Then WsScores.Cells(b, 5).Interior.Color = 65280 'Green
   '     End If
   ' End If
 
' Conditional Formatting (5 Rated Questions - Summary Sheet)
    If TScore5 = TWt5 Then
        'WsScores.Cells(b, 8).Interior.Color = 65280 'Green
        WsSummary.Cells(b + 6, 2).Value = "G"
        WsSummary.Cells(b + 6, 2).Interior.Color = 65280 'Green
    ElseIf TScore5 <> TWt5 Then
        'WsScores.Cells(b, 8).Interior.Color = 255 'Red
        WsSummary.Cells(b + 6, 2).Value = "R"
        WsSummary.Cells(b + 6, 2).Interior.Color = 255 'Red
    End If

' Conditional Formatting (NA Questions - Summary Sheet)
    If TScore = "NA" Then
        'WsScores.Cells(b, 12).Interior.Color = 6908265 'Gray
        WsSummary.Cells(b + 6, 2).Value = "NA"
        WsSummary.Cells(b + 6, 2).Interior.Color = 6908265 'Gray
    End If
' Conditional Formatting (1 Or 3 Rated Questions - Summary Sheet)

'Comment by Pravin Vadpalli dated 26th Apr 2019 on discussion with Chetan More & Rohit Khandave (TScore3/TWt3>=0.8 to RScore3=TWt3)
    If TScore3 = TWt3 Then '>= 0.8 Then
        'WsScores.Cells(b, 11).Interior.Color = 65280 'Green
        WsSummary.Cells(b + 6, 3).Value = "G"
        WsSummary.Cells(b + 6, 3).Interior.Color = 65280 'Green
    ElseIf TScore3 <> TWt3 Then '< 0.8 Then ' < 0.9 changed to <0.8 by Hemant & BHushan on 16 Feb 18' *-(TScore3/TWt3>=0.8 to RScore3=TWt3) Commented by Pravin Vadpalli & Chetan More & Rohit Khandave dated 26th Apr 2019
        'WsScores.Cells(b, 11).Interior.Color = 65535 'Yellow
        WsSummary.Cells(b + 6, 3).Value = "Y"
        WsSummary.Cells(b + 6, 3).Interior.Color = 65535 'Yellow
    'ElseIf TScore3 / TWt3 < 0.7 Then
        'WsScores.Cells(b, 11).Interior.Color = 255 'Red
        'WsSummary.Cells(b + 6, 3).Value = "R"
        'WsSummary.Cells(b + 6, 3).Interior.Color = 255 'Red
    End If
    
    'If TScore = "NA" Then
        'WsScores.Cells(b, 12).Interior.Color = 6908265 'Gray
        'WsSummary.Cells(b + 6, 3).Value = "NA"
        'WsSummary.Cells(b + 6, 3).Interior.Color = 6908265 'Gray
    'End If

' Risk Mitigation
    'Dim j As Integer, EatonScore, SystemScore, Mitigation As String
'Application.ScreenUpdating = True
    'For j = 23 To 30
     '   EatonScore = WsSummary.Cells(j, 2).Value
      '  If EatonScore = "G" Then Mitigation = "Not Required"
       ' If EatonScore = "R" Then Mitigation = "See Mitigation Plan section"
       ' If EatonScore = "NA" Then Mitigation = "Not Applicable"
       ' WsSummary.Cells(j, 9).Value = Mitigation
       ' Mitigation = "Not Required"
    'Next j
    
    c = c + 9
    d = d + 9
    e = e + 9
    b = b + 1
    t = t + 9
'    If WsSummary.Range("B20") = "NA" And WsSummary.Range("C20") = "NA" Then
'        WsSummary.Range("D20").Interior.Color = 6908265
'        WsSummary.Range("I20").Interior.Color = 6908265
'        WsSummary.Range("M20").Interior.Color = 6908265
'    End If
Wend

' Agreements and Certifications Section - Conditional Formatting
    'Call Certifications
    
' Copy Summary and Scores sheets to new workbook and save in defined folder
    SFolder = MyFile & "\ssa_summary"
    SFileName = "\SSA Summary - " & WsSummary.Range("E3").Value & " " & WsSummary.Range("J4").Value
    SFile = SFolder & SFileName
    
    Call UnHideSheets
    'BELOW LINE SET TO COMMENT (Rather than copying sheets to new workbook, saving this file and deleting unwanted tabs
    'Dated: 05th April 2019**********************
    
    'Wb.Sheets(Array("SSA Summary", "System Issues List")).Copy
'    ActiveWorkbook.SaveAs Filename:=SFile, FileFormat:=xlOpenXMLWorkbook, CreateBackup:=False
    ActiveWorkbook.SaveAs Filename:=SFile & ".xlsb", FileFormat:=50, CreateBackup:=False
'    Call Hyperlink
    'Call TransferModule
    'Call CARformcopy1
    Call Hyperlink
'    Call CARformcopy
    'For s = 1 To Sheets.count
     '   If Sheets(s).Name = "Scores" Then Sheets(s).Visible = False
      '  If Sheets(s).Name = "Input" Then Sheets(s).Visible = False
    'Next s
    Sheets("SSA Summary").Visible = True
    Sheets("SSA Summary").Select
    Call Protect1
    'Range("F3").Select
    'ActiveWindow.SmallScroll up:=99
    'ActiveSheet.Protect , AllowFormattingCells:=True, _
    'AllowFormattingColumns:=True, AllowFormattingRows:=True, _
    'AllowInsertingColumns:=True, AllowInsertingRows:=True, AllowDeletingRows:=True
    'ActiveWindow.Close True
    
    'Call CARformdelete
    'HideSheets
    'Close Assessment
    Workbooks(AFile).Close False
    AFile = Dir()
        'WsSummary.Delete
    Protect_Workbook
    Loop
    
    Unprotect_Workbook
    'Wb.Sheets("System Issues List").Delete

Sheets("CAR").Activate
    Range("$X$3").Value = Range("$X$3").Value
    
Call DeleteSheet
   
   For s = 1 To Sheets.count
        
        If Sheets(s).Name = "CAR" Then Sheets(s).Visible = False
        If Sheets(s).Name = "Input" Then Sheets(s).Visible = False
    Next s
    
   
        Sheets("System Issues List").Move before:=Sheets(1)
    Sheets("SSA Summary").Move before:=Sheets(1)
    
Sheets("SSA Summary").Activate
    Range("$A$1").Select
   
   'Call DeleteModule
    'ClearInputs
    Protect_Workbook
    'Application.ScreenUpdating = True
    'Application.ScreenUpdating = False
    
    MsgBox "Supplier Site Assessment Summary Generated Successfully." & vbNewLine & vbNewLine & _
    "Completed Assessment Summary can be found in 'ssa_summary' folder. Now you can close this file."
    
    Set Wb = Nothing
    Set WsInput = Nothing
    Set WsScores = Nothing
    
'    HideSheets
    'Application.ScreenUpdating = True
    Application.DisplayAlerts = True
    'ActiveWindow.SmallScroll up:=99
    ActiveWorkbook.Close savechanges:=True
    
End Sub
Sub ClearInputs()
    Dim Wb As Workbook, WsI, WsScores As Worksheet, r, c, i As Long


    
    Set Wb = ActiveWorkbook
    Set WsI = Wb.Sheets("Input")
    'Marked as comment dated 12.12.2018 by [Pravin Vadpalli] working on [Brian Ranft's] - [New Questionairre request]
    'SSA Scores not required for New Questionairre
    '**********************************
    'Set WsScores = Wb.Sheets("Scores")
    '**********************************
    c = 6
    While c < 71
        For r = 4 To 31
            WsI.Cells(r, c).ClearContents
            WsI.Cells(r, c + 1).ClearContents
        Next r
        c = c + 9
    Wend

'Marked as comment dated 12.12.2018 by [Pravin Vadpalli] working on [Brian Ranft's] - [New Questionairre request]
    'SSA Scores not required for New Questionairre
    '**********************************
    'WsScores.Range("C4:K17").ClearContents
    'WsScores.Range("C4:K17").Interior.Pattern = xlNone
    '**********************************
    
    Set Wb = Nothing
    Set WsI = Nothing
    
    'Marked as comment dated 12.12.2018 by [Pravin Vadpalli] working on [Brian Ranft's] - [New Questionairre request]
    'SSA Scores not required for New Questionairre
    '**********************************
    'Set WsScores = Nothing
    '**********************************
    HideSheets
End Sub
Sub Certifications()
    ' Agreements and Certifications Section - Conditional Formatting
    Dim Wb As Workbook, WsScores, WsInput, WsSummary As Worksheet, MyQuestion, QResult As String
    

    Set Wb = ThisWorkbook
    Set WsInput = Wb.Sheets("Input")
    Set WsSummary = Wb.Sheets("SSA Summary")
    
    '----------------------------Legal, Ethics & Regulatory Agreements------------------------------------
    Dim Agr As Long
    For Agr = 4 To 9
        MyQuestion = WsInput.Range("BM" & Agr).Value
        QResult = WsInput.Range("BR" & Agr).Value
    
      
    'Non Disclosure Agreement
    
        If MyQuestion = "C12Q4" And QResult = "PASS" Then
            WsSummary.Range("B33").Interior.Color = 65280 'Green
            WsSummary.Range("B33").Value = "a"
        ElseIf MyQuestion = "C12Q4" And QResult = "FAIL" Then
            'WsSummary.Range("B31").Interior.Color = 16777215 'Red
            WsSummary.Range("B33").Value = vbNullString
        End If
    
    'Ethics Policy
        If MyQuestion = "C8Q2" And QResult = "PASS" Then
            WsSummary.Range("B34").Interior.Color = 65280 'Green
            WsSummary.Range("B34").Value = "a"
        ElseIf MyQuestion = "C8Q2" And QResult = "FAIL" Then
            WsSummary.Range("B31").Interior.Color = 16777215 'Red
            WsSummary.Range("B34").Value = vbNullString
        End If
        
    'Conflict Mineral
        If MyQuestion = "C12Q11" And QResult = "PASS" Then
            WsSummary.Range("J32").Interior.Color = 65280 'Green
            WsSummary.Range("J32").Value = "a"
        ElseIf MyQuestion = "C12Q11" And QResult = "FAIL" Then
            'WsSummary.Range("B31").Interior.Color = 16777215 'Red
            WsSummary.Range("J32").Value = vbNullString
        End If
          
    'Supplier Code of Conduct
        If MyQuestion = "C12Q1" And QResult = "PASS" Then
            WsSummary.Range("J33").Interior.Color = 65280 'Green
            WsSummary.Range("J33").Value = "a"
        ElseIf MyQuestion = "C12Q1" And QResult = "FAIL" Then
            WsSummary.Range("J33").Interior.Color = 16777215 'Red
            WsSummary.Range("J33").Value = vbNullString
        End If
        
    Next Agr

'------------------------------Quality Certifications---------------------------------------
    Dim Quality As Long
    For Quality = 4 To 52
        MyQuestion = WsInput.Range("K" & Quality).Value
        QResult = WsInput.Range("P" & Quality).Value
    
 'Amendment done on 01st FEB 2017 -------"Amended by: Pravin Vadpalli for excluding ISO requirement against ISO/TS Certified Supplier."
 'If MyQuestion = "C2Q2" And WsInput.Range("O5").Value = "No" Then
  '  QResult = "FAIL"
    
   ' End If
    
     'Supplier Excellence Manual
        If MyQuestion = "C2Q28" And QResult = "PASS" Then
            WsSummary.Range("B32").Interior.Color = 65280 'Green
            WsSummary.Range("B32").Value = "a"
       ElseIf MyQuestion = "C2Q28" And QResult = "FAIL" Then
            WsSummary.Range("B29").Interior.Color = 16777215 'Red
            WsSummary.Range("B32").Value = vbNullString
        End If
    
    'ISO/TS-16949 certified
        If MyQuestion = "C2Q1" And QResult = "PASS" Then
            WsSummary.Range("B36").Interior.Color = 65280 'Green
            WsSummary.Range("B36").Value = "a"
        ElseIf MyQuestion = "C2Q1" And QResult = "FAIL" Then
            WsSummary.Range("B34").Interior.Color = 255 'Red
            WsSummary.Range("B36").Value = vbNullString
        End If
        
    'ISO 9001 certified
        If MyQuestion = "C2Q2" And QResult = "PASS" Then
            WsSummary.Range("B37").Interior.Color = 65280 'Green
            WsSummary.Range("B37").Value = "a"
        ElseIf MyQuestion = "C2Q2" And QResult = "FAIL" Then
            WsSummary.Range("B37").Interior.Color = 255 'Red
            WsSummary.Range("B37").Value = "r"
        End If
        
    'AIAG Member
        If MyQuestion = "C2Q10" And QResult = "PASS" Then
            WsSummary.Range("J44").Interior.Color = 65280 'Green
            WsSummary.Range("J44").Value = "a"
        ElseIf MyQuestion = "C2Q10" And QResult = "FAIL" Then
            WsSummary.Range("J44").Interior.Color = 255 'Red
            WsSummary.Range("J44").Value = "r"
        End If
    
    'AS/EN-9100 certified
        If MyQuestion = "C2Q4" And QResult = "PASS" Then
            WsSummary.Range("B38").Interior.Color = 65280 'Green
            WsSummary.Range("B38").Value = "a"
        ElseIf MyQuestion = "C2Q4" And QResult = "FAIL" Then
            WsSummary.Range("B36").Interior.Color = 255 'Red
            WsSummary.Range("B38").Value = vbNullString
        End If
        
    'AS9120 certified
        If MyQuestion = "C2Q3" And QResult = "PASS" Then
            WsSummary.Range("B39").Interior.Color = 65280 'Green
            WsSummary.Range("B39").Value = "a"
        ElseIf MyQuestion = "C2Q3" And QResult = "FAIL" Then
            WsSummary.Range("B37").Interior.Color = 255 'Red
            WsSummary.Range("B39").Value = vbNullString
        End If
    
    'AC7004 certified
        If MyQuestion = "C2Q5" And QResult = "PASS" Then
            WsSummary.Range("B40").Interior.Color = 65280 'Green
            WsSummary.Range("B40").Value = "a"
        ElseIf MyQuestion = "C2Q5" And QResult = "FAIL" Then
            WsSummary.Range("B38").Interior.Color = 255 'Red
            WsSummary.Range("B40").Value = vbNullString
        End If
        
    'ISO 17025 certified
        If MyQuestion = "C2Q6" And QResult = "PASS" Then
            WsSummary.Range("B41").Interior.Color = 65280 'Green
            WsSummary.Range("B41").Value = "a"
        ElseIf MyQuestion = "C2Q6" And QResult = "FAIL" Then
            WsSummary.Range("B39").Interior.Color = 255 'Red
            WsSummary.Range("B41").Value = vbNullString
        End If
    
    'OHSAS ISO 18001 certified
    If WsInput.Range("DF" & Quality).Value = "C13Q2" And WsInput.Range("DK" & Quality).Value = "PASS" Then
            WsSummary.Range("B42").Interior.Color = 65280 'Green
            WsSummary.Range("B42").Value = "a"
        ElseIf WsInput.Range("DF" & Quality).Value = "C13Q2" And WsInput.Range("DK" & Quality).Value = "FAIL" Then
            WsSummary.Range("H41").Interior.Color = 16777215 'Red
            WsSummary.Range("B42").Value = vbNullString
        End If
    
'    'CQI-9
'        If MyQuestion = "C2Q10" And QResult = "PASS" Then
'            WsSummary.Range("B43").Interior.Color = 65280 'Green
'            WsSummary.Range("B43").Value = "a"
'        ElseIf MyQuestion = "C2Q10" And QResult = "FAIL" Then
'            'WsSummary.Range("B41").Interior.Color = 255 'Red
'            WsSummary.Range("B43").Value = vbNullString
'        End If
'
'    'CQI-11
'        If MyQuestion = "C2Q11" And QResult = "PASS" Then
'            WsSummary.Range("B44").Interior.Color = 65280 'Green
'            WsSummary.Range("B44").Value = "a"
'        ElseIf MyQuestion = "C2Q11" And QResult = "FAIL" Then
'            'WsSummary.Range("B42").Interior.Color = 255 'Red
'            WsSummary.Range("B44").Value = vbNullString
'        End If
'
'    'CQI-12
'        If MyQuestion = "C2Q12" And QResult = "PASS" Then
'            WsSummary.Range("B45").Interior.Color = 65280 'Green
'            WsSummary.Range("B45").Value = "a"
'        ElseIf MyQuestion = "C2Q12" And QResult = "FAIL" Then
'            'WsSummary.Range("B43").Interior.Color = 255 'Red
'            WsSummary.Range("B45").Value = vbNullString
'        End If
'
    'ISO 50001
        If MyQuestion = "C2Q7" And QResult = "PASS" Then
            WsSummary.Range("B44").Interior.Color = 65280 'Green
            WsSummary.Range("B44").Value = "a"
        ElseIf MyQuestion = "C2Q7" And QResult = "FAIL" Then
            WsSummary.Range("H42").Interior.Color = 255 'Red
            WsSummary.Range("B44").Value = vbNullString
        End If
        
    'NQA1
        If MyQuestion = "C2Q8" And QResult = "PASS" Then
            WsSummary.Range("J43").Interior.Color = 65280 'Green
            WsSummary.Range("J43").Value = "a"
        ElseIf MyQuestion = "C2Q8" And QResult = "FAIL" Then
            WsSummary.Range("H43").Interior.Color = 255 'Red
            WsSummary.Range("J43").Value = vbNullString
        End If
    
    'NADCAP
        If MyQuestion = "C2Q9" And QResult = "PASS" Then
            WsSummary.Range("J42").Interior.Color = 65280 'Green
            WsSummary.Range("J42").Value = "a"
        ElseIf MyQuestion = "C2Q9" And QResult = "FAIL" Then
            WsSummary.Range("H40").Interior.Color = 255 'Red
            WsSummary.Range("J42").Value = vbNullString
        End If
        
    'ISO-14001 certified
        If WsInput.Range("DF" & Quality).Value = "C13Q1" And WsInput.Range("DK" & Quality).Value = "PASS" Then
            WsSummary.Range("B43").Interior.Color = 65280 'Green
           WsSummary.Range("B43").Value = "a"
        ElseIf WsInput.Range("DF" & Quality).Value = "C13Q1" And WsInput.Range("DK" & Quality).Value = "FAIL" Then
            WsSummary.Range("H41").Interior.Color = 16777215 'Red
            WsSummary.Range("B43").Value = vbNullString
        End If
    Next Quality

'------------------------------Strategic Planning---------------------------------------
    Dim SPlanning As Long
    
    For SPlanning = 26 To 31
        MyQuestion = WsInput.Range("B" & SPlanning).Value
        QResult = WsInput.Range("G" & SPlanning).Value

    ' Certified Minority-owned business (USA only)
        If MyQuestion = "C1Q23" And QResult = "PASS" Then
            WsSummary.Range("J36").Interior.Color = 65280 'Green
            WsSummary.Range("J36").Value = "a"
        ElseIf MyQuestion = "C1Q23" And QResult = "FAIL" Then
            WsSummary.Range("J36").Interior.Color = 16777215 'Red
            WsSummary.Range("J36").Value = vbNullString
        End If
    
    ' Certified Woman-owned business (USA only)
        If MyQuestion = "C1Q24" And QResult = "PASS" Then
            WsSummary.Range("J37").Interior.Color = 65280 'Green
            WsSummary.Range("J37").Value = "a"
        ElseIf MyQuestion = "C1Q24" And QResult = "FAIL" Then
            WsSummary.Range("J37").Interior.Color = 16777215 'Red
            WsSummary.Range("J37").Value = vbNullString
        End If
    
    ' Certified HubZone business (USA only)
        If MyQuestion = "C1Q25" And QResult = "PASS" Then
            WsSummary.Range("J38").Interior.Color = 65280 'Green
            WsSummary.Range("J38").Value = "a"
        ElseIf MyQuestion = "C1Q25" And QResult = "FAIL" Then
            WsSummary.Range("J38").Interior.Color = 16777215 'Red
            WsSummary.Range("J38").Value = vbNullString
        End If
    
    ' Certified Veteran-owned business (USA only)
        If MyQuestion = "C1Q26" And QResult = "PASS" Then
            WsSummary.Range("J39").Interior.Color = 65280 'Green
            WsSummary.Range("J39").Value = "a"
        ElseIf MyQuestion = "C1Q26" And QResult = "FAIL" Then
            WsSummary.Range("J39").Interior.Color = 16777215 'Red
            WsSummary.Range("J39").Value = vbNullString
        End If
        
    ' Certified veteran disabled-owned business (USA only)
        If MyQuestion = "C1Q27" And QResult = "PASS" Then
            WsSummary.Range("J40").Interior.Color = 65280 'Green
            WsSummary.Range("J40").Value = "a"
        ElseIf MyQuestion = "C1Q27" And QResult = "FAIL" Then
            WsSummary.Range("J40").Interior.Color = 16777215 'Red
            WsSummary.Range("J40").Value = vbNullString
        End If
    
    ' Certified Small Business (USA only)
        If MyQuestion = "C1Q28" And QResult = "PASS" Then
            WsSummary.Range("J41").Interior.Color = 65280 'Green
            WsSummary.Range("J41").Value = "a"
        ElseIf MyQuestion = "C1Q28" And QResult = "FAIL" Then
            WsSummary.Range("J41").Interior.Color = 16777215 'Red
            WsSummary.Range("J41").Value = vbNullString
        End If
    
    Next SPlanning
    
    '------------------------------Special Processes---------------------------------------
    Dim SProcesses As Long
    
    For SProcesses = 13 To 22
        MyQuestion = WsInput.Range("K" & SProcesses).Value
        QResult = WsInput.Range("P" & SProcesses).Value

    'AIAG CQI-9 - Heat Treat
        If MyQuestion = "C2Q11" And QResult = "PASS" Then
            WsSummary.Range("B48").Interior.Color = 65280 'Green
            WsSummary.Range("B48").Value = "a"
        ElseIf MyQuestion = "C2Q11" And QResult = "FAIL" Then
            WsSummary.Range("B48").Interior.Color = 16777215 'Red
            WsSummary.Range("B48").Value = vbNullString
        End If
        
    'AIAG CQI-11 - Plating
        If MyQuestion = "C2Q12" And QResult = "PASS" Then
            WsSummary.Range("B49").Interior.Color = 65280 'Green
            WsSummary.Range("B49").Value = "a"
        ElseIf MyQuestion = "C2Q12" And QResult = "FAIL" Then
            WsSummary.Range("B49").Interior.Color = 16777215 'Red
            WsSummary.Range("B49").Value = vbNullString
        End If
    
    'AIAG CQI-12 - Coating
        If MyQuestion = "C2Q13" And QResult = "PASS" Then
            WsSummary.Range("B50").Interior.Color = 65280 'Green
            WsSummary.Range("B50").Value = "a"
        ElseIf MyQuestion = "C2Q13" And QResult = "FAIL" Then
            WsSummary.Range("B50").Interior.Color = 16777215 'Red
            WsSummary.Range("B50").Value = vbNullString
        End If
        
    'AIAG CQI-15 - Welding
        If MyQuestion = "C2Q14" And QResult = "PASS" Then
            WsSummary.Range("B51").Interior.Color = 65280 'Green
            WsSummary.Range("B51").Value = "a"
        ElseIf MyQuestion = "C2Q14" And QResult = "FAIL" Then
            WsSummary.Range("B51").Interior.Color = 16777215 'Red
            WsSummary.Range("B51").Value = vbNullString
        End If
        
    'AIAG CQI-23 - Molding
        If MyQuestion = "C2Q15" And QResult = "PASS" Then
            WsSummary.Range("B52").Interior.Color = 65280 'Green
            WsSummary.Range("B52").Value = "a"
        ElseIf MyQuestion = "C2Q15" And QResult = "FAIL" Then
            WsSummary.Range("B52").Interior.Color = 16777215 'Red
            WsSummary.Range("B52").Value = vbNullString
        End If
        
    'AIAG CQI-27 - Casting
        If MyQuestion = "C2Q16" And QResult = "PASS" Then
            WsSummary.Range("J48").Interior.Color = 65280 'Green
            WsSummary.Range("J48").Value = "a"
        ElseIf MyQuestion = "C2Q16" And QResult = "FAIL" Then
            WsSummary.Range("J48").Interior.Color = 16777215 'Red
            WsSummary.Range("J48").Value = vbNullString
        End If
        
    'IPC 600 - Printed Circuit Boards
        If MyQuestion = "C2Q17" And QResult = "PASS" Then
            WsSummary.Range("J49").Interior.Color = 65280 'Green
            WsSummary.Range("J49").Value = "a"
        ElseIf MyQuestion = "C2Q17" And QResult = "FAIL" Then
            WsSummary.Range("J49").Interior.Color = 16777215 'Red
            WsSummary.Range("J49").Value = vbNullString
        End If
        
    'IPC 610 - Soldering
        If MyQuestion = "C2Q18" And QResult = "PASS" Then
            WsSummary.Range("J50").Interior.Color = 65280 'Green
            WsSummary.Range("J50").Value = "a"
        ElseIf MyQuestion = "C2Q18" And QResult = "FAIL" Then
            WsSummary.Range("J50").Interior.Color = 16777215 'Red
            WsSummary.Range("J50").Value = vbNullString
        End If
        
    'IPC 620 - Crimping
        If MyQuestion = "C2Q19" And QResult = "PASS" Then
            WsSummary.Range("J51").Interior.Color = 65280 'Green
            WsSummary.Range("J51").Value = "a"
        ElseIf MyQuestion = "C2Q19" And QResult = "FAIL" Then
            WsSummary.Range("J51").Interior.Color = 16777215 'Red
            WsSummary.Range("J51").Value = vbNullString
        End If
        
    'Does supplier meet Industry Standards for 'special processes' in their facility, including certification and appropriate training?
        If MyQuestion = "C2Q20" And QResult = "PASS" Then
            WsSummary.Range("J52").Interior.Color = 65280 'Green
            WsSummary.Range("J52").Value = "a"
        ElseIf MyQuestion = "C2Q20" And QResult = "FAIL" Then
            WsSummary.Range("J52").Interior.Color = 16777215 'Red
            WsSummary.Range("J52").Value = vbNullString
        End If
    Next SProcesses
    '------------------------------Z-Score---------------------------------------
        Dim ZScore As Double
        ZScore = WsInput.Range("BQ9").Value
        If Not IsNumeric(ZScore) Then
            WsSummary.Range("K30").Value = "Z Score Not Provided"
            WsSummary.Range("J30").Interior.Color = 255 'Red
            WsSummary.Range("J30").Value = "r"
        ElseIf ZScore >= 2.9 Then
            WsSummary.Range("B30").Value = ZScore
            WsSummary.Range("K30").Value = "Z-Score indicates Supplier is financially stable"
            WsSummary.Range("J30").Interior.Color = 65280 'Green
            WsSummary.Range("J30").Value = "a"
        ElseIf ZScore >= 1.23 And ZScore < 2.9 Then
            WsSummary.Range("B30").Value = ZScore
            WsSummary.Range("K30").Value = "Z-Score indicates Supplier may be in financial distress"
            WsSummary.Range("J30").Interior.Color = RGB(255, 204, 0) 'Amber
            WsSummary.Range("J30").Value = "a"
        Else
            WsSummary.Range("B30").Value = ZScore
            WsSummary.Range("K30").Value = "Z-Score indicates Supplier is in financial distress.Please notify Supply Chain before proceeding"
            WsSummary.Range("J30").Interior.Color = 255 'Red
            WsSummary.Range("J30").Value = "r"
        End If
End Sub
Sub HideSheets()
Dim p As Integer

'Application.ScreenUpdating = False
    'Application.DisplayAlerts = True
    
    For p = 2 To ThisWorkbook.Worksheets.count
        If Sheets(p).Visible = True Then Sheets(p).Visible = xlSheetHidden
    Next
End Sub
Sub UnHideSheets()
Sheets("Supplier Summary").Visible = xlSheetVisible
Sheets("Mitigations").Visible = xlSheetVisible
Sheets("CAR").Visible = xlSheetVisible
Sheets("Input").Visible = xlSheetVisible
Sheets("message").Visible = xlSheetVisible
Sheets("Scores").Visible = xlSheetVisible
Sheets("RevHistory").Visible = xlSheetVisible

'Dim p As Integer
    'For p = 2 To ThisWorkbook.Worksheets.count
        'Sheets(p).Visible = xlSheetVisible
    'Next
End Sub
Sub AutoFitMergedCellRowHeight()
    Dim CurrentRowHeight As Single, MergedCellRgWidth As Single
    Dim CurrCell As Range
    Dim ActiveCellWidth As Single, PossNewRowHeight As Single
    
    If ActiveCell.MergeCells Then
        With ActiveCell.MergeArea
            If .Rows.count = 1 And .WrapText = True Then
                Application.ScreenUpdating = False
                CurrentRowHeight = .RowHeight
                ActiveCellWidth = ActiveCell.ColumnWidth
                For Each CurrCell In Selection
                    MergedCellRgWidth = CurrCell.ColumnWidth + MergedCellRgWidth
                Next
                .MergeCells = False
                .Cells(1).ColumnWidth = MergedCellRgWidth
                .EntireRow.AutoFit
                PossNewRowHeight = .RowHeight
                .Cells(1).ColumnWidth = ActiveCellWidth
                .MergeCells = True
                .RowHeight = IIf(CurrentRowHeight > PossNewRowHeight, _
                 CurrentRowHeight, PossNewRowHeight)
            End If
        End With
    End If
End Sub
Sub Protect_Workbook()
    Dim Wb As Workbook, shPt As Variant
    
   
    Set Wb = ThisWorkbook
    Wb.Protect "eaton222"
    For Each shPt In ThisWorkbook.Sheets
        shPt.Protect "eaton222"
    Next shPt
End Sub
Sub Unprotect_Workbook()
    Dim Wb As Workbook, shUt As Variant
    
   
    
    Set Wb = ThisWorkbook
    Wb.Unprotect "eaton222"
    For Each shUt In ThisWorkbook.Sheets
        shUt.Unprotect "eaton222"
    Next shUt
End Sub
Sub CARformcopy1()
    Dim z As Integer
    Dim p
    Dim count As Integer
    Dim wbk As Workbook
    Dim f As String
    
  
    Set wbk = ThisWorkbook
    p = ThisWorkbook.Name
    count = wbk.Sheets.count
    SFolder = MyFile & "\ssa_summary"
    SFileName = "SSA Summary - " & WsSummary.Range("E3").Value & " " & WsSummary.Range("E4").Value
    SFile = SFolder & SFileName
    
    For z = 1 To count
        On Error GoTo Error_handler:
        On Error Resume Next
        If InStr(1, Workbooks(p).Sheets(z).Name, "CAR") Or InStr(1, Workbooks(p).Sheets(z).Name, "Input") Then
            f = Workbooks(p).Sheets(z).Name
            Workbooks(p).Sheets(f).Select
            Workbooks(p).Sheets(f).Copy after:=Workbooks(SFileName & ".xlsb").Sheets("System Issues List")
        End If
    Next

Error_handler:
End Sub
Sub CARformdelete()
    Dim z As Integer
    Dim p
    Dim count As Integer
    Dim wbk As Workbook
    Dim f As String
    
   
    Set wbk = ThisWorkbook
    p = ThisWorkbook.Name
    count = wbk.Sheets.count
    
    For z = count To 1 Step -1
        On Error GoTo Error_handler:
        On Error Resume Next
        If InStr(1, Workbooks(p).Sheets(z).Name, "CAR C") Then
            f = Workbooks(p).Sheets(z).Name
            Workbooks(p).Sheets(f).Select
            Workbooks(p).Sheets(f).Delete
        End If
    Next
Error_handler:
End Sub
Sub DeleteSheet()
    Dim wksSht As Worksheet
   
   Application.DisplayAlerts = False
   
    For Each wksSht In ThisWorkbook.Sheets
        If Left(wksSht.Name, 5) <> "CAR C" Then
            If Left(wksSht.Name, 5) <> "SSA S" Then
                If Left(wksSht.Name, 6) <> "System" Then
                    If Left(wksSht.Name, 3) <> "CAR" Then
                        If Left(wksSht.Name, 5) <> "Input" Then
            wksSht.Delete
        End If
            End If
                End If
                    End If
                        End If
    Next wksSht
    
End Sub
Sub Protect1()
    Dim Wb As Workbook, shPt As Variant
    

    Set Wb = ActiveWorkbook
    Wb.Protect "eaton222"
    For Each shPt In Wb.Sheets
        shPt.Protect "eaton222"
    Next shPt
End Sub



Attribute VB_Name = "Mod_TransferModule"
Option Explicit
Sub TransferModule()
    Const MODULE_NAME   As String = "Mod_CreateCAR"         ' Name of the module to transfer
    Const TEMPFILE      As String = "C:\temp\Module.bas"    ' temp textfile
    Dim wbk             As Workbook
  
    On Error Resume Next
    '**Create new workbook
    Set wbk = ActiveWorkbook
     
    '** export the module to a textfile
    ThisWorkbook.VBProject.VBComponents(MODULE_NAME).Export TEMPFILE
    
    'import the module to the new workbook
    wbk.VBProject.VBComponents.Import TEMPFILE
    
    'kill the textfile
    Kill TEMPFILE
    
    
    wbk.Sheets("System Issues List").Select
    ActiveSheet.Shapes("Create CAR").Select
    ActiveSheet.Shapes("Create CAR").OnAction = "'" & wbk.Name & "'" & "!CreateCAR"
'    Selection.OnAction = WBK.Name & "!CreateCAR"
    Set wbk = Nothing
End Sub
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
