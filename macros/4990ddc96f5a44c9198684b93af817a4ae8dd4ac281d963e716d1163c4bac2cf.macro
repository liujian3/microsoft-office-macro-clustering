Attribute VB_Name = "NewMacros"
Option Explicit
Public Mena As String
Public Mena2 As String
Public PRODUKT As String
Public MyHESLO As String
Public POLE As String
Public POPLATEK As String
Public Const REDITEL_PRODEJE As String = "Ing. Ladislav Sladk|fffd|"
Public Const GENERALNI_REDITEL As String = "Ing. Petr |fffd|vec, MBA"
Public Const VEDOUCI_PRODEJ_KA As String = "Ing. Ji|fffd||fffd| Mejzr, Ph.D."
Public Const PREDSTAVENSTVO As String = "Ing. Petr |fffd|vec, MBA a Ing. Ladislav Sladk|fffd|"
Public pocetradku As Integer 'soucasny pocet radku vybrane tabulky
Public M As Integer 'Po|fffd|et |fffd||fffd|dk|fffd|, kter|fffd| se maj|fffd| p|fffd|idat/smazat
Public K As Integer 'Kolikr|fffd|t se m|fffd| makro Add/Delete zopakovat
Public Q As Integer 'Promena pro makro priloha
Public L As Integer 'Promena pro makro priloha
Public TargetObdobi As Integer
Public FIELD As Variant
Public UserForm2Action As String
Public Continue As Boolean
Sub Hide()
ActiveDocument.FormFields(POLE).Range.Font.Hidden = True
End Sub
Sub Unhide()
ActiveDocument.FormFields(POLE).Range.Font.Hidden = False
End Sub
Sub Block()
ActiveDocument.FormFields(POLE).Enabled = False
End Sub
Sub Unblock()
ActiveDocument.FormFields(POLE).Enabled = True
End Sub
Sub Highlight()
ActiveDocument.FormFields(POLE).Select
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorLightYellow
        End With
        End With
End Sub
Sub Unhighlight()
ActiveDocument.FormFields(POLE).Select
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorWhite
        End With
        End With
End Sub
Sub Zabarvit_tabulky_zacatek()
Dim FIELD As Variant
Dim POLETab(1 To 3) As String
POLETab(1) = "zak_kontaktni_osoby"
POLETab(2) = "TabulkaMnozstvi"
POLETab(3) = "TabulkaCena"

For Each FIELD In POLETab
        ActiveDocument.Bookmarks(FIELD).Select
        Selection.Start = Selection.Tables(1).Rows(2).Range.Start
        Selection.Shading.BackgroundPatternColor = wdColorLightYellow
Next
End Sub
Sub Zabarvit_tabulky_konec()
Dim FIELD As Variant
Dim POLETab(1 To 3) As String
POLETab(1) = "zak_kontaktni_osoby"
POLETab(2) = "TabulkaMnozstvi"
POLETab(3) = "TabulkaCena"

For Each FIELD In POLETab
        ActiveDocument.Bookmarks(FIELD).Select
        Selection.Start = Selection.Tables(1).Rows(2).Range.Start
        Selection.Shading.BackgroundPatternColor = wdColorAutomatic
Next
End Sub
Public Sub UET_ZASTOUPEN()
'Zastupce epet se dotahne na stranu s podpisem
If ActiveDocument.FormFields("UET_Zastoupen").Result = "vyber" Then
        ActiveDocument.FormFields("UET_zastupen_funkce").Result = ""
        ActiveDocument.FormFields("UET_podpis_jmeno_1").Result = ""
        ActiveDocument.FormFields("UET_podpis_funkce_1").Result = ""
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = ""
        ActiveDocument.FormFields("UET_podpis_funkce_2").Result = ""
    ElseIf ActiveDocument.FormFields("UET_Zastoupen").Result = VEDOUCI_PRODEJ_KA Then
       ActiveDocument.FormFields("UET_zastupen_funkce").Result = "vedouc|fffd| Prodeje Key Account, na z|fffd|klad|fffd| pln|fffd| moci"
        ActiveDocument.FormFields("UET_podpis_jmeno_1").Result = VEDOUCI_PRODEJ_KA
        ActiveDocument.FormFields("UET_podpis_funkce_1").Result = "vedouc|fffd| Prodeje Key Account"
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = ""
        ActiveDocument.FormFields("UET_podpis_funkce_2").Result = ""
    ElseIf ActiveDocument.FormFields("UET_Zastoupen").Result = PREDSTAVENSTVO Then
        ActiveDocument.FormFields("UET_zastupen_funkce").Result = "|fffd|lenov|fffd| p|fffd|edstavenstva"
        ActiveDocument.FormFields("UET_podpis_jmeno_1").Result = "Ing. Petr |fffd|vec, MBA"
        ActiveDocument.FormFields("UET_podpis_funkce_1").Result = "|fffd|len p|fffd|edstavenstva"
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = "Ing. Ladislav Sladk|fffd|"
        ActiveDocument.FormFields("UET_podpis_funkce_2").Result = "|fffd|len p|fffd|edstavenstva"
  Else: ActiveDocument.FormFields("UET_zastupen_funkce").Result = "Key Account Manager, na z|fffd|klad|fffd| pln|fffd| moci"
        ActiveDocument.FormFields("UET_podpis_jmeno_1").Result = ActiveDocument.FormFields("UET_Zastoupen").Result
        ActiveDocument.FormFields("UET_podpis_funkce_1").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = ""
        ActiveDocument.FormFields("UET_podpis_funkce_2").Result = ""
          
End If
If ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = "" Then
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Select
        With Selection.Cells
            .Borders(wdBorderTop).LineStyle = wdLineStyleNone
        End With
    ElseIf Not ActiveDocument.FormFields("UET_podpis_jmeno_2").Result = "" Then
        ActiveDocument.FormFields("UET_podpis_jmeno_2").Select
        With Selection.Cells
            .Borders(wdBorderTop).LineStyle = wdLineStyleSingle
            .Borders(wdBorderTop).LineWidth = wdLineWidth050pt
            .Borders(wdBorderTop).Color = wdColorAutomatic
        End With
End If
Selection.GoTo What:=wdGoToBookmark, Name:="Zakaznik_spolecnost"
End Sub
Sub UET_KAM()
'Vyber KAM v tabulce kontaktnich osob za Dodavatele
If ActiveDocument.FormFields("UET_Zastupce").Result = "vyber" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = ""
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = ""
        ActiveDocument.FormFields("UET_Zastupce_email").Result = ""
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = ""
        
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Ing. Ji|fffd||fffd| Mejzr, Ph.D." Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Vedouc|fffd| prodeje velkoodb|fffd|ru"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/ 605 342 146"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "jiri.mejzr@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
        
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Ing. Lum|fffd|r Je|fffd|" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/606 738 790"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "lumir.jez@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
        
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Ing. Michal Havl|fffd|k" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/734 683 992"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "michal.havlik@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
        
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Ing. Jarom|fffd|r Pernica" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/724 052 994"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "jaromir.pernica@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
            
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Tom|fffd| Urban" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/734 862 834"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "tomas.urban@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
                
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Bc. Monika Poul|fffd||fffd|kov|fffd|" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/731 661 707"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "monika.poulickova@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
                
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Martin Ko|fffd|an" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/606 723 525"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "martin.kosan@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
                
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Anton|fffd|n |fffd|rom" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/602 690 755"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "antonin.srom@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
                
    ElseIf ActiveDocument.FormFields("UET_Zastupce").Result = "Jarom|fffd|r Vrchota" Then
        ActiveDocument.FormFields("UET_Zastupce_funkce").Result = "Key Account Manager"
        ActiveDocument.FormFields("UET_Zastupce_telefon").Result = "+420/724 444 865"
        ActiveDocument.FormFields("UET_Zastupce_email").Result = "jaromir.vrchota@epet.cz"
        ActiveDocument.FormFields("UET_Zastupce_odpoved").Result = "Smluvn|fffd| z|fffd|le|fffd|itosti, fakturace, platby"
    End If
'If ActiveDocument.FormFields("UET_Zastupce").Result = "Bc. Monika Poul|fffd||fffd|kov|fffd|" Then
'    ActiveDocument.FormFields("UET_Zastupce").Select
'    Selection.ParagraphFormat.Alignment = wdAlignParagraphLeft
'Else:
'    ActiveDocument.FormFields("UET_Zastupce").Select
'    Selection.ParagraphFormat.Alignment = wdAlignParagraphCenter
'End If
Selection.GoTo What:=wdGoToBookmark, Name:="Zak_kontaktni_osoby_1"
'ActiveDocument.Bookmarks("Zak_kontaktni_osoby_1").Select
End Sub
Public Sub ZAK_ZASTOUPEN()
'Zakaznik se dotahne na stranku s podpisem
ActiveDocument.FormFields("Zak_podpis_jmeno1").Result = ActiveDocument.FormFields("Zak_zastoupen_jmeno1").Result
ActiveDocument.FormFields("Zak_podpis_funkce1").Result = ActiveDocument.FormFields("Zak_zastoupen_funkc1").Result
ActiveDocument.FormFields("Zak_podpis_jmeno2").Result = ActiveDocument.FormFields("Zak_zastoupen_jmeno2").Result
ActiveDocument.FormFields("Zak_podpis_funkce2").Result = ActiveDocument.FormFields("Zak_zastoupen_funkc2").Result
End Sub

Sub ZAK_PODPIS_2()
'Pokud bude mit zakaznik 2 zastupce
If ActiveDocument.FormFields("Zak_zastoupen_jmeno2").Result = "" Then
        ActiveDocument.FormFields("Zak_zastoupen_funkc2").Result = ""
        ActiveDocument.FormFields("Zak_podpis_jmeno2").Select
        With Selection.Cells
            .Borders(wdBorderTop).LineStyle = wdLineStyleNone
        End With
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorAutomatic
        End With
        End With
        ActiveDocument.FormFields("Zak_podpis_jmeno2").Enabled = False
        ActiveDocument.FormFields("Zak_podpis_funkce2").Select
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorAutomatic
        End With
        End With
        ActiveDocument.FormFields("Zak_podpis_funkce2").Enabled = False
    ElseIf Not ActiveDocument.FormFields("Zak_zastoupen_jmeno2").Result = "" Then
        ActiveDocument.FormFields("Zak_podpis_jmeno2").Select
        With Selection.Cells
            .Borders(wdBorderTop).LineStyle = wdLineStyleSingle
            .Borders(wdBorderTop).LineWidth = wdLineWidth050pt
            .Borders(wdBorderTop).Color = wdColorBlack
        End With
                With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorAutomatic
        End With
        End With
        ActiveDocument.FormFields("Zak_podpis_jmeno2").Enabled = True
        ActiveDocument.FormFields("Zak_podpis_funkce2").Select
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorAutomatic
        End With
        End With
        ActiveDocument.FormFields("Zak_podpis_funkce2").Enabled = True
End If
ZAK_ZASTOUPEN
ZAK_CARKA
Selection.GoTo What:=wdGoToBookmark, Name:="Zak_zastoupen_jmeno2"
End Sub
Public Sub ZAK_SPOLECNOST()
'Jmeno spolecnosti zakaznika se dotahne i na stranku s podpisem
ActiveDocument.FormFields("Zak_podpis_spol").Result = ActiveDocument.FormFields("Zakaznik_spolecnost").Result
End Sub
Sub ZAK_CARKA()
If ActiveDocument.FormFields("Zak_zastoupen_jmeno2").Result = "" And ActiveDocument.FormFields("Zak_zastoupen_funkc2").Result = "" Then
ActiveDocument.FormFields("Zak_zastoupen_carka").Result = " "
Else: ActiveDocument.FormFields("Zak_zastoupen_carka").Result = ", "
End If
End Sub
Sub Podpis_Datum()
ActiveDocument.FormFields("Zak_podpis_datum").Result = ActiveDocument.FormFields("UET_podpis_datum").Result
End Sub
Sub Poplatek_BSD()
If ActiveDocument.FormFields("Poplatek_BSD").Result = "Poplatek BSD: ANO" Then
    ActiveDocument.FormFields("Poplatek_BSD_text").Result = "Sjedn|fffd|v|fffd| se poplatek za BSD, jeho|fffd| v|fffd||fffd|e se stanov|fffd| dle |fffd|l. 5 odst. 5.5. OP."
Else: ActiveDocument.FormFields("Poplatek_BSD_text").Result = ""
End If
End Sub
Sub subMena()
With ActiveDocument.FormFields("Mena")
    If ActiveDocument.FormFields("Mena").Result = "CZK" Or ActiveDocument.FormFields("Mena").Result = "EUR" Then
    Mena = ActiveDocument.FormFields("Mena").Result
    Mena2 = .Result
    Else:
    Mena = "EUR"
    Mena2 = "CZK"
    End If
End With
Strukturovani
Preprava
ActiveDocument.Bookmarks("TabulkaCena").Select
Dim pocetradku As Integer
pocetradku = Selection.Tables(1).Rows.Count

If pocetradku = 2 Then
    Selection.Tables(1).Cell(2, 3).Range.Text = Mena
ElseIf pocetradku = 3 Then
    ActiveDocument.Bookmarks("TabulkaCena").Select
    Selection.Tables(1).Cell(2, 3).Range.Text = Mena
    Selection.Tables(1).Cell(3, 3).Range.Text = Mena
ElseIf pocetradku = 4 Then
    ActiveDocument.Bookmarks("TabulkaCena").Select
    Selection.Tables(1).Cell(2, 3).Range.Text = Mena
    Selection.Tables(1).Cell(3, 3).Range.Text = Mena
    Selection.Tables(1).Cell(4, 3).Range.Text = Mena
Else:
    MsgBox ("Zkontrolujte po|fffd|et |fffd||fffd|dk|fffd| v tabulce parametr|fffd| cen!")
End If

If ActiveDocument.FormFields("Mena").Result = "CZK - DUZP" Then
    With ActiveDocument.FormFields("DUZP_1")
        .Result = "Smluvn|fffd| strany se dohodly, |fffd|e z|fffd|kazn|fffd|k bude Cenu, kter|fffd| je sjedn|fffd|na v EUR, platit v CZK. K p|fffd|epo|fffd|tu fakturovan|fffd| |fffd||fffd|stky z EUR na CZK se pou|fffd|ije kurz"
        .Range.Font.Hidden = False
    End With
    With ActiveDocument.FormFields("DUZP_2")
        .Result = " CZK/EUR vyhl|fffd|en|fffd| |fffd|eskou n|fffd|rodn|fffd| bankou v den zdaniteln|fffd|ho pln|fffd|n|fffd| vy|fffd||fffd|tovan|fffd| dod|fffd|vky plynu. Jsou-li sjedn|fffd|ny z|fffd|lohy, budou rovn|fffd| hrazeny v CZK, rozpis z|fffd|loh v CZK obdr|fffd||fffd| Z|fffd|kazn|fffd|k v Platebn|fffd|m kalend|fffd||fffd|i." & Chr(11) & Chr(11)
        .Range.Font.Hidden = False
    End With
    ActiveDocument.FormFields("Zvlastni_ujednani").Result = ""
Else:
    With ActiveDocument.FormFields("DUZP_1")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    With ActiveDocument.FormFields("DUZP_2")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    ActiveDocument.FormFields("Zvlastni_ujednani").Result = "Nejsou sjedn|fffd|na."
End If
ActiveDocument.FormFields("Pokuta_Mena").Result = Mena2
End Sub
Sub Strukturovani()
With ActiveDocument.FormFields("Mena")
If .Result = "CZK" Or .Result = "EUR" Then
Mena = .Result
Else:
Mena = "EUR"
End If
End With
If ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 1" Then
    ActiveDocument.FormFields("Strukturovani_t1").Result = "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za strukturov|fffd|n|fffd| (strukturov|fffd|n|fffd|m se rozum|fffd| vyrovn|fffd|v|fffd|n|fffd| sez|fffd|nn|fffd|ch v|fffd|kyv|fffd| v|fffd|odb|fffd|rech plynu Z|fffd|kazn|fffd|kem), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu "
    ActiveDocument.FormFields("Strukturovani_t2").Result = "61,97"
    POLE = "Strukturovani_t2"
    Highlight
    Unblock
    With ActiveDocument.FormFields("Strukturovani_t21")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    ActiveDocument.FormFields("Strukturovani_t3").Result = "/m3 a sjednan|fffd| denn|fffd| rezervovan|fffd| pevn|fffd| distribu|fffd|n|fffd| kapacity (m3) Z|fffd|kazn|fffd|ka."
    POLE = "Strukturovani_t3"
    Unhighlight
    Block
ElseIf ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 2" Then
    ActiveDocument.FormFields("Strukturovani_t1").Result = "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za strukturov|fffd|n|fffd| (strukturov|fffd|n|fffd|m se rozum|fffd| vyrovn|fffd|v|fffd|n|fffd| sez|fffd|nn|fffd|ch v|fffd|kyv|fffd| v|fffd|odb|fffd|rech plynu Z|fffd|kazn|fffd|kem), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu "
    ActiveDocument.FormFields("Strukturovani_t2").Result = "61,97"
    POLE = "Strukturovani_t2"
    Highlight
    Unblock
    With ActiveDocument.FormFields("Strukturovani_t21")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    ActiveDocument.FormFields("Strukturovani_t3").Result = "/MWh a skute|fffd|n|fffd| odebran|fffd|ho mno|fffd|stv|fffd| plynu Z|fffd|kazn|fffd|kem v p|fffd||fffd|slu|fffd|n|fffd|m plyn|fffd|rensk|fffd|m m|fffd|s|fffd|ci (MWh)."
    POLE = "Strukturovani_t3"
    Unhighlight
    Block
ElseIf ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 3" Then
    ActiveDocument.FormFields("Strukturovani_t1").Result = "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za strukturov|fffd|n|fffd| (strukturov|fffd|n|fffd|m se rozum|fffd| vyrovn|fffd|v|fffd|n|fffd| sez|fffd|nn|fffd|ch v|fffd|kyv|fffd| v|fffd|odb|fffd|rech plynu Z|fffd|kazn|fffd|kem), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu "
    ActiveDocument.FormFields("Strukturovani_t2").Result = "61,97"
    POLE = "Strukturovani_t2"
    Highlight
    Unblock
    With ActiveDocument.FormFields("Strukturovani_t21")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    ActiveDocument.FormFields("Strukturovani_t3").Result = "/Nm3|fffd| a skute|fffd|n|fffd| odebran|fffd|ho mno|fffd|stv|fffd| plynu Z|fffd|kazn|fffd|kem v p|fffd||fffd|slu|fffd|n|fffd|m plyn|fffd|rensk|fffd|m m|fffd|s|fffd|ci (Nm3)."
    POLE = "Strukturovani_t3"
    Unhighlight
    Block
ElseIf ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 4" Then
    ActiveDocument.FormFields("Strukturovani_t1").Result = "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za strukturov|fffd|n|fffd| (strukturov|fffd|n|fffd|m se rozum|fffd| vyrovn|fffd|v|fffd|n|fffd| sez|fffd|nn|fffd|ch v|fffd|kyv|fffd| v|fffd|odb|fffd|rech plynu Z|fffd|kazn|fffd|kem), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i "
    ActiveDocument.FormFields("Strukturovani_t2").Result = "5,3 % (slovy: p|fffd|t cel|fffd|ch t|fffd|i desetiny procenta )"
    POLE = "Strukturovani_t2"
    Highlight
    Unblock
    With ActiveDocument.FormFields("Strukturovani_t21")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    ActiveDocument.FormFields("Strukturovani_t3").Result = " z|fffd|celkov|fffd| ceny za dodan|fffd| plyn v p|fffd||fffd|slu|fffd|n|fffd|m plyn|fffd|rensk|fffd|m m|fffd|s|fffd|ci."
    POLE = "Strukturovani_t3"
    Unhighlight
    Block

ElseIf ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 6" Then
    With ActiveDocument.FormFields("Strukturovani_t1")
    .Result = "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za strukturov|fffd|n|fffd| (strukturov|fffd|n|fffd|m se rozum|fffd| vyrovn|fffd|v|fffd|n|fffd| sez|fffd|nn|fffd|ch v|fffd|kyv|fffd| v|fffd|odb|fffd|rech plynu Z|fffd|kazn|fffd|kem), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu (i) ro|fffd|n|fffd| ceny za "
    End With
    With ActiveDocument.FormFields("Strukturovani_t2")
    .Result = " denn|fffd| rezervovanou pevnou distribu|fffd|n|fffd| kapacitu (CZK/tis. m3)  m|fffd|stn|fffd| p|fffd||fffd|slu|fffd|n|fffd|ho provozovatele distribu|fffd|n|fffd| soustavy uveden|fffd| v Cenov|fffd|m rozhodnut|fffd| ER|fffd| platn|fffd|m a |fffd||fffd|inn|fffd|m ke dni skute|fffd|n|fffd|ho zah|fffd|jen|fffd| dod|fffd|vky  (ii) sjednan|fffd| denn|fffd| rezervovan|fffd| "
    End With
    POLE = "Strukturovani_t2"
    Unhighlight
    Block
    With ActiveDocument.FormFields("Strukturovani_t21")
        .Result = " pevn|fffd| distribu|fffd|n|fffd| kapacity  (m3) Z|fffd|kazn|fffd|ka a (iii) "
        .Range.Font.Hidden = False
    End With
    ActiveDocument.FormFields("Strukturovani_t3").Result = "jedn|fffd| poloviny."
    POLE = "Strukturovani_t3"
    Highlight
    Unblock
Else:
    Dim FIELD As Variant
    Dim Strukturovani_text(1 To 4) As String
    Strukturovani_text(1) = "Strukturovani_t1"
    Strukturovani_text(2) = "Strukturovani_t2"
    Strukturovani_text(3) = "Strukturovani_t3"
    Strukturovani_text(4) = "Strukturovani_t21"
    For Each FIELD In Strukturovani_text
    ActiveDocument.FormFields(FIELD).Result = ""
    ActiveDocument.FormFields(FIELD).Enabled = False
    ActiveDocument.FormFields(FIELD).Select
        With Selection.Font
        With .Shading
            .BackgroundPatternColor = wdColorWhite
        End With
        End With
    Next
    
End If

If ActiveDocument.FormFields("Mena").Result = "CZK - DUZP" Or ActiveDocument.FormFields("Mena").Result = "EUR" Then
    Select Case ActiveDocument.FormFields("Strukturovani").Result
    Case "Strukturov|fffd|n|fffd|: Varianta 1", "Strukturov|fffd|n|fffd|: Varianta 2", "Strukturov|fffd|n|fffd|: Varianta 3"
        With ActiveDocument.FormFields("Strukturovani_mena")
            .Result = " EUR"
            .Range.Font.Hidden = False
        End With
    
    Case Else
        With ActiveDocument.FormFields("Strukturovani_mena")
            .Result = ""
            .Range.Font.Hidden = True
        End With
    End Select
ElseIf ActiveDocument.FormFields("Mena").Result = "CZK" Then
    Select Case ActiveDocument.FormFields("Strukturovani").Result
    Case "Strukturov|fffd|n|fffd|: Varianta 1", "Strukturov|fffd|n|fffd|: Varianta 2", "Strukturov|fffd|n|fffd|: Varianta 3"
        With ActiveDocument.FormFields("Strukturovani_mena")
            .Result = " CZK"
            .Range.Font.Hidden = False
        End With
    
    Case Else
        With ActiveDocument.FormFields("Strukturovani_mena")
            .Result = ""
            .Range.Font.Hidden = True
        End With
    End Select
End If

If ActiveDocument.FormFields("Mena").Result = "EUR" And ActiveDocument.FormFields("Strukturovani").Result = "Strukturov|fffd|n|fffd|: Varianta 6" Then
With ActiveDocument.FormFields("Strukturovani_EUR")
    .Result = "Vzhledem k tomu, |fffd|e platba Ceny je sjedn|fffd|na v EUR, pou|fffd|ije se za |fffd||fffd|elem p|fffd|epo|fffd|tu poplatku za strukturaci z CZK do EUR sm|fffd|nn|fffd| kurz"
    .Range.Font.Hidden = False
End With
With ActiveDocument.FormFields("Strukturovani_EUR_2")
    .Result = " devizov|fffd|ho trhu CZK/EUR vyhl|fffd|en|fffd| |fffd|eskou n|fffd|rodn|fffd| bankou ke dni zdaniteln|fffd|ho pln|fffd|n|fffd| vy|fffd||fffd|tovan|fffd| dod|fffd|vky plynu."
    .Range.Font.Hidden = False
End With
Else:
With ActiveDocument.FormFields("Strukturovani_EUR")
    .Result = ""
    .Range.Font.Hidden = True
End With
With ActiveDocument.FormFields("Strukturovani_EUR_2")
    .Result = ""
    .Range.Font.Hidden = True
    End With
End If
End Sub
Sub Preprava()
If ActiveDocument.FormFields("Poplatek_za_prepravu").Result = "Poplatek za p|fffd|epravu: Varianta 1" Then
    ActiveDocument.FormFields("Preprava_t1").Result = Chr(11) & "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za p|fffd|epravu (zahrnuj|fffd|c|fffd| ve|fffd|ker|fffd| n|fffd|klady Dodavatele na p|fffd|epravu"
    ActiveDocument.FormFields("Preprava_t2").Result = " plynu k p|fffd||fffd|slu|fffd|n|fffd| distribu|fffd|n|fffd| soustav|fffd|, jen|fffd| nejsou sou|fffd||fffd|st|fffd| ceny za Distribu|fffd|n|fffd| slu|fffd|by), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu nejvy|fffd||fffd||fffd| pevn|fffd| "
    ActiveDocument.FormFields("Preprava_t3").Result = "ro|fffd|n|fffd| ceny za rezervovanou pevnou p|fffd|epravn|fffd| kapacitu (CZK/MWh/den) na vstupn|fffd|m hrani|fffd|n|fffd|m bodu dle Cenov|fffd|ho rozhodnut|fffd| ER|fffd| platn|fffd|ho a |fffd||fffd|inn|fffd|ho k posledn|fffd|mu dni "
    ActiveDocument.FormFields("Preprava_t4").Result = "p|fffd||fffd|slu|fffd|n|fffd|ho kalend|fffd||fffd|n|fffd|ho m|fffd|s|fffd|ce a velikosti denn|fffd| rezervovan|fffd| pevn|fffd| distribu|fffd|n|fffd| kapacity (m3) Z|fffd|kazn|fffd|ka."
    ActiveDocument.FormFields("Preprava_soucin").Result = ""
    POLE = "Preprava_soucin"
    Hide
    Block
    Unhighlight
ElseIf ActiveDocument.FormFields("Poplatek_za_prepravu").Result = "Poplatek za p|fffd|epravu: Varianta 2" Then
    ActiveDocument.FormFields("Preprava_t1").Result = Chr(11) & "Sou|fffd||fffd|st|fffd| Ceny vedle v|fffd||fffd|e uveden|fffd|ho zp|fffd|sobu jej|fffd|ho v|fffd|po|fffd|tu d|fffd|le je i poplatek za p|fffd|epravu (zahrnuj|fffd|c|fffd| ve|fffd|ker|fffd|"
    ActiveDocument.FormFields("Preprava_t2").Result = " n|fffd|klady Dodavatele na p|fffd|epravu plynu k p|fffd||fffd|slu|fffd|n|fffd| distribu|fffd|n|fffd| soustav|fffd|, jen|fffd| nejsou sou|fffd||fffd|st|fffd| ceny za Distribu|fffd|n|fffd| slu|fffd|by), jen|fffd| bude |fffd||fffd|tov|fffd|n m|fffd|s|fffd||fffd|n|fffd| ve v|fffd||fffd|i sou|fffd|inu "
    ActiveDocument.FormFields("Preprava_t3").Result = " n|fffd|sobku nejvy|fffd||fffd||fffd| pevn|fffd| ro|fffd|n|fffd| ceny za rezervovanou pevnou p|fffd|epravn|fffd| kapacitu (CZK/MWh/den) na vstupn|fffd|m hrani|fffd|n|fffd|m bodu dle Cenov|fffd|ho rozhodnut|fffd| ER|fffd| platn|fffd|ho a |fffd||fffd|inn|fffd|ho k "
    ActiveDocument.FormFields("Preprava_t4").Result = "posledn|fffd|mu dni p|fffd||fffd|slu|fffd|n|fffd|ho kalend|fffd||fffd|n|fffd|ho m|fffd|s|fffd|ce a velikosti denn|fffd| rezervovan|fffd| pevn|fffd| distribu|fffd|n|fffd| kapacity (m3) Z|fffd|kazn|fffd|ka."
    ActiveDocument.FormFields("Preprava_soucin").Result = "0,973"
    POLE = "Preprava_soucin"
    Unhide
    Unblock
    Highlight
Else:
    Dim FIELD As Variant
    Dim Preprava_text(1 To 5) As String
    Preprava_text(1) = "Preprava_t1"
    Preprava_text(2) = "Preprava_t2"
    Preprava_text(3) = "Preprava_t3"
    Preprava_text(4) = "Preprava_t4"
    Preprava_text(5) = "Preprava_soucin"
    For Each FIELD In Preprava_text
        ActiveDocument.FormFields(FIELD).Result = ""
        ActiveDocument.FormFields(FIELD).Enabled = False
        ActiveDocument.FormFields(FIELD).Select
        With Selection.Font
            With .Shading
                .BackgroundPatternColor = wdColorWhite
            End With
        End With
    Next
End If

If ActiveDocument.FormFields("Mena").Result = "EUR" And Not ActiveDocument.FormFields("Poplatek_za_prepravu").Result = "Poplatek za p|fffd|epravu: NE" Then
    With ActiveDocument.FormFields("Preprava_DUZP")
        .Result = "Vzhledem k tomu, |fffd|e platba Ceny je sjedn|fffd|na v EUR, pou|fffd|ije se za |fffd||fffd|elem p|fffd|epo|fffd|tu poplatku za p|fffd|epravu z "
        .Range.Font.Hidden = False
    End With
    With ActiveDocument.FormFields("Preprava_DUZP_2")
        .Result = " CZK do EUR sm|fffd|nn|fffd| kurz devizov|fffd|ho trhu CZK/EUR vyhl|fffd|en|fffd| |fffd|eskou n|fffd|rodn|fffd| bankou ke dni zdaniteln|fffd|ho pln|fffd|n|fffd| vy|fffd||fffd|tovan|fffd| dod|fffd|vky plynu."
        .Range.Font.Hidden = False
    End With
Else:
    With ActiveDocument.FormFields("Preprava_DUZP")
        .Result = ""
        .Range.Font.Hidden = True
    End With
    With ActiveDocument.FormFields("Preprava_DUZP_2")
        .Result = ""
        .Range.Font.Hidden = True
    End With
End If
End Sub
Sub Distribuce_EUR()
If ActiveDocument.FormFields("Distribuce_EUR").Result = "Distribuce EUR: NE" Then
ActiveDocument.FormFields("disEUR_t1").Result = ""
ActiveDocument.FormFields("disEUR_t2").Result = ""
ActiveDocument.FormFields("disEUR_t3").Result = ""
POLE = "disEUR_t3"
Unhighlight
Block
ActiveDocument.FormFields("disEUR_t4").Result = ""
POLE = "disEUR_t4"
Unhighlight
Block
ElseIf ActiveDocument.FormFields("Distribuce_EUR").Result = "Distribuce EUR: ANO (var. 1)" Then
ActiveDocument.FormFields("disEUR_t1").Result = "Je-li sjedn|fffd|na m|fffd|na ceny za Distribu|fffd|n|fffd| slu|fffd|by v|fffd|EUR, pak se pro pot|fffd|eby m|fffd|s|fffd||fffd|n|fffd| fakturace|fffd|jednotliv|fffd|ch slo|fffd|ek ceny za Distribu|fffd|n|fffd| slu|fffd|by v|fffd|EUR pou|fffd|ije kurz CZK/EUR vyhl|fffd|en|fffd|"
ActiveDocument.FormFields("disEUR_t2").Result = " |fffd|eskou n|fffd|rodn|fffd| bankou pro den uskute|fffd|n|fffd|n|fffd| zdaniteln|fffd|ho pln|fffd|n|fffd|, kter|fffd| je fakturov|fffd|no. Smluvn|fffd| strany sjedn|fffd|vaj|fffd| poplatek za fakturaci v|fffd|EUR ve v|fffd||fffd|i "
ActiveDocument.FormFields("disEUR_t3").Result = "0,009"
POLE = "disEUR_t3"
Highlight
Unblock
ActiveDocument.FormFields("disEUR_t4").Result = " % fakturovan|fffd| ceny za Distribu|fffd|n|fffd| slu|fffd|by (EUR)."
POLE = "disEUR_t4"
Unhighlight
Block
Selection.GoTo What:=wdGoToBookmark, Name:="disEUR_t3"
Else:
ActiveDocument.FormFields("disEUR_t1").Result = "Je-li sjedn|fffd|na m|fffd|na ceny za Distribu|fffd|n|fffd| slu|fffd|by v EUR, pak se pro pot|fffd|eby m|fffd|s|fffd||fffd|n|fffd| fakturace jednotliv|fffd|ch slo|fffd|ek ceny za Distribu|fffd|n|fffd| slu|fffd|by v EUR pou|fffd|ije kurz CZK/EUR vyhl|fffd|en|fffd| |fffd|eskou "
ActiveDocument.FormFields("disEUR_t2").Result = "n|fffd|rodn|fffd| bankou pro den uskute|fffd|n|fffd|n|fffd| zdaniteln|fffd|ho pln|fffd|n|fffd|, kter|fffd| je fakturov|fffd|no. Smluvn|fffd| strany sjedn|fffd|vaj|fffd| poplatek za fakturaci v EUR ve v|fffd||fffd|i, je|fffd| odpov|fffd|d|fffd| rozd|fffd|lu mezi |fffd||fffd|stkami fakturovan|fffd|"
ActiveDocument.FormFields("disEUR_t3").Result = " ceny za Distribu|fffd|n|fffd| slu|fffd|by p|fffd|epo|fffd|ten|fffd| z CZK na EUR (i) kurzem |fffd|NB vyhl|fffd|en|fffd|m pro den uskute|fffd|n|fffd|n|fffd| zdaniteln|fffd|ho pln|fffd|n|fffd| a (ii) a kurzem |fffd|NB vyhl|fffd|en|fffd|m pro den uskute|fffd|n|fffd|n|fffd| zdaniteln|fffd|ho pln|fffd|n|fffd| n|fffd|soben|fffd|m "
POLE = "disEUR_t3"
Unhighlight
Block
ActiveDocument.FormFields("disEUR_t4").Result = "0,991."
POLE = "disEUR_t4"
Highlight
Unblock
End If
End Sub
Sub AddRows()
Selection.InsertRowsBelow K 'Cislovka na konci prida x radku na konec vybrane tabulky
End Sub
Sub DeleteRows()        'smaze prebytecne radky do te doby dokud nebude pocet souhlasit s vybranym poctem obdobi
Selection.Tables(1).Rows.Last.Cells.Delete
End Sub
Sub DeleteRowsPriloha() 'smaze prebytecne radky do te doby dokud nebude pocet souhlasit s vybranym poctem obdobi
Do
DeleteRows
L = L + 1
Loop Until L = 0
End Sub
Sub PocetObdobiPriloha() 'porovna pocet radku tabulky prilohy s vybranym poctem obdobi a prida/smaze pripadne radky
ActiveDocument.Bookmarks("TabulkaPriloha").Select
Selection.Tables(1).Range.Select
pocetradku = Selection.Tables(1).Rows.Count
Q = TargetObdobi * 4 - pocetradku
L = Q
If Q < 0 Then
DeleteRowsPriloha
ElseIf Q > 0 Then
PrilohaText
PrilohaTextPOLE
Selection.Tables(1).Range.Select
Selection.Bookmarks.Add Name:="TabulkaPriloha"
End If
End Sub
Sub CompareRows() 'spocita pocet radku v tabulce a porovna s vybranym poctem obdobi
pocetradku = Selection.Tables(1).Rows.Count
M = TargetObdobi - pocetradku
End Sub
Sub PocetObdobi()
Dim Tabulka(1 To 2) As String
Tabulka(1) = "TabulkaCena"
Tabulka(2) = "TabulkaMnozstvi"
For Each FIELD In Tabulka
ActiveDocument.Bookmarks(FIELD).Select
CompareRows
If M < 0 Then
K = M
Do
DeleteRows
K = K + 1
Loop Until K = 0
ElseIf M > 0 Then
ActiveDocument.Bookmarks(FIELD).Select
K = M
AddRows
End If
Next
End Sub
Sub TableBorders() 'zabarvi spodni ohraniceni tabulky, ktere vetsinou mizi pri pridani/odstraneni radku tabulek
Dim Borders(1 To 3) As String
Borders(1) = "TabulkaCena"
Borders(2) = "TabulkaMnozstvi"
Borders(3) = "TabulkaPriloha"
For Each FIELD In Borders
    ActiveDocument.Bookmarks(FIELD).Select
    Selection.Tables(1).Rows.Last.Select
    Options.DefaultBorderColor = -603930625
    With Selection.Borders(wdBorderBottom)
        .LineStyle = Options.DefaultBorderLineStyle
        .LineWidth = Options.DefaultBorderLineWidth
        .Color = Options.DefaultBorderColor
    End With
Next
End Sub
Sub PrilohaTextPOLE() 'aktualizuje vyber textu prilohy pro kopirovani a vlozeni
Dim rngPrilohaPOLE As Range

ActiveDocument.Bookmarks("TabulkaPriloha").Select
With Selection.Tables(1)
Set rngPrilohaPOLE = .Rows(5).Range
rngPrilohaPOLE.End = .Rows(8).Range.End
End With
rngPrilohaPOLE.Select
Selection.Bookmarks.Add Name:="tabPrilohaPOLE"
End Sub
Sub PrilohaText()
ActiveDocument.Bookmarks("TabulkaPriloha").Select
Selection.Tables(1).Range.Select
pocetradku = Selection.Tables(1).Rows.Count
If TargetObdobi = 4 And pocetradku = 8 Then
    PrilohaTextPOLE
    Selection.GoTo What:=wdGoToBookmark, Name:="tabPrilohaPOLE"
    Selection.Copy
    Selection.PasteAndFormat (wdFormatOriginalFormatting)
    Selection.PasteAndFormat (wdFormatOriginalFormatting)
ElseIf TargetObdobi = 4 And pocetradku = 12 Then
    Selection.GoTo What:=wdGoToBookmark, Name:="tabPrilohaPOLE"
    Selection.Copy
    Selection.PasteAndFormat (wdFormatOriginalFormatting)
    PrilohaTextPOLE
ElseIf TargetObdobi = 3 Then
    Selection.GoTo What:=wdGoToBookmark, Name:="tabPrilohaPOLE"
    Selection.Copy
    Selection.PasteAndFormat (wdFormatOriginalFormatting)
    PrilohaTextPOLE
End If
End Sub
Sub PrilohaTextRoky2() 'p|fffd|ep|fffd|e roky v p|fffd||fffd|loze na spr|fffd|vn|fffd| odbob|fffd|
Dim Rok1 As String
Dim Rok2 As String
Dim Rok3 As String

ActiveDocument.Bookmarks("TabulkaMnozstvi").Select
Rok1 = Left(Selection.Tables(1).Cell(Row:=2, Column:=1).Range.Text, 4)
If TargetObdobi = 3 Then
Rok1 = Left(Selection.Tables(1).Cell(Row:=2, Column:=1).Range.Text, 4)
Rok2 = Left(Selection.Tables(1).Cell(Row:=3, Column:=1).Range.Text, 4)
Else:
Rok1 = Left(Selection.Tables(1).Cell(Row:=2, Column:=1).Range.Text, 4)
Rok2 = Left(Selection.Tables(1).Cell(Row:=3, Column:=1).Range.Text, 4)
Rok3 = Left(Selection.Tables(1).Cell(Row:=4, Column:=1).Range.Text, 4)
End If

ActiveDocument.Bookmarks("TabulkaPriloha").Select
If TargetObdobi = 2 Then
  With Selection.Tables(1).Cell(Row:=5, Column:=1).Range
   .Text = Rok1
  End With
ElseIf TargetObdobi = 3 Then
  With Selection.Tables(1).Cell(Row:=5, Column:=1).Range
   .Text = Rok1
  End With
  With Selection.Tables(1).Cell(Row:=9, Column:=1).Range
   .Text = Rok2
  End With
Else:
  With Selection.Tables(1).Cell(Row:=5, Column:=1).Range
   .Text = Rok1
  End With
  With Selection.Tables(1).Cell(Row:=9, Column:=1).Range
   .Text = Rok2
  End With
  With Selection.Tables(1).Cell(Row:=13, Column:=1).Range
   .Text = Rok3
  End With
End If
Selection.GoTo What:=wdGoToBookmark, Name:="Urcita_do"
End Sub
Sub TLACITKO()
On Error Resume Next
ActiveDocument.Unprotect Password:="epetheslo"
Dim FIELD As Variant
Dim POLE_Buttons(1 To 6) As String 'Seznam tlacitek, co se zakryjou pri zamknuti smlouvy
POLE_Buttons(1) = "Poplatek_BSD"
POLE_Buttons(2) = "Strukturovani"
POLE_Buttons(3) = "Distribuce_EUR"
POLE_Buttons(4) = "Poplatek_za_prepravu"
POLE_Buttons(5) = "Mena"
POLE_Buttons(6) = "Mena_text"

Dim ListCheckbox(1 To 8) As String 'Seznam tlacitek, checkboxu
ListCheckbox(1) = "uhrada_fa_prikaz"
ListCheckbox(2) = "uhrada_fa_inkaso"
ListCheckbox(3) = "uhrada_zaloh_prikaz"
ListCheckbox(4) = "uhrada_zaloh_inkaso"
ListCheckbox(5) = "odesilani_email"
ListCheckbox(6) = "odesilani_posta"
ListCheckbox(7) = "osvobozeni_dan_ano"
ListCheckbox(8) = "osvobozeni_dan_ne"

Dim ListPOLE(1 To 31) As String 'Seznam poli, co se maji zvyraznit pri otevreni smlouvy
ListPOLE(1) = "Cislo_smlouvy"
ListPOLE(2) = "UET_zastoupen"
ListPOLE(3) = "Zakaznik_spolecnost"
ListPOLE(4) = "Zakaznik_Sidlo"
ListPOLE(5) = "Zakaznik_Sidlo_PSC"
ListPOLE(6) = "Zakaznik_IC"
ListPOLE(7) = "Zakaznik_DIC"
ListPOLE(8) = "OR_soud"
ListPOLE(9) = "OR_vlozka"
ListPOLE(10) = "Zak_zastoupen_jmeno1"
ListPOLE(11) = "Zak_zastoupen_funkc1"
ListPOLE(12) = "Zak_zastoupen_jmeno2"
ListPOLE(13) = "Zak_zastoupen_funkc2"
ListPOLE(14) = "Zakaznik_BU_CZK"
ListPOLE(15) = "Zakaznik_BU_EUR"
ListPOLE(16) = "Zakaznik_BU_IBAN"
ListPOLE(17) = "Zakaznik_BU_SWIFT"
ListPOLE(18) = "Zakaznik_adresa_2"
ListPOLE(19) = "UET_zastupce"
ListPOLE(20) = "Min_sjednano"
ListPOLE(21) = "Max_sjednano"
ListPOLE(22) = "Tolerance_vyse"
ListPOLE(23) = "Urcita_od"
ListPOLE(24) = "Urcita_do"
ListPOLE(25) = "zasilani_fa_mail"
ListPOLE(26) = "zasilani_fa_posta"
ListPOLE(27) = "Zvlastni_ujednani"
ListPOLE(28) = "UET_podpis_datum"
ListPOLE(29) = "Zak_podpis_misto"
ListPOLE(30) = "Zak_podpis_datum"
ListPOLE(31) = "crm"

Dim List2POLE(1 To 5) As String 'Seznam poli, co se NEmaji zvyraznit pri otevreni smlouvy
List2POLE(1) = "Strukturovani_t2"
List2POLE(2) = "Strukturovani_t3"
List2POLE(3) = "disEUR_t3"
List2POLE(4) = "disEUR_t4"
List2POLE(5) = "Preprava_soucin"

Dim customerFIELD(1 To 16) As String
customerFIELD(1) = "Zakaznik_spolecnost"
customerFIELD(2) = "Zakaznik_Sidlo"
customerFIELD(3) = "Zakaznik_Sidlo_PSC"
customerFIELD(4) = "Zakaznik_IC"
customerFIELD(5) = "Zakaznik_DIC"
customerFIELD(6) = "OR_soud"
customerFIELD(7) = "OR_vlozka"
customerFIELD(8) = "Zak_zastoupen_jmeno1"
customerFIELD(9) = "Zak_zastoupen_funkc1"
customerFIELD(10) = "Zak_zastoupen_jmeno2"
customerFIELD(11) = "Zak_zastoupen_funkc2"
customerFIELD(12) = "Zakaznik_BU_CZK"
customerFIELD(13) = "Zakaznik_BU_EUR"
customerFIELD(14) = "Zakaznik_BU_IBAN"
customerFIELD(15) = "Zakaznik_BU_SWIFT"
customerFIELD(16) = "Zakaznik_adresa_2"

Dim customerCHECKBOX(1 To 8) As String
customerCHECKBOX(1) = "uhrada_fa_prikaz"
customerCHECKBOX(2) = "uhrada_fa_inkaso"
customerCHECKBOX(3) = "uhrada_zaloh_prikaz"
customerCHECKBOX(4) = "uhrada_zaloh_inkaso"
customerCHECKBOX(5) = "odesilani_email"
customerCHECKBOX(6) = "odesilani_posta"
customerCHECKBOX(7) = "osvobozeni_dan_ano"
customerCHECKBOX(8) = "osvobozeni_dan_ne"


Dim HESLO As String
Const MyHESLO = "Klimentska2019"
HESLO = InputBox("Zadej heslo!", "Zadan|fffd| hesla")
    If HESLO = MyHESLO Then
        UserForm2.Show
        Select Case UserForm2Action
        Case "epetUnlock"
            Word.Application.ScreenUpdating = False
            Application.DisplayAlerts = False
            ActiveDocument.Sections(2).ProtectedForForms = False
            ActiveDocument.Sections(4).ProtectedForForms = False
            ActiveDocument.Sections(6).ProtectedForForms = False
            ActiveDocument.Sections(9).ProtectedForForms = False
            UserForm1.Show
            If Continue = False Then
                Word.Application.ScreenUpdating = True
                Application.DisplayAlerts = True
                Exit Sub
            End If
            PocetObdobi
            PocetObdobiPriloha
            PrilohaTextRoky2
            For Each FIELD In POLE_Buttons
                ActiveDocument.FormFields(FIELD).Enabled = True
                ActiveDocument.FormFields(FIELD).Range.Font.Hidden = False
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorDarkBlue
                        End With
                    End With
            Next
            For Each FIELD In ListPOLE
                ActiveDocument.FormFields(FIELD).Enabled = True
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorLightYellow
                        End With
                    End With
            Next
            For Each FIELD In ListCheckbox
                ActiveDocument.FormFields(FIELD).Enabled = True
            Next
            Zabarvit_tabulky_zacatek
            Application.DisplayAlerts = True
            MsgBox ("V|fffd|echna pole jsou odem|fffd|ena!")
            Selection.GoTo What:=wdGoToBookmark, Name:="Cislo_smlouvy"
            Word.Application.ScreenUpdating = True
        Case "epetLock"
            Word.Application.ScreenUpdating = False
            Zabarvit_tabulky_konec
            For Each FIELD In POLE_Buttons
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorWhite
                        End With
                    End With
                ActiveDocument.FormFields(FIELD).Enabled = False
                ActiveDocument.FormFields(FIELD).Range.Font.Hidden = True
            Next
            ActiveDocument.Sections(2).ProtectedForForms = True
            ActiveDocument.Sections(4).ProtectedForForms = True
            ActiveDocument.Sections(6).ProtectedForForms = True
            ActiveDocument.Sections(9).ProtectedForForms = True
            For Each FIELD In ListPOLE
                ActiveDocument.FormFields(FIELD).Enabled = False
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorAutomatic
                        End With
                    End With
            Next
            For Each FIELD In List2POLE
                ActiveDocument.FormFields(FIELD).Enabled = False
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorAutomatic
                        End With
                    End With
            Next
            For Each FIELD In ListCheckbox
                ActiveDocument.FormFields(FIELD).Enabled = False
            Next
            ActiveDocument.FormFields("Zak_podpis_funkce2").Enabled = False
            ActiveDocument.FormFields("Zak_podpis_jmeno2").Enabled = False
            Word.Application.ScreenUpdating = True
            MsgBox ("V|fffd|echna pole jsou zam|fffd|ena!")
            
        Case "customerUnlock"
            'On Error GoTo ChybovaHlaska
            Word.Application.ScreenUpdating = False
            Application.DisplayAlerts = False
            ActiveDocument.Sections(2).ProtectedForForms = False
            ActiveDocument.Sections(4).ProtectedForForms = False
            ActiveDocument.Sections(6).ProtectedForForms = False
            ActiveDocument.Sections(9).ProtectedForForms = False
            UserForm1.Show
            If Continue = False Then
                Word.Application.ScreenUpdating = True
                Application.DisplayAlerts = True
                Exit Sub
            End If
            PocetObdobi
            PocetObdobiPriloha
            PrilohaTextRoky2
            ActiveDocument.Bookmarks("zak_kontaktni_osoby").Select
            Selection.Start = Selection.Tables(1).Rows(2).Range.Start
            Selection.Shading.BackgroundPatternColor = wdColorLightYellow
            For Each FIELD In customerFIELD
                ActiveDocument.FormFields(FIELD).Enabled = True
                ActiveDocument.FormFields(FIELD).Select
                    With Selection.Font
                        With .Shading
                            .BackgroundPatternColor = wdColorLightYellow
                        End With
                    End With
            Next
            For Each FIELD In customerCHECKBOX
                ActiveDocument.FormFields(FIELD).Enabled = True
            Next
            ActiveDocument.Sections(2).ProtectedForForms = False
            ActiveDocument.Sections(4).ProtectedForForms = True
            ActiveDocument.Sections(6).ProtectedForForms = True
            ActiveDocument.Sections(9).ProtectedForForms = False
            Application.DisplayAlerts = True
            Word.Application.ScreenUpdating = True

        End Select
    Else: MsgBox ("Chybn|fffd| zadan|fffd| heslo!")
    End If
    ActiveDocument.Protect Type:=wdAllowOnlyFormFields, Password:="epetheslo", NoReset:=True
Exit Sub
ChybovaHlaska:
    MsgBox ("Nepovedlo se prov|fffd|st vybranou akci!")
End Sub
Attribute VB_Name = "ThisDocument"
Attribute VB_Base = "1Normal.ThisDocument"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = True
Attribute VB_Customizable = True


Private Sub Document_Open()
Continue = False
End Sub

Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{ED602AE5-2066-47FF-98D2-94ABE8FFE41C}{CDFF1520-0C6D-4306-BADD-9E530E87D044}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton5_Click()
UserForm1.Hide
If OptionButton1.Value = True Then
TargetObdobi = 2
ElseIf OptionButton2.Value = True Then
TargetObdobi = 3
ElseIf OptionButton3.Value = True Then
TargetObdobi = 4
End If
Continue = True
End Sub

Private Sub OptionButton1_Click()
TargetObdobi = 2 'Hodnota navysena o radek s nazvy sloupcu
Continue = True
End Sub
Private Sub OptionButton2_Click()
TargetObdobi = 3 'Hodnota navysena o radek s nazvy sloupcu
Continue = True
End Sub
Private Sub OptionButton3_Click()
TargetObdobi = 4 'Hodnota navysena o radek s nazvy sloupcu
Continue = True
End Sub
Attribute VB_Name = "UserForm2"
Attribute VB_Base = "0{DADE5EB1-3F85-498A-8072-ADDD23A57B96}{BA35EE82-E854-4E25-8E34-7C1662CA6892}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Private Sub CommandButton1_Click()
UserForm2Action = "customerUnlock"
UserForm2.Hide
End Sub

Private Sub CommandButton3_Click()
UserForm2Action = "epetLock"
UserForm2.Hide
End Sub

Private Sub CommandButton4_Click()
UserForm2Action = "epetUnlock"
UserForm2.Hide
End Sub





INQUEST-PP=macro
