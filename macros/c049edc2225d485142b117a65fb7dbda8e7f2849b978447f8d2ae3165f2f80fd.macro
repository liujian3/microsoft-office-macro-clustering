Attribute VB_Name = "Module1"
Public ElmRes(7), ElmInc(7) As Integer
Public Energy As Long
Public ActWorld, GCtrl, MatID, TypID As Integer
Public Stat(7), StatLim(7), StatMin(7) As Integer
Public PreCard, PostCard As Integer
Public MAttStat(3), MDefStat(3), TAttStat(3), TDefStat(3)
Public Special, PixieStick As Integer
Public Price As Long
Sub Initialize()
   For I = 0 To 7
      Stat(I) = Range("StatBonus").Cells(1, I + 1)
      StatLim(I) = 0
      StatMin(I) = -10
   Next I
   
   Price = 0
   
   With Sheets("Materials")
      Material = .Columns("B:B").Find(what:=Range("Material"), LookAt:=xlWhole).Row
      For I = 0 To 7
         ElmRes(I) = .Cells(Material, 13 + I)
         ElmInc(I) = 0
      Next I
      For I = 0 To 3
         MAttStat(I) = .Cells(Material, 5 + I)
         MDefStat(I) = .Cells(Material, 9 + I)
      Next I
      MatID = .Cells(Material, 1)
      GCtrl = .Cells(Material, 4)
      Price = .Cells(Material, 21)
   End With
   
   With Sheets("Type")
      TypID = .Cells(.Columns("B:B").Find(what:=Range("Type"), LookAt:=xlWhole).Row, 1)
      For I = 0 To 3
         TAttStat(I) = .Range("Types").Cells(TypID + 1, 4 + I)
         TDefStat(I) = .Range("Types").Cells(TypID + 1, 4 + I)
      Next I
      Price = Price * .Range("Types").Cells(TypID + 1, 12)
   End With
   
   PreCard = 255
   PostCard = 255
   PixieStick = True
   Special = Sheets("Forge").Range("SpecialEffect").Cells(1, 1)
   SetActiveWorld
   Energy = 0
End Sub
Sub CalculatePrice()
   Dim CardID, FCard, AddPrice, FPrice
   
   FPrice = Price
   
   For I = 1 To 4
      CardID = GetCard(I)
      Set FItem = Sheets("Cards").Columns("A:A").Find(what:=Val(CardID), After:=Sheets("Cards").Range("A1"), LookAt:=xlWhole)
      If FItem Is Nothing Then
         AddPrice = 0
      Else
         AddPrice = Sheets("Cards").Cells(FItem.Row, 4)
      End If
      FPrice = FPrice + AddPrice
   Next I
   
   Sheets("Forge").Range("Price").Value = FPrice
End Sub
Sub UpdateName()
   Dim Prefix As String
   
   Prefix = ""
   Postfix = ""
   
   Select Case MatID
      Case 0
         Prefix = "Menos"
      Case 1
         Prefix = "Forse"
      Case 2
         Prefix = "Granz"
      Case 3
         Prefix = "Lora"
      Case 4
         Prefix = "Wndl"
      Case 5
         Prefix = "Vizel"
      Case 6
         Prefix = "Ishe"
      Case 7
         Prefix = "Rimar"
      Case 8
         Prefix = "Alte"
      Case 9
         Prefix = "Maia"
      Case 10 To 15
         Prefix = "Halc"
      Case 16
         Prefix = "Oak"
      Case 17
         Prefix = "Holly"
      Case 18
         Prefix = "Bao"
      Case 19
         Prefix = "Ebony"
      Case 20
         Prefix = "Maple"
      Case 21
         Prefix = "Dior"
      Case 22
         Prefix = "Ash"
      Case 23
         Prefix = "Foss"
      Case 24
         Prefix = "Marb"
      Case 25
         Prefix = "Sidia"
      Case 26
         Prefix = "Pedan"
      Case 27
         Prefix = "Tear"
      Case 28
         Prefix = "Hide"
      Case 29
         Prefix = "Gator"
      Case 30
         Prefix = "Taur"
      Case 31
         Prefix = "Wyver"
      Case 32
         Prefix = "Fish"
      Case 33
         Prefix = "Liza"
      Case 34
         Prefix = "Snake"
      Case 35
         Prefix = "Scale"
      Case 36
         Prefix = "Bone"
      Case 37
         Prefix = "Ivory"
      Case 38
         Prefix = "Curse"
      Case 39
         Prefix = "Stone"
      Case 40
         Prefix = "Cot"
      Case 41
         Prefix = "Silk"
      Case 42
         Prefix = "Hemp"
      Case 43
         Prefix = "Felt"
      Case 44
         Prefix = "Jacob"
      Case 45
         Prefix = "Aero"
      Case 46
         Prefix = "Ankh"
      Case 47
         Prefix = "Vinek"
      Case 48
         Prefix = "Tut"
      Case 49
         Prefix = "Nemes"
      Case 50
         Prefix = "Biel"
      Case 51
         Prefix = "Swift"
      Case 52
         Prefix = "Adam"
      Case 53
         Prefix = "Metal"
      Case 54
         Prefix = "Coral"
      Case 55
         Prefix = "Tort"
      Case 56
         Prefix = "Shell"
      Case 57 To 61
         Prefix = "Jewel"
      Case 62
         Prefix = "Pearl"
      Case 63
         Prefix = "Lapis"
   End Select
   
   Select Case TypID
      Case 0
         Postfix = "Knife"
      Case 1
         Postfix = "Sword"
      Case 2
         Postfix = "Axe"
      Case 3
         Postfix = "2HSword"
      Case 4
         Postfix = "2HAxe"
      Case 5
         Postfix = "Hammer"
      Case 6
         Postfix = "Spear"
      Case 7
         Postfix = "Staff"
      Case 8
         Postfix = "Glove"
      Case 9
         Postfix = "Flail"
      Case 10
         Postfix = "Bow"
      Case 11
         Postfix = "Shield"
      Case 12
         Postfix = "Helm"
      Case 13
         Postfix = "Hat"
      Case 14
         Postfix = "Hauberk"
      Case 15
         Postfix = "Robe"
      Case 16
         Postfix = "Gauntlet"
      Case 17
         Postfix = "Ring"
      Case 18
         Postfix = "Boots"
      Case 19
         Postfix = "Shoes"
      Case 20
         Postfix = "Armor"
      Case 21
         Postfix = "Mantle"
      Case 22
         Postfix = "Pendant"
   End Select
   
   Sheets("Forge").Range("Name") = Prefix + Postfix
End Sub
Sub UpdateSpecial()
   Dim Desc As String
   
   Sheets("Forge").Range("SpecialEffect").Cells(1, 1) = Special
   Select Case Special
      Case 0
         Desc = ": None"
      Case 1
         Desc = ": No Natural Healing"
      Case 2
         Desc = ": Sacrifice Phoenix to Auto-Heal at 0% HP"
      Case 3
         Desc = ": Exp Share"
      Case 4
         Desc = ": Natural Healing while Moving"
      Case 5
         Desc = ": Stare Immunity (?)"
      Case 6
         Desc = ": Half Revive Time"
      Case 8
         Desc = ": Natural Healing while Moving - No Revive"
      Case 9
         Desc = ": Extra Exp"
      Case 10
         Desc = ": Extra Lucre"
      Case Else
         Desc = ": Unknown"
   End Select
   
   Sheets("Forge").Range("SpecialEffect").Cells(1, 2) = Desc
End Sub
Sub SetPlungeAttack(Slot, Name)
   Sheets("Forge").Range("PlungeAttack").Cells(Slot, 1) = Name
End Sub
Function GetCard(Slot)
   GetCard = Sheets("Forge").Range("CardSlots").Cells(Slot, 1)
End Function
Sub SetCard(Slot, Val)
   Sheets("Forge").Range("CardSlots").Cells(Slot, 1) = Val
End Sub
Sub SetActiveWorld()
   Dim Val As Integer
      
   For I = 4 To 1 Step -1
      Val = GetCard(I)
      If Val < 16 Then
         ActWorld = Val
         Exit Sub
      End If
   Next I
   
   ActWorld = 15
End Sub
Sub ChangeAttStat(Num, Code)
   Temp = MAttStat(Num)
   
   Select Case Code
      Case 0
         Temp = Int(Temp / 2)
      Case 1
         Temp = Int(Temp / 4) * 3
      Case 2
         Temp = Int(Temp * 5 / 4)
      Case 3
         Temp = Int(Temp * 3 / 2)
   End Select
   
   If Temp > 255 Then
      Temp = 255
   End If
   
   MAttStat(Num) = Temp
End Sub
Sub ChangeDefStat(Num, Code)
   Temp = MDefStat(Num)
   
   Select Case Code
      Case 0
         Temp = Int(Temp / 2)
      Case 1
         Temp = Int(Temp / 4) * 3
      Case 2
         Temp = Int(Temp * 5 / 4)
      Case 3
         Temp = Int(Temp * 3 / 2)
   End Select
   
   If Temp > 255 Then
      Temp = 255
   End If
   
   MDefStat(Num) = Temp
End Sub
Sub SetAttMark(Req)
   For I = 0 To 7
      If GetEssense(I) >= Req Then
         Sheets("Forge").Range("EssMarkers").Cells(1, I + 1) = "X"
      Else
         Sheets("Forge").Range("EssMarkers").Cells(1, I + 1) = "_"
      End If
   Next I
End Sub
Sub SetDefMark(Req)
   If GetEssense(0) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 2) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 2) = "_"
   End If
   If GetEssense(1) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 1) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 1) = "_"
   End If
   If GetEssense(2) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 4) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 4) = "_"
   End If
   If GetEssense(3) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 3) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 3) = "_"
   End If
   If GetEssense(4) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 6) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 6) = "_"
   End If
   If GetEssense(5) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 7) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 7) = "_"
   End If
   If GetEssense(6) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 8) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 8) = "_"
   End If
   If GetEssense(7) >= Req Then
      Sheets("Forge").Range("EssMarkers").Cells(1, 5) = "X"
   Else
      Sheets("Forge").Range("EssMarkers").Cells(1, 5) = "_"
   End If
End Sub
Sub ClearImmunity()
   If TypID <= 10 Then
      Sheets("Forge").Range("Immunity").ClearContents
   Else
      For I = 1 To 8
         Sheets("Forge").Range("Immunity").Cells(1, I) = "_"
      Next I
   End If
End Sub
Sub SetImmunity(Num)
   Sheets("Forge").Range("Immunity").Cells(1, Num + 1) = "X"
End Sub
Sub PushCards()
   Dim Dest(4)
   Dim Card(4)
   Card(0) = PreCard
   Card(1) = GetCard(1)
   Card(2) = GetCard(2)
   Card(3) = GetCard(3)
   Card(4) = GetCard(4)
   
   For I = 0 To 4
      Dest(I) = I
   Next I
   If Card(0) <> 255 Then
      Dest(0) = 1
      If Card(1) <> 255 Then
         Dest(1) = 2
         If Card(2) <> 255 Then
            Dest(2) = 3
            If Card(3) <> 255 Then
               Dest(3) = 4
               If Card(4) <> 255 Then
                  Dest(4) = 5
               End If
            End If
         End If
      End If
   End If
   
   If PixieStick Then
      If Card(4) >= 81 And Card(4) <= 87 Then
         Dest(4) = 4
         If Card(3) >= 81 And Card(3) <= 87 Then
            Dest(3) = 3
            If Card(2) >= 81 And Card(2) <= 87 Then
               Dest(2) = 2
               If Card(1) >= 81 And Card(1) <= 87 Then
                  Dest(1) = 1
               Else
                  If Card(1) <> 255 And Dest(1) > 1 Then
                     Dest(1) = 5
                  End If
               End If
            Else
               If Card(2) <> 255 And Dest(2) > 2 Then
                  Dest(2) = 5
               End If
            End If
         Else
            If Card(3) <> 255 And Dest(3) > 3 Then
               Dest(3) = 5
            End If
         End If
      End If
   End If
   
   For I = 4 To 0 Step -1
      Select Case Dest(I)
         Case 0
            PreCard = Card(I)
         Case 1
            SetCard 1, Card(I)
         Case 2
            SetCard 2, Card(I)
         Case 3
            SetCard 3, Card(I)
         Case 4
            SetCard 4, Card(I)
         Case 5
            PostCard = Card(I)
      End Select
   Next I
End Sub
Function FindCard(Num)
   Dim Val As Integer
   
   If PreCard = Num Then
      FindCard = 0
      Exit Function
   End If
   
   For I = 1 To 4
      Val = GetCard(I)
      If Val = Num Then
         FindCard = I
         Exit Function
      End If
   Next I
   
   If PostCard = Num Then
      FindCard = 5
   Else
      FindCard = 6
   End If
End Function
Sub ReplaceTopCard(C1, C2)
   Dim Val As Integer
   
   If PostCard = C1 Then
      PostCard = C2
      Exit Sub
   End If
   
   For I = 4 To 1 Step -1
      Val = GetCard(I)
      If Val = C1 Then
         SetCard I, C2
         Exit Sub
      End If
   Next I
   
   If PreCard = C1 Then
      PreCard = C2
   End If
End Sub
Function GetEssense(Ess)
   GetEssense = Range("ElmLevels").Cells(1, Ess + 1)
End Function
Function GetTotalEss()
   Dim Total As Integer
   
   Total = 0
   For I = 0 To 7
      Total = Total + GetEssense(I)
   Next I
   'Strange Command: 80 31 88 7B 80 00 71
   
   GetTotalEss = Total
End Function
Sub SetEssense(Ess, Val)
   Range("ElmLevels").Cells(1, Ess + 1) = Val
End Sub
Sub CommentEssense(Ess)
   Dim Cmmt As String
   Dim Base As Long
   Dim EReq(3) As String
   Dim WizID, WizCount, Res
   
   With Sheets("Materials")
      Material = .Columns("B:B").Find(what:=Range("Material"), LookAt:=xlWhole).Row
      Res = .Cells(Material, 13 + Ess)
   End With
   
   Base = 2 ^ GetEssense(Ess)
   For I = 0 To 3
      EReq(I) = CStr(Res * Base)
      Res = Int(Res / 4) * 3
      If Res = 0 Then Res = 1
   Next I
   
   Select Case Ess
      Case 0, 2, 4, 5
         WizID = 136
      Case Else
         WizID = 137
   End Select
   
   WizCount = 0
   
   For I = 2 To 4
      If GetCard(I) = WizID Then WizCount = WizCount + 1
   Next I
   
   EReq(WizCount) = " _" + EReq(WizCount) + "_ "
   
   Cmmt = Trim(EReq(0) + "/" + EReq(1) + "/" + EReq(2) + "/" + EReq(3) + " Energy Required")
   
   With Range("ElmLevels").Cells(1, Ess + 1)
      .Comment.Text Cmmt
   End With
End Sub
Sub IncEssense(Ess)
   Dim Val As Integer
   Dim EReq As Long
   
   Val = GetEssense(Ess)
   EReq = ElmRes(Ess) * (2 ^ Val)
   If Val < 15 And Energy >= EReq Then
      Energy = Energy - EReq
      SetEssense Ess, Val + 1
   End If
End Sub
Sub DecEssense(Ess)
   Dim Val As Integer
   
   Val = GetEssense(Ess) - 1
   If Val >= 0 Then
      Energy = Energy + (ElmRes(Ess) * (2 ^ Val))
      SetEssense Ess, Val
   End If
End Sub
Sub IncreaseStat(Num)
   Dim Val As Integer
   
   Val = Stat(Num) + 1
   Select Case Val
      Case -9 To -6
         Val = -5
      Case -4
         Val = -3
      Case -2
         Val = -1
      Case 6
         Val = 7
      Case 8
         Val = 9
      Case 11
         Val = 12
      Case 13 To 14
         Val = 15
      Case 16 To 21
         Val = 20
      Case Else
         Val = Val
   End Select
   Stat(Num) = Val
End Sub
Sub DecreaseStat(Num)
   Dim Val As Integer
   
   Val = Stat(Num) - 1
   Select Case Val
      Case -11 To -6
         Val = -10
      Case -4
         Val = -5
      Case -2
         Val = -3
      Case 6
         Val = 5
      Case 8
         Val = 7
      Case 11
         Val = 10
      Case 13 To 14
         Val = 12
      Case 16 To 19
         Val = 15
      Case Else
         Val = Val
   End Select
   Stat(Num) = Val
End Sub
Sub SetStatLim(Num, Val)
   If StatLim(Num) < Val Then
      StatLim(Num) = Val
   End If
End Sub
Sub ElemTaint(Ess)
   Dim Conflict As Integer
      
   Conflict = 0
   
   Select Case Ess
      Case 0
         If ActWorld = 2 Then
            Conflict = GetEssense(1)
         End If
         If Conflict = 0 And Energy >= 8 Then
            IncEssense 0
         End If
         If ActWorld <> 1 Then
            If ActWorld <> 2 Then
               If GetEssense(0) > GetEssense(1) Then
                  While GetEssense(1) > 0
                     DecEssense 1
                  Wend
               End If
            Else
               If GetEssense(1) > GetEssense(0) Then
                  While GetEssense(0) > 0
                     DecEssense 0
                  Wend
               End If
            End If
         End If
      Case 1
         If ActWorld <> 2 Then
            If ActWorld <> 1 Then
               Conflict = GetEssense(0)
            End If
         End If
         If Conflict = 0 And Energy >= 8 Then
            IncEssense 1
         End If
         If ActWorld <> 1 Then
            If ActWorld <> 2 Then
               If GetEssense(0) > GetEssense(1) Then
                  While GetEssense(1) > 0
                     DecEssense 1
                  Wend
               End If
            Else
               If GetEssense(1) > GetEssense(0) Then
                  While GetEssense(0) > 0
                     DecEssense 0
                  Wend
               End If
            End If
         End If
      Case 2
         If ActWorld <> 1 Then
            If ActWorld <> 2 Then
               If GetEssense(1) > GetEssense(0) Then
                  Conflict = GetEssense(3)
               End If
            Else
               If GetEssense(0) > GetEssense(1) Then
                  Conflict = GetEssense(3)
               End If
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If GetEssense(0) > GetEssense(1) Then
                     If Energy >= 4 Then
                        DecEssense 3
                     End If
                  End If
               Else
                  If GetEssense(1) > GetEssense(0) Then
                     If Energy >= 4 Then
                        DecEssense 3
                     End If
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(2) = ElmInc(2) + 1
            End If
         End If
      Case 3
         If ActWorld <> 1 Then
            If ActWorld <> 2 Then
               If GetEssense(0) > GetEssense(1) Then
                  Conflict = GetEssense(2)
               End If
            Else
               If GetEssense(1) > GetEssense(0) Then
                  Conflict = GetEssense(2)
               End If
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If GetEssense(1) > GetEssense(0) Then
                     If Energy >= 4 Then
                        DecEssense 2
                     End If
                  End If
               Else
                  If GetEssense(0) > GetEssense(1) Then
                     If Energy >= 4 Then
                        DecEssense 2
                     End If
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(3) = ElmInc(3) + 1
            End If
         End If
      Case 4
         If ActWorld <> 1 Then
            If ActWorld = 2 Then
               Conflict = GetEssense(5)
            Else
               Conflict = GetEssense(7)
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If Energy >= 4 Then
                     DecEssense 5
                  End If
               Else
                  If Energy >= 4 Then
                     DecEssense 7
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(4) = ElmInc(4) + 1
            End If
         End If
      Case 5
         If ActWorld <> 1 Then
            If ActWorld = 2 Then
               Conflict = GetEssense(6)
            Else
               Conflict = GetEssense(4)
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If Energy >= 4 Then
                     DecEssense 6
                  End If
               Else
                  If Energy >= 4 Then
                     DecEssense 4
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(5) = ElmInc(5) + 1
            End If
         End If
      Case 6
         If ActWorld <> 1 Then
            If ActWorld = 2 Then
               Conflict = GetEssense(7)
            Else
               Conflict = GetEssense(5)
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If Energy >= 4 Then
                     DecEssense 7
                  End If
               Else
                  If Energy >= 4 Then
                     DecEssense 5
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(6) = ElmInc(6) + 1
            End If
         End If
      Case 7
         If ActWorld <> 1 Then
            If ActWorld = 2 Then
               Conflict = GetEssense(4)
            Else
               Conflict = GetEssense(6)
            End If
         End If
         If Conflict = 0 Then
            If ActWorld <> 1 Then
               If ActWorld <> 2 Then
                  If Energy >= 4 Then
                     DecEssense 4
                  End If
               Else
                  If Energy >= 4 Then
                     DecEssense 6
                  End If
               End If
            End If
            If Energy >= 8 Then
               ElmInc(7) = ElmInc(7) + 1
            End If
         End If
   End Select
End Sub
Function GetName(Code)
   Dim CRow As Integer
   CRow = Sheets("Cards").Columns("A:A").Find(what:=Code, LookAt:=xlWhole).Row
   GetName = Range("Cards").Cells(CRow - 1, 2)
End Function
Sub CardCode(Item)
   Select Case Item
      Case "Wisp - 1", "Wisp - 2", "Wisp - 3"
         IncreaseStat 6
         ElemTaint 0
      Case "Shade - 1", "Shade - 2", "Shade - 3"
         IncreaseStat 5
         ElemTaint 1
      Case "Dryad - 1", "Dryad - 2", "Dryad - 3"
         IncreaseStat 4
         ElemTaint 2
      Case "Aura - 1", "Aura - 2", "Aura - 3"
         IncreaseStat 7
         ElemTaint 3
      Case "Salamander - 1", "Salamander - 2", "Salamander - 3"
         IncreaseStat 0
         ElemTaint 4
      Case "Gnome - 1", "Gnome - 2", "Gnome - 3"
         IncreaseStat 2
         ElemTaint 5
      Case "Jinn - 1", "Jinn - 2", "Jinn - 3"
         IncreaseStat 1
         ElemTaint 6
      Case "Undine - 1", "Undine - 2", "Undine - 3"
         IncreaseStat 3
         ElemTaint 7
      Case "Pixie(1) - 1", "Pixie(1) - 2", "Pixie(1) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 81, 44
            End If
            CardCode "Fallen Angel - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 6
         End If
      Case "Pixie(2) - 1", "Pixie(2) - 2", "Pixie(2) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 82, 45
            End If
            CardCode "Witch of Moon - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 3
         End If
      Case "Pixie(3) - 1", "Pixie(3) - 2", "Pixie(3) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 83, 46
            End If
            CardCode "Lord of Flies - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 1
         End If
      Case "Pixie(4) - 1", "Pixie(4) - 2", "Pixie(4) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 84, 47
            End If
            CardCode "Wings of Darkness - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 5
         End If
      Case "Pixie(5) - 1", "Pixie(5) - 2", "Pixie(5) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 85, 48
            End If
            CardCode "God of Destruction - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 0
         End If
      Case "Pixie(6) - 1", "Pixie(6) - 2", "Pixie(6) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 86, 50
            End If
            CardCode "Leviathan - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 4
         End If
      Case "Pixie(7) - 1", "Pixie(7) - 2", "Pixie(7) - 3"
         If ActWorld = 14 Then
            If Energy >= 8 Then
               ReplaceTopCard 87, 49
            End If
            CardCode "Beast-headed God - 1"
         Else
            For I = 0 To 7
               SetStatLim I, 1
               DecreaseStat I
            Next I
            IncreaseStat 2
         End If
      Case "Sorcerer - 1", "Sorcerer - 2", "Sorcerer - 3"
         I = FindCard(18)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 2
            Next I
            IncreaseStat 3
            IncreaseStat 5
            IncreaseStat 6
            ElmRes(0) = Int(ElmRes(0) / 2)
            If ElmRes(0) = 0 Then ElmRes(0) = 1
            ElmRes(2) = Int(ElmRes(2) / 2)
            If ElmRes(2) = 0 Then ElmRes(2) = 1
            ElmRes(4) = Int(ElmRes(4) / 2)
            If ElmRes(4) = 0 Then ElmRes(4) = 1
            ElmRes(5) = Int(ElmRes(5) / 2)
            If ElmRes(5) = 0 Then ElmRes(5) = 1
         Else
            For I = 0 To 7
               SetStatLim I, 1
            Next I
            IncreaseStat 3
            ElmRes(0) = Int(ElmRes(0) / 4) * 3
            If ElmRes(0) = 0 Then ElmRes(0) = 1
            ElmRes(2) = Int(ElmRes(2) / 4) * 3
            If ElmRes(2) = 0 Then ElmRes(2) = 1
            ElmRes(4) = Int(ElmRes(4) / 4) * 3
            If ElmRes(4) = 0 Then ElmRes(4) = 1
            ElmRes(5) = Int(ElmRes(5) / 4) * 3
            If ElmRes(5) = 0 Then ElmRes(5) = 1
         End If
      Case "Witch - 1", "Witch - 2", "Witch - 3"
         I = FindCard(18)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 2
            Next I
            IncreaseStat 3
            IncreaseStat 5
            IncreaseStat 6
            ElmRes(1) = Int(ElmRes(1) / 2)
            If ElmRes(1) = 0 Then ElmRes(1) = 1
            ElmRes(3) = Int(ElmRes(3) / 2)
            If ElmRes(3) = 0 Then ElmRes(3) = 1
            ElmRes(6) = Int(ElmRes(6) / 2)
            If ElmRes(6) = 0 Then ElmRes(6) = 1
            ElmRes(7) = Int(ElmRes(7) / 2)
            If ElmRes(7) = 0 Then ElmRes(7) = 1
         Else
            For I = 0 To 7
               SetStatLim I, 1
            Next I
            IncreaseStat 3
            ElmRes(1) = Int(ElmRes(1) / 4) * 3
            If ElmRes(1) = 0 Then ElmRes(1) = 1
            ElmRes(3) = Int(ElmRes(3) / 4) * 3
            If ElmRes(3) = 0 Then ElmRes(3) = 1
            ElmRes(6) = Int(ElmRes(6) / 4) * 3
            If ElmRes(6) = 0 Then ElmRes(6) = 1
            ElmRes(7) = Int(ElmRes(7) / 4) * 3
            If ElmRes(7) = 0 Then ElmRes(7) = 1
         End If
      Case "King - 1", "King - 2", "King - 3"
         I = FindCard(17)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 2
            Next I
            IncreaseStat 0
         Else
            For I = 0 To 7
               SetStatLim I, 1
            Next I
            IncreaseStat 0
         End If
         If TypID = 8 And GetEssense(3) > 0 Then
            SetPlungeAttack 2, "Hand of Midas"
         End If
      Case "Princess - 1", "Princess - 2", "Princess - 3"
         I = FindCard(17)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 2
            Next I
            IncreaseStat 2
         Else
            For I = 0 To 7
               SetStatLim I, 1
            Next I
            IncreaseStat 2
         End If
      Case "Clown - 1", "Clown - 2", "Clown - 3"
         I = FindCard(17)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 5
            Next I
         Else
            For I = 0 To 7
               SetStatLim I, 3
            Next I
         End If
         If TypID <= 10 Then
            ChangeAttStat 0, 3
            ChangeAttStat 1, 0
            If TypID = 0 Then
               SetPlungeAttack 2, "Quick Blade"
            End If
         Else
            ChangeDefStat 2, 3
            ChangeDefStat 0, 0
         End If
      Case "Cleric - 1", "Cleric - 2", "Cleric - 3"
         I = FindCard(17)
         If I >= 2 And I <= 4 Then
            For I = 0 To 7
               SetStatLim I, 2
            Next I
            IncreaseStat 3
            IncreaseStat 5
            IncreaseStat 6
         Else
            For I = 0 To 7
               SetStatLim I, 1
            Next I
            IncreaseStat 5
         End If
         If TypID <= 10 Then
            ChangeAttStat 0, 0
            ChangeAttStat 1, 3
            If TypID = 7 Then
               SetPlungeAttack 2, "Demonicide"
            End If
         Else
            ChangeDefStat 0, 3
            ChangeDefStat 1, 0
         End If
      Case "Ruler of Sky - 1", "Ruler of Sky - 2", "Ruler of Sky - 3"
         SetStatLim 0, 3
         SetStatLim 3, 3
         StatMin(0) = 9
         StatMin(3) = 9
         If TypID = 6 Then
            SetPlungeAttack 1, "Gungnir"
         Else
            If TypID = 7 Then
               SetPlungeAttack 3, "Electrosceptre"
            End If
         End If
      Case "Mother of Gods - 1", "Mother of Gods - 2", "Mother of Gods - 3"
         SetStatLim 3, 2
         SetStatLim 5, 2
         SetStatLim 6, 2
         StatMin(3) = 5
         StatMin(5) = 5
         StatMin(6) = 5
         If TypID = 9 Then
            SetPlungeAttack 1, "Green Princess"
            SetPlungeAttack 2, "Game of Death"
            SetPlungeAttack 3, "Red Dream"
         End If
      Case "Sun God - 1", "Sun God - 2", "Sun God - 3"
         SetStatLim 6, 4
         StatMin(6) = 10
         If TypID = 1 Then
            SetPlungeAttack 2, "Sunlight"
         Else
            If TypID = 10 Then
               SetPlungeAttack 1, "Solar Flare"
            End If
         End If
      Case "Moon Goddess - 1", "Moon Goddess - 2", "Moon Goddess - 3"
         SetStatLim 5, 4
         StatMin(5) = 10
         If TypID = 1 Then
            SetPlungeAttack 3, "Moonlight"
         Else
            If TypID = 10 Then
               SetPlungeAttack 2, "Lunar Shot"
            End If
         End If
      Case "Thunder God - 1", "Thunder God - 2", "Thunder God - 3"
         SetStatLim 0, 2
         SetStatLim 1, 2
         SetStatLim 2, 2
         StatMin(0) = 5
         StatMin(1) = 5
         StatMin(2) = 5
         If TypID = 5 Then
            SetPlungeAttack 3, "Mjolnir"
         End If
      Case "Goddess of Love - 1", "Goddess of Love - 2", "Goddess of Love - 3"
         SetStatLim 5, 3
         SetStatLim 6, 3
         StatMin(5) = 7
         StatMin(6) = 7
         If TypID = 22 Then
            Special = 10
         End If
      Case "Fertility Goddess - 1", "Fertility Goddess - 2", "Fertility Goddess - 3"
         SetStatLim 4, 4
         StatMin(4) = 10
         If TypID >= 11 Then
            SetImmunity 6
            If TypID = 15 Then
               SetImmunity 6
            Else
               If TypID = 17 Then
                  Special = 3
               End If
            End If
         End If
      Case "Ocean God - 1", "Ocean God - 2", "Ocean God - 3"
         SetStatLim 0, 3
         SetStatLim 1, 3
         StatMin(0) = 7
         StatMin(1) = 7
         If TypID <= 10 Then
            If TypID = 6 Then
               SetPlungeAttack 1, "Trident"
            End If
         Else
            SetImmunity 4
         End If
      Case "Wind God - 1", "Wind God - 2", "Wind God - 3"
         SetStatLim 1, 4
         StatMin(1) = 10
         If TypID = 7 Then
            'Strange Command 80 81 88 7D 80
            SetPlungeAttack 1, "Caduceus"
         End If
         If TypID = 19 Then
            MDefStat(0) = MDefStat(0) + 10
            MDefStat(1) = MDefStat(1) + 10
            MDefStat(2) = MDefStat(2) + 10
            MDefStat(3) = MDefStat(3) + 10
            SetImmunity 2
         End If
      Case "Wisdom Goddess - 1", "Wisdom Goddess - 2", "Wisdom Goddess - 3"
         SetStatLim 3, 4
         StatMin(3) = 10
         If TypID = 11 Then
            Special = 5
         End If
      Case "Blacksmith God - 1", "Blacksmith God - 2", "Blacksmith God - 3"
         SetStatLim 2, 4
         StatMin(2) = 10
         If TypID = 5 Then
            SetPlungeAttack 1, "Sledge Hammer"
         End If
      Case "God of War - 1", "God of War - 2", "God of War - 3"
         SetStatLim 0, 4
         StatMin(0) = 10
         If TypID = 2 Then
            SetPlungeAttack 1, "Dragonslayer"
         End If
      Case "Fallen Angel - 1", "Fallen Angel - 2", "Fallen Angel - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(6) = 15
         If TypID = 3 Then
            SetPlungeAttack 1, "Chaotic Avenger"
         End If
      Case "Fallen Angel - 4"
         ReplaceTopCard 62, 44
      Case "Witch of Moon - 1", "Witch of Moon - 2", "Witch of Moon - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(3) = 15
         If TypID = 1 Then
            SetPlungeAttack 2, "Vampsword"
         End If
      Case "Witch of Moon - 4"
         ReplaceTopCard 62, 45
      Case "Lord of Flies - 1", "Lord of Flies - 2", "Lord of Flies - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(1) = 15
         If TypID = 0 Then
            SetPlungeAttack 3, "Sinister Blade"
         End If
      Case "Lord of Flies - 4"
         ReplaceTopCard 62, 46
      Case "Wings of Darkness - 1", "Wings of Darkness - 2", "Wings of Darkness - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(5) = 15
         If TypID = 7 Then
            SetPlungeAttack 3, "Golden Touch"
         End If
      Case "Wings of Darkness - 4"
         ReplaceTopCard 62, 47
      Case "God of Destruction - 1", "God of Destruction - 2", "God of Destruction - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(0) = 15
         If TypID = 1 Then
            SetPlungeAttack 2, "Flame Tongue"
         Else
            If TypID >= 11 Then
               SetImmunity 7
            End If
         End If
      Case "God of Destruction - 4"
         ReplaceTopCard 62, 48
      Case "Beast-headed God - 1", "Beast-headed God - 2", "Beast-headed God - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(4) = 15
         If TypID = 0 Then
            SetPlungeAttack 2, "Poison Blade"
         End If
      Case "Beast-headed God - 4"
         ReplaceTopCard 62, 49
      Case "Leviathan - 1", "Leviathan - 2", "Leviathan - 3"
         For I = 0 To 7
            SetStatLim I, 7
            DecreaseStat I
         Next I
         StatMin(2) = 15
         If TypID = 4 Then
            SetPlungeAttack 1, "Treefeller"
         End If
      Case "Leviathan - 4"
         ReplaceTopCard 62, 50
      Case "Phoenix - 1", "Phoenix - 2", "Phoenix - 3"
         SetStatLim 0, 2
         SetStatLim 1, 2
         StatMin(0) = 3
         StatMin(1) = 3
         I = FindCard(16)
         If I >= 2 And I <= 4 Then
            If TypID = 17 Or TypID = 22 Then
               Special = 2
            End If
         End If
      Case "Unicorn - 1", "Unicorn - 2", "Unicorn - 3"
         SetStatLim 2, 2
         SetStatLim 3, 2
         StatMin(2) = 3
         StatMin(3) = 3
         I = FindCard(19)
         If I >= 2 And I <= 4 Then
            If TypID = 17 Or TypID = 22 Then
               Special = 6
            End If
         End If
      
      Case "Spirit(1) - 1", "Spirit(1) - 2", "Spirit(1) - 3"
         IncreaseStat 6
         If TypID = 13 Then
            SetImmunity 3
         End If
      Case "Spirit(2) - 1", "Spirit(2) - 2", "Spirit(2) - 3"
         IncreaseStat 5
         IncreaseStat 6
         If TypID = 10 Then
            SetPlungeAttack 2, "Elven Archer"
         End If
      Case "Spirit(3) - 1", "Spirit(3) - 2", "Spirit(3) - 3"
         IncreaseStat 2
         IncreaseStat 4
         If TypID = 5 Then
            SetPlungeAttack 3, "Quake Hammer"
         End If
      Case "Spirit(4) - 1", "Spirit(4) - 2", "Spirit(4) - 3"
         IncreaseStat 1
         If TypID = 18 Then
            SetImmunity 2
         Else
            If TypID = 19 Then
               Special = 9
            End If
         End If
      Case "Spirit(5) - 1", "Spirit(5) - 2", "Spirit(5) - 3"
         IncreaseStat 7
         If TypID = 17 Then
            Special = 10
         Else
            If TypID = 21 Then
               SetImmunity 5
            End If
         End If
      Case "Yggdrasil - 1", "Yggdrasil - 2", "Yggdrasil - 3"
         If TypID = 7 Then
            For I = 0 To 7
               SetStatLim I, 3
            Next I
         Else
            For I = 0 To 7
               SetStatLim I, 4
            Next I
         End If
         For I = 0 To 7
            IncreaseStat I
         Next I
      Case "Heaven's Scale - 1", "Heaven's Scale - 2", "Heaven's Scale - 3"
         If TypID >= 11 Then
            Special = 8
         End If
      Case "Dying Earth - 1", "Dying Earth - 2", "Dying Earth - 3"
         For I = 0 To 7
            SetStatLim I, 5
         Next I
         I = FindCard(63)
         If I < 2 Or I > 4 Then
            For I = 0 To 7
               DecreaseStat I
            Next I
         End If
      Case "Ragnarok - 1", "Ragnarok - 2", "Ragnarok - 3"
         I = FindCard(3) 'Useless command, but it's in the code and I can't figure out why
         If TypID = 3 Then
            SetPlungeAttack 3, "Ragnarok"
         End If
      Case "Yggdrasil - 0", "Ancient Moon - 0", "Mirrored World - 0", "Heaven's Scale - 0", "Dying Earth - 0", "Ragnarok - 0"
         If ActWorld <= 14 Then
            SetCard 1, 255
         End If
      Case "Bed of Thorn - 1", "Bed of Thorn - 2", "Bed of Thorn - 3"
         For I = 0 To 7
            SetStatLim I, 1
         Next I
         If TypID >= 11 Then
            Special = 1
            ChangeDefStat 0, 3
            ChangeDefStat 1, 3
            ChangeDefStat 2, 3
            ChangeDefStat 3, 3
         End If
      Case "Volcano - 1", "Volcano - 2", "Volcano - 3"
         If TypID <= 10 Then
            ChangeAttStat 2, 3
            ChangeAttStat 3, 0
            If TypID = 5 Then
               SetPlungeAttack 3, "Magma Hammer"
            End If
         Else
            If TypID = 14 Then
               SetImmunity 7
            End If
         End If
      Case "Metropolis - 1", "Metropolis - 2", "Metropolis - 3"
         If TypID >= 11 Then
            If TypID = 15 Then
               ChangeDefStat 3, 3
               SetImmunity 3
            Else
               ChangeDefStat 3, 2
            End If
         End If
      Case "Tower - 1", "Tower - 2", "Tower - 3"
         For I = 0 To 7
            SetStatLim I, 2
         Next I
      Case "Spring - 1", "Spring - 2", "Spring - 3"
         For I = 0 To 7
            SetStatLim I, 2
         Next I
         If TypID = 15 Then
            SetImmunity 4
         Else
            If TypID = 22 Then
               SetImmunity 5
            End If
         End If
      Case "Sacrificed Nymph - 1", "Sacrificed Nymph - 2", "Sacrificed Nymph - 3"
         If TypID = 22 Then
            SetImmunity 6
         End If
      Case "Nymph of the Sky - 1", "Nymph of the Sky - 2", "Nymph of the Sky - 3"
         If TypID = 21 Then
            Special = 4
         End If
      Case "Nymph of Orchards - 1", "Nymph of Orchards - 2", "Nymph of Orchards - 3"
         If TypID = 17 Then
            Special = 6
         End If
      Case "Sage - 1", "Sage - 2", "Sage - 3"
         For I = 0 To 7
            SetStatLim I, 2
         Next I
         IncreaseStat 3
         IncreaseStat 2
         If TypID = 10 Then
            SetPlungeAttack 1, "Phoenix Falling"
         End If
      Case "Man of Valour - 1", "Man of Valour - 2", "Man of Valour - 3"
         For I = 0 To 7
            SetStatLim I, 2
         Next I
         IncreaseStat 0
         IncreaseStat 4
         If TypID = 6 Then
            SetPlungeAttack 1, "Spear of Light"
         End If
      Case "Wanderer - 1", "Wanderer - 2", "Wanderer - 3"
         For I = 0 To 7
            SetStatLim I, 2
         Next I
         IncreaseStat 1
         IncreaseStat 5
         If TypID = 2 Then
            SetPlungeAttack 1, "Woodchopper"
         End If
      Case "Nymph of Dawn - 2", "Nymph of Dawn - 3"
         If Energy <= 24 Then
            Energy = Energy + 192
            ReplaceTopCard 66, 255
         End If
      Case "Nymph of Dawn - 4"
         Energy = Energy + 192
      Case "Raven - 1", "Raven - 2", "Raven - 3"
         SetStatLim 3, 2
         SetStatLim 6, 2
         StatMin(3) = 3
         StatMin(6) = 3
      Case "Wolf - 1", "Wolf - 2", "Wolf - 3"
         SetStatLim 1, 2
         SetStatLim 4, 2
         StatMin(1) = 3
         StatMin(4) = 3
      Case Else
   End Select
End Sub
Sub ItemCode(Item)
   Select Case Item
      Case "Wisp Gold", "Wisp Silver"
         ElemTaint 0
         If Energy >= 8 Then
            PreCard = 96
         End If
      Case "Shade Gold", "Shade Silver"
         ElemTaint 1
         If Energy >= 8 Then
            PreCard = 97
         End If
      Case "Dryad Gold", "Dryad Silver"
         ElemTaint 2
         If Energy >= 8 Then
            PreCard = 98
         End If
      Case "Aura Gold", "Aura Silver"
         ElemTaint 3
         If Energy >= 8 Then
            PreCard = 99
         End If
      Case "Sala Gold", "Sala Silver", "Firestone"
         ElemTaint 4
         If Energy >= 8 Then
            PreCard = 100
         End If
      Case "Gnome Gold", "Gnome Silver", "Earthstone"
         ElemTaint 5
         If Energy >= 8 Then
            PreCard = 101
         End If
      Case "Jinn Gold", "Jinn Silver", "Windstone"
         ElemTaint 6
         If Energy >= 8 Then
            PreCard = 102
         End If
      Case "Undine Gold", "Undine Silver", "Waterstone"
         ElemTaint 7
         If Energy >= 8 Then
            PreCard = 103
         End If
      Case "Sun Crystal"
         If GetEssense(0) >= 3 And GetTotalEss() >= 5 And Energy >= 8 Then
            PreCard = 34
         End If
         ElemTaint 0
      Case "Moon Crystal"
         If GetEssense(1) >= 3 And GetTotalEss() >= 5 Then
            PreCard = 35
         End If
         ElemTaint 1
      Case "Glow Crystal"
         If Energy >= 8 Then
            PreCard = 66
         End If
      Case "Chaos Crystal"
         If Energy >= 8 Then
            PreCard = 1
         End If
      Case "Round Seed", "Oblong Seed", "Crooked Seed", "Big Seed", "Small Seed", "Long Seed", "Flat Seed"
         ElemTaint 2
         If Energy >= 8 Then
            PreCard = 98
         End If
      Case "Spiny Seed"
         If GetEssense(2) >= 5 And Energy >= 8 Then
            PreCard = 0
         End If
         ElemTaint 2
      Case "Bellgrapes"
         SetStatLim 3, 4
         IncreaseStat 3
      Case "Diceberry"
         If GetEssense(6) >= 3 And GetTotalEss() >= 5 Then
            PreCard = 40
         End If
         IncreaseStat 7
      Case "Mangolephant"
         SetStatLim 4, 4
         IncreaseStat 4
      Case "Loquat-Shoes", "Pear o'Heels"
         If Energy >= 16 Then
            PreCard = 79
         End If
         If TypID = 18 Or TypID = 19 Then
            ChangeDefStat 0, 2
            ChangeDefStat 1, 2
            ChangeDefStat 2, 2
         End If
      Case "Squalphin"
         If GetEssense(7) >= 3 And GetTotalEss() >= 5 And Energy >= 8 Then
            PreCard = 39
         End If
         ElemTaint 7
      Case "Citrisquid"
         If TypID <= 10 Then
            ChangeAttStat 0, 1
            ChangeAttStat 1, 2
         Else
            ChangeDefStat 1, 1
            ChangeDefStat 0, 2
         End If
      Case "Springanana"
         If Energy >= 8 Then
            PreCard = 3
         End If
      Case "Peach Puppy"
         If Energy >= 8 Then
            PreCard = 114
         End If
         If TypID <= 10 Then
            ChangeAttStat 0, 2
            ChangeAttStat 1, 1
         End If
      Case "Apricat"
         If TypID <= 10 Then
            ChangeAttStat 2, 1
            ChangeAttStat 3, 2
         End If
      Case "Applesocks"
         SetStatLim 1, 4
         IncreaseStat 1
         If GetTotalEss() >= 5 And Energy >= 16 Then
            PreCard = 65
         End If
      Case "Whalamato"
         SetStatLim 4, 4
         StatMin(4) = 10
         If GetEssense(5) >= 3 And GetEssense(7) >= 3 And Energy >= 8 Then
            PreCard = 95
         End If
      Case "Pine o'Clock"
         If TypID >= 11 Then
            ClearImmunity
            SetImmunity 5
         End If
         'Strange Command 80 81 88 7B 80
         If GetEssense(4) >= 1 And GetEssense(5) >= 1 And GetEssense(6) >= 1 And GetEssense(7) >= 1 And Energy >= 8 Then
            'Strange Command 80 81 88 7C 80
            PreCard = 14
         End If
      Case "Fishy Fruit"
         PreCard = 19
         SetStatLim 3, 1
         IncreaseStat 3
         ElemTaint 7
      Case "Boarmelon"
         SetStatLim 0, 1
         IncreaseStat 0
      Case "Rhinoloupe"
         If TypID <= 10 Then
            ChangeAttStat 0, 2
         Else
            ClearImmunity
            SetImmunity 0
         End If
      Case "Orcaplant"
         If GetEssense(7) >= 3 And GetTotalEss() >= 5 And Energy >= 8 Then
            PreCard = 39
         End If
      Case "Garlicrown"
         If Energy >= 8 Then
            PreCard = 138
         End If
         PixieStick = False
         ElemTaint 3
      Case "Honey Onion"
         If Energy >= 8 Then
            PreCard = 139
         End If
         ElemTaint 2
      Case "Sweet Moai"
         If TypID = 12 Then
            ChangeDefStat 0, 2
            ChangeDefStat 1, 2
            ChangeDefStat 2, 2
         Else
            If TypID = 13 Then
               ChangeDefStat 0, 3
               ChangeDefStat 1, 3
               ChangeDefStat 2, 3
            End If
         End If
      Case "Spiny Carrot"
         If TypID <= 10 Then
            ChangeAttStat 0, 2
            ChangeAttStat 1, 1
         End If
         ElemTaint 7
      Case "Conchurnip"
         SetStatLim 2, 1
         IncreaseStat 2
         If Energy >= 16 Then
            PreCard = 76
         End If
      Case "Cornflower"
         ElemTaint 0
      Case "Cabbadillo"
         If TypID = 14 Then
            ChangeDefStat 0, 2
            ChangeDefStat 1, 2
            ChangeDefStat 2, 2
            ChangeDefStat 3, 0
         End If
      Case "Needlettuce"
         If TypID <= 10 Then
            ChangeAttStat 0, 2
            ChangeAttStat 1, 1
         End If
         If GetEssense(4) = 0 And GetEssense(2) > 0 And Energy >= 8 Then
            PreCard = 15
         End If
      Case "Cherry Bombs"
         If TypID = 17 Then
            For I = 0 To 7
               SetStatLim I, 3
            Next I
         End If
      Case "Masked Potato"
         If TypID <= 10 Then
            ChangeAttStat 0, 1
            ChangeAttStat 1, 2
         End If
      Case "Lilipods"
         SetStatLim 5, 1
         IncreaseStat 5
         If Energy >= 8 Then
            PreCard = 63
         End If
      Case "Rocket Papaya"
         SetStatLim 6, 4
         IncreaseStat 6
         If GetEssense(6) = 0 And GetEssense(0) > 0 And Energy >= 8 Then
            PreCard = 18
         End If
      Case "Orange'opus"
         SetStatLim 2, 4
         IncreaseStat 2
         If GetEssense(4) = 0 And GetEssense(5) >= 5 And Energy >= 8 Then
            PreCard = 50
         End If
      Case "Bumpkin"
         SetStatLim 7, 1
         StatMin(7) = 3
         If Energy >= 8 Then
            PreCard = 140
         End If
      Case "Heart Mint"
         SetStatLim 6, 1
         IncreaseStat 6
         If GetEssense(1) >= 2 And GetEssense(5) >= 2 And GetEssense(7) >= 2 And Energy >= 8 Then
            PreCard = 33
         End If
      Case "Spade Basil"
         If TypID <= 10 Then
            ChangeAttStat 0, 2
         End If
         If GetEssense(0) >= 3 And GetTotalEss() >= 6 And Energy >= 8 Then
            PreCard = 32
         End If
      Case "Dialaurel"
         If GetEssense(4) = 0 And GetEssense(1) > 0 And Energy >= 8 Then
            PreCard = 17
         End If
      Case "Gold Clover"
         If TypID <= 10 Then
            ChangeAttStat 1, 2
         End If
      Case "Mush-in-a-Box"
         ElemTaint 1
      Case "Toadstoolshed"
         For I = 0 To 7
            IncreaseStat I
         Next I
         ElemTaint 1
      Case "Sharp Claw"
         If TypID <= 10 Then
            ChangeAttStat 0, 3
            ChangeAttStat 1, 0
         End If
         If GetEssense(7) = 0 And GetEssense(4) >= 5 And Energy >= 8 Then
            PreCard = 48
         End If
      Case "Poison Fang"
         If TypID <= 10 Then
            ChangeAttStat 2, 0
            ChangeAttStat 3, 3
         End If
         If GetEssense(3) = 0 And GetEssense(2) >= 5 And Energy >= 8 Then
            PreCard = 49
         End If
      Case "Giant's Horn"
         If GetEssense(4) = 0 And GetEssense(5) >= 5 And Energy >= 8 Then
            PreCard = 50
         End If
         If TypID <= 10 Then
            ChangeAttStat 0, 0
            ChangeAttStat 1, 3
         End If
      Case "Scissors"
         If TypID <= 10 Then
            ChangeAttStat 2, 3
            ChangeAttStat 3, 0
         End If
      Case "Healing Claw"
         If TypID = 11 Then
            SetImmunity 0
         End If
         If GetEssense(4) = 0 And GetEssense(0) > 0 And Energy >= 8 Then
            PreCard = 18
         End If
      Case "Zombie Claw"
         If TypID = 22 Then
            SetImmunity 2
         End If
      Case "Vampire Fang"
         SetStatLim 6, 2
         SetStatLim 5, 2
         IncreaseStat 6
         IncreaseStat 5
         If GetEssense(6) = 0 And GetEssense(7) >= 5 And Energy >= 8 Then
            PreCard = 45
         End If
      Case "Little Eye"
         If TypID >= 11 Then
            ChangeDefStat 1, 2
         End If
         If Energy >= 4 Then
            PreCard = 81
         End If
      Case "Sleepy Eye"
         If TypID >= 11 Then
            ChangeDefStat 2, 2
         End If
         If Energy >= 4 Then
            PreCard = 82
         End If
      Case "Silly Eye"
         If TypID <= 10 Then
            ChangeAttStat 1, 2
         End If
         If Energy >= 4 Then
            PreCard = 86
         End If
      Case "Dangerous Eye"
         If TypID >= 11 Then
            ChangeDefStat 0, 2
         End If
         If Energy >= 4 Then
            PreCard = 87
         End If
      Case "Angry Eye"
         If TypID <= 10 Then
            ChangeAttStat 2, 2
         End If
         If Energy >= 4 Then
            PreCard = 85
         End If
      Case "Blank Eye"
         If TypID <= 10 Then
            ChangeAttStat 3, 2
         End If
         If Energy >= 4 Then
            PreCard = 83
         End If
      Case "Creepy Eye"
         If TypID >= 11 Then
            ChangeDefStat 3, 2
         End If
         If Energy >= 4 Then
            PreCard = 84
         End If
      Case "Wicked Eye"
         If TypID <= 10 Then
            ChangeAttStat 0, 2
         End If
      Case "Angel Feather"
         SetStatLim 6, 2
         IncreaseStat 6
         If GetEssense(1) = 0 And GetEssense(0) >= 5 And Energy >= 8 Then
            PreCard = 44
         End If
         ElemTaint 0
      Case "Raven Feather"
         SetStatLim 5, 2
         IncreaseStat 5
         If Energy >= 8 Then
            PreCard = 112
         End If
         ElemTaint 1
      Case "Clear Feather"
         If TypID <= 10 Then
            ChangeAttStat 1, 0
            ChangeAttStat 3, 3
         End If
         If GetEssense(5) = 0 And GetEssense(6) >= 5 And Energy >= 8 Then
            PreCard = 46
         End If
      Case "Moth Wing"
         If TypID >= 11 Then
            ChangeDefStat 0, 1
            ChangeDefStat 1, 1
            ChangeDefStat 2, 1
            ChangeDefStat 3, 3
         End If
         If Energy >= 8 Then
            PreCard = 77
         End If
      Case "Flaming Quill"
         SetStatLim 0, 2
         StatMin(0) = 5
         If GetEssense(4) >= 3 And GetEssense(6) >= 3 And Energy >= 4 Then
            PreCard = 88
         End If
      Case "White Feather"
         SetStatLim 1, 2
         StatMin(1) = 5
         If GetEssense(0) > 0 And GetTotalEss() >= 3 And Energy >= 8 Then
            PreCard = 64
         End If
      Case "Aroma Oil"
         If TypID >= 11 Then
            If MatID >= 28 And MatID <= 31 Then
               ChangeDefStat 0, 3
               ChangeDefStat 1, 3
               ChangeDefStat 2, 3
            End If
         End If
         If GetTotalEss() >= 6 And Energy >= 8 Then
            PreCard = 41
         End If
      Case "Dragon Blood"
         For I = 0 To 7
            IncreaseStat I
         Next I
         If GetEssense(4) >= 3 And GetTotalEss() >= 5 And Energy >= 8 Then
            PreCard = 43
         End If
      Case "Holy Water"
         If Energy >= 8 Then
            PreCard = 141
         End If
         PixieStick = False
      Case "Ether"
         If GetEssense(3) >= 3 And GetEssense(5) >= 3 Then
            If Energy >= 8 Then
               PreCard = 42
            End If
         Else
            PreCard = 78
         End If
      Case "Mercury"
         If Energy >= 4 Then
            PreCard = 137
         End If
      Case "Stinky Breath"
         If TypID >= 11 Then
            ClearImmunity
            SetImmunity 0
            SetImmunity 3
         End If
         If Energy >= 4 Then
            PreCard = 84
         End If
      Case "Ghost's Howl"
         If Energy >= 8 Then
            PreCard = 62
         End If
      Case "Dragon Breath"
         If TypID <= 10 Then
            ChangeAttStat 2, 2
            ChangeAttStat 3, 2
         End If
         If GetEssense(0) > 0 And GetEssense(4) > 0 And GetTotalEss() >= 3 And Energy >= 8 Then
            PreCard = 52
         End If
      Case "Virgin's Sigh"
         If GetEssense(1) >= 3 And GetEssense(2) >= 3 And Energy >= 8 Then
            PreCard = 37
         End If
      Case "Electricity"
         If GetEssense(0) >= 3 And GetEssense(4) >= 3 And GetEssense(6) >= 3 And Energy >= 8 Then
            PreCard = 36
         End If
      Case "Moss"
         If TypID = 12 Then
            SetImmunity 1
         End If
      Case "Ear of Wheat"
         If GetEssense(2) >= 3 And GetTotalEss() >= 5 And Energy >= 8 Then
            PreCard = 38
         End If
      Case "Baked Roach"
         If TypID = 15 Then
            SetImmunity 0
         End If
      Case "Blackened Bat"
         If TypID = 22 Then
            SetImmunity 1
         End If
         If GetEssense(0) = 0 And GetEssense(1) >= 5 And Energy >= 8 Then
            PreCard = 47
         End If
      Case "Sulpher"
         If Energy >= 4 Then
            PreCard = 136
         End If
      Case "Poison Powder"
         If Energy >= 4 Then
            PreCard = 85
         End If
      Case "Sleepy Powder"
         If Energy >= 4 Then
            PreCard = 83
         End If
      Case "Knockout Dust"
         If Energy >= 4 Then
            PreCard = 86
         End If
      Case "Rust"
         If Energy >= 4 Then
            PreCard = 82
         End If
      Case "Grave Dirt"
         If Energy >= 8 Then
            PreCard = 4
         End If
      Case "Ash"
         If Energy >= 4 Then
            PreCard = 16
         End If
      Case "Hairball"
         If Energy >= 8 Then
            PreCard = 80
         End If
      Case "Needle"
         If GetEssense(4) = 0 And GetEssense(2) > 0 And Energy >= 8 Then
            PreCard = 15
         End If
      Case "Mirror Piece"
         If GetTotalEss() >= 3 And Energy >= 8 Then
            PreCard = 2
         End If
      Case "Wad of Wool"
         If GetEssense(1) > 0 And GetEssense(2) > 0 And GetTotalEss() >= 3 And Energy >= 8 Then
            PreCard = 53
         End If
      Case "Messy Scroll"
         If GetEssense(6) > 0 And GetEssense(7) > 0 And GetTotalEss() >= 3 And Energy >= 8 Then
            PreCard = 51
         End If
      Case "Greenball Bun"
         IncreaseStat 4
      Case "Tako Bug"
         IncreaseStat 6
      Case Else
   End Select
End Sub
Sub Temper_Item()
   Dim LRow, LCount As Integer
   Dim TItem, LItem As String
   Dim FItem As Range
   Dim SMin, SMax
   Dim TmpStat(3), TmpTotal
           
   Initialize
   TItem = Sheets("Forge").Range("NextTemper").Value
   
   If TItem Like "*[A-Z]*" Or TItem Like "*[a-z]*" Then
      Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
   Else
      Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(TItem), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
   End If
   If FItem Is Nothing Then
      MsgBox "That Temper Item does not exist!"
      Exit Sub
   End If
      
   LRow = FItem.Row
   TItem = Sheets("Secondary").Cells(LRow, 2)
   Sheets("Forge").Range("NextTemper") = TItem
   Energy = Energy + Sheets("Secondary").Cells(LRow, 4)
   
   With Sheets("Temper List")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
      LItem = .Cells(LRow, 2)
      If LRow > 1 And LItem = TItem Then
         LCount = .Cells(LRow, 3)
         .Cells(LRow, 3) = LCount + 1
      Else
         LRow = LRow + 1
         .Cells(LRow, 2) = TItem
         .Cells(LRow, 3) = 1
      End If
   End With
   
   'Material First
   Select Case MatID
      Case 16 To 23 'Wood Code
         ElemTaint 2
         If Energy >= 8 Then
            PreCard = 98
         End If
      Case 44 To 51 'Aerolite Code
         'Checks for Tempered Item ID = 255 (the null item)
         'If True, sets Sala Essense Level to 4 automatically
         ' This is proof that a newly forged item runs the Temper process
         ' once, using the 255 Item ID and 0 Energy.  Aerolite items start
         ' with Salamander 4.  Instead, we've simulated that by setting
         ' everything required up in the Reset Item code, so we can safely
         ' ignore it here.  Also, the Sala 'bleeding' doesn't happen for
         ' this first 'temper' because of that 0 Energy.
         If Energy >= 4 Then
            DecEssense 4
         End If
      Case Else
   End Select
      
   ItemCode TItem
   PushCards
   PreCard = 255  'This needs testing
   CardCode GetName(PostCard) + " - 4"
   PostCard = 255 'Already tested
   CardCode GetName(GetCard(4)) + " - 3"
   CardCode GetName(GetCard(3)) + " - 2"
   CardCode GetName(GetCard(2)) + " - 1"
   CardCode GetName(GetCard(1)) + " - 0"
   
   For I = 0 To 7
      While ElmInc(I) > 0
         IncEssense I
         ElmInc(I) = ElmInc(I) - 1
      Wend
      CommentEssense I
   Next I
   
   Select Case TypID
     Case 0, 1, 7
        SetAttMark 1
     Case 10
        SetAttMark 1
        I = FindCard(137)
        If I >= 2 And I <= 4 Then
           I = FindCard(112)
           If I >= 2 And I <= 4 Then
              I = FindCard(114)
              If I >= 2 And I <= 4 Then
                 SetPlungeAttack 1, "Magical Shot"
              End If
           End If
        End If
     Case 2, 3, 6, 8
        SetAttMark 2
     Case 4, 5, 8
        SetAttMark 3
     Case 11
        SetDefMark 1
     Case 17, 22
        SetDefMark 1
        If Special = 2 Then
           I = FindCard(88)
           If I < 2 Or I > 4 Then
              Special = 0
           End If
        End If
     Case 12 To 16, 18, 19, 21
        SetDefMark 2
     Case 20
        SetDefMark 3
     Case Else
   End Select
   
   For I = 0 To 7
      If Stat(I) < StatMin(I) Then Stat(I) = StatMin(I)
      SMin = -1
      SMax = 1
      Select Case StatLim(I)
         Case 0
            SMin = -1
            SMax = 1
         Case 1
            SMin = -1
            SMax = 3
         Case 2
            SMin = -3
            SMax = 5
         Case 3
            SMin = -3
            SMax = 9
         Case 4
            SMin = -5
            SMax = 10
         Case 5
            SMin = -5
            SMax = 12
         Case 6
            SMin = -10
            SMax = 15
         Case 7
            SMin = -10
            SMax = 20
      End Select
      If Stat(I) < SMin Then Stat(I) = SMin
      If Stat(I) > SMax Then Stat(I) = SMax
      Range("StatBonus").Cells(1, I + 1) = Stat(I)
   Next I
   
   If TypID <= 10 Then
      Range("DefenseStats").ClearContents
      TmpTotal = 0
      For I = 0 To 3
         TmpStat(I) = MAttStat(I) * TAttStat(I) / 128
         Range("OffenseStats").Cells(1, 1 + I) = TmpStat(I)
         TmpTotal = TmpTotal + TmpStat(I)
      Next I
      Range("OffenseStats").Cells(1, 5) = TmpTotal
      TmpTotal = Int(TmpTotal * (1 + GetTotalEss() / GCtrl))
      If TmpTotal > 999 Then TmpTotal = 999
      Range("OffenseStats").Cells(1, 6) = TmpTotal
   Else
      Range("OffenseStats").ClearContents
      For I = 0 To 3
         TmpStat(I) = Int(MDefStat(I) * TDefStat(I) / 64)
         If TmpStat(I) > 99 Then TmpStat(I) = 99
         Range("DefenseStats").Cells(1, 1 + I) = TmpStat(I)
      Next I
   End If
   
   UpdateSpecial
   
   Sheets("Forge").Range("WastedEnergy").Value = Energy
   CalculatePrice
End Sub
Sub Save()
   Dim Name, Plunge(2), Ess(7), Imm(7), Card(3)
   Dim Att(3), BTtl As Long
   Dim FTtl
   Dim Def(3)
   Dim Encode As String
   Dim Sep, BlankSpace As String
   
   Sep = "\"
   BlankSpace = "|fffd|"
      
   Name = Range("Name").Value
   With Sheets("Materials")
      MatID = .Cells(.Columns("B:B").Find(what:=Range("Material"), LookAt:=xlWhole).Row, 1)
   End With
   With Sheets("Type")
      TypID = .Cells(.Columns("B:B").Find(what:=Range("Type"), LookAt:=xlWhole).Row, 1)
   End With
   
   For I = 0 To 2
     Plunge(I) = Range("PlungeAttack").Cells(I + 1, 1)
   Next I

   For I = 0 To 7
      Ess(I) = Range("ElmLevels").Cells(1, I + 1)
      Stat(I) = Range("StatBonus").Cells(1, I + 1)
      If Range("Immunity").Cells(1, I + 1) = "X" Then
         Imm(I) = 1
      Else
         Imm(I) = 0
      End If
   Next I
   
   If TypID <= 10 Then
      For I = 0 To 3
         Att(I) = Range("OffenseStats").Cells(1, I + 1) * 128
         BTtl = Range("OffenseStats").Cells(1, 5) * 128
         FTtl = Range("OffenseStats").Cells(1, 6)
      Next I
   Else
      For I = 0 To 3
         Def(I) = Range("DefenseStats").Cells(1, I + 1)
      Next I
   End If
   
   
   For I = 0 To 3
      Card(I) = Range("CardSlots").Cells(I + 1, 1)
   Next I
   
   Special = Range("SpecialEffect").Cells(1, 1)
   
   Encode = CStr(MatID) + Sep + CStr(TypID) + Sep
   For I = 0 To 7
      Encode = Encode + Chr(Ess(I) + 65) + Sep
   Next I
   For I = 0 To 7
      Encode = Encode + Chr(Stat(I) + 75) + Sep
   Next I
   
   Encode = Encode + Chr(65 + Imm(0) + 2 * Imm(1) + 4 * Imm(2) + 8 * Imm(3)) + Sep
   Encode = Encode + Chr(65 + Imm(4) + 2 * Imm(5) + 4 * Imm(6) + 8 * Imm(7)) + Sep
   
   If TypID <= 10 Then
      For I = 0 To 3
         Encode = Encode + CStr(Att(I)) + Sep
      Next I
      Encode = Encode + CStr(BTtl) + Sep
      Encode = Encode + CStr(FTtl) + Sep
   Else
      For I = 0 To 3
         Encode = Encode + CStr(Def(I)) + Sep
      Next I
   End If
   
   For I = 0 To 3
      Encode = Encode + CStr(Card(I)) + Sep
   Next I
   
   Encode = Encode + Chr(Special + 65) + Sep
   
   For I = 0 To 2
     Encode = Encode + Plunge(I) + Sep
   Next I
   
   Encode = Encode + Name
   
   Encode = Replace(Encode, " ", BlankSpace)
   
   Range("SaveCode").Value = Encode
End Sub
Sub Load()
   Dim Name, Plunge(2), Ess(7), Imm(7), Card(3)
   Dim Att(3), BTtl As Long
   Dim FTtl
   Dim Def(3)
   Dim Encode As String
   Dim CodeChunk(40)
   Dim I, J
   Dim K, Sep, BlankSpace As String
      
   Sep = "\"
   BlankSpace = "|fffd|"
      
   Encode = Range("SaveCode").Value
   Encode = Replace(Encode, " ", "")
   Range("SaveCode").Value = Encode
   
   Encode = Replace(Encode, BlankSpace, " ")
      
   I = 0
   J = 0
   
   Do While I <= 40
      J = InStr(Encode, Sep)
      If J = 0 Then
         CodeChunk(I) = Encode
         Exit Do
      End If
      CodeChunk(I) = Left(Encode, J - 1)
      Encode = Mid(Encode, J + 1)
      I = I + 1
   Loop

   MatID = Val(CodeChunk(0))
   TypID = Val(CodeChunk(1))
   
   If TypID <= 10 Then
      J = 34
   Else
      J = 32
   End If
   
   If I <> J Then
      MsgBox "That is not a valid Save Code!"
      Exit Sub
   End If
   J = J - 32
   
   For I = 0 To 7
      Ess(I) = Asc(CodeChunk(2 + I)) - 65
      Stat(I) = Asc(CodeChunk(10 + I)) - 75
   Next I
   
   If TypID >= 11 Then
      I = Asc(CodeChunk(18)) - 65
      Imm(0) = I Mod 2
      Imm(1) = (I \ 2) Mod 2
      Imm(2) = (I \ 4) Mod 2
      Imm(3) = (I \ 8) Mod 2
      I = Asc(CodeChunk(19)) - 65
      Imm(4) = I Mod 2
      Imm(5) = (I \ 2) Mod 2
      Imm(6) = (I \ 4) Mod 2
      Imm(7) = (I \ 8) Mod 2
   Else
      For I = 0 To 7
         Imm(I) = -1
      Next I
   End If
   
   If TypID <= 10 Then
      For I = 0 To 3
         Att(I) = Val(CodeChunk(20 + I))
      Next I
      BTtl = CodeChunk(24)
      FTtl = CodeChunk(25)
   Else
      For I = 0 To 3
         Def(I) = Val(CodeChunk(20 + I))
      Next I
   End If
   
   For I = 0 To 3
      Card(I) = Val(CodeChunk(24 + I + J))
   Next I
   
   Special = Asc(CodeChunk(28 + J)) - 65
   
   For I = 0 To 2
      Plunge(I) = CodeChunk(29 + I + J)
   Next I
   
   Name = CodeChunk(32 + J)
   
   Range("Name") = Name
   Sheets("Forge").Cells(2, 4) = MatID
   Sheets("Forge").Cells(3, 4) = TypID
   
   For I = 0 To 2
     Range("PlungeAttack").Cells(I + 1, 1) = Plunge(I)
   Next I

   For I = 0 To 7
      Range("ElmLevels").Cells(1, I + 1) = Ess(I)
      CommentEssense I
      Range("StatBonus").Cells(1, I + 1) = Stat(I)
      Select Case Imm(I)
         Case 0
            K = "_"
         Case 1
            K = "X"
         Case Else
            K = ""
      End Select
      Range("Immunity").Cells(1, I + 1) = K
   Next I
   
   Select Case TypID
     Case 0, 1, 7, 10
        SetAttMark 1
     Case 2, 3, 6, 8
        SetAttMark 2
     Case 4, 5, 8
        SetAttMark 3
     Case 11, 17, 22
        SetDefMark 1
     Case 12 To 16, 18, 19, 21
        SetDefMark 2
     Case 20
        SetDefMark 3
     Case Else
   End Select
   
   If TypID <= 10 Then
      For I = 0 To 3
         Range("OffenseStats").Cells(1, I + 1) = Att(I) / 128
         Range("OffenseStats").Cells(1, 5) = BTtl / 128
         Range("OffenseStats").Cells(1, 6) = FTtl
      Next I
   Else
      For I = 0 To 3
         Range("DefenseStats").Cells(1, I + 1) = Def(I)
      Next I
   End If
   
   For I = 0 To 3
      Range("CardSlots").Cells(I + 1, 1) = Card(I)
   Next I
   
   Range("SpecialEffect").Cells(1, 1) = Special
End Sub
Sub SaveTList()
   Application.ScreenUpdating = False
   
   Dim LRow, SVal, EVal, Tmp As Integer
   Dim TItem, FItem
   Dim TID
   Dim Code As String
   
   With Sheets("Temper List")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
   End With
   
   If LRow < 2 Then
      Sheets("Temper List").Range("TemperListCode").Value = ""
      Exit Sub
   End If
   
   SRow = 1
   ERow = LRow - 1
   
   'Validation starts
   For I = SRow To ERow
      TItem = Sheets("Temper List").Cells(1 + I, 2).Value
   
      If TItem Like "*[A-Z]*" Or TItem Like "*[a-z]*" Then
         Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
      Else
         Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(TItem), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
      End If
      If FItem Is Nothing Then
         MsgBox "There is an invalid Temper Item in the Temper List at ID " + CStr(I) + "!"
         Exit Sub
      End If
      
      LRow = FItem.Row
      TItem = Sheets("Secondary").Cells(LRow, 2)
      Sheets("Temper List").Cells(1 + I, 2) = TItem
   Next I
   
   Code = ""
   'Now we save the Recipe!
   For I = SRow To ERow
      TItem = Sheets("Temper List").Cells(1 + I, 2).Value
      Tmp = Val(Sheets("Temper List").Cells(1 + I, 3).Value)
      If Tmp = 0 Then Tmp = 1
      If Tmp > 25 Then Tmp = 25
      
      Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
      
      LRow = FItem.Row
      TID = Sheets("Secondary").Cells(LRow, 1).Value
      
      Code = Code + Chr((TID \ 16) + 65) + Chr((TID Mod 16) + 65)
      Code = Code + Chr(Tmp + 65)
   Next I

   Sheets("Temper List").Range("TemperListCode").Value = Code
  
   Application.ScreenUpdating = True
End Sub
Sub LoadTList()
   Dim LRow As Integer
   Dim Code As String
   Dim FItem
   Dim Tmp
        
   Code = Sheets("Temper List").Range("TemperListCode").Value
   Code = Replace(Code, " ", "")
   Sheets("Temper List").Range("TemperListCode").Value = Code
   
   If Len(Code) Mod 3 > 0 Then
      MsgBox "Invalid Temper List Code!"
      Exit Sub
   End If
   
   For I = 0 To (Len(Code) \ 3 - 1)
      Tmp = Asc(Mid(Code, I * 3 + 1, 1)) - 65
      If Tmp < 0 Or Tmp > 15 Then
         MsgBox "Invalid Temper List Code!"
         Exit Sub
      End If
      Tmp = Asc(Mid(Code, I * 3 + 2, 1)) - 65
      If Tmp < 0 Or Tmp > 15 Then
         MsgBox "Invalid Temper List Code!"
         Exit Sub
      End If
      Tmp = Asc(Mid(Code, I * 3 + 3, 1)) - 65
      If Tmp < 0 Or Tmp > 25 Then
         MsgBox "Invalid Temper List Code!"
         Exit Sub
      End If
   Next I

   With Sheets("Temper List")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
      If LRow > 1 Then
         .Range(.Cells(2, 2), .Cells(LRow, 3)).ClearContents
      End If
   End With
   
   For I = 0 To (Len(Code) \ 3 - 1)
      Tmp = (Asc(Mid(Code, I * 3 + 1, 1)) - 65) * 16 + Asc(Mid(Code, I * 3 + 2, 1)) - 65
      
      Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(Tmp), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
      If FItem Is Nothing Then
         Sheets("Temper List").Cells(I + 2, 2).Value = CStr(Tmp)
      Else
         Sheets("Temper List").Cells(I + 2, 2).Value = Sheets("Secondary").Cells(FItem.Row, 2)
      End If
      
      Tmp = Asc(Mid(Code, I * 3 + 3, 1)) - 65
      If Tmp < 1 Then Tmp = 1
      Sheets("Temper List").Cells(I + 2, 3).Value = Tmp
   Next I
End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "TemperItem, 1, 0, MSForms, CommandButton"
Attribute VB_Control = "SaveButton, 5, 1, MSForms, CommandButton"
Attribute VB_Control = "UpdateItem, 3, 2, MSForms, CommandButton"
Attribute VB_Control = "ResetItem, 4, 3, MSForms, CommandButton"
Attribute VB_Control = "LoadButton, 6, 4, MSForms, CommandButton"
Attribute VB_Control = "NextRecipe, 18, 5, MSForms, CommandButton"
Attribute VB_Control = "RecipeShowNT, 19, 6, MSForms, CheckBox"
Private Sub NextRecipe_Click()
   Application.ScreenUpdating = False
   
   Dim LRow, SVal, EVal, Tmp As Integer
   Dim RStep, RNum
   Dim TItem, FItem
        
   RStep = Sheets("Forge").Range("RecipeStep").Value
   RNum = Val(CStr(Sheets("Forge").Range("RecipeRepeat").Value))
   
   If Val(RNum) = 0 Then RNum = 1
   
   'Validation starts
   TItem = Sheets("Recipe").Cells(1 + RStep, 2).Value
   
   If TItem = "" Then
      MsgBox "You have reached the end of the current recipe."
      Exit Sub
   End If
   
   If TItem Like "*[A-Z]*" Or TItem Like "*[a-z]*" Then
      Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
   Else
      Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(TItem), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
   End If
   If FItem Is Nothing Then
      MsgBox "There is an invalid Temper Item in the Recipe at that ID!"
      Exit Sub
   End If
      
   LRow = FItem.Row
   TItem = Sheets("Secondary").Cells(LRow, 2)
   Sheets("Recipe").Cells(1 + RStep, 2) = TItem
   
   'Now we activate the Recipe!
   Sheets("Forge").Range("NextTemper") = TItem
   Tmp = Val(Sheets("Recipe").Cells(1 + RStep, 3).Value)
   If Tmp = 0 Then Tmp = 1
   If RNum <= Tmp Then
      Temper_Item
   End If
   
   RNum = RNum + 1
   
   If RNum > Tmp Then
      RStep = RStep + 1
      RNum = 1
   End If
   
   Sheets("Forge").Range("RecipeStep").Value = RStep
   Sheets("Forge").Range("RecipeRepeat").Value = RNum
   
   If Sheets("Forge").RecipeShowNT Then
      TItem = Sheets("Recipe").Cells(1 + RStep, 2).Value
      Sheets("Forge").Range("NextTemper") = TItem
   End If
   
   Application.ScreenUpdating = True
End Sub
Private Sub SaveButton_Click()
   Save
   SaveTList
End Sub
Private Sub LoadButton_Click()
   Load
   LoadTList
End Sub
Private Sub ResetItem_Click()
   Dim TmpStat(3), TmpTotal
   
   Initialize
   Special = 0
   UpdateSpecial
   For I = 1 To 4
      SetCard I, 255
   Next I
   For I = 0 To 7
      SetEssense I, 0
      CommentEssense I
      Range("StatBonus").Cells(1, I + 1) = 0
   Next I
   
   Select Case MatID
      Case 44 To 51 'Aerolite Code
         SetEssense 4, 4
         CommentEssense 4
      Case Else
   End Select
   
   SetAttMark 3
   ClearImmunity
   Sheets("Temper List").ClearTemperList_Click
   
   Select Case TypID
      Case 0 To 9
         SetPlungeAttack 1, "Thrust"
         SetPlungeAttack 2, "Uppercut"
         SetPlungeAttack 3, "Jump"
      Case 10
         SetPlungeAttack 1, "Double Shot"
         SetPlungeAttack 2, "Shot"
         SetPlungeAttack 3, "Jump"
      Case Else
         SetPlungeAttack 1, ""
         SetPlungeAttack 2, ""
         SetPlungeAttack 3, ""
   End Select

   If TypID <= 10 Then
      Range("DefenseStats").ClearContents
      TmpTotal = CDec(0)
      For I = 0 To 3
         TmpStat(I) = CDec(MAttStat(I) * TAttStat(I)) / 128
         Range("OffenseStats").Cells(1, 1 + I) = TmpStat(I)
         TmpTotal = TmpTotal + TmpStat(I)
      Next I
      Range("OffenseStats").Cells(1, 5) = TmpTotal
      TmpTotal = Int(TmpTotal * (1 + GetTotalEss() / GCtrl))
      If TmpTotal > 999 Then TmpTotal = 999
      Range("OffenseStats").Cells(1, 6) = TmpTotal
   Else
      Range("OffenseStats").ClearContents
      For I = 0 To 3
         TmpStat(I) = Int(MDefStat(I) * TDefStat(I) / 64)
         If TmpStat(I) > 99 Then TmpStat(I) = 99
         Range("DefenseStats").Cells(1, 1 + I) = TmpStat(I)
      Next I
   End If
   
   Sheets("Forge").Range("WastedEnergy").Value = 0
   Sheets("Forge").Range("RecipeStep").Value = 1
   Sheets("Forge").Range("RecipeRepeat").Value = 1
   CalculatePrice
   UpdateName
End Sub
Private Sub UpdateItem_Click()
   Dim TmpStat(3), TmpTotal
   
   Initialize
   
   For I = 0 To 7
      CommentEssense I
   Next I
   
   Select Case TypID
     Case 0, 1, 7
        SetAttMark 1
     Case 10
        SetAttMark 1
        I = FindCard(137)
        If I >= 2 And I <= 4 Then
           I = FindCard(112)
           If I >= 2 And I <= 4 Then
              I = FindCard(114)
              If I >= 2 And I <= 4 Then
                 SetPlungeAttack 1, "Magical Shot"
              End If
           End If
        End If
     Case 2, 3, 6, 8
        SetAttMark 2
     Case 4, 5, 8
        SetAttMark 3
     Case 11
        SetDefMark 1
     Case 17, 22
        SetDefMark 1
        If Special = 2 Then
           I = FindCard(88)
           If I < 2 Or I > 4 Then
              Special = 0
           End If
        End If
     Case 12 To 16, 18, 19, 21
        SetDefMark 2
     Case 20
        SetDefMark 3
     Case Else
   End Select
   
   If TypID <= 10 Then
      Range("DefenseStats").ClearContents
      TmpTotal = CDec(0)
      For I = 0 To 3
         TmpStat(I) = CDec(MAttStat(I) * TAttStat(I)) / 128
         Range("OffenseStats").Cells(1, 1 + I) = TmpStat(I)
         TmpTotal = TmpTotal + TmpStat(I)
      Next I
      Range("OffenseStats").Cells(1, 5) = TmpTotal
      TmpTotal = Int(TmpTotal * (1 + GetTotalEss() / GCtrl))
      If TmpTotal > 999 Then TmpTotal = 999
      Range("OffenseStats").Cells(1, 6) = TmpTotal
   Else
      Range("OffenseStats").ClearContents
      For I = 0 To 3
         TmpStat(I) = Int(MDefStat(I) * TDefStat(I) / 64)
         If TmpStat(I) > 99 Then TmpStat(I) = 99
         Range("DefenseStats").Cells(1, 1 + I) = TmpStat(I)
      Next I
   End If
      
   UpdateSpecial
   CalculatePrice
End Sub
Public Sub TemperItem_Click()
   Application.ScreenUpdating = False
   
   Temper_Item

   Application.ScreenUpdating = True
End Sub
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "ClearTemperList, 5, 2, MSForms, CommandButton"
Public Sub ClearTemperList_Click()
   Dim LRow As Integer
        
   With Sheets("Temper List")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
      If LRow > 1 Then
         .Range(.Cells(2, 2), .Cells(LRow, 3)).ClearContents
      End If
   End With
End Sub
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "SaveRecipe, 5, 0, MSForms, CommandButton"
Attribute VB_Control = "RecipeStart, 2, 1, MSForms, CommandButton"
Attribute VB_Control = "StopCheck, 3, 2, MSForms, CheckBox"
Attribute VB_Control = "ForgeSwitch, 4, 3, MSForms, CheckBox"
Attribute VB_Control = "LoadRecipe, 6, 4, MSForms, CommandButton"
Private Sub RecipeStart_Click()
   Application.ScreenUpdating = False
   
   Dim LRow, SVal, EVal, Tmp As Integer
   Dim TItem, FItem
        
   With Sheets("Recipe")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
   End With
   
   If LRow < 2 Then
      MsgBox "There is no Recipe to run!"
      Exit Sub
   End If
   
   SVal = Sheets("Recipe").Range("StartValue")
   If Sheets("Recipe").StopCheck Then
      EVal = Sheets("Recipe").Range("EndValue")
      If EVal > LRow - 1 Then
         EVal = LRow - 1
      End If
   Else
      EVal = LRow - 1
   End If
   
   If SVal > EVal Then
      MsgBox "You cannot start a Recipe after its end!"
      Exit Sub
   End If
      
   'Validation starts
   For I = SVal To EVal
      TItem = Sheets("Recipe").Cells(1 + I, 2).Value
   
      If TItem Like "*[A-Z]*" Or TItem Like "*[a-z]*" Then
         Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
      Else
         Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(TItem), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
      End If
      If FItem Is Nothing Then
         Sheets("Recipe").Cells(1 + I, 2).Select
         MsgBox "There is an invalid Temper Item at ID " + CStr(I) + "!"
         Exit Sub
      End If
      
      LRow = FItem.Row
      TItem = Sheets("Secondary").Cells(LRow, 2)
      Sheets("Recipe").Cells(1 + I, 2) = TItem
   Next I
   
   'Now we activate the Recipe!
   For I = SVal To EVal
      TItem = Sheets("Recipe").Cells(1 + I, 2).Value
      Sheets("Forge").Range("NextTemper") = TItem
      Tmp = Val(Sheets("Recipe").Cells(1 + I, 3).Value)
      If Tmp = 0 Then Tmp = 1
      For J = 1 To Tmp
         Temper_Item
      Next J
   Next I
  
   Sheets("Forge").Range("RecipeStep").Value = EVal + 1
   Sheets("Forge").Range("RecipeRepeat").Value = 1
   
   If Sheets("Forge").RecipeShowNT Then
      TItem = Sheets("Recipe").Cells(2 + EVal, 2).Value
      Sheets("Forge").Range("NextTemper") = TItem
   End If
   
   If Sheets("Recipe").ForgeSwitch Then
      Sheets("Forge").Activate
      Sheets("Forge").Range("A1").Select
   End If

   Application.ScreenUpdating = True
End Sub
Private Sub SaveRecipe_Click()
   Application.ScreenUpdating = False
   
   Dim LRow, SVal, EVal, Tmp As Integer
   Dim TItem, FItem
   Dim TID
   Dim Code As String
        
   With Sheets("Recipe")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
   End With
   
   If LRow < 2 Then
      MsgBox "There is no Recipe to save!"
      Exit Sub
   End If
   
   SRow = 1
   ERow = LRow - 1
   
   'Validation starts
   For I = SRow To ERow
      TItem = Sheets("Recipe").Cells(1 + I, 2).Value
   
      If TItem Like "*[A-Z]*" Or TItem Like "*[a-z]*" Then
         Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
      Else
         Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(TItem), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
      End If
      If FItem Is Nothing Then
         Sheets("Recipe").Cells(1 + I, 2).Select
         MsgBox "There is an invalid Temper Item at ID " + CStr(I) + "!"
         Exit Sub
      End If
      
      LRow = FItem.Row
      TItem = Sheets("Secondary").Cells(LRow, 2)
      Sheets("Recipe").Cells(1 + I, 2) = TItem
   Next I
   
   Code = ""
   'Now we save the Recipe!
   For I = SRow To ERow
      TItem = Sheets("Recipe").Cells(1 + I, 2).Value
      Tmp = Val(Sheets("Recipe").Cells(1 + I, 3).Value)
      If Tmp = 0 Then Tmp = 1
      If Tmp > 25 Then Tmp = 25
      
      Set FItem = Sheets("Secondary").Columns("B:B").Find(what:=TItem, After:=Sheets("Secondary").Range("B1"), LookAt:=xlWhole)
      
      LRow = FItem.Row
      TID = Sheets("Secondary").Cells(LRow, 1).Value
      
      Code = Code + Chr((TID \ 16) + 65) + Chr((TID Mod 16) + 65)
      Code = Code + Chr(Tmp + 65)
   Next I
  
   Sheets("Recipe").Range("RecipeCode").Value = Code
  
   Application.ScreenUpdating = True
End Sub
Private Sub LoadRecipe_Click()
   Dim LRow As Integer
   Dim Code As String
   Dim FItem
   Dim Tmp
        
   Code = Sheets("Recipe").Range("RecipeCode").Value
   Code = Replace(Code, " ", "")
   Sheets("Recipe").Range("RecipeCode").Value = Code
   
   If Len(Code) Mod 3 > 0 Then
      MsgBox "Invalid Recipe Code!"
      Exit Sub
   End If
   
   For I = 0 To (Len(Code) \ 3 - 1)
      Tmp = Asc(Mid(Code, I * 3 + 1, 1)) - 65
      If Tmp < 0 Or Tmp > 15 Then
         MsgBox "Invalid Recipe Code!"
         Exit Sub
      End If
      Tmp = Asc(Mid(Code, I * 3 + 2, 1)) - 65
      If Tmp < 0 Or Tmp > 15 Then
         MsgBox "Invalid Recipe Code!"
         Exit Sub
      End If
      Tmp = Asc(Mid(Code, I * 3 + 3, 1)) - 65
      If Tmp < 0 Or Tmp > 25 Then
         MsgBox "Invalid Recipe Code!"
         Exit Sub
      End If
   Next I

   With Sheets("Recipe")
      LRow = .Columns("B:B").Find(what:="", LookAt:=xlWhole).Row - 1
      If LRow > 1 Then
         .Range(.Cells(2, 2), .Cells(LRow, 3)).ClearContents
      End If
   End With
   
   For I = 0 To (Len(Code) \ 3 - 1)
      Tmp = (Asc(Mid(Code, I * 3 + 1, 1)) - 65) * 16 + Asc(Mid(Code, I * 3 + 2, 1)) - 65
      
      Set FItem = Sheets("Secondary").Columns("A:A").Find(what:=Val(Tmp), After:=Sheets("Secondary").Range("A1"), LookAt:=xlWhole)
      If FItem Is Nothing Then
         Sheets("Recipe").Cells(I + 2, 2).Value = CStr(Tmp)
      Else
         Sheets("Recipe").Cells(I + 2, 2).Value = Sheets("Secondary").Cells(FItem.Row, 2)
      End If
      
      Tmp = Asc(Mid(Code, I * 3 + 3, 1)) - 65
      If Tmp > 1 Then
         Sheets("Recipe").Cells(I + 2, 3).Value = Tmp
      End If
   Next I
End Sub

Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True


INQUEST-PP=macro
