Attribute VB_Name = "ApanharErros"
Function findValue(sheet As String) As Boolean
    Dim SearchString As String
    Dim SearchRange As Range, cl As Range
    Dim FirstFound As String
    Dim Sh As Worksheet
    
    Set Sh = ThisWorkbook.Sheets(sheet)
    
    SearchString = "Erro"
    Application.FindFormat.Clear
    
        Set cl = Sh.Cells.Find(What:=SearchString, _
            After:=Sh.Cells(1, 1), _
            LookIn:=xlValues, _
            LookAt:=xlPart, _
            SearchOrder:=xlByRows, _
            SearchDirection:=xlNext, _
            MatchCase:=False, _
            SearchFormat:=False)
        If Not cl Is Nothing Then
        
         findValue = True
         
        Else
        
         findValue = False
         
        End If
End Function








Attribute VB_Name = "Botoes"
Sub ScreenTipKiller() 'Retirar os TipKiller
   On Error Resume Next
   Dim ws As Worksheet
    Dim h As Hyperlink
    Application.ScreenUpdating = False
    For Each ws In ActiveWorkbook.Worksheets
    For Each h In ws.Hyperlinks
        h.ScreenTip = " "
    Next h
    Next ws
    Application.ScreenUpdating = True
End Sub

Sub Balancete_ButtonNext_Click()
    
    If (ThisWorkbook.Sheets("Balancete").Range("A50").Value <> "1") Then
    
        ThisWorkbook.Sheets("Balancete").Range("A50").Value = "1"
        
        
        For Each shp1 In ThisWorkbook.Sheets("Intercompanhias").Shapes
          If (shp1.Name <> "Button2" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52" And shp1.Name <> "Round Same Side Corner Rectangle 58" And shp1.Name <> "Rectangle 59") Then
            ThisWorkbook.Sheets("Intercompanhias").Shapes(shp1.Name).Visible = False
          End If
        Next shp1
        
        ThisWorkbook.Sheets("Intercompanhias").Activate
        
        
    Else
        
        For Each shp1 In ThisWorkbook.Sheets("Intercompanhias").Shapes
          If (shp1.Name <> "Button2" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52" And shp1.Name <> "Round Same Side Corner Rectangle 58" And shp1.Name <> "Rectangle 59") Then
            ThisWorkbook.Sheets("Intercompanhias").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
    
    ThisWorkbook.Sheets("Intercompanhias").Visible = xlSheetVisible
    ThisWorkbook.Sheets("Intercompanhias").Activate
        
    End If

End Sub

Sub Inputs_Next_Click()

    If (ThisWorkbook.Sheets("Inputs").Range("A50").Value <> "7") Then
        
        MsgBox "Campos por preencher"
    
    Else
        
        ThisWorkbook.Sheets("Balancete").Visible = xlSheetVisible
        
        For Each shp1 In ThisWorkbook.Sheets("Balancete").Shapes
          If (shp1.Name <> "Button 4" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52") Then
            ThisWorkbook.Sheets("Balancete").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
        
        ThisWorkbook.Sheets("Balancete").Activate
        
    End If

End Sub


Sub SignOff_Voltar_Click()

    ThisWorkbook.Sheets("Inputs").Activate
End Sub

Sub Intercompanhias_Next_Click()

    'Activar TopBar
    
    'Intercompanhias
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 59").Visible = True
    
    'Balancete
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 59").Visible = True

    'Inputs
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 59").Visible = True
    
    
    ThisWorkbook.Sheets("Geral").Visible = xlSheetVisible
    
    ThisWorkbook.Sheets("Geral").Activate
    
    

End Sub

Sub Geral_Apagar_Click()

    With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
    End With

    Call Module6.ApagarConteudoDetalhado
    Call Module6.CleanGeral
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With
    
    Call Module6.ActualizarSheets
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub

Sub Geral_Actualizar_Click()

    UserForm1.show (vbModeless)
    
    UserForm1.Label1.Caption = "Actualiza|fffd||fffd|o em processamento"
    UserForm1.Repaint
    
    With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
    End With
    
    ThisWorkbook.Sheets("Detalhado").Visible = xlSheetVisible
    
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 61").Visible = True
    
    ThisWorkbook.Sheets("Detalhado").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Detalhado").Shapes("Rectangle 61").Visible = True
    
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 61").Visible = True
    
    ThisWorkbook.Sheets("Geral").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Geral").Shapes("Rectangle 61").Visible = True
    
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 61").Visible = True
    
    Call Module6.unprotect_sheets
    
    
    Call Module6.CorrerDetalhado
    Call Module6.CorrerGeral

    Call Module6.actualizarsidebar
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With
    
    'De forma a que actualize os finds aos erros
    
    With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
    End With
    
    Call ActualizarSheets
    
    Call Module6.protect_sheets
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With
    
    Unload UserForm1
    
    ThisWorkbook.Sheets("Geral").Activate
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"
    
    
End Sub

Sub Detalhado_Actualizar_Click()

    UserForm1.show (vbModeless)
    
    UserForm1.Label1.Caption = "Actualiza|fffd||fffd|o em processamento"
    UserForm1.Repaint
    
    With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
    End With
    
    Call Module6.unprotect_sheets
    
    Call Module6.CleanDetalhado
    
    Call Module6.CorrerDetalhado
    Call Module6.CorrerGeral

    Call Module6.actualizarsidebar
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With
    
    'De forma a que actualize os finds aos erros
    
    With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
    End With
    
    Call ActualizarSheets
    
    Call Module6.protect_sheets
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With
    
    Unload UserForm1
    
    ThisWorkbook.Sheets("Detalhado").Activate
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"
    
    
End Sub

Sub Detalhado_Apagar_Click()

    Application.EnableEvents = False
    Application.Calculation = xlManual

    Call Module6.ApagarConteudoDetalhado
    Call Module6.CleanGeral
    
    
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic
    
    Call Module6.ActualizarSheets
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub



Attribute VB_Name = "Module1"
Sub checkprotect()

For Each s In ActiveWorkbook.Worksheets

If (s.ProtectContents = True) Then

    MsgBox s.Name & " Protegida"

Else

MsgBox s.Name & " Desprotegido"

End If
Next


End Sub

Sub Unhide_Multiple_Sheets()
Dim ws As Worksheet
    
    For Each ws In ActiveWorkbook.Worksheets
        
        ws.Visible = xlSheetVisible
    
    Next ws

End Sub

Sub unhideAllShapes()

Dim shp1 As Shape

For Each shp1 In ActiveSheet.Shapes
            
          ActiveSheet.Shapes(shp1.Name).Visible = True
            
    Next shp1

End Sub

Sub Unhideshapes()

ActiveSheet.Shapes("textbox1").Visible = True
ActiveSheet.Shapes("Rectangle1").Visible = True
ActiveSheet.Shapes("PictureN1").Visible = True
ActiveSheet.Shapes("PictureS1").Visible = True

End Sub

Sub resizeshape()

ActiveSheet.Shapes("Rectangle1").Height = 38

End Sub

Sub CopyShape()
    Dim shp1 As Shape, nombre As String
    Dim s1 As Worksheet, s2 As Worksheet
    Dim shp2 As Shape

    Set s1 = Sheets("A1.5")
    Set s2 = Sheets("EXTRAP")

    For Each shp1 In s1.Shapes
            'On Error Resume Next
            nombre = shp1.Name
            shp1.Copy
            s2.Paste
            Set shp2 = s2.Shapes(s2.Shapes.Count)
            shp2.Name = nombre
            shp2.top = shp1.top
            shp2.Left = shp1.Left
    Next shp1
End Sub


Function findValue(sheet As String) As Boolean

    
    Dim xlRange As Range
    Dim xlCell As Range
    Dim xlSheet As Worksheet
    Dim valueToFind As String
    Dim contador As Long
    contador = 0
    
    valueToFind = "Erro"
    Set xlSheet = ThisWorkbook.Sheets(sheet)
    Set xlRange = xlSheet.Range("A1:AZ500")

    For Each xlCell In xlRange
        If xlCell.Value = valueToFind Then
            contador = 1
        End If
    Next xlCell
    
    If contador <> 0 Then
        findValue = True
    Else
        findValue = False
    End If
    
End Function

Sub unprotect_all_sheets()
On Error GoTo booboo
unpass = InputBox("password")
For Each Worksheet In ActiveWorkbook.Worksheets
Worksheet.Unprotect Password:=unpass
Next
Exit Sub
booboo: MsgBox "There is s problem - check your password, capslock, etc."
End Sub


Sub showshape()
ActiveSheet.Shapes("textbox27").Visible = True
ActiveSheet.Shapes("PictureN27").Visible = True
ActiveSheet.Shapes("PictureS27").Visible = True

End Sub

Sub DeleteAllShapes()
Dim shp As Shape

For Each shp In ActiveSheet.Shapes
   shp.Delete
Next shp

End Sub

Sub allShapesAllcheets()

Dim shp As Shape
'Selection.PrintObject = msoFalse

Dim ws As Worksheet
    
    For Each ws In ActiveWorkbook.Worksheets
        
        For Each shp In ws.Shapes
           ws.Shapes(shp.Name).ControlFormat.printobject = False
           
        Next shp
    
    Next ws


End Sub

Sub printobject()
For i = 1 To Sheets.Count
Worksheets(i).Shapes.SelectAll
Selection.printobject = msoFalse
Next
End Sub

Sub CopyShape2()
    Dim shp1 As Shape, nombre As String
    Dim s1 As Worksheet, s2 As Worksheet
    Dim shp2 As Shape

    Set s1 = Sheets("A1.5")
    Set s2 = Sheets("EXTRAP")

    For Each shp1 In s1.Shapes
            'On Error Resume Next
            nombre = shp1.Name
            shp1.Copy
            s2.Paste
            Set shp2 = s2.Shapes(s2.Shapes.Count)
            shp2.Name = nombre
            shp2.top = shp1.top
            shp2.Left = shp1.Left
    Next shp1
End Sub

Sub protect_all_sheets()
top:
pass = InputBox("Enter password")
repass = InputBox("Verify password")
If Not (pass = repass) Then
MsgBox "Passwords don't match"
GoTo top
End If
For i = 1 To Worksheets.Count
If Worksheets(i).ProtectContents = True Then GoTo oops
Next
For Each s In ActiveWorkbook.Worksheets
s.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True
Next
Exit Sub
oops: MsgBox "I think you have some sheets that are already protected. Please unprotect all sheets before running this Macro."
End Sub

Sub changeRowHeight()

Dim shp As Shape
'Selection.PrintObject = msoFalse

Dim ws As Worksheet
    
    For Each ws In ActiveWorkbook.Worksheets
        
        'ws.Rows(1).RowHeight = 40
        'ws.Rows(2).RowHeight = 27.75
        'ws.Activate
        'ActiveWindow.Zoom = 80
        
        With ActiveWindow
        .SplitColumn = 0
        .SplitRow = 1
        End With
    ActiveWindow.FreezePanes = True
        
    Next ws


End Sub

Sub hideheadings()
'Updateby Extendoffie 20161206
    Dim wsSheet As Worksheet
    Application.ScreenUpdating = False
    For Each wsSheet In ThisWorkbook.Worksheets
        If Not wsSheet.Name = "Blank" Then
            wsSheet.Activate
            With ActiveWindow
                .DisplayHeadings = False
                .DisplayWorkbookTabs = True
                .DisplayHorizontalScrollBar = False
            End With
        End If
    Next wsSheet
    Application.ScreenUpdating = True
End Sub

Sub ScreenTipKiller()
   Dim ws As Worksheet
    Dim h As Hyperlink
    Application.ScreenUpdating = False
    For Each ws In ActiveWorkbook.Worksheets
    For Each h In ws.Hyperlinks
        h.ScreenTip = " "
    Next h
    Next ws
    Application.ScreenUpdating = True
End Sub

Sub testprotect()

ThisWorkbook.Sheets("Sign off").Range("E35").Locked = False



End Sub


Sub splittest()

'Dim shp As Shape
'Selection.PrintObject = msoFalse

'Dim ws As Worksheet
    
 '   For Each ws In ActiveWorkbook.Worksheets
        
        'ws.Rows(1).RowHeight = 40
        'ws.Rows(2).RowHeight = 27.75
        'ws.Activate
        'ActiveWindow.Zoom = 80
        
        With ActiveWindow
        .SplitColumn = 0
        .SplitRow = 1
        End With
    ActiveWindow.FreezePanes = True
        
  '  Next ws


End Sub

Sub zoomSheet()


Dim ws As Worksheet
    
    For Each ws In ActiveWorkbook.Worksheets
        
        'ws.Rows(1).RowHeight = 40
        'ws.Rows(2).RowHeight = 27.75
        ws.Activate
        ActiveWindow.Zoom = 80
        
        
        
    Next ws


End Sub


Sub testComboBox()


MsgBox ThisWorkbook.Sheets("BPE").DropDowns("Drop Down 3").Value

End Sub


Sub hideheadings1()
'Updateby Extendoffie 20161206
    Dim wsSheet As Worksheet
    Application.ScreenUpdating = False
    For Each wsSheet In ThisWorkbook.Worksheets
        If Not wsSheet.Name = "Blank" Then
            wsSheet.Activate
            With ActiveWindow
                .DisplayHeadings = False
                .DisplayWorkbookTabs = True
                .DisplayHorizontalScrollBar = False
            End With
        End If
    Next wsSheet
    Application.ScreenUpdating = True
End Sub
Sub shapeExists()

    Dim Sh As Shape
    For Each Sh In ThisWorkbook.Sheets("Geral").Shapes
         If Sh.Name = "Chevron67" Then MsgBox "Existe"
    Next Sh
End Sub

Sub hideallshapes()

For Each Current In Worksheets

Dim i As Long
For i = 1 To 36
If (shapeExists1("textbox" & i, Current.Name) = True) Then Current.Shapes("textbox" & i).Visible = False
If (shapeExists1("PictureN" & i, Current.Name) = True) Then Current.Shapes("PictureN" & i).Visible = False
If (shapeExists1("PictureS" & i, Current.Name) = True) Then Current.Shapes("PictureS" & i).Visible = False
Next i

Next Current
End Sub


Function shapeExists1(shapeName As String, worksheetname As String) As Boolean

    Dim Sh As Shape
    For Each Sh In ThisWorkbook.Sheets(worksheetname).Shapes
         If Sh.Name = shapeName Then shapeExists1 = True
    Next Sh
End Function

Sub enablecalculation()

With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
    End With

End Sub



Attribute VB_Name = "Module2"

Sub cor()
On Error Resume Next
Dim Current As Worksheet
For Each Current In Worksheets

'Azul escuro
            With Current.Shapes("shapeCP").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 32, 96)
            .Transparency = 0
            .Solid
            End With
            
            With Current.Shapes("shapeCP").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 32, 96)
            .Transparency = 0
            .Solid
            End With


Next


End Sub

Sub testecolor()

ThisWorkbook.Sheets("Inputs").Tab.ColorIndex = 4

Stop

ThisWorkbook.Sheets("Inputs").Tab.ColorIndex = xlColorIndexNone

End Sub
Attribute VB_Name = "Module3"
Sub Macro1()
Attribute Macro1.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro1 Macro
'

'
    Sheets("Overview").Select
    With ActiveWorkbook.Sheets("Overview").Tab
        .Color = 255
        .TintAndShade = 0
    End With
    Sheets("EXTRAP").Select
End Sub
Attribute VB_Name = "Module4"
Sub Macro2()
Attribute Macro2.VB_ProcData.VB_Invoke_Func = " \n14"
'
' Macro2 Macro
'

'
    ActiveSheet.Range("$A$1:$A$8").RemoveDuplicates Columns:=1, Header:=xlNo
    Range("J37").Select
    Sheets("Overview").Select
    ActiveWindow.SelectedSheets.Visible = False
    Range("G21").Select
    ActiveWorkbook.RunAutoMacros Which:=xlAutoClose
    Range("R21").Select
    ActiveWorkbook.RunAutoMacros Which:=xlAutoClose
End Sub
Attribute VB_Name = "Module6"
'Public LastRowBalancetesheet As Long 'variavel que guarda a posicao do ultimo elemento da sheet Balance
Public rubrica() As Variant 'Array que guarda todos os elementos da coluna B da sheet Balance
Public rubricamae() As String 'Array que guarda todos os elementos antes do Ponto da coluna B da sheet Balance
Public accountnumber() As String 'Array que guarda todos os elementos da coluna D da sheet Balance
Public accountdescription() As String 'Array que guarda todos os elementos da coluna E da sheet Balance
Public fscaptionGeral() As String 'Array que guarda todos os elementos da coluna F da sheet Balance
Public fscaptionDetalhado() As String 'Array que guarda todos os elementos da coluna G da sheet Balance
Public balance() As Double 'Array que guarda todos os elementos que sejam montantes da coluna H da sheet Balance
Public balanceInter() As Double
Public rubricamaeBalance() As Double 'Array que sumariza os montantes por todos os elementos da coluna B antes do ponto da sheet Balance
Public RubricaMaeNoDuplicates As Variant 'Array que guarda todos os elementos sem duplicates da coluna B antes do ponto da sheet Balance
Public valuessheetDetalhado() As String ' Array que guarda a informa|fffd||fffd|o da coluna C da sheet Detalhado
Public RubricaInter() As Variant
Public RubricaIntercompanhias() As String ' Array que guarda a informa|fffd||fffd|o da coluna C da sheet intercompanhias
Public RubricaMaeIntercompanhias() As String
Public balanceIntercompanhias() As Double
Public RubricaMaeDoubleIntercompanhias() As Double
Public RubricaMaeIntercompanhiasNoDuplicates As Variant
Public rubricamaeIntercompanhiasBalance() As Double

Sub unprotect_sheets1()
On Error Resume Next
'unpass = InputBox("password")



Dim unpass As String
unpass = "bai_p"
For Each Worksheet In ActiveWorkbook.Worksheets
If (Worksheet.Name = "Intercompanhias" Or Worksheet.Name = "Geral" Or Worksheet.Name = "Detalhado" Or Worksheet.Name = "Balancete") Then
If (Worksheet.ProtectContents = True) Then
Worksheet.Unprotect Password:=unpass
End If
End If
Next



End Sub

Sub protect_sheets()


Dim pass As String

pass = "bai_p"

For Each s In ActiveWorkbook.Worksheets
If (s.Name = "Intercompanhias" Or s.Name = "Geral" Or s.Name = "Detalhado" Or s.Name = "Balancete") Then
If (s.ProtectContents = True) Then


Else

s.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True

End If
End If
Next


End Sub

Sub unprotect_sheets()


Dim pass As String

pass = "bai_p"

For Each s In ActiveWorkbook.Worksheets
If (s.Name = "Intercompanhias" Or s.Name = "Geral" Or s.Name = "Detalhado" Or s.Name = "Balancete") Then

s.Unprotect Password:=pass

End If
Next


End Sub

Sub CorrerGeral()

'Call DeterminarBalancete
'Call DeterminarIntercompanhias
Call escreverGeral
Call escreverIntercompanhiasGeral

'MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub
Sub ApagarConteudoGeral()

Call DeterminarBalancete
Call DeterminarIntercompanhias
Call CleanGeral

'MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub

Sub CorrerDetalhado()

Call DeterminarBalancete
Call DeterminarIntercompanhias
Call EscreverDetalhado
Call EscreverIntercompanhiasDetalhado

'MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub

Sub ApagarConteudoDetalhado()

Call CleanDetalhado

'MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub

'Sub Tab Lateral Overview Abrir
Sub Pentagon63_Click()

Dim pass As String
pass = "bai_p"

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With


ActiveSheet.Unprotect Password:=pass



ActiveSheet.Shapes("Pentagon63").Visible = False
ActiveSheet.Shapes("Picture64").Visible = False
ActiveSheet.Shapes("Chevron67").Visible = False

ActiveSheet.Columns("A").ColumnWidth = 28.57


ActiveSheet.Shapes("Pentagon70").Visible = True
ActiveSheet.Shapes("Chevron71").Visible = True
ActiveSheet.Shapes("Rectangle72").Visible = True


If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then
    Call SetOverviewSideBar
    
Else
    ThisWorkbook.Sheets("Overview").Columns("A").Clear
    ActiveSheet.Shapes("Danger1").Visible = False
    ActiveSheet.Shapes("Danger2").Visible = False
    ActiveSheet.Shapes("Picture73").Visible = True
End If

Call Botoes.ScreenTipKiller 'Retirar o link em hover

ActiveSheet.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True

With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

End Sub
'Sub Tab Lateral Overview Fechar
Sub Pentagon70_Click()

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With


'Hide Slicer
ActiveSheet.Shapes("Pentagon70").Visible = False
ActiveSheet.Shapes("Chevron71").Visible = False
ActiveSheet.Shapes("Rectangle72").Visible = False
ActiveSheet.Shapes("Picture73").Visible = False
ActiveSheet.Shapes("Danger1").Visible = False

'Hide Tabs
ActiveSheet.Shapes("Rectangle1").Visible = False

Dim i As Long
For i = 1 To 35
'On Error Resume Next
ActiveSheet.Shapes("textbox" & i).Visible = False
ActiveSheet.Shapes("PictureN" & i).Visible = False
ActiveSheet.Shapes("PictureS" & i).Visible = False
Next i


ActiveSheet.Columns("A").ColumnWidth = 17.43

ActiveSheet.Shapes("Pentagon63").Visible = True
ActiveSheet.Shapes("Picture64").Visible = True
ActiveSheet.Shapes("Chevron67").Visible = True

If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then
    If (haerros = True) Then
     
        ActiveSheet.Shapes("Picture64").Visible = False
        ActiveSheet.Shapes("Danger2").Visible = True
        
        If (shapeExists("Chevron67", ActiveSheet.Name) = True) Then
            'vermelho
            With ActiveSheet.Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.ObjectThemeColor = msoThemeColorAccent2
            .ForeColor.TintAndShade = 0
            .ForeColor.Brightness = -0.25
            .Transparency = 0.5
            .Solid
            End With
            With ActiveSheet.Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.ObjectThemeColor = msoThemeColorAccent2
            .ForeColor.TintAndShade = 0
            .ForeColor.Brightness = -0.25
            .Transparency = 0.5
            .Solid
            End With
        End If
           
    Else
      
        ActiveSheet.Shapes("Picture64").Visible = True
        ActiveSheet.Shapes("Danger2").Visible = False
        
       ' If (shapeExists("Chevron67", Current.Name) = True) Then
            With ActiveSheet.Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
            With ActiveSheet.Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
        'End If
        
    End If

Else

    ActiveSheet.Shapes("Danger1").Visible = False
    ActiveSheet.Shapes("Danger2").Visible = False
    ActiveSheet.Shapes("Picture64").Visible = True

    If (shapeExists("Chevron67", ActiveSheet.Name) = True) Then
            'MsgBox "Entrou"
            With ActiveSheet.Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
            With ActiveSheet.Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
    End If
    
End If

With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

ActiveSheet.Calculate

End Sub

'Sub Tab Lateral Overview Fechar
Sub CloseSideBarAllSheets()

Dim Current As Worksheet
Dim contadorFC As Integer
contadorFC = 0
Dim contadorCP As Integer
contadorCP = 0
Dim contadorimoveis As Integer
contadorimoveis = 0
Dim checkErros As Boolean
If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then
    If (haerros = True) Then
    
    checkErros = True
    Else
    checkErros = False
    End If

Else
    
    checkErros = False

End If

If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then
        If (findValue("Fluxos de Caixa") = True) Then
          contadorFC = 1
        End If
        If (findValue("CP") = True) Then
          contadorCP = 1
        End If
        If (findValue("Im|fffd|veis") = True) Then
          contadorimoveis = 1
        End If
End If

Dim pass As String
    pass = "bai_p"


For Each Current In Worksheets
    
    If (Current.ProtectContents = True) Then
        
        Current.Unprotect Password:=pass
        
    End If
    
    
'Current.EnableCalculation = False
If (Current.Columns("A").ColumnWidth <> 17.43) Then
'Hide Slicer
If (shapeExists("Pentagon70", Current.Name) = True) Then Current.Shapes("Pentagon70").Visible = False
If (shapeExists("Chevron71", Current.Name) = True) Then Current.Shapes("Chevron71").Visible = False
If (shapeExists("Rectangle72", Current.Name) = True) Then Current.Shapes("Rectangle72").Visible = False
If (shapeExists("Picture73", Current.Name) = True) Then Current.Shapes("Picture73").Visible = False
If (shapeExists("Danger1", Current.Name) = True) Then Current.Shapes("Danger1").Visible = False

'Hide Tabs
If (shapeExists("Rectangle1", Current.Name) = True) Then Current.Shapes("Rectangle1").Visible = False

Dim i As Long
For i = 1 To 35
If (shapeExists("textbox" & i, Current.Name) = True) Then Current.Shapes("textbox" & i).Visible = False
If (shapeExists("PictureN" & i, Current.Name) = True) Then Current.Shapes("PictureN" & i).Visible = False
If (shapeExists("PictureS" & i, Current.Name) = True) Then Current.Shapes("PictureS" & i).Visible = False
Next i

Current.Columns("A").ColumnWidth = 17.43

If (shapeExists("Pentagon63", Current.Name) = True) Then Current.Shapes("Pentagon63").Visible = True
'If (shapeExists("Picture64", Current.Name) = True) Then Current.Shapes("Picture64").Visible = True
If (shapeExists("Chevron67", Current.Name) = True) Then Current.Shapes("Chevron67").Visible = True

End If

'DeterminarErros e popular todas as sheets
    
    If (checkErros = True) Then
        
        If (shapeExists("Danger2", Current.Name) = True) Then Current.Shapes("Danger2").Visible = True
        If (shapeExists("Picture73", Current.Name) = True) Then Current.Shapes("Picture73").Visible = False
        If (shapeExists("Picture64", Current.Name) = True) Then Current.Shapes("Picture64").Visible = False
        If (shapeExists("Chevron67", Current.Name) = True) Then Current.Shapes("Chevron67").Visible = True
        If (shapeExists("Pentagon63", Current.Name) = True) Then Current.Shapes("Pentagon63").Visible = True
        If (shapeExists("Chevron67", Current.Name) = True) Then
            'vermelho
            With Current.Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.ObjectThemeColor = msoThemeColorAccent2
            .ForeColor.TintAndShade = 0
            .ForeColor.Brightness = -0.25
            .Transparency = 0.5
            .Solid
            End With
            With Current.Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.ObjectThemeColor = msoThemeColorAccent2
            .ForeColor.TintAndShade = 0
            .ForeColor.Brightness = -0.25
            .Transparency = 0.5
            .Solid
            End With
        End If
    Else
        If (shapeExists("Danger1", Current.Name) = True) Then Current.Shapes("Danger1").Visible = False
        If (shapeExists("Danger2", Current.Name) = True) Then Current.Shapes("Danger2").Visible = False
        If (shapeExists("Picture64", Current.Name) = True) Then Current.Shapes("Picture64").Visible = True
        If (shapeExists("Chevron67", Current.Name) = True) Then Current.Shapes("Chevron67").Visible = True
        If (shapeExists("Pentagon63", Current.Name) = True) Then Current.Shapes("Pentagon63").Visible = True
        'azul
        If (shapeExists("Chevron67", Current.Name) = True) Then
            With Current.Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
            With Current.Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
        End If
    End If

Next



End Sub

Sub DeterminarBalancete()

Dim i As Long
Dim j As Long
Dim k As Long
Dim LastRow As Long

    With ThisWorkbook.Sheets("Balancete")
        LastRow = .Cells(.Rows.Count, "B").End(xlUp).Row
    End With
    
Dim rubricabalancete() As String
Dim balanceBalancete() As Double
ReDim rubricabalancete(LastRow)
ReDim rubricamae(LastRow)
ReDim accountnumber(LastRow)
ReDim accountdescription(LastRow)
ReDim fscaptionGeral(LastRow)
ReDim fscaptionDetalhado(LastRow)
ReDim balanceBalancete(LastRow)
    
Dim RubricaFinal As Variant
    
 For i = 1 To LastRow
 
    rubricabalancete(i) = ThisWorkbook.Sheets("Balancete").Range("B" & i).Value
    
    If InStr(rubricabalancete(i), ".") > 0 Then
        
        RubricaFinal = Split(rubricabalancete(i), ".")
        
        rubricamae(i) = RubricaFinal(0)
        
        
    Else
    
        rubricamae(i) = rubricabalancete(i)
        
    
    End If
    
    
    accountnumber(i) = ThisWorkbook.Sheets("Balancete").Range("D" & i).Value
    accountdescription(i) = ThisWorkbook.Sheets("Balancete").Range("E" & i).Value
    fscaptionGeral(i) = ThisWorkbook.Sheets("Balancete").Range("F" & i).Value
    fscaptionDetalhado(i) = ThisWorkbook.Sheets("Balancete").Range("G" & i).Value
    
    If IsNumeric(ThisWorkbook.Sheets("Balancete").Range("H" & i).Value) = True Then
        balanceBalancete(i) = ThisWorkbook.Sheets("Balancete").Range("H" & i).Value
    Else
        balanceBalancete(i) = 0
    End If
    
 Next i


  Dim X As Long
  With CreateObject("Scripting.Dictionary")
    For X = LBound(rubricamae) To UBound(rubricamae)
      
    If ((rubricamae(X) <> "") And (rubricamae(X) <> "#")) Then
      
      If Not IsMissing(rubricamae(X)) Then .Item(rubricamae(X)) = 1
    End If
    Next
    RubricaMaeNoDuplicates = .Keys
  End With
    
  With CreateObject("Scripting.Dictionary")
    For X = LBound(rubricabalancete) To UBound(rubricabalancete)
      
    If ((rubricabalancete(X) <> "") And (rubricabalancete(X) <> "#")) Then
      
      If Not IsMissing(rubricabalancete(X)) Then .Item(rubricabalancete(X)) = 1
    End If
    Next
    rubrica = .Keys
  End With
    
    
ReDim rubricamaeBalance(UBound(RubricaMaeNoDuplicates))
ReDim balance(UBound(rubrica))
'MsgBox UBound(balance)

Dim sumador As Double

    For j = LBound(RubricaMaeNoDuplicates) To UBound(RubricaMaeNoDuplicates)
    sumador = 0
        For k = LBound(rubricamae) To UBound(rubricamae)
        
            If (rubricamae(k) = RubricaMaeNoDuplicates(j)) Then
                        
                sumador = balanceBalancete(k)
                rubricamaeBalance(j) = rubricamaeBalance(j) + sumador
                
            End If
        
        Next k

    If (Left(RubricaMaeNoDuplicates(j), 1) <> "A") Then
    
        rubricamaeBalance(j) = (-1) * rubricamaeBalance(j)
    
    End If
    
    Next j
    
    For j = LBound(rubrica) To UBound(rubrica)
    sumador = 0
        For k = LBound(rubricabalancete) To UBound(rubricabalancete)
        
            If (rubricabalancete(k) = rubrica(j)) Then
                        
                sumador = balanceBalancete(k)
                balance(j) = balance(j) + sumador
                
            End If
        
        Next k

    If (Left(rubrica(j), 1) <> "A") Then
    
        balance(j) = (-1) * balance(j)
    
    End If
    
    Next j
    
    
End Sub

Sub DeterminarIntercompanhias()

Dim i As Long
Dim j As Long
Dim k As Long
Dim LastRow As Long
Dim contador As Long
contador = 1
    With ThisWorkbook.Sheets("Intercompanhias")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With
    
ReDim RubricaIntercompanhias(LastRow)
ReDim RubricaMaeIntercompanhias(LastRow)
ReDim balanceIntercompanhias(LastRow)
    
Dim RubricaFinal As Variant
    
 For i = 1 To LastRow
    
    
    
    If (ThisWorkbook.Sheets("Intercompanhias").Range("C" & i).Value <> "") Then
        
        RubricaIntercompanhias(i) = ThisWorkbook.Sheets("Intercompanhias").Range("C" & i).Value
        
        If InStr(RubricaIntercompanhias(contador), ".") > 0 Then
            
            RubricaFinal = Split(RubricaIntercompanhias(contador), ".")
            
            RubricaMaeIntercompanhias(i) = RubricaFinal(0)
            
            
        Else
        
            RubricaMaeIntercompanhias(i) = RubricaIntercompanhias(i)
            
        
        End If
        
        If IsNumeric(ThisWorkbook.Sheets("Intercompanhias").Range("F" & i).Value) = True Then
            balanceIntercompanhias(i) = ThisWorkbook.Sheets("Intercompanhias").Range("F" & i).Value
        Else
            balanceIntercompanhias(i) = 0
        End If
        
    End If
    
 Next i
    
    
  Dim X As Long
  With CreateObject("Scripting.Dictionary")
    For X = LBound(RubricaMaeIntercompanhias) To UBound(RubricaMaeIntercompanhias)
      
    If ((RubricaMaeIntercompanhias(X) <> "") And (RubricaMaeIntercompanhias(X) <> "#")) Then
      
      If Not IsMissing(RubricaMaeIntercompanhias(X)) Then .Item(RubricaMaeIntercompanhias(X)) = 1
    End If
    Next
    RubricaMaeIntercompanhiasNoDuplicates = .Keys
  End With
   
   With CreateObject("Scripting.Dictionary")
    For X = LBound(RubricaIntercompanhias) To UBound(RubricaIntercompanhias)
      
    If ((RubricaIntercompanhias(X) <> "") And (RubricaIntercompanhias(X) <> "#")) Then
      
      If Not IsMissing(RubricaIntercompanhias(X)) Then .Item(RubricaIntercompanhias(X)) = 1
    End If
    Next
    RubricaInter = .Keys
  End With
   

   
ReDim rubricamaeIntercompanhiasBalance(UBound(RubricaMaeIntercompanhiasNoDuplicates))
ReDim balanceInter(UBound(RubricaInter))

Dim sumador As Double
    For j = LBound(RubricaMaeIntercompanhiasNoDuplicates) To UBound(RubricaMaeIntercompanhiasNoDuplicates)
    sumador = 0
        For k = LBound(RubricaMaeIntercompanhias) To UBound(RubricaMaeIntercompanhias)
        
            If (RubricaMaeIntercompanhias(k) = RubricaMaeIntercompanhiasNoDuplicates(j)) Then
                        
                sumador = balanceIntercompanhias(k)
                rubricamaeIntercompanhiasBalance(j) = rubricamaeIntercompanhiasBalance(j) + sumador
                
            End If
        
        Next k
    
    If (Left(RubricaMaeIntercompanhiasNoDuplicates(j), 1) <> "A") Then
    
        'rubricamaeIntercompanhiasBalance(j) = (-1) * rubricamaeIntercompanhiasBalance(j)        -- Estava assim agora iremos manter o valor que for escrito nesta sheet
        
        rubricamaeIntercompanhiasBalance(j) = rubricamaeIntercompanhiasBalance(j)
        
    End If
    
    Next j
    
    For j = LBound(RubricaInter) To UBound(RubricaInter)
    sumador = 0
        For k = LBound(RubricaIntercompanhias) To UBound(RubricaIntercompanhias)
        
            If (RubricaIntercompanhias(k) = RubricaInter(j)) Then
                        
                sumador = balanceIntercompanhias(k)
                balanceInter(j) = balanceInter(j) + sumador
                
            End If
        
        Next k

    If (Left(RubricaInter(j), 1) <> "A") Then
    
        'balanceInter(j) = (-1) * balanceInter(j)      -- Estava assim agora iremos manter o valor que for escrito nesta sheet
        balanceInter(j) = (-1) * balanceInter(j)
        
    End If
    
    Next j
    
End Sub

Sub escreverGeral()

Dim i As Long
Dim j As Long
Dim LastRow As Long
Dim valuessheetGeral() As String



    With ThisWorkbook.Sheets("Geral")
        LastRow = .Cells(.Rows.Count, "D").End(xlUp).Row
    End With
    
ReDim valuessheetGeral(LastRow)

    For i = 1 To LastRow
        
        valuessheetGeral(i) = ThisWorkbook.Sheets("Geral").Range("C" & i).Value
        
    Next i
    
    For i = LBound(valuessheetGeral) To UBound(valuessheetGeral)
    
        For j = LBound(RubricaMaeNoDuplicates) To UBound(RubricaMaeNoDuplicates)
        
            If (valuessheetGeral(i) = RubricaMaeNoDuplicates(j)) Then
            
                ThisWorkbook.Sheets("Geral").Range("J" & i).Value = rubricamaeBalance(j)
                ThisWorkbook.Sheets("Geral").Range("J" & i).Value = rubricamaeBalance(j)
                
            End If

        Next j
    
    Next i
    
End Sub

Sub escreverIntercompanhiasGeral()

Dim i As Long
Dim j As Long
Dim LastRow As Long
Dim valuessheetGeral() As String



    With ThisWorkbook.Sheets("Geral")
        LastRow = .Cells(.Rows.Count, "D").End(xlUp).Row
    End With
    
ReDim valuessheetGeral(LastRow)

    For i = 1 To LastRow
        
        valuessheetGeral(i) = ThisWorkbook.Sheets("Geral").Range("C" & i).Value
        
    Next i
    
    For i = LBound(valuessheetGeral) To UBound(valuessheetGeral)
    
        For j = LBound(RubricaMaeIntercompanhiasNoDuplicates) To UBound(RubricaMaeIntercompanhiasNoDuplicates)
        
            If (valuessheetGeral(i) = RubricaMaeIntercompanhiasNoDuplicates(j)) Then
                
                If (ThisWorkbook.Sheets("Geral").Range("H" & i).HasFormula = False) Then
                ThisWorkbook.Sheets("Geral").Range("H" & i).Value = rubricamaeIntercompanhiasBalance(j)
                End If
            End If

        Next j
    
    Next i
    
End Sub

Sub CleanGeral()
On Error Resume Next
ThisWorkbook.Sheets("Geral").Range("H10:H500").SpecialCells(xlCellTypeConstants, 1).ClearContents
ThisWorkbook.Sheets("Geral").Range("J10:J500").SpecialCells(xlCellTypeConstants, 1).ClearContents
    
End Sub


Sub CleanGeralAntigo()

Dim i As Long
Dim j As Long
Dim LastRow As Long
Dim valuessheetGeral() As String



    With ThisWorkbook.Sheets("Geral")
        LastRow = .Cells(.Rows.Count, "D").End(xlUp).Row
    End With
    
ReDim valuessheetGeral(LastRow)

    For i = 1 To LastRow
        
        valuessheetGeral(i) = ThisWorkbook.Sheets("Geral").Range("C" & i).Value
        
    Next i
    
    For i = LBound(valuessheetGeral) To UBound(valuessheetGeral)
    
        For j = LBound(RubricaMaeNoDuplicates) To UBound(RubricaMaeNoDuplicates)
        
            If (valuessheetGeral(i) = RubricaMaeNoDuplicates(j)) Then
            
                ThisWorkbook.Sheets("Geral").Range("J" & i).Value = ""
                ThisWorkbook.Sheets("Geral").Range("H" & i).Value = ""
                
            End If

        Next j
    
    Next i
    
End Sub

Sub EscreverDetalhado()

Dim i As Long
Dim j As Long
Dim LastRow As Long
'Dim valuessheetDetalhado() As String
Dim matchvaluessheetDetalhado() As Double


    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With
    
ReDim valuessheetDetalhado(LastRow)
ReDim matchvaluessheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        
    Next i
                
    
    
    For i = LBound(valuessheetDetalhado) To UBound(valuessheetDetalhado)
       If (valuessheetDetalhado(i) <> "") Then
            For j = LBound(rubrica) To UBound(rubrica)
                    
                If (rubrica(j) = valuessheetDetalhado(i)) Then
                    
                    'ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value = balance(j)
                    matchvaluessheetDetalhado(i) = balance(j)
                    
                End If
    
            Next j
        End If
    Next i
    
    For i = LBound(matchvaluessheetDetalhado) To UBound(matchvaluessheetDetalhado)
        If (matchvaluessheetDetalhado(i) <> 0) Then
            If (ThisWorkbook.Sheets("Detalhado").Range("J" & i).HasFormula = False) Then
            ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value = matchvaluessheetDetalhado(i)
            End If
        End If
    Next i
    
End Sub

Sub EscreverIntercompanhiasDetalhado()

Dim i As Long
Dim j As Long
Dim LastRow As Long
'Dim valuessheetDetalhado() As String
Dim matchvaluessheetDetalhado() As Double


    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With
    
ReDim valuessheetDetalhado(LastRow)
ReDim matchvaluessheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        
    Next i
    
    
    
    For i = LBound(valuessheetDetalhado) To UBound(valuessheetDetalhado)
       If (valuessheetDetalhado(i) <> "") Then
            For j = LBound(RubricaIntercompanhias) To UBound(RubricaIntercompanhias)
                
                If (RubricaIntercompanhias(j) = valuessheetDetalhado(i)) Then
                    
                    'ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value = balance(j)
                    matchvaluessheetDetalhado(i) = balanceIntercompanhias(j)
                    
                End If
    
            Next j
        End If
    Next i
    
    For i = LBound(matchvaluessheetDetalhado) To UBound(matchvaluessheetDetalhado)
        If (matchvaluessheetDetalhado(i) <> 0) Then
        If (ThisWorkbook.Sheets("Detalhado").Range("H" & i).HasFormula = False) Then
        ThisWorkbook.Sheets("Detalhado").Range("H" & i).Value = matchvaluessheetDetalhado(i)
        End If
        End If
    Next i
    
End Sub


Sub CleanDetalhado()
On Error Resume Next
ThisWorkbook.Sheets("Detalhado").Range("J13:J500").SpecialCells(xlCellTypeConstants).ClearContents
ThisWorkbook.Sheets("Detalhado").Range("H13:H500").SpecialCells(xlCellTypeConstants).ClearContents

End Sub




'Funcao que vao determina as boxs a aparecer no side bar
Sub SetOverviewSideBar()

Dim i As Long

Dim LastRow As Long

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With

Dim BalancesheetDetalhado() As Double

ReDim valuessheetDetalhado(LastRow)
ReDim BalancesheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        If IsNumeric(ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value) = True Then
            BalancesheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value
        Else
            BalancesheetDetalhado(i) = 0
        End If
    Next i

Dim contador As Long
Dim erros As Long

erros = 0
contador = 1
Dim ContabilizarErros() As String
ReDim ContabilizarErros(LastRow)
Dim contadorA7P5 As Integer
contadorA7P5 = 0
Dim contadorA1112 As Integer
contadorA1112 = 0
Dim contadorA1415P1011 As Integer
contadorA1415P1011 = 0
Dim contadorA172526 As Integer
contadorA172526 = 0
Dim contadorD1D2 As Integer
contadorD1D2 = 0
Dim contadorBPE As Integer
Dim contadorJV As Integer
Dim contadorPR As Integer
Dim contadorEXTRAP As Integer

contadorBPE = 0
contadorJV = 0
contadorPR = 0
contadorEXTRAP = 0


Dim hyperLinkedShape As Shape

For i = 1 To UBound(valuessheetDetalhado)
        
        If (contadorBPE = 0 And ThisWorkbook.Sheets("BPE").Range("C4").Value <> "N|fffd|o") Then
        'If (contadorBPE = 0) Then
        contadorBPE = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "BPE"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            'If (BalancesheetDetalhado(i) = ThisWorkbook.Sheets("A1.5").Range("E16").Value) Then
             If (findValue("BPE") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="BPE!A3"
               
            Else
                erros = erros + 1
                ContabilizarErros(erros) = "BPE"
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="BPE!A3"
                contadorBPE = 1
                
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="BPE!A3"

        Sheets("BPE").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("BPE").Visible = xlSheetHidden
        End If
        
      
        If (contadorJV = 0) Then
        contadorJV = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "JV"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            'If (BalancesheetDetalhado(i) = ThisWorkbook.Sheets("A1.5").Range("E16").Value) Then
             If (findValue("JV") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="JV!A3"
                

            Else
                erros = erros + 1
                ContabilizarErros(erros) = "JV"
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="JV!A3"
                contadorJV = 1
                

            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="JV!A3"

        Sheets("JV").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("JV").Visible = xlSheetHidden
        End If
    
        
        If (contadorPR = 0) Then
        contadorPR = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "PR"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            'If (BalancesheetDetalhado(i) = ThisWorkbook.Sheets("A1.5").Range("E16").Value) Then
             If (findValue("PR") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="PR!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = "PR"
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="PR!A3"
                contadorPR = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="PR!A3"

        Sheets("PR").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("PR").Visible = xlSheetHidden
        End If
        
    
        
        If (contadorEXTRAP = 0) Then
        contadorEXTRAP = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "EXTRAP"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            'If (BalancesheetDetalhado(i) = ThisWorkbook.Sheets("A1.5").Range("E16").Value) Then
             If (findValue("EXTRAP") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="EXTRAP!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = "EXTRAP"
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="EXTRAP!A3"
                contadorEXTRAP = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="EXTRAP!A3"

        Sheets("EXTRAP").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("EXTRAP").Visible = xlSheetHidden
        End If
    
    'Rotina check A1.5
    If (valuessheetDetalhado(i) = "A1.5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A1.5"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            'If (BalancesheetDetalhado(i) = ThisWorkbook.Sheets("A1.5").Range("E16").Value) Then
             If (findValue("A1.5") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A1.5!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A1.5!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A1.5!A3"

        Sheets("A1.5").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A1.5").Visible = xlSheetHidden
        End If
    End If
    
    'Rotina check A2.6
    If (valuessheetDetalhado(i) = "A2.6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A2.6"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A2.6") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A2.6!A3"
                
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A2.6!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A2.6!A3"
        
        Sheets("A2.6").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A2.6").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A3"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A3") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A3!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A3!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A3!A3"

        Sheets("A3").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A3").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A4"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A4") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A4!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A4!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A4!A3"

        Sheets("A4").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A4").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A5"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A5") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A5!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A5!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A5!A3"

        Sheets("A5").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A5").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A6"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A6") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A6!A3"
            Else
                erros = erros + 1
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A6!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A6!A3"

        Sheets("A6").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A6").Visible = xlSheetHidden
        End If
    End If
    
    
    If ((valuessheetDetalhado(i) = "A7" Or valuessheetDetalhado(i) = "P5") And contadorA7P5 = 0) Then
     
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        contadorA7P5 = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A7-P5"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A7-P5") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A7-P5'!A3"
            Else
                erros = erros + 1
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A7-P5'!A3"
                contadorA7P5 = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A7-P5'!A3"

        Sheets("A7-P5").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("A7-P5").Visible = xlSheetHidden
        End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A8"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A8") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A8!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A8!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A8!A3"

        Sheets("A8").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A8").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A9") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A9"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A9") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A9!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A9!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A9!A3"

        Sheets("A9").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A9").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A10"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A10") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A10!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A10!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A10!A3"

        Sheets("A10").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A10").Visible = xlSheetHidden
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A11" Or valuessheetDetalhado(i) = "A12") And contadorA1112 = 0) Then
     
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        contadorA1112 = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A11-12"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A11-12") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A11-12'!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A11-12'!A3"
                contadorA1112 = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A11-12'!A3"

        Sheets("A11-12").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("A11-12").Visible = xlSheetHidden
        End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A13"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A13") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A13!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A13!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A13!A3"

        Sheets("A13").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A13").Visible = xlSheetHidden
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A14" Or valuessheetDetalhado(i) = "A15" Or valuessheetDetalhado(i) = "P10" Or valuessheetDetalhado(i) = "P11") And contadorA1415P1011 = 0) Then
      
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        contadorA1415P1011 = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A14-15 P10-11"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A14-15 P10-11") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A14-15 P10-11'!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A14-15 P10-11'!A3"
                contadorA1415P1011 = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A14-15 P10-11'!A3"

        Sheets("A14-15 P10-11").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("A14-15 P10-11").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A17.16"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A17.16") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.16!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.16!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.16!A3"

        Sheets("A17.16").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A17.16").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.21") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A17.21"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A17.21") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.21!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.21!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.21!A3"

        Sheets("A17.21").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A17.21").Visible = xlSheetHidden
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A17.25" Or valuessheetDetalhado(i) = "A17.26") And contadorA172526 = 0) Then
     
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        contadorA172526 = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A17.25-26"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A17.25-26") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A17.25-26'!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A17.25-26'!A3"
                contadorA172526 = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'A17.25-26'!A3"

        Sheets("A17.25-26").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("A17.25-26").Visible = xlSheetHidden
        End If
    End If
   
    
    If (valuessheetDetalhado(i) = "A17.31") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "A17.31"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("A17.31") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.31!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.31!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="A17.31!A3"

        Sheets("A17.31").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("A17.31").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P1") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "P1"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("P1") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P1!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P1!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P1!A3"

        Sheets("P1").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("P1").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "P3"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("P3") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P3!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P3!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P3!A3"

        Sheets("P3").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("P3").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "P4"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("P4") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P4!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P4!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P4!A3"

        Sheets("P4").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("P4").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "P8"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("P8") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P8!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P8!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P8!A3"

        Sheets("P8").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("P8").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P13.18") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "P13.18"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("P13.18") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P13.18!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P13.18!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="P13.18!A3"

        Sheets("P13.18").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("P13.18").Visible = xlSheetHidden
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "D1" Or valuessheetDetalhado(i) = "D2") And contadorD1D2 = 0) Then
       
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        contadorD1D2 = 1
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D1-D2"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D1-D2") = False) Then
                
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'D1-D2'!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'D1-D2'!A3"
                contadorD1D2 = 1
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="'D1-D2'!A3"

        Sheets("D1-D2").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("D1-D2").Visible = xlSheetHidden
        End If
    End If
    
    
    
    If (valuessheetDetalhado(i) = "D6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D6"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D6") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D6!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D6!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D6!A3"

        Sheets("D6").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D6").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D7") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D7"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D7") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D7!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D7!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D7!A3"

        Sheets("D7").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D7").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D10"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D10") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D10!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D10!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D10!A3"

        Sheets("D10").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D10").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D11") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D11"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D11") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D11!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D11!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D11!A3"

        Sheets("D11").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D11").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D13"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D13") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D13!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D13!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D13!A3"

        Sheets("D13").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D13").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D14") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D14"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D14") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D14!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D14!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D14!A3"

        Sheets("D14").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D14").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D16"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D16") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D16!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D16!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D16!A3"

        Sheets("D16").Visible = xlSheetVisible
        contador = contador + 1
        Else
        Sheets("D16").Visible = xlSheetHidden
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D19") Then
        
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        ActiveSheet.Shapes("textbox" & contador).TextFrame.Characters.Text = "D19"
        ActiveSheet.Shapes("textbox" & contador).Visible = True
        
            If (contador > 1) Then
                ActiveSheet.Shapes("Rectangle1").Height = ActiveSheet.Shapes("Rectangle1").Height + 39
            Else
                ActiveSheet.Shapes("Rectangle1").Visible = True
                ActiveSheet.Shapes("Rectangle1").Height = 38
            End If
            
            If (findValue("D19") = False) Then
                ActiveSheet.Shapes("PictureS" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureS" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D19!A3"
            Else
                erros = erros + 1
                ContabilizarErros(erros) = valuessheetDetalhado(i)
                ActiveSheet.Shapes("PictureN" & contador).Visible = True
                Set hyperLinkedShape = ActiveSheet.Shapes("PictureN" & contador)
                ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D19!A3"
            End If
        Set hyperLinkedShape = ActiveSheet.Shapes("textbox" & contador)
        ActiveSheet.Hyperlinks.Add Anchor:=hyperLinkedShape, Address:="", SubAddress:="D19!A3"

        Sheets("D19").Visible = xlSheetVisible
        contador = contador + 1
        Else
        'Sheets("D19").Visible = xlSheetHidden
        End If
    End If
    
    
    
Next i

If (erros > 0) Then

  ActiveSheet.Shapes("Danger1").Visible = True
  ActiveSheet.Shapes("Picture73").Visible = False
  ActiveSheet.Shapes("Picture64").Visible = False
    
Else
       
  ActiveSheet.Shapes("Danger1").Visible = False
  ActiveSheet.Shapes("Danger2").Visible = False
  ActiveSheet.Shapes("Picture73").Visible = True


End If

Dim pass As String

pass = "bai_p"

'---------- Retirei corro apenas no final

'ThisWorkbook.Sheets("Overview").Unprotect Password:=pass

'If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then

'ThisWorkbook.Sheets("Overview").Columns("A").Clear

'For i = 1 To UBound(ContabilizarErros)
'ThisWorkbook.Sheets("Overview").Range("A" & i).Value = ContabilizarErros(i)
'Next i
'Else

'ThisWorkbook.Sheets("Overview").Columns("A").Clear
'End If

'ThisWorkbook.Sheets("Overview").Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
'          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
'          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True


'---------- Retirei corro apenas no final

End Sub

Sub actualizarsidebar()
    
   Call CloseSideBarAllSheets
   'Call SidebardeterminarErros

End Sub


Function findValue(sheet As String) As Boolean
    Dim SearchString As String
    Dim SearchRange As Range, cl As Range
    Dim FirstFound As String
    Dim Sh As Worksheet
    
    Set Sh = ThisWorkbook.Sheets(sheet)
    
    SearchString = "Erro"
    Application.FindFormat.Clear
    
        Set cl = Sh.Cells.Find(What:=SearchString, _
            After:=Sh.Cells(1, 1), _
            LookIn:=xlValues, _
            LookAt:=xlPart, _
            SearchOrder:=xlByRows, _
            SearchDirection:=xlNext, _
            MatchCase:=False, _
            SearchFormat:=False)
        If Not cl Is Nothing Then
        
         findValue = True
         
        Else
        
         findValue = False
         
        End If
End Function



Function haerros() As Boolean

Dim i As Long

Dim LastRow As Long

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With

Dim BalancesheetDetalhado() As Double

ReDim valuessheetDetalhado(LastRow)
ReDim BalancesheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        If IsNumeric(ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value) = True Then
            BalancesheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value
        Else
            BalancesheetDetalhado(i) = 0
        End If
    Next i

Dim contador As Long

contador = 0

Dim contadorA7P5 As Integer
contadorA7P5 = 0
Dim contadorA1112 As Integer
contadorA1112 = 0
Dim contadorA1415P1011 As Integer
contadorA1415P1011 = 0
Dim contadorA172526 As Integer
contadorA172526 = 0
Dim contadorD1D2 As Integer
contadorD1D2 = 0
Dim contadorBPE As Integer
contadorBPE = 0
Dim contadorJV As Integer
contadorJV = 0
Dim contadorPR As Integer
contadorPR = 0
Dim contadorEXTRAP As Integer
contadorEXTRAP = 0

Dim hyperLinkedShape As Shape

For i = LBound(valuessheetDetalhado) To UBound(valuessheetDetalhado)
   
   If (contador = 0) Then
             
             If (contadorBPE = 0 And ThisWorkbook.Sheets("BPE").Range("C4").Value <> "N|fffd|o") Then
             If (findValue("BPE") = True) Then
                
                contadorBPE = 1
                contador = contador + 1
                
              
            End If
            End If
             
             If (contadorJV = 0) Then
             If (findValue("JV") = True) Then
                contadorJV = 1
                contador = contador + 1
                
            End If
            End If
             
             If (contadorPR = 0) Then
             If (findValue("PR") = True) Then
                contadorPR = 1
                contador = contador + 1
               
            End If
            End If
             If (contadorEXTRAP = 0) Then
             If (findValue("EXTRAP") = True) Then
                contadorEXTRAP = 1
                contador = contador + 1
               
            End If
            End If
    
    'Rotina check A1.5
    If (valuessheetDetalhado(i) = "A1.5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             If (findValue("A1.5") = True) Then
        contador = contador + 1
            End If
        End If
    End If
    
    'Rotina check A2.6
    If (valuessheetDetalhado(i) = "A2.6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A2.6") = True) Then
                
                contador = contador + 1
         
            End If
        
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             
            If (findValue("A3") = True) Then
                
                contador = contador + 1
                
            End If
       
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
  
            
            If (findValue("A4") = True) Then
                
                contador = contador + 1
              
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A5") = True) Then
                
        contador = contador + 1
                
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A6") = True) Then
                
                contador = contador + 1
                
            End If
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A7" Or valuessheetDetalhado(i) = "P5") And contadorA7P5 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A7-P5") = True) Then
                
                contador = contador + 1
               
            End If
        End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A8") = True) Then
                
                contador = contador + 1
             
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A9") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A9") = True) Then
                
                contador = contador + 1
              
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("A10") = True) Then
                
                contador = contador + 1
               
            End If
        
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A11" Or valuessheetDetalhado(i) = "A12") And contadorA1112 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A11-12") = True) Then
                
                contador = contador + 1
                
        End If
    End If
    End If
    
    If (valuessheetDetalhado(i) = "A13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A13") = True) Then
                
                contador = contador + 1
              
            End If
        End If
    End If
    
    If ((valuessheetDetalhado(i) = "A14" Or valuessheetDetalhado(i) = "A15" Or valuessheetDetalhado(i) = "P10" Or valuessheetDetalhado(i) = "P11") And contadorA1415P1011 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            If (findValue("A14-15 P10-11") = True) Then
                
                contador = contador + 1
               
            End If
       
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
     
            
            If (findValue("A17.16") = True) Then
                
                contador = contador + 1
              
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.21") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
                    
            If (findValue("A17.21") = True) Then
            
        contador = contador + 1
     
            End If
        
         End If
    End If
    
     If ((valuessheetDetalhado(i) = "A17.25" Or valuessheetDetalhado(i) = "A17.26") And contadorA172526 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("A17.25-26") = True) Then
                
                contador = contador + 1
                
            End If
        
        End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A17.31") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A17.31") = True) Then
                
                contador = contador + 1
              
            End If

        End If
    End If
    
    If (valuessheetDetalhado(i) = "P1") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
       
            If (findValue("P1") = True) Then
                
                contador = contador + 1
               
            End If
        
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("P3") = True) Then
                
               contador = contador + 1
               
            End If
        
        
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
    
            
            If (findValue("P4") = True) Then
                
                contador = contador + 1
               
            End If
     
        
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P8") = True) Then
                
                contador = contador + 1
                
            End If
        
        
    
        End If
    End If
    
    If (valuessheetDetalhado(i) = "P13.18") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P13.18") = True) Then
                
                contador = contador + 1
                
            End If
        
        
        End If
    End If
    
    
     If ((valuessheetDetalhado(i) = "D1" Or valuessheetDetalhado(i) = "D2") And contadorD1D2 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("D1-D2") = True) Then
                
                contador = contador + 1
                
            End If
        
        End If
    End If
    
    
    If (valuessheetDetalhado(i) = "D6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            If (findValue("D6") = True) Then
                
                 contador = contador + 1
               
            End If
      
    
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D7") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D7") = True) Then
                
                contador = contador + 1
                
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("D10") = True) Then
                
                contador = contador + 1
               
            End If
        
      
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D11") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D11") = True) Then
                
                contador = contador + 1
               
            End If

        End If
    End If
    
    If (valuessheetDetalhado(i) = "D13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D13") = True) Then
                
                contador = contador + 1
               
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D14") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D14") = True) Then
                
                contador = contador + 1
                
            End If
        
     
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("D16") = True) Then
                
        contador = contador + 1
           
            End If
        End If
    End If
    
    If (valuessheetDetalhado(i) = "D19") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            If (findValue("D19") = True) Then
                
                contador = contador + 1
               
            End If
        End If
    End If
    
    End If

Next i

If (contador > 0) Then
    
    haerros = True
    
Else

    haerros = False
    
End If

End Function

Sub ActualizarSheets()

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With


Dim pass As String
    pass = "bai_p"

If (ActiveSheet.ProtectContents = True) Then
    
    ActiveSheet.Unprotect Password:=pass
    
End If

If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then


'ActiveWindow.DisplayWorkbookTabs = False

Dim i As Long

Dim LastRow As Long

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With

Dim BalancesheetDetalhado() As Double

ReDim valuessheetDetalhado(LastRow)
ReDim BalancesheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        If IsNumeric(ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value) = True Then
            BalancesheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value
        Else
            BalancesheetDetalhado(i) = 0
        End If
    Next i
    
'----
'Acrescentei

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With


Dim erros As Long

erros = 0

Dim ContabilizarErros() As String
ReDim ContabilizarErros(LastRow)



'----


Dim contador As Long

contador = 0

Dim contadorA7P5 As Integer
contadorA7P5 = 0
Dim contadorA1112 As Integer
contadorA1112 = 0
Dim contadorA1415P1011 As Integer
contadorA1415P1011 = 0
Dim contadorA172526 As Integer
contadorA172526 = 0
Dim contadorD1D2 As Integer
contadorD1D2 = 0
Dim contadorBPE As Integer
contadorBPE = 0
Dim contadorJV As Integer
contadorJV = 0
Dim contadorPR As Integer
contadorPR = 0
Dim contadorEXTRAP As Integer
contadorEXTRAP = 0

Dim hyperLinkedShape As Shape




        If (findValue("Fluxos de Caixa") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "Fluxos de Caixa"
          With ThisWorkbook.Sheets("Fluxos de Caixa").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
          ThisWorkbook.Sheets("Fluxos de Caixa").Visible = xlSheetVisible
          Else
          ThisWorkbook.Sheets("Fluxos de Caixa").Visible = xlSheetVisible
          Sheets("Fluxos de Caixa").Tab.ColorIndex = xlColorIndexNone
          
        End If
        
        If (findValue("CP") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "CP"
          With ThisWorkbook.Sheets("CP").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
          ThisWorkbook.Sheets("CP").Visible = xlSheetVisible
          Else
          ThisWorkbook.Sheets("CP").Visible = xlSheetVisible
          Sheets("CP").Tab.ColorIndex = xlColorIndexNone
          
        End If
        
        If (findValue("Im|fffd|veis") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "Im|fffd|veis"
          With ThisWorkbook.Sheets("Im|fffd|veis").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            ThisWorkbook.Sheets("Im|fffd|veis").Visible = xlSheetVisible
          Else
            ThisWorkbook.Sheets("Im|fffd|veis").Visible = xlSheetVisible
            Sheets("Im|fffd|veis").Tab.ColorIndex = xlColorIndexNone
            
        End If
        
        
        If (ThisWorkbook.Sheets("BPE").Range("C4").Value <> "N|fffd|o") Then
             If (findValue("BPE") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "BPE"
                
                contadorBPE = 1
                contador = contador + 1
                
                With ThisWorkbook.Sheets("BPE").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("BPE").Tab.ColorIndex = xlColorIndexNone
                
              
            End If
            ThisWorkbook.Sheets("BPE").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("BPE").Visible = xlSheetVisible
        End If
             
             
             If (findValue("JV") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "JV"
                
                contadorJV = 1
                contador = contador + 1
                
             With ThisWorkbook.Sheets("JV").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
                ThisWorkbook.Sheets("JV").Visible = xlSheetVisible
            Else
                
                Sheets("JV").Tab.ColorIndex = xlColorIndexNone
                ThisWorkbook.Sheets("JV").Visible = xlSheetVisible
            End If
            
             If (findValue("PR") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "PR"
                
                contadorPR = 1
                contador = contador + 1
               
                With ThisWorkbook.Sheets("PR").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
                ThisWorkbook.Sheets("PR").Visible = xlSheetVisible
            Else
                ThisWorkbook.Sheets("PR").Visible = xlSheetVisible
                Sheets("PR").Tab.ColorIndex = xlColorIndexNone
            End If
            
             If (findValue("EXTRAP") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "EXTRAP"
                
                contadorEXTRAP = 1
                contador = contador + 1
               
            With ThisWorkbook.Sheets("EXTRAP").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
                ThisWorkbook.Sheets("EXTRAP").Visible = xlSheetVisible
            Else
                ThisWorkbook.Sheets("EXTRAP").Visible = xlSheetVisible
                Sheets("EXTRAP").Tab.ColorIndex = xlColorIndexNone
            End If


For i = LBound(valuessheetDetalhado) To UBound(valuessheetDetalhado)
   
    'Rotina check A1.5
    If (valuessheetDetalhado(i) = "A1.5") Then
        
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             
             ThisWorkbook.Sheets("A1.5").Visible = xlSheetVisible
             If (findValue("A1.5") = True) Then
             erros = erros + 1
                ContabilizarErros(erros) = "A1.5"
        contador = contador + 1
            With ThisWorkbook.Sheets("A1.5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A1.5").Tab.ColorIndex = xlColorIndexNone
            End If
            
            Else
            ThisWorkbook.Sheets("A1.5").Visible = xlSheetHidden
            End If
    End If
    
    'Rotina check A2.6
    If (valuessheetDetalhado(i) = "A2.6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A2.6") = True) Then
             erros = erros + 1
                ContabilizarErros(erros) = "A2.6"
                contador = contador + 1

        With ThisWorkbook.Sheets("A2.6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A2.6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A2.6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A2.6").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             
            If (findValue("A3") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A3"
                
                contador = contador + 1
                
            
       
        With ThisWorkbook.Sheets("A3").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A3").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A3").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A3").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
                    
            If (findValue("A4") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A4"
                
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A4").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A4").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A4").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A4").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A5") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A5"
                
        contador = contador + 1
                
            
        With ThisWorkbook.Sheets("A5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A5").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A5").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A5").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A6") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A6"
                
                contador = contador + 1
                
            
        With ThisWorkbook.Sheets("A6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A6").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A7" Or valuessheetDetalhado(i) = "P5") And contadorA7P5 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A7-P5") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A7-P5"
                
                contador = contador + 1
               
            
        With ThisWorkbook.Sheets("A7-P5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A7-P5").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A7-P5").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A7-P5").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A8") Then
        
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A8") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A8"
                
                contador = contador + 1
             
            
        With ThisWorkbook.Sheets("A8").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A8").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A8").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A8").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A9") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A9") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A9"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A9").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A9").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A9").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A9").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("A10") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A10"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("A10").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A10").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A10").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A10").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A11" Or valuessheetDetalhado(i) = "A12") And contadorA1112 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A11-12") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A11-12"
                contador = contador + 1
                
        With ThisWorkbook.Sheets("A11-12").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A11-12").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A11-12").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A11-12").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A13") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A13"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A13").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A13").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A13").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A13").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A14" Or valuessheetDetalhado(i) = "A15" Or valuessheetDetalhado(i) = "P10" Or valuessheetDetalhado(i) = "P11") And contadorA1415P1011 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            If (findValue("A14-15 P10-11") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A14-15 P10-11"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("A14-15 P10-11").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A14-15 P10-11").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A14-15 P10-11").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A14-15 P10-11").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
     
            
            If (findValue("A17.16") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.16"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A17.16").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.16").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.16").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.16").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.21") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
                    
            If (findValue("A17.21") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.21"
        contador = contador + 1
     
            With ThisWorkbook.Sheets("A17.21").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.21").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.21").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.21").Visible = xlSheetHidden
            End If
    End If
    
     If ((valuessheetDetalhado(i) = "A17.25" Or valuessheetDetalhado(i) = "A17.26") And contadorA172526 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("A17.25-26") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.25-26"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("A17.25-26").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.25-26").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.25-26").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.25-26").Visible = xlSheetHidden
            End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A17.31") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A17.31") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.31"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A17.31").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.31").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.31").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.31").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P1") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
       
            If (findValue("P1") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P1"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("P1").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P1").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P1").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P1").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("P3") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P3"
               contador = contador + 1
               
            With ThisWorkbook.Sheets("P3").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P3").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P3").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P3").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
    
            
            If (findValue("P4") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P4"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("P4").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P4").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P4").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P4").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P8") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P8"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("P8").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P8").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P8").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P8").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P13.18") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P13.18") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P13.18"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("P13.18").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P13.18").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P13.18").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P13.18").Visible = xlSheetHidden
            End If
    End If
    
    
     If ((valuessheetDetalhado(i) = "D1" Or valuessheetDetalhado(i) = "D2") And contadorD1D2 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("D1-D2") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D1-D2"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D1-D2").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D1-D2").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D1-D2").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D1-D2").Visible = xlSheetHidden
            End If
    End If
    
    
    If (valuessheetDetalhado(i) = "D6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            If (findValue("D6") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D6"
                 contador = contador + 1
               
            With ThisWorkbook.Sheets("D6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D6").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D7") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D7") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D7"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D7").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D7").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D7").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D7").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("D10") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D10"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D10").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D10").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D10").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D10").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D11") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D11") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D11"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D11").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D11").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D11").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D11").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D13") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D13"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D13").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D13").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D13").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D13").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D14") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D14") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D14"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D14").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D14").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D14").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D14").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("D16") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D16"
        contador = contador + 1
           
            With ThisWorkbook.Sheets("D16").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D16").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D16").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D16").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D19") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            If (findValue("D19") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D19"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D19").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D19").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D19").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D19").Visible = xlSheetHidden
            End If
    End If

Next i

'ActiveWindow.DisplayWorkbookTabs = True

End If

If (ActiveSheet.ProtectContents = False) Then
    
    ActiveSheet.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True
    
End If

With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

End Sub

Sub AntesdeFechar_ActualizarErros()

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With

If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then


'ActiveWindow.DisplayWorkbookTabs = False

Dim i As Long

Dim LastRow As Long

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With

Dim BalancesheetDetalhado() As Double

ReDim valuessheetDetalhado(LastRow)
ReDim BalancesheetDetalhado(LastRow)

    For i = 1 To LastRow
        
        valuessheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("C" & i).Value
        If IsNumeric(ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value) = True Then
            BalancesheetDetalhado(i) = ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value
        Else
            BalancesheetDetalhado(i) = 0
        End If
    Next i
    
'----
'Acrescentei

    With ThisWorkbook.Sheets("Detalhado")
        LastRow = .Cells(.Rows.Count, "C").End(xlUp).Row
    End With


Dim erros As Long

erros = 0

Dim ContabilizarErros() As String
ReDim ContabilizarErros(LastRow)



'----


Dim contador As Long

contador = 0

Dim contadorA7P5 As Integer
contadorA7P5 = 0
Dim contadorA1112 As Integer
contadorA1112 = 0
Dim contadorA1415P1011 As Integer
contadorA1415P1011 = 0
Dim contadorA172526 As Integer
contadorA172526 = 0
Dim contadorD1D2 As Integer
contadorD1D2 = 0
Dim contadorBPE As Integer
contadorBPE = 0
Dim contadorJV As Integer
contadorJV = 0
Dim contadorPR As Integer
contadorPR = 0
Dim contadorEXTRAP As Integer
contadorEXTRAP = 0

Dim hyperLinkedShape As Shape

        If (findValue("Fluxos de Caixa") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "Fluxos de Caixa"
          With ThisWorkbook.Sheets("Fluxos de Caixa").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With

          Else

          Sheets("Fluxos de Caixa").Tab.ColorIndex = xlColorIndexNone
          
        End If
        
        If (findValue("CP") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "CP"
          With ThisWorkbook.Sheets("CP").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With

          Else

          Sheets("CP").Tab.ColorIndex = xlColorIndexNone
          
        End If
        
        If (findValue("Im|fffd|veis") = True) Then
          erros = erros + 1
          ContabilizarErros(erros) = "Im|fffd|veis"
          With ThisWorkbook.Sheets("Im|fffd|veis").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With

          Else

            Sheets("Im|fffd|veis").Tab.ColorIndex = xlColorIndexNone
        End If
        
        
        If (ThisWorkbook.Sheets("BPE").Range("C4").Value <> "N|fffd|o") Then
             If (findValue("BPE") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "BPE"
                
                contadorBPE = 1
                contador = contador + 1
                
                With ThisWorkbook.Sheets("BPE").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("BPE").Tab.ColorIndex = xlColorIndexNone
                
              
            End If
            ThisWorkbook.Sheets("BPE").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("BPE").Visible = xlSheetHidden
        End If
             
             
             If (findValue("JV") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "JV"
                
                contadorJV = 1
                contador = contador + 1
                
             With ThisWorkbook.Sheets("JV").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("JV").Tab.ColorIndex = xlColorIndexNone
            End If
            
             If (findValue("PR") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "PR"
                
                contadorPR = 1
                contador = contador + 1
               
                With ThisWorkbook.Sheets("PR").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("PR").Tab.ColorIndex = xlColorIndexNone
            End If
            
             If (findValue("EXTRAP") = True) Then
                
                erros = erros + 1
                ContabilizarErros(erros) = "EXTRAP"
                
                contadorEXTRAP = 1
                contador = contador + 1
               
            With ThisWorkbook.Sheets("EXTRAP").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("EXTRAP").Tab.ColorIndex = xlColorIndexNone
            End If


For i = LBound(valuessheetDetalhado) To UBound(valuessheetDetalhado)
   
    'Rotina check A1.5
    If (valuessheetDetalhado(i) = "A1.5") Then
        
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             
             ThisWorkbook.Sheets("A1.5").Visible = xlSheetVisible
             If (findValue("A1.5") = True) Then
             erros = erros + 1
                ContabilizarErros(erros) = "A1.5"
        contador = contador + 1
            With ThisWorkbook.Sheets("A1.5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A1.5").Tab.ColorIndex = xlColorIndexNone
            End If
            
            Else
            ThisWorkbook.Sheets("A1.5").Visible = xlSheetHidden
            End If
    End If
    
    'Rotina check A2.6
    If (valuessheetDetalhado(i) = "A2.6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A2.6") = True) Then
             erros = erros + 1
                ContabilizarErros(erros) = "A2.6"
                contador = contador + 1

        With ThisWorkbook.Sheets("A2.6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A2.6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A2.6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A2.6").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
             
            If (findValue("A3") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A3"
                
                contador = contador + 1
                
            
       
        With ThisWorkbook.Sheets("A3").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A3").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A3").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A3").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
                    
            If (findValue("A4") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A4"
                
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A4").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A4").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A4").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A4").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A5") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A5") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A5"
                
        contador = contador + 1
                
            
        With ThisWorkbook.Sheets("A5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A5").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A5").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A5").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A6") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A6"
                
                contador = contador + 1
                
            
        With ThisWorkbook.Sheets("A6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A6").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A7" Or valuessheetDetalhado(i) = "P5") And contadorA7P5 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A7-P5") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A7-P5"
                
                contador = contador + 1
               
            
        With ThisWorkbook.Sheets("A7-P5").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A7-P5").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A7-P5").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A7-P5").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A8") Then
        
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A8") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A8"
                
                contador = contador + 1
             
            
        With ThisWorkbook.Sheets("A8").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A8").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A8").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A8").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A9") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A9") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A9"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A9").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A9").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A9").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A9").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("A10") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A10"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("A10").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A10").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A10").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A10").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A11" Or valuessheetDetalhado(i) = "A12") And contadorA1112 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("A11-12") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A11-12"
                contador = contador + 1
                
        With ThisWorkbook.Sheets("A11-12").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A11-12").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A11-12").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A11-12").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A13") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A13"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A13").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A13").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A13").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A13").Visible = xlSheetHidden
            End If
    End If
    
    If ((valuessheetDetalhado(i) = "A14" Or valuessheetDetalhado(i) = "A15" Or valuessheetDetalhado(i) = "P10" Or valuessheetDetalhado(i) = "P11") And contadorA1415P1011 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            If (findValue("A14-15 P10-11") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A14-15 P10-11"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("A14-15 P10-11").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A14-15 P10-11").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A14-15 P10-11").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A14-15 P10-11").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
     
            
            If (findValue("A17.16") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.16"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A17.16").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.16").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.16").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.16").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "A17.21") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
                    
            If (findValue("A17.21") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.21"
        contador = contador + 1
     
            With ThisWorkbook.Sheets("A17.21").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.21").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.21").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.21").Visible = xlSheetHidden
            End If
    End If
    
     If ((valuessheetDetalhado(i) = "A17.25" Or valuessheetDetalhado(i) = "A17.26") And contadorA172526 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("A17.25-26") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.25-26"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("A17.25-26").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.25-26").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.25-26").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.25-26").Visible = xlSheetHidden
            End If
    End If
    
    
    If (valuessheetDetalhado(i) = "A17.31") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            If (findValue("A17.31") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "A17.31"
                contador = contador + 1
              
            With ThisWorkbook.Sheets("A17.31").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("A17.31").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("A17.31").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("A17.31").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P1") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
       
            If (findValue("P1") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P1"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("P1").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P1").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P1").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P1").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P3") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("P3") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P3"
               contador = contador + 1
               
            With ThisWorkbook.Sheets("P3").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P3").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P3").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P3").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P4") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
    
            
            If (findValue("P4") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P4"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("P4").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P4").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P4").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P4").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P8") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P8") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P8"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("P8").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P8").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P8").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P8").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "P13.18") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("P13.18") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "P13.18"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("P13.18").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("P13.18").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("P13.18").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("P13.18").Visible = xlSheetHidden
            End If
    End If
    
    
     If ((valuessheetDetalhado(i) = "D1" Or valuessheetDetalhado(i) = "D2") And contadorD1D2 = 0) Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
            
            If (findValue("D1-D2") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D1-D2"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D1-D2").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D1-D2").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D1-D2").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D1-D2").Visible = xlSheetHidden
            End If
    End If
    
    
    If (valuessheetDetalhado(i) = "D6") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            If (findValue("D6") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D6"
                 contador = contador + 1
               
            With ThisWorkbook.Sheets("D6").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D6").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D6").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D6").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D7") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D7") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D7"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D7").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D7").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D7").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D7").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D10") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
       
            
            If (findValue("D10") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D10"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D10").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D10").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D10").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D10").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D11") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D11") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D11"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D11").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D11").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D11").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D11").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D13") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D13") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D13"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D13").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D13").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D13").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D13").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D14") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
        
        
            
            If (findValue("D14") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D14"
                contador = contador + 1
                
            With ThisWorkbook.Sheets("D14").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D14").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D14").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D14").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D16") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            
            If (findValue("D16") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D16"
        contador = contador + 1
           
            With ThisWorkbook.Sheets("D16").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D16").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D16").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D16").Visible = xlSheetHidden
            End If
    End If
    
    If (valuessheetDetalhado(i) = "D19") Then
        If ((ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> 0) And (ThisWorkbook.Sheets("Detalhado").Range("J" & i).Value <> "")) Then
            If (findValue("D19") = True) Then
                erros = erros + 1
                ContabilizarErros(erros) = "D19"
                contador = contador + 1
               
            With ThisWorkbook.Sheets("D19").Tab
                    .Color = 255
                    .TintAndShade = 0
                End With
            Else
                Sheets("D19").Tab.ColorIndex = xlColorIndexNone
            End If
            ThisWorkbook.Sheets("D19").Visible = xlSheetVisible
            Else
            ThisWorkbook.Sheets("D19").Visible = xlSheetHidden
            End If
    End If

Next i

'ActiveWindow.DisplayWorkbookTabs = True

End If

If ((ThisWorkbook.Sheets("Inputs").Range("F13").Value = "Semestral") And (ThisWorkbook.Sheets("Inputs").Range("F15").Value = "Integral")) Then

ThisWorkbook.Sheets("Overview").Columns("A").Clear

For i = 1 To UBound(ContabilizarErros)

ThisWorkbook.Sheets("Overview").Range("A" & i).Value = ContabilizarErros(i)
Next i

ThisWorkbook.Sheets("Overview").Range("$A$1:$A$30").RemoveDuplicates Columns:=1, Header:=xlNo

Else

ThisWorkbook.Sheets("Overview").Columns("A").Clear
End If


With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

End Sub

'Funcao que determina se um determinado shape existe retorna True se sim
Function shapeExists(shapeName As String, worksheetname As String) As Boolean

    Dim Sh As Shape
    For Each Sh In ThisWorkbook.Sheets(worksheetname).Shapes
         If Sh.Name = shapeName Then shapeExists = True
    Next Sh
End Function






Attribute VB_Name = "Module7"
Sub Button11_Click()

    Call Module6.main
    

End Sub
Sub Button12_Click()

    Call Module6.ApagarConteudoGeral

End Sub

Sub Button3_Click()
    Application.EnableEvents = False
    Application.Calculation = xlManual
    
    Call Module6.CorrerDetalhado
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic

End Sub

Sub Button4_Click()

    Call Module6.ApagarConteudoDetalhado

End Sub



Attribute VB_Name = "PrimeiraUtilizacao"
Sub PrimeiraUtiliza|fffd||fffd|o()


    ThisWorkbook.Sheets("Overview").Columns("A").Clear

    With ThisWorkbook.Sheets("Geral").Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
            With ThisWorkbook.Sheets("Geral").Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
    End With

    ThisWorkbook.Sheets("Geral").Shapes("Danger1").Visible = False
    ThisWorkbook.Sheets("Geral").Shapes("Danger2").Visible = False
    ThisWorkbook.Sheets("Geral").Shapes("Picture64").Visible = True


    With ThisWorkbook.Sheets("Detalhado").Shapes("Chevron67").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
            End With
            With ThisWorkbook.Sheets("Detalhado").Shapes("Pentagon63").Fill
            .Visible = msoTrue
            .ForeColor.RGB = RGB(0, 176, 240)
            .Transparency = 0.5
            .Solid
    End With

    ThisWorkbook.Sheets("Detalhado").Shapes("Danger1").Visible = False
    ThisWorkbook.Sheets("Detalhado").Shapes("Danger2").Visible = False
    ThisWorkbook.Sheets("Detalhado").Shapes("Picture64").Visible = True
    
    
End Sub

Sub hideShapes()


    ActiveSheet.Shapes("Round Same Side Corner Rectangle 56").Visible = False
    ActiveSheet.Shapes("Rectangle 57").Visible = False
    
    
    ActiveSheet.Shapes("Round Same Side Corner Rectangle 47").Visible = False
    ActiveSheet.Shapes("Rectangle 60").Visible = False
    ActiveSheet.Shapes("shapeCP").Visible = False
    ActiveSheet.Shapes("textboxCP").Visible = False
    ActiveSheet.Shapes("shapeFC").Visible = False
    ActiveSheet.Shapes("textboxCP").Visible = False
    ActiveSheet.Shapes("textboxFC").Visible = False
    ActiveSheet.Shapes("Rectangle 61").Visible = False

End Sub



Attribute VB_Name = "ProtectSheets"
Sub protect_all_sheets()


With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With

Dim pass As String

pass = "bai_p"

For Each s In ActiveWorkbook.Worksheets

If (s.ProtectContents = True) Then

Else

s.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True

End If
Next


With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

End Sub

Sub unprotect_all_sheets()
On Error Resume Next
'unpass = InputBox("password")

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With


Dim unpass As String
unpass = "bai_p"
For Each Worksheet In ActiveWorkbook.Worksheets

If (Worksheet.ProtectContents = True) Then
Worksheet.Unprotect Password:=unpass
End If

Next

With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With

End Sub






Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub CommandButton21_Click()
    UserForm1.show (vbModeless)
    
    UserForm1.Label1.Caption = "Actualiza|fffd||fffd|o em processamento"
    UserForm1.Repaint
    Application.ScreenUpdating = False
    Application.EnableEvents = False
    Application.Calculation = xlManual
    
    
    Call Module6.CorrerDetalhado
    Call Module6.CorrerGeral
    
    
    
    Call Module6.actualizarsidebar
    
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic
    Application.ScreenUpdating = True
    Unload UserForm1
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"

End Sub

Private Sub CommandButton22_Click()
    Application.EnableEvents = False
    Application.Calculation = xlManual

    Call Module6.ApagarConteudoDetalhado
    Call Module6.CleanGeral
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"
    
End Sub





Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub CommandButton21_Click()
    Application.EnableEvents = False
    Application.Calculation = xlManual
    
    Call Module6.CorrerDetalhado
    Call Module6.CorrerGeral
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic
    
    
    Call Module6.actualizarsidebar
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"
End Sub

Private Sub CommandButton22_Click()
    Application.EnableEvents = False
    Application.Calculation = xlManual

    Call Module6.ApagarConteudoDetalhado
    Call Module6.CleanGeral
    
    Application.EnableEvents = True
    Application.Calculation = xlAutomatic
    
    MsgBox "Ac|fffd||fffd|o conclu|fffd|da"
    
End Sub


Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub Worksheet_Change(ByVal Target As Range)
    If Target.Address = "$C$4" Then
        If (ThisWorkbook.Sheets("BPE").Range("C4").Value = "Sim") Then
            
            ThisWorkbook.Sheets("BPE").Rows("6:120").EntireRow.Hidden = False
            
        Else
            
            ThisWorkbook.Sheets("BPE").Rows("6:120").EntireRow.Hidden = True
        
        End If
    End If
End Sub

Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub Worksheet_Change(ByVal Target As Range)
    
    Dim numero As Integer
    
    If Target.Address = "$C$7" Then
        
    If IsNumeric(ThisWorkbook.Sheets("PR").Range("C7").Value) = True Then
        numero = ThisWorkbook.Sheets("PR").Range("C7").Value
        
        If (((13 + numero) < 0) Or ((52 - numero) <= 13)) Then
            MsgBox "Numero de Linhas excedido"
        Else
            
            ThisWorkbook.Sheets("PR").Rows("13:52").EntireRow.Hidden = False
            ThisWorkbook.Sheets("PR").Rows("13:" & (52 - numero)).EntireRow.Hidden = True
        End If
    Else
        
        MsgBox "O valor introduzido n|fffd|o |fffd| um n|fffd|mero"
    
    End If
    
    End If
End Sub






Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub CommandButton21_Click()
    
    'Activar TopBar
    
    'Intercompanhias
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Intercompanhias").Shapes("Rectangle 61").Visible = True
    
    'Balancete
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Balancete").Shapes("Rectangle 61").Visible = True

    'Inputs
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 48").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 52").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 49").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 53").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 50").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 55").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 51").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 54").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 56").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 57").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 58").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 59").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Round Same Side Corner Rectangle 47").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 60").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("shapeCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("shapeFC").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxCP").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("textboxFC").Visible = True
    ThisWorkbook.Sheets("Inputs").Shapes("Rectangle 61").Visible = True
    
    ThisWorkbook.Sheets("Geral").Activate
    
    
End Sub



Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub Worksheet_Change(ByVal Target As Range)

Dim stringFinal As String
Dim i As Long
Dim LastRow As Long

If Not Application.Intersect(Range("E35:F38"), Range(Target.Address)) Is Nothing Then
    
    With ThisWorkbook.Sheets("Overview")
        LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    End With
    
    For i = 1 To LastRow
        If (ThisWorkbook.Sheets("Overview").Range("A" & i).Value <> "") Then
        If (stringFinal = "") Then
        stringFinal = ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        Else
        stringFinal = stringFinal & ", " & ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        End If
        End If
    Next i
    If (stringFinal <> "") Then
        ThisWorkbook.Sheets("Sign off").Range("E35:F38").Locked = True
        MsgBox "Ainda existem erros nos detalhes :" & stringFinal
    Else
        ThisWorkbook.Sheets("Sign off").Range("E35:F38").Locked = False
    End If

End If

End Sub



Private Sub CommandButton21_Click()
    ThisWorkbook.Sheets("Inputs").Activate
End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
Dim stringFinal As String
Dim i As Long
Dim LastRow As Long

If Not Application.Intersect(Range("E35:F38"), Range(Target.Address)) Is Nothing Then
    
    With ThisWorkbook.Sheets("Overview")
        LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    End With
    
    For i = 1 To LastRow
        If (ThisWorkbook.Sheets("Overview").Range("A" & i).Value <> "") Then
        If (stringFinal = "") Then
        stringFinal = ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        Else
        stringFinal = stringFinal & ", " & ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        End If
        End If
    Next i
    If (stringFinal <> "") Then
        ThisWorkbook.Sheets("Sign off").Range("E35:F38").Locked = True
        MsgBox "Ainda existem erros nos detalhes :" & stringFinal
    Else
        ThisWorkbook.Sheets("Sign off").Range("E35:F38").Locked = False
    End If

End If
End Sub


Attribute VB_Name = "Sheet42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub CommandButton21_Click()
    
    If (ThisWorkbook.Sheets("Balancete").Range("A50").Value <> "1") Then
    
        ThisWorkbook.Sheets("Balancete").Range("A50").Value = "1"
        
        For Each shp1 In ThisWorkbook.Sheets("Intercompanhias").Shapes
          If (shp1.Name <> "CommandButton21" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52" And shp1.Name <> "Round Same Side Corner Rectangle 58" And shp1.Name <> "Rectangle 59") Then
            ThisWorkbook.Sheets("Intercompanhias").Shapes(shp1.Name).Visible = False
          End If
        Next shp1
        
        
        ThisWorkbook.Sheets("Intercompanhias").Activate
        
    Else
        
        For Each shp1 In ThisWorkbook.Sheets("Intercompanhias").Shapes
          If (shp1.Name <> "CommandButton21" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52" And shp1.Name <> "Round Same Side Corner Rectangle 58" And shp1.Name <> "Rectangle 59") Then
            ThisWorkbook.Sheets("Intercompanhias").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
    
    ThisWorkbook.Sheets("Intercompanhias").Activate
        
    End If
        
End Sub

Attribute VB_Name = "Sheet43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Public sheetname As String

Private Sub CommandButton21_Click()

    If (ThisWorkbook.Sheets("Inputs").Range("A50").Value <> "7") Then
        
        MsgBox "Preenchimento em falta"
    
    Else
        
        
        For Each shp1 In ThisWorkbook.Sheets("Balancete").Shapes
          If (shp1.Name <> "CommandButton21" And shp1.Name <> "Rectangle 55" And shp1.Name <> "Round Same Side Corner Rectangle 50" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52") Then
            ThisWorkbook.Sheets("Balancete").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
        
        ThisWorkbook.Sheets("Balancete").Activate
        
    End If
        
End Sub


Private Sub Worksheet_Activate()


With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With


If (ThisWorkbook.Sheets("Inputs").Range("A50").Value <> "7") Then

    For Each shp1 In ThisWorkbook.Sheets("Inputs").Shapes
          If (shp1.Name <> "Button 10" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52") Then
            ThisWorkbook.Sheets("Inputs").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
    ActiveSheet.Shapes("textboxCP").Visible = False
    
'Else
    
   ' For Each shp1 In ThisWorkbook.Sheets("Inputs").Shapes

'          ThisWorkbook.Sheets("Inputs").Shapes(shp1.Name).Visible = True
            
'    Next shp1
    
End If



With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With



End Sub

Attribute VB_Name = "Sheet45"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet46"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Option Explicit

Private Sub Workbook_Open()
'On Error Resume Next

'Call ProtectSheets.protect_all_sheets


'ThisWorkbook.Sheets("Inputs").Activate '---- Retirei para ele nao iniciar na sheet dos inputs

With Application
    .Calculation = xlManual
    .DisplayStatusBar = False
    .ScreenUpdating = False
    .EnableEvents = False
End With

Dim pass As String
    pass = "bai_p"
    


'ActiveSheet.Unprotect Password:=pass
    
ActiveSheet.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True

Dim shp1 As Shape

If (ThisWorkbook.Sheets("Inputs").Range("A50").Value <> "7") Then

   ThisWorkbook.Sheets("Balancete").Visible = xlSheetHidden
   ThisWorkbook.Sheets("Detalhado").Visible = xlSheetHidden
   ThisWorkbook.Sheets("Geral").Visible = xlSheetHidden
   ThisWorkbook.Sheets("Intercompanhias").Visible = xlSheetHidden

    For Each shp1 In ThisWorkbook.Sheets("Inputs").Shapes
          If (shp1.Name <> "Button 10" And shp1.Name <> "Round Same Side Corner Rectangle 49" And shp1.Name <> "Rectangle 53" And shp1.Name <> "Round Same Side Corner Rectangle 48" And shp1.Name <> "Rectangle 52") Then
            ThisWorkbook.Sheets("Inputs").Shapes(shp1.Name).Visible = False
          End If
    Next shp1
    ActiveSheet.Shapes("textboxCP").Visible = False
    
Else
    
    For Each shp1 In ThisWorkbook.Sheets("Inputs").Shapes

          ThisWorkbook.Sheets("Inputs").Shapes(shp1.Name).Visible = True
            
    Next shp1
    
End If

Dim stringFinal As String
    Dim i As Long
    Dim LastRow As Long
    
    With ThisWorkbook.Sheets("Overview")
        LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    End With
    
    For i = 1 To LastRow
        If (ThisWorkbook.Sheets("Overview").Range("A" & i).Value <> "") Then
        If (stringFinal = "") Then
        stringFinal = ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        Else
        stringFinal = stringFinal & ", " & ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        End If
        End If
    Next i
    If (stringFinal <> "") Then
    MsgBox "Desde a ultima actualiza|fffd||fffd|o ainda existem erros nos seguintes detalhes: " & stringFinal
    Else
    
    End If
    
    
    With Application
    .Calculation = xlAutomatic
    .DisplayStatusBar = True
    .ScreenUpdating = True
    .EnableEvents = True
    .Calculate
End With
    
End Sub


Private Sub Workbook_BeforeClose(Cancel As Boolean)
    On Error Resume Next
    Dim stringFinal As String
    Dim i As Long
    Dim LastRow As Long
    
    Call Module6.AntesdeFechar_ActualizarErros
    
    With ThisWorkbook.Sheets("Overview")
        LastRow = .Cells(.Rows.Count, "A").End(xlUp).Row
    End With
    
    For i = 1 To LastRow
        If (ThisWorkbook.Sheets("Overview").Range("A" & i).Value <> "") Then
        If (stringFinal = "") Then
        stringFinal = ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        Else
        stringFinal = stringFinal & ", " & ThisWorkbook.Sheets("Overview").Range("A" & i).Value
        End If
        End If
    Next i
    If (stringFinal <> "") Then
    MsgBox "Ainda existem erros nos seguintes detalhes: " & stringFinal
    Else
    
    End If
    'Call ProtectSheets.unprotect_all_sheets
    
    
    
End Sub

Private Sub Workbook_SheetActivate(ByVal Sh As Object)
    
     Dim pass As String
    pass = "bai_p"
        

    If (ActiveSheet.ProtectContents = True) Then
    
    
    Else
    ActiveSheet.Protect Password:=pass, DrawingObjects:=True, Contents:=True, Scenarios:=True, _
          AllowFormattingCells:=True, AllowFormattingColumns:=True, _
          AllowFormattingRows:=True, AllowSorting:=True, AllowFiltering:=True, UserInterFaceOnly:=True
    
    End If
    
    Dim ws As Worksheet
    Dim Findstring As String
    Dim Rng As Range
    Findstring = "Erro"
    
    For Each ws In ThisWorkbook.Worksheets
    
    If Trim(Findstring) = "Erro" And ws.Visible = True Then
        With ws.Range("A3:AC2000")
            Set Rng = .Find(What:=Findstring, _
                            After:=.Cells(.Cells.Count), _
                            LookIn:=xlValues, _
                            LookAt:=xlWhole, _
                            SearchOrder:=xlByRows, _
                            SearchDirection:=xlNext, _
                            MatchCase:=False)
            If Not Rng Is Nothing Then
                        With ws
            .Tab.ColorIndex = 3
        End With

            Else
            ws.Tab.ColorIndex = xlColorIndexNone

            End If
        
        End With
    End If
Next ws
    
    

End Sub



Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{EFEF2B86-0130-496C-AE17-F0C23D9566C0}{D917F840-AD3B-4C5E-BC4B-23D3FEB11D95}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False


' InQuest injected base64 decoded content
' jxbj
' jxbj
' ^"{^
' J'^m

INQUEST-PP=macro
