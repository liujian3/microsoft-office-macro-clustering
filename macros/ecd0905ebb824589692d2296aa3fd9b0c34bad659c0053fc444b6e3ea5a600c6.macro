Attribute VB_Name = "HSC5"
Public Function Units(Tstr As String, Wstr As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Units = oAdd.Unitsadd(Tstr, Wstr)
End Function
Public Function H(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   H = oAdd.Hadd(Spec, T)
End Function
Public Function HCM(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   HCM = oAdd.HCMadd(Spec, T)
End Function
Public Function HNM3(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   HNM3 = oAdd.HCMadd(Spec, T)
End Function
Public Function HKG(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   HKG = oAdd.HKGadd(Spec, T)
End Function
Public Function S(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   S = oAdd.Sadd(Spec, T)
End Function
Public Function G(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   G = oAdd.Gadd(Spec, T)
End Function
Public Function K(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   K = oAdd.Kadd(Spec, T)
End Function
Public Function MW(Spec As String) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   MW = oAdd.MWadd(Spec)
End Function
Public Function HLAT(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   HLAT = oAdd.LATHadd(Spec, T)
End Function
Public Function DE(Spec As String) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   DE = oAdd.Deadd(Spec)
End Function
Public Function REF(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   REF = oAdd.REFadd(Spec)
End Function
Public Function CP(Spec As String, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   CP = oAdd.Cadd(Spec, T)
End Function
Public Function BP(Spec As String) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   BP = oAdd.BPadd(Spec)
End Function
Public Function MP(Spec As String) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   MP = oAdd.MPadd(Spec)
End Function
Public Function Struct(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Struct = oAdd.Structadd(Spec)
End Function
Public Function ChName(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   ChName = oAdd.ChNameadd(Spec)
End Function
Public Function CoName(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   CoName = oAdd.CoNameadd(Spec)
End Function
Public Function CAN(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   CAN = oAdd.CANadd(Spec)
End Function
Public Function Phase(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Phase = oAdd.Phaseadd(Spec)
End Function
Public Function RGBColor(Spec As String) As String
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   RGBColor = oAdd.RGBColoradd(Spec)
End Function
Public Function Solu(Spec As String) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Solu = oAdd.Soluadd(Spec)
End Function
Public Function Rel(Spec As String) As Integer
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Rel = oAdd.Reladd(Spec)
End Function
Public Function TatH(Spec As String, H As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   TatH = oAdd.TatHadd(Spec, H)
End Function
Public Function TatS(Spec As String, S As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   TatS = oAdd.TatSadd(Spec, S)
End Function
Public Function TatCP(Spec As String, CP As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   TatCP = oAdd.TatCPadd(Spec, CP)
End Function
Public Function TatG(Spec As String, G As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   TatG = oAdd.TatGadd(Spec, G)
End Function
'Public Function SPNAME(index As Integer) As String
'   Dim oAdd As Object
'   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
'   SPNAME = oAdd.SPNAMEadd(index)
'End Function
'Public Function SPPHASE(Spec As String, T As Double) As String
'   Dim oAdd As Object
'   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
'   SPPHASE = oAdd.SPPHASEadd(Spec, T)
'End Function
'Public Function SPDATABASE() As String
'   Dim oAdd As Object
'   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
'   SPDATABASE = oAdd.SPDATABASEadd()
'End Function
Public Function FlowH(Spec As Range, Amount As Range, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Dim cl As Range
   Dim length As Integer
   For Each cl In Spec.Cells
     length = length + 1
   Next cl
   FlowH = oAdd.FlowHadd(Spec, Amount, T, length)
End Function
Public Function FlowS(Spec As Range, Amount As Range, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Dim cl As Range
   Dim length As Integer
   For Each cl In Spec.Cells
     length = length + 1
   Next cl
   FlowS = oAdd.FlowSadd(Spec, Amount, T, length)
End Function
Public Function FlowCP(Spec As Range, Amount As Range, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Dim cl As Range
   Dim length As Integer
   For Each cl In Spec.Cells
     length = length + 1
   Next cl
   FlowCP = oAdd.FlowCPadd(Spec, Amount, T, length)
End Function
Public Function FlowG(Spec As Range, Amount As Range, T As Double) As Double
   Dim oAdd As Object
   Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
   Dim cl As Range
   Dim length As Integer
   For Each cl In Spec.Cells
     length = length + 1
   Next cl
   FlowG = oAdd.FlowGadd(Spec, Amount, T, length)
End Function
Public Function MolP(Spec1 As String, Spec2 As String) As Double
  Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  MolP = oAdd.MolPadd(Spec1, Spec2)
End Function
Public Function WTP(Spec1 As String, Spec2 As String) As Double
  Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  WTP = oAdd.WTPadd(Spec1, Spec2)
End Function
Public Function CPA(Spec As String) As Double
  Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  CPA = oAdd.CPAadd(Spec)
End Function
Public Function CPB(Spec As String) As Double
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  CPB = oAdd.CPBadd(Spec)
End Function
Public Function CPC(Spec As String) As Double
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  CPC = oAdd.CPCadd(Spec)
End Function
Public Function CPD(Spec As String) As Double
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  CPD = oAdd.CPDadd(Spec)
End Function
Public Function CPFUNCTION(Spec As String) As String
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  CPFUNCTION = oAdd.CPFUNCTIONadd(Spec)
End Function
Public Function TMIN(Spec As String) As Double
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  TMIN = oAdd.TMINadd(Spec)
End Function
Public Function TMAX(Spec As String) As Double
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  TMAX = oAdd.TMAXadd(Spec)
End Function
Public Function BAL(Reaction As String) As String
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  BAL = oAdd.BALadd(Reaction)
End Function
Public Function SPECIES(DBN As Integer, Po As Long) As String
Dim oAdd As Object
  Set oAdd = Application.COMAddIns.Item("HSC5_Excel.Connect").Object
  SPECIES = oAdd.Speciesadd(DBN, Po)
End Function


Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_AddinInstall()

' Update and check whether dll link is successful
Application.COMAddIns.Update
For counter& = 1 To Application.COMAddIns.Count
  If Application.COMAddIns.Item(counter&) = "HSC5 Excel" Then Exit For
Next counter&

If counter& = Application.COMAddIns.Count + 1 Then ' dll link failed
  On Error Resume Next
  TaskID& = Shell("regsvr32 -s HSC5_Excel.dll", 1)    ' Try to register
  If Err <> 0 Then
    MsgBox "HSC 5.0 worksheet functions installation failed!" & Chr(10) & Chr(10) & _
           "Please make sure that the file HSC5_Excel.dll is in your Windows system directory."
  Else
    ActiveWorkbook.ChangeLink Name:="HSC5.xla", NewName:="HSC5.xla", Type:=xlExcelLinks
    MsgBox "HSC 5.0 worksheet functions installation successful!"
  End If
Else                                               ' dll link successful
  On Error Resume Next
  ActiveWorkbook.ChangeLink Name:="HSC5.xla", NewName:="HSC5.xla", Type:=xlExcelLinks
  MsgBox "HSC 5.0 worksheet functions installation successful!"
  Application.CalculateFull
End If

End Sub

Private Sub Workbook_AddinUninstall()

TaskID& = Shell("regsvr32 -s -u HSC5_Excel.dll", 1) ' Unregister

End Sub


INQUEST-PP=macro
