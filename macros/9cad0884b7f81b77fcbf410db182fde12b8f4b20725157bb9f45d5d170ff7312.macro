Attribute VB_Name = "DOP"
Attribute VB_Base = "0{2A2C534E-2D7B-4B3A-8F4A-A0882894BB29}{8EB5826E-9989-4B75-938B-E8ABF1DD6DF4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Const n = 9
Dim i As Integer
Private Sub cm_2_Click()
Unload Me
DoEvents
Form_Redaktirov.Show
End Sub
Private Sub cm_3_Click()
Unload Me
DoEvents
DOP_arh.Show
End Sub
Private Sub cm_4_Click()
Unload Me
DoEvents
frm_Praise.Show
End Sub
Private Sub cm_5_Click()
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd||fffd|").Visible = True
Sheets("|fffd||fffd||fffd||fffd|").Select
End Sub
Private Sub cm_6_Click()
Unload Me
DoEvents
Form_.Show
End Sub
Private Sub cm_7_Click()
On Error Resume Next
Unload Me
DoEvents
Form_set_password.Show
End Sub
Private Sub cm_9_Click()
On Error Resume Next
Unload Me
DoEvents
Call msg_demo
End Sub
Private Sub cm_1_Click()
On Error Resume Next
Unload Form_Cr
Unload Praise
Unload PraisePr
Unload Me
DoEvents
fSet.Show
End Sub
Private Sub cm_1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_1.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_2.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_3_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_3.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_4.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_5_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_5.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_6.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_7.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_8.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_9.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_8_Click()
Unload Me
DoEvents
DOP_otch.Show
End Sub
Private Sub Label10_Click()
Unload Me
DoEvents
fSet.Show
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Me.StartUpPosition = 0
Me.Top = Application.Top - 5
Me.Left = Application.Left
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Me.Controls("cm_" & i).ForeColor = RGB(255, 255, 255)
Next
If Sheets("setting").Range("z1") = 1 Then
Me.Height = 370
Else
Me.Height = 330
End If
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
End Sub
Attribute VB_Name = "DOP_arh"
Attribute VB_Base = "0{2F4E145E-01AF-44D7-B772-3D1E540C5388}{4C0C10E3-9BE6-4920-9D33-C8D081400D7A}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Const n = 3
Private Sub cm_1_Click()
On Error Resume Next
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True: Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|").Select
With ThisWorkbook.Sheets("setting")
If .Range("b7") = 1 Then
Cells(1, AzkSkid).EntireColumn.Hidden = False
Else
Cells(1, AzkSkid).EntireColumn.Hidden = True
End If
If .Range("b8") = 1 Then
Cells(1, AzkDost).EntireColumn.Hidden = False
Else
Cells(1, AzkDost).EntireColumn.Hidden = True
End If
If .Range("b7") = 0 And .Range("b8") = 0 Then
Cells(1, AzkSumSk).EntireColumn.Hidden = True
Else
Cells(1, AzkSumSk).EntireColumn.Hidden = False
End If
If .Range("i22") = 1 Then
Cells(1, AzkAdr).EntireColumn.Hidden = False
Else
Cells(1, AzkAdr).EntireColumn.Hidden = True
End If
If .Range("i23") = 1 Then
Cells(1, AzkTlf).EntireColumn.Hidden = False
Else
Cells(1, AzkTlf).EntireColumn.Hidden = True
End If
If .Range("b6") = 1 Then
Cells(1, AzkCod).EntireColumn.Hidden = False
Else
Cells(1, AzkCod).EntireColumn.Hidden = True
End If
If .Range("b5") = 1 Then
Cells(1, AzkEd).EntireColumn.Hidden = False
Else
Cells(1, AzkEd).EntireColumn.Hidden = True
End If
End With
ActiveWorkbook.Save
End Sub
Private Sub cm_2_Click()
On Error Resume Next
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True: Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Select
End Sub
Private Sub cm_3_Click()
On Error Resume Next
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Visible = True: Sheets("|fffd||fffd||fffd|-|fffd||fffd||fffd||fffd|").Select
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Me.StartUpPosition = 0
Me.Top = Application.Top + 50
Me.Left = Application.Left + 100
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Me.Controls("cm_" & i).ForeColor = RGB(255, 255, 255)
Next
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
End Sub
Private Sub cm_1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_1.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_2.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_3_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_3.BackColor = RGB(128, 128, 128)
End Sub
Attribute VB_Name = "DOP_otch"
Attribute VB_Base = "0{AAF0C14F-E80E-44A9-A354-482FD31ECE58}{BD23AD34-B64C-4E74-BAB7-766C210E9067}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Const n = 2
Private Sub cm_1_Click()
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Select
show_frm_Otch
End Sub
Private Sub cm_2_Click()
Unload Me
DoEvents
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Select
show_frm_Otch
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Me.StartUpPosition = 0
With DOP
Me.Top = .Top + 100
Me.Left = .Left + .Width
End With
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Me.Controls("cm_" & i).ForeColor = RGB(255, 255, 255)
Next
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
End Sub
Private Sub cm_1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_1.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_2.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_3_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_3.BackColor = RGB(128, 128, 128)
End Sub
Private Sub cm_4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To n
Me.Controls("cm_" & i).BackColor = RGB(58, 110, 165)
Next
cm_4.BackColor = RGB(128, 128, 128)
End Sub

Attribute VB_Name = "Form_"
Attribute VB_Base = "0{812ECEE6-2E7B-4317-92FA-769590109605}{2425560B-C47F-45AF-B7FE-79A5B3641BB4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label2_Click()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
DoEvents
ThisWorkbook.FollowHyperlink "http://sklad-excel.ru/all_versionssclad_81/"
If Err Then Unload Waite: DoEvents: MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 48, " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Unload Waite
End Sub
Private Sub Label2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label2.ForeColor = &HC000&
End Sub
Private Sub Label25_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label25.ForeColor = &HC000&
End Sub
Private Sub MultiPage1_MouseMove(ByVal Index As Long, ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label2.ForeColor = RGB(0, 0, 0)
End Sub
Private Sub Label18_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label25.ForeColor = RGB(0, 0, 0)
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label2.ForeColor = RGB(0, 0, 0)
Label25.ForeColor = RGB(0, 0, 0)
End Sub
Private Sub Label25_Click()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
DoEvents
ThisWorkbook.FollowHyperlink "http://www.fort168.hut.ru/pages/programs/prodag/zakaz_prog.html"
If Err Then Unload Waite: DoEvents: MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 48, " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Unload Waite
End Sub
Attribute VB_Name = "Form_Cr"
Attribute VB_Base = "0{7DDFF07D-32A9-4427-9AD1-7760B51F7D4A}{9AC5E262-11D6-4B5E-ABAB-CA392F6BFBAF}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
color_Cr
End Sub
Private Sub OK2_Click()
color_No
End Sub
Private Sub OptionButton1_Click()
With Sheets("setting")
If OptionButton1.Value = True Then .Range("i3") = skDs
End With
End Sub
Private Sub OptionButton2_Click()
With Sheets("setting")
If OptionButton2.Value = True Then .Range("i3") = skOst
End With
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
OK.BackColor = RGB(55, 96, 145)
OK.ForeColor = RGB(255, 255, 255)
OK2.BackColor = RGB(55, 96, 145)
OK2.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
With Sheets("setting")
If .Range("i3") = skDs Then OptionButton1.Value = True
If .Range("i3") = skOst Then OptionButton2.Value = True
End With
End Sub

Attribute VB_Name = "Form_Enter"
Attribute VB_Base = "0{8AD189A1-C957-4B1E-9D61-9AA9B6EB9141}{5A70D446-4475-4464-8A40-BD18BD988297}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim col As Long
Dim col_All As Long
Dim nm()
Dim cod()
Dim gr()
Dim cnZ()
Dim cnR()
Dim ed()
Dim cc()
Dim c()
Dim ind
Dim grNm As String
Dim flag As Byte
Dim flag_prc As Byte
Dim flag_R As Byte
Const h1 = 118
Const h2 = 138
Dim iCol As Long
Dim str_ As String
Dim textS As String
Private Sub Comb_Find_Click()
On Error Resume Next
With Comb_Find
ind = .ListIndex
If ind = -1 Then Exit Sub
TextBox7.Text = .List(ind, 1)
TextBox3.Text = .List(ind, 2)
TextBox5.Text = format(.List(ind, 3), "0.00")
TextBox6.Text = format(.List(ind, 4), "0.00")
TextBox2.Text = .List(ind, 0)
End With
End Sub
Private Sub Comb_Z_Change()
flag_prc = 0
flag_R = 0
TextBox8.Visible = True
TextBox8.Value = Comb_Z.Value
TextBox8.SetFocus
End Sub
Private Sub ico_Click()
With fSetPr
.Show
.StartUpPosition = 0
.Top = Me.Top
.Left = Me.Left
End With
End Sub
Private Sub TextBox2_Change()
On Error Resume Next
If flag = 1 Then Exit Sub
Comb_Nm.SetFocus
Call find_zv
If Val(Comb_Find.ListCount) > 0 Then Comb_Find.DropDown
End Sub
Sub find_zv()
On Error Resume Next
Dim r As Long
Dim j As Long
Dim i As Long
iCol = 0
str_ = Me.TextBox2.Text
If Len(str_) = 0 Then
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
Exit Sub
End If
If col_All = 0 Then
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
Exit Sub
End If
ReDim aa(LBound(c) To UBound(c), 1 To 5)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If UCase(Left(c(i, 1), 1)) = textS Then
aa(i, 1) = c(i, 1)
aa(i, 2) = c(i, 2)
aa(i, 3) = c(i, 3)
aa(i, 4) = c(i, 4)
aa(i, 5) = c(i, 5)
iCol = iCol + 1
End If
Else
If InStr(1, UCase(c(i, 1)), textS) > 0 Then
aa(i, 1) = c(i, 1)
aa(i, 2) = c(i, 2)
aa(i, 3) = c(i, 3)
aa(i, 4) = c(i, 4)
aa(i, 5) = c(i, 5)
iCol = iCol + 1
End If
End If
Next
If iCol = 0 Then
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
DoEvents
Exit Sub
End If
ReDim w(1 To iCol, 1 To 5)
j = 1
For i = LBound(aa) To UBound(aa)
If aa(i, 1) <> "" Then
w(j, 1) = aa(i, 1)
w(j, 2) = aa(i, 2)
w(j, 3) = aa(i, 3)
w(j, 4) = aa(i, 4)
w(j, 5) = aa(i, 5)
j = j + 1
End If
Next
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
DoEvents
Comb_Find.List = w
End Sub
Private Sub Comb_Nm_Click()
On Error Resume Next
flag = 1
Me.Comb_Find.Clear
With Comb_Nm
ind = .ListIndex
If ind = -1 Then Exit Sub
TextBox2.Text = .List(ind, 0)
TextBox7.Text = .List(ind, 1)
TextBox3.Text = .List(ind, 2)
TextBox5.Text = format(.List(ind, 3), "0.00")
TextBox6.Text = format(.List(ind, 4), "0.00")
End With
flag = 0
End Sub
Private Sub Comb_|fffd||fffd||fffd||fffd||fffd||fffd|_Change()
On Error Resume Next
Dim row1 As Long
Dim row2 As Long
Dim j As Long
Dim i As Long
ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex
If ind = -1 Then Exit Sub
Comb_Nm.Clear
row1 = 0
row2 = 0
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0) = "new" Then
TextBox1.Text = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
Exit Sub
End If
On Error GoTo 12
row1 = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0) + 1
row2 = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind + 1, 0) - 1
12
If row2 = 0 Then row2 = UBound(c)
ReDim aa(1 To row2 - row1 + 1, 1 To 5)
j = 1
For i = row1 To row2
aa(j, 1) = c(i, 1)
aa(j, 2) = c(i, 2)
aa(j, 3) = c(i, 3)
aa(j, 4) = c(i, 4)
aa(j, 5) = c(i, 5)
j = j + 1
Next
Comb_Nm.List = aa
TextBox1.Text = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
TextBox2.Text = ""
TextBox3.Text = ""
TextBox5.Text = ""
TextBox6.Text = ""
TextBox7.Text = ""
End Sub
Private Sub OK_Click()
On Error Resume Next
ThisWorkbook.Activate
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
Dim tovar As String
Dim cell As Range
If TextBox2.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd|"
TextBox2.SetFocus
Exit Sub
End If
If TextBox4.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd|", 64, "|fffd||fffd||fffd||fffd|"
TextBox4.SetFocus
Exit Sub
End If
Dim r As Long
Dim rr As Long
grNm = TextBox1.Text
If grNm = "" Then grNm = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
tovar = TextBox2.Text
r = Cells(Rows.Count, prNm).End(xlUp).Row + 1
If r < 11 Then r = 11: GoTo 22
22
Cells(r, prNm) = TextBox2.Text
Cells(r, prCod) = TextBox7.Text
Cells(r, prEd) = TextBox3.Text
Cells(r, prCol) = Val(TextBox4)
Cells(r, prGr) = grNm
Cells(r, prCenaZ).Value = Replace(TextBox5, ",", ".")
Cells(r, prCenaZ).NumberFormat = "#,##0.00"
Cells(r, prCenaR).Value = Replace(TextBox6, ",", ".")
Cells(r, prCenaR).NumberFormat = "#,##0.00"
With Range(Cells(r, prNm), Cells(r, prSum))
.Borders.LineStyle = True
.Borders.Color = RGB(174, 185, 173)
.Font.Size = 11
End With
With Range(Cells(r, prGr), Cells(r, prGr))
.Borders.LineStyle = True
.Borders.Color = RGB(174, 185, 173)
.Font.Size = 11
End With
With Range(Cells(r, prNm), Cells(r, prNm))
.WrapText = True
.Rows.AutoFit
End With
Range(Cells(r, prEd), Cells(r, prGr)).HorizontalAlignment = xlCenter
Cells(r, zvCol).Select
99
TextBox1.Text = ""
TextBox2.Text = ""
TextBox3.Text = ""
TextBox5.Text = ""
TextBox6.Text = ""
TextBox7.Text = ""
TextBox1.SetFocus
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex = -1
Comb_Nm.Clear
Comb_Find.Clear
If Sheets("setting").Range("i7").Value = 1 Then Unload Me
End Sub
Private Sub TextBox1_Change()
On Error Resume Next
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.SetFocus
TextBox1.SetFocus
End Sub
Private Sub TextBox2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex = -1 Then
If Comb_Find.ListCount > 1 Then Comb_Find.DropDown
End If
If Comb_Nm.ListCount > 1 Then Comb_Nm.DropDown
End Sub
Private Sub TextBox5_Change()
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
Dim r As Long
Dim i As Long
Dim n As Long
Me.StartUpPosition = 0
Me.Top = Range("d11").Top + 15
Me.Left = Cells(1, prSum).Left + Cells(1, prSum).Width - Me.Width
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
Call Load_sklad
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
.Left = TextBox1.Left
.Top = TextBox1.Top
.Width = TextBox1.Width + 13
.Height = TextBox1.Height + 1
.ZOrder 1
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, prNm).End(xlUp).Row
col = Application.CountIf(.Range(.Cells(11, prGr), .Cells(r, prGr)), "<>")
If col = 0 Then GoTo 55
For n = 11 To r
For i = 0 To Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1
If .Cells(n, prGr) <> "" Then
If .Cells(n, prGr) = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(i, 1) Then GoTo 44
End If
Next i
If .Cells(n, prGr) <> "" Then
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1, 1) = .Cells(n, prGr)
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1, 0) = "new"
End If
44
Next n
End With
55
With Comb_Nm
.Left = TextBox2.Left
.Top = TextBox2.Top
.Width = TextBox2.Width + 13
.Height = TextBox2.Height + 1
.ZOrder 1
End With
With Comb_|fffd||fffd|
.Left = TextBox3.Left
.Top = TextBox3.Top
.Width = TextBox3.Width + 13
.Height = TextBox3.Height
.ZOrder 1
End With
With Comb_Find
.Left = TextBox2.Left
.Top = TextBox2.Top
.Width = TextBox2.Width
.Height = TextBox2.Height
.ZOrder 1
End With
With Comb_Z
.Left = TextBox8.Left
.Top = TextBox8.Top
.Width = TextBox8.Width + 13
.Height = TextBox8.Height
.ZOrder 1
End With
With Sheets("setting")
For i = 2 To 8
If .Cells(i, "m") <> "" Then
Me.Comb_Z.AddItem .Cells(i, "m")
End If
Next i
End With
TextBox4.Value = 1
Comb_Nm.ColumnWidths = "320;0;0;0;0"
Comb_Find.ColumnWidths = "320;0;0;0;0"
If Sheets("setting").Range("b6") = 1 Then
Label20.Visible = True
TextBox7.Visible = True
Frame2.Height = h2
Frame3.Top = 78
Me.Height = h2 + 60
Else
Label20.Visible = False
TextBox7.Visible = False
Frame2.Height = h1
Frame3.Top = 58
Me.Height = h1 + 60
End If
OK.Top = Frame2.Height + 12
NO.Top = Frame2.Height + 12
ico.Top = OK.Top
Application.DisplayAlerts = True
ScreenOn
End Sub
Private Sub Load_sklad()
On Error Resume Next
Dim r As Long
Dim i As Long
Dim j As Long
Dim n As Long
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Clear
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row + 2
gr = .Range(.Cells(5, 2), .Cells(r, 2)).Value
nm = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
cod = .Range(.Cells(5, skCod), .Cells(r, skCod)).Value
ed = .Range(.Cells(5, skEd), .Cells(r, skEd)).Value
cnZ = .Range(.Cells(5, skCenaZ), .Cells(r, skCenaZ)).Value
cnR = .Range(.Cells(5, skCenaR), .Cells(r, skCenaR)).Value
col = Application.CountIf(.Range(.Cells(5, skNm), .Cells(r, skNm)), "<>")
col_All = col
End With
If col = 0 Then Exit Sub
ReDim c(1 To col, 1 To 5)
n = 0
j = 1
For i = LBound(nm) To UBound(nm)
If nm(i, 1) <> "" Then
If gr(i, 1) = "" Then
c(j, 1) = nm(i, 1)
c(j, 2) = cod(i, 1)
c(j, 3) = ed(i, 1)
c(j, 4) = cnZ(i, 1)
c(j, 5) = cnR(i, 1)
End If
If gr(i, 1) <> "" Then
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 0) = j
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 1) = nm(i, 1)
n = n + 1
End If
j = j + 1
End If
Next
Call RemoveDuplicates_ed
Call RemoveDuplicates_nm
End Sub
Private Sub RemoveDuplicates_nm()
On Error Resume Next
Dim r As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:f" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(c), 1) = c
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:b" & r).RemoveDuplicates Columns:=Array(1, 2), header:=xlNo
r = .Cells(Rows.Count, 1).End(xlUp).Row
cc = .Range("a1:b" & r).Value
End With
Application.CutCopyMode = False
End Sub
Private Sub RemoveDuplicates_ed()
On Error Resume Next
Dim r As Long
Dim i As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:f" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(c), 3) = c
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:b" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 3).End(xlUp).Row
.Range("c1:c" & r).RemoveDuplicates Columns:=1, header:=xlNo
r = .Cells(Rows.Count, 3).End(xlUp).Row
For i = 1 To r
If .Cells(i, "c") <> "" Then
Comb_|fffd||fffd|.AddItem .Cells(i, "c")
End If
Next i
End With
Application.CutCopyMode = False
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub TextBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
End Sub
Private Sub TextBox3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
If Val(Comb_|fffd||fffd|.ListCount) > 0 Then Comb_|fffd||fffd|.DropDown
End Sub
Private Sub TextBox8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_Z.ListIndex = -1
Comb_Z.DropDown
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
Erase nm
Erase gr
Erase cod
Erase c
Erase cnZ
Erase cnR
Erase ed
End Sub
Private Sub Comb_|fffd||fffd|_Change()
TextBox3.Text = Comb_|fffd||fffd|.Value
End Sub
Private Sub TextBox6_Change()
End Sub
Private Sub TextBox8_Change()
Call cenapr_calculation
Comb_Z.SetFocus
End Sub
Private Sub cenapr_calculation()
Dim prc
Dim cenZ
On Error Resume Next
If TextBox5.Value = "" Then Exit Sub
prc = Me.TextBox8.Value
cenZ = Me.TextBox5.Value
Me.TextBox6.Value = format(cenZ + cenZ * prc / 100, "0.00")
End Sub
Private Sub cenaR_calculation()
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 24
ico.Width = 24
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 22
ico.Width = 22
End Sub
Attribute VB_Name = "Form_Enter_red"
Attribute VB_Base = "0{25F9A2AF-9BB1-4EDC-A058-89DC4D3D3879}{2F2F3F18-41DB-4387-82C9-EA87FF186286}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim col As Long
Dim col1 As Long
Dim nm()
Dim cod()
Dim gr()
Dim cZZ()
Dim ed()
Dim cc()
Dim c()
Dim ind As Integer
Dim grNm As String
Dim flag As Byte
Dim flag_load As Byte
Const h1 = 118
Const h2 = 138
Dim str_ As String
Dim textS As String
Dim iCol As Long
Private Sub Comb_Find_Click()
On Error Resume Next
With Comb_Find
ind = .ListIndex
If ind = -1 Then Exit Sub
|fffd||fffd| = .ListCount
vv = .ColumnCount
TextBox7.Text = .List(ind, 1)
TextBox3.Text = .List(ind, 2)
TextBox5.Text = .List(ind, 3)
TextBox2.Text = .List(ind, 0)
End With
End Sub
Private Sub TextBox2_Change()
On Error Resume Next
If flag = 1 Then Exit Sub
If flag_load = 1 Then Exit Sub
Comb_Nm.SetFocus
Call find_zv
If Val(Comb_Find.ListCount) > 0 Then Comb_Find.DropDown
End Sub
Sub find_zv()
On Error Resume Next
Dim r As Long
Dim j As Long
Dim i As Long
Dim col As Long
iCol = 0
str_ = Me.TextBox2.Text
If Len(str_) = 0 Then
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
Exit Sub
End If
If Len(str_) = 0 Then Exit Sub
ReDim aa(LBound(c) To UBound(c), 1 To 4)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If UCase(Left(c(i, 1), 1)) = textS Then
aa(i, 1) = c(i, 1)
aa(i, 2) = c(i, 2)
aa(i, 3) = c(i, 3)
aa(i, 4) = c(i, 4)
iCol = iCol + 1
End If
Else
If InStr(1, UCase(c(i, 1)), textS) > 0 Then
aa(i, 1) = c(i, 1)
aa(i, 2) = c(i, 2)
aa(i, 3) = c(i, 3)
aa(i, 4) = c(i, 4)
iCol = iCol + 1
End If
End If
Next
If iCol = 0 Then
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
DoEvents
Exit Sub
End If
ReDim w(1 To iCol, 1 To 4)
j = 1
For i = LBound(aa) To UBound(aa)
If aa(i, 1) <> "" Then
w(j, 1) = aa(i, 1)
w(j, 2) = aa(i, 2)
w(j, 3) = aa(i, 3)
w(j, 4) = aa(i, 4)
j = j + 1
End If
Next
Comb_Find.Clear
Comb_Find.SetFocus
TextBox2.SetFocus
DoEvents
Comb_Find.List = w
End Sub
Private Sub Comb_Nm_Click()
On Error Resume Next
flag = 1
Me.Comb_Find.Clear
With Comb_Nm
ind = .ListIndex
If ind = -1 Then Exit Sub
TextBox2.Text = .List(ind, 0)
TextBox7.Text = .List(ind, 1)
TextBox3.Text = .List(ind, 2)
TextBox5.Text = .List(ind, 3)
End With
flag = 0
End Sub
Private Sub Comb_|fffd||fffd||fffd||fffd||fffd||fffd|_Change()
On Error Resume Next
Dim row1 As Long
Dim row2 As Long
Dim j As Long
Dim i As Long
ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex
If ind = -1 Then Exit Sub
Comb_Nm.Clear
row1 = 0
row2 = 0
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0) = "new" Then
TextBox1.Text = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
Exit Sub
End If
On Error GoTo 12
row1 = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0) + 1
row2 = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind + 1, 0) - 1
12
If row2 = 0 Then row2 = UBound(c)
ReDim aa(1 To row2 - row1 + 1, 1 To 4)
j = 1
For i = row1 To row2
aa(j, 1) = c(i, 1)
aa(j, 2) = c(i, 2)
aa(j, 3) = c(i, 3)
aa(j, 4) = c(i, 4)
j = j + 1
Next
Comb_Nm.List = aa
TextBox1.Text = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
TextBox2.Text = ""
TextBox3.Text = ""
TextBox5.Text = ""
TextBox7.Text = ""
End Sub
Private Sub OK_Click()
On Error Resume Next
If TextBox2.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd|"
TextBox2.SetFocus
Exit Sub
End If
If TextBox4.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd|-|fffd||fffd|", 64, "|fffd||fffd||fffd||fffd|"
TextBox4.SetFocus
Exit Sub
End If
Dim r As Integer
Dim i As Integer
grNm = TextBox1.Text
If grNm = "" Then grNm = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
tovar = TextBox2.Text
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
r = Val(tbRow.Value)
Cells(r, prNm) = TextBox2.Text
Cells(r, prCod) = TextBox7.Text
Cells(r, prEd) = TextBox3.Text
Cells(r, prCol) = Val(TextBox4)
Cells(r, prCenaZ) = TextBox5.Value
Cells(r, prCenaR).Value = Replace(TextBox6, ",", ".")
Cells(r, prCenaR).NumberFormat = "#,##0.00"
Cells(r, prGr) = grNm
With Range(Cells(r, prNm), Cells(r, prSum))
.Borders.LineStyle = True
.Borders.Color = RGB(174, 185, 173)
.Font.Size = 11
End With
With Range(Cells(r, prGr), Cells(r, prGr))
.Borders.LineStyle = True
.Borders.Color = RGB(174, 185, 173)
.Font.Size = 11
End With
With Range(Cells(r, prNm), Cells(r, prNm))
.WrapText = True
.Rows.AutoFit
End With
Range(Cells(r, prEd), Cells(r, prGr)).HorizontalAlignment = xlCenter
Cells(r, zvCol).Select
99
TextBox1.Text = ""
TextBox2.Text = ""
TextBox3.Text = ""
TextBox5.Text = ""
TextBox7.Text = ""
TextBox1.SetFocus
If Sheets("setting").Range("i7").Value = 1 Then Unload Me
End Sub
Private Sub TextBox1_Change()
On Error Resume Next
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.SetFocus
TextBox1.SetFocus
End Sub
Private Sub TextBox2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex = -1 Then
If Comb_Find.ListCount > 1 Then Comb_Find.DropDown
End If
If Comb_Nm.ListCount > 1 Then Comb_Nm.DropDown
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
Dim r As Long
Dim i As Long
Dim n As Long
flag_load = 1
Me.StartUpPosition = 0
Me.Top = Range("d11").Top + 15
Me.Left = Cells(1, prSum).Left + Cells(1, prSum).Width - Me.Width
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
Call Load_sklad
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
.Left = TextBox1.Left
.Top = TextBox1.Top
.Width = TextBox1.Width + 13
.Height = TextBox1.Height + 1
.ZOrder 1
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, prNm).End(xlUp).Row
col = Application.CountIf(.Range(.Cells(11, prGr), .Cells(r, prGr)), "<>")
If col = 0 Then GoTo 55
For n = 11 To r
For i = 0 To Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1
If .Cells(n, prGr) <> "" Then
If .Cells(n, prGr) = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(i, 1) Then GoTo 44
End If
Next i
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1, 1) = .Cells(n, prGr)
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1, 0) = "new"
44
Next n
End With
55
With Comb_Nm
.Left = TextBox2.Left
.Top = TextBox2.Top
.Width = TextBox2.Width + 13
.Height = TextBox2.Height + 1
.ZOrder 1
End With
With Comb_|fffd||fffd|
.Left = TextBox3.Left
.Top = TextBox3.Top
.Width = TextBox3.Width + 13
.Height = TextBox3.Height
.ZOrder 1
End With
With Comb_Find
.Left = TextBox2.Left
.Top = TextBox2.Top
.Width = TextBox2.Width
.Height = TextBox2.Height
.ZOrder 1
End With
With Comb_Z
.Left = TextBox8.Left
.Top = TextBox8.Top
.Width = TextBox8.Width + 13
.Height = TextBox8.Height
.ZOrder 1
End With
With Sheets("setting")
For i = 2 To 8
If .Cells(i, "m") <> "" Then
Me.Comb_Z.AddItem .Cells(i, "m")
End If
Next i
End With
TextBox4.Value = 1
Comb_Nm.ColumnWidths = "320;0;0;0"
Comb_Find.ColumnWidths = "320;0;0;0"
If Sheets("setting").Range("b6") = 1 Then
Label20.Visible = True
TextBox7.Visible = True
Frame2.Height = h2
Frame3.Top = 78
Me.Height = h2 + 60
Else
Label20.Visible = False
TextBox7.Visible = False
Frame2.Height = h1
Frame3.Top = 58
Me.Height = h1 + 60
End If
TextBox1.Text = Cells(r, prGr)
OK.Top = Frame2.Height + 12
NO.Top = Frame2.Height + 12
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
For i = 0 To .ListCount - 1
If .List(i, 1) = TextBox1.Text Then
.ListIndex = i
End If
Next
End With
r = ActiveCell.Row
tbRow.Value = r
TextBox2.Text = Cells(r, prNm)
TextBox7.Text = Cells(r, prCod)
TextBox3.Text = Cells(r, prEd)
TextBox4.Text = Cells(r, prCol)
TextBox5.Text = Cells(r, prCenaZ)
TextBox6.Text = Cells(r, prCenaR)
flag_load = 0
Application.DisplayAlerts = True
ScreenOn
End Sub
Private Sub Load_sklad()
On Error Resume Next
Dim r As Long
Dim i As Long
Dim col As Integer
Dim col_1 As Integer
Dim col_2 As Integer
Dim j As Long
Dim n As Long
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Clear
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row + 2
gr = .Range(.Cells(5, 2), .Cells(r, 2)).Value
nm = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
cod = .Range(.Cells(5, skCod), .Cells(r, skCod)).Value
ed = .Range(.Cells(5, skEd), .Cells(r, skEd)).Value
cnZ = .Range(.Cells(5, skCenaZ), .Cells(r, skCenaZ)).Value
col = Application.CountIf(.Range(.Cells(5, skNm), .Cells(r, skNm)), "<>")
End With
If col = 0 Then Exit Sub
ReDim c(1 To col, 1 To 4)
n = 0
j = 1
For i = LBound(nm) To UBound(nm)
If nm(i, 1) <> "" Then
If gr(i, 1) = "" Then
c(j, 1) = nm(i, 1)
c(j, 2) = cod(i, 1)
c(j, 3) = ed(i, 1)
c(j, 4) = cnZ(i, 1)
End If
If gr(i, 1) <> "" Then
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 0) = j
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 1) = nm(i, 1)
n = n + 1
End If
j = j + 1
End If
Next
Call RemoveDuplicates_ed
Call RemoveDuplicates_nm
End Sub
Private Sub RemoveDuplicates_nm()
On Error Resume Next
Dim r As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:f" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(c), 1) = c
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:b" & r).RemoveDuplicates Columns:=Array(1, 2), header:=xlNo
r = .Cells(Rows.Count, 1).End(xlUp).Row
cc = .Range("a1:b" & r).Value
End With
Application.CutCopyMode = False
End Sub
Private Sub RemoveDuplicates_ed()
On Error Resume Next
Dim r As Long
Dim i As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:f" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(c), 3) = c
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:b" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 3).End(xlUp).Row
.Range("c1:c" & r).RemoveDuplicates Columns:=1, header:=xlNo
r = .Cells(Rows.Count, 3).End(xlUp).Row
For i = 1 To r
If .Cells(i, "c") <> "" Then
Comb_|fffd||fffd|.AddItem .Cells(i, "c")
End If
Next i
End With
Application.CutCopyMode = False
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub TextBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
End Sub
Private Sub TextBox3_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_|fffd||fffd|.DropDown
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
Erase nm
Erase gr
Erase g
Erase c
Erase cZZ
Erase cRR
Erase ed
End Sub
Private Sub Comb_|fffd||fffd|_Change()
TextBox3.Text = Comb_|fffd||fffd|.Value
End Sub
Private Sub TextBox8_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_Z.ListIndex = -1
Comb_Z.DropDown
End Sub
Private Sub TextBox8_Change()
Call cenapr_calculation
Comb_Z.SetFocus
End Sub
Private Sub cenapr_calculation()
Dim prc
Dim cenZ
On Error Resume Next
If TextBox5.Value = "" Then Exit Sub
prc = Me.TextBox8.Value
cenZ = Me.TextBox5.Value
Me.TextBox6.Value = format(cenZ + cenZ * prc / 100, "0.00")
End Sub
Private Sub Comb_Z_Change()
TextBox8.Visible = True
TextBox8.Value = Comb_Z.Value
TextBox8.SetFocus
End Sub
Attribute VB_Name = "Form_Redaktirov"
Attribute VB_Base = "0{47EC41EB-FA0A-492F-8F22-E3CBBE22718E}{EBF8C267-EA72-4BD0-BF2C-B0B0225F09D7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Const col = 5
Dim i As Integer
Private Sub cm4_Click()
On Error Resume Next
If Application.DisplayFullScreen = False Then
Call polnekr
Else
Call verekr
End If
End Sub
Private Sub cm5_Click()
Unload Me
End Sub
Private Sub cm1_Click()
If ActiveCell.Row < 5 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
Exit Sub
End If
With Selection
.EntireRow.Insert
End With
End Sub
Private Sub cm2_Click()
If ActiveCell.Row < 5 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
Exit Sub
End If
With Selection
.EntireRow.Delete
End With
End Sub
Private Sub cm3_Click()
If ActiveCell.Row < 5 Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
Exit Sub
End If
With Selection
.ClearContents
End With
End Sub
Private Sub UserForm_Activate()
t.SetFocus
End Sub
Private Sub cm1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 1
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 2
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm3_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 3
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm4_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 4
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm5_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 5
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 6
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm7_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 7
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 8
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm9_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 9
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm10_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 10
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm11_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 11
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub cm12_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Dim i As Integer
Dim n As Integer
n = 12
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
Me.Controls("cm" & n).BackColor = RGB(255, 255, 255)
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
For i = 1 To col
Me.Controls("cm" & i).BackColor = RGB(212, 208, 200)
Next
End Sub




Attribute VB_Name = "Form_SelectDate"
Attribute VB_Base = "0{6989E06E-7827-4E86-BE0C-254D082F6836}{F14B9FF6-4B1D-435A-BA68-B8086724B9C7}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim mozno As Boolean
Dim dt_2
Dim MyYear
Dim MyMonth
Dim MyDay
Dim MyWeekDay
Dim MyCountDay
Dim l_start
Private Sub UserForm_Initialize()
On Error Resume Next
Me.StartUpPosition = 0
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
With vvodPr
If .Visible = True Then
Me.Top = .Top + .tb_Dt.Top + .tb_Dt.Height * 2
Me.Left = .Left + .tb_Dt.Left
End If
End With
GoTo 33
End If
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then
With vvodZv
dd = .ctr.Value
If .Visible = True Then
If .ctr.Value = 1 Then
Me.Top = .Top + .Frame_cmb.Top + .tb_Dt1.Top + .tb_Dt1.Height * 2
Me.Left = .Left + .Frame_cmb.Left + .tb_Dt1.Left
Else
Me.Top = .Top + .Frame_cmb.Top + .tb_Dt2.Top + .tb_Dt2.Height * 2
Me.Left = .Left + .Frame_cmb.Left + .tb_Dt2.Left
End If
End If
End With
End If
33:
dt_2 = dt_1
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd|"
ComboBox_Month.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
On Error Resume Next
If CloseMode = 0 Then dt_1 = dt_2
End Sub
Private Sub Set_TextBox_|fffd||fffd||fffd||fffd|(MyDate As Date)
End Sub
Private Sub Set_TextBox_Year(MyDate As Date)
TextBox_Year.Value = format(MyDate, "yyyy")
End Sub
Private Sub Set_M|fffd|nth(MyDate As Date)
On Error Resume Next
Dim i As Integer
Dim j As Integer
MyYear = Year(MyDate)
MyMonth = Month(MyDate)
MyDay = Day(MyDate)
Label_Day.Caption = MyDay
Label_Month.Caption = MyMonth
Label_Year.Caption = MyYear
ComboBox_Month.ListIndex = MyMonth - 1
MyWeekDay = Weekday(DateSerial(MyYear, MyMonth, 1), vbMonday)
MyCountDay = Day(DateSerial(MyYear, MyMonth + 1, 1) - 1)
l_start = 2 - MyWeekDay
For i = 1 To 6
For j = 1 To 7
If l_start >= 1 And l_start <= MyCountDay Then
Me.Controls("Cell_" & i & "_" & j).Caption = l_start
Else
Me.Controls("Cell_" & i & "_" & j).Caption = ""
End If
If l_start = MyDay Then
Set_On_Off CInt(i), CInt(j)
End If
l_start = l_start + 1
Next j, i
End Sub
Private Sub Cmd_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_Click()
On Error Resume Next
dt_1 = Now
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub Cmd_|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_Click()
On Error Resume Next
dt_1 = dt_1 - 1
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub Cmd_|fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|_Click()
On Error Resume Next
dt_1 = dt_1 + 1
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub Set_|fffd||fffd||fffd||fffd|(iRow As Integer, jCol As Integer)
On Error Resume Next
If Me.Controls("Cell_" & iRow & "_" & jCol).Caption = "" Then Exit Sub
MyYear = Year(dt_1)
MyMonth = Month(dt_1)
MyDay = CInt(Me.Controls("Cell_" & iRow & "_" & jCol).Caption)
dt_1 = DateSerial(MyYear, MyMonth, MyDay)
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
With vvodZv
If .Visible = True Then
If .ctr.Text = 1 Then
.tb_Dt1.Text = dt_1
Else
.tb_Dt2.Text = dt_1
End If
End If
End With
With vvodPr
If .Visible = True Then
.tb_Dt.Text = dt_1
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
End If
End With
Unload Me
End Sub
Private Sub ComboBox_Month_Change()
On Error Resume Next
If mozno Then Exit Sub
MyYear = Year(dt_1)
MyMonth = CInt(ComboBox_Month.ListIndex + 1)
MyDay = Day(dt_1)
MyCountDay = Day(DateSerial(MyYear, MyMonth + 1, 1) - 1)
If MyDay > MyCountDay Then MyDay = MyCountDay
dt_1 = DateSerial(MyYear, MyMonth, MyDay)
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub SpinButton_Year_SpinDown()
On Error Resume Next
MyYear = Year(dt_1) - 1
MyMonth = Month(dt_1)
MyDay = Day(dt_1)
MyCountDay = Day(DateSerial(MyYear, MyMonth + 1, 1) - 1)
If MyDay > MyCountDay Then MyDay = MyCountDay
dt_1 = DateSerial(MyYear, MyMonth, MyDay)
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub SpinButton_Year_SpinUp()
On Error Resume Next
MyYear = Year(dt_1) + 1
MyMonth = Month(dt_1)
MyDay = Day(dt_1)
MyCountDay = Day(DateSerial(MyYear, MyMonth + 1, 1) - 1)
If MyDay > MyCountDay Then MyDay = MyCountDay
dt_1 = DateSerial(MyYear, MyMonth, MyDay)
Set_TextBox_|fffd||fffd||fffd||fffd| (dt_1)
Set_TextBox_Year (dt_1)
mozno = True
Set_M|fffd|nth (dt_1)
mozno = False
End Sub
Private Sub Cell_1_1_Click()
Set_On_Off 1, 1
Set_|fffd||fffd||fffd||fffd| 1, 1
End Sub
Private Sub Cell_1_2_Click()
Set_On_Off 1, 2
Set_|fffd||fffd||fffd||fffd| 1, 2
End Sub
Private Sub Cell_1_3_Click()
Set_On_Off 1, 3
Set_|fffd||fffd||fffd||fffd| 1, 3
End Sub
Private Sub Cell_1_4_Click()
Set_On_Off 1, 4
Set_|fffd||fffd||fffd||fffd| 1, 4
End Sub
Private Sub Cell_1_5_Click()
Set_On_Off 1, 5
Set_|fffd||fffd||fffd||fffd| 1, 5
End Sub
Private Sub Cell_1_6_Click()
Set_On_Off 1, 6
Set_|fffd||fffd||fffd||fffd| 1, 6
End Sub
Private Sub Cell_1_7_Click()
Set_On_Off 1, 7
Set_|fffd||fffd||fffd||fffd| 1, 7
End Sub
Private Sub Cell_2_1_Click()
Set_On_Off 2, 1
Set_|fffd||fffd||fffd||fffd| 2, 1
End Sub
Private Sub Cell_2_2_Click()
Set_On_Off 2, 2
Set_|fffd||fffd||fffd||fffd| 2, 2
End Sub
Private Sub Cell_2_3_Click()
Set_On_Off 2, 3
Set_|fffd||fffd||fffd||fffd| 2, 3
End Sub
Private Sub Cell_2_4_Click()
Set_On_Off 2, 4
Set_|fffd||fffd||fffd||fffd| 2, 4
End Sub
Private Sub Cell_2_5_Click()
Set_On_Off 2, 5
Set_|fffd||fffd||fffd||fffd| 2, 5
End Sub
Private Sub Cell_2_6_Click()
Set_On_Off 2, 6
Set_|fffd||fffd||fffd||fffd| 2, 6
End Sub
Private Sub Cell_2_7_Click()
Set_On_Off 2, 7
Set_|fffd||fffd||fffd||fffd| 2, 7
End Sub
Private Sub Cell_3_1_Click()
Set_On_Off 3, 1
Set_|fffd||fffd||fffd||fffd| 3, 1
End Sub
Private Sub Cell_3_2_Click()
Set_On_Off 3, 2
Set_|fffd||fffd||fffd||fffd| 3, 2
End Sub
Private Sub Cell_3_3_Click()
Set_On_Off 3, 3
Set_|fffd||fffd||fffd||fffd| 3, 3
End Sub
Private Sub Cell_3_4_Click()
Set_On_Off 3, 4
Set_|fffd||fffd||fffd||fffd| 3, 4
End Sub
Private Sub Cell_3_5_Click()
Set_On_Off 3, 5
Set_|fffd||fffd||fffd||fffd| 3, 5
End Sub
Private Sub Cell_3_6_Click()
Set_On_Off 3, 6
Set_|fffd||fffd||fffd||fffd| 3, 6
End Sub
Private Sub Cell_3_7_Click()
Set_On_Off 3, 7
Set_|fffd||fffd||fffd||fffd| 3, 7
End Sub
Private Sub Cell_4_1_Click()
Set_On_Off 4, 1
Set_|fffd||fffd||fffd||fffd| 4, 1
End Sub
Private Sub Cell_4_2_Click()
Set_On_Off 4, 2
Set_|fffd||fffd||fffd||fffd| 4, 2
End Sub
Private Sub Cell_4_3_Click()
Set_On_Off 4, 3
Set_|fffd||fffd||fffd||fffd| 4, 3
End Sub
Private Sub Cell_4_4_Click()
Set_On_Off 4, 4
Set_|fffd||fffd||fffd||fffd| 4, 4
End Sub
Private Sub Cell_4_5_Click()
Set_On_Off 4, 5
Set_|fffd||fffd||fffd||fffd| 4, 5
End Sub
Private Sub Cell_4_6_Click()
Set_On_Off 4, 6
Set_|fffd||fffd||fffd||fffd| 4, 6
End Sub
Private Sub Cell_4_7_Click()
Set_On_Off 4, 7
Set_|fffd||fffd||fffd||fffd| 4, 7
End Sub
Private Sub Cell_5_1_Click()
Set_On_Off 5, 1
Set_|fffd||fffd||fffd||fffd| 5, 1
End Sub
Private Sub Cell_5_2_Click()
Set_On_Off 5, 2
Set_|fffd||fffd||fffd||fffd| 5, 2
End Sub
Private Sub Cell_5_3_Click()
Set_On_Off 5, 3
Set_|fffd||fffd||fffd||fffd| 5, 3
End Sub
Private Sub Cell_5_4_Click()
Set_On_Off 5, 4
Set_|fffd||fffd||fffd||fffd| 5, 4
End Sub
Private Sub Cell_5_5_Click()
Set_On_Off 5, 5
Set_|fffd||fffd||fffd||fffd| 5, 5
End Sub
Private Sub Cell_5_6_Click()
Set_On_Off 5, 6
Set_|fffd||fffd||fffd||fffd| 5, 6
End Sub
Private Sub Cell_5_7_Click()
Set_On_Off 5, 7
Set_|fffd||fffd||fffd||fffd| 5, 7
End Sub
Private Sub Cell_6_1_Click()
Set_On_Off 6, 1
Set_|fffd||fffd||fffd||fffd| 6, 1
End Sub
Private Sub Cell_6_2_Click()
Set_On_Off 6, 2
Set_|fffd||fffd||fffd||fffd| 6, 2
End Sub
Private Sub Cell_6_3_Click()
Set_On_Off 6, 3
Set_|fffd||fffd||fffd||fffd| 6, 3
End Sub
Private Sub Cell_6_4_Click()
Set_On_Off 6, 4
Set_|fffd||fffd||fffd||fffd| 6, 4
End Sub
Private Sub Cell_6_5_Click()
Set_On_Off 6, 5
Set_|fffd||fffd||fffd||fffd| 6, 5
End Sub
Private Sub Cell_6_6_Click()
Set_On_Off 6, 6
Set_|fffd||fffd||fffd||fffd| 6, 6
End Sub
Private Sub Cell_6_7_Click()
Set_On_Off 6, 7
Set_|fffd||fffd||fffd||fffd| 6, 7
End Sub
Private Sub Set_On_Off(iRow As Integer, jCol As Integer)
Dim i As Integer
Dim j As Integer
If Me.Controls("Cell_" & iRow & "_" & jCol).Caption = "" Then Exit Sub
For i = 1 To 6
For j = 1 To 7
Me.Controls("Cell_" & i & "_" & j).BackColor = RGB(255, 255, 255)
Me.Controls("Cell_" & i & "_" & j).BorderColor = RGB(255, 255, 255)
Next j
Next i
Me.Controls("Cell_" & iRow & "_" & jCol).BackColor = RGB(204, 255, 204)
Me.Controls("Cell_" & iRow & "_" & jCol).BorderColor = RGB(150, 150, 150)
End Sub



Attribute VB_Name = "Form_find_sk"
Attribute VB_Base = "0{944B5EE3-3702-421E-A386-5B97F56E738A}{D15F4F44-AAB4-4034-AA1E-8F68DF99A24F}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Option Explicit
Public stolb As Integer
Dim rw As Long
Private Sub ComboBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ComboBox1.DropDown
End Sub
Private Sub ListBox1_Click()
On Error Resume Next
Dim ind As Integer
Dim rw As Long
If ListBox1.ListIndex = -1 Then Exit Sub
ind = ListBox1.ListIndex
rw = ListBox1.List(ind, 0)
Range(Cells(rw, 1), Cells(rw, 12)).Select
End Sub
Private Sub name_f_Click()
stolb = skNm
ListBox1.Clear
TxtFind.Text = ""
TxtFind.SetFocus
End Sub
Private Sub cod_f_Click()
stolb = skCod
ListBox1.Clear
TxtFind.Text = ""
TxtFind.SetFocus
End Sub
Private Sub TxtFind_Change()
On Error Resume Next
Dim r As Long
Dim j As Long
Dim i As Long
Dim a()
Dim textS As String
ListBox1.Clear
If Len(TxtFind.Value) = 0 Then Exit Sub
r = Cells(Rows.Count, stolb).End(xlUp).Row
a = Range(Cells(5, stolb), Cells(r, stolb)).Value
textS = UCase(TxtFind.Value)
j = 0
For i = LBound(a) To UBound(a)
If Len(TxtFind.Value) = 1 Then
If UCase(Left(a(i, 1), 1)) = textS Then
ListBox1.AddItem ""
ListBox1.List(j, 0) = i + 4
ListBox1.List(j, 1) = a(i, 1)
j = j + 1
End If
Else
If InStr(1, UCase(a(i, 1)), textS) > 0 Then
ListBox1.AddItem i
ListBox1.List(j, 0) = i + 4
ListBox1.List(j, 1) = a(i, 1)
j = j + 1
End If
End If
77:
Next
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub ComboBox1_Change()
On Error Resume Next
TxtFind = ""
Dim row1 As Long
Dim row2 As Long
Dim i As Long
Dim r As Long
Dim a()
Dim c()
Dim ind As Integer
ind = ComboBox1.ListIndex
If ind = -1 Then Exit Sub
i = ComboBox1.List(ind, 0)
Range(Cells(i, 1), Cells(i, 14)).Select
ActiveWindow.ScrollRow = i
ListBox1.Clear
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, stolb).End(xlUp).Row
row1 = ComboBox1.List(ind, 0)
row2 = ComboBox1.List(ind + 1, 0) - 1
If ind = ComboBox1.ListCount - 1 Then row2 = r
If ComboBox1.List(ind, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" Then
row1 = 5
row2 = r
End If
a = Range(.Cells(row1 + 1, stolb), .Cells(row2, stolb)).Value
ReDim c(LBound(a) To UBound(a), 1 To 2)
For i = LBound(a) To UBound(a)
If a(i, 1) <> "" Then
c(i, 2) = a(i, 1)
c(i, 1) = i + row1
End If
Next
End With
ListBox1.List = c
Me.Caption = ComboBox1.List(ind, 1)
TxtFind.SetFocus
End Sub
Private Sub UserForm_Click()
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Dim j As Long
Dim r As Long
Dim i As Long
Dim a()
Dim b()
ComboBox1.Value = "|fffd||fffd||fffd||fffd||fffd||fffd|"
With Sheets("C|fffd||fffd||fffd||fffd|")
j = 0
r = .Cells(Rows.Count, 2).End(xlUp).Row
a = Range(.Cells(5, 2), .Cells(r, 2)).Value
b = Range(.Cells(5, skNm), .Cells(r, skNm)).Value
For i = LBound(a) To UBound(a)
If a(i, 1) <> "" Then
ComboBox1.AddItem ""
ComboBox1.List(j, 0) = i + 4
ComboBox1.List(j, 1) = b(i, 1)
j = j + 1
End If
Next
End With
NO.ForeColor = RGB(255, 255, 255)
If Sheets("setting").Range("b6") <> 1 Then
cod_f.Visible = False
Else
cod_f.Visible = True
End If
End Sub
Private Sub UserForm_Activate()
On Error Resume Next
stolb = skNm
name_f.Value = True
DoEvents
TxtFind.SetFocus
DoEvents
End Sub
Attribute VB_Name = "Form_print"
Attribute VB_Base = "0{A524F685-0439-4DFC-99D2-563712EB587A}{C09C340D-86A1-4C3C-AA36-782F4A28E6E9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub OK_Click()
On Error Resume Next
If Me.TextBox1.Text = 5 Then Call prnt_zk: Exit Sub
Unload Me
DoEvents
If Me.TextBox1.Text = 1 Then Call prnt_zv
If Me.TextBox1.Text = 4 Then Call prnt_pr
End Sub
Private Sub UserForm_Activate()
TextBox1.SetFocus
End Sub
Sub list_print()
On Error Resume Next
Dim n
With CreateObject("Shell.Application").Namespace(4).Items
For n = 1 To .Count - 1
Me.ComboBox2.AddItem .Item(n).Name
Next
End With
Label2.Caption = Application.ActivePrinter
Sheets("setting").Range("b10").Value = Application.ActivePrinter
Me.ComboBox2.Value = Label2.Caption
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
OK.BackColor = RGB(55, 96, 145)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
Me.ComboBox1.AddItem "1"
Me.ComboBox1.AddItem "2"
Me.ComboBox1.AddItem "3"
Sheets("setting").Range("b9") = 1
Call list_print
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
With ThisWorkbook.Sheets("setting")
.Range("b9:b10") = 1
End With
End Sub
Private Sub ComboBox2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ComboBox2.DropDown
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub ComboBox1_Change()
Sheets("setting").Range("b9") = ComboBox1.Value
End Sub
Private Sub ComboBox2_Change()
On Error Resume Next
Label2.Caption = ComboBox2.Value
Sheets("setting").Range("b10").Value = ComboBox2.Value
TextBox1.SetFocus
End Sub
Attribute VB_Name = "Form_set_password"
Attribute VB_Base = "0{33E74E96-926E-4953-8E25-D56ED71C0443}{68C5668A-02C9-4EF3-AC28-72A94D2DA4E8}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim i As Integer
Dim r As Integer
Dim n As Integer
Private Sub CheckBox2_Click()
With Sheets("setting")
If CheckBox2.Value = True Then
.Range("aa1") = 1
Else
.Range("aa1") = 0
End If
End With
End Sub
Private Sub CheckBox3_Click()
With Sheets("setting")
If CheckBox3.Value = True Then
.Range("aa2") = 1
Else
.Range("aa2") = 0
End If
End With
End Sub
Private Sub CheckBox4_Click()
With Sheets("setting")
If CheckBox4.Value = True Then
.Range("aa3") = 1
Else
.Range("aa3") = 0
End If
End With
End Sub
Private Sub OK_Click()
Call save_password
End Sub
Private Sub UserForm_Initialize()
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
With Sheets("setting")
Me.TextBox1.Text = "111"
Me.TextBox2.Text = "222"
If .Range("z3") = 1 Then CheckBox1.Value = True
If .Range("aa1") = 1 Then
CheckBox2.Value = True
Else
CheckBox2.Value = False
End If
If .Range("aa2") = 1 Then
CheckBox3.Value = True
Else
CheckBox3.Value = False
End If
If .Range("aa3") = 1 Then
CheckBox4.Value = True
Else
CheckBox4.Value = False
End If
End With
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub UserForm_Click()
End Sub
Private Sub save_password()
With Sheets("setting")
If CheckBox1.Value = True Then
.Range("z3") = 1
Else
.Range("z3") = 0
End If
If CheckBox2.Value = True Then
.Range("aa1") = 1
Else
.Range("aa1") = 0
End If
If CheckBox3.Value = True Then
.Range("aa2") = 1
Else
.Range("aa2") = 0
End If
End With
Unload Me
DoEvents
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
End Sub
Attribute VB_Name = "Praise"
Attribute VB_Base = "0{AFB215BF-94E6-4E97-B4BE-E2B2685D2F79}{6717E559-4D17-490C-9F17-91F7682F0AF4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim nm()
Dim gr()
Dim ed()
Dim cod()
Dim ost()
Dim cnZ()
Dim cnR()
Dim c_ed()
Dim c_ds()
Dim w()
Dim c()
Dim cc()
Dim ind As Integer
Dim id As Integer
Dim find_Flag As Byte
Dim wid_cod
Dim wid_nm
Dim flag
Const iMeWidthMin As Single = 120
Const iMeWidthMax As Single = 900
Const iMeHeightMin As Single = 97
Const iMeHeightMax As Single = 400
Dim str_ As String
Dim textS As String
Dim iCol As Long
Private Sub Label_cod_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
find_Flag = 3
tbFind_Nm.Text = ""
tbFind_Cod.Text = ""
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
On Error Resume Next
ind = ListBox1.ListIndex
If ListBox1.List(ind, 0) = "" Then Exit Sub
If ListBox1.List(ind, 2) = "" Then Exit Sub
If ListBox1.List(ind, 1) = "-------------------------------------------------" Then Exit Sub
Call ent_Zv
End Sub
Private Sub ent_Zv()
On Error Resume Next
Dim r As Integer
Dim n As Integer
Dim rw As Long
Dim rr As Long
Dim cell As Range
Dim tovar As String
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
id = ListBox1.List(ind, 0)
codd = ListBox1.List(ind, 1)
tovar = ListBox1.List(ind, 2)
cenaZ = ListBox1.List(ind, 3)
col = Val(ListBox1.List(ind, 5))
r = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
If r < rwZv Then r = rwZv: GoTo 22
If cenaZ = "" Then GoTo 11
For Each cell In Range(Cells(rwZv, zvNm), Cells(r, zvNm))
If cell = tovar And Cells(cell.Row, zvCod) = codd And CDbl(Cells(cell.Row, zvCenaZ)) = CDbl(cenaZ) Then
rr = cell.Row
Cells(rr, zvCol) = Cells(rr, zvCol) + 1
Cells(rr, zvCol).Select
ListBox1.List(ind, 5) = col - 1
GoTo 99
End If
Next
11
For Each cell In Range(Cells(rwZv, zvNm), Cells(r, zvNm))
If cell = tovar And Cells(cell.Row, zvCod) = codd Then
rr = cell.Row
Cells(rr, zvCol) = Cells(rr, zvCol) + 1
Cells(rr, zvCol).Select
ListBox1.List(ind, 5) = col - 1
GoTo 99
End If
Next
22
Cells(r, zvNm) = ListBox1.List(ind, 2)
Cells(r, zvEd) = c_ed(id, 1)
Cells(r, zvCod) = ListBox1.List(ind, 1)
If ListBox1.List(ind, 3) = "" Then
Cells(r, zvCenaZ) = ""
Else
Cells(r, zvCenaZ) = CDbl(ListBox1.List(ind, 3))
End If
If ListBox1.List(ind, 4) = "" Then
Cells(r, zvCenaR) = ""
Else
Cells(r, zvCenaR) = CDbl(ListBox1.List(ind, 4))
End If
Cells(r, zvDs) = c_ds(id, 1)
If Cells(r, zvDs) = "" Then Cells(r, zvDs) = 0
Cells(r, zvCol) = 1
ListBox1.List(ind, 5) = col - 1
Range(Cells(r, zvNm), Cells(r, zvSum)).Borders.LineStyle = True
Range(Cells(r, zvDs), Cells(r, zvDs)).Borders.LineStyle = True
Range(Cells(r, zvNm), Cells(r, zvSum)).Borders.Color = RGB(197, 217, 241)
Range(Cells(r, zvDs), Cells(r, zvDs)).Borders.Color = RGB(197, 217, 241)
Range(Cells(r, zvCod), Cells(r, zvSum)).HorizontalAlignment = xlCenter
Range(Cells(r, zvDs), Cells(r, zvDs)).HorizontalAlignment = xlCenter
Cells(r, zvSum).NumberFormat = "#,##0.00"
Cells(r, zvCenaR).NumberFormat = "#,##0.00"
With Range(Cells(r, zvNm), Cells(r, zvDs))
.Font.Name = "Cambria"
.Font.Size = 11
End With
Range(Cells(r, zvNm), Cells(r, zvNm)).WrapText = True
Cells(r, zvCol).Select
99
End Sub
Private Sub Label_gr_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
find_Flag = 3
tbFind_Nm.Text = ""
tbFind_Cod.Text = ""
End Sub
Private Sub tbFind_Cod_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
find_Flag = 1
tbFind_Nm.Text = ""
End Sub
Private Sub tbFind_Nm_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
find_Flag = 2
tbFind_Cod.Text = ""
End Sub
Private Sub tbFind_Cod_Change()
Call find_zv_Cod
End Sub
Private Sub tbFind_Nm_Change()
Call find_zv_Nm
Me.ListBox1.Height = Me.Height - 60
Me.Repaint
DoEvents
End Sub
Sub find_zv_Cod()
On Error Resume Next
If find_Flag = 2 Then Exit Sub
If find_Flag = 3 Then Exit Sub
Dim r As Long
Dim j As Long
Dim i As Long
iCol = 0
ListBox1.Clear
str_ = Me.tbFind_Cod.Text
If Len(str_) = 0 Then ListBox1.List = c: Exit Sub
ReDim cc(LBound(c) To UBound(c), 1 To 6)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If c(i, 2) <> "-------------------------------------------------" Then
If UCase(Left(c(i, 2), 1)) = textS Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
Else
If InStr(1, UCase(c(i, 2)), textS) > 0 Then
If c(i, 2) <> "-------------------------------------------------" Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
End If
Next
If iCol = 0 Then Exit Sub
ReDim w(1 To iCol + 1, 1 To 6)
j = 1
For i = LBound(c) To UBound(c)
If cc(i, 2) <> "" Then
w(j, 1) = cc(i, 1)
w(j, 2) = cc(i, 2)
w(j, 3) = cc(i, 3)
w(j, 4) = cc(i, 4)
w(j, 5) = cc(i, 5)
w(j, 6) = format(cc(i, 6), "0.00")
j = j + 1
End If
Next
tbFind_Nm.Text = ""
ListBox1.List = w
End Sub
Sub find_zv_Nm()
On Error Resume Next
If find_Flag = 1 Then Exit Sub
If find_Flag = 3 Then Exit Sub
Dim r As Long
Dim j As Long
Dim i As Long
iCol = 0
ListBox1.Clear
str_ = Me.tbFind_Nm.Text
If Len(str_) = 0 Then ListBox1.List = c: Exit Sub
ReDim cc(LBound(c) To UBound(c), 1 To 6)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If c(i, 2) <> "-------------------------------------------------" Then
If UCase(Left(c(i, 3), 1)) = textS Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
Else
If InStr(1, UCase(c(i, 3)), textS) > 0 Then
If c(i, 2) <> "-------------------------------------------------" Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
End If
Next
If iCol = 0 Then Exit Sub
ReDim w(1 To iCol + 1, 1 To 6)
j = 1
For i = LBound(c) To UBound(c)
If cc(i, 3) <> "" Then
w(j, 1) = cc(i, 1)
w(j, 2) = cc(i, 2)
w(j, 3) = cc(i, 3)
w(j, 4) = cc(i, 4)
w(j, 5) = cc(i, 5)
w(j, 6) = format(cc(i, 6), "0.00")
j = j + 1
End If
Next
tbFind_Cod.Text = ""
ListBox1.List = w
End Sub
Private Sub Comb_|fffd||fffd||fffd||fffd||fffd||fffd|_Change()
On Error Resume Next
Dim row1 As Long
Dim row2 As Long
Dim j As Long
Dim i As Long
Dim col As Long
ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex
If ind = -1 Then Exit Sub
On Error GoTo 12
row1 = Val(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0)) + 1
row2 = Val(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind + 1, 0)) - 1
12
If ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1 Then row2 = UBound(c)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" Then
row1 = LBound(c)
row2 = UBound(c)
End If
col = row2 - row1 + 1
ReDim cc(1 To col, 1 To 6)
j = 1
For i = row1 To row2
cc(j, 1) = c(i, 1)
cc(j, 2) = c(i, 2)
cc(j, 3) = c(i, 3)
cc(j, 4) = c(i, 4)
cc(j, 5) = c(i, 5)
cc(j, 6) = c(i, 6)
j = j + 1
Next
ListBox1.List = cc
Me.Caption = "      " & Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" Then Me.Caption = ""
Me.tbFind_Nm.SetFocus
End Sub
Private Sub UserForm_Activate()
tbFind_Nm.SetFocus
Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListRows = 25
End Sub
Private Sub UserForm_Initialize()
flag = 1
On Error Resume Next
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Clear
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(0, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call load
ListBox1.Font.Size = 10.5
With Sheets("setting")
If .Range("b6") = 0 Then
Label_cod.Width = 0
tbFind_Cod.Width = 0
wid_cod = 0
Else
wid_cod = 65
End If
wid_nm = .Range("g13")
End With
Label_gr.Width = wid_nm - 33
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Width = Label_gr.Width + 13
tbFind_Nm.Width = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Width
Label_gr.Left = Label_cod.Left + Label_cod.Width + 1
tbFind_Nm.Left = Label_gr.Left
Label_cena.Left = Label_gr.Left + Label_gr.Width + 13
Label_cZ.Left = Label_cena.Left
Label_cR.Left = Label_cena.Left + Label_cena.Width - Label_cR.Width
Label_ost.Left = Label_cena.Left + Label_cena.Width + 1
NO.Left = Label_ost.Left
With ListBox1
.ColumnWidths = "0;" & wid_cod & ";" & CInt(wid_nm) & ";58;70;33"
.Width = CInt(Sheets("setting").Range("g12"))
End With
Me.Width = ListBox1.Width + 18
If Me.Width < 360 Then Me.Width = 360
DoEvents
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
.Left = Label_gr.Left
.Top = Label_gr.Top
.ZOrder 1
End With
Me.StartUpPosition = 0
With ActiveSheet.Shapes("cmb_d")
Me.Top = .Top + .Height + 15
End With
Me.Left = Application.Left + Application.Width - Me.Width - 15
Me.Height = Application.Height - 80
ListBox1.Height = Me.Height - 60
NO.ForeColor = RGB(255, 255, 255)
With frm
.Top = 0
.Left = Me.Width - .Width
.Height = Me.Height
.MousePointer = 9
.ZOrder 0
End With
flag = 0
DoEvents
End Sub
Private Sub load()
On Error Resume Next
Dim r As Long
Dim r1 As Long
Dim i As Long
Dim j As Long
Dim col As Integer
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
nm = Range(.Cells(5, skNm), .Cells(r, skNm)).Value
gr = Range(.Cells(5, skGr), .Cells(r, skGr)).Value
ed = Range(.Cells(5, skEd), .Cells(r, skEd)).Value
cod = Range(.Cells(5, skCod), .Cells(r, skCod)).Value
ost = Range(.Cells(5, skDs), .Cells(r, skDs)).Value
cnZ = Range(.Cells(5, skCenaZ), .Cells(r, skCenaZ)).Value
cnR = Range(.Cells(5, skCenaR), .Cells(r, skCenaR)).Value
col = Application.CountIf(Range(.Cells(5, skNm), .Cells(r, skNm)), "<>")
End With
ReDim c(1 To col + 1, 1 To 6)
ReDim c_ed(1 To col + 1, 1 To 1)
ReDim c_ds(1 To col + 1, 1 To 1)
j = 1
n = 1
For i = LBound(nm) To UBound(nm)
If nm(i, 1) <> "" Then
c(j, 1) = j
c(j, 2) = cod(i, 1)
c(j, 3) = nm(i, 1)
c(j, 4) = format(cnZ(i, 1), "0.00")
c(j, 5) = format(cnR(i, 1), "0.00")
c(j, 6) = ost(i, 1)
c_ed(j, 1) = ed(i, 1)
c_ds(j, 1) = ost(i, 1)
If gr(i, 1) <> "" Then
c(j, 2) = "-------------------------------------------------"
c(j, 3) = nm(i, 1) & "  -----------------------------------------------------------------"
c(j, 4) = "-------------------------------------------------"
c(j, 5) = "-------------------------------------------------"
c(j, 6) = "-------------------------------------------------"
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 0) = i
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 1) = nm(i, 1)
n = n + 1
End If
j = j + 1
End If
Next i
Call colListBox
ListBox1.List = c
End Sub
Private Sub colListBox()
On Error Resume Next
Dim r As Long
Dim n As Long
Dim i As Long
r = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
col = Application.CountIf(Range(Cells(rwZv, zvNm), Cells(r, zvNm)), "<>")
If col = 0 Then Exit Sub
nm = Range(Cells(rwZv, zvNm), Cells(r, zvNm)).Value
cod = Range(Cells(rwZv, zvCod), Cells(r, zvCod)).Value
cnZ = Range(Cells(rwZv, zvCenaZ), Cells(r, zvCenaZ)).Value
kl = Range(Cells(rwZv, zvCol), Cells(r, zvCol)).Value
For n = LBound(nm) To UBound(nm)
For i = LBound(c) To UBound(c)
If nm(n, 1) <> "" Then
If nm(n, 1) = c(i, 3) And cod(n, 1) = c(i, 2) And CDbl(cnZ(n, 1)) = c(i, 4) Then
c(i, 6) = Val(c(i, 6)) - Val(kl(n, 1))
End If
End If
Next
Next
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.Top = 17
NO.Height = 17
End Sub
Private Sub Label8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.Top = 17
NO.Height = 17
End Sub
Private Sub tbFind_Nm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.Top = 17
NO.Height = 17
End Sub
Private Sub ListBox1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.Top = 17
NO.Height = 17
End Sub
Private Sub NO_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.Top = 16
NO.Height = 18
End Sub
Private Sub frm_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
End Sub
Private Sub frm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
If flag = 1 Then Exit Sub
If Me.Width < 300 Then Exit Sub
Dim iMeWidth As Single
If Button = 1 Then
iMeWidth = Me.Width + X
If iMeWidth < iMeWidthMin Or iMeWidth > iMeWidthMax Then Exit Sub
Call MyMainFormAndControlResize(X, 0)
End If
End Sub
Private Sub MyMainFormAndControlDefaultSize()
End Sub
Private Sub MyMainFormAndControlResize(iXpos As Single, iYPos As Single)
On Error Resume Next
If flag = 1 Then Exit Sub
If Me.Width < 360 Then
Exit Sub
End If
With Me
.Width = .Width + iXpos
End With
With Label_gr
.Width = .Width + iXpos
End With
With tbFind_Nm
.Width = .Width + iXpos
End With
With ListBox1
.Width = .Width + iXpos
End With
wid_nm = wid_nm + iXpos
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
.Width = .Width + iXpos
End With
Label_gr.Left = Label_cod.Left + Label_cod.Width + 1
tbFind_Nm.Left = Label_gr.Left
Label_cena.Left = Label_gr.Left + Label_gr.Width + 13
Label_cZ.Left = Label_cena.Left
Label_cR.Left = Label_cena.Left + Label_cena.Width - Label_cR.Width
Label_ost.Left = Label_cena.Left + Label_cena.Width + 1
NO.Left = Label_ost.Left
With frm
.Left = .Left + iXpos
End With
Me.Repaint
End Sub
Private Sub frm_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
If wid_nm < 80 Then wid_nm = 80
With Sheets("setting")
.Range("g13") = wid_nm
.Range("g12") = ListBox1.Width
End With
With ListBox1
.ColumnWidths = "0;" & wid_cod & ";" & CInt(wid_nm) & ";58;70;33"
.Width = Sheets("setting").Range("g12")
End With
Me.Width = ListBox1.Width + 18
If Me.Width < 360 Then Me.Width = 360
With frm
.Top = 0
.Left = Me.Width - .Width
.Height = Me.Height
.MousePointer = 9
.ZOrder 0
End With
DoEvents
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
With Sheets("setting")
.Range("g13") = wid_nm
.Range("g12") = ListBox1.Width
End With
End Sub
Attribute VB_Name = "PraisePr"
Attribute VB_Base = "0{95613526-6C28-4596-A376-15E6C5445768}{1315C5E2-0467-4605-B071-AEBF4356690D}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim nm()
Dim gr()
Dim ed()
Dim cd()
Dim ost()
Dim cnZ()
Dim cnR()
Dim pv()
Dim c_ed()
Dim c_cR()
Dim ind As Integer
Dim w()
Dim c()
Dim cc()
Dim pstv As String
Dim find_Flag As Byte
Dim wid_pstv As Double
Dim wid_cod As Double
Dim wid_cena As Double
Dim str_ As String
Dim textS As String
Dim iCol As Long
Private Sub CheckBox1_Click()
With Sheets("setting")
If CheckBox1.Value = True Then
.Range("b6") = 1
Else
.Range("b6") = 0
End If
End With
End Sub
Private Sub CheckBox2_Click()
With Sheets("setting")
If CheckBox2.Value = True Then
.Range("b4") = 1
Else
.Range("b4") = 0
End If
End With
End Sub
Private Sub CheckBox3_Click()
With Sheets("setting")
If CheckBox3.Value = True Then
.Range("b35") = 1
Else
.Range("b35") = 0
End If
End With
End Sub
Private Sub Comb_Psv_Click()
pstv = Comb_Psv.Value
Range("d4") = pstv
Call |fffd||fffd||fffd||fffd||fffd|
ListBox1.SetFocus
End Sub
Private Sub Comb_Psv_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_Psv.DropDown
End Sub
Private Sub |fffd||fffd||fffd||fffd||fffd|()
On Error Resume Next
Dim col As Long
Dim i As Long
Dim j As Long
ReDim cc(LBound(c) To UBound(c), 1 To 6)
col = 0
For i = LBound(c) To UBound(c)
If c(i, 6) = pstv Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
col = col + 1
End If
Next
If col = 0 Then Exit Sub
ReDim w(1 To col, 1 To 6)
j = 1
For i = LBound(c) To UBound(c)
If cc(i, 2) <> "" Then
w(j, 1) = cc(i, 1)
w(j, 2) = cc(i, 2)
w(j, 3) = cc(i, 3)
w(j, 4) = cc(i, 4)
w(j, 5) = cc(i, 5)
w(j, 6) = cc(i, 6)
j = j + 1
End If
Next
ListBox1.Clear
ListBox1.List = w
End Sub
Private Sub ico_Click()
With Frame_columns
.Visible = True
.Top = Me.ListBox1.Top + 2
.Left = NO.Left
.ZOrder 0
End With
With Sheets("setting")
If .Range("b6") = 1 Then Me.CheckBox1.Value = True
If .Range("b4") = 1 Then Me.CheckBox2.Value = True
If .Range("b35") = 1 Then Me.CheckBox3.Value = True
End With
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 18
ico.Width = 18
End Sub
Private Sub Label_cod_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
find_Flag = 3
tbFind_Nm.Text = ""
tbFind_Cod.Text = ""
End Sub
Private Sub Label_pstv_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_Psv.DropDown
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
On Error Resume Next
ind = ListBox1.ListIndex
If ListBox1.List(ind, 2) = "" Then Exit Sub
If ListBox1.List(ind, 1) = "-------------------------------------------------" Then Exit Sub
Call ent_Pr
End Sub
Private Sub ent_Pr()
On Error Resume Next
Dim r As Integer
Dim n As Integer
Dim id As Long
Dim rr As Integer
Dim cell As Range
Dim tovar As String
Dim codd As String
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
id = ListBox1.List(ind, 0)
codd = ListBox1.List(ind, 1)
tovar = ListBox1.List(ind, 2)
cenaZ = ListBox1.List(ind, 3)
r = Cells(Rows.Count, prNm).End(xlUp).Row + 1
If r < 11 Then r = 11: GoTo 22
If cenaZ = "" Then GoTo 11
For Each cell In Range(Cells(11, prNm), Cells(r, prNm))
If cell = tovar And Cells(cell.Row, prCod) = codd And CDbl(Cells(cell.Row, prCenaZ)) = CDbl(cenaZ) Then
rr = cell.Row
Cells(rr, prCol) = Cells(rr, prCol) + 1
Cells(rr, prCol).Select
GoTo 99
End If
Next
11
For Each cell In Range(Cells(11, prNm), Cells(r, prNm))
If cell = tovar And Cells(cell.Row, prCod) = codd Then
rr = cell.Row
Cells(rr, prCol) = Cells(rr, prCol) + 1
Cells(rr, prCol).Select
GoTo 99
End If
Next
22
Cells(r, prNm) = ListBox1.List(ind, 2)
Cells(r, prEd) = c_ed(id, 1)
Cells(r, prCod) = ListBox1.List(ind, 1)
If ListBox1.List(ind, 3) <> "" Then Cells(r, prCenaZ) = CDbl(ListBox1.List(ind, 3))
If c_cR(id, 1) <> "" Then Cells(r, prCenaR) = CDbl(c_cR(id, 1))
Cells(r, prCol) = 1
Cells(r, prCenaZ).NumberFormat = "#,##0.00"
Cells(r, prCenaR).NumberFormat = "#,##0.00"
Range(Cells(r, prNm), Cells(r, prSum)).Borders.LineStyle = True
Range(Cells(r, prNm), Cells(r, prSum)).Borders.Color = RGB(174, 185, 173)
Range(Cells(r, prCod), Cells(r, prGr)).HorizontalAlignment = xlCenter
With Range(Cells(r, prNm), Cells(r, prGr))
.Font.Name = "Cambria"
.Font.Size = 11
End With
Range(Cells(r, prNm), Cells(r, prNm)).WrapText = True
Cells(r, prCol).Select
99
End Sub
Private Sub ListBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Call Frame_columns_hide
End Sub
Private Sub NO2_Click()
Unload Me
End Sub
Private Sub Label_gr_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
find_Flag = 3
tbFind_Nm.Text = ""
tbFind_Cod.Text = ""
End Sub
Private Sub OK_Click()
Unload Me
DoEvents
Call Show_PraisePr
End Sub
Private Sub tbFind_Cod_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
find_Flag = 1
tbFind_Nm.Text = ""
End Sub
Private Sub tbFind_Nm_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
find_Flag = 2
tbFind_Cod.Text = ""
End Sub
Private Sub tbFind_Cod_Change()
Call find_zv_Cod
End Sub
Private Sub tbFind_Nm_Change()
Call find_zv_Nm
Me.ListBox1.Height = Me.Height - 60
Me.Repaint
DoEvents
End Sub
Sub find_zv_Cod()
On Error Resume Next
If find_Flag = 2 Then Exit Sub
If find_Flag = 3 Then Exit Sub
Dim r As Long
Dim j As Long
Dim i As Long
iCol = 0
ListBox1.Clear
str_ = Me.tbFind_Cod.Text
If Len(str_) = 0 Then ListBox1.List = c: Exit Sub
ReDim cc(LBound(c) To UBound(c), 1 To 6)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If c(i, 2) <> "-------------------------------------------------" Then
If UCase(Left(c(i, 2), 1)) = textS Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
Else
If InStr(1, UCase(c(i, 2)), textS) > 0 Then
If c(i, 2) <> "-------------------------------------------------" Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
End If
Next

If iCol = 0 Then Exit Sub
ReDim w(1 To iCol + 1, 1 To 6)
j = 1
For i = LBound(c) To UBound(c)
If cc(i, 2) <> "" Then
w(j, 1) = cc(i, 1)
w(j, 2) = cc(i, 2)
w(j, 3) = cc(i, 3)
w(j, 4) = cc(i, 4)
w(j, 5) = cc(i, 5)
w(j, 6) = format(cc(i, 6), "0.00")
j = j + 1
End If
Next
tbFind_Nm.Text = ""
ListBox1.List = w
End Sub
Sub find_zv_Nm()
On Error Resume Next
If find_Flag = 1 Then Exit Sub
If find_Flag = 3 Then Exit Sub
Dim r As Long
Dim j As Long
Dim i As Long
iCol = 0
ListBox1.Clear
str_ = Me.tbFind_Nm.Text
If Len(str_) = 0 Then ListBox1.List = c: Exit Sub
ReDim cc(LBound(c) To UBound(c), 1 To 6)
textS = UCase(str_)
For i = LBound(c) To UBound(c)
If Len(str_) = 1 Then
If c(i, 2) <> "-------------------------------------------------" Then
If UCase(Left(c(i, 3), 1)) = textS Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
Else
If InStr(1, UCase(c(i, 3)), textS) > 0 Then
If c(i, 2) <> "-------------------------------------------------" Then
cc(i, 1) = c(i, 1)
cc(i, 2) = c(i, 2)
cc(i, 3) = c(i, 3)
cc(i, 4) = c(i, 4)
cc(i, 5) = c(i, 5)
cc(i, 6) = c(i, 6)
iCol = iCol + 1
End If
End If
End If
Next
If iCol = 0 Then Exit Sub
ReDim w(1 To iCol + 1, 1 To 6)
j = 1
For i = LBound(c) To UBound(c)
If cc(i, 3) <> "" Then
w(j, 1) = cc(i, 1)
w(j, 2) = cc(i, 2)
w(j, 3) = cc(i, 3)
w(j, 4) = cc(i, 4)
w(j, 5) = cc(i, 5)
w(j, 6) = format(cc(i, 6), "0.00")
j = j + 1
End If
Next
tbFind_Cod.Text = ""
ListBox1.List = w
End Sub
Private Sub Comb_|fffd||fffd||fffd||fffd||fffd||fffd|_Change()
On Error Resume Next
Dim row1 As Long
Dim row2 As Long
Dim j As Long
Dim i As Long
Dim col As Long
ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListIndex
If ind = -1 Then Exit Sub
ListBox1.Clear
On Error GoTo 12
row1 = Val(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 0)) + 1
row2 = Val(Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind + 1, 0)) - 1
12
If ind = Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.ListCount - 1 Then row2 = UBound(c)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" Then
row1 = LBound(c)
row2 = UBound(c)
End If
col = row2 - row1 + 1
ReDim cc(1 To col, 1 To 6)
j = 1
For i = row1 To row2
cc(j, 1) = c(i, 1)
cc(j, 2) = c(i, 2)
cc(j, 3) = c(i, 3)
cc(j, 4) = c(i, 4)
cc(j, 5) = c(i, 5)
cc(j, 6) = c(i, 6)
j = j + 1
Next
ListBox1.List = cc
Me.Caption = "      " & Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1)
If Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(ind, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|" Then Me.Caption = ""
Me.tbFind_Nm.SetFocus
End Sub
Private Sub UserForm_Activate()
On Error Resume Next
tbFind_Nm.SetFocus
ico.Left = NO.Left + 3
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.Clear
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(0, 1) = "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|"
Call load
ListBox1.Font.Size = 10.5
With Sheets("setting")
If .Range("b6") = 0 Then
Label_cod.Width = 0
tbFind_Cod.Width = 0
wid_cod = 0
Else
wid_cod = 65
End If
If .Range("b4") = 0 Then
Comb_Psv.Width = 0
Label_pstv.Width = 0
wid_pstv = 0
Else
wid_pstv = 40
End If
If .Range("b35") = 0 Then
Label_cena.Width = 0
wid_cena = 0
Else
wid_cena = 70
End If
NO.Width = Label_cena.Width + Label_ost.Width + 1
End With
With Sheets("setting")
If .Range("b4") = 1 Then Call load_psv
End With
Label_gr.Left = Label_cod.Left + Label_cod.Width + 1
tbFind_Nm.Left = Label_gr.Left
Label_cena.Left = Label_gr.Left + Label_gr.Width + 13
NO.Left = Label_cena.Left
Label_ost.Left = Label_cena.Left + Label_cena.Width + 1
Label_pstv.Left = Label_ost.Left + Label_ost.Width + 1
Comb_Psv.Left = Label_pstv.Left
With ListBox1
.ColumnWidths = "0;" & wid_cod & ";200;" & wid_cena & ";48;" & wid_pstv
.Width = Label_pstv.Left + Label_pstv.Width - 4
End With
DoEvents
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd|
.Left = Label_gr.Left
.Top = Label_gr.Top
.Width = Label_gr.Width + 13
.ZOrder 1
End With
Me.Width = Label_pstv.Left + Label_pstv.Width + 12
Me.StartUpPosition = 0
With ActiveSheet.Shapes("cmb_d")
Me.Top = .Top + .Height + 15
End With
Me.Left = Application.Left + Application.Width - Me.Width - 15
Me.Height = Application.Height - 80
ListBox1.Height = Me.Height - 60
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub load()
On Error Resume Next
Dim r As Long
Dim n As Long
Dim i As Long
Dim j As Long
Dim col As Integer
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
nm = Range(.Cells(5, skNm), .Cells(r, skNm)).Value
gr = Range(.Cells(5, skGr), .Cells(r, skGr)).Value
ed = Range(.Cells(5, skEd), .Cells(r, skEd)).Value
cd = Range(.Cells(5, skCod), .Cells(r, skCod)).Value
ost = Range(.Cells(5, skDs), .Cells(r, skDs)).Value
cnZ = Range(.Cells(5, skCenaZ), .Cells(r, skCenaZ)).Value
cnR = .Range(.Cells(5, skCenaR), .Cells(r, skCenaR)).Value
pv = Range(.Cells(5, skPstv), .Cells(r, skPstv)).Value
col = Application.CountIf(Range(.Cells(5, skNm), .Cells(r, skNm)), "<>")
End With
ReDim c(1 To col + 1, 1 To 6)
ReDim c_ed(1 To col + 1, 1 To 1)
ReDim c_cR(1 To col + 1, 1 To 1)
j = 1
n = 1
For i = LBound(nm) To UBound(nm)
If nm(i, 1) <> "" Then
c(j, 1) = i
c(j, 2) = cd(i, 1)
c(j, 3) = nm(i, 1)
c(j, 4) = format(cnZ(i, 1), "0.00")
c(j, 5) = ost(i, 1)
c(j, 6) = pv(i, 1)
c_ed(j, 1) = ed(i, 1)
c_cR(j, 1) = format(cnR(i, 1), "0.00")
If gr(i, 1) <> "" Then
c(j, 2) = "-------------------------------------------------"
c(j, 3) = nm(i, 1) & "  -----------------------------------------------------------------"
c(j, 4) = "-------------------------------------------------"
c(j, 5) = "-------------------------------------------------"
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.AddItem ""
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 0) = i
Comb_|fffd||fffd||fffd||fffd||fffd||fffd|.List(n, 1) = nm(i, 1)
n = n + 1
End If
j = j + 1
End If
Next i
ListBox1.List = c
End Sub
Private Sub load_psv()
On Error Resume Next
Dim r As Long
Dim i As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:f" & r + 22).Clear
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(pv), 1) = pv
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, 1).End(xlUp).Row
.Range("a1:a" & r).RemoveDuplicates Columns:=1, header:=xlNo
r = .Cells(Rows.Count, 1).End(xlUp).Row
For i = 1 To r
If .Cells(i, "a") <> "" Then
Comb_Psv.AddItem .Cells(i, "a")
End If
Next i
End With
Application.CutCopyMode = False
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 0
NO.Top = 18
NO.Height = 15.75
End Sub
Private Sub Label8_Click()
End Sub
Private Sub Label8_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 0
NO.Top = 18
NO.Height = 15.75
End Sub
Private Sub tbFind_Nm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 0
NO.Top = 18
NO.Height = 15.75
End Sub
Private Sub ListBox1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 0
NO.Top = 18
NO.Height = 15.75
ico.Height = 15
ico.Width = 15
End Sub
Private Sub NO_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 6
NO.Top = 16
NO.Height = 20
ico.Height = 15
ico.Width = 15
End Sub
Private Sub NO1_Click()
Call Frame_columns_hide
End Sub
Private Sub Frame_columns_hide()
With Frame_columns
.ZOrder 1
.Visible = False
End With
DoEvents
End Sub
Private Sub Frame_columns_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
NO.SpecialEffect = 0
NO.Top = 18
NO.Height = 15.75
ico.Height = 15
ico.Width = 15
End Sub
Attribute VB_Name = "UserForm1"
Attribute VB_Base = "0{2D4E5EC5-CFC8-49DD-955F-D907F139DC8A}{09D21F86-BBD2-42E9-9FA5-36D700651C2B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label1_Click()
Unload Me
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
With Me
.StartUpPosition = 0
.Top = Application.Height
.Left = Application.Width - .Width
End With
Me.Label1.Caption = msg_text
End Sub
Attribute VB_Name = "Waite"
Attribute VB_Base = "0{ED18846D-9B65-43CE-A912-D740EE80E051}{3DCB7FD1-F713-4446-B64E-902DA3CD7A63}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Attribute VB_Name = "add_psv"
Attribute VB_Base = "0{06F3140B-D995-4A81-B61A-7BDC073EEE3F}{6F7424E3-5B8E-4481-B2A5-74004BC8F21B}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
If TextBox1.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
TextBox1.SetFocus
Exit Sub
End If
Call add_pstvk
End Sub
Private Sub add_pstvk()
Dim r As Long
Dim i As Long
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzPst).End(xlUp).Row + 1
.Cells(r, bzPst) = TextBox1.Text
.Cells(r, bzPst + 1) = TextBox2.Text
.Cells(r, bzPst + 2) = TextBox3.Text
.Range(.Cells(r, bzPst + 1), .Cells(r, bzPst + 2)).HorizontalAlignment = xlCenter
End With
With vvodPr.comb_Pst
.Clear
For i = 2 To r
If Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzPst) <> "" Then
.AddItem Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzPst)
End If
Next
End With
vvodPr.tb_Pst.Text = TextBox1.Text
ScreenOn
Application.DisplayAlerts = True
Unload Me
DoEvents
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Private Sub UserForm_Initialize()
Me.StartUpPosition = 0
Me.Height = 0
Me.Top = vvodPr.Top
Me.Left = vvodPr.Left
OK.BackColor = RGB(55, 96, 145)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub UserForm_Click()
End Sub

Attribute VB_Name = "add_zkz"
Attribute VB_Base = "0{8986BDD4-03CE-427C-9BCC-2AF07E89B538}{FC5BDECA-43ED-49BF-8736-FDBD46B432DD}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
If TextBox1.Text = "" Then
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
TextBox1.SetFocus
Exit Sub
End If
Call add_zkzz
End Sub
Private Sub add_zkzz()
Dim r As Long
Dim i As Long
Dim j As Long
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzZkz).End(xlUp).Row + 1
.Cells(r, bzZkz) = TextBox1.Text
.Cells(r, bzAdr) = TextBox2.Text
.Cells(r, bzTlf) = TextBox3.Text
.Cells(r, bzMail) = TextBox4.Text
.Range(.Cells(r, bzTlf), .Cells(r, bzMail)).HorizontalAlignment = xlCenter
End With
j = 0
With vvodZv.comb_Zkz
.Clear
For i = 2 To r
If Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzZkz) <> "" Then
.AddItem ""
.List(j, 0) = Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzZkz)
.List(j, 1) = Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzAdr)
.List(j, 2) = Sheets("|fffd||fffd||fffd||fffd|").Cells(i, bzTlf)
j = j + 1
End If
Next
End With
With vvodZv
.tb_Zkz.Text = TextBox1.Text
.tb_Adr.Text = TextBox2.Text
.tb_Tlf.Text = TextBox3.Text
End With
ScreenOn
Application.DisplayAlerts = True
Unload Me
DoEvents
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Private Sub UserForm_Initialize()
Me.StartUpPosition = 0
Me.Height = 0
Me.Top = vvodZv.Top
Me.Left = vvodZv.Left
OK.BackColor = RGB(55, 96, 145)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub UserForm_Click()
End Sub
Attribute VB_Name = "fSet"
Attribute VB_Base = "0{E793D6F8-9C22-4284-A947-04BD6B2D24FA}{5A5D3BBD-483A-4F16-9AC8-9C07CC9F2005}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False

Dim wb As Workbook
Dim wa As Workbook
Dim sFolder As String
Dim sFiles As String
Dim vbDirectiry
Dim r As Long
Private Sub CheckBox1_Change()
With Sheets("setting")
If CheckBox1.Value = True Then
.Range("i4") = 1
Else
.Range("i4") = 0
End If
End With
End Sub
Private Sub CheckBox2_Change()
With Sheets("setting")
If CheckBox2.Value = True Then
.Range("i5") = 1
Else
.Range("i5") = 0
End If
End With
End Sub
Private Sub sh_cod_Click()
On Error Resume Next
With Sheets("setting")
If sh_cod.Value = True Then
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skCod).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zvCod).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, prCod).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zkCod).EntireColumn.Hidden = False
.Range("b6") = 1
Else
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skCod).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zvCod).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, prCod).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zkCod).EntireColumn.Hidden = True
.Range("b6") = 0
End If
End With
End Sub
Private Sub sh_cr_Click()
On Error Resume Next
With Sheets("setting")
If sh_cr.Value = True Then
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skCr).EntireColumn.Hidden = False
Sheets("C|fffd||fffd||fffd||fffd|").Shapes("cmb_Cr").Visible = True
.Range("b3") = 1
.Range("i2") = 1
Else
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skCr).EntireColumn.Hidden = True
Sheets("C|fffd||fffd||fffd||fffd|").Shapes("cmb_Cr").Visible = False
.Range("b3") = 0
.Range("i2") = 0
End If
End With
End Sub
Private Sub sh_pv_Click()
On Error Resume Next
With Sheets("setting")
If sh_pv.Value = True Then
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skPstv).EntireColumn.Hidden = False
.Range("b4") = 1
Else
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skPstv).EntireColumn.Hidden = True
.Range("b4") = 0
End If
End With
End Sub
Private Sub sh_ed_Click()
On Error Resume Next
With Sheets("setting")
If sh_ed.Value = True Then
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skEd).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zvEd).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zkEd).EntireColumn.Hidden = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, prEd).EntireColumn.Hidden = False
.Range("b5") = 1
Else
Sheets("C|fffd||fffd||fffd||fffd|").Cells(1, skEd).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zvEd).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, zkEd).EntireColumn.Hidden = True
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Cells(1, prEd).EntireColumn.Hidden = True
.Range("b5") = 0
End If
End With
End Sub
Private Sub sh_skidka_Click()
On Error Resume Next
ScreenOff
With Sheets("setting")
If sh_skidka.Value = True Then
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvSkid).EntireColumn.Hidden = False
.Cells(1, zvSumA).EntireColumn.Hidden = False
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkSkid).EntireColumn.Hidden = False
.Cells(1, zkSumA).EntireColumn.Hidden = False
End With
.Range("b7") = 1
Else
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvSkid).EntireColumn.Hidden = True
.Cells(rwZv - 1, zvSkid) = ""
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkSkid).EntireColumn.Hidden = True
End With
.Range("b7") = 0
End If
If .Range("b7") = 0 And .Range("b8") = 0 Then
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvSumA).EntireColumn.Hidden = True
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkDost).EntireColumn.Hidden = True
.Cells(1, zkSkid).EntireColumn.Hidden = True
.Cells(1, zkSumA).EntireColumn.Hidden = True
End With
End If
End With
ScreenOn
End Sub
Private Sub sh_dostavka_Click()
On Error Resume Next
With Sheets("setting")
If sh_dostavka.Value = True Then
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvDost).EntireColumn.Hidden = False
.Cells(1, zvSumA).EntireColumn.Hidden = False
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkDost).EntireColumn.Hidden = False
.Cells(1, zkSumA).EntireColumn.Hidden = False
End With
.Range("b8") = 1
Else
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvDost).EntireColumn.Hidden = True
.Cells(rwZv - 1, zvDost) = ""
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkDost).EntireColumn.Hidden = True
End With
.Range("b8") = 0
End If
If .Range("b7") = 0 And .Range("b8") = 0 Then
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zvSumA).EntireColumn.Hidden = True
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(1, zkDost).EntireColumn.Hidden = True
.Cells(1, zkSkid).EntireColumn.Hidden = True
.Cells(1, zkSumA).EntireColumn.Hidden = True
End With
End If
End With
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
On Error Resume Next
Call msg_demo
End Sub
Private Sub UserForm_Initialize()
With Sheets("setting")
If .Range("b8") = 1 Then sh_dostavka.Value = True
If .Range("b7") = 1 Then sh_skidka.Value = True
If .Range("b6") = 1 Then sh_cod.Value = True
If .Range("b5") = 1 Then sh_ed.Value = True
If .Range("b3") = 1 Then sh_cr.Value = True
If .Range("b4") = 1 Then sh_pv.Value = True
If .Range("i4") = 1 Then CheckBox1.Value = True
If .Range("i5") = 1 Then CheckBox2.Value = True
End With
End Sub

Attribute VB_Name = "fSetPr"
Attribute VB_Base = "0{DD2E82B3-2AC2-4975-BEEA-D372E0FBCBFF}{7EE49292-FA62-4780-B425-C7C8139DADAC}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim i As Integer
Dim n As Integer
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
On Error Resume Next
With Sheets("setting")
For i = 1 To 7
.Cells(i + 1, "m").Value = Val(Me.Controls("TextBox" & i))
Next
End With
With Sheets("setting")
If CheckBox1.Value = True Then
.Range("i7").Value = 1
Else
.Range("i7").Value = 0
End If
End With
With Form_Enter.Comb_Z
.Clear
For i = 2 To 8
If Sheets("setting").Cells(i, "m") <> "" Then
.AddItem Sheets("setting").Cells(i, "m")
End If
Next i
End With
Unload Me
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
n = 1
With Sheets("setting")
For i = 2 To 8
If .Cells(i, "m") <> "" Then
Me.Controls("TextBox" & n) = .Cells(i, "m").Value
n = n + 1
End If
Next
End With
If Sheets("setting").Range("i7").Value = 1 Then CheckBox1.Value = True
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub UserForm_Click()
End Sub

Attribute VB_Name = "fSetPraise"
Attribute VB_Base = "0{CB03CCCB-9D69-4CB8-8F6A-ACB512AA8EDF}{CF92EDD7-7E01-4E58-8359-87AD02F50AD9}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub OK_Click()
With Sheets("setting")
.Range("f13") = TextBox1.Text
.Range("f14") = TextBox2.Text
.Range("f15") = TextBox3.Text
.Range("f16") = TextBox4.Text
.Range("f17") = TextBox5.Text
End With
With Sheets("setting")
If CheckBox1.Value = True Then: .Range("e13") = 1: Else: .Range("e13") = 0
If CheckBox2.Value = True Then: .Range("e14") = 1: Else: .Range("e14") = 0
If CheckBox3.Value = True Then: .Range("e15") = 1: Else: .Range("e15") = 0
If CheckBox4.Value = True Then: .Range("e16") = 1: Else: .Range("e16") = 0
If CheckBox5.Value = True Then: .Range("e17") = 1: Else: .Range("e17") = 0
End With
With Sheets("setting")
If OptionButton1.Value = True Then: .Range("e22") = 1: Else: .Range("e22") = 2
If OptionButton3.Value = True Then: .Range("e24") = 1: Else: .Range("e24") = 2
If OptionButton5.Value = True Then: .Range("e26") = 1: Else: .Range("e26") = 2
If OptionButton7.Value = True Then: .Range("e28") = 1: Else: .Range("e28") = 2
End With
Unload Me
End Sub
Private Sub UserForm_Initialize()
With Sheets("setting")
If .Range("e14") = 1 Then CheckBox2.Value = True
If .Range("e15") = 1 Then CheckBox3.Value = True
If .Range("e16") = 1 Then CheckBox4.Value = True
If .Range("e17") = 1 Then CheckBox5.Value = True
End With
With Sheets("setting")
TextBox1.Text = .Range("f13")
TextBox2.Text = .Range("f14")
TextBox3.Text = .Range("f15")
TextBox4.Text = .Range("f16")
TextBox5.Text = .Range("f17")
End With

With Sheets("setting")
If .Range("e22") = 1 Then: OptionButton1.Value = True: Else: OptionButton2.Value = True
If .Range("e24") = 1 Then: OptionButton3.Value = True: Else: OptionButton4.Value = True
If .Range("e26") = 1 Then: OptionButton5.Value = True: Else: OptionButton6.Value = True
If .Range("e28") = 1 Then: OptionButton7.Value = True: Else: OptionButton8.Value = True
End With
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub UserForm_Click()
End Sub


Attribute VB_Name = "findALL"
Attribute VB_Base = "0{3FBE27F1-791B-4C12-98D1-7FAAC6A13440}{DFC292F7-01BF-4424-BE59-C6C8E7E5B006}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim r As Long
Dim i As Long
Dim n As Long
Dim nn()
Dim mm()
Dim nm()
Dim dt()
Private Sub ListBox1_Click()
On Error Resume Next
Dim ind As Integer
Dim rw As Long
If Check_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value = False Then Exit Sub
If ListBox1.ListStyle = fmListStyleOption Then
Check_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value = False
Exit Sub
End If
ind = ListBox1.ListIndex
rw = ListBox1.List(ind, 0)
Range(Cells(rw, 1), Cells(rw, 22)).Select
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Dim a()
Dim b()
Dim col
r = Cells(Rows.Count, zkNm).End(xlUp).Row + 1
mm = Range(Cells(4, 1), Cells(r, 1)).Value
nn = Range(Cells(4, zkNomer), Cells(r, zkNomer)).Value
nm = Range(Cells(4, zkNm), Cells(r, zkNm)).Value
dt = Range(Cells(4, zkDt2), Cells(r, zkDt2)).Value
col = Application.CountIf(Range("a4:a" & r), "<>")
If col = 0 Then Exit Sub
ReDim b(1 To col, 1 To 4)
n = 1
For i = LBound(nm) To UBound(nm)
If mm(i, 1) <> "" Then
b(n, 1) = i + 3
b(n, 2) = nm(i, 1)
b(n, 3) = nn(i, 1)
b(n, 4) = format(dt(i + 1, 1), "dd.mm.yyyy")
n = n + 1
End If
Next
ListBox1.List = b
Check_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value = True
ListBox1.ColumnWidths = "0;140;33;33"
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Attribute VB_Name = "frmHelp"
Attribute VB_Base = "0{03AAE673-8D03-43DA-AD9E-AE8763ADADEB}{2680FC96-57A2-4847-BA35-260D3508DA58}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub Label12_Click()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|..."
DoEvents
ThisWorkbook.FollowHyperlink "https://yadi.sk/i/iwzwpburz4MGJ"
If Err Then Unload Waite: DoEvents: MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 48, " |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Unload Waite
End Sub
Private Sub Label12_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label12.ForeColor = &HC000&
End Sub
Private Sub MultiPage1_Change()
With Me.MultiPage1
If .Value = 0 Then Sheets("C|fffd||fffd||fffd||fffd|").Select
If .Value = 1 Then Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
If .Value = 2 Then Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
If .Value = 3 Then Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
End With
End Sub
Private Sub TextBox1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Label12.ForeColor = RGB(0, 0, 0)
End Sub
Private Sub TextBox5_Change()
End Sub
Private Sub UserForm_Initialize()
Me.StartUpPosition = 0
Me.Top = Application.Top + 15
Me.Left = Application.Width - Me.Width - 15
If ActiveSheet.Name = "C|fffd||fffd||fffd||fffd|" Then Me.MultiPage1.Value = 0
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then Me.MultiPage1.Value = 1
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then Me.MultiPage1.Value = 2
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd||fffd|" Then Me.MultiPage1.Value = 3
End Sub
Private Sub Label10_Click()
Unload Me
End Sub
Private Sub Label11_Click()
Unload Me
End Sub
Private Sub Label8_Click()
Unload Me
End Sub
Private Sub Label9_Click()
Unload Me
End Sub
Private Sub UserForm_Click()
End Sub
Private Sub Label13_Click()
Unload Me
End Sub
Attribute VB_Name = "frm_Otch"
Attribute VB_Base = "0{28239122-090F-4D20-AD5D-905309C2C8CA}{A04A229C-B7E4-4AF0-AFED-271AF08F69FB}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Const h1 = 168
Const h2 = 196
Const hf1 = 62
Const hf2 = 122
Const hOK1 = 108
Const hOK2 = 144
Dim r As Long
Dim i As Long
Dim cm As Integer
Private Sub ComboBox1_Change()
mm = Month(Date)
Sheets("setting").Range("q2:q5") = ""
With Me.ComboBox1
If .Value = "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|" Then TextBox1.Text = "01.01." & Year(Now): Sheets("setting").Range("q2") = 1
If .Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" Then TextBox1.Text = "01." & mm & "." & Year(Now): Sheets("setting").Range("q3") = 1
If .Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd||fffd|" Then
TextBox1.Text = "01." & mm - 1 & "." & Year(Now)
If mm = 1 Then TextBox1.Text = "01." & "12." & Year(Now)
Sheets("setting").Range("q4") = 1
End If
If .Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then TextBox1.Text = Date: Sheets("setting").Range("q5") = 1
End With
TextBox1.SetFocus
End Sub
Private Sub ComboBox1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ComboBox1.DropDown
End Sub
Private Sub ico1_Click()
If Me.Height < 190 Then
Me.Height = h2
Me.Frame1.Height = hf2
OK.Top = hOK2
Else
Me.Height = h1
Me.Frame1.Height = hf1
OK.Top = hOK1
End If
End Sub
Private Sub OK_Click()
Unload Me
DoEvents
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
With Me.ComboBox1
.AddItem "|fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd|"
.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| 2 |fffd||fffd||fffd||fffd||fffd||fffd|"
.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End With
With Sheets("setting")
If .Range("q2") = 1 Then Me.ComboBox1.ListIndex = 0
If .Range("q3") = 1 Then Me.ComboBox1.ListIndex = 1
If .Range("q4") = 1 Then Me.ComboBox1.ListIndex = 2
If .Range("q5") = 1 Then Me.ComboBox1.ListIndex = 3
End With
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" Then
Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Else
Label7.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
End If
TextBox2.Text = Date
Call load
End Sub
Public Sub load()
If ActiveSheet.Name = "|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|" Then
cm = bzPst
Else
cm = bzZkz
End If
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, cm).End(xlUp).Row + 1
For i = 2 To r
If .Cells(i, cm) <> "" Then
Me.comb_Zkz.AddItem .Cells(i, cm)
End If
Next
r = .Cells(Rows.Count, bzMj).End(xlUp).Row + 1
For i = 2 To r
If .Cells(i, bzMj) <> "" Then
Me.comb_Mj.AddItem .Cells(i, bzMj)
End If
Next
End With
comb_Zkz.AddItem "|fffd||fffd||fffd|"
comb_Mj.AddItem "|fffd||fffd||fffd|"
comb_Zkz.Value = "|fffd||fffd||fffd|"
comb_Mj.Value = "|fffd||fffd||fffd|"
End Sub
Private Sub TextBox1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
cntr.Text = 1
Call ShowForm4
End Sub
Private Sub TextBox2_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
cntr.Text = 2
Call ShowForm4
End Sub
Private Sub UserForm_Click()
On Error Resume Next
Unload Form_SelectDate
cntr.SetFocus
End Sub
Private Sub comb_Mj_Change()
cntr.SetFocus
End Sub
Private Sub comb_Zkz_Change()
cntr.SetFocus
End Sub
Attribute VB_Name = "frm_Praise"
Attribute VB_Base = "0{6F26A98C-9E63-4BAD-8153-84A3A1A6300F}{6203ACBD-2B26-40E5-A8D3-5A973F448278}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ico_Click()
fSetPraise.Show
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Sub |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|()
Me.TextBox1.Value = GetRate("EUR", Now)
End Sub
Sub |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Me.TextBox2.Value = GetRate("USD", Now)
End Sub
Private Sub OK_Click()
Call do_praise
End Sub
Private Sub OK2_Click()
On Error Resume Next
Call |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 20
ico.Width = 20
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 18
ico.Width = 18
End Sub
Private Sub UserForm_Click()
End Sub
Attribute VB_Name = "frm_Valuta"
Attribute VB_Base = "0{E275793A-7B0E-4605-97ED-F4BA0FF11224}{9BE968C6-98E6-4B05-B2B1-458FCF8A3A12}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd|
End Sub
Sub |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|()
Me.TextBox1.Value = GetRate("EUR", Now)
End Sub
Sub |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|()
Me.TextBox2.Value = GetRate("USD", Now)
End Sub
Private Sub OK2_Click()
On Error Resume Next
Call |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd|
Call |fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd|
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
End Sub
Private Sub UserForm_Click()
End Sub

Attribute VB_Name = "msgForm"
Attribute VB_Base = "0{7B46412E-9314-4FF2-B6CF-A47091572626}{31408737-7FEA-4310-A22D-E4918FEB83A1}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub CommandButton1_Click()
Unload Me
End Sub
Attribute VB_Name = "prodavec"
Attribute VB_Base = "0{37BA3B18-020D-44E9-BC07-7E65BC46DAE7}{66D5B009-DD6D-4EBF-A8A5-AD52D0111645}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim flagSet As Byte
Dim n As Integer
Dim r As Integer
Dim i As Integer
Dim j As Integer
Dim passAdm As String
Dim passMnj As String
Private Sub UserForm_Initialize()
Me.TextBox1.Text = ThisWorkbook.Sheets("setting").Range("h2")
End Sub
Private Sub CommandButton1_Click()
With Sheets("setting")
passAdm = "111"
passMnj = "222"
End With
If tbPass.Text = "" Then MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd|": tbPass.Text = "": tbPass.SetFocus: Exit Sub
If tbPass.Text = passAdm Then
Call login_Adm
Else
If tbPass.Text = passMnj Then
Call login_Mnj
Else
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd|": tbPass.Text = "": tbPass.SetFocus: Exit Sub
End If
End If
99
Unload Me
End Sub
Private Sub CommandButton2_Click()
On Error Resume Next
Application.DisplayAlerts = False
Application.Quit
End Sub
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
If CloseMode = vbFormControlMenu Then Cancel = True
End Sub
Public Sub login_Adm()
Sheets("setting").Range("z1") = 1
Sheets("setting").Range("z2") = 0
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
Sheets("C|fffd||fffd||fffd||fffd|").Cells(2, skCenaZ).EntireColumn.Hidden = False
Call z_no
End Sub
Public Sub login_Mnj()
Sheets("setting").Range("z1") = 0
Sheets("setting").Range("z2") = 1
With Sheets("setting")
If .Range("aa1") = 1 Then
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = 2
Else
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = True
End If
If .Range("aa2") = 1 Then
Sheets("C|fffd||fffd||fffd||fffd|").Cells(2, skCenaZ).EntireColumn.Hidden = True
Else
Sheets("C|fffd||fffd||fffd||fffd|").Cells(2, skCenaZ).EntireColumn.Hidden = False
End If
If .Range("aa3") = 1 Then
Call z_yes
Else
Call z_no
End If
End With
End Sub

Attribute VB_Name = "qee27"
Dim nm()
Dim cod()
Dim col()
Dim nm_sk()
Dim cod_sk()
Dim r As Long
Dim n As Long
Dim i As Long
Dim j As Long
Dim r7 As Long
Dim r9 As Long
Dim n2 As Long
Public Sub spSk()
On Error Resume Next
Call unload_mn_vid
DoEvents
Unload Praise
DoEvents
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, zvNm).End(xlUp).Row
If r < rwZv Then
MsgBox "          |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!" & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", 64, ""
Exit Sub
End If
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
For i = rwZv To r
If .Cells(i, zvCol) = "" Then
.Cells(i, zvCol).Select
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
Next
End With
If MsgBox("     |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?               " & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(4, zvCod) & Chr(10) & _
"   |fffd||fffd||fffd||fffd|: " & Cells(8, zvCod), vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Call spzv_
End Sub
Private Sub spzv_()
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
Call dann
Call arr_this
Call arr_sk
Call hyjt_ukllre
Call logoOt
Call zvClearsp
Sheets("setting").Range("d2") = ""
Sheets("C|fffd||fffd||fffd||fffd|").Select
ThisWorkbook.Save
Call msg_Formsp
ScreenOn
Application.DisplayAlerts = True
Unload Waite
DoEvents
Call showForm
End Sub
Private Sub dann()
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
marker = "c" & Now
nomer = .Range("d2")
zkzz = .Range("d4")
mnjj = .Range("d7")
datt = .Range("d8")
datt2 = .Range("d9")
adr = .Range("d5")
tlf = .Range("d6")
summ = .Cells(rwZv - 1, zvSum)
summA = .Cells(rwZv - 1, zvSumA)
skidka_ = .Cells(rwZv - 1, zvSkid)
dostavka_ = .Cells(rwZv - 1, zvDost)
End With
End Sub
Private Sub arr_this()
On Error Resume Next
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r7 = .Cells(Rows.Count, zvNm).End(xlUp).Row + 2
nm = .Range(.Cells(rwZv, zvNm), .Cells(r7, zvNm)).Value
col = .Range(.Cells(rwZv, zvCol), .Cells(r7, zvCol)).Value
cod = .Range(.Cells(rwZv, zvCod), .Cells(r7, zvCod)).Value
End With
End Sub
Private Sub arr_sk()
On Error Resume Next
With ThisWorkbook.Sheets("C|fffd||fffd||fffd||fffd|")
r9 = .Cells(Rows.Count, skNm).End(xlUp).Row + 4
nm_sk = .Range(.Cells(5, skNm), .Cells(r9, skNm)).Value
cod_sk = .Range(.Cells(5, skCod), .Cells(r9, skCod)).Value
End With
End Sub
Private Sub hyjt_ukllre()
On Error Resume Next
With Sheets("C|fffd||fffd||fffd||fffd|")
For j = LBound(nm) To UBound(nm)
If nm(j, 1) <> "" Then
For i = LBound(nm_sk) To UBound(nm_sk)
If nm(j, 1) = nm_sk(i, 1) And cod(j, 1) = cod_sk(i, 1) Then
.Cells(i + 4, skOst) = .Cells(i + 4, skOst) - CDbl(col(j, 1))
.Cells(i + 4, skDs) = .Cells(i + 4, skDs) - CDbl(col(j, 1))
If Sheets("setting").Range("i5") <> 1 Then
If .Cells(i + 4, skDs) < 0 Then .Cells(i + 4, skDs) = 0
If .Cells(i + 4, skOst) < 0 Then .Cells(i + 4, skOst) = 0
End If
End If
Next i
End If
Next j
End With
If Sheets("setting").Range("i2") = 1 Then Call color_Cr
Erase nm
Erase cod
Erase col
Erase nm_sk
Erase cod_sk
End Sub
Private Sub logoOt()
On Error Resume Next
With Sheets("logR")
n = .Cells(Rows.Count, "c").End(xlUp).Row + 1
If n > 80 Then Exit Sub
.Cells(n, 1) = marker
.Cells(n, otLgNom) = nomer
.Cells(n, otLgDt1) = CDate(datt)
.Cells(n, otLgDt2) = CDate(datt2)
.Cells(n, otLgZkz) = zkzz
.Cells(n, otLgMnj) = mnjj
.Cells(n, otLgSum) = summ
.Cells(n, otLgTm) = format(Now, "hh:mm")
.Cells(n, otLgNom).NumberFormat = "00000"
.Cells(n, otLgSum).NumberFormat = "#,##0.00"
.Cells(n, otLgDt1).NumberFormat = "dd.mm.yyyy"
.Cells(n, otLgDt2).NumberFormat = "dd.mm.yyyy"
End With
End Sub
Private Sub msg_Formsp()
msg_text = Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!"
End Sub
Private Sub zvClearsp()
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .UsedRange.Rows.Count + .UsedRange.Row - 1
.Range("a14:a" & r + 44).EntireRow.Delete
.Cells(rwZvSum, zvSum) = ""
.Cells(rwZvSum, zvSkid) = ""
.Cells(rwZvSum, zvDost) = ""
.Range("a1").Value = .Range("a1").Value + 1
.Range("d2").Value = .Range("a1").Value
End With
End Sub
Attribute VB_Name = "qq00"
Dim r As Long
Dim i As Long
Dim cm As Integer
Public Sub color_No()
With ThisWorkbook.Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
.Range(.Cells(5, skDs), .Cells(r, skBr)).Interior.Color = xlNone
End With
End Sub
Public Sub color_Cr()
Call color_No
With ThisWorkbook.Sheets("setting")
If Form_Cr.OptionButton1.Value = True Then cm = skDs
If Form_Cr.OptionButton2.Value = True Then cm = skOst
End With
With ThisWorkbook.Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
gr = .Range(.Cells(5, skGr), .Cells(r, skGr)).Value
nm = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
ost = .Range(.Cells(5, cm), .Cells(r, cm)).Value
cr = .Range(.Cells(5, skCr), .Cells(r, skCr)).Value
End With
With ThisWorkbook.Sheets("C|fffd||fffd||fffd||fffd|")
For i = LBound(nm) To UBound(nm)
If nm(i, 1) <> "" Then
If gr(i, 1) = "" Then
If ost(i, 1) <= cr(i, 1) Then
.Cells(i + 4, cm).Interior.Color = RGB(230, 185, 184)
End If
End If
End If
Next i
End With
Erase nm
Erase ost
Erase cr
End Sub
Public Sub show_Form_Cr()
Form_Cr.Show
End Sub

Public Sub exit_arh()
On Error Resume Next
Dim shNm As String
shNm = ActiveSheet.Name
Sheets(shNm).Visible = 2
Sheets("C|fffd||fffd||fffd||fffd|").Select
End Sub
Attribute VB_Name = "qq000"
Dim hh As Double
Public Sub show_mn_vid()
On Error Resume Next
With ActiveSheet.Shapes("mn_vid")
.Height = 0
.Visible = True
.Top = ActiveSheet.Shapes("cmb_vd").Top + ActiveSheet.Shapes("cmb_vd").Height + 4
.Left = ActiveSheet.Shapes("cmb_vd").Left
End With
Call show_mn_vid_
End Sub
Private Sub show_mn_vid_()
On Error Resume Next
With ActiveSheet.Shapes("mn_vid")
.Visible = True
'For hh = 0 To 140 Step 70
.Height = 140 'hh
DoEvents
'Next hh
End With
End Sub
Public Sub unload_mn_vid()
On Error Resume Next
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Shapes("mn_vid")
.Height = 0
.Top = 0
.Visible = False
DoEvents
End With
End Sub
Public Sub show_mn_vid_pr()
On Error Resume Next
With ActiveSheet.Shapes("mn_vid_pr")
.Height = 0
.Visible = True
.Top = ActiveSheet.Shapes("cmb_vd").Top + ActiveSheet.Shapes("cmb_vd").Height + 4
.Left = ActiveSheet.Shapes("cmb_vd").Left
End With
Call show_mn_vid_pr_
End Sub
Private Sub show_mn_vid_pr_()
On Error Resume Next
With ActiveSheet.Shapes("mn_vid_pr")
'h = 112
.Visible = True
'For hh = 0 To h Step h / 4
'PauseTime = 0.01
'Start = Timer
'Do While Timer < Start + PauseTime
.Height = 112 ' hh
DoEvents
'Loop
'Next hh
End With
End Sub
Public Sub unload_mn_vid_pr()
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Shapes("mn_vid_pr")
'h = .Height
'For hh = h To 0 Step -h / 2
'PauseTime = 0.01
'Start = Timer
'Do While Timer < Start + PauseTime
.Height = 0 'hh
'Loop
'Next hh
.Top = 0
.Visible = False
DoEvents
End With
End Sub

Attribute VB_Name = "qq0001"
Dim gr()
Dim nm()
Dim cod()
Dim cnZ()
Dim cnR()
Dim ost()
Dim ed()
Dim |fffd||fffd||fffd||fffd|_|fffd||fffd|()
Dim evro As Double
Dim r As Long
Dim i As Long
Public Sub do_praise()
On Error Resume Next
Waite.Show
DoEvents
Application.DisplayAlerts = False
ScreenOff
Call arr_sk
Call header
Call resize_
Call format
Unload frm_Praise
Application.DisplayAlerts = True
ScreenOn
Unload Waite
End Sub
Private Sub arr_sk()
On Error Resume Next
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row + 4
gr = .Range(.Cells(5, skGr), .Cells(r, skGr)).Value
nm = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
ed = .Range(.Cells(5, skEd), .Cells(r, skEd)).Value
cod = .Range(.Cells(5, skCod), .Cells(r, skCod)).Value
ost = .Range(.Cells(5, skDs), .Cells(r, skBr)).Value
cnZ = .Range(.Cells(5, skCenaZ), .Cells(r, skCenaZ)).Value
cnR = .Range(.Cells(5, skCenaR), .Cells(r, skCenaR)).Value
End With
End Sub
Private Sub header()
On Error Resume Next
Application.Workbooks.Add
With ThisWorkbook.Sheets("setting")
Range("b4") = .Range("f13")
Range("c4") = .Range("f14")
Range("d4") = .Range("f15")
Range("e4") = .Range("f16")
Range("f4") = .Range("f17")
End With
Range("b4").ColumnWidth = 44
Range("c4").ColumnWidth = 12
Range("d4").ColumnWidth = 12
Range("e4").ColumnWidth = 12
Range("f4").ColumnWidth = 14
Range("f4").RowHeight = 27
Range(Cells(4, "b"), Cells(4, "f")).Font.Bold = True
Range(Cells(4, "b"), Cells(4, "f")).Font.Size = 12
Range(Cells(4, "b"), Cells(4, "f")).VerticalAlignment = xlCenter
Range(Cells(4, "b"), Cells(4, "f")).HorizontalAlignment = xlLeft
Range(Cells(4, "b"), Cells(4, "f")).Font.Color = RGB(149, 55, 53)
End Sub
Private Sub resize_()
On Error Resume Next
Cells(5, "a").Resize(UBound(gr), 1) = gr
Cells(5, "b").Resize(UBound(nm), 1) = nm
Cells(5, "c").Resize(UBound(cod), 1) = cod
Cells(5, "d").Resize(UBound(ed), 1) = ed
Cells(5, "e").Resize(UBound(ost), 1) = ost
If ThisWorkbook.Sheets("setting").Range("e26") = 1 Then
Cells(5, "f").Resize(UBound(cnZ), 1) = cnZ
Else
Cells(5, "f").Resize(UBound(cnR), 1) = cnR
End If
End Sub
Private Sub format()
On Error Resume Next
Range("b2") = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| " & Date
r = Cells(Rows.Count, "b").End(xlUp).Row
Range(Cells(5, "c"), Cells(r, "f")).HorizontalAlignment = xlLeft
For i = 5 To r
If Cells(i, "a") <> "" Then
Cells(i, "b").Font.Bold = True
End If
Next
Range(Cells(1, "b"), Cells(r, "f")).Font.Name = "Times New Roman"
Range(Cells(5, "a"), Cells(r, "a")) = ""
Dim fmt As String
If ThisWorkbook.Sheets("setting").Range("e22") = 1 Then
fmt = "#,##0"
Else
fmt = "#,##0.00"
End If
Dim |fffd||fffd||fffd||fffd||fffd| As String
|fffd||fffd||fffd||fffd||fffd| = ThisWorkbook.Sheets("setting").Range("e35")
If ThisWorkbook.Sheets("setting").Range("e24") = 1 Then
Range(Cells(5, "f"), Cells(r, "f")).NumberFormat = "[$|fffd|-2] " & fmt
For i = 5 To r
If Cells(i, "f") <> "" Then
Cells(i, "f") = Cells(i, "f") & " " & |fffd||fffd||fffd||fffd||fffd|
End If
Next
Else
Range(Cells(5, "f"), Cells(r, "f")).NumberFormat = fmt & "$"
End If
Call columns_
Call zebra
ActiveWindow.DisplayGridlines = False
End Sub
Private Sub columns_()
On Error Resume Next
With ThisWorkbook.Sheets("setting")
If .Range("e17") = 0 Then Cells(5, "f").EntireColumn.Delete
If .Range("e16") = 0 Then Cells(5, "e").EntireColumn.Delete
If .Range("e15") = 0 Then Cells(5, "d").EntireColumn.Delete
If .Range("e14") = 0 Then Cells(5, "c").EntireColumn.Delete
End With
End Sub
Private Sub zebra()
On Error Resume Next
Dim r As Long
Dim i As Long
Cells(1, "a").EntireColumn.Insert
Range("a4").ColumnWidth = 4
Range("b4").ColumnWidth = 2
r = Cells(Rows.Count, "c").End(xlUp).Row + 1
For i = 4 To r Step 2
Range(Cells(i, "b"), Cells(i, "g")).Interior.Color = 14540253
Next
End Sub

Attribute VB_Name = "qq0003"
Public Sub showForm()
On Error Resume Next
Unload UserForm1
With UserForm1
.Show
For i = Application.Height To Application.Height - .Height Step -4
PauseTime = 0.01
Start = Timer
Do While Timer < Start + PauseTime
.Top = i
DoEvents
Loop
Next
End With
Call pause2
Call unloadFormMsg
End Sub
Public Sub unloadFormMsg()
On Error Resume Next
With UserForm1
.Top = Application.Height - .Height
For i = .Top To Application.Height + 22 Step 4
PauseTime = 0.01
Start = Timer
Do While Timer < Start + PauseTime
.Top = i
DoEvents
Loop
Next
End With
Unload UserForm1
End Sub
Private Sub pause2()
On Error Resume Next
Dim xx
For xx = 1 To 7
PauseTime = 0.4
Start = Timer
Do While Timer < Start + PauseTime
DoEvents
Loop
Next xx
End Sub

Public Sub pause()
On Error Resume Next
Dim xx As Double
For xx = 1 To 3
PauseTime = 0.4
Start = Timer
Do While Timer < Start + PauseTime
DoEvents
Loop
Next xx
End Sub


Attribute VB_Name = "qq02"
Dim col As Integer
Dim r As Long
Dim rw As Long
Dim n As Long
Dim nNk As Long
Dim row1 As Long
Dim row2 As Long
Dim actPr As String
Sub prnt_zv()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
ScreenOff
Application.DisplayAlerts = False
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
r = Cells(Rows.Count, zvNm).End(xlUp).Row
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
nomer = .Range("d2").Value
datt = .Range("d8").Value
summ = .Cells(rwZvSum, zvSum).Value
skidka_ = .Cells(rwZvSum, zvSkid)
dostavka_ = .Cells(rwZvSum, zvDost)
summA = .Cells(rwZvSum, zvSumA)
End With
With ThisWorkbook.Worksheets("setting")
col = .Range("b9").Value
actPr = .Range("b10").Value
End With
With Sheets("prnZv")
.Visible = True
.Select
n = Cells(Rows.Count, zvNm).End(xlUp).Row
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)) = ""
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)).Font.Bold = False
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)).Borders.LineStyle = False
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Cells(4, "d") = .Cells(4, "d")
Cells(5, "d") = .Cells(5, "d")
Cells(6, "d") = .Cells(6, "d")
Cells(7, "d") = .Cells(7, "d")
Cells(8, "d") = .Cells(8, "d")
Cells(9, "d") = .Cells(9, "d")
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Range(.Cells(rwZv, zvNm), .Cells(r, zvSum)).Copy
Cells(rwZv, zvNm).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
End With
Application.CutCopyMode = False
nNk = Cells(Rows.Count, zvNm).End(xlUp).Row
Range(Cells(rwZv, zvNm), Cells(nNk, zvSum)).Borders.LineStyle = True
Range(Cells(rwZv, zvCenaR), Cells(nNk, zvCenaR)).NumberFormat = "#,##0.00"
Range(Cells(rwZv, zvSum), Cells(nNk, zvSum)).NumberFormat = "#,##0.00"
Range(Cells(rwZv, zvCod), Cells(nNk + 9, zvSum)).HorizontalAlignment = xlCenter

n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Cells(n, zvSum) = summ
Cells(n, zvSum).NumberFormat = "#,##0.00"
If ThisWorkbook.Sheets("setting").Range("b7") <> 1 Then GoTo 33
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If skidka_ = 0 Then Cells(n, zvSum) = "0": GoTo 33
Cells(n, zvSum) = "'" & skidka_ & "%"
33
If ThisWorkbook.Sheets("setting").Range("b8") <> 1 Then GoTo 34
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If dostavka_ = 0 Then Cells(n, zvSum) = "0": GoTo 34
Cells(n, zvSum) = dostavka_
Cells(n, zvSum).NumberFormat = "#,##0.00"
34
If ThisWorkbook.Sheets("setting").Range("b7") <> 1 And ThisWorkbook.Sheets("setting").Range("b8") <> 1 Then GoTo 35
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd|"
Cells(n, zvSum) = summA
Cells(n, zvSum).NumberFormat = "#,##0.00"
35
Range(Cells(nNk + 1, zvNm), Cells(n, zvSum)).Font.Bold = True
Range(Cells(rwZv, zvNm), Cells(n, zvSum)).Font.Name = "Times New Roman"
Range(Cells(rwZv, zvNm), Cells(n, zvSum)).Font.Size = 11
Range("c2") = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & format(nomer, "00000") & "  |fffd||fffd|  " & datt
With ThisWorkbook.Sheets("setting")
If .Range("i22") = 1 Then
Range("d5").EntireRow.Hidden = False
Else
Range("d5").EntireRow.Hidden = True
End If
If .Range("i23") = 1 Then
Range("d6").EntireRow.Hidden = False
Else
Range("d6").EntireRow.Hidden = True
End If
End With
With ActiveSheet
r = .Cells(Rows.Count, zvNm).End(xlUp).Row
With .PageSetup
.PrintArea = "c1:h" & r
.CenterHorizontally = True
End With
.PrintOut Copies:=col, ActivePrinter:=actPr
End With
Sheets("prnZv").Visible = 2
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
ScreenOn
Application.DisplayAlerts = True
Unload Waite
End Sub
Sub prnt_pr()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
ScreenOff
Application.DisplayAlerts = False
Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
r = Cells(Rows.Count, prNm).End(xlUp).Row
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
nomer = .Range("d2").Value
datt = .Range("d7").Value
summ = .Cells(10, prSum).Value
End With
With ThisWorkbook.Worksheets("setting")
col = .Range("b9").Value
actPr = .Range("b10").Value
End With
With Sheets("prnPr")
.Visible = True
.Select
n = Cells(Rows.Count, prNm).End(xlUp).Row
Range(Cells(11, prNm), Cells(n + 44, prSum)) = ""
Range(Cells(11, prNm), Cells(n + 44, prSum)).Font.Bold = False
Range(Cells(11, prNm), Cells(n + 44, prSum)).Borders.LineStyle = False
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Cells(4, "d") = .Cells(4, "d")
Cells(5, "d") = .Cells(5, "d")
Cells(6, "d") = .Cells(6, "d")
Cells(7, "d") = .Cells(7, "d")
Cells(8, "d") = .Cells(8, "d")
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Range(.Cells(11, prNm), .Cells(r, prSum)).Copy
Cells(11, prNm).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
End With
Application.CutCopyMode = False
nNk = Cells(Rows.Count, prNm).End(xlUp).Row
Range(Cells(11, prNm), Cells(nNk, prSum)).Borders.LineStyle = True
Range(Cells(11, prCenaZ), Cells(nNk, prCenaZ)).NumberFormat = "#,##0.00"
Range(Cells(11, prSum), Cells(nNk, prSum)).NumberFormat = "#,##0.00"
Range(Cells(11, prCod), Cells(nNk + 9, prSum)).HorizontalAlignment = xlCenter
n = Cells(Rows.Count, prNm).End(xlUp).Row + 1
Cells(n, prNm) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Cells(n, prSum) = summ
Cells(n, prSum).NumberFormat = "#,##0.00"
Range(Cells(n, prNm), Cells(n, prSum)).Font.Bold = True
Range(Cells(11, prNm), Cells(n, prSum)).Font.Name = "Times New Roman"
Range(Cells(11, prNm), Cells(n, prSum)).Font.Size = 11
Range("c2") = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & format(nomer, "00000") & "  |fffd||fffd|  " & datt
With ActiveSheet
r = .Cells(Rows.Count, prNm).End(xlUp).Row
With .PageSetup
.PrintArea = "c1:i" & r
.CenterHorizontally = True
End With
.PrintOut Copies:=col, ActivePrinter:=actPr
End With
Sheets("prnPr").Visible = 2
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
ScreenOn
Application.DisplayAlerts = True
Unload Waite
End Sub
Sub prnt_zk()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
ScreenOff
Application.DisplayAlerts = False
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
Call diap
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
nomer = .Cells(row1 - 1, zkNomer)
zkzz = .Cells(row1 - 1, zkNm)
mnjj = .Cells(row1 - 1, zkCol)
datt = CDate(.Cells(row1 - 1, zkDt1))
datt2 = CDate(.Cells(row1 - 1, zkDt1))
summ = .Cells(row1 - 1, zkSum).Value
skidka_ = .Cells(row1 - 1, zkSkid)
dostavka_ = .Cells(row1 - 1, zkDost)
summA = .Cells(row1 - 1, zkSumA)
adr = .Cells(row1 - 1, zkAdr)
tlf = .Cells(row1 - 1, zkTlf)
End With
With ThisWorkbook.Worksheets("setting")
col = .Range("b9").Value
actPr = .Range("b10").Value
End With
With Sheets("prnZv")
.Visible = True
.Select
n = Cells(Rows.Count, zvNm).End(xlUp).Row
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)) = ""
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)).Font.Bold = False
Range(Cells(rwZv, zvNm), Cells(n + 44, zvSum)).Borders.LineStyle = False
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Cells(4, "d") = zkzz
Cells(5, "d") = adr
Cells(6, "d") = tlf
Cells(7, "d") = mnjj
Cells(8, "d") = datt
Cells(9, "d") = datt2
End With
With ThisWorkbook.Worksheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Range(.Cells(row1, zkNm), .Cells(row2, zkNm)).Copy
Cells(rwZv, zvNm).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
.Range(.Cells(row1, zkCod), .Cells(row2, zkCod)).Copy
Cells(rwZv, zvCod).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
.Range(.Cells(row1, zkEd), .Cells(row2, zkSum)).Copy
Cells(rwZv, zvEd).PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
End With
Application.CutCopyMode = False
nNk = Cells(Rows.Count, zvNm).End(xlUp).Row
Range(Cells(rwZv, zvNm), Cells(nNk, zvSum)).Borders.LineStyle = True
Range(Cells(rwZv, zvCenaR), Cells(nNk, zvCenaR)).NumberFormat = "#,##0.00"
Range(Cells(rwZv, zvSum), Cells(nNk, zvSum)).NumberFormat = "#,##0.00"
Range(Cells(rwZv, zvCod), Cells(nNk + 9, zvSum)).HorizontalAlignment = xlCenter
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Cells(n, zvSum) = summ
If ThisWorkbook.Sheets("setting").Range("b7") <> 1 Then GoTo 33
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd||fffd|"
If skidka_ = 0 Then Cells(n, zvSum) = "0": GoTo 33
Cells(n, zvSum) = "'" & skidka_ & "%"
33
If ThisWorkbook.Sheets("setting").Range("b8") <> 1 Then GoTo 34
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
If dostavka_ = 0 Then Cells(n, zvSum) = "0": GoTo 34
Cells(n, zvSum) = dostavka_
Cells(n, zvSum).NumberFormat = "#,##0.00"
34
If ThisWorkbook.Sheets("setting").Range("b7") <> 1 And ThisWorkbook.Sheets("setting").Range("b8") <> 1 Then GoTo 35
n = Cells(Rows.Count, zvNm).End(xlUp).Row + 1
Cells(n, zvNm) = "|fffd||fffd||fffd||fffd||fffd|"
Cells(n, zvSum) = summA
Cells(n, zvSum).NumberFormat = "#,##0.00"
35
Range(Cells(nNk + 1, zvNm), Cells(n, zvSum)).Font.Bold = True
Range(Cells(rwZv, zvNm), Cells(n, zvSum)).Font.Name = "Times New Roman"
Range(Cells(rwZv, zvNm), Cells(n, zvSum)).Font.Size = 11
Range("c2") = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & format(nomer, "00000") & "  |fffd||fffd|  " & datt
With ThisWorkbook.Sheets("setting")
If .Range("i22") = 1 Then
Range("d5").EntireRow.Hidden = False
Else
Range("d5").EntireRow.Hidden = True
End If
If .Range("i23") = 1 Then
Range("d6").EntireRow.Hidden = False
Else
Range("d6").EntireRow.Hidden = True
End If
End With
With ActiveSheet
r = .Cells(Rows.Count, zvNm).End(xlUp).Row
With .PageSetup
.PrintArea = "c1:h" & r
.CenterHorizontally = True
End With
.PrintOut Copies:=col, ActivePrinter:=actPr
End With
Sheets("prnZv").Visible = 2
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
ScreenOn
Application.DisplayAlerts = True
Unload Waite
End Sub
Private Sub diap()
On Error Resume Next
With Form_print
r = Val(.tb_row.Value)
End With
n = Cells(Rows.Count, zkNm).End(xlUp).Row
row1 = r + 1
row2 = Cells(r, 1).End(xlDown).Row - 1
If row2 > n Then row2 = n + 1
Unload Form_print
DoEvents
End Sub
Attribute VB_Name = "qq03"
Public Sub red_pr__()
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, prSum)).Select
Form_Enter_red.Show
End Sub
Public Sub del_poz_pr()
On Error Resume Next
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, 7)).Select
Call del_poz_pr_
Cells(r, 1).Select
End Sub
Public Sub del_poz_pr_()
On Error Resume Next
Dim i As Long
Dim r As Long
ActiveCell.EntireRow.Delete
r = Cells(Rows.Count, prNm).End(xlUp).Row
Cells(10, prSum) = 0
For i = 11 To r
If Cells(i, prNm) <> "" Then
Cells(10, prSum) = Cells(10, prSum) + Cells(i, prSum)
End If
Next
End Sub

Public Sub show_frm_Otch()
frm_Otch.Show
End Sub
Public Sub close_otch_r()
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("C|fffd||fffd||fffd||fffd|").Select
End Sub
Public Sub close_otch_pr()
Sheets("|fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd|").Visible = False
Sheets("C|fffd||fffd||fffd||fffd|").Select
End Sub
Attribute VB_Name = "qq04"
Public Const progrWid As Long = 324
Public msg_text As String
Public marker As String
Public nomer As String
Public zkzz As String
Public mnjj As String
Public datt As Date
Public datt2 As Date
Public summ As Double
Public summA As Double
Public skidka_ As Double
Public dostavka_ As Double
Public adr As String
Public tlf As String
Public osn As String
Public Const rwZv As Integer = 14
Public Const rwZvSum As Integer = 13
Public Const skGr As Integer = 2
Public Const skNm As Integer = 4
Public Const skCod As Integer = 3
Public Const skEd As Integer = 5
Public Const skDs As Integer = 6
Public Const skOst As Integer = 7
Public Const skBr As Integer = 8
Public Const skCr As Integer = 9
Public Const skCenaR As Integer = 10
Public Const skCenaZ As Integer = 11
Public Const skPstv As Integer = 12
Public Const skPrim As Integer = 13
Public Const zvNm As Integer = 3
Public Const zvCod As Integer = 4
Public Const zvEd As Integer = 5
Public Const zvCol As Integer = 6
Public Const zvCenaR As Integer = 7
Public Const zvSum As Integer = 8
Public Const zvDs As Integer = 10
Public Const zvDost As Integer = 12
Public Const zvSkid As Integer = 13
Public Const zvSumA As Integer = 14
Public Const zvAvanc As Integer = 16
Public Const zvOpl As Integer = 17
Public Const zvCenaZ As Integer = 19
Public Const zkNomer As Integer = 3
Public Const zkDt1 As Integer = 4
Public Const zkDt2 As Integer = 5
Public Const zkCod As Integer = 6
Public Const zkNm As Integer = 7
Public Const zkEd As Integer = 8
Public Const zkCol As Integer = 9
Public Const zkCenaR As Integer = 10
Public Const zkSum As Integer = 11
Public Const zkOst As Integer = 12
Public Const zkPrim As Integer = 13
Public Const zkDost As Integer = 15
Public Const zkSkid As Integer = 16
Public Const zkSumA As Integer = 17
Public Const zkAvanc As Integer = 19
Public Const zkOpl As Integer = 20
Public Const zkAdr As Integer = 22
Public Const zkTlf As Integer = 23
Public Const zkCenaZ As Integer = 33
Public Const prNm As Integer = 3
Public Const prCod As Integer = 4
Public Const prEd As Integer = 5
Public Const prCol As Integer = 6
Public Const prCenaZ As Integer = 7
Public Const prCenaR As Integer = 8
Public Const prSum As Integer = 9
Public Const prGr As Integer = 11
Public Const AprNm As Integer = 4
Public Const AprCod As Integer = 5
Public Const AprEd As Integer = 6
Public Const AprCol As Integer = 7
Public Const AprCena As Integer = 8
Public Const AprSum As Integer = 9
Public Const AprSumA As Integer = 10
Public Const AprNom As Integer = 11
Public Const AprDt As Integer = 12
Public Const AprPst As Integer = 13
Public Const AprMnj As Integer = 14
Public Const AprOsn As Integer = 15
Public Const AzkCod As Integer = 3
Public Const AzkNm As Integer = 4
Public Const AzkEd As Integer = 5
Public Const AzkCol As Integer = 6
Public Const AzkCena As Integer = 7
Public Const AzkSum As Integer = 8
Public Const AzkSumA As Integer = 9
Public Const AzkNom As Integer = 10
Public Const AzkDt1 As Integer = 11
Public Const AzkDt2 As Integer = 12
Public Const AzkZkz As Integer = 13
Public Const AzkMnj As Integer = 14
Public Const AzkDost As Integer = 15
Public Const AzkSkid As Integer = 16
Public Const AzkSumSk As Integer = 17
Public Const AzkAdr As Integer = 18
Public Const AzkTlf As Integer = 19
Public Const AzkCenaZ As Integer = 22
Public Const otLgNom As Integer = 2
Public Const otLgDt1 As Integer = 3
Public Const otLgDt2 As Integer = 4
Public Const otLgZkz As Integer = 5
Public Const otLgMnj As Integer = 6
Public Const otLgSum As Integer = 7
Public Const otLgTm As Integer = 8
Public Const prLgNom As Integer = 2
Public Const prLgDt As Integer = 3
Public Const prLgZkz As Integer = 4
Public Const prLgMnj As Integer = 5
Public Const prLgSum As Integer = 6
Public Const prLgTm As Integer = 7
Public Const bzZkz As Integer = 2
Public Const bzAdr As Integer = 3
Public Const bzTlf As Integer = 4
Public Const bzMail As Integer = 5
Public Const bzMj As Integer = 7
Public Const bzPst As Integer = 9
Public Const bzTlfPs As Integer = 10
Public Const bzMailPs As Integer = 11
Attribute VB_Name = "qq05"
Public dt_1 As Date
Public Sub ShowForm4()
On Error Resume Next
Unload Form_SelectDate
dt_1 = FormatDateTime(Now)
Form_SelectDate.Show
End Sub
Public Sub ShowForm_Sort()
On Error Resume Next
dt_1 = FormatDateTime(Now)
Form_Sort.Show
End Sub
Public Sub zv_pedactirov_()
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, 12)).Select
If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Cells(r, zkNomer) & ": " & Chr(34) & Cells(r, zkNm) & Chr(34) & "?", vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Call msg_demo
End Sub
Public Sub delete_zv()
On Error Resume Next
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, 12)).Select
If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| " & Cells(r, zkNomer) & ": " & Chr(34) & Cells(r, zkNm) & Chr(34) & "?", vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Call zvDelete
End Sub
Public Sub to_otgr_1()
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, 12)).Select
If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| " & Cells(r, zkNomer) & ": " & Chr(34) & Cells(r, zkNm) & Chr(34) & "?", vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Call msg_demo
End Sub
Public Sub del_poz_zv()
On Error Resume Next
Dim r As Long
r = ActiveCell.Row
Range(Cells(r, 3), Cells(r, 7)).Select
Call del_poz_zv_
Cells(r, 1).Select
End Sub
Public Sub del_poz_zv_()
On Error Resume Next
Dim i As Long
Dim r As Long
ActiveCell.EntireRow.Delete
r = Cells(Rows.Count, zvNm).End(xlUp).Row
Cells(13, zvSum) = 0
For i = 14 To r
If Cells(i, zvNm) <> "" Then
Cells(13, zvSum) = Cells(13, zvSum) + Cells(i, zvSum)
End If
Next
End Sub



Attribute VB_Name = "qq07"
Dim r1 As Long
Dim r2 As Long
Dim nm
Dim ost
Dim cod
Dim nm_
Dim col_
Dim cod_
Public Sub zvDelete()
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
Call otDiap
Call delOstSk
Call delZk
If Sheets("setting").Range("i2") = 1 Then Call color_Cr
Cells(r1, 1).Select
ThisWorkbook.Save
ScreenOn
Application.DisplayAlerts = True
Unload Waite
MsgBox ("      |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!              "), 64, ""
End Sub
Private Sub delZk()
On Error Resume Next
Range(Cells(r1 - 1, 1), Cells(r2, 1)).EntireRow.Delete
End Sub
Private Sub otDiap()
Dim r As Long
Dim n As Long
r = ActiveCell.Row
n = Cells(Rows.Count, zkNm).End(xlUp).Row
r1 = r + 1
r2 = Cells(r, 1).End(xlDown).Row - 1
If r2 > n Then r2 = n + 1
End Sub
Private Sub delOstSk()
On Error Resume Next
Dim r As Long
Dim i As Long
Dim n As Long
nm_ = Range(Cells(r1, zkNm), Cells(r2, zkNm)).Value
col_ = Range(Cells(r1, zkCol), Cells(r2, zkCol)).Value
cod_ = Range(Cells(r1, zkCod), Cells(r2, zkCod)).Value
With Sheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
nm = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
ost = .Range(.Cells(5, skDs), .Cells(r, skBr)).Value
cod = .Range(.Cells(5, skCod), .Cells(r, skCod)).Value
End With
With Sheets("C|fffd||fffd||fffd||fffd|")
For n = LBound(nm_) To UBound(nm_)
For i = LBound(nm) To UBound(nm)
If nm_(n, 1) <> "" Then
If nm(i, 1) = nm_(n, 1) And cod(i, 1) = cod_(n, 1) Then
.Cells(i + 4, skBr) = .Cells(i + 4, skBr) - CDbl(col_(n, 1))
If .Cells(i + 4, skBr) = 0 Then .Cells(i + 4, skBr) = ""
.Cells(i + 4, skDs) = .Cells(i + 4, skOst) - .Cells(i + 4, skBr)
If Sheets("setting").Range("i5") <> 1 Then
If .Cells(i + 4, skDs) < 0 Then .Cells(i + 4, skDs) = 0
End If
End If
End If
Next i
Next n
End With
Erase nm
Erase ost
Erase cod
Erase nm_
Erase col_
Erase cod_
End Sub

Attribute VB_Name = "qq08"
Function GetRate(ByVal CurrencyName As String, ByVal RateDate As Date) As Double
On Error Resume Next
CurrencyName = UCase(CurrencyName): If Len(CurrencyName) <> 3 Then Exit Function
Set xmldoc = CreateObject("Msxml.DOMDocument"): xmldoc.async = False
url_request = "http://www.cbr.ru/scripts/XML_daily.asp?date_req=" + format(RateDate, "dd\/mm\/yyyy")
If xmldoc.load(url_request) <> True Then Exit Function
Set nodeList = xmldoc.SelectNodes("ValCurs"): Set xmlNode = nodeList.Item(0).CloneNode(True)
Set node_attr = xmlNode.Attributes(0): strDate = node_attr.Value
Set nodeList = xmldoc.SelectNodes("*/Valute")
For i = 0 To nodeList.Length - 1
Set xmlNode = nodeList.Item(i).CloneNode(True)
If xmlNode.ChildNodes(1).Text = CurrencyName Then
CurrencyRate = CDbl(xmlNode.ChildNodes(4).Text)
divisor = Val(xmlNode.ChildNodes(2).Text)
GetRate = CurrencyRate / divisor
Exit Function
End If
Next
End Function

Attribute VB_Name = "qw45"
Const parol_sheet = "gh123"
Public Sub z_yes()
On Error Resume Next
Call z_no
With Worksheets("C|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, skNm).End(xlUp).Row
.UsedRange.Cells.Locked = False
.Range(.Cells(5, skDs), .Cells(r, skBr)).Locked = True
.Protect Password:=parol_sheet, _
DrawingObjects:=False, Contents:=True, Scenarios:= _
False, AllowFormattingCells:=True, AllowFormattingColumns:=True, _
AllowFormattingRows:=True, AllowInsertingColumns:=True, AllowInsertingRows _
:=True, AllowInsertingHyperlinks:=True, AllowDeletingColumns:=True, _
AllowDeletingRows:=True, AllowSorting:=True, AllowFiltering:=True, _
AllowUsingPivotTables:=True, UserInterfaceOnly:=True
End With
End Sub
Public Sub z_no()
On Error Resume Next
With Sheets("C|fffd||fffd||fffd||fffd|")
.Unprotect Password:=parol_sheet
End With
End Sub

Attribute VB_Name = "qwq321"
Dim r As Long
Dim i As Long
Public Sub prDo()
On Error Resume Next
Call unload_mn_vid_pr
DoEvents
Unload PraisePr
DoEvents
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, prNm).End(xlUp).Row
If r < 11 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
For i = 11 To r
If .Cells(i, prCol) = "" Then
.Cells(i, prCol).Select
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, ""
Exit Sub
End If
Next
End With
If MsgBox("     |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?               " & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(4, 4) & Chr(10) & _
"   |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(7, 4), vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Call msg_demo
End Sub
Attribute VB_Name = "vvodPr"
Attribute VB_Base = "0{043C6DB7-EB93-4B80-981D-B0F067A40013}{07DE2962-310D-42D8-84D7-7070144C2F89}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Private Sub ico_Click()
Call showForm
End Sub
Private Sub showForm()
On Error Resume Next
Dim i As Long
With add_psv
.Show
.TextBox1.Text = tb_Pst.Text
For i = 0 To Me.Height Step Me.Height / 10
PauseTime = 0.01
Start = Timer
Do While Timer < Start + PauseTime
.Height = i
DoEvents
Loop
Next
.Height = Me.Height
End With
Call pause
Call unloadFormMsg
End Sub
Private Sub OK_Click()
On Error Resume Next
Dim str1 As String
Dim n As Integer
Dim j As Integer
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
str1 = tb_Pst.Text
Range("d4") = ""
For n = 1 To Len(str1)
Range("d4") = String(Len(str1) - n, " ") & Left(str1, n)
For j = 1 To 55: DoEvents: Next
Next
str1 = tb_Mnj.Text
Range("d5") = ""
For n = 1 To Len(str1)
Range("d5") = String(Len(str1) - n, " ") & Left(str1, n)
For j = 1 To 55: DoEvents: Next
Next
str1 = tb_Dt.Text
Range("d7") = ""
For n = 1 To Len(str1)
Range("d7") = String(Len(str1) - n, " ") & Left(str1, n)
For j = 1 To 55: DoEvents: Next
Next
str1 = tb_Osn.Text
Range("d8") = ""
For n = 1 To Len(str1)
Range("d8") = String(Len(str1) - n, " ") & Left(str1, n)
For j = 1 To 55: DoEvents: Next
Next
Unload Me
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
Me.StartUpPosition = 0
With ActiveSheet.Shapes("cmb_d")
Me.Top = .Top + .Height + 20
Me.Left = .Left
End With
Dim r As Long
Dim i As Long
With comb_Mnj
.Left = tb_Mnj.Left
.Top = tb_Mnj.Top
.Width = tb_Mnj.Width + 13
.ZOrder 1
End With
With comb_Pst
.Left = tb_Pst.Left
.Top = tb_Pst.Top
.Width = tb_Pst.Width + 13
.ZOrder 1
End With
With comb_osn
.Left = tb_Osn.Left
.Top = tb_Osn.Top
.Width = tb_Osn.Width + 13
.AddItem "|fffd||fffd||fffd||fffd| |fffd| "
.AddItem "|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "
.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| "
.ZOrder 1
End With
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzPst).End(xlUp).Row
For i = 2 To r
If .Cells(i, bzPst) <> "" Then comb_Pst.AddItem .Cells(i, bzPst)
Next
End With
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzMj).End(xlUp).Row
For i = 2 To r
If .Cells(i, bzMj) <> "" Then comb_Mnj.AddItem .Cells(i, bzMj)
Next
End With
tb_Pst.Text = Range("d4")
tb_Mnj.Text = Range("d5")
tb_Dt.Text = Range("d7")
tb_Osn.Text = Range("d8")
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
tb_Dt.Text = Date
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.BackColor = &H80000005
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.BackColor = &H8000000F
End Sub
Private Sub comb_Mnj_Change()
tb_Mnj.Text = comb_Mnj.Value
End Sub
Private Sub comb_Pst_Change()
tb_Pst.Text = comb_Pst.Value
End Sub
Private Sub comb_osn_Change()
tb_Osn.Text = comb_osn.Value
End Sub
Private Sub UserForm_Click()
On Error Resume Next
Unload add_psv
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub UserForm_Terminate()
On Error Resume Next
Unload add_psv
End Sub
Private Sub tb_Mnj_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
comb_Mnj.DropDown
End Sub
Private Sub tb_Dt_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
Call ShowForm4
End Sub
Private Sub tb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Change()
End Sub
Private Sub tb_Pst_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
comb_Pst.DropDown
End Sub
Private Sub tb_osn_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
comb_osn.DropDown
End Sub
Attribute VB_Name = "vvodZv"
Attribute VB_Base = "0{C00A82D0-51FB-44F0-B911-15696F69E226}{B2EF071A-56F3-4EAF-802F-D941848D1CF2}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Const top1 = 106
Dim r As Long
Dim i As Long
Dim j As Long
Private Sub CheckBox1_Click()
On Error Resume Next
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
With Sheets("setting")
If CheckBox1.Value = True Then
.Range("i22") = 1
Else
.Range("i22") = 0
End If
End With
If CheckBox1.Value = False And CheckBox2.Value = False Then
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = True
Me.Frame_cmb.Top = mAdr.Top
End If
If CheckBox1.Value = True And CheckBox2.Value = False Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = True
End If
If CheckBox1.Value = True And CheckBox2.Value = True Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = top1
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = False
End If
If CheckBox1.Value = False And CheckBox2.Value = True Then
lb_Adr.Visible = False
tb_Tlf.Top = mAdr.Top
lb_Tlf.Top = mAdr.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = False
End If
With Frame_cmb
Me.Height = .Top + .Height + 25
End With
End Sub
Private Sub CheckBox2_Click()
On Error Resume Next
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
With Sheets("setting")
If CheckBox2.Value = True Then
.Range("i23") = 1
Else
.Range("i23") = 0
End If
End With
If CheckBox1.Value = False And CheckBox2.Value = False Then
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = True
Me.Frame_cmb.Top = mAdr.Top
End If
If CheckBox1.Value = True And CheckBox2.Value = False Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = True
End If
If CheckBox1.Value = True And CheckBox2.Value = True Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = top1
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = False
End If
If CheckBox1.Value = False And CheckBox2.Value = True Then
lb_Adr.Visible = False
tb_Tlf.Top = mAdr.Top
lb_Tlf.Top = mAdr.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = False
End If
With Frame_cmb
Me.Height = .Top + .Height + 25
End With
End Sub
Private Sub comb_Zkz_Change()
On Error Resume Next
i = comb_Zkz.ListIndex
If i = -1 Then Exit Sub
With comb_Zkz
tb_Zkz.Text = .List(i, 0)
tb_Adr.Text = .List(i, 1)
tb_Tlf.Text = .List(i, 2)
End With
End Sub
Private Sub comb_Mnj_Change()
On Error Resume Next
tb_Mnj.Text = comb_Mnj.Value
End Sub
Private Sub ico_Click()
Call showForm
End Sub
Private Sub showForm()
On Error Resume Next
With add_zkz
.Show
.TextBox1.Text = tb_Zkz.Text
For i = 0 To Me.Height Step Me.Height / 10
PauseTime = 0.01
Start = Timer
Do While Timer < Start + PauseTime
.Height = i
DoEvents
Loop
Next
.Height = 160
End With
Call pause
Call unloadFormMsg
End Sub
Private Sub ico2_Click()
With Frame1
If .Visible = False Then
.Visible = True
.Left = 336
.Top = 54
Else
.Visible = False
End If
End With
End Sub
Private Sub NO_Click()
Unload Me
End Sub
Private Sub OK_Click()
On Error Resume Next
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
Range("d4") = Me.tb_Zkz.Text
Range("d5") = Me.tb_Adr.Text
Range("d6") = Me.tb_Tlf.Text
Range("d7") = Me.tb_Mnj.Text
Range("d8") = Me.tb_Dt1.Text
Range("d9") = Me.tb_Dt2.Text
Unload Me
End Sub
Private Sub UserForm_Initialize()
ScreenOff
On Error Resume Next
Me.StartUpPosition = 0
With ActiveSheet.Shapes("cmb_d")
Me.Top = .Top + .Height + 20
Me.Left = .Left
End With
Call load
With ActiveSheet
Me.tb_Zkz.Text = .Range("d4")
Me.tb_Adr.Text = .Range("d5")
Me.tb_Tlf.Text = .Range("d6")
Me.tb_Mnj.Text = .Range("d7")
Me.tb_Dt1.Text = .Range("d8")
Me.tb_Dt2.Text = .Range("d9")
End With
With comb_Zkz
.Left = tb_Zkz.Left
.Top = tb_Zkz.Top
.Width = tb_Zkz.Width + 13
.ZOrder 1
End With
With comb_Mnj
.Left = tb_Mnj.Left
.Top = tb_Mnj.Top
.Width = tb_Mnj.Width + 13
.ZOrder 1
End With
With Sheets("setting")
If .Range("i22") = 1 Then Me.CheckBox1.Value = True
If .Range("i23") = 1 Then Me.CheckBox2.Value = True
End With
If CheckBox1.Value = False And CheckBox2.Value = False Then
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = True
Me.Frame_cmb.Top = mAdr.Top
End If
If CheckBox1.Value = True And CheckBox2.Value = False Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = True
End If
If CheckBox1.Value = True And CheckBox2.Value = True Then
lb_Adr.Visible = True
tb_Tlf.Top = mTlf.Top
lb_Tlf.Top = mTlf.Top
Me.Frame_cmb.Top = top1
Range("b5").EntireRow.Hidden = False
Range("b6").EntireRow.Hidden = False
End If
If CheckBox1.Value = False And CheckBox2.Value = True Then
lb_Adr.Visible = False
tb_Tlf.Top = mAdr.Top
lb_Tlf.Top = mAdr.Top
Me.Frame_cmb.Top = mTlf.Top
Range("b5").EntireRow.Hidden = True
Range("b6").EntireRow.Hidden = False
End If
With Frame_cmb
Me.Height = .Top + .Height + 25
End With
OK.BackColor = RGB(58, 110, 165)
OK.ForeColor = RGB(255, 255, 255)
NO.ForeColor = RGB(255, 255, 255)
ScreenOn
End Sub
Private Sub load()
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzMj).End(xlUp).Row
For i = 2 To r
If .Cells(i, bzMj) <> "" Then comb_Mnj.AddItem .Cells(i, bzMj)
Next
End With
With Sheets("|fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, bzZkz).End(xlUp).Row
j = 0
For i = 2 To r
If .Cells(i, bzZkz) <> "" Then
comb_Zkz.AddItem ""
comb_Zkz.List(j, 0) = .Cells(i, bzZkz)
comb_Zkz.List(j, 1) = .Cells(i, bzAdr)
comb_Zkz.List(j, 2) = .Cells(i, bzTlf)
j = j + 1
End If
Next
End With
comb_Zkz.ColumnWidths = "200;0;0"
End Sub
Private Sub UserForm_Terminate()
tb_Zkz.Text = ""
tb_Mnj.Text = ""
tb_Dt1.Text = ""
tb_Dt2.Text = ""
End Sub
Private Sub tb_Mnj_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
comb_Mnj.DropDown
End Sub
Private Sub tb_Zkz_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
comb_Zkz.DropDown
End Sub
Private Sub tb_Dt1_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
ctr = 1
Call ShowForm4
End Sub
Private Sub tb_Dt2_MouseUp(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
On Error Resume Next
ctr = 2
Call ShowForm4
End Sub
Private Sub UserForm_Click()
On Error Resume Next
Frame1.Visible = False
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.BackColor = &H80000005
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.BackColor = &H8000000F
End Sub

Attribute VB_Name = "wqe3"
Dim iCol As Integer
Dim r As Long
Dim i As Long
Dim n As Long
Dim r1 As Long
Public Sub svZv()
On Error Resume Next
Call unload_mn_vid
DoEvents
Unload Praise
DoEvents
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, zvNm).End(xlUp).Row
If r < rwZv Then
MsgBox "          |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!" & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|", 64, ""
Exit Sub
End If
End With
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
For i = rwZv To r
If .Cells(i, zvCol) = "" Then
.Cells(i, zvCol).Select
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
Next
End With
If MsgBox("     |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?               " & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"   |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(4, zvCod) & Chr(10) & _
"   |fffd||fffd||fffd||fffd|: " & Cells(8, zvCod), vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
DoEvents
Call vb_call______ww6777
End Sub
Private Sub msg_Formsv()
msg_text = Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!"
End Sub
Private Sub vb_call______ww6777()
On Error Resume Next
Waite.Show
Waite.Label1.Caption = "|fffd||fffd||fffd||fffd||fffd|." & Chr(10) & "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|..."
Waite.Repaint
ScreenOff
Application.DisplayAlerts = False
Call msg_Formsv
Call copytb
Call ostat
Call zv_frmt
Call clear_zv
ThisWorkbook.Save
ScreenOn
Application.DisplayAlerts = True
Unload Waite
DoEvents
showForm
End Sub
Private Sub copytb()
On Error Resume Next
Dim whZv As Worksheet
Dim whZk As Worksheet
Set whZv = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Set whZk = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
n = .Cells(Rows.Count, zvNm).End(xlUp).Row
iCol = .Range(.Cells(rwZvSum, zvNm), .Cells(n, zvNm)).Cells.Count - 1
End With
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
For i = 1 To iCol + 2
.Range("a5").EntireRow.Insert
Next
r = 5
.Cells(r, 1) = "c" & Now
.Cells(r, zkNomer) = whZv.Range("d2").Value
.Cells(r, zkNomer).NumberFormat = "00000"
.Cells(r, zkNm) = whZv.Range("d4").Value
.Cells(r, zkCol) = whZv.Range("d7").Value
.Cells(r, zkPrim).Font.Color = RGB(255, 255, 255)
.Cells(r, zkSum) = whZv.Cells(rwZvSum, zvSum).Value
.Cells(r, zkSum).NumberFormat = whZv.Cells(rwZv, zvSum).NumberFormat
.Cells(r, zkDt1) = whZv.Range("d10").Value
.Cells(r, zkAdr) = whZv.Range("d5").Value
.Cells(r, zkTlf) = whZv.Range("d6").Value
End With
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Range(.Cells(rwZv, zvNm), .Cells(n, zvNm)).Copy
whZk.Cells(6, zkNm).PasteSpecial Paste:=xlPasteValuesAndNumberFormats, Operation:=xlNone, SkipBlanks:=False, Transpose:=False
.Range(.Cells(rwZv, zvCol), .Cells(n, zvCol)).Copy (whZk.Cells(6, zkCol))
.Range(.Cells(rwZv, zvEd), .Cells(n, zvEd)).Copy (whZk.Cells(6, zkEd))
.Range(.Cells(rwZv, zvCenaR), .Cells(n, zvCenaR)).Copy (whZk.Cells(6, zkCenaR))
.Range(.Cells(rwZv, zvCenaZ), .Cells(n, zvCenaZ)).Copy (whZk.Cells(6, zkCenaZ))
.Range(.Cells(rwZv, zvSum), .Cells(n, zvSum)).Copy (whZk.Cells(6, zkSum))
.Range(.Cells(rwZv, zvCod), .Cells(n, zvCod)).Copy (whZk.Cells(6, zkCod))
End With
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Cells(5, zkDost) = whZv.Cells(rwZvSum, zvDost).Value: If .Cells(5, zkDost) = "" Then .Cells(5, zkDost) = 0
.Cells(5, zkSkid) = whZv.Cells(rwZvSum, zvSkid).Value: If .Cells(5, zkSkid) = "" Then .Cells(5, zkSkid) = 0
.Cells(5, zkSumA) = whZv.Cells(rwZvSum, zvSumA).Value
.Cells(5, zkAvanc) = whZv.Cells(rwZvSum, zvAvanc).Value
.Cells(5, zkOpl) = whZv.Cells(rwZvSum, zvOpl).Value
End With
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
.Range(.Cells(6, zkDt1), .Cells(6 + iCol - 1, zkDt1)) = whZv.Cells(8, zvCod).Value
.Range(.Cells(6, zkDt2), .Cells(6 + iCol - 1, zkDt2)) = whZv.Cells(9, zvCod).Value
End With
With whZk
.Range(.Cells(5, zkNomer), .Cells(5, zkPrim)).Interior.Color = RGB(79, 129, 189)
.Range(.Cells(5, zkNomer), .Cells(5, zkPrim)).Font.Color = RGB(255, 255, 255)
.Range(.Cells(5, zkNomer), .Cells(5, zkPrim)).Font.Italic = True
.Range(.Cells(5, zkNomer), .Cells(5, zkPrim)).Font.Bold = True
.Range(.Cells(6, zkDt1), .Cells(5 + iCol, zkPrim)).Interior.Color = RGB(234, 241, 221)
.Range(.Cells(5, zkDt1), .Cells(5, zkSumA)).Interior.Color = RGB(79, 129, 189)
.Range(.Cells(5, zkDt1), .Cells(5, zkSumA)).Font.Color = RGB(255, 255, 255)
.Range(.Cells(5, zkDt1), .Cells(5, zkSumA)).Font.Italic = True
.Range(.Cells(5, zkDt1), .Cells(5, zkSumA)).Font.Bold = True
With .Range(.Cells(5, zkAvanc), .Cells(5, zkOpl))
.Interior.Color = RGB(79, 129, 189)
.Font.Color = RGB(255, 255, 255)
.Font.Italic = True
.Font.Bold = True
.HorizontalAlignment = xlCenter
End With
.Cells(5, zkPrim + 1).Clear
End With
End Sub
Private Sub zv_frmt()
On Error Resume Next
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
n = .Cells(Rows.Count, zvNm).End(xlUp).Row
iCol = Range(.Cells(rwZvSum, zvNm), .Cells(n, zvNm)).Cells.Count - 1
End With
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
Range(Cells(5, zkNomer), Cells(5 + iCol, zkSumA)).Borders(xlInsideVertical).LineStyle = xlNone
Range(Cells(5, zkNm), Cells(5 + iCol, zkNm)).ClearComments
For i = 4 To 5 + iCol
With Range(Cells(i, zkNomer), Cells(i, zkSumA)).Borders(xlEdgeBottom)
.Color = RGB(255, 255, 255)
.LineStyle = xlContinuous
End With
Next
Cells(5, zkNomer).HorizontalAlignment = xlCenter
Range(Cells(5, zkCol), Cells(r + iCol, zkSum)).HorizontalAlignment = xlCenter
Range(Cells(5, zkDt1), Cells(5, zkDt2)).HorizontalAlignment = xlCenter
Range(Cells(5, zkOst), Cells(5 + iCol, zkOst)).HorizontalAlignment = xlCenter
Range(Cells(5, zkDost), Cells(5, zkSumA)).HorizontalAlignment = xlCenter
Range(Cells(5, zkNomer), Cells(5, zkPrim)).Font.Size = 10
Cells(5, zkPrim).HorizontalAlignment = xlRight
Range(Cells(5, zkNomer), Cells(5 + iCol, zkSumA)).Borders(xlInsideVertical).LineStyle = xlNone
Cells(5, zkPrim) = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
ActiveWindow.ScrollRow = 1
Range(Cells(5, zkNomer), Cells(5 + iCol, 33)).Font.Name = "Times New Roman"
Range(Cells(6, zkNomer), Cells(5 + iCol, 33)).Font.Size = 11
Range("a1").Select
End Sub
Private Sub ostat()
On Error Resume Next
Dim whZv As Worksheet
Dim whSk As Worksheet
Dim a()
Dim k()
Dim ac()
Dim ak()
Dim ad()
Set whZv = ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Set whSk = ThisWorkbook.Sheets("C|fffd||fffd||fffd||fffd|")
With whSk
r = .UsedRange.Rows.Count + .UsedRange.Row - 1
a = .Range(.Cells(5, skNm), .Cells(r, skNm)).Value
k = .Range(.Cells(5, skCod), .Cells(r, skCod)).Value
End With
With whZv
r1 = .UsedRange.Rows.Count + .UsedRange.Row
ac = .Range(.Cells(rwZv, zvNm), .Cells(r1, zvNm)).Value
ak = .Range(.Cells(rwZv, zvCol), .Cells(r1, zvCol)).Value
ad = .Range(.Cells(rwZv, zvCod), .Cells(r1, zvCod)).Value
End With
With whSk
For n = LBound(ac) To UBound(ac)
For i = LBound(a) To UBound(a)
If ac(n, 1) <> "" Then
If ac(n, 1) = a(i, 1) Then
If ad(n, 1) = k(i, 1) Then
.Cells(i + 4, skBr) = .Cells(i + 4, skBr).Value + CDbl(ak(n, 1))
.Cells(i + 4, skDs) = .Cells(i + 4, skOst).Value - CDbl(.Cells(i + 4, skBr))
If Sheets("setting").Range("i5") <> 1 Then
If .Cells(i + 4, skDs) < 0 Then .Cells(i + 4, skDs) = 0
End If
End If
End If
End If
Next i
Next n
End With
End Sub
Private Sub clear_zv()
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .UsedRange.Rows.Count + .UsedRange.Row - 1
.Range("a14:a" & r + 44).EntireRow.Delete
.Cells(rwZvSum, zvSum) = ""
.Cells(rwZvSum, zvSkid) = ""
.Cells(rwZvSum, zvDost) = ""
.Cells(rwZvSum, zvAvanc) = ""
If Sheets("setting").Range("d2") = "" Then
.Range("a1").Value = .Range("a1").Value + 1
End If
.Range("d2").Value = .Range("a1").Value
Sheets("setting").Range("d2") = ""
End With
End Sub

Attribute VB_Name = "ww1"
Option Explicit
Public Sub show_Form_find_sk()
On Error Resume Next
Form_find_sk.Show
End Sub
Public Sub show_findALL()
On Error Resume Next
findALL.Show
End Sub
Sub ScreenOff()
With Application
.ScreenUpdating = False
.EnableEvents = False
End With
End Sub
Sub ScreenOn()
With Application
.ScreenUpdating = True
.EnableEvents = True
End With
End Sub
Public Sub polnekr()
On Error Resume Next
ScreenOff
Dim sh As Worksheet
For Each sh In ThisWorkbook.Sheets
If sh.Name <> "setting" Then
If sh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
If sh.Name <> "|fffd||fffd||fffd||fffd|" Then
If sh.Name <> "vvv" Then
sh.Activate
Application.DisplayFormulaBar = False
ActiveWindow.DisplayHeadings = False
Application.DisplayFullScreen = True
End If
End If
End If
End If
Next
ScreenOn
End Sub
Public Sub verekr()
On Error Resume Next
ScreenOff
Dim sh As Worksheet
For Each sh In ThisWorkbook.Sheets
If sh.Name <> "setting" Then
If sh.Name <> "|fffd||fffd||fffd||fffd||fffd|" Then
If sh.Name <> "|fffd||fffd||fffd||fffd|" Then
If sh.Name <> "vvv" Then
sh.Activate
Application.DisplayFullScreen = False
Application.DisplayFormulaBar = True
ActiveWindow.DisplayHeadings = True
End If
End If
End If
End If
Next
ScreenOn
End Sub
Public Sub ekr()
On Error Resume Next
If Application.DisplayFullScreen = False Then
Call polnekr
Else
Call verekr
End If
Sheets("C|fffd||fffd||fffd||fffd|").Select
End Sub
Public Sub exit_K()
Sheets("|fffd||fffd||fffd||fffd|").Visible = False
End Sub
Sub print_zv()
On Error Resume Next
Call unload_mn_vid
DoEvents
Dim r As Long
r = Cells(Rows.Count, zvNm).End(xlUp).Row
If r < rwZv Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
Form_print.Show
Form_print.TextBox1.Text = 1
End Sub
Sub printPr()
On Error Resume Next
Call unload_mn_vid_pr
DoEvents
Dim r As Long
r = Cells(Rows.Count, prNm).End(xlUp).Row
If r < 11 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd||fffd||fffd|"
Exit Sub
End If
Form_print.Show
Form_print.TextBox1.Text = 4
End Sub
Public Sub show_frmHelp()
frmHelp.Show
End Sub
Public Sub show_Form_Enter()
Form_Enter.Show
End Sub
Public Sub show_zvSelect()
Call unload_mn_vid
DoEvents
zvSelect.Show
End Sub
Public Sub show_zvSelectPr()
Call unload_mn_vid_pr
DoEvents
Call msg_demo
End Sub
Attribute VB_Name = "ww4"
Public Sub clearpr3()
On Error Resume Next
Call unload_mn_vid_pr
DoEvents
If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|?", vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
Dim r As Long
r = .UsedRange.Rows.Count + .UsedRange.Row - 1
.Range("a11:a" & r + 44).EntireRow.Delete
.Cells(10, prSum) = ""
End With
End Sub
Public Sub show_DOP()
On Error Resume Next
DOP.Show
End Sub
Public Sub show_Form_find_zk()
findALL.Show
End Sub
Public Sub Show_form_Print()
On Error Resume Next
Form_print.Show
Form_print.TextBox1.Text = 5
Form_print.tb_row.Value = ActiveCell.Row
End Sub
Public Sub clearzv3()
On Error Resume Next
Call unload_mn_vid
DoEvents
If MsgBox("|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|?       ", vbOKCancel + vbQuestion, "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|") = vbCancel Then Exit Sub
Dim r As Long
With Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|")
r = .UsedRange.Rows.Count + .UsedRange.Row - 1
.Range("a14:a" & r + 44).EntireRow.Delete
.Cells(rwZvSum, zvSum) = ""
.Cells(rwZvSum, zvSkid) = ""
.Cells(rwZvSum, zvDost) = ""
.Cells(rwZvSum, zvAvanc) = ""
Sheets("setting").Range("d2") = ""
End With
End Sub
Public Sub show_FormRedaktirov()
On Error Resume Next
FormRedaktirov.Show
End Sub
Public Sub Show_Praise()
On Error Resume Next
Call unload_mn_vid
DoEvents
Praise.Show
End Sub
Public Sub Show_PraisePr()
On Error Resume Next
Call unload_mn_vid_pr
DoEvents
PraisePr.Show
End Sub
Public Sub zv_Select_()
Sheets("|fffd||fffd||fffd||fffd||fffd||fffd|").Select
End Sub
Public Sub Show_vvodZv()
On Error Resume Next
Call unload_mn_vid
Unload vvodZv
DoEvents
vvodZv.Show
End Sub
Public Sub Show_vvodPr()
On Error Resume Next
Call unload_mn_vid_pr
DoEvents
Unload vvodPr
DoEvents
vvodPr.Show
End Sub
Sub vb_call______ww2()
Call svZv
End Sub






Attribute VB_Name = "ww7"
Public Sub sh_text_remove()
On Error Resume Next
ActiveSheet.Shapes("sh_text").Cut
End Sub
Public Sub show_Form__()
Form_.Show
End Sub

Sub msg_demo()
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!", 64, "|fffd||fffd||fffd||fffd|-|fffd||fffd||fffd||fffd||fffd||fffd|"
End Sub
Attribute VB_Name = "zvSelect"
Attribute VB_Base = "0{D378A05F-BEB1-437D-AA8C-8BC0387215CD}{A67CAE1E-35BE-4FF6-A1B9-37421962D992}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False
Dim r As Long
Dim i As Long
Dim n As Long
Dim j As Long
Dim r7 As Long
Dim col As Long
Dim dt1 As Date
Dim nm()
Dim mj()
Dim dt()
Dim zk()
Dim c()
Dim mk()
Dim nom()
Dim sm()
Dim a()
Dim nmSk As String
Private Sub Comb_dt_Change()
Call select_date
End Sub
Private Sub Comb_Z_Change()
Call select_client
End Sub
Private Sub Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_Change()
Call select_mj
End Sub
Private Sub select_date()
On Error Resume Next
ListBox1.Clear
If Me.Comb_dt.Value = "|fffd||fffd||fffd|" Then
ListBox1.List = c
Exit Sub
End If
ReDim b(LBound(c) To UBound(c), 1 To 6)
If Me.Comb_dt.Value = "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd|" Then
dt1 = Date - 30
n = 1
For i = LBound(c) To UBound(c)
If CDate(c(i, 4)) >= dt1 Then
b(n, 1) = c(i, 1)
b(n, 2) = c(i, 2)
b(n, 3) = c(i, 3)
b(n, 4) = c(i, 4)
b(n, 5) = c(i, 5)
b(n, 6) = c(i, 6)
n = n + 1
End If
Next
GoTo 77
End If
If Me.Comb_dt.Value = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|" Then
nmSk = format(Date, "dd.mm.yyyy")
Else
If Me.Comb_dt.Value = "|fffd||fffd||fffd||fffd||fffd|" Then
nmSk = format(Date - 1, "dd.mm.yyyy")
End If
End If
n = 1
For i = LBound(c) To UBound(c)
If c(i, 4) = nmSk Then
b(n, 1) = c(i, 1)
b(n, 2) = c(i, 2)
b(n, 3) = c(i, 3)
b(n, 4) = c(i, 4)
b(n, 5) = c(i, 5)
b(n, 6) = c(i, 6)
n = n + 1
End If
Next
77
ReDim bb(1 To n, 1 To 6)
j = 1
For i = LBound(b) To UBound(b)
If b(i, 4) <> "" Then
bb(j, 1) = b(i, 1)
bb(j, 2) = b(i, 2)
bb(j, 3) = b(i, 3)
bb(j, 4) = b(i, 4)
bb(j, 5) = b(i, 5)
bb(j, 6) = b(i, 6)
j = j + 1
End If
Next
ListBox1.List = bb
End Sub
Private Sub select_mj()
On Error Resume Next
ListBox1.Clear
If Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value = "|fffd||fffd||fffd|" Then
ListBox1.List = c
Exit Sub
End If
nmSk = Me.Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.Value
ReDim b(LBound(c) To UBound(c), 1 To 6)
n = 1
For i = LBound(c) To UBound(c)
If c(i, 5) = nmSk Then
b(n, 1) = c(i, 1)
b(n, 2) = c(i, 2)
b(n, 3) = c(i, 3)
b(n, 4) = c(i, 4)
b(n, 5) = c(i, 5)
b(n, 6) = c(i, 6)
n = n + 1
End If
Next
ListBox1.List = b
End Sub
Private Sub select_client()
On Error Resume Next
ListBox1.Clear
If Me.Comb_Z.Value = "|fffd||fffd||fffd|" Then
ListBox1.List = c
Exit Sub
End If
nmSk = Me.Comb_Z.Value
ReDim b(LBound(c) To UBound(c), 1 To 6)
n = 1
For i = LBound(c) To UBound(c)
If c(i, 3) = nmSk Then
b(n, 1) = c(i, 1)
b(n, 2) = c(i, 2)
b(n, 3) = c(i, 3)
b(n, 4) = c(i, 4)
b(n, 5) = c(i, 5)
b(n, 6) = c(i, 6)
n = n + 1
End If
Next
ListBox1.List = b
End Sub
Private Sub ico_Click()
Unload Me
End Sub
Private Sub Label6_Click()
Unload Me
End Sub
Private Sub ListBox1_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
If ListBox1.ListIndex = -1 Then
MsgBox "|fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|", 64, ""
Exit Sub
End If
Call msg_demo
End Sub
Private Sub UserForm_Initialize()
On Error Resume Next
ScreenOff
Application.DisplayAlerts = False
Me.StartUpPosition = 0
With ActiveSheet.Shapes("cmb_d")
Me.Top = .Top + .Height + 20
Me.Left = .Left
End With
Call load
ListBox1.ColumnWidths = "0;44;130;70;94"
With Comb_dt
.Left = Label2.Left
.Top = Label2.Top
.Width = Label2.Width + 13
.ZOrder 1
.AddItem "|fffd||fffd||fffd|"
.AddItem "|fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.AddItem "|fffd||fffd||fffd||fffd||fffd|"
.AddItem "|fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
.ListIndex = 3
End With
With Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|
.Left = Label5.Left
.Top = Label5.Top
.Width = Label5.Width + 13
.ZOrder 1
End With
With Comb_Z
.Left = Label1.Left
.Top = Label1.Top
.Width = Label1.Width + 13
.ZOrder 1
End With
Call RemoveDuplicates
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, "c").End(xlUp).Row
Comb_Z.AddItem "|fffd||fffd||fffd|"
For i = 1 To r
If .Cells(i, "c") <> "" Then
Comb_Z.AddItem .Cells(i, "c")
End If
Next
Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.AddItem "|fffd||fffd||fffd|"
For i = 1 To r
If .Cells(i, "e") <> "" Then
Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.AddItem .Cells(i, "e")
End If
Next
End With
ScreenOn
Application.DisplayAlerts = True
If col = 0 Then
ListBox1.Clear
MsgBox "|fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|!" & Chr(10) & _
"---------------------------------------------------" & Chr(10) & _
"|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| (|fffd||fffd||fffd||fffd||fffd||fffd||fffd|) |fffd||fffd|", 64, ""
Exit Sub
End If
DoEvents
End Sub
Private Sub load()
On Error Resume Next
With Sheets("logR")
r7 = .Cells(Rows.Count, otLgNom).End(xlUp).Row + 2
mk = .Range(.Cells(2, 1), .Cells(r7, 1)).Value
nom = .Range(.Cells(2, otLgNom), .Cells(r7, otLgNom)).Value
zk = .Range(.Cells(2, otLgZkz), .Cells(r7, otLgZkz)).Value
dt = .Range(.Cells(2, otLgDt2), .Cells(r7, otLgDt2)).Value
mj = .Range(.Cells(2, otLgMnj), .Cells(r7, otLgMnj)).Value
sm = .Range(.Cells(2, otLgSum), .Cells(r7, otLgSum)).Value
col = Application.CountIf(.Range(.Cells(2, 1), .Cells(r7, 1)), "<>")
If col = 0 Then Exit Sub
End With
ReDim c(1 To col + 1, 1 To 6)
n = 1
For i = LBound(mk) To UBound(mk)
If mk(i, 1) <> "" Then
c(n, 1) = mk(i, 1)
c(n, 2) = format(nom(i, 1), "00000")
c(n, 3) = zk(i, 1)
c(n, 4) = format(dt(i, 1), "dd.mm.yyyy")
c(n, 5) = mj(i, 1)
c(n, 6) = format(sm(i, 1), "0.00")
n = n + 1
End If
Next
End Sub
Private Sub RemoveDuplicates()
On Error Resume Next
Call clearBuf
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
.Cells(1, "a").Resize(UBound(c), 5) = c
r = .Cells(Rows.Count, "a").End(xlUp).Row
.Range("c1:c" & r).RemoveDuplicates Columns:=1, header:=xlNo
.Range("e1:e" & r).RemoveDuplicates Columns:=1, header:=xlNo
End With
Call sortZk
Call sortMj
End Sub
Private Sub sortZk()
On Error Resume Next
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, "c").End(xlUp).Row
.Sort.SortFields.Clear
.Sort.SortFields.Add Key:=.Range("c1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
With .Sort
.SetRange Range("c1:c" & r)
.header = xlNo
.MatchCase = False
.Orientation = xlTopToBottom
.SortMethod = xlPinYin
.Apply
End With
End With
End Sub
Private Sub sortMj()
On Error Resume Next
With Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, "e").End(xlUp).Row
.Sort.SortFields.Clear
.Sort.SortFields.Add Key:=.Range("e1"), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
With .Sort
.SetRange Range("e1:e" & r)
.header = xlNo
.MatchCase = False
.Orientation = xlTopToBottom
.SortMethod = xlPinYin
.Apply
End With
End With
End Sub
Private Sub clearBuf()
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, "a").End(xlUp).Row
.Range("a1:h" & r + 44).Clear
End With
End Sub
Private Sub Label5_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|.DropDown
End Sub
Private Sub Label1_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_Z.DropDown
End Sub
Private Sub Label2_MouseDown(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Comb_dt.DropDown
End Sub
Private Sub ico_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 20
ico.Width = 20
End Sub
Private Sub ListBox1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 16
ico.Width = 16
End Sub
Private Sub Label6_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 16
ico.Width = 16
End Sub
Private Sub UserForm_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
ico.Height = 16
ico.Width = 16
End Sub
Private Sub UserForm_Terminate()
Call clearBuf
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
On Error Resume Next
Unload DOP
Unload DOP_otch
Unload DOP_arh
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "|fffd||fffd||fffd||fffd|12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim r As Long
Dim i As Long
Private Sub Worksheet_Activate()
On Error Resume Next
Range("d8") = Date
Range("d9") = Date
Range("a1").Select
End Sub
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
On Error Resume Next
If Target.Count > 1 Then Exit Sub
If Target.Row < rwZv Then Exit Sub
r = Cells(Rows.Count, zvNm).End(xlUp).Row
i = Target.Row
If Not Intersect(Target, Range(Cells(rwZv, zvNm), Cells(r, zvSum))) Is Nothing Then
Cancel = True
Call Add_MyContextMenu_zv
Application.CommandBars("MyContextMenu_zv").ShowPopup
End If
End Sub
Private Sub Add_MyContextMenu_zv()
On Error Resume Next
With Application.CommandBars.Add(Name:="MyContextMenu_zv", Position:=msoBarPopup, Temporary:=True)
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 21
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "del_poz_zv"
End With
End With
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
On Error Resume Next
Dim rw As Integer
If Target.Count > 1 Then Exit Sub
If Target.Row < rwZv Then Exit Sub
r = Cells(Rows.Count, zvNm).End(xlUp).Row
rw = Target.Row
If Not Intersect(Target, Range(Cells(rwZv, zvCol), Cells(r, zvCol))) Is Nothing Then
Call |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(rw)
End If
End Sub
Private Function |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|_|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|(i As Integer)
On Error Resume Next
If Sheets("setting").Range("i4") = 1 Then
If Cells(i, zvCol) > Cells(i, zvDs) Then
Cells(i, zvCol) = Cells(i, zvDs)
Cells(i, zvCol).Select
MsgBox "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd|!" & Chr(10) & Chr(10) & _
"   |fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|: " & Cells(i, zvDs) & " |fffd||fffd|", 64, "|fffd||fffd||fffd||fffd||fffd|"
Exit Function
End If
End If
r = Cells(Rows.Count, zvNm).End(xlUp).Row
Cells(i, zvSum) = Cells(i, zvCol) * Cells(i, zvCenaR)
Cells(rwZvSum, zvSum) = Application.Sum(Range(Cells(rwZv, zvSum), Cells(r, zvSum)))
End Function
Private Sub Worksheet_Deactivate()
On Error Resume Next
Unload Praise
Call unload_mn_vid
DoEvents
End Sub
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
On Error Resume Next
If ActiveSheet.Shapes("mn_vid").Visible = True Then Call unload_mn_vid
End Sub

Attribute VB_Name = "|fffd||fffd||fffd||fffd|4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim r As Long
Dim i As Long
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
On Error Resume Next
If Target.Count > 1 Then Exit Sub
r = Cells(Rows.Count, zkNm).End(xlUp).Row
i = Target.Row
If Not Intersect(Target, Range(Cells(4, zkDt1 - 1), Cells(r, zkPrim))) Is Nothing Then
If Cells(i, "a") <> "" Then
Cancel = True
Add_MyContextMenu
Application.CommandBars("MyContextMenu").ShowPopup
End If
End If
End Sub
Private Sub Add_MyContextMenu()
On Error Resume Next
Application.CommandBars("MyContextMenu").Delete
With Application.CommandBars.Add(Name:="MyContextMenu", Position:=msoBarPopup, Temporary:=True)
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 162
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "zv_pedactirov_"
End With
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 4
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "Show_form_Print"
End With
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 3160
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "to_otgr_1"
End With
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 21
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd|"
.OnAction = "delete_zv"
End With
End With
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd|7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "|fffd||fffd||fffd||fffd|9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Dim r As Long
Dim i As Long
Private Sub Worksheet_Activate()
On Error Resume Next
Range("d7") = Date
End Sub
Private Sub Worksheet_BeforeDoubleClick(ByVal Target As Range, Cancel As Boolean)
On Error Resume Next
If Target.Count > 1 Then Exit Sub
If Target.Row < 11 Then Exit Sub
r = Cells(Rows.Count, prNm).End(xlUp).Row
i = Target.Row
If Not Intersect(Target, Range(Cells(11, prNm), Cells(r, prSum))) Is Nothing Then
Cancel = True
Call Add_MyContextMenu_pr
Application.CommandBars("Add_MyContextMenu_pr").ShowPopup
End If
End Sub
Private Sub Add_MyContextMenu_pr()
On Error Resume Next
Application.CommandBars("Add_MyContextMenu_pr").Delete
With Application.CommandBars.Add(Name:="Add_MyContextMenu_pr", Position:=msoBarPopup, Temporary:=True)
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 162
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "red_pr__"
End With
With .Controls.Add(Type:=msoControlButton)
.Style = msoButtonIconAndCaption
.FaceId = 21
.Caption = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd| |fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
.OnAction = "del_poz_pr"
End With
End With
End Sub
Private Sub Worksheet_Change(ByVal Target As Range)
On Error Resume Next
If Target.Count > 1 Then Exit Sub
If Target.Row < 11 Then Exit Sub
r = Cells(Rows.Count, prNm).End(xlUp).Row
rw = Target.Row
If Not Intersect(Target, Range(Cells(11, prCol), Cells(r, prCenaZ))) Is Nothing Then
Cells(rw, prSum) = Cells(rw, prCol) * Cells(rw, prCenaZ)
Range(Cells(rw, prCol), Cells(rw, prSum)).HorizontalAlignment = xlCenter
Range(Cells(rw, prCenaZ), Cells(rw, prSum)).NumberFormat = "#,##0.00"
End If
Cells(10, prSum) = Application.Sum(Range(Cells(11, prSum), Cells(r, prSum)))
Cells(10, prSum).NumberFormat = "#,##0.00"
End Sub
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
On Error Resume Next
If ActiveSheet.Shapes("mn_vid_pr").Visible = True Then Call unload_mn_vid_pr
End Sub
Private Sub Worksheet_Deactivate()
On Error Resume Next
Unload PraisePr
Call unload_mn_vid_pr
DoEvents
End Sub
Attribute VB_Name = "|fffd||fffd||fffd||fffd||fffd||fffd||fffd||fffd|"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_BeforeClose(Cancel As Boolean)
On Error Resume Next
Dim r As Long
With ThisWorkbook.Sheets("|fffd||fffd||fffd||fffd||fffd|")
r = .Cells(Rows.Count, "a").End(xlUp).Row
.Range("a1:h" & r + 44).Clear
End With
Call verekr
Application.DisplayAlerts = False
ThisWorkbook.Save
Application.DisplayAlerts = True
End Sub
Private Sub Workbook_Open()
On Error Resume Next
Call polnekr
Application.AutoRecover.Enabled = False
Sheets("C|fffd||fffd||fffd||fffd|").Select
Call sh_text_remove
ActiveWindow.DisplayHeadings = False
ActiveWindow.ScrollRow = 4
If Sheets("setting").Range("z3") = 1 Then prodavec.Show
End Sub


' InQuest injected base64 decoded content
' `'t*'
' `'t*'

INQUEST-PP=macro
