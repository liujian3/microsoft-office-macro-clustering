Attribute VB_Name = "CalendarFrm"
Attribute VB_Base = "0{9D52E180-377C-4D24-8128-EDE325CCDAA7}{CA2D061D-6C92-4FA8-87A1-BE5EC8D8B2B4}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = False




Option Explicit
    Dim ThisDay As Date
    Dim ThisYear, ThisMth As Date
    Dim CreateCal As Boolean
    Dim i As Integer


Private Sub Frame1_Click()

End Sub

Private Sub UserForm_Initialize()
    Application.EnableEvents = False
    'starts the form on todays date
    ThisDay = Date
    ThisMth = Format(ThisDay, "mm")
    ThisYear = Format(ThisDay, "yyyy")
    For i = 1 To 12
        CB_Mth.AddItem Format(DateSerial(Year(Date), Month(Date) + i, 0), "mmmm")
    Next
    CB_Mth.ListIndex = Format(Date, "mm") - Format(Date, "mm")
    For i = -20 To 50
        If i = 1 Then CB_Yr.AddItem Format((ThisDay), "yyyy") Else CB_Yr.AddItem _
            Format((DateAdd("yyyy", (i - 1), ThisDay)), "yyyy")
    Next
    CB_Yr.ListIndex = 21
    'Builds the calendar with todays date
    CalendarFrm.Width = CalendarFrm.Width
    CreateCal = True
    Call Build_Calendar
    Application.EnableEvents = True
End Sub
Private Sub CB_Mth_Change()
    'rebuilds the calendar when the month is changed by the user
    Build_Calendar
End Sub
Private Sub CB_Yr_Change()
    'rebuilds the calendar when the year is changed by the user
    Build_Calendar
End Sub
Private Sub Build_Calendar()
    'the routine that actually builds the calendar each time
    If CreateCal = True Then
    CalendarFrm.Caption = " " & CB_Mth.Value & " " & CB_Yr.Value
    'sets the focus for the todays date button
    CommandButton1.SetFocus
    For i = 1 To 42
        If i < Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value)) Then
            Controls("D" & (i)).Caption = Format(DateAdd("d", (i - Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), _
                ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "d")
            Controls("D" & (i)).ControlTipText = Format(DateAdd("d", (i - Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), _
                ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "m/d/yy")
        ElseIf i >= Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value)) Then
            Controls("D" & (i)).Caption = Format(DateAdd("d", (i - Weekday((CB_Mth.Value) _
                & "/1/" & (CB_Yr.Value))), ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "d")
            Controls("D" & (i)).ControlTipText = Format(DateAdd("d", (i - Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), _
                ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "m/d/yy")
        End If
        If Format(DateAdd("d", (i - Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), _
        ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "mmmm") = ((CB_Mth.Value)) Then
            If Controls("D" & (i)).BackColor <> &H80000016 Then Controls("D" & (i)).BackColor = &HC0FFC0          'H80000018  '&H80000010
            Controls("D" & (i)).Font.Bold = True
        If Format(DateAdd("d", (i - Weekday((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), _
            ((CB_Mth.Value) & "/1/" & (CB_Yr.Value))), "m/d/yy") = Format(ThisDay, "m/d/yy") Then Controls("D" & (i)).SetFocus
        Else
            If Controls("D" & (i)).BackColor <> &H80000016 Then Controls("D" & (i)).BackColor = &H8000000F
            Controls("D" & (i)).Font.Bold = False
        End If
    Next
    End If
End Sub
Private Sub D1_Click()
    'this sub and the ones following represent the buttons for days on the form
    'retrieves the current value of the individual controltiptext and
    'places it in the active cell
    ActiveCell.Value = D1.ControlTipText
    Unload Me
    'after unload you can call a different userform to continue data entry
    'uncomment this line and add a userform named UserForm2
    'Userform2.Show
    
End Sub
Private Sub D2_Click()
    ActiveCell.Value = D2.ControlTipText
    Unload Me
    
End Sub
Private Sub D3_Click()
    ActiveCell.Value = D3.ControlTipText
    Unload Me
    
End Sub
Private Sub D4_Click()
    ActiveCell.Value = D4.ControlTipText
    Unload Me
    
End Sub
Private Sub D5_Click()
    ActiveCell.Value = D5.ControlTipText
    Unload Me
    
End Sub
Private Sub D6_Click()
    ActiveCell.Value = D6.ControlTipText
    Unload Me
    
End Sub
Private Sub D7_Click()
    ActiveCell.Value = D7.ControlTipText
    Unload Me
    
End Sub
Private Sub D8_Click()
    ActiveCell.Value = D8.ControlTipText
    Unload Me
    
End Sub
Private Sub D9_Click()
    ActiveCell.Value = D9.ControlTipText
    Unload Me
    
End Sub
Private Sub D10_Click()
    ActiveCell.Value = D10.ControlTipText
    Unload Me
    
End Sub
Private Sub D11_Click()
    ActiveCell.Value = D11.ControlTipText
    Unload Me
    
End Sub
Private Sub D12_Click()
    ActiveCell.Value = D12.ControlTipText
    Unload Me
    
End Sub
Private Sub D13_Click()
    ActiveCell.Value = D13.ControlTipText
    Unload Me
    
End Sub
Private Sub D14_Click()
    ActiveCell.Value = D14.ControlTipText
    Unload Me
    
End Sub
Private Sub D15_Click()
    ActiveCell.Value = D15.ControlTipText
    Unload Me
    
End Sub
Private Sub D16_Click()
    ActiveCell.Value = D16.ControlTipText
    Unload Me
    
End Sub
Private Sub D17_Click()
    ActiveCell.Value = D17.ControlTipText
    Unload Me
    
End Sub
Private Sub D18_Click()
    ActiveCell.Value = D18.ControlTipText
    Unload Me
    
End Sub
Private Sub D19_Click()
    ActiveCell.Value = D19.ControlTipText
    Unload Me
    
End Sub
Private Sub D20_Click()
    ActiveCell.Value = D20.ControlTipText
    Unload Me
    
End Sub
Private Sub D21_Click()
    ActiveCell.Value = D21.ControlTipText
    Unload Me
    
End Sub
Private Sub D22_Click()
    ActiveCell.Value = D22.ControlTipText
    Unload Me
    
End Sub
Private Sub D23_Click()
    ActiveCell.Value = D23.ControlTipText
    Unload Me
    
End Sub
Private Sub D24_Click()
    ActiveCell.Value = D24.ControlTipText
    Unload Me
    
End Sub
Private Sub D25_Click()
    ActiveCell.Value = D25.ControlTipText
    Unload Me
    
End Sub
Private Sub D26_Click()
    ActiveCell.Value = D26.ControlTipText
    Unload Me
    
End Sub
Private Sub D27_Click()
    ActiveCell.Value = D27.ControlTipText
    Unload Me
    
End Sub
Private Sub D28_Click()
    ActiveCell.Value = D28.ControlTipText
    Unload Me
    
End Sub
Private Sub D29_Click()
    ActiveCell.Value = D29.ControlTipText
    Unload Me
    
End Sub
Private Sub D30_Click()
    ActiveCell.Value = D30.ControlTipText
    Unload Me
    
End Sub
Private Sub D31_Click()
    ActiveCell.Value = D31.ControlTipText
    Unload Me
    
End Sub
Private Sub D32_Click()
    ActiveCell.Value = D32.ControlTipText
    Unload Me
    
End Sub
Private Sub D33_Click()
    ActiveCell.Value = D33.ControlTipText
    Unload Me
    
End Sub
Private Sub D34_Click()
    ActiveCell.Value = D34.ControlTipText
    Unload Me
    
End Sub
Private Sub D35_Click()
    ActiveCell.Value = D35.ControlTipText
    Unload Me
    
End Sub
Private Sub D36_Click()
    ActiveCell.Value = D36.ControlTipText
    Unload Me
    
End Sub
Private Sub D37_Click()
    ActiveCell.Value = D37.ControlTipText
    Unload Me
    
End Sub
Private Sub D38_Click()
    ActiveCell.Value = D38.ControlTipText
    Unload Me
    
End Sub
Private Sub D39_Click()
    ActiveCell.Value = D39.ControlTipText
    Unload Me
    
End Sub
Private Sub D40_Click()
    ActiveCell.Value = D40.ControlTipText
    Unload Me
    
End Sub
Private Sub D41_Click()
    ActiveCell.Value = D41.ControlTipText
    Unload Me
    
End Sub
Private Sub D42_Click()
    ActiveCell.Value = D42.ControlTipText
    Unload Me
    
End Sub




Attribute VB_Name = "Module1"
Private Sub Addarecord()
ActiveWindow.DisplayWorkbookTabs = False

    Application.ScreenUpdating = False
    
    If Range("E4").Value = "" Then
    
    MsgBox ("The Name is Empty! Please Enter the name")
    Cells(4, "E").Select
    Exit Sub
    
     End If
    
    
    
    If Range("o5") = 0 Then
MsgBox ("The Last Name Empty!")
Exit Sub
End If
     
    If Range("o6") = 0 Then
MsgBox ("The Address is Empty!")
Exit Sub
End If
        
    If Range("o7") = 0 Then
MsgBox ("The City is Empty!")
Exit Sub
End If
    
    If Range("o8") = 0 Then
MsgBox ("The State and Zip Must be Filled!")
Exit Sub
End If
    
    If Range("o11") = 0 Then
MsgBox ("The Social Security Number is Emty!")
Exit Sub
End If

    If Range("z11") <> True Then
MsgBox ("Social Security Number Must be in 999-99-9999 Format!")
Exit Sub
End If


    
    If Range("o12") = 0 Then
MsgBox ("The Tax Claim Status Must be either ""M"" or ""S""!")
Exit Sub
End If
     
   If Range("o13") = 0 Then
MsgBox ("The Number or Dependents Must be in Value Format!")
Exit Sub
End If
    
    
   If Range("o17") = 0 Then
MsgBox ("The Payrate must be in Value!")
Exit Sub
End If
    
    If Range("z8") < 7.25 Then
MsgBox ("The Payrate must be greater than $7.25 per hour!")
Exit Sub
End If
    
    
    
     If Range("z8") > 4807.7 Then

MsgBox ("Too Large! The Maximum rate is $4807.69/Hour, Please reenter")

Exit Sub

End If

  
  

        If Range("o9") = True Then

MsgBox ("The Vacation adjustment must be a number in value! Please Re-enter")

Exit Sub

End If


        If Range("o18") = True Then

MsgBox ("Deduction Amount/Percent must be a number in value! Please Re-enter")

Exit Sub

End If


        If Range("o19") = True Then

MsgBox ("The deduction limit must be a number/amount in value! Please Re-enter")

Exit Sub

End If

       If Range("o20") = False Then

MsgBox ("The deduction amount/percent must be greater or equal to zero! Please Re-enter")

Exit Sub

End If


       If Range("o21") = False Then

MsgBox ("The deduction limit Cannot be Negative! Please Re-enter")

Exit Sub

End If
  
       If Range("o24") = True Then

MsgBox ("The Hiring Date is Empty! Please enter a hiring date")

Exit Sub

End If


       If Range("o23") = True Then

MsgBox ("The Hiring Date Must be in Value Format mm/dd/yy! Please Re-enter")

Exit Sub

End If


       If Range("o25") = True Then

MsgBox ("Hiring Date Error! Do not enter a future employee for more than 30 days, Please Re-enter")

Exit Sub

End If

 
    
    
    'Sheets("Setup").Range("b10") = Sheets("Setup").Range("b9").Value

'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
'  Application.OnKey "^{Break}", ""
'  Application.OnKey "^%{Del}", ""


      Sheets("Selection1").Visible = True
   ' Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value
     Sheets("Dbase1").Visible = True
         
     Sheets("Dbase1").Select

Sheets("Dbase1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

    
    
    
    Range("A1").Select
    Selection.End(xlDown).Select
    Selection.EntireRow.Insert
    ActiveCell.Offset(0, 0).Value = Sheets("Adding").Cells(3, "e")
    ActiveCell.Offset(0, 1).Value = Sheets("Adding").Cells(4, "Ae")
    ActiveCell.Offset(0, 2).Value = Sheets("Adding").Cells(5, "Ae")
    ActiveCell.Offset(0, 3).Value = Sheets("Adding").Cells(6, "e")
    ActiveCell.Offset(0, 4).Value = Sheets("Adding").Cells(7, "e")
    ActiveCell.Offset(0, 5).Value = Sheets("Adding").Cells(8, "e")
    ActiveCell.Offset(0, 6).Value = Sheets("Adding").Cells(9, "e")
    ActiveCell.Offset(0, 7).Value = Sheets("Adding").Cells(10, "e")
    ActiveCell.Offset(0, 8).Value = Sheets("Adding").Cells(11, "e")
    ActiveCell.Offset(0, 9).Value = Sheets("Adding").Cells(12, "e")
    ActiveCell.Offset(0, 10).Value = Sheets("Adding").Cells(13, "e")
    ActiveCell.Offset(0, 11).Value = Sheets("Adding").Cells(14, "e")
    ActiveCell.Offset(0, 12).Value = Sheets("Adding").Cells(15, "e")
    ActiveCell.Offset(0, 13).Value = Sheets("Adding").Cells(16, "e")
    ActiveCell.Offset(0, 14).Value = Sheets("Adding").Cells(17, "e")
    ActiveCell.Offset(0, 15).Value = Sheets("Adding").Cells(18, "e")
    ActiveCell.Offset(0, 16).Value = Sheets("Adding").Cells(19, "e")
    ActiveCell.Offset(0, 17).Value = Sheets("Adding").Cells(20, "e")
    ActiveCell.Offset(0, 18).Value = Sheets("Adding").Cells(21, "e")
    ActiveCell.Offset(0, 19).Value = Sheets("Adding").Cells(18, "f")
    ActiveCell.Offset(0, 20).Value = Sheets("Adding").Cells(19, "f")
    ActiveCell.Offset(0, 21).Value = Sheets("Adding").Cells(20, "f")
    ActiveCell.Offset(0, 22).Value = Sheets("Adding").Cells(21, "f")
    ActiveCell.Offset(0, 23).Value = Sheets("Adding").Cells(7, "z")
    ActiveCell.Offset(0, 24).Value = Sheets("Adding").Cells(18, "g")
    ActiveCell.Offset(0, 25).Value = Sheets("Adding").Cells(19, "g")
    ActiveCell.Offset(0, 26).Value = Sheets("Adding").Cells(20, "g")
    ActiveCell.Offset(0, 27).Value = Sheets("Adding").Cells(21, "g")
    
        
    Sheets("Adding").Select
       
    Range("A1").Select
    
    Cells(1, "X").Value = Cells(3, "e").Value
    
    Range("RecHeading1").Copy
        
  ' to open the record file and adding a new record
  
      Workbooks.Open Sheets("Setup").Range("e10").Value & Sheets("Setup").Range("b7").Value, Password:=Sheets("Setup").Range("AA9").Value
      
        
        'Windows(Sheets("Setup").Range("b7").Value).Activate
    
    Sheets("MRecord").Select
    Range("B1").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       ' to empty the memory
    
    Application.CutCopyMode = False
    
    Dim NewRecName As String
    NewRecName = Range("F1").Value
        
    Sheets("MRecord").Copy Before:=Sheets(1)

    Sheets("MRecord (2)").Select
    Sheets("MRecord (2)").Name = NewRecName
    
    Sheets("MRecord").Select
   
    
    
        'to save and close the file
    
     ActiveWorkbook.Save
     ActiveWorkbook.Close
    
    'Windows(Sheets("Setup").PRfilename.Value).Activate
    
       'Windows("Payroll Time Card.xlsm").Activate
       Sheets("Adding").Select
       
       
 
 Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
       
       
         Sheets("Dbase1").Visible = xlVeryHidden
         
                    
           
   'to update the selection bar


 Sheets("Selection1").Select
 
 Range("BC1").Select
 
 Selection.Offset(Range("AB2").Value, 0).Value = Sheets("Adding").Range("Y1").Value
 
           
           
      Sheets("Adding").Select
           
    Application.ScreenUpdating = True
    
    
    MsgBox ("Record Has Been Added!")
    
    Range("E4") = ""
    
    Range("E5") = ""
    Range("E6") = ""
    Range("E7") = ""
    Range("E8") = ""
    Range("F9") = 1
    Range("E10") = ""
    Range("E11") = ""
        
    
      Range("E17", "E21").Select
    Selection.ClearContents
    
      Range("E13", "E14").Select
      Selection.ClearContents
    
          Range("g18", "g21").Select
    Selection.ClearContents
    
 Sheets("Adding").Visible = xlVeryHidden
 
    Sheets("Selection1").Select
  
 Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
   
  Application.Run "macro3"

    
    'to save the book

ActiveWorkbook.Save

'Application.EnableCancelKey = xlInterrupt
 ' Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^{Break}"
 ' Application.OnKey "^%{Del}"
    
  '  Application.Run "macro3"
   


End Sub

Private Sub Macro3()
'
' Macro3 to update and displace the selection
'
ActiveWindow.DisplayWorkbookTabs = False

Application.ScreenUpdating = False

'Application.EnableCancelKey = xlDisabled

Sheets("Selection1").Select

'ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Selection1").Columns("X").ClearContents
        
   
    
    Dim LineNum1 As Integer
    Dim Sortkey1 As Integer
    
    LineNum1 = Cells(2, "AB").Value
    Sortkey1 = Cells(1, "AB").Value
    
    
    Sheets("Dbase1").Visible = True
    
    Sheets("DBase1").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
    Range(Cells(1, "A"), Cells(LineNum1 + 1, "AD")).Select
       
     
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Add Key:=Range(Cells(2, Sortkey1), Cells(LineNum1 + 1, Sortkey1)), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DBase1").Sort
        .SetRange Range(Cells(1, "A"), Cells(LineNum1 + 1, "AD"))
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
         
        
    Cells(1, "A").Select

Range(Selection.Offset(1, Sortkey1 - 1), Selection.Offset(LineNum1, Sortkey1 - 1)).Select
Selection.Copy
     
Sheets("Selection1").Select

Range("X1").Select
    
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Range("a1").Select


'to unprotect the sheet

   ' ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
     
      
' to select the selection range


Sheets("Selection1").Range(Sheets("Selection1").Range("V1").Value).Name = "eelist"


'      ActiveSheet.Shapes("List Box 1").Select
      
'    With Selection
    
 '   If LineNum1 >= 100000 Then
        
  '      .ListFillRange = "Selection1!$X$1:$X$110000"
     
        
  '      Else: .ListFillRange = Range("V1").Value
        
        
   '     End If
        
    '    .LinkedCell = "$AA$2"
    '    .MultiSelect = xlNone
     '   .Display3DShading = False
    
    ' to protect the sheet
    
    Sheets("Selection1").Select
    Range("A1").Select
    
      ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
     
     '
          
     
    'End With
  
  
      
    ' to empty the memory
    
    Application.CutCopyMode = False
  
  'Application.ScreenUpdating = True
  
 Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
  Sheets("Dbase1").Visible = xlVeryHidden
  

'Application.EnableCancelKey = xlInterrupt


End Sub





Attribute VB_Name = "Module10"
Private Sub RestQBCK()

Range("EA1:EL54").Copy Destination:=Range("A1")

  Application.CutCopyMode = False
  
Range("A:A,B:B").ColumnWidth = 6.5
Range("C:C").ColumnWidth = 12
Range("D:D,H:H,L:L").ColumnWidth = 1
Range("E:E,F:F,G:G,I:I,J:J,K:K").ColumnWidth = 10.5
Range("A1").Select

End Sub
Attribute VB_Name = "Module11"
Private Sub ExportReg()

Dim name1 As String
Dim name2 As String
Dim name3 As String
name1 = Sheets("ViewRegister").Range("e1").Value
name2 = Sheets("ViewRegister").Range("h1").Value
name3 = Sheets("ViewRegister").Range("l2").Value

Application.ScreenUpdating = False


Dim reportbook As String
Sheets("ViewRegister").Range(Cells(3, "a"), Cells(Sheets("Selection1").Range("AW2").Value + 22, "Y")).Select
Selection.Copy

Workbooks.Add
     ActiveSheet.Range("A3").Select
    ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False

   Columns("c:d").ColumnWidth = 2
Columns("a").ColumnWidth = 6
Columns("b").ColumnWidth = 11
Columns("e:y").ColumnWidth = 8

ActiveSheet.Range("a1") = name1
ActiveSheet.Range("j1") = name2
ActiveSheet.Range("a2") = name3


    Range("A1").Font.Bold = True
    Range("J1").Font.Bold = True
    
    Range("A2").Select
    With Selection.Font
        .Name = "Calibri"
        .Size = 8
        .Strikethrough = False
        .Superscript = False
        .Subscript = False
        .OutlineFont = False
        .Shadow = False
        .Underline = xlUnderlineStyleNone
        .ThemeColor = xlThemeColorLight1
        .TintAndShade = 0
        .ThemeFont = xlThemeFontMinor
    End With

     ActiveSheet.Range("a1").Select
  
  
    reportbook = ActiveWorkbook.Name

ThisWorkbook.Activate
Application.CutCopyMode = False

Sheets("ViewRegister").Range("a3").Select

MsgBox ("Record Exported to a New Excel Book1,2,3,4..., Please Check")

'Sheets("Selection1").Visible = True
'Sheets("ViewRecord").Visible = xlVeryHidden

Windows(reportbook).Activate

Application.ScreenUpdating = True


End Sub
Attribute VB_Name = "Module12"
Private Sub DropDown17_Change()

Sheets("editing").Range("e9") = Sheets("editing").Range("q9").Value


End Sub
Attribute VB_Name = "Module13"
Private Sub SetSalary()

Application.ScreenUpdating = False
Range("AK2:AK204") = Range("K2:K204").Value

Range("K2:K204") = Range("AL2:AL204").Value
Range("an2:an204") = Range("Aj2:Aj204").Value

Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Module14"
Attribute VB_Name = "Module15"
Attribute VB_Name = "Module2"
Private Sub Macro1()
'
' To display the Adding Sheet
'
 Sheets("Adding").Visible = True
 
    Sheets("Adding").Select
        
 Range("e14").Value = Date
         
    Cells(1, "y").Value = Cells(1, "X").Value + 1
    Range("E4").Select
    Sheets("selection1").Visible = xlVeryHidden
    
End Sub
Private Sub Delete1()

If Range("AB2") < 2 Then

MsgBox ("Only One Emplyee! You Must Add One Before You May Delete This One!")

Exit Sub

End If


   Dim AnswerYN1 As String
    
   AnswerYN1 = MsgBox("Are you sure that you want to delete this record?", vbYesNo, "Warning")
    If AnswerYN1 = vbNo Then
        Exit Sub
    End If
    
    
   
 'To open the record

Dim prfile2 As String
Dim filepath As String
Dim SRecord1 As String
    
    
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
 SRecord1 = Range("i4").Value
    
 
Application.ScreenUpdating = False
  

Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
       
  'select the employee record sheet
   
    Windows(prfile2).Activate
    Sheets(SRecord1).Select

If Sheets(SRecord1).Cells(2, "A") > 0 Then
    
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

MsgBox ("Activities found for this employee! Unable to Delete. Please do it after year closed")

Exit Sub
End If

Application.DisplayAlerts = False
ActiveWindow.SelectedSheets.Delete
Application.DisplayAlerts = True

   ActiveWorkbook.Save
   ActiveWorkbook.Close
 
ThisWorkbook.Activate
    
    
' start deleting


Sheets("Selection1").Select

    
     Sheets("Dbase1").Visible = True
     
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.EntireRow.Select
Selection.Delete


Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Dbase1").Visible = xlVeryHiddne

Sheets("Selection1").Select

Application.Run "Macro3"

Range("V3") = Range("V2").Value

Application.ScreenUpdating = True



End Sub




Attribute VB_Name = "Module25"
Private Sub PRSelection()
'
' PRSelection Macro
'
ActiveWindow.DisplayWorkbookTabs = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^%{Del}", ""

If Sheets("Setup").Range("AH6") = False Then

Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, Visit www.ExcelPayroll.Org"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value

MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If




'normal code start
 Sheets("Selection1").Visible = True

    Sheets("Selection1").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Dim prfile1 As String
Dim prfile3 As String
Dim filepath As String

prfile1 = Worksheets("setup").Range("B10").Value
prfile3 = Worksheets("setup").Range("e7").Value
filepath = Worksheets("setup").Range("e10").Value

Application.ScreenUpdating = False
Workbooks.Open filepath & prfile3, Password:=Sheets("Setup").Range("AA9").Value

 Windows(prfile3).Activate
 
'Sheets("Sheet1").Range("s1", "dc100").Copy
Sheets("Sheet1").Range("a1", "ck100").Copy

ThisWorkbook.Activate
Sheets("WeekTime").Visible = True
Sheets("WeekTime").Select
Range("DS1").Select
    
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


Windows(prfile3).Activate

ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate

Sheets("WeekTime").Range("S1", "DC100").ClearContents
Sheets("TimeCard").Range("AC6", "AC10").ClearContents

Sheets("WeekTime").Visible = False
Sheets("Selection1").Visible = True

Sheets("Selection1").Select

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

Sheets("Selection1").Select
  Range("A1").Select
   
   ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

    
    Sheets("Main").Visible = False
    Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^%{Del}"

    
End Sub
Private Sub Return2()
ActiveWindow.DisplayWorkbookTabs = False
'
' Return to Main Menu
'
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
   
    Sheets("Main").Select
    Range("I13").Select
    ThisWorkbook.Save

Application.EnableCancelKey = xlInterrupt
Application.CellDragAndDrop = True
 
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^%{Del}"
        
End Sub
Private Sub Costing()

ActiveWindow.DisplayWorkbookTabs = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^%{Del}", ""

If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; please use standard version")

Exit Sub

End If


'start normal

Application.ScreenUpdating = False
       
    Dim LineNum1 As Integer
    Dim Sortkey1 As Integer
    Dim Enumbers As Integer
    Dim prfile1 As String
    Dim prfile3 As String
    Dim filepath As String
    
    
    
    LineNum1 = Sheets("Selection1").Cells(2, "AB").Value
    Sortkey1 = 14
    Enumbers = Worksheets("selection1").Range("AD3").Value
    prfile1 = Worksheets("setup").Range("B10").Value
    prfile3 = Worksheets("setup").Range("e7").Value
    filepath = Worksheets("setup").Range("e10").Value
    
    
    
    
    
    Sheets("Dbase1").Visible = True
    
    Sheets("DBase1").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
    Range(Cells(1, "A"), Cells(LineNum1 + 1, "AB")).Select
       
     
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Add Key:=Range(Cells(2, Sortkey1), Cells(LineNum1 + 1, Sortkey1)), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DBase1").Sort
        .SetRange Range(Cells(1, "A"), Cells(LineNum1 + 1, "AB"))
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
         
        
 Cells(1, "A").Select


Workbooks.Open filepath & prfile3, Password:=Sheets("Setup").Range("AA9").Value

Windows(prfile3).Activate

 Sheets("employeedata").Visible = True
Sheets("employeedata").Select
Range("B2:F58").ClearContents
Range("AA1").Value = filepath
Range("AB1").Value = prfile1


'copy ID numbers
Windows(prfile1).Activate
Sheets("DBase1").Visible = True
Sheets("DBase1").Select
Range("A1").Select
Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy

'Paste ID number


 Windows(prfile3).Activate
Sheets("employeedata").Select

Range("C2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False
 
'copy Name
Windows(prfile1).Activate
Sheets("DBase1").Visible = True
Sheets("DBase1").Select
Range("B1").Select
Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste Name

 Windows(prfile3).Activate
Sheets("employeedata").Select
Range("B2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


'copy payrate
Windows(prfile1).Activate
Sheets("DBase1").Select
Range("o1").Select
Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste payrate

 Windows(prfile3).Activate
Sheets("employeedata").Select
Range("e2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


'copy ratecode
Windows(prfile1).Activate
Sheets("DBase1").Select
Range("x1").Select
Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste ratecode

 Windows(prfile3).Activate
Sheets("employeedata").Select
Range("d2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


 Sheets("employeedata").Visible = xlVeryHidden


'update the selection box

Sheets("TimeCard").Select


ActiveSheet.Unprotect Password:="danielchao"


    ActiveSheet.Shapes("Drop Down 6").Select
    With Selection
        .ListFillRange = Sheets("EmployeeData").Range("AC1").Value
        .LinkedCell = "TimeCard!$F$4"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    
Range("e8").Select

Sheets("Detail2").Range("B2:C58").Value = Sheets("EmployeeList").Range("B2:C58").Value


 ActiveSheet.Protect Password:="danielchao", DrawingObjects:=True, Contents:=True, Scenarios:=True



ThisWorkbook.Activate
ThisWorkbook.Saved = True
'ThisWorkbook.Save
ThisWorkbook.Close

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^%{Del}"


End Sub



Attribute VB_Name = "Module27"
Private Sub ViewRecord()

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim SRecord1 As String
    
    
 prfile1 = Worksheets("setup").Range("B10").Value
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
 SRecord1 = Range("i4").Value
    
 
Application.ScreenUpdating = False
  
 'TO GET VACATION HOUR READY
   
'  Sheets("Dbase1").Visible = True
  
 '   Sheets("Dbase1").Select

'Columns("A").Select

'Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

'ActiveCell.Select

'Selection.Offset(0, 12).Select

'Range("AC1") = Selection.Value

 ' Sheets("Dbase1").Visible = False
  




Sheets("ViewRecord").Visible = True

    Sheets("ViewRecord").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    Sheets("ViewRecord").Range("D1", "AH3660").Select
    Selection.ClearContents
        With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    
    Sheets("ViewRecord").Range("DA1", "EW3660").ClearContents
     
'Sheets("Setup").Visible = True
   
   'Sheets("Setup").Select
    '   Range("D9").Select
    'ActiveCell.FormulaR1C1 = "=PRfilename"
    'Range("b10").Select

 'Sheets("Setup").Range("b10") = Sheets("Setup").Range("b9").Value

'Sheets("Setup").Visible = xlVeryHiddne

Sheets("Selection1").Select

Dim Emunber As String

Emunber = Cells(3, "V").Value
          
    
  
    
  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
       
  'select the employee record sheet
   
    Windows(prfile2).Activate
    Sheets(Emunber).Select

'Range("A:AE").Select

Range("A1", "AE" & Cells(2, "AE") + 10).Select


Selection.Copy
 'Windows("PayrollBook.xlsm").Activate
 Windows(prfile1).Activate
 Sheets("ViewRecord").Select
 Range("D1").Select
ActiveSheet.Paste

Range("D1").Select
 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False

'copy another full record to DA range

    Windows(prfile2).Activate
    Sheets(Emunber).Select

'Range("A:AW").Select
Range("A1", "AW" & Cells(2, "AE") + 10).Select

Selection.Copy
 'Windows("PayrollBook.xlsm").Activate
 Windows(prfile1).Activate
 Sheets("ViewRecord").Select
 Range("DA1").Select

 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


    Columns("DA:EW").Select
    Selection.ColumnWidth = 0
    Range("A1").Select


   'Windows("Payroll Record.xlsm").Activate
   Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close

 
' to select the selection range


      ActiveSheet.Shapes("List Box 1").Select
      
    With Selection
    
 .ListFillRange = Range("A2").Value
         
        .LinkedCell = "$A$3"
        .MultiSelect = xlNone
        .Display3DShading = False
        
       End With
            
    Range("e4").Select
Range(Selection.Offset(1, 0), Selection.Offset(1, 19)).Select

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        '.ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
            
      Range("A3").Value = 1
                  
            Range("a1").Select
            
    ' to protect the sheet
    
    ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
  
  If Range("D2").Value = 0 Then
  
  MsgBox ("No Payroll Has Made to This Employee! No Record Found!")
  Sheets("ViewRecord").Visible = xlVeryHidden
   Sheets("Selection1").Select
  
  'Application.Run "PRSelection"
    
  Exit Sub
  End If
 
Sheets("Selection1").Visible = xlVeryHidden

Application.ScreenUpdating = True

End Sub



Private Sub DeleteCheck()
 

   Dim AnswerYN2 As String
    
   AnswerYN2 = MsgBox("Are you sure that you want to Void this Paycheck?", vbYesNo, "Warning")
    If AnswerYN2 = vbNo Then
        Exit Sub
    End If
    

If Cells(4, "bp").Value = "V" Then

 MsgBox ("This check had previously voided! Unable to void again!")

Exit Sub
End If

If Cells(4, "bq").Value = "V" Then

 MsgBox ("Unable to Void This Voided Entry! Please Select and Pay!")

Exit Sub
End If


Application.EnableCancelKey = xlDisabled

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value


Application.ScreenUpdating = False

Dim cnumber As String
Dim vnumber As String
Dim lnumber As Integer
Dim Recnumber As String

cnumber = Cells(5, "bo").Value
vnumber = Cells(5, "bp").Value
lnumber = Cells(2, "d").Value
Recnumber = Cells(1, "i").Value


  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
       
  'select the employee record sheet
   
    Windows(prfile2).Activate
    Sheets(Recnumber).Select

Columns("AE").Select

Selection.Find(What:=cnumber, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

ActiveCell.Value = vnumber


' to insert a line

    Range("A3").Select
    Selection.End(xlDown).Select
      
    Selection.Offset(1, 0).Select
       Selection.EntireRow.Insert , CopyOrigin:=xlFormatFromLeftOrAbove


'to copy the void line

Windows(prfile1).Activate
Sheets("ViewRecord").Select
Range("AK6:CG6").Select
Selection.Copy

    Windows(prfile2).Activate
    Sheets(Recnumber).Select
    Range("A3").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

         ' to empty the memory
    
    Application.CutCopyMode = False



  ' to copy to the register
     
     
    'Windows("ExBook.xlsm").Activate
     'Windows(Sheets("Setup2").Range("b10").Value).Activate
       
       
    Windows(prfile1).Activate
Sheets("ViewRecord").Select
Range("AK2:CI2").Select
Selection.Copy
       

    Windows(prfile2).Activate
    Sheets("MRegister").Select
    Range("C1").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
         ' to empty the memory
    
    Application.CutCopyMode = False

   Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close

    Windows(prfile1).Activate
Sheets("ViewRecord").Select


 'to update the vacation balance
  

    Dim SRecord1 As String
    SRecord1 = Range("i1").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select
 
 Selection.Offset(0, 12).Select

    ActiveCell.Value = ActiveCell.Value + Sheets("ViewRecord").Cells(6, "CD")
   

Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Dbase1").Visible = xlVeryHidden


' to display message

 MsgBox ("Selected PayCheck Voided!")

ScreenUpdating = False

Sheets("Selection1").Visible = True
Sheets("Selection1").Select
Application.Run ("ViewRecord")


Application.EnableCancelKey = xlDisabled
ScreenUpdating = True

End Sub


Private Sub Printrec()
    
    Application.ScreenUpdating = False
     Sheets("PrintRecord").Visible = True
    Sheets("PrintRecord").Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
    Columns("E:X").Select
    Selection.Copy
        
    Sheets("PrintRecord").Select
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    
    
    Range(Cells(1, "A"), Cells(Cells(1, "V").Value + 5, "T")).Select

    Selection.PrintOut Copies:=1

Sheets("PrintRecord").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("PrintRecord").Visible = xlVeryHidden
Sheets("ViewRecord").Select
Range("B17").Select

Application.ScreenUpdating = True

End Sub

Private Sub copyrecord()

Application.ScreenUpdating = False

Dim reportbook As String
Sheets("ViewRecord").Range(Cells(1, "E"), Cells(Cells(2, "D").Value + 10, "X")).Select
Selection.Copy

Workbooks.Add
     ActiveSheet.Range("A1").Select
    ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
Application.CutCopyMode = False

    Columns("A:T").Select
    With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With

     ActiveSheet.Range("a1").Select
    
    reportbook = ActiveWorkbook.Name

ThisWorkbook.Activate
Application.CutCopyMode = False
Sheets("ViewRecord").Range("C17").Select

MsgBox ("Record Exported to a New Excel Book1,2,3,4..., Please Check")

'Sheets("Selection1").Visible = True
'Sheets("ViewRecord").Visible = xlVeryHidden

Windows(reportbook).Activate

Application.ScreenUpdating = True


End Sub




Private Sub ViewRegister()

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value



Application.ScreenUpdating = False
Sheets("ViewRegister").Visible = True

    Sheets("ViewRegister").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
Range("A5", "AC3667").Select

Selection.ClearContents


    
  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
Windows(prfile2).Activate
       
  'select the employee record sheet
   
   ' Windows("Payroll Record.xlsm").Activate
    Sheets("MRegister").Select

Dim Reglinenumber As String

Reglinenumber = Cells(1, "AK").Value
              
Range("C3").Select

Range(Selection.Offset(0, 0), Selection.Offset(Reglinenumber, 26)).Select
Selection.Copy

Windows(prfile1).Activate
Sheets("ViewRegister").Select

Range("a5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False

Windows(prfile2).Activate
 Sheets("MRegister").Select
 Range("D3651", "AC3667").Select
 Selection.Copy
 
Windows(prfile1).Activate
Sheets("ViewRegister").Select

Range("B5").Select
Range(Selection.Offset(Reglinenumber + 1, 0), Selection.Offset(Reglinenumber + 1, 26)).Select

    'ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
     Application.CutCopyMode = False
    
    
    'to outline the range
    
Range("A5").Select
Range(Selection.Offset(0, 0), Selection.Offset(Reglinenumber + 17, 26)).Select
    
       Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
  
Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

Range("A1").Select

    ' to protect the sheet
    
    ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
  Sheets("Selection1").Visible = xlVeryHidden
Application.ScreenUpdating = True


End Sub


Attribute VB_Name = "Module3"
Private Sub Return1()
'
ActiveWindow.DisplayWorkbookTabs = False
'check if program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If


' Return1 Macro
Application.ScreenUpdating = False
Sheets("Selection1").Visible = True
     Sheets("Entry1").Visible = xlVeryHidden
      Sheets("Adding").Visible = xlVeryHidden
       Sheets("Editing").Visible = xlVeryHidden
       Sheets("JournalEntry").Visible = xlVeryHidden
       Sheets("TimeCard").Visible = xlVeryHidden
  Sheets("ViewRecord").Visible = xlVeryHidden
  Sheets("W2info").Visible = xlVeryHidden
   Sheets("ViewRegister").Visible = xlVeryHidden
         Sheets("Selection1").Select
    Sheets("Selection1").Range("J13").Select

Sheets("Selection1").Range("AA1") = 2
Application.Run "macro3"

Application.EnableCancelKey = xlInterrupt

Application.ScreenUpdating = True
End Sub
Private Sub Edit1()
ActiveWindow.DisplayWorkbookTabs = False

 Sheets("editing").Visible = True
 
Sheets("editing").Select

Range("e4:e5").Value = Sheets("Selection1").Range("ac5:ac6").Value

Range("e6:e15").Value = Sheets("Selection1").Range("aa7:aa16").Value

Range("f16").Value = Sheets("Selection1").Range("z17").Value

Range("e17:e21").Value = Sheets("Selection1").Range("aa18:aa22").Value

Range("f18:f21").Value = Sheets("Selection1").Range("ac19:ac22").Value

Range("z7").Value = Sheets("Selection1").Range("ac23").Value

Range("g18:g21").Value = Sheets("Selection1").Range("aa23:aa27").Value


Sheets("selection1").Visible = xlVeryHidden

Application.EnableCancelKey = xlInterrupt


End Sub
Private Sub Update1()
ActiveWindow.DisplayWorkbookTabs = False

    If Range("z11") <> True Then

MsgBox ("Social Security Number Must be in 999-99-9999 Format!")

Exit Sub
End If




        If Range("o9") = True Then

MsgBox ("The Vacation adjustment must be a number in value! Please Re-enter")

Exit Sub

End If


        If Range("o18") = True Then

MsgBox ("Deduction Amount/Percent must be a number in value! Please Re-enter")

Exit Sub

End If


        If Range("o19") = True Then

MsgBox ("The deduction limit must be a number/amount in value! Please Re-enter")

Exit Sub

End If

       If Range("o20") = False Then

MsgBox ("The deduction amount/percent must be greater or equal to zero! Please Re-enter")

Exit Sub

End If


       If Range("o21") = False Then

MsgBox ("The deduction limit Cannot be Negative! Please Re-enter")

Exit Sub

End If


    
    If Range("E4").Value = "" Then
    
    MsgBox ("The Name is Empty! Please Enter the name")
    Cells(4, "E").Select
    Exit Sub
    
     End If
    
   
    
    If Range("o5") = 0 Then

MsgBox ("The Last Name Empty!")

Exit Sub

End If
    
    
    If Range("o6") = 0 Then

MsgBox ("The Address is Empty!")

Exit Sub

End If
    
    
    
        If Range("o7") = 0 Then

MsgBox ("The City is Empty!")

Exit Sub

End If
    
        If Range("o8") = 0 Then

MsgBox ("The State and Zip Must be Filled!")

Exit Sub

End If
    
        If Range("o11") = 0 Then

MsgBox ("The Social Security Number is Emty!")

Exit Sub

End If
    
    
        If Range("o12") = 0 Then

MsgBox ("The Tax Claim Status Must be either ""M"" or ""S""!")

Exit Sub

End If
    
    
        If Range("o13") = 0 Then

MsgBox ("The Number of Dependents Must be in Value Format!")

Exit Sub

End If
    
    
        If Range("o17") = 0 Then

MsgBox ("The Payrate must be in Value and Greater than $7.25!")

Exit Sub

End If

        If Range("z8") > 4807.7 Then

MsgBox ("Too Large! The Maximum rate is $4807.69/Hour, Please reenter")

Exit Sub

End If

       If Range("o24") = True Then

MsgBox ("The Hiring Date is Empty! Please enter a hiring date")

Exit Sub

End If


       If Range("o23") = True Then

MsgBox ("The Hiring Date Must be in Value Format mm/dd/yy! Please Re-enter")

Exit Sub

End If


       If Range("o25") = True Then

MsgBox ("Hiring Date Error! Do not enter a future employee for more than 30 days, Please Re-enter")

Exit Sub

End If





Application.EnableCancelKey = xlDisabled


'start normal
Application.ScreenUpdating = False

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value



Sheets("Selection1").Visible = True

Sheets("Selection1").Select

    Dim SRecord1 As String
    SRecord1 = Range("i4").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

    ActiveCell.Offset(0, 0).Value = Sheets("Editing").Cells(3, "e")
    ActiveCell.Offset(0, 1).Value = Sheets("Editing").Cells(4, "aa")
    ActiveCell.Offset(0, 2).Value = Sheets("Editing").Cells(5, "aa")
    ActiveCell.Offset(0, 3).Value = Sheets("Editing").Cells(6, "e")
    ActiveCell.Offset(0, 4).Value = Sheets("Editing").Cells(7, "e")
    ActiveCell.Offset(0, 5).Value = Sheets("Editing").Cells(8, "e")
    ActiveCell.Offset(0, 6).Value = Sheets("Editing").Cells(9, "e")
    ActiveCell.Offset(0, 7).Value = Sheets("Editing").Cells(10, "e")
    ActiveCell.Offset(0, 8).Value = Sheets("Editing").Cells(11, "e")
    ActiveCell.Offset(0, 9).Value = Sheets("Editing").Cells(12, "e")
    ActiveCell.Offset(0, 10).Value = Sheets("Editing").Cells(13, "e")
    ActiveCell.Offset(0, 11).Value = Sheets("Editing").Cells(14, "e")
    ActiveCell.Offset(0, 12).Value = Sheets("Editing").Cells(15, "e")
    ActiveCell.Offset(0, 13).Value = Sheets("Editing").Cells(16, "e")
    ActiveCell.Offset(0, 14).Value = Sheets("Editing").Cells(17, "e")
    ActiveCell.Offset(0, 15).Value = Sheets("Editing").Cells(18, "e")
    ActiveCell.Offset(0, 16).Value = Sheets("Editing").Cells(19, "e")
    ActiveCell.Offset(0, 17).Value = Sheets("Editing").Cells(20, "e")
    ActiveCell.Offset(0, 18).Value = Sheets("Editing").Cells(21, "e")
    ActiveCell.Offset(0, 19).Value = Sheets("Editing").Cells(18, "f")
    ActiveCell.Offset(0, 20).Value = Sheets("Editing").Cells(19, "f")
    ActiveCell.Offset(0, 21).Value = Sheets("Editing").Cells(20, "f")
    ActiveCell.Offset(0, 22).Value = Sheets("Editing").Cells(21, "f")
    ActiveCell.Offset(0, 23).Value = Sheets("Editing").Cells(7, "z")
    ActiveCell.Offset(0, 24).Value = Sheets("Editing").Cells(18, "g")
    ActiveCell.Offset(0, 25).Value = Sheets("Editing").Cells(19, "g")
    ActiveCell.Offset(0, 26).Value = Sheets("Editing").Cells(20, "g")
    ActiveCell.Offset(0, 27).Value = Sheets("Editing").Cells(21, "g")
    



Sheets("Editing").Select

Range("Recheading2").Copy
        
  ' to open the editted headding to record file
  
      Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
        
        Windows(prfile2).Activate
    
    Sheets(SRecord1).Select
    
    Range("B1").Select
    
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       ' to empty the memory
    
    Application.CutCopyMode = False


        'to save and close the file
    
     ActiveWorkbook.Save
     ActiveWorkbook.Close

 Sheets("Selection1").Select

Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Editing").Visible = xlVeryHidden
Sheets("Dbase1").Visible = xlVeryHidden

'to save the book

ActiveWorkbook.Save

Application.Run "macro3"

Application.EnableCancelKey = xlInterrupt

End Sub




Attribute VB_Name = "Module32"
Private Sub ListBox1_Change()

Application.ScreenUpdating = False

      ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
      

Dim payline2 As Integer
payline2 = Range("D2").Value

Range("e4").Select
Range(Selection.Offset(1, 0), Selection.Offset(payline2, 19)).Select

      With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With


Dim payline1 As Integer
payline1 = Cells(2, "AI").Value


'Range("AI3").Value = Range("AI2").Value

Range("e4").Select
Range(Selection.Offset(payline1, 0), Selection.Offset(payline1, 19)).Select

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        '.ThemeColor = xlThemeColorAccent2
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With


Range("A7").Select

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Application.ScreenUpdating = True





End Sub

Attribute VB_Name = "Module34"
Private Sub PW2_Click()

    Application.ScreenUpdating = False
     Sheets("W2info").Visible = True
    
    Worksheets("W2info").Range("at10").Value = Worksheets("Selection1").Range("v3").Value
         
    Dim LineNum1 As Integer
    Dim Sortkey1 As Integer
    
    LineNum1 = Cells(2, "AB").Value
    Sortkey1 = 1
    
    
    
    
    Sheets("Dbase1").Visible = True
    
    Sheets("DBase1").Select
    
    Range(Cells(1, "A"), Cells(LineNum1 + 1, "AD")).Select
       
     
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Add Key:=Range(Cells(2, Sortkey1), Cells(LineNum1 + 1, Sortkey1)), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    With ActiveWorkbook.Worksheets("DBase1").Sort
        .SetRange Range(Cells(1, "A"), Cells(LineNum1 + 1, "AD"))
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
         
        
    Cells(1, "A").Select

Sheets("Dbase1").Visible = xlVeryHiddne

' To display sheet("W2info")

 Sheets("W2info").Select
Worksheets("W2info").Range("j6").Value = Worksheets("W2info").Range("at11").Value
    Worksheets("W2info").Range("j7").Value = Worksheets("W2info").Range("at11").Value

'to adjust the selection box

 ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

    ActiveSheet.Shapes("Drop Down 1").Select
    With Selection
        .ListFillRange = Range("AT1").Value
        
        .LinkedCell = "$J$6"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    Range("J10").Select

    ActiveSheet.Shapes("Drop Down 2").Select
    With Selection
        .ListFillRange = Range("AT1").Value
        
        .LinkedCell = "$J$7"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    
ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
      
    
Range("i11").Select
Sheets("Selection1").Visible = False

Application.ScreenUpdating = True


End Sub


Attribute VB_Name = "Module36"
Private Sub PrintW2()

' to print w-2 form

If Range("I6").Value > Range("I7").Value Then

MsgBox ("Error! The last number must be greater then the starting number!")

Exit Sub

End If

Application.EnableCancelKey = xlDisabled



'to display processing
Sheets("Processing").Range("BB1") = 4
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("W2info").Range("at7").Value
Sheets("Processing").Visible = True
Sheets("Processing").Select
Application.ScreenUpdating = False



Sheets("W2info").Visible = True
 Sheets("W2info").Select

Application.ScreenUpdating = False

Sheets("W2Form").Visible = True


Dim enumber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim Printnumber As Integer
Dim formprinted As Integer
Dim irsform As Integer



'********Range("f2").Value = Worksheets("Selection1").Range("V3").Value

Range("f2").Value = Range("at6").Value

prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value

enumber = Cells(6, "i").Value
Printnumber = Range("at7").Value
formprinted = 0
irsform = 0


   
  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
   
  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value

      
      Do Until Printnumber < 1
     
      'select data to copy to w2-info sheet
   
    Windows(prfile2).Activate
          
    Sheets(enumber).Select
    
    If Range("A2") > 0 Then
    
    'irsform = irsform + 1
    'Sheets("W2info").Range("at15") = irsform
    
    Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    
Range(Selection.Offset(4, 0), Selection.Offset(4, 25)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    
    Windows(prfile1).Activate
        
    Sheets("W2info").Select
    Range("S3").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Range("f8").Value = Range("AT2").Value
Range("f9").Value = Range("AT3").Value
Range("f10").Value = Range("AT4").Value
Range("f11").Value = Range("AT5").Value

Range("c2").Value = Range("t3").Value
Range("c3").Value = Range("aa3").Value
Range("c4").Value = Range("v3").Value
Range("c5").Value = Range("y3").Value
Range("c6").Value = Range("w3").Value
Range("c7").Value = Range("z3").Value
Range("c13").Value = Range("ad3").Value
Range("c14").Value = Range("ae3").Value
Range("d13").Value = Range("af3").Value
Range("d14").Value = Range("ag3").Value

Range("c17").Value = Range("u3").Value
Range("c18").Value = Range("ab3").Value
Range("c19").Value = Range("ac3").Value
Range("c21").Value = Worksheets("PRRate").Range("e4").Value



If Sheets("W2info").Range("at13") = 1 Then
ThisWorkbook.Activate
Sheets("W2Form").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
End If


formprinted = formprinted + 1
Sheets("W2info").Range("at15") = formprinted


If Sheets("W2info").Range("at13") = 2 And Sheets("W2info").Range("at16") = False Then
Sheets("W2info").Range("C25:F44") = Sheets("W2info").Range("C2:F21").Value
End If


If Sheets("W2info").Range("at13") = 2 And Sheets("W2info").Range("at16") = True Then
ThisWorkbook.Activate

Sheets("W2IRSCopy").Visible = True
Sheets("W2IRSCopy").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
irsform = irsform + 1
Sheets("W2IRSCopy").Visible = xlVeryHidden

Sheets("W2info").Range("C25:F44").ClearContents
Sheets("W2info").Range("C2:c7").ClearContents
Sheets("W2info").Range("C13:d15").ClearContents
Sheets("W2info").Range("C17:c21").ClearContents
Sheets("W2info").Range("f7:f11").ClearContents
Sheets("W2info").Range("f2").ClearContents

End If



Sheets("W2info").Select

Printnumber = Printnumber - 1

Range("at9").Value = Printnumber

enumber = Range("at8").Value

Range("f2").Value = Range("at8").Value


Else

ThisWorkbook.Activate
Sheets("W2info").Select

Printnumber = Printnumber - 1

Range("at9").Value = Printnumber

enumber = Range("at8").Value

Range("f2").Value = Range("at8").Value

End If


'to display processing
ThisWorkbook.Activate
Sheets("Processing").Range("Ba1") = Sheets("Processing").Range("Ba2") - Printnumber
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False


Loop


If Sheets("W2info").Range("at13") = 2 And Sheets("W2info").Range("at17") = False Then

'Sheets("W2info").Range("C25:F44") = Sheets("W2info").Range("C2:F21").Value

ThisWorkbook.Activate
Sheets("W2IRSCopy").Visible = True
Sheets("W2IRSCopy").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
irsform = irsform + 1
Sheets("W2IRSCopy").Visible = xlVeryHidden

End If

Sheets("W2info").Range("C25:F44").ClearContents
Sheets("W2info").Range("C2:c7").ClearContents
Sheets("W2info").Range("C13").ClearContents
Sheets("W2info").Range("C17:c21").ClearContents
Sheets("W2info").Range("f7:f11").ClearContents
Sheets("W2info").Range("f2").ClearContents

Application.ScreenUpdating = False


Sheets("W2info").Range("AZ1") = formprinted
Windows(prfile2).Activate
Sheets("MRegister").Select
Range("H3667:BA3667").Select
Selection.Copy

ThisWorkbook.Activate
Sheets("W2info").Select
Range("BA2").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False



'to close the payroll record

Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate
Sheets("Selection1").Visible = True
Sheets("Selection1").Select
Sheets("Selection1").Cells(1, "AA") = 4
Application.Run "macro3"
Sheets("W2Form").Visible = xlVeryHidden



If Sheets("W2info").Range("at13") = 1 Then

Sheets("Processing").Select
MsgBox "Total " & (formprinted) & " W-2 form printed!"

End If

If Sheets("W2info").Range("at13") = 2 Then

Sheets("Processing").Select
MsgBox "Total " & (irsform) & " W-2 IRS Pages printed!"

End If




If Sheets("W2info").Range("At7") = Sheets("Selection1").Range("Ab2") Then

Dim Answer5 As String
    Answer5 = MsgBox("Do you want to print W-3 information?", vbYesNo, "Alert")
    If Answer5 = vbYes Then

Sheets("Processing").Select
Application.ScreenUpdating = False

Sheets("W3").Visible = True
Sheets("W3").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
Sheets("W3").Visible = xlVeryHidden

    End If
    
End If


Sheets("W2info").Select
Range("i11").Select
Application.ScreenUpdating = True

Sheets("Processing").Visible = xlVeryHidden
Sheets("Selection1").Visible = xlVeryHidden

Application.EnableCancelKey = xlInterrupt


End Sub


Attribute VB_Name = "Module39"
Private Sub ViewEarning()
'
' ViewEarning Macro
'

Application.ScreenUpdating = False

Sheets("Earnings").Visible = True

  Sheets("Earnings").Range("A4", "T200").ClearContents
    
    
    Sheets("Earnings").Range("B1", "N1").Value = Sheets("ViewRecord").Range("f1", "r1").Value
    
        
Dim Wagelinenumber As Integer

Wagelinenumber = Cells(2, "d").Value
              

Range("DB5").Select

Range(Selection.Offset(0, 0), Selection.Offset(Wagelinenumber - 1, 0)).Select
Selection.Copy

Sheets("Earnings").Select
  
    
    Range("A4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
     Application.CutCopyMode = False
   
    Sheets("ViewRecord").Select
    

Range("EG5").Select

Range(Selection.Offset(0, 0), Selection.Offset(Wagelinenumber - 1, 8)).Select
Selection.Copy

Sheets("Earnings").Select
  
    
    Range("b4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
     Application.CutCopyMode = False
   
    Sheets("ViewRecord").Select
    
    
    
   Range("Ep5").Select

Range(Selection.Offset(0, 0), Selection.Offset(Wagelinenumber - 1, 7)).Select
Selection.Copy

Sheets("Earnings").Select
  
    
    Range("l4").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
     Application.CutCopyMode = False
    

'to sum total

Range("K4").Formula = "=sum(C4:j4)"
Range("t4").Formula = "=sum(L4:s4)"

Range("k4").Copy
Range("k4", "k" & Cells(1, "aa").Value + 3).Select
ActiveSheet.Paste

 Application.CutCopyMode = False

Range("t4").Copy
Range("t4", "t" & Cells(1, "aa").Value + 3).Select
ActiveSheet.Paste

 Application.CutCopyMode = False


'sum total

Range("a2").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    ActiveCell.Formula = "Total"


Range("c4", "t" & Cells(1, "aa").Value + 3).Select

    Dim source As Range
    Dim iCol As Long
    Dim nCol As Long
    Dim nRow As Long
 
    Set source = Selection
 
    nCol = source.Columns.Count
    nRow = source.Rows.Count
    For iCol = 1 To nCol
        With source.Columns(iCol).Rows(nRow).Offset(1, 0)
            .FormulaR1C1 = "=SUM(R[-" & nRow & "]C:R[-1]C)"
           ' .Font.Bold = True
        End With
    Next iCol



'to close the viewrecord sheet


Sheets("ViewRecord").Visible = xlVeryHidden


  Range("a1").Select
  Application.ScreenUpdating = True
    
    
End Sub


Attribute VB_Name = "Module4"
Private Sub DataEntry1()

' to test the expiration before starts the program

If Sheets("Setup").Range("AH6") = False Then


Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ChaoNing.Com to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, ask DanieChao@hotmail.com"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value

MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If




'normal code start


'
' DataEntry1 Macro

Application.ScreenUpdating = False

Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

'to select the weeks

Sheets("TimeCard").Range("AC6", "AC10") = True
'Sheets("TimeCard").Range("AC7", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "DC100") = Sheets("WeekTime").Range("DS1", "hc100").Value
'Sheets("WeekTime").Range("Ak1", "dc201").ClearContents


If Sheets("Setup").Range("y1").Value = 1 Then

Sheets("TimeCard").Range("AC6") = True
Sheets("TimeCard").Range("AC7", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "AI100") = Sheets("WeekTime").Range("DS1", "EI100").Value

Sheets("WeekTime").Range("Ak1", "dc201").ClearContents

End If

If Sheets("Setup").Range("y1").Value = 2 Then

Sheets("TimeCard").Range("AC6", "AC7") = True
Sheets("TimeCard").Range("AC8", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "BA100") = Sheets("WeekTime").Range("DS1", "FA100").Value

Sheets("WeekTime").Range("BC1", "dc201").ClearContents

End If

'to start entry
Sheets("WeekTime").Range("B2", "C201").ClearContents
Range(Sheets("WeekTime").Range("C2"), Sheets("WeekTime").Range("C2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Range(Sheets("DBase1").Range("A2"), Sheets("DBase1").Range("A2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value
Range(Sheets("WeekTime").Range("B2"), Sheets("WeekTime").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Range(Sheets("DBase1").Range("B2"), Sheets("DBase1").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 If Range("ay1") <> 1 Then
 
  Range("BC1").Select
 
 Selection.Offset(Range("AZ1").Value, 0).Value = Range("V3").Value
 
End If



Dim Emunber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
Emunber = Cells(3, "V").Value


Columns("BC").Select

Selection.Find(What:=Emunber, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

Range("Az2") = Selection.Offset(0, 8).Value
Range("Az3") = Selection.Offset(0, 9).Value
Range("Az4") = Selection.Offset(0, 10).Value
Range("Az5") = Selection.Offset(0, 11).Value
Range("Az6") = Selection.Offset(0, 12).Value


Sheets("Selection1").Select


'Application.ScreenUpdating = False
   
    Sheets("Entry1").Visible = True
    Sheets("Entry1").Select
    
     
    
    Range("e12", "g20").ClearContents
    
    
    Range("b4").Value = Sheets("Selection1").Range("I4").Value
    Range("b5").Value = Sheets("Selection1").Range("I6").Value
    Range("b6:b9").Value = Sheets("Selection1").Range("I7:I10").Value
  
    Range("E12").Value = Sheets("Selection1").Range("Az2").Value
    Range("E13").Value = Sheets("Selection1").Range("Az3").Value
    Range("E14").Value = Sheets("Selection1").Range("Az4").Value
    Range("E15").Value = Sheets("Selection1").Range("Az5").Value
    Range("E16").Value = Sheets("Selection1").Range("Az6").Value
    
    
    
  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
   
  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value


   'select data to copy to entry1 sheet
   
    Windows(prfile2).Activate
    
    
    If Sheets("MRegister").Range("AK1").Value >= 3645 Then
    
    MsgBox ("Reached Maximum Payroll this Year; Please Close the Payroll Year and Rerun!")
    
         ActiveWorkbook.Saved = True
         ActiveWorkbook.Close
    ThisWorkbook.Activate
    Sheets("Entry1").Visible = False
    Sheets("Selection1").Select
      
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
    Exit Sub
    
    
    End If
            
    
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    
Range(Selection.Offset(4, 0), Selection.Offset(4, 25)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S1").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'copy last payment info

    'Windows("Payroll Record.xlsm").Activate
    
    Windows(prfile2).Activate
    
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
   
    
Range(Selection.Offset(0, -3), Selection.Offset(0, 26)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S2").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Range("A1").Select


 Windows(prfile2).Activate
 
 ActiveWorkbook.Saved = True
 ActiveWorkbook.Close
    
'return to Entry1 sheet
       
Windows(prfile1).Activate
'Windows(Sheets("Setup").Range("b10").Value).Activate

Sheets("Entry1").Select
Range("O2").Value = Sheets("Setup").Range("Y1").Value


Range("j4", "j13").ClearContents
Range("g9").ClearContents
Range("q23", "q31").ClearContents
Range("q23", "q27").Value = Range("t23", "t27").Value


Range("g4").Value = Now()
'Range("g6").Value = Range("g6") + 1
Sheets("Entry1").Select
Range("g9").Value = Sheets("selection1").Range("v17").Value
Sheets("selection1").Visible = False
Range("e12").Select
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True


End Sub


Private Sub Button1_Click()
 
 
 'check if errors in setup

If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub

End If

If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")

Exit Sub

End If
 
  
 ' start process
 
Range("g12", "g20").Value = Range("P20", "P28").Value
 
 If Range("q14") <> 1 Then
MsgBox ("The Gross Wage Must be in Value Amount!")
Exit Sub
End If
 
 
 
 Application.ScreenUpdating = False
 Sheets("Setup").Range("b10") = Sheets("Setup").Range("b9").Value

  Sheets("PRCalculator").Visible = True
  
Range("j4").Value = Sheets("PRCalculator").Range("N14").Value
Range("j5").Value = Sheets("PRCalculator").Range("O14").Value
Cells(6, "j").Value = Sheets("PRCalculator").Range("L14").Value
Range("j7").Value = Sheets("PRCalculator").Range("M14").Value
Range("j8").Value = Sheets("PRCalculator").Range("P14").Value
Range("j9").Value = Sheets("PRCalculator").Range("Q14").Value
Range("j10").Value = Sheets("PRCalculator").Range("R14").Value
Range("j11").Value = Sheets("PRCalculator").Range("S14").Value
Range("j12").Value = Sheets("PRCalculator").Range("T14").Value
Range("j13").Value = Sheets("PRCalculator").Range("x14").Value

  Sheets("PRCalculator").Visible = xlVeryHiddne


End Sub
Private Sub Button2_Click()



' to check the expiration before starting
'

If Sheets("Setup").Range("AH6") = False Then



Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ChaoNing.Com to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, ask DanieChao@hotmail.com"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If



'normal code start


If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub

End If

If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")

Exit Sub

End If



'Button2 to process and post Rayroll paycheck and records


Range("g12", "g20").Value = Range("P20", "P28").Value


Sheets("Selection1").Visible = True


 If Range("q14") <> 1 Then
MsgBox ("The Gross Wage Must be in Value Amount!")
Exit Sub
End If


If Range("o4") = 0 Then
MsgBox ("The Date is Empty!")
Exit Sub
End If


If Range("e21") > 2080 Then
MsgBox ("The Time/Hour is too large! Please Check the Timecard!")
Exit Sub
End If



If Range("o3") = 0 Then
MsgBox ("The Date Must Be in Format ""mm/dd/yyyy""!")
Exit Sub
End If

If Range("o7") = 0 Then
MsgBox "The Date Must Be within the Selected Payroll Year " & Sheets("Setup").Range("AA54").Value
Exit Sub
End If

If Range("o11") = False Then
MsgBox ("The Date Must Be within the Payroll Year! Please Check the Date or Reset the PR Year")
Exit Sub
End If


If Range("o5") = 0 Then
MsgBox ("The Gross Amount Must be in Number and Greater than Zero!")
Exit Sub
End If


If Range("g5") <= 0.99 Then
MsgBox ("The Gross Amount Must be in Number and Greater than $1.00!")
Exit Sub
End If

If Sheets("PRCalculator").Range("x14") < 0 Then
MsgBox ("The Net Pay Amount is below Zero! Unable to Process")
Exit Sub
End If


If Range("g5") > 10000000 Then
MsgBox ("The Gross Amount is too large! Unable to Process!")
Exit Sub
End If

If Range("o6") = 0 Then
MsgBox ("Please Enter a Valid Check Number!")
Exit Sub
End If

If Sheets("PRCalculator").Range("x14").Value <= 0 Then
MsgBox ("The NetPay Amount is Negative! Unable to Process!")
Exit Sub
End If

   Application.ScreenUpdating = False

Sheets("TimeCard").Range("AA2") = 1
Sheets("Setup").Range("AA51") = Sheets("Setup").Range("AA51") + 1

Dim Emunber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String

Emunber = Cells(3, "s").Value
prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value


  
    Sheets("PPRChck").Visible = True
    Sheets("PPRChck").Select
        
        Range("Z32:AF41").Select
    Selection.Copy
    Range("Z43").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Add Key:=Range("Z44:Z52" _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    With ActiveWorkbook.Worksheets("PPRChck").Sort
        .SetRange Range("Z43:AF52")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Range("R33", "R41").Value = Range("ac44", "ac52").Value
    Range("t33", "v41").Value = Range("ad44", "af52").Value
    
    
    
    
    
    Sheets("PPRChck").Select
        
    Range("Printprcheck").Select
    Selection.Copy
    Range("B2").Select
                 
                 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
    
    Application.CutCopyMode = False
        

'to save the printed check for reprint

Sheets("PPRChck").Range("bb3", "dp500").ClearContents

     Sheets("PPRChck").Select
Range("BB1").Select
 
    Selection.End(xlDown).Select
 
Range(Selection.Offset(1, 0), Selection.Offset(1, 66)).Value = Sheets("PPRChck").Range("BB2", "DP2").Value
        
 'to adjust the reprint check box in timecard
 

 
 Sheets("TimeCard").Visible = True
  Sheets("TimeCard").Select
  Sheets("PPRChck").Range("AZ1") = 0
   Sheets("PPRChck").Range("BA1") = 1
   
   ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

    ActiveSheet.Shapes("Drop Down 3").Select
    With Selection
        .ListFillRange = Sheets("PPRChck").Range("BA2").Value
        .LinkedCell = "PPRChck!$AZ$1"
        .DropDownLines = 1
        .Display3DShading = False
    End With
    
Range("S12").Select

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
     
     
     
    Sheets("TimeCard").Visible = False
       
        
        
        
        

 'to update the vacation balance
 
 
 Sheets("Selection1").Visible = True

Sheets("Selection1").Select

    Dim SRecord1 As String
    SRecord1 = Range("i4").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value



Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select
 
 Selection.Offset(0, 12).Select

    ActiveCell.Value = ActiveCell.Value + Sheets("Entry1").Cells(32, "q")
  
 Sheets("Selection1").Select
 
Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Dbase1").Visible = False


' to open record file

  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
    
   Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
        
    Windows(prfile2).Activate
            
   ' check if the maximum line is available
            
      If Sheets("MRegister").Range("AK1").Value >= 3645 Then
    
    MsgBox ("Reached Maximum Payroll this Year; Please Close the Payroll Year and Rerun!")
    
         ActiveWorkbook.Saved = True
         ActiveWorkbook.Close
    ThisWorkbook.Activate
    Sheets("Entry1").Visible = False
    Sheets("Entry1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Sheets("PPRChck").Visible = False
    Sheets("PPRChck").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Sheets("Selection1").Select
    Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Exit Sub
    
    End If
        
            
        Sheets(Emunber).Select

' to insert a line

    Range("A3").Select
    Selection.End(xlDown).Select
      
    Selection.Offset(1, 0).Select
       Selection.EntireRow.Insert , CopyOrigin:=xlFormatFromLeftOrAbove
       
' to copy the record
    
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    Windows(prfile1).Activate
    
      Sheets("PRCalculator").Visible = True
      
    
       Sheets("PRCalculator").Select
       Range("A17", "AW17").Select
       Selection.Copy
       
    'Windows("Payroll Record.xlsm").Activate
    Windows(prfile2).Activate
    Sheets(Emunber).Select
    Range("A3").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        
  ' to copy the register
     
     
    'Windows("ExBook.xlsm").Activate
     'Windows(Sheets("Setup2").Range("b10").Value).Activate
       
       Windows(prfile1).Activate
       Sheets("PRCalculator").Select

    
' to update the register

       Range("A14", "Ay14").Select
       Selection.Copy
       
    'Windows("Payroll Record.xlsm").Activate
    Windows(prfile2).Activate
    
    Sheets("MRegister").Select
    Range("C1").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
         ' to empty the memory
    
    Application.CutCopyMode = False
       
    'To update the control number
    
     'Windows(Sheets("Setup2").Range("b10").Value).Activate
     Windows(prfile1).Activate
        Sheets("PRCalculator").Range("AG16").Value = Sheets("PRCalculator").Range("AE17").Value


   
    'to save and close the Record file
    'Windows("Payroll Record.xlsm").Activate
    
    Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close
    
    'Windows("Payroll Time Card.xlsm").Activate
    
    'Windows(Sheets("Setup").Range("b10").Value).Activate
    Windows(prfile1).Activate
    
    'Sheets("Entry1").Range("e4", "e13").ClearContents
    
    
        
    
    Sheets("Entry1").Visible = False
    
    Sheets("PRCalculator").Visible = False
    
    Sheets("Selection1").Select
    Range("i13").Select
    ActiveWorkbook.Save

'Ask if want to print the pr check

    Dim Answer2 As String
    Answer2 = MsgBox("Do you want to print a Payroll check?", vbYesNo, "Alter")
    If Answer2 = vbYes Then
      
    
    'To Print PR check

If Sheets("Selection1").Range("AD1") = 1 Then
'Sheets("PPRChck").Visible = True
'Sheets("PPRChck").Select

        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If
    
Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
     
    Sheets("Selection1").Select
    Range("A1").Select
        
        
    Sheets("QBCK").Visible = False
    Sheets("QKNCK").Visible = False
    Sheets("PTCK").Visible = False
    Sheets("GPCK").Visible = False
    Sheets("GPCK").Visible = False
    Sheets("SBTCK").Visible = False
    Sheets("PFWCK").Visible = False
    Sheets("CustCheck").Visible = False
    Sheets("OTHCK").Visible = False
    Sheets("PPRChck").Visible = False
   
End If

' Ask again if want to reprint the check

    Dim Answer3 As String
    Answer3 = MsgBox("PR Processed! Do You Need to Reprint the Check?", vbYesNo, "Alert")
    If Answer3 = vbYes Then
   
    
    If Sheets("Selection1").Range("AD1") = 1 Then

'Sheets("PPRChck").Visible = True
'Sheets("PPRChck").Select

        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If


Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
     
    Sheets("Selection1").Select
    Range("A1").Select
       Sheets("CustCheck").Visible = False
       Sheets("PPRChck").Visible = False
    
     
      
    End If

    Sheets("QBCK").Visible = False
    Sheets("QKNCK").Visible = False
    Sheets("PTCK").Visible = False
    Sheets("GPCK").Visible = False
    Sheets("GPCK").Visible = False
    Sheets("SBTCK").Visible = False
    Sheets("PFWCK").Visible = False
    Sheets("CustCheck").Visible = False
    Sheets("OTHCK").Visible = False
    Sheets("PPRChck").Visible = False
  
Sheets("Entry1").Range("g6").Value = Sheets("Entry1").Range("g6") + 1

    Application.ScreenUpdating = True
    
    


End Sub

Private Sub JournalEntry()

Application.ScreenUpdating = False

Sheets("JournalEntry").Visible = True
Sheets("PRRegister").Visible = True
Sheets("PRRegister").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String

    
 prfile1 = Worksheets("setup").Range("B10").Value
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
        
  'to open the record file
  
Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value

  'copy register
   
Sheets("MRegister").Select
Range("H3651", "AC3667").Select
Selection.Copy
  
 ThisWorkbook.Activate
 'Sheets("PRRegister").Range("B2", "W18").Value = Windows(prfile2).Sheets("MRegister").Range("H3651", "AC3667").Value

Sheets("PRRegister").Select
Range("B2").Select

Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False

Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

'ActiveSheet.Visible = False
Sheets("JournalEntry").Select
Range("A1").Select
Sheets("PRRegister").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("PRRegister").Visible = False
Sheets("Selection1").Visible = False
Application.ScreenUpdating = True


End Sub


Private Sub Comsetup()
Application.ScreenUpdating = False
Sheets("Setup").Visible = True
ActiveSheet.Visible = False
Sheets("Setup").Select
Range("AA55") = Range("AB55").Value
Range("A1").Select
Application.ScreenUpdating = True

End Sub

Private Sub Taxrate()
Application.ScreenUpdating = False
Sheets("PRRate").Visible = True
ActiveSheet.Visible = False
Sheets("PRRate").Select
Range("A1").Select
Application.ScreenUpdating = True

End Sub


Attribute VB_Name = "Module40"
Private Sub ReturnRecord()


Sheets("ViewRecord").Visible = True
Sheets("ViewRecord").Select
Sheets("Earnings").Visible = xlVeryHidden
Range("a1").Select

End Sub

Attribute VB_Name = "Module41"
Private Sub Print941()

If Range("K7") < 13 Or Range("K7") > 16 Then

MsgBox ("Please Select a Quarter of the Year for 941 Information")

Exit Sub

End If


Application.ScreenUpdating = False

' set the tax liability selection in the same period

Cells(25, "K").Value = Cells(7, "K").Value

' set the period as the customized report period
Sheets("Setup").Range("AB74") = Sheets("JournalEntry").Range("K30").Value
Sheets("Setup").Range("AB75") = Sheets("JournalEntry").Range("K31").Value

Sheets("Qreport").Visible = True
Sheets("Qreport").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Reports").Unprotect Password:=Sheets("Setup").Range("AA8").Value

' set processing display
Sheets("Processing").Visible = True
Sheets("Processing").Range("BB1") = 5
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("Selection1").Range("ab2").Value
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False
'Sheets("Setup").Range("AB74:AB75").Value = Sheets("Selection1").Range("D8:D9").Value

Sheets("Qreport").Range("A3:AZ3660").ClearContents
Sheets("Reports").Range("J9:BJ3660").ClearContents

Dim enumber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim totalnumber As Integer
Dim currentnumber As Integer

Dim firstdate As Single
Dim lastdate As Single

'Dim currentquarter As Integer

firstdate = Sheets("Setup").Range("AB74").Value
lastdate = Sheets("Setup").Range("AB75").Value

prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
totalnumber = Sheets("Selection1").Cells(2, "AB").Value
currentnumber = 1
'currentquarter = Sheets("JournalEntry").Range("H7").Value - 13

   
  'to open the record file
  
  'Workbooks.Open Sheets("Setup").Range("b6").Value & Sheets("Setup").Range("b7").Value
   
  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
 
 Windows(prfile2).Activate
 
  Sheets("Setup2").Range("B11") = firstdate
 Sheets("Setup2").Range("B12") = lastdate
    
      Do Until totalnumber = 0
     
      'select data to copy to report sheet
   
   ThisWorkbook.Activate
   
   enumber = Sheets("DBase1").Range("A1").Offset(currentnumber, 0).Value
      
   
    Windows(prfile2).Activate
          
    Sheets(enumber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
  
  'If Selection.Offset(currentquarter, 0).Value = 0 Then
  
   If Selection.Offset(5, 0).Value = 0 Then
  currentnumber = currentnumber + 1
  totalnumber = totalnumber - 1
  
  Else
    
Range(Selection.Offset(5, 0), Selection.Offset(5, 44)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    
   ThisWorkbook.Activate
        
    Sheets("Qreport").Select
    Range("D1").Select
     Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
        
       
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Application.CutCopyMode = False


    Range("D1").Select
     Selection.End(xlDown).Select
    
Selection.Offset(0, -1) = Sheets("DBase1").Range("A1").Offset(currentnumber, 8)
Selection.Offset(0, -2) = Sheets("DBase1").Range("A1").Offset(currentnumber, 2)
Selection.Offset(0, -3) = Sheets("DBase1").Range("A1").Offset(currentnumber, 0)


  currentnumber = currentnumber + 1
  totalnumber = totalnumber - 1

End If

'to display processing

 ThisWorkbook.Activate
Sheets("Processing").Range("Ba1") = currentnumber - 1
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False

Loop


Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate
Sheets("941").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("941").Range("L11") = Sheets("Qreport").Range("A1").Value

Sheets("941").Visible = True
Sheets("941").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
Sheets("JournalEntry").Select
Sheets("941").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("941").Visible = False

Sheets("Qreport").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Reports").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Qreport").Visible = False
Sheets("Processing").Visible = False
Application.ScreenUpdating = True


End Sub
Private Sub Print940()

Application.ScreenUpdating = False

' set the period in a full year
Cells(7, "K").Value = 17
Cells(25, "K").Value = 17


Sheets("940").Visible = True
Sheets("940").Select
ActiveWindow.SelectedSheets.PrintOut Copies:=1
Sheets("JournalEntry").Select
Sheets("940").Visible = False

Application.ScreenUpdating = True



End Sub


Attribute VB_Name = "Module42"
Private Sub Payinbatch()

Application.ScreenUpdating = False

If Sheets("Setup").Range("AG2") = False Then

Sheets("TimeCard").Range("AC6", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "DC100").ClearContents


End If



'To test the expiration before starts the program

If Sheets("Setup").Range("AH6") = False Then



Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ChaoNing.Com to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, ask DanieChao@hotmail.com"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If



'normal code start

Sheets("WeekTime").Range("B2", "C201").ClearContents
Range(Sheets("WeekTime").Range("C2"), Sheets("WeekTime").Range("C2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Range(Sheets("DBase1").Range("A2"), Sheets("DBase1").Range("A2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value
Range(Sheets("WeekTime").Range("B2"), Sheets("WeekTime").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Range(Sheets("DBase1").Range("B2"), Sheets("DBase1").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value

'Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value



Sheets("Selection1").Visible = True


'Sheets("TimeCard").Range("AC6", "AC10").ClearContents
'Sheets("WeekTime").Range("s1", "dc201").ClearContents


Sheets("Selection1").Select
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("CA2", "CA500").ClearContents

Sheets("TimeCard").Visible = True
Sheets("DBase1").Visible = True
Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value


If Sheets("Selection1").Range("AB2").Value > 200 Then

MsgBox "You have total " & (Sheets("Selection1").Range("AB2").Value) & " employees in database. The maximum in batch is 200. You may select individual to pay the other employees"

End If


Range("A2").Select
Range(Selection, Selection.Offset(Sheets("Selection1").Range("AD2").Value - 1, 0)).Select
Selection.Copy
Sheets("Selection1").Select
Range("CA2").Select

 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'ActiveSheet.Paste
 Application.CutCopyMode = False
 

Sheets("TimeCard").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("S6") = Date
Range("S7") = Sheets("Entry1").Range("G5")

Range("B2", "c204").ClearContents
Range("k2", "O204").ClearContents

'transfer time to selection page

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

Range("B2", "C204") = Sheets("Selection1").Range("CI2", "CJ204").Value
Range("K2", "O204") = Sheets("Selection1").Range("CK2", "CO204").Value

   
ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("DBase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("DBase1").Visible = False

Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Visible = False

Application.ScreenUpdating = True
Range("A1").Select

Range("K2").Select



End Sub


Attribute VB_Name = "Module43"
Private Sub ProBatch()

ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If



Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^%{Del}", ""

'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value
Sheets("Entry1").Range("P44:P45").ClearContents
Sheets("Entry1").Range("g7:g8").ClearContents


'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False



' To Check expiration before starting

If Sheets("Setup").Range("AH6") = False Then



Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, Visit www.ExcelPayroll.Org"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If




 'check if errors in setup

If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub

End If

If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")

Exit Sub

End If


'normal code start


Range("AF1").ClearContents

If Range("AE1") = True Then

MsgBox ("Error, All Time Hour Must be in Value!")

Exit Sub

End If


If Range("AE3") = True Then

MsgBox ("Hour Error! Time Must be Greater Than 0.1 Hour for Each Employee!")

Exit Sub

End If


If Range("AF4") = True Then

MsgBox ("Error! Hour Value Must be Greater Than 0.1 for each Category!")

Exit Sub

End If


If Range("AE2") > 224 Then

MsgBox ("One or More Payees' Time Over 224 Hours! Please Check the Timecard!")

Exit Sub

End If




If Range("AB1") = False Then

MsgBox ("The Check Number Must be in Value, Please Re-enter")

Exit Sub
End If


If Range("AC2") = False Then

MsgBox ("The Date Must be in Current Payroll Year ") & Sheets("Setup").Cells(54, "AA") & "!"

Exit Sub
End If

'check if the pr year selected is the same as the tax rate year

 If Sheets("Setup").Range("aa46") <> True Then

    Dim Answer4 As String
    Answer4 = MsgBox("Payroll Year Does Not Match The Tax Table Year" & vbCrLf & _
    "Do you wish to continue?", vbYesNo, "Use the old Tax Rates?")
    If Answer4 = vbNo Then
    Exit Sub
    End If
    End If




If Sheets("Timecard").Range("CS2") > 0 Then

  Dim AnswerYN12 As String
    
   AnswerYN12 = MsgBox("One or More Employees' Vacation Balance Become Negative", vbYesNo, "Continue Pay Vacation Hour?")
    If AnswerYN12 = vbNo Then
        Exit Sub
    End If

End If




   Dim AnswerYN2 As String
    
   AnswerYN2 = MsgBox("Have you put checks in the printer?", vbYesNo, "Are You Ready?")
    If AnswerYN2 = vbNo Then
        Exit Sub
    End If



Sheets("Setup").Range("AA50") = Sheets("Setup").Range("AA50") + 1

' to indicate if this is a check or pre-print statement when aa2=2
Sheets("TimeCard").Range("AA2") = 1


'to display processing
Sheets("Processing").Range("BB1") = 1
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("Selection1").Range("az1").Value
Sheets("Processing").Visible = True
Sheets("Processing").Select
Application.ScreenUpdating = False





Application.ScreenUpdating = False
Sheets("Selection1").Visible = True
'Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("TimeCard").Visible = True
Sheets("TempBatch").Visible = True

Sheets("PPRChck").Range("bb3", "dp500").ClearContents
Sheets("TempBatch").Range("A3", "AY500").ClearContents

Sheets("Selection1").Range("BA2", "BO201").Value = Sheets("TimeCard").Range("A2", "O201").Value

Sheets("Entry1").Range("BG1").Value = Sheets("TimeCard").Range("s6").Value
Sheets("Entry1").Range("BF1").Value = Sheets("TimeCard").Range("s7").Value

Sheets("Entry1").Range("g4").Value = Sheets("TimeCard").Range("s6").Value
Sheets("Entry1").Range("g5").Value = Sheets("TimeCard").Range("s7").Value


Sheets("Entry1").Range("BF1").Copy Destination:=Sheets("Entry1").Range("G5")
Application.CutCopyMode = False


Sheets("Selection1").Select

Application.Run ("BatchPrinting")

Application.EnableCancelKey = xlDisabled

If Sheets("TimeCard").Range("AF1") >= 3640 Then

Sheets("TimeCard").Visible = True
Sheets("TimeCard").Select
Sheets("Processing").Visible = xlVeryHidden
Application.ScreenUpdating = True

Exit Sub

End If



MsgBox "Payroll " & (Sheets("TimeCard").Range("AD1")) & " Check(s) Printed!"

  If Sheets("TimeCard").Range("AD1") <= 0 Then
  
  Sheets("TempBatch").Visible = xlVeryHidden
Sheets("TimeCard").Visible = True
Sheets("TimeCard").Select
Sheets("Processing").Visible = xlVeryHidden
Application.ScreenUpdating = True

  Exit Sub
       
  End If


' to sum the total for TempBatch Report

Sheets("TempBatch").Select

Range("b2").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    ActiveCell.Formula = "Batch Total"


Range("F3", "ay" & Sheets("TimeCard").Cells(1, "ad").Value + 2).Select

    Dim source As Range
    Dim iCol As Long
    Dim nCol As Long
    Dim nRow As Long
 
    Set source = Selection
 
    nCol = source.Columns.Count
    nRow = source.Rows.Count
    For iCol = 1 To nCol
        With source.Columns(iCol).Rows(nRow).Offset(1, 0)
            .FormulaR1C1 = "=SUM(R[-" & nRow & "]C:R[-1]C)"
           ' .Font.Bold = True
        End With
    Next iCol


     

Range("A1").Select



' to Display check printed message and to update selection of reprint check box

Sheets("TimeCard").Visible = True
Sheets("TimeCard").Select

Sheets("Selection1").Visible = xlVeryHidden


ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("PPRChck").Range("AZ1") = 0

    ActiveSheet.Shapes("Drop Down 3").Select
    With Selection
        .ListFillRange = Sheets("PPRChck").Range("BA2").Value
        .LinkedCell = "PPRChck!$AZ$1"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    
Range("S12").Select

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

 Sheets("PPRChck").Visible = xlVeryHidden
 Sheets("CustCheck").Visible = xlVeryHidden
 Sheets("TempBatch").Visible = xlVeryHidden
 Sheets("Selection1").Range("V3") = Sheets("Selection1").Range("V2").Value
 
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

 Sheets("TimeCard").Range("S7") = Sheets("Entry1").Range("G5")
 
Sheets("Processing").Visible = xlVeryHidden
 
 
Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^%{Del}"

End Sub

Attribute VB_Name = "Module44"
Private Sub Selection1_ListBox1_Change()
Sheets("Selection1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

   
Sheets("Selection1").Range("V3") = Sheets("Selection1").Range("V2").Value

Range("a1").Select
'Range("j15").Select
' to protect the sheet
    
ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
 
End Sub

Attribute VB_Name = "Module45"
Private Sub BatchPrinting()
ActiveWindow.DisplayWorkbookTabs = False
'
' Start to Print checks

Application.ScreenUpdating = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""

Sheets("Selection1").Select

' *** will insert: if section1 az1=0, then no payroll check to be printed. End

If Sheets("Selection1").Range("AZ1") = 0 Then

MsgBox ("No Record Found! Please Add an Employee")

Exit Sub

End If



Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim printedchecks As Integer


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
printedchecks = 0


'To open the Payroll Record

 Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value


' check if the payroll line is available

Windows(prfile2).Activate

    If Sheets("MRegister").Range("AK1").Value >= 3645 Then
    
    Sheets("MRegister").Range("AK1").Copy
    ThisWorkbook.Activate
    Sheets("TimeCard").Select
    Range("AF1").Select
        
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    
    
    MsgBox ("Reached Maximum Payroll this Year; Please Close the Payroll Year and Rerun!")
    
     Windows(prfile2).Activate
    
         ActiveWorkbook.Saved = True
         ActiveWorkbook.Close
    ThisWorkbook.Activate
    Sheets("TimeCard").Visible = xlVeryHidden
    Sheets("Selection1").Select
       
       
    Exit Sub
    
    
    End If




ThisWorkbook.Activate
Sheets("Selection1").Select
Sheets("Selection1").Range("a1").Select


Dim Checkcount As Integer
Dim Emunber As String


Checkcount = 2



Do Until Sheets("Selection1").Cells(Checkcount, "BC").Value = 0

Sheets("Selection1").Select

Sheets("Selection1").Range("V3") = Sheets("Selection1").Cells(Checkcount, "BC").Value


Emunber = Sheets("Selection1").Cells(3, "V").Value


Columns("BC").Select

Selection.Find(What:=Emunber, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

Range("Az2") = Selection.Offset(0, 8).Value
Range("Az3") = Selection.Offset(0, 9).Value
Range("Az4") = Selection.Offset(0, 10).Value
Range("Az5") = Selection.Offset(0, 11).Value
Range("Az6") = Selection.Offset(0, 12).Value


' To make sure the net pay is not negative

If Sheets("Selection1").Range("Az8").Value > 0 Then

   
    Sheets("Entry1").Visible = True
    Sheets("Entry1").Select
    
'to get data ready

    Sheets("Entry1").Range("e12", "g20").ClearContents
    Sheets("Entry1").Range("j4", "j13").ClearContents
    Sheets("Entry1").Range("g9").ClearContents
    Sheets("Entry1").Range("q23", "q31").ClearContents
    Sheets("Entry1").Range("ba1:bc9").ClearContents
     
    Sheets("Entry1").Range("b4").Value = Sheets("Selection1").Range("I4").Value
    Sheets("Entry1").Range("b5").Value = Sheets("Selection1").Range("I6").Value
    Sheets("Entry1").Range("b6:b9").Value = Sheets("Selection1").Range("I7:I10").Value
  
    
    'copy date and check number
    Sheets("Entry1").Range("BF1") = Sheets("Entry1").Range("g5").Value
    Sheets("Entry1").Range("BG1") = Sheets("Entry1").Range("G4").Value
    
    
    'copy hours for prepare calculation
    Sheets("Entry1").Range("ba1").Value = Sheets("Selection1").Range("Az2").Value
    Sheets("Entry1").Range("ba2").Value = Sheets("Selection1").Range("Az3").Value
    Sheets("Entry1").Range("ba3").Value = Sheets("Selection1").Range("Az4").Value
    Sheets("Entry1").Range("ba4").Value = Sheets("Selection1").Range("Az5").Value
   Sheets("Entry1").Range("ba5").Value = Sheets("Selection1").Range("Az6").Value


   'copy earning/hour type headings
   Sheets("Entry1").Range("Q33:Q41").Value = Sheets("Entry1").Range("P33:P41").Value
   'copy index code for earning calculation; these codes were for selection codes
   'will be coded in column "t" again
   
'copy the code for calculation
Sheets("Entry1").Range("q23", "q27").Value = Sheets("Entry1").Range("t23", "t27").Value

'copy rate

Sheets("Entry1").Range("BE1") = Sheets("selection1").Range("v17").Value

Range("Entry1!BE1").Copy Destination:=Range("Entry1!G9")
    Application.CutCopyMode = False


'copy earning amount Button2/to process and post Rayroll paycheck and records
'****
Sheets("Entry1").Range("bc1", "bc9").Value = Sheets("Entry1").Range("P20", "P28").Value

'****
   
  
    ' copy earning
    
   'copy back to reset format and to show data
   Sheets("Entry1").Range("BA1:BC9").Copy Destination:=Sheets("Entry1").Range("E12:G20")
    Application.CutCopyMode = False

'No need for batch print

  
   
    Windows(prfile2).Activate
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    
Range(Selection.Offset(4, 0), Selection.Offset(4, 25)).Select
Selection.Copy
    
        
      
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S1").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Application.CutCopyMode = False

'copy last payment info

       
    Windows(prfile2).Activate
    
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
   
    
Range(Selection.Offset(0, -3), Selection.Offset(0, 26)).Select
Selection.Copy
    
   
   
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S2").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Application.CutCopyMode = False
  
'return to Entry1 sheet
       
Windows(prfile1).Activate

Sheets("Entry1").Select
Sheets("Entry1").Range("O2").Value = Sheets("Setup").Range("Y1").Value



' To make sure the net pay is not negative


    If Sheets("Selection1").Range("AY8").Value > 0 Then


Sheets("Selection1").Visible = True



   Application.ScreenUpdating = False

  
    Sheets("PPRChck").Visible = True
    Sheets("PPRChck").Select
        
        Range("Z32:AF41").Select
    Selection.Copy
    Range("Z43").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Add Key:=Range("Z44:Z52" _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    With ActiveWorkbook.Worksheets("PPRChck").Sort
        .SetRange Range("Z43:AF52")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Range("R33", "R41").Value = Range("ac44", "ac52").Value
    Range("t33", "v41").Value = Range("ad44", "af52").Value
    
        
    Sheets("PPRChck").Select
        
    Range("Printprcheck").Select
    Selection.Copy
    Range("B2").Select
                 
                 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False

    
 'to update the vacation balance
 
 
 Sheets("Selection1").Visible = True

Sheets("Selection1").Select

    Dim SRecord1 As String
    SRecord1 = Sheets("Selection1").Range("i4").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select
 
 Selection.Offset(0, 12).Select

    ActiveCell.Value = ActiveCell.Value + Sheets("Entry1").Cells(32, "q")
  
 Sheets("Selection1").Select

Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Dbase1").Visible = xlVeryHidden



' to Update the Payroll Record

       
    Windows(prfile2).Activate
            
        Sheets(Emunber).Select

' to insert a line

    Range("A3").Select
    Selection.End(xlDown).Select
      
    Selection.Offset(1, 0).Select
       Selection.EntireRow.Insert , CopyOrigin:=xlFormatFromLeftOrAbove
       
' to copy the record
    
    Windows(prfile1).Activate

       Sheets("PRCalculator").Range("A17", "AW17").Copy

    Windows(prfile2).Activate
    Sheets(Emunber).Select
    Range("A3").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        
  ' to copy the register
     
            
       Windows(prfile1).Activate
  
    
' to update the register


       Sheets("PRCalculator").Range("A14", "Ay14").Copy

    Windows(prfile2).Activate
    
    Sheets("MRegister").Select
    Range("C1").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
         ' to empty the memory
    
    Application.CutCopyMode = False
       
       
    ' to update the TempBatch Sheet

ThisWorkbook.Activate

    Sheets("TempBatch").Select
    Range("A1").Select
    Selection.End(xlDown).Select

Range(Selection.Offset(1, 0), Selection.Offset(1, 50)) = Sheets("PRCalculator").Range("A14", "Ay14").Value
         
       
    'To update the control number
 
        Sheets("PRCalculator").Range("AG16").Value = Sheets("PRCalculator").Range("AE17").Value

printedchecks = printedchecks + 1
Checkcount = Checkcount + 1

' to copy the printed check info

Sheets("PPRChck").Select
Range("BB1").Select
 
    Selection.End(xlDown).Select
 
Range(Selection.Offset(1, 0), Selection.Offset(1, 66)).Value = Range("BB2", "DP2").Value


Sheets("Entry1").Range("g5") = Sheets("Entry1").Range("g5").Value + 1
Sheets("Entry1").Range("BF1") = Sheets("Entry1").Range("g5").Value

 Sheets("Selection1").Select

'To Print PR check


If Sheets("Selection1").Range("AD1") = 1 Then

        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If


Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
   
       Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHidden
    Sheets("PPRChck").Visible = xlVeryHidden

Else

Windows(prfile1).Activate
Checkcount = Checkcount + 1

End If

Else

Windows(prfile1).Activate
Checkcount = Checkcount + 1

End If



'to display processing

Sheets("Processing").Range("Ba1") = Checkcount
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False


Loop

   'Windows("Payroll Record.xlsm").Activate
    
    Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close
    
         
    Windows(prfile1).Activate
    
        
    Sheets("Entry1").Visible = xlVeryHidden
    

    Range("i13").Select
    ActiveWorkbook.Save


Sheets("PPRChck").Range("BA1").Value = printedchecks
  
  If printedchecks = 0 Then
  
  MsgBox ("No Payroll, please enter Timesheet/Hours to start!")
 Sheets("Processing").Visible = xlVeryHidden
 Sheets("Selection1").Visible = xlVeryHidden

  Exit Sub
  End If
    
  Sheets("PPRChck").Visible = xlVeryHidden
Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"

End Sub


Attribute VB_Name = "Module48"
Private Sub DropDown3_Change()

Application.ScreenUpdating = False

Sheets("PPRChck").Visible = True

Sheets("PPRChck").Select

Range("j5") = Range("bc2").Offset(Range("AZ1").Value, 0).Value

Sheets("PPRChck").Range("j6") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, -1).Value

Sheets("PPRChck").Range("e21") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 1).Value
Sheets("PPRChck").Range("j12") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 2).Value

Sheets("PPRChck").Range("e9") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 3).Value
Sheets("PPRChck").Range("e11") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 4).Value
Sheets("PPRChck").Range("e12") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 5).Value
Sheets("PPRChck").Range("e13") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 6).Value
Sheets("PPRChck").Range("e24") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 7).Value
Sheets("PPRChck").Range("e25") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 8).Value
Sheets("PPRChck").Range("e26") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 9).Value
Sheets("PPRChck").Range("e27") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 10).Value
Sheets("PPRChck").Range("e28") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 11).Value
Sheets("PPRChck").Range("e29") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 12).Value

Sheets("PPRChck").Range("f24") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 13).Value
Sheets("PPRChck").Range("f25") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 14).Value
Sheets("PPRChck").Range("f26") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 15).Value
Sheets("PPRChck").Range("f27") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 16).Value
Sheets("PPRChck").Range("f28") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 17).Value
Sheets("PPRChck").Range("f29") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 18).Value

Sheets("PPRChck").Range("h24") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 19).Value
Sheets("PPRChck").Range("h25") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 20).Value
Sheets("PPRChck").Range("h26") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 21).Value
Sheets("PPRChck").Range("h27") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 22).Value

Sheets("PPRChck").Range("i24") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 23).Value
Sheets("PPRChck").Range("i25") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 24).Value
Sheets("PPRChck").Range("i26") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 25).Value
Sheets("PPRChck").Range("i27") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 26).Value


Sheets("PPRChck").Range("c33") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 27).Value
Sheets("PPRChck").Range("c34") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 28).Value
Sheets("PPRChck").Range("c35") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 29).Value
Sheets("PPRChck").Range("c36") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 30).Value
Sheets("PPRChck").Range("c37") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 31).Value
Sheets("PPRChck").Range("c38") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 32).Value
Sheets("PPRChck").Range("c39") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 33).Value
Sheets("PPRChck").Range("c40") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 34).Value
Sheets("PPRChck").Range("c41") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 35).Value


Sheets("PPRChck").Range("e33") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 36).Value
Sheets("PPRChck").Range("e34") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 37).Value
Sheets("PPRChck").Range("e35") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 38).Value
Sheets("PPRChck").Range("e36") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 39).Value
Sheets("PPRChck").Range("e37") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 40).Value
Sheets("PPRChck").Range("e38") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 41).Value
Sheets("PPRChck").Range("e39") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 42).Value
Sheets("PPRChck").Range("e40") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 43).Value
Sheets("PPRChck").Range("e41") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 44).Value


Sheets("PPRChck").Range("f33") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 45).Value
Sheets("PPRChck").Range("f34") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 46).Value
Sheets("PPRChck").Range("f35") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 47).Value
Sheets("PPRChck").Range("f36") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 48).Value
Sheets("PPRChck").Range("f37") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 49).Value
Sheets("PPRChck").Range("f38") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 50).Value
Sheets("PPRChck").Range("f39") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 51).Value
Sheets("PPRChck").Range("f40") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 52).Value
Sheets("PPRChck").Range("f41") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 53).Value

Sheets("PPRChck").Range("g33") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 54).Value
Sheets("PPRChck").Range("g34") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 55).Value
Sheets("PPRChck").Range("g35") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 56).Value
Sheets("PPRChck").Range("g36") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 57).Value
Sheets("PPRChck").Range("g37") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 58).Value
Sheets("PPRChck").Range("g38") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 59).Value
Sheets("PPRChck").Range("g39") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 60).Value
Sheets("PPRChck").Range("g40") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 61).Value
Sheets("PPRChck").Range("g41") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 62).Value

Sheets("PPRChck").Range("g21") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 63).Value
Sheets("PPRChck").Range("i33") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 64).Value
Sheets("PPRChck").Range("i34") = Sheets("PPRChck").Range("bc2").Offset(Sheets("PPRChck").Range("AZ1").Value, 65).Value

Range("I35") = Range("i33") + Range("i34")
Range("e30") = Range("e25") + Range("e26") + Range("e27") + Range("e28") + Range("e29")
Range("f30") = Range("f25") + Range("f26") + Range("f27") + Range("f28") + Range("f29")

Range("h28") = Range("h24") + Range("h25") + Range("h26") + Range("h27")
Range("i28") = Range("i24") + Range("i25") + Range("i26") + Range("i27")


Range("h29") = Range("h28") + Range("e30")
Range("i29") = Range("i28") + Range("f30")

Range("h30") = Range("e24") - Range("h29")
Range("i30") = Range("f24") - Range("i29")

Range("e42") = Range("e33") + Range("e34") + Range("e35") + Range("e36") + Range("e37") + Range("e38") + Range("e39") + Range("e40") + Range("e41")
Range("g42") = Range("g33") + Range("g34") + Range("g35") + Range("g36") + Range("g37") + Range("g38") + Range("g39") + Range("g40") + Range("g41")

Sheets("PPRChck").Visible = False
Sheets("TimeCard").Select

'To Print PR check

If Sheets("Selection1").Range("AD1") = 1 Then

'Sheets("PPRChck").Visible = True
'Sheets("PPRChck").Select

        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If


Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
           
   Dim AnswerYN5 As String
    
    
    If Sheets("TimeCard").Range("AA2") = 1 Then
    
    
   AnswerYN5 = MsgBox("Are You Sure to Reprint This Check?", vbYesNo, "A Blank Check in Printer?")
     
   Else
   
    AnswerYN5 = MsgBox("Print Non-post Statement for this Transaction?", vbYesNo, "Not a Check, Plain Paper Only")
    
    End If

    
    If AnswerYN5 = vbNo Then
       
        'If Sheets("PPRChck").Range("BA1") = 1 Then
   
   Sheets("PPRChck").Range("AZ1") = 0
   
   'End If
        
       Sheets("TimeCard").Visible = True

       Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHidden
    Sheets("PPRChck").Visible = xlVeryHidden
     
        Sheets("TimeCard").Select
        Exit Sub
    End If
                
           
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
   
   If Sheets("PPRChck").Range("BA1") = 1 Then
   
   Sheets("PPRChck").Range("AZ1") = 0
   
   End If
   
    Sheets("TimeCard").Visible = True
   
       Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHiddne
    Sheets("PPRChck").Visible = xlVeryHidden
    
        Sheets("TimeCard").Select

Application.ScreenUpdating = True



End Sub

Attribute VB_Name = "Module49"
Private Sub BatchReport()
ActiveWindow.DisplayWorkbookTabs = False

'check if program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If



If Range("AD1") = 0 Then
MsgBox ("There is no batch payroll check printed!")
Exit Sub
End If
Sheets("TempBatch").Visible = True
Sheets("TimeCard").Visible = xlVeryHidden

Sheets("TempBatch").Select
Range("A1").Select


End Sub

Attribute VB_Name = "Module5"
Private Sub SaveSetup()
ActiveWindow.DisplayWorkbookTabs = False

' Return to Main Menu
Application.ScreenUpdating = False

Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""


'to indicate setup failed

If Sheets("Setup").Range("CO49") <> 1 Then
 
'save previous setup

   Sheets("Setup").Range("CB1:CJ48").Copy Destination:=Sheets("Setup").Range("CL1:CT48")
    Application.CutCopyMode = False
       
End If

'copy data

Sheets("Setup").Range("CB1:CB5") = Sheets("Setup").Range("b1:b5").Value
Sheets("Setup").Range("CC5") = Sheets("Setup").Range("C5").Value
Sheets("Setup").Range("CB14:CB16") = Sheets("Setup").Range("b14:b16").Value
Sheets("Setup").Range("CJ13:CJ16") = Sheets("Setup").Range("J13:J16").Value
Sheets("Setup").Range("CC19:CC34") = Sheets("Setup").Range("C19:C34").Value
Sheets("Setup").Range("CE19:CE34") = Sheets("Setup").Range("E19:E34").Value

Sheets("Setup").Range("CB41:CD48") = Sheets("Setup").Range("B41:D48").Value
Sheets("Setup").Range("CF41:CH48") = Sheets("Setup").Range("F41:H48").Value



If Sheets("Setup").Range("AA37") = True Then

MsgBox ("The Maximum Deduction Amount must be in Value, Please re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 

Exit Sub


End If

If Sheets("Setup").Range("AA38") = True Then

MsgBox ("The Year and Vacation Hours must be in Value, Please re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 


Exit Sub

End If



If Sheets("Setup").Range("AA39") = True Then

MsgBox ("The Percentages in Workcomp code must be in Value, Please re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 
    
Exit Sub

End If

If Sheets("Setup").Range("AA42") = True Then

MsgBox ("Number Year of Service Must Be Greater or Equal to the Previous Year, Please Re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 
Exit Sub

End If


If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Entry Error; All Entry must be Value in Number, Please Re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 
Exit Sub

End If


If Sheets("Setup").Range("CE49").Value > 0 Then

MsgBox ("Error! Worker's Compensation Rate Must be in Value! Please Re-enter")
'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 
Exit Sub

End If


If Sheets("Setup").Range("CI49").Value > 0 Then

MsgBox ("401K Setting Error! Yr of Srv must be in Decending order and Percentage must be in Value!")

'to indicate setup failed

 Sheets("Setup").Range("CO49") = 1
 

Exit Sub

End If

'to indicate setup suceeds

 Sheets("Setup").Range("CO49").ClearContents
 
   
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
        
      
Sheets("Setup").Protect Password:="~~#$SXMLC1999", DrawingObjects:=True, Contents:=True, Scenarios:=True
        
    Sheets("Main").Select
    'Range("I13").Select
    ThisWorkbook.Save

MsgBox ("Setup Information Saved!")

Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"

End Sub
Private Sub CancelSetup()
ActiveWindow.DisplayWorkbookTabs = False

Application.ScreenUpdating = False

Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""

'Restore data
   Sheets("Setup").Range("CL1:CT48").Copy Destination:=Sheets("Setup").Range("CB1:CJ48")
    Application.CutCopyMode = False

'copy data back to original


 Sheets("Setup").Range("CB1:CB5").Copy Destination:=Sheets("Setup").Range("b1:b5")
  Application.CutCopyMode = False
Sheets("Setup").Range("CC5").Copy Destination:=Sheets("Setup").Range("C5")
 Application.CutCopyMode = False
Sheets("Setup").Range("CB14:CB16").Copy Destination:=Sheets("Setup").Range("b14:b16")
 Application.CutCopyMode = False
Sheets("Setup").Range("CJ13:CJ16").Copy Destination:=Sheets("Setup").Range("J13:J16")
 Application.CutCopyMode = False
Sheets("Setup").Range("CC19:CC34").Copy Destination:=Sheets("Setup").Range("C19:C34")
 Application.CutCopyMode = False
Sheets("Setup").Range("CE19:CE34").Copy Destination:=Sheets("Setup").Range("E19:E34")
 Application.CutCopyMode = False

Sheets("Setup").Range("CB41:CD48").Copy Destination:=Sheets("Setup").Range("B41:D48")
 
 Application.CutCopyMode = False

Sheets("Setup").Range("CF41:CH48").Copy Destination:=Sheets("Setup").Range("F41:H48")
Application.CutCopyMode = False


'to indicate setup suceeds

 Sheets("Setup").Range("CO49").ClearContents
Sheets("Setup").Protect Password:="~~#$SXMLC1999", DrawingObjects:=True, Contents:=True, Scenarios:=True

   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
         
    Sheets("Main").Select
    'Range("I13").Select
    ThisWorkbook.Save

MsgBox ("Setup Canceled and Previous Setup Information Restored.")

Application.ScreenUpdating = True
Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"

End Sub
Attribute VB_Name = "Module52"
Private Sub PRYear()


If Cells(52, "AA") > 0 Then

MsgBox ("Current Year Has Activities; Please Close this PR Year before selecting a New PR Year")
Range("AA55") = Range("AB55").Value

Exit Sub
End If




' to enter user's name


If Range("AO2") > 5000 And Range("AR5") = True And Range("AO2") < 50000 Then

'Range("as2:at2") = Range("ap2:aq2").Value

Range("ap2:aq2").ClearContents


'Do Until Sheets("Setup").Range("aq3") = True


Sheets("Setup").Range("aq2") = InputBox("Please Enter Your First Name:", "User's First Name - Required")

'Loop


'Do Until Sheets("Setup").Range("ap3") = True

Sheets("Setup").Range("ap2") = InputBox("Please Enter Your Last Name:", "Enter User's Last Name - Required")

'Loop

Application.Run ("ProcessorNumber")


If Range("AS3") = False Then

MsgBox ("Names Do Not Match! Please Reselect Year or Renew with your Code again")
Range("AA55") = Range("AB55").Value
Exit Sub

End If


If Range("Aq16") = False Then

MsgBox ("Copyright reserved! if New Computer, Please Renew with your Code again then Select a Year!")
Range("AA55") = Range("AB55").Value
Exit Sub

End If


End If


'copy the payroll year to aa54

Range("AA54") = Range("AA55").Offset(Cells(55, "AA").Value, 0)
Range("AQ5") = Date

MsgBox "You are Selecting " & (Range("AA54")) & " as Current Payroll Year!" & vbCrLf & _
"Make sure you update your tax rate for Year " & (Range("AA54"))



End Sub

Attribute VB_Name = "Module53"
Private Sub ClosePRYear()
ActiveWindow.DisplayWorkbookTabs = False

MsgBox ("ONLY DO THIS ONCE YEAR!" & vbCrLf & _
"Your Last Closing Year Was On " & Cells(4, "AQ") & vbCrLf & _
"Payroll Data May be Lost if Closing More than Once a Year!")


If Range("aa47") > 3 Then


    Dim Answer4 As String
    Answer4 = MsgBox("There are " & Cells(47, "AA") & " more days before the year ends. Continue?", vbYesNo, "Alert")
    If Answer4 = vbNo Then

Exit Sub

End If

End If



Range("aa49").Value = InputBox("You Are Attempting to Close the Year!" & vbCrLf & "Only Close It Once a Year!" & vbCrLf & "Are You Sure to Do This?", "Please Type 'Close' to Confirm")

If Range("aa48").Value <> 1 Then

 MsgBox "Payroll Year " & (Range("AA54")) & " has Not closed."


Exit Sub

End If


'Application.EnableCancelKey = xlDisabled
 ' Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
 ' Application.OnKey "^%{Break}", ""
 ' Application.OnKey "^{Break}", ""

'to display processing
Sheets("Processing").Range("BB1") = 3
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("Selection1").Range("ab2").Value
Sheets("Processing").Visible = True
Sheets("Processing").Select
Application.ScreenUpdating = False

Sheets("Setup").Select

' to copy the data base to payroll data file

'Sheets("DBase1").Visible = True
Sheets("DBase1").Range("A1", "AB1000").Copy


' to open the record file and Save the payroll data
   
  Dim filepath1 As String
  Dim filename1 As String
  Dim filename2 As String
    
    filepath1 = Range("e10").Value
    filename1 = Range("aa53").Value
    filename2 = Range("b7").Value
   
  
   Application.EnableCancelKey = xlDisabled
   
  
      Workbooks.Open filepath1 & filename2, Password:=Sheets("Setup").Range("AA9").Value
        
        'Windows(Sheets("Setup").Range("b7").Value).Activate
    
   Sheets("EmployeeList").Select
   Range("A1").Select
   ActiveSheet.Paste
       
    
    Application.DisplayAlerts = False
    
      ActiveWorkbook.SaveAs filepath1 & filename1, FileFormat:= _
        xlOpenXMLWorkbookMacroEnabled, Password:="", CreateBackup:=False
    
    Application.DisplayAlerts = True
    
    
    ActiveWorkbook.Close
    

' to open a new pr record file

ThisWorkbook.Activate
Sheets("Setup").Select
'Sheets("DBase1").Visible = False

Workbooks.Open filepath1 & Sheets("Setup").Range("d7").Value, Password:=Sheets("Setup").Range("AA9").Value

Application.DisplayAlerts = False

      ActiveWorkbook.SaveAs filepath1 & filename2, FileFormat:= _
        xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False
   
 Application.DisplayAlerts = True
   
ThisWorkbook.Activate
Sheets("DBase1").Visible = True

Sheets("DBase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Dim recordnumber As Integer
Dim NewRecName As String
Dim recordcount As Integer


recordnumber = 2
recordcount = Sheets("Selection1").Range("AB2").Value

Range("A2").Select

'Do Until Selection = "EOF"

Do Until recordcount < 1

Cells(recordnumber, "A").Select

   
  Cells(1, "AY").Value = ActiveCell.Address
      NewRecName = ActiveCell.Value
 
 Range("BA1:BS1").Copy
  
   
   Windows(filename2).Activate
    
    Sheets("MRecord").Select
    
    Range("B1").Select
    
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       ' to empty the memory
    
    Application.CutCopyMode = False
    

        
    Sheets("MRecord").Copy Before:=Sheets(1)

    Sheets("MRecord (2)").Select
    Sheets("MRecord (2)").Name = NewRecName
    
    recordnumber = recordnumber + 1
    recordcount = recordcount - 1
    
    ThisWorkbook.Activate
    
    
    'to display processing

Sheets("Processing").Range("Ba1") = recordnumber
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False
        
    
    Sheets("DBase1").Select
   
 
    Loop
     Windows(filename2).Activate
    ActiveWorkbook.Save
     ActiveWorkbook.Close
            
     ThisWorkbook.Activate
    Sheets("Setup").Select
    Range("AA50", "AA51").ClearContents
   
   Sheets("DBase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
   Sheets("DBase1").Visible = xlVeryHidden
      
      
    MsgBox (filename2) & " has been closed. You may select a new payroll year now"

Sheets("Setup").Range("AQ4") = Date

Sheets("Processing").Visible = xlVeryHidden

Application.ScreenUpdating = True

'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^{Break}"

End Sub


Attribute VB_Name = "Module55"
Private Sub PreBatch()
ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If




Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^%{Del}", ""

'backup data

Sheets("TimeCard").Range("CK2", "CO204") = Sheets("TimeCard").Range("K2", "O204").Value
Sheets("TimeCard").Range("CS6", "CS7") = Sheets("TimeCard").Range("S6", "S7").Value
Sheets("Entry1").Range("P44:P45").ClearContents
Sheets("Entry1").Range("g7:g8").ClearContents

'copy format back

Sheets("TimeCard").Range("CK2", "CO204").Copy Destination:=Sheets("TimeCard").Range("K2", "O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6", "CS7").Copy Destination:=Sheets("TimeCard").Range("S6", "S7")

    Application.CutCopyMode = False


' To Check expiration before starting
'

If Sheets("Setup").Range("AH6") = False Then



Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired, Visit ExcelPayroll.Org"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If



 'check if errors in setup

If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub

End If

If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")

Exit Sub

End If



'normal code start


If Range("AE1") = True Then

MsgBox ("Error, All Time Hour Must be in Value!")

Exit Sub

End If

If Range("AE3") = True Then

MsgBox ("Hour Error! Time Must be Greater Than 0.1 Hour for Each Employee!")

Exit Sub

End If

If Range("AF4") = True Then

MsgBox ("Error! Hour Value Must be Greater Than 0.1 for each Category!")

Exit Sub

End If


If Range("AE2") > 224 Then

MsgBox ("One or More Payees' Time Over 224 Hours! Please Check the Timecard!")

Exit Sub

End If




If Range("AB1") = False Then

MsgBox ("The Check Number Must be in Value, Please Re-enter")

Exit Sub
End If


If Range("AC2") = False Then

MsgBox ("The Date Must be in Current Payroll Year ") & Sheets("Setup").Cells(54, "AA") & "!"

Exit Sub
End If



If Sheets("Timecard").Range("CS2") > 0 Then

  Dim AnswerYN12 As String
    
   AnswerYN12 = MsgBox("One or More Employees' Vacation Balance Become Negative", vbYesNo, "Continue Pay Vacation Hour?")
    If AnswerYN12 = vbNo Then
        Exit Sub
    End If

End If



   Dim AnswerYN2 As String
    
   AnswerYN2 = MsgBox("Run a Pre-Process Test Report?", vbYesNo, "Payroll will Not be Recorded")
    If AnswerYN2 = vbNo Then
        Exit Sub
    End If



'to display processing
Sheets("Processing").Range("BB1") = 2
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("Selection1").Range("az1").Value
Sheets("Processing").Visible = True
Sheets("Processing").Select
Application.ScreenUpdating = False





Application.ScreenUpdating = False
Sheets("Selection1").Visible = True
'Sheets("TimeCard").Visible = True
Sheets("TempBatch").Visible = True


Sheets("PPRChck").Range("bb3", "dp500").ClearContents
Sheets("TempBatch").Range("A3", "AY500").ClearContents

'to indicate this is not a check

Sheets("TimeCard").Range("AA2") = 2


Sheets("Selection1").Range("BA2", "BO201").Value = Sheets("TimeCard").Range("A2", "O201").Value

Sheets("Entry1").Range("g4").Value = Sheets("TimeCard").Range("s6").Value
Sheets("Entry1").Range("g5").Value = Sheets("TimeCard").Range("s7").Value

Sheets("Entry1").Range("bg1").Value = Sheets("TimeCard").Range("s6").Value
Sheets("Entry1").Range("bf1").Value = Sheets("TimeCard").Range("s7").Value




Sheets("Selection1").Select

Application.Run ("Prebatchreport")

Sheets("TimeCard").Visible = True
Sheets("TimeCard").Select

Sheets("Selection1").Visible = xlVeryHidden
Sheets("Entry1").Visible = xlVeryHidden
 Sheets("PPRChck").Visible = xlVeryHidden

If Sheets("TimeCard").Range("AD1") > 1 Then

MsgBox "Total " & (Sheets("TimeCard").Range("AD1")) & " Employees in this Payroll Batch!"

End If

If Sheets("TimeCard").Range("AD1") = 1 Then

MsgBox "" & (Sheets("TimeCard").Range("AD1")) & " Employee in this Payroll Batch!"

End If


  If Sheets("TimeCard").Range("AD1") <= 0 Then
  
  Sheets("TempBatch").Visible = xlVeryHidden
  
    
  Exit Sub
  End If



Sheets("TempBatch").Select


' to sum the total

Range("b2").Select
    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    ActiveCell.Formula = "Batch Total"


Range("F3", "ay" & Sheets("TimeCard").Cells(1, "ad").Value + 2).Select

    Dim source As Range
    Dim iCol As Long
    Dim nCol As Long
    Dim nRow As Long
 
    Set source = Selection
 
    nCol = source.Columns.Count
    nRow = source.Rows.Count
    For iCol = 1 To nCol
        With source.Columns(iCol).Rows(nRow).Offset(1, 0)
            .FormulaR1C1 = "=SUM(R[-" & nRow & "]C:R[-1]C)"
           ' .Font.Bold = True
        End With
    Next iCol

' to clear the total on check numbers

Range("Y1").Select
    Selection.End(xlDown).Select
    Selection.ClearContents
        
Range("AI1").Select
    Selection.End(xlDown).Select
    Selection.ClearContents
       
        

Range("A1").Select



Sheets("TimeCard").Visible = True

Sheets("TimeCard").Select


ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("PPRChck").Range("AZ1") = 0

    ActiveSheet.Shapes("Drop Down 3").Select
    With Selection
        .ListFillRange = Sheets("PPRChck").Range("BA2").Value
        .LinkedCell = "PPRChck!$AZ$1"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    
Range("S12").Select

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True



 
 Sheets("TempBatch").Select
 Sheets("Selection1").Range("V3") = Sheets("Selection1").Range("V2").Value
 
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

 Sheets("Processing").Visible = xlVeryHidden
 Sheets("TimeCard").Visible = xlVeryHidden
 
Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^%{Del}"


End Sub
Private Sub Prebatchreport()
ActiveWindow.DisplayWorkbookTabs = False
'
' Start to Print checks

Application.ScreenUpdating = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^%{Del}", ""

Sheets("Selection1").Select


' *** will insert: if section1 az1=0, then no payroll check to be printed. End

If Sheets("Selection1").Range("AZ1") = 0 Then

MsgBox ("No Record Found! Please Add an Employee")
 Sheets("Processing").Visible = xlVeryHidden
 Sheets("TimeCard").Visible = xlVeryHidden

Exit Sub

End If



Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim printedchecks As Integer


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
printedchecks = 0


'To open the Payroll Record

 Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value


ThisWorkbook.Activate
Sheets("Selection1").Select

Dim Checkcount As Integer
Dim Emunber As String


Checkcount = 2



Do Until Sheets("Selection1").Cells(Checkcount, "BC").Value = 0


'Clean Up

Sheets("Entry1").Range("e12", "g20").ClearContents
Sheets("Entry1").Range("j4", "j13").ClearContents
Sheets("Entry1").Range("g9").ClearContents
Sheets("Entry1").Range("q23", "q31").ClearContents



Sheets("Selection1").Select
Sheets("Selection1").Range("V3") = Sheets("Selection1").Cells(Checkcount, "BC").Value
Emunber = Sheets("Selection1").Cells(3, "V").Value

Columns("BC").Select

Selection.Find(What:=Emunber, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

Sheets("Selection1").Range("Az2") = Selection.Offset(0, 8).Value
Sheets("Selection1").Range("Az3") = Selection.Offset(0, 9).Value
Sheets("Selection1").Range("Az4") = Selection.Offset(0, 10).Value
Sheets("Selection1").Range("Az5") = Selection.Offset(0, 11).Value
Sheets("Selection1").Range("Az6") = Selection.Offset(0, 12).Value


' To make sure the net pay is not negative

   
If Sheets("Selection1").Range("AZ8").Value > 0 Then
  
    Sheets("Entry1").Visible = True
    Sheets("Entry1").Select
    
    
       
    
    'to get data ready
    
    Sheets("Entry1").Range("b4").Value = Sheets("Selection1").Range("I4").Value
    Sheets("Entry1").Range("b5").Value = Sheets("Selection1").Range("I6").Value
    Sheets("Entry1").Range("b6:b9").Value = Sheets("Selection1").Range("I7:I10").Value
  
    
    'copy date and check number
    Sheets("Entry1").Range("BF1") = Sheets("Entry1").Range("g5").Value
    Sheets("Entry1").Range("BG1") = Sheets("Entry1").Range("G4").Value
    
    'copy earning rate
    
    
    
    'copy hours for prepare calculation
    Sheets("Entry1").Range("ba1:bc9").ClearContents
    
    Sheets("Entry1").Range("ba1").Value = Sheets("Selection1").Range("Az2").Value
    Sheets("Entry1").Range("ba2").Value = Sheets("Selection1").Range("Az3").Value
    Sheets("Entry1").Range("ba3").Value = Sheets("Selection1").Range("Az4").Value
    Sheets("Entry1").Range("ba4").Value = Sheets("Selection1").Range("Az5").Value
   Sheets("Entry1").Range("ba5").Value = Sheets("Selection1").Range("Az6").Value


   'copy earning/hour type headings
   Sheets("Entry1").Range("Q33:Q41").Value = Sheets("Entry1").Range("P33:P41").Value
   'Copy Rate
    Sheets("Entry1").Range("g9").Value = Sheets("selection1").Range("v17").Value
    Sheets("Entry1").Range("BE1").Value = Sheets("selection1").Range("v17").Value
   
   
   
   'copy index code for earning calculation; these codes were for selection codes
   'will be coded in column "t" again
  
  
   
'Copy index code
Sheets("Entry1").Range("q23", "q27").Value = Sheets("Entry1").Range("t23", "t27").Value

'copy earning
'****
Sheets("Entry1").Range("bc1", "bc9").Value = Sheets("Entry1").Range("P20", "P28").Value

Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("bc1", "bc9").Value

'****
   
      
   'copy back to reset format and to show data
   Sheets("Entry1").Range("BA1:BC9").Copy Destination:=Sheets("Entry1").Range("E12:G20")
    Application.CutCopyMode = False

    Sheets("Entry1").Earningtype.Object.Text = Sheets("Entry1").Range("P33")
Sheets("Entry1").ComboBox1.Object.Text = Sheets("Entry1").Range("P34")
Sheets("Entry1").ComboBox2.Object.Text = Sheets("Entry1").Range("P35")
Sheets("Entry1").ComboBox3.Object.Text = Sheets("Entry1").Range("P36")
Sheets("Entry1").ComboBox4.Object.Text = Sheets("Entry1").Range("P37")
Sheets("Entry1").ComboBox5.Object.Text = ""
Sheets("Entry1").ComboBox6.Object.Text = ""
Sheets("Entry1").ComboBox7.Object.Text = ""
Sheets("Entry1").ComboBox8.Object.Text = ""


  'to select the record file
  
   
    Windows(prfile2).Activate
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    
Range(Selection.Offset(4, 0), Selection.Offset(4, 25)).Select
Selection.Copy
    
     
   
    'Windows("Current File Name.xlsm").Activate
    
      
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S1").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'copy last payment info
    
    Windows(prfile2).Activate
    
    Sheets(Emunber).Select
    Range("E2").Select
    Selection.End(xlDown).Select
   
    
Range(Selection.Offset(0, -3), Selection.Offset(0, 26)).Select
Selection.Copy
    
       
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Range("S2").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

  
'return to Entry1 sheet
       
Windows(prfile1).Activate

Sheets("Entry1").Select
Range("O2").Value = Sheets("Setup").Range("Y1").Value



' To make sure the net pay is not negative

   If Sheets("Selection1").Range("AY8").Value > 0 Then



Sheets("Selection1").Visible = True



   Application.ScreenUpdating = False

  
    Sheets("PPRChck").Visible = True
    Sheets("PPRChck").Select
        
        Range("Z32:AF41").Select
    Selection.Copy
    Range("Z43").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Add Key:=Range("Z44:Z52" _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    With ActiveWorkbook.Worksheets("PPRChck").Sort
        .SetRange Range("Z43:AF52")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Range("R33", "R41").Value = Range("ac44", "ac52").Value
    Range("t33", "v41").Value = Range("ad44", "af52").Value
    
        
    Sheets("PPRChck").Select
        
    Range("Printprcheck").Select
    Selection.Copy
    Range("B2").Select
                 
                 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False

       
        
  ' to copy the register
  ' copy register to a temp file
   
    
' to update the TempBatch Sheet

    Sheets("TempBatch").Select
    Range("A1").Select
    Selection.End(xlDown).Select

Range(Selection.Offset(1, 0), Selection.Offset(1, 50)) = Sheets("PRCalculator").Range("A14", "Ay14").Value


       
    'To update the control number
    
     Windows(prfile1).Activate
        Sheets("PRCalculator").Range("AG16").Value = Sheets("PRCalculator").Range("AE17").Value

printedchecks = printedchecks + 1
Checkcount = Checkcount + 1

' to copy the printed check info

Sheets("PPRChck").Select
Range("BB1").Select
 
    Selection.End(xlDown).Select
 
Range(Selection.Offset(1, 0), Selection.Offset(1, 66)).Value = Range("BB2", "DP2").Value

Sheets("Entry1").Range("g5").Value = Sheets("Entry1").Range("g5") + 1
Sheets("Entry1").Range("BF1") = Sheets("Entry1").Range("g5").Value

 Sheets("Selection1").Select

'To Print PR check

If Sheets("Selection1").Range("AD1") = 1 Then

Sheets("PPRChck").Visible = True

Sheets("PPRChck").Select

Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   Sheets("PPRChck").Visible = xlVeryHidden
   Sheets("CustCheck").Visible = xlVeryHidden
   
Else

Windows(prfile1).Activate
Checkcount = Checkcount + 1
 Sheets("Selection1").Select

End If

Else

Windows(prfile1).Activate
Checkcount = Checkcount + 1
 Sheets("Selection1").Select

End If

'to display processing
Sheets("Processing").Range("Ba1") = Checkcount
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False


Loop

   
    'to save and close the Record file
    
    Windows(prfile2).Activate
     ActiveWorkbook.Saved = True
     ActiveWorkbook.Close
        
    Windows(prfile1).Activate
    
        
    Sheets("Entry1").Visible = xlVeryHidden
    
    
    Sheets("Selection1").Select
    Range("i13").Select
    ActiveWorkbook.Save


Sheets("PPRChck").Range("BA1").Value = printedchecks
 
  
  
  If printedchecks = 0 Then
  
  MsgBox ("No Payroll, please enter Timesheet/Hours to start!")
  
   Sheets("Processing").Visible = xlVeryHidden
  
  Exit Sub
  End If
    
  Sheets("PPRChck").Visible = xlVeryHidden
       
Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^%{Del}"

End Sub


Attribute VB_Name = "Module56"
Private Sub BatchReport2()

Sheets("TempBatch").Select


End Sub
Attribute VB_Name = "Module57"
Private Sub Return4()

Sheets("TimeCard").Visible = True
Sheets("TimeCard").Select
Sheets("TempBatch").Visible = xlVeryHidden

End Sub
Attribute VB_Name = "Module59"
Private Sub ViewEmployees()


Application.ScreenUpdating = False

    Sheets("DBase1").Visible = True
    Sheets("Employee").Visible = True
    
    'to unprotect "employee" sheet
   Sheets("Employee").Unprotect Password:=Sheets("Setup").Range("AA8").Value

    Sheets("DBase1").Select
    Range("MainDbase").Select
    Selection.Copy
    Sheets("Employee").Select
    
   
    Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
  Application.CutCopyMode = False

    Columns("P:AD").Select
     Selection.EntireColumn.Delete
     
    Range("B1").Value = "Name"
    
        Columns("L:L").Select
    Selection.NumberFormat = "mm/dd/yy;@"
    Range("B2").Select
    
'to protect "employee" sheet

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
    
    Sheets("Selection1").Visible = xlVeryHidden
      Sheets("DBase1").Visible = xlVeryHidden
      Application.ScreenUpdating = True
      


End Sub
Private Sub return5()
Application.ScreenUpdating = False
'to unprotect "employee" sheet
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("A1", "P2000").ClearContents
 'to protect "employee" sheet

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    
     
     Sheets("Selection1").Visible = True
      Sheets("Selection1").Select
      Sheets("DBase1").Visible = xlVeryHidden
    Sheets("Employee").Visible = xlVeryHidden

Application.ScreenUpdating = True

End Sub


Attribute VB_Name = "Module6"
Private Sub NameListing()
     
    Dim objFSO As Object
    Dim objFolder As Object
    Dim objFile As Object
    Dim ws As Worksheet
     
    Set objFSO = CreateObject("Scripting.FileSystemObject")
    'Set ws = Worksheets.Add
     Set ws = Sheets("Setup")
          
     'Get the folder object associated with the directory
    'Set objFolder = objFSO.GetFolder("C:\")
    
    Set objFolder = objFSO.GetFolder(Sheets("Setup").Range("E10").Value)
    
    ws.Cells(1, 61).Value = "The files in " & objFolder.Name & " are:"
     
     'Loop through the Files collection
    For Each objFile In objFolder.Files
    
        ws.Cells(ws.UsedRange.Rows.Count + 1, 61).Value = objFile.Name
    Next
     
     'Clean up!
    Set objFolder = Nothing
    Set objFile = Nothing
    Set objFSO = Nothing

End Sub

Attribute VB_Name = "Module60"
Private Sub Week1()

ActiveWindow.DisplayWorkbookTabs = False
'to start

If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; use standard version to select time card weeks")
Range("AC6:AC10") = False


Exit Sub

End If

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value


Application.ScreenUpdating = False

Range("AA5").Value = Range("AA6").Value

Sheets("WeekTime").Visible = True

If Range("AC6") <> True Then

Sheets("WeekTime").Range("S1", "AI100").ClearContents
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Application.Run "Payinbatch"
Sheets("WeekTime").Visible = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value



Exit Sub

End If


Sheets("WeekTime").Range("s1", "ai100").Value = Sheets("WeekTime").Range("ds1", "ei100").Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 Application.Run "Payinbatch"
 
 
 Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
          
 Sheets("WeekTime").Visible = False
 
 'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False
 
 
 Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
  Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value
 
 Application.ScreenUpdating = True


End Sub

Attribute VB_Name = "Module61"
Private Sub Week2()
ActiveWindow.DisplayWorkbookTabs = False

If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; use standard version to select time card weeks")
Range("AC6:AC10") = False
Exit Sub

End If


Application.ScreenUpdating = False

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("AA5").Value = Range("AA6").Value

Sheets("WeekTime").Visible = True

If Range("AC7") <> True Then

Sheets("WeekTime").Range("ak1", "ba100").ClearContents
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Application.Run "Payinbatch"
Sheets("WeekTime").Visible = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value



Exit Sub

End If

Sheets("WeekTime").Range("ak1", "ba100").Value = Sheets("WeekTime").Range("ek1", "fa100").Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 Application.Run "Payinbatch"

Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 

  Sheets("WeekTime").Visible = False
  Application.ScreenUpdating = True

'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")


Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value



    Application.CutCopyMode = False



End Sub
Private Sub Week3()
ActiveWindow.DisplayWorkbookTabs = False

If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; use standard version to select time card weeks")
Range("AC6:AC10") = False
Exit Sub

End If

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value


Application.ScreenUpdating = False

Range("AA5").Value = Range("AA6").Value

Sheets("WeekTime").Visible = True

If Range("AC8") <> True Then

Sheets("WeekTime").Range("bc1", "bs100").ClearContents
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Application.Run "Payinbatch"
Sheets("WeekTime").Visible = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value


Exit Sub

End If

Sheets("WeekTime").Range("bc1", "bs100").Value = Sheets("WeekTime").Range("fc1", "fs100").Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

Application.Run "Payinbatch"
 
Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
 
 Sheets("WeekTime").Visible = False
 
 'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value
 
 
 Application.ScreenUpdating = True



End Sub
Private Sub Week4()
ActiveWindow.DisplayWorkbookTabs = False
If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; use standard version to select time card weeks")
Range("AC6:AC10") = False
Exit Sub

End If

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value


Application.ScreenUpdating = False

Range("AA5").Value = Range("AA6").Value

Sheets("WeekTime").Visible = True

If Range("AC9") <> True Then

Sheets("WeekTime").Range("bu1", "ck100").ClearContents
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Application.Run "Payinbatch"
Sheets("WeekTime").Visible = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value


Exit Sub

End If

Sheets("WeekTime").Range("bu1", "ck100").Value = Sheets("WeekTime").Range("fu1", "gk100").Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 Application.Run "Payinbatch"
  
Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
  
  Sheets("WeekTime").Visible = False
 
 'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False
    
Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value
 
 Application.ScreenUpdating = True


End Sub
Private Sub Week5()
ActiveWindow.DisplayWorkbookTabs = False
If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; use standard version to select time card weeks")
Range("AC6:AC10") = False
Exit Sub

End If

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Application.ScreenUpdating = False

Range("AA5").Value = Range("AA6").Value

Sheets("WeekTime").Visible = True

If Range("AC10") <> True Then

Sheets("WeekTime").Range("cm1", "dc100").ClearContents
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Application.Run "Payinbatch"
Sheets("WeekTime").Visible = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value


Exit Sub

End If

Sheets("WeekTime").Range("cm1", "dc100").Value = Sheets("WeekTime").Range("gm1", "hc100").Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 
 Application.Run "Payinbatch"
 
 Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
 
 Sheets("WeekTime").Visible = False
 'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False

Sheets("TimeCard").Range("aK2:aK204") = 0
 Sheets("TimeCard").Range("AO2:AO204") = Sheets("TimeCard").Range("K2:K204").Value
    Sheets("TimeCard").Range("AR2:AR204") = Sheets("TimeCard").Range("AQ2:AQ204").Value
 Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("Ap2:Ap204").Value
 Sheets("TimeCard").Range("Aj2:Aj204") = Sheets("TimeCard").Range("aq2:aq204").Value
 Sheets("TimeCard").Range("AN2:AN204") = Sheets("TimeCard").Range("aq2:aq204").Value


 Application.ScreenUpdating = True


End Sub

Attribute VB_Name = "Module62"
Private Sub Custcksetup()

If Sheets("Entry1").Range("R14") = 1 Then
MsgBox ("You selected stardard check format; this is for customizing check format.")
Exit Sub
End If

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
Sheets("Setup").Visible = xlVeryHidden

End Sub
Private Sub ReturnSetup()
Sheets("Setup").Visible = True
Sheets("CustCheck").Visible = xlVeryHidden
Sheets("Setup").Select

End Sub
Attribute VB_Name = "Module63"
Private Sub Updatecode()

ActiveWindow.DisplayWorkbookTabs = False
'Application.EnableCancelKey = xlDisabled
 ' Application.OnKey "{ESC}", ""
 ' Application.OnKey "^C", ""
 ' Application.OnKey "^%{Break}", ""
 ' Application.OnKey "^{Break}", ""


Sheets("Setup").Range("ao3") = Sheets("Setup").Range("ao2").Value


If Sheets("Setup").Range("ai7").Value >= 180 Then


    Dim Answer2 As String

Answer2 = MsgBox("No update required at this time; Do You Still Want to Upgrade to Standard Version?", vbYesNo, "Code Required to Upgrade")
    If Answer2 = vbNo Then
        Exit Sub
    End If

'Sheets("Setup").Range("an5") = Sheets("Setup").Range("an4")
'Sheets("Setup").Range("i5").Value = InputBox("Please Enter an Upgrade Code to Continue", "Get a Code from www.ExcelPayroll.Org")

'Application.Run "Updatecode2"
    'Exit Sub
End If



If Sheets("Setup").Range("ai7").Value >= 30 Then


    Dim Answer3 As String
    Dim daysleft As Long
    
    daysleft = Sheets("Setup").Range("ai7").Value
    
Answer3 = MsgBox("Program Update Due in " & daysleft & " days; do you want to renew or upgrate?", vbYesNo, "An Update Code Required to Process")
    If Answer3 = vbNo Then
        Exit Sub
    End If

'Sheets("Setup").Range("an5") = Sheets("Setup").Range("an4")
'Sheets("Setup").Range("i5").Value = InputBox("Please Enter an Upgrade Code to Continue", "Get a Code from www.ExcelPayroll.Org")
'Application.Run "Updatecode2"
    'Exit Sub
End If



Sheets("Setup").Range("an5") = Sheets("Setup").Range("an4")


If Sheets("Setup").Range("i5").Value = "" Then

Sheets("Setup").Range("i5").Value = InputBox("Please Enter an Upgrade Code to Continue", "Get a Code from www.ExcelPayroll.Org")

End If


Application.Run "Updatecode2"

'Application.EnableCancelKey = xlInterrupt
  'Application.OnKey "{ESC}"
 ' Application.OnKey "^C"
  'Application.OnKey "^%{Break}"
  'Application.OnKey "^{Break}"

End Sub

Attribute VB_Name = "Module64"
Private Sub Resetcheck()

Application.ScreenUpdating = False


'to unprotect the sheet

    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
      
' to select the selection range

Sheets("CustCheck").Range("B1", "AZ400").ClearContents

Sheets("CustCheck").Range("EA1:ED54").Copy Destination:=Sheets("CustCheck").Range("B1")

 Range("B:E").ColumnWidth = 12
 Range("F:J").ColumnWidth = 9


'Selection.Copy

'Sheets("CustCheck").Range("B1").Select

'ActiveSheet.Paste
  
 ' Selection.PasteSpecial Paste:=xlPasteFormulas, Operation:=xlNone, _
  '  SkipBlanks:=False, Transpose:=False
    
  Application.CutCopyMode = False
    
    Sheets("CustCheck").Range("A1").Select
    
    ' to protect the sheet
    
      ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True _
        , AllowFormattingCells:=True, AllowFormattingColumns:=True, _
        AllowFormattingRows:=True
     

          
Application.ScreenUpdating = True


End Sub


Attribute VB_Name = "Module65"
Public ProcNum As String

Private Sub ProcessorNumber()
With Application
.ScreenUpdating = False
.DisplayAlerts = False
.EnableEvents = False
Dim WMI As Object, WQL As String, Proc As Object, Procs As Object, i As Integer
Sheets.Add
i = 1
Set WMI = GetObject("winmgmts:")
WQL = "select * from win32_processor"
Set Procs = WMI.ExecQuery(WQL)
For Each Proc In Procs
Cells(i, 1).Value = Proc.getObjectText_
i = i + 1
Next Proc
Set WMI = Nothing
Set Procs = Nothing
With Range("B1")
.Formula = "=CLEAN(MID(RC1,SEARCH(""{"",RC1)+1,SEARCH(""}"",RC1)-SEARCH(""{"",RC1)-1))"
.Value = .Value
End With
Range("B1").TextToColumns Destination:=Range("B1"), DataType:=xlDelimited, _
TextQualifier:=xlDoubleQuote, Other:=True, OtherChar:=";", FieldInfo:=Array( _
Array(1, 1), Array(2, 1), Array(3, 1), Array(4, 1), Array(5, 1), Array(6, 1), _
Array(7, 1), Array(8, 1), Array(9, 1), Array(10, 1), Array(11, 1), Array(12, 1), _
Array(13, 1), Array(14, 1), Array(15, 1), Array(16, 1), Array(17, 1), Array(18, 1), _
Array(19, 1), Array(20, 1), Array(21, 1), Array(22, 1), Array(23, 1), Array(24, 1), _
Array(25, 1), Array(26, 1), Array(27, 1), Array(28, 1), Array(29, 1), Array(30, 1), _
Array(31, 1), Array(32, 1), Array(33, 1))
Range("B1:AG1").Copy
Range("B2").PasteSpecial Paste:=xlPasteAll, Transpose:=True
Application.CutCopyMode = False
Columns(1).Delete
Rows(1).Delete
Columns(1).TextToColumns Destination:=Range("A1"), DataType:=xlDelimited, _
TextQualifier:=xlDoubleQuote, Other:=True, OtherChar:="=", FieldInfo:=Array(Array(1, 1), Array(2, 1))
ProcNum = .Trim(.Substitute(Range("B21").Value, Chr(34), ""))
ActiveSheet.Delete
.EnableEvents = True
.DisplayAlerts = True
.ScreenUpdating = True
End With

'Sheets("Setup").Range("AQ13") = ProcNum
'Sheets("Setup").Range("AQ14") = DriveSerialNumber


'MsgBox "Processor number is: " & ProcNum & vbCrLf & "Hard drive serial number is: " & DriveSerialNumber, , "Computer info:"

End Sub

Function DriveSerialNumber() As String
Dim FSO As Object
Set FSO = CreateObject("Scripting.FileSystemObject")
DriveSerialNumber = Format(CDbl(FSO.Drives("C:").SerialNumber))
End Function



Private Sub Updatecode2()

'update code being continued


Sheets("Setup").Range("an4") = Sheets("Setup").Range("i5").Value


If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code! Visit www.ExcelPayroll.Org to get a new one"
Sheets("Setup").Range("an4") = Sheets("Setup").Range("an5").Value

Sheets("Setup").Range("i5") = ""
Exit Sub

End If




If Sheets("Setup").Range("ao3") > Sheets("Setup").Range("ao2") And Sheets("Setup").Range("ao3") >= 5000 Then


    Dim Answer3 As String

Answer3 = MsgBox("The Code is lower than the Current Version!", vbYesNo, "Continue Downgrade?")
    If Answer3 = vbNo Then
    Sheets("Setup").Range("an4") = Sheets("Setup").Range("an5").Value
    Sheets("Setup").Range("i5") = ""
    
           Exit Sub
    End If

End If


'test if the code expired within 30 days


If Range("AO2").Value < 50000 Then

        '**** 2017/01/29***
        'test the code if expired within 60 days
        'If Sheets("setup").Range("an9") = False Then
        'Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value
        'End If


        If Sheets("Setup").Range("ah5") = False Or Sheets("Setup").Range("an9") = False Then

        MsgBox "The Code has expired or already used, Visit www.ExcelPayroll.Org"
        
        Sheets("Setup").Range("an4") = Sheets("Setup").Range("an5").Value
        Sheets("Setup").Range("i5") = ""

        Exit Sub

        End If
        
End If


    Sheets("Setup").Range("ak2") = Date

        If Sheets("Setup").Range("am3").Value >= 15 Then

        Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

        End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value



' to enter user's name


If Range("AO2").Value > 5000 And Range("AO2").Value < 50000 Then


Range("ap2:aq2").ClearContents

Do Until Sheets("Setup").Range("aq3") = True

Sheets("Setup").Range("aq2") = InputBox("Please Enter Your First Name:", "User's First Name - Required")

Loop


Do Until Sheets("Setup").Range("ap3") = True

Sheets("Setup").Range("ap2") = InputBox("Please Enter Your Last Name:", "Enter User's Last Name - Required")

Loop

Range("AR3") = Range("AR2").Value

'to get the harddrive number
Application.Run ("ProcessorNumber")

Sheets("Setup").Range("AQ13") = ProcNum
Sheets("Setup").Range("AQ14") = DriveSerialNumber


Sheets("Setup").Range("aq15") = Sheets("Setup").Range("aq14").Value

End If



Range("as2:at2") = Range("ap2:aq2").Value

Sheets("Setup").Range("am2") = Sheets("Setup").Range("an10").Value


Sheets("Setup").Range("ak2") = Date
Sheets("Setup").Range("AQ5") = Date
Sheets("Setup").Range("i5") = "Updated"

MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program"

Sheets("Setup").Range("i5") = ""


End Sub


Attribute VB_Name = "Module66"
Private Sub Return3()

' Return to Main Menu
'
If Sheets("Setup").Range("AA37") = True Then

MsgBox ("The Maximum Deduction Amount must be in Value, Please re-enter")

Exit Sub

End If

If Sheets("Setup").Range("AA38") = True Then

MsgBox ("The Year and Vacation Hours must be in Value, Please re-enter")

Exit Sub

End If

If Sheets("Setup").Range("AA39") = True Then

MsgBox ("The Percentages in Workcomp code must be in Value, Please re-enter")

Exit Sub

End If

If Sheets("Setup").Range("AA42") = True Then

MsgBox ("Number Year of Service Must Be Greater or Equal to the Previous Year, Please Re-enter")

Exit Sub

End If


If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Entry Error; All Entry must be Value in Number, Please Re-enter")

Exit Sub

End If
     
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
         
    Sheets("Main").Select
    'Range("I13").Select
    'ThisWorkbook.Save

End Sub

Attribute VB_Name = "Module67"
Private Sub Return6()
' Return to Main Menu
'
If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("All Entries Must be in Value, Please Check The Error and Re-enter")

Exit Sub

End If
  
   
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
   
    Sheets("Main").Select
    'Range("I13").Select
    ThisWorkbook.Save
    
End Sub

Attribute VB_Name = "Module69"
Private Sub HelpSelect()

ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("C7", "C14") = Range(Range("Ai28").Offset(Range("Ak7").Value, 0), Range("Ai28").Offset(Range("Ak7").Value + 8, 0)).Value


 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 

End Sub
Private Sub SelectFQA()

ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Range("C18", "C25") = Range(Range("AA28").Offset(Range("AC7").Value, 0), Range("AA28").Offset(Range("AC7").Value + 8, 0)).Value

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
End Sub

Attribute VB_Name = "Module7"
Private Sub Taxratesetup()


ActiveWindow.DisplayWorkbookTabs = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""

Application.ScreenUpdating = False


'copy to prepare checking data
'copy year
Sheets("TaxRate").Range("Bj1") = Sheets("TaxRate").Range("j1").Value

'copy employment tax name
Sheets("TaxRate").Range("be4") = Sheets("TaxRate").Range("e4").Value
Sheets("TaxRate").Range("bh4") = Sheets("TaxRate").Range("h4").Value

'copy employment tax
Sheets("TaxRate").Range("bc5", "bJ6") = Sheets("TaxRate").Range("c5", "J6").Value

'copy federal rates
Sheets("TaxRate").Range("bb12", "bc18") = Sheets("TaxRate").Range("b12", "c18").Value
Sheets("TaxRate").Range("bg12", "bh18") = Sheets("TaxRate").Range("g12", "h18").Value

' copy state rates
Sheets("TaxRate").Range("bb23", "bc30") = Sheets("TaxRate").Range("b23", "c30").Value
Sheets("TaxRate").Range("bg23", "bh30") = Sheets("TaxRate").Range("g23", "h30").Value


'copy federal deduction
Sheets("TaxRate").Range("bc34", "be34") = Sheets("TaxRate").Range("c34", "e34").Value

'copy state deduction
Sheets("TaxRate").Range("bC39", "bE40") = Sheets("TaxRate").Range("C39", "E40").Value


'copy back

 ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value


Sheets("TaxRate").Range("BB1:BK31").Copy Destination:=Sheets("TaxRate").Range("B1:K31")
    Application.CutCopyMode = False

Sheets("TaxRate").Range("Bc34:Bf34").Copy Destination:=Sheets("TaxRate").Range("c34:f34")
    Application.CutCopyMode = False

Sheets("TaxRate").Range("Bc39:bf40").Copy Destination:=Sheets("TaxRate").Range("c39:f40")
    Application.CutCopyMode = False


ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True



If Sheets("TaxRate").Range("bk30") = "Error" Then

MsgBox ("Error! The Next Taxable Amount Must be Greater than the Previous Amount!")
Application.ScreenUpdating = True
Exit Sub

End If


If Sheets("TaxRate").Range("bk1") = "Error" Then

MsgBox ("Error! The Year must ending December 31 and No early than 2005!")

Application.ScreenUpdating = True


Exit Sub

End If





If Sheets("TaxRate").Range("CA1") = True Then

MsgBox ("Setup Error! The Tax Rates and Amount Must be in Value! Please Change")
Application.ScreenUpdating = True
Exit Sub

End If


'update rates
'copy year
Sheets("PRRate").Range("j1") = Sheets("TaxRate").Range("j1").Value
'copy employment tax
Sheets("PRRate").Range("c3", "J6") = Sheets("TaxRate").Range("c3", "J6").Value
'copy federal deduction
Sheets("PRRate").Range("c11", "e11") = Sheets("TaxRate").Range("c34", "e34").Value

'copy federal rates
Sheets("PRRate").Range("b18", "c24") = Sheets("TaxRate").Range("b12", "c18").Value
Sheets("PRRate").Range("g18", "h24") = Sheets("TaxRate").Range("g12", "h18").Value
' copy state rates
Sheets("PRRate").Range("b32", "c39") = Sheets("TaxRate").Range("b23", "c30").Value
Sheets("PRRate").Range("g32", "h39") = Sheets("TaxRate").Range("g23", "h30").Value
'copy state deduction
Sheets("PRRate").Range("e41") = Sheets("TaxRate").Range("C39").Value
Sheets("PRRate").Range("e42") = Sheets("TaxRate").Range("D39").Value
Sheets("PRRate").Range("e49") = Sheets("TaxRate").Range("E39").Value


If Sheets("TaxRate").Range("e4") = "" Then

Sheets("TaxRate").Range("e4") = "Local"

End If

If Sheets("TaxRate").Range("h4") = "" Then

Sheets("TaxRate").Range("h4") = "Other"

End If


MsgBox ("Setup New Tax Rates Completed!")

' Return to Main Menu
'
   
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
   
    Sheets("Main").Select
    
Application.ScreenUpdating = True

    'Range("I13").Select
    ThisWorkbook.Save

Application.EnableCancelKey = xlInterrupt

  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"

End Sub
Attribute VB_Name = "Module70"
Attribute VB_Name = "Module71"
Option Explicit
Attribute VB_Name = "Module73"
Private Sub WageReport()

Sheets("Reports").Select
Range("j9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value
Range("n9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 7)) = Range(Sheets("Qreport").Range("AG3"), Sheets("Qreport").Range("AG3").Offset(Sheets("Qreport").Range("A1").Value, 7)).Value

End Sub

Private Sub HourReport()
Sheets("Reports").Select

Range("x9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 2)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 2)).Value
Range("aa9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 7)) = Range(Sheets("Qreport").Range("AO3"), Sheets("Qreport").Range("AO3").Offset(Sheets("Qreport").Range("A1").Value, 7)).Value

End Sub

Private Sub StateReport()
Sheets("Reports").Select

Range("AL9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value

Range("AP9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 0)) = Range(Sheets("Qreport").Range("F3"), Sheets("Qreport").Range("F3").Offset(Sheets("Qreport").Range("A1").Value, 0)).Value

Range("AQ9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 0)) = Range(Sheets("Qreport").Range("M3"), Sheets("Qreport").Range("M3").Offset(Sheets("Qreport").Range("A1").Value, 0)).Value

End Sub

Private Sub DeductionReport()
Sheets("Reports").Select

Range("BB9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 2)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 2)).Value
Range("BE9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("O3"), Sheets("Qreport").Range("O3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value

End Sub


Private Sub VacationReport()

Dim eecount As Integer
Dim copycount As Integer

eecount = Sheets("Selection1").Range("AB2").Value
copycount = 1

Sheets("Reports").Select

Range("at9").Select
Range(Selection, Selection.Offset(eecount - 1, 0)) = Range(Sheets("DBase1").Range("A2"), Sheets("DBase1").Range("A2").Offset(eecount - 1, 0)).Value
Range("au9").Select
Range(Selection, Selection.Offset(eecount - 1, 0)) = Range(Sheets("DBase1").Range("c2"), Sheets("DBase1").Range("c2").Offset(eecount - 1, 0)).Value
Range("av9").Select
Range(Selection, Selection.Offset(eecount - 1, 0)) = Range(Sheets("DBase1").Range("i2"), Sheets("DBase1").Range("i2").Offset(eecount - 1, 0)).Value
Range("ax9").Select
Range(Selection, Selection.Offset(eecount - 1, 0)) = Range(Sheets("DBase1").Range("m2"), Sheets("DBase1").Range("m2").Offset(eecount - 1, 0)).Value


'Range("as9").Select
'Range(Selection, Selection.Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Range(Sheets("DBase1").Range("L2"), Sheets("DBase1").Range("L2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value

Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Do Until copycount > eecount

Sheets("Selection1").Range("V3") = Sheets("Reports").Range("at8").Offset(copycount, 0).Value
Sheets("Reports").Range("at8").Offset(copycount, 3) = Sheets("Setup").Range("AA33").Value
'Range("AY8").Select
'Selection.Offset(copycount, 0) = Selection.Offset(copycount, -1).Value - Selection.Offset(copycount, -2).Value
Sheets("Reports").Range("at8").Offset(copycount, 5) = Sheets("Setup").Range("AA34").Value
Sheets("Reports").Range("at8").Offset(copycount, 6) = Sheets("Setup").Range("AA35").Value

copycount = copycount + 1


Loop


Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True


End Sub

Private Sub sumreports()

'sum total

Sheets("Reports").Select

Cells(8, Sheets("Setup").Range("AB77").Value - 1).Select

    Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
    ActiveCell.Formula = "Total"


'Range("c4", "t" & Cells(1, "aa").Value + 3).Select

Range(Cells(Sheets("Setup").Range("AB78").Value, Sheets("Setup").Range("AB77").Value), Cells(Sheets("Setup").Range("AC78").Value, Sheets("Setup").Range("AC77").Value)).Select


    Dim source As Range
    Dim iCol As Long
    Dim nCol As Long
    Dim nRow As Long
 
    Set source = Selection
 
    nCol = source.Columns.Count
    nRow = source.Rows.Count
    For iCol = 1 To nCol
        With source.Columns(iCol).Rows(nRow).Offset(1, 0)
            .FormulaR1C1 = "=SUM(R[-" & nRow & "]C:R[-1]C)"
           ' .Font.Bold = True
        End With
    Next iCol


If Sheets("Setup").Range("AA74") = 12 Then

Range(Cells(Sheets("Setup").Range("AC78") + 1, "BS"), Cells(Sheets("Setup").Range("AC78") + 1, "BT")).ClearContents

End If




End Sub

Private Sub Workcom()

Sheets("Reports").Select
Range("bj9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value
Range("bw9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 2)) = Range(Sheets("Qreport").Range("AO3"), Sheets("Qreport").Range("AO3").Offset(Sheets("Qreport").Range("A1").Value, 2)).Value

Range("BW2", "CE2").Select
Selection.Copy

Range("BN9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value - 1, 8)).Select

ActiveSheet.Paste
Application.CutCopyMode = False



End Sub



Private Sub Kreport()

Sheets("Reports").Select
Range("CG9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value

Range("CK9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 0)) = Range(Sheets("Qreport").Range("O3"), Sheets("Qreport").Range("O3").Offset(Sheets("Qreport").Range("A1").Value, 0)).Value

Range("CQ2", "CV2").Select
Selection.Copy

Range("CL9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value - 1, 5)).Select

ActiveSheet.Paste
Application.CutCopyMode = False



End Sub



Private Sub registersum()

Sheets("Reports").Select

Range("CY9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 3)) = Range(Sheets("Qreport").Range("A3"), Sheets("Qreport").Range("A3").Offset(Sheets("Qreport").Range("A1").Value, 3)).Value

Range("DC9").Select
Range(Selection, Selection.Offset(Sheets("Qreport").Range("A1").Value, 9)) = Range(Sheets("Qreport").Range("J3"), Sheets("Qreport").Range("J3").Offset(Sheets("Qreport").Range("A1").Value, 9)).Value


End Sub






Attribute VB_Name = "Module74"
Private Sub CheckAdjustment()

If Sheets("Selection1").Range("AD1") = 2 Then

MsgBox ("This is for standard check alignment! You selected customized check format")
Exit Sub
End If

MsgBox ("Make sure to make a test print before change the stardard check setup!")


   Dim AnswerYN6 As String
   AnswerYN6 = MsgBox("Are you sure you want to make some changes of check?", vbYesNo, "Warning")
    If AnswerYN6 = vbNo Then
        Exit Sub
    End If


If Sheets("Setup").Range("AA93") = 1 Then
Sheets("QBCK").Visible = True
Sheets("QBCK").Select
End If

If Sheets("Setup").Range("AA93") = 2 Then
Sheets("QKNCK").Visible = True
Sheets("QKNCK").Select
End If

If Sheets("Setup").Range("AA93") = 3 Then
Sheets("PTCK").Visible = True
Sheets("PTCK").Select
End If

If Sheets("Setup").Range("AA93") = 4 Then
Sheets("GPCK").Visible = True
Sheets("GPCK").Select
End If

If Sheets("Setup").Range("AA93") = 5 Then
Sheets("SBTCK").Visible = True
Sheets("SBTCK").Select
End If

If Sheets("Setup").Range("AA93") = 6 Then
Sheets("PFWCK").Visible = True
Sheets("PFWCK").Select
End If

If Sheets("Setup").Range("AA93") = 7 Then
Sheets("OTHCK").Visible = True
Sheets("OTHCK").Select
End If

Sheets("Setup").Visible = xlVeryHidden

End Sub
Private Sub Return7()
Sheets("Setup").Visible = True
Sheets("Setup").Select
    Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHidden
    Sheets("PPRChck").Visible = xlVeryHidden

End Sub

Attribute VB_Name = "Module8"
Private Sub CancelRateSetup()


   Dim Answer7 As String
    Answer7 = MsgBox("Are sure to abort the Tax Rate Setup?", vbYesNo, "Abort Tax Rate Setup?")
    
    If Answer7 = vbNo Then
    Exit Sub
    End If
    
Application.EnableCancelKey = xlDisabled
    
'copy from PPRate data back to TaxRate Reserve area
    'copy year
Sheets("TaxRate").Range("bj1") = Sheets("PRRate").Range("j1").Value
'copy employment tax
Sheets("TaxRate").Range("bc5", "bJ6") = Sheets("PRRate").Range("c5", "J6").Value
'copy federal deduction
Sheets("TaxRate").Range("bc34", "be34") = Sheets("PRRate").Range("c11", "e11").Value
'copy federal rates
Sheets("TaxRate").Range("bb12", "bc17") = Sheets("PRRate").Range("b18", "c23").Value
Sheets("TaxRate").Range("bg12", "bh17") = Sheets("PRRate").Range("g18", "h23").Value
' copy state rates
Sheets("TaxRate").Range("bb23", "bc29") = Sheets("PRRate").Range("b32", "c38").Value
Sheets("TaxRate").Range("bg23", "bh29") = Sheets("PRRate").Range("g32", "h38").Value
'copy state deduction
Sheets("TaxRate").Range("bC39") = Sheets("PRRate").Range("e41").Value
Sheets("TaxRate").Range("bD39") = Sheets("PRRate").Range("e42").Value
Sheets("TaxRate").Range("bE39") = Sheets("PRRate").Range("e49").Value

    
'copy back

Sheets("TaxRate").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("TaxRate").Range("BB1:BK29").Copy Destination:=Sheets("TaxRate").Range("B1:K29")
    Application.CutCopyMode = False

Sheets("TaxRate").Range("Bc34:Bf34").Copy Destination:=Sheets("TaxRate").Range("c34:f34")
    Application.CutCopyMode = False

Sheets("TaxRate").Range("Bc39:bf39").Copy Destination:=Sheets("TaxRate").Range("c39:f39")
    Application.CutCopyMode = False

Sheets("TaxRate").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
        
MsgBox ("Tax Rate Setup Canceled")
    
   Sheets("Main").Visible = True
      ActiveSheet.Visible = xlVeryHidden
       Sheets("Main").Select

Application.EnableCancelKey = xlInterrupt


End Sub
Attribute VB_Name = "Module9"
Private Sub TaxRateUpdate()

If Sheets("Setup").Range("Bk5") = True Then

MsgBox ("Tax Table Not Found! Enter Rates Manually or contact ExcelPayroll.Org")
Exit Sub

End If

Application.ScreenUpdating = False

Application.EnableCancelKey = xlDisabled

Dim filepath1 As String
Dim taxratefile As String

filepath1 = Sheets("Setup").Range("E10").Value
taxratefile = Sheets("Setup").Range("BJ5").Value


Workbooks.Open filepath1 & taxratefile
Windows(taxratefile).Activate
'Range("A1").Select

If Range("A1") <> "zzzm66" Then

MsgBox ("Tax Table Does Not Exist or File Damaged! Enter Rates Manually or Contact ExcelPayroll.Org")

ActiveWorkbook.Saved = True
ActiveWorkbook.Close
Application.ScreenUpdating = True

Exit Sub
End If

If Range("A2") <> taxratefile Then

MsgBox ("The Payroll year you selected does not match the table! Please select the payroll before import tax rates")

ActiveWorkbook.Saved = True
ActiveWorkbook.Close
Application.ScreenUpdating = True

Exit Sub
End If

Windows(taxratefile).Activate
Range("C43:C44").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("AA3:AA4").Select
ActiveSheet.Paste
Application.CutCopyMode = False



Windows(taxratefile).Activate
Range("J1").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("J1").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("e4").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("e4").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("h4").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("h4").Select
ActiveSheet.Paste
Application.CutCopyMode = False


Windows(taxratefile).Activate
Range("C5:J6").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("C5:J6").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("B12:C18").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("B12:C18").Select
ActiveSheet.Paste
Application.CutCopyMode = False


Windows(taxratefile).Activate
Range("G12:H18").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("G12:H18").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("b23:c30").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("b23:c30").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("g23:h30").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("g23:h30").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("c34:e34").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("c34:e34").Select
ActiveSheet.Paste
Application.CutCopyMode = False

Windows(taxratefile).Activate
Range("c39:e40").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("c39:e40").Select
ActiveSheet.Paste
Application.CutCopyMode = False


'continue copy special state tax table

Sheets("TaxRate").Unprotect Password:=Sheets("Setup").Range("AA8").Value


    Columns("CZ:DP").Select
    Selection.EntireColumn.Hidden = False

Windows(taxratefile).Activate
Range("DA3:DO50").Select
Selection.Copy
ThisWorkbook.Activate
Sheets("TaxRate").Select
Range("DA3:DO50").Select
ActiveSheet.Paste
Application.CutCopyMode = False

    Columns("DA:DO").Select
    Selection.EntireColumn.Hidden = True


Sheets("TaxRate").Range("A1").Select
Sheets("TaxRate").Protect Password:=Sheets("Setup").Range("AA8").Value


Windows(taxratefile).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

ThisWorkbook.Activate
Application.Run "Taxratesetup"

Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt


End Sub

Attribute VB_Name = "Sheet1"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet10"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet11"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Addemployee, 21, 0, MSForms, CommandButton"
Attribute VB_Control = "Editemployee, 22, 1, MSForms, CommandButton"
Attribute VB_Control = "Deleteemployee, 23, 2, MSForms, CommandButton"
Attribute VB_Control = "DataEntry1, 24, 3, MSForms, CommandButton"
Attribute VB_Control = "Payinbatch, 25, 4, MSForms, CommandButton"
Attribute VB_Control = "Qreport, 26, 5, MSForms, CommandButton"
Attribute VB_Control = "ViewEmployees, 27, 6, MSForms, Image"
Attribute VB_Control = "Reviewrecord, 28, 7, MSForms, Image"
Attribute VB_Control = "ViewRegister, 29, 8, MSForms, Image"
Attribute VB_Control = "JournalEntry, 30, 9, MSForms, Image"
Option Explicit
Private Sub Worksheet_SelectionChange(ByVal Target As Range)
     'check cells for desired format to trigger the calendarfrm.show routine
     'otherwise exit the sub
    If ActiveCell.Address = "$D$8" Or ActiveCell.Address = "$D$9" Then
    
                CalendarFrm.Show
            
    End If
 
End Sub



Private Sub Addemployee_Click()
'
'test if the program being changed or damaged
ActiveWindow.DisplayWorkbookTabs = False

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If



' To display the Adding Sheet
'
 Sheets("Adding").Visible = True
 
    Sheets("Adding").Select
        
 Sheets("Adding").Range("e14").Value = Date
         
    Sheets("Adding").Cells(1, "y").Value = Sheets("Adding").Cells(1, "X").Value + 1
    Sheets("Adding").Range("E4").Select
    Sheets("selection1").Visible = xlVeryHidden

End Sub

Private Sub DataEntry1_Click()
ActiveWindow.DisplayWorkbookTabs = False
'restore the format

Sheets("Entry1").Range("bj2") = Sheets("Entry1").Range("g5").Value

Sheets("Entry1").Range("bj1:bj2").Copy Destination:=Sheets("Entry1").Range("g4")
Application.CutCopyMode = False

Sheets("Entry1").Range("bj4:bj6").Copy Destination:=Sheets("Entry1").Range("g7")
Application.CutCopyMode = False



'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If




' to test the expiration before starts the program

If Sheets("Setup").Range("AH6") = False Then


Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Visit ExcelPayroll.Org for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used or Expired! Help at ExcelPayroll.Org"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value

MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If



If Sheets("Setup").Range("ac11") = True Then

Sheets("Reports").Range("f9:f129").ClearContents

End If



'normal code start

If Sheets("Selection1").Range("j4") <> "" Then

   Dim AnswerYN9 As String
    
   AnswerYN9 = MsgBox("Employee Terminated! Continue Your Selection?", vbYesNo, "Warning")
    If AnswerYN9 = vbNo Then
        Exit Sub
    End If

End If



Sheets("Setup").Range("z11") = Sheets("Setup").Range("z11") + Sheets("Setup").Range("ab11").Value



' DataEntry1 Macro

Application.ScreenUpdating = False

'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Del}", ""
'  Application.OnKey "^%{Break}", ""
'Application.OnKey "^{Break}", ""

'to unselect block all deductions
Sheets("Entry1").Range("p49:p52") = False


Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

'to select the weeks

Sheets("TimeCard").Range("AC6", "AC10") = True
'Sheets("TimeCard").Range("AC7", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "DC100") = Sheets("WeekTime").Range("DS1", "hc100").Value
'Sheets("WeekTime").Range("Ak1", "dc201").ClearContents


If Sheets("Setup").Range("y1").Value = 1 Then

Sheets("TimeCard").Range("AC6") = True
Sheets("TimeCard").Range("AC7", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "AI100") = Sheets("WeekTime").Range("DS1", "EI100").Value

Sheets("WeekTime").Range("Ak1", "dc201").ClearContents

End If

If Sheets("Setup").Range("y1").Value = 2 Then

Sheets("TimeCard").Range("AC6", "AC7") = True
Sheets("TimeCard").Range("AC8", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "BA100") = Sheets("WeekTime").Range("DS1", "FA100").Value

Sheets("WeekTime").Range("BC1", "dc201").ClearContents

End If

'to start entry
Sheets("WeekTime").Range("B2", "C201").ClearContents

Sheets("WeekTime").Range(Sheets("WeekTime").Range("C2"), Sheets("WeekTime").Range("C2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Sheets("DBase1").Range(Sheets("DBase1").Range("A2"), Sheets("DBase1").Range("A2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value
Sheets("WeekTime").Range(Sheets("WeekTime").Range("B2"), Sheets("WeekTime").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Sheets("DBase1").Range(Sheets("DBase1").Range("B2"), Sheets("DBase1").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value

 If Sheets("Selection1").Range("ay1") <> 1 Then
 
  Sheets("Selection1").Range("BC1").Select
 
 Selection.Offset(Range("AZ1").Value, 0).Value = Sheets("Selection1").Range("V3").Value
 
End If



Dim Emunber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
Emunber = Sheets("Selection1").Cells(3, "V").Value


'Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Selection1").Columns("BC").Select

Selection.Find(What:=Emunber, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select




Sheets("Selection1").Range("Az2") = Selection.Offset(0, 8).Value
Sheets("Selection1").Range("Az3") = Selection.Offset(0, 9).Value
Sheets("Selection1").Range("Az4") = Selection.Offset(0, 10).Value
Sheets("Selection1").Range("Az5") = Selection.Offset(0, 11).Value
Sheets("Selection1").Range("Az6") = Selection.Offset(0, 12).Value


Sheets("Selection1").Range("A1").Select

Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True



'Sheets("Selection1").Select


'Application.ScreenUpdating = False
   
    Sheets("Entry1").Visible = True
    Sheets("Entry1").Select
    
Sheets("Entry1").Range("j4", "j13").ClearContents
Sheets("Entry1").Range("g9").ClearContents
Sheets("Entry1").Range("q23", "q31").ClearContents
Sheets("Entry1").Range("q33", "q41").ClearContents
Sheets("Entry1").Range("e12", "g20").ClearContents
Sheets("Entry1").Range("ba1:bc9").ClearContents
            
      
    Sheets("Entry1").Range("b4").Value = Sheets("Selection1").Range("I4").Value
    Sheets("Entry1").Range("b5").Value = Sheets("Selection1").Range("I6").Value
    Sheets("Entry1").Range("b6:b8").Value = Sheets("Selection1").Range("I7:I9").Value
    Sheets("Entry1").Range("b9").Value = Sheets("Selection1").Range("z29").Value
    
    Sheets("Entry1").Range("BF1") = Sheets("Entry1").Range("g5").Value
    Sheets("Entry1").Range("BG1") = Sheets("Entry1").Range("G4").Value
    
    Sheets("Entry1").Range("ba1").Value = Sheets("Selection1").Range("Az2").Value
    Sheets("Entry1").Range("ba2").Value = Sheets("Selection1").Range("Az3").Value
    Sheets("Entry1").Range("ba3").Value = Sheets("Selection1").Range("Az4").Value
    Sheets("Entry1").Range("ba4").Value = Sheets("Selection1").Range("Az5").Value
   Sheets("Entry1").Range("ba5").Value = Sheets("Selection1").Range("Az6").Value

'copy index code

 Sheets("Entry1").Range("q23", "q27").Value = Sheets("Entry1").Range("t23", "t27").Value

'copy the date and the rate
Sheets("Entry1").Range("g4") = Date
Sheets("Entry1").Range("BE1").Value = Sheets("selection1").Range("v17").Value
Sheets("Entry1").Range("g9").Value = Sheets("selection1").Range("v17").Value
   
'copy amount
Sheets("Entry1").Range("BC1", "BC9").Value = Sheets("Entry1").Range("P20", "P28").Value
Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("BC1", "BC9").Value
  
  
   
   Sheets("Entry1").Range("BA1:BC9").Copy Destination:=Sheets("Entry1").Range("E12:G20")
    
    Application.CutCopyMode = False
    
  'to open the record file

  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value


   'select data to copy to entry1 sheet
   
    Windows(prfile2).Activate
    
    
    If Sheets("MRegister").Range("AK1").Value >= 3645 Then
    
    MsgBox ("Reached Maximum Payroll this Year; Please Close the Payroll Year and Rerun!")
    
         ActiveWorkbook.Saved = True
         ActiveWorkbook.Close
    ThisWorkbook.Activate
    Sheets("Entry1").Visible = xlVeryHidden
        
    Sheets("Selection1").Select
    
  
    Exit Sub
    
    
    End If
            
    
    Sheets(Emunber).Select
    Sheets(Emunber).Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
    
Sheets(Emunber).Range(Selection.Offset(4, 0), Selection.Offset(4, 25)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    
      
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Sheets("Entry1").Range("S1").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'copy last payment info

    
    Windows(prfile2).Activate
    
    Sheets(Emunber).Select
    Sheets(Emunber).Range("E2").Select
    Selection.End(xlDown).Select
   
    
Sheets(Emunber).Range(Selection.Offset(0, -3), Selection.Offset(0, 26)).Select
Selection.Copy
    
    
    'Windows("Current File Name.xlsm").Activate
    

    
    Windows(prfile1).Activate
        
    Sheets("Entry1").Select
    Sheets("Entry1").Range("S2").Select
        
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Sheets("Entry1").Range("A1").Select


 Windows(prfile2).Activate
 
 ActiveWorkbook.Saved = True
 ActiveWorkbook.Close
    
'return to Entry1 sheet
       
Windows(prfile1).Activate



Sheets("Entry1").Select
Sheets("Entry1").Range("O2").Value = Sheets("Setup").Range("Y1").Value



Sheets("selection1").Visible = xlVeryHidden
'Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Entry1").Range("e12").Select


Sheets("Entry1").Earningtype.Object.Text = Sheets("Entry1").Range("P33")
Sheets("Entry1").ComboBox1.Object.Text = Sheets("Entry1").Range("P34")
Sheets("Entry1").ComboBox2.Object.Text = Sheets("Entry1").Range("P35")
Sheets("Entry1").ComboBox3.Object.Text = Sheets("Entry1").Range("P36")
Sheets("Entry1").ComboBox4.Object.Text = Sheets("Entry1").Range("P37")
Sheets("Entry1").ComboBox5.Object.Text = ""
Sheets("Entry1").ComboBox6.Object.Text = ""
Sheets("Entry1").ComboBox7.Object.Text = ""
Sheets("Entry1").ComboBox8.Object.Text = ""

'ComboBox3.SelectedIndex = -1
'clean up time entry if it is using trial version

If Sheets("Setup").Range("AO2") < 2000 Then

Sheets("Entry1").Range("E12:G20").ClearContents
Sheets("Entry1").Range("BA1:BC9").ClearContents
Sheets("Entry1").Range("q23", "q31").ClearContents
Sheets("Entry1").Range("q33", "q41").ClearContents

Sheets("Entry1").Earningtype.Object.Text = ""
Sheets("Entry1").ComboBox1.Object.Text = ""
Sheets("Entry1").ComboBox2.Object.Text = ""
Sheets("Entry1").ComboBox3.Object.Text = ""
Sheets("Entry1").ComboBox4.Object.Text = ""

End If

Sheets("Entry1").Range("P44:P45").ClearContents
Sheets("Entry1").Range("g7:g8").ClearContents

Application.ScreenUpdating = True
Sheets("Entry1").Range("e12").Select


'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^%{Del}"

End Sub

Private Sub Deleteemployee_Click()
ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If




If Sheets("Selection1").Range("AB2") < 2 Then

MsgBox ("Only One Emplyee! You Must Add One Before You May Delete This One!")

Exit Sub

End If


   Dim AnswerYN1 As String
    
   AnswerYN1 = MsgBox("Are you sure that you want to delete this record?", vbYesNo, "Warning")
    If AnswerYN1 = vbNo Then
        Exit Sub
    End If
    
    
   
 'To open the record
 
Application.EnableCancelKey = xlDisabled


Dim prfile2 As String
Dim filepath As String
Dim SRecord1 As String
    
    
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
 SRecord1 = Sheets("Selection1").Range("i4").Value
    
 
Application.ScreenUpdating = False
  

Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
       
  'select the employee record sheet
   
    Windows(prfile2).Activate
    Sheets(SRecord1).Select

If Sheets(SRecord1).Cells(2, "A") > 0 Then
    
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

MsgBox ("Activities found for this employee! Unable to Delete. Please do it after year closed")

Exit Sub
End If

Application.DisplayAlerts = False
ActiveWindow.SelectedSheets.Delete
Application.DisplayAlerts = True

   ActiveWorkbook.Save
   ActiveWorkbook.Close
 
ThisWorkbook.Activate
    
    
' start deleting


Sheets("Selection1").Select

    
     Sheets("Dbase1").Visible = True
     
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Dbase1").Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.EntireRow.Select
Selection.Delete


Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("Dbase1").Visible = xlVeryHidden

Sheets("Selection1").Select

Application.Run "Macro3"

Sheets("Selection1").Range("V3") = Range("V2").Value

Application.EnableCancelKey = xlInterrupt


Application.ScreenUpdating = True


End Sub

Private Sub Editemployee_Click()

ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If

Application.EnableCancelKey = xlDisabled

 Sheets("editing").Visible = True
 
Sheets("editing").Select

Sheets("editing").Range("e4:e5").Value = Sheets("Selection1").Range("ac5:ac6").Value

Sheets("editing").Range("e6:e11").Value = Sheets("Selection1").Range("aa7:aa12").Value

Sheets("editing").Range("o16").Value = Sheets("Selection1").Range("z13").Value
Sheets("editing").Range("Q101").Value = Sheets("Selection1").Range("z14").Value
Sheets("editing").Range("p16").Value = Sheets("Selection1").Range("z27").Value
Sheets("editing").Range("Q102").Value = Sheets("Selection1").Range("z28").Value





Sheets("editing").Range("e14:e15").Value = Sheets("Selection1").Range("aa15:aa16").Value



Sheets("editing").Range("f16").Value = Sheets("Selection1").Range("z17").Value

Sheets("editing").Range("e17:e21").Value = Sheets("Selection1").Range("aa18:aa22").Value

Sheets("editing").Range("f18:f21").Value = Sheets("Selection1").Range("ac19:ac22").Value

Sheets("editing").Range("z7").Value = Sheets("Selection1").Range("ac23").Value

Sheets("editing").Range("g18:g21").Value = Sheets("Selection1").Range("aa23:aa27").Value

Sheets("editing").Range("f9") = Sheets("editing").Range("p9").Value


Sheets("selection1").Visible = xlVeryHidden
Application.EnableCancelKey = xlInterrupt

End Sub

Private Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Sheets("Selection1").Range("d8").Select
Selection.Activate
Application.Run ("OpenCalendar")
End Sub


Private Sub Image2_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Sheets("Selection1").Range("d9").Select
Selection.Activate
Application.Run ("OpenCalendar")
End Sub

Private Sub JournalEntry_Click()
'test if the program being changed or damaged
ActiveWindow.DisplayWorkbookTabs = False

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If


Application.EnableCancelKey = xlDisabled


Application.ScreenUpdating = False


Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String

    
 prfile1 = Worksheets("setup").Range("B10").Value
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
        
  'to open the record file
  
Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value

  'copy register
 ThisWorkbook.Activate
 Sheets("PRRegister").Visible = True
 Sheets("JournalEntry").Visible = True
 Application.EnableCancelKey = xlDisabled

Sheets("PRRegister").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("PRRegister").Select

Windows(prfile2).Activate
Sheets("MRegister").Select
Sheets("MRegister").Range("H3651", "AC3667").Select
Selection.Copy
  
 ThisWorkbook.Activate

Sheets("PRRegister").Select
Sheets("PRRegister").Range("B2").Select

Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False
Sheets("PRRegister").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("PRRegister").Visible = xlVeryHidden
Sheets("Selection1").Visible = xlVeryHidden

Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate

Sheets("JournalEntry").Select
Sheets("JournalEntry").Range("A1").Select
Application.ScreenUpdating = True

Application.EnableCancelKey = xlInterrupt



End Sub

Private Sub Payinbatch_Click()

ActiveWindow.DisplayWorkbookTabs = False

 Application.Run "macro3"

Sheets("timecard").Range("al1") = False
Sheets("timecard").Range("aj2:aj204") = False
Sheets("timecard").Range("ak2:ak204") = 0

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If

Application.EnableCancelKey = xlDisabled


Application.ScreenUpdating = False

'to unselect block all deductions
Sheets("Entry1").Range("p49:p52") = False


If Sheets("Setup").Range("AG2") = False Then

Sheets("TimeCard").Range("AC6", "AC10").ClearContents
Sheets("WeekTime").Range("S1", "DC100").ClearContents


End If



'To test the expiration before starts the program

If Sheets("Setup").Range("AH6") = False Then



Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "Ask DanielChao@hotmail.Com for help")

If Sheets("Setup").Range("ah3") = False Then

MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org to get a new one"

Exit Sub

End If

If Sheets("Setup").Range("ah5") = False Then

MsgBox "The Code Already Used and Expired! Visit ExcelPayroll.Org"

Exit Sub

End If

Sheets("Setup").Range("ak2") = Date

If Sheets("Setup").Range("am3").Value >= 15 Then

Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value

End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If



'normal code start


'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
'  Application.OnKey "^{Break}", ""
'  Application.OnKey "^%{Del}", ""

Sheets("Entry1").Range("P44:P45").ClearContents
Sheets("Entry1").Range("g7:g8").ClearContents

Sheets("WeekTime").Range("B2", "C201").ClearContents
Sheets("WeekTime").Range(Sheets("WeekTime").Range("C2"), Sheets("WeekTime").Range("C2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Sheets("DBase1").Range(Sheets("DBase1").Range("A2"), Sheets("DBase1").Range("A2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value
Sheets("WeekTime").Range(Sheets("WeekTime").Range("B2"), Sheets("WeekTime").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)) = Sheets("DBase1").Range(Sheets("DBase1").Range("B2"), Sheets("DBase1").Range("B2").Offset(Sheets("Selection1").Range("AB2").Value - 1, 0)).Value

Sheets("Selection1").Visible = True



If Sheets("Selection1").Range("AB2").Value > 200 Then

MsgBox "You have total " & (Sheets("Selection1").Range("AB2").Value) & " employees in database." & vbCrLf & "The maximum in batch is 200." & vbCrLf & "You may select individually to pay the other employees"

End If

Sheets("Selection1").Select
Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Selection1").Range("CA2", "CA500").ClearContents

Sheets("TimeCard").Visible = True
Sheets("DBase1").Visible = True
Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Dbase1").Range("A2").Select
Sheets("Dbase1").Range(Selection, Selection.Offset(Sheets("Selection1").Range("AD2").Value - 1, 0)).Select
Selection.Copy
Sheets("Selection1").Select
Sheets("Selection1").Range("CA2").Select

 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

'ActiveSheet.Paste
 Application.CutCopyMode = False
 

Sheets("TimeCard").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("TimeCard").Range("S6") = Date
Sheets("TimeCard").Range("S7") = Sheets("Entry1").Range("G5")

Sheets("TimeCard").Range("B2", "C204").ClearContents
Sheets("TimeCard").Range("K2", "O204").ClearContents

'transfer time to selection page

Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
 
Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Selection1").Visible = xlVeryHidden


Sheets("TimeCard").Range("B2", "C204") = Sheets("Selection1").Range("CI2", "CJ204").Value
Sheets("TimeCard").Range("K2", "O204") = Sheets("Selection1").Range("CK2", "CO204").Value

   
ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("DBase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("DBase1").Visible = xlVeryHidden



'backup data

Sheets("TimeCard").Range("CK2:CO204") = Sheets("TimeCard").Range("K2:O204").Value
Sheets("TimeCard").Range("CS6:CS7") = Sheets("TimeCard").Range("S6:S7").Value

'copy format back

Sheets("TimeCard").Range("CK2:CO204").Copy Destination:=Sheets("TimeCard").Range("K2:O204")
    Application.CutCopyMode = False

Sheets("TimeCard").Range("CS6:CS7").Copy Destination:=Sheets("TimeCard").Range("S6:S7")

    Application.CutCopyMode = False

'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^{Break}"
'  Application.OnKey "^%{Del}"

Application.ScreenUpdating = True
Sheets("TimeCard").Range("A1").Select

Sheets("TimeCard").Range("K2").Select


End Sub

Private Sub Qreport_Click()

ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If




If Sheets("Selection1").Range("AI1") = True Then

MsgBox ("Date Error! Please Re-enter or Select a Period!")
Exit Sub

End If



If Sheets("Setup").Range("AA74") = 10 Then
Application.Run ("PW2_Click")
Exit Sub
End If


'set the 1st date of the year and the current date as the last day for vacation balance
If Sheets("Setup").Range("AA74") = 7 Then

Sheets("Setup").Range("AB74") = Sheets("Setup").Range("AB72").Value
Sheets("Setup").Range("AB75") = Date

End If


'make sure the first date is before the ending date

If Sheets("Setup").Cells(54, "AA").Value <> Sheets("Setup").Cells(73, "AB") Then

MsgBox ("Date Error, Range must be within the Payroll Year!")

Exit Sub

End If



If Sheets("Selection1").Cells(8, "d").Value > Sheets("Selection1").Cells(9, "d") Then

MsgBox ("Error! The Ending Date Must be Greater than the Beginning Date!")

Exit Sub

End If


If Sheets("Setup").Range("AA74") = 11 And Sheets("Selection1").Cells(8, "d") <> Sheets("Selection1").Cells(9, "d") Then

    Dim Answer11 As String
    Answer11 = MsgBox("401K Report Should be One Paydate Only! Continue Report Anyway?", vbYesNo, "Alert")
    If Answer11 = vbNo Then
    Exit Sub
    End If

End If



If Sheets("Reports").Range("f18") = "" Or Sheets("PRCalculator").Range("A15") > 10 Or Sheets("Setup").Range("z11") > 10 Then

    Dim Answer99 As String
    Answer99 = MsgBox("Program was illegally Modified! Reports May Not Be Correct", vbYesNo, "Warning! Continue?")
    If Answer99 = vbNo Then
    Exit Sub
    End If

End If










'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
'  Application.OnKey "^{Break}", ""
'  Application.OnKey "^%{Del}", ""

'to display processing



Sheets("Processing").Visible = True


Sheets("Processing").Range("BB1") = 5
Sheets("Processing").Range("Ba1") = 0
Sheets("Processing").Range("Ba2") = Sheets("Selection1").Range("ab2").Value + 2
Sheets("Processing").Select

Application.ScreenUpdating = False


Sheets("Setup").Range("AB74:AB75").Value = Sheets("Selection1").Range("D8:D9").Value
Sheets("Qreport").Range("A3:AZ3660").ClearContents
Sheets("Reports").Range("J9:DL3660").ClearContents

Dim enumber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim totalnumber As Integer
Dim currentnumber As Integer
Dim reportbook As String


Dim firstdate As Single
Dim lastdate As Single
Dim ETTax As Single


'Dim currentquarter As Integer

firstdate = Sheets("Setup").Range("AB74").Value
lastdate = Sheets("Setup").Range("AB75").Value


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value
totalnumber = Sheets("Selection1").Cells(2, "AB").Value
currentnumber = 1
   
  'to open the record file
  
 

  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
 

 Windows(prfile2).Activate
 
  Sheets("Setup2").Range("B11") = firstdate
 Sheets("Setup2").Range("B12") = lastdate


ETTax = Sheets("MRegister").Range("Y3670").Value



'to display processing
 ThisWorkbook.Activate
 

 Sheets("Processing").Select
  'Sheets("Processing").Visible = True
Application.ScreenUpdating = True

Sheets("Processing").Range("Ba1") = currentnumber

Application.ScreenUpdating = False
    
  Sheets("QReport").Visible = True
Sheets("QReport").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("Reports").Visible = True
Sheets("Reports").Unprotect Password:=Sheets("Setup").Range("AA8").Value


Sheets("Qreport").Range("AY1") = ETTax

    
      Do Until totalnumber = 0
     
      'select data to copy to report sheet
   
   ThisWorkbook.Activate
   
   enumber = Sheets("DBase1").Range("A1").Offset(currentnumber, 0).Value
      
   
    Windows(prfile2).Activate
          
    Sheets(enumber).Select
    Sheets(enumber).Range("E2").Select
    Selection.End(xlDown).Select
    Selection.End(xlDown).Select
  
  'If Selection.Offset(currentquarter, 0).Value = 0 Then
  
   If Selection.Offset(5, 0).Value = 0 Then
  currentnumber = currentnumber + 1
  totalnumber = totalnumber - 1
  
  Else
    
Sheets(enumber).Range(Selection.Offset(5, 0), Selection.Offset(5, 44)).Select
Selection.Copy
    
    
   ThisWorkbook.Activate


    Sheets("Qreport").Select
    Sheets("Qreport").Range("D1").Select
     Selection.End(xlDown).Select
    Selection.Offset(1, 0).Select
        
       
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

Application.CutCopyMode = False


    Sheets("Qreport").Range("D1").Select
     Selection.End(xlDown).Select
    
Selection.Offset(0, -1) = Sheets("DBase1").Range("A1").Offset(currentnumber, 8)
Selection.Offset(0, -2) = Sheets("DBase1").Range("A1").Offset(currentnumber, 2)
Selection.Offset(0, -3) = Sheets("DBase1").Range("A1").Offset(currentnumber, 0)


  currentnumber = currentnumber + 1
  totalnumber = totalnumber - 1

End If

'to display processing

 ThisWorkbook.Activate
Sheets("Processing").Range("Ba1") = currentnumber
Sheets("Processing").Select
Application.ScreenUpdating = True
Application.ScreenUpdating = False

Loop


Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate

If Sheets("QReport").Range("A1") = 0 Then

MsgBox ("No Transaction Found for the Selected Period; Please Reselect!")

Sheets("Selection1").Visible = True
Sheets("Selection1").Select

Sheets("Processing").Visible = xlVeryHidden

Sheets("QReport").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("QReport").Visible = xlVeryHidden

Sheets("Reports").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Reports").Visible = xlVeryHidden

Application.ScreenUpdating = True

'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^%{Del}"



Exit Sub
End If



Sheets("Reports").Select

If Sheets("Setup").Range("AA74") = 4 Then
Application.Run ("WageReport")
End If


If Sheets("Setup").Range("AA74") = 5 Then
Application.Run ("HourReport")
End If

If Sheets("Setup").Range("AA74") = 6 Then
Application.Run ("StateReport")

End If

If Sheets("Setup").Range("AA74") = 7 Then
Application.Run ("VacationReport")

End If


If Sheets("Setup").Range("AA74") = 8 Then
Application.Run ("DeductionReport")

End If


If Sheets("Setup").Range("AA74") = 11 Then
Application.Run ("Kreport")

End If


If Sheets("Setup").Range("AA74") = 12 Then
Application.Run ("Workcom")

End If




If Sheets("Setup").Range("AA74") = 13 Then

Application.Run ("registersum")

End If





'Exporting reports



If Sheets("Setup").Range("AA74") = 1 Then
Sheets("Reports").Range("B1", "F36").Select
End If

If Sheets("Setup").Range("AA74") = 2 Then
Sheets("Reports").Range("B41", "F69").Select
End If


If Sheets("Setup").Range("AA74") = 3 Then
Sheets("Reports").Range("B80", "F103").Select
End If



If Sheets("Setup").Range("AA74") >= 4 And Sheets("Setup").Range("AA74") <= 8 Or Sheets("Setup").Range("AA74") = 11 Or Sheets("Setup").Range("AA74") = 12 Or Sheets("Setup").Range("AA74") = 13 Then

Application.Run ("sumreports")
Sheets("Reports").Range(Sheets("Reports").Cells(1, Sheets("Setup").Range("AB77").Value - 3), Sheets("Reports").Cells(Sheets("Setup").Range("AC78").Value + 2, Sheets("Setup").Range("AC77").Value)).Select

End If



If Sheets("Setup").Range("AA74") = 9 Then
Sheets("Reports").Range("B106", "F129").Select
End If



    Selection.Copy
    Workbooks.Add
     ActiveSheet.Range("A1").Select
    ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
 Application.CutCopyMode = False

    ActiveSheet.Columns("A:O").Select
    
    ActiveSheet.Columns("F:O").EntireColumn.AutoFit
     ActiveSheet.Columns("A:E").Select
    Selection.ColumnWidth = 11
    ActiveSheet.Range("C5").Select
    
    reportbook = ActiveWorkbook.Name
    

ThisWorkbook.Activate


Sheets("QReport").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("QReport").Visible = xlVeryHidden

Sheets("Reports").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Reports").Visible = xlVeryHidden

Sheets("Processing").Range("Ba1") = currentnumber + 1
Sheets("Processing").Select


Application.ScreenUpdating = True
Application.ScreenUpdating = False

MsgBox ("Report Exported to a New Excel Book1,2,3,4..., Please Check")

Sheets("Selection1").Visible = True
Sheets("Selection1").Select
Sheets("Processing").Visible = xlVeryHidden

Windows(reportbook).Activate


'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^{Break}"
'  Application.OnKey "^%{Del}"

'Application.ScreenUpdating = True



End Sub

Private Sub Reviewrecord_Click()
ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If


'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
 ' Application.OnKey "^{Break}", ""
 ' Application.OnKey "^%{Del}", ""

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String
Dim SRecord1 As String
    
    
 prfile1 = Worksheets("setup").Range("B10").Value
 prfile2 = Worksheets("setup").Range("B7").Value
 filepath = Worksheets("setup").Range("e10").Value
 SRecord1 = Sheets("Selection1").Range("i4").Value
    
 
Application.ScreenUpdating = False
  

Sheets("ViewRecord").Visible = True

    Sheets("ViewRecord").Select
     Sheets("ViewRecord").Unprotect Password:=Sheets("Setup").Range("AA8").Value
    Sheets("ViewRecord").Range("D1", "AH3660").Select
    Selection.ClearContents
        With Selection.Interior
        .Pattern = xlNone
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
    Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    Selection.Borders(xlEdgeLeft).LineStyle = xlNone
    Selection.Borders(xlEdgeTop).LineStyle = xlNone
    Selection.Borders(xlEdgeBottom).LineStyle = xlNone
    Selection.Borders(xlEdgeRight).LineStyle = xlNone
    Selection.Borders(xlInsideVertical).LineStyle = xlNone
    Selection.Borders(xlInsideHorizontal).LineStyle = xlNone
    
    
    Sheets("ViewRecord").Range("DA1", "EW3660").ClearContents
     
     
 Sheets("ViewRecord").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
       
     

Sheets("Selection1").Select

Dim Emunber As String

Emunber = Sheets("Selection1").Cells(3, "V").Value
          
    
  
    
  'to open the record file
  

Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
       
  'select the employee record sheet
   
 Windows(prfile1).Activate
 Sheets("ViewRecord").Unprotect Password:=Sheets("Setup").Range("AA8").Value
 
 
Windows(prfile2).Activate
Sheets(Emunber).Select
Sheets(Emunber).Range("A1", "AE" & Sheets(Emunber).Cells(2, "AE") + 10).Select
Selection.Copy

 Windows(prfile1).Activate
 Sheets("ViewRecord").Select
 Sheets("ViewRecord").Range("D1").Select
ActiveSheet.Paste

Sheets("ViewRecord").Range("D1").Select
 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False

'copy another full record to DA range

    Windows(prfile2).Activate
    Sheets(Emunber).Select

'Range("A:AW").Select
Sheets(Emunber).Range("A1", "AW" & Sheets(Emunber).Cells(2, "AE") + 10).Select

Selection.Copy
 'Windows("PayrollBook.xlsm").Activate
 Windows(prfile1).Activate
 Sheets("ViewRecord").Select
 Sheets("ViewRecord").Range("DA1").Select

 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


    Sheets("ViewRecord").Columns("DA:EW").Select
    Selection.ColumnWidth = 0
    Sheets("ViewRecord").Range("A1").Select

Sheets("ViewRecord").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

   'Windows("Payroll Record.xlsm").Activate
   Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close

 
' to select the selection range

 Sheets("ViewRecord").Unprotect Password:=Sheets("Setup").Range("AA8").Value

      Sheets("ViewRecord").Shapes("List Box 1").Select
      
    With Selection
    
 .ListFillRange = Sheets("ViewRecord").Range("A2").Value
         
        .LinkedCell = "$A$3"
        .MultiSelect = xlNone
        .Display3DShading = False
        
       End With
            
    Sheets("ViewRecord").Range("e4").Select
Sheets("ViewRecord").Range(Selection.Offset(1, 0), Selection.Offset(1, 19)).Select

    With Selection.Interior
        .Pattern = xlSolid
        .PatternColorIndex = xlAutomatic
        .Color = 65535
        .TintAndShade = 0
        .PatternTintAndShade = 0
    End With
            
      Sheets("ViewRecord").Range("A3").Value = 1
                  
            Sheets("ViewRecord").Range("a7").Select
            
    ' to protect the sheet
    
    ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
  
  If Sheets("ViewRecord").Range("D2").Value = 0 Then
  
  MsgBox ("No Payroll Has Made to This Employee! No Record Found!")
  Sheets("ViewRecord").Visible = xlVeryHidden
   Sheets("Selection1").Select
  
  'Application.Run "PRSelection"
    
  Exit Sub
  End If
 
Sheets("Selection1").Visible = xlVeryHidden


'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^%{Del}"


Application.ScreenUpdating = True


End Sub

Private Sub ViewEmployees_Click()

ActiveWindow.DisplayWorkbookTabs = False
'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If


Application.EnableCancelKey = xlDisabled

Application.ScreenUpdating = False

    Sheets("DBase1").Visible = True
    Sheets("Employee").Visible = True
    
    'to unprotect "employee" sheet
   Sheets("Employee").Unprotect Password:=Sheets("Setup").Range("AA8").Value

    Sheets("DBase1").Select
    Sheets("DBase1").Range("MainDbase").Select
    Selection.Copy
    Sheets("Employee").Select
    
   
    Sheets("Employee").Range("A1").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
  Application.CutCopyMode = False
    
    Sheets("Employee").Range("AE2").Formula = "=RC[-21]&""-""&RC[-20]"
    Sheets("Employee").Range("AF2").Formula = "=RC[-3]&""-""&RC[-2]"
    Sheets("Employee").Range("AE2:AF2").Select

    Selection.Copy Destination:=Sheets("employee").Range(Sheets("employee").Cells(2, "AE"), Sheets("employee").Cells(Sheets("selection1").Range("AB2").Value + 1, "AF"))
      Application.CutCopyMode = False
   
    Sheets("Employee").Columns("AE:AF").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False
    
    Sheets("employee").Range(Sheets("employee").Cells(2, "AE"), Sheets("employee").Cells(Sheets("selection1").Range("AB2").Value + 1, "AF")).Select
    Selection.Copy Destination:=Sheets("employee").Range("J2")
    
    Application.CutCopyMode = False
    
    Sheets("employee").Range("J1") = "Federal"
    Sheets("employee").Range("K1") = "State"




    Sheets("Employee").Columns("Y:AF").Select
     Selection.EntireColumn.Delete
     
        Sheets("Employee").Columns("P:W").Select
     Selection.EntireColumn.Delete
     
           Sheets("Employee").Columns("C").Select
     Selection.EntireColumn.Delete
     
     
    Sheets("Employee").Range("B1").Value = "Name"
       
    
    Sheets("Employee").Range("P1") = "Per"
    Sheets("Employee").Range("Q1") = "Type"
    Sheets("Employee").Range("P2").Formula = _
        "=IF(RC[-1]=5,""Year"",IF(RC[-1]=4,""Month"",IF(RC[-1]=3,""Week"",IF(RC[-1]=2,""Day"",""Hour""))))"
    Sheets("Employee").Range("Q2").Formula = "=IF(RC[-2]=1,""Wage"",""Salary"")"
    
    Sheets("Employee").Range("P2:Q2").Select
    Selection.Copy Destination:=Sheets("employee").Range(Sheets("employee").Cells(2, "p"), Sheets("employee").Cells(Sheets("selection1").Range("AB2").Value + 1, "Q"))
      Application.CutCopyMode = False
   
    Sheets("Employee").Columns("P:Q").Select
    Selection.Copy
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Sheets("Employee").Columns("O:O").Select
    Application.CutCopyMode = False
    Selection.Delete Shift:=xlToLeft

        Sheets("Employee").Columns("J:J").Select
    Selection.NumberFormat = "General"
        'Sheets("Employee").Columns("L:L").Select
    'Selection.NumberFormat = "#,##0.00_);(#,##0.00)"

        Sheets("Employee").Columns("N:N").NumberFormat = "#,##0.00_);(#,##0.00)"

        Sheets("Employee").Columns("K:K").Select
    Selection.NumberFormat = "mm/dd/yy;@"

   Sheets("Employee").Range("e1") = "Zip"
    Sheets("Employee").Range("k1") = "DOH"

 Sheets("Employee").Columns("L:L").Select
Selection.Delete Shift:=xlToLeft

 Sheets("Employee").Columns("M:M").Select
    Selection.Style = "Comma"

 Sheets("Employee").Columns("A:O").Select
     With Selection.Font
        .Name = "Arial Narrow"
        .Size = 10

    End With

Sheets("Employee").Columns("A:O").EntireColumn.AutoFit

    Sheets("Employee").Range("B2").Select

'to protect "employee" sheet

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
 
    
    Sheets("Selection1").Visible = xlVeryHidden
      Sheets("DBase1").Visible = xlVeryHidden
      Application.ScreenUpdating = True
      

End Sub

Private Sub ViewRegister_Click()
ActiveWindow.DisplayWorkbookTabs = False

'test if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If


'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
'  Application.OnKey "^{Break}", ""
'  Application.OnKey "^%{Del}", ""

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value



Application.ScreenUpdating = False
Sheets("ViewRegister").Visible = True

    Sheets("ViewRegister").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
Sheets("ViewRegister").Range("A5", "AC3667").ClearContents

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

    
  'to open the record file
  
  Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value


Windows(prfile1).Activate
Sheets("ViewRegister").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value


Windows(prfile2).Activate
       
  'select the employee record sheet
    
    Sheets("MRegister").Select

Dim Reglinenumber As String

Reglinenumber = Sheets("MRegister").Cells(1, "AK").Value
              
Sheets("MRegister").Range("C3").Select

Sheets("MRegister").Range(Selection.Offset(0, 0), Selection.Offset(Reglinenumber, 26)).Select
Selection.Copy



ThisWorkbook.Activate
Sheets("ViewRegister").Select
Sheets("ViewRegister").Range("a5").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    
    Application.CutCopyMode = False




Windows(prfile2).Activate
 Sheets("MRegister").Select
 Sheets("MRegister").Range("D3651", "AC3667").Select
 Selection.Copy
 
Windows(prfile1).Activate
Sheets("ViewRegister").Select

Sheets("ViewRegister").Range("B5").Select
Sheets("ViewRegister").Range(Selection.Offset(Reglinenumber + 1, 0), Selection.Offset(Reglinenumber + 1, 26)).Select

    'ActiveSheet.Paste
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
     Application.CutCopyMode = False
    
    
    'to outline the range
    
Sheets("ViewRegister").Range("A5").Select
Sheets("ViewRegister").Range(Selection.Offset(0, 0), Selection.Offset(Reglinenumber + 17, 26)).Select
    
       Selection.Borders(xlDiagonalDown).LineStyle = xlNone
    Selection.Borders(xlDiagonalUp).LineStyle = xlNone
    With Selection.Borders(xlEdgeLeft)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeTop)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeBottom)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlEdgeRight)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideVertical)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    With Selection.Borders(xlInsideHorizontal)
        .LineStyle = xlContinuous
        .ColorIndex = 0
        .TintAndShade = 0
        .Weight = xlThin
    End With
    
 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  
Windows(prfile2).Activate
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

Sheets("ViewRegister").Range("A1").Select

    ' to protect the sheet
    
   
  Sheets("Selection1").Visible = xlVeryHidden

'Application.EnableCancelKey = xlInterrupt
'  Application.OnKey "{ESC}"
'  Application.OnKey "^C"
'  Application.OnKey "^%{Break}"
'  Application.OnKey "^{Break}"
'  Application.OnKey "^%{Del}"

Application.ScreenUpdating = True


End Sub


Attribute VB_Name = "Sheet12"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Return1, 12, 0, MSForms, CommandButton"
Attribute VB_Control = "Update1, 11, 1, MSForms, CommandButton"


Private Sub Image1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
Range("e14").Select
Selection.Activate
Application.Run ("OpenCalendar")
End Sub

Private Sub Return1_Click()

Application.ScreenUpdating = False
Sheets("Selection1").Visible = True
     Sheets("Entry1").Visible = xlVeryHidden
     Sheets("Adding").Visible = xlVeryHidden
       Sheets("Editing").Visible = xlVeryHidden
       Sheets("JournalEntry").Visible = xlVeryHidden
       Sheets("TimeCard").Visible = xlVeryHidden
  Sheets("ViewRecord").Visible = xlVeryHidden
  Sheets("W2info").Visible = xlVeryHidden
   Sheets("ViewRegister").Visible = xlVeryHidden
         Sheets("Selection1").Select
    Sheets("Selection1").Range("J13").Select

Application.ScreenUpdating = True

End Sub

Private Sub Update1_Click()
'Dim SRecord2 As String
'SRecord2 = Range("E3").Value

Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""

Sheets("Editing").Range("BE4:BE11") = Sheets("Editing").Range("E4:E11").Value

Sheets("Editing").Range("be14:BE15") = Sheets("Editing").Range("e14:E15").Value
Sheets("Editing").Range("BE17:BE21") = Sheets("Editing").Range("E17:E21").Value
Sheets("Editing").Range("Bg18:Bg21") = Sheets("Editing").Range("g18:g21").Value

Application.EnableCancelKey = xlInterrupt


    If Sheets("Editing").Range("z11") <> True Then

MsgBox ("Social Security Number Must be in 999-99-9999 Format!")

Exit Sub
End If

        If Sheets("Editing").Range("o9") = True Then

MsgBox ("The Vacation adjustment must be a number in value! Please Re-enter")

Exit Sub

End If


        If Sheets("Editing").Range("o18") = True Then

MsgBox ("Deduction Amount/Percent must be a number in value! Please Re-enter")

Exit Sub

End If


        If Sheets("Editing").Range("o19") = True Then

MsgBox ("The deduction limit must be a number/amount in value! Please Re-enter")

Exit Sub

End If

       If Sheets("Editing").Range("o20") = False Then

MsgBox ("The deduction amount/percent must be greater or equal to zero! Please Re-enter")

Exit Sub

End If


       If Sheets("Editing").Range("o21") = False Then

MsgBox ("The deduction limit Cannot be Negative! Please Re-enter")

Exit Sub

End If


    
    If Sheets("Editing").Range("E4").Value = "" Then
    
    MsgBox ("The Name is Empty! Please Enter the name")
    Sheets("Editing").Cells(4, "E").Select
    Exit Sub
    
     End If
    
   
    
    If Sheets("Editing").Range("o5") = 0 Then

MsgBox ("The Last Name Empty!")

Exit Sub

End If
    
    
    If Sheets("Editing").Range("o6") = 0 Then

MsgBox ("The Address is Empty!")

Exit Sub

End If
    
    
    
        If Sheets("Editing").Range("o7") = 0 Then

MsgBox ("The City is Empty!")

Exit Sub

End If
    
        If Sheets("Editing").Range("o8") = 0 Then

MsgBox ("The State and Zip Must be Filled!")

Exit Sub

End If
    
        If Sheets("Editing").Range("o11") = 0 Then

MsgBox ("The Social Security Number is Emty!")

Exit Sub

End If
    
    
'        If Sheets("Editing").Range("o12") = 0 Then
'MsgBox ("The Tax Claim Status Must be either ""M"" or ""S""!")
'Exit Sub
'End If
    
    
 '       If Sheets("Editing").Range("o13") = 0 Then
'MsgBox ("The Number of Dependents Must be in Value Format!")
'Exit Sub
'End If
    
    
        If Sheets("Editing").Range("o17") = 0 Then

MsgBox ("The Payrate must be in Value and Greater than $2.13!")

Exit Sub

End If

        If Sheets("Editing").Range("z8") > 4807.7 Then

MsgBox ("Too Large! The Maximum rate is $4807.69/Hour, Please reenter")

Exit Sub

End If

       If Sheets("Editing").Range("o24") = True Then

MsgBox ("The Hiring Date is Empty! Please enter a hiring date")

Exit Sub

End If


       If Sheets("Editing").Range("o23") = True Then

MsgBox ("The Hiring Date Must be in Value Format mm/dd/yy! Please Re-enter")

Exit Sub

End If


       If Sheets("Editing").Range("o25") = True Then

MsgBox ("Hiring Date Error! Do not enter a future employee for more than 30 days, Please Re-enter")

Exit Sub

End If




'start normal
Application.ScreenUpdating = False

Application.EnableCancelKey = xlDisabled

Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String


prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value


Sheets("Selection1").Visible = True

Sheets("Selection1").Select

    Dim SRecord1 As String
    SRecord1 = Sheets("Selection1").Range("i4").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("Dbase1").Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select

    ActiveCell.Offset(0, 0).Value = Sheets("Editing").Cells(3, "e")
    ActiveCell.Offset(0, 1).Value = Sheets("Editing").Cells(4, "aa")
    ActiveCell.Offset(0, 2).Value = Sheets("Editing").Cells(5, "aa")
    ActiveCell.Offset(0, 3).Value = Sheets("Editing").Cells(6, "e")
    ActiveCell.Offset(0, 4).Value = Sheets("Editing").Cells(7, "e")
    ActiveCell.Offset(0, 5).Value = Sheets("Editing").Cells(8, "e")
    ActiveCell.Offset(0, 6).Value = Sheets("Editing").Cells(9, "e")
    ActiveCell.Offset(0, 7).Value = Sheets("Editing").Cells(10, "e")
    ActiveCell.Offset(0, 8).Value = Sheets("Editing").Cells(11, "e")
    ActiveCell.Offset(0, 9).Value = Sheets("Editing").Cells(12, "e")
    ActiveCell.Offset(0, 10).Value = Sheets("Editing").Cells(1, "Q")
    ActiveCell.Offset(0, 11).Value = Sheets("Editing").Cells(14, "e")
    ActiveCell.Offset(0, 12).Value = Sheets("Editing").Cells(15, "e")
    ActiveCell.Offset(0, 13).Value = Sheets("Editing").Cells(16, "e")
    ActiveCell.Offset(0, 14).Value = Sheets("Editing").Cells(17, "e")
    ActiveCell.Offset(0, 15).Value = Sheets("Editing").Cells(18, "e")
    ActiveCell.Offset(0, 16).Value = Sheets("Editing").Cells(19, "e")
    ActiveCell.Offset(0, 17).Value = Sheets("Editing").Cells(20, "e")
    ActiveCell.Offset(0, 18).Value = Sheets("Editing").Cells(21, "e")
    ActiveCell.Offset(0, 19).Value = Sheets("Editing").Cells(18, "f")
    ActiveCell.Offset(0, 20).Value = Sheets("Editing").Cells(19, "f")
    ActiveCell.Offset(0, 21).Value = Sheets("Editing").Cells(20, "f")
    ActiveCell.Offset(0, 22).Value = Sheets("Editing").Cells(21, "f")
    ActiveCell.Offset(0, 23).Value = Sheets("Editing").Cells(7, "z")
    ActiveCell.Offset(0, 24).Value = Sheets("Editing").Cells(18, "g")
    ActiveCell.Offset(0, 25).Value = Sheets("Editing").Cells(19, "g")
    ActiveCell.Offset(0, 26).Value = Sheets("Editing").Cells(20, "g")
    ActiveCell.Offset(0, 27).Value = Sheets("Editing").Cells(21, "g")
    
    ActiveCell.Offset(0, 28).Value = Sheets("Editing").Cells(13, "e")
    ActiveCell.Offset(0, 29).Value = Sheets("Editing").Cells(2, "Q")
    
    

Sheets("Editing").Select

Range("Recheading2").Copy
        
  ' to open the editted headding to record file
  
      Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
        
        Windows(prfile2).Activate
    
    Sheets(SRecord1).Select
    
    Sheets(SRecord1).Range("B1").Select
    
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       ' to empty the memory
    
    Application.CutCopyMode = False


        'to save and close the file
    
     ActiveWorkbook.Save
     ActiveWorkbook.Close


ThisWorkbook.Activate

Sheets("Editing").Range("BE4:BE15").ClearContents
Sheets("Editing").Range("BE17:BE21").ClearContents
Sheets("Editing").Range("Bg18:Bg21").ClearContents


 Sheets("Selection1").Select

Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Editing").Visible = xlVeryHidden
Sheets("Dbase1").Visible = xlVeryHidden

'to save the book

ActiveWorkbook.Save

MsgBox ("File Updated!")

Application.Run "macro3"

Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    If ActiveCell.Address = "$E$14" Then
    
                CalendarFrm.Show
            
    End If

End Sub


Attribute VB_Name = "Sheet13"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Return1, 16, 0, MSForms, CommandButton"
Attribute VB_Control = "Addarecord, 15, 1, MSForms, CommandButton"
Private Sub Addarecord_Click()

    Application.ScreenUpdating = False
    
    If Sheets("Adding").Range("E4").Value = "" Then
    
    MsgBox ("The Name is Empty! Please Enter the name")
    Sheets("Adding").Cells(4, "E").Select
    Exit Sub
    
     End If
 
    
  
    Sheets("Adding").Range("BE4:BE5") = Sheets("Adding").Range("E4:E5").Value
    Sheets("Adding").Range("BE6:BE7") = Sheets("Adding").Range("E6:E7").Value
    Sheets("Adding").Range("BE8") = Sheets("Adding").Range("E8").Value
    Sheets("Adding").Range("BE10:BE11") = Sheets("Adding").Range("E10:E11").Value
    Sheets("Adding").Range("BE14:BE15") = Sheets("Adding").Range("E14:E15").Value
    Sheets("Adding").Range("BE17:BE21") = Sheets("Adding").Range("E17:E21").Value
    Sheets("Adding").Range("Bg18:Bg21") = Sheets("Adding").Range("g18:g21").Value
     
    
    If Sheets("Adding").Range("o5") = 0 Then
MsgBox ("The Last Name Empty!")
Exit Sub
End If
     
    If Sheets("Adding").Range("o6") = 0 Then
MsgBox ("The Address is Empty!")
Exit Sub
End If
        
    If Sheets("Adding").Range("o7") = 0 Then
MsgBox ("The City is Empty!")
Exit Sub
End If
    
    If Sheets("Adding").Range("o8") = 0 Then
MsgBox ("The State and Zip Must be Filled!")
Exit Sub
End If
    
    If Sheets("Adding").Range("o11") = 0 Then
MsgBox ("The Social Security Number is Emty!")
Exit Sub
End If

    If Sheets("Adding").Range("z11") <> True Then
MsgBox ("Social Security Number Must be in 999-99-9999 Format!")
Exit Sub
End If


    
'    If Sheets("Adding").Range("o12") = 0 Then
'MsgBox ("The Tax Claim Status Must be either ""M"" or ""S""!")
'Exit Sub
'End If
     
'If Sheets("Adding").Range("o13") = 0 Then
'MsgBox ("The Number or Dependents Must be in Value Format!")
'Exit Sub
'End If
    
    
   If Sheets("Adding").Range("o17") = 0 Then
MsgBox ("The Payrate must be in Value!")
Exit Sub
End If
    
    If Sheets("Adding").Range("z8") < 2.13 Then
MsgBox ("The Payrate must be greater than $2.13 per hour!")
Exit Sub
End If
    
    
    
     If Sheets("Adding").Range("z8") > 4807.7 Then

MsgBox ("Too Large! The Maximum rate is $4807.69/Hour, Please reenter")

Exit Sub

End If

  
  

        If Sheets("Adding").Range("o9") = True Then

MsgBox ("The Vacation adjustment must be a number in value! Please Re-enter")

Exit Sub

End If


        If Sheets("Adding").Range("o18") = True Then

MsgBox ("Deduction Amount/Percent must be a number in value! Please Re-enter")

Exit Sub

End If


        If Sheets("Adding").Range("o19") = True Then

MsgBox ("The deduction limit must be a number/amount in value! Please Re-enter")

Exit Sub

End If

       If Sheets("Adding").Range("o20") = False Then

MsgBox ("The deduction amount/percent must be greater or equal to zero! Please Re-enter")

Exit Sub

End If


       If Sheets("Adding").Range("o21") = False Then

MsgBox ("The deduction limit Cannot be Negative! Please Re-enter")

Exit Sub

End If
  
       If Sheets("Adding").Range("o24") = True Then

MsgBox ("The Hiring Date is Empty! Please enter a hiring date")

Exit Sub

End If


       If Sheets("Adding").Range("o23") = True Then

MsgBox ("The Hiring Date Must be in Value Format mm/dd/yy! Please Re-enter")

Exit Sub

End If


       If Sheets("Adding").Range("o25") = True Then

MsgBox ("Hiring Date Error! Do not enter a future employee for more than 30 days, Please Re-enter")

Exit Sub

End If


    
    'Sheets("Setup").Range("b10") = Sheets("Setup").Range("b9").Value
    
      Sheets("Selection1").Visible = True
    Sheets("Selection1").Unprotect Password:=Sheets("Setup").Range("AA8").Value
     Sheets("Dbase1").Visible = True
         
     Sheets("Dbase1").Select

Sheets("Dbase1").Unprotect Password:=Sheets("Setup").Range("AA8").Value

    
    
    
    Sheets("Dbase1").Range("A1").Select
    Selection.End(xlDown).Select
    Selection.EntireRow.Insert
    ActiveCell.Offset(0, 0).Value = Sheets("Adding").Cells(3, "e")
    ActiveCell.Offset(0, 1).Value = Sheets("Adding").Cells(4, "Ae")
    ActiveCell.Offset(0, 2).Value = Sheets("Adding").Cells(5, "Ae")
    ActiveCell.Offset(0, 3).Value = Sheets("Adding").Cells(6, "e")
    ActiveCell.Offset(0, 4).Value = Sheets("Adding").Cells(7, "e")
    ActiveCell.Offset(0, 5).Value = Sheets("Adding").Cells(8, "e")
    ActiveCell.Offset(0, 6).Value = Sheets("Adding").Cells(9, "e")
    ActiveCell.Offset(0, 7).Value = Sheets("Adding").Cells(10, "e")
    ActiveCell.Offset(0, 8).Value = Sheets("Adding").Cells(11, "e")
    ActiveCell.Offset(0, 9).Value = Sheets("Adding").Cells(12, "e")
    
    'ActiveCell.Offset(0, 10).Value = Sheets("Adding").Cells(13, "e")
    ActiveCell.Offset(0, 10).Value = Sheets("Adding").Cells(101, "R").Value
    
    ActiveCell.Offset(0, 28) = Sheets("Adding").Cells(13, "e").Value
    ActiveCell.Offset(0, 29) = Sheets("Adding").Range("R102").Value
        
    
    ActiveCell.Offset(0, 11).Value = Sheets("Adding").Cells(14, "e")
    ActiveCell.Offset(0, 12).Value = Sheets("Adding").Cells(15, "e")
    ActiveCell.Offset(0, 13).Value = Sheets("Adding").Cells(16, "e")
    ActiveCell.Offset(0, 14).Value = Sheets("Adding").Cells(17, "e")
    ActiveCell.Offset(0, 15).Value = Sheets("Adding").Cells(18, "e")
    ActiveCell.Offset(0, 16).Value = Sheets("Adding").Cells(19, "e")
    ActiveCell.Offset(0, 17).Value = Sheets("Adding").Cells(20, "e")
    ActiveCell.Offset(0, 18).Value = Sheets("Adding").Cells(21, "e")
    ActiveCell.Offset(0, 19).Value = Sheets("Adding").Cells(18, "f")
    ActiveCell.Offset(0, 20).Value = Sheets("Adding").Cells(19, "f")
    ActiveCell.Offset(0, 21).Value = Sheets("Adding").Cells(20, "f")
    ActiveCell.Offset(0, 22).Value = Sheets("Adding").Cells(21, "f")
    ActiveCell.Offset(0, 23).Value = Sheets("Adding").Cells(7, "z")
    ActiveCell.Offset(0, 24).Value = Sheets("Adding").Cells(18, "g")
    ActiveCell.Offset(0, 25).Value = Sheets("Adding").Cells(19, "g")
    ActiveCell.Offset(0, 26).Value = Sheets("Adding").Cells(20, "g")
    ActiveCell.Offset(0, 27).Value = Sheets("Adding").Cells(21, "g")
    

    
    
        
    Sheets("Adding").Select
       
    Sheets("Adding").Range("A1").Select
    
    Sheets("Adding").Cells(1, "X").Value = Sheets("Adding").Cells(3, "e").Value
    
    Range("RecHeading1").Copy
        
  ' to open the record file and adding a new record
  
      Workbooks.Open Sheets("Setup").Range("e10").Value & Sheets("Setup").Range("b7").Value, Password:=Sheets("Setup").Range("AA9").Value
      
        
        'Windows(Sheets("Setup").Range("b7").Value).Activate
    
    Sheets("MRecord").Select
    Sheets("MRecord").Range("B1").Select
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       ' to empty the memory
    
    Application.CutCopyMode = False
    
    Dim NewRecName As String
    NewRecName = Sheets("MRecord").Range("F1").Value
        
    Sheets("MRecord").Copy Before:=Sheets(1)

    Sheets("MRecord (2)").Select
    Sheets("MRecord (2)").Name = NewRecName
    
    Sheets("MRecord").Select
   
    
    
        'to save and close the file
    
     ActiveWorkbook.Save
     ActiveWorkbook.Close
    
    'Windows(Sheets("Setup").PRfilename.Value).Activate
    
       'Windows("Payroll Time Card.xlsm").Activate
       Sheets("Adding").Select
       
       
 
 Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
       
       
         Sheets("Dbase1").Visible = xlVeryHiddne
           
           
   'to update the selection bar


 Sheets("Selection1").Select
 
 Sheets("Selection1").Range("BC1").Select
 
 Selection.Offset(Range("AB2").Value, 0).Value = Sheets("Adding").Range("Y1").Value
 
Sheets("Selection1").Range("a1").Select
           
      Sheets("Adding").Select
           
    Application.ScreenUpdating = True
    
    
    MsgBox ("Record Has Been Added!")
    
    Sheets("Adding").Range("E4") = ""
    Sheets("Adding").Range("E5") = ""
    Sheets("Adding").Range("E6") = ""
    Sheets("Adding").Range("E7") = ""
    Sheets("Adding").Range("E8") = ""
    Sheets("Adding").Range("F9") = 1
    Sheets("Adding").Range("E10", "E11") = ""
 
        
    
      Sheets("Adding").Range("E17", "E21").ClearContents
      Sheets("Adding").Range("E14").ClearContents
      Sheets("Adding").Range("g18", "g21").ClearContents
    
 
 
     Sheets("Adding").Range("bE4") = ""
    Sheets("Adding").Range("bE5") = ""
    Sheets("Adding").Range("bE6") = ""
    Sheets("Adding").Range("bE7") = ""
    Sheets("Adding").Range("bE8") = ""
    Sheets("Adding").Range("bF9") = 1
    Sheets("Adding").Range("bE10", "bE11") = ""
 
        
    
      Sheets("Adding").Range("bE17", "bE21").ClearContents
      Sheets("Adding").Range("bE13", "bE14").ClearContents
      Sheets("Adding").Range("bg18", "bg21").ClearContents
 
 
 Sheets("Adding").Range("o16:p16") = 2
 Sheets("Adding").Range("q101:q102") = 1
 
 
  
 
 Sheets("Adding").Visible = xlVeryHiddne
 
    Sheets("Selection1").Select
  
 Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
  

  
 ' run macro3
  
  Application.Run "macro3"

    
    'to save the book

ActiveWorkbook.Save


End Sub



Private Sub Return1_Click()
'
' Return1 Macro
Application.ScreenUpdating = False
Sheets("Selection1").Visible = True
     Sheets("Entry1").Visible = xlVeryHiddne
      Sheets("Adding").Visible = xlVeryHiddne
       Sheets("Editing").Visible = xlVeryHiddne
       Sheets("JournalEntry").Visible = xlVeryHiddne
       Sheets("TimeCard").Visible = xlVeryHiddne
  Sheets("ViewRecord").Visible = False
  Sheets("W2info").Visible = False
   Sheets("ViewRegister").Visible = False
         Sheets("Selection1").Select
    Sheets("Selection1").Range("J13").Select

Application.ScreenUpdating = True

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If ActiveCell.Address = "$E$14" Then
    
                CalendarFrm.Show
            
    End If
 
End Sub


Attribute VB_Name = "Sheet14"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet15"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CheckBox1, 51, 0, MSForms, CheckBox"
Attribute VB_Control = "ShowNet, 33, 1, MSForms, CommandButton"
Attribute VB_Control = "PayProcess, 32, 2, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 34, 3, MSForms, CommandButton"
Attribute VB_Control = "Earningtype, 35, 4, MSForms, ComboBox"
Attribute VB_Control = "ComboBox1, 36, 5, MSForms, ComboBox"
Attribute VB_Control = "ComboBox2, 37, 6, MSForms, ComboBox"
Attribute VB_Control = "ComboBox3, 38, 7, MSForms, ComboBox"
Attribute VB_Control = "ComboBox4, 39, 8, MSForms, ComboBox"
Attribute VB_Control = "ComboBox5, 40, 9, MSForms, ComboBox"
Attribute VB_Control = "ComboBox6, 41, 10, MSForms, ComboBox"
Attribute VB_Control = "ComboBox7, 42, 11, MSForms, ComboBox"
Attribute VB_Control = "ComboBox8, 43, 12, MSForms, ComboBox"
Attribute VB_Control = "CheckBox2, 53, 13, MSForms, CheckBox"
Attribute VB_Control = "CheckBox3, 54, 14, MSForms, CheckBox"
Attribute VB_Control = "CheckBox4, 55, 15, MSForms, CheckBox"


Private Sub CommandButton1_Click()

ActiveWindow.DisplayWorkbookTabs = False
Application.EnableCancelKey = xlDisabled


Sheets("Entry1").Range("ba12", "bc20").Value = Sheets("Entry1").Range("e12", "g20").Value
Sheets("Entry1").Range("bg12").Value = Sheets("Entry1").Range("g4").Value
Sheets("Entry1").Range("bf12").Value = Sheets("Entry1").Range("g5").Value
Sheets("Entry1").Range("be12").Value = Sheets("Entry1").Range("g9").Value

If Sheets("Entry1").Range("bd21") <> True Then

MsgBox ("Entry Error! Please check and Re-entry! Process failed")

Application.EnableCancelKey = xlInterrupt

Exit Sub

End If

Sheets("Entry1").Range("ba1", "bc9").Value = Sheets("Entry1").Range("ba12", "bc20").Value
Sheets("Entry1").Range("bg1").Value = Sheets("Entry1").Range("bg12").Value
Sheets("Entry1").Range("bf1").Value = Sheets("Entry1").Range("bf12").Value
Sheets("Entry1").Range("be1").Value = Sheets("Entry1").Range("be12").Value

Sheets("Entry1").Range("q23", "q31").Value = Sheets("Entry1").Range("r33", "r41").Value
Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("P20", "P28").Value
Sheets("Entry1").Range("q23", "q31").Value = Sheets("Entry1").Range("r33", "r41").Value

Application.EnableCancelKey = xlInterrupt

End Sub


Private Sub PayProcess_Click()
ActiveWindow.DisplayWorkbookTabs = False

'check if program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If



' to check the expiration before starting
'

If Sheets("Setup").Range("AH6") = False Then
Sheets("Setup").Range("an4").Value = InputBox("Program Expired! Enter a Code to Renew", "visit ExcelPayroll.Org for help")

    If Sheets("Setup").Range("ah3") = False Then
    MsgBox "Not a valid code.  Visit www.ExcelPayroll.Org to get a new one"
    Exit Sub
    End If

    If Sheets("Setup").Range("ah5") = False Then
    MsgBox "The Code Already Used and Expired! WWW.ExcelPayroll.Org"
    Exit Sub
    End If

Sheets("Setup").Range("ak2") = Date

    If Sheets("Setup").Range("am3").Value >= 15 Then
    Sheets("Setup").Range("AL4") = Sheets("Setup").Range("an4").Value
    End If

Sheets("Setup").Range("AL4").Offset(Sheets("Setup").Range("am3").Value, 0) = Sheets("Setup").Range("an4").Value
MsgBox "Code Accepted and Updated! Thank you for using Excel Payroll Program!"

End If


'normal code start
' make sure the entries are correct

Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^{Del}", ""

Sheets("Entry1").Range("p44:p45") = Sheets("Entry1").Range("g7:g8").Value


    If Sheets("Entry1").Range("q44") <> True Or Sheets("Entry1").Range("q45") <> True Then
 
 MsgBox ("Tax withhold must be in Value in Percentage! Please Re-enter!")
 Exit Sub
 End If
 
     If Sheets("Entry1").Range("r44") <> True Or Sheets("Entry1").Range("r45") <> True Then
 
 MsgBox ("Each FIT or SIT tax withhold must be less than 50%! Please Reeenter!")
 Exit Sub
 End If
 
 
 If Sheets("Entry1").Range("p46") <> True Then
MsgBox ("Total income taxes withhold cannot be over 90%! Please Re-enter ")
Exit Sub

End If


'check if the pr year selected is the same as the tax rate year

 If Sheets("Setup").Range("aa46") <> True Then

    Dim Answer4 As String
    Answer4 = MsgBox("Payroll Year Does Not Match The Tax Table Year" & vbCrLf & _
    "Do you wish to continue?", vbYesNo, "Use the old Tax Rates?")
    If Answer4 = vbNo Then
    Exit Sub
    End If
    End If
  


Sheets("Entry1").Range("ba12", "bc20").Value = Sheets("Entry1").Range("e12", "g20").Value
Sheets("Entry1").Range("bg12").Value = Sheets("Entry1").Range("g4").Value
Sheets("Entry1").Range("bf12").Value = Sheets("Entry1").Range("g5").Value
Sheets("Entry1").Range("be12").Value = Sheets("Entry1").Range("g9").Value

If Sheets("Entry1").Range("bd21") <> True Then

MsgBox ("Entry Error! Please check and Re-entry! Process failed")

    If Sheets("Entry1").Range("aw12") = True Then
        Sheets("Entry1").Range("g12").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw13") = True Then
        Sheets("Entry1").Range("g13").ClearContents
        End If
      
    If Sheets("Entry1").Range("aw14") = True Then
        Sheets("Entry1").Range("g14").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw15") = True Then
        Sheets("Entry1").Range("g15").ClearContents
        End If

    If Sheets("Entry1").Range("aw16") = True Then
        Sheets("Entry1").Range("g16").ClearContents
        End If

    If Sheets("Entry1").Range("aw17") = True Then
        Sheets("Entry1").Range("g17").ClearContents
        End If

    If Sheets("Entry1").Range("aw18") = True Then
        Sheets("Entry1").Range("g18").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw19") = True Then
        Sheets("Entry1").Range("g19").ClearContents
        End If

    If Sheets("Entry1").Range("aw20") = True Then
        Sheets("Entry1").Range("g20").ClearContents
        End If
              

Exit Sub

End If



'copy data to prepare payroll process
Sheets("Entry1").Range("ba1", "bc9").Value = Sheets("Entry1").Range("ba12", "bc20").Value
Sheets("Entry1").Range("bg1").Value = Sheets("Entry1").Range("bg12").Value
Sheets("Entry1").Range("bf1").Value = Sheets("Entry1").Range("bf12").Value
Sheets("Entry1").Range("be1").Value = Sheets("Entry1").Range("be12").Value

'copy code the calculate total
Sheets("Entry1").Range("q23", "q31").Value = Sheets("Entry1").Range("r33", "r41").Value

'copy total

Sheets("Entry1").Range("bc1", "bc9").Value = Sheets("Entry1").Range("P20", "P28").Value
Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("bc1", "bc9").Value


'start

If Sheets("Setup").Range("AA40") = True Then
MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub
End If

If Sheets("PRRate").Range("AA1") = True Then
MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")
Exit Sub
End If


'to process and post Rayroll paycheck and records (button 2 in macro)

Sheets("Selection1").Visible = True


 If Sheets("Entry1").Range("q14") <> 1 Then
MsgBox ("The Gross Wage Must be in Value Amount!")
Exit Sub
End If


If Sheets("Entry1").Range("o4") = 0 Then
MsgBox ("The Date is Empty!")
Exit Sub
End If


If Sheets("Entry1").Range("e21") > 2080 Then
MsgBox ("The Time/Hour is too large! Please Check the Timecard!")
Exit Sub
End If



If Sheets("Entry1").Range("o3") = 0 Then
MsgBox ("The Date Must Be in Format ""mm/dd/yyyy""!")
Exit Sub
End If

If Sheets("Entry1").Range("o11") = False Then
MsgBox ("The Date Must Be within the Payroll Year " & Sheets("Setup").Range("AA54") & ("! Please Reenter Date or Reset the PR Year!"))

Exit Sub
End If


If Sheets("Entry1").Range("o5") = 0 Then
MsgBox ("The Gross Amount Must be in Number and Greater than Zero!")
Exit Sub
End If


If Sheets("Entry1").Range("g21") <= 0.99 Then
MsgBox ("The Gross Amount Must be in Number and Greater than $1.00!")
Exit Sub
End If

If Sheets("PRCalculator").Range("x14") < 0 Then
MsgBox ("The Net Pay Amount is below Zero! Unable to Process")
Exit Sub
End If


If Sheets("Entry1").Range("g21") > 10000000 Then
MsgBox ("The Gross Amount is too large! Unable to Process!")
Exit Sub
End If

If Sheets("Entry1").Range("o6") = 0 Then
MsgBox ("Please Enter a Valid Check Number!")
Exit Sub
End If

If Sheets("PRCalculator").Range("x14").Value <= 0 Then
MsgBox ("The NetPay Amount is Negative! Unable to Process!")
Exit Sub
End If


If Sheets("Selection1").Range("j4") <> "" Then

   Dim AnswerYN9 As String
    
   AnswerYN9 = MsgBox("You Are Paying a Terminated Employee! Continue?", vbYesNo, "Warning")
    If AnswerYN9 = vbNo Then
        Exit Sub
    End If

End If


If Sheets("Entry1").Range("p55") < 0 And Sheets("Entry1").Range("Q32") > 0 Then

   Dim AnswerYN10 As String
    
   AnswerYN10 = MsgBox("Vacation Balance Below Zero! Continue?", vbYesNo, "Warning")
    If AnswerYN10 = vbNo Then
        Exit Sub
    End If

End If



   Application.ScreenUpdating = False

Application.EnableCancelKey = xlDisabled


Sheets("TimeCard").Range("AA2") = 1
Sheets("Setup").Range("AA51") = Sheets("Setup").Range("AA51") + 1

Dim Emunber As String
Dim prfile1 As String
Dim prfile2 As String
Dim filepath As String

Emunber = Sheets("Entry1").Cells(3, "s").Value
prfile1 = Worksheets("setup").Range("B10").Value
prfile2 = Worksheets("setup").Range("B7").Value
filepath = Worksheets("setup").Range("e10").Value


  
    Sheets("PPRChck").Visible = True
    Sheets("PPRChck").Select
       
        Sheets("PPRChck").Range("Z32:AF41").Select
    Selection.Copy
    Sheets("PPRChck").Range("Z43").Select
    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
    Application.CutCopyMode = False
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Clear
    ActiveWorkbook.Worksheets("PPRChck").Sort.SortFields.Add Key:=Range("Z44:Z52" _
        ), SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    With ActiveWorkbook.Worksheets("PPRChck").Sort
        .SetRange Sheets("PPRChck").Range("Z43:AF52")
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
    Sheets("PPRChck").Range("R33", "R41").Value = Sheets("PPRChck").Range("ac44", "ac52").Value
    Sheets("PPRChck").Range("t33", "v41").Value = Sheets("PPRChck").Range("ad44", "af52").Value
    
    
    
    
    
    Sheets("PPRChck").Select
        
    Sheets("PPRChck").Range("Printprcheck").Select
    Selection.Copy
    Sheets("PPRChck").Range("B2").Select
                 
                 Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
    
    Application.CutCopyMode = False
        

'to save the printed check for reprint

Sheets("PPRChck").Range("bb3", "dp500").ClearContents

     Sheets("PPRChck").Select
Sheets("PPRChck").Range("BB1").Select
 
    Selection.End(xlDown).Select
 
Sheets("PPRChck").Range(Selection.Offset(1, 0), Selection.Offset(1, 66)).Value = Sheets("PPRChck").Range("BB2", "DP2").Value
        
 'to adjust the reprint check box in timecard
 

 
 Sheets("TimeCard").Visible = True
  Sheets("TimeCard").Select
  Sheets("PPRChck").Range("AZ1") = 0
   Sheets("PPRChck").Range("BA1") = 1
   
   ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

    ActiveSheet.Shapes("Drop Down 3").Select
    With Selection
        .ListFillRange = Sheets("PPRChck").Range("BA2").Value
        .LinkedCell = "PPRChck!$AZ$1"
        .DropDownLines = 1
        .Display3DShading = False
    End With
    
Sheets("TimeCard").Range("S12").Select

 ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    
     
    Sheets("TimeCard").Visible = xlVeryHidden
         

 'to update the vacation balance
 
 
 Sheets("Selection1").Visible = True

Sheets("Selection1").Select

    Dim SRecord1 As String
    SRecord1 = Sheets("Selection1").Range("i4").Value
    
  
  Sheets("Dbase1").Visible = True
  
    Sheets("Dbase1").Select
ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value



Sheets("Dbase1").Columns("A").Select

Selection.Find(What:=SRecord1, After:=ActiveCell, LookIn:=xlFormulas, LookAt _
        :=xlPart, SearchOrder:=xlByRows, SearchDirection:=xlNext, MatchCase:= _
        False).Activate

ActiveCell.Select
 
 Selection.Offset(0, 12).Select

    ActiveCell.Value = ActiveCell.Value + Sheets("Entry1").Cells(32, "q")
  
 Sheets("Selection1").Select
 
Sheets("Dbase1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("Dbase1").Visible = xlVeryHidden
Sheets("PPRChck").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
Sheets("PPRChck").Visible = xlVeryHidden

Application.EnableCancelKey = xlDisabled

' to open record file
    
   Workbooks.Open filepath & prfile2, Password:=Sheets("Setup").Range("AA9").Value
        
    Windows(prfile2).Activate
            
   ' check if the maximum line is available
            
      If Sheets("MRegister").Range("AK1").Value >= 3645 Then
    
    MsgBox ("Reached Maximum Payroll this Year; Please Close the Payroll Year and Rerun!")
    
         ActiveWorkbook.Saved = True
         ActiveWorkbook.Close
    ThisWorkbook.Activate
    Sheets("Entry1").Visible = xlVeryHidden
    Sheets("Entry1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Sheets("PPRChck").Visible = xlVeryHidden
    Sheets("PPRChck").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Sheets("Selection1").Select
    Sheets("Selection1").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True
    Exit Sub
    
    End If
        
            
        Sheets(Emunber).Select

' to insert a line

    Sheets(Emunber).Range("A3").Select
    Selection.End(xlDown).Select
      
    Selection.Offset(1, 0).Select
       Selection.EntireRow.Insert , CopyOrigin:=xlFormatFromLeftOrAbove
       
' to copy the record
    
    
    'Windows(Sheets("Setup2").Range("b10").Value).Activate
    Windows(prfile1).Activate
       
     Sheets("PRCalculator").Range("A17", "AW17").Copy
            
    'Windows("Payroll Record.xlsm").Activate
    Windows(prfile2).Activate
    Sheets(Emunber).Select
    Sheets(Emunber).Range("A3").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
        
        
  ' to copy the register
       
       Windows(prfile1).Activate
    
' to update the register
       
       
       Sheets("PRCalculator").Range("A14", "Ay14").Copy
    'Windows("Payroll Record.xlsm").Activate
    Windows(prfile2).Activate
    
    Sheets("MRegister").Select
    Sheets("MRegister").Range("C1").Select
    Selection.End(xlDown).Select
     Selection.Offset(1, 0).Select
         Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False
       
         ' to empty the memory
    
    Application.CutCopyMode = False
       
    'To update the control number
  
     Windows(prfile1).Activate
        Sheets("PRCalculator").Range("AG16").Value = Sheets("PRCalculator").Range("AE17").Value


   
    'to save and close the Record file
     
    Windows(prfile2).Activate
     ActiveWorkbook.Save
     ActiveWorkbook.Close
       
    'Windows(Sheets("Setup").Range("b10").Value).Activate
    Windows(prfile1).Activate
    
    'Sheets("Entry1").Range("e4", "e13").ClearContents
        
    
    Sheets("Entry1").Visible = xlVeryHidden
    
    Sheets("Selection1").Select
    Sheets("Selection1").Range("i13").Select
    ActiveWorkbook.Save

'Ask if want to print the pr check

    Dim Answer2 As String
    Answer2 = MsgBox("Do You Want to Print a Payroll Check?", vbYesNo, "A Blank Check in Printer?")
    If Answer2 = vbYes Then
      
    
    'To Print PR check

If Sheets("Selection1").Range("AD1") = 1 Then

        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If
    
Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
     
    Sheets("Selection1").Select
    Sheets("Selection1").Range("A1").Select
        
        
    Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHidden
    Sheets("PPRChck").Visible = xlVeryHidden
   
End If

' Ask again if want to reprint the check

    Dim Answer3 As String
    Answer3 = MsgBox("Do You Need to Reprint the Check?", vbYesNo, "Payroll Processed!")
    If Answer3 = vbYes Then
   
    
    If Sheets("Selection1").Range("AD1") = 1 Then


        If Sheets("Setup").Range("AA93") = 1 Then
        Sheets("QBCK").Visible = True
        Sheets("QBCK").Select
    
            End If
    
        If Sheets("Setup").Range("AA93") = 2 Then
        Sheets("QKNCK").Visible = True
        Sheets("QKNCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 3 Then
        Sheets("PTCK").Visible = True
        Sheets("PTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 4 Then
        Sheets("GPCK").Visible = True
        Sheets("GPCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 5 Then
        Sheets("SBTCK").Visible = True
        Sheets("SBTCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 6 Then
        Sheets("PFWCK").Visible = True
        Sheets("PFWCK").Select

            End If
    
        If Sheets("Setup").Range("AA93") = 7 Then
        Sheets("OTHCK").Visible = True
        Sheets("OTHCK").Select

            End If


Else

Sheets("CustCheck").Visible = True
Sheets("CustCheck").Select
    
End If
            
   ActiveWindow.SelectedSheets.PrintOut Copies:=1
     
    Sheets("Selection1").Select
    Sheets("Selection1").Range("A1").Select
       Sheets("CustCheck").Visible = False
       Sheets("PPRChck").Visible = xlVeryHidden
    
     
      
    End If

    Sheets("QBCK").Visible = xlVeryHidden
    Sheets("QKNCK").Visible = xlVeryHidden
    Sheets("PTCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("GPCK").Visible = xlVeryHidden
    Sheets("SBTCK").Visible = xlVeryHidden
    Sheets("PFWCK").Visible = xlVeryHidden
    Sheets("CustCheck").Visible = xlVeryHidden
    Sheets("OTHCK").Visible = xlVeryHidden
    Sheets("PPRChck").Visible = xlVeryHidden
  
Sheets("Entry1").Range("g5").Value = Sheets("Entry1").Range("g5") + 1


Sheets("Setup").Range("z11") = Sheets("Setup").Range("z11") + Sheets("Setup").Range("ab11").Value
Sheets("PRCalculator").Range("a15") = Sheets("PRCalculator").Range("a15") + Sheets("PRCalculator").Range("bp3001").Value


    Application.ScreenUpdating = True
    
 Application.EnableCancelKey = xlInterrupt
   Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^{Del}"
    
End Sub

Private Sub ShowNet_Click()
 
 ActiveWindow.DisplayWorkbookTabs = False
 
'check if program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

'Application.ScreenUpdating = True

Exit Sub

End If
 
  
 
 'check if errors in setup

If Sheets("Setup").Range("AA40") = True Then

MsgBox ("Company Setup Error! Process Failed! Please Return to Co Setup and Re-enter Value!")

Exit Sub

End If

If Sheets("PRRate").Range("AA1") = True Then

MsgBox ("Tax Rate Setup Error! Process Failed! Please Return to Rate Setup and Re-enter Value!")

Exit Sub

End If
 
  
 ' start process
 Application.EnableCancelKey = xlDisabled
   Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""
  Application.OnKey "^{Del}", ""

Sheets("Entry1").Range("p44:p45") = Sheets("Entry1").Range("g7:g8").Value


    If Sheets("Entry1").Range("q44") <> True Or Sheets("Entry1").Range("q45") <> True Then
 
 MsgBox ("Tax withhold must be in Value in Percentage! Please Re-enter!")
 Exit Sub
 End If
 
     If Sheets("Entry1").Range("r44") <> True Or Sheets("Entry1").Range("r45") <> True Then
 
 MsgBox ("Each FIT or SIT tax withhold must be less than 50%! Please Reeenter!")
 Exit Sub
 End If
 
 
 If Sheets("Entry1").Range("p46") <> True Then
MsgBox ("Total income taxes withhold cannot be over 90%! Please Re-enter ")
Exit Sub

End If


Application.EnableCancelKey = xlDisabled

Sheets("Entry1").Range("ba12", "bc20").Value = Sheets("Entry1").Range("e12", "g20").Value
Sheets("Entry1").Range("bg12") = Sheets("Entry1").Range("g4").Value
Sheets("Entry1").Range("bf12") = Sheets("Entry1").Range("g5").Value
Sheets("Entry1").Range("be12") = Sheets("Entry1").Range("g9").Value

If Sheets("Entry1").Range("bd21") <> True Then

MsgBox ("Entry Error! Please check and Re-entry! Process failed")

    If Sheets("Entry1").Range("aw12") = True Then
        Sheets("Entry1").Range("g12").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw13") = True Then
        Sheets("Entry1").Range("g13").ClearContents
        End If
      
    If Sheets("Entry1").Range("aw14") = True Then
        Sheets("Entry1").Range("g14").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw15") = True Then
        Sheets("Entry1").Range("g15").ClearContents
        End If

    If Sheets("Entry1").Range("aw16") = True Then
        Sheets("Entry1").Range("g16").ClearContents
        End If

    If Sheets("Entry1").Range("aw17") = True Then
        Sheets("Entry1").Range("g17").ClearContents
        End If

    If Sheets("Entry1").Range("aw18") = True Then
        Sheets("Entry1").Range("g18").ClearContents
        End If
        
    If Sheets("Entry1").Range("aw19") = True Then
        Sheets("Entry1").Range("g19").ClearContents
        End If

    If Sheets("Entry1").Range("aw20") = True Then
        Sheets("Entry1").Range("g20").ClearContents
        End If
              
Exit Sub

End If


Sheets("Entry1").Range("ba1", "bc9").Value = Sheets("Entry1").Range("ba12", "bc20").Value
Sheets("Entry1").Range("bg1").Value = Sheets("Entry1").Range("bg12").Value
Sheets("Entry1").Range("bf1").Value = Sheets("Entry1").Range("bf12").Value
Sheets("Entry1").Range("be1").Value = Sheets("Entry1").Range("be12").Value


Sheets("Entry1").Range("q23", "q31").Value = Sheets("Entry1").Range("r33", "r41").Value
Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("P20", "P28").Value
Sheets("Entry1").Range("q23", "q31").Value = Sheets("Entry1").Range("r33", "r41").Value


Sheets("Entry1").Range("g12", "g20").Value = Sheets("Entry1").Range("P20", "P28").Value
 
 If Sheets("Entry1").Range("q14") <> 1 Then
MsgBox ("The Gross Wage Must be in Value Amount!")

Sheets("Entry1").Range("g12", "g20").ClearContents

Exit Sub
End If
 
 
 
 
 
 Application.ScreenUpdating = False
 Sheets("Setup").Range("b10") = Sheets("Setup").Range("b9").Value

  Sheets("PRCalculator").Visible = xlVeryHidden
  
Sheets("Entry1").Range("j4").Value = Sheets("PRCalculator").Range("N14").Value
Sheets("Entry1").Range("j5").Value = Sheets("PRCalculator").Range("O14").Value
Sheets("Entry1").Cells(6, "j").Value = Sheets("PRCalculator").Range("L14").Value
Sheets("Entry1").Range("j7").Value = Sheets("PRCalculator").Range("M14").Value
Sheets("Entry1").Range("j8").Value = Sheets("PRCalculator").Range("P14").Value
Sheets("Entry1").Range("j9").Value = Sheets("PRCalculator").Range("Q14").Value
Sheets("Entry1").Range("j10").Value = Sheets("PRCalculator").Range("R14").Value
Sheets("Entry1").Range("j11").Value = Sheets("PRCalculator").Range("S14").Value
Sheets("Entry1").Range("j12").Value = Sheets("PRCalculator").Range("T14").Value
Sheets("Entry1").Range("j13").Value = Sheets("PRCalculator").Range("x14").Value


If Sheets("Entry1").Range("p55") < 0 And Sheets("Entry1").Range("Q32") > 0 Then
MsgBox ("Vacation Balance Below Zero!")
        Exit Sub
End If


Application.EnableCancelKey = xlInterrupt
  Application.OnKey "{ESC}"
  Application.OnKey "^C"
  Application.OnKey "^%{Break}"
  Application.OnKey "^{Break}"
  Application.OnKey "^{Del}"

  'Sheets("PRCalculator").Visible = False

End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)

    If ActiveCell.Address = "$G$4" Then
    
                CalendarFrm.Show
            
    End If
 
End Sub


Attribute VB_Name = "Sheet16"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet17"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet18"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet19"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True

Attribute VB_Name = "Sheet20"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet21"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Worksheet_SelectionChange(ByVal Target As Range)

Sheets("Setup").Range("z11") = Sheets("Setup").Range("z11") + Sheets("Setup").Range("ab11").Value


End Sub
Attribute VB_Name = "Sheet22"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet23"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet24"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Auto, 16, 0, MSForms, CheckBox"

Private Sub Auto_Click()

Application.ScreenUpdating = False

Sheets("TimeCard").Range("AK2:AK204") = Sheets("TimeCard").Range("K2:K204").Value
Sheets("TimeCard").Range("AJ2:AJ204") = Sheets("TimeCard").Range("AM2:AM204").Value

Sheets("TimeCard").Range("K2:K204") = Sheets("TimeCard").Range("AL2:AL204").Value
Sheets("TimeCard").Range("an2:an204") = Sheets("TimeCard").Range("Aj2:Aj204").Value

Application.ScreenUpdating = True



End Sub

Private Sub Worksheet_SelectionChange(ByVal Target As Range)
    If ActiveCell.Address = "$S$6" Then
    
                CalendarFrm.Show
           
    End If
End Sub

Attribute VB_Name = "Sheet25"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet26"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet27"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet28"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet29"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet3"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet30"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton1, 4, 0, MSForms, CommandButton"
Private Sub CommandButton1_Click()

Sheets("condition").Visible = True
Sheets("condition").Select

End Sub
Attribute VB_Name = "Sheet31"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "Costing, 9, 0, MSForms, CommandButton"
Attribute VB_Control = "Help, 8, 1, MSForms, Image"
Attribute VB_Control = "Taxrate, 7, 2, MSForms, CommandButton"
Attribute VB_Control = "Comsetup, 6, 3, MSForms, CommandButton"
Attribute VB_Control = "Payroll, 5, 4, MSForms, CommandButton"

Private Sub Comsetup_Click()

ActiveWindow.DisplayWorkbookTabs = False
Application.ScreenUpdating = False

'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


'check if program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If



'to begin

Application.EnableCancelKey = xlDisabled

Sheets("Setup").Visible = True
ActiveSheet.Visible = xlVeryHidden

Sheets("Setup").Select
Sheets("Setup").Range("AA55") = Sheets("Setup").Range("AB55").Value


'save previous setup

   Sheets("Setup").Range("CB1:CJ48").Copy Destination:=Sheets("Setup").Range("CL1:CT48")
    Application.CutCopyMode = False

Sheets("Setup").Range("A1").Select

Application.EnableCancelKey = xlInterrupt
Application.CellDragAndDrop = True

Application.ScreenUpdating = True

End Sub


Private Sub Costing_Click()
ActiveWindow.DisplayWorkbookTabs = False
Application.EnableCancelKey = xlDisabled
  Application.OnKey "{ESC}", ""
  Application.OnKey "^C", ""
  Application.OnKey "^%{Break}", ""
  Application.OnKey "^{Break}", ""


If Sheets("Setup").Range("AG2") = False Then

MsgBox ("Not available in this version; please use standard version")

Exit Sub

End If


'check if program being changed or damage


If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"


Exit Sub

End If


'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If



'make sure the user has agreed to the term and condition

If Sheets("condition").Range("c26") = "" Then

   Dim AnswerYN15 As String
    
   AnswerYN15 = MsgBox("You Must Agree to the Term and Condition Before You May Use the Application" & vbCrLf _
   & "Click Yes to Accept to Agree the Term and Condition or" & vbCrLf _
   & "Click No to View the Term and Conditioin", vbYesNo, "1st Time User: Welcome to Excel Payroll")
    If AnswerYN15 = vbYes Then
        
        Sheets("condition").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("condition").Range("C26") = "User agreed"

Sheets("condition").Protect Password:=Sheets("Setup").Range("AA8").Value
        
  
       MsgBox "Congratulations! Welcome to ExcelPayroll!" & vbCrLf _
& "You have agreed and accepted the users' term and condition" & vbCrLf _
& "You may start to use the program now!"
                   
    Exit Sub
                   
    End If
Sheets("condition").Visible = True
Sheets("condition").Select

Exit Sub
End If







'start normal

Application.ScreenUpdating = False
       
    Dim LineNum1 As Integer
    Dim Sortkey1 As Integer
    Dim Sortkey2 As Integer
    Dim Enumbers As Integer
    Dim prfile1 As String
    Dim prfile3 As String
    Dim filepath As String
    
    
    
    LineNum1 = Sheets("Selection1").Cells(2, "AB").Value
    Sortkey1 = 14
    Sortkey2 = 24
    Enumbers = Worksheets("selection1").Range("AD3").Value
    prfile1 = Worksheets("setup").Range("B10").Value
    prfile3 = Worksheets("setup").Range("e7").Value
    filepath = Worksheets("setup").Range("e10").Value
         
      
    Sheets("Dbase1").Visible = True
    
    Sheets("DBase1").Select
    ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value
    
    Sheets("DBase1").Range(Sheets("DBase1").Cells(1, "A"), Sheets("DBase1").Cells(LineNum1 + 1, "AD")).Select
       
     
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Clear
    
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Add Key:=Sheets("DBase1").Range(Sheets("DBase1").Cells(2, Sortkey1), Sheets("DBase1").Cells(LineNum1 + 1, Sortkey1)), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    ActiveWorkbook.Worksheets("DBase1").Sort.SortFields.Add Key:=Sheets("DBase1").Range(Sheets("DBase1").Cells(2, Sortkey2), Sheets("DBase1").Cells(LineNum1 + 1, Sortkey2)), _
        SortOn:=xlSortOnValues, Order:=xlAscending, DataOption:=xlSortNormal
    
    
    With ActiveWorkbook.Worksheets("DBase1").Sort
        .SetRange Sheets("DBase1").Range(Sheets("DBase1").Cells(1, "A"), Sheets("DBase1").Cells(LineNum1 + 1, "AD"))
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
         
        
 Sheets("DBase1").Cells(1, "A").Select


Workbooks.Open filepath & prfile3, Password:=Sheets("Setup").Range("AA9").Value

Windows(prfile3).Activate

 Sheets("employeedata").Visible = True
Sheets("employeedata").Select
Sheets("employeedata").Range("B2:F58").ClearContents
Sheets("employeedata").Range("AA1").Value = filepath
Sheets("employeedata").Range("AB1").Value = prfile1


'copy ID numbers
Windows(prfile1).Activate
Sheets("DBase1").Visible = True
Sheets("DBase1").Select
Sheets("DBase1").Range("A1").Select
Sheets("DBase1").Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy

'Paste ID number


 Windows(prfile3).Activate
Sheets("employeedata").Select

Sheets("employeedata").Range("C2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False
 
'copy Name
Windows(prfile1).Activate
Sheets("DBase1").Visible = True
Sheets("DBase1").Select
Sheets("DBase1").Range("B1").Select
Sheets("DBase1").Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste Name

 Windows(prfile3).Activate
Sheets("employeedata").Select
Sheets("employeedata").Range("B2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


'copy payrate
Windows(prfile1).Activate
Sheets("DBase1").Select
Sheets("DBase1").Range("o1").Select
Sheets("DBase1").Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste payrate

 Windows(prfile3).Activate
Sheets("employeedata").Select
Sheets("employeedata").Range("e2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


'copy ratecode
Windows(prfile1).Activate
Sheets("DBase1").Select
Sheets("DBase1").Range("x1").Select
Sheets("DBase1").Range(Selection.Offset(1, 0), Selection.Offset(Enumbers, 0)).Select
Selection.Copy


'Paste ratecode

 Windows(prfile3).Activate
Sheets("employeedata").Select
Sheets("employeedata").Range("d2").Select

    Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


 Sheets("employeedata").Visible = xlVeryHidden


'update the selection box

Sheets("TimeCard").Select


ActiveSheet.Unprotect Password:=Sheets("Timecard").Range("AZ1").Value


    ActiveSheet.Shapes("Drop Down 6").Select
    With Selection
        .ListFillRange = Sheets("EmployeeData").Range("AC1").Value
        .LinkedCell = "TimeCard!$F$4"
        .DropDownLines = 8
        .Display3DShading = False
    End With
    
Sheets("TimeCard").Range("e8").Select

Sheets("Detail2").Range("B2:C58").Value = Sheets("EmployeeList").Range("B2:C58").Value


 ActiveSheet.Protect Password:=Sheets("Timecard").Range("AZ1").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Application.EnableCancelKey = xlInterrupt

ThisWorkbook.Activate
'ThisWorkbook.Saved = True
ThisWorkbook.Save
ThisWorkbook.Close




End Sub

Private Sub Help_Click()
ActiveWindow.DisplayWorkbookTabs = False

'check if the program being changed or damaged

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If



'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

'Application.ScreenUpdating = True



Exit Sub

End If


If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If



Sheets("Help").Visible = True
 ActiveSheet.Visible = xlVeryHidden
Sheets("Help").Select
End Sub

Private Sub Payroll_Click()

ActiveWindow.DisplayWorkbookTabs = False



'Application.OnKey "{ESC}", "NoChange"

'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If



If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If




'make sure the premium version is not an illegal copy ** 1/29/2017 v2.31


If Sheets("Setup").Range("AO2") > 5000 And Sheets("Setup").Range("AS14") = False Then

MsgBox "Unauthorized Computer Found! This Version must be Kept at the Same Computer!" & vbCrLf & "No Copies can be made for this version; Please Contact ExcelPayroll.Org if Need Help"

Exit Sub

End If





'make sure the user has agreed to the term and condition

If Sheets("condition").Range("c26") = "" Then

   Dim AnswerYN15 As String
    
   AnswerYN15 = MsgBox("You Must Agree to the Term and Condition Before You May Use the Application" & vbCrLf _
   & "Click Yes to Accept to Agree the Term and Condition or" & vbCrLf _
   & "Click No to View the Term and Conditioin", vbYesNo, "1st Time User: Welcome to Excel Payroll")
    If AnswerYN15 = vbYes Then
        
        Sheets("condition").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("condition").Range("C26") = "User agreed"

Sheets("condition").Protect Password:=Sheets("Setup").Range("AA8").Value
        
  
       MsgBox "Congratulations! Welcome to ExcelPayroll!" & vbCrLf _
& "You have agreed and accepted the users' term and condition" & vbCrLf _
& "You may start to use the program now!"
                   
    Exit Sub
                   
    End If
Sheets("condition").Visible = True
Sheets("condition").Select
Exit Sub
End If




' check if the program expires 1/29/2017
'

If Sheets("Setup").Range("AH6") = False Then

MsgBox "Program Expired!" & vbCrLf & "Please Visit www.ExcelPayroll.Org to Get a Renewal Code!"

Exit Sub

End If




'normal code start

'Application.EnableCancelKey = xlDisabled
'  Application.OnKey "{ESC}", ""
'  Application.OnKey "^C", ""
'  Application.OnKey "^%{Break}", ""
'  Application.OnKey "^{Break}", ""

 
 Application.ScreenUpdating = False
 
 
 Sheets("Selection1").Visible = True

    Sheets("Selection1").Select
    'ActiveSheet.Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("WeekTime").Unprotect Password:=Sheets("Setup").Range("AA8").Value
Sheets("WeekTime").Columns("A:HD").Hidden = False

Dim prfile1 As String
Dim prfile3 As String
Dim filepath As String

prfile1 = Worksheets("setup").Range("B10").Value
prfile3 = Worksheets("setup").Range("e7").Value
filepath = Worksheets("setup").Range("e10").Value

Application.ScreenUpdating = False
Workbooks.Open filepath & prfile3, Password:=Sheets("Setup").Range("AA9").Value

 Windows(prfile3).Activate
 
Sheets("Sheet1").Range("a1", "ck100").Copy
ThisWorkbook.Activate
Sheets("WeekTime").Visible = True
Sheets("WeekTime").Select
Sheets("WeekTime").Range("DS1").Select
    
        Selection.PasteSpecial Paste:=xlPasteValues, Operation:=xlNone, SkipBlanks _
        :=False, Transpose:=False

 Application.CutCopyMode = False


Windows(prfile3).Activate

ActiveWorkbook.Saved = True
ActiveWorkbook.Close


ThisWorkbook.Activate

Application.DisplayFullScreen = False


Sheets("WeekTime").Range("S1", "DC100").ClearContents
Sheets("TimeCard").Range("AC6", "AC10").ClearContents


Sheets("WeekTime").Columns("A:HD").Hidden = True
Sheets("WeekTime").Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

Sheets("WeekTime").Visible = xlVeryHidden
Sheets("Selection1").Visible = True

Sheets("Main").Range("AA1").Value = Sheets("Setup").Range("AI7").Value
Sheets("Setup").Range("z11") = Sheets("Setup").Range("z11") + Sheets("Setup").Range("ab11").Value


Sheets("Selection1").Select
Sheets("Selection1").Range("BA1", "BQ201").Value = Sheets("WeekTime").Range("A1", "Q201").Value
Sheets("Selection1").Select

 Application.Run "macro3"

 Sheets("Selection1").Range("A1").Select
   
   ActiveSheet.Protect Password:=Sheets("Setup").Range("AA8").Value, DrawingObjects:=True, Contents:=True, Scenarios:=True

    
    Sheets("Main").Visible = xlVeryHidden
    
  
    'Application.ScreenUpdating = True
    
  Application.EnableCancelKey = xlInterrupt
  
   
End Sub

Private Sub Taxrate_Click()
ActiveWindow.DisplayWorkbookTabs = False
'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"

Exit Sub

End If


If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If


If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If


'to begin

Application.ScreenUpdating = False
Sheets("TaxRate").Visible = True
ActiveSheet.Visible = xlVeryHidden
Sheets("TaxRate").Select
Sheets("TaxRate").Range("A1").Select
Application.ScreenUpdating = True

End Sub
Attribute VB_Name = "Sheet32"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet33"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet34"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet35"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet36"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet37"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet38"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet39"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet4"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet40"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet41"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet42"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "OptionButton1, 388, 0, MSForms, OptionButton"
Attribute VB_Control = "OptionButton2, 389, 1, MSForms, OptionButton"
Attribute VB_Name = "Sheet43"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Control = "CommandButton2, 2, 0, MSForms, CommandButton"
Attribute VB_Control = "CommandButton1, 1, 1, MSForms, CommandButton"
Private Sub CommandButton1_Click()


If Sheets("condition").Range("C26") = "User agreed" Then

MsgBox "You have agreed to this term at purchase; this is for view only" & vbCrLf _
& "Thank you for using this Excep Payroll Program!"

Sheets("help").Visible = True
Sheets("condition").Visible = False
Sheets("help").Select

Exit Sub

End If




Application.ScreenUpdating = False

Sheets("condition").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("condition").Range("C26") = "User agreed"
Sheets("condition").Range("C27") = Now()

Sheets("condition").Protect Password:=Sheets("Setup").Range("AA8").Value


       MsgBox "Congratulations! Welcome to ExcelPayroll!" & vbCrLf _
& "You have agreed and accepted the users' term and condition" & vbCrLf _
& "You may start to use the program now!"


Sheets("main").Visible = True
Sheets("condition").Visible = False
Sheets("main").Select
ActiveWorkbook.Save

Application.ScreenUpdating = True

End Sub

Private Sub CommandButton2_Click()

If Sheets("condition").Range("C26") = "User agreed" Then

MsgBox "You have agreed to this term at purchase; this is for view only" & vbCrLf _
& "But if you do not agree to the term you are not able to use this product"

Sheets("help").Visible = True
Sheets("condition").Visible = False
Sheets("help").Select

Exit Sub
End If

Sheets("condition").Protect Password:=Sheets("Setup").Range("AA8").Value
ActiveWorkbook.Save
ActiveWorkbook.Saved = True
ActiveWorkbook.Close

End Sub
Attribute VB_Name = "Sheet5"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet6"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet7"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet8"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "Sheet9"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Attribute VB_Name = "ThisWorkbook"
Attribute VB_Base = "0{00020819-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
Private Sub Workbook_Open()

'check if program being changed or damaged
ActiveWindow.DisplayWorkbookTabs = False

If Sheets("Setup").Range("BO1") = True Then

MsgBox "One or More Excel Sheet Missing or Name changed" & vbCrLf & "or program file damaged! Unable to process" & vbCrLf _
& "Please Contact ExcelPayroll.Org or restore your back file!"

Exit Sub

End If




Worksheets("setup").Range("B10").Value = Worksheets("setup").Range("B9").Value
Worksheets("setup").Range("e10").Value = Worksheets("setup").Range("e9").Value
Worksheets("setup").Columns("BI").ClearContents

Sheets("Main").Visible = True
Sheets("Main").Select
Sheets("Number").Visible = xlVeryHidden
Sheets("PRCalculator").Visible = xlVeryHidden
Sheets("Record").Visible = xlVeryHidden
Sheets("PRRate").Visible = xlVeryHidden
Sheets("CustCheck").Visible = xlVeryHidden
Sheets("PPRChck").Visible = xlVeryHidden
Sheets("DBase1").Visible = xlVeryHidden
Sheets("Entry1").Visible = xlVeryHidden
Sheets("Adding").Visible = xlVeryHidden
Sheets("Editing").Visible = xlVeryHidden
Sheets("JournalEntry").Visible = xlVeryHidden
Sheets("PRSummary").Visible = xlVeryHidden
Sheets("Setup").Visible = xlVeryHidden
Sheets("ViewRecord").Visible = xlVeryHidden
Sheets("PrintRecord").Visible = xlVeryHidden
Sheets("ViewRegister").Visible = xlVeryHidden
Sheets("Earnings").Visible = xlVeryHidden
Sheets("941").Visible = xlVeryHidden
Sheets("940").Visible = xlVeryHidden
Sheets("W2info").Visible = xlVeryHidden
Sheets("PRRegister").Visible = xlVeryHidden
Sheets("W2Form").Visible = xlVeryHidden
Sheets("condition").Visible = False
Sheets("TempBatch").Visible = xlVeryHidden
Sheets("Selection1").Visible = xlVeryHidden
Sheets("TimeCard").Visible = xlVeryHidden
Sheets("Employee").Visible = xlVeryHidden
Sheets("WeekTime").Visible = xlVeryHidden
Sheets("Help").Visible = xlVeryHidden
Sheets("Processing").Visible = xlVeryHidden
Sheets("W3").Visible = xlVeryHidden
Sheets("Qreport").Visible = xlVeryHidden
Sheets("Reports").Visible = xlVeryHidden
Sheets("QBCK").Visible = xlVeryHidden
Sheets("QKNCK").Visible = xlVeryHidden
Sheets("PTCK").Visible = xlVeryHidden
Sheets("GPCK").Visible = xlVeryHidden
Sheets("GPCK").Visible = xlVeryHidden
Sheets("SBTCK").Visible = xlVeryHidden
Sheets("PFWCK").Visible = xlVeryHidden
Sheets("CustCheck").Visible = xlVeryHidden
Sheets("OTHCK").Visible = xlVeryHidden
Sheets("PPRChck").Visible = xlVeryHidden

Application.ScreenUpdating = False
Application.DisplayFullScreen = False

Application.Run ("NameListing")


'check and make sure all files are in the same folder

If Sheets("Setup").Range("BK1") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Record.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If

If Sheets("Setup").Range("BK2") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "Payroll Time Card.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If


If Sheets("Setup").Range("BK3") = True Then

MsgBox "Missing file or Name Changed:" & vbCrLf & "PRRecord.xlsm" & vbCrLf _
& "All of the 4 files must be in the same folder!" & vbCrLf _
& "Please exit and put the missing file in the same folder!"


Exit Sub

End If


'make sure user agrees the term and condition

If Sheets("condition").Range("c26") = "" Then

   Dim AnswerYN15 As String
    
   AnswerYN15 = MsgBox("You Must Agree to the Term and Condition Before You May Use the Application" & vbCrLf _
   & "Click Yes to Accept to Agree the Term and Condition or" & vbCrLf _
   & "Click No to View the Term and Conditioin", vbYesNo, "1st Time User: Welcome to Excel Payroll")
    If AnswerYN15 = vbYes Then
        
        Sheets("condition").Unprotect Password:=Sheets("Setup").Range("AA8").Value

Sheets("condition").Range("C26") = "User agreed"
Sheets("condition").Range("C27") = Now()

Sheets("condition").Protect Password:=Sheets("Setup").Range("AA8").Value
        
  
       MsgBox "Congratulations! Welcome to ExcelPayroll!" & vbCrLf _
& "You have agreed and accepted the users' term and condition" & vbCrLf _
& "You may start to use the program now!"
                   
    Exit Sub
                   
    End If
Sheets("condition").Visible = True
Sheets("condition").Select

End If

Sheets("Main").Range("AA1").Value = Sheets("Setup").Range("AI7").Value
Sheets("Main").Range("AA2").Value = Sheets("Setup").Range("AO2").Value



'to get harddisk SNumber 1/29/2017 V2.31

Application.Run ("ProcessorNumber")

Sheets("Setup").Range("AR13") = ProcNum
Sheets("Setup").Range("AR14") = DriveSerialNumber



'Application.ScreenUpdating = True
Application.DisplayFullScreen = False

End Sub





INQUEST-PP=macro
